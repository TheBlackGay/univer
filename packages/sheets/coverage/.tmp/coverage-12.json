{"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/type.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/type.ts","statementMap":{"0":{"start":{"line":1,"column":47},"end":{"line":7,"column":27}},"1":{"start":{"line":2,"column":2},"end":{"line":2,"column":74}},"2":{"start":{"line":3,"column":2},"end":{"line":3,"column":66}},"3":{"start":{"line":4,"column":2},"end":{"line":4,"column":70}},"4":{"start":{"line":5,"column":2},"end":{"line":5,"column":70}},"5":{"start":{"line":6,"column":2},"end":{"line":6,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":1,"column":48},"end":{"line":1,"column":49}},"loc":{"start":{"line":1,"column":72},"end":{"line":7,"column":1}},"line":1}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":3},"end":{"line":7,"column":26}},"type":"binary-expr","locations":[{"start":{"line":7,"column":3},"end":{"line":7,"column":20}},{"start":{"line":7,"column":24},"end":{"line":7,"column":26}}],"line":7}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1},"f":{"0":1},"b":{"0":[1,1]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/type.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface ISelectionManagerSearchParam {\n    unitId: string;\n    sheetId: string;\n}\n\nexport enum SelectionMoveType {\n    MOVE_START,\n    MOVING,\n    MOVE_END,\n    /**\n     * Events are not triggered by cursor movement\n     */\n    ONLY_SET,\n}\n"],"mappings":"AAqBO,WAAK,oBAAL,kBAAKA,uBAAL;AACH,EAAAA,sCAAA;AACA,EAAAA,sCAAA;AACA,EAAAA,sCAAA;AAIA,EAAAA,sCAAA;AAPQ,SAAAA;AAAA,GAAA;","names":["SelectionMoveType"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"51f6428312fde8c31d809a38f0c341bd74784748"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/selection-data-model.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/selection-data-model.ts","statementMap":{"0":{"start":{"line":6,"column":4},"end":{"line":6,"column":12}},"1":{"start":{"line":7,"column":4},"end":{"line":7,"column":31}},"2":{"start":{"line":8,"column":4},"end":{"line":8,"column":81}},"3":{"start":{"line":13,"column":41},"end":{"line":13,"column":50}},"4":{"start":{"line":14,"column":25},"end":{"line":14,"column":38}},"5":{"start":{"line":15,"column":24},"end":{"line":15,"column":64}},"6":{"start":{"line":16,"column":22},"end":{"line":16,"column":35}},"7":{"start":{"line":17,"column":21},"end":{"line":17,"column":58}},"8":{"start":{"line":18,"column":23},"end":{"line":18,"column":46}},"9":{"start":{"line":19,"column":22},"end":{"line":19,"column":60}},"10":{"start":{"line":20,"column":19},"end":{"line":20,"column":42}},"11":{"start":{"line":21,"column":18},"end":{"line":21,"column":52}},"12":{"start":{"line":23,"column":29},"end":{"line":23,"column":52}},"13":{"start":{"line":24,"column":28},"end":{"line":24,"column":72}},"14":{"start":{"line":26,"column":4},"end":{"line":26,"column":20}},"15":{"start":{"line":27,"column":4},"end":{"line":27,"column":45}},"16":{"start":{"line":28,"column":4},"end":{"line":28,"column":39}},"17":{"start":{"line":29,"column":4},"end":{"line":29,"column":38}},"18":{"start":{"line":30,"column":4},"end":{"line":30,"column":41}},"19":{"start":{"line":31,"column":4},"end":{"line":31,"column":35}},"20":{"start":{"line":34,"column":23},"end":{"line":34,"column":61}},"21":{"start":{"line":35,"column":4},"end":{"line":35,"column":39}},"22":{"start":{"line":36,"column":4},"end":{"line":36,"column":41}},"23":{"start":{"line":45,"column":4},"end":{"line":45,"column":59}},"24":{"start":{"line":46,"column":4},"end":{"line":64,"column":5}},"25":{"start":{"line":48,"column":8},"end":{"line":48,"column":55}},"26":{"start":{"line":49,"column":8},"end":{"line":49,"column":14}},"27":{"start":{"line":51,"column":8},"end":{"line":51,"column":52}},"28":{"start":{"line":52,"column":8},"end":{"line":52,"column":14}},"29":{"start":{"line":54,"column":8},"end":{"line":54,"column":59}},"30":{"start":{"line":55,"column":8},"end":{"line":55,"column":53}},"31":{"start":{"line":56,"column":8},"end":{"line":56,"column":14}},"32":{"start":{"line":58,"column":8},"end":{"line":58,"column":49}},"33":{"start":{"line":59,"column":8},"end":{"line":59,"column":14}},"34":{"start":{"line":62,"column":8},"end":{"line":62,"column":49}},"35":{"start":{"line":63,"column":8},"end":{"line":63,"column":14}},"36":{"start":{"line":67,"column":4},"end":{"line":67,"column":40}},"37":{"start":{"line":75,"column":4},"end":{"line":75,"column":50}},"38":{"start":{"line":78,"column":4},"end":{"line":80,"column":5}},"39":{"start":{"line":79,"column":6},"end":{"line":79,"column":49}},"40":{"start":{"line":81,"column":4},"end":{"line":81,"column":50}},"41":{"start":{"line":84,"column":4},"end":{"line":84,"column":60}},"42":{"start":{"line":87,"column":4},"end":{"line":87,"column":47}},"43":{"start":{"line":91,"column":4},"end":{"line":91,"column":38}},"44":{"start":{"line":92,"column":4},"end":{"line":92,"column":33}},"45":{"start":{"line":95,"column":4},"end":{"line":95,"column":87}},"46":{"start":{"line":98,"column":26},"end":{"line":98,"column":54}},"47":{"start":{"line":99,"column":4},"end":{"line":99,"column":51}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":2},"end":{"line":5,"column":3}},"loc":{"start":{"line":5,"column":25},"end":{"line":9,"column":3}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":25,"column":2},"end":{"line":25,"column":3}},"loc":{"start":{"line":25,"column":12},"end":{"line":32,"column":3}},"line":25},"2":{"name":"(anonymous_2)","decl":{"start":{"line":33,"column":2},"end":{"line":33,"column":3}},"loc":{"start":{"line":33,"column":41},"end":{"line":37,"column":3}},"line":33},"3":{"name":"(anonymous_3)","decl":{"start":{"line":44,"column":2},"end":{"line":44,"column":3}},"loc":{"start":{"line":44,"column":52},"end":{"line":65,"column":3}},"line":44},"4":{"name":"(anonymous_4)","decl":{"start":{"line":66,"column":2},"end":{"line":66,"column":3}},"loc":{"start":{"line":66,"column":25},"end":{"line":68,"column":3}},"line":66},"5":{"name":"(anonymous_5)","decl":{"start":{"line":74,"column":2},"end":{"line":74,"column":3}},"loc":{"start":{"line":74,"column":35},"end":{"line":76,"column":3}},"line":74},"6":{"name":"(anonymous_6)","decl":{"start":{"line":77,"column":2},"end":{"line":77,"column":3}},"loc":{"start":{"line":77,"column":36},"end":{"line":82,"column":3}},"line":77},"7":{"name":"(anonymous_7)","decl":{"start":{"line":83,"column":2},"end":{"line":83,"column":3}},"loc":{"start":{"line":83,"column":48},"end":{"line":85,"column":3}},"line":83},"8":{"name":"(anonymous_8)","decl":{"start":{"line":86,"column":2},"end":{"line":86,"column":3}},"loc":{"start":{"line":86,"column":32},"end":{"line":88,"column":3}},"line":86},"9":{"name":"(anonymous_9)","decl":{"start":{"line":90,"column":2},"end":{"line":90,"column":3}},"loc":{"start":{"line":90,"column":10},"end":{"line":93,"column":3}},"line":90},"10":{"name":"(anonymous_10)","decl":{"start":{"line":94,"column":2},"end":{"line":94,"column":3}},"loc":{"start":{"line":94,"column":26},"end":{"line":96,"column":3}},"line":94},"11":{"name":"(anonymous_11)","decl":{"start":{"line":97,"column":2},"end":{"line":97,"column":3}},"loc":{"start":{"line":97,"column":28},"end":{"line":100,"column":3}},"line":97}},"branchMap":{"0":{"loc":{"start":{"line":44,"column":25},"end":{"line":44,"column":44}},"type":"default-arg","locations":[{"start":{"line":44,"column":42},"end":{"line":44,"column":44}}],"line":44},"1":{"loc":{"start":{"line":46,"column":4},"end":{"line":64,"column":5}},"type":"switch","locations":[{"start":{"line":47,"column":6},"end":{"line":49,"column":14}},{"start":{"line":50,"column":6},"end":{"line":52,"column":14}},{"start":{"line":53,"column":6},"end":{"line":56,"column":14}},{"start":{"line":57,"column":6},"end":{"line":60,"column":7}},{"start":{"line":61,"column":6},"end":{"line":63,"column":14}}],"line":46},"2":{"loc":{"start":{"line":78,"column":4},"end":{"line":80,"column":5}},"type":"if","locations":[{"start":{"line":78,"column":4},"end":{"line":80,"column":5}},{"start":{},"end":{}}],"line":78}},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5,"7":5,"8":5,"9":5,"10":5,"11":5,"12":5,"13":5,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":10,"21":10,"22":10,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":14,"39":5,"40":14,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0},"f":{"0":5,"1":0,"2":10,"3":0,"4":0,"5":0,"6":14,"7":0,"8":0,"9":0,"10":0,"11":0},"b":{"0":[0],"1":[0,0,0,0,0],"2":[5,9]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/selection-data-model.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ISelectionCell, Nullable, Workbook } from '@univerjs/core';\nimport type { Observable } from 'rxjs';\nimport type { ISelectionWithStyle } from '../../basics/selection';\n\nimport { Disposable } from '@univerjs/core';\nimport { BehaviorSubject, merge, Subject } from 'rxjs';\nimport { SelectionMoveType } from './type';\n\n/**\n * Origin name: WorkbookSelections\n * NOT Same as @univerjs/sheets-ui.SelectionRenderModel, that's data for SelectionControl in rendering.\n */\nexport class WorkbookSelectionModel extends Disposable {\n    /**\n     * Selection data model for each worksheet.\n     */\n    private _worksheetSelections = new Map<string, ISelectionWithStyle[]>();\n\n    private readonly _selectionMoveStart$ = new Subject<Nullable<ISelectionWithStyle[]>>();\n    readonly selectionMoveStart$ = this._selectionMoveStart$.asObservable();\n\n    private readonly _selectionMoving$ = new Subject<Nullable<ISelectionWithStyle[]>>();\n    readonly selectionMoving$ = this._selectionMoving$.asObservable();\n\n    readonly _selectionMoveEnd$ = new BehaviorSubject<ISelectionWithStyle[]>([]);\n    readonly selectionMoveEnd$ = this._selectionMoveEnd$.asObservable();\n\n    private readonly _selectionSet$ = new BehaviorSubject<ISelectionWithStyle[]>([]);\n    readonly selectionSet$ = this._selectionSet$.asObservable();\n\n    selectionChanged$: Observable<ISelectionWithStyle[]>;\n\n    private readonly _beforeSelectionMoveEnd$ = new BehaviorSubject<ISelectionWithStyle[]>([]);\n    readonly beforeSelectionMoveEnd$ = this._beforeSelectionMoveEnd$.asObservable();\n\n    constructor(\n        private readonly _workbook: Workbook\n    ) {\n        super();\n        this.selectionChanged$ = merge(this._selectionMoveEnd$, this._selectionSet$);\n    }\n\n    override dispose(): void {\n        super.dispose();\n\n        this._beforeSelectionMoveEnd$.complete();\n        this._selectionMoveEnd$.complete();\n        this._selectionMoving$.complete();\n        this._selectionMoveStart$.complete();\n        this._selectionSet$.complete();\n    }\n\n    addSelections(sheetId: string, selectionDatas: ISelectionWithStyle[]): void {\n        const selections = this.getSelectionsOfWorksheet(sheetId);\n        selections.push(...selectionDatas);\n        this._selectionSet$.next(selections);\n    }\n\n    /**\n     * Set selectionDatas to _worksheetSelections, and emit selectionDatas by type.\n     * @param sheetId\n     * @param selectionDatas\n     * @param type\n     */\n    setSelections(sheetId: string, selectionDatas: ISelectionWithStyle[] = [], type: SelectionMoveType): void {\n        // selectionDatas should not be same variable as this._worksheetSelections !!!\n        // but there are some place get selection from this._worksheetSelections and set selectionDatas(2nd parameter of this function ) cause selectionDatas is always []\n        // see univer/pull/2909\n        // this.deleteSheetSelection(sheetId);\n        this.setSelectionsOfWorksheet(sheetId, selectionDatas);\n\n        switch (type) {\n            case SelectionMoveType.MOVE_START:\n                this._selectionMoveStart$.next(selectionDatas);\n                break;\n            case SelectionMoveType.MOVING:\n                this._selectionMoving$.next(selectionDatas);\n                break;\n            case SelectionMoveType.MOVE_END:\n                this._beforeSelectionMoveEnd$.next(selectionDatas);\n                this._selectionMoveEnd$.next(selectionDatas);\n                break;\n            case SelectionMoveType.ONLY_SET: {\n                this._selectionSet$.next(selectionDatas);\n                break;\n            }\n            default:\n                this._selectionSet$.next(selectionDatas);\n                break;\n        }\n    }\n\n    getCurrentSelections(): Readonly<ISelectionWithStyle[]> {\n        return this._getCurrentSelections();\n    }\n\n    /**\n     * @deprecated use `getSelectionsOfWorksheet` instead.\n     * @param sheetId\n     * @returns\n     */\n    getSelectionOfWorksheet(sheetId: string): ISelectionWithStyle[] {\n        return this.getSelectionsOfWorksheet(sheetId);\n    }\n\n    getSelectionsOfWorksheet(sheetId: string): ISelectionWithStyle[] {\n        if (!this._worksheetSelections.has(sheetId)) {\n            this._worksheetSelections.set(sheetId, []);\n        }\n\n        return this._worksheetSelections.get(sheetId)!;\n    }\n\n    setSelectionsOfWorksheet(sheetId: string, selections: ISelectionWithStyle[]): void {\n        this._worksheetSelections.set(sheetId, [...selections]);\n    }\n\n    deleteSheetSelection(sheetId: string) {\n        this._worksheetSelections.set(sheetId, []);\n    }\n\n    /** Clear all selections in this workbook. */\n    clear(): void {\n        this._worksheetSelections.clear();\n        this._selectionSet$.next([]);\n    }\n\n    private _getCurrentSelections(): ISelectionWithStyle[] {\n        return this.getSelectionsOfWorksheet(this._workbook.getActiveSheet()!.getSheetId());\n    }\n\n    getCurrentLastSelection(): Readonly<Nullable<ISelectionWithStyle & { primary: ISelectionCell }>> {\n        const selectionData = this._getCurrentSelections();\n        return selectionData[selectionData.length - 1] as Readonly<Nullable<ISelectionWithStyle & { primary: ISelectionCell }>>;\n    }\n}\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d65e983a192a7b520ce26d3bfaa6187256b3ed7c"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/selection.service.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/selection.service.ts","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":37}},"1":{"start":{"line":2,"column":23},"end":{"line":2,"column":54}},"2":{"start":{"line":3,"column":22},"end":{"line":10,"column":1}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"4":{"start":{"line":5,"column":2},"end":{"line":7,"column":85}},"5":{"start":{"line":5,"column":15},"end":{"line":5,"column":36}},"6":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"7":{"start":{"line":7,"column":6},"end":{"line":7,"column":85}},"8":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"9":{"start":{"line":8,"column":22},"end":{"line":8,"column":53}},"10":{"start":{"line":9,"column":2},"end":{"line":9,"column":16}},"11":{"start":{"line":11,"column":22},"end":{"line":11,"column":90}},"12":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"13":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"14":{"start":{"line":16,"column":37},"end":{"line":168,"column":1}},"15":{"start":{"line":18,"column":4},"end":{"line":18,"column":12}},"16":{"start":{"line":19,"column":4},"end":{"line":19,"column":37}},"17":{"start":{"line":20,"column":4},"end":{"line":20,"column":17}},"18":{"start":{"line":23,"column":21},"end":{"line":23,"column":93}},"19":{"start":{"line":24,"column":4},"end":{"line":24,"column":31}},"20":{"start":{"line":24,"column":19},"end":{"line":24,"column":31}},"21":{"start":{"line":25,"column":22},"end":{"line":25,"column":47}},"22":{"start":{"line":26,"column":4},"end":{"line":26,"column":77}},"23":{"start":{"line":29,"column":4},"end":{"line":29,"column":37}},"24":{"start":{"line":52,"column":15},"end":{"line":52,"column":134}},"25":{"start":{"line":53,"column":4},"end":{"line":53,"column":156}},"26":{"start":{"line":53,"column":63},"end":{"line":53,"column":153}},"27":{"start":{"line":54,"column":4},"end":{"line":54,"column":150}},"28":{"start":{"line":54,"column":60},"end":{"line":54,"column":147}},"29":{"start":{"line":55,"column":4},"end":{"line":55,"column":154}},"30":{"start":{"line":55,"column":61},"end":{"line":55,"column":151}},"31":{"start":{"line":56,"column":4},"end":{"line":56,"column":146}},"32":{"start":{"line":56,"column":57},"end":{"line":56,"column":143}},"33":{"start":{"line":57,"column":4},"end":{"line":66,"column":6}},"34":{"start":{"line":57,"column":61},"end":{"line":57,"column":151}},"35":{"start":{"line":59,"column":8},"end":{"line":59,"column":54}},"36":{"start":{"line":59,"column":41},"end":{"line":59,"column":54}},"37":{"start":{"line":60,"column":8},"end":{"line":60,"column":64}},"38":{"start":{"line":60,"column":52},"end":{"line":60,"column":64}},"39":{"start":{"line":61,"column":8},"end":{"line":63,"column":11}},"40":{"start":{"line":62,"column":10},"end":{"line":62,"column":70}},"41":{"start":{"line":67,"column":4},"end":{"line":69,"column":7}},"42":{"start":{"line":68,"column":6},"end":{"line":68,"column":58}},"43":{"start":{"line":76,"column":4},"end":{"line":76,"column":75}},"44":{"start":{"line":76,"column":54},"end":{"line":76,"column":73}},"45":{"start":{"line":79,"column":4},"end":{"line":79,"column":40}},"46":{"start":{"line":82,"column":26},"end":{"line":82,"column":54}},"47":{"start":{"line":83,"column":4},"end":{"line":83,"column":53}},"48":{"start":{"line":86,"column":4},"end":{"line":89,"column":5}},"49":{"start":{"line":87,"column":6},"end":{"line":87,"column":99}},"50":{"start":{"line":88,"column":6},"end":{"line":88,"column":13}},"51":{"start":{"line":90,"column":20},"end":{"line":90,"column":45}},"52":{"start":{"line":91,"column":4},"end":{"line":93,"column":5}},"53":{"start":{"line":92,"column":6},"end":{"line":92,"column":92}},"54":{"start":{"line":94,"column":32},"end":{"line":94,"column":39}},"55":{"start":{"line":95,"column":4},"end":{"line":95,"column":85}},"56":{"start":{"line":98,"column":4},"end":{"line":106,"column":5}},"57":{"start":{"line":99,"column":22},"end":{"line":99,"column":40}},"58":{"start":{"line":100,"column":6},"end":{"line":104,"column":8}},"59":{"start":{"line":105,"column":6},"end":{"line":105,"column":13}},"60":{"start":{"line":107,"column":20},"end":{"line":107,"column":45}},"61":{"start":{"line":108,"column":4},"end":{"line":110,"column":5}},"62":{"start":{"line":109,"column":6},"end":{"line":109,"column":92}},"63":{"start":{"line":111,"column":32},"end":{"line":111,"column":39}},"64":{"start":{"line":112,"column":4},"end":{"line":116,"column":5}},"65":{"start":{"line":113,"column":28},"end":{"line":113,"column":64}},"66":{"start":{"line":114,"column":20},"end":{"line":114,"column":67}},"67":{"start":{"line":115,"column":6},"end":{"line":115,"column":89}},"68":{"start":{"line":119,"column":26},"end":{"line":119,"column":54}},"69":{"start":{"line":120,"column":4},"end":{"line":120,"column":28}},"70":{"start":{"line":128,"column":30},"end":{"line":128,"column":57}},"71":{"start":{"line":129,"column":4},"end":{"line":131,"column":5}},"72":{"start":{"line":130,"column":6},"end":{"line":130,"column":19}},"73":{"start":{"line":132,"column":4},"end":{"line":139,"column":6}},"74":{"start":{"line":133,"column":28},"end":{"line":138,"column":8}},"75":{"start":{"line":134,"column":8},"end":{"line":136,"column":9}},"76":{"start":{"line":135,"column":10},"end":{"line":135,"column":23}},"77":{"start":{"line":137,"column":8},"end":{"line":137,"column":164}},"78":{"start":{"line":142,"column":20},"end":{"line":142,"column":45}},"79":{"start":{"line":143,"column":4},"end":{"line":145,"column":5}},"80":{"start":{"line":144,"column":6},"end":{"line":144,"column":16}},"81":{"start":{"line":146,"column":32},"end":{"line":146,"column":39}},"82":{"start":{"line":147,"column":4},"end":{"line":147,"column":83}},"83":{"start":{"line":150,"column":4},"end":{"line":150,"column":49}},"84":{"start":{"line":152,"column":40},"end":{"line":152,"column":49}},"85":{"start":{"line":154,"column":22},"end":{"line":154,"column":58}},"86":{"start":{"line":155,"column":4},"end":{"line":162,"column":5}},"87":{"start":{"line":156,"column":23},"end":{"line":156,"column":56}},"88":{"start":{"line":157,"column":6},"end":{"line":159,"column":7}},"89":{"start":{"line":158,"column":8},"end":{"line":158,"column":95}},"90":{"start":{"line":160,"column":6},"end":{"line":160,"column":57}},"91":{"start":{"line":161,"column":6},"end":{"line":161,"column":56}},"92":{"start":{"line":163,"column":4},"end":{"line":163,"column":23}},"93":{"start":{"line":166,"column":4},"end":{"line":166,"column":44}},"94":{"start":{"line":169,"column":0},"end":{"line":171,"column":28}},"95":{"start":{"line":172,"column":41},"end":{"line":172,"column":68}},"96":{"start":{"line":173,"column":34},"end":{"line":173,"column":54}},"97":{"start":{"line":174,"column":38},"end":{"line":174,"column":62}},"98":{"start":{"line":175,"column":30},"end":{"line":175,"column":50}},"99":{"start":{"line":176,"column":43},"end":{"line":180,"column":23}},"100":{"start":{"line":177,"column":2},"end":{"line":177,"column":58}},"101":{"start":{"line":178,"column":2},"end":{"line":178,"column":52}},"102":{"start":{"line":179,"column":2},"end":{"line":179,"column":24}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":22},"end":{"line":3,"column":23}},"loc":{"start":{"line":3,"column":57},"end":{"line":10,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":44},"end":{"line":11,"column":45}},"loc":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":17,"column":2},"end":{"line":17,"column":3}},"loc":{"start":{"line":17,"column":28},"end":{"line":21,"column":3}},"line":17},"4":{"name":"(anonymous_4)","decl":{"start":{"line":22,"column":2},"end":{"line":22,"column":3}},"loc":{"start":{"line":22,"column":29},"end":{"line":27,"column":3}},"line":22},"5":{"name":"(anonymous_5)","decl":{"start":{"line":28,"column":2},"end":{"line":28,"column":3}},"loc":{"start":{"line":28,"column":30},"end":{"line":30,"column":3}},"line":28},"6":{"name":"(anonymous_6)","decl":{"start":{"line":51,"column":2},"end":{"line":51,"column":3}},"loc":{"start":{"line":51,"column":10},"end":{"line":70,"column":3}},"line":51},"7":{"name":"(anonymous_7)","decl":{"start":{"line":53,"column":49},"end":{"line":53,"column":50}},"loc":{"start":{"line":53,"column":63},"end":{"line":53,"column":153}},"line":53},"8":{"name":"(anonymous_8)","decl":{"start":{"line":54,"column":46},"end":{"line":54,"column":47}},"loc":{"start":{"line":54,"column":60},"end":{"line":54,"column":147}},"line":54},"9":{"name":"(anonymous_9)","decl":{"start":{"line":55,"column":47},"end":{"line":55,"column":48}},"loc":{"start":{"line":55,"column":61},"end":{"line":55,"column":151}},"line":55},"10":{"name":"(anonymous_10)","decl":{"start":{"line":56,"column":43},"end":{"line":56,"column":44}},"loc":{"start":{"line":56,"column":57},"end":{"line":56,"column":143}},"line":56},"11":{"name":"(anonymous_11)","decl":{"start":{"line":57,"column":47},"end":{"line":57,"column":48}},"loc":{"start":{"line":57,"column":61},"end":{"line":57,"column":151}},"line":57},"12":{"name":"(anonymous_12)","decl":{"start":{"line":58,"column":27},"end":{"line":58,"column":28}},"loc":{"start":{"line":58,"column":43},"end":{"line":64,"column":7}},"line":58},"13":{"name":"(anonymous_13)","decl":{"start":{"line":61,"column":26},"end":{"line":61,"column":27}},"loc":{"start":{"line":61,"column":43},"end":{"line":63,"column":9}},"line":61},"14":{"name":"(anonymous_14)","decl":{"start":{"line":67,"column":119},"end":{"line":67,"column":120}},"loc":{"start":{"line":67,"column":133},"end":{"line":69,"column":5}},"line":67},"15":{"name":"(anonymous_15)","decl":{"start":{"line":75,"column":2},"end":{"line":75,"column":3}},"loc":{"start":{"line":75,"column":10},"end":{"line":77,"column":3}},"line":75},"16":{"name":"(anonymous_16)","decl":{"start":{"line":76,"column":37},"end":{"line":76,"column":38}},"loc":{"start":{"line":76,"column":54},"end":{"line":76,"column":73}},"line":76},"17":{"name":"(anonymous_17)","decl":{"start":{"line":78,"column":2},"end":{"line":78,"column":3}},"loc":{"start":{"line":78,"column":25},"end":{"line":80,"column":3}},"line":78},"18":{"name":"(anonymous_18)","decl":{"start":{"line":81,"column":2},"end":{"line":81,"column":3}},"loc":{"start":{"line":81,"column":28},"end":{"line":84,"column":3}},"line":81},"19":{"name":"(anonymous_19)","decl":{"start":{"line":85,"column":2},"end":{"line":85,"column":3}},"loc":{"start":{"line":85,"column":65},"end":{"line":96,"column":3}},"line":85},"20":{"name":"(anonymous_20)","decl":{"start":{"line":97,"column":2},"end":{"line":97,"column":3}},"loc":{"start":{"line":97,"column":77},"end":{"line":117,"column":3}},"line":97},"21":{"name":"(anonymous_21)","decl":{"start":{"line":118,"column":2},"end":{"line":118,"column":3}},"loc":{"start":{"line":118,"column":27},"end":{"line":121,"column":3}},"line":118},"22":{"name":"(anonymous_22)","decl":{"start":{"line":127,"column":2},"end":{"line":127,"column":3}},"loc":{"start":{"line":127,"column":18},"end":{"line":140,"column":3}},"line":127},"23":{"name":"(anonymous_23)","decl":{"start":{"line":133,"column":6},"end":{"line":133,"column":7}},"loc":{"start":{"line":133,"column":28},"end":{"line":138,"column":8}},"line":133},"24":{"name":"(anonymous_24)","decl":{"start":{"line":133,"column":51},"end":{"line":133,"column":52}},"loc":{"start":{"line":133,"column":82},"end":{"line":138,"column":7}},"line":133},"25":{"name":"(anonymous_25)","decl":{"start":{"line":141,"column":2},"end":{"line":141,"column":3}},"loc":{"start":{"line":141,"column":26},"end":{"line":148,"column":3}},"line":141},"26":{"name":"(anonymous_26)","decl":{"start":{"line":149,"column":2},"end":{"line":149,"column":3}},"loc":{"start":{"line":149,"column":32},"end":{"line":151,"column":3}},"line":149},"27":{"name":"(anonymous_27)","decl":{"start":{"line":153,"column":2},"end":{"line":153,"column":3}},"loc":{"start":{"line":153,"column":35},"end":{"line":164,"column":3}},"line":153},"28":{"name":"(anonymous_28)","decl":{"start":{"line":165,"column":2},"end":{"line":165,"column":3}},"loc":{"start":{"line":165,"column":35},"end":{"line":167,"column":3}},"line":165},"29":{"name":"(anonymous_29)","decl":{"start":{"line":176,"column":44},"end":{"line":176,"column":45}},"loc":{"start":{"line":176,"column":64},"end":{"line":180,"column":1}},"line":176}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":26},"end":{"line":4,"column":32}},{"start":{"line":4,"column":35},"end":{"line":4,"column":80}}],"line":4},"1":{"loc":{"start":{"line":4,"column":35},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":42},"end":{"line":4,"column":71}},{"start":{"line":4,"column":74},"end":{"line":4,"column":80}}],"line":4},"2":{"loc":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"type":"if","locations":[{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},{"start":{},"end":{}}],"line":6},"3":{"loc":{"start":{"line":7,"column":15},"end":{"line":7,"column":84}},"type":"binary-expr","locations":[{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},{"start":{"line":7,"column":78},"end":{"line":7,"column":84}}],"line":7},"4":{"loc":{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},"type":"cond-expr","locations":[{"start":{"line":7,"column":23},"end":{"line":7,"column":53}},{"start":{"line":7,"column":56},"end":{"line":7,"column":73}}],"line":7},"5":{"loc":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},{"start":{},"end":{}}],"line":8},"6":{"loc":{"start":{"line":8,"column":6},"end":{"line":8,"column":20}},"type":"binary-expr","locations":[{"start":{"line":8,"column":6},"end":{"line":8,"column":10}},{"start":{"line":8,"column":14},"end":{"line":8,"column":20}}],"line":8},"7":{"loc":{"start":{"line":24,"column":4},"end":{"line":24,"column":31}},"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":24,"column":31}},{"start":{},"end":{}}],"line":24},"8":{"loc":{"start":{"line":53,"column":63},"end":{"line":53,"column":153}},"type":"cond-expr","locations":[{"start":{"line":53,"column":75},"end":{"line":53,"column":79}},{"start":{"line":53,"column":82},"end":{"line":53,"column":153}}],"line":53},"9":{"loc":{"start":{"line":54,"column":60},"end":{"line":54,"column":147}},"type":"cond-expr","locations":[{"start":{"line":54,"column":72},"end":{"line":54,"column":76}},{"start":{"line":54,"column":79},"end":{"line":54,"column":147}}],"line":54},"10":{"loc":{"start":{"line":55,"column":61},"end":{"line":55,"column":151}},"type":"cond-expr","locations":[{"start":{"line":55,"column":73},"end":{"line":55,"column":79}},{"start":{"line":55,"column":82},"end":{"line":55,"column":151}}],"line":55},"11":{"loc":{"start":{"line":56,"column":57},"end":{"line":56,"column":143}},"type":"cond-expr","locations":[{"start":{"line":56,"column":69},"end":{"line":56,"column":75}},{"start":{"line":56,"column":78},"end":{"line":56,"column":143}}],"line":56},"12":{"loc":{"start":{"line":57,"column":61},"end":{"line":57,"column":151}},"type":"cond-expr","locations":[{"start":{"line":57,"column":73},"end":{"line":57,"column":79}},{"start":{"line":57,"column":82},"end":{"line":57,"column":151}}],"line":57},"13":{"loc":{"start":{"line":59,"column":8},"end":{"line":59,"column":54}},"type":"if","locations":[{"start":{"line":59,"column":8},"end":{"line":59,"column":54}},{"start":{},"end":{}}],"line":59},"14":{"loc":{"start":{"line":60,"column":8},"end":{"line":60,"column":64}},"type":"if","locations":[{"start":{"line":60,"column":8},"end":{"line":60,"column":64}},{"start":{},"end":{}}],"line":60},"15":{"loc":{"start":{"line":60,"column":12},"end":{"line":60,"column":50}},"type":"binary-expr","locations":[{"start":{"line":60,"column":12},"end":{"line":60,"column":29}},{"start":{"line":60,"column":33},"end":{"line":60,"column":50}}],"line":60},"16":{"loc":{"start":{"line":86,"column":4},"end":{"line":89,"column":5}},"type":"if","locations":[{"start":{"line":86,"column":4},"end":{"line":89,"column":5}},{"start":{},"end":{}}],"line":86},"17":{"loc":{"start":{"line":91,"column":4},"end":{"line":93,"column":5}},"type":"if","locations":[{"start":{"line":91,"column":4},"end":{"line":93,"column":5}},{"start":{},"end":{}}],"line":91},"18":{"loc":{"start":{"line":98,"column":4},"end":{"line":106,"column":5}},"type":"if","locations":[{"start":{"line":98,"column":4},"end":{"line":106,"column":5}},{"start":{},"end":{}}],"line":98},"19":{"loc":{"start":{"line":98,"column":8},"end":{"line":98,"column":87}},"type":"binary-expr","locations":[{"start":{"line":98,"column":8},"end":{"line":98,"column":46}},{"start":{"line":98,"column":50},"end":{"line":98,"column":87}}],"line":98},"20":{"loc":{"start":{"line":102,"column":8},"end":{"line":102,"column":28}},"type":"binary-expr","locations":[{"start":{"line":102,"column":8},"end":{"line":102,"column":22}},{"start":{"line":102,"column":26},"end":{"line":102,"column":28}}],"line":102},"21":{"loc":{"start":{"line":103,"column":8},"end":{"line":103,"column":42}},"type":"binary-expr","locations":[{"start":{"line":103,"column":8},"end":{"line":103,"column":12}},{"start":{"line":103,"column":16},"end":{"line":103,"column":42}}],"line":103},"22":{"loc":{"start":{"line":108,"column":4},"end":{"line":110,"column":5}},"type":"if","locations":[{"start":{"line":108,"column":4},"end":{"line":110,"column":5}},{"start":{},"end":{}}],"line":108},"23":{"loc":{"start":{"line":112,"column":4},"end":{"line":116,"column":5}},"type":"if","locations":[{"start":{"line":112,"column":4},"end":{"line":116,"column":5}},{"start":{},"end":{}}],"line":112},"24":{"loc":{"start":{"line":113,"column":28},"end":{"line":113,"column":64}},"type":"binary-expr","locations":[{"start":{"line":113,"column":28},"end":{"line":113,"column":46}},{"start":{"line":113,"column":50},"end":{"line":113,"column":64}}],"line":113},"25":{"loc":{"start":{"line":114,"column":20},"end":{"line":114,"column":67}},"type":"binary-expr","locations":[{"start":{"line":114,"column":20},"end":{"line":114,"column":37}},{"start":{"line":114,"column":41},"end":{"line":114,"column":67}}],"line":114},"26":{"loc":{"start":{"line":129,"column":4},"end":{"line":131,"column":5}},"type":"if","locations":[{"start":{"line":129,"column":4},"end":{"line":131,"column":5}},{"start":{},"end":{}}],"line":129},"27":{"loc":{"start":{"line":134,"column":8},"end":{"line":136,"column":9}},"type":"if","locations":[{"start":{"line":134,"column":8},"end":{"line":136,"column":9}},{"start":{},"end":{}}],"line":134},"28":{"loc":{"start":{"line":137,"column":15},"end":{"line":137,"column":163}},"type":"binary-expr","locations":[{"start":{"line":137,"column":15},"end":{"line":137,"column":46}},{"start":{"line":137,"column":50},"end":{"line":137,"column":81}},{"start":{"line":137,"column":85},"end":{"line":137,"column":122}},{"start":{"line":137,"column":126},"end":{"line":137,"column":163}}],"line":137},"29":{"loc":{"start":{"line":143,"column":4},"end":{"line":145,"column":5}},"type":"if","locations":[{"start":{"line":143,"column":4},"end":{"line":145,"column":5}},{"start":{},"end":{}}],"line":143},"30":{"loc":{"start":{"line":155,"column":4},"end":{"line":162,"column":5}},"type":"if","locations":[{"start":{"line":155,"column":4},"end":{"line":162,"column":5}},{"start":{},"end":{}}],"line":155},"31":{"loc":{"start":{"line":157,"column":6},"end":{"line":159,"column":7}},"type":"if","locations":[{"start":{"line":157,"column":6},"end":{"line":159,"column":7}},{"start":{},"end":{}}],"line":157},"32":{"loc":{"start":{"line":180,"column":3},"end":{"line":180,"column":22}},"type":"binary-expr","locations":[{"start":{"line":180,"column":3},"end":{"line":180,"column":16}},{"start":{"line":180,"column":20},"end":{"line":180,"column":22}}],"line":180}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1,"11":1,"12":1,"13":1,"14":1,"15":5,"16":5,"17":5,"18":14,"19":14,"20":0,"21":14,"22":14,"23":0,"24":5,"25":5,"26":0,"27":5,"28":0,"29":5,"30":0,"31":5,"32":0,"33":5,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":5,"42":0,"43":0,"44":0,"45":4,"46":0,"47":0,"48":10,"49":0,"50":0,"51":10,"52":10,"53":0,"54":10,"55":10,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":4,"79":4,"80":0,"81":4,"82":4,"83":0,"84":5,"85":14,"86":14,"87":5,"88":5,"89":0,"90":5,"91":5,"92":14,"93":0,"94":1,"95":1,"96":1,"97":1,"98":1,"99":1,"100":1,"101":1,"102":1},"f":{"0":1,"1":1,"2":1,"3":5,"4":14,"5":0,"6":5,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":4,"18":0,"19":10,"20":0,"21":0,"22":0,"23":0,"24":0,"25":4,"26":0,"27":14,"28":0,"29":1},"b":{"0":[0,1],"1":[0,1],"2":[1,0],"3":[1,1],"4":[0,1],"5":[0,1],"6":[1,0],"7":[0,14],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,10],"17":[0,10],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0,0,0],"29":[0,4],"30":[5,9],"31":[0,5],"32":[1,1]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/selection.service.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { DeepReadonly, ISelectionCell, Nullable, Workbook } from '@univerjs/core';\nimport type { Observable } from 'rxjs';\nimport type { ISelectionWithStyle } from '../../basics/selection';\nimport type { ISelectionManagerSearchParam } from './type';\n\nimport { IUniverInstanceService, RxDisposable, UniverInstanceType } from '@univerjs/core';\nimport { distinctUntilChanged, of, shareReplay, skip, switchMap, takeUntil } from 'rxjs';\nimport { WorkbookSelectionModel } from './selection-data-model';\nimport { SelectionMoveType } from './type';\n\n/**\n * For normal selection.\n * Ref selection is in RefSelectionService which extends this class.\n */\nexport class SheetsSelectionsService extends RxDisposable {\n    private get _currentSelectionPos(): Nullable<ISelectionManagerSearchParam> {\n        const workbook = this._instanceSrv.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        if (!workbook) return null;\n\n        const worksheet = workbook.getActiveSheet();\n        return { unitId: workbook.getUnitId(), sheetId: worksheet.getSheetId() };\n    }\n\n    get currentSelectionParam() {\n        return this._currentSelectionPos;\n    }\n\n    /**\n     * Selection Events, usually triggered when pointerdown in spreadsheet by selection render service after selectionModel has updated.\n     */\n    selectionMoveStart$: Observable<Nullable<ISelectionWithStyle[]>>;\n\n    /**\n     * Selection Events, usually triggered when pointermove in spreadsheet by selection render service after selectionModel has updated.\n     */\n    selectionMoving$: Observable<Nullable<ISelectionWithStyle[]>>;\n\n    /**\n     * Selection Events, usually triggered when pointerup in spreadsheet by selection render service after selectionModel has updated.\n     */\n    selectionMoveEnd$: Observable<ISelectionWithStyle[]>;\n\n    /**\n     * Selection Events, usually triggered when changing unit.(focus in formula editor)\n     */\n    selectionSet$: Observable<Nullable<ISelectionWithStyle[]>>;\n\n    /**\n     * Selection Events, merge moveEnd$ and selectionSet$\n     */\n    selectionChanged$: Observable<Nullable<ISelectionWithStyle[]>>;\n\n    constructor(\n        @IUniverInstanceService protected readonly _instanceSrv: IUniverInstanceService\n    ) {\n        super();\n        this._init();\n    }\n\n    protected _init(): void {\n        const c$ = this._instanceSrv.getCurrentTypeOfUnit$(UniverInstanceType.UNIVER_SHEET).pipe(shareReplay(1), takeUntil(this.dispose$));\n        // When workbook changed, unsubscribe the previous workbook selection$ and subscribe the new workbook selection$.\n        this.selectionMoveStart$ = c$.pipe(switchMap((workbook) => !workbook ? of() : this._ensureWorkbookSelection(workbook.getUnitId()).selectionMoveStart$));\n        this.selectionMoving$ = c$.pipe(switchMap((workbook) => !workbook ? of() : this._ensureWorkbookSelection(workbook.getUnitId()).selectionMoving$));\n        this.selectionMoveEnd$ = c$.pipe(switchMap((workbook) => !workbook ? of([]) : this._ensureWorkbookSelection(workbook.getUnitId()).selectionMoveEnd$));\n        this.selectionSet$ = c$.pipe(switchMap((workbook) => !workbook ? of([]) : this._ensureWorkbookSelection(workbook.getUnitId()).selectionSet$));\n        this.selectionChanged$ = c$.pipe(switchMap((workbook) => !workbook ? of([]) : this._ensureWorkbookSelection(workbook.getUnitId()).selectionChanged$)).pipe(\n            distinctUntilChanged((prev, curr) => {\n                if (prev.length !== curr.length) return false;\n                if (prev.length === 0 && curr.length === 0) return true;\n                return prev.every((item, index) => {\n                    return JSON.stringify(item) === JSON.stringify(curr[index]);\n                });\n            }),\n            skip(1)\n        );\n\n        this._instanceSrv.getTypeOfUnitDisposed$(UniverInstanceType.UNIVER_SHEET).pipe(takeUntil(this.dispose$)).subscribe((workbook) => {\n            this._removeWorkbookSelection(workbook.getUnitId());\n        });\n    }\n\n    /**\n     * Clear all selections in all workbooks.\n     * invoked by prompt.controller\n     */\n    clear(): void {\n        this._workbookSelections.forEach((wbSelection) => wbSelection.clear());\n    }\n\n    getCurrentSelections(): Readonly<ISelectionWithStyle[]> {\n        return this._getCurrentSelections();\n    }\n\n    getCurrentLastSelection(): DeepReadonly<Nullable<ISelectionWithStyle & { primary: ISelectionCell }>> {\n        const selectionData = this._getCurrentSelections();\n        return selectionData?.[selectionData.length - 1] as Readonly<Nullable<ISelectionWithStyle & { primary: ISelectionCell }>>;\n    }\n\n    addSelections(selectionsData: ISelectionWithStyle[]): void;\n    addSelections(unitId: string, worksheetId: string, selectionDatas: ISelectionWithStyle[]): void;\n    addSelections(unitIdOrSelections: string | ISelectionWithStyle[], worksheetId?: string, selectionDatas?: ISelectionWithStyle[]): void {\n        if (typeof unitIdOrSelections === 'string') {\n            this._ensureWorkbookSelection(unitIdOrSelections).addSelections(worksheetId!, selectionDatas!);\n            return;\n        }\n\n        const current = this._currentSelectionPos;\n        if (!current) {\n            throw new Error('[SheetsSelectionsService]: cannot find current selection position!');\n        }\n        const { unitId, sheetId } = current;\n        this._ensureWorkbookSelection(unitId).addSelections(sheetId, unitIdOrSelections);\n    }\n\n    /**\n     * Set selection data to WorkbookSelectionModel.\n     *\n     * @param unitIdOrSelections\n     * @param worksheetIdOrType\n     * @param selectionDatas\n     * @param type\n     */\n    setSelections(selectionDatas: ISelectionWithStyle[], type?: SelectionMoveType): void;\n    setSelections(unitId: string, worksheetId: string, selectionDatas: ISelectionWithStyle[], type?: SelectionMoveType): void;\n    setSelections(\n        unitIdOrSelections: string | ISelectionWithStyle[],\n        worksheetIdOrType: string | SelectionMoveType | undefined,\n        selectionDatas?: ISelectionWithStyle[],\n        type?: SelectionMoveType\n    ): void {\n        if (typeof unitIdOrSelections === 'string' && typeof worksheetIdOrType === 'string') {\n            const unitId = unitIdOrSelections as string;\n            this._ensureWorkbookSelection(unitId).setSelections(\n                worksheetIdOrType,\n                selectionDatas || [],\n                type ?? SelectionMoveType.ONLY_SET\n            );\n            return;\n        }\n\n        const current = this._currentSelectionPos;\n        if (!current) {\n            throw new Error('[SheetsSelectionsService]: cannot find current selection position!');\n        }\n\n        const { unitId, sheetId } = current;\n        if (typeof unitIdOrSelections === 'object') {\n            const selectionData = unitIdOrSelections ?? selectionDatas;\n            const type = worksheetIdOrType as SelectionMoveType ?? SelectionMoveType.ONLY_SET;\n            this._ensureWorkbookSelection(unitId).setSelections(sheetId, selectionData, type);\n        }\n    }\n\n    clearCurrentSelections(): void {\n        const selectionData = this._getCurrentSelections();\n        selectionData.splice(0);\n    }\n\n    /**\n     * Determine whether multiple current selections overlap\n     *\n     * @deprecated this should be extracted to an pure function\n     */\n    isOverlapping(): boolean {\n        const selectionDataList = this.getCurrentSelections();\n        if (selectionDataList == null) {\n            return false;\n        }\n\n        return selectionDataList.some(({ range }, index) =>\n            selectionDataList.some(({ range: range2 }, index2) => {\n                if (index === index2) {\n                    return false;\n                }\n                return (\n                    range.startRow <= range2.endRow &&\n                    range.endRow >= range2.startRow &&\n                    range.startColumn <= range2.endColumn &&\n                    range.endColumn >= range2.startColumn\n                );\n            })\n        );\n    }\n\n    protected _getCurrentSelections() {\n        const current = this._currentSelectionPos;\n        if (!current) {\n            return [];\n        }\n\n        const { unitId, sheetId } = current;\n        return this._ensureWorkbookSelection(unitId).getSelectionsOfWorksheet(sheetId);\n    }\n\n    getWorkbookSelections(unitId: string): WorkbookSelectionModel {\n        return this._ensureWorkbookSelection(unitId);\n    }\n\n    protected _workbookSelections = new Map<string, WorkbookSelectionModel>();\n    protected _ensureWorkbookSelection(unitId: string): WorkbookSelectionModel {\n        let wbSelection = this._workbookSelections.get(unitId);\n        if (!wbSelection) {\n            const workbook = this._instanceSrv.getUnit<Workbook>(unitId);\n            if (!workbook) {\n                throw new Error(`[SheetsSelectionsService]: cannot resolve unit with id \"${unitId}\"!`);\n            }\n\n            wbSelection = new WorkbookSelectionModel(workbook);\n            this._workbookSelections.set(unitId, wbSelection);\n        }\n\n        return wbSelection;\n    }\n\n    protected _removeWorkbookSelection(unitId: string): void {\n        this._workbookSelections.delete(unitId);\n    }\n}\n\n/** An context key to disable normal selections if its value is set to `true`. */\n// so Bad! why not enableXXX\nexport const DISABLE_NORMAL_SELECTIONS = 'DISABLE_NORMAL_SELECTIONS';\nexport const SELECTIONS_ENABLED = 'SELECTIONS_ENABLED';\nexport const REF_SELECTIONS_ENABLED = 'REF_SELECTIONS_ENABLED';\nexport const SELECTION_MODE = '__SELECTION_MODE__';\nexport enum SelectionMode {\n    NORMAL,\n    REF,\n}\n"],"mappings":"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","names":["unitId","type","SelectionMode"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b16e153c94b4eb4eacefc64dc6cf5e11f8cf2046"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/utils/target-util.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/utils/target-util.ts","statementMap":{"0":{"start":{"line":3,"column":21},"end":{"line":3,"column":27}},"1":{"start":{"line":4,"column":19},"end":{"line":4,"column":159}},"2":{"start":{"line":5,"column":2},"end":{"line":5,"column":29}},"3":{"start":{"line":5,"column":17},"end":{"line":5,"column":29}},"4":{"start":{"line":6,"column":2},"end":{"line":9,"column":4}},"5":{"start":{"line":12,"column":32},"end":{"line":12,"column":38}},"6":{"start":{"line":13,"column":19},"end":{"line":13,"column":159}},"7":{"start":{"line":14,"column":2},"end":{"line":14,"column":29}},"8":{"start":{"line":14,"column":17},"end":{"line":14,"column":29}},"9":{"start":{"line":15,"column":20},"end":{"line":15,"column":101}},"10":{"start":{"line":16,"column":2},"end":{"line":18,"column":3}},"11":{"start":{"line":17,"column":4},"end":{"line":17,"column":16}},"12":{"start":{"line":19,"column":2},"end":{"line":24,"column":4}},"13":{"start":{"line":27,"column":32},"end":{"line":27,"column":38}},"14":{"start":{"line":28,"column":19},"end":{"line":28,"column":71}},"15":{"start":{"line":29,"column":2},"end":{"line":29,"column":29}},"16":{"start":{"line":29,"column":17},"end":{"line":29,"column":29}},"17":{"start":{"line":30,"column":20},"end":{"line":30,"column":57}},"18":{"start":{"line":31,"column":2},"end":{"line":33,"column":3}},"19":{"start":{"line":32,"column":4},"end":{"line":32,"column":16}},"20":{"start":{"line":34,"column":2},"end":{"line":37,"column":4}}},"fnMap":{"0":{"name":"getSheetCommandTargetWorkbook","decl":{"start":{"line":2,"column":16},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":77},"end":{"line":10,"column":1}},"line":2},"1":{"name":"getSheetCommandTarget","decl":{"start":{"line":11,"column":16},"end":{"line":11,"column":37}},"loc":{"start":{"line":11,"column":74},"end":{"line":25,"column":1}},"line":11},"2":{"name":"getSheetMutationTarget","decl":{"start":{"line":26,"column":16},"end":{"line":26,"column":38}},"loc":{"start":{"line":26,"column":70},"end":{"line":38,"column":1}},"line":26}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":19},"end":{"line":4,"column":159}},"type":"cond-expr","locations":[{"start":{"line":4,"column":28},"end":{"line":4,"column":80}},{"start":{"line":4,"column":83},"end":{"line":4,"column":159}}],"line":4},"1":{"loc":{"start":{"line":5,"column":2},"end":{"line":5,"column":29}},"type":"if","locations":[{"start":{"line":5,"column":2},"end":{"line":5,"column":29}},{"start":{},"end":{}}],"line":5},"2":{"loc":{"start":{"line":11,"column":61},"end":{"line":11,"column":72}},"type":"default-arg","locations":[{"start":{"line":11,"column":70},"end":{"line":11,"column":72}}],"line":11},"3":{"loc":{"start":{"line":13,"column":19},"end":{"line":13,"column":159}},"type":"cond-expr","locations":[{"start":{"line":13,"column":28},"end":{"line":13,"column":80}},{"start":{"line":13,"column":83},"end":{"line":13,"column":159}}],"line":13},"4":{"loc":{"start":{"line":14,"column":2},"end":{"line":14,"column":29}},"type":"if","locations":[{"start":{"line":14,"column":2},"end":{"line":14,"column":29}},{"start":{},"end":{}}],"line":14},"5":{"loc":{"start":{"line":15,"column":20},"end":{"line":15,"column":101}},"type":"cond-expr","locations":[{"start":{"line":15,"column":32},"end":{"line":15,"column":69}},{"start":{"line":15,"column":72},"end":{"line":15,"column":101}}],"line":15},"6":{"loc":{"start":{"line":16,"column":2},"end":{"line":18,"column":3}},"type":"if","locations":[{"start":{"line":16,"column":2},"end":{"line":18,"column":3}},{"start":{},"end":{}}],"line":16},"7":{"loc":{"start":{"line":29,"column":2},"end":{"line":29,"column":29}},"type":"if","locations":[{"start":{"line":29,"column":2},"end":{"line":29,"column":29}},{"start":{},"end":{}}],"line":29},"8":{"loc":{"start":{"line":31,"column":2},"end":{"line":33,"column":3}},"type":"if","locations":[{"start":{"line":31,"column":2},"end":{"line":33,"column":3}},{"start":{},"end":{}}],"line":31}},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":24,"6":24,"7":24,"8":0,"9":24,"10":24,"11":0,"12":24,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},"f":{"0":0,"1":24,"2":0},"b":{"0":[0,0],"1":[0,0],"2":[3],"3":[19,5],"4":[0,24],"5":[19,5],"6":[0,24],"7":[0,0],"8":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/utils/target-util.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type IUniverInstanceService, type Nullable, UniverInstanceType, type Workbook, type Worksheet } from '@univerjs/core';\n\nexport function getSheetCommandTargetWorkbook(univerInstanceService: IUniverInstanceService, params: { unitId?: string }): Nullable<{\n    workbook: Workbook;\n    unitId: string;\n}> {\n    const { unitId } = params;\n    const workbook = unitId\n        ? univerInstanceService.getUniverSheetInstance(unitId)\n        : univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n\n    if (!workbook) return null;\n\n    return {\n        workbook,\n        unitId: workbook.getUnitId(),\n    };\n}\n\nexport interface IResult {\n    workbook: Workbook;\n    worksheet: Worksheet;\n    unitId: string;\n    subUnitId: string;\n}\n\n/**\n * Get targeted Workbook & Worksheet of a command. If `unitId` and `subUnitId` are given, the function would\n * try to get these instances. If not, it would try to get the current active instances.\n *\n * @param univerInstanceService\n * @param params - unitId and subUnitId\n * @param params.unitId - The unitId of the Workbook\n * @param params.subUnitId - The subUnitId of the Worksheet\n * @returns Targeted Workbook & Worksheet\n */\nexport function getSheetCommandTarget(univerInstanceService: IUniverInstanceService, params: { unitId?: string; subUnitId?: string } = {}): Nullable<IResult> {\n    const { unitId, subUnitId } = params;\n\n    const workbook = unitId\n        ? univerInstanceService.getUniverSheetInstance(unitId)\n        : univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    if (!workbook) return null;\n\n    const worksheet = subUnitId ? workbook.getSheetBySheetId(subUnitId) : workbook.getActiveSheet(true);\n    if (!worksheet) {\n        return null;\n    }\n\n    return {\n        worksheet,\n        workbook,\n        unitId: workbook.getUnitId(),\n        subUnitId: worksheet.getSheetId(),\n    };\n}\n\nexport function getSheetMutationTarget(univerInstanceService: IUniverInstanceService, params: { unitId: string; subUnitId: string }): Nullable<Pick<IResult, 'workbook' | 'worksheet'>> {\n    const { unitId, subUnitId } = params;\n\n    const workbook = univerInstanceService.getUniverSheetInstance(unitId);\n    if (!workbook) return null;\n\n    const worksheet = workbook.getSheetBySheetId(subUnitId);\n    if (!worksheet) {\n        return null;\n    }\n\n    return {\n        worksheet,\n        workbook,\n    };\n}\n"],"mappings":"AAgBA,SAAqD,0BAAyD;AAEvG,gBAAS,8BAA8B,uBAA+C,QAG1F;AACC,QAAM,EAAE,OAAO,IAAI;AACnB,QAAM,WAAW,SACX,sBAAsB,uBAAuB,MAAM,IACnD,sBAAsB,sBAAgC,mBAAmB,YAAY;AAE3F,MAAI,CAAC,SAAU,QAAO;AAEtB,SAAO;AAAA,IACH;AAAA,IACA,QAAQ,SAAS,UAAU;AAAA,EAC/B;AACJ;AAmBO,gBAAS,sBAAsB,uBAA+C,SAAkD,CAAC,GAAsB;AAC1J,QAAM,EAAE,QAAQ,UAAU,IAAI;AAE9B,QAAM,WAAW,SACX,sBAAsB,uBAAuB,MAAM,IACnD,sBAAsB,sBAAgC,mBAAmB,YAAY;AAC3F,MAAI,CAAC,SAAU,QAAO;AAEtB,QAAM,YAAY,YAAY,SAAS,kBAAkB,SAAS,IAAI,SAAS,eAAe,IAAI;AAClG,MAAI,CAAC,WAAW;AACZ,WAAO;AAAA,EACX;AAEA,SAAO;AAAA,IACH;AAAA,IACA;AAAA,IACA,QAAQ,SAAS,UAAU;AAAA,IAC3B,WAAW,UAAU,WAAW;AAAA,EACpC;AACJ;AAEO,gBAAS,uBAAuB,uBAA+C,QAAkG;AACpL,QAAM,EAAE,QAAQ,UAAU,IAAI;AAE9B,QAAM,WAAW,sBAAsB,uBAAuB,MAAM;AACpE,MAAI,CAAC,SAAU,QAAO;AAEtB,QAAM,YAAY,SAAS,kBAAkB,SAAS;AACtD,MAAI,CAAC,WAAW;AACZ,WAAO;AAAA,EACX;AAEA,SAAO;AAAA,IACH;AAAA,IACA;AAAA,EACJ;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"80d2c4ddf9c0f11306f8b30b3ff160bf961cfc34"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/set-worksheet-row-height.mutation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/set-worksheet-row-height.mutation.ts","statementMap":{"0":{"start":{"line":3,"column":27},"end":{"line":3,"column":30}},"1":{"start":{"line":4,"column":52},"end":{"line":20,"column":1}},"2":{"start":{"line":5,"column":40},"end":{"line":5,"column":46}},"3":{"start":{"line":6,"column":20},"end":{"line":6,"column":22}},"4":{"start":{"line":7,"column":18},"end":{"line":7,"column":43}},"5":{"start":{"line":8,"column":2},"end":{"line":13,"column":3}},"6":{"start":{"line":9,"column":4},"end":{"line":12,"column":5}},"7":{"start":{"line":9,"column":24},"end":{"line":9,"column":32}},"8":{"start":{"line":10,"column":18},"end":{"line":10,"column":50}},"9":{"start":{"line":11,"column":6},"end":{"line":11,"column":34}},"10":{"start":{"line":14,"column":2},"end":{"line":19,"column":4}},"11":{"start":{"line":21,"column":58},"end":{"line":37,"column":1}},"12":{"start":{"line":22,"column":40},"end":{"line":22,"column":46}},"13":{"start":{"line":23,"column":25},"end":{"line":23,"column":27}},"14":{"start":{"line":24,"column":18},"end":{"line":24,"column":43}},"15":{"start":{"line":25,"column":2},"end":{"line":30,"column":3}},"16":{"start":{"line":26,"column":4},"end":{"line":29,"column":5}},"17":{"start":{"line":26,"column":24},"end":{"line":26,"column":32}},"18":{"start":{"line":27,"column":18},"end":{"line":27,"column":50}},"19":{"start":{"line":28,"column":6},"end":{"line":28,"column":40}},"20":{"start":{"line":31,"column":2},"end":{"line":36,"column":4}},"21":{"start":{"line":38,"column":56},"end":{"line":52,"column":1}},"22":{"start":{"line":39,"column":52},"end":{"line":39,"column":58}},"23":{"start":{"line":40,"column":18},"end":{"line":40,"column":20}},"24":{"start":{"line":41,"column":18},"end":{"line":41,"column":43}},"25":{"start":{"line":42,"column":2},"end":{"line":46,"column":3}},"26":{"start":{"line":43,"column":20},"end":{"line":43,"column":27}},"27":{"start":{"line":44,"column":19},"end":{"line":44,"column":46}},"28":{"start":{"line":45,"column":4},"end":{"line":45,"column":42}},"29":{"start":{"line":47,"column":2},"end":{"line":51,"column":4}},"30":{"start":{"line":53,"column":45},"end":{"line":77,"column":1}},"31":{"start":{"line":57,"column":34},"end":{"line":57,"column":40}},"32":{"start":{"line":58,"column":34},"end":{"line":58,"column":70}},"33":{"start":{"line":59,"column":19},"end":{"line":59,"column":71}},"34":{"start":{"line":60,"column":4},"end":{"line":60,"column":30}},"35":{"start":{"line":60,"column":17},"end":{"line":60,"column":30}},"36":{"start":{"line":61,"column":26},"end":{"line":61,"column":32}},"37":{"start":{"line":62,"column":20},"end":{"line":62,"column":45}},"38":{"start":{"line":63,"column":29},"end":{"line":63,"column":67}},"39":{"start":{"line":64,"column":4},"end":{"line":74,"column":5}},"40":{"start":{"line":65,"column":6},"end":{"line":73,"column":7}},"41":{"start":{"line":65,"column":26},"end":{"line":65,"column":34}},"42":{"start":{"line":66,"column":20},"end":{"line":66,"column":52}},"43":{"start":{"line":67,"column":8},"end":{"line":71,"column":9}},"44":{"start":{"line":68,"column":10},"end":{"line":68,"column":28}},"45":{"start":{"line":70,"column":10},"end":{"line":70,"column":58}},"46":{"start":{"line":72,"column":8},"end":{"line":72,"column":52}},"47":{"start":{"line":75,"column":4},"end":{"line":75,"column":16}},"48":{"start":{"line":78,"column":51},"end":{"line":99,"column":1}},"49":{"start":{"line":82,"column":39},"end":{"line":82,"column":45}},"50":{"start":{"line":83,"column":34},"end":{"line":83,"column":70}},"51":{"start":{"line":84,"column":19},"end":{"line":84,"column":71}},"52":{"start":{"line":85,"column":4},"end":{"line":85,"column":30}},"53":{"start":{"line":85,"column":17},"end":{"line":85,"column":30}},"54":{"start":{"line":86,"column":20},"end":{"line":86,"column":52}},"55":{"start":{"line":87,"column":4},"end":{"line":96,"column":5}},"56":{"start":{"line":88,"column":6},"end":{"line":95,"column":7}},"57":{"start":{"line":88,"column":26},"end":{"line":88,"column":34}},"58":{"start":{"line":89,"column":20},"end":{"line":89,"column":52}},"59":{"start":{"line":90,"column":8},"end":{"line":94,"column":9}},"60":{"start":{"line":91,"column":10},"end":{"line":91,"column":34}},"61":{"start":{"line":93,"column":10},"end":{"line":93,"column":54}},"62":{"start":{"line":97,"column":4},"end":{"line":97,"column":16}},"63":{"start":{"line":100,"column":49},"end":{"line":115,"column":1}},"64":{"start":{"line":104,"column":35},"end":{"line":104,"column":41}},"65":{"start":{"line":105,"column":34},"end":{"line":105,"column":70}},"66":{"start":{"line":106,"column":19},"end":{"line":106,"column":71}},"67":{"start":{"line":107,"column":4},"end":{"line":107,"column":30}},"68":{"start":{"line":107,"column":17},"end":{"line":107,"column":30}},"69":{"start":{"line":108,"column":23},"end":{"line":108,"column":55}},"70":{"start":{"line":109,"column":4},"end":{"line":112,"column":5}},"71":{"start":{"line":110,"column":21},"end":{"line":110,"column":51}},"72":{"start":{"line":111,"column":6},"end":{"line":111,"column":29}},"73":{"start":{"line":113,"column":4},"end":{"line":113,"column":16}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":52},"end":{"line":4,"column":53}},"loc":{"start":{"line":4,"column":75},"end":{"line":20,"column":1}},"line":4},"1":{"name":"(anonymous_1)","decl":{"start":{"line":21,"column":58},"end":{"line":21,"column":59}},"loc":{"start":{"line":21,"column":81},"end":{"line":37,"column":1}},"line":21},"2":{"name":"(anonymous_2)","decl":{"start":{"line":38,"column":56},"end":{"line":38,"column":57}},"loc":{"start":{"line":38,"column":79},"end":{"line":52,"column":1}},"line":38},"3":{"name":"(anonymous_3)","decl":{"start":{"line":56,"column":11},"end":{"line":56,"column":12}},"loc":{"start":{"line":56,"column":33},"end":{"line":76,"column":3}},"line":56},"4":{"name":"(anonymous_4)","decl":{"start":{"line":81,"column":11},"end":{"line":81,"column":12}},"loc":{"start":{"line":81,"column":33},"end":{"line":98,"column":3}},"line":81},"5":{"name":"(anonymous_5)","decl":{"start":{"line":103,"column":11},"end":{"line":103,"column":12}},"loc":{"start":{"line":103,"column":33},"end":{"line":114,"column":3}},"line":103}},"branchMap":{"0":{"loc":{"start":{"line":60,"column":4},"end":{"line":60,"column":30}},"type":"if","locations":[{"start":{"line":60,"column":4},"end":{"line":60,"column":30}},{"start":{},"end":{}}],"line":60},"1":{"loc":{"start":{"line":67,"column":8},"end":{"line":71,"column":9}},"type":"if","locations":[{"start":{"line":67,"column":8},"end":{"line":71,"column":9}},{"start":{"line":69,"column":15},"end":{"line":71,"column":9}}],"line":67},"2":{"loc":{"start":{"line":70,"column":18},"end":{"line":70,"column":57}},"type":"binary-expr","locations":[{"start":{"line":70,"column":18},"end":{"line":70,"column":37}},{"start":{"line":70,"column":41},"end":{"line":70,"column":57}}],"line":70},"3":{"loc":{"start":{"line":85,"column":4},"end":{"line":85,"column":30}},"type":"if","locations":[{"start":{"line":85,"column":4},"end":{"line":85,"column":30}},{"start":{},"end":{}}],"line":85},"4":{"loc":{"start":{"line":90,"column":8},"end":{"line":94,"column":9}},"type":"if","locations":[{"start":{"line":90,"column":8},"end":{"line":94,"column":9}},{"start":{"line":92,"column":15},"end":{"line":94,"column":9}}],"line":90},"5":{"loc":{"start":{"line":93,"column":19},"end":{"line":93,"column":53}},"type":"binary-expr","locations":[{"start":{"line":93,"column":19},"end":{"line":93,"column":43}},{"start":{"line":93,"column":47},"end":{"line":93,"column":53}}],"line":93},"6":{"loc":{"start":{"line":107,"column":4},"end":{"line":107,"column":30}},"type":"if","locations":[{"start":{"line":107,"column":4},"end":{"line":107,"column":30}},{"start":{},"end":{}}],"line":107}},"s":{"0":1,"1":1,"2":4,"3":4,"4":4,"5":4,"6":6,"7":6,"8":8,"9":8,"10":4,"11":1,"12":5,"13":5,"14":5,"15":5,"16":8,"17":8,"18":11,"19":11,"20":5,"21":1,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":1,"31":8,"32":8,"33":8,"34":8,"35":0,"36":8,"37":8,"38":8,"39":8,"40":14,"41":14,"42":20,"43":20,"44":14,"45":6,"46":20,"47":8,"48":1,"49":11,"50":11,"51":11,"52":11,"53":0,"54":11,"55":11,"56":20,"57":20,"58":29,"59":29,"60":20,"61":9,"62":11,"63":1,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0},"f":{"0":4,"1":5,"2":0,"3":8,"4":11,"5":0},"b":{"0":[0,8],"1":[14,6],"2":[6,6],"3":[0,11],"4":[20,9],"5":[9,9],"6":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/set-worksheet-row-height.mutation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommandType, IUniverInstanceService } from '@univerjs/core';\nimport type { BooleanNumber, IMutation, IObjectArrayPrimitiveType, IRange, IRowAutoHeightInfo, Nullable, Worksheet } from '@univerjs/core';\nimport { getSheetCommandTarget } from '../commands/utils/target-util';\n\nconst MAXIMUM_ROW_HEIGHT = 2000;\n\nexport interface ISetWorksheetRowHeightMutationParams {\n    unitId: string;\n    subUnitId: string;\n    ranges: IRange[];\n    rowHeight: number | IObjectArrayPrimitiveType<Nullable<number>>;\n}\n\nexport interface ISetWorksheetRowIsAutoHeightMutationParams {\n    unitId: string;\n    subUnitId: string;\n    ranges: IRange[];\n    autoHeightInfo: BooleanNumber | IObjectArrayPrimitiveType<Nullable<BooleanNumber>>;\n}\n\nexport interface ISetWorksheetRowAutoHeightMutationParams {\n    unitId: string;\n    subUnitId: string;\n    rowsAutoHeightInfo: IRowAutoHeightInfo[];\n}\n\nexport const SetWorksheetRowHeightMutationFactory = (\n    params: ISetWorksheetRowHeightMutationParams,\n    worksheet: Worksheet\n): ISetWorksheetRowHeightMutationParams => {\n    const { unitId, subUnitId, ranges } = params;\n\n    const rowHeight: IObjectArrayPrimitiveType<Nullable<number>> = {};\n    const manager = worksheet.getRowManager();\n\n    for (const { startRow, endRow } of ranges) {\n        for (let rowIndex = startRow; rowIndex < endRow + 1; rowIndex++) {\n            const row = manager.getRowOrCreate(rowIndex);\n            rowHeight[rowIndex] = row.h;\n        }\n    }\n\n    return {\n        unitId,\n        subUnitId,\n        ranges,\n        rowHeight,\n    };\n};\n\nexport const SetWorksheetRowIsAutoHeightMutationFactory = (\n    params: ISetWorksheetRowIsAutoHeightMutationParams,\n    worksheet: Worksheet\n): ISetWorksheetRowIsAutoHeightMutationParams => {\n    const { unitId, subUnitId, ranges } = params;\n\n    const autoHeightHash: IObjectArrayPrimitiveType<Nullable<BooleanNumber>> = {};\n    const manager = worksheet.getRowManager();\n\n    for (const { startRow, endRow } of ranges) {\n        for (let rowIndex = startRow; rowIndex <= endRow; rowIndex++) {\n            const row = manager.getRowOrCreate(rowIndex);\n\n            autoHeightHash[rowIndex] = row.ia;\n        }\n    }\n\n    return {\n        unitId,\n        subUnitId,\n        ranges,\n        autoHeightInfo: autoHeightHash,\n    };\n};\n\nexport const SetWorksheetRowAutoHeightMutationFactory = (\n    params: ISetWorksheetRowAutoHeightMutationParams,\n    worksheet: Worksheet\n): ISetWorksheetRowAutoHeightMutationParams => {\n    const { unitId, subUnitId, rowsAutoHeightInfo } = params;\n    const results: IRowAutoHeightInfo[] = [];\n    const manager = worksheet.getRowManager();\n\n    for (const rowInfo of rowsAutoHeightInfo) {\n        const { row } = rowInfo;\n        const { ah } = manager.getRowOrCreate(row);\n\n        results.push({ row, autoHeight: ah });\n    }\n\n    return {\n        unitId,\n        subUnitId,\n        rowsAutoHeightInfo: results,\n    };\n};\n\nexport const SetWorksheetRowHeightMutation: IMutation<ISetWorksheetRowHeightMutationParams> = {\n    id: 'sheet.mutation.set-worksheet-row-height',\n    type: CommandType.MUTATION,\n    handler: (accessor, params) => {\n        const { ranges, rowHeight } = params;\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const target = getSheetCommandTarget(univerInstanceService, params);\n        if (!target) return false;\n\n        const { worksheet } = target;\n        const manager = worksheet.getRowManager();\n        const defaultRowHeight = worksheet.getConfig().defaultRowHeight;\n        for (const { startRow, endRow } of ranges) {\n            for (let rowIndex = startRow; rowIndex <= endRow; rowIndex++) {\n                const row = manager.getRowOrCreate(rowIndex);\n\n                if (typeof rowHeight === 'number') {\n                    row.h = rowHeight;\n                } else {\n                    row.h = rowHeight[rowIndex] ?? defaultRowHeight; // Start from startRow\n                }\n\n                row.h = Math.min(MAXIMUM_ROW_HEIGHT, row.h);\n            }\n        }\n\n        return true;\n    },\n};\n\nexport const SetWorksheetRowIsAutoHeightMutation: IMutation<ISetWorksheetRowIsAutoHeightMutationParams> = {\n    id: 'sheet.mutation.set-worksheet-row-is-auto-height',\n    type: CommandType.MUTATION,\n    handler: (accessor, params) => {\n        const { ranges, autoHeightInfo } = params;\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const target = getSheetCommandTarget(univerInstanceService, params);\n        if (!target) return false;\n\n        const manager = target.worksheet.getRowManager();\n        for (const { startRow, endRow } of ranges) {\n            for (let rowIndex = startRow; rowIndex <= endRow; rowIndex++) {\n                const row = manager.getRowOrCreate(rowIndex);\n\n                if (typeof autoHeightInfo === 'number') {\n                    row.ia = autoHeightInfo;\n                } else {\n                    row.ia = autoHeightInfo[rowIndex] ?? undefined;\n                }\n            }\n        }\n\n        return true;\n    },\n};\n\nexport const SetWorksheetRowAutoHeightMutation: IMutation<ISetWorksheetRowAutoHeightMutationParams> = {\n    id: 'sheet.mutation.set-worksheet-row-auto-height',\n    type: CommandType.MUTATION,\n    handler: (accessor, params) => {\n        const { rowsAutoHeightInfo } = params;\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const target = getSheetCommandTarget(univerInstanceService, params);\n        if (!target) return false;\n\n        const rowManager = target.worksheet.getRowManager();\n\n        for (const { row, autoHeight } of rowsAutoHeightInfo) {\n            const curRow = rowManager.getRowOrCreate(row);\n            curRow.ah = autoHeight;\n        }\n\n        return true;\n    },\n};\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2c028626bc851b02124d692d2c8c09bb4261a937"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/sheet-interceptor/interceptor-const.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/sheet-interceptor/interceptor-const.ts","statementMap":{"0":{"start":{"line":2,"column":21},"end":{"line":2,"column":57}},"1":{"start":{"line":3,"column":21},"end":{"line":3,"column":57}},"2":{"start":{"line":4,"column":33},"end":{"line":7,"column":1}},"3":{"start":{"line":8,"column":58},"end":{"line":13,"column":38}},"4":{"start":{"line":9,"column":2},"end":{"line":9,"column":106}},"5":{"start":{"line":10,"column":2},"end":{"line":10,"column":89}},"6":{"start":{"line":11,"column":2},"end":{"line":11,"column":97}},"7":{"start":{"line":12,"column":2},"end":{"line":12,"column":39}},"8":{"start":{"line":14,"column":39},"end":{"line":14,"column":73}},"9":{"start":{"line":15,"column":46},"end":{"line":15,"column":84}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":59},"end":{"line":8,"column":60}},"loc":{"start":{"line":8,"column":94},"end":{"line":13,"column":1}},"line":8}},"branchMap":{"0":{"loc":{"start":{"line":13,"column":3},"end":{"line":13,"column":37}},"type":"binary-expr","locations":[{"start":{"line":13,"column":3},"end":{"line":13,"column":31}},{"start":{"line":13,"column":35},"end":{"line":13,"column":37}}],"line":13}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1},"f":{"0":1},"b":{"0":[1,1]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/sheet-interceptor/interceptor-const.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellData, ICellDataForSheetInterceptor, ICellInterceptor, Nullable } from '@univerjs/core';\nimport type { ISheetLocation, ISheetRowLocation } from './utils/interceptor';\n\nimport { createInterceptorKey } from '@univerjs/core';\n\nconst CELL_CONTENT = createInterceptorKey<ICellDataForSheetInterceptor, ISheetLocation & { rawData: Nullable<ICellData> }>('CELL_CONTENT') as ICellInterceptor<ICellDataForSheetInterceptor, ISheetLocation & { rawData: Nullable<ICellData> }>;\nconst ROW_FILTERED = createInterceptorKey<boolean, ISheetRowLocation>('ROW_FILTERED');\n\nexport const INTERCEPTOR_POINT = {\n    CELL_CONTENT,\n    ROW_FILTERED,\n};\n\nexport enum InterceptCellContentPriority {\n    DATA_VALIDATION = 9,\n    NUMFMT = 10,\n    CELL_IMAGE = 11,\n}\n// used for define the range theme interceptor, it will also use to ignore the range theme interceptor\nexport const RangeThemeInterceptorId = 'sheet.interceptor.range-theme-id';\n\nexport const IgnoreRangeThemeInterceptorKey = 'sheet.interceptor.ignore-range-theme';\n"],"mappings":"AAmBA,SAAS,4BAA4B;AAErC,MAAM,eAAe,qBAAsG,cAAc;AACzI,MAAM,eAAe,qBAAiD,cAAc;AAE7E,aAAM,oBAAoB;AAAA,EAC7B;AAAA,EACA;AACJ;AAEO,WAAK,+BAAL,kBAAKA,kCAAL;AACH,EAAAA,4DAAA,qBAAkB,KAAlB;AACA,EAAAA,4DAAA,YAAS,MAAT;AACA,EAAAA,4DAAA,gBAAa,MAAb;AAHQ,SAAAA;AAAA,GAAA;AAML,aAAM,0BAA0B;AAEhC,aAAM,iCAAiC;","names":["InterceptCellContentPriority"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7895c8d2e97066b0ade87500952f58c224d5f641"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/sheet-interceptor/sheet-interceptor.service.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/sheet-interceptor/sheet-interceptor.service.ts","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":37}},"1":{"start":{"line":2,"column":23},"end":{"line":2,"column":54}},"2":{"start":{"line":3,"column":22},"end":{"line":10,"column":1}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"4":{"start":{"line":5,"column":2},"end":{"line":7,"column":85}},"5":{"start":{"line":5,"column":15},"end":{"line":5,"column":36}},"6":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"7":{"start":{"line":7,"column":6},"end":{"line":7,"column":85}},"8":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"9":{"start":{"line":8,"column":22},"end":{"line":8,"column":53}},"10":{"start":{"line":9,"column":2},"end":{"line":9,"column":16}},"11":{"start":{"line":11,"column":22},"end":{"line":11,"column":90}},"12":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"13":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"14":{"start":{"line":26,"column":32},"end":{"line":26,"column":72}},"15":{"start":{"line":27,"column":31},"end":{"line":27,"column":70}},"16":{"start":{"line":28,"column":29},"end":{"line":28,"column":66}},"17":{"start":{"line":29,"column":37},"end":{"line":317,"column":1}},"18":{"start":{"line":32,"column":4},"end":{"line":32,"column":12}},"19":{"start":{"line":33,"column":4},"end":{"line":33,"column":57}},"20":{"start":{"line":34,"column":4},"end":{"line":36,"column":8}},"21":{"start":{"line":35,"column":6},"end":{"line":35,"column":40}},"22":{"start":{"line":37,"column":4},"end":{"line":39,"column":7}},"23":{"start":{"line":38,"column":20},"end":{"line":38,"column":62}},"24":{"start":{"line":40,"column":4},"end":{"line":50,"column":7}},"25":{"start":{"line":44,"column":24},"end":{"line":44,"column":78}},"26":{"start":{"line":45,"column":8},"end":{"line":47,"column":9}},"27":{"start":{"line":46,"column":10},"end":{"line":46,"column":42}},"28":{"start":{"line":48,"column":8},"end":{"line":48,"column":23}},"29":{"start":{"line":51,"column":4},"end":{"line":54,"column":8}},"30":{"start":{"line":53,"column":27},"end":{"line":53,"column":33}},"31":{"start":{"line":55,"column":4},"end":{"line":58,"column":8}},"32":{"start":{"line":57,"column":27},"end":{"line":57,"column":33}},"33":{"start":{"line":59,"column":4},"end":{"line":62,"column":8}},"34":{"start":{"line":61,"column":27},"end":{"line":61,"column":33}},"35":{"start":{"line":64,"column":40},"end":{"line":64,"column":49}},"36":{"start":{"line":65,"column":25},"end":{"line":65,"column":27}},"37":{"start":{"line":66,"column":23},"end":{"line":66,"column":25}},"38":{"start":{"line":67,"column":30},"end":{"line":67,"column":32}},"39":{"start":{"line":68,"column":30},"end":{"line":68,"column":32}},"40":{"start":{"line":69,"column":41},"end":{"line":69,"column":50}},"41":{"start":{"line":70,"column":42},"end":{"line":70,"column":51}},"42":{"start":{"line":71,"column":23},"end":{"line":71,"column":28}},"43":{"start":{"line":72,"column":46},"end":{"line":72,"column":55}},"44":{"start":{"line":73,"column":25},"end":{"line":77,"column":4}},"45":{"start":{"line":79,"column":4},"end":{"line":79,"column":20}},"46":{"start":{"line":80,"column":4},"end":{"line":80,"column":76}},"47":{"start":{"line":80,"column":54},"end":{"line":80,"column":74}},"48":{"start":{"line":81,"column":4},"end":{"line":81,"column":38}},"49":{"start":{"line":82,"column":4},"end":{"line":82,"column":39}},"50":{"start":{"line":83,"column":4},"end":{"line":83,"column":37}},"51":{"start":{"line":95,"column":4},"end":{"line":97,"column":5}},"52":{"start":{"line":96,"column":6},"end":{"line":96,"column":80}},"53":{"start":{"line":98,"column":4},"end":{"line":98,"column":48}},"54":{"start":{"line":99,"column":4},"end":{"line":99,"column":84}},"55":{"start":{"line":99,"column":45},"end":{"line":99,"column":82}},"56":{"start":{"line":100,"column":4},"end":{"line":100,"column":98}},"57":{"start":{"line":100,"column":49},"end":{"line":100,"column":95}},"58":{"start":{"line":108,"column":18},"end":{"line":108,"column":76}},"59":{"start":{"line":108,"column":55},"end":{"line":108,"column":75}},"60":{"start":{"line":109,"column":4},"end":{"line":114,"column":6}},"61":{"start":{"line":110,"column":33},"end":{"line":110,"column":49}},"62":{"start":{"line":111,"column":30},"end":{"line":111,"column":37}},"63":{"start":{"line":112,"column":33},"end":{"line":112,"column":49}},"64":{"start":{"line":113,"column":30},"end":{"line":113,"column":37}},"65":{"start":{"line":117,"column":4},"end":{"line":119,"column":5}},"66":{"start":{"line":118,"column":6},"end":{"line":118,"column":80}},"67":{"start":{"line":120,"column":4},"end":{"line":120,"column":53}},"68":{"start":{"line":121,"column":4},"end":{"line":121,"column":89}},"69":{"start":{"line":121,"column":50},"end":{"line":121,"column":87}},"70":{"start":{"line":122,"column":4},"end":{"line":122,"column":103}},"71":{"start":{"line":122,"column":49},"end":{"line":122,"column":100}},"72":{"start":{"line":125,"column":18},"end":{"line":125,"column":81}},"73":{"start":{"line":125,"column":60},"end":{"line":125,"column":80}},"74":{"start":{"line":126,"column":4},"end":{"line":129,"column":6}},"75":{"start":{"line":127,"column":30},"end":{"line":127,"column":37}},"76":{"start":{"line":128,"column":30},"end":{"line":128,"column":37}},"77":{"start":{"line":141,"column":4},"end":{"line":143,"column":5}},"78":{"start":{"line":142,"column":6},"end":{"line":142,"column":80}},"79":{"start":{"line":144,"column":4},"end":{"line":144,"column":53}},"80":{"start":{"line":145,"column":4},"end":{"line":145,"column":89}},"81":{"start":{"line":145,"column":50},"end":{"line":145,"column":87}},"82":{"start":{"line":146,"column":4},"end":{"line":146,"column":103}},"83":{"start":{"line":146,"column":49},"end":{"line":146,"column":100}},"84":{"start":{"line":154,"column":31},"end":{"line":154,"column":113}},"85":{"start":{"line":154,"column":91},"end":{"line":154,"column":111}},"86":{"start":{"line":155,"column":4},"end":{"line":155,"column":58}},"87":{"start":{"line":155,"column":49},"end":{"line":155,"column":56}},"88":{"start":{"line":165,"column":4},"end":{"line":167,"column":5}},"89":{"start":{"line":166,"column":6},"end":{"line":166,"column":80}},"90":{"start":{"line":168,"column":4},"end":{"line":168,"column":46}},"91":{"start":{"line":169,"column":4},"end":{"line":169,"column":82}},"92":{"start":{"line":169,"column":43},"end":{"line":169,"column":80}},"93":{"start":{"line":170,"column":4},"end":{"line":170,"column":96}},"94":{"start":{"line":170,"column":49},"end":{"line":170,"column":93}},"95":{"start":{"line":173,"column":18},"end":{"line":173,"column":74}},"96":{"start":{"line":173,"column":53},"end":{"line":173,"column":73}},"97":{"start":{"line":174,"column":4},"end":{"line":179,"column":6}},"98":{"start":{"line":175,"column":33},"end":{"line":175,"column":49}},"99":{"start":{"line":176,"column":30},"end":{"line":176,"column":37}},"100":{"start":{"line":177,"column":33},"end":{"line":177,"column":49}},"101":{"start":{"line":178,"column":30},"end":{"line":178,"column":37}},"102":{"start":{"line":184,"column":20},"end":{"line":192,"column":5}},"103":{"start":{"line":193,"column":4},"end":{"line":193,"column":98}},"104":{"start":{"line":197,"column":20},"end":{"line":204,"column":5}},"105":{"start":{"line":205,"column":4},"end":{"line":205,"column":109}},"106":{"start":{"line":208,"column":16},"end":{"line":208,"column":20}},"107":{"start":{"line":209,"column":4},"end":{"line":211,"column":5}},"108":{"start":{"line":210,"column":6},"end":{"line":210,"column":44}},"109":{"start":{"line":212,"column":25},"end":{"line":212,"column":58}},"110":{"start":{"line":213,"column":4},"end":{"line":213,"column":35}},"111":{"start":{"line":214,"column":31},"end":{"line":214,"column":97}},"112":{"start":{"line":214,"column":59},"end":{"line":214,"column":96}},"113":{"start":{"line":215,"column":4},"end":{"line":215,"column":35}},"114":{"start":{"line":216,"column":4},"end":{"line":237,"column":5}},"115":{"start":{"line":217,"column":28},"end":{"line":217,"column":85}},"116":{"start":{"line":218,"column":6},"end":{"line":218,"column":82}},"117":{"start":{"line":219,"column":26},"end":{"line":219,"column":83}},"118":{"start":{"line":220,"column":6},"end":{"line":223,"column":8}},"119":{"start":{"line":222,"column":41},"end":{"line":222,"column":102}},"120":{"start":{"line":224,"column":6},"end":{"line":227,"column":8}},"121":{"start":{"line":226,"column":41},"end":{"line":226,"column":102}},"122":{"start":{"line":228,"column":6},"end":{"line":233,"column":10}},"123":{"start":{"line":229,"column":8},"end":{"line":229,"column":63}},"124":{"start":{"line":230,"column":8},"end":{"line":230,"column":85}},"125":{"start":{"line":231,"column":8},"end":{"line":231,"column":99}},"126":{"start":{"line":232,"column":8},"end":{"line":232,"column":99}},"127":{"start":{"line":235,"column":6},"end":{"line":235,"column":60}},"128":{"start":{"line":236,"column":6},"end":{"line":236,"column":108}},"129":{"start":{"line":236,"column":51},"end":{"line":236,"column":105}},"130":{"start":{"line":240,"column":23},"end":{"line":240,"column":69}},"131":{"start":{"line":241,"column":16},"end":{"line":241,"column":34}},"132":{"start":{"line":242,"column":19},"end":{"line":242,"column":58}},"133":{"start":{"line":243,"column":4},"end":{"line":250,"column":5}},"134":{"start":{"line":244,"column":25},"end":{"line":244,"column":65}},"135":{"start":{"line":245,"column":6},"end":{"line":247,"column":7}},"136":{"start":{"line":246,"column":8},"end":{"line":246,"column":51}},"137":{"start":{"line":248,"column":6},"end":{"line":248,"column":57}},"138":{"start":{"line":249,"column":6},"end":{"line":249,"column":56}},"139":{"start":{"line":251,"column":4},"end":{"line":251,"column":20}},"140":{"start":{"line":254,"column":24},"end":{"line":254,"column":50}},"141":{"start":{"line":255,"column":19},"end":{"line":255,"column":39}},"142":{"start":{"line":256,"column":36},"end":{"line":256,"column":40}},"143":{"start":{"line":257,"column":31},"end":{"line":294,"column":5}},"144":{"start":{"line":258,"column":24},"end":{"line":258,"column":46}},"145":{"start":{"line":259,"column":6},"end":{"line":293,"column":9}},"146":{"start":{"line":260,"column":33},"end":{"line":260,"column":59}},"147":{"start":{"line":261,"column":8},"end":{"line":261,"column":121}},"148":{"start":{"line":262,"column":8},"end":{"line":278,"column":12}},"149":{"start":{"line":264,"column":28},"end":{"line":264,"column":58}},"150":{"start":{"line":265,"column":12},"end":{"line":276,"column":14}},"151":{"start":{"line":279,"column":8},"end":{"line":292,"column":12}},"152":{"start":{"line":281,"column":12},"end":{"line":290,"column":14}},"153":{"start":{"line":295,"column":4},"end":{"line":295,"column":79}},"154":{"start":{"line":295,"column":48},"end":{"line":295,"column":77}},"155":{"start":{"line":296,"column":4},"end":{"line":296,"column":100}},"156":{"start":{"line":296,"column":68},"end":{"line":296,"column":97}},"157":{"start":{"line":297,"column":4},"end":{"line":297,"column":135}},"158":{"start":{"line":297,"column":39},"end":{"line":297,"column":132}},"159":{"start":{"line":297,"column":83},"end":{"line":297,"column":131}},"160":{"start":{"line":298,"column":4},"end":{"line":298,"column":120}},"161":{"start":{"line":298,"column":69},"end":{"line":298,"column":117}},"162":{"start":{"line":299,"column":4},"end":{"line":299,"column":55}},"163":{"start":{"line":302,"column":19},"end":{"line":302,"column":39}},"164":{"start":{"line":303,"column":23},"end":{"line":303,"column":60}},"165":{"start":{"line":304,"column":4},"end":{"line":307,"column":5}},"166":{"start":{"line":305,"column":6},"end":{"line":305,"column":27}},"167":{"start":{"line":306,"column":6},"end":{"line":306,"column":47}},"168":{"start":{"line":310,"column":25},"end":{"line":310,"column":68}},"169":{"start":{"line":311,"column":23},"end":{"line":311,"column":67}},"170":{"start":{"line":312,"column":4},"end":{"line":315,"column":5}},"171":{"start":{"line":313,"column":6},"end":{"line":313,"column":27}},"172":{"start":{"line":314,"column":6},"end":{"line":314,"column":54}},"173":{"start":{"line":318,"column":0},"end":{"line":320,"column":28}},"174":{"start":{"line":322,"column":2},"end":{"line":322,"column":47}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":22},"end":{"line":3,"column":23}},"loc":{"start":{"line":3,"column":57},"end":{"line":10,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":44},"end":{"line":11,"column":45}},"loc":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":31,"column":2},"end":{"line":31,"column":3}},"loc":{"start":{"line":31,"column":38},"end":{"line":63,"column":3}},"line":31},"4":{"name":"(anonymous_4)","decl":{"start":{"line":34,"column":114},"end":{"line":34,"column":115}},"loc":{"start":{"line":34,"column":128},"end":{"line":36,"column":5}},"line":34},"5":{"name":"(anonymous_5)","decl":{"start":{"line":38,"column":6},"end":{"line":38,"column":7}},"loc":{"start":{"line":38,"column":20},"end":{"line":38,"column":62}},"line":38},"6":{"name":"(anonymous_6)","decl":{"start":{"line":43,"column":6},"end":{"line":43,"column":7}},"loc":{"start":{"line":43,"column":30},"end":{"line":49,"column":7}},"line":43},"7":{"name":"(anonymous_7)","decl":{"start":{"line":53,"column":15},"end":{"line":53,"column":16}},"loc":{"start":{"line":53,"column":27},"end":{"line":53,"column":33}},"line":53},"8":{"name":"(anonymous_8)","decl":{"start":{"line":57,"column":15},"end":{"line":57,"column":16}},"loc":{"start":{"line":57,"column":27},"end":{"line":57,"column":33}},"line":57},"9":{"name":"(anonymous_9)","decl":{"start":{"line":61,"column":15},"end":{"line":61,"column":16}},"loc":{"start":{"line":61,"column":27},"end":{"line":61,"column":33}},"line":61},"10":{"name":"(anonymous_10)","decl":{"start":{"line":78,"column":2},"end":{"line":78,"column":3}},"loc":{"start":{"line":78,"column":12},"end":{"line":84,"column":3}},"line":78},"11":{"name":"(anonymous_11)","decl":{"start":{"line":80,"column":38},"end":{"line":80,"column":39}},"loc":{"start":{"line":80,"column":54},"end":{"line":80,"column":74}},"line":80},"12":{"name":"(anonymous_12)","decl":{"start":{"line":94,"column":2},"end":{"line":94,"column":3}},"loc":{"start":{"line":94,"column":32},"end":{"line":101,"column":3}},"line":94},"13":{"name":"(anonymous_13)","decl":{"start":{"line":99,"column":35},"end":{"line":99,"column":36}},"loc":{"start":{"line":99,"column":45},"end":{"line":99,"column":82}},"line":99},"14":{"name":"(anonymous_14)","decl":{"start":{"line":100,"column":43},"end":{"line":100,"column":44}},"loc":{"start":{"line":100,"column":49},"end":{"line":100,"column":95}},"line":100},"15":{"name":"(anonymous_15)","decl":{"start":{"line":107,"column":2},"end":{"line":107,"column":3}},"loc":{"start":{"line":107,"column":25},"end":{"line":115,"column":3}},"line":107},"16":{"name":"(anonymous_16)","decl":{"start":{"line":108,"column":48},"end":{"line":108,"column":49}},"loc":{"start":{"line":108,"column":55},"end":{"line":108,"column":75}},"line":108},"17":{"name":"(anonymous_17)","decl":{"start":{"line":110,"column":26},"end":{"line":110,"column":27}},"loc":{"start":{"line":110,"column":33},"end":{"line":110,"column":49}},"line":110},"18":{"name":"(anonymous_18)","decl":{"start":{"line":111,"column":23},"end":{"line":111,"column":24}},"loc":{"start":{"line":111,"column":30},"end":{"line":111,"column":37}},"line":111},"19":{"name":"(anonymous_19)","decl":{"start":{"line":112,"column":26},"end":{"line":112,"column":27}},"loc":{"start":{"line":112,"column":33},"end":{"line":112,"column":49}},"line":112},"20":{"name":"(anonymous_20)","decl":{"start":{"line":113,"column":23},"end":{"line":113,"column":24}},"loc":{"start":{"line":113,"column":30},"end":{"line":113,"column":37}},"line":113},"21":{"name":"(anonymous_21)","decl":{"start":{"line":116,"column":2},"end":{"line":116,"column":3}},"loc":{"start":{"line":116,"column":37},"end":{"line":123,"column":3}},"line":116},"22":{"name":"(anonymous_22)","decl":{"start":{"line":121,"column":40},"end":{"line":121,"column":41}},"loc":{"start":{"line":121,"column":50},"end":{"line":121,"column":87}},"line":121},"23":{"name":"(anonymous_23)","decl":{"start":{"line":122,"column":43},"end":{"line":122,"column":44}},"loc":{"start":{"line":122,"column":49},"end":{"line":122,"column":100}},"line":122},"24":{"name":"(anonymous_24)","decl":{"start":{"line":124,"column":2},"end":{"line":124,"column":3}},"loc":{"start":{"line":124,"column":28},"end":{"line":130,"column":3}},"line":124},"25":{"name":"(anonymous_25)","decl":{"start":{"line":125,"column":53},"end":{"line":125,"column":54}},"loc":{"start":{"line":125,"column":60},"end":{"line":125,"column":80}},"line":125},"26":{"name":"(anonymous_26)","decl":{"start":{"line":127,"column":23},"end":{"line":127,"column":24}},"loc":{"start":{"line":127,"column":30},"end":{"line":127,"column":37}},"line":127},"27":{"name":"(anonymous_27)","decl":{"start":{"line":128,"column":23},"end":{"line":128,"column":24}},"loc":{"start":{"line":128,"column":30},"end":{"line":128,"column":37}},"line":128},"28":{"name":"(anonymous_28)","decl":{"start":{"line":140,"column":2},"end":{"line":140,"column":3}},"loc":{"start":{"line":140,"column":38},"end":{"line":147,"column":3}},"line":140},"29":{"name":"(anonymous_29)","decl":{"start":{"line":145,"column":40},"end":{"line":145,"column":41}},"loc":{"start":{"line":145,"column":50},"end":{"line":145,"column":87}},"line":145},"30":{"name":"(anonymous_30)","decl":{"start":{"line":146,"column":43},"end":{"line":146,"column":44}},"loc":{"start":{"line":146,"column":49},"end":{"line":146,"column":100}},"line":146},"31":{"name":"(anonymous_31)","decl":{"start":{"line":153,"column":2},"end":{"line":153,"column":3}},"loc":{"start":{"line":153,"column":35},"end":{"line":156,"column":3}},"line":153},"32":{"name":"(anonymous_32)","decl":{"start":{"line":154,"column":84},"end":{"line":154,"column":85}},"loc":{"start":{"line":154,"column":91},"end":{"line":154,"column":111}},"line":154},"33":{"name":"(anonymous_33)","decl":{"start":{"line":155,"column":36},"end":{"line":155,"column":37}},"loc":{"start":{"line":155,"column":49},"end":{"line":155,"column":56}},"line":155},"34":{"name":"(anonymous_34)","decl":{"start":{"line":164,"column":2},"end":{"line":164,"column":3}},"loc":{"start":{"line":164,"column":31},"end":{"line":171,"column":3}},"line":164},"35":{"name":"(anonymous_35)","decl":{"start":{"line":169,"column":33},"end":{"line":169,"column":34}},"loc":{"start":{"line":169,"column":43},"end":{"line":169,"column":80}},"line":169},"36":{"name":"(anonymous_36)","decl":{"start":{"line":170,"column":43},"end":{"line":170,"column":44}},"loc":{"start":{"line":170,"column":49},"end":{"line":170,"column":93}},"line":170},"37":{"name":"(anonymous_37)","decl":{"start":{"line":172,"column":2},"end":{"line":172,"column":3}},"loc":{"start":{"line":172,"column":34},"end":{"line":180,"column":3}},"line":172},"38":{"name":"(anonymous_38)","decl":{"start":{"line":173,"column":46},"end":{"line":173,"column":47}},"loc":{"start":{"line":173,"column":53},"end":{"line":173,"column":73}},"line":173},"39":{"name":"(anonymous_39)","decl":{"start":{"line":175,"column":26},"end":{"line":175,"column":27}},"loc":{"start":{"line":175,"column":33},"end":{"line":175,"column":49}},"line":175},"40":{"name":"(anonymous_40)","decl":{"start":{"line":176,"column":23},"end":{"line":176,"column":24}},"loc":{"start":{"line":176,"column":30},"end":{"line":176,"column":37}},"line":176},"41":{"name":"(anonymous_41)","decl":{"start":{"line":177,"column":26},"end":{"line":177,"column":27}},"loc":{"start":{"line":177,"column":33},"end":{"line":177,"column":49}},"line":177},"42":{"name":"(anonymous_42)","decl":{"start":{"line":178,"column":23},"end":{"line":178,"column":24}},"loc":{"start":{"line":178,"column":30},"end":{"line":178,"column":37}},"line":178},"43":{"name":"(anonymous_43)","decl":{"start":{"line":183,"column":2},"end":{"line":183,"column":3}},"loc":{"start":{"line":183,"column":55},"end":{"line":194,"column":3}},"line":183},"44":{"name":"(anonymous_44)","decl":{"start":{"line":196,"column":2},"end":{"line":196,"column":3}},"loc":{"start":{"line":196,"column":48},"end":{"line":206,"column":3}},"line":196},"45":{"name":"(anonymous_45)","decl":{"start":{"line":207,"column":2},"end":{"line":207,"column":3}},"loc":{"start":{"line":207,"column":31},"end":{"line":238,"column":3}},"line":207},"46":{"name":"(anonymous_46)","decl":{"start":{"line":214,"column":49},"end":{"line":214,"column":50}},"loc":{"start":{"line":214,"column":59},"end":{"line":214,"column":96}},"line":214},"47":{"name":"(anonymous_47)","decl":{"start":{"line":222,"column":34},"end":{"line":222,"column":35}},"loc":{"start":{"line":222,"column":41},"end":{"line":222,"column":102}},"line":222},"48":{"name":"(anonymous_48)","decl":{"start":{"line":226,"column":34},"end":{"line":226,"column":35}},"loc":{"start":{"line":226,"column":41},"end":{"line":226,"column":102}},"line":226},"49":{"name":"(anonymous_49)","decl":{"start":{"line":228,"column":45},"end":{"line":228,"column":46}},"loc":{"start":{"line":228,"column":51},"end":{"line":233,"column":7}},"line":228},"50":{"name":"(anonymous_50)","decl":{"start":{"line":236,"column":45},"end":{"line":236,"column":46}},"loc":{"start":{"line":236,"column":51},"end":{"line":236,"column":105}},"line":236},"51":{"name":"(anonymous_51)","decl":{"start":{"line":239,"column":2},"end":{"line":239,"column":3}},"loc":{"start":{"line":239,"column":55},"end":{"line":252,"column":3}},"line":239},"52":{"name":"(anonymous_52)","decl":{"start":{"line":253,"column":2},"end":{"line":253,"column":3}},"loc":{"start":{"line":253,"column":31},"end":{"line":300,"column":3}},"line":253},"53":{"name":"(anonymous_53)","decl":{"start":{"line":257,"column":31},"end":{"line":257,"column":32}},"loc":{"start":{"line":257,"column":46},"end":{"line":294,"column":5}},"line":257},"54":{"name":"(anonymous_54)","decl":{"start":{"line":259,"column":37},"end":{"line":259,"column":38}},"loc":{"start":{"line":259,"column":52},"end":{"line":293,"column":7}},"line":259},"55":{"name":"(anonymous_55)","decl":{"start":{"line":263,"column":10},"end":{"line":263,"column":11}},"loc":{"start":{"line":263,"column":49},"end":{"line":277,"column":11}},"line":263},"56":{"name":"(anonymous_56)","decl":{"start":{"line":280,"column":10},"end":{"line":280,"column":11}},"loc":{"start":{"line":280,"column":30},"end":{"line":291,"column":11}},"line":280},"57":{"name":"(anonymous_57)","decl":{"start":{"line":295,"column":33},"end":{"line":295,"column":34}},"loc":{"start":{"line":295,"column":48},"end":{"line":295,"column":77}},"line":295},"58":{"name":"(anonymous_58)","decl":{"start":{"line":296,"column":53},"end":{"line":296,"column":54}},"loc":{"start":{"line":296,"column":68},"end":{"line":296,"column":97}},"line":296},"59":{"name":"(anonymous_59)","decl":{"start":{"line":297,"column":33},"end":{"line":297,"column":34}},"loc":{"start":{"line":297,"column":39},"end":{"line":297,"column":132}},"line":297},"60":{"name":"(anonymous_60)","decl":{"start":{"line":297,"column":68},"end":{"line":297,"column":69}},"loc":{"start":{"line":297,"column":83},"end":{"line":297,"column":131}},"line":297},"61":{"name":"(anonymous_61)","decl":{"start":{"line":298,"column":54},"end":{"line":298,"column":55}},"loc":{"start":{"line":298,"column":69},"end":{"line":298,"column":117}},"line":298},"62":{"name":"(anonymous_62)","decl":{"start":{"line":301,"column":2},"end":{"line":301,"column":3}},"loc":{"start":{"line":301,"column":40},"end":{"line":308,"column":3}},"line":301},"63":{"name":"(anonymous_63)","decl":{"start":{"line":309,"column":2},"end":{"line":309,"column":3}},"loc":{"start":{"line":309,"column":46},"end":{"line":316,"column":3}},"line":309},"64":{"name":"getWorksheetDisposableID","decl":{"start":{"line":321,"column":9},"end":{"line":321,"column":33}},"loc":{"start":{"line":321,"column":53},"end":{"line":323,"column":1}},"line":321}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":26},"end":{"line":4,"column":32}},{"start":{"line":4,"column":35},"end":{"line":4,"column":80}}],"line":4},"1":{"loc":{"start":{"line":4,"column":35},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":42},"end":{"line":4,"column":71}},{"start":{"line":4,"column":74},"end":{"line":4,"column":80}}],"line":4},"2":{"loc":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"type":"if","locations":[{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},{"start":{},"end":{}}],"line":6},"3":{"loc":{"start":{"line":7,"column":15},"end":{"line":7,"column":84}},"type":"binary-expr","locations":[{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},{"start":{"line":7,"column":78},"end":{"line":7,"column":84}}],"line":7},"4":{"loc":{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},"type":"cond-expr","locations":[{"start":{"line":7,"column":23},"end":{"line":7,"column":53}},{"start":{"line":7,"column":56},"end":{"line":7,"column":73}}],"line":7},"5":{"loc":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},{"start":{},"end":{}}],"line":8},"6":{"loc":{"start":{"line":8,"column":6},"end":{"line":8,"column":20}},"type":"binary-expr","locations":[{"start":{"line":8,"column":6},"end":{"line":8,"column":10}},{"start":{"line":8,"column":14},"end":{"line":8,"column":20}}],"line":8},"7":{"loc":{"start":{"line":45,"column":8},"end":{"line":47,"column":9}},"type":"if","locations":[{"start":{"line":45,"column":8},"end":{"line":47,"column":9}},{"start":{},"end":{}}],"line":45},"8":{"loc":{"start":{"line":95,"column":4},"end":{"line":97,"column":5}},"type":"if","locations":[{"start":{"line":95,"column":4},"end":{"line":97,"column":5}},{"start":{},"end":{}}],"line":95},"9":{"loc":{"start":{"line":99,"column":46},"end":{"line":99,"column":61}},"type":"binary-expr","locations":[{"start":{"line":99,"column":46},"end":{"line":99,"column":56}},{"start":{"line":99,"column":60},"end":{"line":99,"column":61}}],"line":99},"10":{"loc":{"start":{"line":99,"column":66},"end":{"line":99,"column":81}},"type":"binary-expr","locations":[{"start":{"line":99,"column":66},"end":{"line":99,"column":76}},{"start":{"line":99,"column":80},"end":{"line":99,"column":81}}],"line":99},"11":{"loc":{"start":{"line":110,"column":33},"end":{"line":110,"column":49}},"type":"binary-expr","locations":[{"start":{"line":110,"column":33},"end":{"line":110,"column":43}},{"start":{"line":110,"column":47},"end":{"line":110,"column":49}}],"line":110},"12":{"loc":{"start":{"line":112,"column":33},"end":{"line":112,"column":49}},"type":"binary-expr","locations":[{"start":{"line":112,"column":33},"end":{"line":112,"column":43}},{"start":{"line":112,"column":47},"end":{"line":112,"column":49}}],"line":112},"13":{"loc":{"start":{"line":117,"column":4},"end":{"line":119,"column":5}},"type":"if","locations":[{"start":{"line":117,"column":4},"end":{"line":119,"column":5}},{"start":{},"end":{}}],"line":117},"14":{"loc":{"start":{"line":121,"column":51},"end":{"line":121,"column":66}},"type":"binary-expr","locations":[{"start":{"line":121,"column":51},"end":{"line":121,"column":61}},{"start":{"line":121,"column":65},"end":{"line":121,"column":66}}],"line":121},"15":{"loc":{"start":{"line":121,"column":71},"end":{"line":121,"column":86}},"type":"binary-expr","locations":[{"start":{"line":121,"column":71},"end":{"line":121,"column":81}},{"start":{"line":121,"column":85},"end":{"line":121,"column":86}}],"line":121},"16":{"loc":{"start":{"line":141,"column":4},"end":{"line":143,"column":5}},"type":"if","locations":[{"start":{"line":141,"column":4},"end":{"line":143,"column":5}},{"start":{},"end":{}}],"line":141},"17":{"loc":{"start":{"line":145,"column":51},"end":{"line":145,"column":66}},"type":"binary-expr","locations":[{"start":{"line":145,"column":51},"end":{"line":145,"column":61}},{"start":{"line":145,"column":65},"end":{"line":145,"column":66}}],"line":145},"18":{"loc":{"start":{"line":145,"column":71},"end":{"line":145,"column":86}},"type":"binary-expr","locations":[{"start":{"line":145,"column":71},"end":{"line":145,"column":81}},{"start":{"line":145,"column":85},"end":{"line":145,"column":86}}],"line":145},"19":{"loc":{"start":{"line":165,"column":4},"end":{"line":167,"column":5}},"type":"if","locations":[{"start":{"line":165,"column":4},"end":{"line":167,"column":5}},{"start":{},"end":{}}],"line":165},"20":{"loc":{"start":{"line":169,"column":44},"end":{"line":169,"column":59}},"type":"binary-expr","locations":[{"start":{"line":169,"column":44},"end":{"line":169,"column":54}},{"start":{"line":169,"column":58},"end":{"line":169,"column":59}}],"line":169},"21":{"loc":{"start":{"line":169,"column":64},"end":{"line":169,"column":79}},"type":"binary-expr","locations":[{"start":{"line":169,"column":64},"end":{"line":169,"column":74}},{"start":{"line":169,"column":78},"end":{"line":169,"column":79}}],"line":169},"22":{"loc":{"start":{"line":175,"column":33},"end":{"line":175,"column":49}},"type":"binary-expr","locations":[{"start":{"line":175,"column":33},"end":{"line":175,"column":43}},{"start":{"line":175,"column":47},"end":{"line":175,"column":49}}],"line":175},"23":{"loc":{"start":{"line":177,"column":33},"end":{"line":177,"column":49}},"type":"binary-expr","locations":[{"start":{"line":177,"column":33},"end":{"line":177,"column":43}},{"start":{"line":177,"column":47},"end":{"line":177,"column":49}}],"line":177},"24":{"loc":{"start":{"line":209,"column":4},"end":{"line":211,"column":5}},"type":"if","locations":[{"start":{"line":209,"column":4},"end":{"line":211,"column":5}},{"start":{},"end":{}}],"line":209},"25":{"loc":{"start":{"line":214,"column":60},"end":{"line":214,"column":75}},"type":"binary-expr","locations":[{"start":{"line":214,"column":60},"end":{"line":214,"column":70}},{"start":{"line":214,"column":74},"end":{"line":214,"column":75}}],"line":214},"26":{"loc":{"start":{"line":214,"column":80},"end":{"line":214,"column":95}},"type":"binary-expr","locations":[{"start":{"line":214,"column":80},"end":{"line":214,"column":90}},{"start":{"line":214,"column":94},"end":{"line":214,"column":95}}],"line":214},"27":{"loc":{"start":{"line":216,"column":4},"end":{"line":237,"column":5}},"type":"if","locations":[{"start":{"line":216,"column":4},"end":{"line":237,"column":5}},{"start":{"line":234,"column":11},"end":{"line":237,"column":5}}],"line":216},"28":{"loc":{"start":{"line":222,"column":43},"end":{"line":222,"column":66}},"type":"binary-expr","locations":[{"start":{"line":222,"column":43},"end":{"line":222,"column":51}},{"start":{"line":222,"column":55},"end":{"line":222,"column":66}}],"line":222},"29":{"loc":{"start":{"line":226,"column":43},"end":{"line":226,"column":66}},"type":"binary-expr","locations":[{"start":{"line":226,"column":43},"end":{"line":226,"column":51}},{"start":{"line":226,"column":55},"end":{"line":226,"column":66}}],"line":226},"30":{"loc":{"start":{"line":240,"column":23},"end":{"line":240,"column":69}},"type":"cond-expr","locations":[{"start":{"line":240,"column":43},"end":{"line":240,"column":47}},{"start":{"line":240,"column":50},"end":{"line":240,"column":69}}],"line":240},"31":{"loc":{"start":{"line":241,"column":16},"end":{"line":241,"column":34}},"type":"binary-expr","locations":[{"start":{"line":241,"column":16},"end":{"line":241,"column":20}},{"start":{"line":241,"column":24},"end":{"line":241,"column":34}}],"line":241},"32":{"loc":{"start":{"line":243,"column":4},"end":{"line":250,"column":5}},"type":"if","locations":[{"start":{"line":243,"column":4},"end":{"line":250,"column":5}},{"start":{},"end":{}}],"line":243},"33":{"loc":{"start":{"line":243,"column":8},"end":{"line":243,"column":44}},"type":"binary-expr","locations":[{"start":{"line":243,"column":8},"end":{"line":243,"column":17}},{"start":{"line":243,"column":21},"end":{"line":243,"column":44}}],"line":243},"34":{"loc":{"start":{"line":245,"column":6},"end":{"line":247,"column":7}},"type":"if","locations":[{"start":{"line":245,"column":6},"end":{"line":247,"column":7}},{"start":{},"end":{}}],"line":245},"35":{"loc":{"start":{"line":245,"column":10},"end":{"line":245,"column":32}},"type":"binary-expr","locations":[{"start":{"line":245,"column":10},"end":{"line":245,"column":22}},{"start":{"line":245,"column":26},"end":{"line":245,"column":32}}],"line":245},"36":{"loc":{"start":{"line":248,"column":37},"end":{"line":248,"column":55}},"type":"binary-expr","locations":[{"start":{"line":248,"column":37},"end":{"line":248,"column":49}},{"start":{"line":248,"column":53},"end":{"line":248,"column":55}}],"line":248},"37":{"loc":{"start":{"line":304,"column":4},"end":{"line":307,"column":5}},"type":"if","locations":[{"start":{"line":304,"column":4},"end":{"line":307,"column":5}},{"start":{},"end":{}}],"line":304},"38":{"loc":{"start":{"line":312,"column":4},"end":{"line":315,"column":5}},"type":"if","locations":[{"start":{"line":312,"column":4},"end":{"line":315,"column":5}},{"start":{},"end":{}}],"line":312}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":5,"19":5,"20":5,"21":5,"22":5,"23":0,"24":5,"25":0,"26":0,"27":0,"28":0,"29":5,"30":0,"31":5,"32":0,"33":5,"34":0,"35":5,"36":5,"37":5,"38":5,"39":5,"40":5,"41":5,"42":5,"43":5,"44":5,"45":5,"46":5,"47":5,"48":5,"49":5,"50":5,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":5,"59":0,"60":5,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":5,"107":5,"108":5,"109":5,"110":5,"111":5,"112":0,"113":5,"114":5,"115":5,"116":5,"117":5,"118":5,"119":5,"120":5,"121":5,"122":5,"123":5,"124":5,"125":5,"126":5,"127":0,"128":0,"129":0,"130":29,"131":29,"132":29,"133":29,"134":29,"135":29,"136":0,"137":29,"138":29,"139":29,"140":5,"141":5,"142":5,"143":5,"144":5,"145":5,"146":5,"147":5,"148":5,"149":0,"150":0,"151":5,"152":29,"153":5,"154":5,"155":5,"156":0,"157":5,"158":5,"159":5,"160":5,"161":0,"162":5,"163":0,"164":0,"165":0,"166":0,"167":0,"168":5,"169":5,"170":5,"171":5,"172":5,"173":1,"174":10},"f":{"0":1,"1":1,"2":1,"3":5,"4":5,"5":0,"6":0,"7":0,"8":0,"9":0,"10":5,"11":5,"12":0,"13":0,"14":0,"15":5,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":5,"46":0,"47":5,"48":5,"49":5,"50":0,"51":29,"52":5,"53":5,"54":5,"55":0,"56":29,"57":5,"58":0,"59":5,"60":5,"61":0,"62":0,"63":5,"64":10},"b":{"0":[0,1],"1":[0,1],"2":[1,0],"3":[1,1],"4":[0,1],"5":[0,1],"6":[1,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[5,0],"25":[0,0],"26":[0,0],"27":[5,0],"28":[5,0],"29":[5,0],"30":[29,0],"31":[29,29],"32":[29,0],"33":[29,25],"34":[0,29],"35":[29,0],"36":[29,29],"37":[0,0],"38":[5,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/sheet-interceptor/sheet-interceptor.service.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable ts/no-explicit-any */\n\nimport type {\n    ICellData,\n    ICellDataForSheetInterceptor,\n    ICellInterceptor,\n    ICommandInfo,\n    IComposeInterceptors,\n    IDisposable,\n    IInterceptor,\n    IRange,\n    IUndoRedoCommandInfosByInterceptor,\n    Nullable,\n    Workbook,\n    Worksheet,\n} from '@univerjs/core';\nimport type { ISheetLocation } from './utils/interceptor';\n\nimport {\n    composeInterceptors,\n    createInterceptorKey,\n    Disposable,\n    DisposableCollection,\n    InterceptorEffectEnum,\n    InterceptorManager,\n    IUniverInstanceService,\n    remove,\n    toDisposable,\n    Tools,\n    UniverInstanceType,\n} from '@univerjs/core';\nimport { INTERCEPTOR_POINT } from './interceptor-const';\n\nexport interface IBeforeCommandInterceptor {\n    priority?: number;\n    performCheck(info: ICommandInfo): Promise<boolean>;\n}\n\nexport interface ICommandInterceptor {\n    priority?: number;\n    getMutations(command: ICommandInfo): IUndoRedoCommandInfosByInterceptor;\n}\n\nexport interface IRangesInfo {\n    unitId: string;\n    subUnitId: string;\n    ranges: IRange[];\n}\n\nexport interface IRangeInterceptors {\n    priority?: number;\n    getMutations(rangesInfo: IRangesInfo): IUndoRedoCommandInfosByInterceptor;\n}\n\ninterface ISheetLocationForEditor extends ISheetLocation {\n    origin: Nullable<ICellData>;\n}\n\nexport const BEFORE_CELL_EDIT = createInterceptorKey<ICellDataForSheetInterceptor, ISheetLocationForEditor>('BEFORE_CELL_EDIT');\nexport const AFTER_CELL_EDIT = createInterceptorKey<ICellDataForSheetInterceptor, ISheetLocationForEditor>('AFTER_CELL_EDIT');\nexport const VALIDATE_CELL = createInterceptorKey<Promise<boolean>, ISheetLocation>('VALIDATE_CELL');\n\n/**\n * This class expose methods for sheet features to inject code to sheet underlying logic.\n */\nexport class SheetInterceptorService extends Disposable {\n    private _interceptorsByName: Map<string, Array<IInterceptor<unknown, unknown>>> = new Map();\n    private _commandInterceptors: ICommandInterceptor[] = [];\n    private _rangeInterceptors: IRangeInterceptors[] = [];\n\n    private _beforeCommandInterceptor: IBeforeCommandInterceptor[] = [];\n    private _afterCommandInterceptors: ICommandInterceptor[] = [];\n\n    private readonly _workbookDisposables = new Map<string, IDisposable>();\n    private readonly _worksheetDisposables = new Map<string, IDisposable>();\n\n    private _interceptorsDirty = false;\n    private _composedInterceptorByKey: Map<string, ReturnType<IComposeInterceptors<any, any>>> = new Map();\n\n    readonly writeCellInterceptor = new InterceptorManager({\n        BEFORE_CELL_EDIT,\n        AFTER_CELL_EDIT,\n        VALIDATE_CELL,\n    });\n\n    /** @ignore */\n    constructor(\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService\n    ) {\n        super();\n\n        // When a workbook is created or a worksheet is added after when workbook is created,\n        // `SheetInterceptorService` inject interceptors to worksheet instances to it.\n        this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$<Workbook>(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) => {\n            this._interceptWorkbook(workbook);\n        }));\n\n        this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$<Workbook>(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) =>\n            this._disposeWorkbookInterceptor(workbook)\n        ));\n\n        // register default viewModel interceptor\n        this.intercept(INTERCEPTOR_POINT.CELL_CONTENT, {\n            priority: -1,\n            effect: InterceptorEffectEnum.Style | InterceptorEffectEnum.Value,\n            handler(value, context): Nullable<ICellData> {\n                const rawData = context.worksheet.getCellRaw(context.row, context.col);\n                if (value) {\n                    return { ...rawData, ...value };\n                }\n\n                return rawData;\n            },\n        });\n\n        this.disposeWithMe(this.writeCellInterceptor.intercept(AFTER_CELL_EDIT, {\n            priority: -1,\n            handler: (_value) => _value,\n        }));\n\n        this.disposeWithMe(this.writeCellInterceptor.intercept(BEFORE_CELL_EDIT, {\n            priority: -1,\n            handler: (_value) => _value,\n        }));\n\n        this.disposeWithMe(this.writeCellInterceptor.intercept(VALIDATE_CELL, {\n            priority: -1,\n            handler: (_value) => _value,\n        }));\n    }\n\n    override dispose(): void {\n        super.dispose();\n\n        this._workbookDisposables.forEach((disposable) => disposable.dispose());\n        this._workbookDisposables.clear();\n        this._worksheetDisposables.clear();\n\n        this._interceptorsByName.clear();\n    }\n\n    // #region intercept command execution\n\n    /**\n     * Add a listener function to a specific command to add affiliated mutations. It should be called in controllers.\n     *\n     * Pairs with {@link onCommandExecute}.\n     *\n     * @param interceptor\n     * @returns\n     */\n    interceptCommand(interceptor: ICommandInterceptor): IDisposable {\n        if (this._commandInterceptors.includes(interceptor)) {\n            throw new Error('[SheetInterceptorService]: Interceptor already exists!');\n        }\n\n        this._commandInterceptors.push(interceptor);\n        this._commandInterceptors.sort((a, b) => (b.priority ?? 0) - (a.priority ?? 0));\n\n        return this.disposeWithMe(toDisposable(() => remove(this._commandInterceptors, interceptor)));\n    }\n\n    /**\n     * When command is executing, call this method to gether undo redo mutations from upper features.\n     * @param command\n     * @returns\n     */\n    onCommandExecute(info: ICommandInfo): IUndoRedoCommandInfosByInterceptor {\n        const infos = this._commandInterceptors.map((i) => i.getMutations(info));\n\n        return {\n            preUndos: infos.map((i) => i.preUndos ?? []).flat(),\n            undos: infos.map((i) => i.undos).flat(),\n            preRedos: infos.map((i) => i.preRedos ?? []).flat(),\n            redos: infos.map((i) => i.redos).flat(),\n        };\n    }\n\n    interceptAfterCommand(interceptor: ICommandInterceptor): IDisposable {\n        if (this._afterCommandInterceptors.includes(interceptor)) {\n            throw new Error('[SheetInterceptorService]: Interceptor already exists!');\n        }\n\n        this._afterCommandInterceptors.push(interceptor);\n        this._afterCommandInterceptors.sort((a, b) => (b.priority ?? 0) - (a.priority ?? 0));\n\n        return this.disposeWithMe(toDisposable(() => remove(this._afterCommandInterceptors, interceptor)));\n    }\n\n    afterCommandExecute(info: ICommandInfo): IUndoRedoCommandInfosByInterceptor {\n        const infos = this._afterCommandInterceptors.map((i) => i.getMutations(info));\n\n        return {\n            undos: infos.map((i) => i.undos).flat(),\n            redos: infos.map((i) => i.redos).flat(),\n        };\n    }\n\n    /**\n     * Add a listener function to a specific command to determine if the command can execute mutations. It should be\n     * called in controllers.\n     *\n     * Pairs with {@link beforeCommandExecute}.\n     *\n     * @param interceptor\n     * @returns\n     */\n    interceptBeforeCommand(interceptor: IBeforeCommandInterceptor): IDisposable {\n        if (this._beforeCommandInterceptor.includes(interceptor)) {\n            throw new Error('[SheetInterceptorService]: Interceptor already exists!');\n        }\n\n        this._beforeCommandInterceptor.push(interceptor);\n        this._beforeCommandInterceptor.sort((a, b) => (b.priority ?? 0) - (a.priority ?? 0));\n\n        return this.disposeWithMe(toDisposable(() => remove(this._beforeCommandInterceptor, interceptor)));\n    }\n\n    /**\n     * before command execute, call this method to get the flag of whether it can be executed the command，\n     * @param info ICommandInfo\n     * @returns Promise<boolean>\n     */\n    async beforeCommandExecute(info: ICommandInfo): Promise<boolean> {\n        const allPerformCheckRes = await Promise.all(this._beforeCommandInterceptor.map((i) => i.performCheck(info)));\n        return allPerformCheckRes.every((perform) => perform);\n    }\n\n    // #endregion\n\n    // #region intercept ranges - mainly for pivot table currently (2024/10/28).\n\n    /**\n     * By adding callbacks to some Ranges can get some additional mutations, such as clearing all plugin data in a certain area.\n     * @param interceptor IRangeInterceptors\n     * @returns IDisposable\n     */\n    interceptRanges(interceptor: IRangeInterceptors): IDisposable {\n        if (this._rangeInterceptors.includes(interceptor)) {\n            throw new Error('[SheetInterceptorService]: Interceptor already exists!');\n        }\n\n        this._rangeInterceptors.push(interceptor);\n        this._rangeInterceptors.sort((a, b) => (b.priority ?? 0) - (a.priority ?? 0));\n\n        return this.disposeWithMe(toDisposable(() => remove(this._rangeInterceptors, interceptor)));\n    }\n\n    generateMutationsByRanges(info: IRangesInfo): IUndoRedoCommandInfosByInterceptor {\n        const infos = this._rangeInterceptors.map((i) => i.getMutations(info));\n\n        return {\n            preUndos: infos.map((i) => i.preUndos ?? []).flat(),\n            undos: infos.map((i) => i.undos).flat(),\n            preRedos: infos.map((i) => i.preRedos ?? []).flat(),\n            redos: infos.map((i) => i.redos).flat(),\n        };\n    }\n\n    // #endregion\n\n    // #region intercept on writing cell\n\n    onWriteCell(workbook: Workbook, worksheet: Worksheet, row: number, col: number, cellData: ICellData) {\n        const context = {\n            subUnitId: worksheet.getSheetId(),\n            unitId: workbook.getUnitId(),\n            workbook: workbook!,\n            worksheet,\n            row,\n            col,\n            origin: Tools.deepClone(cellData),\n        };\n\n        return this.writeCellInterceptor.fetchThroughInterceptors(AFTER_CELL_EDIT)(cellData, context);\n    }\n\n    // #endregion\n\n    onValidateCell(workbook: Workbook, worksheet: Worksheet, row: number, col: number) {\n        const context: ISheetLocation = {\n            subUnitId: worksheet.getSheetId(),\n            unitId: workbook.getUnitId(),\n            workbook: workbook!,\n            worksheet,\n            row,\n            col,\n        };\n\n        return this.writeCellInterceptor.fetchThroughInterceptors(VALIDATE_CELL)(Promise.resolve(true), context);\n    }\n\n    intercept<T extends IInterceptor<any, any>>(name: T, interceptor: T): IDisposable {\n        const key = name as unknown as string;\n        if (!this._interceptorsByName.has(key)) {\n            this._interceptorsByName.set(key, []);\n        }\n\n        const interceptors = this._interceptorsByName.get(key)!;\n        interceptors.push(interceptor);\n        const sortedInterceptors = interceptors.sort((a, b) => (b.priority ?? 0) - (a.priority ?? 0));\n\n        this._interceptorsDirty = true;\n\n        if (key === INTERCEPTOR_POINT.CELL_CONTENT as unknown as string) {\n            const JOINED_EFFECT = InterceptorEffectEnum.Style | InterceptorEffectEnum.Value;\n            this._interceptorsByName.set(`${key}-${JOINED_EFFECT}`, sortedInterceptors);\n\n            const BOTH_EFFECT = InterceptorEffectEnum.Style | InterceptorEffectEnum.Value;\n            this._interceptorsByName.set(\n                `${key}-${(InterceptorEffectEnum.Style)}`,\n                (sortedInterceptors as ICellInterceptor<unknown, unknown>[]).filter((i) => ((i.effect || BOTH_EFFECT) & InterceptorEffectEnum.Style) > 0)\n            );\n            this._interceptorsByName.set(\n                `${key}-${(InterceptorEffectEnum.Value)}`,\n                (sortedInterceptors as ICellInterceptor<unknown, unknown>[]).filter((i) => ((i.effect || BOTH_EFFECT) & InterceptorEffectEnum.Value) > 0)\n            );\n\n            return this.disposeWithMe(toDisposable(() => {\n                remove(this._interceptorsByName.get(key)!, interceptor);\n                remove(this._interceptorsByName.get(`${key}-${JOINED_EFFECT}`)!, interceptor);\n                remove(this._interceptorsByName.get(`${key}-${(InterceptorEffectEnum.Style)}`)!, interceptor);\n                remove(this._interceptorsByName.get(`${key}-${(InterceptorEffectEnum.Value)}`)!, interceptor);\n            }));\n        } else {\n            this._interceptorsByName.set(key, sortedInterceptors);\n            return this.disposeWithMe(toDisposable(() => remove(this._interceptorsByName.get(key)!, interceptor)));\n        }\n    }\n\n    fetchThroughInterceptors<T, C>(\n        name: IInterceptor<T, C>,\n        effect?: InterceptorEffectEnum,\n        _key?: string,\n        filter?: (interceptor: IInterceptor<any, any>) => boolean\n    ): ReturnType<IComposeInterceptors<T, C>> {\n        const byNamesKey = effect === undefined ? name as unknown as string : `${name as unknown as string}-${effect}`;\n        const key = _key ?? byNamesKey;\n        let composed = this._composedInterceptorByKey.get(key);\n\n        if (!composed || this._interceptorsDirty) {\n            let interceptors = this._interceptorsByName.get(byNamesKey) as unknown as Array<IInterceptor<any, any>> | undefined;\n            if (interceptors && filter) {\n                interceptors = interceptors.filter(filter);\n            }\n\n            composed = composeInterceptors<T, C>(interceptors || []);\n            this._composedInterceptorByKey.set(key, composed);\n        }\n\n        return composed;\n    }\n\n    private _interceptWorkbook(workbook: Workbook): void {\n        const disposables = new DisposableCollection();\n        const unitId = workbook.getUnitId();\n\n        // eslint-disable-next-line ts/no-this-alias\n        const sheetInterceptorService = this;\n        const interceptViewModel = (worksheet: Worksheet): void => {\n            const subUnitId = worksheet.getSheetId();\n            worksheet.__interceptViewModel((viewModel) => {\n                const sheetDisposables = new DisposableCollection();\n                sheetInterceptorService._worksheetDisposables.set(getWorksheetDisposableID(unitId, worksheet), sheetDisposables);\n\n                sheetDisposables.add(viewModel.registerCellContentInterceptor({\n                    getCell(\n                        row: number,\n                        col: number,\n                        effect: InterceptorEffectEnum,\n                        key?: string,\n                        filter?: (interceptor: IInterceptor<any, any>) => boolean\n                    ): Nullable<ICellData> {\n                        const rawData = worksheet.getCellRaw(row, col);\n                        return sheetInterceptorService.fetchThroughInterceptors(INTERCEPTOR_POINT.CELL_CONTENT, effect, key, filter)(\n                            rawData,\n                            {\n                                unitId,\n                                subUnitId,\n                                row,\n                                col,\n                                worksheet,\n                                workbook,\n                                rawData,\n                            }\n                        );\n                    },\n                }));\n\n                sheetDisposables.add(viewModel.registerRowFilteredInterceptor({\n                    getRowFiltered(row: number): boolean {\n                        return !!sheetInterceptorService.fetchThroughInterceptors(INTERCEPTOR_POINT.ROW_FILTERED)(\n                            false,\n                            {\n                                unitId,\n                                subUnitId,\n                                row,\n                                workbook,\n                                worksheet,\n                            }\n                        );\n                    },\n                }));\n            });\n        };\n\n        // We should intercept all instantiated worksheet and should subscribe to\n        // worksheet creation event to intercept newly created worksheet.\n        workbook.getSheets().forEach((worksheet) => interceptViewModel(worksheet));\n        disposables.add(workbook.sheetCreated$.subscribe((worksheet) => interceptViewModel(worksheet)));\n\n        // Dispose all underlying interceptors when workbook is disposed.\n        disposables.add(toDisposable(() => workbook.getSheets().forEach((worksheet) => this._disposeSheetInterceptor(unitId, worksheet))));\n        // Dispose interceptor when a worksheet is destroyed.\n        disposables.add(workbook.sheetDisposed$.subscribe((worksheet) => this._disposeSheetInterceptor(unitId, worksheet)));\n\n        this._workbookDisposables.set(unitId, disposables);\n    }\n\n    private _disposeWorkbookInterceptor(workbook: Workbook): void {\n        const unitId = workbook.getUnitId();\n        const disposable = this._workbookDisposables.get(unitId);\n\n        if (disposable) {\n            disposable.dispose();\n            this._workbookDisposables.delete(unitId);\n        }\n    }\n\n    private _disposeSheetInterceptor(unitId: string, worksheet: Worksheet): void {\n        const disposableId = getWorksheetDisposableID(unitId, worksheet);\n        const disposable = this._worksheetDisposables.get(disposableId);\n\n        if (disposable) {\n            disposable.dispose();\n            this._worksheetDisposables.delete(disposableId);\n        }\n    }\n}\n\nfunction getWorksheetDisposableID(unitId: string, worksheet: Worksheet): string {\n    return `${unitId}|${worksheet.getSheetId()}`;\n}\n"],"mappings":";;;;;;;;;;;AAkCA;AAAA,EACI;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,OACG;AACP,SAAS,yBAAyB;AA2B3B,aAAM,mBAAmB,qBAA4E,kBAAkB;AACvH,aAAM,kBAAkB,qBAA4E,iBAAiB;AACrH,aAAM,gBAAgB,qBAAuD,eAAe;AAK5F,WAAM,0BAAN,cAAsC,WAAW;AAAA;AAAA,EAqBpD,YAC6C,wBAC3C;AACE,UAAM;AAFmC;AAMzC,SAAK,cAAc,KAAK,uBAAuB,oBAA8B,mBAAmB,YAAY,EAAE,UAAU,CAAC,aAAa;AAClI,WAAK,mBAAmB,QAAQ;AAAA,IACpC,CAAC,CAAC;AAEF,SAAK,cAAc,KAAK,uBAAuB,uBAAiC,mBAAmB,YAAY,EAAE;AAAA,MAAU,CAAC,aACxH,KAAK,4BAA4B,QAAQ;AAAA,IAC7C,CAAC;AAGD,SAAK,UAAU,kBAAkB,cAAc;AAAA,MAC3C,UAAU;AAAA,MACV,QAAQ,sBAAsB,QAAQ,sBAAsB;AAAA,MAC5D,QAAQ,OAAO,SAA8B;AACzC,cAAM,UAAU,QAAQ,UAAU,WAAW,QAAQ,KAAK,QAAQ,GAAG;AACrE,YAAI,OAAO;AACP,iBAAO,EAAE,GAAG,SAAS,GAAG,MAAM;AAAA,QAClC;AAEA,eAAO;AAAA,MACX;AAAA,IACJ,CAAC;AAED,SAAK,cAAc,KAAK,qBAAqB,UAAU,iBAAiB;AAAA,MACpE,UAAU;AAAA,MACV,SAAS,CAAC,WAAW;AAAA,IACzB,CAAC,CAAC;AAEF,SAAK,cAAc,KAAK,qBAAqB,UAAU,kBAAkB;AAAA,MACrE,UAAU;AAAA,MACV,SAAS,CAAC,WAAW;AAAA,IACzB,CAAC,CAAC;AAEF,SAAK,cAAc,KAAK,qBAAqB,UAAU,eAAe;AAAA,MAClE,UAAU;AAAA,MACV,SAAS,CAAC,WAAW;AAAA,IACzB,CAAC,CAAC;AAAA,EACN;AAAA,EA/DQ,sBAA0E,oBAAI,IAAI;AAAA,EAClF,uBAA8C,CAAC;AAAA,EAC/C,qBAA2C,CAAC;AAAA,EAE5C,4BAAyD,CAAC;AAAA,EAC1D,4BAAmD,CAAC;AAAA,EAE3C,uBAAuB,oBAAI,IAAyB;AAAA,EACpD,wBAAwB,oBAAI,IAAyB;AAAA,EAE9D,qBAAqB;AAAA,EACrB,4BAAqF,oBAAI,IAAI;AAAA,EAE5F,uBAAuB,IAAI,mBAAmB;AAAA,IACnD;AAAA,IACA;AAAA,IACA;AAAA,EACJ,CAAC;AAAA,EAgDQ,UAAgB;AACrB,UAAM,QAAQ;AAEd,SAAK,qBAAqB,QAAQ,CAAC,eAAe,WAAW,QAAQ,CAAC;AACtE,SAAK,qBAAqB,MAAM;AAChC,SAAK,sBAAsB,MAAM;AAEjC,SAAK,oBAAoB,MAAM;AAAA,EACnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,iBAAiB,aAA+C;AAC5D,QAAI,KAAK,qBAAqB,SAAS,WAAW,GAAG;AACjD,YAAM,IAAI,MAAM,wDAAwD;AAAA,IAC5E;AAEA,SAAK,qBAAqB,KAAK,WAAW;AAC1C,SAAK,qBAAqB,KAAK,CAAC,GAAG,OAAO,EAAE,YAAY,MAAM,EAAE,YAAY,EAAE;AAE9E,WAAO,KAAK,cAAc,aAAa,MAAM,OAAO,KAAK,sBAAsB,WAAW,CAAC,CAAC;AAAA,EAChG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,iBAAiB,MAAwD;AACrE,UAAM,QAAQ,KAAK,qBAAqB,IAAI,CAAC,MAAM,EAAE,aAAa,IAAI,CAAC;AAEvE,WAAO;AAAA,MACH,UAAU,MAAM,IAAI,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC,EAAE,KAAK;AAAA,MAClD,OAAO,MAAM,IAAI,CAAC,MAAM,EAAE,KAAK,EAAE,KAAK;AAAA,MACtC,UAAU,MAAM,IAAI,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC,EAAE,KAAK;AAAA,MAClD,OAAO,MAAM,IAAI,CAAC,MAAM,EAAE,KAAK,EAAE,KAAK;AAAA,IAC1C;AAAA,EACJ;AAAA,EAEA,sBAAsB,aAA+C;AACjE,QAAI,KAAK,0BAA0B,SAAS,WAAW,GAAG;AACtD,YAAM,IAAI,MAAM,wDAAwD;AAAA,IAC5E;AAEA,SAAK,0BAA0B,KAAK,WAAW;AAC/C,SAAK,0BAA0B,KAAK,CAAC,GAAG,OAAO,EAAE,YAAY,MAAM,EAAE,YAAY,EAAE;AAEnF,WAAO,KAAK,cAAc,aAAa,MAAM,OAAO,KAAK,2BAA2B,WAAW,CAAC,CAAC;AAAA,EACrG;AAAA,EAEA,oBAAoB,MAAwD;AACxE,UAAM,QAAQ,KAAK,0BAA0B,IAAI,CAAC,MAAM,EAAE,aAAa,IAAI,CAAC;AAE5E,WAAO;AAAA,MACH,OAAO,MAAM,IAAI,CAAC,MAAM,EAAE,KAAK,EAAE,KAAK;AAAA,MACtC,OAAO,MAAM,IAAI,CAAC,MAAM,EAAE,KAAK,EAAE,KAAK;AAAA,IAC1C;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,uBAAuB,aAAqD;AACxE,QAAI,KAAK,0BAA0B,SAAS,WAAW,GAAG;AACtD,YAAM,IAAI,MAAM,wDAAwD;AAAA,IAC5E;AAEA,SAAK,0BAA0B,KAAK,WAAW;AAC/C,SAAK,0BAA0B,KAAK,CAAC,GAAG,OAAO,EAAE,YAAY,MAAM,EAAE,YAAY,EAAE;AAEnF,WAAO,KAAK,cAAc,aAAa,MAAM,OAAO,KAAK,2BAA2B,WAAW,CAAC,CAAC;AAAA,EACrG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,MAAM,qBAAqB,MAAsC;AAC7D,UAAM,qBAAqB,MAAM,QAAQ,IAAI,KAAK,0BAA0B,IAAI,CAAC,MAAM,EAAE,aAAa,IAAI,CAAC,CAAC;AAC5G,WAAO,mBAAmB,MAAM,CAAC,YAAY,OAAO;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,gBAAgB,aAA8C;AAC1D,QAAI,KAAK,mBAAmB,SAAS,WAAW,GAAG;AAC/C,YAAM,IAAI,MAAM,wDAAwD;AAAA,IAC5E;AAEA,SAAK,mBAAmB,KAAK,WAAW;AACxC,SAAK,mBAAmB,KAAK,CAAC,GAAG,OAAO,EAAE,YAAY,MAAM,EAAE,YAAY,EAAE;AAE5E,WAAO,KAAK,cAAc,aAAa,MAAM,OAAO,KAAK,oBAAoB,WAAW,CAAC,CAAC;AAAA,EAC9F;AAAA,EAEA,0BAA0B,MAAuD;AAC7E,UAAM,QAAQ,KAAK,mBAAmB,IAAI,CAAC,MAAM,EAAE,aAAa,IAAI,CAAC;AAErE,WAAO;AAAA,MACH,UAAU,MAAM,IAAI,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC,EAAE,KAAK;AAAA,MAClD,OAAO,MAAM,IAAI,CAAC,MAAM,EAAE,KAAK,EAAE,KAAK;AAAA,MACtC,UAAU,MAAM,IAAI,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC,EAAE,KAAK;AAAA,MAClD,OAAO,MAAM,IAAI,CAAC,MAAM,EAAE,KAAK,EAAE,KAAK;AAAA,IAC1C;AAAA,EACJ;AAAA;AAAA;AAAA,EAMA,YAAY,UAAoB,WAAsB,KAAa,KAAa,UAAqB;AACjG,UAAM,UAAU;AAAA,MACZ,WAAW,UAAU,WAAW;AAAA,MAChC,QAAQ,SAAS,UAAU;AAAA,MAC3B;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA,QAAQ,MAAM,UAAU,QAAQ;AAAA,IACpC;AAEA,WAAO,KAAK,qBAAqB,yBAAyB,eAAe,EAAE,UAAU,OAAO;AAAA,EAChG;AAAA;AAAA,EAIA,eAAe,UAAoB,WAAsB,KAAa,KAAa;AAC/E,UAAM,UAA0B;AAAA,MAC5B,WAAW,UAAU,WAAW;AAAA,MAChC,QAAQ,SAAS,UAAU;AAAA,MAC3B;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACJ;AAEA,WAAO,KAAK,qBAAqB,yBAAyB,aAAa,EAAE,QAAQ,QAAQ,IAAI,GAAG,OAAO;AAAA,EAC3G;AAAA,EAEA,UAA4C,MAAS,aAA6B;AAC9E,UAAM,MAAM;AACZ,QAAI,CAAC,KAAK,oBAAoB,IAAI,GAAG,GAAG;AACpC,WAAK,oBAAoB,IAAI,KAAK,CAAC,CAAC;AAAA,IACxC;AAEA,UAAM,eAAe,KAAK,oBAAoB,IAAI,GAAG;AACrD,iBAAa,KAAK,WAAW;AAC7B,UAAM,qBAAqB,aAAa,KAAK,CAAC,GAAG,OAAO,EAAE,YAAY,MAAM,EAAE,YAAY,EAAE;AAE5F,SAAK,qBAAqB;AAE1B,QAAI,QAAQ,kBAAkB,cAAmC;AAC7D,YAAM,gBAAgB,sBAAsB,QAAQ,sBAAsB;AAC1E,WAAK,oBAAoB,IAAI,GAAG,GAAG,IAAI,aAAa,IAAI,kBAAkB;AAE1E,YAAM,cAAc,sBAAsB,QAAQ,sBAAsB;AACxE,WAAK,oBAAoB;AAAA,QACrB,GAAG,GAAG,IAAK,sBAAsB,KAAM;AAAA,QACtC,mBAA4D,OAAO,CAAC,QAAQ,EAAE,UAAU,eAAe,sBAAsB,SAAS,CAAC;AAAA,MAC5I;AACA,WAAK,oBAAoB;AAAA,QACrB,GAAG,GAAG,IAAK,sBAAsB,KAAM;AAAA,QACtC,mBAA4D,OAAO,CAAC,QAAQ,EAAE,UAAU,eAAe,sBAAsB,SAAS,CAAC;AAAA,MAC5I;AAEA,aAAO,KAAK,cAAc,aAAa,MAAM;AACzC,eAAO,KAAK,oBAAoB,IAAI,GAAG,GAAI,WAAW;AACtD,eAAO,KAAK,oBAAoB,IAAI,GAAG,GAAG,IAAI,aAAa,EAAE,GAAI,WAAW;AAC5E,eAAO,KAAK,oBAAoB,IAAI,GAAG,GAAG,IAAK,sBAAsB,KAAM,EAAE,GAAI,WAAW;AAC5F,eAAO,KAAK,oBAAoB,IAAI,GAAG,GAAG,IAAK,sBAAsB,KAAM,EAAE,GAAI,WAAW;AAAA,MAChG,CAAC,CAAC;AAAA,IACN,OAAO;AACH,WAAK,oBAAoB,IAAI,KAAK,kBAAkB;AACpD,aAAO,KAAK,cAAc,aAAa,MAAM,OAAO,KAAK,oBAAoB,IAAI,GAAG,GAAI,WAAW,CAAC,CAAC;AAAA,IACzG;AAAA,EACJ;AAAA,EAEA,yBACI,MACA,QACA,MACA,QACsC;AACtC,UAAM,aAAa,WAAW,SAAY,OAA4B,GAAG,IAAyB,IAAI,MAAM;AAC5G,UAAM,MAAM,QAAQ;AACpB,QAAI,WAAW,KAAK,0BAA0B,IAAI,GAAG;AAErD,QAAI,CAAC,YAAY,KAAK,oBAAoB;AACtC,UAAI,eAAe,KAAK,oBAAoB,IAAI,UAAU;AAC1D,UAAI,gBAAgB,QAAQ;AACxB,uBAAe,aAAa,OAAO,MAAM;AAAA,MAC7C;AAEA,iBAAW,oBAA0B,gBAAgB,CAAC,CAAC;AACvD,WAAK,0BAA0B,IAAI,KAAK,QAAQ;AAAA,IACpD;AAEA,WAAO;AAAA,EACX;AAAA,EAEQ,mBAAmB,UAA0B;AACjD,UAAM,cAAc,IAAI,qBAAqB;AAC7C,UAAM,SAAS,SAAS,UAAU;AAGlC,UAAM,0BAA0B;AAChC,UAAM,qBAAqB,CAAC,cAA+B;AACvD,YAAM,YAAY,UAAU,WAAW;AACvC,gBAAU,qBAAqB,CAAC,cAAc;AAC1C,cAAM,mBAAmB,IAAI,qBAAqB;AAClD,gCAAwB,sBAAsB,IAAI,yBAAyB,QAAQ,SAAS,GAAG,gBAAgB;AAE/G,yBAAiB,IAAI,UAAU,+BAA+B;AAAA,UAC1D,QACI,KACA,KACA,QACA,KACA,QACmB;AACnB,kBAAM,UAAU,UAAU,WAAW,KAAK,GAAG;AAC7C,mBAAO,wBAAwB,yBAAyB,kBAAkB,cAAc,QAAQ,KAAK,MAAM;AAAA,cACvG;AAAA,cACA;AAAA,gBACI;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,cACJ;AAAA,YACJ;AAAA,UACJ;AAAA,QACJ,CAAC,CAAC;AAEF,yBAAiB,IAAI,UAAU,+BAA+B;AAAA,UAC1D,eAAe,KAAsB;AACjC,mBAAO,CAAC,CAAC,wBAAwB,yBAAyB,kBAAkB,YAAY;AAAA,cACpF;AAAA,cACA;AAAA,gBACI;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,cACJ;AAAA,YACJ;AAAA,UACJ;AAAA,QACJ,CAAC,CAAC;AAAA,MACN,CAAC;AAAA,IACL;AAIA,aAAS,UAAU,EAAE,QAAQ,CAAC,cAAc,mBAAmB,SAAS,CAAC;AACzE,gBAAY,IAAI,SAAS,cAAc,UAAU,CAAC,cAAc,mBAAmB,SAAS,CAAC,CAAC;AAG9F,gBAAY,IAAI,aAAa,MAAM,SAAS,UAAU,EAAE,QAAQ,CAAC,cAAc,KAAK,yBAAyB,QAAQ,SAAS,CAAC,CAAC,CAAC;AAEjI,gBAAY,IAAI,SAAS,eAAe,UAAU,CAAC,cAAc,KAAK,yBAAyB,QAAQ,SAAS,CAAC,CAAC;AAElH,SAAK,qBAAqB,IAAI,QAAQ,WAAW;AAAA,EACrD;AAAA,EAEQ,4BAA4B,UAA0B;AAC1D,UAAM,SAAS,SAAS,UAAU;AAClC,UAAM,aAAa,KAAK,qBAAqB,IAAI,MAAM;AAEvD,QAAI,YAAY;AACZ,iBAAW,QAAQ;AACnB,WAAK,qBAAqB,OAAO,MAAM;AAAA,IAC3C;AAAA,EACJ;AAAA,EAEQ,yBAAyB,QAAgB,WAA4B;AACzE,UAAM,eAAe,yBAAyB,QAAQ,SAAS;AAC/D,UAAM,aAAa,KAAK,sBAAsB,IAAI,YAAY;AAE9D,QAAI,YAAY;AACZ,iBAAW,QAAQ;AACnB,WAAK,sBAAsB,OAAO,YAAY;AAAA,IAClD;AAAA,EACJ;AACJ;AArXa,0BAAN;AAAA,EAsBE;AAAA,GAtBI;AAuXb,SAAS,yBAAyB,QAAgB,WAA8B;AAC5E,SAAO,GAAG,MAAM,IAAI,UAAU,WAAW,CAAC;AAC9C;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"e8fae290e776aad55f3370861ebfec9517e4fb57"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/set-worksheet-row-height.command.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/set-worksheet-row-height.command.ts","statementMap":{"0":{"start":{"line":20,"column":37},"end":{"line":134,"column":1}},"1":{"start":{"line":25,"column":36},"end":{"line":25,"column":73}},"2":{"start":{"line":26,"column":23},"end":{"line":26,"column":69}},"3":{"start":{"line":27,"column":36},"end":{"line":27,"column":73}},"4":{"start":{"line":28,"column":4},"end":{"line":30,"column":5}},"5":{"start":{"line":29,"column":6},"end":{"line":29,"column":19}},"6":{"start":{"line":31,"column":19},"end":{"line":31,"column":78}},"7":{"start":{"line":32,"column":4},"end":{"line":32,"column":30}},"8":{"start":{"line":32,"column":17},"end":{"line":32,"column":30}},"9":{"start":{"line":33,"column":45},"end":{"line":33,"column":51}},"10":{"start":{"line":34,"column":34},"end":{"line":34,"column":40}},"11":{"start":{"line":35,"column":28},"end":{"line":35,"column":61}},"12":{"start":{"line":36,"column":26},"end":{"line":36,"column":50}},"13":{"start":{"line":37,"column":28},"end":{"line":37,"column":103}},"14":{"start":{"line":38,"column":26},"end":{"line":38,"column":88}},"15":{"start":{"line":38,"column":51},"end":{"line":38,"column":87}},"16":{"start":{"line":39,"column":22},"end":{"line":42,"column":43}},"17":{"start":{"line":40,"column":35},"end":{"line":40,"column":40}},"18":{"start":{"line":41,"column":6},"end":{"line":41,"column":58}},"19":{"start":{"line":44,"column":4},"end":{"line":76,"column":5}},"20":{"start":{"line":45,"column":23},"end":{"line":45,"column":49}},"21":{"start":{"line":46,"column":27},"end":{"line":48,"column":7}},"22":{"start":{"line":47,"column":23},"end":{"line":47,"column":98}},"23":{"start":{"line":49,"column":6},"end":{"line":54,"column":8}},"24":{"start":{"line":55,"column":11},"end":{"line":76,"column":5}},"25":{"start":{"line":56,"column":6},"end":{"line":61,"column":8}},"26":{"start":{"line":59,"column":41},"end":{"line":59,"column":65}},"27":{"start":{"line":63,"column":6},"end":{"line":75,"column":8}},"28":{"start":{"line":77,"column":31},"end":{"line":77,"column":98}},"29":{"start":{"line":78,"column":38},"end":{"line":83,"column":5}},"30":{"start":{"line":84,"column":38},"end":{"line":84,"column":118}},"31":{"start":{"line":85,"column":27},"end":{"line":85,"column":56}},"32":{"start":{"line":86,"column":28},"end":{"line":86,"column":58}},"33":{"start":{"line":87,"column":24},"end":{"line":90,"column":6}},"34":{"start":{"line":91,"column":19},"end":{"line":100,"column":22}},"35":{"start":{"line":101,"column":30},"end":{"line":101,"column":85}},"36":{"start":{"line":102,"column":4},"end":{"line":131,"column":5}},"37":{"start":{"line":103,"column":6},"end":{"line":129,"column":9}},"38":{"start":{"line":130,"column":6},"end":{"line":130,"column":18}},"39":{"start":{"line":132,"column":4},"end":{"line":132,"column":17}},"40":{"start":{"line":135,"column":35},"end":{"line":213,"column":1}},"41":{"start":{"line":140,"column":36},"end":{"line":140,"column":73}},"42":{"start":{"line":141,"column":27},"end":{"line":141,"column":56}},"43":{"start":{"line":142,"column":28},"end":{"line":142,"column":58}},"44":{"start":{"line":143,"column":34},"end":{"line":143,"column":70}},"45":{"start":{"line":144,"column":36},"end":{"line":144,"column":73}},"46":{"start":{"line":145,"column":23},"end":{"line":145,"column":131}},"47":{"start":{"line":145,"column":123},"end":{"line":145,"column":130}},"48":{"start":{"line":146,"column":4},"end":{"line":148,"column":5}},"49":{"start":{"line":147,"column":6},"end":{"line":147,"column":19}},"50":{"start":{"line":149,"column":19},"end":{"line":149,"column":71}},"51":{"start":{"line":150,"column":4},"end":{"line":150,"column":30}},"52":{"start":{"line":150,"column":17},"end":{"line":150,"column":30}},"53":{"start":{"line":151,"column":45},"end":{"line":151,"column":51}},"54":{"start":{"line":152,"column":31},"end":{"line":157,"column":5}},"55":{"start":{"line":158,"column":31},"end":{"line":158,"column":98}},"56":{"start":{"line":159,"column":38},"end":{"line":164,"column":5}},"57":{"start":{"line":165,"column":38},"end":{"line":165,"column":118}},"58":{"start":{"line":166,"column":19},"end":{"line":175,"column":22}},"59":{"start":{"line":176,"column":24},"end":{"line":179,"column":6}},"60":{"start":{"line":180,"column":35},"end":{"line":180,"column":90}},"61":{"start":{"line":181,"column":4},"end":{"line":210,"column":5}},"62":{"start":{"line":182,"column":6},"end":{"line":208,"column":9}},"63":{"start":{"line":209,"column":6},"end":{"line":209,"column":18}},"64":{"start":{"line":211,"column":4},"end":{"line":211,"column":17}},"65":{"start":{"line":214,"column":50},"end":{"line":256,"column":1}},"66":{"start":{"line":218,"column":27},"end":{"line":218,"column":56}},"67":{"start":{"line":219,"column":28},"end":{"line":219,"column":58}},"68":{"start":{"line":220,"column":36},"end":{"line":220,"column":73}},"69":{"start":{"line":221,"column":34},"end":{"line":221,"column":70}},"70":{"start":{"line":222,"column":19},"end":{"line":222,"column":71}},"71":{"start":{"line":223,"column":4},"end":{"line":223,"column":30}},"72":{"start":{"line":223,"column":17},"end":{"line":223,"column":30}},"73":{"start":{"line":224,"column":45},"end":{"line":224,"column":51}},"74":{"start":{"line":225,"column":19},"end":{"line":225,"column":127}},"75":{"start":{"line":225,"column":119},"end":{"line":225,"column":126}},"76":{"start":{"line":226,"column":4},"end":{"line":228,"column":5}},"77":{"start":{"line":227,"column":6},"end":{"line":227,"column":19}},"78":{"start":{"line":229,"column":31},"end":{"line":235,"column":5}},"79":{"start":{"line":236,"column":31},"end":{"line":236,"column":104}},"80":{"start":{"line":237,"column":34},"end":{"line":240,"column":5}},"81":{"start":{"line":241,"column":29},"end":{"line":244,"column":6}},"82":{"start":{"line":245,"column":19},"end":{"line":245,"column":62}},"83":{"start":{"line":246,"column":4},"end":{"line":253,"column":5}},"84":{"start":{"line":247,"column":6},"end":{"line":251,"column":9}},"85":{"start":{"line":252,"column":6},"end":{"line":252,"column":18}},"86":{"start":{"line":254,"column":4},"end":{"line":254,"column":17}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":24,"column":11},"end":{"line":24,"column":12}},"loc":{"start":{"line":24,"column":39},"end":{"line":133,"column":3}},"line":24},"1":{"name":"(anonymous_1)","decl":{"start":{"line":38,"column":44},"end":{"line":38,"column":45}},"loc":{"start":{"line":38,"column":51},"end":{"line":38,"column":87}},"line":38},"2":{"name":"(anonymous_2)","decl":{"start":{"line":39,"column":76},"end":{"line":39,"column":77}},"loc":{"start":{"line":39,"column":91},"end":{"line":42,"column":5}},"line":39},"3":{"name":"(anonymous_3)","decl":{"start":{"line":47,"column":8},"end":{"line":47,"column":9}},"loc":{"start":{"line":47,"column":23},"end":{"line":47,"column":98}},"line":47},"4":{"name":"(anonymous_4)","decl":{"start":{"line":59,"column":34},"end":{"line":59,"column":35}},"loc":{"start":{"line":59,"column":41},"end":{"line":59,"column":65}},"line":59},"5":{"name":"(anonymous_5)","decl":{"start":{"line":139,"column":11},"end":{"line":139,"column":12}},"loc":{"start":{"line":139,"column":33},"end":{"line":212,"column":3}},"line":139},"6":{"name":"(anonymous_6)","decl":{"start":{"line":145,"column":116},"end":{"line":145,"column":117}},"loc":{"start":{"line":145,"column":123},"end":{"line":145,"column":130}},"line":145},"7":{"name":"(anonymous_7)","decl":{"start":{"line":217,"column":11},"end":{"line":217,"column":12}},"loc":{"start":{"line":217,"column":33},"end":{"line":255,"column":3}},"line":217},"8":{"name":"(anonymous_8)","decl":{"start":{"line":225,"column":112},"end":{"line":225,"column":113}},"loc":{"start":{"line":225,"column":119},"end":{"line":225,"column":126}},"line":225}},"branchMap":{"0":{"loc":{"start":{"line":28,"column":4},"end":{"line":30,"column":5}},"type":"if","locations":[{"start":{"line":28,"column":4},"end":{"line":30,"column":5}},{"start":{},"end":{}}],"line":28},"1":{"loc":{"start":{"line":32,"column":4},"end":{"line":32,"column":30}},"type":"if","locations":[{"start":{"line":32,"column":4},"end":{"line":32,"column":30}},{"start":{},"end":{}}],"line":32},"2":{"loc":{"start":{"line":37,"column":28},"end":{"line":37,"column":103}},"type":"binary-expr","locations":[{"start":{"line":37,"column":28},"end":{"line":37,"column":51}},{"start":{"line":37,"column":55},"end":{"line":37,"column":103}}],"line":37},"3":{"loc":{"start":{"line":39,"column":22},"end":{"line":42,"column":43}},"type":"cond-expr","locations":[{"start":{"line":39,"column":40},"end":{"line":39,"column":54}},{"start":{"line":39,"column":57},"end":{"line":42,"column":43}}],"line":39},"4":{"loc":{"start":{"line":39,"column":57},"end":{"line":42,"column":43}},"type":"cond-expr","locations":[{"start":{"line":42,"column":9},"end":{"line":42,"column":23}},{"start":{"line":42,"column":26},"end":{"line":42,"column":43}}],"line":39},"5":{"loc":{"start":{"line":41,"column":13},"end":{"line":41,"column":57}},"type":"binary-expr","locations":[{"start":{"line":41,"column":13},"end":{"line":41,"column":34}},{"start":{"line":41,"column":38},"end":{"line":41,"column":57}}],"line":41},"6":{"loc":{"start":{"line":44,"column":4},"end":{"line":76,"column":5}},"type":"if","locations":[{"start":{"line":44,"column":4},"end":{"line":76,"column":5}},{"start":{"line":55,"column":11},"end":{"line":76,"column":5}}],"line":44},"7":{"loc":{"start":{"line":55,"column":11},"end":{"line":76,"column":5}},"type":"if","locations":[{"start":{"line":55,"column":11},"end":{"line":76,"column":5}},{"start":{"line":62,"column":11},"end":{"line":76,"column":5}}],"line":55},"8":{"loc":{"start":{"line":102,"column":4},"end":{"line":131,"column":5}},"type":"if","locations":[{"start":{"line":102,"column":4},"end":{"line":131,"column":5}},{"start":{},"end":{}}],"line":102},"9":{"loc":{"start":{"line":102,"column":8},"end":{"line":102,"column":49}},"type":"binary-expr","locations":[{"start":{"line":102,"column":8},"end":{"line":102,"column":21}},{"start":{"line":102,"column":25},"end":{"line":102,"column":49}}],"line":102},"10":{"loc":{"start":{"line":106,"column":13},"end":{"line":106,"column":39}},"type":"binary-expr","locations":[{"start":{"line":106,"column":13},"end":{"line":106,"column":33}},{"start":{"line":106,"column":37},"end":{"line":106,"column":39}}],"line":106},"11":{"loc":{"start":{"line":118,"column":13},"end":{"line":118,"column":39}},"type":"binary-expr","locations":[{"start":{"line":118,"column":13},"end":{"line":118,"column":33}},{"start":{"line":118,"column":37},"end":{"line":118,"column":39}}],"line":118},"12":{"loc":{"start":{"line":145,"column":23},"end":{"line":145,"column":131}},"type":"cond-expr","locations":[{"start":{"line":145,"column":48},"end":{"line":145,"column":61}},{"start":{"line":145,"column":64},"end":{"line":145,"column":131}}],"line":145},"13":{"loc":{"start":{"line":146,"column":4},"end":{"line":148,"column":5}},"type":"if","locations":[{"start":{"line":146,"column":4},"end":{"line":148,"column":5}},{"start":{},"end":{}}],"line":146},"14":{"loc":{"start":{"line":150,"column":4},"end":{"line":150,"column":30}},"type":"if","locations":[{"start":{"line":150,"column":4},"end":{"line":150,"column":30}},{"start":{},"end":{}}],"line":150},"15":{"loc":{"start":{"line":181,"column":4},"end":{"line":210,"column":5}},"type":"if","locations":[{"start":{"line":181,"column":4},"end":{"line":210,"column":5}},{"start":{},"end":{}}],"line":181},"16":{"loc":{"start":{"line":181,"column":8},"end":{"line":181,"column":54}},"type":"binary-expr","locations":[{"start":{"line":181,"column":8},"end":{"line":181,"column":21}},{"start":{"line":181,"column":25},"end":{"line":181,"column":54}}],"line":181},"17":{"loc":{"start":{"line":185,"column":13},"end":{"line":185,"column":39}},"type":"binary-expr","locations":[{"start":{"line":185,"column":13},"end":{"line":185,"column":33}},{"start":{"line":185,"column":37},"end":{"line":185,"column":39}}],"line":185},"18":{"loc":{"start":{"line":197,"column":13},"end":{"line":197,"column":39}},"type":"binary-expr","locations":[{"start":{"line":197,"column":13},"end":{"line":197,"column":33}},{"start":{"line":197,"column":37},"end":{"line":197,"column":39}}],"line":197},"19":{"loc":{"start":{"line":223,"column":4},"end":{"line":223,"column":30}},"type":"if","locations":[{"start":{"line":223,"column":4},"end":{"line":223,"column":30}},{"start":{},"end":{}}],"line":223},"20":{"loc":{"start":{"line":225,"column":19},"end":{"line":225,"column":127}},"type":"cond-expr","locations":[{"start":{"line":225,"column":44},"end":{"line":225,"column":57}},{"start":{"line":225,"column":60},"end":{"line":225,"column":127}}],"line":225},"21":{"loc":{"start":{"line":226,"column":4},"end":{"line":228,"column":5}},"type":"if","locations":[{"start":{"line":226,"column":4},"end":{"line":228,"column":5}},{"start":{},"end":{}}],"line":226},"22":{"loc":{"start":{"line":246,"column":4},"end":{"line":253,"column":5}},"type":"if","locations":[{"start":{"line":246,"column":4},"end":{"line":253,"column":5}},{"start":{},"end":{}}],"line":246},"23":{"loc":{"start":{"line":246,"column":8},"end":{"line":246,"column":46}},"type":"binary-expr","locations":[{"start":{"line":246,"column":8},"end":{"line":246,"column":29}},{"start":{"line":246,"column":33},"end":{"line":246,"column":46}}],"line":246}},"s":{"0":1,"1":2,"2":2,"3":2,"4":2,"5":0,"6":2,"7":2,"8":0,"9":2,"10":2,"11":2,"12":2,"13":2,"14":2,"15":4,"16":2,"17":4,"18":4,"19":2,"20":0,"21":0,"22":0,"23":0,"24":2,"25":1,"26":2,"27":1,"28":2,"29":2,"30":2,"31":2,"32":2,"33":2,"34":2,"35":2,"36":2,"37":2,"38":2,"39":0,"40":1,"41":2,"42":2,"43":2,"44":2,"45":2,"46":2,"47":2,"48":2,"49":0,"50":2,"51":2,"52":0,"53":2,"54":2,"55":2,"56":2,"57":2,"58":2,"59":2,"60":2,"61":2,"62":2,"63":2,"64":0,"65":1,"66":1,"67":1,"68":1,"69":1,"70":1,"71":1,"72":0,"73":1,"74":1,"75":2,"76":1,"77":0,"78":1,"79":1,"80":1,"81":1,"82":1,"83":1,"84":1,"85":1,"86":0},"f":{"0":2,"1":4,"2":4,"3":0,"4":2,"5":2,"6":2,"7":1,"8":2},"b":{"0":[0,2],"1":[0,2],"2":[2,0],"3":[0,2],"4":[1,1],"5":[4,4],"6":[0,2],"7":[1,1],"8":[2,0],"9":[2,2],"10":[2,0],"11":[2,0],"12":[1,1],"13":[0,2],"14":[0,2],"15":[2,0],"16":[2,2],"17":[2,0],"18":[2,0],"19":[0,1],"20":[0,1],"21":[0,1],"22":[1,0],"23":[1,1]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/set-worksheet-row-height.command.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand, IRange } from '@univerjs/core';\nimport type {\n    ISetWorksheetRowHeightMutationParams,\n    ISetWorksheetRowIsAutoHeightMutationParams,\n} from '../mutations/set-worksheet-row-height.mutation';\n\nimport {\n    BooleanNumber,\n    CommandType,\n    ICommandService,\n    IUndoRedoService,\n    IUniverInstanceService,\n    RANGE_TYPE,\n    Rectangle,\n    sequenceExecute,\n} from '@univerjs/core';\nimport { SheetsSelectionsService } from '../../services/selections/selection.service';\nimport { SheetInterceptorService } from '../../services/sheet-interceptor/sheet-interceptor.service';\nimport {\n    SetWorksheetRowHeightMutation,\n    SetWorksheetRowHeightMutationFactory,\n    SetWorksheetRowIsAutoHeightMutation,\n    SetWorksheetRowIsAutoHeightMutationFactory,\n} from '../mutations/set-worksheet-row-height.mutation';\nimport { getSheetCommandTarget } from './utils/target-util';\n\nexport interface IDeltaRowHeightCommand {\n    anchorRow: number;\n    deltaY: number;\n}\n\nexport const DeltaRowHeightCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.delta-row-height',\n    // eslint-disable-next-line max-lines-per-function\n    handler: async (accessor: IAccessor, params: IDeltaRowHeightCommand) => {\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const selections = selectionManagerService.getCurrentSelections();\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n\n        if (!selections?.length) {\n            return false;\n        }\n\n        const target = getSheetCommandTarget(accessor.get(IUniverInstanceService));\n        if (!target) return false;\n\n        const { worksheet, subUnitId, unitId } = target;\n\n        const { anchorRow, deltaY } = params;\n        const anchorRowHeight = worksheet.getRowHeight(anchorRow);\n        const destRowHeight = anchorRowHeight + deltaY;\n\n        const isAllSheetRange = selections.length === 1 && selections[0].range.rangeType === RANGE_TYPE.ALL;\n        const rowSelections = selections.filter((s) => s.range.rangeType === RANGE_TYPE.ROW);\n        const rangeType = isAllSheetRange\n            ? RANGE_TYPE.ALL\n            : rowSelections.some(({ range }) => {\n                const { startRow, endRow } = range;\n                return startRow <= anchorRow && anchorRow <= endRow;\n            })\n                ? RANGE_TYPE.ROW\n                : RANGE_TYPE.NORMAL;\n\n        let redoMutationParams: ISetWorksheetRowHeightMutationParams;\n        if (rangeType === RANGE_TYPE.ALL) {\n            const colCount = worksheet.getColumnCount();\n            const allRowRanges = new Array(worksheet.getRowCount())\n                .fill(undefined)\n                .map(\n                    (_, index) =>\n                        ({ startRow: index, endRow: index, startColumn: 0, endColumn: colCount - 1 }) as IRange\n                );\n\n            redoMutationParams = {\n                subUnitId,\n                unitId,\n                rowHeight: destRowHeight,\n                ranges: allRowRanges,\n            };\n        } else if (rangeType === RANGE_TYPE.ROW) {\n            redoMutationParams = {\n                subUnitId,\n                unitId,\n                ranges: rowSelections.map((s) => Rectangle.clone(s.range)),\n                rowHeight: destRowHeight,\n            };\n        } else {\n            redoMutationParams = {\n                subUnitId,\n                unitId,\n                rowHeight: destRowHeight,\n                ranges: [\n                    {\n                        startRow: anchorRow,\n                        endRow: anchorRow,\n                        startColumn: 0,\n                        endColumn: worksheet.getMaxColumns() - 1,\n                    },\n                ],\n            };\n        }\n\n        const undoMutationParams: ISetWorksheetRowHeightMutationParams = SetWorksheetRowHeightMutationFactory(redoMutationParams, worksheet);\n\n        const redoSetIsAutoHeightParams: ISetWorksheetRowIsAutoHeightMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: redoMutationParams.ranges,\n            autoHeightInfo: BooleanNumber.FALSE,\n        };\n\n        const undoSetIsAutoHeightParams: ISetWorksheetRowIsAutoHeightMutationParams =\n            SetWorksheetRowIsAutoHeightMutationFactory(redoSetIsAutoHeightParams, worksheet);\n\n        const commandService = accessor.get(ICommandService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n\n        const intercepted = sheetInterceptorService.onCommandExecute({\n            id: DeltaRowHeightCommand.id,\n            params: redoMutationParams,\n        });\n\n        const result = sequenceExecute([\n            {\n                id: SetWorksheetRowHeightMutation.id,\n                params: redoMutationParams,\n            },\n            {\n                id: SetWorksheetRowIsAutoHeightMutation.id,\n                params: redoSetIsAutoHeightParams,\n            },\n        ], commandService);\n\n        const interceptedResult = sequenceExecute([...intercepted.redos], commandService);\n\n        if (result.result && interceptedResult.result) {\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: [\n                    ...(intercepted.preUndos ?? []),\n                    {\n                        id: SetWorksheetRowHeightMutation.id,\n                        params: undoMutationParams,\n                    },\n                    {\n                        id: SetWorksheetRowIsAutoHeightMutation.id,\n                        params: undoSetIsAutoHeightParams,\n                    },\n                    ...intercepted.undos,\n                ],\n                redoMutations: [\n                    ...(intercepted.preRedos ?? []),\n                    {\n                        id: SetWorksheetRowHeightMutation.id,\n                        params: redoMutationParams,\n                    },\n                    {\n                        id: SetWorksheetRowIsAutoHeightMutation.id,\n                        params: redoSetIsAutoHeightParams,\n                    },\n                    ...intercepted.redos,\n                ],\n            });\n            return true;\n        }\n\n        return false;\n    },\n};\n\nexport interface ISetRowHeightCommandParams {\n    unitId?: string;\n    subUnitId?: string;\n    ranges?: IRange[]; // For Facade API\n    value: number;\n}\n\nexport const SetRowHeightCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.set-row-height',\n    // eslint-disable-next-line max-lines-per-function\n    handler: (accessor: IAccessor, params: ISetRowHeightCommandParams) => {\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const commandService = accessor.get(ICommandService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n\n        // user can specify the ranges to set row height, if not, use the current selection\n        const selections = params?.ranges?.length ? params.ranges : selectionManagerService.getCurrentSelections()?.map((s) => s.range);\n        if (!selections?.length) {\n            return false;\n        }\n\n        const target = getSheetCommandTarget(univerInstanceService, params);\n        if (!target) return false;\n\n        const { unitId, subUnitId, worksheet } = target;\n\n        const redoMutationParams: ISetWorksheetRowHeightMutationParams = {\n            subUnitId,\n            unitId,\n            ranges: selections,\n            rowHeight: params.value,\n        };\n\n        const undoMutationParams: ISetWorksheetRowHeightMutationParams = SetWorksheetRowHeightMutationFactory(redoMutationParams, worksheet);\n\n        const redoSetIsAutoHeightParams: ISetWorksheetRowIsAutoHeightMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: redoMutationParams.ranges,\n            autoHeightInfo: BooleanNumber.FALSE,\n        };\n\n        const undoSetIsAutoHeightParams: ISetWorksheetRowIsAutoHeightMutationParams =\n            SetWorksheetRowIsAutoHeightMutationFactory(redoSetIsAutoHeightParams, worksheet);\n\n        const result = sequenceExecute([\n            {\n                id: SetWorksheetRowHeightMutation.id,\n                params: redoMutationParams,\n            },\n            {\n                id: SetWorksheetRowIsAutoHeightMutation.id,\n                params: redoSetIsAutoHeightParams,\n            },\n        ], commandService);\n\n        const intercepted = sheetInterceptorService.onCommandExecute({\n            id: SetRowHeightCommand.id,\n            params: redoMutationParams,\n        });\n\n        const sheetInterceptorResult = sequenceExecute([...intercepted.redos], commandService);\n\n        if (result.result && sheetInterceptorResult.result) {\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: [\n                    ...intercepted.preRedos ?? [],\n                    {\n                        id: SetWorksheetRowHeightMutation.id,\n                        params: undoMutationParams,\n                    },\n                    {\n                        id: SetWorksheetRowIsAutoHeightMutation.id,\n                        params: undoSetIsAutoHeightParams,\n                    },\n                    ...intercepted.undos,\n                ],\n                redoMutations: [\n                    ...intercepted.preRedos ?? [],\n                    {\n                        id: SetWorksheetRowHeightMutation.id,\n                        params: redoMutationParams,\n                    },\n                    {\n                        id: SetWorksheetRowIsAutoHeightMutation.id,\n                        params: redoSetIsAutoHeightParams,\n                    },\n                    ...intercepted.redos,\n                ],\n            });\n            return true;\n        }\n\n        return false;\n    },\n};\n\nexport interface ISetWorksheetRowIsAutoHeightCommandParams {\n    unitId?: string;\n    subUnitId?: string;\n    ranges?: IRange[]; // For Facade API\n}\n\nexport const SetWorksheetRowIsAutoHeightCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.set-row-is-auto-height',\n    handler: (accessor: IAccessor, params?: ISetWorksheetRowIsAutoHeightCommandParams) => {\n        const commandService = accessor.get(ICommandService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const target = getSheetCommandTarget(univerInstanceService, params);\n        if (!target) return false;\n\n        const { unitId, subUnitId, worksheet } = target;\n        const ranges = params?.ranges?.length ? params.ranges : selectionManagerService.getCurrentSelections()?.map((s) => s.range);\n\n        if (!ranges?.length) {\n            return false;\n        }\n\n        const redoMutationParams: ISetWorksheetRowIsAutoHeightMutationParams = {\n            unitId,\n            subUnitId,\n            ranges,\n            autoHeightInfo: BooleanNumber.TRUE, // Hard code first, maybe it will change by the menu item in the future.\n        };\n\n        const undoMutationParams: ISetWorksheetRowIsAutoHeightMutationParams =\n            SetWorksheetRowIsAutoHeightMutationFactory(redoMutationParams, worksheet);\n\n        const setIsAutoHeightResult = commandService.syncExecuteCommand(\n            SetWorksheetRowIsAutoHeightMutation.id,\n            redoMutationParams\n        );\n\n        const { undos, redos } = accessor.get(SheetInterceptorService).onCommandExecute({\n            id: SetWorksheetRowIsAutoHeightCommand.id,\n            params: redoMutationParams,\n        });\n\n        const result = sequenceExecute([...redos], commandService);\n        if (setIsAutoHeightResult && result.result) {\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: [{ id: SetWorksheetRowIsAutoHeightMutation.id, params: undoMutationParams }, ...undos],\n                redoMutations: [{ id: SetWorksheetRowIsAutoHeightMutation.id, params: redoMutationParams }, ...redos],\n            });\n\n            return true;\n        }\n\n        return false;\n    },\n};\n"],"mappings":"AAsBA;AAAA,EACI;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,OACG;AACP,SAAS,+BAA+B;AACxC,SAAS,+BAA+B;AACxC;AAAA,EACI;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,OACG;AACP,SAAS,6BAA6B;AAO/B,aAAM,wBAAkC;AAAA,EAC3C,MAAM,YAAY;AAAA,EAClB,IAAI;AAAA;AAAA,EAEJ,SAAS,OAAO,UAAqB,WAAmC;AACpE,UAAM,0BAA0B,SAAS,IAAI,uBAAuB;AACpE,UAAM,aAAa,wBAAwB,qBAAqB;AAChE,UAAM,0BAA0B,SAAS,IAAI,uBAAuB;AAEpE,QAAI,CAAC,YAAY,QAAQ;AACrB,aAAO;AAAA,IACX;AAEA,UAAM,SAAS,sBAAsB,SAAS,IAAI,sBAAsB,CAAC;AACzE,QAAI,CAAC,OAAQ,QAAO;AAEpB,UAAM,EAAE,WAAW,WAAW,OAAO,IAAI;AAEzC,UAAM,EAAE,WAAW,OAAO,IAAI;AAC9B,UAAM,kBAAkB,UAAU,aAAa,SAAS;AACxD,UAAM,gBAAgB,kBAAkB;AAExC,UAAM,kBAAkB,WAAW,WAAW,KAAK,WAAW,CAAC,EAAE,MAAM,cAAc,WAAW;AAChG,UAAM,gBAAgB,WAAW,OAAO,CAAC,MAAM,EAAE,MAAM,cAAc,WAAW,GAAG;AACnF,UAAM,YAAY,kBACZ,WAAW,MACX,cAAc,KAAK,CAAC,EAAE,MAAM,MAAM;AAChC,YAAM,EAAE,UAAU,OAAO,IAAI;AAC7B,aAAO,YAAY,aAAa,aAAa;AAAA,IACjD,CAAC,IACK,WAAW,MACX,WAAW;AAErB,QAAI;AACJ,QAAI,cAAc,WAAW,KAAK;AAC9B,YAAM,WAAW,UAAU,eAAe;AAC1C,YAAM,eAAe,IAAI,MAAM,UAAU,YAAY,CAAC,EACjD,KAAK,MAAS,EACd;AAAA,QACG,CAAC,GAAG,WACC,EAAE,UAAU,OAAO,QAAQ,OAAO,aAAa,GAAG,WAAW,WAAW,EAAE;AAAA,MACnF;AAEJ,2BAAqB;AAAA,QACjB;AAAA,QACA;AAAA,QACA,WAAW;AAAA,QACX,QAAQ;AAAA,MACZ;AAAA,IACJ,WAAW,cAAc,WAAW,KAAK;AACrC,2BAAqB;AAAA,QACjB;AAAA,QACA;AAAA,QACA,QAAQ,cAAc,IAAI,CAAC,MAAM,UAAU,MAAM,EAAE,KAAK,CAAC;AAAA,QACzD,WAAW;AAAA,MACf;AAAA,IACJ,OAAO;AACH,2BAAqB;AAAA,QACjB;AAAA,QACA;AAAA,QACA,WAAW;AAAA,QACX,QAAQ;AAAA,UACJ;AAAA,YACI,UAAU;AAAA,YACV,QAAQ;AAAA,YACR,aAAa;AAAA,YACb,WAAW,UAAU,cAAc,IAAI;AAAA,UAC3C;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAEA,UAAM,qBAA2D,qCAAqC,oBAAoB,SAAS;AAEnI,UAAM,4BAAwE;AAAA,MAC1E;AAAA,MACA;AAAA,MACA,QAAQ,mBAAmB;AAAA,MAC3B,gBAAgB,cAAc;AAAA,IAClC;AAEA,UAAM,4BACF,2CAA2C,2BAA2B,SAAS;AAEnF,UAAM,iBAAiB,SAAS,IAAI,eAAe;AACnD,UAAM,kBAAkB,SAAS,IAAI,gBAAgB;AAErD,UAAM,cAAc,wBAAwB,iBAAiB;AAAA,MACzD,IAAI,sBAAsB;AAAA,MAC1B,QAAQ;AAAA,IACZ,CAAC;AAED,UAAM,SAAS,gBAAgB;AAAA,MAC3B;AAAA,QACI,IAAI,8BAA8B;AAAA,QAClC,QAAQ;AAAA,MACZ;AAAA,MACA;AAAA,QACI,IAAI,oCAAoC;AAAA,QACxC,QAAQ;AAAA,MACZ;AAAA,IACJ,GAAG,cAAc;AAEjB,UAAM,oBAAoB,gBAAgB,CAAC,GAAG,YAAY,KAAK,GAAG,cAAc;AAEhF,QAAI,OAAO,UAAU,kBAAkB,QAAQ;AAC3C,sBAAgB,aAAa;AAAA,QACzB,QAAQ;AAAA,QACR,eAAe;AAAA,UACX,GAAI,YAAY,YAAY,CAAC;AAAA,UAC7B;AAAA,YACI,IAAI,8BAA8B;AAAA,YAClC,QAAQ;AAAA,UACZ;AAAA,UACA;AAAA,YACI,IAAI,oCAAoC;AAAA,YACxC,QAAQ;AAAA,UACZ;AAAA,UACA,GAAG,YAAY;AAAA,QACnB;AAAA,QACA,eAAe;AAAA,UACX,GAAI,YAAY,YAAY,CAAC;AAAA,UAC7B;AAAA,YACI,IAAI,8BAA8B;AAAA,YAClC,QAAQ;AAAA,UACZ;AAAA,UACA;AAAA,YACI,IAAI,oCAAoC;AAAA,YACxC,QAAQ;AAAA,UACZ;AAAA,UACA,GAAG,YAAY;AAAA,QACnB;AAAA,MACJ,CAAC;AACD,aAAO;AAAA,IACX;AAEA,WAAO;AAAA,EACX;AACJ;AASO,aAAM,sBAAgC;AAAA,EACzC,MAAM,YAAY;AAAA,EAClB,IAAI;AAAA;AAAA,EAEJ,SAAS,CAAC,UAAqB,WAAuC;AAClE,UAAM,0BAA0B,SAAS,IAAI,uBAAuB;AACpE,UAAM,iBAAiB,SAAS,IAAI,eAAe;AACnD,UAAM,kBAAkB,SAAS,IAAI,gBAAgB;AACrD,UAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,UAAM,0BAA0B,SAAS,IAAI,uBAAuB;AAGpE,UAAM,aAAa,QAAQ,QAAQ,SAAS,OAAO,SAAS,wBAAwB,qBAAqB,GAAG,IAAI,CAAC,MAAM,EAAE,KAAK;AAC9H,QAAI,CAAC,YAAY,QAAQ;AACrB,aAAO;AAAA,IACX;AAEA,UAAM,SAAS,sBAAsB,uBAAuB,MAAM;AAClE,QAAI,CAAC,OAAQ,QAAO;AAEpB,UAAM,EAAE,QAAQ,WAAW,UAAU,IAAI;AAEzC,UAAM,qBAA2D;AAAA,MAC7D;AAAA,MACA;AAAA,MACA,QAAQ;AAAA,MACR,WAAW,OAAO;AAAA,IACtB;AAEA,UAAM,qBAA2D,qCAAqC,oBAAoB,SAAS;AAEnI,UAAM,4BAAwE;AAAA,MAC1E;AAAA,MACA;AAAA,MACA,QAAQ,mBAAmB;AAAA,MAC3B,gBAAgB,cAAc;AAAA,IAClC;AAEA,UAAM,4BACF,2CAA2C,2BAA2B,SAAS;AAEnF,UAAM,SAAS,gBAAgB;AAAA,MAC3B;AAAA,QACI,IAAI,8BAA8B;AAAA,QAClC,QAAQ;AAAA,MACZ;AAAA,MACA;AAAA,QACI,IAAI,oCAAoC;AAAA,QACxC,QAAQ;AAAA,MACZ;AAAA,IACJ,GAAG,cAAc;AAEjB,UAAM,cAAc,wBAAwB,iBAAiB;AAAA,MACzD,IAAI,oBAAoB;AAAA,MACxB,QAAQ;AAAA,IACZ,CAAC;AAED,UAAM,yBAAyB,gBAAgB,CAAC,GAAG,YAAY,KAAK,GAAG,cAAc;AAErF,QAAI,OAAO,UAAU,uBAAuB,QAAQ;AAChD,sBAAgB,aAAa;AAAA,QACzB,QAAQ;AAAA,QACR,eAAe;AAAA,UACX,GAAG,YAAY,YAAY,CAAC;AAAA,UAC5B;AAAA,YACI,IAAI,8BAA8B;AAAA,YAClC,QAAQ;AAAA,UACZ;AAAA,UACA;AAAA,YACI,IAAI,oCAAoC;AAAA,YACxC,QAAQ;AAAA,UACZ;AAAA,UACA,GAAG,YAAY;AAAA,QACnB;AAAA,QACA,eAAe;AAAA,UACX,GAAG,YAAY,YAAY,CAAC;AAAA,UAC5B;AAAA,YACI,IAAI,8BAA8B;AAAA,YAClC,QAAQ;AAAA,UACZ;AAAA,UACA;AAAA,YACI,IAAI,oCAAoC;AAAA,YACxC,QAAQ;AAAA,UACZ;AAAA,UACA,GAAG,YAAY;AAAA,QACnB;AAAA,MACJ,CAAC;AACD,aAAO;AAAA,IACX;AAEA,WAAO;AAAA,EACX;AACJ;AAQO,aAAM,qCAA+C;AAAA,EACxD,MAAM,YAAY;AAAA,EAClB,IAAI;AAAA,EACJ,SAAS,CAAC,UAAqB,WAAuD;AAClF,UAAM,iBAAiB,SAAS,IAAI,eAAe;AACnD,UAAM,kBAAkB,SAAS,IAAI,gBAAgB;AACrD,UAAM,0BAA0B,SAAS,IAAI,uBAAuB;AACpE,UAAM,wBAAwB,SAAS,IAAI,sBAAsB;AAEjE,UAAM,SAAS,sBAAsB,uBAAuB,MAAM;AAClE,QAAI,CAAC,OAAQ,QAAO;AAEpB,UAAM,EAAE,QAAQ,WAAW,UAAU,IAAI;AACzC,UAAM,SAAS,QAAQ,QAAQ,SAAS,OAAO,SAAS,wBAAwB,qBAAqB,GAAG,IAAI,CAAC,MAAM,EAAE,KAAK;AAE1H,QAAI,CAAC,QAAQ,QAAQ;AACjB,aAAO;AAAA,IACX;AAEA,UAAM,qBAAiE;AAAA,MACnE;AAAA,MACA;AAAA,MACA;AAAA,MACA,gBAAgB,cAAc;AAAA;AAAA,IAClC;AAEA,UAAM,qBACF,2CAA2C,oBAAoB,SAAS;AAE5E,UAAM,wBAAwB,eAAe;AAAA,MACzC,oCAAoC;AAAA,MACpC;AAAA,IACJ;AAEA,UAAM,EAAE,OAAO,MAAM,IAAI,SAAS,IAAI,uBAAuB,EAAE,iBAAiB;AAAA,MAC5E,IAAI,mCAAmC;AAAA,MACvC,QAAQ;AAAA,IACZ,CAAC;AAED,UAAM,SAAS,gBAAgB,CAAC,GAAG,KAAK,GAAG,cAAc;AACzD,QAAI,yBAAyB,OAAO,QAAQ;AACxC,sBAAgB,aAAa;AAAA,QACzB,QAAQ;AAAA,QACR,eAAe,CAAC,EAAE,IAAI,oCAAoC,IAAI,QAAQ,mBAAmB,GAAG,GAAG,KAAK;AAAA,QACpG,eAAe,CAAC,EAAE,IAAI,oCAAoC,IAAI,QAAQ,mBAAmB,GAAG,GAAG,KAAK;AAAA,MACxG,CAAC;AAED,aAAO;AAAA,IACX;AAEA,WAAO;AAAA,EACX;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8273f54cb36c4721e2c9beff34ad459a6b5ed0ff"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/model/range-protection-rule.model.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/model/range-protection-rule.model.ts","statementMap":{"0":{"start":{"line":3,"column":43},"end":{"line":7,"column":23}},"1":{"start":{"line":4,"column":2},"end":{"line":4,"column":52}},"2":{"start":{"line":5,"column":2},"end":{"line":5,"column":58}},"3":{"start":{"line":6,"column":2},"end":{"line":6,"column":24}},"4":{"start":{"line":8,"column":43},"end":{"line":12,"column":23}},"5":{"start":{"line":9,"column":2},"end":{"line":9,"column":64}},"6":{"start":{"line":10,"column":2},"end":{"line":10,"column":38}},"7":{"start":{"line":11,"column":2},"end":{"line":11,"column":24}},"8":{"start":{"line":17,"column":27},"end":{"line":17,"column":36}},"9":{"start":{"line":18,"column":17},"end":{"line":18,"column":30}},"10":{"start":{"line":19,"column":16},"end":{"line":19,"column":48}},"11":{"start":{"line":20,"column":18},"end":{"line":20,"column":31}},"12":{"start":{"line":21,"column":17},"end":{"line":21,"column":50}},"13":{"start":{"line":23,"column":4},"end":{"line":23,"column":33}},"14":{"start":{"line":24,"column":4},"end":{"line":24,"column":34}},"15":{"start":{"line":27,"column":4},"end":{"line":27,"column":32}},"16":{"start":{"line":29,"column":30},"end":{"line":29,"column":56}},"17":{"start":{"line":30,"column":30},"end":{"line":30,"column":75}},"18":{"start":{"line":32,"column":4},"end":{"line":32,"column":48}},"19":{"start":{"line":35,"column":4},"end":{"line":35,"column":47}},"20":{"start":{"line":38,"column":20},"end":{"line":38,"column":58}},"21":{"start":{"line":39,"column":4},"end":{"line":39,"column":31}},"22":{"start":{"line":40,"column":4},"end":{"line":40,"column":69}},"23":{"start":{"line":43,"column":17},"end":{"line":43,"column":65}},"24":{"start":{"line":44,"column":4},"end":{"line":47,"column":5}},"25":{"start":{"line":45,"column":6},"end":{"line":45,"column":58}},"26":{"start":{"line":46,"column":6},"end":{"line":46,"column":74}},"27":{"start":{"line":50,"column":20},"end":{"line":50,"column":55}},"28":{"start":{"line":51,"column":4},"end":{"line":54,"column":5}},"29":{"start":{"line":52,"column":6},"end":{"line":52,"column":61}},"30":{"start":{"line":53,"column":6},"end":{"line":53,"column":80}},"31":{"start":{"line":57,"column":4},"end":{"line":57,"column":60}},"32":{"start":{"line":60,"column":16},"end":{"line":60,"column":84}},"33":{"start":{"line":61,"column":4},"end":{"line":61,"column":29}},"34":{"start":{"line":64,"column":16},"end":{"line":64,"column":55}},"35":{"start":{"line":65,"column":4},"end":{"line":65,"column":30}},"36":{"start":{"line":68,"column":21},"end":{"line":68,"column":44}},"37":{"start":{"line":69,"column":4},"end":{"line":72,"column":5}},"38":{"start":{"line":70,"column":6},"end":{"line":70,"column":45}},"39":{"start":{"line":71,"column":6},"end":{"line":71,"column":42}},"40":{"start":{"line":73,"column":18},"end":{"line":73,"column":43}},"41":{"start":{"line":74,"column":4},"end":{"line":77,"column":5}},"42":{"start":{"line":75,"column":6},"end":{"line":75,"column":42}},"43":{"start":{"line":76,"column":6},"end":{"line":76,"column":41}},"44":{"start":{"line":78,"column":4},"end":{"line":78,"column":19}},"45":{"start":{"line":81,"column":19},"end":{"line":81,"column":21}},"46":{"start":{"line":82,"column":21},"end":{"line":82,"column":44}},"47":{"start":{"line":83,"column":4},"end":{"line":91,"column":7}},"48":{"start":{"line":84,"column":24},"end":{"line":84,"column":47}},"49":{"start":{"line":85,"column":26},"end":{"line":85,"column":47}},"50":{"start":{"line":86,"column":6},"end":{"line":86,"column":26}},"51":{"start":{"line":87,"column":6},"end":{"line":90,"column":9}},"52":{"start":{"line":88,"column":24},"end":{"line":88,"column":48}},"53":{"start":{"line":89,"column":8},"end":{"line":89,"column":58}},"54":{"start":{"line":92,"column":4},"end":{"line":92,"column":18}},"55":{"start":{"line":95,"column":35},"end":{"line":95,"column":44}},"56":{"start":{"line":96,"column":4},"end":{"line":107,"column":7}},"57":{"start":{"line":97,"column":25},"end":{"line":97,"column":36}},"58":{"start":{"line":98,"column":34},"end":{"line":98,"column":43}},"59":{"start":{"line":99,"column":6},"end":{"line":105,"column":9}},"60":{"start":{"line":100,"column":24},"end":{"line":103,"column":37}},"61":{"start":{"line":101,"column":10},"end":{"line":101,"column":35}},"62":{"start":{"line":102,"column":10},"end":{"line":102,"column":25}},"63":{"start":{"line":104,"column":8},"end":{"line":104,"column":36}},"64":{"start":{"line":106,"column":6},"end":{"line":106,"column":30}},"65":{"start":{"line":108,"column":4},"end":{"line":108,"column":25}},"66":{"start":{"line":111,"column":4},"end":{"line":111,"column":31}},"67":{"start":{"line":114,"column":13},"end":{"line":114,"column":38}},"68":{"start":{"line":115,"column":20},"end":{"line":115,"column":58}},"69":{"start":{"line":116,"column":4},"end":{"line":118,"column":5}},"70":{"start":{"line":117,"column":6},"end":{"line":117,"column":37}},"71":{"start":{"line":119,"column":4},"end":{"line":119,"column":14}},"72":{"start":{"line":122,"column":23},"end":{"line":122,"column":46}},"73":{"start":{"line":123,"column":4},"end":{"line":123,"column":33}},"74":{"start":{"line":123,"column":21},"end":{"line":123,"column":33}},"75":{"start":{"line":124,"column":4},"end":{"line":130,"column":5}},"76":{"start":{"line":125,"column":6},"end":{"line":129,"column":7}},"77":{"start":{"line":126,"column":8},"end":{"line":128,"column":9}},"78":{"start":{"line":127,"column":10},"end":{"line":127,"column":37}},"79":{"start":{"line":131,"column":4},"end":{"line":131,"column":16}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":44},"end":{"line":3,"column":45}},"loc":{"start":{"line":3,"column":64},"end":{"line":7,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":8,"column":44},"end":{"line":8,"column":45}},"loc":{"start":{"line":8,"column":64},"end":{"line":12,"column":1}},"line":8},"2":{"name":"(anonymous_2)","decl":{"start":{"line":22,"column":2},"end":{"line":22,"column":3}},"loc":{"start":{"line":22,"column":12},"end":{"line":25,"column":3}},"line":22},"3":{"name":"(anonymous_3)","decl":{"start":{"line":26,"column":2},"end":{"line":26,"column":3}},"loc":{"start":{"line":26,"column":18},"end":{"line":28,"column":3}},"line":26},"4":{"name":"(anonymous_4)","decl":{"start":{"line":31,"column":2},"end":{"line":31,"column":3}},"loc":{"start":{"line":31,"column":26},"end":{"line":33,"column":3}},"line":31},"5":{"name":"(anonymous_5)","decl":{"start":{"line":34,"column":2},"end":{"line":34,"column":3}},"loc":{"start":{"line":34,"column":29},"end":{"line":36,"column":3}},"line":34},"6":{"name":"(anonymous_6)","decl":{"start":{"line":37,"column":2},"end":{"line":37,"column":3}},"loc":{"start":{"line":37,"column":35},"end":{"line":41,"column":3}},"line":37},"7":{"name":"(anonymous_7)","decl":{"start":{"line":42,"column":2},"end":{"line":42,"column":3}},"loc":{"start":{"line":42,"column":36},"end":{"line":48,"column":3}},"line":42},"8":{"name":"(anonymous_8)","decl":{"start":{"line":49,"column":2},"end":{"line":49,"column":3}},"loc":{"start":{"line":49,"column":39},"end":{"line":55,"column":3}},"line":49},"9":{"name":"(anonymous_9)","decl":{"start":{"line":56,"column":2},"end":{"line":56,"column":3}},"loc":{"start":{"line":56,"column":33},"end":{"line":58,"column":3}},"line":56},"10":{"name":"(anonymous_10)","decl":{"start":{"line":59,"column":2},"end":{"line":59,"column":3}},"loc":{"start":{"line":59,"column":40},"end":{"line":62,"column":3}},"line":59},"11":{"name":"(anonymous_11)","decl":{"start":{"line":63,"column":2},"end":{"line":63,"column":3}},"loc":{"start":{"line":63,"column":46},"end":{"line":66,"column":3}},"line":63},"12":{"name":"(anonymous_12)","decl":{"start":{"line":67,"column":2},"end":{"line":67,"column":3}},"loc":{"start":{"line":67,"column":36},"end":{"line":79,"column":3}},"line":67},"13":{"name":"(anonymous_13)","decl":{"start":{"line":80,"column":2},"end":{"line":80,"column":3}},"loc":{"start":{"line":80,"column":13},"end":{"line":93,"column":3}},"line":80},"14":{"name":"(anonymous_14)","decl":{"start":{"line":83,"column":21},"end":{"line":83,"column":22}},"loc":{"start":{"line":83,"column":33},"end":{"line":91,"column":5}},"line":83},"15":{"name":"(anonymous_15)","decl":{"start":{"line":87,"column":26},"end":{"line":87,"column":27}},"loc":{"start":{"line":87,"column":41},"end":{"line":90,"column":7}},"line":87},"16":{"name":"(anonymous_16)","decl":{"start":{"line":94,"column":2},"end":{"line":94,"column":3}},"loc":{"start":{"line":94,"column":18},"end":{"line":109,"column":3}},"line":94},"17":{"name":"(anonymous_17)","decl":{"start":{"line":96,"column":29},"end":{"line":96,"column":30}},"loc":{"start":{"line":96,"column":41},"end":{"line":107,"column":5}},"line":96},"18":{"name":"(anonymous_18)","decl":{"start":{"line":99,"column":38},"end":{"line":99,"column":39}},"loc":{"start":{"line":99,"column":53},"end":{"line":105,"column":7}},"line":99},"19":{"name":"(anonymous_19)","decl":{"start":{"line":100,"column":53},"end":{"line":100,"column":54}},"loc":{"start":{"line":100,"column":71},"end":{"line":103,"column":9}},"line":100},"20":{"name":"(anonymous_20)","decl":{"start":{"line":110,"column":2},"end":{"line":110,"column":3}},"loc":{"start":{"line":110,"column":26},"end":{"line":112,"column":3}},"line":110},"21":{"name":"(anonymous_21)","decl":{"start":{"line":113,"column":2},"end":{"line":113,"column":3}},"loc":{"start":{"line":113,"column":34},"end":{"line":120,"column":3}},"line":113},"22":{"name":"(anonymous_22)","decl":{"start":{"line":121,"column":2},"end":{"line":121,"column":3}},"loc":{"start":{"line":121,"column":48},"end":{"line":132,"column":3}},"line":121}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":3},"end":{"line":7,"column":22}},"type":"binary-expr","locations":[{"start":{"line":7,"column":3},"end":{"line":7,"column":16}},{"start":{"line":7,"column":20},"end":{"line":7,"column":22}}],"line":7},"1":{"loc":{"start":{"line":12,"column":3},"end":{"line":12,"column":22}},"type":"binary-expr","locations":[{"start":{"line":12,"column":3},"end":{"line":12,"column":16}},{"start":{"line":12,"column":20},"end":{"line":12,"column":22}}],"line":12},"2":{"loc":{"start":{"line":44,"column":4},"end":{"line":47,"column":5}},"type":"if","locations":[{"start":{"line":44,"column":4},"end":{"line":47,"column":5}},{"start":{},"end":{}}],"line":44},"3":{"loc":{"start":{"line":51,"column":4},"end":{"line":54,"column":5}},"type":"if","locations":[{"start":{"line":51,"column":4},"end":{"line":54,"column":5}},{"start":{},"end":{}}],"line":51},"4":{"loc":{"start":{"line":60,"column":16},"end":{"line":60,"column":84}},"type":"binary-expr","locations":[{"start":{"line":60,"column":16},"end":{"line":60,"column":55}},{"start":{"line":60,"column":75},"end":{"line":60,"column":84}}],"line":60},"5":{"loc":{"start":{"line":65,"column":11},"end":{"line":65,"column":29}},"type":"cond-expr","locations":[{"start":{"line":65,"column":17},"end":{"line":65,"column":25}},{"start":{"line":65,"column":28},"end":{"line":65,"column":29}}],"line":65},"6":{"loc":{"start":{"line":69,"column":4},"end":{"line":72,"column":5}},"type":"if","locations":[{"start":{"line":69,"column":4},"end":{"line":72,"column":5}},{"start":{},"end":{}}],"line":69},"7":{"loc":{"start":{"line":74,"column":4},"end":{"line":77,"column":5}},"type":"if","locations":[{"start":{"line":74,"column":4},"end":{"line":77,"column":5}},{"start":{},"end":{}}],"line":74},"8":{"loc":{"start":{"line":123,"column":4},"end":{"line":123,"column":33}},"type":"if","locations":[{"start":{"line":123,"column":4},"end":{"line":123,"column":33}},{"start":{},"end":{}}],"line":123},"9":{"loc":{"start":{"line":126,"column":8},"end":{"line":128,"column":9}},"type":"if","locations":[{"start":{"line":126,"column":8},"end":{"line":128,"column":9}},{"start":{},"end":{}}],"line":126}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":5,"9":5,"10":5,"11":5,"12":5,"13":5,"14":5,"15":0,"16":5,"17":5,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0},"f":{"0":1,"1":1,"2":5,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},"b":{"0":[1,1],"1":[1,1],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/model/range-protection-rule.model.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IDisposable, IRange } from '@univerjs/core';\nimport type { UnitObject } from '@univerjs/protocol';\nimport { Tools } from '@univerjs/core';\n\nimport { BehaviorSubject, Subject } from 'rxjs';\n\nexport enum ViewStateEnum {\n    OthersCanView = 'othersCanView',\n    NoOneElseCanView = 'noOneElseCanView',\n}\n\nexport enum EditStateEnum {\n    DesignedUserCanEdit = 'designedUserCanEdit',\n    OnlyMe = 'onlyMe',\n}\n\nexport interface IRangeProtectionRule {\n    ranges: IRange[];\n    permissionId: string;\n    id: string;\n    description?: string;\n    unitType: UnitObject;\n    unitId: string;\n    subUnitId: string;\n    viewState: ViewStateEnum;\n    editState: EditStateEnum;\n}\nexport type IObjectModel = Record<string, Record<string, IRangeProtectionRule[]>>;\n\nexport type IModel = Map<string, Map<string, Map<string, IRangeProtectionRule>>>;\n\nexport interface IRuleChange {\n    unitId: string;\n    subUnitId: string;\n    rule: IRangeProtectionRule;\n    oldRule?: IRangeProtectionRule;\n    type: IRuleChangeType;\n}\n\ntype IRuleChangeType = 'add' | 'set' | 'delete';\n\nexport class RangeProtectionRuleModel implements IDisposable {\n    /**\n     * Map<unitId, Map<subUnitId, Map<ruleId, IRangeProtectionRule>>>\n     */\n    private _model: IModel = new Map();\n\n    private readonly _ruleChange$ = new Subject<IRuleChange>();\n    readonly ruleChange$ = this._ruleChange$.asObservable();\n\n    private _ruleRefresh$ = new Subject<string>();\n    ruleRefresh$ = this._ruleRefresh$.asObservable();\n\n    dispose(): void {\n        this._ruleChange$.complete();\n        this._ruleRefresh$.complete();\n    }\n\n    ruleRefresh(id: string) {\n        this._ruleRefresh$.next(id);\n    }\n\n    private _rangeRuleInitStateChange = new BehaviorSubject<boolean>(false);\n    rangeRuleInitStateChange$ = this._rangeRuleInitStateChange.asObservable();\n\n    getRangeRuleInitState() {\n        return this._rangeRuleInitStateChange.value;\n    }\n\n    changeRuleInitState(state: boolean) {\n        this._rangeRuleInitStateChange.next(state);\n    }\n\n    addRule(unitId: string, subUnitId: string, rule: IRangeProtectionRule) {\n        const ruleMap = this._ensureRuleMap(unitId, subUnitId);\n        ruleMap.set(rule.id, rule);\n        this._ruleChange$.next({ unitId, subUnitId, rule, type: 'add' });\n    }\n\n    deleteRule(unitId: string, subUnitId: string, id: string) {\n        const rule = this._model.get(unitId)?.get(subUnitId)?.get(id);\n        if (rule) {\n            this._model.get(unitId)?.get(subUnitId)?.delete(id);\n            this._ruleChange$.next({ unitId, subUnitId, rule, type: 'delete' });\n        }\n    }\n\n    setRule(unitId: string, subUnitId: string, id: string, rule: IRangeProtectionRule) {\n        const oldRule = this.getRule(unitId, subUnitId, id);\n        if (oldRule) {\n            this._model.get(unitId)?.get(subUnitId)?.set(id, rule);\n            this._ruleChange$.next({ unitId, subUnitId, oldRule, rule, type: 'set' });\n        }\n    }\n\n    getRule(unitId: string, subUnitId: string, id: string) {\n        return this._model.get(unitId)?.get(subUnitId)?.get(id);\n    }\n\n    getSubunitRuleList(unitId: string, subUnitId: string) {\n        const map = this._model.get(unitId)?.get(subUnitId) || new Map();\n        return [...map.values()] as IRangeProtectionRule[];\n    }\n\n    getSubunitRuleListLength(unitId: string, subUnitId: string) {\n        const map = this._model.get(unitId)?.get(subUnitId);\n        return map ? map.size : 0;\n    }\n\n    private _ensureRuleMap(unitId: string, subUnitId: string) {\n        let subUnitMap = this._model.get(unitId);\n        if (!subUnitMap) {\n            subUnitMap = new Map();\n            this._model.set(unitId, subUnitMap);\n        }\n        let ruleMap = subUnitMap.get(subUnitId);\n\n        if (!ruleMap) {\n            ruleMap = new Map<string, IRangeProtectionRule>();\n            subUnitMap.set(subUnitId, ruleMap);\n        }\n        return ruleMap;\n    }\n\n    toObject() {\n        const result: IObjectModel = {};\n        const unitKeys = [...this._model.keys()];\n        unitKeys.forEach((unitId) => {\n            const submitMap = this._model.get(unitId)!;\n            const subUnitKeys = [...submitMap.keys()];\n            result[unitId] = {};\n            subUnitKeys.forEach((subunitId) => {\n                const ruleMap = submitMap.get(subunitId)!;\n                result[unitId][subunitId] = [...ruleMap.values()];\n            });\n        });\n        return result;\n    }\n\n    fromObject(obj: IObjectModel) {\n        const result: IModel = new Map();\n        Object.keys(obj).forEach((unitId) => {\n            const subUnitObj = obj[unitId];\n            const map = new Map<string, Map<string, IRangeProtectionRule>>();\n            Object.keys(subUnitObj).forEach((subunitId) => {\n                const ruleMap = subUnitObj[subunitId].reduce((result, cur) => {\n                    result.set(cur.id, cur);\n                    return result;\n                }, new Map<string, IRangeProtectionRule>());\n                map.set(subunitId, ruleMap);\n            });\n            result.set(unitId, map);\n        });\n        this._model = result;\n    }\n\n    deleteUnitModel(unitId: string) {\n        this._model.delete(unitId);\n    }\n\n    createRuleId(unitId: string, subUnitId: string) {\n        let id = Tools.generateRandomId(4);\n        const ruleMap = this._ensureRuleMap(unitId, subUnitId);\n        while (ruleMap.has(id)) {\n            id = Tools.generateRandomId(4);\n        }\n        return id;\n    }\n\n    getTargetByPermissionId(unitId: string, permissionId: string) {\n        const subUnitMap = this._model.get(unitId);\n        if (!subUnitMap) return null;\n        for (const [subUnitId, ruleMap] of subUnitMap) {\n            for (const rule of ruleMap.values()) {\n                if (rule.permissionId === permissionId) {\n                    return [unitId, subUnitId];\n                }\n            }\n        }\n        return null;\n    }\n}\n"],"mappings":"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","names":["ViewStateEnum","EditStateEnum","result"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"e75ecdfdf8ac7cd531fc82b4ec9407a86dd462f7"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/border-style-manager.service.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/border-style-manager.service.ts","statementMap":{"0":{"start":{"line":4,"column":16},"end":{"line":9,"column":3}},"1":{"start":{"line":10,"column":17},"end":{"line":10,"column":54}},"2":{"start":{"line":11,"column":16},"end":{"line":11,"column":48}},"3":{"start":{"line":13,"column":4},"end":{"line":13,"column":33}},"4":{"start":{"line":16,"column":4},"end":{"line":16,"column":33}},"5":{"start":{"line":17,"column":4},"end":{"line":17,"column":35}},"6":{"start":{"line":18,"column":4},"end":{"line":18,"column":20}},"7":{"start":{"line":21,"column":4},"end":{"line":21,"column":35}},"8":{"start":{"line":22,"column":4},"end":{"line":22,"column":20}},"9":{"start":{"line":25,"column":4},"end":{"line":25,"column":35}},"10":{"start":{"line":26,"column":4},"end":{"line":26,"column":20}},"11":{"start":{"line":29,"column":4},"end":{"line":29,"column":47}},"12":{"start":{"line":32,"column":4},"end":{"line":32,"column":28}},"13":{"start":{"line":35,"column":4},"end":{"line":35,"column":45}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":2},"end":{"line":12,"column":3}},"loc":{"start":{"line":12,"column":12},"end":{"line":14,"column":3}},"line":12},"1":{"name":"(anonymous_1)","decl":{"start":{"line":15,"column":2},"end":{"line":15,"column":3}},"loc":{"start":{"line":15,"column":16},"end":{"line":19,"column":3}},"line":15},"2":{"name":"(anonymous_2)","decl":{"start":{"line":20,"column":2},"end":{"line":20,"column":3}},"loc":{"start":{"line":20,"column":18},"end":{"line":23,"column":3}},"line":20},"3":{"name":"(anonymous_3)","decl":{"start":{"line":24,"column":2},"end":{"line":24,"column":3}},"loc":{"start":{"line":24,"column":18},"end":{"line":27,"column":3}},"line":24},"4":{"name":"(anonymous_4)","decl":{"start":{"line":28,"column":2},"end":{"line":28,"column":3}},"loc":{"start":{"line":28,"column":30},"end":{"line":30,"column":3}},"line":28},"5":{"name":"(anonymous_5)","decl":{"start":{"line":31,"column":2},"end":{"line":31,"column":3}},"loc":{"start":{"line":31,"column":18},"end":{"line":33,"column":3}},"line":31},"6":{"name":"(anonymous_6)","decl":{"start":{"line":34,"column":2},"end":{"line":34,"column":3}},"loc":{"start":{"line":34,"column":13},"end":{"line":36,"column":3}},"line":34}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/border-style-manager.service.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IDisposable } from '@univerjs/core';\nimport { BorderStyleTypes, BorderType } from '@univerjs/core';\nimport { BehaviorSubject } from 'rxjs';\n\nexport interface IBorderInfo {\n    type: BorderType;\n    color: string | undefined;\n    style: BorderStyleTypes;\n    activeBorderType: boolean; // When you click on the border type, then click on the color and style, it should take effect immediately.\n}\n\n/**\n * This service is for managing settings border style status.\n */\nexport class BorderStyleManagerService implements IDisposable {\n    private readonly _borderInfo: IBorderInfo = {\n        type: BorderType.ALL,\n        color: '#000000',\n        style: BorderStyleTypes.THIN,\n        activeBorderType: false,\n    };\n\n    private readonly _borderInfo$ = new BehaviorSubject<IBorderInfo>(this._borderInfo);\n    readonly borderInfo$ = this._borderInfo$.asObservable();\n\n    dispose(): void {\n        this._borderInfo$.complete();\n    }\n\n    setType(type: BorderType): void {\n        this._borderInfo.type = type;\n        this.setActiveBorderType(true);\n        this._refresh();\n    }\n\n    setColor(color: string): void {\n        this._borderInfo.color = color;\n        this._refresh();\n    }\n\n    setStyle(style: BorderStyleTypes): void {\n        this._borderInfo.style = style;\n        this._refresh();\n    }\n\n    setActiveBorderType(status: boolean) {\n        this._borderInfo.activeBorderType = status;\n    }\n\n    getBorderInfo(): Readonly<IBorderInfo> {\n        return this._borderInfo;\n    }\n\n    private _refresh(): void {\n        this._borderInfo$.next(this._borderInfo);\n    }\n}\n"],"mappings":"AAiBA,SAAS,kBAAkB,kBAAkB;AAC7C,SAAS,uBAAuB;AAYzB,aAAM,0BAAiD;AAAA,EACzC,cAA2B;AAAA,IACxC,MAAM,WAAW;AAAA,IACjB,OAAO;AAAA,IACP,OAAO,iBAAiB;AAAA,IACxB,kBAAkB;AAAA,EACtB;AAAA,EAEiB,eAAe,IAAI,gBAA6B,KAAK,WAAW;AAAA,EACxE,cAAc,KAAK,aAAa,aAAa;AAAA,EAEtD,UAAgB;AACZ,SAAK,aAAa,SAAS;AAAA,EAC/B;AAAA,EAEA,QAAQ,MAAwB;AAC5B,SAAK,YAAY,OAAO;AACxB,SAAK,oBAAoB,IAAI;AAC7B,SAAK,SAAS;AAAA,EAClB;AAAA,EAEA,SAAS,OAAqB;AAC1B,SAAK,YAAY,QAAQ;AACzB,SAAK,SAAS;AAAA,EAClB;AAAA,EAEA,SAAS,OAA+B;AACpC,SAAK,YAAY,QAAQ;AACzB,SAAK,SAAS;AAAA,EAClB;AAAA,EAEA,oBAAoB,QAAiB;AACjC,SAAK,YAAY,mBAAmB;AAAA,EACxC;AAAA,EAEA,gBAAuC;AACnC,WAAO,KAAK;AAAA,EAChB;AAAA,EAEQ,WAAiB;AACrB,SAAK,aAAa,KAAK,KAAK,WAAW;AAAA,EAC3C;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"fc07f189dda3059ee2d0113eff570284c64274c3"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/delete-protection.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/delete-protection.ts","statementMap":{"0":{"start":{"line":4,"column":9},"end":{"line":4,"column":31}},"1":{"start":{"line":5,"column":12},"end":{"line":5,"column":29}},"2":{"start":{"line":6,"column":11},"end":{"line":6,"column":32}},"3":{"start":{"line":7,"column":10},"end":{"line":7,"column":14}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":25}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":31}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":37}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":79}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":2},"end":{"line":12,"column":3}},"loc":{"start":{"line":12,"column":47},"end":{"line":17,"column":3}},"line":12}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/delete-protection.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class RangeProtectionPermissionDeleteProtectionPoint implements IPermissionPoint {\n    type = UnitObject.SelectRange;\n    subType = UnitAction.Delete;\n    status = PermissionStatus.INIT;\n    value = true;\n    id: string;\n    unitId: string;\n    subUnitId: string;\n    permissionId: string;\n    constructor(unitId: string, subUnitId: string, permissionId: string) {\n        this.unitId = unitId;\n        this.subUnitId = subUnitId;\n        this.permissionId = permissionId;\n        this.id = `${UnitObject.SelectRange}.${UnitAction.Delete}.${permissionId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,+CAA2E;AAAA,EACpF,OAAO,WAAW;AAAA,EAClB,UAAU,WAAW;AAAA,EACrB,SAAS,iBAAiB;AAAA,EAC1B,QAAQ;AAAA,EACR;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,YAAY,QAAgB,WAAmB,cAAsB;AACjE,SAAK,SAAS;AACd,SAAK,YAAY;AACjB,SAAK,eAAe;AACpB,SAAK,KAAK,GAAG,WAAW,WAAW,IAAI,WAAW,MAAM,IAAI,YAAY;AAAA,EAC5E;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"92913ae64053429b40685e29dc015fde3b465ad7"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/edit.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/edit.ts","statementMap":{"0":{"start":{"line":4,"column":9},"end":{"line":4,"column":31}},"1":{"start":{"line":5,"column":12},"end":{"line":5,"column":27}},"2":{"start":{"line":6,"column":11},"end":{"line":6,"column":32}},"3":{"start":{"line":7,"column":10},"end":{"line":7,"column":14}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":25}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":31}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":37}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":77}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":2},"end":{"line":12,"column":3}},"loc":{"start":{"line":12,"column":47},"end":{"line":17,"column":3}},"line":12}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/edit.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\nimport type { IPermissionPoint } from '@univerjs/core';\n\nexport class RangeProtectionPermissionEditPoint implements IPermissionPoint {\n    type = UnitObject.SelectRange;\n    subType = UnitAction.Edit;\n    status = PermissionStatus.INIT;\n    value = true;\n    id: string;\n    unitId: string;\n    subUnitId: string;\n    permissionId: string;\n    constructor(unitId: string, subUnitId: string, permissionId: string) {\n        this.unitId = unitId;\n        this.subUnitId = subUnitId;\n        this.permissionId = permissionId;\n        this.id = `${UnitObject.SelectRange}.${UnitAction.Edit}.${permissionId}`;\n    }\n}\n"],"mappings":"AAgBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAGhC,aAAM,mCAA+D;AAAA,EACxE,OAAO,WAAW;AAAA,EAClB,UAAU,WAAW;AAAA,EACrB,SAAS,iBAAiB;AAAA,EAC1B,QAAQ;AAAA,EACR;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,YAAY,QAAgB,WAAmB,cAAsB;AACjE,SAAK,SAAS;AACd,SAAK,YAAY;AACjB,SAAK,eAAe;AACpB,SAAK,KAAK,GAAG,WAAW,WAAW,IAAI,WAAW,IAAI,IAAI,YAAY;AAAA,EAC1E;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"1f979d45273f5510d2a13dcfd8d8a2ce2f4f7e33"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/manage-collaborator.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/manage-collaborator.ts","statementMap":{"0":{"start":{"line":4,"column":9},"end":{"line":4,"column":31}},"1":{"start":{"line":5,"column":12},"end":{"line":5,"column":41}},"2":{"start":{"line":6,"column":11},"end":{"line":6,"column":32}},"3":{"start":{"line":7,"column":10},"end":{"line":7,"column":14}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":25}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":31}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":37}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":91}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":2},"end":{"line":12,"column":3}},"loc":{"start":{"line":12,"column":47},"end":{"line":17,"column":3}},"line":12}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/manage-collaborator.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class RangeProtectionPermissionManageCollaPoint implements IPermissionPoint {\n    type = UnitObject.SelectRange;\n    subType = UnitAction.ManageCollaborator;\n    status = PermissionStatus.INIT;\n    value = true;\n    id: string;\n    unitId: string;\n    subUnitId: string;\n    permissionId: string;\n    constructor(unitId: string, subUnitId: string, permissionId: string) {\n        this.unitId = unitId;\n        this.subUnitId = subUnitId;\n        this.permissionId = permissionId;\n        this.id = `${UnitObject.SelectRange}.${UnitAction.ManageCollaborator}.${permissionId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,0CAAsE;AAAA,EAC/E,OAAO,WAAW;AAAA,EAClB,UAAU,WAAW;AAAA,EACrB,SAAS,iBAAiB;AAAA,EAC1B,QAAQ;AAAA,EACR;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,YAAY,QAAgB,WAAmB,cAAsB;AACjE,SAAK,SAAS;AACd,SAAK,YAAY;AACjB,SAAK,eAAe;AACpB,SAAK,KAAK,GAAG,WAAW,WAAW,IAAI,WAAW,kBAAkB,IAAI,YAAY;AAAA,EACxF;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c2583668b2500d16234334d15593f5dac2b8ddf1"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/view.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/view.ts","statementMap":{"0":{"start":{"line":4,"column":9},"end":{"line":4,"column":31}},"1":{"start":{"line":5,"column":12},"end":{"line":5,"column":27}},"2":{"start":{"line":6,"column":11},"end":{"line":6,"column":32}},"3":{"start":{"line":7,"column":10},"end":{"line":7,"column":14}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":25}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":31}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":37}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":77}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":2},"end":{"line":12,"column":3}},"loc":{"start":{"line":12,"column":47},"end":{"line":17,"column":3}},"line":12}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/view.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class RangeProtectionPermissionViewPoint implements IPermissionPoint {\n    type = UnitObject.SelectRange;\n    subType = UnitAction.View;\n    status = PermissionStatus.INIT;\n    value = true;\n    id: string;\n    unitId: string;\n    subUnitId: string;\n    permissionId: string;\n    constructor(unitId: string, subUnitId: string, permissionId: string) {\n        this.unitId = unitId;\n        this.subUnitId = subUnitId;\n        this.permissionId = permissionId;\n        this.id = `${UnitObject.SelectRange}.${UnitAction.View}.${permissionId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,mCAA+D;AAAA,EACxE,OAAO,WAAW;AAAA,EAClB,UAAU,WAAW;AAAA,EACrB,SAAS,iBAAiB;AAAA,EAC1B,QAAQ;AAAA,EACR;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,YAAY,QAAgB,WAAmB,cAAsB;AACjE,SAAK,SAAS;AACd,SAAK,YAAY;AACjB,SAAK,eAAe;AACpB,SAAK,KAAK,GAAG,WAAW,WAAW,IAAI,WAAW,IAAI,IAAI,YAAY;AAAA,EAC1E;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a103a7ade3c1ac529d07805a0dcbb27f4201432b"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/range-permission/util.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/range-permission/util.ts","statementMap":{"0":{"start":{"line":6,"column":42},"end":{"line":6,"column":211}},"1":{"start":{"line":6,"column":48},"end":{"line":6,"column":211}},"2":{"start":{"line":7,"column":37},"end":{"line":7,"column":121}},"3":{"start":{"line":8,"column":41},"end":{"line":12,"column":6}},"4":{"start":{"line":8,"column":120},"end":{"line":12,"column":6}},"5":{"start":{"line":9,"column":12},"end":{"line":9,"column":50}},"6":{"start":{"line":10,"column":2},"end":{"line":10,"column":25}},"7":{"start":{"line":11,"column":2},"end":{"line":11,"column":11}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":42},"end":{"line":6,"column":43}},"loc":{"start":{"line":6,"column":48},"end":{"line":6,"column":211}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":8,"column":41},"end":{"line":8,"column":42}},"loc":{"start":{"line":8,"column":120},"end":{"line":12,"column":6}},"line":8},"2":{"name":"(anonymous_2)","decl":{"start":{"line":8,"column":156},"end":{"line":8,"column":157}},"loc":{"start":{"line":8,"column":166},"end":{"line":12,"column":1}},"line":8}},"branchMap":{"0":{"loc":{"start":{"line":8,"column":42},"end":{"line":8,"column":59}},"type":"default-arg","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":59}}],"line":8},"1":{"loc":{"start":{"line":8,"column":61},"end":{"line":8,"column":84}},"type":"default-arg","locations":[{"start":{"line":8,"column":73},"end":{"line":8,"column":84}}],"line":8},"2":{"loc":{"start":{"line":8,"column":86},"end":{"line":8,"column":115}},"type":"default-arg","locations":[{"start":{"line":8,"column":101},"end":{"line":8,"column":115}}],"line":8}},"s":{"0":1,"1":0,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0},"f":{"0":0,"1":0,"2":0},"b":{"0":[0],"1":[0],"2":[0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/range-permission/util.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UnitAction } from '@univerjs/protocol';\nimport { RangeProtectionPermissionDeleteProtectionPoint } from '../permission-point/range/delete-protection';\nimport { RangeProtectionPermissionEditPoint } from '../permission-point/range/edit';\nimport { RangeProtectionPermissionManageCollaPoint } from '../permission-point/range/manage-collaborator';\nimport { RangeProtectionPermissionViewPoint } from '../permission-point/range/view';\n\nexport type IRangePermissionPoint = RangeProtectionPermissionEditPoint | RangeProtectionPermissionViewPoint;\n\nexport const getAllRangePermissionPoint = () => [RangeProtectionPermissionViewPoint, RangeProtectionPermissionEditPoint, RangeProtectionPermissionManageCollaPoint, RangeProtectionPermissionDeleteProtectionPoint];\n\nexport const baseProtectionActions = [UnitAction.Edit, UnitAction.View, UnitAction.ManageCollaborator, UnitAction.Delete];\n\nexport const getDefaultRangePermission = (unitId = 'unitId', subUnitId = 'subUnitId', permissionId = 'permissionId') => getAllRangePermissionPoint().reduce((r, F) => {\n    const i = new F(unitId, subUnitId, permissionId);\n    r[i.subType] = i.value;\n    return r;\n}, {} as Record<UnitAction, boolean>);\n"],"mappings":"AAgBA,SAAS,kBAAkB;AAC3B,SAAS,sDAAsD;AAC/D,SAAS,0CAA0C;AACnD,SAAS,iDAAiD;AAC1D,SAAS,0CAA0C;AAI5C,aAAM,6BAA6B,MAAM,CAAC,oCAAoC,oCAAoC,2CAA2C,8CAA8C;AAE3M,aAAM,wBAAwB,CAAC,WAAW,MAAM,WAAW,MAAM,WAAW,oBAAoB,WAAW,MAAM;AAEjH,aAAM,4BAA4B,CAAC,SAAS,UAAU,YAAY,aAAa,eAAe,mBAAmB,2BAA2B,EAAE,OAAO,CAAC,GAAG,MAAM;AAClK,QAAM,IAAI,IAAI,EAAE,QAAQ,WAAW,YAAY;AAC/C,IAAE,EAAE,OAAO,IAAI,EAAE;AACjB,SAAO;AACX,GAAG,CAAC,CAAgC;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"98561f63789a6bf27b06de273ba52f1ac31c7851"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/index.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/index.ts","statementMap":{},"fnMap":{},"branchMap":{},"s":{},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/index.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport { WorksheetProtectionPointModel } from './worksheet-permission-point.model';\nexport { WorksheetProtectionRuleModel } from './worksheet-permission-rule.model';\nexport { WorksheetPermissionService } from './worksheet-permission.service';\n"],"mappings":"AAgBA,SAAS,qCAAqC;AAC9C,SAAS,oCAAoC;AAC7C,SAAS,kCAAkC;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"02c010c187659fba59fdd95827cc2dc9634fa0fe"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission-point.model.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission-point.model.ts","statementMap":{"0":{"start":{"line":3,"column":27},"end":{"line":3,"column":36}},"1":{"start":{"line":4,"column":17},"end":{"line":4,"column":30}},"2":{"start":{"line":5,"column":17},"end":{"line":5,"column":49}},"3":{"start":{"line":7,"column":23},"end":{"line":7,"column":58}},"4":{"start":{"line":8,"column":4},"end":{"line":8,"column":41}},"5":{"start":{"line":9,"column":4},"end":{"line":9,"column":33}},"6":{"start":{"line":12,"column":17},"end":{"line":12,"column":56}},"7":{"start":{"line":13,"column":4},"end":{"line":16,"column":5}},"8":{"start":{"line":14,"column":6},"end":{"line":14,"column":50}},"9":{"start":{"line":15,"column":6},"end":{"line":15,"column":35}},"10":{"start":{"line":19,"column":4},"end":{"line":19,"column":52}},"11":{"start":{"line":22,"column":19},"end":{"line":22,"column":21}},"12":{"start":{"line":23,"column":21},"end":{"line":23,"column":44}},"13":{"start":{"line":24,"column":4},"end":{"line":36,"column":7}},"14":{"start":{"line":25,"column":25},"end":{"line":25,"column":48}},"15":{"start":{"line":26,"column":6},"end":{"line":35,"column":7}},"16":{"start":{"line":27,"column":8},"end":{"line":27,"column":28}},"17":{"start":{"line":28,"column":28},"end":{"line":28,"column":50}},"18":{"start":{"line":29,"column":8},"end":{"line":34,"column":11}},"19":{"start":{"line":30,"column":23},"end":{"line":30,"column":48}},"20":{"start":{"line":31,"column":10},"end":{"line":33,"column":11}},"21":{"start":{"line":32,"column":12},"end":{"line":32,"column":38}},"22":{"start":{"line":37,"column":4},"end":{"line":37,"column":18}},"23":{"start":{"line":40,"column":35},"end":{"line":40,"column":44}},"24":{"start":{"line":41,"column":4},"end":{"line":50,"column":7}},"25":{"start":{"line":42,"column":26},"end":{"line":42,"column":37}},"26":{"start":{"line":43,"column":6},"end":{"line":49,"column":7}},"27":{"start":{"line":44,"column":43},"end":{"line":44,"column":52}},"28":{"start":{"line":45,"column":8},"end":{"line":47,"column":11}},"29":{"start":{"line":46,"column":10},"end":{"line":46,"column":47}},"30":{"start":{"line":48,"column":8},"end":{"line":48,"column":39}},"31":{"start":{"line":51,"column":4},"end":{"line":51,"column":25}},"32":{"start":{"line":54,"column":4},"end":{"line":54,"column":31}},"33":{"start":{"line":57,"column":21},"end":{"line":57,"column":44}},"34":{"start":{"line":58,"column":4},"end":{"line":61,"column":5}},"35":{"start":{"line":59,"column":6},"end":{"line":59,"column":45}},"36":{"start":{"line":60,"column":6},"end":{"line":60,"column":42}},"37":{"start":{"line":62,"column":4},"end":{"line":62,"column":22}},"38":{"start":{"line":65,"column":23},"end":{"line":65,"column":46}},"39":{"start":{"line":66,"column":4},"end":{"line":66,"column":33}},"40":{"start":{"line":66,"column":21},"end":{"line":66,"column":33}},"41":{"start":{"line":67,"column":4},"end":{"line":71,"column":5}},"42":{"start":{"line":68,"column":6},"end":{"line":70,"column":7}},"43":{"start":{"line":69,"column":8},"end":{"line":69,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":2},"end":{"line":6,"column":3}},"loc":{"start":{"line":6,"column":16},"end":{"line":10,"column":3}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":2},"end":{"line":11,"column":3}},"loc":{"start":{"line":11,"column":32},"end":{"line":17,"column":3}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":18,"column":2},"end":{"line":18,"column":3}},"loc":{"start":{"line":18,"column":29},"end":{"line":20,"column":3}},"line":18},"3":{"name":"(anonymous_3)","decl":{"start":{"line":21,"column":2},"end":{"line":21,"column":3}},"loc":{"start":{"line":21,"column":13},"end":{"line":38,"column":3}},"line":21},"4":{"name":"(anonymous_4)","decl":{"start":{"line":24,"column":21},"end":{"line":24,"column":22}},"loc":{"start":{"line":24,"column":33},"end":{"line":36,"column":5}},"line":24},"5":{"name":"(anonymous_5)","decl":{"start":{"line":29,"column":28},"end":{"line":29,"column":29}},"loc":{"start":{"line":29,"column":43},"end":{"line":34,"column":9}},"line":29},"6":{"name":"(anonymous_6)","decl":{"start":{"line":39,"column":2},"end":{"line":39,"column":3}},"loc":{"start":{"line":39,"column":18},"end":{"line":52,"column":3}},"line":39},"7":{"name":"(anonymous_7)","decl":{"start":{"line":41,"column":29},"end":{"line":41,"column":30}},"loc":{"start":{"line":41,"column":41},"end":{"line":50,"column":5}},"line":41},"8":{"name":"(anonymous_8)","decl":{"start":{"line":45,"column":28},"end":{"line":45,"column":29}},"loc":{"start":{"line":45,"column":38},"end":{"line":47,"column":9}},"line":45},"9":{"name":"(anonymous_9)","decl":{"start":{"line":53,"column":2},"end":{"line":53,"column":3}},"loc":{"start":{"line":53,"column":26},"end":{"line":55,"column":3}},"line":53},"10":{"name":"(anonymous_10)","decl":{"start":{"line":56,"column":2},"end":{"line":56,"column":3}},"loc":{"start":{"line":56,"column":28},"end":{"line":63,"column":3}},"line":56},"11":{"name":"(anonymous_11)","decl":{"start":{"line":64,"column":2},"end":{"line":64,"column":3}},"loc":{"start":{"line":64,"column":48},"end":{"line":72,"column":3}},"line":64}},"branchMap":{"0":{"loc":{"start":{"line":13,"column":4},"end":{"line":16,"column":5}},"type":"if","locations":[{"start":{"line":13,"column":4},"end":{"line":16,"column":5}},{"start":{},"end":{}}],"line":13},"1":{"loc":{"start":{"line":26,"column":6},"end":{"line":35,"column":7}},"type":"if","locations":[{"start":{"line":26,"column":6},"end":{"line":35,"column":7}},{"start":{},"end":{}}],"line":26},"2":{"loc":{"start":{"line":31,"column":10},"end":{"line":33,"column":11}},"type":"if","locations":[{"start":{"line":31,"column":10},"end":{"line":33,"column":11}},{"start":{},"end":{}}],"line":31},"3":{"loc":{"start":{"line":43,"column":6},"end":{"line":49,"column":7}},"type":"if","locations":[{"start":{"line":43,"column":6},"end":{"line":49,"column":7}},{"start":{},"end":{}}],"line":43},"4":{"loc":{"start":{"line":58,"column":4},"end":{"line":61,"column":5}},"type":"if","locations":[{"start":{"line":58,"column":4},"end":{"line":61,"column":5}},{"start":{},"end":{}}],"line":58},"5":{"loc":{"start":{"line":66,"column":4},"end":{"line":66,"column":33}},"type":"if","locations":[{"start":{"line":66,"column":4},"end":{"line":66,"column":33}},{"start":{},"end":{}}],"line":66},"6":{"loc":{"start":{"line":68,"column":6},"end":{"line":70,"column":7}},"type":"if","locations":[{"start":{"line":68,"column":6},"end":{"line":70,"column":7}},{"start":{},"end":{}}],"line":68}},"s":{"0":5,"1":5,"2":5,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission-point.model.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IObjectPointModel, IPointRuleModel, IWorksheetProtectionPointRule } from '../type';\nimport { Subject } from 'rxjs';\n\nexport class WorksheetProtectionPointModel {\n    private _model: IPointRuleModel = new Map();\n\n    private _pointChange = new Subject<{\n        unitId: string;\n        subUnitId: string;\n        permissionId: string;\n    }>();\n\n    pointChange$ = this._pointChange.asObservable();\n\n    addRule(rule: IWorksheetProtectionPointRule) {\n        const subUnitMap = this._ensureSubUnitMap(rule.unitId);\n        subUnitMap.set(rule.subUnitId, rule);\n        this._pointChange.next(rule);\n    }\n\n    deleteRule(unitId: string, subUnitId: string) {\n        const rule = this._model.get(unitId)?.get(subUnitId);\n        if (rule) {\n            this._model?.get(unitId)?.delete(subUnitId);\n            this._pointChange.next(rule);\n        }\n    }\n\n    getRule(unitId: string, subUnitId: string) {\n        return this._model?.get(unitId)?.get(subUnitId);\n    }\n\n    toObject() {\n        const result: IObjectPointModel = {};\n        const unitKeys = [...this._model.keys()];\n        unitKeys.forEach((unitId) => {\n            const subUnitMap = this._model.get(unitId);\n            if (subUnitMap?.size) {\n                result[unitId] = [];\n                const subUnitKeys = [...subUnitMap.keys()];\n                subUnitKeys.forEach((subUnitId) => {\n                    const rule = subUnitMap.get(subUnitId);\n                    if (rule) {\n                        result[unitId].push(rule);\n                    }\n                });\n            }\n        });\n        return result;\n    }\n\n    fromObject(obj: IObjectPointModel) {\n        const result: IPointRuleModel = new Map();\n        Object.keys(obj).forEach((unitId) => {\n            const subUnitList = obj[unitId];\n            if (subUnitList?.length) {\n                const subUnitMap = new Map();\n                subUnitList.forEach((rule) => {\n                    subUnitMap.set(rule.subUnitId, rule);\n                });\n                result.set(unitId, subUnitMap);\n            }\n        });\n        this._model = result;\n    }\n\n    deleteUnitModel(unitId: string) {\n        this._model.delete(unitId);\n    }\n\n    private _ensureSubUnitMap(unitId: string) {\n        let subUnitMap = this._model.get(unitId);\n        if (!subUnitMap) {\n            subUnitMap = new Map();\n            this._model.set(unitId, subUnitMap);\n        }\n        return subUnitMap;\n    }\n\n    getTargetByPermissionId(unitId: string, permissionId: string) {\n        const subUnitMap = this._model.get(unitId);\n        if (!subUnitMap) return null;\n        for (const [subUnitId, rule] of subUnitMap) {\n            if (rule.permissionId === permissionId) {\n                return [unitId, subUnitId];\n            }\n        }\n    }\n}\n"],"mappings":"AAiBA,SAAS,eAAe;AAEjB,aAAM,8BAA8B;AAAA,EAC/B,SAA0B,oBAAI,IAAI;AAAA,EAElC,eAAe,IAAI,QAIxB;AAAA,EAEH,eAAe,KAAK,aAAa,aAAa;AAAA,EAE9C,QAAQ,MAAqC;AACzC,UAAM,aAAa,KAAK,kBAAkB,KAAK,MAAM;AACrD,eAAW,IAAI,KAAK,WAAW,IAAI;AACnC,SAAK,aAAa,KAAK,IAAI;AAAA,EAC/B;AAAA,EAEA,WAAW,QAAgB,WAAmB;AAC1C,UAAM,OAAO,KAAK,OAAO,IAAI,MAAM,GAAG,IAAI,SAAS;AACnD,QAAI,MAAM;AACN,WAAK,QAAQ,IAAI,MAAM,GAAG,OAAO,SAAS;AAC1C,WAAK,aAAa,KAAK,IAAI;AAAA,IAC/B;AAAA,EACJ;AAAA,EAEA,QAAQ,QAAgB,WAAmB;AACvC,WAAO,KAAK,QAAQ,IAAI,MAAM,GAAG,IAAI,SAAS;AAAA,EAClD;AAAA,EAEA,WAAW;AACP,UAAM,SAA4B,CAAC;AACnC,UAAM,WAAW,CAAC,GAAG,KAAK,OAAO,KAAK,CAAC;AACvC,aAAS,QAAQ,CAAC,WAAW;AACzB,YAAM,aAAa,KAAK,OAAO,IAAI,MAAM;AACzC,UAAI,YAAY,MAAM;AAClB,eAAO,MAAM,IAAI,CAAC;AAClB,cAAM,cAAc,CAAC,GAAG,WAAW,KAAK,CAAC;AACzC,oBAAY,QAAQ,CAAC,cAAc;AAC/B,gBAAM,OAAO,WAAW,IAAI,SAAS;AACrC,cAAI,MAAM;AACN,mBAAO,MAAM,EAAE,KAAK,IAAI;AAAA,UAC5B;AAAA,QACJ,CAAC;AAAA,MACL;AAAA,IACJ,CAAC;AACD,WAAO;AAAA,EACX;AAAA,EAEA,WAAW,KAAwB;AAC/B,UAAM,SAA0B,oBAAI,IAAI;AACxC,WAAO,KAAK,GAAG,EAAE,QAAQ,CAAC,WAAW;AACjC,YAAM,cAAc,IAAI,MAAM;AAC9B,UAAI,aAAa,QAAQ;AACrB,cAAM,aAAa,oBAAI,IAAI;AAC3B,oBAAY,QAAQ,CAAC,SAAS;AAC1B,qBAAW,IAAI,KAAK,WAAW,IAAI;AAAA,QACvC,CAAC;AACD,eAAO,IAAI,QAAQ,UAAU;AAAA,MACjC;AAAA,IACJ,CAAC;AACD,SAAK,SAAS;AAAA,EAClB;AAAA,EAEA,gBAAgB,QAAgB;AAC5B,SAAK,OAAO,OAAO,MAAM;AAAA,EAC7B;AAAA,EAEQ,kBAAkB,QAAgB;AACtC,QAAI,aAAa,KAAK,OAAO,IAAI,MAAM;AACvC,QAAI,CAAC,YAAY;AACb,mBAAa,oBAAI,IAAI;AACrB,WAAK,OAAO,IAAI,QAAQ,UAAU;AAAA,IACtC;AACA,WAAO;AAAA,EACX;AAAA,EAEA,wBAAwB,QAAgB,cAAsB;AAC1D,UAAM,aAAa,KAAK,OAAO,IAAI,MAAM;AACzC,QAAI,CAAC,WAAY,QAAO;AACxB,eAAW,CAAC,WAAW,IAAI,KAAK,YAAY;AACxC,UAAI,KAAK,iBAAiB,cAAc;AACpC,eAAO,CAAC,QAAQ,SAAS;AAAA,MAC7B;AAAA,IACJ;AAAA,EACJ;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"aeb856c4661ce4bcf89f86653d4866d12e72331c"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission-rule.model.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission-rule.model.ts","statementMap":{"0":{"start":{"line":7,"column":27},"end":{"line":7,"column":36}},"1":{"start":{"line":8,"column":16},"end":{"line":8,"column":29}},"2":{"start":{"line":9,"column":17},"end":{"line":9,"column":30}},"3":{"start":{"line":10,"column":16},"end":{"line":10,"column":29}},"4":{"start":{"line":11,"column":16},"end":{"line":11,"column":47}},"5":{"start":{"line":12,"column":17},"end":{"line":12,"column":49}},"6":{"start":{"line":13,"column":16},"end":{"line":13,"column":47}},"7":{"start":{"line":14,"column":34},"end":{"line":14,"column":60}},"8":{"start":{"line":15,"column":34},"end":{"line":15,"column":83}},"9":{"start":{"line":17,"column":4},"end":{"line":17,"column":51}},"10":{"start":{"line":20,"column":4},"end":{"line":20,"column":52}},"11":{"start":{"line":23,"column":23},"end":{"line":23,"column":53}},"12":{"start":{"line":24,"column":4},"end":{"line":24,"column":41}},"13":{"start":{"line":25,"column":4},"end":{"line":25,"column":84}},"14":{"start":{"line":28,"column":17},"end":{"line":28,"column":57}},"15":{"start":{"line":29,"column":4},"end":{"line":32,"column":5}},"16":{"start":{"line":30,"column":6},"end":{"line":30,"column":49}},"17":{"start":{"line":31,"column":6},"end":{"line":31,"column":73}},"18":{"start":{"line":35,"column":20},"end":{"line":35,"column":51}},"19":{"start":{"line":36,"column":4},"end":{"line":39,"column":5}},"20":{"start":{"line":37,"column":6},"end":{"line":37,"column":53}},"21":{"start":{"line":38,"column":6},"end":{"line":38,"column":79}},"22":{"start":{"line":42,"column":4},"end":{"line":42,"column":52}},"23":{"start":{"line":45,"column":19},"end":{"line":45,"column":21}},"24":{"start":{"line":46,"column":21},"end":{"line":46,"column":44}},"25":{"start":{"line":47,"column":4},"end":{"line":59,"column":7}},"26":{"start":{"line":48,"column":25},"end":{"line":48,"column":48}},"27":{"start":{"line":49,"column":6},"end":{"line":58,"column":7}},"28":{"start":{"line":50,"column":8},"end":{"line":50,"column":28}},"29":{"start":{"line":51,"column":28},"end":{"line":51,"column":50}},"30":{"start":{"line":52,"column":8},"end":{"line":57,"column":11}},"31":{"start":{"line":53,"column":23},"end":{"line":53,"column":48}},"32":{"start":{"line":54,"column":10},"end":{"line":56,"column":11}},"33":{"start":{"line":55,"column":12},"end":{"line":55,"column":38}},"34":{"start":{"line":60,"column":4},"end":{"line":60,"column":18}},"35":{"start":{"line":63,"column":35},"end":{"line":63,"column":44}},"36":{"start":{"line":64,"column":4},"end":{"line":73,"column":7}},"37":{"start":{"line":65,"column":26},"end":{"line":65,"column":37}},"38":{"start":{"line":66,"column":6},"end":{"line":72,"column":7}},"39":{"start":{"line":67,"column":43},"end":{"line":67,"column":52}},"40":{"start":{"line":68,"column":8},"end":{"line":70,"column":11}},"41":{"start":{"line":69,"column":10},"end":{"line":69,"column":47}},"42":{"start":{"line":71,"column":8},"end":{"line":71,"column":39}},"43":{"start":{"line":74,"column":4},"end":{"line":74,"column":25}},"44":{"start":{"line":77,"column":4},"end":{"line":77,"column":31}},"45":{"start":{"line":80,"column":21},"end":{"line":80,"column":44}},"46":{"start":{"line":81,"column":4},"end":{"line":84,"column":5}},"47":{"start":{"line":82,"column":6},"end":{"line":82,"column":45}},"48":{"start":{"line":83,"column":6},"end":{"line":83,"column":42}},"49":{"start":{"line":85,"column":4},"end":{"line":85,"column":22}},"50":{"start":{"line":88,"column":4},"end":{"line":88,"column":41}},"51":{"start":{"line":91,"column":4},"end":{"line":91,"column":41}},"52":{"start":{"line":94,"column":23},"end":{"line":94,"column":46}},"53":{"start":{"line":95,"column":4},"end":{"line":95,"column":33}},"54":{"start":{"line":95,"column":21},"end":{"line":95,"column":33}},"55":{"start":{"line":96,"column":4},"end":{"line":100,"column":5}},"56":{"start":{"line":97,"column":6},"end":{"line":99,"column":7}},"57":{"start":{"line":98,"column":8},"end":{"line":98,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":16,"column":2},"end":{"line":16,"column":3}},"loc":{"start":{"line":16,"column":29},"end":{"line":18,"column":3}},"line":16},"1":{"name":"(anonymous_1)","decl":{"start":{"line":19,"column":2},"end":{"line":19,"column":3}},"loc":{"start":{"line":19,"column":26},"end":{"line":21,"column":3}},"line":19},"2":{"name":"(anonymous_2)","decl":{"start":{"line":22,"column":2},"end":{"line":22,"column":3}},"loc":{"start":{"line":22,"column":24},"end":{"line":26,"column":3}},"line":22},"3":{"name":"(anonymous_3)","decl":{"start":{"line":27,"column":2},"end":{"line":27,"column":3}},"loc":{"start":{"line":27,"column":32},"end":{"line":33,"column":3}},"line":27},"4":{"name":"(anonymous_4)","decl":{"start":{"line":34,"column":2},"end":{"line":34,"column":3}},"loc":{"start":{"line":34,"column":35},"end":{"line":40,"column":3}},"line":34},"5":{"name":"(anonymous_5)","decl":{"start":{"line":41,"column":2},"end":{"line":41,"column":3}},"loc":{"start":{"line":41,"column":29},"end":{"line":43,"column":3}},"line":41},"6":{"name":"(anonymous_6)","decl":{"start":{"line":44,"column":2},"end":{"line":44,"column":3}},"loc":{"start":{"line":44,"column":13},"end":{"line":61,"column":3}},"line":44},"7":{"name":"(anonymous_7)","decl":{"start":{"line":47,"column":21},"end":{"line":47,"column":22}},"loc":{"start":{"line":47,"column":33},"end":{"line":59,"column":5}},"line":47},"8":{"name":"(anonymous_8)","decl":{"start":{"line":52,"column":28},"end":{"line":52,"column":29}},"loc":{"start":{"line":52,"column":43},"end":{"line":57,"column":9}},"line":52},"9":{"name":"(anonymous_9)","decl":{"start":{"line":62,"column":2},"end":{"line":62,"column":3}},"loc":{"start":{"line":62,"column":18},"end":{"line":75,"column":3}},"line":62},"10":{"name":"(anonymous_10)","decl":{"start":{"line":64,"column":29},"end":{"line":64,"column":30}},"loc":{"start":{"line":64,"column":41},"end":{"line":73,"column":5}},"line":64},"11":{"name":"(anonymous_11)","decl":{"start":{"line":68,"column":28},"end":{"line":68,"column":29}},"loc":{"start":{"line":68,"column":38},"end":{"line":70,"column":9}},"line":68},"12":{"name":"(anonymous_12)","decl":{"start":{"line":76,"column":2},"end":{"line":76,"column":3}},"loc":{"start":{"line":76,"column":26},"end":{"line":78,"column":3}},"line":76},"13":{"name":"(anonymous_13)","decl":{"start":{"line":79,"column":2},"end":{"line":79,"column":3}},"loc":{"start":{"line":79,"column":28},"end":{"line":86,"column":3}},"line":79},"14":{"name":"(anonymous_14)","decl":{"start":{"line":87,"column":2},"end":{"line":87,"column":3}},"loc":{"start":{"line":87,"column":28},"end":{"line":89,"column":3}},"line":87},"15":{"name":"(anonymous_15)","decl":{"start":{"line":90,"column":2},"end":{"line":90,"column":3}},"loc":{"start":{"line":90,"column":15},"end":{"line":92,"column":3}},"line":90},"16":{"name":"(anonymous_16)","decl":{"start":{"line":93,"column":2},"end":{"line":93,"column":3}},"loc":{"start":{"line":93,"column":48},"end":{"line":101,"column":3}},"line":93}},"branchMap":{"0":{"loc":{"start":{"line":29,"column":4},"end":{"line":32,"column":5}},"type":"if","locations":[{"start":{"line":29,"column":4},"end":{"line":32,"column":5}},{"start":{},"end":{}}],"line":29},"1":{"loc":{"start":{"line":36,"column":4},"end":{"line":39,"column":5}},"type":"if","locations":[{"start":{"line":36,"column":4},"end":{"line":39,"column":5}},{"start":{},"end":{}}],"line":36},"2":{"loc":{"start":{"line":49,"column":6},"end":{"line":58,"column":7}},"type":"if","locations":[{"start":{"line":49,"column":6},"end":{"line":58,"column":7}},{"start":{},"end":{}}],"line":49},"3":{"loc":{"start":{"line":54,"column":10},"end":{"line":56,"column":11}},"type":"if","locations":[{"start":{"line":54,"column":10},"end":{"line":56,"column":11}},{"start":{},"end":{}}],"line":54},"4":{"loc":{"start":{"line":66,"column":6},"end":{"line":72,"column":7}},"type":"if","locations":[{"start":{"line":66,"column":6},"end":{"line":72,"column":7}},{"start":{},"end":{}}],"line":66},"5":{"loc":{"start":{"line":81,"column":4},"end":{"line":84,"column":5}},"type":"if","locations":[{"start":{"line":81,"column":4},"end":{"line":84,"column":5}},{"start":{},"end":{}}],"line":81},"6":{"loc":{"start":{"line":95,"column":4},"end":{"line":95,"column":33}},"type":"if","locations":[{"start":{"line":95,"column":4},"end":{"line":95,"column":33}},{"start":{},"end":{}}],"line":95},"7":{"loc":{"start":{"line":97,"column":6},"end":{"line":99,"column":7}},"type":"if","locations":[{"start":{"line":97,"column":6},"end":{"line":99,"column":7}},{"start":{},"end":{}}],"line":97}},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5,"7":5,"8":5,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission-rule.model.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IModel, IObjectModel, IWorksheetProtectionRule } from '../type';\nimport { BehaviorSubject, Subject } from 'rxjs';\n\ntype IRuleChangeType = 'add' | 'set' | 'delete';\n\nexport class WorksheetProtectionRuleModel {\n    /**\n     *\n     * Map<unitId, Map<subUnitId, Map<subUnitId, IWorksheetProtectionRule>>>\n     */\n    private _model: IModel = new Map();\n\n    private _ruleChange = new Subject<{\n        unitId: string;\n        subUnitId: string;\n        rule: IWorksheetProtectionRule;\n        oldRule?: IWorksheetProtectionRule;\n        type: IRuleChangeType;\n    }>();\n\n    private _ruleRefresh = new Subject<string>();\n    private _resetOrder = new Subject();\n\n    ruleChange$ = this._ruleChange.asObservable();\n\n    ruleRefresh$ = this._ruleRefresh.asObservable();\n\n    resetOrder$ = this._resetOrder.asObservable();\n\n    private _worksheetRuleInitStateChange = new BehaviorSubject<boolean>(false);\n    worksheetRuleInitStateChange$ = this._worksheetRuleInitStateChange.asObservable();\n\n    changeRuleInitState(state: boolean) {\n        this._worksheetRuleInitStateChange.next(state);\n    }\n\n    getSheetRuleInitState() {\n        return this._worksheetRuleInitStateChange.value;\n    }\n\n    addRule(unitId: string, rule: IWorksheetProtectionRule) {\n        const subUnitMap = this._ensureSubUnitMap(unitId);\n        subUnitMap.set(rule.subUnitId, rule);\n        this._ruleChange.next({ unitId, rule, type: 'add', subUnitId: rule.subUnitId });\n    }\n\n    deleteRule(unitId: string, subUnitId: string) {\n        const rule = this._model?.get(unitId)?.get(subUnitId);\n        if (rule) {\n            this._model.get(unitId)?.delete(subUnitId);\n            this._ruleChange.next({ unitId, rule, type: 'delete', subUnitId });\n        }\n    }\n\n    setRule(unitId: string, subUnitId: string, rule: IWorksheetProtectionRule) {\n        const oldRule = this.getRule(unitId, subUnitId);\n        if (oldRule) {\n            this._model?.get(unitId)?.set(subUnitId, rule);\n            this._ruleChange.next({ unitId, oldRule, rule, type: 'set', subUnitId });\n        }\n    }\n\n    getRule(unitId: string, subUnitId: string) {\n        return this._model?.get(unitId)?.get(subUnitId);\n    }\n\n    toObject() {\n        const result: IObjectModel = {};\n        const unitKeys = [...this._model.keys()];\n        unitKeys.forEach((unitId) => {\n            const subUnitMap = this._model.get(unitId);\n            if (subUnitMap?.size) {\n                result[unitId] = [];\n                const subUnitKeys = [...subUnitMap.keys()];\n                subUnitKeys.forEach((subUnitId) => {\n                    const rule = subUnitMap.get(subUnitId);\n                    if (rule) {\n                        result[unitId].push(rule);\n                    }\n                });\n            }\n        });\n        return result;\n    }\n\n    fromObject(obj: IObjectModel) {\n        const result: IModel = new Map();\n        Object.keys(obj).forEach((unitId) => {\n            const subUnitList = obj[unitId];\n            if (subUnitList?.length) {\n                const subUnitMap = new Map();\n                subUnitList.forEach((rule) => {\n                    subUnitMap.set(rule.subUnitId, rule);\n                });\n                result.set(unitId, subUnitMap);\n            }\n        });\n        this._model = result;\n    }\n\n    deleteUnitModel(unitId: string) {\n        this._model.delete(unitId);\n    }\n\n    private _ensureSubUnitMap(unitId: string) {\n        let subUnitMap = this._model.get(unitId);\n        if (!subUnitMap) {\n            subUnitMap = new Map();\n            this._model.set(unitId, subUnitMap);\n        }\n        return subUnitMap;\n    }\n\n    ruleRefresh(permissionId: string) {\n        this._ruleRefresh.next(permissionId);\n    }\n\n    resetOrder() {\n        this._resetOrder.next(Math.random());\n    }\n\n    getTargetByPermissionId(unitId: string, permissionId: string) {\n        const subUnitMap = this._model.get(unitId);\n        if (!subUnitMap) return null;\n        for (const [subUnitId, rule] of subUnitMap) {\n            if (rule.permissionId === permissionId) {\n                return [unitId, subUnitId];\n            }\n        }\n    }\n}\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ead29d308c2ab8bdfb78505c478297794e1202c7"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/index.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/index.ts","statementMap":{},"fnMap":{},"branchMap":{},"s":{},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/index.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport { getAllWorkbookPermissionPoint, defaultWorkbookPermissionPoints } from './util';\n"],"mappings":"AAgBA,SAAS,+BAA+B,uCAAuC;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"11cafdf04fea9cb4f902e1f5b98a9a1327b2a8c5"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/index.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/index.ts","statementMap":{},"fnMap":{},"branchMap":{},"s":{},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/index.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport { RangeProtectionPermissionEditPoint } from './range/edit';\nexport { RangeProtectionPermissionViewPoint } from './range/view';\nexport { WorkbookCommentPermission } from './workbook/comment';\nexport { WorkbookCopyPermission } from './workbook/copy';\nexport { WorkbookCopySheetPermission } from './workbook/copy-sheet';\nexport { WorkbookCreateProtectPermission } from './workbook/create-permission';\nexport { WorkbookCreateSheetPermission } from './workbook/create-sheet';\nexport { WorkbookDeleteSheetPermission } from './workbook/delete-sheet';\nexport { WorkbookDuplicatePermission } from './workbook/duplicate';\nexport { WorkbookEditablePermission } from './workbook/editable';\nexport { WorkbookExportPermission } from './workbook/export';\nexport { WorkbookHideSheetPermission } from './workbook/hide-sheet';\nexport { WorkbookHistoryPermission } from './workbook/history';\nexport { WorkbookManageCollaboratorPermission } from './workbook/manage-collaborator';\nexport { WorkbookMoveSheetPermission } from './workbook/move-sheet';\nexport { WorkbookPrintPermission } from './workbook/print';\nexport { WorkbookRecoverHistoryPermission } from './workbook/recover-history';\nexport { WorkbookRenameSheetPermission } from './workbook/rename-sheet';\nexport { WorkbookSharePermission } from './workbook/share';\nexport { WorkbookViewPermission } from './workbook/view';\n\nexport { WorkbookViewHistoryPermission } from './workbook/view-history';\nexport { WorksheetCopyPermission } from './worksheet/copy';\nexport { WorksheetDeleteColumnPermission } from './worksheet/delete-column';\nexport { WorksheetDeleteProtectionPermission } from './worksheet/delete-protection';\nexport { WorksheetDeleteRowPermission } from './worksheet/delete-row';\nexport { WorksheetEditPermission } from './worksheet/edit';\nexport { WorksheetEditExtraObjectPermission } from './worksheet/edit-extra-object';\nexport { WorksheetFilterPermission } from './worksheet/filter';\nexport { WorksheetInsertColumnPermission } from './worksheet/insert-column';\nexport { WorksheetInsertHyperlinkPermission } from './worksheet/insert-hyperlink';\nexport { WorksheetInsertRowPermission } from './worksheet/insert-row';\nexport { WorksheetManageCollaboratorPermission } from './worksheet/manage-collaborator';\nexport { WorksheetPivotTablePermission } from './worksheet/pivot-table';\nexport { WorksheetSelectProtectedCellsPermission } from './worksheet/select-protected-cells';\nexport { WorksheetSelectUnProtectedCellsPermission } from './worksheet/select-un-protected-cells';\nexport { WorksheetSetCellStylePermission } from './worksheet/set-cell-style';\nexport { WorksheetSetCellValuePermission } from './worksheet/set-cell-value';\nexport { WorksheetSetColumnStylePermission } from './worksheet/set-column-style';\nexport { WorksheetSetRowStylePermission } from './worksheet/set-row-style';\n\nexport { WorksheetSortPermission } from './worksheet/sort';\nexport { WorksheetViewPermission } from './worksheet/view';\n"],"mappings":"AAgBA,SAAS,0CAA0C;AACnD,SAAS,0CAA0C;AACnD,SAAS,iCAAiC;AAC1C,SAAS,8BAA8B;AACvC,SAAS,mCAAmC;AAC5C,SAAS,uCAAuC;AAChD,SAAS,qCAAqC;AAC9C,SAAS,qCAAqC;AAC9C,SAAS,mCAAmC;AAC5C,SAAS,kCAAkC;AAC3C,SAAS,gCAAgC;AACzC,SAAS,mCAAmC;AAC5C,SAAS,iCAAiC;AAC1C,SAAS,4CAA4C;AACrD,SAAS,mCAAmC;AAC5C,SAAS,+BAA+B;AACxC,SAAS,wCAAwC;AACjD,SAAS,qCAAqC;AAC9C,SAAS,+BAA+B;AACxC,SAAS,8BAA8B;AAEvC,SAAS,qCAAqC;AAC9C,SAAS,+BAA+B;AACxC,SAAS,uCAAuC;AAChD,SAAS,2CAA2C;AACpD,SAAS,oCAAoC;AAC7C,SAAS,+BAA+B;AACxC,SAAS,0CAA0C;AACnD,SAAS,iCAAiC;AAC1C,SAAS,uCAAuC;AAChD,SAAS,0CAA0C;AACnD,SAAS,oCAAoC;AAC7C,SAAS,6CAA6C;AACtD,SAAS,qCAAqC;AAC9C,SAAS,+CAA+C;AACxD,SAAS,iDAAiD;AAC1D,SAAS,uCAAuC;AAChD,SAAS,uCAAuC;AAChD,SAAS,yCAAyC;AAClD,SAAS,sCAAsC;AAE/C,SAAS,+BAA+B;AACxC,SAAS,+BAA+B;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"fa4266c34bfe75a1f0cfdd2a4a5ffa2d40e38efe"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/comment.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/comment.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":61}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":30}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/comment.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookCommentPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Comment;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Comment}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,0BAAsD;AAAA,EAO/D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,OAAO,IAAI,MAAM;AAAA,EAC1D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"acb1d70be03de548d6cf145bdabfd267faa5e05d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/copy.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/copy.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":58}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/copy.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookCopyPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Copy;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Copy}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,uBAAmD;AAAA,EAO5D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM;AAAA,EACvD;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"59b0fc2a437bf6fda1be8ba3917a57290157dcc7"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/copy-sheet.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/copy-sheet.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":63}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":12},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":11},"end":{"line":13,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/copy-sheet.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookCopySheetPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    subType = UnitAction.CopySheet;\n    status = PermissionStatus.INIT;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.CopySheet}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,4BAAwD;AAAA,EAOjE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,SAAS,IAAI,MAAM;AAAA,EAC5D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,UAAU,WAAW;AAAA,EACrB,SAAS,iBAAiB;AAM9B;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d181d2ad7a5923b0db812c30e34a0bcc0c5f555d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/create-permission.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/create-permission.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":76}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":45}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/create-permission.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookCreateProtectPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.CreatePermissionObject;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.CreatePermissionObject}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,gCAA4D;AAAA,EAOrE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,sBAAsB,IAAI,MAAM;AAAA,EACzE;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"320bd8d74183d935d56676a52764bebc5a680592"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/create-sheet.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/create-sheet.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":65}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/create-sheet.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookCreateSheetPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.CreateSheet;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.CreateSheet}_${unitId}` as string;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,8BAA0D;AAAA,EAOnE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,WAAW,IAAI,MAAM;AAAA,EAC9D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b80d74a3af8531ed64550fe04162d07c640c05ac"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/delete-sheet.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/delete-sheet.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":65}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/delete-sheet.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookDeleteSheetPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.DeleteSheet;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.DeleteSheet}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,8BAA0D;AAAA,EAOnE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,WAAW,IAAI,MAAM;AAAA,EAC9D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8f6eb134a8444fc3a13fd7d7e1d2fd85e1f6d424"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/duplicate.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/duplicate.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":63}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/duplicate.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookDuplicatePermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Duplicate;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Duplicate}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,4BAAwD;AAAA,EAOjE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,SAAS,IAAI,MAAM;AAAA,EAC5D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"64e2b236449a0acc8b0b7d3de96c6467f50a910b"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/editable.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/editable.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":58}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/editable.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookEditablePermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Edit;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Edit}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,2BAAuD;AAAA,EAOhE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM;AAAA,EACvD;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"6e0d59c5d6d9527843b57ac21a4b28d9797c37e2"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/export.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/export.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":60}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":29}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/export.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookExportPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Export;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Export}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,yBAAqD;AAAA,EAO9D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,MAAM,IAAI,MAAM;AAAA,EACzD;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8de16c24a19f99ef977b1550ecf0c75af3f24d56"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/hide-sheet.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/hide-sheet.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":63}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/hide-sheet.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookHideSheetPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.HideSheet;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.HideSheet}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,4BAAwD;AAAA,EAOjE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,SAAS,IAAI,MAAM;AAAA,EAC5D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"60bf1e36e89bc7f96f0e7559ece6242ff5c7134e"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/history.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/history.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":61}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":30}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/history.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookHistoryPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.History;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.History}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,0BAAsD;AAAA,EAO/D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,OAAO,IAAI,MAAM;AAAA,EAC1D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4aa618f5274448687c11ddc343128a2dd353aeda"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/manage-collaborator.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/manage-collaborator.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":72}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":41}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/manage-collaborator.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookManageCollaboratorPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.ManageCollaborator;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.ManageCollaborator}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,qCAAiE;AAAA,EAO1E,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,kBAAkB,IAAI,MAAM;AAAA,EACrE;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d9738d4246c11548c06873e8cce33c6d53612cc9"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/move-sheet.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/move-sheet.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":63}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/move-sheet.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookMoveSheetPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.MoveSheet;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.MoveSheet}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,4BAAwD;AAAA,EAOjE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,SAAS,IAAI,MAAM;AAAA,EAC5D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"5d93f4bec413312ab6ca902e276a835ab1cb29f8"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/print.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/print.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":59}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/print.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookPrintPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Print;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Print}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wBAAoD;AAAA,EAO7D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,KAAK,IAAI,MAAM;AAAA,EACxD;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c46c6b1ca99286ab7f9b18b2113279ef7afafa3f"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/recover-history.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/recover-history.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":68}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":37}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/recover-history.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookRecoverHistoryPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.RecoverHistory;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.RecoverHistory}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,iCAA6D;AAAA,EAOtE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,cAAc,IAAI,MAAM;AAAA,EACjE;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c38f9a9afee2f3057817c99cfe05b4d0560a926d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/rename-sheet.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/rename-sheet.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":65}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/rename-sheet.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookRenameSheetPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.RenameSheet;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.RenameSheet}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,8BAA0D;AAAA,EAOnE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,WAAW,IAAI,MAAM;AAAA,EAC9D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c383f4f41f9cfd68575dafeff179fa5f3922908c"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/share.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/share.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":59}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/share.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookSharePermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Share;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Share}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wBAAoD;AAAA,EAO7D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,KAAK,IAAI,MAAM;AAAA,EACxD;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8e8b4f15b99f6622512b834c06982b1d9952d1af"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/view.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/view.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":58}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/view.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookViewPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.View;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.View}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,uBAAmD;AAAA,EAO5D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM;AAAA,EACvD;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f56cae2d7543fcf71af6451f909e1188713e655e"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/view-history.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/view-history.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":65}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/view-history.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookViewHistoryPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.ViewHistory;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.ViewHistory}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,8BAA0D;AAAA,EAOnE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,WAAW,IAAI,MAAM;AAAA,EAC9D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"38f11cb409b273b5765689ea65528dd1c4144e38"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/copy.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/copy.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":71}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/copy.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetCopyPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.Copy;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.Copy}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wBAAoD;AAAA,EAM7D,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM,IAAI,SAAS;AAAA,EACpE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"edb6eab66d507ad7af58e27df19ebe85aae589df"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-column.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-column.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":79}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-column.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetDeleteColumnPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.DeleteColumn;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.DeleteColumn}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,gCAA4D;AAAA,EAMrE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,YAAY,IAAI,MAAM,IAAI,SAAS;AAAA,EAC5E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"657e5ebfa657abd820172f0924841baddd268e1f"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-protection.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-protection.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":73}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":29}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-protection.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetDeleteProtectionPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.Delete;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.Delete}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,oCAAgE;AAAA,EAMzE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,MAAM,IAAI,MAAM,IAAI,SAAS;AAAA,EACtE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"80bbe7442806cc5fb316b375a9203d12fe8217f6"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-row.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-row.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":76}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-row.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetDeleteRowPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.DeleteRow;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.DeleteRow}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,6BAAyD;AAAA,EAMlE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,SAAS,IAAI,MAAM,IAAI,SAAS;AAAA,EACzE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f3e624df8bd63beb6e411a183402a6a2821391e1"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/edit.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/edit.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":71}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/edit.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetEditPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.Edit;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.Edit}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wBAAoD;AAAA,EAM7D,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM,IAAI,SAAS;AAAA,EACpE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"90cd3e55ce78bdf2284bbd5d5aebe3e712571f25"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/edit-extra-object.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/edit-extra-object.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":82}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/edit-extra-object.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetEditExtraObjectPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.EditExtraObject;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.EditExtraObject}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,mCAA+D;AAAA,EAMxE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,eAAe,IAAI,MAAM,IAAI,SAAS;AAAA,EAC/E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8854e96e5038b199172845fc04f522bd027a4409"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/filter.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/filter.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":73}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":29}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/filter.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetFilterPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.Filter;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.Filter}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,0BAAsD;AAAA,EAM/D,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,MAAM,IAAI,MAAM,IAAI,SAAS;AAAA,EACtE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d568570ec793378990983e537584027ec3014255"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-column.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-column.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":79}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-column.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetInsertColumnPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.InsertColumn;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.InsertColumn}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,gCAA4D;AAAA,EAMrE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,YAAY,IAAI,MAAM,IAAI,SAAS;AAAA,EAC5E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"003eaca68a726878766369e89d516c6822545850"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-hyperlink.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-hyperlink.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":82}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-hyperlink.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetInsertHyperlinkPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.InsertHyperlink;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.InsertHyperlink}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,mCAA+D;AAAA,EAMxE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,eAAe,IAAI,MAAM,IAAI,SAAS;AAAA,EAC/E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3a80156fc473dd4ebff9268ebbaa6ac7e9cefd9b"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-row.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-row.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":76}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-row.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetInsertRowPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.InsertRow;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.InsertRow}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,6BAAyD;AAAA,EAMlE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,SAAS,IAAI,MAAM,IAAI,SAAS;AAAA,EACzE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"bebca7733858d3f60415904c18c179b0e87f922d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/manage-collaborator.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/manage-collaborator.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":85}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":41}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/manage-collaborator.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetManageCollaboratorPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.ManageCollaborator;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.ManageCollaborator}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,sCAAkE;AAAA,EAM3E,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,kBAAkB,IAAI,MAAM,IAAI,SAAS;AAAA,EAClF;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c16cdce57e4c261b4ecec4fd2a86965372522947"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/pivot-table.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/pivot-table.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":77}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":33}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/pivot-table.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetPivotTablePermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.PivotTable;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.PivotTable}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,8BAA0D;AAAA,EAMnE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,UAAU,IAAI,MAAM,IAAI,SAAS;AAAA,EAC1E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"58fdbf984a967c04831a859635aa181ad81c737f"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/select-protected-cells.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/select-protected-cells.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":87}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":43}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/select-protected-cells.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSelectProtectedCellsPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.SelectProtectedCells;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.SelectProtectedCells}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wCAAoE;AAAA,EAM7E,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,oBAAoB,IAAI,MAAM,IAAI,SAAS;AAAA,EACpF;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8481b1a839f1c62f07b2106c96bc1cad75e35741"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/select-un-protected-cells.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/select-un-protected-cells.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":89}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":45}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/select-un-protected-cells.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSelectUnProtectedCellsPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.SelectUnProtectedCells;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.SelectUnProtectedCells}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,0CAAsE;AAAA,EAM/E,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,sBAAsB,IAAI,MAAM,IAAI,SAAS;AAAA,EACtF;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"adb1791d3b95cb791b034b2322cfda7dbd7457ca"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-cell-style.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-cell-style.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":79}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-cell-style.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSetCellStylePermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.SetCellStyle;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.SetCellStyle}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,gCAA4D;AAAA,EAMrE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,YAAY,IAAI,MAAM,IAAI,SAAS;AAAA,EAC5E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4795966c1f688514909e89fcb6c528b41dd3fb19"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-cell-value.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-cell-value.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":79}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-cell-value.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSetCellValuePermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.SetCellValue;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.SetCellValue}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,gCAA4D;AAAA,EAMrE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,YAAY,IAAI,MAAM,IAAI,SAAS;AAAA,EAC5E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"89776ecc2ffc57e1bdca5b0b5db80f0cb9f0d341"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-column-style.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-column-style.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":81}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":37}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-column-style.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSetColumnStylePermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.SetColumnStyle;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.SetColumnStyle}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,kCAA8D;AAAA,EAMvE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,cAAc,IAAI,MAAM,IAAI,SAAS;AAAA,EAC9E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"81926dfe4e3987a2088f6e0395342c5a68a61957"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-row-style.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-row-style.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":78}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-row-style.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSetRowStylePermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.SetRowStyle;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.SetRowStyle}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,+BAA2D;AAAA,EAMpE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,WAAW,IAAI,MAAM,IAAI,SAAS;AAAA,EAC3E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"449fd0cad040c2e43a34493e1713c039349a731b"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/sort.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/sort.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":71}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/sort.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSortPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.Sort;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.Sort}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wBAAoD;AAAA,EAM7D,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM,IAAI,SAAS;AAAA,EACpE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"bf2d337517ebd85a8b28be48174d34760447355a"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/view.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/view.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":71}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":5,"1":5,"2":5,"3":5,"4":5,"5":5,"6":5},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/view.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetViewPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.View;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.View}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wBAAoD;AAAA,EAM7D,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM,IAAI,SAAS;AAAA,EACpE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2801f2c609d83e25e4bf6ea22e8938037deda1ca"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/util.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/util.ts","statementMap":{"0":{"start":{"line":4,"column":45},"end":{"line":23,"column":1}},"1":{"start":{"line":4,"column":51},"end":{"line":23,"column":1}},"2":{"start":{"line":24,"column":47},"end":{"line":43,"column":1}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":45},"end":{"line":4,"column":46}},"loc":{"start":{"line":4,"column":51},"end":{"line":23,"column":1}},"line":4}},"branchMap":{},"s":{"0":1,"1":5,"2":1},"f":{"0":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/util.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UnitAction } from '@univerjs/protocol';\nimport { WorkbookCommentPermission, WorkbookCopyPermission, WorkbookCopySheetPermission, WorkbookCreateSheetPermission, WorkbookDeleteSheetPermission, WorkbookDuplicatePermission, WorkbookEditablePermission, WorkbookExportPermission, WorkbookHideSheetPermission, WorkbookManageCollaboratorPermission, WorkbookMoveSheetPermission, WorkbookPrintPermission, WorkbookRecoverHistoryPermission, WorkbookRenameSheetPermission, WorkbookSharePermission, WorkbookViewHistoryPermission, WorkbookViewPermission } from '../permission-point';\nimport { WorkbookCreateProtectPermission } from '../permission-point/workbook/create-permission';\n\nexport const getAllWorkbookPermissionPoint = () => [\n    WorkbookEditablePermission,\n    WorkbookPrintPermission,\n    WorkbookCommentPermission,\n    WorkbookViewPermission,\n    WorkbookCopyPermission,\n    WorkbookExportPermission,\n    WorkbookManageCollaboratorPermission,\n    WorkbookCreateSheetPermission,\n    WorkbookDeleteSheetPermission,\n    WorkbookRenameSheetPermission,\n    WorkbookHideSheetPermission,\n    WorkbookDuplicatePermission,\n    WorkbookSharePermission,\n    WorkbookMoveSheetPermission,\n    WorkbookCopySheetPermission,\n    WorkbookViewHistoryPermission,\n    WorkbookRecoverHistoryPermission,\n    WorkbookCreateProtectPermission,\n];\n\nexport const defaultWorkbookPermissionPoints = [\n    UnitAction.Edit,\n    UnitAction.Print,\n    UnitAction.Comment,\n    UnitAction.View,\n    UnitAction.Copy,\n    UnitAction.Export,\n    UnitAction.ManageCollaborator,\n    UnitAction.CreateSheet,\n    UnitAction.DeleteSheet,\n    UnitAction.RenameSheet,\n    UnitAction.HideSheet,\n    UnitAction.Duplicate,\n    UnitAction.Share,\n    UnitAction.MoveSheet,\n    UnitAction.CopySheet,\n    UnitAction.RecoverHistory,\n    UnitAction.ViewHistory,\n    UnitAction.CreatePermissionObject,\n];\n"],"mappings":"AAgBA,SAAS,kBAAkB;AAC3B,SAAS,2BAA2B,wBAAwB,6BAA6B,+BAA+B,+BAA+B,6BAA6B,4BAA4B,0BAA0B,6BAA6B,sCAAsC,6BAA6B,yBAAyB,kCAAkC,+BAA+B,yBAAyB,+BAA+B,8BAA8B;AAC1f,SAAS,uCAAuC;AAEzC,aAAM,gCAAgC,MAAM;AAAA,EAC/C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ;AAEO,aAAM,kCAAkC;AAAA,EAC3C,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AACf;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"cdac87228b1eaf4e3336da30b02bbd7ac4763e9d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/utils.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/utils.ts","statementMap":{"0":{"start":{"line":3,"column":46},"end":{"line":8,"column":1}},"1":{"start":{"line":3,"column":52},"end":{"line":8,"column":1}},"2":{"start":{"line":9,"column":58},"end":{"line":24,"column":1}},"3":{"start":{"line":9,"column":64},"end":{"line":24,"column":1}},"4":{"start":{"line":25,"column":47},"end":{"line":40,"column":1}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":46},"end":{"line":3,"column":47}},"loc":{"start":{"line":3,"column":52},"end":{"line":8,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":58},"end":{"line":9,"column":59}},"loc":{"start":{"line":9,"column":64},"end":{"line":24,"column":1}},"line":9}},"branchMap":{},"s":{"0":1,"1":5,"2":1,"3":5,"4":1},"f":{"0":5,"1":5},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/utils.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UnitAction } from '@univerjs/protocol';\nimport { WorksheetCopyPermission, WorksheetDeleteColumnPermission, WorksheetDeleteProtectionPermission, WorksheetDeleteRowPermission, WorksheetEditExtraObjectPermission, WorksheetEditPermission, WorksheetFilterPermission, WorksheetInsertColumnPermission, WorksheetInsertHyperlinkPermission, WorksheetInsertRowPermission, WorksheetManageCollaboratorPermission, WorksheetPivotTablePermission, WorksheetSetCellStylePermission, WorksheetSetCellValuePermission, WorksheetSetColumnStylePermission, WorksheetSetRowStylePermission, WorksheetSortPermission, WorksheetViewPermission } from '../permission-point';\n\nexport const getAllWorksheetPermissionPoint = () => [\n    WorksheetEditPermission,\n    WorksheetViewPermission,\n    WorksheetManageCollaboratorPermission,\n    WorksheetDeleteProtectionPermission,\n];\n\n// Changes require synchronization of the following arrays\nexport const getAllWorksheetPermissionPointByPointPanel = () => [\n    WorksheetCopyPermission,\n    WorksheetDeleteColumnPermission,\n    WorksheetDeleteRowPermission,\n    WorksheetEditExtraObjectPermission,\n    WorksheetFilterPermission,\n    WorksheetInsertColumnPermission,\n    WorksheetInsertRowPermission,\n    WorksheetInsertHyperlinkPermission,\n    WorksheetPivotTablePermission,\n    WorksheetSetCellStylePermission,\n    WorksheetSetCellValuePermission,\n    WorksheetSetColumnStylePermission,\n    WorksheetSetRowStylePermission,\n    WorksheetSortPermission,\n];\n\nexport const defaultWorksheetPermissionPoint = [\n    UnitAction.Copy,\n    UnitAction.DeleteColumn,\n    UnitAction.DeleteRow,\n    UnitAction.EditExtraObject,\n    UnitAction.Filter,\n    UnitAction.InsertColumn,\n    UnitAction.InsertRow,\n    UnitAction.InsertHyperlink,\n    UnitAction.PivotTable,\n    UnitAction.SetCellStyle,\n    UnitAction.SetCellValue,\n    UnitAction.SetColumnStyle,\n    UnitAction.SetRowStyle,\n    UnitAction.Sort,\n];\n"],"mappings":"AAgBA,SAAS,kBAAkB;AAC3B,SAAS,yBAAyB,iCAAiC,qCAAqC,8BAA8B,oCAAoC,yBAAyB,2BAA2B,iCAAiC,oCAAoC,8BAA8B,uCAAuC,+BAA+B,iCAAiC,iCAAiC,mCAAmC,gCAAgC,yBAAyB,+BAA+B;AAE7jB,aAAM,iCAAiC,MAAM;AAAA,EAChD;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ;AAGO,aAAM,6CAA6C,MAAM;AAAA,EAC5D;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ;AAEO,aAAM,kCAAkC;AAAA,EAC3C,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AACf;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c7248bb8c5b5c7f7a5617ee981de10f0893c0f1d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission.service.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission.service.ts","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":37}},"1":{"start":{"line":2,"column":23},"end":{"line":2,"column":54}},"2":{"start":{"line":3,"column":22},"end":{"line":10,"column":1}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"4":{"start":{"line":5,"column":2},"end":{"line":7,"column":85}},"5":{"start":{"line":5,"column":15},"end":{"line":5,"column":36}},"6":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"7":{"start":{"line":7,"column":6},"end":{"line":7,"column":85}},"8":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"9":{"start":{"line":8,"column":22},"end":{"line":8,"column":53}},"10":{"start":{"line":9,"column":2},"end":{"line":9,"column":16}},"11":{"start":{"line":11,"column":22},"end":{"line":11,"column":90}},"12":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"13":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"14":{"start":{"line":21,"column":38},"end":{"line":21,"column":73}},"15":{"start":{"line":22,"column":39},"end":{"line":22,"column":80}},"16":{"start":{"line":23,"column":40},"end":{"line":199,"column":1}},"17":{"start":{"line":25,"column":4},"end":{"line":25,"column":12}},"18":{"start":{"line":26,"column":4},"end":{"line":26,"column":49}},"19":{"start":{"line":27,"column":4},"end":{"line":27,"column":57}},"20":{"start":{"line":28,"column":4},"end":{"line":28,"column":31}},"21":{"start":{"line":29,"column":4},"end":{"line":29,"column":71}},"22":{"start":{"line":30,"column":4},"end":{"line":30,"column":81}},"23":{"start":{"line":31,"column":4},"end":{"line":31,"column":59}},"24":{"start":{"line":32,"column":4},"end":{"line":32,"column":63}},"25":{"start":{"line":33,"column":4},"end":{"line":33,"column":35}},"26":{"start":{"line":34,"column":4},"end":{"line":34,"column":17}},"27":{"start":{"line":35,"column":4},"end":{"line":35,"column":27}},"28":{"start":{"line":36,"column":4},"end":{"line":36,"column":29}},"29":{"start":{"line":37,"column":4},"end":{"line":37,"column":30}},"30":{"start":{"line":40,"column":27},"end":{"line":70,"column":5}},"31":{"start":{"line":41,"column":21},"end":{"line":41,"column":41}},"32":{"start":{"line":42,"column":30},"end":{"line":49,"column":7}},"33":{"start":{"line":43,"column":26},"end":{"line":43,"column":48}},"34":{"start":{"line":44,"column":8},"end":{"line":47,"column":11}},"35":{"start":{"line":45,"column":27},"end":{"line":45,"column":51}},"36":{"start":{"line":46,"column":10},"end":{"line":46,"column":63}},"37":{"start":{"line":48,"column":8},"end":{"line":48,"column":110}},"38":{"start":{"line":50,"column":6},"end":{"line":52,"column":9}},"39":{"start":{"line":51,"column":8},"end":{"line":51,"column":35}},"40":{"start":{"line":53,"column":6},"end":{"line":55,"column":9}},"41":{"start":{"line":54,"column":8},"end":{"line":54,"column":35}},"42":{"start":{"line":56,"column":6},"end":{"line":69,"column":9}},"43":{"start":{"line":57,"column":26},"end":{"line":57,"column":48}},"44":{"start":{"line":58,"column":30},"end":{"line":58,"column":98}},"45":{"start":{"line":59,"column":8},"end":{"line":64,"column":11}},"46":{"start":{"line":60,"column":10},"end":{"line":63,"column":13}},"47":{"start":{"line":61,"column":29},"end":{"line":61,"column":72}},"48":{"start":{"line":62,"column":12},"end":{"line":62,"column":71}},"49":{"start":{"line":65,"column":8},"end":{"line":68,"column":11}},"50":{"start":{"line":66,"column":27},"end":{"line":66,"column":51}},"51":{"start":{"line":67,"column":10},"end":{"line":67,"column":69}},"52":{"start":{"line":71,"column":4},"end":{"line":73,"column":7}},"53":{"start":{"line":72,"column":6},"end":{"line":72,"column":31}},"54":{"start":{"line":74,"column":4},"end":{"line":74,"column":142}},"55":{"start":{"line":75,"column":4},"end":{"line":84,"column":7}},"56":{"start":{"line":76,"column":6},"end":{"line":83,"column":9}},"57":{"start":{"line":77,"column":23},"end":{"line":77,"column":43}},"58":{"start":{"line":78,"column":26},"end":{"line":78,"column":48}},"59":{"start":{"line":79,"column":8},"end":{"line":82,"column":11}},"60":{"start":{"line":80,"column":27},"end":{"line":80,"column":51}},"61":{"start":{"line":81,"column":10},"end":{"line":81,"column":69}},"62":{"start":{"line":87,"column":4},"end":{"line":109,"column":6}},"63":{"start":{"line":89,"column":8},"end":{"line":107,"column":9}},"64":{"start":{"line":91,"column":12},"end":{"line":91,"column":18}},"65":{"start":{"line":94,"column":12},"end":{"line":97,"column":15}},"66":{"start":{"line":95,"column":31},"end":{"line":95,"column":65}},"67":{"start":{"line":96,"column":14},"end":{"line":96,"column":79}},"68":{"start":{"line":98,"column":12},"end":{"line":98,"column":18}},"69":{"start":{"line":101,"column":12},"end":{"line":104,"column":15}},"70":{"start":{"line":102,"column":31},"end":{"line":102,"column":65}},"71":{"start":{"line":103,"column":14},"end":{"line":103,"column":84}},"72":{"start":{"line":105,"column":12},"end":{"line":105,"column":18}},"73":{"start":{"line":112,"column":19},"end":{"line":115,"column":5}},"74":{"start":{"line":113,"column":21},"end":{"line":113,"column":66}},"75":{"start":{"line":114,"column":6},"end":{"line":114,"column":36}},"76":{"start":{"line":116,"column":22},"end":{"line":125,"column":5}},"77":{"start":{"line":117,"column":6},"end":{"line":119,"column":7}},"78":{"start":{"line":118,"column":8},"end":{"line":118,"column":18}},"79":{"start":{"line":120,"column":6},"end":{"line":124,"column":7}},"80":{"start":{"line":121,"column":8},"end":{"line":121,"column":32}},"81":{"start":{"line":123,"column":8},"end":{"line":123,"column":18}},"82":{"start":{"line":126,"column":4},"end":{"line":161,"column":6}},"83":{"start":{"line":133,"column":10},"end":{"line":133,"column":67}},"84":{"start":{"line":134,"column":10},"end":{"line":140,"column":13}},"85":{"start":{"line":135,"column":12},"end":{"line":139,"column":15}},"86":{"start":{"line":136,"column":31},"end":{"line":136,"column":55}},"87":{"start":{"line":137,"column":14},"end":{"line":137,"column":37}},"88":{"start":{"line":138,"column":14},"end":{"line":138,"column":67}},"89":{"start":{"line":141,"column":10},"end":{"line":141,"column":71}},"90":{"start":{"line":144,"column":27},"end":{"line":144,"column":70}},"91":{"start":{"line":145,"column":10},"end":{"line":157,"column":11}},"92":{"start":{"line":146,"column":12},"end":{"line":152,"column":15}},"93":{"start":{"line":147,"column":32},"end":{"line":147,"column":54}},"94":{"start":{"line":148,"column":14},"end":{"line":151,"column":17}},"95":{"start":{"line":149,"column":33},"end":{"line":149,"column":57}},"96":{"start":{"line":150,"column":16},"end":{"line":150,"column":75}},"97":{"start":{"line":153,"column":12},"end":{"line":156,"column":15}},"98":{"start":{"line":154,"column":31},"end":{"line":154,"column":44}},"99":{"start":{"line":155,"column":14},"end":{"line":155,"column":73}},"100":{"start":{"line":158,"column":10},"end":{"line":158,"column":69}},"101":{"start":{"line":164,"column":19},"end":{"line":167,"column":5}},"102":{"start":{"line":165,"column":21},"end":{"line":165,"column":71}},"103":{"start":{"line":166,"column":6},"end":{"line":166,"column":36}},"104":{"start":{"line":168,"column":22},"end":{"line":177,"column":5}},"105":{"start":{"line":169,"column":6},"end":{"line":171,"column":7}},"106":{"start":{"line":170,"column":8},"end":{"line":170,"column":18}},"107":{"start":{"line":172,"column":6},"end":{"line":176,"column":7}},"108":{"start":{"line":173,"column":8},"end":{"line":173,"column":32}},"109":{"start":{"line":175,"column":8},"end":{"line":175,"column":18}},"110":{"start":{"line":178,"column":4},"end":{"line":197,"column":6}},"111":{"start":{"line":185,"column":10},"end":{"line":185,"column":72}},"112":{"start":{"line":186,"column":10},"end":{"line":191,"column":13}},"113":{"start":{"line":187,"column":12},"end":{"line":190,"column":15}},"114":{"start":{"line":188,"column":31},"end":{"line":188,"column":55}},"115":{"start":{"line":189,"column":14},"end":{"line":189,"column":67}},"116":{"start":{"line":194,"column":10},"end":{"line":194,"column":74}},"117":{"start":{"line":200,"column":0},"end":{"line":209,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":22},"end":{"line":3,"column":23}},"loc":{"start":{"line":3,"column":57},"end":{"line":10,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":44},"end":{"line":11,"column":45}},"loc":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":24,"column":2},"end":{"line":24,"column":3}},"loc":{"start":{"line":24,"column":201},"end":{"line":38,"column":3}},"line":24},"4":{"name":"(anonymous_4)","decl":{"start":{"line":39,"column":2},"end":{"line":39,"column":3}},"loc":{"start":{"line":39,"column":10},"end":{"line":85,"column":3}},"line":39},"5":{"name":"(anonymous_5)","decl":{"start":{"line":40,"column":27},"end":{"line":40,"column":28}},"loc":{"start":{"line":40,"column":41},"end":{"line":70,"column":5}},"line":40},"6":{"name":"(anonymous_6)","decl":{"start":{"line":42,"column":30},"end":{"line":42,"column":31}},"loc":{"start":{"line":42,"column":45},"end":{"line":49,"column":7}},"line":42},"7":{"name":"(anonymous_7)","decl":{"start":{"line":44,"column":103},"end":{"line":44,"column":104}},"loc":{"start":{"line":44,"column":110},"end":{"line":47,"column":9}},"line":44},"8":{"name":"(anonymous_8)","decl":{"start":{"line":50,"column":35},"end":{"line":50,"column":36}},"loc":{"start":{"line":50,"column":50},"end":{"line":52,"column":7}},"line":50},"9":{"name":"(anonymous_9)","decl":{"start":{"line":53,"column":39},"end":{"line":53,"column":40}},"loc":{"start":{"line":53,"column":54},"end":{"line":55,"column":7}},"line":53},"10":{"name":"(anonymous_10)","decl":{"start":{"line":56,"column":40},"end":{"line":56,"column":41}},"loc":{"start":{"line":56,"column":55},"end":{"line":69,"column":7}},"line":56},"11":{"name":"(anonymous_11)","decl":{"start":{"line":59,"column":30},"end":{"line":59,"column":31}},"loc":{"start":{"line":59,"column":40},"end":{"line":64,"column":9}},"line":59},"12":{"name":"(anonymous_12)","decl":{"start":{"line":60,"column":52},"end":{"line":60,"column":53}},"loc":{"start":{"line":60,"column":59},"end":{"line":63,"column":11}},"line":60},"13":{"name":"(anonymous_13)","decl":{"start":{"line":65,"column":103},"end":{"line":65,"column":104}},"loc":{"start":{"line":65,"column":110},"end":{"line":68,"column":9}},"line":65},"14":{"name":"(anonymous_14)","decl":{"start":{"line":71,"column":92},"end":{"line":71,"column":93}},"loc":{"start":{"line":71,"column":106},"end":{"line":73,"column":5}},"line":71},"15":{"name":"(anonymous_15)","decl":{"start":{"line":75,"column":129},"end":{"line":75,"column":130}},"loc":{"start":{"line":75,"column":143},"end":{"line":84,"column":5}},"line":75},"16":{"name":"(anonymous_16)","decl":{"start":{"line":76,"column":35},"end":{"line":76,"column":36}},"loc":{"start":{"line":76,"column":50},"end":{"line":83,"column":7}},"line":76},"17":{"name":"(anonymous_17)","decl":{"start":{"line":79,"column":49},"end":{"line":79,"column":50}},"loc":{"start":{"line":79,"column":56},"end":{"line":82,"column":9}},"line":79},"18":{"name":"(anonymous_18)","decl":{"start":{"line":86,"column":2},"end":{"line":86,"column":3}},"loc":{"start":{"line":86,"column":20},"end":{"line":110,"column":3}},"line":86},"19":{"name":"(anonymous_19)","decl":{"start":{"line":88,"column":63},"end":{"line":88,"column":64}},"loc":{"start":{"line":88,"column":73},"end":{"line":108,"column":7}},"line":88},"20":{"name":"(anonymous_20)","decl":{"start":{"line":94,"column":53},"end":{"line":94,"column":54}},"loc":{"start":{"line":94,"column":60},"end":{"line":97,"column":13}},"line":94},"21":{"name":"(anonymous_21)","decl":{"start":{"line":101,"column":53},"end":{"line":101,"column":54}},"loc":{"start":{"line":101,"column":60},"end":{"line":104,"column":13}},"line":101},"22":{"name":"(anonymous_22)","decl":{"start":{"line":111,"column":2},"end":{"line":111,"column":3}},"loc":{"start":{"line":111,"column":22},"end":{"line":162,"column":3}},"line":111},"23":{"name":"(anonymous_23)","decl":{"start":{"line":112,"column":19},"end":{"line":112,"column":20}},"loc":{"start":{"line":112,"column":25},"end":{"line":115,"column":5}},"line":112},"24":{"name":"(anonymous_24)","decl":{"start":{"line":116,"column":22},"end":{"line":116,"column":23}},"loc":{"start":{"line":116,"column":32},"end":{"line":125,"column":5}},"line":116},"25":{"name":"(anonymous_25)","decl":{"start":{"line":132,"column":16},"end":{"line":132,"column":17}},"loc":{"start":{"line":132,"column":39},"end":{"line":142,"column":9}},"line":132},"26":{"name":"(anonymous_26)","decl":{"start":{"line":134,"column":41},"end":{"line":134,"column":42}},"loc":{"start":{"line":134,"column":56},"end":{"line":140,"column":11}},"line":134},"27":{"name":"(anonymous_27)","decl":{"start":{"line":135,"column":53},"end":{"line":135,"column":54}},"loc":{"start":{"line":135,"column":60},"end":{"line":139,"column":13}},"line":135},"28":{"name":"(anonymous_28)","decl":{"start":{"line":143,"column":18},"end":{"line":143,"column":19}},"loc":{"start":{"line":143,"column":30},"end":{"line":159,"column":9}},"line":143},"29":{"name":"(anonymous_29)","decl":{"start":{"line":146,"column":41},"end":{"line":146,"column":42}},"loc":{"start":{"line":146,"column":56},"end":{"line":152,"column":13}},"line":146},"30":{"name":"(anonymous_30)","decl":{"start":{"line":148,"column":109},"end":{"line":148,"column":110}},"loc":{"start":{"line":148,"column":116},"end":{"line":151,"column":15}},"line":148},"31":{"name":"(anonymous_31)","decl":{"start":{"line":153,"column":52},"end":{"line":153,"column":53}},"loc":{"start":{"line":153,"column":59},"end":{"line":156,"column":13}},"line":153},"32":{"name":"(anonymous_32)","decl":{"start":{"line":163,"column":2},"end":{"line":163,"column":3}},"loc":{"start":{"line":163,"column":23},"end":{"line":198,"column":3}},"line":163},"33":{"name":"(anonymous_33)","decl":{"start":{"line":164,"column":19},"end":{"line":164,"column":20}},"loc":{"start":{"line":164,"column":25},"end":{"line":167,"column":5}},"line":164},"34":{"name":"(anonymous_34)","decl":{"start":{"line":168,"column":22},"end":{"line":168,"column":23}},"loc":{"start":{"line":168,"column":32},"end":{"line":177,"column":5}},"line":168},"35":{"name":"(anonymous_35)","decl":{"start":{"line":184,"column":16},"end":{"line":184,"column":17}},"loc":{"start":{"line":184,"column":39},"end":{"line":192,"column":9}},"line":184},"36":{"name":"(anonymous_36)","decl":{"start":{"line":186,"column":41},"end":{"line":186,"column":42}},"loc":{"start":{"line":186,"column":56},"end":{"line":191,"column":11}},"line":186},"37":{"name":"(anonymous_37)","decl":{"start":{"line":187,"column":65},"end":{"line":187,"column":66}},"loc":{"start":{"line":187,"column":72},"end":{"line":190,"column":13}},"line":187},"38":{"name":"(anonymous_38)","decl":{"start":{"line":193,"column":18},"end":{"line":193,"column":19}},"loc":{"start":{"line":193,"column":30},"end":{"line":195,"column":9}},"line":193}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":26},"end":{"line":4,"column":32}},{"start":{"line":4,"column":35},"end":{"line":4,"column":80}}],"line":4},"1":{"loc":{"start":{"line":4,"column":35},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":42},"end":{"line":4,"column":71}},{"start":{"line":4,"column":74},"end":{"line":4,"column":80}}],"line":4},"2":{"loc":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"type":"if","locations":[{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},{"start":{},"end":{}}],"line":6},"3":{"loc":{"start":{"line":7,"column":15},"end":{"line":7,"column":84}},"type":"binary-expr","locations":[{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},{"start":{"line":7,"column":78},"end":{"line":7,"column":84}}],"line":7},"4":{"loc":{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},"type":"cond-expr","locations":[{"start":{"line":7,"column":23},"end":{"line":7,"column":53}},{"start":{"line":7,"column":56},"end":{"line":7,"column":73}}],"line":7},"5":{"loc":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},{"start":{},"end":{}}],"line":8},"6":{"loc":{"start":{"line":8,"column":6},"end":{"line":8,"column":20}},"type":"binary-expr","locations":[{"start":{"line":8,"column":6},"end":{"line":8,"column":10}},{"start":{"line":8,"column":14},"end":{"line":8,"column":20}}],"line":8},"7":{"loc":{"start":{"line":89,"column":8},"end":{"line":107,"column":9}},"type":"switch","locations":[{"start":{"line":90,"column":10},"end":{"line":92,"column":11}},{"start":{"line":93,"column":10},"end":{"line":99,"column":11}},{"start":{"line":100,"column":10},"end":{"line":106,"column":11}}],"line":89},"8":{"loc":{"start":{"line":117,"column":6},"end":{"line":119,"column":7}},"type":"if","locations":[{"start":{"line":117,"column":6},"end":{"line":119,"column":7}},{"start":{},"end":{}}],"line":117},"9":{"loc":{"start":{"line":145,"column":10},"end":{"line":157,"column":11}},"type":"if","locations":[{"start":{"line":145,"column":10},"end":{"line":157,"column":11}},{"start":{},"end":{}}],"line":145},"10":{"loc":{"start":{"line":169,"column":6},"end":{"line":171,"column":7}},"type":"if","locations":[{"start":{"line":169,"column":6},"end":{"line":171,"column":7}},{"start":{},"end":{}}],"line":169}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":8,"7":8,"8":1,"9":0,"10":1,"11":1,"12":8,"13":8,"14":1,"15":1,"16":1,"17":5,"18":5,"19":5,"20":5,"21":5,"22":5,"23":5,"24":5,"25":5,"26":5,"27":5,"28":5,"29":5,"30":5,"31":5,"32":5,"33":5,"34":5,"35":90,"36":90,"37":5,"38":5,"39":5,"40":5,"41":0,"42":5,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":5,"53":0,"54":5,"55":5,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":5,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":5,"74":0,"75":0,"76":5,"77":0,"78":0,"79":0,"80":0,"81":0,"82":5,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":5,"102":0,"103":0,"104":5,"105":0,"106":0,"107":0,"108":0,"109":0,"110":5,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":1},"f":{"0":1,"1":8,"2":8,"3":5,"4":5,"5":5,"6":5,"7":90,"8":5,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":5,"19":0,"20":0,"21":0,"22":5,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":5,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0},"b":{"0":[0,1],"1":[0,1],"2":[8,0],"3":[8,8],"4":[0,8],"5":[0,1],"6":[1,0],"7":[0,0,0],"8":[0,0],"9":[0,0],"10":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission.service.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook, Worksheet } from '@univerjs/core';\nimport type { IObjectModel, IObjectPointModel } from '../type';\nimport { ILogService, Inject, Injector, IPermissionService, IResourceManagerService, IUniverInstanceService, RxDisposable, UniverInstanceType } from '@univerjs/core';\nimport { UniverType } from '@univerjs/protocol';\n\nimport { takeUntil } from 'rxjs/operators';\nimport { RangeProtectionRuleModel } from '../../../model/range-protection-rule.model';\nimport { getAllRangePermissionPoint } from '../range-permission/util';\nimport { getAllWorkbookPermissionPoint } from '../workbook-permission';\nimport { getAllWorksheetPermissionPoint, getAllWorksheetPermissionPointByPointPanel } from './utils';\nimport { WorksheetProtectionPointModel } from './worksheet-permission-point.model';\nimport { WorksheetProtectionRuleModel } from './worksheet-permission-rule.model';\n\nexport const RULE_MODEL_PLUGIN_NAME = 'SHEET_WORKSHEET_PROTECTION_PLUGIN';\nexport const POINT_MODEL_PLUGIN_NAME = 'SHEET_WORKSHEET_PROTECTION_POINT_PLUGIN';\n\nexport class WorksheetPermissionService extends RxDisposable {\n    constructor(\n        @Inject(IPermissionService) private _permissionService: IPermissionService,\n        @Inject(IUniverInstanceService) private _univerInstanceService: IUniverInstanceService,\n        @Inject(Injector) readonly _injector: Injector,\n        @Inject(WorksheetProtectionRuleModel) private _worksheetProtectionRuleModel: WorksheetProtectionRuleModel,\n        @Inject(WorksheetProtectionPointModel) private _worksheetProtectionPointRuleModel: WorksheetProtectionPointModel,\n        @Inject(IResourceManagerService) private _resourceManagerService: IResourceManagerService,\n        @Inject(RangeProtectionRuleModel) private _rangeProtectionRuleModel: RangeProtectionRuleModel,\n        @Inject(ILogService) private _logService: ILogService\n    ) {\n        super();\n        this._init();\n        this._initRuleChange();\n        this._initRuleSnapshot();\n        this._initPointSnapshot();\n    }\n\n    private _init() {\n        const handleWorkbook = (workbook: Workbook) => {\n            const unitId = workbook.getUnitId();\n            const handleWorksheet = (worksheet: Worksheet) => {\n                const subUnitId = worksheet.getSheetId();\n                [...getAllWorksheetPermissionPoint(), ...getAllWorksheetPermissionPointByPointPanel()].forEach((F) => {\n                    const instance = new F(unitId, subUnitId);\n                    this._permissionService.addPermissionPoint(instance);\n                });\n                this._logService.debug('[WorksheetPermissionService]', 'Initialization completed', unitId, subUnitId);\n            };\n            workbook.getSheets().forEach((worksheet) => {\n                handleWorksheet(worksheet);\n            });\n            workbook.sheetCreated$.subscribe((worksheet) => {\n                handleWorksheet(worksheet);\n            });\n            workbook.sheetDisposed$.subscribe((worksheet) => {\n                const subUnitId = worksheet.getSheetId();\n\n                const rangeRuleList = this._rangeProtectionRuleModel.getSubunitRuleList(unitId, subUnitId);\n                rangeRuleList.forEach((rule) => {\n                    [...getAllRangePermissionPoint()].forEach((F) => {\n                        const instance = new F(unitId, subUnitId, rule.permissionId);\n                        this._permissionService.deletePermissionPoint(instance.id);\n                    });\n                });\n\n                [...getAllWorksheetPermissionPoint(), ...getAllWorksheetPermissionPointByPointPanel()].forEach((F) => {\n                    const instance = new F(unitId, subUnitId);\n                    this._permissionService.deletePermissionPoint(instance.id);\n                });\n            });\n        };\n\n        this._univerInstanceService.getAllUnitsForType<Workbook>(UniverInstanceType.UNIVER_SHEET).forEach((workbook) => {\n            handleWorkbook(workbook);\n        });\n\n        this._univerInstanceService.getTypeOfUnitAdded$<Workbook>(UniverInstanceType.UNIVER_SHEET).pipe(takeUntil(this.dispose$)).subscribe(handleWorkbook);\n\n        this._univerInstanceService.getTypeOfUnitDisposed$<Workbook>(UniverInstanceType.UNIVER_SHEET).pipe(takeUntil(this.dispose$)).subscribe((workbook) => {\n            workbook.getSheets().forEach((worksheet) => {\n                const unitId = workbook.getUnitId();\n                const subUnitId = worksheet.getSheetId();\n                getAllWorksheetPermissionPoint().forEach((F) => {\n                    const instance = new F(unitId, subUnitId);\n                    this._permissionService.deletePermissionPoint(instance.id);\n                });\n            });\n        });\n    }\n\n    private _initRuleChange() {\n        this.disposeWithMe(\n            this._worksheetProtectionRuleModel.ruleChange$.subscribe((info) => {\n                switch (info.type) {\n                    case 'add': {\n                        break;\n                    }\n                    case 'delete': {\n                        getAllWorksheetPermissionPoint().forEach((F) => {\n                            const instance = new F(info.unitId, info.subUnitId);\n                            this._permissionService.updatePermissionPoint(instance.id, true);\n                        });\n                        break;\n                    }\n                    case 'set': {\n                        getAllWorksheetPermissionPoint().forEach((F) => {\n                            const instance = new F(info.unitId, info.subUnitId);\n                            this._permissionService.updatePermissionPoint(instance.id, info.rule);\n                        });\n                        break;\n                    }\n                }\n            })\n        );\n    }\n\n    private _initRuleSnapshot() {\n        const toJson = () => {\n            const object = this._worksheetProtectionRuleModel.toObject();\n            return JSON.stringify(object);\n        };\n        const parseJson = (json: string): IObjectModel => {\n            if (!json) {\n                return {};\n            }\n            try {\n                return JSON.parse(json);\n            } catch (err) {\n                return {};\n            }\n        };\n        this.disposeWithMe(\n            this._resourceManagerService.registerPluginResource({\n                toJson,\n                parseJson,\n                pluginName: RULE_MODEL_PLUGIN_NAME,\n                businesses: [UniverType.UNIVER_SHEET],\n                onLoad: (unitId, resources) => {\n                    this._worksheetProtectionRuleModel.fromObject(resources);\n                    Object.keys(resources).forEach((subUnitId) => {\n                        getAllWorksheetPermissionPoint().forEach((F) => {\n                            const instance = new F(unitId, subUnitId);\n                            instance.value = false;\n                            this._permissionService.addPermissionPoint(instance);\n                        });\n                    });\n                    this._worksheetProtectionRuleModel.changeRuleInitState(true);\n                },\n                onUnLoad: (unitId: string) => {\n                    const workbook = this._univerInstanceService.getUnit<Workbook>(unitId);\n                    if (workbook) {\n                        workbook.getSheets().forEach((worksheet) => {\n                            const subUnitId = worksheet.getSheetId();\n\n                            [...getAllWorksheetPermissionPoint(), ...getAllWorksheetPermissionPointByPointPanel()].forEach((F) => {\n                                const instance = new F(unitId, subUnitId);\n                                this._permissionService.deletePermissionPoint(instance.id);\n                            });\n                        });\n                        getAllWorkbookPermissionPoint().forEach((F) => {\n                            const instance = new F(unitId);\n                            this._permissionService.deletePermissionPoint(instance.id);\n                        });\n                    }\n\n                    this._worksheetProtectionRuleModel.deleteUnitModel(unitId);\n                },\n            })\n        );\n    }\n\n    private _initPointSnapshot() {\n        const toJson = () => {\n            const object = this._worksheetProtectionPointRuleModel.toObject();\n            return JSON.stringify(object);\n        };\n        const parseJson = (json: string): IObjectPointModel => {\n            if (!json) {\n                return {};\n            }\n            try {\n                return JSON.parse(json);\n            } catch (err) {\n                return {};\n            }\n        };\n        this.disposeWithMe(\n            this._resourceManagerService.registerPluginResource({\n                toJson,\n                parseJson,\n                pluginName: POINT_MODEL_PLUGIN_NAME,\n                businesses: [UniverType.UNIVER_SHEET],\n                onLoad: (unitId, resources) => {\n                    this._worksheetProtectionPointRuleModel.fromObject(resources);\n                    Object.keys(resources).forEach((subUnitId) => {\n                        getAllWorksheetPermissionPointByPointPanel().forEach((F) => {\n                            const instance = new F(unitId, subUnitId);\n                            this._permissionService.addPermissionPoint(instance);\n                        });\n                    });\n                },\n                onUnLoad: (unitId: string) => {\n                    this._worksheetProtectionPointRuleModel.deleteUnitModel(unitId);\n                },\n            })\n        );\n    }\n}\n"],"mappings":";;;;;;;;;;;AAkBA,SAAS,aAAa,QAAQ,UAAU,oBAAoB,yBAAyB,wBAAwB,cAAc,0BAA0B;AACrJ,SAAS,kBAAkB;AAE3B,SAAS,iBAAiB;AAC1B,SAAS,gCAAgC;AACzC,SAAS,kCAAkC;AAC3C,SAAS,qCAAqC;AAC9C,SAAS,gCAAgC,kDAAkD;AAC3F,SAAS,qCAAqC;AAC9C,SAAS,oCAAoC;AAEtC,aAAM,yBAAyB;AAC/B,aAAM,0BAA0B;AAEhC,WAAM,6BAAN,cAAyC,aAAa;AAAA,EACzD,YACwC,oBACI,wBACb,WACmB,+BACC,oCACN,yBACC,2BACb,aAC/B;AACE,UAAM;AAT8B;AACI;AACb;AACmB;AACC;AACN;AACC;AACb;AAG7B,SAAK,MAAM;AACX,SAAK,gBAAgB;AACrB,SAAK,kBAAkB;AACvB,SAAK,mBAAmB;AAAA,EAC5B;AAAA,EAEQ,QAAQ;AACZ,UAAM,iBAAiB,CAAC,aAAuB;AAC3C,YAAM,SAAS,SAAS,UAAU;AAClC,YAAM,kBAAkB,CAAC,cAAyB;AAC9C,cAAM,YAAY,UAAU,WAAW;AACvC,SAAC,GAAG,+BAA+B,GAAG,GAAG,2CAA2C,CAAC,EAAE,QAAQ,CAAC,MAAM;AAClG,gBAAM,WAAW,IAAI,EAAE,QAAQ,SAAS;AACxC,eAAK,mBAAmB,mBAAmB,QAAQ;AAAA,QACvD,CAAC;AACD,aAAK,YAAY,MAAM,gCAAgC,4BAA4B,QAAQ,SAAS;AAAA,MACxG;AACA,eAAS,UAAU,EAAE,QAAQ,CAAC,cAAc;AACxC,wBAAgB,SAAS;AAAA,MAC7B,CAAC;AACD,eAAS,cAAc,UAAU,CAAC,cAAc;AAC5C,wBAAgB,SAAS;AAAA,MAC7B,CAAC;AACD,eAAS,eAAe,UAAU,CAAC,cAAc;AAC7C,cAAM,YAAY,UAAU,WAAW;AAEvC,cAAM,gBAAgB,KAAK,0BAA0B,mBAAmB,QAAQ,SAAS;AACzF,sBAAc,QAAQ,CAAC,SAAS;AAC5B,WAAC,GAAG,2BAA2B,CAAC,EAAE,QAAQ,CAAC,MAAM;AAC7C,kBAAM,WAAW,IAAI,EAAE,QAAQ,WAAW,KAAK,YAAY;AAC3D,iBAAK,mBAAmB,sBAAsB,SAAS,EAAE;AAAA,UAC7D,CAAC;AAAA,QACL,CAAC;AAED,SAAC,GAAG,+BAA+B,GAAG,GAAG,2CAA2C,CAAC,EAAE,QAAQ,CAAC,MAAM;AAClG,gBAAM,WAAW,IAAI,EAAE,QAAQ,SAAS;AACxC,eAAK,mBAAmB,sBAAsB,SAAS,EAAE;AAAA,QAC7D,CAAC;AAAA,MACL,CAAC;AAAA,IACL;AAEA,SAAK,uBAAuB,mBAA6B,mBAAmB,YAAY,EAAE,QAAQ,CAAC,aAAa;AAC5G,qBAAe,QAAQ;AAAA,IAC3B,CAAC;AAED,SAAK,uBAAuB,oBAA8B,mBAAmB,YAAY,EAAE,KAAK,UAAU,KAAK,QAAQ,CAAC,EAAE,UAAU,cAAc;AAElJ,SAAK,uBAAuB,uBAAiC,mBAAmB,YAAY,EAAE,KAAK,UAAU,KAAK,QAAQ,CAAC,EAAE,UAAU,CAAC,aAAa;AACjJ,eAAS,UAAU,EAAE,QAAQ,CAAC,cAAc;AACxC,cAAM,SAAS,SAAS,UAAU;AAClC,cAAM,YAAY,UAAU,WAAW;AACvC,uCAA+B,EAAE,QAAQ,CAAC,MAAM;AAC5C,gBAAM,WAAW,IAAI,EAAE,QAAQ,SAAS;AACxC,eAAK,mBAAmB,sBAAsB,SAAS,EAAE;AAAA,QAC7D,CAAC;AAAA,MACL,CAAC;AAAA,IACL,CAAC;AAAA,EACL;AAAA,EAEQ,kBAAkB;AACtB,SAAK;AAAA,MACD,KAAK,8BAA8B,YAAY,UAAU,CAAC,SAAS;AAC/D,gBAAQ,KAAK,MAAM;AAAA,UACf,KAAK,OAAO;AACR;AAAA,UACJ;AAAA,UACA,KAAK,UAAU;AACX,2CAA+B,EAAE,QAAQ,CAAC,MAAM;AAC5C,oBAAM,WAAW,IAAI,EAAE,KAAK,QAAQ,KAAK,SAAS;AAClD,mBAAK,mBAAmB,sBAAsB,SAAS,IAAI,IAAI;AAAA,YACnE,CAAC;AACD;AAAA,UACJ;AAAA,UACA,KAAK,OAAO;AACR,2CAA+B,EAAE,QAAQ,CAAC,MAAM;AAC5C,oBAAM,WAAW,IAAI,EAAE,KAAK,QAAQ,KAAK,SAAS;AAClD,mBAAK,mBAAmB,sBAAsB,SAAS,IAAI,KAAK,IAAI;AAAA,YACxE,CAAC;AACD;AAAA,UACJ;AAAA,QACJ;AAAA,MACJ,CAAC;AAAA,IACL;AAAA,EACJ;AAAA,EAEQ,oBAAoB;AACxB,UAAM,SAAS,MAAM;AACjB,YAAM,SAAS,KAAK,8BAA8B,SAAS;AAC3D,aAAO,KAAK,UAAU,MAAM;AAAA,IAChC;AACA,UAAM,YAAY,CAAC,SAA+B;AAC9C,UAAI,CAAC,MAAM;AACP,eAAO,CAAC;AAAA,MACZ;AACA,UAAI;AACA,eAAO,KAAK,MAAM,IAAI;AAAA,MAC1B,SAAS,KAAK;AACV,eAAO,CAAC;AAAA,MACZ;AAAA,IACJ;AACA,SAAK;AAAA,MACD,KAAK,wBAAwB,uBAAuB;AAAA,QAChD;AAAA,QACA;AAAA,QACA,YAAY;AAAA,QACZ,YAAY,CAAC,WAAW,YAAY;AAAA,QACpC,QAAQ,CAAC,QAAQ,cAAc;AAC3B,eAAK,8BAA8B,WAAW,SAAS;AACvD,iBAAO,KAAK,SAAS,EAAE,QAAQ,CAAC,cAAc;AAC1C,2CAA+B,EAAE,QAAQ,CAAC,MAAM;AAC5C,oBAAM,WAAW,IAAI,EAAE,QAAQ,SAAS;AACxC,uBAAS,QAAQ;AACjB,mBAAK,mBAAmB,mBAAmB,QAAQ;AAAA,YACvD,CAAC;AAAA,UACL,CAAC;AACD,eAAK,8BAA8B,oBAAoB,IAAI;AAAA,QAC/D;AAAA,QACA,UAAU,CAAC,WAAmB;AAC1B,gBAAM,WAAW,KAAK,uBAAuB,QAAkB,MAAM;AACrE,cAAI,UAAU;AACV,qBAAS,UAAU,EAAE,QAAQ,CAAC,cAAc;AACxC,oBAAM,YAAY,UAAU,WAAW;AAEvC,eAAC,GAAG,+BAA+B,GAAG,GAAG,2CAA2C,CAAC,EAAE,QAAQ,CAAC,MAAM;AAClG,sBAAM,WAAW,IAAI,EAAE,QAAQ,SAAS;AACxC,qBAAK,mBAAmB,sBAAsB,SAAS,EAAE;AAAA,cAC7D,CAAC;AAAA,YACL,CAAC;AACD,0CAA8B,EAAE,QAAQ,CAAC,MAAM;AAC3C,oBAAM,WAAW,IAAI,EAAE,MAAM;AAC7B,mBAAK,mBAAmB,sBAAsB,SAAS,EAAE;AAAA,YAC7D,CAAC;AAAA,UACL;AAEA,eAAK,8BAA8B,gBAAgB,MAAM;AAAA,QAC7D;AAAA,MACJ,CAAC;AAAA,IACL;AAAA,EACJ;AAAA,EAEQ,qBAAqB;AACzB,UAAM,SAAS,MAAM;AACjB,YAAM,SAAS,KAAK,mCAAmC,SAAS;AAChE,aAAO,KAAK,UAAU,MAAM;AAAA,IAChC;AACA,UAAM,YAAY,CAAC,SAAoC;AACnD,UAAI,CAAC,MAAM;AACP,eAAO,CAAC;AAAA,MACZ;AACA,UAAI;AACA,eAAO,KAAK,MAAM,IAAI;AAAA,MAC1B,SAAS,KAAK;AACV,eAAO,CAAC;AAAA,MACZ;AAAA,IACJ;AACA,SAAK;AAAA,MACD,KAAK,wBAAwB,uBAAuB;AAAA,QAChD;AAAA,QACA;AAAA,QACA,YAAY;AAAA,QACZ,YAAY,CAAC,WAAW,YAAY;AAAA,QACpC,QAAQ,CAAC,QAAQ,cAAc;AAC3B,eAAK,mCAAmC,WAAW,SAAS;AAC5D,iBAAO,KAAK,SAAS,EAAE,QAAQ,CAAC,cAAc;AAC1C,uDAA2C,EAAE,QAAQ,CAAC,MAAM;AACxD,oBAAM,WAAW,IAAI,EAAE,QAAQ,SAAS;AACxC,mBAAK,mBAAmB,mBAAmB,QAAQ;AAAA,YACvD,CAAC;AAAA,UACL,CAAC;AAAA,QACL;AAAA,QACA,UAAU,CAAC,WAAmB;AAC1B,eAAK,mCAAmC,gBAAgB,MAAM;AAAA,QAClE;AAAA,MACJ,CAAC;AAAA,IACL;AAAA,EACJ;AACJ;AA5La,6BAAN;AAAA,EAEE,0BAAO,kBAAkB;AAAA,EACzB,0BAAO,sBAAsB;AAAA,EAC7B,0BAAO,QAAQ;AAAA,EACf,0BAAO,4BAA4B;AAAA,EACnC,0BAAO,6BAA6B;AAAA,EACpC,0BAAO,uBAAuB;AAAA,EAC9B,0BAAO,wBAAwB;AAAA,EAC/B,0BAAO,WAAW;AAAA,GATd;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2cff6eeff4b37afeee3f942eeeb98834565ee6e2"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/workbook-permission.service.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/workbook-permission.service.ts","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":37}},"1":{"start":{"line":2,"column":23},"end":{"line":2,"column":54}},"2":{"start":{"line":3,"column":22},"end":{"line":10,"column":1}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"4":{"start":{"line":5,"column":2},"end":{"line":7,"column":85}},"5":{"start":{"line":5,"column":15},"end":{"line":5,"column":36}},"6":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"7":{"start":{"line":7,"column":6},"end":{"line":7,"column":85}},"8":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"9":{"start":{"line":8,"column":22},"end":{"line":8,"column":53}},"10":{"start":{"line":9,"column":2},"end":{"line":9,"column":16}},"11":{"start":{"line":11,"column":22},"end":{"line":11,"column":90}},"12":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"13":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"14":{"start":{"line":18,"column":39},"end":{"line":67,"column":1}},"15":{"start":{"line":20,"column":4},"end":{"line":20,"column":12}},"16":{"start":{"line":21,"column":4},"end":{"line":21,"column":49}},"17":{"start":{"line":22,"column":4},"end":{"line":22,"column":57}},"18":{"start":{"line":23,"column":4},"end":{"line":23,"column":63}},"19":{"start":{"line":24,"column":4},"end":{"line":24,"column":71}},"20":{"start":{"line":25,"column":4},"end":{"line":25,"column":73}},"21":{"start":{"line":26,"column":4},"end":{"line":26,"column":17}},"22":{"start":{"line":29,"column":27},"end":{"line":35,"column":5}},"23":{"start":{"line":30,"column":21},"end":{"line":30,"column":41}},"24":{"start":{"line":31,"column":6},"end":{"line":34,"column":9}},"25":{"start":{"line":32,"column":25},"end":{"line":32,"column":38}},"26":{"start":{"line":33,"column":8},"end":{"line":33,"column":61}},"27":{"start":{"line":36,"column":4},"end":{"line":38,"column":7}},"28":{"start":{"line":37,"column":6},"end":{"line":37,"column":31}},"29":{"start":{"line":39,"column":4},"end":{"line":41,"column":8}},"30":{"start":{"line":40,"column":6},"end":{"line":40,"column":31}},"31":{"start":{"line":42,"column":4},"end":{"line":65,"column":8}},"32":{"start":{"line":43,"column":21},"end":{"line":43,"column":41}},"33":{"start":{"line":44,"column":6},"end":{"line":57,"column":9}},"34":{"start":{"line":45,"column":26},"end":{"line":45,"column":48}},"35":{"start":{"line":46,"column":30},"end":{"line":46,"column":98}},"36":{"start":{"line":47,"column":8},"end":{"line":52,"column":11}},"37":{"start":{"line":48,"column":10},"end":{"line":51,"column":13}},"38":{"start":{"line":49,"column":29},"end":{"line":49,"column":72}},"39":{"start":{"line":50,"column":12},"end":{"line":50,"column":71}},"40":{"start":{"line":53,"column":8},"end":{"line":56,"column":11}},"41":{"start":{"line":54,"column":27},"end":{"line":54,"column":51}},"42":{"start":{"line":55,"column":10},"end":{"line":55,"column":69}},"43":{"start":{"line":58,"column":6},"end":{"line":61,"column":9}},"44":{"start":{"line":59,"column":25},"end":{"line":59,"column":38}},"45":{"start":{"line":60,"column":8},"end":{"line":60,"column":67}},"46":{"start":{"line":62,"column":6},"end":{"line":62,"column":61}},"47":{"start":{"line":63,"column":6},"end":{"line":63,"column":66}},"48":{"start":{"line":64,"column":6},"end":{"line":64,"column":65}},"49":{"start":{"line":68,"column":0},"end":{"line":74,"column":30}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":22},"end":{"line":3,"column":23}},"loc":{"start":{"line":3,"column":57},"end":{"line":10,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":44},"end":{"line":11,"column":45}},"loc":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":19,"column":2},"end":{"line":19,"column":3}},"loc":{"start":{"line":19,"column":148},"end":{"line":27,"column":3}},"line":19},"4":{"name":"(anonymous_4)","decl":{"start":{"line":28,"column":2},"end":{"line":28,"column":3}},"loc":{"start":{"line":28,"column":10},"end":{"line":66,"column":3}},"line":28},"5":{"name":"(anonymous_5)","decl":{"start":{"line":29,"column":27},"end":{"line":29,"column":28}},"loc":{"start":{"line":29,"column":41},"end":{"line":35,"column":5}},"line":29},"6":{"name":"(anonymous_6)","decl":{"start":{"line":31,"column":46},"end":{"line":31,"column":47}},"loc":{"start":{"line":31,"column":53},"end":{"line":34,"column":7}},"line":31},"7":{"name":"(anonymous_7)","decl":{"start":{"line":36,"column":92},"end":{"line":36,"column":93}},"loc":{"start":{"line":36,"column":106},"end":{"line":38,"column":5}},"line":36},"8":{"name":"(anonymous_8)","decl":{"start":{"line":39,"column":114},"end":{"line":39,"column":115}},"loc":{"start":{"line":39,"column":128},"end":{"line":41,"column":5}},"line":39},"9":{"name":"(anonymous_9)","decl":{"start":{"line":42,"column":117},"end":{"line":42,"column":118}},"loc":{"start":{"line":42,"column":131},"end":{"line":65,"column":5}},"line":42},"10":{"name":"(anonymous_10)","decl":{"start":{"line":44,"column":35},"end":{"line":44,"column":36}},"loc":{"start":{"line":44,"column":50},"end":{"line":57,"column":7}},"line":44},"11":{"name":"(anonymous_11)","decl":{"start":{"line":47,"column":30},"end":{"line":47,"column":31}},"loc":{"start":{"line":47,"column":40},"end":{"line":52,"column":9}},"line":47},"12":{"name":"(anonymous_12)","decl":{"start":{"line":48,"column":52},"end":{"line":48,"column":53}},"loc":{"start":{"line":48,"column":59},"end":{"line":51,"column":11}},"line":48},"13":{"name":"(anonymous_13)","decl":{"start":{"line":53,"column":103},"end":{"line":53,"column":104}},"loc":{"start":{"line":53,"column":110},"end":{"line":56,"column":9}},"line":53},"14":{"name":"(anonymous_14)","decl":{"start":{"line":58,"column":46},"end":{"line":58,"column":47}},"loc":{"start":{"line":58,"column":53},"end":{"line":61,"column":7}},"line":58}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":26},"end":{"line":4,"column":32}},{"start":{"line":4,"column":35},"end":{"line":4,"column":80}}],"line":4},"1":{"loc":{"start":{"line":4,"column":35},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":42},"end":{"line":4,"column":71}},{"start":{"line":4,"column":74},"end":{"line":4,"column":80}}],"line":4},"2":{"loc":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"type":"if","locations":[{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},{"start":{},"end":{}}],"line":6},"3":{"loc":{"start":{"line":7,"column":15},"end":{"line":7,"column":84}},"type":"binary-expr","locations":[{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},{"start":{"line":7,"column":78},"end":{"line":7,"column":84}}],"line":7},"4":{"loc":{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},"type":"cond-expr","locations":[{"start":{"line":7,"column":23},"end":{"line":7,"column":53}},{"start":{"line":7,"column":56},"end":{"line":7,"column":73}}],"line":7},"5":{"loc":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},{"start":{},"end":{}}],"line":8},"6":{"loc":{"start":{"line":8,"column":6},"end":{"line":8,"column":20}},"type":"binary-expr","locations":[{"start":{"line":8,"column":6},"end":{"line":8,"column":10}},{"start":{"line":8,"column":14},"end":{"line":8,"column":20}}],"line":8}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":5,"7":5,"8":1,"9":0,"10":1,"11":1,"12":5,"13":5,"14":1,"15":5,"16":5,"17":5,"18":5,"19":5,"20":5,"21":5,"22":5,"23":5,"24":5,"25":90,"26":90,"27":5,"28":0,"29":5,"30":5,"31":5,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":1},"f":{"0":1,"1":5,"2":5,"3":5,"4":5,"5":5,"6":90,"7":0,"8":5,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"b":{"0":[0,1],"1":[0,1],"2":[5,0],"3":[5,5],"4":[0,5],"5":[0,1],"6":[1,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/workbook-permission.service.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport { Disposable, Inject, IPermissionService, IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport { RangeProtectionRuleModel } from '../../../model/range-protection-rule.model';\nimport { getAllRangePermissionPoint } from '../range-permission/util';\nimport { WorksheetProtectionPointModel, WorksheetProtectionRuleModel } from '../worksheet-permission';\nimport { getAllWorksheetPermissionPoint, getAllWorksheetPermissionPointByPointPanel } from '../worksheet-permission/utils';\nimport { getAllWorkbookPermissionPoint } from './util';\n\nexport class WorkbookPermissionService extends Disposable {\n    constructor(\n        @Inject(IPermissionService) private _permissionService: IPermissionService,\n        @Inject(IUniverInstanceService) private _univerInstanceService: IUniverInstanceService,\n        @Inject(RangeProtectionRuleModel) private _rangeProtectionRuleModel: RangeProtectionRuleModel,\n        @Inject(WorksheetProtectionRuleModel) private _worksheetProtectionRuleModel: WorksheetProtectionRuleModel,\n        @Inject(WorksheetProtectionPointModel) private _worksheetProtectionPointModel: WorksheetProtectionPointModel\n    ) {\n        super();\n\n        this._init();\n    }\n\n    private _init() {\n        const handleWorkbook = (workbook: Workbook) => {\n            const unitId = workbook.getUnitId();\n            getAllWorkbookPermissionPoint().forEach((F) => {\n                const instance = new F(unitId);\n                this._permissionService.addPermissionPoint(instance);\n            });\n        };\n\n        this._univerInstanceService.getAllUnitsForType<Workbook>(UniverInstanceType.UNIVER_SHEET).forEach((workbook) => {\n            handleWorkbook(workbook);\n        });\n\n        this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$<Workbook>(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) => {\n            handleWorkbook(workbook);\n        }));\n\n        this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$<Workbook>(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) => {\n            const unitId = workbook.getUnitId();\n            workbook.getSheets().forEach((worksheet) => {\n                const subUnitId = worksheet.getSheetId();\n\n                const rangeRuleList = this._rangeProtectionRuleModel.getSubunitRuleList(unitId, subUnitId);\n                rangeRuleList.forEach((rule) => {\n                    [...getAllRangePermissionPoint()].forEach((F) => {\n                        const instance = new F(unitId, subUnitId, rule.permissionId);\n                        this._permissionService.deletePermissionPoint(instance.id);\n                    });\n                });\n\n                [...getAllWorksheetPermissionPoint(), ...getAllWorksheetPermissionPointByPointPanel()].forEach((F) => {\n                    const instance = new F(unitId, subUnitId);\n                    this._permissionService.deletePermissionPoint(instance.id);\n                });\n            });\n            getAllWorkbookPermissionPoint().forEach((F) => {\n                const instance = new F(unitId);\n                this._permissionService.deletePermissionPoint(instance.id);\n            });\n\n            this._rangeProtectionRuleModel.deleteUnitModel(unitId);\n            this._worksheetProtectionPointModel.deleteUnitModel(unitId);\n            this._worksheetProtectionRuleModel.deleteUnitModel(unitId);\n        }));\n    }\n}\n"],"mappings":";;;;;;;;;;;AAiBA,SAAS,YAAY,QAAQ,oBAAoB,wBAAwB,0BAA0B;AACnG,SAAS,gCAAgC;AACzC,SAAS,kCAAkC;AAC3C,SAAS,+BAA+B,oCAAoC;AAC5E,SAAS,gCAAgC,kDAAkD;AAC3F,SAAS,qCAAqC;AAEvC,WAAM,4BAAN,cAAwC,WAAW;AAAA,EACtD,YACwC,oBACI,wBACE,2BACI,+BACC,gCACjD;AACE,UAAM;AAN8B;AACI;AACE;AACI;AACC;AAI/C,SAAK,MAAM;AAAA,EACf;AAAA,EAEQ,QAAQ;AACZ,UAAM,iBAAiB,CAAC,aAAuB;AAC3C,YAAM,SAAS,SAAS,UAAU;AAClC,oCAA8B,EAAE,QAAQ,CAAC,MAAM;AAC3C,cAAM,WAAW,IAAI,EAAE,MAAM;AAC7B,aAAK,mBAAmB,mBAAmB,QAAQ;AAAA,MACvD,CAAC;AAAA,IACL;AAEA,SAAK,uBAAuB,mBAA6B,mBAAmB,YAAY,EAAE,QAAQ,CAAC,aAAa;AAC5G,qBAAe,QAAQ;AAAA,IAC3B,CAAC;AAED,SAAK,cAAc,KAAK,uBAAuB,oBAA8B,mBAAmB,YAAY,EAAE,UAAU,CAAC,aAAa;AAClI,qBAAe,QAAQ;AAAA,IAC3B,CAAC,CAAC;AAEF,SAAK,cAAc,KAAK,uBAAuB,uBAAiC,mBAAmB,YAAY,EAAE,UAAU,CAAC,aAAa;AACrI,YAAM,SAAS,SAAS,UAAU;AAClC,eAAS,UAAU,EAAE,QAAQ,CAAC,cAAc;AACxC,cAAM,YAAY,UAAU,WAAW;AAEvC,cAAM,gBAAgB,KAAK,0BAA0B,mBAAmB,QAAQ,SAAS;AACzF,sBAAc,QAAQ,CAAC,SAAS;AAC5B,WAAC,GAAG,2BAA2B,CAAC,EAAE,QAAQ,CAAC,MAAM;AAC7C,kBAAM,WAAW,IAAI,EAAE,QAAQ,WAAW,KAAK,YAAY;AAC3D,iBAAK,mBAAmB,sBAAsB,SAAS,EAAE;AAAA,UAC7D,CAAC;AAAA,QACL,CAAC;AAED,SAAC,GAAG,+BAA+B,GAAG,GAAG,2CAA2C,CAAC,EAAE,QAAQ,CAAC,MAAM;AAClG,gBAAM,WAAW,IAAI,EAAE,QAAQ,SAAS;AACxC,eAAK,mBAAmB,sBAAsB,SAAS,EAAE;AAAA,QAC7D,CAAC;AAAA,MACL,CAAC;AACD,oCAA8B,EAAE,QAAQ,CAAC,MAAM;AAC3C,cAAM,WAAW,IAAI,EAAE,MAAM;AAC7B,aAAK,mBAAmB,sBAAsB,SAAS,EAAE;AAAA,MAC7D,CAAC;AAED,WAAK,0BAA0B,gBAAgB,MAAM;AACrD,WAAK,+BAA+B,gBAAgB,MAAM;AAC1D,WAAK,8BAA8B,gBAAgB,MAAM;AAAA,IAC7D,CAAC,CAAC;AAAA,EACN;AACJ;AA1Da,4BAAN;AAAA,EAEE,0BAAO,kBAAkB;AAAA,EACzB,0BAAO,sBAAsB;AAAA,EAC7B,0BAAO,wBAAwB;AAAA,EAC/B,0BAAO,4BAA4B;AAAA,EACnC,0BAAO,6BAA6B;AAAA,GANhC;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b11a0a8e514a3cef8fad998738863bb6694d417e"}}