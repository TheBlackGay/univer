{"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/utils.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/utils.ts","statementMap":{"0":{"start":{"line":2,"column":26},"end":{"line":22,"column":1}},"1":{"start":{"line":3,"column":2},"end":{"line":21,"column":4}},"2":{"start":{"line":5,"column":20},"end":{"line":5,"column":43}},"3":{"start":{"line":6,"column":6},"end":{"line":9,"column":7}},"4":{"start":{"line":7,"column":8},"end":{"line":7,"column":54}},"5":{"start":{"line":8,"column":8},"end":{"line":8,"column":22}},"6":{"start":{"line":10,"column":6},"end":{"line":17,"column":7}},"7":{"start":{"line":11,"column":8},"end":{"line":13,"column":9}},"8":{"start":{"line":12,"column":10},"end":{"line":12,"column":29}},"9":{"start":{"line":14,"column":8},"end":{"line":14,"column":36}},"10":{"start":{"line":16,"column":8},"end":{"line":16,"column":39}},"11":{"start":{"line":18,"column":6},"end":{"line":18,"column":20}},"12":{"start":{"line":23,"column":31},"end":{"line":28,"column":1}},"13":{"start":{"line":24,"column":19},"end":{"line":24,"column":28}},"14":{"start":{"line":25,"column":2},"end":{"line":27,"column":4}},"15":{"start":{"line":26,"column":4},"end":{"line":26,"column":24}},"16":{"start":{"line":30,"column":2},"end":{"line":32,"column":3}},"17":{"start":{"line":31,"column":4},"end":{"line":31,"column":17}},"18":{"start":{"line":33,"column":2},"end":{"line":33,"column":84}},"19":{"start":{"line":36,"column":36},"end":{"line":36,"column":46}},"20":{"start":{"line":37,"column":17},"end":{"line":37,"column":39}},"21":{"start":{"line":38,"column":20},"end":{"line":38,"column":45}},"22":{"start":{"line":39,"column":16},"end":{"line":39,"column":20}},"23":{"start":{"line":40,"column":20},"end":{"line":40,"column":37}},"24":{"start":{"line":41,"column":20},"end":{"line":41,"column":87}},"25":{"start":{"line":42,"column":2},"end":{"line":121,"column":3}},"26":{"start":{"line":43,"column":4},"end":{"line":43,"column":20}},"27":{"start":{"line":44,"column":4},"end":{"line":61,"column":5}},"28":{"start":{"line":45,"column":22},"end":{"line":45,"column":44}},"29":{"start":{"line":46,"column":25},"end":{"line":51,"column":7}},"30":{"start":{"line":52,"column":6},"end":{"line":60,"column":7}},"31":{"start":{"line":52,"column":21},"end":{"line":52,"column":43}},"32":{"start":{"line":53,"column":21},"end":{"line":53,"column":65}},"33":{"start":{"line":54,"column":8},"end":{"line":59,"column":9}},"34":{"start":{"line":55,"column":10},"end":{"line":55,"column":81}},"35":{"start":{"line":56,"column":10},"end":{"line":56,"column":71}},"36":{"start":{"line":57,"column":10},"end":{"line":57,"column":67}},"37":{"start":{"line":58,"column":10},"end":{"line":58,"column":25}},"38":{"start":{"line":62,"column":4},"end":{"line":83,"column":5}},"39":{"start":{"line":63,"column":22},"end":{"line":63,"column":42}},"40":{"start":{"line":64,"column":25},"end":{"line":69,"column":7}},"41":{"start":{"line":70,"column":6},"end":{"line":82,"column":7}},"42":{"start":{"line":70,"column":21},"end":{"line":70,"column":43}},"43":{"start":{"line":71,"column":26},"end":{"line":71,"column":70}},"44":{"start":{"line":72,"column":8},"end":{"line":81,"column":9}},"45":{"start":{"line":73,"column":10},"end":{"line":73,"column":75}},"46":{"start":{"line":74,"column":10},"end":{"line":77,"column":12}},"47":{"start":{"line":78,"column":10},"end":{"line":78,"column":71}},"48":{"start":{"line":79,"column":10},"end":{"line":79,"column":67}},"49":{"start":{"line":80,"column":10},"end":{"line":80,"column":25}},"50":{"start":{"line":84,"column":4},"end":{"line":101,"column":5}},"51":{"start":{"line":85,"column":22},"end":{"line":85,"column":47}},"52":{"start":{"line":86,"column":25},"end":{"line":91,"column":7}},"53":{"start":{"line":92,"column":6},"end":{"line":100,"column":7}},"54":{"start":{"line":92,"column":21},"end":{"line":92,"column":40}},"55":{"start":{"line":93,"column":21},"end":{"line":93,"column":68}},"56":{"start":{"line":94,"column":8},"end":{"line":99,"column":9}},"57":{"start":{"line":95,"column":10},"end":{"line":95,"column":90}},"58":{"start":{"line":96,"column":10},"end":{"line":96,"column":65}},"59":{"start":{"line":97,"column":10},"end":{"line":97,"column":61}},"60":{"start":{"line":98,"column":10},"end":{"line":98,"column":25}},"61":{"start":{"line":102,"column":4},"end":{"line":120,"column":5}},"62":{"start":{"line":103,"column":22},"end":{"line":103,"column":45}},"63":{"start":{"line":104,"column":25},"end":{"line":109,"column":7}},"64":{"start":{"line":110,"column":6},"end":{"line":119,"column":7}},"65":{"start":{"line":110,"column":21},"end":{"line":110,"column":40}},"66":{"start":{"line":111,"column":26},"end":{"line":111,"column":71}},"67":{"start":{"line":112,"column":8},"end":{"line":118,"column":9}},"68":{"start":{"line":113,"column":10},"end":{"line":116,"column":12}},"69":{"start":{"line":117,"column":10},"end":{"line":117,"column":25}},"70":{"start":{"line":122,"column":2},"end":{"line":122,"column":19}},"71":{"start":{"line":125,"column":20},"end":{"line":125,"column":38}},"72":{"start":{"line":126,"column":2},"end":{"line":133,"column":5}},"73":{"start":{"line":127,"column":57},"end":{"line":127,"column":63}},"74":{"start":{"line":128,"column":4},"end":{"line":132,"column":5}},"75":{"start":{"line":128,"column":17},"end":{"line":128,"column":25}},"76":{"start":{"line":129,"column":6},"end":{"line":131,"column":7}},"77":{"start":{"line":129,"column":19},"end":{"line":129,"column":30}},"78":{"start":{"line":130,"column":8},"end":{"line":130,"column":39}},"79":{"start":{"line":134,"column":2},"end":{"line":134,"column":27}},"80":{"start":{"line":137,"column":20},"end":{"line":137,"column":38}},"81":{"start":{"line":138,"column":2},"end":{"line":151,"column":5}},"82":{"start":{"line":139,"column":57},"end":{"line":139,"column":63}},"83":{"start":{"line":140,"column":4},"end":{"line":150,"column":5}},"84":{"start":{"line":140,"column":17},"end":{"line":140,"column":25}},"85":{"start":{"line":141,"column":6},"end":{"line":149,"column":7}},"86":{"start":{"line":141,"column":19},"end":{"line":141,"column":30}},"87":{"start":{"line":142,"column":8},"end":{"line":148,"column":11}},"88":{"start":{"line":152,"column":2},"end":{"line":152,"column":27}},"89":{"start":{"line":155,"column":20},"end":{"line":155,"column":38}},"90":{"start":{"line":156,"column":2},"end":{"line":165,"column":5}},"91":{"start":{"line":157,"column":57},"end":{"line":157,"column":62}},"92":{"start":{"line":158,"column":4},"end":{"line":164,"column":5}},"93":{"start":{"line":158,"column":17},"end":{"line":158,"column":25}},"94":{"start":{"line":159,"column":6},"end":{"line":163,"column":7}},"95":{"start":{"line":159,"column":19},"end":{"line":159,"column":30}},"96":{"start":{"line":160,"column":8},"end":{"line":162,"column":11}},"97":{"start":{"line":166,"column":2},"end":{"line":166,"column":27}},"98":{"start":{"line":169,"column":19},"end":{"line":169,"column":89}},"99":{"start":{"line":170,"column":20},"end":{"line":170,"column":46}},"100":{"start":{"line":171,"column":2},"end":{"line":171,"column":31}},"101":{"start":{"line":174,"column":32},"end":{"line":174,"column":68}},"102":{"start":{"line":175,"column":19},"end":{"line":175,"column":177}},"103":{"start":{"line":176,"column":20},"end":{"line":176,"column":99}},"104":{"start":{"line":177,"column":2},"end":{"line":179,"column":3}},"105":{"start":{"line":178,"column":4},"end":{"line":178,"column":16}},"106":{"start":{"line":180,"column":55},"end":{"line":180,"column":60}},"107":{"start":{"line":181,"column":15},"end":{"line":181,"column":17}},"108":{"start":{"line":182,"column":15},"end":{"line":182,"column":17}},"109":{"start":{"line":183,"column":2},"end":{"line":193,"column":3}},"110":{"start":{"line":183,"column":15},"end":{"line":183,"column":23}},"111":{"start":{"line":184,"column":4},"end":{"line":192,"column":5}},"112":{"start":{"line":185,"column":6},"end":{"line":191,"column":7}},"113":{"start":{"line":186,"column":8},"end":{"line":188,"column":9}},"114":{"start":{"line":187,"column":10},"end":{"line":187,"column":23}},"115":{"start":{"line":190,"column":8},"end":{"line":190,"column":21}},"116":{"start":{"line":194,"column":2},"end":{"line":202,"column":3}},"117":{"start":{"line":194,"column":15},"end":{"line":194,"column":26}},"118":{"start":{"line":195,"column":4},"end":{"line":201,"column":5}},"119":{"start":{"line":196,"column":6},"end":{"line":198,"column":7}},"120":{"start":{"line":197,"column":8},"end":{"line":197,"column":21}},"121":{"start":{"line":200,"column":6},"end":{"line":200,"column":19}},"122":{"start":{"line":203,"column":2},"end":{"line":206,"column":4}},"123":{"start":{"line":209,"column":18},"end":{"line":209,"column":20}},"124":{"start":{"line":210,"column":18},"end":{"line":210,"column":20}},"125":{"start":{"line":211,"column":2},"end":{"line":217,"column":3}},"126":{"start":{"line":212,"column":26},"end":{"line":212,"column":88}},"127":{"start":{"line":213,"column":4},"end":{"line":216,"column":5}},"128":{"start":{"line":214,"column":6},"end":{"line":214,"column":42}},"129":{"start":{"line":215,"column":6},"end":{"line":215,"column":42}},"130":{"start":{"line":218,"column":21},"end":{"line":218,"column":71}},"131":{"start":{"line":218,"column":65},"end":{"line":218,"column":70}},"132":{"start":{"line":219,"column":21},"end":{"line":219,"column":71}},"133":{"start":{"line":219,"column":65},"end":{"line":219,"column":70}},"134":{"start":{"line":220,"column":24},"end":{"line":220,"column":26}},"135":{"start":{"line":222,"column":21},"end":{"line":222,"column":23}},"136":{"start":{"line":223,"column":16},"end":{"line":223,"column":22}},"137":{"start":{"line":224,"column":4},"end":{"line":229,"column":5}},"138":{"start":{"line":224,"column":17},"end":{"line":224,"column":18}},"139":{"start":{"line":225,"column":6},"end":{"line":228,"column":7}},"140":{"start":{"line":226,"column":8},"end":{"line":226,"column":43}},"141":{"start":{"line":227,"column":8},"end":{"line":227,"column":23}},"142":{"start":{"line":230,"column":4},"end":{"line":230,"column":48}},"143":{"start":{"line":231,"column":4},"end":{"line":231,"column":20}},"144":{"start":{"line":233,"column":22},"end":{"line":233,"column":56}},"145":{"start":{"line":234,"column":22},"end":{"line":234,"column":56}},"146":{"start":{"line":235,"column":2},"end":{"line":244,"column":3}},"147":{"start":{"line":236,"column":4},"end":{"line":243,"column":5}},"148":{"start":{"line":237,"column":6},"end":{"line":242,"column":9}},"149":{"start":{"line":245,"column":2},"end":{"line":245,"column":23}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":26},"end":{"line":2,"column":27}},"loc":{"start":{"line":2,"column":55},"end":{"line":22,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":4,"column":4},"end":{"line":4,"column":5}},"loc":{"start":{"line":4,"column":25},"end":{"line":19,"column":5}},"line":4},"2":{"name":"(anonymous_2)","decl":{"start":{"line":23,"column":31},"end":{"line":23,"column":32}},"loc":{"start":{"line":23,"column":50},"end":{"line":28,"column":1}},"line":23},"3":{"name":"getKey","decl":{"start":{"line":25,"column":18},"end":{"line":25,"column":24}},"loc":{"start":{"line":25,"column":27},"end":{"line":27,"column":3}},"line":25},"4":{"name":"cellHasValue","decl":{"start":{"line":29,"column":9},"end":{"line":29,"column":21}},"loc":{"start":{"line":29,"column":28},"end":{"line":34,"column":1}},"line":29},"5":{"name":"expandToContinuousRange","decl":{"start":{"line":35,"column":16},"end":{"line":35,"column":39}},"loc":{"start":{"line":35,"column":75},"end":{"line":123,"column":1}},"line":35},"6":{"name":"generateNullCell","decl":{"start":{"line":124,"column":16},"end":{"line":124,"column":32}},"loc":{"start":{"line":124,"column":40},"end":{"line":135,"column":1}},"line":124},"7":{"name":"(anonymous_7)","decl":{"start":{"line":126,"column":16},"end":{"line":126,"column":17}},"loc":{"start":{"line":126,"column":28},"end":{"line":133,"column":3}},"line":126},"8":{"name":"generateNullCellValue","decl":{"start":{"line":136,"column":16},"end":{"line":136,"column":37}},"loc":{"start":{"line":136,"column":45},"end":{"line":153,"column":1}},"line":136},"9":{"name":"(anonymous_9)","decl":{"start":{"line":138,"column":16},"end":{"line":138,"column":17}},"loc":{"start":{"line":138,"column":28},"end":{"line":151,"column":3}},"line":138},"10":{"name":"generateNullCellStyle","decl":{"start":{"line":154,"column":16},"end":{"line":154,"column":37}},"loc":{"start":{"line":154,"column":46},"end":{"line":167,"column":1}},"line":154},"11":{"name":"(anonymous_11)","decl":{"start":{"line":156,"column":17},"end":{"line":156,"column":18}},"loc":{"start":{"line":156,"column":28},"end":{"line":165,"column":3}},"line":156},"12":{"name":"getActiveWorksheet","decl":{"start":{"line":168,"column":16},"end":{"line":168,"column":34}},"loc":{"start":{"line":168,"column":52},"end":{"line":172,"column":1}},"line":168},"13":{"name":"rangeToDiscreteRange","decl":{"start":{"line":173,"column":16},"end":{"line":173,"column":36}},"loc":{"start":{"line":173,"column":87},"end":{"line":207,"column":1}},"line":173},"14":{"name":"getVisibleRanges","decl":{"start":{"line":208,"column":16},"end":{"line":208,"column":32}},"loc":{"start":{"line":208,"column":70},"end":{"line":246,"column":1}},"line":208},"15":{"name":"(anonymous_15)","decl":{"start":{"line":218,"column":55},"end":{"line":218,"column":56}},"loc":{"start":{"line":218,"column":65},"end":{"line":218,"column":70}},"line":218},"16":{"name":"(anonymous_16)","decl":{"start":{"line":219,"column":55},"end":{"line":219,"column":56}},"loc":{"start":{"line":219,"column":65},"end":{"line":219,"column":70}},"line":219},"17":{"name":"findContinuousSegments","decl":{"start":{"line":221,"column":11},"end":{"line":221,"column":33}},"loc":{"start":{"line":221,"column":39},"end":{"line":232,"column":3}},"line":221}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":37},"end":{"line":2,"column":50}},"type":"default-arg","locations":[{"start":{"line":2,"column":48},"end":{"line":2,"column":50}}],"line":2},"1":{"loc":{"start":{"line":5,"column":20},"end":{"line":5,"column":43}},"type":"binary-expr","locations":[{"start":{"line":5,"column":20},"end":{"line":5,"column":27}},{"start":{"line":5,"column":31},"end":{"line":5,"column":43}}],"line":5},"2":{"loc":{"start":{"line":6,"column":6},"end":{"line":9,"column":7}},"type":"if","locations":[{"start":{"line":6,"column":6},"end":{"line":9,"column":7}},{"start":{},"end":{}}],"line":6},"3":{"loc":{"start":{"line":10,"column":6},"end":{"line":17,"column":7}},"type":"if","locations":[{"start":{"line":10,"column":6},"end":{"line":17,"column":7}},{"start":{"line":15,"column":13},"end":{"line":17,"column":7}}],"line":10},"4":{"loc":{"start":{"line":11,"column":8},"end":{"line":13,"column":9}},"type":"if","locations":[{"start":{"line":11,"column":8},"end":{"line":13,"column":9}},{"start":{},"end":{}}],"line":11},"5":{"loc":{"start":{"line":23,"column":32},"end":{"line":23,"column":45}},"type":"default-arg","locations":[{"start":{"line":23,"column":44},"end":{"line":23,"column":45}}],"line":23},"6":{"loc":{"start":{"line":30,"column":2},"end":{"line":32,"column":3}},"type":"if","locations":[{"start":{"line":30,"column":2},"end":{"line":32,"column":3}},{"start":{},"end":{}}],"line":30},"7":{"loc":{"start":{"line":30,"column":6},"end":{"line":30,"column":38}},"type":"binary-expr","locations":[{"start":{"line":30,"column":6},"end":{"line":30,"column":21}},{"start":{"line":30,"column":25},"end":{"line":30,"column":38}}],"line":30},"8":{"loc":{"start":{"line":33,"column":9},"end":{"line":33,"column":83}},"type":"binary-expr","locations":[{"start":{"line":33,"column":9},"end":{"line":33,"column":26}},{"start":{"line":33,"column":30},"end":{"line":33,"column":45}},{"start":{"line":33,"column":49},"end":{"line":33,"column":62}},{"start":{"line":33,"column":66},"end":{"line":33,"column":83}}],"line":33},"9":{"loc":{"start":{"line":44,"column":4},"end":{"line":61,"column":5}},"type":"if","locations":[{"start":{"line":44,"column":4},"end":{"line":61,"column":5}},{"start":{},"end":{}}],"line":44},"10":{"loc":{"start":{"line":44,"column":8},"end":{"line":44,"column":38}},"type":"binary-expr","locations":[{"start":{"line":44,"column":8},"end":{"line":44,"column":10}},{"start":{"line":44,"column":14},"end":{"line":44,"column":38}}],"line":44},"11":{"loc":{"start":{"line":54,"column":8},"end":{"line":59,"column":9}},"type":"if","locations":[{"start":{"line":54,"column":8},"end":{"line":59,"column":9}},{"start":{},"end":{}}],"line":54},"12":{"loc":{"start":{"line":62,"column":4},"end":{"line":83,"column":5}},"type":"if","locations":[{"start":{"line":62,"column":4},"end":{"line":83,"column":5}},{"start":{},"end":{}}],"line":62},"13":{"loc":{"start":{"line":62,"column":8},"end":{"line":62,"column":47}},"type":"binary-expr","locations":[{"start":{"line":62,"column":8},"end":{"line":62,"column":12}},{"start":{"line":62,"column":16},"end":{"line":62,"column":47}}],"line":62},"14":{"loc":{"start":{"line":72,"column":8},"end":{"line":81,"column":9}},"type":"if","locations":[{"start":{"line":72,"column":8},"end":{"line":81,"column":9}},{"start":{},"end":{}}],"line":72},"15":{"loc":{"start":{"line":75,"column":33},"end":{"line":75,"column":89}},"type":"cond-expr","locations":[{"start":{"line":75,"column":64},"end":{"line":75,"column":85}},{"start":{"line":75,"column":88},"end":{"line":75,"column":89}}],"line":75},"16":{"loc":{"start":{"line":84,"column":4},"end":{"line":101,"column":5}},"type":"if","locations":[{"start":{"line":84,"column":4},"end":{"line":101,"column":5}},{"start":{},"end":{}}],"line":84},"17":{"loc":{"start":{"line":84,"column":8},"end":{"line":84,"column":43}},"type":"binary-expr","locations":[{"start":{"line":84,"column":8},"end":{"line":84,"column":12}},{"start":{"line":84,"column":16},"end":{"line":84,"column":43}}],"line":84},"18":{"loc":{"start":{"line":94,"column":8},"end":{"line":99,"column":9}},"type":"if","locations":[{"start":{"line":94,"column":8},"end":{"line":99,"column":9}},{"start":{},"end":{}}],"line":94},"19":{"loc":{"start":{"line":102,"column":4},"end":{"line":120,"column":5}},"type":"if","locations":[{"start":{"line":102,"column":4},"end":{"line":120,"column":5}},{"start":{},"end":{}}],"line":102},"20":{"loc":{"start":{"line":102,"column":8},"end":{"line":102,"column":54}},"type":"binary-expr","locations":[{"start":{"line":102,"column":8},"end":{"line":102,"column":13}},{"start":{"line":102,"column":17},"end":{"line":102,"column":54}}],"line":102},"21":{"loc":{"start":{"line":112,"column":8},"end":{"line":118,"column":9}},"type":"if","locations":[{"start":{"line":112,"column":8},"end":{"line":118,"column":9}},{"start":{},"end":{}}],"line":112},"22":{"loc":{"start":{"line":114,"column":36},"end":{"line":114,"column":92}},"type":"cond-expr","locations":[{"start":{"line":114,"column":67},"end":{"line":114,"column":88}},{"start":{"line":114,"column":91},"end":{"line":114,"column":92}}],"line":114},"23":{"loc":{"start":{"line":175,"column":19},"end":{"line":175,"column":177}},"type":"cond-expr","locations":[{"start":{"line":175,"column":28},"end":{"line":175,"column":98}},{"start":{"line":175,"column":101},"end":{"line":175,"column":177}}],"line":175},"24":{"loc":{"start":{"line":176,"column":20},"end":{"line":176,"column":99}},"type":"cond-expr","locations":[{"start":{"line":176,"column":32},"end":{"line":176,"column":70}},{"start":{"line":176,"column":73},"end":{"line":176,"column":99}}],"line":176},"25":{"loc":{"start":{"line":177,"column":2},"end":{"line":179,"column":3}},"type":"if","locations":[{"start":{"line":177,"column":2},"end":{"line":179,"column":3}},{"start":{},"end":{}}],"line":177},"26":{"loc":{"start":{"line":184,"column":4},"end":{"line":192,"column":5}},"type":"if","locations":[{"start":{"line":184,"column":4},"end":{"line":192,"column":5}},{"start":{},"end":{}}],"line":184},"27":{"loc":{"start":{"line":185,"column":6},"end":{"line":191,"column":7}},"type":"if","locations":[{"start":{"line":185,"column":6},"end":{"line":191,"column":7}},{"start":{"line":189,"column":13},"end":{"line":191,"column":7}}],"line":185},"28":{"loc":{"start":{"line":186,"column":8},"end":{"line":188,"column":9}},"type":"if","locations":[{"start":{"line":186,"column":8},"end":{"line":188,"column":9}},{"start":{},"end":{}}],"line":186},"29":{"loc":{"start":{"line":195,"column":4},"end":{"line":201,"column":5}},"type":"if","locations":[{"start":{"line":195,"column":4},"end":{"line":201,"column":5}},{"start":{"line":199,"column":11},"end":{"line":201,"column":5}}],"line":195},"30":{"loc":{"start":{"line":196,"column":6},"end":{"line":198,"column":7}},"type":"if","locations":[{"start":{"line":196,"column":6},"end":{"line":198,"column":7}},{"start":{},"end":{}}],"line":196},"31":{"loc":{"start":{"line":213,"column":4},"end":{"line":216,"column":5}},"type":"if","locations":[{"start":{"line":213,"column":4},"end":{"line":216,"column":5}},{"start":{},"end":{}}],"line":213},"32":{"loc":{"start":{"line":225,"column":6},"end":{"line":228,"column":7}},"type":"if","locations":[{"start":{"line":225,"column":6},"end":{"line":228,"column":7}},{"start":{},"end":{}}],"line":225}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":1,"102":1,"103":1,"104":1,"105":0,"106":1,"107":1,"108":1,"109":1,"110":1,"111":1,"112":1,"113":1,"114":1,"115":0,"116":1,"117":1,"118":20,"119":20,"120":20,"121":0,"122":1,"123":1,"124":1,"125":1,"126":1,"127":1,"128":1,"129":1,"130":1,"131":0,"132":1,"133":19,"134":1,"135":2,"136":2,"137":2,"138":2,"139":19,"140":0,"141":0,"142":2,"143":2,"144":1,"145":1,"146":1,"147":1,"148":1,"149":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1,"14":1,"15":0,"16":19,"17":2},"b":{"0":[0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0],"6":[0,0],"7":[0,0],"8":[0,0,0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[1,0],"24":[1,0],"25":[0,1],"26":[1,0],"27":[1,0],"28":[1,0],"29":[20,0],"30":[20,0],"31":[1,0],"32":[0,19]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/utils.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICellData, IObjectMatrixPrimitiveType, IRange, Nullable, UniverInstanceService, Workbook, Worksheet } from '@univerjs/core';\nimport type { IExpandParams } from '../commands/commands/utils/selection-utils';\nimport type { IDiscreteRange } from './interfaces';\nimport { IUniverInstanceService, ObjectMatrix, UniverInstanceType } from '@univerjs/core';\n\nexport const groupByKey = <T = Record<string, unknown>>(arr: T[], key: string, blankKey = '') => {\n    return arr.reduce(\n        (result, current) => {\n            const value = current && ((current as Record<string, unknown>)[key] as string);\n\n            if (typeof value !== 'string') {\n                console.warn(current, `${key} is not string`);\n                return result;\n            }\n\n            if (value) {\n                if (!result[value]) {\n                    result[value] = [];\n                }\n                result[value].push(current);\n            } else {\n                result[blankKey].push(current);\n            }\n            return result;\n        },\n        {} as Record<string, T[]>\n    );\n};\n\nexport const createUniqueKey = (initValue = 0) => {\n    let _initValue = initValue;\n    /**\n     * Increments 1 per call\n     */\n    return function getKey() {\n        return _initValue++;\n    };\n};\n\nfunction cellHasValue(cell: ICellData | undefined): boolean {\n    if (cell === undefined || cell === null) {\n        return false;\n    }\n    return (cell.v !== undefined && cell.v !== null && cell.v !== '') || cell.p !== undefined;\n}\n\n// eslint-disable-next-line max-lines-per-function\nexport function expandToContinuousRange(startRange: IRange, directions: IExpandParams, worksheet: Worksheet): IRange {\n    const { left, right, up, down } = directions;\n    const maxRow = worksheet.getMaxRows();\n    const maxColumn = worksheet.getMaxColumns();\n\n    let changed = true;\n    const destRange: IRange = { ...startRange }; // startRange should not be used below\n\n    const allMatrix = worksheet.getMatrixWithMergedCells(0, 0, maxRow - 1, maxColumn - 1);\n    while (changed) {\n        changed = false;\n\n        if (up && destRange.startRow !== 0) {\n            // see if there are value in the upper row of contents\n            // set `changed` to true if `startRow` really changes\n            const destRow = destRange.startRow - 1; // it may decrease if there are merged cell\n\n            const checkRange = {\n                startRow: destRow,\n                startColumn: destRange.startColumn,\n                endRow: destRow,\n                endColumn: destRange.endColumn,\n            };\n            for (let col = checkRange.startColumn; col <= checkRange.endColumn; col++) {\n                const cell = allMatrix.getValue(checkRange.startRow, col)!;\n                if (cellHasValue(cell)) {\n                    destRange.startRow = Math.min(checkRange.startRow, destRange.startRow);\n                    destRange.startColumn = Math.min(col, destRange.startColumn);\n                    destRange.endColumn = Math.max(col, destRange.endColumn);\n                    changed = true;\n                }\n            }\n        }\n\n        if (down && destRange.endRow !== maxRow - 1) {\n            const destRow = destRange.endRow + 1;\n            const checkRange = {\n                startRow: destRow,\n                startColumn: destRange.startColumn,\n                endRow: destRow,\n                endColumn: destRange.endColumn,\n            };\n            for (let col = checkRange.startColumn; col <= checkRange.endColumn; col++) {\n                const cellValue = allMatrix.getValue(checkRange.startRow, col)!;\n                if (cellHasValue(cellValue)) {\n                    destRange.endRow = Math.max(checkRange.endRow, destRange.endRow);\n                    destRange.endRow = Math.max(\n                        checkRange.endRow + (cellValue.rowSpan !== undefined ? cellValue.rowSpan - 1 : 0),\n                        destRange.endRow\n                    );\n                    destRange.startColumn = Math.min(col, destRange.startColumn);\n                    destRange.endColumn = Math.max(col, destRange.endColumn);\n                    changed = true;\n                }\n            }\n        }\n\n        if (left && destRange.startColumn !== 0) {\n            const destCol = destRange.startColumn - 1;\n            const checkRange = {\n                startRow: destRange.startRow,\n                startColumn: destCol,\n                endRow: destRange.endRow,\n                endColumn: destCol,\n            };\n            for (let row = checkRange.startRow; row <= checkRange.endRow; row++) {\n                const cell = allMatrix.getValue(row, checkRange.startColumn)!;\n                if (cellHasValue(cell)) {\n                    destRange.startColumn = Math.min(checkRange.startColumn, destRange.startColumn);\n                    destRange.startRow = Math.min(row, destRange.startRow);\n                    destRange.endRow = Math.max(row, destRange.endRow);\n                    changed = true;\n                }\n            }\n        }\n\n        if (right && destRange.endColumn !== maxColumn - 1) {\n            const destCol = destRange.endColumn + 1;\n            const checkRange = {\n                startRow: destRange.startRow,\n                startColumn: destCol,\n                endRow: destRange.endRow,\n                endColumn: destCol,\n            };\n            for (let row = checkRange.startRow; row <= checkRange.endRow; row++) {\n                const cellValue = allMatrix.getValue(row, checkRange.endColumn)!;\n                if (cellHasValue(cellValue)) {\n                    destRange.endColumn = Math.max(\n                        checkRange.endColumn + (cellValue.colSpan !== undefined ? cellValue.colSpan - 1 : 0),\n                        destRange.endColumn\n                    );\n                    changed = true;\n                }\n            }\n        }\n    }\n\n    return destRange;\n}\n/**\n * Generate cellValue from range and set null\n * @param range\n * @returns\n */\nexport function generateNullCell(range: IRange[]): IObjectMatrixPrimitiveType<Nullable<ICellData>> {\n    const cellValue = new ObjectMatrix<Nullable<ICellData>>();\n    range.forEach((range: IRange) => {\n        const { startRow, startColumn, endRow, endColumn } = range;\n        for (let i = startRow; i <= endRow; i++) {\n            for (let j = startColumn; j <= endColumn; j++) {\n                cellValue.setValue(i, j, null);\n            }\n        }\n    });\n\n    return cellValue.clone();\n}\n\n/**\n * Generate cellValue from range and set v/p/f/si/custom to null\n * @param range\n * @returns\n */\nexport function generateNullCellValue(range: IRange[]): IObjectMatrixPrimitiveType<ICellData> {\n    const cellValue = new ObjectMatrix<ICellData>();\n    range.forEach((range: IRange) => {\n        const { startRow, startColumn, endRow, endColumn } = range;\n        for (let i = startRow; i <= endRow; i++) {\n            for (let j = startColumn; j <= endColumn; j++) {\n                cellValue.setValue(i, j, {\n                    v: null,\n                    p: null,\n                    f: null,\n                    si: null,\n                    custom: null,\n                });\n            }\n        }\n    });\n\n    return cellValue.clone();\n}\n\n// Generate cellValue from range and set s to null\nexport function generateNullCellStyle(ranges: IRange[]): IObjectMatrixPrimitiveType<ICellData> {\n    const cellValue = new ObjectMatrix<ICellData>();\n\n    ranges.forEach((range: IRange) => {\n        const { startRow, startColumn, endRow, endColumn } = range;\n\n        for (let i = startRow; i <= endRow; i++) {\n            for (let j = startColumn; j <= endColumn; j++) {\n                cellValue.setValue(i, j, {\n                    s: null,\n                });\n            }\n        }\n    });\n\n    return cellValue.clone();\n}\n\nexport function getActiveWorksheet(instanceService: UniverInstanceService): [Nullable<Workbook>, Nullable<Worksheet>] {\n    const workbook = instanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    const worksheet = workbook?.getActiveSheet();\n    return [workbook, worksheet];\n}\n\nexport function rangeToDiscreteRange(range: IRange, accessor: IAccessor, unitId?: string, subUnitId?: string, considerHide?: boolean): IDiscreteRange | null {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const workbook = unitId\n        ? univerInstanceService.getUnit<Workbook>(unitId, UniverInstanceType.UNIVER_SHEET)\n        : univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    const worksheet = subUnitId ? workbook?.getSheetBySheetId(subUnitId) : workbook?.getActiveSheet();\n    if (!worksheet) {\n        return null;\n    }\n    const { startRow, endRow, startColumn, endColumn } = range;\n\n    const rows = [];\n    const cols = [];\n    for (let r = startRow; r <= endRow; r++) {\n        if (!worksheet.getRowFiltered(r)) {\n            if (considerHide) {\n                if (worksheet.getRowRawVisible(r)) {\n                    rows.push(r);\n                }\n            } else {\n                rows.push(r);\n            }\n        }\n    }\n    for (let c = startColumn; c <= endColumn; c++) {\n        if (considerHide) {\n            if (worksheet.getColVisible(c)) {\n                cols.push(c);\n            }\n        } else {\n            cols.push(c);\n        }\n    }\n    return {\n        rows,\n        cols,\n    };\n}\n\nexport function getVisibleRanges(ranges: IRange[], accessor: IAccessor, unitId?: string, subUnitId?: string): IRange[] {\n    const allRows: number[] = [];\n    const allCols: number[] = [];\n\n    for (const range of ranges) {\n        const discreteRange = rangeToDiscreteRange(range, accessor, unitId, subUnitId, true);\n\n        if (discreteRange) {\n            allRows.push(...discreteRange.rows);\n            allCols.push(...discreteRange.cols);\n        }\n    }\n\n    const uniqueRows = Array.from(new Set(allRows)).sort((a, b) => a - b);\n    const uniqueCols = Array.from(new Set(allCols)).sort((a, b) => a - b);\n\n    const visibleRanges: IRange[] = [];\n\n    function findContinuousSegments(arr: number[]): number[][] {\n        const segments: number[][] = [];\n        let start = arr[0];\n\n        for (let i = 1; i < arr.length; i++) {\n            if (arr[i] !== arr[i - 1] + 1) {\n                segments.push([start, arr[i - 1]]);\n                start = arr[i];\n            }\n        }\n        segments.push([start, arr[arr.length - 1]]);\n        return segments;\n    }\n\n    const rowSegments = findContinuousSegments(uniqueRows);\n    const colSegments = findContinuousSegments(uniqueCols);\n\n    for (const [startRow, endRow] of rowSegments) {\n        for (const [startCol, endCol] of colSegments) {\n            visibleRanges.push({\n                startRow,\n                endRow,\n                startColumn: startCol,\n                endColumn: endCol,\n            });\n        }\n    }\n\n    return visibleRanges;\n}\n"],"mappings":"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","names":["range"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4f028f98b18ba0edd562f63732b3477ed303870b"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/type.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/type.ts","statementMap":{"0":{"start":{"line":1,"column":47},"end":{"line":7,"column":27}},"1":{"start":{"line":2,"column":2},"end":{"line":2,"column":74}},"2":{"start":{"line":3,"column":2},"end":{"line":3,"column":66}},"3":{"start":{"line":4,"column":2},"end":{"line":4,"column":70}},"4":{"start":{"line":5,"column":2},"end":{"line":5,"column":70}},"5":{"start":{"line":6,"column":2},"end":{"line":6,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":1,"column":48},"end":{"line":1,"column":49}},"loc":{"start":{"line":1,"column":72},"end":{"line":7,"column":1}},"line":1}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":3},"end":{"line":7,"column":26}},"type":"binary-expr","locations":[{"start":{"line":7,"column":3},"end":{"line":7,"column":20}},{"start":{"line":7,"column":24},"end":{"line":7,"column":26}}],"line":7}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1},"f":{"0":1},"b":{"0":[1,1]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/type.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface ISelectionManagerSearchParam {\n    unitId: string;\n    sheetId: string;\n}\n\nexport enum SelectionMoveType {\n    MOVE_START,\n    MOVING,\n    MOVE_END,\n    /**\n     * Events are not triggered by cursor movement\n     */\n    ONLY_SET,\n}\n"],"mappings":"AAqBO,WAAK,oBAAL,kBAAKA,uBAAL;AACH,EAAAA,sCAAA;AACA,EAAAA,sCAAA;AACA,EAAAA,sCAAA;AAIA,EAAAA,sCAAA;AAPQ,SAAAA;AAAA,GAAA;","names":["SelectionMoveType"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"51f6428312fde8c31d809a38f0c341bd74784748"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/selection-data-model.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/selection-data-model.ts","statementMap":{"0":{"start":{"line":6,"column":4},"end":{"line":6,"column":12}},"1":{"start":{"line":7,"column":4},"end":{"line":7,"column":31}},"2":{"start":{"line":8,"column":4},"end":{"line":8,"column":81}},"3":{"start":{"line":13,"column":41},"end":{"line":13,"column":50}},"4":{"start":{"line":14,"column":25},"end":{"line":14,"column":38}},"5":{"start":{"line":15,"column":24},"end":{"line":15,"column":64}},"6":{"start":{"line":16,"column":22},"end":{"line":16,"column":35}},"7":{"start":{"line":17,"column":21},"end":{"line":17,"column":58}},"8":{"start":{"line":18,"column":23},"end":{"line":18,"column":46}},"9":{"start":{"line":19,"column":22},"end":{"line":19,"column":60}},"10":{"start":{"line":20,"column":19},"end":{"line":20,"column":42}},"11":{"start":{"line":21,"column":18},"end":{"line":21,"column":52}},"12":{"start":{"line":23,"column":29},"end":{"line":23,"column":52}},"13":{"start":{"line":24,"column":28},"end":{"line":24,"column":72}},"14":{"start":{"line":26,"column":4},"end":{"line":26,"column":20}},"15":{"start":{"line":27,"column":4},"end":{"line":27,"column":45}},"16":{"start":{"line":28,"column":4},"end":{"line":28,"column":39}},"17":{"start":{"line":29,"column":4},"end":{"line":29,"column":38}},"18":{"start":{"line":30,"column":4},"end":{"line":30,"column":41}},"19":{"start":{"line":31,"column":4},"end":{"line":31,"column":35}},"20":{"start":{"line":34,"column":23},"end":{"line":34,"column":61}},"21":{"start":{"line":35,"column":4},"end":{"line":35,"column":39}},"22":{"start":{"line":36,"column":4},"end":{"line":36,"column":41}},"23":{"start":{"line":45,"column":4},"end":{"line":45,"column":59}},"24":{"start":{"line":46,"column":4},"end":{"line":64,"column":5}},"25":{"start":{"line":48,"column":8},"end":{"line":48,"column":55}},"26":{"start":{"line":49,"column":8},"end":{"line":49,"column":14}},"27":{"start":{"line":51,"column":8},"end":{"line":51,"column":52}},"28":{"start":{"line":52,"column":8},"end":{"line":52,"column":14}},"29":{"start":{"line":54,"column":8},"end":{"line":54,"column":59}},"30":{"start":{"line":55,"column":8},"end":{"line":55,"column":53}},"31":{"start":{"line":56,"column":8},"end":{"line":56,"column":14}},"32":{"start":{"line":58,"column":8},"end":{"line":58,"column":49}},"33":{"start":{"line":59,"column":8},"end":{"line":59,"column":14}},"34":{"start":{"line":62,"column":8},"end":{"line":62,"column":49}},"35":{"start":{"line":63,"column":8},"end":{"line":63,"column":14}},"36":{"start":{"line":67,"column":4},"end":{"line":67,"column":40}},"37":{"start":{"line":75,"column":4},"end":{"line":75,"column":50}},"38":{"start":{"line":78,"column":4},"end":{"line":80,"column":5}},"39":{"start":{"line":79,"column":6},"end":{"line":79,"column":49}},"40":{"start":{"line":81,"column":4},"end":{"line":81,"column":50}},"41":{"start":{"line":84,"column":4},"end":{"line":84,"column":60}},"42":{"start":{"line":87,"column":4},"end":{"line":87,"column":47}},"43":{"start":{"line":91,"column":4},"end":{"line":91,"column":38}},"44":{"start":{"line":92,"column":4},"end":{"line":92,"column":33}},"45":{"start":{"line":95,"column":4},"end":{"line":95,"column":87}},"46":{"start":{"line":98,"column":26},"end":{"line":98,"column":54}},"47":{"start":{"line":99,"column":4},"end":{"line":99,"column":51}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":2},"end":{"line":5,"column":3}},"loc":{"start":{"line":5,"column":25},"end":{"line":9,"column":3}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":25,"column":2},"end":{"line":25,"column":3}},"loc":{"start":{"line":25,"column":12},"end":{"line":32,"column":3}},"line":25},"2":{"name":"(anonymous_2)","decl":{"start":{"line":33,"column":2},"end":{"line":33,"column":3}},"loc":{"start":{"line":33,"column":41},"end":{"line":37,"column":3}},"line":33},"3":{"name":"(anonymous_3)","decl":{"start":{"line":44,"column":2},"end":{"line":44,"column":3}},"loc":{"start":{"line":44,"column":52},"end":{"line":65,"column":3}},"line":44},"4":{"name":"(anonymous_4)","decl":{"start":{"line":66,"column":2},"end":{"line":66,"column":3}},"loc":{"start":{"line":66,"column":25},"end":{"line":68,"column":3}},"line":66},"5":{"name":"(anonymous_5)","decl":{"start":{"line":74,"column":2},"end":{"line":74,"column":3}},"loc":{"start":{"line":74,"column":35},"end":{"line":76,"column":3}},"line":74},"6":{"name":"(anonymous_6)","decl":{"start":{"line":77,"column":2},"end":{"line":77,"column":3}},"loc":{"start":{"line":77,"column":36},"end":{"line":82,"column":3}},"line":77},"7":{"name":"(anonymous_7)","decl":{"start":{"line":83,"column":2},"end":{"line":83,"column":3}},"loc":{"start":{"line":83,"column":48},"end":{"line":85,"column":3}},"line":83},"8":{"name":"(anonymous_8)","decl":{"start":{"line":86,"column":2},"end":{"line":86,"column":3}},"loc":{"start":{"line":86,"column":32},"end":{"line":88,"column":3}},"line":86},"9":{"name":"(anonymous_9)","decl":{"start":{"line":90,"column":2},"end":{"line":90,"column":3}},"loc":{"start":{"line":90,"column":10},"end":{"line":93,"column":3}},"line":90},"10":{"name":"(anonymous_10)","decl":{"start":{"line":94,"column":2},"end":{"line":94,"column":3}},"loc":{"start":{"line":94,"column":26},"end":{"line":96,"column":3}},"line":94},"11":{"name":"(anonymous_11)","decl":{"start":{"line":97,"column":2},"end":{"line":97,"column":3}},"loc":{"start":{"line":97,"column":28},"end":{"line":100,"column":3}},"line":97}},"branchMap":{"0":{"loc":{"start":{"line":44,"column":25},"end":{"line":44,"column":44}},"type":"default-arg","locations":[{"start":{"line":44,"column":42},"end":{"line":44,"column":44}}],"line":44},"1":{"loc":{"start":{"line":46,"column":4},"end":{"line":64,"column":5}},"type":"switch","locations":[{"start":{"line":47,"column":6},"end":{"line":49,"column":14}},{"start":{"line":50,"column":6},"end":{"line":52,"column":14}},{"start":{"line":53,"column":6},"end":{"line":56,"column":14}},{"start":{"line":57,"column":6},"end":{"line":60,"column":7}},{"start":{"line":61,"column":6},"end":{"line":63,"column":14}}],"line":46},"2":{"loc":{"start":{"line":78,"column":4},"end":{"line":80,"column":5}},"type":"if","locations":[{"start":{"line":78,"column":4},"end":{"line":80,"column":5}},{"start":{},"end":{}}],"line":78}},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":2,"9":2,"10":2,"11":2,"12":2,"13":2,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":2,"21":2,"22":2,"23":3,"24":3,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":3,"33":3,"34":0,"35":0,"36":0,"37":0,"38":2,"39":2,"40":2,"41":3,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0},"f":{"0":2,"1":0,"2":2,"3":3,"4":0,"5":0,"6":2,"7":3,"8":0,"9":0,"10":0,"11":0},"b":{"0":[0],"1":[0,0,0,3,0],"2":[2,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/selection-data-model.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ISelectionCell, Nullable, Workbook } from '@univerjs/core';\nimport type { Observable } from 'rxjs';\nimport type { ISelectionWithStyle } from '../../basics/selection';\n\nimport { Disposable } from '@univerjs/core';\nimport { BehaviorSubject, merge, Subject } from 'rxjs';\nimport { SelectionMoveType } from './type';\n\n/**\n * Origin name: WorkbookSelections\n * NOT Same as @univerjs/sheets-ui.SelectionRenderModel, that's data for SelectionControl in rendering.\n */\nexport class WorkbookSelectionModel extends Disposable {\n    /**\n     * Selection data model for each worksheet.\n     */\n    private _worksheetSelections = new Map<string, ISelectionWithStyle[]>();\n\n    private readonly _selectionMoveStart$ = new Subject<Nullable<ISelectionWithStyle[]>>();\n    readonly selectionMoveStart$ = this._selectionMoveStart$.asObservable();\n\n    private readonly _selectionMoving$ = new Subject<Nullable<ISelectionWithStyle[]>>();\n    readonly selectionMoving$ = this._selectionMoving$.asObservable();\n\n    readonly _selectionMoveEnd$ = new BehaviorSubject<ISelectionWithStyle[]>([]);\n    readonly selectionMoveEnd$ = this._selectionMoveEnd$.asObservable();\n\n    private readonly _selectionSet$ = new BehaviorSubject<ISelectionWithStyle[]>([]);\n    readonly selectionSet$ = this._selectionSet$.asObservable();\n\n    selectionChanged$: Observable<ISelectionWithStyle[]>;\n\n    private readonly _beforeSelectionMoveEnd$ = new BehaviorSubject<ISelectionWithStyle[]>([]);\n    readonly beforeSelectionMoveEnd$ = this._beforeSelectionMoveEnd$.asObservable();\n\n    constructor(\n        private readonly _workbook: Workbook\n    ) {\n        super();\n        this.selectionChanged$ = merge(this._selectionMoveEnd$, this._selectionSet$);\n    }\n\n    override dispose(): void {\n        super.dispose();\n\n        this._beforeSelectionMoveEnd$.complete();\n        this._selectionMoveEnd$.complete();\n        this._selectionMoving$.complete();\n        this._selectionMoveStart$.complete();\n        this._selectionSet$.complete();\n    }\n\n    addSelections(sheetId: string, selectionDatas: ISelectionWithStyle[]): void {\n        const selections = this.getSelectionsOfWorksheet(sheetId);\n        selections.push(...selectionDatas);\n        this._selectionSet$.next(selections);\n    }\n\n    /**\n     * Set selectionDatas to _worksheetSelections, and emit selectionDatas by type.\n     * @param sheetId\n     * @param selectionDatas\n     * @param type\n     */\n    setSelections(sheetId: string, selectionDatas: ISelectionWithStyle[] = [], type: SelectionMoveType): void {\n        // selectionDatas should not be same variable as this._worksheetSelections !!!\n        // but there are some place get selection from this._worksheetSelections and set selectionDatas(2nd parameter of this function ) cause selectionDatas is always []\n        // see univer/pull/2909\n        // this.deleteSheetSelection(sheetId);\n        this.setSelectionsOfWorksheet(sheetId, selectionDatas);\n\n        switch (type) {\n            case SelectionMoveType.MOVE_START:\n                this._selectionMoveStart$.next(selectionDatas);\n                break;\n            case SelectionMoveType.MOVING:\n                this._selectionMoving$.next(selectionDatas);\n                break;\n            case SelectionMoveType.MOVE_END:\n                this._beforeSelectionMoveEnd$.next(selectionDatas);\n                this._selectionMoveEnd$.next(selectionDatas);\n                break;\n            case SelectionMoveType.ONLY_SET: {\n                this._selectionSet$.next(selectionDatas);\n                break;\n            }\n            default:\n                this._selectionSet$.next(selectionDatas);\n                break;\n        }\n    }\n\n    getCurrentSelections(): Readonly<ISelectionWithStyle[]> {\n        return this._getCurrentSelections();\n    }\n\n    /**\n     * @deprecated use `getSelectionsOfWorksheet` instead.\n     * @param sheetId\n     * @returns\n     */\n    getSelectionOfWorksheet(sheetId: string): ISelectionWithStyle[] {\n        return this.getSelectionsOfWorksheet(sheetId);\n    }\n\n    getSelectionsOfWorksheet(sheetId: string): ISelectionWithStyle[] {\n        if (!this._worksheetSelections.has(sheetId)) {\n            this._worksheetSelections.set(sheetId, []);\n        }\n\n        return this._worksheetSelections.get(sheetId)!;\n    }\n\n    setSelectionsOfWorksheet(sheetId: string, selections: ISelectionWithStyle[]): void {\n        this._worksheetSelections.set(sheetId, [...selections]);\n    }\n\n    deleteSheetSelection(sheetId: string) {\n        this._worksheetSelections.set(sheetId, []);\n    }\n\n    /** Clear all selections in this workbook. */\n    clear(): void {\n        this._worksheetSelections.clear();\n        this._selectionSet$.next([]);\n    }\n\n    private _getCurrentSelections(): ISelectionWithStyle[] {\n        return this.getSelectionsOfWorksheet(this._workbook.getActiveSheet()!.getSheetId());\n    }\n\n    getCurrentLastSelection(): Readonly<Nullable<ISelectionWithStyle & { primary: ISelectionCell }>> {\n        const selectionData = this._getCurrentSelections();\n        return selectionData[selectionData.length - 1] as Readonly<Nullable<ISelectionWithStyle & { primary: ISelectionCell }>>;\n    }\n}\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d65e983a192a7b520ce26d3bfaa6187256b3ed7c"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/selection.service.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/selection.service.ts","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":37}},"1":{"start":{"line":2,"column":23},"end":{"line":2,"column":54}},"2":{"start":{"line":3,"column":22},"end":{"line":10,"column":1}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"4":{"start":{"line":5,"column":2},"end":{"line":7,"column":85}},"5":{"start":{"line":5,"column":15},"end":{"line":5,"column":36}},"6":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"7":{"start":{"line":7,"column":6},"end":{"line":7,"column":85}},"8":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"9":{"start":{"line":8,"column":22},"end":{"line":8,"column":53}},"10":{"start":{"line":9,"column":2},"end":{"line":9,"column":16}},"11":{"start":{"line":11,"column":22},"end":{"line":11,"column":90}},"12":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"13":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"14":{"start":{"line":16,"column":37},"end":{"line":168,"column":1}},"15":{"start":{"line":18,"column":4},"end":{"line":18,"column":12}},"16":{"start":{"line":19,"column":4},"end":{"line":19,"column":37}},"17":{"start":{"line":20,"column":4},"end":{"line":20,"column":17}},"18":{"start":{"line":23,"column":21},"end":{"line":23,"column":93}},"19":{"start":{"line":24,"column":4},"end":{"line":24,"column":31}},"20":{"start":{"line":24,"column":19},"end":{"line":24,"column":31}},"21":{"start":{"line":25,"column":22},"end":{"line":25,"column":47}},"22":{"start":{"line":26,"column":4},"end":{"line":26,"column":77}},"23":{"start":{"line":29,"column":4},"end":{"line":29,"column":37}},"24":{"start":{"line":52,"column":15},"end":{"line":52,"column":134}},"25":{"start":{"line":53,"column":4},"end":{"line":53,"column":156}},"26":{"start":{"line":53,"column":63},"end":{"line":53,"column":153}},"27":{"start":{"line":54,"column":4},"end":{"line":54,"column":150}},"28":{"start":{"line":54,"column":60},"end":{"line":54,"column":147}},"29":{"start":{"line":55,"column":4},"end":{"line":55,"column":154}},"30":{"start":{"line":55,"column":61},"end":{"line":55,"column":151}},"31":{"start":{"line":56,"column":4},"end":{"line":56,"column":146}},"32":{"start":{"line":56,"column":57},"end":{"line":56,"column":143}},"33":{"start":{"line":57,"column":4},"end":{"line":66,"column":6}},"34":{"start":{"line":57,"column":61},"end":{"line":57,"column":151}},"35":{"start":{"line":59,"column":8},"end":{"line":59,"column":54}},"36":{"start":{"line":59,"column":41},"end":{"line":59,"column":54}},"37":{"start":{"line":60,"column":8},"end":{"line":60,"column":64}},"38":{"start":{"line":60,"column":52},"end":{"line":60,"column":64}},"39":{"start":{"line":61,"column":8},"end":{"line":63,"column":11}},"40":{"start":{"line":62,"column":10},"end":{"line":62,"column":70}},"41":{"start":{"line":67,"column":4},"end":{"line":69,"column":7}},"42":{"start":{"line":68,"column":6},"end":{"line":68,"column":58}},"43":{"start":{"line":76,"column":4},"end":{"line":76,"column":75}},"44":{"start":{"line":76,"column":54},"end":{"line":76,"column":73}},"45":{"start":{"line":79,"column":4},"end":{"line":79,"column":40}},"46":{"start":{"line":82,"column":26},"end":{"line":82,"column":54}},"47":{"start":{"line":83,"column":4},"end":{"line":83,"column":53}},"48":{"start":{"line":86,"column":4},"end":{"line":89,"column":5}},"49":{"start":{"line":87,"column":6},"end":{"line":87,"column":99}},"50":{"start":{"line":88,"column":6},"end":{"line":88,"column":13}},"51":{"start":{"line":90,"column":20},"end":{"line":90,"column":45}},"52":{"start":{"line":91,"column":4},"end":{"line":93,"column":5}},"53":{"start":{"line":92,"column":6},"end":{"line":92,"column":92}},"54":{"start":{"line":94,"column":32},"end":{"line":94,"column":39}},"55":{"start":{"line":95,"column":4},"end":{"line":95,"column":85}},"56":{"start":{"line":98,"column":4},"end":{"line":106,"column":5}},"57":{"start":{"line":99,"column":22},"end":{"line":99,"column":40}},"58":{"start":{"line":100,"column":6},"end":{"line":104,"column":8}},"59":{"start":{"line":105,"column":6},"end":{"line":105,"column":13}},"60":{"start":{"line":107,"column":20},"end":{"line":107,"column":45}},"61":{"start":{"line":108,"column":4},"end":{"line":110,"column":5}},"62":{"start":{"line":109,"column":6},"end":{"line":109,"column":92}},"63":{"start":{"line":111,"column":32},"end":{"line":111,"column":39}},"64":{"start":{"line":112,"column":4},"end":{"line":116,"column":5}},"65":{"start":{"line":113,"column":28},"end":{"line":113,"column":64}},"66":{"start":{"line":114,"column":20},"end":{"line":114,"column":67}},"67":{"start":{"line":115,"column":6},"end":{"line":115,"column":89}},"68":{"start":{"line":119,"column":26},"end":{"line":119,"column":54}},"69":{"start":{"line":120,"column":4},"end":{"line":120,"column":28}},"70":{"start":{"line":128,"column":30},"end":{"line":128,"column":57}},"71":{"start":{"line":129,"column":4},"end":{"line":131,"column":5}},"72":{"start":{"line":130,"column":6},"end":{"line":130,"column":19}},"73":{"start":{"line":132,"column":4},"end":{"line":139,"column":6}},"74":{"start":{"line":133,"column":28},"end":{"line":138,"column":8}},"75":{"start":{"line":134,"column":8},"end":{"line":136,"column":9}},"76":{"start":{"line":135,"column":10},"end":{"line":135,"column":23}},"77":{"start":{"line":137,"column":8},"end":{"line":137,"column":164}},"78":{"start":{"line":142,"column":20},"end":{"line":142,"column":45}},"79":{"start":{"line":143,"column":4},"end":{"line":145,"column":5}},"80":{"start":{"line":144,"column":6},"end":{"line":144,"column":16}},"81":{"start":{"line":146,"column":32},"end":{"line":146,"column":39}},"82":{"start":{"line":147,"column":4},"end":{"line":147,"column":83}},"83":{"start":{"line":150,"column":4},"end":{"line":150,"column":49}},"84":{"start":{"line":152,"column":40},"end":{"line":152,"column":49}},"85":{"start":{"line":154,"column":22},"end":{"line":154,"column":58}},"86":{"start":{"line":155,"column":4},"end":{"line":162,"column":5}},"87":{"start":{"line":156,"column":23},"end":{"line":156,"column":56}},"88":{"start":{"line":157,"column":6},"end":{"line":159,"column":7}},"89":{"start":{"line":158,"column":8},"end":{"line":158,"column":95}},"90":{"start":{"line":160,"column":6},"end":{"line":160,"column":57}},"91":{"start":{"line":161,"column":6},"end":{"line":161,"column":56}},"92":{"start":{"line":163,"column":4},"end":{"line":163,"column":23}},"93":{"start":{"line":166,"column":4},"end":{"line":166,"column":44}},"94":{"start":{"line":169,"column":0},"end":{"line":171,"column":28}},"95":{"start":{"line":172,"column":41},"end":{"line":172,"column":68}},"96":{"start":{"line":173,"column":34},"end":{"line":173,"column":54}},"97":{"start":{"line":174,"column":38},"end":{"line":174,"column":62}},"98":{"start":{"line":175,"column":30},"end":{"line":175,"column":50}},"99":{"start":{"line":176,"column":43},"end":{"line":180,"column":23}},"100":{"start":{"line":177,"column":2},"end":{"line":177,"column":58}},"101":{"start":{"line":178,"column":2},"end":{"line":178,"column":52}},"102":{"start":{"line":179,"column":2},"end":{"line":179,"column":24}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":22},"end":{"line":3,"column":23}},"loc":{"start":{"line":3,"column":57},"end":{"line":10,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":44},"end":{"line":11,"column":45}},"loc":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":17,"column":2},"end":{"line":17,"column":3}},"loc":{"start":{"line":17,"column":28},"end":{"line":21,"column":3}},"line":17},"4":{"name":"(anonymous_4)","decl":{"start":{"line":22,"column":2},"end":{"line":22,"column":3}},"loc":{"start":{"line":22,"column":29},"end":{"line":27,"column":3}},"line":22},"5":{"name":"(anonymous_5)","decl":{"start":{"line":28,"column":2},"end":{"line":28,"column":3}},"loc":{"start":{"line":28,"column":30},"end":{"line":30,"column":3}},"line":28},"6":{"name":"(anonymous_6)","decl":{"start":{"line":51,"column":2},"end":{"line":51,"column":3}},"loc":{"start":{"line":51,"column":10},"end":{"line":70,"column":3}},"line":51},"7":{"name":"(anonymous_7)","decl":{"start":{"line":53,"column":49},"end":{"line":53,"column":50}},"loc":{"start":{"line":53,"column":63},"end":{"line":53,"column":153}},"line":53},"8":{"name":"(anonymous_8)","decl":{"start":{"line":54,"column":46},"end":{"line":54,"column":47}},"loc":{"start":{"line":54,"column":60},"end":{"line":54,"column":147}},"line":54},"9":{"name":"(anonymous_9)","decl":{"start":{"line":55,"column":47},"end":{"line":55,"column":48}},"loc":{"start":{"line":55,"column":61},"end":{"line":55,"column":151}},"line":55},"10":{"name":"(anonymous_10)","decl":{"start":{"line":56,"column":43},"end":{"line":56,"column":44}},"loc":{"start":{"line":56,"column":57},"end":{"line":56,"column":143}},"line":56},"11":{"name":"(anonymous_11)","decl":{"start":{"line":57,"column":47},"end":{"line":57,"column":48}},"loc":{"start":{"line":57,"column":61},"end":{"line":57,"column":151}},"line":57},"12":{"name":"(anonymous_12)","decl":{"start":{"line":58,"column":27},"end":{"line":58,"column":28}},"loc":{"start":{"line":58,"column":43},"end":{"line":64,"column":7}},"line":58},"13":{"name":"(anonymous_13)","decl":{"start":{"line":61,"column":26},"end":{"line":61,"column":27}},"loc":{"start":{"line":61,"column":43},"end":{"line":63,"column":9}},"line":61},"14":{"name":"(anonymous_14)","decl":{"start":{"line":67,"column":119},"end":{"line":67,"column":120}},"loc":{"start":{"line":67,"column":133},"end":{"line":69,"column":5}},"line":67},"15":{"name":"(anonymous_15)","decl":{"start":{"line":75,"column":2},"end":{"line":75,"column":3}},"loc":{"start":{"line":75,"column":10},"end":{"line":77,"column":3}},"line":75},"16":{"name":"(anonymous_16)","decl":{"start":{"line":76,"column":37},"end":{"line":76,"column":38}},"loc":{"start":{"line":76,"column":54},"end":{"line":76,"column":73}},"line":76},"17":{"name":"(anonymous_17)","decl":{"start":{"line":78,"column":2},"end":{"line":78,"column":3}},"loc":{"start":{"line":78,"column":25},"end":{"line":80,"column":3}},"line":78},"18":{"name":"(anonymous_18)","decl":{"start":{"line":81,"column":2},"end":{"line":81,"column":3}},"loc":{"start":{"line":81,"column":28},"end":{"line":84,"column":3}},"line":81},"19":{"name":"(anonymous_19)","decl":{"start":{"line":85,"column":2},"end":{"line":85,"column":3}},"loc":{"start":{"line":85,"column":65},"end":{"line":96,"column":3}},"line":85},"20":{"name":"(anonymous_20)","decl":{"start":{"line":97,"column":2},"end":{"line":97,"column":3}},"loc":{"start":{"line":97,"column":77},"end":{"line":117,"column":3}},"line":97},"21":{"name":"(anonymous_21)","decl":{"start":{"line":118,"column":2},"end":{"line":118,"column":3}},"loc":{"start":{"line":118,"column":27},"end":{"line":121,"column":3}},"line":118},"22":{"name":"(anonymous_22)","decl":{"start":{"line":127,"column":2},"end":{"line":127,"column":3}},"loc":{"start":{"line":127,"column":18},"end":{"line":140,"column":3}},"line":127},"23":{"name":"(anonymous_23)","decl":{"start":{"line":133,"column":6},"end":{"line":133,"column":7}},"loc":{"start":{"line":133,"column":28},"end":{"line":138,"column":8}},"line":133},"24":{"name":"(anonymous_24)","decl":{"start":{"line":133,"column":51},"end":{"line":133,"column":52}},"loc":{"start":{"line":133,"column":82},"end":{"line":138,"column":7}},"line":133},"25":{"name":"(anonymous_25)","decl":{"start":{"line":141,"column":2},"end":{"line":141,"column":3}},"loc":{"start":{"line":141,"column":26},"end":{"line":148,"column":3}},"line":141},"26":{"name":"(anonymous_26)","decl":{"start":{"line":149,"column":2},"end":{"line":149,"column":3}},"loc":{"start":{"line":149,"column":32},"end":{"line":151,"column":3}},"line":149},"27":{"name":"(anonymous_27)","decl":{"start":{"line":153,"column":2},"end":{"line":153,"column":3}},"loc":{"start":{"line":153,"column":35},"end":{"line":164,"column":3}},"line":153},"28":{"name":"(anonymous_28)","decl":{"start":{"line":165,"column":2},"end":{"line":165,"column":3}},"loc":{"start":{"line":165,"column":35},"end":{"line":167,"column":3}},"line":165},"29":{"name":"(anonymous_29)","decl":{"start":{"line":176,"column":44},"end":{"line":176,"column":45}},"loc":{"start":{"line":176,"column":64},"end":{"line":180,"column":1}},"line":176}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":26},"end":{"line":4,"column":32}},{"start":{"line":4,"column":35},"end":{"line":4,"column":80}}],"line":4},"1":{"loc":{"start":{"line":4,"column":35},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":42},"end":{"line":4,"column":71}},{"start":{"line":4,"column":74},"end":{"line":4,"column":80}}],"line":4},"2":{"loc":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"type":"if","locations":[{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},{"start":{},"end":{}}],"line":6},"3":{"loc":{"start":{"line":7,"column":15},"end":{"line":7,"column":84}},"type":"binary-expr","locations":[{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},{"start":{"line":7,"column":78},"end":{"line":7,"column":84}}],"line":7},"4":{"loc":{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},"type":"cond-expr","locations":[{"start":{"line":7,"column":23},"end":{"line":7,"column":53}},{"start":{"line":7,"column":56},"end":{"line":7,"column":73}}],"line":7},"5":{"loc":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},{"start":{},"end":{}}],"line":8},"6":{"loc":{"start":{"line":8,"column":6},"end":{"line":8,"column":20}},"type":"binary-expr","locations":[{"start":{"line":8,"column":6},"end":{"line":8,"column":10}},{"start":{"line":8,"column":14},"end":{"line":8,"column":20}}],"line":8},"7":{"loc":{"start":{"line":24,"column":4},"end":{"line":24,"column":31}},"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":24,"column":31}},{"start":{},"end":{}}],"line":24},"8":{"loc":{"start":{"line":53,"column":63},"end":{"line":53,"column":153}},"type":"cond-expr","locations":[{"start":{"line":53,"column":75},"end":{"line":53,"column":79}},{"start":{"line":53,"column":82},"end":{"line":53,"column":153}}],"line":53},"9":{"loc":{"start":{"line":54,"column":60},"end":{"line":54,"column":147}},"type":"cond-expr","locations":[{"start":{"line":54,"column":72},"end":{"line":54,"column":76}},{"start":{"line":54,"column":79},"end":{"line":54,"column":147}}],"line":54},"10":{"loc":{"start":{"line":55,"column":61},"end":{"line":55,"column":151}},"type":"cond-expr","locations":[{"start":{"line":55,"column":73},"end":{"line":55,"column":79}},{"start":{"line":55,"column":82},"end":{"line":55,"column":151}}],"line":55},"11":{"loc":{"start":{"line":56,"column":57},"end":{"line":56,"column":143}},"type":"cond-expr","locations":[{"start":{"line":56,"column":69},"end":{"line":56,"column":75}},{"start":{"line":56,"column":78},"end":{"line":56,"column":143}}],"line":56},"12":{"loc":{"start":{"line":57,"column":61},"end":{"line":57,"column":151}},"type":"cond-expr","locations":[{"start":{"line":57,"column":73},"end":{"line":57,"column":79}},{"start":{"line":57,"column":82},"end":{"line":57,"column":151}}],"line":57},"13":{"loc":{"start":{"line":59,"column":8},"end":{"line":59,"column":54}},"type":"if","locations":[{"start":{"line":59,"column":8},"end":{"line":59,"column":54}},{"start":{},"end":{}}],"line":59},"14":{"loc":{"start":{"line":60,"column":8},"end":{"line":60,"column":64}},"type":"if","locations":[{"start":{"line":60,"column":8},"end":{"line":60,"column":64}},{"start":{},"end":{}}],"line":60},"15":{"loc":{"start":{"line":60,"column":12},"end":{"line":60,"column":50}},"type":"binary-expr","locations":[{"start":{"line":60,"column":12},"end":{"line":60,"column":29}},{"start":{"line":60,"column":33},"end":{"line":60,"column":50}}],"line":60},"16":{"loc":{"start":{"line":86,"column":4},"end":{"line":89,"column":5}},"type":"if","locations":[{"start":{"line":86,"column":4},"end":{"line":89,"column":5}},{"start":{},"end":{}}],"line":86},"17":{"loc":{"start":{"line":91,"column":4},"end":{"line":93,"column":5}},"type":"if","locations":[{"start":{"line":91,"column":4},"end":{"line":93,"column":5}},{"start":{},"end":{}}],"line":91},"18":{"loc":{"start":{"line":98,"column":4},"end":{"line":106,"column":5}},"type":"if","locations":[{"start":{"line":98,"column":4},"end":{"line":106,"column":5}},{"start":{},"end":{}}],"line":98},"19":{"loc":{"start":{"line":98,"column":8},"end":{"line":98,"column":87}},"type":"binary-expr","locations":[{"start":{"line":98,"column":8},"end":{"line":98,"column":46}},{"start":{"line":98,"column":50},"end":{"line":98,"column":87}}],"line":98},"20":{"loc":{"start":{"line":102,"column":8},"end":{"line":102,"column":28}},"type":"binary-expr","locations":[{"start":{"line":102,"column":8},"end":{"line":102,"column":22}},{"start":{"line":102,"column":26},"end":{"line":102,"column":28}}],"line":102},"21":{"loc":{"start":{"line":103,"column":8},"end":{"line":103,"column":42}},"type":"binary-expr","locations":[{"start":{"line":103,"column":8},"end":{"line":103,"column":12}},{"start":{"line":103,"column":16},"end":{"line":103,"column":42}}],"line":103},"22":{"loc":{"start":{"line":108,"column":4},"end":{"line":110,"column":5}},"type":"if","locations":[{"start":{"line":108,"column":4},"end":{"line":110,"column":5}},{"start":{},"end":{}}],"line":108},"23":{"loc":{"start":{"line":112,"column":4},"end":{"line":116,"column":5}},"type":"if","locations":[{"start":{"line":112,"column":4},"end":{"line":116,"column":5}},{"start":{},"end":{}}],"line":112},"24":{"loc":{"start":{"line":113,"column":28},"end":{"line":113,"column":64}},"type":"binary-expr","locations":[{"start":{"line":113,"column":28},"end":{"line":113,"column":46}},{"start":{"line":113,"column":50},"end":{"line":113,"column":64}}],"line":113},"25":{"loc":{"start":{"line":114,"column":20},"end":{"line":114,"column":67}},"type":"binary-expr","locations":[{"start":{"line":114,"column":20},"end":{"line":114,"column":37}},{"start":{"line":114,"column":41},"end":{"line":114,"column":67}}],"line":114},"26":{"loc":{"start":{"line":129,"column":4},"end":{"line":131,"column":5}},"type":"if","locations":[{"start":{"line":129,"column":4},"end":{"line":131,"column":5}},{"start":{},"end":{}}],"line":129},"27":{"loc":{"start":{"line":134,"column":8},"end":{"line":136,"column":9}},"type":"if","locations":[{"start":{"line":134,"column":8},"end":{"line":136,"column":9}},{"start":{},"end":{}}],"line":134},"28":{"loc":{"start":{"line":137,"column":15},"end":{"line":137,"column":163}},"type":"binary-expr","locations":[{"start":{"line":137,"column":15},"end":{"line":137,"column":46}},{"start":{"line":137,"column":50},"end":{"line":137,"column":81}},{"start":{"line":137,"column":85},"end":{"line":137,"column":122}},{"start":{"line":137,"column":126},"end":{"line":137,"column":163}}],"line":137},"29":{"loc":{"start":{"line":143,"column":4},"end":{"line":145,"column":5}},"type":"if","locations":[{"start":{"line":143,"column":4},"end":{"line":145,"column":5}},{"start":{},"end":{}}],"line":143},"30":{"loc":{"start":{"line":155,"column":4},"end":{"line":162,"column":5}},"type":"if","locations":[{"start":{"line":155,"column":4},"end":{"line":162,"column":5}},{"start":{},"end":{}}],"line":155},"31":{"loc":{"start":{"line":157,"column":6},"end":{"line":159,"column":7}},"type":"if","locations":[{"start":{"line":157,"column":6},"end":{"line":159,"column":7}},{"start":{},"end":{}}],"line":157},"32":{"loc":{"start":{"line":180,"column":3},"end":{"line":180,"column":22}},"type":"binary-expr","locations":[{"start":{"line":180,"column":3},"end":{"line":180,"column":16}},{"start":{"line":180,"column":20},"end":{"line":180,"column":22}}],"line":180}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1,"11":1,"12":1,"13":1,"14":1,"15":2,"16":2,"17":2,"18":2,"19":2,"20":0,"21":2,"22":2,"23":0,"24":2,"25":2,"26":0,"27":2,"28":0,"29":2,"30":0,"31":2,"32":0,"33":2,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":2,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":2,"49":0,"50":0,"51":2,"52":2,"53":0,"54":2,"55":2,"56":3,"57":3,"58":3,"59":3,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":2,"85":5,"86":5,"87":2,"88":2,"89":0,"90":2,"91":2,"92":5,"93":0,"94":1,"95":1,"96":1,"97":1,"98":1,"99":1,"100":1,"101":1,"102":1},"f":{"0":1,"1":1,"2":1,"3":2,"4":2,"5":0,"6":2,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":2,"20":3,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":5,"28":0,"29":1},"b":{"0":[0,1],"1":[0,1],"2":[1,0],"3":[1,1],"4":[0,1],"5":[0,1],"6":[1,0],"7":[0,2],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,2],"17":[0,2],"18":[3,0],"19":[3,3],"20":[3,0],"21":[3,3],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0,0,0],"29":[0,0],"30":[2,3],"31":[0,2],"32":[1,1]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/selection.service.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { DeepReadonly, ISelectionCell, Nullable, Workbook } from '@univerjs/core';\nimport type { Observable } from 'rxjs';\nimport type { ISelectionWithStyle } from '../../basics/selection';\nimport type { ISelectionManagerSearchParam } from './type';\n\nimport { IUniverInstanceService, RxDisposable, UniverInstanceType } from '@univerjs/core';\nimport { distinctUntilChanged, of, shareReplay, skip, switchMap, takeUntil } from 'rxjs';\nimport { WorkbookSelectionModel } from './selection-data-model';\nimport { SelectionMoveType } from './type';\n\n/**\n * For normal selection.\n * Ref selection is in RefSelectionService which extends this class.\n */\nexport class SheetsSelectionsService extends RxDisposable {\n    private get _currentSelectionPos(): Nullable<ISelectionManagerSearchParam> {\n        const workbook = this._instanceSrv.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        if (!workbook) return null;\n\n        const worksheet = workbook.getActiveSheet();\n        return { unitId: workbook.getUnitId(), sheetId: worksheet.getSheetId() };\n    }\n\n    get currentSelectionParam() {\n        return this._currentSelectionPos;\n    }\n\n    /**\n     * Selection Events, usually triggered when pointerdown in spreadsheet by selection render service after selectionModel has updated.\n     */\n    selectionMoveStart$: Observable<Nullable<ISelectionWithStyle[]>>;\n\n    /**\n     * Selection Events, usually triggered when pointermove in spreadsheet by selection render service after selectionModel has updated.\n     */\n    selectionMoving$: Observable<Nullable<ISelectionWithStyle[]>>;\n\n    /**\n     * Selection Events, usually triggered when pointerup in spreadsheet by selection render service after selectionModel has updated.\n     */\n    selectionMoveEnd$: Observable<ISelectionWithStyle[]>;\n\n    /**\n     * Selection Events, usually triggered when changing unit.(focus in formula editor)\n     */\n    selectionSet$: Observable<Nullable<ISelectionWithStyle[]>>;\n\n    /**\n     * Selection Events, merge moveEnd$ and selectionSet$\n     */\n    selectionChanged$: Observable<Nullable<ISelectionWithStyle[]>>;\n\n    constructor(\n        @IUniverInstanceService protected readonly _instanceSrv: IUniverInstanceService\n    ) {\n        super();\n        this._init();\n    }\n\n    protected _init(): void {\n        const c$ = this._instanceSrv.getCurrentTypeOfUnit$(UniverInstanceType.UNIVER_SHEET).pipe(shareReplay(1), takeUntil(this.dispose$));\n        // When workbook changed, unsubscribe the previous workbook selection$ and subscribe the new workbook selection$.\n        this.selectionMoveStart$ = c$.pipe(switchMap((workbook) => !workbook ? of() : this._ensureWorkbookSelection(workbook.getUnitId()).selectionMoveStart$));\n        this.selectionMoving$ = c$.pipe(switchMap((workbook) => !workbook ? of() : this._ensureWorkbookSelection(workbook.getUnitId()).selectionMoving$));\n        this.selectionMoveEnd$ = c$.pipe(switchMap((workbook) => !workbook ? of([]) : this._ensureWorkbookSelection(workbook.getUnitId()).selectionMoveEnd$));\n        this.selectionSet$ = c$.pipe(switchMap((workbook) => !workbook ? of([]) : this._ensureWorkbookSelection(workbook.getUnitId()).selectionSet$));\n        this.selectionChanged$ = c$.pipe(switchMap((workbook) => !workbook ? of([]) : this._ensureWorkbookSelection(workbook.getUnitId()).selectionChanged$)).pipe(\n            distinctUntilChanged((prev, curr) => {\n                if (prev.length !== curr.length) return false;\n                if (prev.length === 0 && curr.length === 0) return true;\n                return prev.every((item, index) => {\n                    return JSON.stringify(item) === JSON.stringify(curr[index]);\n                });\n            }),\n            skip(1)\n        );\n\n        this._instanceSrv.getTypeOfUnitDisposed$(UniverInstanceType.UNIVER_SHEET).pipe(takeUntil(this.dispose$)).subscribe((workbook) => {\n            this._removeWorkbookSelection(workbook.getUnitId());\n        });\n    }\n\n    /**\n     * Clear all selections in all workbooks.\n     * invoked by prompt.controller\n     */\n    clear(): void {\n        this._workbookSelections.forEach((wbSelection) => wbSelection.clear());\n    }\n\n    getCurrentSelections(): Readonly<ISelectionWithStyle[]> {\n        return this._getCurrentSelections();\n    }\n\n    getCurrentLastSelection(): DeepReadonly<Nullable<ISelectionWithStyle & { primary: ISelectionCell }>> {\n        const selectionData = this._getCurrentSelections();\n        return selectionData?.[selectionData.length - 1] as Readonly<Nullable<ISelectionWithStyle & { primary: ISelectionCell }>>;\n    }\n\n    addSelections(selectionsData: ISelectionWithStyle[]): void;\n    addSelections(unitId: string, worksheetId: string, selectionDatas: ISelectionWithStyle[]): void;\n    addSelections(unitIdOrSelections: string | ISelectionWithStyle[], worksheetId?: string, selectionDatas?: ISelectionWithStyle[]): void {\n        if (typeof unitIdOrSelections === 'string') {\n            this._ensureWorkbookSelection(unitIdOrSelections).addSelections(worksheetId!, selectionDatas!);\n            return;\n        }\n\n        const current = this._currentSelectionPos;\n        if (!current) {\n            throw new Error('[SheetsSelectionsService]: cannot find current selection position!');\n        }\n        const { unitId, sheetId } = current;\n        this._ensureWorkbookSelection(unitId).addSelections(sheetId, unitIdOrSelections);\n    }\n\n    /**\n     * Set selection data to WorkbookSelectionModel.\n     *\n     * @param unitIdOrSelections\n     * @param worksheetIdOrType\n     * @param selectionDatas\n     * @param type\n     */\n    setSelections(selectionDatas: ISelectionWithStyle[], type?: SelectionMoveType): void;\n    setSelections(unitId: string, worksheetId: string, selectionDatas: ISelectionWithStyle[], type?: SelectionMoveType): void;\n    setSelections(\n        unitIdOrSelections: string | ISelectionWithStyle[],\n        worksheetIdOrType: string | SelectionMoveType | undefined,\n        selectionDatas?: ISelectionWithStyle[],\n        type?: SelectionMoveType\n    ): void {\n        if (typeof unitIdOrSelections === 'string' && typeof worksheetIdOrType === 'string') {\n            const unitId = unitIdOrSelections as string;\n            this._ensureWorkbookSelection(unitId).setSelections(\n                worksheetIdOrType,\n                selectionDatas || [],\n                type ?? SelectionMoveType.ONLY_SET\n            );\n            return;\n        }\n\n        const current = this._currentSelectionPos;\n        if (!current) {\n            throw new Error('[SheetsSelectionsService]: cannot find current selection position!');\n        }\n\n        const { unitId, sheetId } = current;\n        if (typeof unitIdOrSelections === 'object') {\n            const selectionData = unitIdOrSelections ?? selectionDatas;\n            const type = worksheetIdOrType as SelectionMoveType ?? SelectionMoveType.ONLY_SET;\n            this._ensureWorkbookSelection(unitId).setSelections(sheetId, selectionData, type);\n        }\n    }\n\n    clearCurrentSelections(): void {\n        const selectionData = this._getCurrentSelections();\n        selectionData.splice(0);\n    }\n\n    /**\n     * Determine whether multiple current selections overlap\n     *\n     * @deprecated this should be extracted to an pure function\n     */\n    isOverlapping(): boolean {\n        const selectionDataList = this.getCurrentSelections();\n        if (selectionDataList == null) {\n            return false;\n        }\n\n        return selectionDataList.some(({ range }, index) =>\n            selectionDataList.some(({ range: range2 }, index2) => {\n                if (index === index2) {\n                    return false;\n                }\n                return (\n                    range.startRow <= range2.endRow &&\n                    range.endRow >= range2.startRow &&\n                    range.startColumn <= range2.endColumn &&\n                    range.endColumn >= range2.startColumn\n                );\n            })\n        );\n    }\n\n    protected _getCurrentSelections() {\n        const current = this._currentSelectionPos;\n        if (!current) {\n            return [];\n        }\n\n        const { unitId, sheetId } = current;\n        return this._ensureWorkbookSelection(unitId).getSelectionsOfWorksheet(sheetId);\n    }\n\n    getWorkbookSelections(unitId: string): WorkbookSelectionModel {\n        return this._ensureWorkbookSelection(unitId);\n    }\n\n    protected _workbookSelections = new Map<string, WorkbookSelectionModel>();\n    protected _ensureWorkbookSelection(unitId: string): WorkbookSelectionModel {\n        let wbSelection = this._workbookSelections.get(unitId);\n        if (!wbSelection) {\n            const workbook = this._instanceSrv.getUnit<Workbook>(unitId);\n            if (!workbook) {\n                throw new Error(`[SheetsSelectionsService]: cannot resolve unit with id \"${unitId}\"!`);\n            }\n\n            wbSelection = new WorkbookSelectionModel(workbook);\n            this._workbookSelections.set(unitId, wbSelection);\n        }\n\n        return wbSelection;\n    }\n\n    protected _removeWorkbookSelection(unitId: string): void {\n        this._workbookSelections.delete(unitId);\n    }\n}\n\n/** An context key to disable normal selections if its value is set to `true`. */\n// so Bad! why not enableXXX\nexport const DISABLE_NORMAL_SELECTIONS = 'DISABLE_NORMAL_SELECTIONS';\nexport const SELECTIONS_ENABLED = 'SELECTIONS_ENABLED';\nexport const REF_SELECTIONS_ENABLED = 'REF_SELECTIONS_ENABLED';\nexport const SELECTION_MODE = '__SELECTION_MODE__';\nexport enum SelectionMode {\n    NORMAL,\n    REF,\n}\n"],"mappings":"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","names":["unitId","type","SelectionMode"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b16e153c94b4eb4eacefc64dc6cf5e11f8cf2046"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/sheet-interceptor/interceptor-const.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/sheet-interceptor/interceptor-const.ts","statementMap":{"0":{"start":{"line":2,"column":21},"end":{"line":2,"column":57}},"1":{"start":{"line":3,"column":21},"end":{"line":3,"column":57}},"2":{"start":{"line":4,"column":33},"end":{"line":7,"column":1}},"3":{"start":{"line":8,"column":58},"end":{"line":13,"column":38}},"4":{"start":{"line":9,"column":2},"end":{"line":9,"column":106}},"5":{"start":{"line":10,"column":2},"end":{"line":10,"column":89}},"6":{"start":{"line":11,"column":2},"end":{"line":11,"column":97}},"7":{"start":{"line":12,"column":2},"end":{"line":12,"column":39}},"8":{"start":{"line":14,"column":39},"end":{"line":14,"column":73}},"9":{"start":{"line":15,"column":46},"end":{"line":15,"column":84}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":59},"end":{"line":8,"column":60}},"loc":{"start":{"line":8,"column":94},"end":{"line":13,"column":1}},"line":8}},"branchMap":{"0":{"loc":{"start":{"line":13,"column":3},"end":{"line":13,"column":37}},"type":"binary-expr","locations":[{"start":{"line":13,"column":3},"end":{"line":13,"column":31}},{"start":{"line":13,"column":35},"end":{"line":13,"column":37}}],"line":13}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1},"f":{"0":1},"b":{"0":[1,1]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/sheet-interceptor/interceptor-const.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellData, ICellDataForSheetInterceptor, ICellInterceptor, Nullable } from '@univerjs/core';\nimport type { ISheetLocation, ISheetRowLocation } from './utils/interceptor';\n\nimport { createInterceptorKey } from '@univerjs/core';\n\nconst CELL_CONTENT = createInterceptorKey<ICellDataForSheetInterceptor, ISheetLocation & { rawData: Nullable<ICellData> }>('CELL_CONTENT') as ICellInterceptor<ICellDataForSheetInterceptor, ISheetLocation & { rawData: Nullable<ICellData> }>;\nconst ROW_FILTERED = createInterceptorKey<boolean, ISheetRowLocation>('ROW_FILTERED');\n\nexport const INTERCEPTOR_POINT = {\n    CELL_CONTENT,\n    ROW_FILTERED,\n};\n\nexport enum InterceptCellContentPriority {\n    DATA_VALIDATION = 9,\n    NUMFMT = 10,\n    CELL_IMAGE = 11,\n}\n// used for define the range theme interceptor, it will also use to ignore the range theme interceptor\nexport const RangeThemeInterceptorId = 'sheet.interceptor.range-theme-id';\n\nexport const IgnoreRangeThemeInterceptorKey = 'sheet.interceptor.ignore-range-theme';\n"],"mappings":"AAmBA,SAAS,4BAA4B;AAErC,MAAM,eAAe,qBAAsG,cAAc;AACzI,MAAM,eAAe,qBAAiD,cAAc;AAE7E,aAAM,oBAAoB;AAAA,EAC7B;AAAA,EACA;AACJ;AAEO,WAAK,+BAAL,kBAAKA,kCAAL;AACH,EAAAA,4DAAA,qBAAkB,KAAlB;AACA,EAAAA,4DAAA,YAAS,MAAT;AACA,EAAAA,4DAAA,gBAAa,MAAb;AAHQ,SAAAA;AAAA,GAAA;AAML,aAAM,0BAA0B;AAEhC,aAAM,iCAAiC;","names":["InterceptCellContentPriority"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7895c8d2e97066b0ade87500952f58c224d5f641"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/sheet-interceptor/sheet-interceptor.service.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/sheet-interceptor/sheet-interceptor.service.ts","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":37}},"1":{"start":{"line":2,"column":23},"end":{"line":2,"column":54}},"2":{"start":{"line":3,"column":22},"end":{"line":10,"column":1}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"4":{"start":{"line":5,"column":2},"end":{"line":7,"column":85}},"5":{"start":{"line":5,"column":15},"end":{"line":5,"column":36}},"6":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"7":{"start":{"line":7,"column":6},"end":{"line":7,"column":85}},"8":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"9":{"start":{"line":8,"column":22},"end":{"line":8,"column":53}},"10":{"start":{"line":9,"column":2},"end":{"line":9,"column":16}},"11":{"start":{"line":11,"column":22},"end":{"line":11,"column":90}},"12":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"13":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"14":{"start":{"line":26,"column":32},"end":{"line":26,"column":72}},"15":{"start":{"line":27,"column":31},"end":{"line":27,"column":70}},"16":{"start":{"line":28,"column":29},"end":{"line":28,"column":66}},"17":{"start":{"line":29,"column":37},"end":{"line":317,"column":1}},"18":{"start":{"line":32,"column":4},"end":{"line":32,"column":12}},"19":{"start":{"line":33,"column":4},"end":{"line":33,"column":57}},"20":{"start":{"line":34,"column":4},"end":{"line":36,"column":8}},"21":{"start":{"line":35,"column":6},"end":{"line":35,"column":40}},"22":{"start":{"line":37,"column":4},"end":{"line":39,"column":7}},"23":{"start":{"line":38,"column":20},"end":{"line":38,"column":62}},"24":{"start":{"line":40,"column":4},"end":{"line":50,"column":7}},"25":{"start":{"line":44,"column":24},"end":{"line":44,"column":78}},"26":{"start":{"line":45,"column":8},"end":{"line":47,"column":9}},"27":{"start":{"line":46,"column":10},"end":{"line":46,"column":42}},"28":{"start":{"line":48,"column":8},"end":{"line":48,"column":23}},"29":{"start":{"line":51,"column":4},"end":{"line":54,"column":8}},"30":{"start":{"line":53,"column":27},"end":{"line":53,"column":33}},"31":{"start":{"line":55,"column":4},"end":{"line":58,"column":8}},"32":{"start":{"line":57,"column":27},"end":{"line":57,"column":33}},"33":{"start":{"line":59,"column":4},"end":{"line":62,"column":8}},"34":{"start":{"line":61,"column":27},"end":{"line":61,"column":33}},"35":{"start":{"line":64,"column":40},"end":{"line":64,"column":49}},"36":{"start":{"line":65,"column":25},"end":{"line":65,"column":27}},"37":{"start":{"line":66,"column":23},"end":{"line":66,"column":25}},"38":{"start":{"line":67,"column":30},"end":{"line":67,"column":32}},"39":{"start":{"line":68,"column":30},"end":{"line":68,"column":32}},"40":{"start":{"line":69,"column":41},"end":{"line":69,"column":50}},"41":{"start":{"line":70,"column":42},"end":{"line":70,"column":51}},"42":{"start":{"line":71,"column":23},"end":{"line":71,"column":28}},"43":{"start":{"line":72,"column":46},"end":{"line":72,"column":55}},"44":{"start":{"line":73,"column":25},"end":{"line":77,"column":4}},"45":{"start":{"line":79,"column":4},"end":{"line":79,"column":20}},"46":{"start":{"line":80,"column":4},"end":{"line":80,"column":76}},"47":{"start":{"line":80,"column":54},"end":{"line":80,"column":74}},"48":{"start":{"line":81,"column":4},"end":{"line":81,"column":38}},"49":{"start":{"line":82,"column":4},"end":{"line":82,"column":39}},"50":{"start":{"line":83,"column":4},"end":{"line":83,"column":37}},"51":{"start":{"line":95,"column":4},"end":{"line":97,"column":5}},"52":{"start":{"line":96,"column":6},"end":{"line":96,"column":80}},"53":{"start":{"line":98,"column":4},"end":{"line":98,"column":48}},"54":{"start":{"line":99,"column":4},"end":{"line":99,"column":84}},"55":{"start":{"line":99,"column":45},"end":{"line":99,"column":82}},"56":{"start":{"line":100,"column":4},"end":{"line":100,"column":98}},"57":{"start":{"line":100,"column":49},"end":{"line":100,"column":95}},"58":{"start":{"line":108,"column":18},"end":{"line":108,"column":76}},"59":{"start":{"line":108,"column":55},"end":{"line":108,"column":75}},"60":{"start":{"line":109,"column":4},"end":{"line":114,"column":6}},"61":{"start":{"line":110,"column":33},"end":{"line":110,"column":49}},"62":{"start":{"line":111,"column":30},"end":{"line":111,"column":37}},"63":{"start":{"line":112,"column":33},"end":{"line":112,"column":49}},"64":{"start":{"line":113,"column":30},"end":{"line":113,"column":37}},"65":{"start":{"line":117,"column":4},"end":{"line":119,"column":5}},"66":{"start":{"line":118,"column":6},"end":{"line":118,"column":80}},"67":{"start":{"line":120,"column":4},"end":{"line":120,"column":53}},"68":{"start":{"line":121,"column":4},"end":{"line":121,"column":89}},"69":{"start":{"line":121,"column":50},"end":{"line":121,"column":87}},"70":{"start":{"line":122,"column":4},"end":{"line":122,"column":103}},"71":{"start":{"line":122,"column":49},"end":{"line":122,"column":100}},"72":{"start":{"line":125,"column":18},"end":{"line":125,"column":81}},"73":{"start":{"line":125,"column":60},"end":{"line":125,"column":80}},"74":{"start":{"line":126,"column":4},"end":{"line":129,"column":6}},"75":{"start":{"line":127,"column":30},"end":{"line":127,"column":37}},"76":{"start":{"line":128,"column":30},"end":{"line":128,"column":37}},"77":{"start":{"line":141,"column":4},"end":{"line":143,"column":5}},"78":{"start":{"line":142,"column":6},"end":{"line":142,"column":80}},"79":{"start":{"line":144,"column":4},"end":{"line":144,"column":53}},"80":{"start":{"line":145,"column":4},"end":{"line":145,"column":89}},"81":{"start":{"line":145,"column":50},"end":{"line":145,"column":87}},"82":{"start":{"line":146,"column":4},"end":{"line":146,"column":103}},"83":{"start":{"line":146,"column":49},"end":{"line":146,"column":100}},"84":{"start":{"line":154,"column":31},"end":{"line":154,"column":113}},"85":{"start":{"line":154,"column":91},"end":{"line":154,"column":111}},"86":{"start":{"line":155,"column":4},"end":{"line":155,"column":58}},"87":{"start":{"line":155,"column":49},"end":{"line":155,"column":56}},"88":{"start":{"line":165,"column":4},"end":{"line":167,"column":5}},"89":{"start":{"line":166,"column":6},"end":{"line":166,"column":80}},"90":{"start":{"line":168,"column":4},"end":{"line":168,"column":46}},"91":{"start":{"line":169,"column":4},"end":{"line":169,"column":82}},"92":{"start":{"line":169,"column":43},"end":{"line":169,"column":80}},"93":{"start":{"line":170,"column":4},"end":{"line":170,"column":96}},"94":{"start":{"line":170,"column":49},"end":{"line":170,"column":93}},"95":{"start":{"line":173,"column":18},"end":{"line":173,"column":74}},"96":{"start":{"line":173,"column":53},"end":{"line":173,"column":73}},"97":{"start":{"line":174,"column":4},"end":{"line":179,"column":6}},"98":{"start":{"line":175,"column":33},"end":{"line":175,"column":49}},"99":{"start":{"line":176,"column":30},"end":{"line":176,"column":37}},"100":{"start":{"line":177,"column":33},"end":{"line":177,"column":49}},"101":{"start":{"line":178,"column":30},"end":{"line":178,"column":37}},"102":{"start":{"line":184,"column":20},"end":{"line":192,"column":5}},"103":{"start":{"line":193,"column":4},"end":{"line":193,"column":98}},"104":{"start":{"line":197,"column":20},"end":{"line":204,"column":5}},"105":{"start":{"line":205,"column":4},"end":{"line":205,"column":109}},"106":{"start":{"line":208,"column":16},"end":{"line":208,"column":20}},"107":{"start":{"line":209,"column":4},"end":{"line":211,"column":5}},"108":{"start":{"line":210,"column":6},"end":{"line":210,"column":44}},"109":{"start":{"line":212,"column":25},"end":{"line":212,"column":58}},"110":{"start":{"line":213,"column":4},"end":{"line":213,"column":35}},"111":{"start":{"line":214,"column":31},"end":{"line":214,"column":97}},"112":{"start":{"line":214,"column":59},"end":{"line":214,"column":96}},"113":{"start":{"line":215,"column":4},"end":{"line":215,"column":35}},"114":{"start":{"line":216,"column":4},"end":{"line":237,"column":5}},"115":{"start":{"line":217,"column":28},"end":{"line":217,"column":85}},"116":{"start":{"line":218,"column":6},"end":{"line":218,"column":82}},"117":{"start":{"line":219,"column":26},"end":{"line":219,"column":83}},"118":{"start":{"line":220,"column":6},"end":{"line":223,"column":8}},"119":{"start":{"line":222,"column":41},"end":{"line":222,"column":102}},"120":{"start":{"line":224,"column":6},"end":{"line":227,"column":8}},"121":{"start":{"line":226,"column":41},"end":{"line":226,"column":102}},"122":{"start":{"line":228,"column":6},"end":{"line":233,"column":10}},"123":{"start":{"line":229,"column":8},"end":{"line":229,"column":63}},"124":{"start":{"line":230,"column":8},"end":{"line":230,"column":85}},"125":{"start":{"line":231,"column":8},"end":{"line":231,"column":99}},"126":{"start":{"line":232,"column":8},"end":{"line":232,"column":99}},"127":{"start":{"line":235,"column":6},"end":{"line":235,"column":60}},"128":{"start":{"line":236,"column":6},"end":{"line":236,"column":108}},"129":{"start":{"line":236,"column":51},"end":{"line":236,"column":105}},"130":{"start":{"line":240,"column":23},"end":{"line":240,"column":69}},"131":{"start":{"line":241,"column":16},"end":{"line":241,"column":34}},"132":{"start":{"line":242,"column":19},"end":{"line":242,"column":58}},"133":{"start":{"line":243,"column":4},"end":{"line":250,"column":5}},"134":{"start":{"line":244,"column":25},"end":{"line":244,"column":65}},"135":{"start":{"line":245,"column":6},"end":{"line":247,"column":7}},"136":{"start":{"line":246,"column":8},"end":{"line":246,"column":51}},"137":{"start":{"line":248,"column":6},"end":{"line":248,"column":57}},"138":{"start":{"line":249,"column":6},"end":{"line":249,"column":56}},"139":{"start":{"line":251,"column":4},"end":{"line":251,"column":20}},"140":{"start":{"line":254,"column":24},"end":{"line":254,"column":50}},"141":{"start":{"line":255,"column":19},"end":{"line":255,"column":39}},"142":{"start":{"line":256,"column":36},"end":{"line":256,"column":40}},"143":{"start":{"line":257,"column":31},"end":{"line":294,"column":5}},"144":{"start":{"line":258,"column":24},"end":{"line":258,"column":46}},"145":{"start":{"line":259,"column":6},"end":{"line":293,"column":9}},"146":{"start":{"line":260,"column":33},"end":{"line":260,"column":59}},"147":{"start":{"line":261,"column":8},"end":{"line":261,"column":121}},"148":{"start":{"line":262,"column":8},"end":{"line":278,"column":12}},"149":{"start":{"line":264,"column":28},"end":{"line":264,"column":58}},"150":{"start":{"line":265,"column":12},"end":{"line":276,"column":14}},"151":{"start":{"line":279,"column":8},"end":{"line":292,"column":12}},"152":{"start":{"line":281,"column":12},"end":{"line":290,"column":14}},"153":{"start":{"line":295,"column":4},"end":{"line":295,"column":79}},"154":{"start":{"line":295,"column":48},"end":{"line":295,"column":77}},"155":{"start":{"line":296,"column":4},"end":{"line":296,"column":100}},"156":{"start":{"line":296,"column":68},"end":{"line":296,"column":97}},"157":{"start":{"line":297,"column":4},"end":{"line":297,"column":135}},"158":{"start":{"line":297,"column":39},"end":{"line":297,"column":132}},"159":{"start":{"line":297,"column":83},"end":{"line":297,"column":131}},"160":{"start":{"line":298,"column":4},"end":{"line":298,"column":120}},"161":{"start":{"line":298,"column":69},"end":{"line":298,"column":117}},"162":{"start":{"line":299,"column":4},"end":{"line":299,"column":55}},"163":{"start":{"line":302,"column":19},"end":{"line":302,"column":39}},"164":{"start":{"line":303,"column":23},"end":{"line":303,"column":60}},"165":{"start":{"line":304,"column":4},"end":{"line":307,"column":5}},"166":{"start":{"line":305,"column":6},"end":{"line":305,"column":27}},"167":{"start":{"line":306,"column":6},"end":{"line":306,"column":47}},"168":{"start":{"line":310,"column":25},"end":{"line":310,"column":68}},"169":{"start":{"line":311,"column":23},"end":{"line":311,"column":67}},"170":{"start":{"line":312,"column":4},"end":{"line":315,"column":5}},"171":{"start":{"line":313,"column":6},"end":{"line":313,"column":27}},"172":{"start":{"line":314,"column":6},"end":{"line":314,"column":54}},"173":{"start":{"line":318,"column":0},"end":{"line":320,"column":28}},"174":{"start":{"line":322,"column":2},"end":{"line":322,"column":47}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":22},"end":{"line":3,"column":23}},"loc":{"start":{"line":3,"column":57},"end":{"line":10,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":44},"end":{"line":11,"column":45}},"loc":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":31,"column":2},"end":{"line":31,"column":3}},"loc":{"start":{"line":31,"column":38},"end":{"line":63,"column":3}},"line":31},"4":{"name":"(anonymous_4)","decl":{"start":{"line":34,"column":114},"end":{"line":34,"column":115}},"loc":{"start":{"line":34,"column":128},"end":{"line":36,"column":5}},"line":34},"5":{"name":"(anonymous_5)","decl":{"start":{"line":38,"column":6},"end":{"line":38,"column":7}},"loc":{"start":{"line":38,"column":20},"end":{"line":38,"column":62}},"line":38},"6":{"name":"(anonymous_6)","decl":{"start":{"line":43,"column":6},"end":{"line":43,"column":7}},"loc":{"start":{"line":43,"column":30},"end":{"line":49,"column":7}},"line":43},"7":{"name":"(anonymous_7)","decl":{"start":{"line":53,"column":15},"end":{"line":53,"column":16}},"loc":{"start":{"line":53,"column":27},"end":{"line":53,"column":33}},"line":53},"8":{"name":"(anonymous_8)","decl":{"start":{"line":57,"column":15},"end":{"line":57,"column":16}},"loc":{"start":{"line":57,"column":27},"end":{"line":57,"column":33}},"line":57},"9":{"name":"(anonymous_9)","decl":{"start":{"line":61,"column":15},"end":{"line":61,"column":16}},"loc":{"start":{"line":61,"column":27},"end":{"line":61,"column":33}},"line":61},"10":{"name":"(anonymous_10)","decl":{"start":{"line":78,"column":2},"end":{"line":78,"column":3}},"loc":{"start":{"line":78,"column":12},"end":{"line":84,"column":3}},"line":78},"11":{"name":"(anonymous_11)","decl":{"start":{"line":80,"column":38},"end":{"line":80,"column":39}},"loc":{"start":{"line":80,"column":54},"end":{"line":80,"column":74}},"line":80},"12":{"name":"(anonymous_12)","decl":{"start":{"line":94,"column":2},"end":{"line":94,"column":3}},"loc":{"start":{"line":94,"column":32},"end":{"line":101,"column":3}},"line":94},"13":{"name":"(anonymous_13)","decl":{"start":{"line":99,"column":35},"end":{"line":99,"column":36}},"loc":{"start":{"line":99,"column":45},"end":{"line":99,"column":82}},"line":99},"14":{"name":"(anonymous_14)","decl":{"start":{"line":100,"column":43},"end":{"line":100,"column":44}},"loc":{"start":{"line":100,"column":49},"end":{"line":100,"column":95}},"line":100},"15":{"name":"(anonymous_15)","decl":{"start":{"line":107,"column":2},"end":{"line":107,"column":3}},"loc":{"start":{"line":107,"column":25},"end":{"line":115,"column":3}},"line":107},"16":{"name":"(anonymous_16)","decl":{"start":{"line":108,"column":48},"end":{"line":108,"column":49}},"loc":{"start":{"line":108,"column":55},"end":{"line":108,"column":75}},"line":108},"17":{"name":"(anonymous_17)","decl":{"start":{"line":110,"column":26},"end":{"line":110,"column":27}},"loc":{"start":{"line":110,"column":33},"end":{"line":110,"column":49}},"line":110},"18":{"name":"(anonymous_18)","decl":{"start":{"line":111,"column":23},"end":{"line":111,"column":24}},"loc":{"start":{"line":111,"column":30},"end":{"line":111,"column":37}},"line":111},"19":{"name":"(anonymous_19)","decl":{"start":{"line":112,"column":26},"end":{"line":112,"column":27}},"loc":{"start":{"line":112,"column":33},"end":{"line":112,"column":49}},"line":112},"20":{"name":"(anonymous_20)","decl":{"start":{"line":113,"column":23},"end":{"line":113,"column":24}},"loc":{"start":{"line":113,"column":30},"end":{"line":113,"column":37}},"line":113},"21":{"name":"(anonymous_21)","decl":{"start":{"line":116,"column":2},"end":{"line":116,"column":3}},"loc":{"start":{"line":116,"column":37},"end":{"line":123,"column":3}},"line":116},"22":{"name":"(anonymous_22)","decl":{"start":{"line":121,"column":40},"end":{"line":121,"column":41}},"loc":{"start":{"line":121,"column":50},"end":{"line":121,"column":87}},"line":121},"23":{"name":"(anonymous_23)","decl":{"start":{"line":122,"column":43},"end":{"line":122,"column":44}},"loc":{"start":{"line":122,"column":49},"end":{"line":122,"column":100}},"line":122},"24":{"name":"(anonymous_24)","decl":{"start":{"line":124,"column":2},"end":{"line":124,"column":3}},"loc":{"start":{"line":124,"column":28},"end":{"line":130,"column":3}},"line":124},"25":{"name":"(anonymous_25)","decl":{"start":{"line":125,"column":53},"end":{"line":125,"column":54}},"loc":{"start":{"line":125,"column":60},"end":{"line":125,"column":80}},"line":125},"26":{"name":"(anonymous_26)","decl":{"start":{"line":127,"column":23},"end":{"line":127,"column":24}},"loc":{"start":{"line":127,"column":30},"end":{"line":127,"column":37}},"line":127},"27":{"name":"(anonymous_27)","decl":{"start":{"line":128,"column":23},"end":{"line":128,"column":24}},"loc":{"start":{"line":128,"column":30},"end":{"line":128,"column":37}},"line":128},"28":{"name":"(anonymous_28)","decl":{"start":{"line":140,"column":2},"end":{"line":140,"column":3}},"loc":{"start":{"line":140,"column":38},"end":{"line":147,"column":3}},"line":140},"29":{"name":"(anonymous_29)","decl":{"start":{"line":145,"column":40},"end":{"line":145,"column":41}},"loc":{"start":{"line":145,"column":50},"end":{"line":145,"column":87}},"line":145},"30":{"name":"(anonymous_30)","decl":{"start":{"line":146,"column":43},"end":{"line":146,"column":44}},"loc":{"start":{"line":146,"column":49},"end":{"line":146,"column":100}},"line":146},"31":{"name":"(anonymous_31)","decl":{"start":{"line":153,"column":2},"end":{"line":153,"column":3}},"loc":{"start":{"line":153,"column":35},"end":{"line":156,"column":3}},"line":153},"32":{"name":"(anonymous_32)","decl":{"start":{"line":154,"column":84},"end":{"line":154,"column":85}},"loc":{"start":{"line":154,"column":91},"end":{"line":154,"column":111}},"line":154},"33":{"name":"(anonymous_33)","decl":{"start":{"line":155,"column":36},"end":{"line":155,"column":37}},"loc":{"start":{"line":155,"column":49},"end":{"line":155,"column":56}},"line":155},"34":{"name":"(anonymous_34)","decl":{"start":{"line":164,"column":2},"end":{"line":164,"column":3}},"loc":{"start":{"line":164,"column":31},"end":{"line":171,"column":3}},"line":164},"35":{"name":"(anonymous_35)","decl":{"start":{"line":169,"column":33},"end":{"line":169,"column":34}},"loc":{"start":{"line":169,"column":43},"end":{"line":169,"column":80}},"line":169},"36":{"name":"(anonymous_36)","decl":{"start":{"line":170,"column":43},"end":{"line":170,"column":44}},"loc":{"start":{"line":170,"column":49},"end":{"line":170,"column":93}},"line":170},"37":{"name":"(anonymous_37)","decl":{"start":{"line":172,"column":2},"end":{"line":172,"column":3}},"loc":{"start":{"line":172,"column":34},"end":{"line":180,"column":3}},"line":172},"38":{"name":"(anonymous_38)","decl":{"start":{"line":173,"column":46},"end":{"line":173,"column":47}},"loc":{"start":{"line":173,"column":53},"end":{"line":173,"column":73}},"line":173},"39":{"name":"(anonymous_39)","decl":{"start":{"line":175,"column":26},"end":{"line":175,"column":27}},"loc":{"start":{"line":175,"column":33},"end":{"line":175,"column":49}},"line":175},"40":{"name":"(anonymous_40)","decl":{"start":{"line":176,"column":23},"end":{"line":176,"column":24}},"loc":{"start":{"line":176,"column":30},"end":{"line":176,"column":37}},"line":176},"41":{"name":"(anonymous_41)","decl":{"start":{"line":177,"column":26},"end":{"line":177,"column":27}},"loc":{"start":{"line":177,"column":33},"end":{"line":177,"column":49}},"line":177},"42":{"name":"(anonymous_42)","decl":{"start":{"line":178,"column":23},"end":{"line":178,"column":24}},"loc":{"start":{"line":178,"column":30},"end":{"line":178,"column":37}},"line":178},"43":{"name":"(anonymous_43)","decl":{"start":{"line":183,"column":2},"end":{"line":183,"column":3}},"loc":{"start":{"line":183,"column":55},"end":{"line":194,"column":3}},"line":183},"44":{"name":"(anonymous_44)","decl":{"start":{"line":196,"column":2},"end":{"line":196,"column":3}},"loc":{"start":{"line":196,"column":48},"end":{"line":206,"column":3}},"line":196},"45":{"name":"(anonymous_45)","decl":{"start":{"line":207,"column":2},"end":{"line":207,"column":3}},"loc":{"start":{"line":207,"column":31},"end":{"line":238,"column":3}},"line":207},"46":{"name":"(anonymous_46)","decl":{"start":{"line":214,"column":49},"end":{"line":214,"column":50}},"loc":{"start":{"line":214,"column":59},"end":{"line":214,"column":96}},"line":214},"47":{"name":"(anonymous_47)","decl":{"start":{"line":222,"column":34},"end":{"line":222,"column":35}},"loc":{"start":{"line":222,"column":41},"end":{"line":222,"column":102}},"line":222},"48":{"name":"(anonymous_48)","decl":{"start":{"line":226,"column":34},"end":{"line":226,"column":35}},"loc":{"start":{"line":226,"column":41},"end":{"line":226,"column":102}},"line":226},"49":{"name":"(anonymous_49)","decl":{"start":{"line":228,"column":45},"end":{"line":228,"column":46}},"loc":{"start":{"line":228,"column":51},"end":{"line":233,"column":7}},"line":228},"50":{"name":"(anonymous_50)","decl":{"start":{"line":236,"column":45},"end":{"line":236,"column":46}},"loc":{"start":{"line":236,"column":51},"end":{"line":236,"column":105}},"line":236},"51":{"name":"(anonymous_51)","decl":{"start":{"line":239,"column":2},"end":{"line":239,"column":3}},"loc":{"start":{"line":239,"column":55},"end":{"line":252,"column":3}},"line":239},"52":{"name":"(anonymous_52)","decl":{"start":{"line":253,"column":2},"end":{"line":253,"column":3}},"loc":{"start":{"line":253,"column":31},"end":{"line":300,"column":3}},"line":253},"53":{"name":"(anonymous_53)","decl":{"start":{"line":257,"column":31},"end":{"line":257,"column":32}},"loc":{"start":{"line":257,"column":46},"end":{"line":294,"column":5}},"line":257},"54":{"name":"(anonymous_54)","decl":{"start":{"line":259,"column":37},"end":{"line":259,"column":38}},"loc":{"start":{"line":259,"column":52},"end":{"line":293,"column":7}},"line":259},"55":{"name":"(anonymous_55)","decl":{"start":{"line":263,"column":10},"end":{"line":263,"column":11}},"loc":{"start":{"line":263,"column":49},"end":{"line":277,"column":11}},"line":263},"56":{"name":"(anonymous_56)","decl":{"start":{"line":280,"column":10},"end":{"line":280,"column":11}},"loc":{"start":{"line":280,"column":30},"end":{"line":291,"column":11}},"line":280},"57":{"name":"(anonymous_57)","decl":{"start":{"line":295,"column":33},"end":{"line":295,"column":34}},"loc":{"start":{"line":295,"column":48},"end":{"line":295,"column":77}},"line":295},"58":{"name":"(anonymous_58)","decl":{"start":{"line":296,"column":53},"end":{"line":296,"column":54}},"loc":{"start":{"line":296,"column":68},"end":{"line":296,"column":97}},"line":296},"59":{"name":"(anonymous_59)","decl":{"start":{"line":297,"column":33},"end":{"line":297,"column":34}},"loc":{"start":{"line":297,"column":39},"end":{"line":297,"column":132}},"line":297},"60":{"name":"(anonymous_60)","decl":{"start":{"line":297,"column":68},"end":{"line":297,"column":69}},"loc":{"start":{"line":297,"column":83},"end":{"line":297,"column":131}},"line":297},"61":{"name":"(anonymous_61)","decl":{"start":{"line":298,"column":54},"end":{"line":298,"column":55}},"loc":{"start":{"line":298,"column":69},"end":{"line":298,"column":117}},"line":298},"62":{"name":"(anonymous_62)","decl":{"start":{"line":301,"column":2},"end":{"line":301,"column":3}},"loc":{"start":{"line":301,"column":40},"end":{"line":308,"column":3}},"line":301},"63":{"name":"(anonymous_63)","decl":{"start":{"line":309,"column":2},"end":{"line":309,"column":3}},"loc":{"start":{"line":309,"column":46},"end":{"line":316,"column":3}},"line":309},"64":{"name":"getWorksheetDisposableID","decl":{"start":{"line":321,"column":9},"end":{"line":321,"column":33}},"loc":{"start":{"line":321,"column":53},"end":{"line":323,"column":1}},"line":321}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":26},"end":{"line":4,"column":32}},{"start":{"line":4,"column":35},"end":{"line":4,"column":80}}],"line":4},"1":{"loc":{"start":{"line":4,"column":35},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":42},"end":{"line":4,"column":71}},{"start":{"line":4,"column":74},"end":{"line":4,"column":80}}],"line":4},"2":{"loc":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"type":"if","locations":[{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},{"start":{},"end":{}}],"line":6},"3":{"loc":{"start":{"line":7,"column":15},"end":{"line":7,"column":84}},"type":"binary-expr","locations":[{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},{"start":{"line":7,"column":78},"end":{"line":7,"column":84}}],"line":7},"4":{"loc":{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},"type":"cond-expr","locations":[{"start":{"line":7,"column":23},"end":{"line":7,"column":53}},{"start":{"line":7,"column":56},"end":{"line":7,"column":73}}],"line":7},"5":{"loc":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},{"start":{},"end":{}}],"line":8},"6":{"loc":{"start":{"line":8,"column":6},"end":{"line":8,"column":20}},"type":"binary-expr","locations":[{"start":{"line":8,"column":6},"end":{"line":8,"column":10}},{"start":{"line":8,"column":14},"end":{"line":8,"column":20}}],"line":8},"7":{"loc":{"start":{"line":45,"column":8},"end":{"line":47,"column":9}},"type":"if","locations":[{"start":{"line":45,"column":8},"end":{"line":47,"column":9}},{"start":{},"end":{}}],"line":45},"8":{"loc":{"start":{"line":95,"column":4},"end":{"line":97,"column":5}},"type":"if","locations":[{"start":{"line":95,"column":4},"end":{"line":97,"column":5}},{"start":{},"end":{}}],"line":95},"9":{"loc":{"start":{"line":99,"column":46},"end":{"line":99,"column":61}},"type":"binary-expr","locations":[{"start":{"line":99,"column":46},"end":{"line":99,"column":56}},{"start":{"line":99,"column":60},"end":{"line":99,"column":61}}],"line":99},"10":{"loc":{"start":{"line":99,"column":66},"end":{"line":99,"column":81}},"type":"binary-expr","locations":[{"start":{"line":99,"column":66},"end":{"line":99,"column":76}},{"start":{"line":99,"column":80},"end":{"line":99,"column":81}}],"line":99},"11":{"loc":{"start":{"line":110,"column":33},"end":{"line":110,"column":49}},"type":"binary-expr","locations":[{"start":{"line":110,"column":33},"end":{"line":110,"column":43}},{"start":{"line":110,"column":47},"end":{"line":110,"column":49}}],"line":110},"12":{"loc":{"start":{"line":112,"column":33},"end":{"line":112,"column":49}},"type":"binary-expr","locations":[{"start":{"line":112,"column":33},"end":{"line":112,"column":43}},{"start":{"line":112,"column":47},"end":{"line":112,"column":49}}],"line":112},"13":{"loc":{"start":{"line":117,"column":4},"end":{"line":119,"column":5}},"type":"if","locations":[{"start":{"line":117,"column":4},"end":{"line":119,"column":5}},{"start":{},"end":{}}],"line":117},"14":{"loc":{"start":{"line":121,"column":51},"end":{"line":121,"column":66}},"type":"binary-expr","locations":[{"start":{"line":121,"column":51},"end":{"line":121,"column":61}},{"start":{"line":121,"column":65},"end":{"line":121,"column":66}}],"line":121},"15":{"loc":{"start":{"line":121,"column":71},"end":{"line":121,"column":86}},"type":"binary-expr","locations":[{"start":{"line":121,"column":71},"end":{"line":121,"column":81}},{"start":{"line":121,"column":85},"end":{"line":121,"column":86}}],"line":121},"16":{"loc":{"start":{"line":141,"column":4},"end":{"line":143,"column":5}},"type":"if","locations":[{"start":{"line":141,"column":4},"end":{"line":143,"column":5}},{"start":{},"end":{}}],"line":141},"17":{"loc":{"start":{"line":145,"column":51},"end":{"line":145,"column":66}},"type":"binary-expr","locations":[{"start":{"line":145,"column":51},"end":{"line":145,"column":61}},{"start":{"line":145,"column":65},"end":{"line":145,"column":66}}],"line":145},"18":{"loc":{"start":{"line":145,"column":71},"end":{"line":145,"column":86}},"type":"binary-expr","locations":[{"start":{"line":145,"column":71},"end":{"line":145,"column":81}},{"start":{"line":145,"column":85},"end":{"line":145,"column":86}}],"line":145},"19":{"loc":{"start":{"line":165,"column":4},"end":{"line":167,"column":5}},"type":"if","locations":[{"start":{"line":165,"column":4},"end":{"line":167,"column":5}},{"start":{},"end":{}}],"line":165},"20":{"loc":{"start":{"line":169,"column":44},"end":{"line":169,"column":59}},"type":"binary-expr","locations":[{"start":{"line":169,"column":44},"end":{"line":169,"column":54}},{"start":{"line":169,"column":58},"end":{"line":169,"column":59}}],"line":169},"21":{"loc":{"start":{"line":169,"column":64},"end":{"line":169,"column":79}},"type":"binary-expr","locations":[{"start":{"line":169,"column":64},"end":{"line":169,"column":74}},{"start":{"line":169,"column":78},"end":{"line":169,"column":79}}],"line":169},"22":{"loc":{"start":{"line":175,"column":33},"end":{"line":175,"column":49}},"type":"binary-expr","locations":[{"start":{"line":175,"column":33},"end":{"line":175,"column":43}},{"start":{"line":175,"column":47},"end":{"line":175,"column":49}}],"line":175},"23":{"loc":{"start":{"line":177,"column":33},"end":{"line":177,"column":49}},"type":"binary-expr","locations":[{"start":{"line":177,"column":33},"end":{"line":177,"column":43}},{"start":{"line":177,"column":47},"end":{"line":177,"column":49}}],"line":177},"24":{"loc":{"start":{"line":209,"column":4},"end":{"line":211,"column":5}},"type":"if","locations":[{"start":{"line":209,"column":4},"end":{"line":211,"column":5}},{"start":{},"end":{}}],"line":209},"25":{"loc":{"start":{"line":214,"column":60},"end":{"line":214,"column":75}},"type":"binary-expr","locations":[{"start":{"line":214,"column":60},"end":{"line":214,"column":70}},{"start":{"line":214,"column":74},"end":{"line":214,"column":75}}],"line":214},"26":{"loc":{"start":{"line":214,"column":80},"end":{"line":214,"column":95}},"type":"binary-expr","locations":[{"start":{"line":214,"column":80},"end":{"line":214,"column":90}},{"start":{"line":214,"column":94},"end":{"line":214,"column":95}}],"line":214},"27":{"loc":{"start":{"line":216,"column":4},"end":{"line":237,"column":5}},"type":"if","locations":[{"start":{"line":216,"column":4},"end":{"line":237,"column":5}},{"start":{"line":234,"column":11},"end":{"line":237,"column":5}}],"line":216},"28":{"loc":{"start":{"line":222,"column":43},"end":{"line":222,"column":66}},"type":"binary-expr","locations":[{"start":{"line":222,"column":43},"end":{"line":222,"column":51}},{"start":{"line":222,"column":55},"end":{"line":222,"column":66}}],"line":222},"29":{"loc":{"start":{"line":226,"column":43},"end":{"line":226,"column":66}},"type":"binary-expr","locations":[{"start":{"line":226,"column":43},"end":{"line":226,"column":51}},{"start":{"line":226,"column":55},"end":{"line":226,"column":66}}],"line":226},"30":{"loc":{"start":{"line":240,"column":23},"end":{"line":240,"column":69}},"type":"cond-expr","locations":[{"start":{"line":240,"column":43},"end":{"line":240,"column":47}},{"start":{"line":240,"column":50},"end":{"line":240,"column":69}}],"line":240},"31":{"loc":{"start":{"line":241,"column":16},"end":{"line":241,"column":34}},"type":"binary-expr","locations":[{"start":{"line":241,"column":16},"end":{"line":241,"column":20}},{"start":{"line":241,"column":24},"end":{"line":241,"column":34}}],"line":241},"32":{"loc":{"start":{"line":243,"column":4},"end":{"line":250,"column":5}},"type":"if","locations":[{"start":{"line":243,"column":4},"end":{"line":250,"column":5}},{"start":{},"end":{}}],"line":243},"33":{"loc":{"start":{"line":243,"column":8},"end":{"line":243,"column":44}},"type":"binary-expr","locations":[{"start":{"line":243,"column":8},"end":{"line":243,"column":17}},{"start":{"line":243,"column":21},"end":{"line":243,"column":44}}],"line":243},"34":{"loc":{"start":{"line":245,"column":6},"end":{"line":247,"column":7}},"type":"if","locations":[{"start":{"line":245,"column":6},"end":{"line":247,"column":7}},{"start":{},"end":{}}],"line":245},"35":{"loc":{"start":{"line":245,"column":10},"end":{"line":245,"column":32}},"type":"binary-expr","locations":[{"start":{"line":245,"column":10},"end":{"line":245,"column":22}},{"start":{"line":245,"column":26},"end":{"line":245,"column":32}}],"line":245},"36":{"loc":{"start":{"line":248,"column":37},"end":{"line":248,"column":55}},"type":"binary-expr","locations":[{"start":{"line":248,"column":37},"end":{"line":248,"column":49}},{"start":{"line":248,"column":53},"end":{"line":248,"column":55}}],"line":248},"37":{"loc":{"start":{"line":304,"column":4},"end":{"line":307,"column":5}},"type":"if","locations":[{"start":{"line":304,"column":4},"end":{"line":307,"column":5}},{"start":{},"end":{}}],"line":304},"38":{"loc":{"start":{"line":312,"column":4},"end":{"line":315,"column":5}},"type":"if","locations":[{"start":{"line":312,"column":4},"end":{"line":315,"column":5}},{"start":{},"end":{}}],"line":312}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":2,"19":2,"20":2,"21":2,"22":2,"23":0,"24":2,"25":0,"26":0,"27":0,"28":0,"29":2,"30":0,"31":2,"32":0,"33":2,"34":0,"35":2,"36":2,"37":2,"38":2,"39":2,"40":2,"41":2,"42":2,"43":2,"44":2,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":4,"52":0,"53":4,"54":4,"55":2,"56":4,"57":0,"58":2,"59":4,"60":2,"61":4,"62":4,"63":4,"64":4,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":2,"85":0,"86":2,"87":0,"88":2,"89":0,"90":2,"91":2,"92":0,"93":2,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":2,"107":2,"108":2,"109":2,"110":2,"111":2,"112":0,"113":2,"114":2,"115":2,"116":2,"117":2,"118":2,"119":2,"120":2,"121":2,"122":2,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":3,"131":3,"132":3,"133":3,"134":3,"135":3,"136":0,"137":3,"138":3,"139":3,"140":2,"141":2,"142":2,"143":2,"144":2,"145":2,"146":2,"147":2,"148":2,"149":0,"150":0,"151":2,"152":3,"153":2,"154":2,"155":2,"156":0,"157":2,"158":0,"159":0,"160":2,"161":0,"162":2,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":1,"174":2},"f":{"0":1,"1":1,"2":1,"3":2,"4":2,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":4,"13":2,"14":0,"15":2,"16":4,"17":4,"18":4,"19":4,"20":4,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":2,"32":0,"33":0,"34":2,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":2,"46":0,"47":2,"48":2,"49":0,"50":0,"51":3,"52":2,"53":2,"54":2,"55":0,"56":3,"57":2,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":2},"b":{"0":[0,1],"1":[0,1],"2":[1,0],"3":[1,1],"4":[0,1],"5":[0,1],"6":[1,0],"7":[0,0],"8":[0,4],"9":[2,2],"10":[2,2],"11":[4,2],"12":[4,2],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,2],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[2,0],"25":[0,0],"26":[0,0],"27":[2,0],"28":[2,0],"29":[2,0],"30":[3,0],"31":[3,3],"32":[3,0],"33":[3,2],"34":[0,3],"35":[3,0],"36":[3,3],"37":[0,0],"38":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/sheet-interceptor/sheet-interceptor.service.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable ts/no-explicit-any */\n\nimport type {\n    ICellData,\n    ICellDataForSheetInterceptor,\n    ICellInterceptor,\n    ICommandInfo,\n    IComposeInterceptors,\n    IDisposable,\n    IInterceptor,\n    IRange,\n    IUndoRedoCommandInfosByInterceptor,\n    Nullable,\n    Workbook,\n    Worksheet,\n} from '@univerjs/core';\nimport type { ISheetLocation } from './utils/interceptor';\n\nimport {\n    composeInterceptors,\n    createInterceptorKey,\n    Disposable,\n    DisposableCollection,\n    InterceptorEffectEnum,\n    InterceptorManager,\n    IUniverInstanceService,\n    remove,\n    toDisposable,\n    Tools,\n    UniverInstanceType,\n} from '@univerjs/core';\nimport { INTERCEPTOR_POINT } from './interceptor-const';\n\nexport interface IBeforeCommandInterceptor {\n    priority?: number;\n    performCheck(info: ICommandInfo): Promise<boolean>;\n}\n\nexport interface ICommandInterceptor {\n    priority?: number;\n    getMutations(command: ICommandInfo): IUndoRedoCommandInfosByInterceptor;\n}\n\nexport interface IRangesInfo {\n    unitId: string;\n    subUnitId: string;\n    ranges: IRange[];\n}\n\nexport interface IRangeInterceptors {\n    priority?: number;\n    getMutations(rangesInfo: IRangesInfo): IUndoRedoCommandInfosByInterceptor;\n}\n\ninterface ISheetLocationForEditor extends ISheetLocation {\n    origin: Nullable<ICellData>;\n}\n\nexport const BEFORE_CELL_EDIT = createInterceptorKey<ICellDataForSheetInterceptor, ISheetLocationForEditor>('BEFORE_CELL_EDIT');\nexport const AFTER_CELL_EDIT = createInterceptorKey<ICellDataForSheetInterceptor, ISheetLocationForEditor>('AFTER_CELL_EDIT');\nexport const VALIDATE_CELL = createInterceptorKey<Promise<boolean>, ISheetLocation>('VALIDATE_CELL');\n\n/**\n * This class expose methods for sheet features to inject code to sheet underlying logic.\n */\nexport class SheetInterceptorService extends Disposable {\n    private _interceptorsByName: Map<string, Array<IInterceptor<unknown, unknown>>> = new Map();\n    private _commandInterceptors: ICommandInterceptor[] = [];\n    private _rangeInterceptors: IRangeInterceptors[] = [];\n\n    private _beforeCommandInterceptor: IBeforeCommandInterceptor[] = [];\n    private _afterCommandInterceptors: ICommandInterceptor[] = [];\n\n    private readonly _workbookDisposables = new Map<string, IDisposable>();\n    private readonly _worksheetDisposables = new Map<string, IDisposable>();\n\n    private _interceptorsDirty = false;\n    private _composedInterceptorByKey: Map<string, ReturnType<IComposeInterceptors<any, any>>> = new Map();\n\n    readonly writeCellInterceptor = new InterceptorManager({\n        BEFORE_CELL_EDIT,\n        AFTER_CELL_EDIT,\n        VALIDATE_CELL,\n    });\n\n    /** @ignore */\n    constructor(\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService\n    ) {\n        super();\n\n        // When a workbook is created or a worksheet is added after when workbook is created,\n        // `SheetInterceptorService` inject interceptors to worksheet instances to it.\n        this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$<Workbook>(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) => {\n            this._interceptWorkbook(workbook);\n        }));\n\n        this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$<Workbook>(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) =>\n            this._disposeWorkbookInterceptor(workbook)\n        ));\n\n        // register default viewModel interceptor\n        this.intercept(INTERCEPTOR_POINT.CELL_CONTENT, {\n            priority: -1,\n            effect: InterceptorEffectEnum.Style | InterceptorEffectEnum.Value,\n            handler(value, context): Nullable<ICellData> {\n                const rawData = context.worksheet.getCellRaw(context.row, context.col);\n                if (value) {\n                    return { ...rawData, ...value };\n                }\n\n                return rawData;\n            },\n        });\n\n        this.disposeWithMe(this.writeCellInterceptor.intercept(AFTER_CELL_EDIT, {\n            priority: -1,\n            handler: (_value) => _value,\n        }));\n\n        this.disposeWithMe(this.writeCellInterceptor.intercept(BEFORE_CELL_EDIT, {\n            priority: -1,\n            handler: (_value) => _value,\n        }));\n\n        this.disposeWithMe(this.writeCellInterceptor.intercept(VALIDATE_CELL, {\n            priority: -1,\n            handler: (_value) => _value,\n        }));\n    }\n\n    override dispose(): void {\n        super.dispose();\n\n        this._workbookDisposables.forEach((disposable) => disposable.dispose());\n        this._workbookDisposables.clear();\n        this._worksheetDisposables.clear();\n\n        this._interceptorsByName.clear();\n    }\n\n    // #region intercept command execution\n\n    /**\n     * Add a listener function to a specific command to add affiliated mutations. It should be called in controllers.\n     *\n     * Pairs with {@link onCommandExecute}.\n     *\n     * @param interceptor\n     * @returns\n     */\n    interceptCommand(interceptor: ICommandInterceptor): IDisposable {\n        if (this._commandInterceptors.includes(interceptor)) {\n            throw new Error('[SheetInterceptorService]: Interceptor already exists!');\n        }\n\n        this._commandInterceptors.push(interceptor);\n        this._commandInterceptors.sort((a, b) => (b.priority ?? 0) - (a.priority ?? 0));\n\n        return this.disposeWithMe(toDisposable(() => remove(this._commandInterceptors, interceptor)));\n    }\n\n    /**\n     * When command is executing, call this method to gether undo redo mutations from upper features.\n     * @param command\n     * @returns\n     */\n    onCommandExecute(info: ICommandInfo): IUndoRedoCommandInfosByInterceptor {\n        const infos = this._commandInterceptors.map((i) => i.getMutations(info));\n\n        return {\n            preUndos: infos.map((i) => i.preUndos ?? []).flat(),\n            undos: infos.map((i) => i.undos).flat(),\n            preRedos: infos.map((i) => i.preRedos ?? []).flat(),\n            redos: infos.map((i) => i.redos).flat(),\n        };\n    }\n\n    interceptAfterCommand(interceptor: ICommandInterceptor): IDisposable {\n        if (this._afterCommandInterceptors.includes(interceptor)) {\n            throw new Error('[SheetInterceptorService]: Interceptor already exists!');\n        }\n\n        this._afterCommandInterceptors.push(interceptor);\n        this._afterCommandInterceptors.sort((a, b) => (b.priority ?? 0) - (a.priority ?? 0));\n\n        return this.disposeWithMe(toDisposable(() => remove(this._afterCommandInterceptors, interceptor)));\n    }\n\n    afterCommandExecute(info: ICommandInfo): IUndoRedoCommandInfosByInterceptor {\n        const infos = this._afterCommandInterceptors.map((i) => i.getMutations(info));\n\n        return {\n            undos: infos.map((i) => i.undos).flat(),\n            redos: infos.map((i) => i.redos).flat(),\n        };\n    }\n\n    /**\n     * Add a listener function to a specific command to determine if the command can execute mutations. It should be\n     * called in controllers.\n     *\n     * Pairs with {@link beforeCommandExecute}.\n     *\n     * @param interceptor\n     * @returns\n     */\n    interceptBeforeCommand(interceptor: IBeforeCommandInterceptor): IDisposable {\n        if (this._beforeCommandInterceptor.includes(interceptor)) {\n            throw new Error('[SheetInterceptorService]: Interceptor already exists!');\n        }\n\n        this._beforeCommandInterceptor.push(interceptor);\n        this._beforeCommandInterceptor.sort((a, b) => (b.priority ?? 0) - (a.priority ?? 0));\n\n        return this.disposeWithMe(toDisposable(() => remove(this._beforeCommandInterceptor, interceptor)));\n    }\n\n    /**\n     * before command execute, call this method to get the flag of whether it can be executed the command\n     * @param info ICommandInfo\n     * @returns Promise<boolean>\n     */\n    async beforeCommandExecute(info: ICommandInfo): Promise<boolean> {\n        const allPerformCheckRes = await Promise.all(this._beforeCommandInterceptor.map((i) => i.performCheck(info)));\n        return allPerformCheckRes.every((perform) => perform);\n    }\n\n    // #endregion\n\n    // #region intercept ranges - mainly for pivot table currently (2024/10/28).\n\n    /**\n     * By adding callbacks to some Ranges can get some additional mutations, such as clearing all plugin data in a certain area.\n     * @param interceptor IRangeInterceptors\n     * @returns IDisposable\n     */\n    interceptRanges(interceptor: IRangeInterceptors): IDisposable {\n        if (this._rangeInterceptors.includes(interceptor)) {\n            throw new Error('[SheetInterceptorService]: Interceptor already exists!');\n        }\n\n        this._rangeInterceptors.push(interceptor);\n        this._rangeInterceptors.sort((a, b) => (b.priority ?? 0) - (a.priority ?? 0));\n\n        return this.disposeWithMe(toDisposable(() => remove(this._rangeInterceptors, interceptor)));\n    }\n\n    generateMutationsByRanges(info: IRangesInfo): IUndoRedoCommandInfosByInterceptor {\n        const infos = this._rangeInterceptors.map((i) => i.getMutations(info));\n\n        return {\n            preUndos: infos.map((i) => i.preUndos ?? []).flat(),\n            undos: infos.map((i) => i.undos).flat(),\n            preRedos: infos.map((i) => i.preRedos ?? []).flat(),\n            redos: infos.map((i) => i.redos).flat(),\n        };\n    }\n\n    // #endregion\n\n    // #region intercept on writing cell\n\n    onWriteCell(workbook: Workbook, worksheet: Worksheet, row: number, col: number, cellData: ICellData) {\n        const context = {\n            subUnitId: worksheet.getSheetId(),\n            unitId: workbook.getUnitId(),\n            workbook: workbook!,\n            worksheet,\n            row,\n            col,\n            origin: Tools.deepClone(cellData),\n        };\n\n        return this.writeCellInterceptor.fetchThroughInterceptors(AFTER_CELL_EDIT)(cellData, context);\n    }\n\n    // #endregion\n\n    onValidateCell(workbook: Workbook, worksheet: Worksheet, row: number, col: number) {\n        const context: ISheetLocation = {\n            subUnitId: worksheet.getSheetId(),\n            unitId: workbook.getUnitId(),\n            workbook: workbook!,\n            worksheet,\n            row,\n            col,\n        };\n\n        return this.writeCellInterceptor.fetchThroughInterceptors(VALIDATE_CELL)(Promise.resolve(true), context);\n    }\n\n    intercept<T extends IInterceptor<any, any>>(name: T, interceptor: T): IDisposable {\n        const key = name as unknown as string;\n        if (!this._interceptorsByName.has(key)) {\n            this._interceptorsByName.set(key, []);\n        }\n\n        const interceptors = this._interceptorsByName.get(key)!;\n        interceptors.push(interceptor);\n        const sortedInterceptors = interceptors.sort((a, b) => (b.priority ?? 0) - (a.priority ?? 0));\n\n        this._interceptorsDirty = true;\n\n        if (key === INTERCEPTOR_POINT.CELL_CONTENT as unknown as string) {\n            const JOINED_EFFECT = InterceptorEffectEnum.Style | InterceptorEffectEnum.Value;\n            this._interceptorsByName.set(`${key}-${JOINED_EFFECT}`, sortedInterceptors);\n\n            const BOTH_EFFECT = InterceptorEffectEnum.Style | InterceptorEffectEnum.Value;\n            this._interceptorsByName.set(\n                `${key}-${(InterceptorEffectEnum.Style)}`,\n                (sortedInterceptors as ICellInterceptor<unknown, unknown>[]).filter((i) => ((i.effect || BOTH_EFFECT) & InterceptorEffectEnum.Style) > 0)\n            );\n            this._interceptorsByName.set(\n                `${key}-${(InterceptorEffectEnum.Value)}`,\n                (sortedInterceptors as ICellInterceptor<unknown, unknown>[]).filter((i) => ((i.effect || BOTH_EFFECT) & InterceptorEffectEnum.Value) > 0)\n            );\n\n            return this.disposeWithMe(toDisposable(() => {\n                remove(this._interceptorsByName.get(key)!, interceptor);\n                remove(this._interceptorsByName.get(`${key}-${JOINED_EFFECT}`)!, interceptor);\n                remove(this._interceptorsByName.get(`${key}-${(InterceptorEffectEnum.Style)}`)!, interceptor);\n                remove(this._interceptorsByName.get(`${key}-${(InterceptorEffectEnum.Value)}`)!, interceptor);\n            }));\n        } else {\n            this._interceptorsByName.set(key, sortedInterceptors);\n            return this.disposeWithMe(toDisposable(() => remove(this._interceptorsByName.get(key)!, interceptor)));\n        }\n    }\n\n    fetchThroughInterceptors<T, C>(\n        name: IInterceptor<T, C>,\n        effect?: InterceptorEffectEnum,\n        _key?: string,\n        filter?: (interceptor: IInterceptor<any, any>) => boolean\n    ): ReturnType<IComposeInterceptors<T, C>> {\n        const byNamesKey = effect === undefined ? name as unknown as string : `${name as unknown as string}-${effect}`;\n        const key = _key ?? byNamesKey;\n        let composed = this._composedInterceptorByKey.get(key);\n\n        if (!composed || this._interceptorsDirty) {\n            let interceptors = this._interceptorsByName.get(byNamesKey) as unknown as Array<IInterceptor<any, any>> | undefined;\n            if (interceptors && filter) {\n                interceptors = interceptors.filter(filter);\n            }\n\n            composed = composeInterceptors<T, C>(interceptors || []);\n            this._composedInterceptorByKey.set(key, composed);\n        }\n\n        return composed;\n    }\n\n    private _interceptWorkbook(workbook: Workbook): void {\n        const disposables = new DisposableCollection();\n        const unitId = workbook.getUnitId();\n\n        // eslint-disable-next-line ts/no-this-alias\n        const sheetInterceptorService = this;\n        const interceptViewModel = (worksheet: Worksheet): void => {\n            const subUnitId = worksheet.getSheetId();\n            worksheet.__interceptViewModel((viewModel) => {\n                const sheetDisposables = new DisposableCollection();\n                sheetInterceptorService._worksheetDisposables.set(getWorksheetDisposableID(unitId, worksheet), sheetDisposables);\n\n                sheetDisposables.add(viewModel.registerCellContentInterceptor({\n                    getCell(\n                        row: number,\n                        col: number,\n                        effect: InterceptorEffectEnum,\n                        key?: string,\n                        filter?: (interceptor: IInterceptor<any, any>) => boolean\n                    ): Nullable<ICellData> {\n                        const rawData = worksheet.getCellRaw(row, col);\n                        return sheetInterceptorService.fetchThroughInterceptors(INTERCEPTOR_POINT.CELL_CONTENT, effect, key, filter)(\n                            rawData,\n                            {\n                                unitId,\n                                subUnitId,\n                                row,\n                                col,\n                                worksheet,\n                                workbook,\n                                rawData,\n                            }\n                        );\n                    },\n                }));\n\n                sheetDisposables.add(viewModel.registerRowFilteredInterceptor({\n                    getRowFiltered(row: number): boolean {\n                        return !!sheetInterceptorService.fetchThroughInterceptors(INTERCEPTOR_POINT.ROW_FILTERED)(\n                            false,\n                            {\n                                unitId,\n                                subUnitId,\n                                row,\n                                workbook,\n                                worksheet,\n                            }\n                        );\n                    },\n                }));\n            });\n        };\n\n        // We should intercept all instantiated worksheet and should subscribe to\n        // worksheet creation event to intercept newly created worksheet.\n        workbook.getSheets().forEach((worksheet) => interceptViewModel(worksheet));\n        disposables.add(workbook.sheetCreated$.subscribe((worksheet) => interceptViewModel(worksheet)));\n\n        // Dispose all underlying interceptors when workbook is disposed.\n        disposables.add(toDisposable(() => workbook.getSheets().forEach((worksheet) => this._disposeSheetInterceptor(unitId, worksheet))));\n        // Dispose interceptor when a worksheet is destroyed.\n        disposables.add(workbook.sheetDisposed$.subscribe((worksheet) => this._disposeSheetInterceptor(unitId, worksheet)));\n\n        this._workbookDisposables.set(unitId, disposables);\n    }\n\n    private _disposeWorkbookInterceptor(workbook: Workbook): void {\n        const unitId = workbook.getUnitId();\n        const disposable = this._workbookDisposables.get(unitId);\n\n        if (disposable) {\n            disposable.dispose();\n            this._workbookDisposables.delete(unitId);\n        }\n    }\n\n    private _disposeSheetInterceptor(unitId: string, worksheet: Worksheet): void {\n        const disposableId = getWorksheetDisposableID(unitId, worksheet);\n        const disposable = this._worksheetDisposables.get(disposableId);\n\n        if (disposable) {\n            disposable.dispose();\n            this._worksheetDisposables.delete(disposableId);\n        }\n    }\n}\n\nfunction getWorksheetDisposableID(unitId: string, worksheet: Worksheet): string {\n    return `${unitId}|${worksheet.getSheetId()}`;\n}\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"e8fae290e776aad55f3370861ebfec9517e4fb57"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/cell-style.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/cell-style.ts","statementMap":{"0":{"start":{"line":3,"column":19},"end":{"line":3,"column":48}},"1":{"start":{"line":4,"column":2},"end":{"line":6,"column":3}},"2":{"start":{"line":5,"column":4},"end":{"line":5,"column":20}},"3":{"start":{"line":7,"column":2},"end":{"line":9,"column":3}},"4":{"start":{"line":8,"column":4},"end":{"line":8,"column":36}},"5":{"start":{"line":10,"column":16},"end":{"line":10,"column":64}},"6":{"start":{"line":11,"column":2},"end":{"line":18,"column":3}},"7":{"start":{"line":12,"column":4},"end":{"line":12,"column":28}},"8":{"start":{"line":13,"column":4},"end":{"line":17,"column":7}},"9":{"start":{"line":14,"column":6},"end":{"line":16,"column":7}},"10":{"start":{"line":15,"column":8},"end":{"line":15,"column":26}},"11":{"start":{"line":19,"column":2},"end":{"line":23,"column":3}},"12":{"start":{"line":20,"column":4},"end":{"line":20,"column":20}},"13":{"start":{"line":22,"column":4},"end":{"line":22,"column":38}},"14":{"start":{"line":24,"column":25},"end":{"line":25,"column":6}},"15":{"start":{"line":26,"column":2},"end":{"line":32,"column":3}},"16":{"start":{"line":27,"column":4},"end":{"line":31,"column":5}},"17":{"start":{"line":28,"column":6},"end":{"line":28,"column":22}},"18":{"start":{"line":30,"column":6},"end":{"line":30,"column":63}},"19":{"start":{"line":35,"column":2},"end":{"line":37,"column":3}},"20":{"start":{"line":36,"column":4},"end":{"line":36,"column":20}},"21":{"start":{"line":38,"column":22},"end":{"line":38,"column":36}},"22":{"start":{"line":39,"column":2},"end":{"line":45,"column":3}},"23":{"start":{"line":40,"column":4},"end":{"line":44,"column":5}},"24":{"start":{"line":41,"column":6},"end":{"line":41,"column":75}},"25":{"start":{"line":42,"column":11},"end":{"line":44,"column":5}},"26":{"start":{"line":43,"column":6},"end":{"line":43,"column":28}},"27":{"start":{"line":46,"column":2},"end":{"line":46,"column":21}},"28":{"start":{"line":49,"column":2},"end":{"line":51,"column":3}},"29":{"start":{"line":50,"column":4},"end":{"line":50,"column":22}},"30":{"start":{"line":52,"column":2},"end":{"line":56,"column":3}},"31":{"start":{"line":53,"column":4},"end":{"line":55,"column":5}},"32":{"start":{"line":54,"column":6},"end":{"line":54,"column":27}},"33":{"start":{"line":57,"column":2},"end":{"line":57,"column":20}},"34":{"start":{"line":60,"column":2},"end":{"line":60,"column":41}},"35":{"start":{"line":60,"column":25},"end":{"line":60,"column":41}},"36":{"start":{"line":61,"column":2},"end":{"line":61,"column":43}},"37":{"start":{"line":61,"column":27},"end":{"line":61,"column":43}},"38":{"start":{"line":62,"column":22},"end":{"line":62,"column":53}},"39":{"start":{"line":63,"column":2},"end":{"line":72,"column":3}},"40":{"start":{"line":64,"column":4},"end":{"line":66,"column":5}},"41":{"start":{"line":65,"column":6},"end":{"line":65,"column":15}},"42":{"start":{"line":67,"column":4},"end":{"line":71,"column":5}},"43":{"start":{"line":68,"column":6},"end":{"line":68,"column":66}},"44":{"start":{"line":70,"column":6},"end":{"line":70,"column":35}},"45":{"start":{"line":73,"column":2},"end":{"line":83,"column":3}},"46":{"start":{"line":74,"column":4},"end":{"line":76,"column":5}},"47":{"start":{"line":75,"column":6},"end":{"line":75,"column":41}},"48":{"start":{"line":77,"column":4},"end":{"line":79,"column":5}},"49":{"start":{"line":78,"column":6},"end":{"line":78,"column":41}},"50":{"start":{"line":80,"column":4},"end":{"line":82,"column":5}},"51":{"start":{"line":81,"column":6},"end":{"line":81,"column":41}},"52":{"start":{"line":84,"column":2},"end":{"line":84,"column":21}},"53":{"start":{"line":87,"column":2},"end":{"line":89,"column":3}},"54":{"start":{"line":87,"column":29},"end":{"line":87,"column":52}},"55":{"start":{"line":88,"column":4},"end":{"line":88,"column":50}},"56":{"start":{"line":90,"column":2},"end":{"line":90,"column":16}},"57":{"start":{"line":93,"column":2},"end":{"line":95,"column":3}},"58":{"start":{"line":94,"column":4},"end":{"line":94,"column":11}},"59":{"start":{"line":96,"column":2},"end":{"line":98,"column":3}},"60":{"start":{"line":97,"column":4},"end":{"line":97,"column":25}},"61":{"start":{"line":99,"column":14},"end":{"line":99,"column":15}},"62":{"start":{"line":100,"column":22},"end":{"line":100,"column":24}},"63":{"start":{"line":101,"column":21},"end":{"line":101,"column":45}},"64":{"start":{"line":102,"column":2},"end":{"line":125,"column":3}},"65":{"start":{"line":103,"column":32},"end":{"line":103,"column":39}},"66":{"start":{"line":104,"column":4},"end":{"line":115,"column":5}},"67":{"start":{"line":105,"column":17},"end":{"line":108,"column":7}},"68":{"start":{"line":109,"column":21},"end":{"line":109,"column":51}},"69":{"start":{"line":110,"column":6},"end":{"line":110,"column":41}},"70":{"start":{"line":111,"column":6},"end":{"line":113,"column":7}},"71":{"start":{"line":112,"column":8},"end":{"line":112,"column":23}},"72":{"start":{"line":114,"column":6},"end":{"line":114,"column":27}},"73":{"start":{"line":116,"column":18},"end":{"line":116,"column":48}},"74":{"start":{"line":117,"column":4},"end":{"line":117,"column":37}},"75":{"start":{"line":118,"column":4},"end":{"line":122,"column":5}},"76":{"start":{"line":119,"column":6},"end":{"line":119,"column":24}},"77":{"start":{"line":121,"column":6},"end":{"line":121,"column":25}},"78":{"start":{"line":123,"column":4},"end":{"line":123,"column":30}},"79":{"start":{"line":124,"column":4},"end":{"line":124,"column":43}},"80":{"start":{"line":126,"column":19},"end":{"line":126,"column":111}},"81":{"start":{"line":127,"column":2},"end":{"line":138,"column":3}},"82":{"start":{"line":128,"column":15},"end":{"line":131,"column":5}},"83":{"start":{"line":132,"column":18},"end":{"line":132,"column":48}},"84":{"start":{"line":133,"column":4},"end":{"line":133,"column":37}},"85":{"start":{"line":134,"column":4},"end":{"line":136,"column":5}},"86":{"start":{"line":135,"column":6},"end":{"line":135,"column":20}},"87":{"start":{"line":137,"column":4},"end":{"line":137,"column":25}},"88":{"start":{"line":139,"column":2},"end":{"line":139,"column":51}}},"fnMap":{"0":{"name":"handleStyle","decl":{"start":{"line":2,"column":16},"end":{"line":2,"column":27}},"loc":{"start":{"line":2,"column":52},"end":{"line":33,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":13,"column":34},"end":{"line":13,"column":35}},"loc":{"start":{"line":13,"column":50},"end":{"line":17,"column":5}},"line":13},"2":{"name":"transformStyle","decl":{"start":{"line":34,"column":16},"end":{"line":34,"column":30}},"loc":{"start":{"line":34,"column":51},"end":{"line":47,"column":1}},"line":34},"3":{"name":"transformBorders","decl":{"start":{"line":48,"column":9},"end":{"line":48,"column":25}},"loc":{"start":{"line":48,"column":50},"end":{"line":58,"column":1}},"line":48},"4":{"name":"mergeStyle","decl":{"start":{"line":59,"column":9},"end":{"line":59,"column":19}},"loc":{"start":{"line":59,"column":60},"end":{"line":85,"column":1}},"line":59},"5":{"name":"skipParagraphs","decl":{"start":{"line":86,"column":9},"end":{"line":86,"column":23}},"loc":{"start":{"line":86,"column":44},"end":{"line":91,"column":1}},"line":86},"6":{"name":"(anonymous_6)","decl":{"start":{"line":87,"column":22},"end":{"line":87,"column":23}},"loc":{"start":{"line":87,"column":29},"end":{"line":87,"column":52}},"line":87},"7":{"name":"mergeRichTextStyle","decl":{"start":{"line":92,"column":9},"end":{"line":92,"column":27}},"loc":{"start":{"line":92,"column":41},"end":{"line":140,"column":1}},"line":92}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":2},"end":{"line":6,"column":3}},"type":"if","locations":[{"start":{"line":4,"column":2},"end":{"line":6,"column":3}},{"start":{},"end":{}}],"line":4},"1":{"loc":{"start":{"line":7,"column":2},"end":{"line":9,"column":3}},"type":"if","locations":[{"start":{"line":7,"column":2},"end":{"line":9,"column":3}},{"start":{},"end":{}}],"line":7},"2":{"loc":{"start":{"line":10,"column":37},"end":{"line":10,"column":63}},"type":"cond-expr","locations":[{"start":{"line":10,"column":48},"end":{"line":10,"column":56}},{"start":{"line":10,"column":59},"end":{"line":10,"column":63}}],"line":10},"3":{"loc":{"start":{"line":11,"column":2},"end":{"line":18,"column":3}},"type":"if","locations":[{"start":{"line":11,"column":2},"end":{"line":18,"column":3}},{"start":{},"end":{}}],"line":11},"4":{"loc":{"start":{"line":14,"column":6},"end":{"line":16,"column":7}},"type":"if","locations":[{"start":{"line":14,"column":6},"end":{"line":16,"column":7}},{"start":{},"end":{}}],"line":14},"5":{"loc":{"start":{"line":14,"column":10},"end":{"line":14,"column":82}},"type":"binary-expr","locations":[{"start":{"line":14,"column":10},"end":{"line":14,"column":33}},{"start":{"line":14,"column":37},"end":{"line":14,"column":49}},{"start":{"line":14,"column":53},"end":{"line":14,"column":82}}],"line":14},"6":{"loc":{"start":{"line":19,"column":2},"end":{"line":23,"column":3}},"type":"if","locations":[{"start":{"line":19,"column":2},"end":{"line":23,"column":3}},{"start":{"line":21,"column":9},"end":{"line":23,"column":3}}],"line":19},"7":{"loc":{"start":{"line":24,"column":25},"end":{"line":25,"column":6}},"type":"cond-expr","locations":[{"start":{"line":24,"column":36},"end":{"line":25,"column":1}},{"start":{"line":25,"column":4},"end":{"line":25,"column":6}}],"line":24},"8":{"loc":{"start":{"line":26,"column":2},"end":{"line":32,"column":3}},"type":"if","locations":[{"start":{"line":26,"column":2},"end":{"line":32,"column":3}},{"start":{},"end":{}}],"line":26},"9":{"loc":{"start":{"line":26,"column":6},"end":{"line":26,"column":27}},"type":"binary-expr","locations":[{"start":{"line":26,"column":6},"end":{"line":26,"column":15}},{"start":{"line":26,"column":19},"end":{"line":26,"column":27}}],"line":26},"10":{"loc":{"start":{"line":27,"column":4},"end":{"line":31,"column":5}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":31,"column":5}},{"start":{"line":29,"column":11},"end":{"line":31,"column":5}}],"line":27},"11":{"loc":{"start":{"line":27,"column":8},"end":{"line":27,"column":70}},"type":"binary-expr","locations":[{"start":{"line":27,"column":8},"end":{"line":27,"column":22}},{"start":{"line":27,"column":26},"end":{"line":27,"column":70}}],"line":27},"12":{"loc":{"start":{"line":30,"column":35},"end":{"line":30,"column":61}},"type":"cond-expr","locations":[{"start":{"line":30,"column":46},"end":{"line":30,"column":54}},{"start":{"line":30,"column":57},"end":{"line":30,"column":61}}],"line":30},"13":{"loc":{"start":{"line":35,"column":2},"end":{"line":37,"column":3}},"type":"if","locations":[{"start":{"line":35,"column":2},"end":{"line":37,"column":3}},{"start":{},"end":{}}],"line":35},"14":{"loc":{"start":{"line":35,"column":6},"end":{"line":35,"column":48}},"type":"binary-expr","locations":[{"start":{"line":35,"column":6},"end":{"line":35,"column":15}},{"start":{"line":35,"column":19},"end":{"line":35,"column":48}}],"line":35},"15":{"loc":{"start":{"line":38,"column":22},"end":{"line":38,"column":36}},"type":"binary-expr","locations":[{"start":{"line":38,"column":22},"end":{"line":38,"column":30}},{"start":{"line":38,"column":34},"end":{"line":38,"column":36}}],"line":38},"16":{"loc":{"start":{"line":40,"column":4},"end":{"line":44,"column":5}},"type":"if","locations":[{"start":{"line":40,"column":4},"end":{"line":44,"column":5}},{"start":{"line":42,"column":11},"end":{"line":44,"column":5}}],"line":40},"17":{"loc":{"start":{"line":41,"column":40},"end":{"line":41,"column":60}},"type":"binary-expr","locations":[{"start":{"line":41,"column":40},"end":{"line":41,"column":54}},{"start":{"line":41,"column":58},"end":{"line":41,"column":60}}],"line":41},"18":{"loc":{"start":{"line":42,"column":11},"end":{"line":44,"column":5}},"type":"if","locations":[{"start":{"line":42,"column":11},"end":{"line":44,"column":5}},{"start":{},"end":{}}],"line":42},"19":{"loc":{"start":{"line":49,"column":2},"end":{"line":51,"column":3}},"type":"if","locations":[{"start":{"line":49,"column":2},"end":{"line":51,"column":3}},{"start":{},"end":{}}],"line":49},"20":{"loc":{"start":{"line":49,"column":6},"end":{"line":49,"column":52}},"type":"binary-expr","locations":[{"start":{"line":49,"column":6},"end":{"line":49,"column":17}},{"start":{"line":49,"column":21},"end":{"line":49,"column":52}}],"line":49},"21":{"loc":{"start":{"line":53,"column":4},"end":{"line":55,"column":5}},"type":"if","locations":[{"start":{"line":53,"column":4},"end":{"line":55,"column":5}},{"start":{},"end":{}}],"line":53},"22":{"loc":{"start":{"line":59,"column":40},"end":{"line":59,"column":58}},"type":"default-arg","locations":[{"start":{"line":59,"column":53},"end":{"line":59,"column":58}}],"line":59},"23":{"loc":{"start":{"line":60,"column":2},"end":{"line":60,"column":41}},"type":"if","locations":[{"start":{"line":60,"column":2},"end":{"line":60,"column":41}},{"start":{},"end":{}}],"line":60},"24":{"loc":{"start":{"line":61,"column":2},"end":{"line":61,"column":43}},"type":"if","locations":[{"start":{"line":61,"column":2},"end":{"line":61,"column":43}},{"start":{},"end":{}}],"line":61},"25":{"loc":{"start":{"line":62,"column":22},"end":{"line":62,"column":53}},"type":"binary-expr","locations":[{"start":{"line":62,"column":22},"end":{"line":62,"column":47}},{"start":{"line":62,"column":51},"end":{"line":62,"column":53}}],"line":62},"26":{"loc":{"start":{"line":64,"column":4},"end":{"line":66,"column":5}},"type":"if","locations":[{"start":{"line":64,"column":4},"end":{"line":66,"column":5}},{"start":{},"end":{}}],"line":64},"27":{"loc":{"start":{"line":64,"column":8},"end":{"line":64,"column":82}},"type":"binary-expr","locations":[{"start":{"line":64,"column":8},"end":{"line":64,"column":18}},{"start":{"line":64,"column":22},"end":{"line":64,"column":82}}],"line":64},"28":{"loc":{"start":{"line":67,"column":4},"end":{"line":71,"column":5}},"type":"if","locations":[{"start":{"line":67,"column":4},"end":{"line":71,"column":5}},{"start":{"line":69,"column":11},"end":{"line":71,"column":5}}],"line":67},"29":{"loc":{"start":{"line":67,"column":8},"end":{"line":67,"column":38}},"type":"binary-expr","locations":[{"start":{"line":67,"column":8},"end":{"line":67,"column":24}},{"start":{"line":67,"column":28},"end":{"line":67,"column":38}}],"line":67},"30":{"loc":{"start":{"line":73,"column":2},"end":{"line":83,"column":3}},"type":"if","locations":[{"start":{"line":73,"column":2},"end":{"line":83,"column":3}},{"start":{},"end":{}}],"line":73},"31":{"loc":{"start":{"line":74,"column":4},"end":{"line":76,"column":5}},"type":"if","locations":[{"start":{"line":74,"column":4},"end":{"line":76,"column":5}},{"start":{},"end":{}}],"line":74},"32":{"loc":{"start":{"line":74,"column":8},"end":{"line":74,"column":45}},"type":"binary-expr","locations":[{"start":{"line":74,"column":8},"end":{"line":74,"column":27}},{"start":{"line":74,"column":31},"end":{"line":74,"column":45}}],"line":74},"33":{"loc":{"start":{"line":77,"column":4},"end":{"line":79,"column":5}},"type":"if","locations":[{"start":{"line":77,"column":4},"end":{"line":79,"column":5}},{"start":{},"end":{}}],"line":77},"34":{"loc":{"start":{"line":77,"column":8},"end":{"line":77,"column":45}},"type":"binary-expr","locations":[{"start":{"line":77,"column":8},"end":{"line":77,"column":27}},{"start":{"line":77,"column":31},"end":{"line":77,"column":45}}],"line":77},"35":{"loc":{"start":{"line":80,"column":4},"end":{"line":82,"column":5}},"type":"if","locations":[{"start":{"line":80,"column":4},"end":{"line":82,"column":5}},{"start":{},"end":{}}],"line":80},"36":{"loc":{"start":{"line":80,"column":8},"end":{"line":80,"column":45}},"type":"binary-expr","locations":[{"start":{"line":80,"column":8},"end":{"line":80,"column":27}},{"start":{"line":80,"column":31},"end":{"line":80,"column":45}}],"line":80},"37":{"loc":{"start":{"line":87,"column":2},"end":{"line":89,"column":3}},"type":"if","locations":[{"start":{"line":87,"column":2},"end":{"line":89,"column":3}},{"start":{},"end":{}}],"line":87},"38":{"loc":{"start":{"line":93,"column":2},"end":{"line":95,"column":3}},"type":"if","locations":[{"start":{"line":93,"column":2},"end":{"line":95,"column":3}},{"start":{},"end":{}}],"line":93},"39":{"loc":{"start":{"line":96,"column":2},"end":{"line":98,"column":3}},"type":"if","locations":[{"start":{"line":96,"column":2},"end":{"line":98,"column":3}},{"start":{},"end":{}}],"line":96},"40":{"loc":{"start":{"line":101,"column":21},"end":{"line":101,"column":45}},"type":"binary-expr","locations":[{"start":{"line":101,"column":21},"end":{"line":101,"column":39}},{"start":{"line":101,"column":43},"end":{"line":101,"column":45}}],"line":101},"41":{"loc":{"start":{"line":103,"column":20},"end":{"line":103,"column":27}},"type":"default-arg","locations":[{"start":{"line":103,"column":25},"end":{"line":103,"column":27}}],"line":103},"42":{"loc":{"start":{"line":104,"column":4},"end":{"line":115,"column":5}},"type":"if","locations":[{"start":{"line":104,"column":4},"end":{"line":115,"column":5}},{"start":{},"end":{}}],"line":104},"43":{"loc":{"start":{"line":110,"column":6},"end":{"line":110,"column":40}},"type":"binary-expr","locations":[{"start":{"line":110,"column":6},"end":{"line":110,"column":12}},{"start":{"line":110,"column":16},"end":{"line":110,"column":40}}],"line":110},"44":{"loc":{"start":{"line":111,"column":6},"end":{"line":113,"column":7}},"type":"if","locations":[{"start":{"line":111,"column":6},"end":{"line":113,"column":7}},{"start":{},"end":{}}],"line":111},"45":{"loc":{"start":{"line":117,"column":4},"end":{"line":117,"column":36}},"type":"binary-expr","locations":[{"start":{"line":117,"column":4},"end":{"line":117,"column":9}},{"start":{"line":117,"column":13},"end":{"line":117,"column":36}}],"line":117},"46":{"loc":{"start":{"line":118,"column":4},"end":{"line":122,"column":5}},"type":"if","locations":[{"start":{"line":118,"column":4},"end":{"line":122,"column":5}},{"start":{"line":120,"column":11},"end":{"line":122,"column":5}}],"line":118},"47":{"loc":{"start":{"line":126,"column":19},"end":{"line":126,"column":111}},"type":"cond-expr","locations":[{"start":{"line":126,"column":56},"end":{"line":126,"column":84}},{"start":{"line":126,"column":87},"end":{"line":126,"column":111}}],"line":126},"48":{"loc":{"start":{"line":127,"column":2},"end":{"line":138,"column":3}},"type":"if","locations":[{"start":{"line":127,"column":2},"end":{"line":138,"column":3}},{"start":{},"end":{}}],"line":127},"49":{"loc":{"start":{"line":133,"column":4},"end":{"line":133,"column":36}},"type":"binary-expr","locations":[{"start":{"line":133,"column":4},"end":{"line":133,"column":9}},{"start":{"line":133,"column":13},"end":{"line":133,"column":36}}],"line":133},"50":{"loc":{"start":{"line":134,"column":4},"end":{"line":136,"column":5}},"type":"if","locations":[{"start":{"line":134,"column":4},"end":{"line":136,"column":5}},{"start":{},"end":{}}],"line":134}},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4,"7":0,"8":0,"9":0,"10":0,"11":4,"12":4,"13":0,"14":4,"15":4,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":4,"35":4,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0},"f":{"0":4,"1":0,"2":0,"3":0,"4":4,"5":0,"6":0,"7":0},"b":{"0":[4,0],"1":[4,0],"2":[0,4],"3":[0,4],"4":[0,0],"5":[0,0,0],"6":[4,0],"7":[4,0],"8":[0,4],"9":[4,4],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[4],"23":[4,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/cell-style.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IBorderData, ICellData, IDocumentData, IKeyValue, IParagraph, IStyleData, ITextRun, ITextStyle, Nullable, Styles } from '@univerjs/core';\nimport { normalizeTextRuns, Tools } from '@univerjs/core';\n\n/**\n *\n * @param styles\n * @param oldVal\n * @param newVal\n */\nexport function handleStyle(styles: Styles, oldVal: ICellData, newVal: ICellData) {\n    // use null to clear style\n    const oldStyle = styles.getStyleByCell(oldVal);\n\n    if (oldStyle == null) {\n        // clear\n        delete oldVal.s;\n    }\n\n    if (typeof newVal.s === 'string') {\n        newVal.s = styles.get(newVal.s);\n    }\n\n    // set style\n    const merge = mergeStyle(oldStyle, newVal.s ? (newVal.s as Nullable<IStyleData>) : null);\n\n    // then remove null\n    if (merge) {\n        Tools.removeNull(merge);\n\n        // remove empty object\n        Object.entries(merge).forEach(([key, val]) => {\n            if (typeof val === 'object' && val !== null && Object.keys(val).length === 0) {\n                delete merge[key as keyof IStyleData];\n            }\n        });\n    }\n\n    if (Tools.isEmptyObject(merge)) {\n        delete oldVal.s;\n    } else {\n        oldVal.s = styles.setValue(merge);\n    }\n\n    const newValueStream = newVal.v ? `${newVal.v}\\r\\n` : '';\n    // Only need to copy newValue.s to oldValue.p when you modify the cell style, not when you modify the cell value.\n    if (!newVal.p && oldVal.p) {\n        if (newValueStream && newValueStream !== oldVal.p.body?.dataStream) {\n            delete oldVal.p;\n        } else {\n            mergeRichTextStyle(oldVal.p, newVal.s ? (newVal.s as Nullable<IStyleData>) : null);\n        }\n    }\n}\n\n/**\n * Convert old style data for storage\n * @param style\n * @param oldStyle\n * @param newStyle\n */\nexport function transformStyle(oldStyle: Nullable<IStyleData>, newStyle: Nullable<IStyleData>): Nullable<IStyleData> {\n    // If there is no newly set style, directly store the historical style\n    if (!newStyle || !Object.keys(newStyle).length) {\n        return oldStyle;\n    }\n    const backupStyle: Record<string, any> = oldStyle || {};\n\n    for (const k in newStyle) {\n        if (k === 'bd') {\n            backupStyle[k] = transformBorders(backupStyle[k] || {}, newStyle[k]);\n        }\n        // 1. To modify the existing style,we need original setting to undo\n        // 2. Newly set the style, we need null to undo\n        else if (!(k in backupStyle)) {\n            backupStyle[k] = null;\n        }\n    }\n    return backupStyle;\n}\n\n/**\n * Convert old style border for storage\n * @param style\n * @param oldBorders\n * @param newBorders\n */\nfunction transformBorders(oldBorders: IBorderData, newBorders: Nullable<IBorderData>): IBorderData {\n    // If there is no newly set border, directly store the historical border\n    if (!newBorders || !Object.keys(newBorders).length) {\n        return oldBorders;\n    }\n\n    for (const k in newBorders) {\n        // 1. To modify the existing border,we need original setting to undo\n        // 2. Newly set the border, we need null to undo\n        if (!(k in oldBorders)) {\n            (oldBorders as IKeyValue)[k] = null;\n        }\n    }\n\n    return oldBorders;\n}\n\n/**\n * merge new style to old style\n * @param oldStyle\n * @param newStyle\n * @param isRichText\n */\nfunction mergeStyle(\n    oldStyle: Nullable<IStyleData>,\n    newStyle: Nullable<IStyleData>,\n    isRichText: boolean = false\n): Nullable<IStyleData> {\n    // clear style\n    if (newStyle === null) return newStyle;\n    // don't operate\n    if (newStyle === undefined) return oldStyle;\n\n    const backupStyle: Record<string, any> = Tools.deepClone(oldStyle) || {};\n\n    for (const k in newStyle) {\n        // Do not copy cell background color to rich text background color.\n        if (isRichText && ['bd', 'tr', 'td', 'ht', 'vt', 'tb', 'pd', 'bg'].includes(k)) {\n            continue;\n        }\n        // you can only choose one of the themeColor and rgbColor of the border setting\n        if (k in backupStyle && k === 'bd') {\n            backupStyle[k] = Object.assign(backupStyle[k], newStyle[k]);\n        } else {\n            backupStyle[k] = (newStyle as IKeyValue)[k];\n        }\n    }\n\n    if ('cl' in backupStyle) {\n        if ('ul' in backupStyle && backupStyle.ul) {\n            backupStyle.ul.cl = backupStyle.cl;\n        }\n\n        if ('ol' in backupStyle && backupStyle.ol) {\n            backupStyle.ol.cl = backupStyle.cl;\n        }\n\n        if ('st' in backupStyle && backupStyle.st) {\n            backupStyle.st.cl = backupStyle.cl;\n        }\n    }\n\n    return backupStyle;\n}\n\n/**\n *\n * @param paragraphs\n * @param offset\n */\nfunction skipParagraphs(paragraphs: IParagraph[], offset: number): number {\n    if (paragraphs.some((p) => p.startIndex === offset)) {\n        return skipParagraphs(paragraphs, offset + 1);\n    }\n\n    return offset;\n}\n\n/**\n * Find the text style of all paragraphs and modify it to the new style\n * @param p\n * @param newStyle\n */\nfunction mergeRichTextStyle(p: IDocumentData, newStyle: Nullable<IStyleData>) {\n    if (p.body == null) {\n        return;\n    }\n\n    if (!Array.isArray(p.body.textRuns)) {\n        p.body.textRuns = [];\n    }\n\n    let index = 0;\n    const newTextRuns = [];\n    const paragraphs = p.body?.paragraphs || [];\n\n    for (const textRun of p.body.textRuns) {\n        const { st, ed, ts = {} } = textRun;\n\n        if (index < st) {\n            const tr: ITextRun = {\n                st: index,\n                ed: st,\n            };\n\n            const merge = mergeStyle({}, newStyle, true);\n\n            // then remove null\n            merge && Tools.removeNull(merge);\n\n            if (!Tools.isEmptyObject(merge)) {\n                tr.ts = merge!;\n            }\n\n            newTextRuns.push(tr);\n        }\n\n        const merge = mergeStyle(ts, newStyle, true);\n\n        // then remove null\n        merge && Tools.removeNull(merge);\n\n        if (Tools.isEmptyObject(merge)) {\n            delete textRun.ts;\n        } else {\n            textRun.ts = merge as ITextStyle;\n        }\n\n        newTextRuns.push(textRun);\n\n        index = skipParagraphs(paragraphs, ed);\n    }\n\n    const endIndex = p.body.dataStream.endsWith('\\r\\n') ? p.body.dataStream.length - 2 : p.body.dataStream.length;\n\n    if (index < endIndex) {\n        const tr: ITextRun = {\n            st: index,\n            ed: endIndex,\n        };\n\n        const merge = mergeStyle({}, newStyle, true);\n\n        // then remove null\n        merge && Tools.removeNull(merge);\n\n        if (!Tools.isEmptyObject(merge)) {\n            tr.ts = merge!;\n        }\n\n        newTextRuns.push(tr);\n    }\n\n    p.body.textRuns = normalizeTextRuns(newTextRuns);\n}\n"],"mappings":"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","names":["merge"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3f0747412e964079c684167a85016565625a624d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/cell-type.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/cell-type.ts","statementMap":{"0":{"start":{"line":4,"column":2},"end":{"line":4,"column":32}},"1":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"2":{"start":{"line":5,"column":2},"end":{"line":5,"column":37}},"3":{"start":{"line":5,"column":25},"end":{"line":5,"column":37}},"4":{"start":{"line":6,"column":19},"end":{"line":6,"column":48}},"5":{"start":{"line":7,"column":19},"end":{"line":7,"column":48}},"6":{"start":{"line":8,"column":2},"end":{"line":17,"column":3}},"7":{"start":{"line":9,"column":4},"end":{"line":15,"column":5}},"8":{"start":{"line":10,"column":6},"end":{"line":14,"column":7}},"9":{"start":{"line":11,"column":8},"end":{"line":11,"column":36}},"10":{"start":{"line":12,"column":13},"end":{"line":14,"column":7}},"11":{"start":{"line":13,"column":8},"end":{"line":13,"column":37}},"12":{"start":{"line":16,"column":4},"end":{"line":16,"column":38}},"13":{"start":{"line":18,"column":2},"end":{"line":23,"column":3}},"14":{"start":{"line":19,"column":4},"end":{"line":21,"column":5}},"15":{"start":{"line":20,"column":6},"end":{"line":20,"column":34}},"16":{"start":{"line":22,"column":4},"end":{"line":22,"column":53}},"17":{"start":{"line":24,"column":2},"end":{"line":26,"column":3}},"18":{"start":{"line":25,"column":4},"end":{"line":25,"column":32}},"19":{"start":{"line":27,"column":2},"end":{"line":27,"column":51}},"20":{"start":{"line":30,"column":2},"end":{"line":30,"column":111}},"21":{"start":{"line":33,"column":2},"end":{"line":33,"column":29}},"22":{"start":{"line":36,"column":2},"end":{"line":36,"column":30}},"23":{"start":{"line":36,"column":18},"end":{"line":36,"column":30}},"24":{"start":{"line":37,"column":2},"end":{"line":47,"column":3}},"25":{"start":{"line":38,"column":4},"end":{"line":45,"column":5}},"26":{"start":{"line":39,"column":6},"end":{"line":41,"column":7}},"27":{"start":{"line":40,"column":8},"end":{"line":40,"column":37}},"28":{"start":{"line":42,"column":6},"end":{"line":42,"column":34}},"29":{"start":{"line":43,"column":11},"end":{"line":45,"column":5}},"30":{"start":{"line":44,"column":6},"end":{"line":44,"column":35}},"31":{"start":{"line":46,"column":4},"end":{"line":46,"column":32}},"32":{"start":{"line":48,"column":2},"end":{"line":53,"column":3}},"33":{"start":{"line":49,"column":4},"end":{"line":51,"column":5}},"34":{"start":{"line":50,"column":6},"end":{"line":50,"column":35}},"35":{"start":{"line":52,"column":4},"end":{"line":52,"column":32}},"36":{"start":{"line":54,"column":2},"end":{"line":56,"column":3}},"37":{"start":{"line":55,"column":4},"end":{"line":55,"column":33}},"38":{"start":{"line":57,"column":2},"end":{"line":57,"column":36}},"39":{"start":{"line":60,"column":2},"end":{"line":62,"column":3}},"40":{"start":{"line":61,"column":4},"end":{"line":61,"column":38}},"41":{"start":{"line":63,"column":2},"end":{"line":65,"column":3}},"42":{"start":{"line":64,"column":4},"end":{"line":64,"column":32}},"43":{"start":{"line":66,"column":2},"end":{"line":66,"column":44}}},"fnMap":{"0":{"name":"getCellType","decl":{"start":{"line":3,"column":16},"end":{"line":3,"column":27}},"loc":{"start":{"line":3,"column":52},"end":{"line":28,"column":1}},"line":3},"1":{"name":"checkCellValueTypeByValue","decl":{"start":{"line":29,"column":9},"end":{"line":29,"column":34}},"loc":{"start":{"line":29,"column":51},"end":{"line":31,"column":1}},"line":29},"2":{"name":"hasNumberFormat","decl":{"start":{"line":32,"column":9},"end":{"line":32,"column":24}},"loc":{"start":{"line":32,"column":32},"end":{"line":34,"column":1}},"line":32},"3":{"name":"checkCellValueType","decl":{"start":{"line":35,"column":16},"end":{"line":35,"column":34}},"loc":{"start":{"line":35,"column":44},"end":{"line":58,"column":1}},"line":35},"4":{"name":"getCellTypeByPattern","decl":{"start":{"line":59,"column":16},"end":{"line":59,"column":36}},"loc":{"start":{"line":59,"column":52},"end":{"line":67,"column":1}},"line":59}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":2},"end":{"line":4,"column":32}},"type":"if","locations":[{"start":{"line":4,"column":2},"end":{"line":4,"column":32}},{"start":{},"end":{}}],"line":4},"1":{"loc":{"start":{"line":5,"column":2},"end":{"line":5,"column":37}},"type":"if","locations":[{"start":{"line":5,"column":2},"end":{"line":5,"column":37}},{"start":{},"end":{}}],"line":5},"2":{"loc":{"start":{"line":8,"column":2},"end":{"line":17,"column":3}},"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":17,"column":3}},{"start":{},"end":{}}],"line":8},"3":{"loc":{"start":{"line":9,"column":4},"end":{"line":15,"column":5}},"type":"if","locations":[{"start":{"line":9,"column":4},"end":{"line":15,"column":5}},{"start":{},"end":{}}],"line":9},"4":{"loc":{"start":{"line":9,"column":8},"end":{"line":9,"column":66}},"type":"binary-expr","locations":[{"start":{"line":9,"column":8},"end":{"line":9,"column":43}},{"start":{"line":9,"column":47},"end":{"line":9,"column":66}}],"line":9},"5":{"loc":{"start":{"line":10,"column":6},"end":{"line":14,"column":7}},"type":"if","locations":[{"start":{"line":10,"column":6},"end":{"line":14,"column":7}},{"start":{"line":12,"column":13},"end":{"line":14,"column":7}}],"line":10},"6":{"loc":{"start":{"line":12,"column":13},"end":{"line":14,"column":7}},"type":"if","locations":[{"start":{"line":12,"column":13},"end":{"line":14,"column":7}},{"start":{},"end":{}}],"line":12},"7":{"loc":{"start":{"line":18,"column":2},"end":{"line":23,"column":3}},"type":"if","locations":[{"start":{"line":18,"column":2},"end":{"line":23,"column":3}},{"start":{},"end":{}}],"line":18},"8":{"loc":{"start":{"line":19,"column":4},"end":{"line":21,"column":5}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":21,"column":5}},{"start":{},"end":{}}],"line":19},"9":{"loc":{"start":{"line":24,"column":2},"end":{"line":26,"column":3}},"type":"if","locations":[{"start":{"line":24,"column":2},"end":{"line":26,"column":3}},{"start":{},"end":{}}],"line":24},"10":{"loc":{"start":{"line":30,"column":9},"end":{"line":30,"column":110}},"type":"cond-expr","locations":[{"start":{"line":30,"column":31},"end":{"line":30,"column":69}},{"start":{"line":30,"column":72},"end":{"line":30,"column":110}}],"line":30},"11":{"loc":{"start":{"line":36,"column":2},"end":{"line":36,"column":30}},"type":"if","locations":[{"start":{"line":36,"column":2},"end":{"line":36,"column":30}},{"start":{},"end":{}}],"line":36},"12":{"loc":{"start":{"line":37,"column":2},"end":{"line":47,"column":3}},"type":"if","locations":[{"start":{"line":37,"column":2},"end":{"line":47,"column":3}},{"start":{},"end":{}}],"line":37},"13":{"loc":{"start":{"line":38,"column":4},"end":{"line":45,"column":5}},"type":"if","locations":[{"start":{"line":38,"column":4},"end":{"line":45,"column":5}},{"start":{"line":43,"column":11},"end":{"line":45,"column":5}}],"line":38},"14":{"loc":{"start":{"line":39,"column":6},"end":{"line":41,"column":7}},"type":"if","locations":[{"start":{"line":39,"column":6},"end":{"line":41,"column":7}},{"start":{},"end":{}}],"line":39},"15":{"loc":{"start":{"line":39,"column":10},"end":{"line":39,"column":66}},"type":"binary-expr","locations":[{"start":{"line":39,"column":11},"end":{"line":39,"column":19}},{"start":{"line":39,"column":23},"end":{"line":39,"column":31}},{"start":{"line":39,"column":36},"end":{"line":39,"column":66}}],"line":39},"16":{"loc":{"start":{"line":43,"column":11},"end":{"line":45,"column":5}},"type":"if","locations":[{"start":{"line":43,"column":11},"end":{"line":45,"column":5}},{"start":{},"end":{}}],"line":43},"17":{"loc":{"start":{"line":48,"column":2},"end":{"line":53,"column":3}},"type":"if","locations":[{"start":{"line":48,"column":2},"end":{"line":53,"column":3}},{"start":{},"end":{}}],"line":48},"18":{"loc":{"start":{"line":49,"column":4},"end":{"line":51,"column":5}},"type":"if","locations":[{"start":{"line":49,"column":4},"end":{"line":51,"column":5}},{"start":{},"end":{}}],"line":49},"19":{"loc":{"start":{"line":49,"column":8},"end":{"line":49,"column":62}},"type":"binary-expr","locations":[{"start":{"line":49,"column":9},"end":{"line":49,"column":16}},{"start":{"line":49,"column":20},"end":{"line":49,"column":27}},{"start":{"line":49,"column":32},"end":{"line":49,"column":62}}],"line":49},"20":{"loc":{"start":{"line":54,"column":2},"end":{"line":56,"column":3}},"type":"if","locations":[{"start":{"line":54,"column":2},"end":{"line":56,"column":3}},{"start":{},"end":{}}],"line":54},"21":{"loc":{"start":{"line":60,"column":2},"end":{"line":62,"column":3}},"type":"if","locations":[{"start":{"line":60,"column":2},"end":{"line":62,"column":3}},{"start":{},"end":{}}],"line":60},"22":{"loc":{"start":{"line":63,"column":2},"end":{"line":65,"column":3}},"type":"if","locations":[{"start":{"line":63,"column":2},"end":{"line":65,"column":3}},{"start":{},"end":{}}],"line":63}},"s":{"0":4,"1":0,"2":4,"3":0,"4":4,"5":4,"6":4,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":4,"14":0,"15":0,"16":0,"17":4,"18":0,"19":4,"20":4,"21":4,"22":4,"23":0,"24":4,"25":4,"26":0,"27":0,"28":0,"29":4,"30":0,"31":4,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0},"f":{"0":4,"1":4,"2":4,"3":4,"4":0},"b":{"0":[0,4],"1":[0,4],"2":[0,4],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,4],"8":[0,0],"9":[0,4],"10":[4,0],"11":[0,4],"12":[4,0],"13":[0,4],"14":[0,0],"15":[0,0,0],"16":[0,4],"17":[0,0],"18":[0,0],"19":[0,0,0],"20":[0,0],"21":[0,0],"22":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/cell-type.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { CellValue, ICellData, IStyleData, Nullable, Styles } from '@univerjs/core';\nimport { CellValueType, isBooleanString, isRealNum } from '@univerjs/core';\nimport { isTextFormat } from '@univerjs/engine-numfmt';\n\n/**\n * Get cell value type by style, new value and old value.\n * If the new value contains t, then take t directly. In other cases, we need to dynamically determine based on actual data and styles\n * @param newVal\n * @param oldVal\n * @returns\n */\nexport function getCellType(styles: Styles, newVal: ICellData, oldVal: ICellData) {\n    if (newVal.t) return newVal.t;\n    if (newVal.v === null) return null;\n\n    const newStyle = styles.getStyleByCell(newVal);\n    const oldStyle = styles.getStyleByCell(oldVal);\n\n    if (oldVal.t === CellValueType.FORCE_STRING) {\n        // For cells with forced strings, set the percentage format and still use forced strings\n        // For cells with forced strings, update to the number and convert to ordinary numbers\n        // For cells with forced strings and text formats, update to the number and still use forced strings\n        if (!isTextFormat(oldStyle?.n?.pattern) && newVal.v !== undefined) {\n            if (isRealNum(newVal.v)) {\n                return CellValueType.NUMBER;\n            } else if (isBooleanString(`${newVal.v}`)) {\n                return CellValueType.BOOLEAN;\n            }\n        }\n\n        return CellValueType.FORCE_STRING;\n    }\n\n    // For cells with ordinary numbers, set the text format and convert the cell type to text\n    if (hasNumberFormat(newStyle)) {\n        if (isTextFormat(newStyle?.n?.pattern)) {\n            return CellValueType.STRING;\n        }\n\n        return checkCellValueTypeByValue(newVal, oldVal);\n    }\n\n    // For cells with text format, the cell type is still text when numbers are written, because the ISNUMBER function detects FALSE\n    if (isTextFormat(oldStyle?.n?.pattern)) {\n        return CellValueType.STRING;\n    }\n\n    return checkCellValueTypeByValue(newVal, oldVal);\n}\n\nfunction checkCellValueTypeByValue(newVal: ICellData, oldVal: ICellData): Nullable<CellValueType> {\n    return newVal.v !== undefined ? checkCellValueType(newVal.v, newVal.t) : checkCellValueType(oldVal.v, oldVal.t);\n}\n\nfunction hasNumberFormat(style: Nullable<IStyleData>) {\n    return !!style?.n?.pattern;\n}\n\n/**\n * Get the correct type after setting values to a cell.\n *\n * @param v the new value\n * @param type the old type\n * @returns the new type\n */\nexport function checkCellValueType(v: Nullable<CellValue>, type: Nullable<CellValueType>): Nullable<CellValueType> {\n    if (v === null) return null;\n\n    if (typeof v === 'string') {\n        // Support scientific notation, such as 10e+1\n        if (isRealNum(v)) {\n            if ((+v === 0 || +v === 1) && type === CellValueType.BOOLEAN) {\n                return CellValueType.BOOLEAN;\n            }\n\n            return CellValueType.NUMBER;\n        } else if (isBooleanString(v)) {\n            return CellValueType.BOOLEAN;\n        }\n        return CellValueType.STRING;\n    }\n\n    if (typeof v === 'number') {\n        if ((v === 0 || v === 1) && type === CellValueType.BOOLEAN) {\n            return CellValueType.BOOLEAN;\n        }\n        return CellValueType.NUMBER;\n    }\n\n    if (typeof v === 'boolean') {\n        return CellValueType.BOOLEAN;\n    }\n\n    return CellValueType.FORCE_STRING;\n}\n\nexport function getCellTypeByPattern(cell: ICellData, pattern: string) {\n    if (cell.t === CellValueType.FORCE_STRING) {\n        return CellValueType.FORCE_STRING;\n    }\n\n    if (isTextFormat(pattern)) {\n        return CellValueType.STRING;\n    }\n\n    return checkCellValueType(cell.v, cell.t);\n}\n"],"mappings":"AAiBA,SAAS,eAAe,iBAAiB,iBAAiB;AAC1D,SAAS,oBAAoB;AAStB,gBAAS,YAAY,QAAgB,QAAmB,QAAmB;AAC9E,MAAI,OAAO,EAAG,QAAO,OAAO;AAC5B,MAAI,OAAO,MAAM,KAAM,QAAO;AAE9B,QAAM,WAAW,OAAO,eAAe,MAAM;AAC7C,QAAM,WAAW,OAAO,eAAe,MAAM;AAE7C,MAAI,OAAO,MAAM,cAAc,cAAc;AAIzC,QAAI,CAAC,aAAa,UAAU,GAAG,OAAO,KAAK,OAAO,MAAM,QAAW;AAC/D,UAAI,UAAU,OAAO,CAAC,GAAG;AACrB,eAAO,cAAc;AAAA,MACzB,WAAW,gBAAgB,GAAG,OAAO,CAAC,EAAE,GAAG;AACvC,eAAO,cAAc;AAAA,MACzB;AAAA,IACJ;AAEA,WAAO,cAAc;AAAA,EACzB;AAGA,MAAI,gBAAgB,QAAQ,GAAG;AAC3B,QAAI,aAAa,UAAU,GAAG,OAAO,GAAG;AACpC,aAAO,cAAc;AAAA,IACzB;AAEA,WAAO,0BAA0B,QAAQ,MAAM;AAAA,EACnD;AAGA,MAAI,aAAa,UAAU,GAAG,OAAO,GAAG;AACpC,WAAO,cAAc;AAAA,EACzB;AAEA,SAAO,0BAA0B,QAAQ,MAAM;AACnD;AAEA,SAAS,0BAA0B,QAAmB,QAA4C;AAC9F,SAAO,OAAO,MAAM,SAAY,mBAAmB,OAAO,GAAG,OAAO,CAAC,IAAI,mBAAmB,OAAO,GAAG,OAAO,CAAC;AAClH;AAEA,SAAS,gBAAgB,OAA6B;AAClD,SAAO,CAAC,CAAC,OAAO,GAAG;AACvB;AASO,gBAAS,mBAAmB,GAAwB,MAAwD;AAC/G,MAAI,MAAM,KAAM,QAAO;AAEvB,MAAI,OAAO,MAAM,UAAU;AAEvB,QAAI,UAAU,CAAC,GAAG;AACd,WAAK,CAAC,MAAM,KAAK,CAAC,MAAM,MAAM,SAAS,cAAc,SAAS;AAC1D,eAAO,cAAc;AAAA,MACzB;AAEA,aAAO,cAAc;AAAA,IACzB,WAAW,gBAAgB,CAAC,GAAG;AAC3B,aAAO,cAAc;AAAA,IACzB;AACA,WAAO,cAAc;AAAA,EACzB;AAEA,MAAI,OAAO,MAAM,UAAU;AACvB,SAAK,MAAM,KAAK,MAAM,MAAM,SAAS,cAAc,SAAS;AACxD,aAAO,cAAc;AAAA,IACzB;AACA,WAAO,cAAc;AAAA,EACzB;AAEA,MAAI,OAAO,MAAM,WAAW;AACxB,WAAO,cAAc;AAAA,EACzB;AAEA,SAAO,cAAc;AACzB;AAEO,gBAAS,qBAAqB,MAAiB,SAAiB;AACnE,MAAI,KAAK,MAAM,cAAc,cAAc;AACvC,WAAO,cAAc;AAAA,EACzB;AAEA,MAAI,aAAa,OAAO,GAAG;AACvB,WAAO,cAAc;AAAA,EACzB;AAEA,SAAO,mBAAmB,KAAK,GAAG,KAAK,CAAC;AAC5C;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"41f5b16c476cc5bd17bdfe15655be2c939aed4b1"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/cell-value.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/cell-value.ts","statementMap":{"0":{"start":{"line":3,"column":2},"end":{"line":5,"column":3}},"1":{"start":{"line":4,"column":4},"end":{"line":4,"column":26}},"2":{"start":{"line":6,"column":2},"end":{"line":8,"column":3}},"3":{"start":{"line":7,"column":4},"end":{"line":7,"column":47}},"4":{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},"5":{"start":{"line":10,"column":4},"end":{"line":10,"column":23}},"6":{"start":{"line":12,"column":2},"end":{"line":12,"column":16}},"7":{"start":{"line":15,"column":2},"end":{"line":31,"column":3}},"8":{"start":{"line":16,"column":4},"end":{"line":18,"column":5}},"9":{"start":{"line":17,"column":6},"end":{"line":17,"column":18}},"10":{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},"11":{"start":{"line":21,"column":6},"end":{"line":21,"column":19}},"12":{"start":{"line":23,"column":4},"end":{"line":30,"column":5}},"13":{"start":{"line":24,"column":6},"end":{"line":26,"column":7}},"14":{"start":{"line":25,"column":8},"end":{"line":25,"column":21}},"15":{"start":{"line":27,"column":6},"end":{"line":29,"column":7}},"16":{"start":{"line":28,"column":8},"end":{"line":28,"column":20}},"17":{"start":{"line":32,"column":2},"end":{"line":39,"column":3}},"18":{"start":{"line":33,"column":4},"end":{"line":35,"column":5}},"19":{"start":{"line":34,"column":6},"end":{"line":34,"column":19}},"20":{"start":{"line":36,"column":4},"end":{"line":38,"column":5}},"21":{"start":{"line":37,"column":6},"end":{"line":37,"column":18}},"22":{"start":{"line":40,"column":2},"end":{"line":42,"column":3}},"23":{"start":{"line":41,"column":4},"end":{"line":41,"column":17}},"24":{"start":{"line":43,"column":2},"end":{"line":43,"column":14}},"25":{"start":{"line":46,"column":2},"end":{"line":46,"column":33}},"26":{"start":{"line":46,"column":21},"end":{"line":46,"column":33}},"27":{"start":{"line":47,"column":2},"end":{"line":49,"column":3}},"28":{"start":{"line":48,"column":4},"end":{"line":48,"column":19}},"29":{"start":{"line":50,"column":2},"end":{"line":52,"column":3}},"30":{"start":{"line":51,"column":4},"end":{"line":51,"column":20}},"31":{"start":{"line":53,"column":2},"end":{"line":55,"column":3}},"32":{"start":{"line":54,"column":4},"end":{"line":54,"column":19}},"33":{"start":{"line":56,"column":2},"end":{"line":58,"column":3}},"34":{"start":{"line":57,"column":4},"end":{"line":57,"column":19}},"35":{"start":{"line":59,"column":2},"end":{"line":61,"column":3}},"36":{"start":{"line":60,"column":4},"end":{"line":60,"column":19}},"37":{"start":{"line":62,"column":2},"end":{"line":64,"column":3}},"38":{"start":{"line":63,"column":4},"end":{"line":63,"column":19}},"39":{"start":{"line":65,"column":2},"end":{"line":67,"column":3}},"40":{"start":{"line":66,"column":4},"end":{"line":66,"column":24}},"41":{"start":{"line":68,"column":2},"end":{"line":68,"column":15}}},"fnMap":{"0":{"name":"getCellValue","decl":{"start":{"line":2,"column":16},"end":{"line":2,"column":28}},"loc":{"start":{"line":2,"column":41},"end":{"line":13,"column":1}},"line":2},"1":{"name":"extractBooleanValue","decl":{"start":{"line":14,"column":16},"end":{"line":14,"column":35}},"loc":{"start":{"line":14,"column":43},"end":{"line":44,"column":1}},"line":14},"2":{"name":"setNull","decl":{"start":{"line":45,"column":16},"end":{"line":45,"column":23}},"loc":{"start":{"line":45,"column":31},"end":{"line":69,"column":1}},"line":45}},"branchMap":{"0":{"loc":{"start":{"line":3,"column":2},"end":{"line":5,"column":3}},"type":"if","locations":[{"start":{"line":3,"column":2},"end":{"line":5,"column":3}},{"start":{},"end":{}}],"line":3},"1":{"loc":{"start":{"line":6,"column":2},"end":{"line":8,"column":3}},"type":"if","locations":[{"start":{"line":6,"column":2},"end":{"line":8,"column":3}},{"start":{},"end":{}}],"line":6},"2":{"loc":{"start":{"line":7,"column":11},"end":{"line":7,"column":46}},"type":"cond-expr","locations":[{"start":{"line":7,"column":41},"end":{"line":7,"column":42}},{"start":{"line":7,"column":45},"end":{"line":7,"column":46}}],"line":7},"3":{"loc":{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},"type":"if","locations":[{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},{"start":{},"end":{}}],"line":9},"4":{"loc":{"start":{"line":9,"column":6},"end":{"line":9,"column":74}},"type":"binary-expr","locations":[{"start":{"line":9,"column":6},"end":{"line":9,"column":35}},{"start":{"line":9,"column":39},"end":{"line":9,"column":74}}],"line":9},"5":{"loc":{"start":{"line":15,"column":2},"end":{"line":31,"column":3}},"type":"if","locations":[{"start":{"line":15,"column":2},"end":{"line":31,"column":3}},{"start":{},"end":{}}],"line":15},"6":{"loc":{"start":{"line":16,"column":4},"end":{"line":18,"column":5}},"type":"if","locations":[{"start":{"line":16,"column":4},"end":{"line":18,"column":5}},{"start":{},"end":{}}],"line":16},"7":{"loc":{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},{"start":{},"end":{}}],"line":20},"8":{"loc":{"start":{"line":23,"column":4},"end":{"line":30,"column":5}},"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":30,"column":5}},{"start":{},"end":{}}],"line":23},"9":{"loc":{"start":{"line":24,"column":6},"end":{"line":26,"column":7}},"type":"if","locations":[{"start":{"line":24,"column":6},"end":{"line":26,"column":7}},{"start":{},"end":{}}],"line":24},"10":{"loc":{"start":{"line":27,"column":6},"end":{"line":29,"column":7}},"type":"if","locations":[{"start":{"line":27,"column":6},"end":{"line":29,"column":7}},{"start":{},"end":{}}],"line":27},"11":{"loc":{"start":{"line":32,"column":2},"end":{"line":39,"column":3}},"type":"if","locations":[{"start":{"line":32,"column":2},"end":{"line":39,"column":3}},{"start":{},"end":{}}],"line":32},"12":{"loc":{"start":{"line":33,"column":4},"end":{"line":35,"column":5}},"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":35,"column":5}},{"start":{},"end":{}}],"line":33},"13":{"loc":{"start":{"line":36,"column":4},"end":{"line":38,"column":5}},"type":"if","locations":[{"start":{"line":36,"column":4},"end":{"line":38,"column":5}},{"start":{},"end":{}}],"line":36},"14":{"loc":{"start":{"line":40,"column":2},"end":{"line":42,"column":3}},"type":"if","locations":[{"start":{"line":40,"column":2},"end":{"line":42,"column":3}},{"start":{},"end":{}}],"line":40},"15":{"loc":{"start":{"line":46,"column":2},"end":{"line":46,"column":33}},"type":"if","locations":[{"start":{"line":46,"column":2},"end":{"line":46,"column":33}},{"start":{},"end":{}}],"line":46},"16":{"loc":{"start":{"line":47,"column":2},"end":{"line":49,"column":3}},"type":"if","locations":[{"start":{"line":47,"column":2},"end":{"line":49,"column":3}},{"start":{},"end":{}}],"line":47},"17":{"loc":{"start":{"line":50,"column":2},"end":{"line":52,"column":3}},"type":"if","locations":[{"start":{"line":50,"column":2},"end":{"line":52,"column":3}},{"start":{},"end":{}}],"line":50},"18":{"loc":{"start":{"line":53,"column":2},"end":{"line":55,"column":3}},"type":"if","locations":[{"start":{"line":53,"column":2},"end":{"line":55,"column":3}},{"start":{},"end":{}}],"line":53},"19":{"loc":{"start":{"line":56,"column":2},"end":{"line":58,"column":3}},"type":"if","locations":[{"start":{"line":56,"column":2},"end":{"line":58,"column":3}},{"start":{},"end":{}}],"line":56},"20":{"loc":{"start":{"line":59,"column":2},"end":{"line":61,"column":3}},"type":"if","locations":[{"start":{"line":59,"column":2},"end":{"line":61,"column":3}},{"start":{},"end":{}}],"line":59},"21":{"loc":{"start":{"line":62,"column":2},"end":{"line":64,"column":3}},"type":"if","locations":[{"start":{"line":62,"column":2},"end":{"line":64,"column":3}},{"start":{},"end":{}}],"line":62},"22":{"loc":{"start":{"line":65,"column":2},"end":{"line":67,"column":3}},"type":"if","locations":[{"start":{"line":65,"column":2},"end":{"line":67,"column":3}},{"start":{},"end":{}}],"line":65}},"s":{"0":8,"1":0,"2":8,"3":0,"4":8,"5":8,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0},"f":{"0":8,"1":0,"2":0},"b":{"0":[0,8],"1":[0,8],"2":[0,0],"3":[8,0],"4":[8,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/cell-value.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellData, Nullable } from '@univerjs/core';\nimport { CellValueType, isSafeNumeric } from '@univerjs/core';\n\n/**\n * Get cell value from new value by type\n * @param type\n * @param cell\n * @returns\n */\nexport function getCellValue(type: Nullable<CellValueType>, cell: ICellData) {\n    if (type === CellValueType.NUMBER) {\n        return Number(cell.v);\n    }\n\n    if (type === CellValueType.BOOLEAN) {\n        return extractBooleanValue(cell.v) ? 1 : 0;\n    }\n\n    if (type === CellValueType.STRING || type === CellValueType.FORCE_STRING) {\n        return `${cell.v}`;\n    }\n\n    return cell.v;\n}\n\n/**\n * Check if the value can be casted to a boolean.\n * @internal\n * @param value\n * @returns It would return null if the value cannot be casted to a boolean, and would return the boolean value if it can be casted.\n */\nexport function extractBooleanValue(value: Nullable<string | number | boolean>): Nullable<boolean> {\n    if (typeof value === 'string') {\n        if (value.toUpperCase() === 'TRUE') {\n            return true;\n        };\n\n        if (value.toUpperCase() === 'FALSE') {\n            return false;\n        }\n\n        if (isSafeNumeric(value)) {\n            if (Number(value) === 0) {\n                return false;\n            }\n\n            if (Number(value) === 1) {\n                return true;\n            }\n        }\n    }\n\n    if (typeof value === 'number') {\n        if (value === 0) {\n            return false;\n        }\n\n        if (value === 1) {\n            return true;\n        }\n    }\n\n    if (typeof value === 'boolean') {\n        return value;\n    }\n\n    return null;\n}\n\n/**\n * Supplement the data of the cell, set the other value to NULL, Used to reset properties when undoing\n * @param value\n * @returns\n */\nexport function setNull(value: Nullable<ICellData>) {\n    if (value == null) return null;\n\n    if (value.f === undefined) {\n        value.f = null;\n    }\n\n    if (value.si === undefined) {\n        value.si = null;\n    }\n\n    if (value.p === undefined) {\n        value.p = null;\n    }\n\n    if (value.v === undefined) {\n        value.v = null;\n    }\n\n    if (value.t === undefined) {\n        value.t = null;\n    }\n\n    if (value.s === undefined) {\n        value.s = null;\n    }\n\n    if (value.custom === undefined) {\n        value.custom = null;\n    }\n\n    return value;\n}\n"],"mappings":"AAiBA,SAAS,eAAe,qBAAqB;AAQtC,gBAAS,aAAa,MAA+B,MAAiB;AACzE,MAAI,SAAS,cAAc,QAAQ;AAC/B,WAAO,OAAO,KAAK,CAAC;AAAA,EACxB;AAEA,MAAI,SAAS,cAAc,SAAS;AAChC,WAAO,oBAAoB,KAAK,CAAC,IAAI,IAAI;AAAA,EAC7C;AAEA,MAAI,SAAS,cAAc,UAAU,SAAS,cAAc,cAAc;AACtE,WAAO,GAAG,KAAK,CAAC;AAAA,EACpB;AAEA,SAAO,KAAK;AAChB;AAQO,gBAAS,oBAAoB,OAA+D;AAC/F,MAAI,OAAO,UAAU,UAAU;AAC3B,QAAI,MAAM,YAAY,MAAM,QAAQ;AAChC,aAAO;AAAA,IACX;AAAC;AAED,QAAI,MAAM,YAAY,MAAM,SAAS;AACjC,aAAO;AAAA,IACX;AAEA,QAAI,cAAc,KAAK,GAAG;AACtB,UAAI,OAAO,KAAK,MAAM,GAAG;AACrB,eAAO;AAAA,MACX;AAEA,UAAI,OAAO,KAAK,MAAM,GAAG;AACrB,eAAO;AAAA,MACX;AAAA,IACJ;AAAA,EACJ;AAEA,MAAI,OAAO,UAAU,UAAU;AAC3B,QAAI,UAAU,GAAG;AACb,aAAO;AAAA,IACX;AAEA,QAAI,UAAU,GAAG;AACb,aAAO;AAAA,IACX;AAAA,EACJ;AAEA,MAAI,OAAO,UAAU,WAAW;AAC5B,WAAO;AAAA,EACX;AAEA,SAAO;AACX;AAOO,gBAAS,QAAQ,OAA4B;AAChD,MAAI,SAAS,KAAM,QAAO;AAE1B,MAAI,MAAM,MAAM,QAAW;AACvB,UAAM,IAAI;AAAA,EACd;AAEA,MAAI,MAAM,OAAO,QAAW;AACxB,UAAM,KAAK;AAAA,EACf;AAEA,MAAI,MAAM,MAAM,QAAW;AACvB,UAAM,IAAI;AAAA,EACd;AAEA,MAAI,MAAM,MAAM,QAAW;AACvB,UAAM,IAAI;AAAA,EACd;AAEA,MAAI,MAAM,MAAM,QAAW;AACvB,UAAM,IAAI;AAAA,EACd;AAEA,MAAI,MAAM,MAAM,QAAW;AACvB,UAAM,IAAI;AAAA,EACd;AAEA,MAAI,MAAM,WAAW,QAAW;AAC5B,UAAM,SAAS;AAAA,EACnB;AAEA,SAAO;AACX;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"15e226475a9ac53551d777b78e513d1dd1352813"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/set-range-values.mutation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/set-range-values.mutation.ts","statementMap":{"0":{"start":{"line":5,"column":49},"end":{"line":32,"column":1}},"1":{"start":{"line":6,"column":43},"end":{"line":6,"column":49}},"2":{"start":{"line":7,"column":32},"end":{"line":7,"column":68}},"3":{"start":{"line":8,"column":19},"end":{"line":8,"column":71}},"4":{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},"5":{"start":{"line":10,"column":4},"end":{"line":10,"column":47}},"6":{"start":{"line":12,"column":20},"end":{"line":12,"column":57}},"7":{"start":{"line":13,"column":2},"end":{"line":15,"column":3}},"8":{"start":{"line":14,"column":4},"end":{"line":14,"column":48}},"9":{"start":{"line":16,"column":21},"end":{"line":16,"column":46}},"10":{"start":{"line":17,"column":17},"end":{"line":17,"column":37}},"11":{"start":{"line":18,"column":19},"end":{"line":18,"column":37}},"12":{"start":{"line":19,"column":20},"end":{"line":19,"column":47}},"13":{"start":{"line":20,"column":2},"end":{"line":26,"column":5}},"14":{"start":{"line":21,"column":17},"end":{"line":21,"column":70}},"15":{"start":{"line":22,"column":21},"end":{"line":22,"column":48}},"16":{"start":{"line":23,"column":21},"end":{"line":23,"column":50}},"17":{"start":{"line":24,"column":4},"end":{"line":24,"column":48}},"18":{"start":{"line":25,"column":4},"end":{"line":25,"column":47}},"19":{"start":{"line":27,"column":2},"end":{"line":31,"column":4}},"20":{"start":{"line":33,"column":38},"end":{"line":83,"column":1}},"21":{"start":{"line":37,"column":45},"end":{"line":37,"column":51}},"22":{"start":{"line":38,"column":34},"end":{"line":38,"column":70}},"23":{"start":{"line":39,"column":21},"end":{"line":39,"column":58}},"24":{"start":{"line":40,"column":4},"end":{"line":42,"column":5}},"25":{"start":{"line":41,"column":6},"end":{"line":41,"column":19}},"26":{"start":{"line":43,"column":22},"end":{"line":43,"column":59}},"27":{"start":{"line":44,"column":4},"end":{"line":46,"column":5}},"28":{"start":{"line":45,"column":6},"end":{"line":45,"column":19}},"29":{"start":{"line":47,"column":23},"end":{"line":47,"column":48}},"30":{"start":{"line":48,"column":19},"end":{"line":48,"column":39}},"31":{"start":{"line":49,"column":22},"end":{"line":49,"column":49}},"32":{"start":{"line":50,"column":4},"end":{"line":80,"column":7}},"33":{"start":{"line":51,"column":6},"end":{"line":79,"column":7}},"34":{"start":{"line":52,"column":8},"end":{"line":52,"column":43}},"35":{"start":{"line":54,"column":23},"end":{"line":54,"column":58}},"36":{"start":{"line":55,"column":21},"end":{"line":55,"column":56}},"37":{"start":{"line":56,"column":8},"end":{"line":58,"column":9}},"38":{"start":{"line":57,"column":10},"end":{"line":57,"column":30}},"39":{"start":{"line":59,"column":8},"end":{"line":61,"column":9}},"40":{"start":{"line":60,"column":10},"end":{"line":60,"column":32}},"41":{"start":{"line":62,"column":8},"end":{"line":64,"column":9}},"42":{"start":{"line":63,"column":10},"end":{"line":63,"column":30}},"43":{"start":{"line":65,"column":8},"end":{"line":67,"column":9}},"44":{"start":{"line":66,"column":10},"end":{"line":66,"column":48}},"45":{"start":{"line":68,"column":8},"end":{"line":71,"column":9}},"46":{"start":{"line":69,"column":10},"end":{"line":69,"column":26}},"47":{"start":{"line":70,"column":10},"end":{"line":70,"column":48}},"48":{"start":{"line":72,"column":8},"end":{"line":74,"column":9}},"49":{"start":{"line":73,"column":10},"end":{"line":73,"column":46}},"50":{"start":{"line":75,"column":8},"end":{"line":77,"column":9}},"51":{"start":{"line":76,"column":10},"end":{"line":76,"column":40}},"52":{"start":{"line":78,"column":8},"end":{"line":78,"column":64}},"53":{"start":{"line":81,"column":4},"end":{"line":81,"column":16}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":49},"end":{"line":5,"column":50}},"loc":{"start":{"line":5,"column":71},"end":{"line":32,"column":1}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":20,"column":21},"end":{"line":20,"column":22}},"loc":{"start":{"line":20,"column":43},"end":{"line":26,"column":3}},"line":20},"2":{"name":"(anonymous_2)","decl":{"start":{"line":36,"column":11},"end":{"line":36,"column":12}},"loc":{"start":{"line":36,"column":33},"end":{"line":82,"column":3}},"line":36},"3":{"name":"(anonymous_3)","decl":{"start":{"line":50,"column":23},"end":{"line":50,"column":24}},"loc":{"start":{"line":50,"column":45},"end":{"line":80,"column":5}},"line":50}},"branchMap":{"0":{"loc":{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},"type":"if","locations":[{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},{"start":{},"end":{}}],"line":9},"1":{"loc":{"start":{"line":13,"column":2},"end":{"line":15,"column":3}},"type":"if","locations":[{"start":{"line":13,"column":2},"end":{"line":15,"column":3}},{"start":{},"end":{}}],"line":13},"2":{"loc":{"start":{"line":21,"column":17},"end":{"line":21,"column":70}},"type":"binary-expr","locations":[{"start":{"line":21,"column":17},"end":{"line":21,"column":64}},{"start":{"line":21,"column":68},"end":{"line":21,"column":70}}],"line":21},"3":{"loc":{"start":{"line":40,"column":4},"end":{"line":42,"column":5}},"type":"if","locations":[{"start":{"line":40,"column":4},"end":{"line":42,"column":5}},{"start":{},"end":{}}],"line":40},"4":{"loc":{"start":{"line":44,"column":4},"end":{"line":46,"column":5}},"type":"if","locations":[{"start":{"line":44,"column":4},"end":{"line":46,"column":5}},{"start":{},"end":{}}],"line":44},"5":{"loc":{"start":{"line":51,"column":6},"end":{"line":79,"column":7}},"type":"if","locations":[{"start":{"line":51,"column":6},"end":{"line":79,"column":7}},{"start":{"line":53,"column":13},"end":{"line":79,"column":7}}],"line":51},"6":{"loc":{"start":{"line":54,"column":23},"end":{"line":54,"column":58}},"type":"binary-expr","locations":[{"start":{"line":54,"column":23},"end":{"line":54,"column":52}},{"start":{"line":54,"column":56},"end":{"line":54,"column":58}}],"line":54},"7":{"loc":{"start":{"line":56,"column":8},"end":{"line":58,"column":9}},"type":"if","locations":[{"start":{"line":56,"column":8},"end":{"line":58,"column":9}},{"start":{},"end":{}}],"line":56},"8":{"loc":{"start":{"line":59,"column":8},"end":{"line":61,"column":9}},"type":"if","locations":[{"start":{"line":59,"column":8},"end":{"line":61,"column":9}},{"start":{},"end":{}}],"line":59},"9":{"loc":{"start":{"line":62,"column":8},"end":{"line":64,"column":9}},"type":"if","locations":[{"start":{"line":62,"column":8},"end":{"line":64,"column":9}},{"start":{},"end":{}}],"line":62},"10":{"loc":{"start":{"line":65,"column":8},"end":{"line":67,"column":9}},"type":"if","locations":[{"start":{"line":65,"column":8},"end":{"line":67,"column":9}},{"start":{},"end":{}}],"line":65},"11":{"loc":{"start":{"line":68,"column":8},"end":{"line":71,"column":9}},"type":"if","locations":[{"start":{"line":68,"column":8},"end":{"line":71,"column":9}},{"start":{},"end":{}}],"line":68},"12":{"loc":{"start":{"line":72,"column":8},"end":{"line":74,"column":9}},"type":"if","locations":[{"start":{"line":72,"column":8},"end":{"line":74,"column":9}},{"start":{},"end":{}}],"line":72},"13":{"loc":{"start":{"line":75,"column":8},"end":{"line":77,"column":9}},"type":"if","locations":[{"start":{"line":75,"column":8},"end":{"line":77,"column":9}},{"start":{},"end":{}}],"line":75}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1,"21":2,"22":2,"23":2,"24":2,"25":0,"26":2,"27":2,"28":0,"29":2,"30":2,"31":2,"32":2,"33":4,"34":0,"35":4,"36":4,"37":4,"38":0,"39":4,"40":0,"41":4,"42":0,"43":4,"44":4,"45":4,"46":4,"47":4,"48":4,"49":4,"50":4,"51":0,"52":4,"53":2},"f":{"0":0,"1":0,"2":2,"3":4},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,2],"4":[0,2],"5":[0,4],"6":[4,4],"7":[0,4],"8":[0,4],"9":[0,4],"10":[4,0],"11":[4,0],"12":[4,0],"13":[0,4]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/set-range-values.mutation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type {\n    IAccessor,\n    ICellData,\n    ICopyToOptionsData,\n    IMutation,\n    IMutationCommonParams,\n    IObjectMatrixPrimitiveType,\n    IRange,\n    Nullable,\n    Workbook,\n} from '@univerjs/core';\nimport { CommandType, IUniverInstanceService, ObjectMatrix, Tools } from '@univerjs/core';\nimport { handleStyle, transformStyle } from '../../basics/cell-style';\nimport { getCellType } from '../../basics/cell-type';\nimport { getCellValue, setNull } from '../../basics/cell-value';\n\n/** Params of `SetRangeValuesMutation` */\nexport interface ISetRangeValuesMutationParams extends IMutationCommonParams {\n    subUnitId: string;\n    unitId: string;\n\n    /**\n     * null for clear all\n     */\n    cellValue?: IObjectMatrixPrimitiveType<Nullable<ICellData>>;\n\n    /**\n     * @deprecated not a good design\n     */\n    options?: ICopyToOptionsData;\n}\n\nexport interface ISetRangeValuesRangeMutationParams extends ISetRangeValuesMutationParams {\n    range: IRange[];\n}\n\n/**\n * Generate undo mutation of a `SetRangeValuesMutation`\n *\n * @param {IAccessor} accessor - injector accessor\n * @param {ISetRangeValuesMutationParams} params - do mutation params\n * @returns {ISetRangeValuesMutationParams} undo mutation params\n */\nexport const SetRangeValuesUndoMutationFactory = (\n    accessor: IAccessor,\n    params: ISetRangeValuesMutationParams\n): ISetRangeValuesMutationParams => {\n    const { unitId, subUnitId, cellValue } = params;\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const workbook = univerInstanceService.getUniverSheetInstance(unitId);\n\n    if (workbook == null) {\n        throw new Error('workbook is null error!');\n    }\n\n    const worksheet = workbook.getSheetBySheetId(subUnitId);\n    if (worksheet == null) {\n        throw new Error('worksheet is null error!');\n    }\n\n    const cellMatrix = worksheet.getCellMatrix();\n    const styles = workbook.getStyles();\n    const undoData = new ObjectMatrix<Nullable<ICellData>>();\n\n    const newValues = new ObjectMatrix(cellValue);\n\n    newValues.forValue((row, col, newVal) => {\n        const cell = Tools.deepClone(cellMatrix?.getValue(row, col)) || {}; // clone cell dataprevent modify the original data\n        const oldStyle = styles.getStyleByCell(cell);\n        // transformStyle does not accept style id\n        const newStyle = styles.getStyleByCell(newVal);\n\n        cell.s = transformStyle(oldStyle, newStyle);\n\n        undoData.setValue(row, col, setNull(cell));\n    });\n\n    return {\n        ...params,\n        options: {},\n        cellValue: undoData.getMatrix(),\n    } as ISetRangeValuesMutationParams;\n};\n\nexport const SetRangeValuesMutation: IMutation<ISetRangeValuesMutationParams, boolean> = {\n    id: 'sheet.mutation.set-range-values',\n\n    type: CommandType.MUTATION,\n\n    handler: (accessor, params) => {\n        const { cellValue, subUnitId, unitId } = params;\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const workbook = univerInstanceService.getUnit<Workbook>(unitId);\n        if (!workbook) {\n            return false;\n        }\n\n        const worksheet = workbook.getSheetBySheetId(subUnitId);\n        if (!worksheet) {\n            return false;\n        }\n\n        const cellMatrix = worksheet.getCellMatrix();\n        const styles = workbook.getStyles();\n        const newValues = new ObjectMatrix(cellValue);\n\n        newValues.forValue((row, col, newVal) => {\n            // clear all\n            if (!newVal) {\n                cellMatrix?.setValue(row, col, {});\n            } else {\n                const oldVal = cellMatrix.getValue(row, col) || {};\n\n                // NOTE: we may need to take `p` into account\n                const type = getCellType(styles, newVal, oldVal);\n\n                if (newVal.f !== undefined) {\n                    oldVal.f = newVal.f;\n                }\n\n                if (newVal.si !== undefined) {\n                    oldVal.si = newVal.si;\n                }\n\n                if (newVal.p !== undefined) {\n                    oldVal.p = newVal.p;\n                }\n\n                // Set to null, clear content\n                if (newVal.v !== undefined) {\n                    oldVal.v = getCellValue(type, newVal);\n                }\n\n                if (oldVal.v !== undefined) {\n                    oldVal.t = type;\n                    // The text format may be set for the numeric cell, and cell.v needs to be converted to text\n                    oldVal.v = getCellValue(type, oldVal);\n                }\n\n                // handle style\n                if (newVal.s !== undefined) {\n                    handleStyle(styles, oldVal, newVal);\n                }\n\n                if (newVal.custom !== undefined) {\n                    // Custom will overwrite the original value\n                    oldVal.custom = newVal.custom;\n                }\n\n                cellMatrix.setValue(row, col, Tools.removeNull(oldVal));\n            }\n        });\n\n        return true;\n    },\n};\n"],"mappings":"AA2BA,SAAS,aAAa,wBAAwB,cAAc,aAAa;AACzE,SAAS,aAAa,sBAAsB;AAC5C,SAAS,mBAAmB;AAC5B,SAAS,cAAc,eAAe;AA6B/B,aAAM,oCAAoC,CAC7C,UACA,WACgC;AAChC,QAAM,EAAE,QAAQ,WAAW,UAAU,IAAI;AACzC,QAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,QAAM,WAAW,sBAAsB,uBAAuB,MAAM;AAEpE,MAAI,YAAY,MAAM;AAClB,UAAM,IAAI,MAAM,yBAAyB;AAAA,EAC7C;AAEA,QAAM,YAAY,SAAS,kBAAkB,SAAS;AACtD,MAAI,aAAa,MAAM;AACnB,UAAM,IAAI,MAAM,0BAA0B;AAAA,EAC9C;AAEA,QAAM,aAAa,UAAU,cAAc;AAC3C,QAAM,SAAS,SAAS,UAAU;AAClC,QAAM,WAAW,IAAI,aAAkC;AAEvD,QAAM,YAAY,IAAI,aAAa,SAAS;AAE5C,YAAU,SAAS,CAAC,KAAK,KAAK,WAAW;AACrC,UAAM,OAAO,MAAM,UAAU,YAAY,SAAS,KAAK,GAAG,CAAC,KAAK,CAAC;AACjE,UAAM,WAAW,OAAO,eAAe,IAAI;AAE3C,UAAM,WAAW,OAAO,eAAe,MAAM;AAE7C,SAAK,IAAI,eAAe,UAAU,QAAQ;AAE1C,aAAS,SAAS,KAAK,KAAK,QAAQ,IAAI,CAAC;AAAA,EAC7C,CAAC;AAED,SAAO;AAAA,IACH,GAAG;AAAA,IACH,SAAS,CAAC;AAAA,IACV,WAAW,SAAS,UAAU;AAAA,EAClC;AACJ;AAEO,aAAM,yBAA4E;AAAA,EACrF,IAAI;AAAA,EAEJ,MAAM,YAAY;AAAA,EAElB,SAAS,CAAC,UAAU,WAAW;AAC3B,UAAM,EAAE,WAAW,WAAW,OAAO,IAAI;AACzC,UAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,UAAM,WAAW,sBAAsB,QAAkB,MAAM;AAC/D,QAAI,CAAC,UAAU;AACX,aAAO;AAAA,IACX;AAEA,UAAM,YAAY,SAAS,kBAAkB,SAAS;AACtD,QAAI,CAAC,WAAW;AACZ,aAAO;AAAA,IACX;AAEA,UAAM,aAAa,UAAU,cAAc;AAC3C,UAAM,SAAS,SAAS,UAAU;AAClC,UAAM,YAAY,IAAI,aAAa,SAAS;AAE5C,cAAU,SAAS,CAAC,KAAK,KAAK,WAAW;AAErC,UAAI,CAAC,QAAQ;AACT,oBAAY,SAAS,KAAK,KAAK,CAAC,CAAC;AAAA,MACrC,OAAO;AACH,cAAM,SAAS,WAAW,SAAS,KAAK,GAAG,KAAK,CAAC;AAGjD,cAAM,OAAO,YAAY,QAAQ,QAAQ,MAAM;AAE/C,YAAI,OAAO,MAAM,QAAW;AACxB,iBAAO,IAAI,OAAO;AAAA,QACtB;AAEA,YAAI,OAAO,OAAO,QAAW;AACzB,iBAAO,KAAK,OAAO;AAAA,QACvB;AAEA,YAAI,OAAO,MAAM,QAAW;AACxB,iBAAO,IAAI,OAAO;AAAA,QACtB;AAGA,YAAI,OAAO,MAAM,QAAW;AACxB,iBAAO,IAAI,aAAa,MAAM,MAAM;AAAA,QACxC;AAEA,YAAI,OAAO,MAAM,QAAW;AACxB,iBAAO,IAAI;AAEX,iBAAO,IAAI,aAAa,MAAM,MAAM;AAAA,QACxC;AAGA,YAAI,OAAO,MAAM,QAAW;AACxB,sBAAY,QAAQ,QAAQ,MAAM;AAAA,QACtC;AAEA,YAAI,OAAO,WAAW,QAAW;AAE7B,iBAAO,SAAS,OAAO;AAAA,QAC3B;AAEA,mBAAW,SAAS,KAAK,KAAK,MAAM,WAAW,MAAM,CAAC;AAAA,MAC1D;AAAA,IACJ,CAAC;AAED,WAAO;AAAA,EACX;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"cac588d9ead82bf8a18e08492238887fb6b52d6a"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/clear-selection-all.command.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/clear-selection-all.command.ts","statementMap":{"0":{"start":{"line":13,"column":40},"end":{"line":68,"column":1}},"1":{"start":{"line":17,"column":34},"end":{"line":17,"column":70}},"2":{"start":{"line":18,"column":27},"end":{"line":18,"column":56}},"3":{"start":{"line":19,"column":36},"end":{"line":19,"column":73}},"4":{"start":{"line":20,"column":28},"end":{"line":20,"column":58}},"5":{"start":{"line":21,"column":36},"end":{"line":21,"column":73}},"6":{"start":{"line":22,"column":21},"end":{"line":22,"column":97}},"7":{"start":{"line":23,"column":4},"end":{"line":23,"column":32}},"8":{"start":{"line":23,"column":19},"end":{"line":23,"column":32}},"9":{"start":{"line":24,"column":19},"end":{"line":24,"column":57}},"10":{"start":{"line":25,"column":22},"end":{"line":25,"column":47}},"11":{"start":{"line":26,"column":4},"end":{"line":26,"column":33}},"12":{"start":{"line":26,"column":20},"end":{"line":26,"column":33}},"13":{"start":{"line":27,"column":22},"end":{"line":27,"column":65}},"14":{"start":{"line":28,"column":23},"end":{"line":28,"column":108}},"15":{"start":{"line":28,"column":100},"end":{"line":28,"column":107}},"16":{"start":{"line":29,"column":4},"end":{"line":31,"column":5}},"17":{"start":{"line":30,"column":6},"end":{"line":30,"column":19}},"18":{"start":{"line":32,"column":26},"end":{"line":32,"column":83}},"19":{"start":{"line":33,"column":32},"end":{"line":33,"column":34}},"20":{"start":{"line":34,"column":36},"end":{"line":34,"column":38}},"21":{"start":{"line":35,"column":32},"end":{"line":39,"column":5}},"22":{"start":{"line":40,"column":36},"end":{"line":43,"column":5}},"23":{"start":{"line":44,"column":4},"end":{"line":47,"column":7}},"24":{"start":{"line":48,"column":4},"end":{"line":51,"column":7}},"25":{"start":{"line":52,"column":24},"end":{"line":52,"column":101}},"26":{"start":{"line":53,"column":4},"end":{"line":53,"column":51}},"27":{"start":{"line":54,"column":4},"end":{"line":54,"column":58}},"28":{"start":{"line":55,"column":19},"end":{"line":55,"column":71}},"29":{"start":{"line":56,"column":4},"end":{"line":65,"column":5}},"30":{"start":{"line":57,"column":6},"end":{"line":63,"column":9}},"31":{"start":{"line":64,"column":6},"end":{"line":64,"column":18}},"32":{"start":{"line":66,"column":4},"end":{"line":66,"column":17}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":16,"column":11},"end":{"line":16,"column":12}},"loc":{"start":{"line":16,"column":33},"end":{"line":67,"column":3}},"line":16},"1":{"name":"(anonymous_1)","decl":{"start":{"line":28,"column":93},"end":{"line":28,"column":94}},"loc":{"start":{"line":28,"column":100},"end":{"line":28,"column":107}},"line":28}},"branchMap":{"0":{"loc":{"start":{"line":23,"column":4},"end":{"line":23,"column":32}},"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":23,"column":32}},{"start":{},"end":{}}],"line":23},"1":{"loc":{"start":{"line":24,"column":19},"end":{"line":24,"column":57}},"type":"binary-expr","locations":[{"start":{"line":24,"column":19},"end":{"line":24,"column":33}},{"start":{"line":24,"column":37},"end":{"line":24,"column":57}}],"line":24},"2":{"loc":{"start":{"line":26,"column":4},"end":{"line":26,"column":33}},"type":"if","locations":[{"start":{"line":26,"column":4},"end":{"line":26,"column":33}},{"start":{},"end":{}}],"line":26},"3":{"loc":{"start":{"line":27,"column":22},"end":{"line":27,"column":65}},"type":"binary-expr","locations":[{"start":{"line":27,"column":22},"end":{"line":27,"column":39}},{"start":{"line":27,"column":43},"end":{"line":27,"column":65}}],"line":27},"4":{"loc":{"start":{"line":28,"column":23},"end":{"line":28,"column":108}},"type":"binary-expr","locations":[{"start":{"line":28,"column":23},"end":{"line":28,"column":37}},{"start":{"line":28,"column":41},"end":{"line":28,"column":108}}],"line":28},"5":{"loc":{"start":{"line":29,"column":4},"end":{"line":31,"column":5}},"type":"if","locations":[{"start":{"line":29,"column":4},"end":{"line":31,"column":5}},{"start":{},"end":{}}],"line":29},"6":{"loc":{"start":{"line":56,"column":4},"end":{"line":65,"column":5}},"type":"if","locations":[{"start":{"line":56,"column":4},"end":{"line":65,"column":5}},{"start":{},"end":{}}],"line":56}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0},"f":{"0":0,"1":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/clear-selection-all.command.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand, IMutationInfo, IRange, Workbook } from '@univerjs/core';\nimport type { ISetRangeValuesMutationParams } from '../mutations/set-range-values.mutation';\n\nimport {\n    CommandType,\n    ICommandService,\n    IUndoRedoService,\n    IUniverInstanceService,\n    sequenceExecute,\n    UniverInstanceType,\n} from '@univerjs/core';\nimport { generateNullCell, getVisibleRanges } from '../../basics/utils';\nimport { SheetsSelectionsService } from '../../services/selections/selection.service';\nimport { SheetInterceptorService } from '../../services/sheet-interceptor/sheet-interceptor.service';\nimport { SetRangeValuesMutation, SetRangeValuesUndoMutationFactory } from '../mutations/set-range-values.mutation';\n\ninterface IClearSelectionAllCommandParams {\n    unitId?: string;\n    subUnitId?: string;\n    ranges?: IRange[];\n}\n\n/**\n * The command to clear all in current selected ranges.\n */\nexport const ClearSelectionAllCommand: ICommand = {\n    id: 'sheet.command.clear-selection-all',\n    type: CommandType.COMMAND,\n    handler: (accessor: IAccessor, params: IClearSelectionAllCommandParams) => {\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const commandService = accessor.get(ICommandService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n\n        const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        if (!workbook) return false;\n\n        const unitId = params?.unitId || workbook.getUnitId();\n        const worksheet = workbook.getActiveSheet();\n        if (!worksheet) return false;\n\n        const subUnitId = params?.subUnitId || worksheet.getSheetId();\n        const selections = params?.ranges || selectionManagerService.getCurrentSelections()?.map((s) => s.range);\n        if (!selections?.length) {\n            return false;\n        }\n        const visibleRanges = getVisibleRanges(selections, accessor, unitId, subUnitId);\n\n        const sequenceExecuteList: IMutationInfo[] = [];\n        const sequenceExecuteUndoList: IMutationInfo[] = [];\n\n        // clear style and content\n        const clearMutationParams: ISetRangeValuesMutationParams = {\n            subUnitId,\n            unitId,\n            cellValue: generateNullCell(visibleRanges),\n        };\n        const undoClearMutationParams: ISetRangeValuesMutationParams = SetRangeValuesUndoMutationFactory(\n            accessor,\n            clearMutationParams\n        );\n\n        sequenceExecuteList.push({\n            id: SetRangeValuesMutation.id,\n            params: clearMutationParams,\n        });\n        sequenceExecuteUndoList.push({\n            id: SetRangeValuesMutation.id,\n            params: undoClearMutationParams,\n        });\n\n        const intercepted = sheetInterceptorService.onCommandExecute({ id: ClearSelectionAllCommand.id });\n\n        sequenceExecuteList.push(...intercepted.redos);\n        sequenceExecuteUndoList.unshift(...intercepted.undos);\n        const result = sequenceExecute(sequenceExecuteList, commandService);\n\n        if (result) {\n            undoRedoService.pushUndoRedo({\n                // If there are multiple mutations that form an encapsulated project, they must be encapsulated in the same undo redo element.\n                // Hooks can be used to hook the code of external controllers to add new actions.\n                unitID: unitId,\n                undoMutations: sequenceExecuteUndoList,\n                redoMutations: sequenceExecuteList,\n            });\n\n            return true;\n        }\n\n        return false;\n    },\n};\n"],"mappings":"AAmBA;AAAA,EACI;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,OACG;AACP,SAAS,kBAAkB,wBAAwB;AACnD,SAAS,+BAA+B;AACxC,SAAS,+BAA+B;AACxC,SAAS,wBAAwB,yCAAyC;AAWnE,aAAM,2BAAqC;AAAA,EAC9C,IAAI;AAAA,EACJ,MAAM,YAAY;AAAA,EAClB,SAAS,CAAC,UAAqB,WAA4C;AACvE,UAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,UAAM,iBAAiB,SAAS,IAAI,eAAe;AACnD,UAAM,0BAA0B,SAAS,IAAI,uBAAuB;AACpE,UAAM,kBAAkB,SAAS,IAAI,gBAAgB;AACrD,UAAM,0BAA0B,SAAS,IAAI,uBAAuB;AAEpE,UAAM,WAAW,sBAAsB,sBAAgC,mBAAmB,YAAY;AACtG,QAAI,CAAC,SAAU,QAAO;AAEtB,UAAM,SAAS,QAAQ,UAAU,SAAS,UAAU;AACpD,UAAM,YAAY,SAAS,eAAe;AAC1C,QAAI,CAAC,UAAW,QAAO;AAEvB,UAAM,YAAY,QAAQ,aAAa,UAAU,WAAW;AAC5D,UAAM,aAAa,QAAQ,UAAU,wBAAwB,qBAAqB,GAAG,IAAI,CAAC,MAAM,EAAE,KAAK;AACvG,QAAI,CAAC,YAAY,QAAQ;AACrB,aAAO;AAAA,IACX;AACA,UAAM,gBAAgB,iBAAiB,YAAY,UAAU,QAAQ,SAAS;AAE9E,UAAM,sBAAuC,CAAC;AAC9C,UAAM,0BAA2C,CAAC;AAGlD,UAAM,sBAAqD;AAAA,MACvD;AAAA,MACA;AAAA,MACA,WAAW,iBAAiB,aAAa;AAAA,IAC7C;AACA,UAAM,0BAAyD;AAAA,MAC3D;AAAA,MACA;AAAA,IACJ;AAEA,wBAAoB,KAAK;AAAA,MACrB,IAAI,uBAAuB;AAAA,MAC3B,QAAQ;AAAA,IACZ,CAAC;AACD,4BAAwB,KAAK;AAAA,MACzB,IAAI,uBAAuB;AAAA,MAC3B,QAAQ;AAAA,IACZ,CAAC;AAED,UAAM,cAAc,wBAAwB,iBAAiB,EAAE,IAAI,yBAAyB,GAAG,CAAC;AAEhG,wBAAoB,KAAK,GAAG,YAAY,KAAK;AAC7C,4BAAwB,QAAQ,GAAG,YAAY,KAAK;AACpD,UAAM,SAAS,gBAAgB,qBAAqB,cAAc;AAElE,QAAI,QAAQ;AACR,sBAAgB,aAAa;AAAA;AAAA;AAAA,QAGzB,QAAQ;AAAA,QACR,eAAe;AAAA,QACf,eAAe;AAAA,MACnB,CAAC;AAED,aAAO;AAAA,IACX;AAEA,WAAO;AAAA,EACX;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2eb6db9ba4db7000e7c61a32f784ddeec7abe687"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/clear-selection-format.command.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/clear-selection-format.command.ts","statementMap":{"0":{"start":{"line":13,"column":43},"end":{"line":68,"column":1}},"1":{"start":{"line":17,"column":34},"end":{"line":17,"column":70}},"2":{"start":{"line":18,"column":27},"end":{"line":18,"column":56}},"3":{"start":{"line":19,"column":36},"end":{"line":19,"column":73}},"4":{"start":{"line":20,"column":28},"end":{"line":20,"column":58}},"5":{"start":{"line":21,"column":36},"end":{"line":21,"column":73}},"6":{"start":{"line":22,"column":21},"end":{"line":22,"column":97}},"7":{"start":{"line":23,"column":4},"end":{"line":23,"column":32}},"8":{"start":{"line":23,"column":19},"end":{"line":23,"column":32}},"9":{"start":{"line":24,"column":19},"end":{"line":24,"column":57}},"10":{"start":{"line":25,"column":22},"end":{"line":25,"column":47}},"11":{"start":{"line":26,"column":4},"end":{"line":26,"column":33}},"12":{"start":{"line":26,"column":20},"end":{"line":26,"column":33}},"13":{"start":{"line":27,"column":22},"end":{"line":27,"column":65}},"14":{"start":{"line":28,"column":19},"end":{"line":28,"column":104}},"15":{"start":{"line":28,"column":96},"end":{"line":28,"column":103}},"16":{"start":{"line":29,"column":4},"end":{"line":31,"column":5}},"17":{"start":{"line":30,"column":6},"end":{"line":30,"column":19}},"18":{"start":{"line":32,"column":26},"end":{"line":32,"column":79}},"19":{"start":{"line":33,"column":32},"end":{"line":33,"column":34}},"20":{"start":{"line":34,"column":36},"end":{"line":34,"column":38}},"21":{"start":{"line":35,"column":32},"end":{"line":39,"column":5}},"22":{"start":{"line":40,"column":36},"end":{"line":43,"column":5}},"23":{"start":{"line":44,"column":4},"end":{"line":47,"column":7}},"24":{"start":{"line":48,"column":4},"end":{"line":51,"column":7}},"25":{"start":{"line":52,"column":24},"end":{"line":52,"column":104}},"26":{"start":{"line":53,"column":4},"end":{"line":53,"column":51}},"27":{"start":{"line":54,"column":4},"end":{"line":54,"column":58}},"28":{"start":{"line":55,"column":19},"end":{"line":55,"column":71}},"29":{"start":{"line":56,"column":4},"end":{"line":65,"column":5}},"30":{"start":{"line":57,"column":6},"end":{"line":63,"column":9}},"31":{"start":{"line":64,"column":6},"end":{"line":64,"column":18}},"32":{"start":{"line":66,"column":4},"end":{"line":66,"column":17}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":16,"column":11},"end":{"line":16,"column":12}},"loc":{"start":{"line":16,"column":33},"end":{"line":67,"column":3}},"line":16},"1":{"name":"(anonymous_1)","decl":{"start":{"line":28,"column":89},"end":{"line":28,"column":90}},"loc":{"start":{"line":28,"column":96},"end":{"line":28,"column":103}},"line":28}},"branchMap":{"0":{"loc":{"start":{"line":23,"column":4},"end":{"line":23,"column":32}},"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":23,"column":32}},{"start":{},"end":{}}],"line":23},"1":{"loc":{"start":{"line":24,"column":19},"end":{"line":24,"column":57}},"type":"binary-expr","locations":[{"start":{"line":24,"column":19},"end":{"line":24,"column":33}},{"start":{"line":24,"column":37},"end":{"line":24,"column":57}}],"line":24},"2":{"loc":{"start":{"line":26,"column":4},"end":{"line":26,"column":33}},"type":"if","locations":[{"start":{"line":26,"column":4},"end":{"line":26,"column":33}},{"start":{},"end":{}}],"line":26},"3":{"loc":{"start":{"line":27,"column":22},"end":{"line":27,"column":65}},"type":"binary-expr","locations":[{"start":{"line":27,"column":22},"end":{"line":27,"column":39}},{"start":{"line":27,"column":43},"end":{"line":27,"column":65}}],"line":27},"4":{"loc":{"start":{"line":28,"column":19},"end":{"line":28,"column":104}},"type":"binary-expr","locations":[{"start":{"line":28,"column":19},"end":{"line":28,"column":33}},{"start":{"line":28,"column":37},"end":{"line":28,"column":104}}],"line":28},"5":{"loc":{"start":{"line":29,"column":4},"end":{"line":31,"column":5}},"type":"if","locations":[{"start":{"line":29,"column":4},"end":{"line":31,"column":5}},{"start":{},"end":{}}],"line":29},"6":{"loc":{"start":{"line":56,"column":4},"end":{"line":65,"column":5}},"type":"if","locations":[{"start":{"line":56,"column":4},"end":{"line":65,"column":5}},{"start":{},"end":{}}],"line":56}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0},"f":{"0":0,"1":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/clear-selection-format.command.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand, IMutationInfo, IRange, Workbook } from '@univerjs/core';\nimport type { ISetRangeValuesMutationParams } from '../mutations/set-range-values.mutation';\n\nimport {\n    CommandType,\n    ICommandService,\n    IUndoRedoService,\n    IUniverInstanceService,\n    sequenceExecute,\n    UniverInstanceType,\n} from '@univerjs/core';\nimport { generateNullCellStyle, getVisibleRanges } from '../../basics/utils';\nimport { SheetsSelectionsService } from '../../services/selections/selection.service';\nimport { SheetInterceptorService } from '../../services/sheet-interceptor/sheet-interceptor.service';\nimport { SetRangeValuesMutation, SetRangeValuesUndoMutationFactory } from '../mutations/set-range-values.mutation';\n\ninterface IClearSelectionFormatCommandParams {\n    unitId?: string;\n    subUnitId?: string;\n    ranges?: IRange[];\n}\n\n/**\n * The command to clear content in current selected ranges.\n */\nexport const ClearSelectionFormatCommand: ICommand = {\n    id: 'sheet.command.clear-selection-format',\n\n    type: CommandType.COMMAND,\n\n    handler: (accessor: IAccessor, params: IClearSelectionFormatCommandParams) => {\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const commandService = accessor.get(ICommandService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n\n        const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        if (!workbook) return false;\n\n        const unitId = params?.unitId || workbook.getUnitId();\n        const worksheet = workbook.getActiveSheet();\n        if (!worksheet) return false;\n\n        const subUnitId = params?.subUnitId || worksheet.getSheetId();\n        const ranges = params?.ranges || selectionManagerService.getCurrentSelections()?.map((s) => s.range);\n        if (!ranges?.length) {\n            return false;\n        }\n        const visibleRanges = getVisibleRanges(ranges, accessor, unitId, subUnitId);\n\n        const sequenceExecuteList: IMutationInfo[] = [];\n        const sequenceExecuteUndoList: IMutationInfo[] = [];\n\n        // clear style\n        const clearMutationParams: ISetRangeValuesMutationParams = {\n            subUnitId,\n            unitId,\n            cellValue: generateNullCellStyle(visibleRanges),\n        };\n        const undoClearMutationParams: ISetRangeValuesMutationParams = SetRangeValuesUndoMutationFactory(\n            accessor,\n            clearMutationParams\n        );\n\n        sequenceExecuteList.push({\n            id: SetRangeValuesMutation.id,\n            params: clearMutationParams,\n        });\n        sequenceExecuteUndoList.push({\n            id: SetRangeValuesMutation.id,\n            params: undoClearMutationParams,\n        });\n\n        const intercepted = sheetInterceptorService.onCommandExecute({ id: ClearSelectionFormatCommand.id });\n\n        sequenceExecuteList.push(...intercepted.redos);\n        sequenceExecuteUndoList.unshift(...intercepted.undos);\n\n        const result = sequenceExecute(sequenceExecuteList, commandService);\n\n        // const result = commandService.syncExecuteCommand(SetRangeValuesMutation.id, clearMutationParams);\n        if (result) {\n            undoRedoService.pushUndoRedo({\n                // If there are multiple mutations that form an encapsulated project, they must be encapsulated in the same undo redo element.\n                // Hooks can be used to hook the code of external controllers to add new actions.\n                unitID: unitId,\n                undoMutations: sequenceExecuteUndoList,\n                redoMutations: sequenceExecuteList,\n            });\n\n            return true;\n        }\n\n        return false;\n    },\n};\n"],"mappings":"AAmBA;AAAA,EACI;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,OACG;AACP,SAAS,uBAAuB,wBAAwB;AACxD,SAAS,+BAA+B;AACxC,SAAS,+BAA+B;AACxC,SAAS,wBAAwB,yCAAyC;AAWnE,aAAM,8BAAwC;AAAA,EACjD,IAAI;AAAA,EAEJ,MAAM,YAAY;AAAA,EAElB,SAAS,CAAC,UAAqB,WAA+C;AAC1E,UAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,UAAM,iBAAiB,SAAS,IAAI,eAAe;AACnD,UAAM,0BAA0B,SAAS,IAAI,uBAAuB;AACpE,UAAM,kBAAkB,SAAS,IAAI,gBAAgB;AACrD,UAAM,0BAA0B,SAAS,IAAI,uBAAuB;AAEpE,UAAM,WAAW,sBAAsB,sBAAgC,mBAAmB,YAAY;AACtG,QAAI,CAAC,SAAU,QAAO;AAEtB,UAAM,SAAS,QAAQ,UAAU,SAAS,UAAU;AACpD,UAAM,YAAY,SAAS,eAAe;AAC1C,QAAI,CAAC,UAAW,QAAO;AAEvB,UAAM,YAAY,QAAQ,aAAa,UAAU,WAAW;AAC5D,UAAM,SAAS,QAAQ,UAAU,wBAAwB,qBAAqB,GAAG,IAAI,CAAC,MAAM,EAAE,KAAK;AACnG,QAAI,CAAC,QAAQ,QAAQ;AACjB,aAAO;AAAA,IACX;AACA,UAAM,gBAAgB,iBAAiB,QAAQ,UAAU,QAAQ,SAAS;AAE1E,UAAM,sBAAuC,CAAC;AAC9C,UAAM,0BAA2C,CAAC;AAGlD,UAAM,sBAAqD;AAAA,MACvD;AAAA,MACA;AAAA,MACA,WAAW,sBAAsB,aAAa;AAAA,IAClD;AACA,UAAM,0BAAyD;AAAA,MAC3D;AAAA,MACA;AAAA,IACJ;AAEA,wBAAoB,KAAK;AAAA,MACrB,IAAI,uBAAuB;AAAA,MAC3B,QAAQ;AAAA,IACZ,CAAC;AACD,4BAAwB,KAAK;AAAA,MACzB,IAAI,uBAAuB;AAAA,MAC3B,QAAQ;AAAA,IACZ,CAAC;AAED,UAAM,cAAc,wBAAwB,iBAAiB,EAAE,IAAI,4BAA4B,GAAG,CAAC;AAEnG,wBAAoB,KAAK,GAAG,YAAY,KAAK;AAC7C,4BAAwB,QAAQ,GAAG,YAAY,KAAK;AAEpD,UAAM,SAAS,gBAAgB,qBAAqB,cAAc;AAGlE,QAAI,QAAQ;AACR,sBAAgB,aAAa;AAAA;AAAA;AAAA,QAGzB,QAAQ;AAAA,QACR,eAAe;AAAA,QACf,eAAe;AAAA,MACnB,CAAC;AAED,aAAO;AAAA,IACX;AAEA,WAAO;AAAA,EACX;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"49906a0f77ec62dad1a90eb24f209afd050ce1a2"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/move-range.mutation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/move-range.mutation.ts","statementMap":{"0":{"start":{"line":2,"column":33},"end":{"line":30,"column":1}},"1":{"start":{"line":6,"column":25},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":9,"column":5}},"3":{"start":{"line":8,"column":6},"end":{"line":8,"column":19}},"4":{"start":{"line":10,"column":34},"end":{"line":10,"column":70}},"5":{"start":{"line":11,"column":21},"end":{"line":11,"column":97}},"6":{"start":{"line":12,"column":4},"end":{"line":14,"column":5}},"7":{"start":{"line":13,"column":6},"end":{"line":13,"column":19}},"8":{"start":{"line":15,"column":26},"end":{"line":15,"column":75}},"9":{"start":{"line":16,"column":24},"end":{"line":16,"column":71}},"10":{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},"11":{"start":{"line":18,"column":6},"end":{"line":18,"column":19}},"12":{"start":{"line":20,"column":27},"end":{"line":20,"column":56}},"13":{"start":{"line":21,"column":25},"end":{"line":21,"column":52}},"14":{"start":{"line":22,"column":4},"end":{"line":24,"column":7}},"15":{"start":{"line":23,"column":6},"end":{"line":23,"column":48}},"16":{"start":{"line":25,"column":4},"end":{"line":27,"column":7}},"17":{"start":{"line":26,"column":6},"end":{"line":26,"column":46}},"18":{"start":{"line":28,"column":4},"end":{"line":28,"column":16}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":11},"end":{"line":5,"column":12}},"loc":{"start":{"line":5,"column":33},"end":{"line":29,"column":3}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":22,"column":42},"end":{"line":22,"column":43}},"loc":{"start":{"line":22,"column":64},"end":{"line":24,"column":5}},"line":22},"2":{"name":"(anonymous_2)","decl":{"start":{"line":25,"column":40},"end":{"line":25,"column":41}},"loc":{"start":{"line":25,"column":62},"end":{"line":27,"column":5}},"line":25}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":4},"end":{"line":9,"column":5}},"type":"if","locations":[{"start":{"line":7,"column":4},"end":{"line":9,"column":5}},{"start":{},"end":{}}],"line":7},"1":{"loc":{"start":{"line":7,"column":8},"end":{"line":7,"column":20}},"type":"binary-expr","locations":[{"start":{"line":7,"column":8},"end":{"line":7,"column":13}},{"start":{"line":7,"column":17},"end":{"line":7,"column":20}}],"line":7},"2":{"loc":{"start":{"line":12,"column":4},"end":{"line":14,"column":5}},"type":"if","locations":[{"start":{"line":12,"column":4},"end":{"line":14,"column":5}},{"start":{},"end":{}}],"line":12},"3":{"loc":{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},"type":"if","locations":[{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},{"start":{},"end":{}}],"line":17},"4":{"loc":{"start":{"line":17,"column":8},"end":{"line":17,"column":38}},"type":"binary-expr","locations":[{"start":{"line":17,"column":8},"end":{"line":17,"column":22}},{"start":{"line":17,"column":26},"end":{"line":17,"column":38}}],"line":17}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},"f":{"0":0,"1":0,"2":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/move-range.mutation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellData, IMutation, IObjectMatrixPrimitiveType, IRange, Nullable, Workbook } from '@univerjs/core';\nimport { CommandType, IUniverInstanceService, ObjectMatrix, UniverInstanceType } from '@univerjs/core';\n\nexport interface IMoveRangeMutationParams {\n    unitId: string;\n    fromRange: IRange;\n    toRange: IRange;\n    from: {\n        subUnitId: string;\n        value: IObjectMatrixPrimitiveType<Nullable<ICellData>>;\n    };\n    to: {\n        subUnitId: string;\n        value: IObjectMatrixPrimitiveType<Nullable<ICellData>>;\n    };\n}\n\nexport const MoveRangeMutation: IMutation<IMoveRangeMutationParams, boolean> = {\n    id: 'sheet.mutation.move-range',\n    type: CommandType.MUTATION,\n    handler: (accessor, params) => {\n        const { from, to } = params;\n\n        if (!from || !to) {\n            return false;\n        }\n\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        if (!workbook) {\n            return false;\n        }\n\n        const fromWorksheet = workbook.getSheetBySheetId(params.from.subUnitId);\n        const toWorksheet = workbook.getSheetBySheetId(params.to.subUnitId);\n\n        if (!fromWorksheet || !toWorksheet) {\n            return false;\n        }\n\n        const fromCellMatrix = fromWorksheet.getCellMatrix();\n        const toCellMatrix = toWorksheet.getCellMatrix();\n\n        new ObjectMatrix<Nullable<ICellData>>(from.value).forValue((row, col, newVal) => {\n            fromCellMatrix.setValue(row, col, newVal);\n        });\n\n        new ObjectMatrix<Nullable<ICellData>>(to.value).forValue((row, col, newVal) => {\n            toCellMatrix.setValue(row, col, newVal);\n        });\n\n        return true;\n    },\n};\n"],"mappings":"AAiBA,SAAS,aAAa,wBAAwB,cAAc,0BAA0B;AAgB/E,aAAM,oBAAkE;AAAA,EAC3E,IAAI;AAAA,EACJ,MAAM,YAAY;AAAA,EAClB,SAAS,CAAC,UAAU,WAAW;AAC3B,UAAM,EAAE,MAAM,GAAG,IAAI;AAErB,QAAI,CAAC,QAAQ,CAAC,IAAI;AACd,aAAO;AAAA,IACX;AAEA,UAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,UAAM,WAAW,sBAAsB,sBAAgC,mBAAmB,YAAY;AACtG,QAAI,CAAC,UAAU;AACX,aAAO;AAAA,IACX;AAEA,UAAM,gBAAgB,SAAS,kBAAkB,OAAO,KAAK,SAAS;AACtE,UAAM,cAAc,SAAS,kBAAkB,OAAO,GAAG,SAAS;AAElE,QAAI,CAAC,iBAAiB,CAAC,aAAa;AAChC,aAAO;AAAA,IACX;AAEA,UAAM,iBAAiB,cAAc,cAAc;AACnD,UAAM,eAAe,YAAY,cAAc;AAE/C,QAAI,aAAkC,KAAK,KAAK,EAAE,SAAS,CAAC,KAAK,KAAK,WAAW;AAC7E,qBAAe,SAAS,KAAK,KAAK,MAAM;AAAA,IAC5C,CAAC;AAED,QAAI,aAAkC,GAAG,KAAK,EAAE,SAAS,CAAC,KAAK,KAAK,WAAW;AAC3E,mBAAa,SAAS,KAAK,KAAK,MAAM;AAAA,IAC1C,CAAC;AAED,WAAO;AAAA,EACX;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"451da5749b100f709e0e613a585e3e778aa91c73"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/utils/selection-utils.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/utils/selection-utils.ts","statementMap":{"0":{"start":{"line":5,"column":29},"end":{"line":5,"column":96}},"1":{"start":{"line":6,"column":30},"end":{"line":6,"column":32}},"2":{"start":{"line":7,"column":2},"end":{"line":19,"column":5}},"3":{"start":{"line":8,"column":4},"end":{"line":18,"column":5}},"4":{"start":{"line":9,"column":30},"end":{"line":14,"column":7}},"5":{"start":{"line":15,"column":6},"end":{"line":17,"column":7}},"6":{"start":{"line":16,"column":8},"end":{"line":16,"column":50}},"7":{"start":{"line":20,"column":2},"end":{"line":22,"column":3}},"8":{"start":{"line":21,"column":4},"end":{"line":21,"column":22}},"9":{"start":{"line":23,"column":16},"end":{"line":23,"column":67}},"10":{"start":{"line":24,"column":2},"end":{"line":26,"column":3}},"11":{"start":{"line":25,"column":4},"end":{"line":25,"column":72}},"12":{"start":{"line":27,"column":2},"end":{"line":27,"column":15}},"13":{"start":{"line":30,"column":18},"end":{"line":30,"column":22}},"14":{"start":{"line":31,"column":17},"end":{"line":31,"column":71}},"15":{"start":{"line":32,"column":2},"end":{"line":45,"column":5}},"16":{"start":{"line":33,"column":4},"end":{"line":43,"column":6}},"17":{"start":{"line":44,"column":4},"end":{"line":44,"column":17}},"18":{"start":{"line":46,"column":2},"end":{"line":58,"column":3}},"19":{"start":{"line":47,"column":4},"end":{"line":57,"column":6}},"20":{"start":{"line":59,"column":2},"end":{"line":59,"column":19}},"21":{"start":{"line":62,"column":55},"end":{"line":62,"column":60}},"22":{"start":{"line":63,"column":2},"end":{"line":65,"column":3}},"23":{"start":{"line":64,"column":4},"end":{"line":64,"column":23}},"24":{"start":{"line":66,"column":2},"end":{"line":68,"column":3}},"25":{"start":{"line":67,"column":4},"end":{"line":67,"column":32}},"26":{"start":{"line":69,"column":2},"end":{"line":71,"column":3}},"27":{"start":{"line":70,"column":4},"end":{"line":70,"column":26}},"28":{"start":{"line":72,"column":2},"end":{"line":74,"column":3}},"29":{"start":{"line":73,"column":4},"end":{"line":73,"column":38}},"30":{"start":{"line":75,"column":2},"end":{"line":75,"column":15}},"31":{"start":{"line":78,"column":19},"end":{"line":78,"column":68}},"32":{"start":{"line":79,"column":22},"end":{"line":79,"column":77}},"33":{"start":{"line":80,"column":22},"end":{"line":80,"column":68}},"34":{"start":{"line":81,"column":2},"end":{"line":93,"column":3}},"35":{"start":{"line":82,"column":4},"end":{"line":92,"column":6}},"36":{"start":{"line":94,"column":2},"end":{"line":101,"column":4}},"37":{"start":{"line":104,"column":17},"end":{"line":104,"column":19}},"38":{"start":{"line":105,"column":2},"end":{"line":108,"column":5}},"39":{"start":{"line":106,"column":25},"end":{"line":106,"column":45}},"40":{"start":{"line":107,"column":4},"end":{"line":107,"column":28}},"41":{"start":{"line":109,"column":2},"end":{"line":109,"column":31}},"42":{"start":{"line":109,"column":24},"end":{"line":109,"column":29}},"43":{"start":{"line":110,"column":20},"end":{"line":110,"column":21}},"44":{"start":{"line":111,"column":2},"end":{"line":116,"column":3}},"45":{"start":{"line":111,"column":15},"end":{"line":111,"column":16}},"46":{"start":{"line":112,"column":18},"end":{"line":112,"column":27}},"47":{"start":{"line":113,"column":16},"end":{"line":113,"column":29}},"48":{"start":{"line":114,"column":19},"end":{"line":114,"column":30}},"49":{"start":{"line":115,"column":4},"end":{"line":115,"column":26}},"50":{"start":{"line":117,"column":2},"end":{"line":117,"column":25}},"51":{"start":{"line":119,"column":40},"end":{"line":127,"column":2}},"52":{"start":{"line":119,"column":73},"end":{"line":127,"column":1}},"53":{"start":{"line":129,"column":2},"end":{"line":131,"column":3}},"54":{"start":{"line":130,"column":4},"end":{"line":130,"column":17}},"55":{"start":{"line":132,"column":29},"end":{"line":132,"column":38}},"56":{"start":{"line":133,"column":2},"end":{"line":133,"column":42}},"57":{"start":{"line":138,"column":6},"end":{"line":145,"column":7}},"58":{"start":{"line":138,"column":19},"end":{"line":138,"column":33}},"59":{"start":{"line":139,"column":8},"end":{"line":141,"column":9}},"60":{"start":{"line":140,"column":10},"end":{"line":140,"column":19}},"61":{"start":{"line":142,"column":8},"end":{"line":144,"column":9}},"62":{"start":{"line":142,"column":21},"end":{"line":142,"column":38}},"63":{"start":{"line":143,"column":10},"end":{"line":143,"column":32}},"64":{"start":{"line":148,"column":4},"end":{"line":148,"column":20}},"65":{"start":{"line":150,"column":2},"end":{"line":152,"column":4}},"66":{"start":{"line":154,"column":42},"end":{"line":154,"column":101}},"67":{"start":{"line":154,"column":59},"end":{"line":154,"column":101}},"68":{"start":{"line":156,"column":20},"end":{"line":156,"column":22}},"69":{"start":{"line":157,"column":2},"end":{"line":168,"column":3}},"70":{"start":{"line":157,"column":17},"end":{"line":157,"column":25}},"71":{"start":{"line":158,"column":4},"end":{"line":167,"column":5}},"72":{"start":{"line":158,"column":22},"end":{"line":158,"column":33}},"73":{"start":{"line":159,"column":19},"end":{"line":159,"column":295}},"74":{"start":{"line":160,"column":6},"end":{"line":162,"column":7}},"75":{"start":{"line":161,"column":8},"end":{"line":161,"column":17}},"76":{"start":{"line":163,"column":6},"end":{"line":165,"column":7}},"77":{"start":{"line":164,"column":8},"end":{"line":164,"column":28}},"78":{"start":{"line":166,"column":6},"end":{"line":166,"column":45}},"79":{"start":{"line":169,"column":2},"end":{"line":169,"column":19}},"80":{"start":{"line":172,"column":20},"end":{"line":172,"column":22}},"81":{"start":{"line":173,"column":2},"end":{"line":195,"column":3}},"82":{"start":{"line":173,"column":17},"end":{"line":173,"column":25}},"83":{"start":{"line":174,"column":4},"end":{"line":194,"column":5}},"84":{"start":{"line":174,"column":22},"end":{"line":174,"column":33}},"85":{"start":{"line":175,"column":19},"end":{"line":175,"column":295}},"86":{"start":{"line":176,"column":6},"end":{"line":178,"column":7}},"87":{"start":{"line":177,"column":8},"end":{"line":177,"column":17}},"88":{"start":{"line":179,"column":6},"end":{"line":181,"column":7}},"89":{"start":{"line":180,"column":8},"end":{"line":180,"column":28}},"90":{"start":{"line":182,"column":6},"end":{"line":192,"column":7}},"91":{"start":{"line":183,"column":26},"end":{"line":183,"column":62}},"92":{"start":{"line":184,"column":8},"end":{"line":187,"column":9}},"93":{"start":{"line":185,"column":10},"end":{"line":185,"column":30}},"94":{"start":{"line":186,"column":10},"end":{"line":186,"column":53}},"95":{"start":{"line":189,"column":26},"end":{"line":189,"column":39}},"96":{"start":{"line":190,"column":8},"end":{"line":190,"column":28}},"97":{"start":{"line":191,"column":8},"end":{"line":191,"column":51}},"98":{"start":{"line":193,"column":6},"end":{"line":193,"column":45}},"99":{"start":{"line":196,"column":2},"end":{"line":196,"column":19}}},"fnMap":{"0":{"name":"alignToMergedCellsBorders","decl":{"start":{"line":4,"column":16},"end":{"line":4,"column":41}},"loc":{"start":{"line":4,"column":89},"end":{"line":28,"column":1}},"line":4},"1":{"name":"(anonymous_1)","decl":{"start":{"line":7,"column":30},"end":{"line":7,"column":31}},"loc":{"start":{"line":7,"column":51},"end":{"line":19,"column":3}},"line":7},"2":{"name":"getCellAtRowCol","decl":{"start":{"line":29,"column":16},"end":{"line":29,"column":31}},"loc":{"start":{"line":29,"column":53},"end":{"line":60,"column":1}},"line":29},"3":{"name":"(anonymous_3)","decl":{"start":{"line":32,"column":18},"end":{"line":32,"column":19}},"loc":{"start":{"line":32,"column":41},"end":{"line":45,"column":3}},"line":32},"4":{"name":"setEndForRange","decl":{"start":{"line":61,"column":16},"end":{"line":61,"column":30}},"loc":{"start":{"line":61,"column":61},"end":{"line":76,"column":1}},"line":61},"5":{"name":"getPrimaryForRange","decl":{"start":{"line":77,"column":16},"end":{"line":77,"column":34}},"loc":{"start":{"line":77,"column":53},"end":{"line":102,"column":1}},"line":77},"6":{"name":"calculateTotalLength","decl":{"start":{"line":103,"column":16},"end":{"line":103,"column":36}},"loc":{"start":{"line":103,"column":54},"end":{"line":118,"column":1}},"line":103},"7":{"name":"(anonymous_7)","decl":{"start":{"line":105,"column":39},"end":{"line":105,"column":40}},"loc":{"start":{"line":105,"column":48},"end":{"line":108,"column":3}},"line":105},"8":{"name":"(anonymous_8)","decl":{"start":{"line":109,"column":14},"end":{"line":109,"column":15}},"loc":{"start":{"line":109,"column":24},"end":{"line":109,"column":29}},"line":109},"9":{"name":"(anonymous_9)","decl":{"start":{"line":119,"column":40},"end":{"line":119,"column":41}},"loc":{"start":{"line":119,"column":73},"end":{"line":127,"column":1}},"line":119},"10":{"name":"isSingleCellSelection","decl":{"start":{"line":128,"column":16},"end":{"line":128,"column":37}},"loc":{"start":{"line":128,"column":49},"end":{"line":134,"column":1}},"line":128},"11":{"name":"createRangeIteratorWithSkipFilteredRows","decl":{"start":{"line":135,"column":16},"end":{"line":135,"column":55}},"loc":{"start":{"line":135,"column":63},"end":{"line":153,"column":1}},"line":135},"12":{"name":"forOperableEach","decl":{"start":{"line":136,"column":11},"end":{"line":136,"column":26}},"loc":{"start":{"line":136,"column":45},"end":{"line":149,"column":3}},"line":136},"13":{"name":"iterate","decl":{"start":{"line":137,"column":13},"end":{"line":137,"column":20}},"loc":{"start":{"line":137,"column":28},"end":{"line":146,"column":5}},"line":137},"14":{"name":"(anonymous_14)","decl":{"start":{"line":154,"column":42},"end":{"line":154,"column":43}},"loc":{"start":{"line":154,"column":59},"end":{"line":154,"column":101}},"line":154},"15":{"name":"copyRangeStyles","decl":{"start":{"line":155,"column":16},"end":{"line":155,"column":31}},"loc":{"start":{"line":155,"column":110},"end":{"line":170,"column":1}},"line":155},"16":{"name":"copyRangeStylesWithoutBorder","decl":{"start":{"line":171,"column":16},"end":{"line":171,"column":44}},"loc":{"start":{"line":171,"column":123},"end":{"line":197,"column":1}},"line":171}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":65},"end":{"line":4,"column":87}},"type":"default-arg","locations":[{"start":{"line":4,"column":83},"end":{"line":4,"column":87}}],"line":4},"1":{"loc":{"start":{"line":8,"column":4},"end":{"line":18,"column":5}},"type":"if","locations":[{"start":{"line":8,"column":4},"end":{"line":18,"column":5}},{"start":{},"end":{}}],"line":8},"2":{"loc":{"start":{"line":8,"column":8},"end":{"line":8,"column":60}},"type":"binary-expr","locations":[{"start":{"line":8,"column":8},"end":{"line":8,"column":32}},{"start":{"line":8,"column":36},"end":{"line":8,"column":60}}],"line":8},"3":{"loc":{"start":{"line":15,"column":6},"end":{"line":17,"column":7}},"type":"if","locations":[{"start":{"line":15,"column":6},"end":{"line":17,"column":7}},{"start":{},"end":{}}],"line":15},"4":{"loc":{"start":{"line":20,"column":2},"end":{"line":22,"column":3}},"type":"if","locations":[{"start":{"line":20,"column":2},"end":{"line":22,"column":3}},{"start":{},"end":{}}],"line":20},"5":{"loc":{"start":{"line":24,"column":2},"end":{"line":26,"column":3}},"type":"if","locations":[{"start":{"line":24,"column":2},"end":{"line":26,"column":3}},{"start":{},"end":{}}],"line":24},"6":{"loc":{"start":{"line":38,"column":16},"end":{"line":38,"column":68}},"type":"binary-expr","locations":[{"start":{"line":38,"column":16},"end":{"line":38,"column":40}},{"start":{"line":38,"column":44},"end":{"line":38,"column":68}}],"line":38},"7":{"loc":{"start":{"line":39,"column":24},"end":{"line":39,"column":76}},"type":"binary-expr","locations":[{"start":{"line":39,"column":24},"end":{"line":39,"column":48}},{"start":{"line":39,"column":52},"end":{"line":39,"column":76}}],"line":39},"8":{"loc":{"start":{"line":40,"column":22},"end":{"line":40,"column":70}},"type":"cond-expr","locations":[{"start":{"line":40,"column":49},"end":{"line":40,"column":66}},{"start":{"line":40,"column":69},"end":{"line":40,"column":70}}],"line":40},"9":{"loc":{"start":{"line":41,"column":25},"end":{"line":41,"column":73}},"type":"cond-expr","locations":[{"start":{"line":41,"column":52},"end":{"line":41,"column":69}},{"start":{"line":41,"column":72},"end":{"line":41,"column":73}}],"line":41},"10":{"loc":{"start":{"line":46,"column":2},"end":{"line":58,"column":3}},"type":"if","locations":[{"start":{"line":46,"column":2},"end":{"line":58,"column":3}},{"start":{},"end":{}}],"line":46},"11":{"loc":{"start":{"line":63,"column":2},"end":{"line":65,"column":3}},"type":"if","locations":[{"start":{"line":63,"column":2},"end":{"line":65,"column":3}},{"start":{},"end":{}}],"line":63},"12":{"loc":{"start":{"line":66,"column":2},"end":{"line":68,"column":3}},"type":"if","locations":[{"start":{"line":66,"column":2},"end":{"line":68,"column":3}},{"start":{},"end":{}}],"line":66},"13":{"loc":{"start":{"line":69,"column":2},"end":{"line":71,"column":3}},"type":"if","locations":[{"start":{"line":69,"column":2},"end":{"line":71,"column":3}},{"start":{},"end":{}}],"line":69},"14":{"loc":{"start":{"line":72,"column":2},"end":{"line":74,"column":3}},"type":"if","locations":[{"start":{"line":72,"column":2},"end":{"line":74,"column":3}},{"start":{},"end":{}}],"line":72},"15":{"loc":{"start":{"line":78,"column":19},"end":{"line":78,"column":68}},"type":"cond-expr","locations":[{"start":{"line":78,"column":50},"end":{"line":78,"column":51}},{"start":{"line":78,"column":54},"end":{"line":78,"column":68}}],"line":78},"16":{"loc":{"start":{"line":79,"column":22},"end":{"line":79,"column":77}},"type":"cond-expr","locations":[{"start":{"line":79,"column":56},"end":{"line":79,"column":57}},{"start":{"line":79,"column":60},"end":{"line":79,"column":77}}],"line":79},"17":{"loc":{"start":{"line":81,"column":2},"end":{"line":93,"column":3}},"type":"if","locations":[{"start":{"line":81,"column":2},"end":{"line":93,"column":3}},{"start":{},"end":{}}],"line":81},"18":{"loc":{"start":{"line":129,"column":2},"end":{"line":131,"column":3}},"type":"if","locations":[{"start":{"line":129,"column":2},"end":{"line":131,"column":3}},{"start":{},"end":{}}],"line":129},"19":{"loc":{"start":{"line":139,"column":8},"end":{"line":141,"column":9}},"type":"if","locations":[{"start":{"line":139,"column":8},"end":{"line":141,"column":9}},{"start":{},"end":{}}],"line":139},"20":{"loc":{"start":{"line":159,"column":19},"end":{"line":159,"column":295}},"type":"cond-expr","locations":[{"start":{"line":159,"column":27},"end":{"line":159,"column":161}},{"start":{"line":159,"column":164},"end":{"line":159,"column":295}}],"line":159},"21":{"loc":{"start":{"line":160,"column":6},"end":{"line":162,"column":7}},"type":"if","locations":[{"start":{"line":160,"column":6},"end":{"line":162,"column":7}},{"start":{},"end":{}}],"line":160},"22":{"loc":{"start":{"line":160,"column":10},"end":{"line":160,"column":26}},"type":"binary-expr","locations":[{"start":{"line":160,"column":10},"end":{"line":160,"column":15}},{"start":{"line":160,"column":19},"end":{"line":160,"column":26}}],"line":160},"23":{"loc":{"start":{"line":163,"column":6},"end":{"line":165,"column":7}},"type":"if","locations":[{"start":{"line":163,"column":6},"end":{"line":165,"column":7}},{"start":{},"end":{}}],"line":163},"24":{"loc":{"start":{"line":175,"column":19},"end":{"line":175,"column":295}},"type":"cond-expr","locations":[{"start":{"line":175,"column":27},"end":{"line":175,"column":161}},{"start":{"line":175,"column":164},"end":{"line":175,"column":295}}],"line":175},"25":{"loc":{"start":{"line":176,"column":6},"end":{"line":178,"column":7}},"type":"if","locations":[{"start":{"line":176,"column":6},"end":{"line":178,"column":7}},{"start":{},"end":{}}],"line":176},"26":{"loc":{"start":{"line":176,"column":10},"end":{"line":176,"column":26}},"type":"binary-expr","locations":[{"start":{"line":176,"column":10},"end":{"line":176,"column":15}},{"start":{"line":176,"column":19},"end":{"line":176,"column":26}}],"line":176},"27":{"loc":{"start":{"line":179,"column":6},"end":{"line":181,"column":7}},"type":"if","locations":[{"start":{"line":179,"column":6},"end":{"line":181,"column":7}},{"start":{},"end":{}}],"line":179},"28":{"loc":{"start":{"line":182,"column":6},"end":{"line":192,"column":7}},"type":"if","locations":[{"start":{"line":182,"column":6},"end":{"line":192,"column":7}},{"start":{"line":188,"column":13},"end":{"line":192,"column":7}}],"line":182},"29":{"loc":{"start":{"line":184,"column":8},"end":{"line":187,"column":9}},"type":"if","locations":[{"start":{"line":184,"column":8},"end":{"line":187,"column":9}},{"start":{},"end":{}}],"line":184}},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":2,"32":2,"33":2,"34":2,"35":2,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":1,"52":2,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":1,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":2,"6":0,"7":0,"8":0,"9":2,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"b":{"0":[0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,2],"16":[0,2],"17":[2,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/utils/selection-utils.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellData, IInterceptor, IObjectMatrixPrimitiveType, IRange, ISelectionCell, Nullable, Workbook, Worksheet } from '@univerjs/core';\nimport type { ISelectionWithStyle } from '../../../basics/selection';\n\nimport type { ISetSelectionsOperationParams } from '../../operations/selection.operation';\nimport { RANGE_TYPE, Rectangle, selectionToArray } from '@univerjs/core';\nimport { IgnoreRangeThemeInterceptorKey, RangeThemeInterceptorId } from '../../../services/sheet-interceptor/interceptor-const';\nimport { SetSelectionsOperation } from '../../operations/selection.operation';\n\nexport interface IExpandParams {\n    left?: boolean;\n    right?: boolean;\n    up?: boolean;\n    down?: boolean;\n}\n\n/**\n * Adjust the range to align merged cell's borders.\n */\nexport function alignToMergedCellsBorders(startRange: IRange, worksheet: Worksheet, shouldRecursive = true) {\n    const coveredMergedCells = worksheet.getMatrixWithMergedCells(...selectionToArray(startRange));\n    const exceededMergedCells: IRange[] = [];\n\n    coveredMergedCells.forValue((row, col, value) => {\n        if (value.colSpan !== undefined && value.rowSpan !== undefined) {\n            const mergedCellRange = {\n                startRow: row,\n                startColumn: col,\n                endRow: row + value.rowSpan! - 1,\n                endColumn: col + value.colSpan! - 1,\n            };\n\n            if (!Rectangle.contains(startRange, mergedCellRange)) {\n                exceededMergedCells.push(mergedCellRange);\n            }\n        }\n    });\n\n    if (exceededMergedCells.length === 0) {\n        return startRange;\n    }\n\n    const union = Rectangle.union(startRange, ...exceededMergedCells);\n    if (shouldRecursive) {\n        return alignToMergedCellsBorders(union, worksheet, shouldRecursive);\n    }\n    return union;\n}\n\nexport function getCellAtRowCol(row: number, col: number, worksheet: Worksheet): ISelectionCell {\n    let destRange: ISelectionCell | null = null;\n\n    const matrix = worksheet.getMatrixWithMergedCells(row, col, row, col);\n    matrix.forValue((row, col, value) => {\n        destRange = {\n            actualRow: row,\n            actualColumn: col,\n            startRow: row,\n            startColumn: col,\n            isMerged: value.rowSpan !== undefined || value.colSpan !== undefined,\n            isMergedMainCell: value.rowSpan !== undefined && value.colSpan !== undefined,\n            endRow: row + (value.rowSpan !== undefined ? value.rowSpan - 1 : 0),\n            endColumn: col + (value.colSpan !== undefined ? value.colSpan - 1 : 0),\n            rangeType: RANGE_TYPE.NORMAL,\n        };\n\n        return false;\n    });\n\n    if (!destRange) {\n        return {\n            actualColumn: col,\n            actualRow: row,\n            startRow: row,\n            startColumn: col,\n            endRow: row,\n            endColumn: col,\n            isMerged: false,\n            isMergedMainCell: false,\n            rangeType: RANGE_TYPE.NORMAL,\n        };\n    }\n\n    return destRange;\n}\n\nexport function setEndForRange(range: IRange, rowCount: number, columnCount: number) {\n    const { startRow, startColumn, endRow, endColumn } = range;\n\n    if (Number.isNaN(startRow)) {\n        range.startRow = 0;\n    }\n\n    if (Number.isNaN(endRow)) {\n        range.endRow = rowCount - 1;\n    }\n\n    if (Number.isNaN(startColumn)) {\n        range.startColumn = 0;\n    }\n\n    if (Number.isNaN(endColumn)) {\n        range.endColumn = columnCount - 1;\n    }\n\n    return range;\n}\n\n/**\n * Get the default primary cell (the most top-left cell) of a range.\n * @param range\n * @param worksheet\n */\nexport function getPrimaryForRange(range: IRange, worksheet: Worksheet): ISelectionCell {\n    const startRow = Number.isNaN(range.startRow) ? 0 : range.startRow;\n    const startColumn = Number.isNaN(range.startColumn) ? 0 : range.startColumn;\n    const mergedRange = worksheet.getMergedCell(startRow, startColumn);\n    if (!mergedRange) {\n        return {\n            startRow,\n            startColumn,\n            endRow: range.startRow,\n            endColumn: range.startColumn,\n            actualRow: startRow,\n            actualColumn: startColumn,\n            rangeType: RANGE_TYPE.NORMAL,\n            isMerged: false,\n            isMergedMainCell: false,\n        };\n    }\n\n    return {\n        ...mergedRange,\n        actualRow: startRow,\n        actualColumn: startColumn,\n        rangeType: RANGE_TYPE.NORMAL,\n        isMerged: true,\n        isMergedMainCell: true,\n    };\n}\n\nexport interface IInterval {\n    [index: string]: [start: number, end: number];\n}\n\n/**\n * Calculate the real length of the intervals\n * @param intervalsObject\n * @returns\n */\nexport function calculateTotalLength(intervalsObject: IInterval): number {\n    const points: number[] = [];\n\n    // Put the start and end points of the interval into the points array\n\n    Object.keys(intervalsObject).forEach((key: string) => {\n        const [start, end] = intervalsObject[key];\n        points.push(start, end);\n    });\n\n    // Sort the points array\n    points.sort((a, b) => a - b);\n\n    let totalLength = 0;\n    for (let i = 0; i < points.length - 1; i++) {\n        const start = points[i];\n        const end = points[i + 1];\n        const length = end - start;\n        totalLength += length;\n    }\n\n    return totalLength + 1;\n}\n\nexport const followSelectionOperation = (range: IRange, workbook: Workbook, worksheet: Worksheet) => ({\n    id: SetSelectionsOperation.id,\n    params: {\n        unitId: workbook.getUnitId(),\n        subUnitId: worksheet.getSheetId(),\n        reveal: true,\n        selections: [{ range, primary: getPrimaryForRange(range, worksheet) }],\n    } as ISetSelectionsOperationParams,\n});\n\n/**\n * Examine if a selection only contains a single cell (a merged cell is considered as a single cell in this case).\n * @param selection\n * @returns `true` if the selection only contains a single cell.\n */\nexport function isSingleCellSelection(selection: Nullable<ISelectionWithStyle & { primary: ISelectionCell }>): boolean {\n    if (!selection) {\n        return false;\n    }\n\n    const { range, primary } = selection;\n    return Rectangle.equals(range, primary);\n}\n/**\n * Create an iterator to iterate over cells in range.\n * It will skip the row that has been filtered.\n * @param sheet bind a sheet\n * @returns iterator\n */\nexport function createRangeIteratorWithSkipFilteredRows(sheet: Worksheet) {\n    function forOperableEach(ranges: IRange, operator: (row: number, col: number, range: IRange) => void) {\n        function iterate(range: IRange) {\n            for (let r = range.startRow; r <= range.endRow; r++) {\n                if (sheet.getRowFiltered(r)) {\n                    continue;\n                }\n                for (let c = range.startColumn; c <= range.endColumn; c++) {\n                    operator(r, c, range);\n                }\n            }\n        };\n        iterate(ranges);\n    }\n    return {\n        forOperableEach,\n    };\n}\n\nconst ignoreRangeThemeInterceptorFilter = (interceptor: IInterceptor<unknown, unknown>) => interceptor.id !== RangeThemeInterceptorId;\n\n/**\n * Copy the styles of a range of cells to another range. Used for insert row and insert column.\n * @param worksheet\n * @param startRow\n * @param endRow\n * @param startColumn\n * @param endColumn\n * @param isRow\n * @param sourceRangeIndex\n */\nexport function copyRangeStyles(\n    worksheet: Worksheet,\n    startRow: number,\n    endRow: number,\n    startColumn: number,\n    endColumn: number,\n    isRow: boolean,\n    sourceRangeIndex: number\n): IObjectMatrixPrimitiveType<ICellData> {\n    const cellValue: IObjectMatrixPrimitiveType<ICellData> = {};\n    for (let row = startRow; row <= endRow; row++) {\n        for (let column = startColumn; column <= endColumn; column++) {\n            const cell = isRow ?\n                worksheet.getCellWithFilteredInterceptors(sourceRangeIndex, column, IgnoreRangeThemeInterceptorKey, ignoreRangeThemeInterceptorFilter)\n                : worksheet.getCellWithFilteredInterceptors(row, sourceRangeIndex, IgnoreRangeThemeInterceptorKey, ignoreRangeThemeInterceptorFilter);\n\n            if (!cell || !cell.s) {\n                continue;\n            }\n            if (!cellValue[row]) {\n                cellValue[row] = {};\n            }\n            cellValue[row][column] = { s: cell.s };\n        }\n    }\n    return cellValue;\n}\n\nexport function copyRangeStylesWithoutBorder(\n    worksheet: Worksheet,\n    startRow: number,\n    endRow: number,\n    startColumn: number,\n    endColumn: number,\n    isRow: boolean,\n    styleRowOrColumn: number\n): IObjectMatrixPrimitiveType<ICellData> {\n    const cellValue: IObjectMatrixPrimitiveType<ICellData> = {};\n    for (let row = startRow; row <= endRow; row++) {\n        for (let column = startColumn; column <= endColumn; column++) {\n            const cell = isRow\n                ? worksheet.getCellWithFilteredInterceptors(styleRowOrColumn, column, IgnoreRangeThemeInterceptorKey, ignoreRangeThemeInterceptorFilter)\n                : worksheet.getCellWithFilteredInterceptors(row, styleRowOrColumn, IgnoreRangeThemeInterceptorKey, ignoreRangeThemeInterceptorFilter);\n\n            if (!cell || !cell.s) {\n                continue;\n            }\n            if (!cellValue[row]) {\n                cellValue[row] = {};\n            }\n\n            // univer-pro/issues/3016  insert row/column should not reuse border style\n            if (typeof cell.s === 'string') {\n                const styleData = worksheet.getStyleDataByHash(cell.s);\n                if (styleData) {\n                    delete styleData.bd;\n                    cell.s = worksheet.setStyleData(styleData);\n                }\n            } else {\n                const styleData = { ...cell.s };\n                delete styleData.bd;\n                cell.s = worksheet.setStyleData(styleData);\n            }\n            cellValue[row][column] = { s: cell.s };\n        }\n    }\n    return cellValue;\n}\n"],"mappings":"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","names":["row","col"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"64d079424728a5fd2c1812357554b6d105798e81"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/utils/target-util.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/utils/target-util.ts","statementMap":{"0":{"start":{"line":3,"column":21},"end":{"line":3,"column":27}},"1":{"start":{"line":4,"column":19},"end":{"line":4,"column":159}},"2":{"start":{"line":5,"column":2},"end":{"line":5,"column":29}},"3":{"start":{"line":5,"column":17},"end":{"line":5,"column":29}},"4":{"start":{"line":6,"column":2},"end":{"line":9,"column":4}},"5":{"start":{"line":12,"column":32},"end":{"line":12,"column":38}},"6":{"start":{"line":13,"column":19},"end":{"line":13,"column":159}},"7":{"start":{"line":14,"column":2},"end":{"line":14,"column":29}},"8":{"start":{"line":14,"column":17},"end":{"line":14,"column":29}},"9":{"start":{"line":15,"column":20},"end":{"line":15,"column":101}},"10":{"start":{"line":16,"column":2},"end":{"line":18,"column":3}},"11":{"start":{"line":17,"column":4},"end":{"line":17,"column":16}},"12":{"start":{"line":19,"column":2},"end":{"line":24,"column":4}},"13":{"start":{"line":27,"column":32},"end":{"line":27,"column":38}},"14":{"start":{"line":28,"column":19},"end":{"line":28,"column":71}},"15":{"start":{"line":29,"column":2},"end":{"line":29,"column":29}},"16":{"start":{"line":29,"column":17},"end":{"line":29,"column":29}},"17":{"start":{"line":30,"column":20},"end":{"line":30,"column":57}},"18":{"start":{"line":31,"column":2},"end":{"line":33,"column":3}},"19":{"start":{"line":32,"column":4},"end":{"line":32,"column":16}},"20":{"start":{"line":34,"column":2},"end":{"line":37,"column":4}}},"fnMap":{"0":{"name":"getSheetCommandTargetWorkbook","decl":{"start":{"line":2,"column":16},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":77},"end":{"line":10,"column":1}},"line":2},"1":{"name":"getSheetCommandTarget","decl":{"start":{"line":11,"column":16},"end":{"line":11,"column":37}},"loc":{"start":{"line":11,"column":74},"end":{"line":25,"column":1}},"line":11},"2":{"name":"getSheetMutationTarget","decl":{"start":{"line":26,"column":16},"end":{"line":26,"column":38}},"loc":{"start":{"line":26,"column":70},"end":{"line":38,"column":1}},"line":26}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":19},"end":{"line":4,"column":159}},"type":"cond-expr","locations":[{"start":{"line":4,"column":28},"end":{"line":4,"column":80}},{"start":{"line":4,"column":83},"end":{"line":4,"column":159}}],"line":4},"1":{"loc":{"start":{"line":5,"column":2},"end":{"line":5,"column":29}},"type":"if","locations":[{"start":{"line":5,"column":2},"end":{"line":5,"column":29}},{"start":{},"end":{}}],"line":5},"2":{"loc":{"start":{"line":11,"column":61},"end":{"line":11,"column":72}},"type":"default-arg","locations":[{"start":{"line":11,"column":70},"end":{"line":11,"column":72}}],"line":11},"3":{"loc":{"start":{"line":13,"column":19},"end":{"line":13,"column":159}},"type":"cond-expr","locations":[{"start":{"line":13,"column":28},"end":{"line":13,"column":80}},{"start":{"line":13,"column":83},"end":{"line":13,"column":159}}],"line":13},"4":{"loc":{"start":{"line":14,"column":2},"end":{"line":14,"column":29}},"type":"if","locations":[{"start":{"line":14,"column":2},"end":{"line":14,"column":29}},{"start":{},"end":{}}],"line":14},"5":{"loc":{"start":{"line":15,"column":20},"end":{"line":15,"column":101}},"type":"cond-expr","locations":[{"start":{"line":15,"column":32},"end":{"line":15,"column":69}},{"start":{"line":15,"column":72},"end":{"line":15,"column":101}}],"line":15},"6":{"loc":{"start":{"line":16,"column":2},"end":{"line":18,"column":3}},"type":"if","locations":[{"start":{"line":16,"column":2},"end":{"line":18,"column":3}},{"start":{},"end":{}}],"line":16},"7":{"loc":{"start":{"line":29,"column":2},"end":{"line":29,"column":29}},"type":"if","locations":[{"start":{"line":29,"column":2},"end":{"line":29,"column":29}},{"start":{},"end":{}}],"line":29},"8":{"loc":{"start":{"line":31,"column":2},"end":{"line":33,"column":3}},"type":"if","locations":[{"start":{"line":31,"column":2},"end":{"line":33,"column":3}},{"start":{},"end":{}}],"line":31}},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":4,"6":4,"7":4,"8":0,"9":4,"10":4,"11":0,"12":4,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},"f":{"0":0,"1":4,"2":0},"b":{"0":[0,0],"1":[0,0],"2":[2],"3":[2,2],"4":[0,4],"5":[2,2],"6":[0,4],"7":[0,0],"8":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/utils/target-util.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type IUniverInstanceService, type Nullable, UniverInstanceType, type Workbook, type Worksheet } from '@univerjs/core';\n\nexport function getSheetCommandTargetWorkbook(univerInstanceService: IUniverInstanceService, params: { unitId?: string }): Nullable<{\n    workbook: Workbook;\n    unitId: string;\n}> {\n    const { unitId } = params;\n    const workbook = unitId\n        ? univerInstanceService.getUniverSheetInstance(unitId)\n        : univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n\n    if (!workbook) return null;\n\n    return {\n        workbook,\n        unitId: workbook.getUnitId(),\n    };\n}\n\nexport interface IResult {\n    workbook: Workbook;\n    worksheet: Worksheet;\n    unitId: string;\n    subUnitId: string;\n}\n\n/**\n * Get targeted Workbook & Worksheet of a command. If `unitId` and `subUnitId` are given, the function would\n * try to get these instances. If not, it would try to get the current active instances.\n *\n * @param univerInstanceService\n * @param params - unitId and subUnitId\n * @param params.unitId - The unitId of the Workbook\n * @param params.subUnitId - The subUnitId of the Worksheet\n * @returns Targeted Workbook & Worksheet\n */\nexport function getSheetCommandTarget(univerInstanceService: IUniverInstanceService, params: { unitId?: string; subUnitId?: string } = {}): Nullable<IResult> {\n    const { unitId, subUnitId } = params;\n\n    const workbook = unitId\n        ? univerInstanceService.getUniverSheetInstance(unitId)\n        : univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    if (!workbook) return null;\n\n    const worksheet = subUnitId ? workbook.getSheetBySheetId(subUnitId) : workbook.getActiveSheet(true);\n    if (!worksheet) {\n        return null;\n    }\n\n    return {\n        worksheet,\n        workbook,\n        unitId: workbook.getUnitId(),\n        subUnitId: worksheet.getSheetId(),\n    };\n}\n\nexport function getSheetMutationTarget(univerInstanceService: IUniverInstanceService, params: { unitId: string; subUnitId: string }): Nullable<Pick<IResult, 'workbook' | 'worksheet'>> {\n    const { unitId, subUnitId } = params;\n\n    const workbook = univerInstanceService.getUniverSheetInstance(unitId);\n    if (!workbook) return null;\n\n    const worksheet = workbook.getSheetBySheetId(subUnitId);\n    if (!worksheet) {\n        return null;\n    }\n\n    return {\n        worksheet,\n        workbook,\n    };\n}\n"],"mappings":"AAgBA,SAAqD,0BAAyD;AAEvG,gBAAS,8BAA8B,uBAA+C,QAG1F;AACC,QAAM,EAAE,OAAO,IAAI;AACnB,QAAM,WAAW,SACX,sBAAsB,uBAAuB,MAAM,IACnD,sBAAsB,sBAAgC,mBAAmB,YAAY;AAE3F,MAAI,CAAC,SAAU,QAAO;AAEtB,SAAO;AAAA,IACH;AAAA,IACA,QAAQ,SAAS,UAAU;AAAA,EAC/B;AACJ;AAmBO,gBAAS,sBAAsB,uBAA+C,SAAkD,CAAC,GAAsB;AAC1J,QAAM,EAAE,QAAQ,UAAU,IAAI;AAE9B,QAAM,WAAW,SACX,sBAAsB,uBAAuB,MAAM,IACnD,sBAAsB,sBAAgC,mBAAmB,YAAY;AAC3F,MAAI,CAAC,SAAU,QAAO;AAEtB,QAAM,YAAY,YAAY,SAAS,kBAAkB,SAAS,IAAI,SAAS,eAAe,IAAI;AAClG,MAAI,CAAC,WAAW;AACZ,WAAO;AAAA,EACX;AAEA,SAAO;AAAA,IACH;AAAA,IACA;AAAA,IACA,QAAQ,SAAS,UAAU;AAAA,IAC3B,WAAW,UAAU,WAAW;AAAA,EACpC;AACJ;AAEO,gBAAS,uBAAuB,uBAA+C,QAAkG;AACpL,QAAM,EAAE,QAAQ,UAAU,IAAI;AAE9B,QAAM,WAAW,sBAAsB,uBAAuB,MAAM;AACpE,MAAI,CAAC,SAAU,QAAO;AAEtB,QAAM,YAAY,SAAS,kBAAkB,SAAS;AACtD,MAAI,CAAC,WAAW;AACZ,WAAO;AAAA,EACX;AAEA,SAAO;AAAA,IACH;AAAA,IACA;AAAA,EACJ;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"80d2c4ddf9c0f11306f8b30b3ff160bf961cfc34"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/ref-selections.service.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/ref-selections.service.ts","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":37}},"1":{"start":{"line":2,"column":23},"end":{"line":2,"column":54}},"2":{"start":{"line":3,"column":22},"end":{"line":10,"column":1}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"4":{"start":{"line":5,"column":2},"end":{"line":7,"column":85}},"5":{"start":{"line":5,"column":15},"end":{"line":5,"column":36}},"6":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"7":{"start":{"line":7,"column":6},"end":{"line":7,"column":85}},"8":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"9":{"start":{"line":8,"column":22},"end":{"line":8,"column":53}},"10":{"start":{"line":9,"column":2},"end":{"line":9,"column":16}},"11":{"start":{"line":11,"column":22},"end":{"line":11,"column":90}},"12":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"13":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"14":{"start":{"line":15,"column":37},"end":{"line":15,"column":94}},"15":{"start":{"line":16,"column":34},"end":{"line":41,"column":1}},"16":{"start":{"line":18,"column":4},"end":{"line":18,"column":24}},"17":{"start":{"line":21,"column":14},"end":{"line":21,"column":71}},"18":{"start":{"line":22,"column":4},"end":{"line":22,"column":105}},"19":{"start":{"line":22,"column":56},"end":{"line":22,"column":102}},"20":{"start":{"line":22,"column":79},"end":{"line":22,"column":100}},"21":{"start":{"line":23,"column":4},"end":{"line":23,"column":99}},"22":{"start":{"line":23,"column":53},"end":{"line":23,"column":96}},"23":{"start":{"line":23,"column":76},"end":{"line":23,"column":94}},"24":{"start":{"line":24,"column":4},"end":{"line":24,"column":101}},"25":{"start":{"line":24,"column":54},"end":{"line":24,"column":98}},"26":{"start":{"line":24,"column":77},"end":{"line":24,"column":96}},"27":{"start":{"line":25,"column":4},"end":{"line":25,"column":93}},"28":{"start":{"line":25,"column":50},"end":{"line":25,"column":90}},"29":{"start":{"line":25,"column":73},"end":{"line":25,"column":88}},"30":{"start":{"line":28,"column":27},"end":{"line":28,"column":96}},"31":{"start":{"line":29,"column":4},"end":{"line":29,"column":94}},"32":{"start":{"line":29,"column":41},"end":{"line":29,"column":92}},"33":{"start":{"line":30,"column":23},"end":{"line":30,"column":58}},"34":{"start":{"line":31,"column":4},"end":{"line":34,"column":8}},"35":{"start":{"line":32,"column":6},"end":{"line":32,"column":58}},"36":{"start":{"line":33,"column":6},"end":{"line":33,"column":60}},"37":{"start":{"line":35,"column":4},"end":{"line":38,"column":8}},"38":{"start":{"line":36,"column":6},"end":{"line":36,"column":58}},"39":{"start":{"line":37,"column":6},"end":{"line":37,"column":81}},"40":{"start":{"line":37,"column":61},"end":{"line":37,"column":78}},"41":{"start":{"line":39,"column":4},"end":{"line":39,"column":115}},"42":{"start":{"line":39,"column":46},"end":{"line":39,"column":112}},"43":{"start":{"line":39,"column":67},"end":{"line":39,"column":111}},"44":{"start":{"line":42,"column":0},"end":{"line":44,"column":25}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":22},"end":{"line":3,"column":23}},"loc":{"start":{"line":3,"column":57},"end":{"line":10,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":44},"end":{"line":11,"column":45}},"loc":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":17,"column":2},"end":{"line":17,"column":3}},"loc":{"start":{"line":17,"column":28},"end":{"line":19,"column":3}},"line":17},"4":{"name":"(anonymous_4)","decl":{"start":{"line":20,"column":2},"end":{"line":20,"column":3}},"loc":{"start":{"line":20,"column":10},"end":{"line":26,"column":3}},"line":20},"5":{"name":"(anonymous_5)","decl":{"start":{"line":22,"column":48},"end":{"line":22,"column":49}},"loc":{"start":{"line":22,"column":56},"end":{"line":22,"column":102}},"line":22},"6":{"name":"(anonymous_6)","decl":{"start":{"line":22,"column":72},"end":{"line":22,"column":73}},"loc":{"start":{"line":22,"column":79},"end":{"line":22,"column":100}},"line":22},"7":{"name":"(anonymous_7)","decl":{"start":{"line":23,"column":45},"end":{"line":23,"column":46}},"loc":{"start":{"line":23,"column":53},"end":{"line":23,"column":96}},"line":23},"8":{"name":"(anonymous_8)","decl":{"start":{"line":23,"column":69},"end":{"line":23,"column":70}},"loc":{"start":{"line":23,"column":76},"end":{"line":23,"column":94}},"line":23},"9":{"name":"(anonymous_9)","decl":{"start":{"line":24,"column":46},"end":{"line":24,"column":47}},"loc":{"start":{"line":24,"column":54},"end":{"line":24,"column":98}},"line":24},"10":{"name":"(anonymous_10)","decl":{"start":{"line":24,"column":70},"end":{"line":24,"column":71}},"loc":{"start":{"line":24,"column":77},"end":{"line":24,"column":96}},"line":24},"11":{"name":"(anonymous_11)","decl":{"start":{"line":25,"column":42},"end":{"line":25,"column":43}},"loc":{"start":{"line":25,"column":50},"end":{"line":25,"column":90}},"line":25},"12":{"name":"(anonymous_12)","decl":{"start":{"line":25,"column":66},"end":{"line":25,"column":67}},"loc":{"start":{"line":25,"column":73},"end":{"line":25,"column":88}},"line":25},"13":{"name":"(anonymous_13)","decl":{"start":{"line":27,"column":2},"end":{"line":27,"column":3}},"loc":{"start":{"line":27,"column":24},"end":{"line":40,"column":3}},"line":27},"14":{"name":"(anonymous_14)","decl":{"start":{"line":29,"column":27},"end":{"line":29,"column":28}},"loc":{"start":{"line":29,"column":41},"end":{"line":29,"column":92}},"line":29},"15":{"name":"(anonymous_15)","decl":{"start":{"line":31,"column":104},"end":{"line":31,"column":105}},"loc":{"start":{"line":31,"column":118},"end":{"line":34,"column":5}},"line":31},"16":{"name":"(anonymous_16)","decl":{"start":{"line":35,"column":107},"end":{"line":35,"column":108}},"loc":{"start":{"line":35,"column":121},"end":{"line":38,"column":5}},"line":35},"17":{"name":"(anonymous_17)","decl":{"start":{"line":37,"column":51},"end":{"line":37,"column":52}},"loc":{"start":{"line":37,"column":61},"end":{"line":37,"column":78}},"line":37},"18":{"name":"(anonymous_18)","decl":{"start":{"line":39,"column":31},"end":{"line":39,"column":32}},"loc":{"start":{"line":39,"column":46},"end":{"line":39,"column":112}},"line":39},"19":{"name":"(anonymous_19)","decl":{"start":{"line":39,"column":60},"end":{"line":39,"column":61}},"loc":{"start":{"line":39,"column":67},"end":{"line":39,"column":111}},"line":39}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":26},"end":{"line":4,"column":32}},{"start":{"line":4,"column":35},"end":{"line":4,"column":80}}],"line":4},"1":{"loc":{"start":{"line":4,"column":35},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":42},"end":{"line":4,"column":71}},{"start":{"line":4,"column":74},"end":{"line":4,"column":80}}],"line":4},"2":{"loc":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"type":"if","locations":[{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},{"start":{},"end":{}}],"line":6},"3":{"loc":{"start":{"line":7,"column":15},"end":{"line":7,"column":84}},"type":"binary-expr","locations":[{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},{"start":{"line":7,"column":78},"end":{"line":7,"column":84}}],"line":7},"4":{"loc":{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},"type":"cond-expr","locations":[{"start":{"line":7,"column":23},"end":{"line":7,"column":53}},{"start":{"line":7,"column":56},"end":{"line":7,"column":73}}],"line":7},"5":{"loc":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},{"start":{},"end":{}}],"line":8},"6":{"loc":{"start":{"line":8,"column":6},"end":{"line":8,"column":20}},"type":"binary-expr","locations":[{"start":{"line":8,"column":6},"end":{"line":8,"column":10}},{"start":{"line":8,"column":14},"end":{"line":8,"column":20}}],"line":8}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":1},"f":{"0":1,"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},"b":{"0":[0,1],"1":[0,1],"2":[1,0],"3":[1,1],"4":[0,1],"5":[0,1],"6":[1,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/ref-selections.service.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport type { Observable } from 'rxjs';\nimport type { WorkbookSelectionModel } from './selection-data-model';\nimport { createIdentifier, IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport { BehaviorSubject, map, merge, switchMap, takeUntil } from 'rxjs';\nimport { SheetsSelectionsService } from './selection.service';\n\n/**\n * Ref selections service reuses code of `SelectionManagerService`. And it only contains ref selections\n * when user is editing formula.\n *\n * Its data should be cleared by the caller quit editing formula and reconstructed when user starts editing.\n */\nexport const IRefSelectionsService = createIdentifier<SheetsSelectionsService>('sheets-formula.ref-selections.service');\n\n/**\n * RefSelectionsService treats `selectionMoveStart$` `selectionMoving$` and `selectionMoveEnd$` differently\n * than `SheetsSelectionsService`. Because ref selections can be in different workbooks.\n */\nexport class RefSelectionsService extends SheetsSelectionsService {\n    constructor(\n        @IUniverInstanceService _instanceSrv: IUniverInstanceService\n    ) {\n        super(_instanceSrv);\n    }\n\n    protected override _init(): void {\n        const $ = this._getAliveWorkbooks$().pipe(takeUntil(this.dispose$));\n        this.selectionMoveStart$ = $.pipe(switchMap((ss) => merge(...ss.map((s) => s.selectionMoveStart$))));\n        this.selectionMoving$ = $.pipe(switchMap((ss) => merge(...ss.map((s) => s.selectionMoving$))));\n        this.selectionMoveEnd$ = $.pipe(switchMap((ss) => merge(...ss.map((s) => s.selectionMoveEnd$))));\n        this.selectionSet$ = $.pipe(switchMap((ss) => merge(...ss.map((s) => s.selectionSet$))));\n    }\n\n    private _getAliveWorkbooks$(): Observable<WorkbookSelectionModel[]> {\n        const aliveWorkbooks = this._instanceSrv.getAllUnitsForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        aliveWorkbooks.forEach((workbook) => this._ensureWorkbookSelection(workbook.getUnitId()));\n\n        const workbooks$ = new BehaviorSubject(aliveWorkbooks);\n        this.disposeWithMe(this._instanceSrv.getTypeOfUnitAdded$<Workbook>(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) => {\n            this._ensureWorkbookSelection(workbook.getUnitId());\n            workbooks$.next([...workbooks$.getValue(), workbook]);\n        }));\n        this.disposeWithMe(this._instanceSrv.getTypeOfUnitDisposed$<Workbook>(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) => {\n            this._removeWorkbookSelection(workbook.getUnitId());\n            workbooks$.next(workbooks$.getValue().filter((unit) => unit !== workbook));\n        }));\n\n        return workbooks$.pipe(map((workbooks) => workbooks.map((w) => this._ensureWorkbookSelection(w.getUnitId()))));\n    }\n}\n"],"mappings":";;;;;;;;;;;AAmBA,SAAS,kBAAkB,wBAAwB,0BAA0B;AAC7E,SAAS,iBAAiB,KAAK,OAAO,WAAW,iBAAiB;AAClE,SAAS,+BAA+B;AAQjC,aAAM,wBAAwB,iBAA0C,uCAAuC;AAM/G,WAAM,uBAAN,cAAmC,wBAAwB;AAAA,EAC9D,YAC4B,cAC1B;AACE,UAAM,YAAY;AAAA,EACtB;AAAA,EAEmB,QAAc;AAC7B,UAAM,IAAI,KAAK,oBAAoB,EAAE,KAAK,UAAU,KAAK,QAAQ,CAAC;AAClE,SAAK,sBAAsB,EAAE,KAAK,UAAU,CAAC,OAAO,MAAM,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,mBAAmB,CAAC,CAAC,CAAC;AACnG,SAAK,mBAAmB,EAAE,KAAK,UAAU,CAAC,OAAO,MAAM,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC,CAAC;AAC7F,SAAK,oBAAoB,EAAE,KAAK,UAAU,CAAC,OAAO,MAAM,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,iBAAiB,CAAC,CAAC,CAAC;AAC/F,SAAK,gBAAgB,EAAE,KAAK,UAAU,CAAC,OAAO,MAAM,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC,CAAC;AAAA,EAC3F;AAAA,EAEQ,sBAA4D;AAChE,UAAM,iBAAiB,KAAK,aAAa,mBAA6B,mBAAmB,YAAY;AACrG,mBAAe,QAAQ,CAAC,aAAa,KAAK,yBAAyB,SAAS,UAAU,CAAC,CAAC;AAExF,UAAM,aAAa,IAAI,gBAAgB,cAAc;AACrD,SAAK,cAAc,KAAK,aAAa,oBAA8B,mBAAmB,YAAY,EAAE,UAAU,CAAC,aAAa;AACxH,WAAK,yBAAyB,SAAS,UAAU,CAAC;AAClD,iBAAW,KAAK,CAAC,GAAG,WAAW,SAAS,GAAG,QAAQ,CAAC;AAAA,IACxD,CAAC,CAAC;AACF,SAAK,cAAc,KAAK,aAAa,uBAAiC,mBAAmB,YAAY,EAAE,UAAU,CAAC,aAAa;AAC3H,WAAK,yBAAyB,SAAS,UAAU,CAAC;AAClD,iBAAW,KAAK,WAAW,SAAS,EAAE,OAAO,CAAC,SAAS,SAAS,QAAQ,CAAC;AAAA,IAC7E,CAAC,CAAC;AAEF,WAAO,WAAW,KAAK,IAAI,CAAC,cAAc,UAAU,IAAI,CAAC,MAAM,KAAK,yBAAyB,EAAE,UAAU,CAAC,CAAC,CAAC,CAAC;AAAA,EACjH;AACJ;AA/Ba,uBAAN;AAAA,EAEE;AAAA,GAFI;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"982f6603367d5a04baa9ff761aa93a623ae65042"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/utils/selection-command-util.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/utils/selection-command-util.ts","statementMap":{"0":{"start":{"line":5,"column":25},"end":{"line":5,"column":54}},"1":{"start":{"line":6,"column":31},"end":{"line":6,"column":85}},"2":{"start":{"line":7,"column":2},"end":{"line":7,"column":119}}},"fnMap":{"0":{"name":"getSelectionsService","decl":{"start":{"line":4,"column":16},"end":{"line":4,"column":36}},"loc":{"start":{"line":4,"column":69},"end":{"line":8,"column":1}},"line":4}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":22},"end":{"line":7,"column":117}},"type":"cond-expr","locations":[{"start":{"line":7,"column":70},"end":{"line":7,"column":91}},{"start":{"line":7,"column":94},"end":{"line":7,"column":117}}],"line":7},"1":{"loc":{"start":{"line":7,"column":22},"end":{"line":7,"column":67}},"type":"binary-expr","locations":[{"start":{"line":7,"column":22},"end":{"line":7,"column":42}},{"start":{"line":7,"column":46},"end":{"line":7,"column":67}}],"line":7}},"s":{"0":3,"1":3,"2":3},"f":{"0":3},"b":{"0":[0,3],"1":[3,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/utils/selection-command-util.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor } from '@univerjs/core';\nimport { IContextService } from '@univerjs/core';\nimport { IRefSelectionsService } from '../../services/selections/ref-selections.service';\nimport { REF_SELECTIONS_ENABLED, SheetsSelectionsService } from '../../services/selections/selection.service';\n\nexport function getSelectionsService(\n    accessor: IAccessor,\n    fromCurrentSelection?: boolean\n): SheetsSelectionsService {\n    const contextService = accessor.get(IContextService);\n    const isInRefSelectionMode = contextService.getContextValue(REF_SELECTIONS_ENABLED);\n\n    return accessor.get(isInRefSelectionMode && !fromCurrentSelection ? IRefSelectionsService : SheetsSelectionsService);\n}\n"],"mappings":"AAiBA,SAAS,uBAAuB;AAChC,SAAS,6BAA6B;AACtC,SAAS,wBAAwB,+BAA+B;AAEzD,gBAAS,qBACZ,UACA,sBACuB;AACvB,QAAM,iBAAiB,SAAS,IAAI,eAAe;AACnD,QAAM,uBAAuB,eAAe,gBAAgB,sBAAsB;AAElF,SAAO,SAAS,IAAI,wBAAwB,CAAC,uBAAuB,wBAAwB,uBAAuB;AACvH;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ffc4a17863ef7dbd7849349e2387751b978fe86c"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/operations/selection.operation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/operations/selection.operation.ts","statementMap":{"0":{"start":{"line":5,"column":38},"end":{"line":15,"column":1}},"1":{"start":{"line":9,"column":4},"end":{"line":9,"column":30}},"2":{"start":{"line":9,"column":17},"end":{"line":9,"column":30}},"3":{"start":{"line":10,"column":52},"end":{"line":10,"column":58}},"4":{"start":{"line":11,"column":36},"end":{"line":11,"column":66}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":84}},"6":{"start":{"line":13,"column":4},"end":{"line":13,"column":16}},"7":{"start":{"line":16,"column":34},"end":{"line":36,"column":1}},"8":{"start":{"line":20,"column":4},"end":{"line":20,"column":30}},"9":{"start":{"line":20,"column":17},"end":{"line":20,"column":30}},"10":{"start":{"line":21,"column":39},"end":{"line":21,"column":45}},"11":{"start":{"line":22,"column":27},"end":{"line":22,"column":56}},"12":{"start":{"line":23,"column":19},"end":{"line":23,"column":86}},"13":{"start":{"line":24,"column":4},"end":{"line":24,"column":30}},"14":{"start":{"line":24,"column":17},"end":{"line":24,"column":30}},"15":{"start":{"line":25,"column":23},"end":{"line":29,"column":6}},"16":{"start":{"line":30,"column":4},"end":{"line":34,"column":7}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":11},"end":{"line":8,"column":12}},"loc":{"start":{"line":8,"column":33},"end":{"line":14,"column":3}},"line":8},"1":{"name":"(anonymous_1)","decl":{"start":{"line":19,"column":11},"end":{"line":19,"column":12}},"loc":{"start":{"line":19,"column":33},"end":{"line":35,"column":3}},"line":19}},"branchMap":{"0":{"loc":{"start":{"line":9,"column":4},"end":{"line":9,"column":30}},"type":"if","locations":[{"start":{"line":9,"column":4},"end":{"line":9,"column":30}},{"start":{},"end":{}}],"line":9},"1":{"loc":{"start":{"line":20,"column":4},"end":{"line":20,"column":30}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":20,"column":30}},{"start":{},"end":{}}],"line":20},"2":{"loc":{"start":{"line":24,"column":4},"end":{"line":24,"column":30}},"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":24,"column":30}},{"start":{},"end":{}}],"line":24}},"s":{"0":1,"1":3,"2":0,"3":3,"4":3,"5":3,"6":3,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"f":{"0":3,"1":0},"b":{"0":[0,3],"1":[0,0],"2":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/operations/selection.operation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand, IOperation, IRange } from '@univerjs/core';\nimport type { ISelectionWithStyle } from '../../basics/selection';\nimport type { SelectionMoveType } from '../../services/selections/type';\nimport { CommandType, ICommandService, IUniverInstanceService } from '@univerjs/core';\nimport { getPrimaryForRange } from '../commands/utils/selection-utils';\nimport { getSheetCommandTarget } from '../commands/utils/target-util';\nimport { getSelectionsService } from '../utils/selection-command-util';\n\nexport interface ISetSelectionsOperationParams {\n    unitId: string;\n    subUnitId: string;\n    selections: ISelectionWithStyle[];\n    type?: SelectionMoveType;\n\n    /** If should scroll to the selected range. */\n    reveal?: boolean;\n    extra?: string;\n}\n\n/**\n * Set selections to SelectionModel(WorkbookSelectionModel) by selectionManagerService.\n */\nexport const SetSelectionsOperation: IOperation<ISetSelectionsOperationParams> = {\n    id: 'sheet.operation.set-selections',\n    type: CommandType.OPERATION,\n    handler: (accessor, params) => {\n        if (!params) return false;\n\n        const { selections, type, unitId, subUnitId } = params;\n        const selectionManagerService = getSelectionsService(accessor);\n\n        // Must update selections array ref.\n        // See https://github.com/dream-num/univer/issues/2199\n        selectionManagerService.setSelections(unitId, subUnitId, [...selections], type);\n        return true;\n    },\n};\n\nexport interface ISelectRangeCommandParams {\n    unitId: string;\n    subUnit: string;\n    range: IRange;\n\n    /** If should scroll to the selected range. */\n    reveal?: boolean;\n    extra?: string;\n}\n\nexport const SelectRangeCommand: ICommand<ISelectRangeCommandParams> = {\n    id: 'sheet.command.select-range',\n    type: CommandType.COMMAND,\n    handler: (accessor: IAccessor, params: ISelectRangeCommandParams) => {\n        if (!params) return false;\n\n        const { unitId, subUnit, range } = params;\n        const commandService = accessor.get(ICommandService);\n        const target = getSheetCommandTarget(accessor.get(IUniverInstanceService), params);\n        if (!target) return false;\n\n        const selections: ISelectionWithStyle[] = [{\n            range,\n            primary: getPrimaryForRange(range, target.worksheet),\n            style: null,\n        }];\n\n        return commandService.syncExecuteCommand(SetSelectionsOperation.id, {\n            unitId,\n            subUnitId: subUnit,\n            selections,\n        } as ISetSelectionsOperationParams);\n    },\n};\n"],"mappings":"AAmBA,SAAS,aAAa,iBAAiB,8BAA8B;AACrE,SAAS,0BAA0B;AACnC,SAAS,6BAA6B;AACtC,SAAS,4BAA4B;AAgB9B,aAAM,yBAAoE;AAAA,EAC7E,IAAI;AAAA,EACJ,MAAM,YAAY;AAAA,EAClB,SAAS,CAAC,UAAU,WAAW;AAC3B,QAAI,CAAC,OAAQ,QAAO;AAEpB,UAAM,EAAE,YAAY,MAAM,QAAQ,UAAU,IAAI;AAChD,UAAM,0BAA0B,qBAAqB,QAAQ;AAI7D,4BAAwB,cAAc,QAAQ,WAAW,CAAC,GAAG,UAAU,GAAG,IAAI;AAC9E,WAAO;AAAA,EACX;AACJ;AAYO,aAAM,qBAA0D;AAAA,EACnE,IAAI;AAAA,EACJ,MAAM,YAAY;AAAA,EAClB,SAAS,CAAC,UAAqB,WAAsC;AACjE,QAAI,CAAC,OAAQ,QAAO;AAEpB,UAAM,EAAE,QAAQ,SAAS,MAAM,IAAI;AACnC,UAAM,iBAAiB,SAAS,IAAI,eAAe;AACnD,UAAM,SAAS,sBAAsB,SAAS,IAAI,sBAAsB,GAAG,MAAM;AACjF,QAAI,CAAC,OAAQ,QAAO;AAEpB,UAAM,aAAoC,CAAC;AAAA,MACvC;AAAA,MACA,SAAS,mBAAmB,OAAO,OAAO,SAAS;AAAA,MACnD,OAAO;AAAA,IACX,CAAC;AAED,WAAO,eAAe,mBAAmB,uBAAuB,IAAI;AAAA,MAChE;AAAA,MACA,WAAW;AAAA,MACX;AAAA,IACJ,CAAkC;AAAA,EACtC;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d38d442e00bce523324e7e89a1cde14994ba12de"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/move-range.command.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/move-range.command.ts","statementMap":{"0":{"start":{"line":21,"column":34},"end":{"line":21,"column":60}},"1":{"start":{"line":22,"column":32},"end":{"line":96,"column":1}},"2":{"start":{"line":26,"column":27},"end":{"line":26,"column":56}},"3":{"start":{"line":27,"column":28},"end":{"line":27,"column":58}},"4":{"start":{"line":28,"column":34},"end":{"line":28,"column":70}},"5":{"start":{"line":29,"column":25},"end":{"line":29,"column":51}},"6":{"start":{"line":30,"column":26},"end":{"line":30,"column":53}},"7":{"start":{"line":31,"column":36},"end":{"line":31,"column":73}},"8":{"start":{"line":32,"column":19},"end":{"line":32,"column":63}},"9":{"start":{"line":33,"column":4},"end":{"line":33,"column":30}},"10":{"start":{"line":33,"column":17},"end":{"line":33,"column":30}},"11":{"start":{"line":34,"column":20},"end":{"line":34,"column":107}},"12":{"start":{"line":35,"column":4},"end":{"line":37,"column":5}},"13":{"start":{"line":36,"column":6},"end":{"line":36,"column":19}},"14":{"start":{"line":38,"column":45},"end":{"line":38,"column":51}},"15":{"start":{"line":39,"column":31},"end":{"line":43,"column":5}},"16":{"start":{"line":44,"column":4},"end":{"line":47,"column":5}},"17":{"start":{"line":45,"column":6},"end":{"line":45,"column":73}},"18":{"start":{"line":46,"column":6},"end":{"line":46,"column":19}},"19":{"start":{"line":48,"column":32},"end":{"line":51,"column":6}},"20":{"start":{"line":52,"column":18},"end":{"line":65,"column":5}},"21":{"start":{"line":66,"column":18},"end":{"line":79,"column":5}},"22":{"start":{"line":80,"column":19},"end":{"line":80,"column":64}},"23":{"start":{"line":81,"column":30},"end":{"line":84,"column":6}},"24":{"start":{"line":85,"column":4},"end":{"line":93,"column":5}},"25":{"start":{"line":86,"column":6},"end":{"line":86,"column":63}},"26":{"start":{"line":87,"column":6},"end":{"line":91,"column":9}},"27":{"start":{"line":92,"column":6},"end":{"line":92,"column":18}},"28":{"start":{"line":94,"column":4},"end":{"line":94,"column":17}},"29":{"start":{"line":98,"column":16},"end":{"line":98,"column":18}},"30":{"start":{"line":99,"column":16},"end":{"line":99,"column":18}},"31":{"start":{"line":100,"column":65},"end":{"line":100,"column":69}},"32":{"start":{"line":101,"column":53},"end":{"line":101,"column":55}},"33":{"start":{"line":102,"column":32},"end":{"line":102,"column":68}},"34":{"start":{"line":103,"column":19},"end":{"line":103,"column":71}},"35":{"start":{"line":104,"column":22},"end":{"line":104,"column":62}},"36":{"start":{"line":105,"column":24},"end":{"line":105,"column":66}},"37":{"start":{"line":106,"column":23},"end":{"line":106,"column":51}},"38":{"start":{"line":107,"column":25},"end":{"line":107,"column":55}},"39":{"start":{"line":108,"column":2},"end":{"line":169,"column":3}},"40":{"start":{"line":109,"column":36},"end":{"line":109,"column":90}},"41":{"start":{"line":110,"column":4},"end":{"line":112,"column":5}},"42":{"start":{"line":111,"column":6},"end":{"line":111,"column":18}},"43":{"start":{"line":113,"column":26},"end":{"line":113,"column":44}},"44":{"start":{"line":114,"column":29},"end":{"line":114,"column":47}},"45":{"start":{"line":115,"column":26},"end":{"line":115,"column":44}},"46":{"start":{"line":116,"column":4},"end":{"line":124,"column":7}},"47":{"start":{"line":117,"column":23},"end":{"line":117,"column":56}},"48":{"start":{"line":118,"column":6},"end":{"line":118,"column":66}},"49":{"start":{"line":119,"column":6},"end":{"line":122,"column":7}},"50":{"start":{"line":120,"column":22},"end":{"line":120,"column":59}},"51":{"start":{"line":121,"column":8},"end":{"line":121,"column":65}},"52":{"start":{"line":123,"column":6},"end":{"line":123,"column":48}},"53":{"start":{"line":125,"column":24},"end":{"line":125,"column":42}},"54":{"start":{"line":126,"column":27},"end":{"line":126,"column":45}},"55":{"start":{"line":127,"column":4},"end":{"line":129,"column":7}},"56":{"start":{"line":128,"column":6},"end":{"line":128,"column":87}},"57":{"start":{"line":130,"column":4},"end":{"line":140,"column":7}},"58":{"start":{"line":131,"column":24},"end":{"line":131,"column":45}},"59":{"start":{"line":132,"column":28},"end":{"line":132,"column":76}},"60":{"start":{"line":133,"column":20},"end":{"line":133,"column":70}},"61":{"start":{"line":134,"column":25},"end":{"line":134,"column":74}},"62":{"start":{"line":135,"column":24},"end":{"line":135,"column":73}},"63":{"start":{"line":136,"column":6},"end":{"line":138,"column":7}},"64":{"start":{"line":137,"column":8},"end":{"line":137,"column":33}},"65":{"start":{"line":139,"column":6},"end":{"line":139,"column":76}},"66":{"start":{"line":141,"column":32},"end":{"line":153,"column":5}},"67":{"start":{"line":154,"column":34},"end":{"line":166,"column":5}},"68":{"start":{"line":167,"column":4},"end":{"line":167,"column":74}},"69":{"start":{"line":168,"column":4},"end":{"line":168,"column":76}},"70":{"start":{"line":170,"column":2},"end":{"line":173,"column":4}},"71":{"start":{"line":176,"column":19},"end":{"line":176,"column":37}},"72":{"start":{"line":177,"column":22},"end":{"line":177,"column":43}},"73":{"start":{"line":178,"column":20},"end":{"line":178,"column":66}},"74":{"start":{"line":179,"column":14},"end":{"line":179,"column":52}},"75":{"start":{"line":180,"column":2},"end":{"line":189,"column":3}},"76":{"start":{"line":181,"column":26},"end":{"line":181,"column":67}},"77":{"start":{"line":182,"column":26},"end":{"line":182,"column":73}},"78":{"start":{"line":183,"column":4},"end":{"line":183,"column":50}},"79":{"start":{"line":184,"column":4},"end":{"line":184,"column":56}},"80":{"start":{"line":185,"column":4},"end":{"line":185,"column":33}},"81":{"start":{"line":186,"column":4},"end":{"line":186,"column":39}},"82":{"start":{"line":187,"column":4},"end":{"line":187,"column":25}},"83":{"start":{"line":188,"column":4},"end":{"line":188,"column":32}},"84":{"start":{"line":190,"column":2},"end":{"line":190,"column":13}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":25,"column":11},"end":{"line":25,"column":12}},"loc":{"start":{"line":25,"column":39},"end":{"line":95,"column":3}},"line":25},"1":{"name":"getMoveRangeUndoRedoMutations","decl":{"start":{"line":97,"column":16},"end":{"line":97,"column":45}},"loc":{"start":{"line":97,"column":87},"end":{"line":174,"column":1}},"line":97},"2":{"name":"(anonymous_2)","decl":{"start":{"line":116,"column":29},"end":{"line":116,"column":30}},"loc":{"start":{"line":116,"column":43},"end":{"line":124,"column":5}},"line":116},"3":{"name":"(anonymous_3)","decl":{"start":{"line":127,"column":27},"end":{"line":127,"column":28}},"loc":{"start":{"line":127,"column":41},"end":{"line":129,"column":5}},"line":127},"4":{"name":"(anonymous_4)","decl":{"start":{"line":130,"column":29},"end":{"line":130,"column":30}},"loc":{"start":{"line":130,"column":43},"end":{"line":140,"column":5}},"line":130},"5":{"name":"getPrimaryAfterMove","decl":{"start":{"line":175,"column":9},"end":{"line":175,"column":28}},"loc":{"start":{"line":175,"column":60},"end":{"line":191,"column":1}},"line":175}},"branchMap":{"0":{"loc":{"start":{"line":33,"column":4},"end":{"line":33,"column":30}},"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":33,"column":30}},{"start":{},"end":{}}],"line":33},"1":{"loc":{"start":{"line":35,"column":4},"end":{"line":37,"column":5}},"type":"if","locations":[{"start":{"line":35,"column":4},"end":{"line":37,"column":5}},{"start":{},"end":{}}],"line":35},"2":{"loc":{"start":{"line":44,"column":4},"end":{"line":47,"column":5}},"type":"if","locations":[{"start":{"line":44,"column":4},"end":{"line":47,"column":5}},{"start":{},"end":{}}],"line":44},"3":{"loc":{"start":{"line":53,"column":9},"end":{"line":53,"column":43}},"type":"binary-expr","locations":[{"start":{"line":53,"column":9},"end":{"line":53,"column":37}},{"start":{"line":53,"column":41},"end":{"line":53,"column":43}}],"line":53},"4":{"loc":{"start":{"line":67,"column":9},"end":{"line":67,"column":43}},"type":"binary-expr","locations":[{"start":{"line":67,"column":9},"end":{"line":67,"column":37}},{"start":{"line":67,"column":41},"end":{"line":67,"column":43}}],"line":67},"5":{"loc":{"start":{"line":85,"column":4},"end":{"line":93,"column":5}},"type":"if","locations":[{"start":{"line":85,"column":4},"end":{"line":93,"column":5}},{"start":{},"end":{}}],"line":85},"6":{"loc":{"start":{"line":97,"column":66},"end":{"line":97,"column":85}},"type":"default-arg","locations":[{"start":{"line":97,"column":80},"end":{"line":97,"column":85}}],"line":97},"7":{"loc":{"start":{"line":108,"column":2},"end":{"line":169,"column":3}},"type":"if","locations":[{"start":{"line":108,"column":2},"end":{"line":169,"column":3}},{"start":{},"end":{}}],"line":108},"8":{"loc":{"start":{"line":108,"column":6},"end":{"line":108,"column":68}},"type":"binary-expr","locations":[{"start":{"line":108,"column":6},"end":{"line":108,"column":17}},{"start":{"line":108,"column":21},"end":{"line":108,"column":34}},{"start":{"line":108,"column":38},"end":{"line":108,"column":50}},{"start":{"line":108,"column":54},"end":{"line":108,"column":68}}],"line":108},"9":{"loc":{"start":{"line":110,"column":4},"end":{"line":112,"column":5}},"type":"if","locations":[{"start":{"line":110,"column":4},"end":{"line":112,"column":5}},{"start":{},"end":{}}],"line":110},"10":{"loc":{"start":{"line":110,"column":8},"end":{"line":110,"column":75}},"type":"binary-expr","locations":[{"start":{"line":110,"column":8},"end":{"line":110,"column":59}},{"start":{"line":110,"column":63},"end":{"line":110,"column":75}}],"line":110},"11":{"loc":{"start":{"line":119,"column":6},"end":{"line":122,"column":7}},"type":"if","locations":[{"start":{"line":119,"column":6},"end":{"line":122,"column":7}},{"start":{},"end":{}}],"line":119},"12":{"loc":{"start":{"line":136,"column":6},"end":{"line":138,"column":7}},"type":"if","locations":[{"start":{"line":136,"column":6},"end":{"line":138,"column":7}},{"start":{},"end":{}}],"line":136},"13":{"loc":{"start":{"line":136,"column":10},"end":{"line":136,"column":33}},"type":"binary-expr","locations":[{"start":{"line":136,"column":10},"end":{"line":136,"column":19}},{"start":{"line":136,"column":23},"end":{"line":136,"column":33}}],"line":136},"14":{"loc":{"start":{"line":180,"column":2},"end":{"line":189,"column":3}},"type":"if","locations":[{"start":{"line":180,"column":2},"end":{"line":189,"column":3}},{"start":{},"end":{}}],"line":180}},"s":{"0":1,"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0],"7":[0,0],"8":[0,0,0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/move-range.command.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICellData, ICommand, IMutationInfo, IRange, ISelectionCell, IStyleData, Nullable, Worksheet } from '@univerjs/core';\nimport type { IMoveRangeMutationParams } from '../mutations/move-range.mutation';\n\nimport type { ISetSelectionsOperationParams } from '../operations/selection.operation';\nimport {\n    cellToRange,\n    CommandType,\n    ErrorService,\n    ICommandService,\n    IUndoRedoService,\n    IUniverInstanceService,\n    LocaleService,\n    ObjectMatrix,\n    Range,\n    Rectangle,\n    sequenceExecute,\n    Tools,\n} from '@univerjs/core';\nimport { SelectionMoveType } from '../../services/selections/type';\nimport { SheetInterceptorService } from '../../services/sheet-interceptor/sheet-interceptor.service';\nimport { MoveRangeMutation } from '../mutations/move-range.mutation';\nimport { SetSelectionsOperation } from '../operations/selection.operation';\nimport { alignToMergedCellsBorders, getPrimaryForRange } from './utils/selection-utils';\nimport { getSheetCommandTarget } from './utils/target-util';\n\nexport interface IMoveRangeCommandParams {\n    toRange: IRange;\n    fromRange: IRange;\n}\nexport const MoveRangeCommandId = 'sheet.command.move-range';\n\nexport const MoveRangeCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: MoveRangeCommandId,\n\n    handler: async (accessor: IAccessor, params: IMoveRangeCommandParams) => {\n        const commandService = accessor.get(ICommandService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const errorService = accessor.get(ErrorService);\n        const localeService = accessor.get(LocaleService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const perform = await sheetInterceptorService.beforeCommandExecute({ id: MoveRangeCommand.id, params });\n\n        if (!perform) {\n            return false;\n        }\n\n        const { worksheet, subUnitId, unitId } = target;\n        const moveRangeMutations = getMoveRangeUndoRedoMutations(\n            accessor,\n            { unitId, subUnitId, range: params.fromRange },\n            { unitId, subUnitId, range: params.toRange }\n        );\n        if (moveRangeMutations === null) {\n            errorService.emit(localeService.t('sheets.info.acrossMergedCell'));\n            return false;\n        }\n\n        const interceptorCommands = sheetInterceptorService.onCommandExecute({\n            id: MoveRangeCommand.id,\n            params: { ...params },\n        });\n\n        const redos = [\n            ...(interceptorCommands.preRedos ?? []),\n            ...moveRangeMutations.redos,\n            ...interceptorCommands.redos,\n            {\n                id: SetSelectionsOperation.id,\n                params: {\n                    unitId,\n                    subUnitId,\n                    selections: [{ range: params.toRange, primary: getPrimaryAfterMove(params.fromRange, params.toRange, worksheet) }],\n                    type: SelectionMoveType.MOVE_END,\n                } as ISetSelectionsOperationParams,\n            },\n        ];\n        const undos = [\n            ...(interceptorCommands.preUndos ?? []),\n            ...moveRangeMutations.undos,\n            ...interceptorCommands.undos,\n            {\n                id: SetSelectionsOperation.id,\n                params: {\n                    unitId,\n                    subUnitId,\n                    selections: [{ range: params.fromRange, primary: getPrimaryForRange(params.fromRange, worksheet) }],\n                    type: SelectionMoveType.MOVE_END,\n                } as ISetSelectionsOperationParams,\n            },\n        ];\n\n        const result = sequenceExecute(redos, commandService).result;\n\n        const afterInterceptors = sheetInterceptorService.afterCommandExecute({\n            id: MoveRangeCommand.id,\n            params: { ...params },\n        });\n\n        if (result) {\n            sequenceExecute(afterInterceptors.redos, commandService);\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: [...undos, ...afterInterceptors.undos],\n                redoMutations: [...redos, ...afterInterceptors.redos],\n            });\n            return true;\n        }\n        return false;\n    },\n};\n\nexport interface IRangeUnit {\n    unitId: string;\n    subUnitId: string;\n    range: IRange;\n}\n\n// eslint-disable-next-line max-lines-per-function\nexport function getMoveRangeUndoRedoMutations(\n    accessor: IAccessor,\n    from: IRangeUnit,\n    to: IRangeUnit,\n    ignoreMerge = false\n) {\n    const redos: IMutationInfo[] = [];\n    const undos: IMutationInfo[] = [];\n    const { range: fromRange, subUnitId: fromSubUnitId, unitId } = from;\n    const { range: toRange, subUnitId: toSubUnitId } = to;\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const workbook = univerInstanceService.getUniverSheetInstance(unitId);\n    const toWorksheet = workbook?.getSheetBySheetId(toSubUnitId);\n    const fromWorksheet = workbook?.getSheetBySheetId(fromSubUnitId);\n    const toCellMatrix = toWorksheet?.getCellMatrix();\n    const fromCellMatrix = fromWorksheet?.getCellMatrix();\n    if (toWorksheet && fromWorksheet && toCellMatrix && fromCellMatrix) {\n        const alignedRangeWithToRange = alignToMergedCellsBorders(toRange, toWorksheet, false);\n\n        if (!Rectangle.equals(toRange, alignedRangeWithToRange) && !ignoreMerge) {\n            return null;\n        }\n\n        const fromCellValue = new ObjectMatrix<Nullable<ICellData>>();\n        const newFromCellValue = new ObjectMatrix<Nullable<ICellData>>();\n        const fromCellStyle = new ObjectMatrix<Nullable<IStyleData>>();\n\n        Range.foreach(fromRange, (row, col) => {\n            const cellData = fromCellMatrix.getValue(row, col);\n            fromCellValue.setValue(row, col, Tools.deepClone(cellData));\n            if (cellData) {\n                const style = workbook?.getStyles().get(cellData.s);\n                fromCellStyle.setValue(row, col, Tools.deepClone(style));\n            }\n            newFromCellValue.setValue(row, col, null);\n        });\n        const toCellValue = new ObjectMatrix<Nullable<ICellData>>();\n        const newToCellValue = new ObjectMatrix<Nullable<ICellData>>();\n\n        Range.foreach(toRange, (row, col) => {\n            toCellValue.setValue(row, col, Tools.deepClone(toCellMatrix.getValue(row, col)));\n        });\n\n        Range.foreach(fromRange, (row, col) => {\n            const cellRange = cellToRange(row, col);\n            const relativeRange = Rectangle.getRelativeRange(cellRange, fromRange);\n            const range = Rectangle.getPositionRange(relativeRange, toRange);\n\n            const styleValue = Tools.deepClone(fromCellStyle.getValue(row, col));\n            const cellValue = Tools.deepClone(fromCellValue.getValue(row, col));\n            if (cellValue && styleValue) {\n                cellValue.s = styleValue;\n            }\n            newToCellValue.setValue(range.startRow, range.startColumn, cellValue);\n        });\n\n        const doMoveRangeMutation: IMoveRangeMutationParams = {\n            fromRange: from.range,\n            toRange: to.range,\n            from: {\n                value: newFromCellValue.getMatrix(),\n                subUnitId: fromSubUnitId,\n            },\n            to: {\n                value: newToCellValue.getMatrix(),\n                subUnitId: toSubUnitId,\n            },\n            unitId,\n        };\n        const undoMoveRangeMutation: IMoveRangeMutationParams = {\n            fromRange: to.range,\n            toRange: from.range,\n            from: {\n                value: fromCellValue.getMatrix(),\n                subUnitId: fromSubUnitId,\n            },\n            to: {\n                value: toCellValue.getMatrix(),\n                subUnitId: toSubUnitId,\n            },\n            unitId,\n        };\n\n        redos.push({ id: MoveRangeMutation.id, params: doMoveRangeMutation });\n        undos.push({ id: MoveRangeMutation.id, params: undoMoveRangeMutation });\n    }\n\n    return {\n        redos,\n        undos,\n    };\n}\n\n// Before moveRange is executed, the target area has no merge cell yet.\n// So need to get the merge info of the start cell and then transform it\nfunction getPrimaryAfterMove(fromRange: IRange, toRange: IRange, worksheet: Worksheet): ISelectionCell {\n    const startRow = fromRange.startRow;\n    const startColumn = fromRange.startColumn;\n    const mergeInfo = worksheet.getMergedCell(startRow, startColumn);\n\n    const res = getPrimaryForRange(toRange, worksheet);\n    if (mergeInfo) {\n        const mergeRowCount = mergeInfo.endRow - mergeInfo.startRow + 1;\n        const mergeColCount = mergeInfo.endColumn - mergeInfo.startColumn + 1;\n        res.endRow = res.startRow + mergeRowCount - 1;\n        res.endColumn = res.startColumn + mergeColCount - 1;\n        res.actualRow = res.startRow;\n        res.actualColumn = res.startColumn;\n        res.isMerged = false;\n        res.isMergedMainCell = true;\n    }\n\n    return res;\n}\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"35e6db448db8c7e1339eef1e383aaf6892ad4ce8"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/index.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/index.ts","statementMap":{},"fnMap":{},"branchMap":{},"s":{},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/index.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport { RangeProtectionPermissionEditPoint } from './range/edit';\nexport { RangeProtectionPermissionViewPoint } from './range/view';\nexport { WorkbookCommentPermission } from './workbook/comment';\nexport { WorkbookCopyPermission } from './workbook/copy';\nexport { WorkbookCopySheetPermission } from './workbook/copy-sheet';\nexport { WorkbookCreateProtectPermission } from './workbook/create-permission';\nexport { WorkbookCreateSheetPermission } from './workbook/create-sheet';\nexport { WorkbookDeleteSheetPermission } from './workbook/delete-sheet';\nexport { WorkbookDuplicatePermission } from './workbook/duplicate';\nexport { WorkbookEditablePermission } from './workbook/editable';\nexport { WorkbookExportPermission } from './workbook/export';\nexport { WorkbookHideSheetPermission } from './workbook/hide-sheet';\nexport { WorkbookHistoryPermission } from './workbook/history';\nexport { WorkbookManageCollaboratorPermission } from './workbook/manage-collaborator';\nexport { WorkbookMoveSheetPermission } from './workbook/move-sheet';\nexport { WorkbookPrintPermission } from './workbook/print';\nexport { WorkbookRecoverHistoryPermission } from './workbook/recover-history';\nexport { WorkbookRenameSheetPermission } from './workbook/rename-sheet';\nexport { WorkbookSharePermission } from './workbook/share';\nexport { WorkbookViewPermission } from './workbook/view';\n\nexport { WorkbookViewHistoryPermission } from './workbook/view-history';\nexport { WorksheetCopyPermission } from './worksheet/copy';\nexport { WorksheetDeleteColumnPermission } from './worksheet/delete-column';\nexport { WorksheetDeleteProtectionPermission } from './worksheet/delete-protection';\nexport { WorksheetDeleteRowPermission } from './worksheet/delete-row';\nexport { WorksheetEditPermission } from './worksheet/edit';\nexport { WorksheetEditExtraObjectPermission } from './worksheet/edit-extra-object';\nexport { WorksheetFilterPermission } from './worksheet/filter';\nexport { WorksheetInsertColumnPermission } from './worksheet/insert-column';\nexport { WorksheetInsertHyperlinkPermission } from './worksheet/insert-hyperlink';\nexport { WorksheetInsertRowPermission } from './worksheet/insert-row';\nexport { WorksheetManageCollaboratorPermission } from './worksheet/manage-collaborator';\nexport { WorksheetPivotTablePermission } from './worksheet/pivot-table';\nexport { WorksheetSelectProtectedCellsPermission } from './worksheet/select-protected-cells';\nexport { WorksheetSelectUnProtectedCellsPermission } from './worksheet/select-un-protected-cells';\nexport { WorksheetSetCellStylePermission } from './worksheet/set-cell-style';\nexport { WorksheetSetCellValuePermission } from './worksheet/set-cell-value';\nexport { WorksheetSetColumnStylePermission } from './worksheet/set-column-style';\nexport { WorksheetSetRowStylePermission } from './worksheet/set-row-style';\n\nexport { WorksheetSortPermission } from './worksheet/sort';\nexport { WorksheetViewPermission } from './worksheet/view';\n"],"mappings":"AAgBA,SAAS,0CAA0C;AACnD,SAAS,0CAA0C;AACnD,SAAS,iCAAiC;AAC1C,SAAS,8BAA8B;AACvC,SAAS,mCAAmC;AAC5C,SAAS,uCAAuC;AAChD,SAAS,qCAAqC;AAC9C,SAAS,qCAAqC;AAC9C,SAAS,mCAAmC;AAC5C,SAAS,kCAAkC;AAC3C,SAAS,gCAAgC;AACzC,SAAS,mCAAmC;AAC5C,SAAS,iCAAiC;AAC1C,SAAS,4CAA4C;AACrD,SAAS,mCAAmC;AAC5C,SAAS,+BAA+B;AACxC,SAAS,wCAAwC;AACjD,SAAS,qCAAqC;AAC9C,SAAS,+BAA+B;AACxC,SAAS,8BAA8B;AAEvC,SAAS,qCAAqC;AAC9C,SAAS,+BAA+B;AACxC,SAAS,uCAAuC;AAChD,SAAS,2CAA2C;AACpD,SAAS,oCAAoC;AAC7C,SAAS,+BAA+B;AACxC,SAAS,0CAA0C;AACnD,SAAS,iCAAiC;AAC1C,SAAS,uCAAuC;AAChD,SAAS,0CAA0C;AACnD,SAAS,oCAAoC;AAC7C,SAAS,6CAA6C;AACtD,SAAS,qCAAqC;AAC9C,SAAS,+CAA+C;AACxD,SAAS,iDAAiD;AAC1D,SAAS,uCAAuC;AAChD,SAAS,uCAAuC;AAChD,SAAS,yCAAyC;AAClD,SAAS,sCAAsC;AAE/C,SAAS,+BAA+B;AACxC,SAAS,+BAA+B;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"fa4266c34bfe75a1f0cfdd2a4a5ffa2d40e38efe"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/edit.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/edit.ts","statementMap":{"0":{"start":{"line":4,"column":9},"end":{"line":4,"column":31}},"1":{"start":{"line":5,"column":12},"end":{"line":5,"column":27}},"2":{"start":{"line":6,"column":11},"end":{"line":6,"column":32}},"3":{"start":{"line":7,"column":10},"end":{"line":7,"column":14}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":25}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":31}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":37}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":77}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":2},"end":{"line":12,"column":3}},"loc":{"start":{"line":12,"column":47},"end":{"line":17,"column":3}},"line":12}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/edit.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\nimport type { IPermissionPoint } from '@univerjs/core';\n\nexport class RangeProtectionPermissionEditPoint implements IPermissionPoint {\n    type = UnitObject.SelectRange;\n    subType = UnitAction.Edit;\n    status = PermissionStatus.INIT;\n    value = true;\n    id: string;\n    unitId: string;\n    subUnitId: string;\n    permissionId: string;\n    constructor(unitId: string, subUnitId: string, permissionId: string) {\n        this.unitId = unitId;\n        this.subUnitId = subUnitId;\n        this.permissionId = permissionId;\n        this.id = `${UnitObject.SelectRange}.${UnitAction.Edit}.${permissionId}`;\n    }\n}\n"],"mappings":"AAgBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAGhC,aAAM,mCAA+D;AAAA,EACxE,OAAO,WAAW;AAAA,EAClB,UAAU,WAAW;AAAA,EACrB,SAAS,iBAAiB;AAAA,EAC1B,QAAQ;AAAA,EACR;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,YAAY,QAAgB,WAAmB,cAAsB;AACjE,SAAK,SAAS;AACd,SAAK,YAAY;AACjB,SAAK,eAAe;AACpB,SAAK,KAAK,GAAG,WAAW,WAAW,IAAI,WAAW,IAAI,IAAI,YAAY;AAAA,EAC1E;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"1f979d45273f5510d2a13dcfd8d8a2ce2f4f7e33"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/view.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/view.ts","statementMap":{"0":{"start":{"line":4,"column":9},"end":{"line":4,"column":31}},"1":{"start":{"line":5,"column":12},"end":{"line":5,"column":27}},"2":{"start":{"line":6,"column":11},"end":{"line":6,"column":32}},"3":{"start":{"line":7,"column":10},"end":{"line":7,"column":14}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":25}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":31}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":37}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":77}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":2},"end":{"line":12,"column":3}},"loc":{"start":{"line":12,"column":47},"end":{"line":17,"column":3}},"line":12}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/view.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class RangeProtectionPermissionViewPoint implements IPermissionPoint {\n    type = UnitObject.SelectRange;\n    subType = UnitAction.View;\n    status = PermissionStatus.INIT;\n    value = true;\n    id: string;\n    unitId: string;\n    subUnitId: string;\n    permissionId: string;\n    constructor(unitId: string, subUnitId: string, permissionId: string) {\n        this.unitId = unitId;\n        this.subUnitId = subUnitId;\n        this.permissionId = permissionId;\n        this.id = `${UnitObject.SelectRange}.${UnitAction.View}.${permissionId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,mCAA+D;AAAA,EACxE,OAAO,WAAW;AAAA,EAClB,UAAU,WAAW;AAAA,EACrB,SAAS,iBAAiB;AAAA,EAC1B,QAAQ;AAAA,EACR;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,YAAY,QAAgB,WAAmB,cAAsB;AACjE,SAAK,SAAS;AACd,SAAK,YAAY;AACjB,SAAK,eAAe;AACpB,SAAK,KAAK,GAAG,WAAW,WAAW,IAAI,WAAW,IAAI,IAAI,YAAY;AAAA,EAC1E;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a103a7ade3c1ac529d07805a0dcbb27f4201432b"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/comment.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/comment.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":61}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":30}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/comment.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookCommentPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Comment;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Comment}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,0BAAsD;AAAA,EAO/D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,OAAO,IAAI,MAAM;AAAA,EAC1D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"acb1d70be03de548d6cf145bdabfd267faa5e05d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/copy.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/copy.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":58}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/copy.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookCopyPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Copy;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Copy}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,uBAAmD;AAAA,EAO5D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM;AAAA,EACvD;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"59b0fc2a437bf6fda1be8ba3917a57290157dcc7"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/copy-sheet.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/copy-sheet.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":63}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":12},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":11},"end":{"line":13,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/copy-sheet.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookCopySheetPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    subType = UnitAction.CopySheet;\n    status = PermissionStatus.INIT;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.CopySheet}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,4BAAwD;AAAA,EAOjE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,SAAS,IAAI,MAAM;AAAA,EAC5D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,UAAU,WAAW;AAAA,EACrB,SAAS,iBAAiB;AAM9B;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d181d2ad7a5923b0db812c30e34a0bcc0c5f555d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/create-permission.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/create-permission.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":76}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":45}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/create-permission.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookCreateProtectPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.CreatePermissionObject;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.CreatePermissionObject}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,gCAA4D;AAAA,EAOrE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,sBAAsB,IAAI,MAAM;AAAA,EACzE;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"320bd8d74183d935d56676a52764bebc5a680592"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/create-sheet.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/create-sheet.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":65}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/create-sheet.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookCreateSheetPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.CreateSheet;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.CreateSheet}_${unitId}` as string;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,8BAA0D;AAAA,EAOnE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,WAAW,IAAI,MAAM;AAAA,EAC9D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b80d74a3af8531ed64550fe04162d07c640c05ac"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/delete-sheet.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/delete-sheet.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":65}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/delete-sheet.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookDeleteSheetPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.DeleteSheet;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.DeleteSheet}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,8BAA0D;AAAA,EAOnE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,WAAW,IAAI,MAAM;AAAA,EAC9D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8f6eb134a8444fc3a13fd7d7e1d2fd85e1f6d424"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/duplicate.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/duplicate.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":63}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/duplicate.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookDuplicatePermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Duplicate;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Duplicate}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,4BAAwD;AAAA,EAOjE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,SAAS,IAAI,MAAM;AAAA,EAC5D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"64e2b236449a0acc8b0b7d3de96c6467f50a910b"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/editable.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/editable.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":58}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/editable.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookEditablePermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Edit;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Edit}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,2BAAuD;AAAA,EAOhE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM;AAAA,EACvD;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"6e0d59c5d6d9527843b57ac21a4b28d9797c37e2"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/export.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/export.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":60}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":29}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/export.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookExportPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Export;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Export}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,yBAAqD;AAAA,EAO9D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,MAAM,IAAI,MAAM;AAAA,EACzD;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8de16c24a19f99ef977b1550ecf0c75af3f24d56"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/hide-sheet.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/hide-sheet.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":63}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/hide-sheet.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookHideSheetPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.HideSheet;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.HideSheet}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,4BAAwD;AAAA,EAOjE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,SAAS,IAAI,MAAM;AAAA,EAC5D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"60bf1e36e89bc7f96f0e7559ece6242ff5c7134e"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/history.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/history.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":61}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":30}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/history.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookHistoryPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.History;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.History}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,0BAAsD;AAAA,EAO/D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,OAAO,IAAI,MAAM;AAAA,EAC1D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4aa618f5274448687c11ddc343128a2dd353aeda"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/manage-collaborator.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/manage-collaborator.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":72}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":41}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/manage-collaborator.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookManageCollaboratorPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.ManageCollaborator;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.ManageCollaborator}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,qCAAiE;AAAA,EAO1E,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,kBAAkB,IAAI,MAAM;AAAA,EACrE;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d9738d4246c11548c06873e8cce33c6d53612cc9"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/move-sheet.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/move-sheet.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":63}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/move-sheet.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookMoveSheetPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.MoveSheet;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.MoveSheet}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,4BAAwD;AAAA,EAOjE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,SAAS,IAAI,MAAM;AAAA,EAC5D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"5d93f4bec413312ab6ca902e276a835ab1cb29f8"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/print.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/print.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":59}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/print.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookPrintPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Print;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Print}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wBAAoD;AAAA,EAO7D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,KAAK,IAAI,MAAM;AAAA,EACxD;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c46c6b1ca99286ab7f9b18b2113279ef7afafa3f"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/recover-history.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/recover-history.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":68}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":37}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/recover-history.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookRecoverHistoryPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.RecoverHistory;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.RecoverHistory}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,iCAA6D;AAAA,EAOtE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,cAAc,IAAI,MAAM;AAAA,EACjE;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c38f9a9afee2f3057817c99cfe05b4d0560a926d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/rename-sheet.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/rename-sheet.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":65}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/rename-sheet.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookRenameSheetPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.RenameSheet;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.RenameSheet}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,8BAA0D;AAAA,EAOnE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,WAAW,IAAI,MAAM;AAAA,EAC9D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c383f4f41f9cfd68575dafeff179fa5f3922908c"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/share.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/share.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":59}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/share.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookSharePermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Share;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Share}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wBAAoD;AAAA,EAO7D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,KAAK,IAAI,MAAM;AAAA,EACxD;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8e8b4f15b99f6622512b834c06982b1d9952d1af"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/view.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/view.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":58}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/view.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookViewPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.View;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.View}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,uBAAmD;AAAA,EAO5D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM;AAAA,EACvD;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f56cae2d7543fcf71af6451f909e1188713e655e"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/view-history.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/view-history.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":65}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/view-history.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookViewHistoryPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.ViewHistory;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.ViewHistory}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,8BAA0D;AAAA,EAOnE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,WAAW,IAAI,MAAM;AAAA,EAC9D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"38f11cb409b273b5765689ea65528dd1c4144e38"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/copy.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/copy.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":71}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/copy.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetCopyPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.Copy;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.Copy}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wBAAoD;AAAA,EAM7D,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM,IAAI,SAAS;AAAA,EACpE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"edb6eab66d507ad7af58e27df19ebe85aae589df"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-column.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-column.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":79}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-column.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetDeleteColumnPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.DeleteColumn;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.DeleteColumn}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,gCAA4D;AAAA,EAMrE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,YAAY,IAAI,MAAM,IAAI,SAAS;AAAA,EAC5E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"657e5ebfa657abd820172f0924841baddd268e1f"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-protection.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-protection.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":73}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":29}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-protection.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetDeleteProtectionPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.Delete;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.Delete}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,oCAAgE;AAAA,EAMzE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,MAAM,IAAI,MAAM,IAAI,SAAS;AAAA,EACtE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"80bbe7442806cc5fb316b375a9203d12fe8217f6"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-row.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-row.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":76}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-row.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetDeleteRowPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.DeleteRow;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.DeleteRow}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,6BAAyD;AAAA,EAMlE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,SAAS,IAAI,MAAM,IAAI,SAAS;AAAA,EACzE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f3e624df8bd63beb6e411a183402a6a2821391e1"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/edit.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/edit.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":71}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/edit.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetEditPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.Edit;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.Edit}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wBAAoD;AAAA,EAM7D,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM,IAAI,SAAS;AAAA,EACpE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"90cd3e55ce78bdf2284bbd5d5aebe3e712571f25"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/edit-extra-object.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/edit-extra-object.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":82}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/edit-extra-object.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetEditExtraObjectPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.EditExtraObject;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.EditExtraObject}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,mCAA+D;AAAA,EAMxE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,eAAe,IAAI,MAAM,IAAI,SAAS;AAAA,EAC/E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8854e96e5038b199172845fc04f522bd027a4409"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/filter.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/filter.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":73}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":29}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/filter.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetFilterPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.Filter;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.Filter}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,0BAAsD;AAAA,EAM/D,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,MAAM,IAAI,MAAM,IAAI,SAAS;AAAA,EACtE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d568570ec793378990983e537584027ec3014255"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-column.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-column.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":79}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-column.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetInsertColumnPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.InsertColumn;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.InsertColumn}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,gCAA4D;AAAA,EAMrE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,YAAY,IAAI,MAAM,IAAI,SAAS;AAAA,EAC5E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"003eaca68a726878766369e89d516c6822545850"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-hyperlink.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-hyperlink.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":82}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-hyperlink.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetInsertHyperlinkPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.InsertHyperlink;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.InsertHyperlink}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,mCAA+D;AAAA,EAMxE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,eAAe,IAAI,MAAM,IAAI,SAAS;AAAA,EAC/E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3a80156fc473dd4ebff9268ebbaa6ac7e9cefd9b"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-row.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-row.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":76}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-row.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetInsertRowPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.InsertRow;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.InsertRow}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,6BAAyD;AAAA,EAMlE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,SAAS,IAAI,MAAM,IAAI,SAAS;AAAA,EACzE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"bebca7733858d3f60415904c18c179b0e87f922d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/manage-collaborator.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/manage-collaborator.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":85}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":41}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/manage-collaborator.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetManageCollaboratorPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.ManageCollaborator;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.ManageCollaborator}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,sCAAkE;AAAA,EAM3E,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,kBAAkB,IAAI,MAAM,IAAI,SAAS;AAAA,EAClF;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c16cdce57e4c261b4ecec4fd2a86965372522947"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/pivot-table.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/pivot-table.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":77}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":33}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/pivot-table.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetPivotTablePermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.PivotTable;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.PivotTable}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,8BAA0D;AAAA,EAMnE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,UAAU,IAAI,MAAM,IAAI,SAAS;AAAA,EAC1E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"58fdbf984a967c04831a859635aa181ad81c737f"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/select-protected-cells.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/select-protected-cells.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":87}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":43}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/select-protected-cells.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSelectProtectedCellsPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.SelectProtectedCells;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.SelectProtectedCells}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wCAAoE;AAAA,EAM7E,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,oBAAoB,IAAI,MAAM,IAAI,SAAS;AAAA,EACpF;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8481b1a839f1c62f07b2106c96bc1cad75e35741"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/select-un-protected-cells.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/select-un-protected-cells.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":89}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":45}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/select-un-protected-cells.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSelectUnProtectedCellsPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.SelectUnProtectedCells;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.SelectUnProtectedCells}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,0CAAsE;AAAA,EAM/E,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,sBAAsB,IAAI,MAAM,IAAI,SAAS;AAAA,EACtF;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"adb1791d3b95cb791b034b2322cfda7dbd7457ca"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-cell-style.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-cell-style.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":79}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-cell-style.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSetCellStylePermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.SetCellStyle;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.SetCellStyle}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,gCAA4D;AAAA,EAMrE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,YAAY,IAAI,MAAM,IAAI,SAAS;AAAA,EAC5E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4795966c1f688514909e89fcb6c528b41dd3fb19"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-cell-value.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-cell-value.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":79}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-cell-value.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSetCellValuePermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.SetCellValue;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.SetCellValue}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,gCAA4D;AAAA,EAMrE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,YAAY,IAAI,MAAM,IAAI,SAAS;AAAA,EAC5E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"89776ecc2ffc57e1bdca5b0b5db80f0cb9f0d341"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-column-style.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-column-style.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":81}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":37}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-column-style.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSetColumnStylePermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.SetColumnStyle;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.SetColumnStyle}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,kCAA8D;AAAA,EAMvE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,cAAc,IAAI,MAAM,IAAI,SAAS;AAAA,EAC9E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"81926dfe4e3987a2088f6e0395342c5a68a61957"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-row-style.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-row-style.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":78}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-row-style.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSetRowStylePermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.SetRowStyle;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.SetRowStyle}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,+BAA2D;AAAA,EAMpE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,WAAW,IAAI,MAAM,IAAI,SAAS;AAAA,EAC3E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"449fd0cad040c2e43a34493e1713c039349a731b"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/sort.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/sort.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":71}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/sort.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSortPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.Sort;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.Sort}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wBAAoD;AAAA,EAM7D,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM,IAAI,SAAS;AAAA,EACpE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"bf2d337517ebd85a8b28be48174d34760447355a"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/view.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/view.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":71}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/view.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetViewPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.View;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.View}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wBAAoD;AAAA,EAM7D,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM,IAAI,SAAS;AAAA,EACpE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2801f2c609d83e25e4bf6ea22e8938037deda1ca"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/set-range-values.command.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/set-range-values.command.ts","statementMap":{"0":{"start":{"line":18,"column":37},"end":{"line":87,"column":1}},"1":{"start":{"line":22,"column":27},"end":{"line":22,"column":56}},"2":{"start":{"line":23,"column":28},"end":{"line":23,"column":58}},"3":{"start":{"line":24,"column":34},"end":{"line":24,"column":70}},"4":{"start":{"line":25,"column":36},"end":{"line":25,"column":73}},"5":{"start":{"line":26,"column":36},"end":{"line":26,"column":73}},"6":{"start":{"line":27,"column":30},"end":{"line":27,"column":62}},"7":{"start":{"line":28,"column":19},"end":{"line":28,"column":71}},"8":{"start":{"line":29,"column":4},"end":{"line":29,"column":30}},"9":{"start":{"line":29,"column":17},"end":{"line":29,"column":30}},"10":{"start":{"line":30,"column":55},"end":{"line":30,"column":61}},"11":{"start":{"line":31,"column":41},"end":{"line":31,"column":47}},"12":{"start":{"line":32,"column":30},"end":{"line":32,"column":115}},"13":{"start":{"line":32,"column":107},"end":{"line":32,"column":114}},"14":{"start":{"line":33,"column":4},"end":{"line":33,"column":70}},"15":{"start":{"line":33,"column":57},"end":{"line":33,"column":70}},"16":{"start":{"line":34,"column":4},"end":{"line":34,"column":111}},"17":{"start":{"line":34,"column":98},"end":{"line":34,"column":111}},"18":{"start":{"line":35,"column":22},"end":{"line":35,"column":40}},"19":{"start":{"line":37,"column":4},"end":{"line":57,"column":5}},"20":{"start":{"line":38,"column":6},"end":{"line":45,"column":7}},"21":{"start":{"line":38,"column":19},"end":{"line":38,"column":20}},"22":{"start":{"line":39,"column":61},"end":{"line":39,"column":81}},"23":{"start":{"line":40,"column":8},"end":{"line":44,"column":9}},"24":{"start":{"line":40,"column":21},"end":{"line":40,"column":22}},"25":{"start":{"line":41,"column":10},"end":{"line":43,"column":11}},"26":{"start":{"line":41,"column":23},"end":{"line":41,"column":24}},"27":{"start":{"line":42,"column":12},"end":{"line":42,"column":75}},"28":{"start":{"line":46,"column":11},"end":{"line":57,"column":5}},"29":{"start":{"line":47,"column":6},"end":{"line":54,"column":7}},"30":{"start":{"line":47,"column":19},"end":{"line":47,"column":20}},"31":{"start":{"line":48,"column":61},"end":{"line":48,"column":81}},"32":{"start":{"line":49,"column":8},"end":{"line":53,"column":9}},"33":{"start":{"line":49,"column":21},"end":{"line":49,"column":29}},"34":{"start":{"line":50,"column":10},"end":{"line":52,"column":11}},"35":{"start":{"line":50,"column":23},"end":{"line":50,"column":34}},"36":{"start":{"line":51,"column":12},"end":{"line":51,"column":44}},"37":{"start":{"line":56,"column":6},"end":{"line":56,"column":28}},"38":{"start":{"line":58,"column":41},"end":{"line":58,"column":113}},"39":{"start":{"line":59,"column":23},"end":{"line":59,"column":96}},"40":{"start":{"line":60,"column":35},"end":{"line":60,"column":125}},"41":{"start":{"line":61,"column":4},"end":{"line":61,"column":46}},"42":{"start":{"line":61,"column":33},"end":{"line":61,"column":46}},"43":{"start":{"line":62,"column":29},"end":{"line":65,"column":6}},"44":{"start":{"line":66,"column":19},"end":{"line":66,"column":62}},"45":{"start":{"line":67,"column":4},"end":{"line":84,"column":5}},"46":{"start":{"line":68,"column":33},"end":{"line":68,"column":109}},"47":{"start":{"line":69,"column":6},"end":{"line":82,"column":9}},"48":{"start":{"line":83,"column":6},"end":{"line":83,"column":18}},"49":{"start":{"line":85,"column":4},"end":{"line":85,"column":17}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":21,"column":11},"end":{"line":21,"column":12}},"loc":{"start":{"line":21,"column":33},"end":{"line":86,"column":3}},"line":21},"1":{"name":"(anonymous_1)","decl":{"start":{"line":32,"column":100},"end":{"line":32,"column":101}},"loc":{"start":{"line":32,"column":107},"end":{"line":32,"column":114}},"line":32}},"branchMap":{"0":{"loc":{"start":{"line":29,"column":4},"end":{"line":29,"column":30}},"type":"if","locations":[{"start":{"line":29,"column":4},"end":{"line":29,"column":30}},{"start":{},"end":{}}],"line":29},"1":{"loc":{"start":{"line":32,"column":30},"end":{"line":32,"column":115}},"type":"cond-expr","locations":[{"start":{"line":32,"column":38},"end":{"line":32,"column":45}},{"start":{"line":32,"column":48},"end":{"line":32,"column":115}}],"line":32},"2":{"loc":{"start":{"line":33,"column":4},"end":{"line":33,"column":70}},"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":33,"column":70}},{"start":{},"end":{}}],"line":33},"3":{"loc":{"start":{"line":33,"column":8},"end":{"line":33,"column":55}},"type":"binary-expr","locations":[{"start":{"line":33,"column":8},"end":{"line":33,"column":26}},{"start":{"line":33,"column":30},"end":{"line":33,"column":55}}],"line":33},"4":{"loc":{"start":{"line":34,"column":4},"end":{"line":34,"column":111}},"type":"if","locations":[{"start":{"line":34,"column":4},"end":{"line":34,"column":111}},{"start":{},"end":{}}],"line":34},"5":{"loc":{"start":{"line":37,"column":4},"end":{"line":57,"column":5}},"type":"if","locations":[{"start":{"line":37,"column":4},"end":{"line":57,"column":5}},{"start":{"line":46,"column":11},"end":{"line":57,"column":5}}],"line":37},"6":{"loc":{"start":{"line":46,"column":11},"end":{"line":57,"column":5}},"type":"if","locations":[{"start":{"line":46,"column":11},"end":{"line":57,"column":5}},{"start":{"line":55,"column":11},"end":{"line":57,"column":5}}],"line":46},"7":{"loc":{"start":{"line":58,"column":73},"end":{"line":58,"column":111}},"type":"binary-expr","locations":[{"start":{"line":58,"column":73},"end":{"line":58,"column":86}},{"start":{"line":58,"column":90},"end":{"line":58,"column":111}}],"line":58},"8":{"loc":{"start":{"line":61,"column":4},"end":{"line":61,"column":46}},"type":"if","locations":[{"start":{"line":61,"column":4},"end":{"line":61,"column":46}},{"start":{},"end":{}}],"line":61},"9":{"loc":{"start":{"line":67,"column":4},"end":{"line":84,"column":5}},"type":"if","locations":[{"start":{"line":67,"column":4},"end":{"line":84,"column":5}},{"start":{},"end":{}}],"line":67},"10":{"loc":{"start":{"line":68,"column":58},"end":{"line":68,"column":87}},"type":"binary-expr","locations":[{"start":{"line":68,"column":58},"end":{"line":68,"column":63}},{"start":{"line":68,"column":67},"end":{"line":68,"column":87}}],"line":68}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0},"f":{"0":0,"1":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/set-range-values.command.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICellData, ICommand, IObjectMatrixPrimitiveType, IRange } from '@univerjs/core';\nimport type { ISheetCommandSharedParams } from '../utils/interface';\n\nimport {\n    CommandType,\n    ICommandService,\n    IPermissionService,\n    isICellData,\n    IUndoRedoService,\n    IUniverInstanceService,\n    ObjectMatrix,\n    sequenceExecute,\n    Tools,\n} from '@univerjs/core';\nimport { WorksheetEditPermission } from '../../services/permission/permission-point';\nimport { SheetsSelectionsService } from '../../services/selections/selection.service';\nimport { SheetInterceptorService } from '../../services/sheet-interceptor/sheet-interceptor.service';\nimport { SetRangeValuesMutation, SetRangeValuesUndoMutationFactory } from '../mutations/set-range-values.mutation';\nimport { followSelectionOperation } from './utils/selection-utils';\nimport { getSheetCommandTarget } from './utils/target-util';\n\nexport interface ISetRangeValuesCommandParams extends Partial<ISheetCommandSharedParams> {\n    range?: IRange;\n\n    /**\n     * 1. ICellData: Normal cell data\n     * 2. ICellData[][]: The two-dimensional array indicates the data of multiple cells\n     * 3. IObjectMatrixPrimitiveType<ICellData>: Bring the row/column information MATRIX, indicating the data of multiple cells\n     */\n    value: ICellData | ICellData[][] | IObjectMatrixPrimitiveType<ICellData>;\n\n    redoUndoId?: string;\n}\n\n/**\n * The command to set values for ranges.\n */\nexport const SetRangeValuesCommand: ICommand = {\n    id: 'sheet.command.set-range-values',\n    type: CommandType.COMMAND,\n\n    handler: (accessor: IAccessor, params: ISetRangeValuesCommandParams) => {\n        const commandService = accessor.get(ICommandService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n        const permissionService = accessor.get(IPermissionService);\n        const target = getSheetCommandTarget(univerInstanceService, params);\n        if (!target) return false;\n\n        const { subUnitId, unitId, workbook, worksheet } = target;\n        const { value, range, redoUndoId } = params;\n        const currentSelections = range ? [range] : selectionManagerService.getCurrentSelections()?.map((s) => s.range);\n\n        if (!currentSelections || !currentSelections.length) return false;\n        if (!permissionService.getPermissionPoint(new WorksheetEditPermission(unitId, subUnitId).id)) return false;\n\n        const cellValue = new ObjectMatrix<ICellData>();\n        let realCellValue: IObjectMatrixPrimitiveType<ICellData> | undefined;\n\n        if (Tools.isArray(value)) {\n            for (let i = 0; i < currentSelections.length; i++) {\n                const { startRow, startColumn, endRow, endColumn } = currentSelections[i];\n\n                for (let r = 0; r <= endRow - startRow; r++) {\n                    for (let c = 0; c <= endColumn - startColumn; c++) {\n                        cellValue.setValue(r + startRow, c + startColumn, value[r][c]);\n                    }\n                }\n            }\n        } else if (isICellData(value)) {\n            for (let i = 0; i < currentSelections.length; i++) {\n                const { startRow, startColumn, endRow, endColumn } = currentSelections[i];\n\n                for (let r = startRow; r <= endRow; r++) {\n                    for (let c = startColumn; c <= endColumn; c++) {\n                        cellValue.setValue(r, c, value);\n                    }\n                }\n            }\n        } else {\n            realCellValue = value as IObjectMatrixPrimitiveType<ICellData>;\n        }\n\n        const setRangeValuesMutationParams = { subUnitId, unitId, cellValue: realCellValue ?? cellValue.getMatrix() };\n        const redoParams = SetRangeValuesUndoMutationFactory(accessor, setRangeValuesMutationParams);\n\n        const setValueMutationResult = commandService.syncExecuteCommand(SetRangeValuesMutation.id, setRangeValuesMutationParams);\n        if (!setValueMutationResult) return false;\n\n        const { undos, redos } = sheetInterceptorService.onCommandExecute({\n            id: SetRangeValuesCommand.id,\n            params: { ...setRangeValuesMutationParams, range: currentSelections },\n        });\n\n        const result = sequenceExecute([...redos], commandService);\n        if (result.result) {\n            const selectionOperation = followSelectionOperation(range ?? cellValue.getRange(), workbook, worksheet);\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: [\n                    { id: SetRangeValuesMutation.id, params: redoParams },\n                    ...undos,\n                    selectionOperation,\n                ],\n                redoMutations: [\n                    { id: SetRangeValuesMutation.id, params: setRangeValuesMutationParams },\n                    ...redos,\n                    Tools.deepClone(selectionOperation),\n                ],\n                id: redoUndoId,\n            });\n\n            return true;\n        }\n\n        return false;\n    },\n};\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ccc944c3a0e31cfba53ebf7bbbfb2a111252dfe8"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/utils/handle-range-mutation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/utils/handle-range-mutation.ts","statementMap":{"0":{"start":{"line":11,"column":46},"end":{"line":16,"column":2}},"1":{"start":{"line":11,"column":69},"end":{"line":16,"column":1}},"2":{"start":{"line":18,"column":15},"end":{"line":18,"column":17}},"3":{"start":{"line":19,"column":15},"end":{"line":19,"column":17}},"4":{"start":{"line":20,"column":71},"end":{"line":20,"column":77}},"5":{"start":{"line":21,"column":26},"end":{"line":21,"column":62}},"6":{"start":{"line":22,"column":34},"end":{"line":22,"column":71}},"7":{"start":{"line":23,"column":19},"end":{"line":23,"column":65}},"8":{"start":{"line":24,"column":20},"end":{"line":24,"column":58}},"9":{"start":{"line":25,"column":2},"end":{"line":105,"column":3}},"10":{"start":{"line":26,"column":23},"end":{"line":26,"column":48}},"11":{"start":{"line":27,"column":22},"end":{"line":27,"column":47}},"12":{"start":{"line":28,"column":4},"end":{"line":79,"column":5}},"13":{"start":{"line":31,"column":6},"end":{"line":68,"column":7}},"14":{"start":{"line":32,"column":23},"end":{"line":32,"column":63}},"15":{"start":{"line":33,"column":24},"end":{"line":33,"column":25}},"16":{"start":{"line":34,"column":8},"end":{"line":38,"column":9}},"17":{"start":{"line":34,"column":23},"end":{"line":34,"column":37}},"18":{"start":{"line":35,"column":26},"end":{"line":35,"column":48}},"19":{"start":{"line":36,"column":28},"end":{"line":36,"column":69}},"20":{"start":{"line":37,"column":10},"end":{"line":37,"column":53}},"21":{"start":{"line":39,"column":8},"end":{"line":44,"column":10}},"22":{"start":{"line":45,"column":22},"end":{"line":45,"column":61}},"23":{"start":{"line":46,"column":8},"end":{"line":51,"column":10}},"24":{"start":{"line":53,"column":26},"end":{"line":53,"column":72}},"25":{"start":{"line":54,"column":23},"end":{"line":54,"column":39}},"26":{"start":{"line":55,"column":8},"end":{"line":60,"column":10}},"27":{"start":{"line":61,"column":22},"end":{"line":61,"column":55}},"28":{"start":{"line":62,"column":8},"end":{"line":67,"column":10}},"29":{"start":{"line":69,"column":33},"end":{"line":74,"column":7}},"30":{"start":{"line":75,"column":6},"end":{"line":78,"column":7}},"31":{"start":{"line":76,"column":8},"end":{"line":76,"column":47}},"32":{"start":{"line":77,"column":8},"end":{"line":77,"column":47}},"33":{"start":{"line":80,"column":4},"end":{"line":89,"column":5}},"34":{"start":{"line":81,"column":6},"end":{"line":88,"column":7}},"35":{"start":{"line":81,"column":21},"end":{"line":81,"column":35}},"36":{"start":{"line":82,"column":8},"end":{"line":84,"column":9}},"37":{"start":{"line":83,"column":10},"end":{"line":83,"column":30}},"38":{"start":{"line":85,"column":8},"end":{"line":87,"column":9}},"39":{"start":{"line":85,"column":26},"end":{"line":85,"column":43}},"40":{"start":{"line":86,"column":10},"end":{"line":86,"column":40}},"41":{"start":{"line":90,"column":41},"end":{"line":94,"column":5}},"42":{"start":{"line":95,"column":45},"end":{"line":98,"column":5}},"43":{"start":{"line":99,"column":65},"end":{"line":102,"column":6}},"44":{"start":{"line":103,"column":4},"end":{"line":103,"column":108}},"45":{"start":{"line":104,"column":4},"end":{"line":104,"column":112}},"46":{"start":{"line":106,"column":2},"end":{"line":109,"column":4}},"47":{"start":{"line":112,"column":15},"end":{"line":112,"column":17}},"48":{"start":{"line":113,"column":15},"end":{"line":113,"column":17}},"49":{"start":{"line":114,"column":55},"end":{"line":114,"column":61}},"50":{"start":{"line":115,"column":26},"end":{"line":115,"column":62}},"51":{"start":{"line":116,"column":34},"end":{"line":116,"column":71}},"52":{"start":{"line":117,"column":19},"end":{"line":117,"column":65}},"53":{"start":{"line":118,"column":20},"end":{"line":118,"column":58}},"54":{"start":{"line":119,"column":2},"end":{"line":195,"column":3}},"55":{"start":{"line":120,"column":23},"end":{"line":120,"column":48}},"56":{"start":{"line":121,"column":22},"end":{"line":121,"column":47}},"57":{"start":{"line":122,"column":41},"end":{"line":126,"column":5}},"58":{"start":{"line":127,"column":45},"end":{"line":130,"column":5}},"59":{"start":{"line":131,"column":24},"end":{"line":134,"column":6}},"60":{"start":{"line":135,"column":4},"end":{"line":135,"column":109}},"61":{"start":{"line":136,"column":4},"end":{"line":139,"column":7}},"62":{"start":{"line":140,"column":4},"end":{"line":194,"column":5}},"63":{"start":{"line":141,"column":26},"end":{"line":141,"column":30}},"64":{"start":{"line":142,"column":24},"end":{"line":142,"column":28}},"65":{"start":{"line":143,"column":6},"end":{"line":164,"column":7}},"66":{"start":{"line":144,"column":23},"end":{"line":144,"column":63}},"67":{"start":{"line":145,"column":24},"end":{"line":145,"column":25}},"68":{"start":{"line":146,"column":8},"end":{"line":150,"column":9}},"69":{"start":{"line":146,"column":23},"end":{"line":146,"column":37}},"70":{"start":{"line":147,"column":26},"end":{"line":147,"column":48}},"71":{"start":{"line":148,"column":28},"end":{"line":148,"column":69}},"72":{"start":{"line":149,"column":10},"end":{"line":149,"column":53}},"73":{"start":{"line":151,"column":8},"end":{"line":156,"column":10}},"74":{"start":{"line":157,"column":22},"end":{"line":157,"column":61}},"75":{"start":{"line":158,"column":8},"end":{"line":163,"column":10}},"76":{"start":{"line":165,"column":6},"end":{"line":181,"column":7}},"77":{"start":{"line":166,"column":26},"end":{"line":166,"column":72}},"78":{"start":{"line":167,"column":23},"end":{"line":167,"column":39}},"79":{"start":{"line":168,"column":8},"end":{"line":173,"column":10}},"80":{"start":{"line":174,"column":22},"end":{"line":174,"column":55}},"81":{"start":{"line":175,"column":8},"end":{"line":180,"column":10}},"82":{"start":{"line":182,"column":6},"end":{"line":193,"column":7}},"83":{"start":{"line":183,"column":35},"end":{"line":188,"column":9}},"84":{"start":{"line":189,"column":8},"end":{"line":192,"column":9}},"85":{"start":{"line":190,"column":10},"end":{"line":190,"column":49}},"86":{"start":{"line":191,"column":10},"end":{"line":191,"column":49}},"87":{"start":{"line":196,"column":2},"end":{"line":199,"column":4}},"88":{"start":{"line":202,"column":55},"end":{"line":202,"column":60}},"89":{"start":{"line":203,"column":2},"end":{"line":245,"column":3}},"90":{"start":{"line":204,"column":17},"end":{"line":204,"column":38}},"91":{"start":{"line":205,"column":4},"end":{"line":214,"column":5}},"92":{"start":{"line":205,"column":17},"end":{"line":205,"column":27}},"93":{"start":{"line":206,"column":6},"end":{"line":213,"column":7}},"94":{"start":{"line":206,"column":19},"end":{"line":206,"column":30}},"95":{"start":{"line":207,"column":22},"end":{"line":207,"column":47}},"96":{"start":{"line":208,"column":8},"end":{"line":212,"column":9}},"97":{"start":{"line":209,"column":10},"end":{"line":209,"column":50}},"98":{"start":{"line":211,"column":10},"end":{"line":211,"column":50}},"99":{"start":{"line":215,"column":4},"end":{"line":223,"column":5}},"100":{"start":{"line":215,"column":17},"end":{"line":215,"column":23}},"101":{"start":{"line":216,"column":6},"end":{"line":222,"column":7}},"102":{"start":{"line":216,"column":19},"end":{"line":216,"column":30}},"103":{"start":{"line":217,"column":8},"end":{"line":221,"column":9}},"104":{"start":{"line":218,"column":10},"end":{"line":218,"column":53}},"105":{"start":{"line":220,"column":10},"end":{"line":220,"column":43}},"106":{"start":{"line":224,"column":9},"end":{"line":245,"column":3}},"107":{"start":{"line":225,"column":20},"end":{"line":225,"column":47}},"108":{"start":{"line":226,"column":4},"end":{"line":235,"column":5}},"109":{"start":{"line":226,"column":17},"end":{"line":226,"column":25}},"110":{"start":{"line":227,"column":6},"end":{"line":234,"column":7}},"111":{"start":{"line":227,"column":19},"end":{"line":227,"column":32}},"112":{"start":{"line":228,"column":22},"end":{"line":228,"column":47}},"113":{"start":{"line":229,"column":8},"end":{"line":233,"column":9}},"114":{"start":{"line":230,"column":10},"end":{"line":230,"column":53}},"115":{"start":{"line":232,"column":10},"end":{"line":232,"column":53}},"116":{"start":{"line":236,"column":4},"end":{"line":244,"column":5}},"117":{"start":{"line":236,"column":17},"end":{"line":236,"column":25}},"118":{"start":{"line":237,"column":6},"end":{"line":243,"column":7}},"119":{"start":{"line":237,"column":19},"end":{"line":237,"column":28}},"120":{"start":{"line":238,"column":8},"end":{"line":242,"column":9}},"121":{"start":{"line":239,"column":10},"end":{"line":239,"column":53}},"122":{"start":{"line":241,"column":10},"end":{"line":241,"column":43}},"123":{"start":{"line":247,"column":46},"end":{"line":285,"column":1}},"124":{"start":{"line":248,"column":32},"end":{"line":248,"column":68}},"125":{"start":{"line":249,"column":17},"end":{"line":249,"column":70}},"126":{"start":{"line":250,"column":2},"end":{"line":250,"column":27}},"127":{"start":{"line":250,"column":15},"end":{"line":250,"column":27}},"128":{"start":{"line":251,"column":24},"end":{"line":251,"column":30}},"129":{"start":{"line":252,"column":21},"end":{"line":252,"column":46}},"130":{"start":{"line":253,"column":19},"end":{"line":253,"column":37}},"131":{"start":{"line":254,"column":21},"end":{"line":254,"column":51}},"132":{"start":{"line":255,"column":24},"end":{"line":255,"column":57}},"133":{"start":{"line":256,"column":55},"end":{"line":256,"column":67}},"134":{"start":{"line":257,"column":2},"end":{"line":280,"column":3}},"135":{"start":{"line":258,"column":4},"end":{"line":265,"column":5}},"136":{"start":{"line":258,"column":17},"end":{"line":258,"column":25}},"137":{"start":{"line":259,"column":6},"end":{"line":264,"column":7}},"138":{"start":{"line":259,"column":19},"end":{"line":259,"column":30}},"139":{"start":{"line":260,"column":8},"end":{"line":263,"column":9}},"140":{"start":{"line":261,"column":23},"end":{"line":261,"column":48}},"141":{"start":{"line":262,"column":10},"end":{"line":262,"column":40}},"142":{"start":{"line":266,"column":9},"end":{"line":280,"column":3}},"143":{"start":{"line":267,"column":4},"end":{"line":279,"column":5}},"144":{"start":{"line":267,"column":17},"end":{"line":267,"column":25}},"145":{"start":{"line":268,"column":6},"end":{"line":278,"column":7}},"146":{"start":{"line":268,"column":19},"end":{"line":268,"column":30}},"147":{"start":{"line":269,"column":8},"end":{"line":277,"column":9}},"148":{"start":{"line":270,"column":23},"end":{"line":270,"column":48}},"149":{"start":{"line":271,"column":10},"end":{"line":271,"column":40}},"150":{"start":{"line":273,"column":10},"end":{"line":276,"column":11}},"151":{"start":{"line":273,"column":23},"end":{"line":273,"column":24}},"152":{"start":{"line":274,"column":25},"end":{"line":274,"column":50}},"153":{"start":{"line":275,"column":12},"end":{"line":275,"column":46}},"154":{"start":{"line":281,"column":2},"end":{"line":284,"column":4}},"155":{"start":{"line":287,"column":55},"end":{"line":287,"column":60}},"156":{"start":{"line":288,"column":15},"end":{"line":288,"column":36}},"157":{"start":{"line":289,"column":18},"end":{"line":289,"column":45}},"158":{"start":{"line":290,"column":2},"end":{"line":312,"column":3}},"159":{"start":{"line":291,"column":4},"end":{"line":300,"column":5}},"160":{"start":{"line":291,"column":17},"end":{"line":291,"column":25}},"161":{"start":{"line":292,"column":6},"end":{"line":299,"column":7}},"162":{"start":{"line":292,"column":19},"end":{"line":292,"column":30}},"163":{"start":{"line":293,"column":22},"end":{"line":293,"column":54}},"164":{"start":{"line":294,"column":8},"end":{"line":298,"column":9}},"165":{"start":{"line":295,"column":10},"end":{"line":295,"column":43}},"166":{"start":{"line":297,"column":10},"end":{"line":297,"column":43}},"167":{"start":{"line":301,"column":9},"end":{"line":312,"column":3}},"168":{"start":{"line":302,"column":4},"end":{"line":311,"column":5}},"169":{"start":{"line":302,"column":17},"end":{"line":302,"column":25}},"170":{"start":{"line":303,"column":6},"end":{"line":310,"column":7}},"171":{"start":{"line":303,"column":19},"end":{"line":303,"column":30}},"172":{"start":{"line":304,"column":22},"end":{"line":304,"column":57}},"173":{"start":{"line":305,"column":8},"end":{"line":309,"column":9}},"174":{"start":{"line":306,"column":10},"end":{"line":306,"column":43}},"175":{"start":{"line":308,"column":10},"end":{"line":308,"column":43}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":11,"column":46},"end":{"line":11,"column":47}},"loc":{"start":{"line":11,"column":69},"end":{"line":16,"column":1}},"line":11},"1":{"name":"getInsertRangeMutations","decl":{"start":{"line":17,"column":16},"end":{"line":17,"column":39}},"loc":{"start":{"line":17,"column":58},"end":{"line":110,"column":1}},"line":17},"2":{"name":"getRemoveRangeMutations","decl":{"start":{"line":111,"column":16},"end":{"line":111,"column":39}},"loc":{"start":{"line":111,"column":58},"end":{"line":200,"column":1}},"line":111},"3":{"name":"handleInsertRangeMutation","decl":{"start":{"line":201,"column":16},"end":{"line":201,"column":41}},"loc":{"start":{"line":201,"column":115},"end":{"line":246,"column":1}},"line":201},"4":{"name":"(anonymous_4)","decl":{"start":{"line":247,"column":46},"end":{"line":247,"column":47}},"loc":{"start":{"line":247,"column":68},"end":{"line":285,"column":1}},"line":247},"5":{"name":"handleDeleteRangeMutation","decl":{"start":{"line":286,"column":16},"end":{"line":286,"column":41}},"loc":{"start":{"line":286,"column":104},"end":{"line":313,"column":1}},"line":286}},"branchMap":{"0":{"loc":{"start":{"line":20,"column":52},"end":{"line":20,"column":66}},"type":"default-arg","locations":[{"start":{"line":20,"column":64},"end":{"line":20,"column":66}}],"line":20},"1":{"loc":{"start":{"line":25,"column":2},"end":{"line":105,"column":3}},"type":"if","locations":[{"start":{"line":25,"column":2},"end":{"line":105,"column":3}},{"start":{},"end":{}}],"line":25},"2":{"loc":{"start":{"line":28,"column":4},"end":{"line":79,"column":5}},"type":"if","locations":[{"start":{"line":28,"column":4},"end":{"line":79,"column":5}},{"start":{},"end":{}}],"line":28},"3":{"loc":{"start":{"line":28,"column":8},"end":{"line":28,"column":86}},"type":"binary-expr","locations":[{"start":{"line":28,"column":8},"end":{"line":28,"column":48}},{"start":{"line":28,"column":52},"end":{"line":28,"column":86}}],"line":28},"4":{"loc":{"start":{"line":31,"column":6},"end":{"line":68,"column":7}},"type":"if","locations":[{"start":{"line":31,"column":6},"end":{"line":68,"column":7}},{"start":{"line":52,"column":13},"end":{"line":68,"column":7}}],"line":31},"5":{"loc":{"start":{"line":36,"column":28},"end":{"line":36,"column":69}},"type":"cond-expr","locations":[{"start":{"line":36,"column":38},"end":{"line":36,"column":65}},{"start":{"line":36,"column":68},"end":{"line":36,"column":69}}],"line":36},"6":{"loc":{"start":{"line":75,"column":6},"end":{"line":78,"column":7}},"type":"if","locations":[{"start":{"line":75,"column":6},"end":{"line":78,"column":7}},{"start":{},"end":{}}],"line":75},"7":{"loc":{"start":{"line":80,"column":4},"end":{"line":89,"column":5}},"type":"if","locations":[{"start":{"line":80,"column":4},"end":{"line":89,"column":5}},{"start":{},"end":{}}],"line":80},"8":{"loc":{"start":{"line":82,"column":8},"end":{"line":84,"column":9}},"type":"if","locations":[{"start":{"line":82,"column":8},"end":{"line":84,"column":9}},{"start":{},"end":{}}],"line":82},"9":{"loc":{"start":{"line":119,"column":2},"end":{"line":195,"column":3}},"type":"if","locations":[{"start":{"line":119,"column":2},"end":{"line":195,"column":3}},{"start":{},"end":{}}],"line":119},"10":{"loc":{"start":{"line":140,"column":4},"end":{"line":194,"column":5}},"type":"if","locations":[{"start":{"line":140,"column":4},"end":{"line":194,"column":5}},{"start":{},"end":{}}],"line":140},"11":{"loc":{"start":{"line":140,"column":8},"end":{"line":140,"column":86}},"type":"binary-expr","locations":[{"start":{"line":140,"column":8},"end":{"line":140,"column":48}},{"start":{"line":140,"column":52},"end":{"line":140,"column":86}}],"line":140},"12":{"loc":{"start":{"line":143,"column":6},"end":{"line":164,"column":7}},"type":"if","locations":[{"start":{"line":143,"column":6},"end":{"line":164,"column":7}},{"start":{},"end":{}}],"line":143},"13":{"loc":{"start":{"line":143,"column":10},"end":{"line":143,"column":87}},"type":"binary-expr","locations":[{"start":{"line":143,"column":10},"end":{"line":143,"column":46}},{"start":{"line":143,"column":50},"end":{"line":143,"column":87}}],"line":143},"14":{"loc":{"start":{"line":148,"column":28},"end":{"line":148,"column":69}},"type":"cond-expr","locations":[{"start":{"line":148,"column":38},"end":{"line":148,"column":65}},{"start":{"line":148,"column":68},"end":{"line":148,"column":69}}],"line":148},"15":{"loc":{"start":{"line":165,"column":6},"end":{"line":181,"column":7}},"type":"if","locations":[{"start":{"line":165,"column":6},"end":{"line":181,"column":7}},{"start":{},"end":{}}],"line":165},"16":{"loc":{"start":{"line":165,"column":10},"end":{"line":165,"column":78}},"type":"binary-expr","locations":[{"start":{"line":165,"column":10},"end":{"line":165,"column":43}},{"start":{"line":165,"column":47},"end":{"line":165,"column":78}}],"line":165},"17":{"loc":{"start":{"line":182,"column":6},"end":{"line":193,"column":7}},"type":"if","locations":[{"start":{"line":182,"column":6},"end":{"line":193,"column":7}},{"start":{},"end":{}}],"line":182},"18":{"loc":{"start":{"line":182,"column":10},"end":{"line":182,"column":38}},"type":"binary-expr","locations":[{"start":{"line":182,"column":10},"end":{"line":182,"column":23}},{"start":{"line":182,"column":27},"end":{"line":182,"column":38}}],"line":182},"19":{"loc":{"start":{"line":189,"column":8},"end":{"line":192,"column":9}},"type":"if","locations":[{"start":{"line":189,"column":8},"end":{"line":192,"column":9}},{"start":{},"end":{}}],"line":189},"20":{"loc":{"start":{"line":203,"column":2},"end":{"line":245,"column":3}},"type":"if","locations":[{"start":{"line":203,"column":2},"end":{"line":245,"column":3}},{"start":{"line":224,"column":9},"end":{"line":245,"column":3}}],"line":203},"21":{"loc":{"start":{"line":208,"column":8},"end":{"line":212,"column":9}},"type":"if","locations":[{"start":{"line":208,"column":8},"end":{"line":212,"column":9}},{"start":{"line":210,"column":15},"end":{"line":212,"column":9}}],"line":208},"22":{"loc":{"start":{"line":217,"column":8},"end":{"line":221,"column":9}},"type":"if","locations":[{"start":{"line":217,"column":8},"end":{"line":221,"column":9}},{"start":{"line":219,"column":15},"end":{"line":221,"column":9}}],"line":217},"23":{"loc":{"start":{"line":217,"column":12},"end":{"line":217,"column":56}},"type":"binary-expr","locations":[{"start":{"line":217,"column":12},"end":{"line":217,"column":21}},{"start":{"line":217,"column":25},"end":{"line":217,"column":37}},{"start":{"line":217,"column":41},"end":{"line":217,"column":56}}],"line":217},"24":{"loc":{"start":{"line":224,"column":9},"end":{"line":245,"column":3}},"type":"if","locations":[{"start":{"line":224,"column":9},"end":{"line":245,"column":3}},{"start":{},"end":{}}],"line":224},"25":{"loc":{"start":{"line":229,"column":8},"end":{"line":233,"column":9}},"type":"if","locations":[{"start":{"line":229,"column":8},"end":{"line":233,"column":9}},{"start":{"line":231,"column":15},"end":{"line":233,"column":9}}],"line":229},"26":{"loc":{"start":{"line":238,"column":8},"end":{"line":242,"column":9}},"type":"if","locations":[{"start":{"line":238,"column":8},"end":{"line":242,"column":9}},{"start":{"line":240,"column":15},"end":{"line":242,"column":9}}],"line":238},"27":{"loc":{"start":{"line":238,"column":12},"end":{"line":238,"column":56}},"type":"binary-expr","locations":[{"start":{"line":238,"column":12},"end":{"line":238,"column":21}},{"start":{"line":238,"column":25},"end":{"line":238,"column":37}},{"start":{"line":238,"column":41},"end":{"line":238,"column":56}}],"line":238},"28":{"loc":{"start":{"line":250,"column":2},"end":{"line":250,"column":27}},"type":"if","locations":[{"start":{"line":250,"column":2},"end":{"line":250,"column":27}},{"start":{},"end":{}}],"line":250},"29":{"loc":{"start":{"line":257,"column":2},"end":{"line":280,"column":3}},"type":"if","locations":[{"start":{"line":257,"column":2},"end":{"line":280,"column":3}},{"start":{"line":266,"column":9},"end":{"line":280,"column":3}}],"line":257},"30":{"loc":{"start":{"line":260,"column":8},"end":{"line":263,"column":9}},"type":"if","locations":[{"start":{"line":260,"column":8},"end":{"line":263,"column":9}},{"start":{},"end":{}}],"line":260},"31":{"loc":{"start":{"line":266,"column":9},"end":{"line":280,"column":3}},"type":"if","locations":[{"start":{"line":266,"column":9},"end":{"line":280,"column":3}},{"start":{},"end":{}}],"line":266},"32":{"loc":{"start":{"line":269,"column":8},"end":{"line":277,"column":9}},"type":"if","locations":[{"start":{"line":269,"column":8},"end":{"line":277,"column":9}},{"start":{"line":272,"column":15},"end":{"line":277,"column":9}}],"line":269},"33":{"loc":{"start":{"line":290,"column":2},"end":{"line":312,"column":3}},"type":"if","locations":[{"start":{"line":290,"column":2},"end":{"line":312,"column":3}},{"start":{"line":301,"column":9},"end":{"line":312,"column":3}}],"line":290},"34":{"loc":{"start":{"line":294,"column":8},"end":{"line":298,"column":9}},"type":"if","locations":[{"start":{"line":294,"column":8},"end":{"line":298,"column":9}},{"start":{"line":296,"column":15},"end":{"line":298,"column":9}}],"line":294},"35":{"loc":{"start":{"line":301,"column":9},"end":{"line":312,"column":3}},"type":"if","locations":[{"start":{"line":301,"column":9},"end":{"line":312,"column":3}},{"start":{},"end":{}}],"line":301},"36":{"loc":{"start":{"line":305,"column":8},"end":{"line":309,"column":9}},"type":"if","locations":[{"start":{"line":305,"column":8},"end":{"line":309,"column":9}},{"start":{"line":307,"column":15},"end":{"line":309,"column":9}}],"line":305}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":1,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},"b":{"0":[0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/utils/handle-range-mutation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICellData, IMutationInfo, IObjectMatrixPrimitiveType, IRange, Nullable } from '@univerjs/core';\nimport { Dimension, getArrayLength, IUniverInstanceService, ObjectMatrix, Tools } from '@univerjs/core';\n\nimport type {\n    IDeleteRangeMutationParams,\n    IInsertRangeMutationParams,\n} from '../../basics/interfaces/mutation-interface';\nimport { SheetInterceptorService } from '../../services/sheet-interceptor/sheet-interceptor.service';\nimport { getMoveRangeUndoRedoMutations } from '../commands/move-range.command';\nimport { SetRangeValuesCommand } from '../commands/set-range-values.command';\nimport {\n    type ISetRangeValuesMutationParams,\n    SetRangeValuesMutation,\n    SetRangeValuesUndoMutationFactory,\n} from '../mutations/set-range-values.mutation';\nimport { getSheetMutationTarget } from '../commands/utils/target-util';\nimport { generateNullCell } from '../../basics/utils';\n\n/**\n * Generate undo mutation of a `InsertRangeMutation`\n *\n * @param {IAccessor} accessor - injector accessor\n * @param {IInsertRangeMutationParams} params - do mutation params\n * @returns {IDeleteRangeMutationParams} undo mutation params\n */\nexport const InsertRangeUndoMutationFactory = (\n    accessor: IAccessor,\n    params: IInsertRangeMutationParams\n): IDeleteRangeMutationParams => ({\n    unitId: params.unitId,\n    subUnitId: params.subUnitId,\n    range: params.range,\n    shiftDimension: params.shiftDimension,\n});\n\n// export const InsertRangeMutation: IMutation<IInsertRangeMutationParams, boolean> = {\n//     id: 'sheet.mutation.insert-range',\n//     type: CommandType.MUTATION,\n//     handler: (accessor, params) => {\n//         const { unitId, subUnitId, range, cellValue, shiftDimension } = params;\n//         const univerInstanceService = accessor.get(IUniverInstanceService);\n//         const workbook = univerInstanceService.getUniverSheetInstance(unitId);\n//         if (!workbook) return false;\n//         const worksheet = workbook.getSheetBySheetId(subUnitId);\n//         if (!worksheet) return false;\n\n//         const cellMatrix = worksheet.getCellMatrix();\n//         const lastEndRow = worksheet.getLastRowWithContent();\n//         const lastEndColumn = worksheet.getLastColumnWithContent();\n\n//         handleInsertRangeMutation(cellMatrix, range, lastEndRow, lastEndColumn, shiftDimension, cellValue);\n\n//         return true;\n//     },\n// };\n\n/**\n * InsertRange is not a mutation but combination of `SetRangeValuesMutation` and `MoveRangeMutation`.\n * @param accessor\n * @param params\n * @returns\n */\n\nexport function getInsertRangeMutations(accessor: IAccessor, params: IInsertRangeMutationParams) {\n    const redo: IMutationInfo[] = [];\n    const undo: IMutationInfo[] = [];\n    const { unitId, subUnitId, range, shiftDimension, cellValue = {} } = params;\n    const instanceService = accessor.get(IUniverInstanceService);\n    const sheetInterceptorService = accessor.get(SheetInterceptorService);\n\n    const workbook = instanceService.getUniverSheetInstance(unitId);\n    const worksheet = workbook?.getSheetBySheetId(subUnitId);\n    if (worksheet) {\n        const cellMatrix = worksheet.getCellMatrix();\n        const dataRange = cellMatrix.getDataRange();\n\n        if (range.startColumn <= dataRange.endColumn || range.startRow <= dataRange.endRow) {\n            let moveFromRange: IRange;\n            let moveToRange: IRange;\n            if (shiftDimension === Dimension.COLUMNS) {\n                const endRow = Math.min(range.endRow, dataRange.endRow);\n                let endColumn = 0;\n                for (let row = range.startRow; row <= endRow; row++) {\n                    const rowData = cellMatrix.getRow(row);\n                    const rowLength = rowData ? getArrayLength(rowData) - 1 : 0;\n                    endColumn = Math.max(endColumn, rowLength);\n                }\n\n                moveFromRange = {\n                    startRow: range.startRow,\n                    startColumn: range.startColumn,\n                    endRow,\n                    endColumn,\n                };\n                const shift = range.endColumn - range.startColumn + 1;\n                moveToRange = {\n                    startRow: range.startRow,\n                    startColumn: moveFromRange.startColumn + shift,\n                    endRow,\n                    endColumn: moveFromRange.endColumn + shift,\n                };\n            } else {\n                const endColumn = Math.min(range.endColumn, dataRange.endColumn);\n                const endRow = dataRange.endRow;\n                moveFromRange = {\n                    startRow: range.startRow,\n                    startColumn: range.startColumn,\n                    endRow,\n                    endColumn,\n                };\n                const shift = range.endRow - range.startRow + 1;\n                moveToRange = {\n                    startRow: moveFromRange.startRow + shift,\n                    startColumn: range.startColumn,\n                    endRow: moveFromRange.endRow + shift,\n                    endColumn,\n                };\n            }\n\n            const moveRangeMutations = getMoveRangeUndoRedoMutations(\n                accessor,\n                { unitId, subUnitId, range: moveFromRange },\n                { unitId, subUnitId, range: moveToRange },\n                true\n            );\n            if (moveRangeMutations) {\n                redo.push(...moveRangeMutations.redos);\n                undo.push(...moveRangeMutations.undos);\n            }\n        }\n\n        if (Object.entries(cellValue).length === 0) {\n            for (let row = range.startRow; row <= range.endRow; row++) {\n                if (!cellValue[row]) {\n                    cellValue[row] = {};\n                }\n                for (let column = range.startColumn; column <= range.endColumn; column++) {\n                    cellValue[row][column] = null;\n                }\n            }\n        }\n\n        const setRangeValuesMutationParams: ISetRangeValuesMutationParams = {\n            subUnitId,\n            unitId,\n            cellValue,\n        };\n        const undoSetRangeValuesMutationParams: ISetRangeValuesMutationParams = SetRangeValuesUndoMutationFactory(\n            accessor,\n            setRangeValuesMutationParams\n        );\n        const { undos: interceptorUndos, redos: interceptorRedos } = sheetInterceptorService.onCommandExecute({\n            id: SetRangeValuesCommand.id,\n            params: { ...setRangeValuesMutationParams, range },\n        });\n\n        redo.push({ id: SetRangeValuesMutation.id, params: setRangeValuesMutationParams }, ...interceptorRedos);\n        undo.push({ id: SetRangeValuesMutation.id, params: undoSetRangeValuesMutationParams }, ...interceptorUndos);\n    }\n    return {\n        redo,\n        undo,\n    };\n}\n\n// eslint-disable-next-line max-lines-per-function\nexport function getRemoveRangeMutations(accessor: IAccessor, params: IDeleteRangeMutationParams) {\n    const redo: IMutationInfo[] = [];\n    const undo: IMutationInfo[] = [];\n    const { unitId, subUnitId, range, shiftDimension } = params;\n    const instanceService = accessor.get(IUniverInstanceService);\n    const sheetInterceptorService = accessor.get(SheetInterceptorService);\n\n    const workbook = instanceService.getUniverSheetInstance(unitId);\n    const worksheet = workbook?.getSheetBySheetId(subUnitId);\n    if (worksheet) {\n        const cellMatrix = worksheet.getCellMatrix();\n        const dataRange = cellMatrix.getDataRange();\n\n        const setRangeValuesMutationParams: ISetRangeValuesMutationParams = {\n            subUnitId,\n            unitId,\n            cellValue: generateNullCell([range]),\n        };\n        const undoSetRangeValuesMutationParams: ISetRangeValuesMutationParams = SetRangeValuesUndoMutationFactory(\n            accessor,\n            setRangeValuesMutationParams\n        );\n        const intercepted = sheetInterceptorService.onCommandExecute({\n            id: SetRangeValuesCommand.id,\n            params: setRangeValuesMutationParams,\n        });\n        redo.push({ id: SetRangeValuesMutation.id, params: setRangeValuesMutationParams }, ...intercepted.redos);\n        undo.push(...intercepted.undos, {\n            id: SetRangeValuesMutation.id,\n            params: undoSetRangeValuesMutationParams,\n        });\n\n        if (range.startColumn <= dataRange.endColumn || range.startRow <= dataRange.endRow) {\n            let moveFromRange: IRange | null = null;\n            let moveToRange: IRange | null = null;\n            if (shiftDimension === Dimension.COLUMNS && range.endColumn < dataRange.endColumn) {\n                const endRow = Math.min(range.endRow, dataRange.endRow);\n                let endColumn = 0;\n                for (let row = range.startRow; row <= endRow; row++) {\n                    const rowData = cellMatrix.getRow(row);\n                    const rowLength = rowData ? getArrayLength(rowData) - 1 : 0;\n                    endColumn = Math.max(endColumn, rowLength);\n                }\n\n                moveFromRange = {\n                    startRow: range.startRow,\n                    startColumn: range.endColumn + 1,\n                    endRow,\n                    endColumn,\n                };\n                const shift = range.endColumn - range.startColumn + 1;\n                moveToRange = {\n                    startRow: range.startRow,\n                    startColumn: moveFromRange.startColumn - shift,\n                    endRow,\n                    endColumn: moveFromRange.endColumn - shift,\n                };\n            }\n\n            if (shiftDimension === Dimension.ROWS && range.endRow < dataRange.endRow) {\n                const endColumn = Math.min(range.endColumn, dataRange.endColumn);\n                const endRow = dataRange.endRow;\n                moveFromRange = {\n                    startRow: range.endRow + 1,\n                    startColumn: range.startColumn,\n                    endRow,\n                    endColumn,\n                };\n                const shift = range.endRow - range.startRow + 1;\n                moveToRange = {\n                    startRow: moveFromRange.startRow - shift,\n                    startColumn: range.startColumn,\n                    endRow: moveFromRange.endRow - shift,\n                    endColumn,\n                };\n            }\n\n            if (moveFromRange && moveToRange) {\n                const moveRangeMutations = getMoveRangeUndoRedoMutations(\n                    accessor,\n                    { unitId, subUnitId, range: moveFromRange },\n                    { unitId, subUnitId, range: moveToRange },\n                    true\n                );\n                if (moveRangeMutations) {\n                    redo.push(...moveRangeMutations.redos);\n                    undo.push(...moveRangeMutations.undos);\n                }\n            }\n        }\n    }\n    return {\n        redo,\n        undo,\n    };\n}\n\nexport function handleInsertRangeMutation<T>(\n    cellMatrix: ObjectMatrix<T>,\n    range: IRange,\n    lastEndRow: number,\n    lastEndColumn: number,\n    shiftDimension: Dimension,\n    cellValue?: IObjectMatrixPrimitiveType<T>\n) {\n    const { startRow, endRow, startColumn, endColumn } = range;\n    if (shiftDimension === Dimension.ROWS) {\n        const rows = endRow - startRow + 1;\n        // build new data\n        for (let r = lastEndRow; r >= startRow; r--) {\n            for (let c = startColumn; c <= endColumn; c++) {\n                // get value blow current range\n\n                const value = cellMatrix.getValue(r, c);\n                if (value == null) {\n                    cellMatrix.realDeleteValue(r + rows, c);\n                } else {\n                    cellMatrix.setValue(r + rows, c, value);\n                }\n            }\n        }\n        // insert cell value from user\n        for (let r = endRow; r >= startRow; r--) {\n            for (let c = startColumn; c <= endColumn; c++) {\n                if (cellValue && cellValue[r] && cellValue[r][c]) {\n                    cellMatrix.setValue(r, c, cellValue[r][c]);\n                } else {\n                    cellMatrix.realDeleteValue(r, c);\n                }\n            }\n        }\n    } else if (shiftDimension === Dimension.COLUMNS) {\n        const columns = endColumn - startColumn + 1;\n        for (let r = startRow; r <= endRow; r++) {\n            for (let c = lastEndColumn; c >= startColumn; c--) {\n                // get value blow current range\n                const value = cellMatrix.getValue(r, c);\n\n                if (value == null) {\n                    cellMatrix.realDeleteValue(r, c + columns);\n                } else {\n                    cellMatrix.setValue(r, c + columns, value);\n                }\n            }\n        }\n        // insert cell value from user\n        for (let r = startRow; r <= endRow; r++) {\n            for (let c = endColumn; c >= startColumn; c--) {\n                if (cellValue && cellValue[r] && cellValue[r][c]) {\n                    cellMatrix.setValue(r, c, cellValue[r][c]);\n                } else {\n                    cellMatrix.realDeleteValue(r, c);\n                }\n            }\n        }\n    }\n}\n\n/**\n * Generate undo mutation of a `DeleteRangeMutation`\n *\n * @param {IAccessor} accessor - injector accessor\n * @param {IDeleteRangeMutationParams} params - do mutation params\n * @returns {IInsertRangeMutationParams} undo mutation params\n */\nexport const DeleteRangeUndoMutationFactory = (\n    accessor: IAccessor,\n    params: IDeleteRangeMutationParams\n): Nullable<IInsertRangeMutationParams> => {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const target = getSheetMutationTarget(univerInstanceService, params);\n    if (!target) return null;\n\n    const { worksheet } = target;\n    const cellMatrix = worksheet.getCellMatrix();\n    const undoData = new ObjectMatrix<ICellData>();\n    const lastEndRow = worksheet.getConfig().rowCount;\n    const lastEndColumn = worksheet.getConfig().columnCount;\n\n    const { startRow, endRow, startColumn, endColumn } = params.range;\n    if (params.shiftDimension === Dimension.ROWS) {\n        // build new data\n        for (let r = startRow; r <= lastEndRow; r++) {\n            for (let c = startColumn; c <= endColumn; c++) {\n                // store old value\n                if (r <= endRow) {\n                    const cell: Nullable<ICellData> = cellMatrix.getValue(r, c);\n                    undoData.setValue(r, c, cell as ICellData);\n                }\n            }\n        }\n    } else if (params.shiftDimension === Dimension.COLUMNS) {\n        // build new data\n        for (let r = startRow; r <= endRow; r++) {\n            for (let c = startColumn; c <= lastEndColumn; c++) {\n                // store old value\n                if (c <= endColumn) {\n                    const cell: Nullable<ICellData> = cellMatrix.getValue(r, c);\n                    undoData.setValue(r, c, cell as ICellData);\n                } else {\n                    for (let i = 0; i <= endColumn; i++) {\n                        const cell: Nullable<ICellData> = cellMatrix.getValue(r, c);\n                        undoData.setValue(r, c + i, cell as ICellData);\n                    }\n                }\n            }\n        }\n    }\n\n    return {\n        ...Tools.deepClone(params),\n        cellValue: undoData.getData(),\n    };\n};\n\nexport function handleDeleteRangeMutation<T>(\n    cellMatrix: ObjectMatrix<T>,\n    range: IRange,\n    lastEndRow: number,\n    lastEndColumn: number,\n    shiftDimension: Dimension\n) {\n    const { startRow, endRow, startColumn, endColumn } = range;\n\n    const rows = endRow - startRow + 1;\n    const columns = endColumn - startColumn + 1;\n\n    if (shiftDimension === Dimension.ROWS) {\n        // build new data\n        for (let r = startRow; r <= lastEndRow; r++) {\n            for (let c = startColumn; c <= endColumn; c++) {\n                // get value blow current range\n                const value = cellMatrix.getValue(r + rows, c);\n                if (value == null) {\n                    cellMatrix.realDeleteValue(r, c);\n                } else {\n                    cellMatrix.setValue(r, c, value);\n                }\n            }\n        }\n    } else if (shiftDimension === Dimension.COLUMNS) {\n        // build new data\n        for (let r = startRow; r <= endRow; r++) {\n            for (let c = startColumn; c <= lastEndColumn; c++) {\n                // get value blow current range\n\n                const value = cellMatrix.getValue(r, c + columns);\n                if (value == null) {\n                    cellMatrix.realDeleteValue(r, c);\n                } else {\n                    cellMatrix.setValue(r, c, value);\n                }\n            }\n        }\n    }\n}\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"bdc49a084386f2530f080acd9c749183e6ebce77"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/delete-range-move-left.command.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/delete-range-move-left.command.ts","statementMap":{"0":{"start":{"line":14,"column":44},"end":{"line":14,"column":82}},"1":{"start":{"line":15,"column":42},"end":{"line":64,"column":1}},"2":{"start":{"line":19,"column":27},"end":{"line":19,"column":56}},"3":{"start":{"line":20,"column":28},"end":{"line":20,"column":58}},"4":{"start":{"line":21,"column":34},"end":{"line":21,"column":70}},"5":{"start":{"line":22,"column":36},"end":{"line":22,"column":73}},"6":{"start":{"line":23,"column":36},"end":{"line":23,"column":73}},"7":{"start":{"line":24,"column":19},"end":{"line":24,"column":63}},"8":{"start":{"line":25,"column":4},"end":{"line":25,"column":30}},"9":{"start":{"line":25,"column":17},"end":{"line":25,"column":30}},"10":{"start":{"line":26,"column":55},"end":{"line":26,"column":61}},"11":{"start":{"line":27,"column":16},"end":{"line":27,"column":29}},"12":{"start":{"line":28,"column":4},"end":{"line":30,"column":5}},"13":{"start":{"line":29,"column":6},"end":{"line":29,"column":71}},"14":{"start":{"line":31,"column":4},"end":{"line":31,"column":29}},"15":{"start":{"line":31,"column":16},"end":{"line":31,"column":29}},"16":{"start":{"line":32,"column":38},"end":{"line":37,"column":5}},"17":{"start":{"line":38,"column":29},"end":{"line":41,"column":6}},"18":{"start":{"line":42,"column":61},"end":{"line":45,"column":5}},"19":{"start":{"line":46,"column":18},"end":{"line":46,"column":74}},"20":{"start":{"line":47,"column":18},"end":{"line":47,"column":65}},"21":{"start":{"line":48,"column":4},"end":{"line":48,"column":42}},"22":{"start":{"line":49,"column":4},"end":{"line":49,"column":69}},"23":{"start":{"line":50,"column":4},"end":{"line":50,"column":51}},"24":{"start":{"line":51,"column":19},"end":{"line":51,"column":64}},"25":{"start":{"line":52,"column":4},"end":{"line":59,"column":5}},"26":{"start":{"line":53,"column":6},"end":{"line":57,"column":9}},"27":{"start":{"line":58,"column":6},"end":{"line":58,"column":18}},"28":{"start":{"line":60,"column":4},"end":{"line":60,"column":17}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":18,"column":11},"end":{"line":18,"column":12}},"loc":{"start":{"line":18,"column":39},"end":{"line":61,"column":3}},"line":18}},"branchMap":{"0":{"loc":{"start":{"line":25,"column":4},"end":{"line":25,"column":30}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":30}},{"start":{},"end":{}}],"line":25},"1":{"loc":{"start":{"line":28,"column":4},"end":{"line":30,"column":5}},"type":"if","locations":[{"start":{"line":28,"column":4},"end":{"line":30,"column":5}},{"start":{},"end":{}}],"line":28},"2":{"loc":{"start":{"line":31,"column":4},"end":{"line":31,"column":29}},"type":"if","locations":[{"start":{"line":31,"column":4},"end":{"line":31,"column":29}},{"start":{},"end":{}}],"line":31},"3":{"loc":{"start":{"line":46,"column":22},"end":{"line":46,"column":53}},"type":"binary-expr","locations":[{"start":{"line":46,"column":22},"end":{"line":46,"column":47}},{"start":{"line":46,"column":51},"end":{"line":46,"column":53}}],"line":46},"4":{"loc":{"start":{"line":50,"column":18},"end":{"line":50,"column":49}},"type":"binary-expr","locations":[{"start":{"line":50,"column":18},"end":{"line":50,"column":43}},{"start":{"line":50,"column":47},"end":{"line":50,"column":49}}],"line":50},"5":{"loc":{"start":{"line":52,"column":4},"end":{"line":59,"column":5}},"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":59,"column":5}},{"start":{},"end":{}}],"line":52}},"s":{"0":1,"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0},"f":{"0":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/delete-range-move-left.command.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand, IMutationInfo, IRange } from '@univerjs/core';\nimport type { IDeleteRangeMutationParams } from '../../basics/interfaces/mutation-interface';\n\nimport {\n    CommandType,\n    Dimension,\n    ICommandService,\n    IUndoRedoService,\n    IUniverInstanceService,\n    sequenceExecute,\n} from '@univerjs/core';\nimport { SheetsSelectionsService } from '../../services/selections/selection.service';\nimport { SheetInterceptorService } from '../../services/sheet-interceptor/sheet-interceptor.service';\nimport { getRemoveRangeMutations } from '../utils/handle-range-mutation';\nimport { followSelectionOperation } from './utils/selection-utils';\nimport { getSheetCommandTarget } from './utils/target-util';\n\nexport interface IDeleteRangeMoveLeftCommandParams {\n    range: IRange;\n}\n\nexport const DeleteRangeMoveLeftCommandId = 'sheet.command.delete-range-move-left';\n/**\n * The command to delete range.\n */\nexport const DeleteRangeMoveLeftCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: DeleteRangeMoveLeftCommandId,\n\n    handler: async (accessor: IAccessor, params?: IDeleteRangeMoveLeftCommandParams) => {\n        const commandService = accessor.get(ICommandService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet, workbook, subUnitId, unitId } = target;\n\n        let range = params?.range;\n        if (!range) {\n            range = selectionManagerService.getCurrentLastSelection()?.range;\n        }\n\n        if (!range) return false;\n        const deleteRangeMutationParams: IDeleteRangeMutationParams = {\n            range,\n            subUnitId,\n            unitId,\n            shiftDimension: Dimension.COLUMNS,\n        };\n\n        const sheetInterceptor = sheetInterceptorService.onCommandExecute({\n            id: DeleteRangeMoveLeftCommand.id,\n            params: { range } as IDeleteRangeMoveLeftCommandParams,\n        });\n        const { redo: removeRangeRedo, undo: removeRangeUndo } = getRemoveRangeMutations(\n            accessor,\n            deleteRangeMutationParams\n        );\n        const redos: IMutationInfo[] = [...(sheetInterceptor.preRedos ?? []), ...removeRangeRedo];\n        const undos: IMutationInfo[] = [...sheetInterceptor.undos, ...removeRangeUndo];\n        redos.push(...sheetInterceptor.redos);\n        redos.push(followSelectionOperation(range, workbook, worksheet));\n        undos.push(...(sheetInterceptor.preUndos ?? []));\n        // execute do mutations and add undo mutations to undo stack if completed\n        const result = sequenceExecute(redos, commandService).result;\n\n        if (result) {\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: undos.reverse(),\n                redoMutations: redos,\n            });\n\n            return true;\n        }\n\n        return false;\n    },\n    // all subsequent mutations should succeed inorder to make the whole process succeed\n    // Promise.all([]).then(() => true),\n};\n"],"mappings":"AAmBA;AAAA,EACI;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,OACG;AACP,SAAS,+BAA+B;AACxC,SAAS,+BAA+B;AACxC,SAAS,+BAA+B;AACxC,SAAS,gCAAgC;AACzC,SAAS,6BAA6B;AAM/B,aAAM,+BAA+B;AAIrC,aAAM,6BAAuC;AAAA,EAChD,MAAM,YAAY;AAAA,EAClB,IAAI;AAAA,EAEJ,SAAS,OAAO,UAAqB,WAA+C;AAChF,UAAM,iBAAiB,SAAS,IAAI,eAAe;AACnD,UAAM,kBAAkB,SAAS,IAAI,gBAAgB;AACrD,UAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,UAAM,0BAA0B,SAAS,IAAI,uBAAuB;AACpE,UAAM,0BAA0B,SAAS,IAAI,uBAAuB;AAEpE,UAAM,SAAS,sBAAsB,qBAAqB;AAC1D,QAAI,CAAC,OAAQ,QAAO;AAEpB,UAAM,EAAE,WAAW,UAAU,WAAW,OAAO,IAAI;AAEnD,QAAI,QAAQ,QAAQ;AACpB,QAAI,CAAC,OAAO;AACR,cAAQ,wBAAwB,wBAAwB,GAAG;AAAA,IAC/D;AAEA,QAAI,CAAC,MAAO,QAAO;AACnB,UAAM,4BAAwD;AAAA,MAC1D;AAAA,MACA;AAAA,MACA;AAAA,MACA,gBAAgB,UAAU;AAAA,IAC9B;AAEA,UAAM,mBAAmB,wBAAwB,iBAAiB;AAAA,MAC9D,IAAI,2BAA2B;AAAA,MAC/B,QAAQ,EAAE,MAAM;AAAA,IACpB,CAAC;AACD,UAAM,EAAE,MAAM,iBAAiB,MAAM,gBAAgB,IAAI;AAAA,MACrD;AAAA,MACA;AAAA,IACJ;AACA,UAAM,QAAyB,CAAC,GAAI,iBAAiB,YAAY,CAAC,GAAI,GAAG,eAAe;AACxF,UAAM,QAAyB,CAAC,GAAG,iBAAiB,OAAO,GAAG,eAAe;AAC7E,UAAM,KAAK,GAAG,iBAAiB,KAAK;AACpC,UAAM,KAAK,yBAAyB,OAAO,UAAU,SAAS,CAAC;AAC/D,UAAM,KAAK,GAAI,iBAAiB,YAAY,CAAC,CAAE;AAE/C,UAAM,SAAS,gBAAgB,OAAO,cAAc,EAAE;AAEtD,QAAI,QAAQ;AACR,sBAAgB,aAAa;AAAA,QACzB,QAAQ;AAAA,QACR,eAAe,MAAM,QAAQ;AAAA,QAC7B,eAAe;AAAA,MACnB,CAAC;AAED,aAAO;AAAA,IACX;AAEA,WAAO;AAAA,EACX;AAAA;AAAA;AAGJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7ec8146764161d4882b89a2fa8c5b505d1635a60"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/delete-range-move-up.command.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/delete-range-move-up.command.ts","statementMap":{"0":{"start":{"line":14,"column":42},"end":{"line":14,"column":78}},"1":{"start":{"line":15,"column":40},"end":{"line":64,"column":1}},"2":{"start":{"line":19,"column":27},"end":{"line":19,"column":56}},"3":{"start":{"line":20,"column":28},"end":{"line":20,"column":58}},"4":{"start":{"line":21,"column":34},"end":{"line":21,"column":70}},"5":{"start":{"line":22,"column":36},"end":{"line":22,"column":73}},"6":{"start":{"line":23,"column":36},"end":{"line":23,"column":73}},"7":{"start":{"line":24,"column":19},"end":{"line":24,"column":63}},"8":{"start":{"line":25,"column":4},"end":{"line":25,"column":30}},"9":{"start":{"line":25,"column":17},"end":{"line":25,"column":30}},"10":{"start":{"line":26,"column":55},"end":{"line":26,"column":61}},"11":{"start":{"line":27,"column":16},"end":{"line":27,"column":29}},"12":{"start":{"line":28,"column":4},"end":{"line":30,"column":5}},"13":{"start":{"line":29,"column":6},"end":{"line":29,"column":71}},"14":{"start":{"line":31,"column":4},"end":{"line":31,"column":29}},"15":{"start":{"line":31,"column":16},"end":{"line":31,"column":29}},"16":{"start":{"line":32,"column":38},"end":{"line":37,"column":5}},"17":{"start":{"line":38,"column":29},"end":{"line":41,"column":6}},"18":{"start":{"line":42,"column":61},"end":{"line":45,"column":5}},"19":{"start":{"line":46,"column":18},"end":{"line":46,"column":74}},"20":{"start":{"line":47,"column":18},"end":{"line":47,"column":65}},"21":{"start":{"line":48,"column":4},"end":{"line":48,"column":42}},"22":{"start":{"line":49,"column":4},"end":{"line":49,"column":69}},"23":{"start":{"line":50,"column":4},"end":{"line":50,"column":51}},"24":{"start":{"line":51,"column":19},"end":{"line":51,"column":64}},"25":{"start":{"line":52,"column":4},"end":{"line":59,"column":5}},"26":{"start":{"line":53,"column":6},"end":{"line":57,"column":9}},"27":{"start":{"line":58,"column":6},"end":{"line":58,"column":18}},"28":{"start":{"line":60,"column":4},"end":{"line":60,"column":17}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":18,"column":11},"end":{"line":18,"column":12}},"loc":{"start":{"line":18,"column":39},"end":{"line":61,"column":3}},"line":18}},"branchMap":{"0":{"loc":{"start":{"line":25,"column":4},"end":{"line":25,"column":30}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":30}},{"start":{},"end":{}}],"line":25},"1":{"loc":{"start":{"line":28,"column":4},"end":{"line":30,"column":5}},"type":"if","locations":[{"start":{"line":28,"column":4},"end":{"line":30,"column":5}},{"start":{},"end":{}}],"line":28},"2":{"loc":{"start":{"line":31,"column":4},"end":{"line":31,"column":29}},"type":"if","locations":[{"start":{"line":31,"column":4},"end":{"line":31,"column":29}},{"start":{},"end":{}}],"line":31},"3":{"loc":{"start":{"line":46,"column":22},"end":{"line":46,"column":53}},"type":"binary-expr","locations":[{"start":{"line":46,"column":22},"end":{"line":46,"column":47}},{"start":{"line":46,"column":51},"end":{"line":46,"column":53}}],"line":46},"4":{"loc":{"start":{"line":50,"column":18},"end":{"line":50,"column":49}},"type":"binary-expr","locations":[{"start":{"line":50,"column":18},"end":{"line":50,"column":43}},{"start":{"line":50,"column":47},"end":{"line":50,"column":49}}],"line":50},"5":{"loc":{"start":{"line":52,"column":4},"end":{"line":59,"column":5}},"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":59,"column":5}},{"start":{},"end":{}}],"line":52}},"s":{"0":1,"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0},"f":{"0":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/delete-range-move-up.command.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand, IMutationInfo, IRange } from '@univerjs/core';\nimport type { IDeleteRangeMutationParams } from '../../basics/interfaces/mutation-interface';\n\nimport {\n    CommandType,\n    Dimension,\n    ICommandService,\n    IUndoRedoService,\n    IUniverInstanceService,\n    sequenceExecute,\n} from '@univerjs/core';\nimport { SheetsSelectionsService } from '../../services/selections/selection.service';\nimport { SheetInterceptorService } from '../../services/sheet-interceptor/sheet-interceptor.service';\nimport { getRemoveRangeMutations } from '../utils/handle-range-mutation';\nimport { followSelectionOperation } from './utils/selection-utils';\nimport { getSheetCommandTarget } from './utils/target-util';\n\nexport interface IDeleteRangeMoveUpCommandParams {\n    range: IRange;\n}\n\nexport const DeleteRangeMoveUpCommandId = 'sheet.command.delete-range-move-up';\n/**\n * The command to delete range.\n */\nexport const DeleteRangeMoveUpCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: DeleteRangeMoveUpCommandId,\n\n    handler: async (accessor: IAccessor, params: IDeleteRangeMoveUpCommandParams) => {\n        const commandService = accessor.get(ICommandService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { unitId, subUnitId, workbook, worksheet } = target;\n        let range = params?.range;\n        if (!range) {\n            range = selectionManagerService.getCurrentLastSelection()?.range!;\n        }\n        if (!range) return false;\n\n        const deleteRangeMutationParams: IDeleteRangeMutationParams = {\n            range,\n            subUnitId,\n            unitId,\n            shiftDimension: Dimension.ROWS,\n        };\n\n        const sheetInterceptor = sheetInterceptorService.onCommandExecute({\n            id: DeleteRangeMoveUpCommand.id,\n            params: { range } as IDeleteRangeMoveUpCommandParams,\n        });\n\n        const { redo: removeRangeRedo, undo: removeRangeUndo } = getRemoveRangeMutations(\n            accessor,\n            deleteRangeMutationParams\n        );\n        const redos: IMutationInfo[] = [...(sheetInterceptor.preRedos ?? []), ...removeRangeRedo];\n        const undos: IMutationInfo[] = [...sheetInterceptor.undos, ...removeRangeUndo];\n        redos.push(...sheetInterceptor.redos);\n        redos.push(followSelectionOperation(range, workbook, worksheet));\n        undos.push(...(sheetInterceptor.preUndos ?? []));\n        const result = sequenceExecute(redos, commandService).result;\n\n        if (result) {\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: undos.reverse(),\n                redoMutations: redos,\n            });\n\n            return true;\n        }\n\n        return false;\n    },\n    // all subsequent mutations should succeed inorder to make the whole process succeed\n    // Promise.all([]).then(() => true),\n};\n"],"mappings":"AAmBA;AAAA,EACI;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,OACG;AACP,SAAS,+BAA+B;AACxC,SAAS,+BAA+B;AACxC,SAAS,+BAA+B;AACxC,SAAS,gCAAgC;AACzC,SAAS,6BAA6B;AAM/B,aAAM,6BAA6B;AAInC,aAAM,2BAAqC;AAAA,EAC9C,MAAM,YAAY;AAAA,EAClB,IAAI;AAAA,EAEJ,SAAS,OAAO,UAAqB,WAA4C;AAC7E,UAAM,iBAAiB,SAAS,IAAI,eAAe;AACnD,UAAM,kBAAkB,SAAS,IAAI,gBAAgB;AACrD,UAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,UAAM,0BAA0B,SAAS,IAAI,uBAAuB;AACpE,UAAM,0BAA0B,SAAS,IAAI,uBAAuB;AAEpE,UAAM,SAAS,sBAAsB,qBAAqB;AAC1D,QAAI,CAAC,OAAQ,QAAO;AAEpB,UAAM,EAAE,QAAQ,WAAW,UAAU,UAAU,IAAI;AACnD,QAAI,QAAQ,QAAQ;AACpB,QAAI,CAAC,OAAO;AACR,cAAQ,wBAAwB,wBAAwB,GAAG;AAAA,IAC/D;AACA,QAAI,CAAC,MAAO,QAAO;AAEnB,UAAM,4BAAwD;AAAA,MAC1D;AAAA,MACA;AAAA,MACA;AAAA,MACA,gBAAgB,UAAU;AAAA,IAC9B;AAEA,UAAM,mBAAmB,wBAAwB,iBAAiB;AAAA,MAC9D,IAAI,yBAAyB;AAAA,MAC7B,QAAQ,EAAE,MAAM;AAAA,IACpB,CAAC;AAED,UAAM,EAAE,MAAM,iBAAiB,MAAM,gBAAgB,IAAI;AAAA,MACrD;AAAA,MACA;AAAA,IACJ;AACA,UAAM,QAAyB,CAAC,GAAI,iBAAiB,YAAY,CAAC,GAAI,GAAG,eAAe;AACxF,UAAM,QAAyB,CAAC,GAAG,iBAAiB,OAAO,GAAG,eAAe;AAC7E,UAAM,KAAK,GAAG,iBAAiB,KAAK;AACpC,UAAM,KAAK,yBAAyB,OAAO,UAAU,SAAS,CAAC;AAC/D,UAAM,KAAK,GAAI,iBAAiB,YAAY,CAAC,CAAE;AAC/C,UAAM,SAAS,gBAAgB,OAAO,cAAc,EAAE;AAEtD,QAAI,QAAQ;AACR,sBAAgB,aAAa;AAAA,QACzB,QAAQ;AAAA,QACR,eAAe,MAAM,QAAQ;AAAA,QAC7B,eAAe;AAAA,MACnB,CAAC;AAED,aAAO;AAAA,IACX;AAEA,WAAO;AAAA,EACX;AAAA;AAAA;AAGJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"89b6569d0840d740467a9462986ac7dad39235e0"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/insert-row-col.mutation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/insert-row-col.mutation.ts","statementMap":{"0":{"start":{"line":2,"column":44},"end":{"line":13,"column":1}},"1":{"start":{"line":3,"column":32},"end":{"line":3,"column":68}},"2":{"start":{"line":4,"column":22},"end":{"line":4,"column":81}},"3":{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},"4":{"start":{"line":6,"column":4},"end":{"line":6,"column":50}},"5":{"start":{"line":8,"column":2},"end":{"line":12,"column":4}},"6":{"start":{"line":14,"column":33},"end":{"line":47,"column":1}},"7":{"start":{"line":18,"column":50},"end":{"line":18,"column":56}},"8":{"start":{"line":19,"column":34},"end":{"line":19,"column":70}},"9":{"start":{"line":20,"column":24},"end":{"line":20,"column":76}},"10":{"start":{"line":21,"column":4},"end":{"line":23,"column":5}},"11":{"start":{"line":22,"column":6},"end":{"line":22,"column":52}},"12":{"start":{"line":24,"column":22},"end":{"line":24,"column":62}},"13":{"start":{"line":25,"column":4},"end":{"line":27,"column":5}},"14":{"start":{"line":26,"column":6},"end":{"line":26,"column":50}},"15":{"start":{"line":28,"column":23},"end":{"line":28,"column":61}},"16":{"start":{"line":29,"column":27},"end":{"line":32,"column":5}},"17":{"start":{"line":33,"column":21},"end":{"line":33,"column":35}},"18":{"start":{"line":34,"column":21},"end":{"line":34,"column":54}},"19":{"start":{"line":35,"column":4},"end":{"line":41,"column":5}},"20":{"start":{"line":35,"column":17},"end":{"line":35,"column":25}},"21":{"start":{"line":36,"column":6},"end":{"line":40,"column":7}},"22":{"start":{"line":37,"column":8},"end":{"line":37,"column":88}},"23":{"start":{"line":39,"column":8},"end":{"line":39,"column":57}},"24":{"start":{"line":42,"column":4},"end":{"line":42,"column":87}},"25":{"start":{"line":43,"column":23},"end":{"line":43,"column":48}},"26":{"start":{"line":44,"column":4},"end":{"line":44,"column":52}},"27":{"start":{"line":45,"column":4},"end":{"line":45,"column":16}},"28":{"start":{"line":48,"column":44},"end":{"line":59,"column":1}},"29":{"start":{"line":49,"column":32},"end":{"line":49,"column":68}},"30":{"start":{"line":50,"column":22},"end":{"line":50,"column":81}},"31":{"start":{"line":51,"column":2},"end":{"line":53,"column":3}},"32":{"start":{"line":52,"column":4},"end":{"line":52,"column":50}},"33":{"start":{"line":54,"column":2},"end":{"line":58,"column":4}},"34":{"start":{"line":60,"column":33},"end":{"line":94,"column":1}},"35":{"start":{"line":64,"column":34},"end":{"line":64,"column":70}},"36":{"start":{"line":65,"column":24},"end":{"line":65,"column":83}},"37":{"start":{"line":66,"column":4},"end":{"line":68,"column":5}},"38":{"start":{"line":67,"column":6},"end":{"line":67,"column":52}},"39":{"start":{"line":69,"column":22},"end":{"line":69,"column":69}},"40":{"start":{"line":70,"column":4},"end":{"line":70,"column":33}},"41":{"start":{"line":70,"column":20},"end":{"line":70,"column":33}},"42":{"start":{"line":71,"column":20},"end":{"line":71,"column":48}},"43":{"start":{"line":72,"column":31},"end":{"line":72,"column":37}},"44":{"start":{"line":73,"column":28},"end":{"line":73,"column":51}},"45":{"start":{"line":74,"column":26},"end":{"line":74,"column":41}},"46":{"start":{"line":75,"column":21},"end":{"line":75,"column":38}},"47":{"start":{"line":76,"column":21},"end":{"line":76,"column":60}},"48":{"start":{"line":77,"column":28},"end":{"line":77,"column":68}},"49":{"start":{"line":78,"column":4},"end":{"line":88,"column":5}},"50":{"start":{"line":78,"column":17},"end":{"line":78,"column":25}},"51":{"start":{"line":79,"column":29},"end":{"line":82,"column":7}},"52":{"start":{"line":83,"column":6},"end":{"line":87,"column":7}},"53":{"start":{"line":84,"column":8},"end":{"line":84,"column":94}},"54":{"start":{"line":86,"column":8},"end":{"line":86,"column":60}},"55":{"start":{"line":89,"column":4},"end":{"line":89,"column":99}},"56":{"start":{"line":90,"column":23},"end":{"line":90,"column":48}},"57":{"start":{"line":91,"column":4},"end":{"line":91,"column":58}},"58":{"start":{"line":92,"column":4},"end":{"line":92,"column":16}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":66},"end":{"line":13,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":17,"column":11},"end":{"line":17,"column":12}},"loc":{"start":{"line":17,"column":33},"end":{"line":46,"column":3}},"line":17},"2":{"name":"(anonymous_2)","decl":{"start":{"line":48,"column":44},"end":{"line":48,"column":45}},"loc":{"start":{"line":48,"column":66},"end":{"line":59,"column":1}},"line":48},"3":{"name":"(anonymous_3)","decl":{"start":{"line":63,"column":11},"end":{"line":63,"column":12}},"loc":{"start":{"line":63,"column":33},"end":{"line":93,"column":3}},"line":63}},"branchMap":{"0":{"loc":{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},"type":"if","locations":[{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},{"start":{},"end":{}}],"line":5},"1":{"loc":{"start":{"line":21,"column":4},"end":{"line":23,"column":5}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":23,"column":5}},{"start":{},"end":{}}],"line":21},"2":{"loc":{"start":{"line":25,"column":4},"end":{"line":27,"column":5}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":27,"column":5}},{"start":{},"end":{}}],"line":25},"3":{"loc":{"start":{"line":36,"column":6},"end":{"line":40,"column":7}},"type":"if","locations":[{"start":{"line":36,"column":6},"end":{"line":40,"column":7}},{"start":{"line":38,"column":13},"end":{"line":40,"column":7}}],"line":36},"4":{"loc":{"start":{"line":37,"column":29},"end":{"line":37,"column":74}},"type":"binary-expr","locations":[{"start":{"line":37,"column":29},"end":{"line":37,"column":56}},{"start":{"line":37,"column":60},"end":{"line":37,"column":74}}],"line":37},"5":{"loc":{"start":{"line":51,"column":2},"end":{"line":53,"column":3}},"type":"if","locations":[{"start":{"line":51,"column":2},"end":{"line":53,"column":3}},{"start":{},"end":{}}],"line":51},"6":{"loc":{"start":{"line":66,"column":4},"end":{"line":68,"column":5}},"type":"if","locations":[{"start":{"line":66,"column":4},"end":{"line":68,"column":5}},{"start":{},"end":{}}],"line":66},"7":{"loc":{"start":{"line":70,"column":4},"end":{"line":70,"column":33}},"type":"if","locations":[{"start":{"line":70,"column":4},"end":{"line":70,"column":33}},{"start":{},"end":{}}],"line":70},"8":{"loc":{"start":{"line":83,"column":6},"end":{"line":87,"column":7}},"type":"if","locations":[{"start":{"line":83,"column":6},"end":{"line":87,"column":7}},{"start":{"line":85,"column":13},"end":{"line":87,"column":7}}],"line":83},"9":{"loc":{"start":{"line":84,"column":29},"end":{"line":84,"column":77}},"type":"binary-expr","locations":[{"start":{"line":84,"column":29},"end":{"line":84,"column":59}},{"start":{"line":84,"column":63},"end":{"line":84,"column":77}}],"line":84}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":1,"13":1,"14":0,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":0,"24":1,"25":1,"26":1,"27":1,"28":1,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":1,"36":1,"37":1,"38":0,"39":1,"40":1,"41":0,"42":1,"43":1,"44":1,"45":1,"46":1,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":0,"55":1,"56":1,"57":1,"58":1},"f":{"0":0,"1":1,"2":0,"3":1},"b":{"0":[0,0],"1":[0,1],"2":[0,1],"3":[1,0],"4":[1,1],"5":[0,0],"6":[0,1],"7":[0,1],"8":[1,0],"9":[1,1]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/insert-row-col.mutation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, IMutation } from '@univerjs/core';\nimport { CommandType, insertMatrixArray, IUniverInstanceService } from '@univerjs/core';\n\nimport type {\n    IInsertColMutationParams,\n    IInsertRowMutationParams,\n    IRemoveColMutationParams,\n    IRemoveRowsMutationParams,\n} from '../../basics/interfaces/mutation-interface';\n\nexport const InsertRowMutationUndoFactory = (\n    accessor: IAccessor,\n    params: IInsertRowMutationParams\n): IRemoveRowsMutationParams => {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n    if (universheet == null) {\n        throw new Error('universheet is null error!');\n    }\n\n    return {\n        unitId: params.unitId,\n        subUnitId: params.subUnitId,\n        range: params.range,\n    };\n};\n\nexport const InsertRowMutation: IMutation<IInsertRowMutationParams> = {\n    id: 'sheet.mutation.insert-row',\n    type: CommandType.MUTATION,\n    handler: (accessor, params) => {\n        const { unitId, subUnitId, range, rowInfo } = params;\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const universheet = univerInstanceService.getUniverSheetInstance(unitId);\n        if (universheet == null) {\n            throw new Error('universheet is null error!');\n        }\n\n        const worksheet = universheet.getSheetBySheetId(subUnitId);\n        if (worksheet == null) {\n            throw new Error('worksheet is null error!');\n        }\n\n        // TODO@wzhudev: should not expose row data and let outside modules to modify it directly\n        // the correct way to do this is to provide a method from RowManager to modify row data\n        const rowWrapper = worksheet.getRowManager().getRowData();\n        const defaultRowInfo = {\n            h: worksheet.getConfig().defaultRowHeight,\n            hd: 0,\n        };\n\n        const rowIndex = range.startRow;\n        const rowCount = range.endRow - range.startRow + 1;\n\n        for (let j = rowIndex; j < rowIndex + rowCount; j++) {\n            if (rowInfo) {\n                insertMatrixArray(j, rowInfo[j - range.startRow] ?? defaultRowInfo, rowWrapper);\n            } else {\n                insertMatrixArray(j, defaultRowInfo, rowWrapper);\n            }\n        }\n\n        worksheet.setRowCount(worksheet.getRowCount() + range.endRow - range.startRow + 1);\n\n        // remove cells contents by directly mutating worksheetCellMatrix\n        const cellMatrix = worksheet.getCellMatrix();\n        cellMatrix.insertRows(range.startRow, rowCount);\n\n        return true;\n    },\n};\n\nexport const InsertColMutationUndoFactory = (\n    accessor: IAccessor,\n    params: IInsertColMutationParams\n): IRemoveColMutationParams => {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n    if (universheet == null) {\n        throw new Error('universheet is null error!');\n    }\n\n    return {\n        unitId: params.unitId,\n        subUnitId: params.subUnitId,\n        range: params.range,\n    };\n};\n\nexport const InsertColMutation: IMutation<IInsertColMutationParams> = {\n    id: 'sheet.mutation.insert-col',\n    type: CommandType.MUTATION,\n    handler: (accessor, params) => {\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n        if (universheet == null) {\n            throw new Error('universheet is null error!');\n        }\n\n        const worksheet = universheet.getSheetBySheetId(params.subUnitId);\n        if (!worksheet) return false;\n        const manager = worksheet.getColumnManager();\n        const { range, colInfo } = params;\n        const columnPrimitive = manager.getColumnData();\n        const columnWrapper = columnPrimitive;\n\n        const colIndex = range.startColumn;\n        const colCount = range.endColumn - range.startColumn + 1;\n        const defaultColWidth = worksheet.getConfig().defaultColumnWidth;\n        for (let j = colIndex; j < colIndex + colCount; j++) {\n            const defaultColInfo = {\n                w: defaultColWidth,\n                hd: 0,\n            };\n            if (colInfo) {\n                insertMatrixArray(j, colInfo[j - range.startColumn] ?? defaultColInfo, columnWrapper);\n            } else {\n                insertMatrixArray(j, defaultColInfo, columnWrapper);\n            }\n        }\n\n        worksheet.setColumnCount(worksheet.getColumnCount() + range.endColumn - range.startColumn + 1);\n\n        // remove cells contents by directly mutating worksheetCellMatrix\n        const cellMatrix = worksheet.getCellMatrix();\n        cellMatrix.insertColumns(range.startColumn, colCount);\n\n        return true;\n    },\n};\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"136f17d3503c2524f8af9379339362834d480879"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/remove-row-col.mutation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/remove-row-col.mutation.ts","statementMap":{"0":{"start":{"line":2,"column":45},"end":{"line":16,"column":1}},"1":{"start":{"line":3,"column":18},"end":{"line":3,"column":43}},"2":{"start":{"line":4,"column":23},"end":{"line":4,"column":43}},"3":{"start":{"line":5,"column":21},"end":{"line":5,"column":33}},"4":{"start":{"line":6,"column":18},"end":{"line":6,"column":20}},"5":{"start":{"line":7,"column":16},"end":{"line":7,"column":28}},"6":{"start":{"line":8,"column":16},"end":{"line":8,"column":74}},"7":{"start":{"line":9,"column":19},"end":{"line":9,"column":52}},"8":{"start":{"line":10,"column":2},"end":{"line":15,"column":4}},"9":{"start":{"line":17,"column":33},"end":{"line":44,"column":1}},"10":{"start":{"line":21,"column":34},"end":{"line":21,"column":70}},"11":{"start":{"line":22,"column":24},"end":{"line":22,"column":83}},"12":{"start":{"line":23,"column":4},"end":{"line":25,"column":5}},"13":{"start":{"line":24,"column":6},"end":{"line":24,"column":52}},"14":{"start":{"line":26,"column":22},"end":{"line":26,"column":69}},"15":{"start":{"line":27,"column":4},"end":{"line":27,"column":33}},"16":{"start":{"line":27,"column":20},"end":{"line":27,"column":33}},"17":{"start":{"line":28,"column":18},"end":{"line":28,"column":30}},"18":{"start":{"line":29,"column":20},"end":{"line":29,"column":45}},"19":{"start":{"line":30,"column":25},"end":{"line":30,"column":45}},"20":{"start":{"line":31,"column":26},"end":{"line":31,"column":28}},"21":{"start":{"line":32,"column":4},"end":{"line":36,"column":5}},"22":{"start":{"line":32,"column":17},"end":{"line":32,"column":31}},"23":{"start":{"line":33,"column":6},"end":{"line":35,"column":7}},"24":{"start":{"line":34,"column":8},"end":{"line":34,"column":30}},"25":{"start":{"line":37,"column":21},"end":{"line":37,"column":54}},"26":{"start":{"line":38,"column":4},"end":{"line":38,"column":56}},"27":{"start":{"line":39,"column":23},"end":{"line":39,"column":48}},"28":{"start":{"line":40,"column":4},"end":{"line":40,"column":52}},"29":{"start":{"line":41,"column":4},"end":{"line":41,"column":62}},"30":{"start":{"line":42,"column":4},"end":{"line":42,"column":16}},"31":{"start":{"line":45,"column":40},"end":{"line":68,"column":1}},"32":{"start":{"line":46,"column":32},"end":{"line":46,"column":68}},"33":{"start":{"line":47,"column":22},"end":{"line":47,"column":81}},"34":{"start":{"line":48,"column":2},"end":{"line":50,"column":3}},"35":{"start":{"line":49,"column":4},"end":{"line":49,"column":50}},"36":{"start":{"line":51,"column":20},"end":{"line":51,"column":67}},"37":{"start":{"line":52,"column":2},"end":{"line":54,"column":3}},"38":{"start":{"line":53,"column":4},"end":{"line":53,"column":48}},"39":{"start":{"line":55,"column":18},"end":{"line":55,"column":46}},"40":{"start":{"line":56,"column":26},"end":{"line":56,"column":49}},"41":{"start":{"line":57,"column":24},"end":{"line":57,"column":39}},"42":{"start":{"line":58,"column":18},"end":{"line":58,"column":20}},"43":{"start":{"line":59,"column":16},"end":{"line":59,"column":28}},"44":{"start":{"line":60,"column":16},"end":{"line":60,"column":83}},"45":{"start":{"line":61,"column":19},"end":{"line":61,"column":52}},"46":{"start":{"line":62,"column":2},"end":{"line":67,"column":4}},"47":{"start":{"line":69,"column":33},"end":{"line":90,"column":1}},"48":{"start":{"line":73,"column":34},"end":{"line":73,"column":70}},"49":{"start":{"line":74,"column":24},"end":{"line":74,"column":83}},"50":{"start":{"line":75,"column":4},"end":{"line":77,"column":5}},"51":{"start":{"line":76,"column":6},"end":{"line":76,"column":52}},"52":{"start":{"line":78,"column":22},"end":{"line":78,"column":69}},"53":{"start":{"line":79,"column":4},"end":{"line":79,"column":33}},"54":{"start":{"line":79,"column":20},"end":{"line":79,"column":33}},"55":{"start":{"line":80,"column":18},"end":{"line":80,"column":30}},"56":{"start":{"line":81,"column":20},"end":{"line":81,"column":48}},"57":{"start":{"line":82,"column":25},"end":{"line":82,"column":48}},"58":{"start":{"line":83,"column":21},"end":{"line":83,"column":60}},"59":{"start":{"line":84,"column":4},"end":{"line":84,"column":59}},"60":{"start":{"line":85,"column":4},"end":{"line":85,"column":68}},"61":{"start":{"line":86,"column":23},"end":{"line":86,"column":48}},"62":{"start":{"line":87,"column":4},"end":{"line":87,"column":58}},"63":{"start":{"line":88,"column":4},"end":{"line":88,"column":16}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":45},"end":{"line":2,"column":46}},"loc":{"start":{"line":2,"column":68},"end":{"line":16,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":20,"column":11},"end":{"line":20,"column":12}},"loc":{"start":{"line":20,"column":33},"end":{"line":43,"column":3}},"line":20},"2":{"name":"(anonymous_2)","decl":{"start":{"line":45,"column":40},"end":{"line":45,"column":41}},"loc":{"start":{"line":45,"column":62},"end":{"line":68,"column":1}},"line":45},"3":{"name":"(anonymous_3)","decl":{"start":{"line":72,"column":11},"end":{"line":72,"column":12}},"loc":{"start":{"line":72,"column":33},"end":{"line":89,"column":3}},"line":72}},"branchMap":{"0":{"loc":{"start":{"line":23,"column":4},"end":{"line":25,"column":5}},"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":25,"column":5}},{"start":{},"end":{}}],"line":23},"1":{"loc":{"start":{"line":27,"column":4},"end":{"line":27,"column":33}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":27,"column":33}},{"start":{},"end":{}}],"line":27},"2":{"loc":{"start":{"line":33,"column":6},"end":{"line":35,"column":7}},"type":"if","locations":[{"start":{"line":33,"column":6},"end":{"line":35,"column":7}},{"start":{},"end":{}}],"line":33},"3":{"loc":{"start":{"line":48,"column":2},"end":{"line":50,"column":3}},"type":"if","locations":[{"start":{"line":48,"column":2},"end":{"line":50,"column":3}},{"start":{},"end":{}}],"line":48},"4":{"loc":{"start":{"line":52,"column":2},"end":{"line":54,"column":3}},"type":"if","locations":[{"start":{"line":52,"column":2},"end":{"line":54,"column":3}},{"start":{},"end":{}}],"line":52},"5":{"loc":{"start":{"line":75,"column":4},"end":{"line":77,"column":5}},"type":"if","locations":[{"start":{"line":75,"column":4},"end":{"line":77,"column":5}},{"start":{},"end":{}}],"line":75},"6":{"loc":{"start":{"line":79,"column":4},"end":{"line":79,"column":33}},"type":"if","locations":[{"start":{"line":79,"column":4},"end":{"line":79,"column":33}},{"start":{},"end":{}}],"line":79}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":2,"11":2,"12":2,"13":0,"14":2,"15":2,"16":0,"17":2,"18":2,"19":2,"20":2,"21":2,"22":2,"23":2,"24":0,"25":2,"26":2,"27":2,"28":2,"29":2,"30":2,"31":1,"32":1,"33":1,"34":1,"35":0,"36":1,"37":1,"38":0,"39":1,"40":1,"41":1,"42":1,"43":1,"44":1,"45":1,"46":1,"47":1,"48":2,"49":2,"50":2,"51":0,"52":2,"53":2,"54":0,"55":2,"56":2,"57":2,"58":2,"59":2,"60":2,"61":2,"62":2,"63":2},"f":{"0":1,"1":2,"2":1,"3":2},"b":{"0":[0,2],"1":[0,2],"2":[0,2],"3":[0,1],"4":[0,1],"5":[0,2],"6":[0,2]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/remove-row-col.mutation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, IColumnData, IMutation, IObjectArrayPrimitiveType, IRowData, Worksheet } from '@univerjs/core';\nimport { CommandType, concatMatrixArray, IUniverInstanceService, sliceMatrixArray, spliceArray } from '@univerjs/core';\n\nimport type {\n    IInsertColMutationParams,\n    IInsertRowMutationParams,\n    IRemoveColMutationParams,\n    IRemoveRowsMutationParams,\n} from '../../basics/interfaces/mutation-interface';\n\nexport const RemoveRowsUndoMutationFactory = (\n    params: IRemoveRowsMutationParams,\n    worksheet: Worksheet\n): IInsertRowMutationParams => {\n    const manager = worksheet.getRowManager();\n    const rowPrimitive = manager.getRowData();\n    const rowWrapper = rowPrimitive;\n    const rowInfo: IObjectArrayPrimitiveType<IRowData> = {};\n\n    const range = params.range;\n    const slice = sliceMatrixArray(range.startRow, range.endRow, rowWrapper);\n    const _rowInfo = concatMatrixArray(rowInfo, slice);\n\n    return {\n        unitId: params.unitId,\n        subUnitId: params.subUnitId,\n        range: params.range,\n        rowInfo: _rowInfo as IObjectArrayPrimitiveType<IRowData>,\n    };\n};\n\nexport const RemoveRowMutation: IMutation<IRemoveRowsMutationParams> = {\n    id: 'sheet.mutation.remove-rows',\n\n    type: CommandType.MUTATION,\n\n    handler: (accessor, params) => {\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n        if (universheet == null) {\n            throw new Error('universheet is null error!');\n        }\n\n        const worksheet = universheet.getSheetBySheetId(params.subUnitId);\n        if (!worksheet) return false;\n        const range = params.range;\n        const manager = worksheet.getRowManager();\n        const rowPrimitive = manager.getRowData();\n\n        const filterOutRows = [];\n        for (let i = range.startRow; i <= range.endRow; i++) {\n            if (worksheet.getRowFiltered(i)) {\n                filterOutRows.push(i);\n            }\n        }\n\n        const rowCount = range.endRow - range.startRow + 1;\n        spliceArray(range.startRow, rowCount, rowPrimitive);\n\n        // remove cells contents by directly mutating worksheetCellMatrix\n        const cellMatrix = worksheet.getCellMatrix();\n        cellMatrix.removeRows(range.startRow, rowCount);\n\n        worksheet.setRowCount(worksheet.getRowCount() - rowCount);\n\n        return true;\n    },\n};\n\nexport const RemoveColMutationFactory = (\n    accessor: IAccessor,\n    params: IRemoveColMutationParams\n): IInsertColMutationParams => {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n    if (universheet == null) {\n        throw new Error('universheet is null error!');\n    }\n\n    const worksheet = universheet.getSheetBySheetId(params.subUnitId);\n\n    if (worksheet == null) {\n        throw new Error('worksheet is null error!');\n    }\n\n    const manager = worksheet.getColumnManager();\n    const columnPrimitive = manager.getColumnData();\n    const columnWrapper = columnPrimitive;\n    const colInfo: IObjectArrayPrimitiveType<IColumnData> = {};\n\n    const range = params.range;\n\n    const slice = sliceMatrixArray(range.startColumn, range.endColumn, columnWrapper);\n\n    const _colInfo = concatMatrixArray(colInfo, slice);\n\n    return {\n        unitId: params.unitId,\n        subUnitId: params.subUnitId,\n        range: params.range,\n        colInfo: _colInfo as IObjectArrayPrimitiveType<IColumnData>,\n    };\n};\n\nexport const RemoveColMutation: IMutation<IRemoveColMutationParams> = {\n    id: 'sheet.mutation.remove-col',\n    type: CommandType.MUTATION,\n    handler: (accessor, params) => {\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n        if (universheet == null) {\n            throw new Error('universheet is null error!');\n        }\n\n        const worksheet = universheet.getSheetBySheetId(params.subUnitId);\n        if (!worksheet) return false;\n\n        const range = params.range;\n        const manager = worksheet.getColumnManager();\n        const colPrimitive = manager.getColumnData();\n        const colCount = range.endColumn - range.startColumn + 1;\n        spliceArray(range.startColumn, colCount, colPrimitive);\n        worksheet.setColumnCount(worksheet.getColumnCount() - colCount);\n\n        // remove cells contents by directly mutating worksheetCellMatrix\n        const cellMatrix = worksheet.getCellMatrix();\n        cellMatrix.removeColumns(range.startColumn, colCount);\n\n        return true;\n    },\n};\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2bdcee57d551686db29dbac569ef2ba5916d3b80"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/insert-range-move-down.command.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/insert-range-move-down.command.ts","statementMap":{"0":{"start":{"line":20,"column":44},"end":{"line":20,"column":82}},"1":{"start":{"line":21,"column":42},"end":{"line":125,"column":1}},"2":{"start":{"line":26,"column":27},"end":{"line":26,"column":56}},"3":{"start":{"line":27,"column":28},"end":{"line":27,"column":58}},"4":{"start":{"line":28,"column":34},"end":{"line":28,"column":70}},"5":{"start":{"line":29,"column":36},"end":{"line":29,"column":73}},"6":{"start":{"line":30,"column":36},"end":{"line":30,"column":73}},"7":{"start":{"line":31,"column":25},"end":{"line":31,"column":51}},"8":{"start":{"line":32,"column":26},"end":{"line":32,"column":53}},"9":{"start":{"line":33,"column":4},"end":{"line":36,"column":5}},"10":{"start":{"line":34,"column":6},"end":{"line":34,"column":78}},"11":{"start":{"line":35,"column":6},"end":{"line":35,"column":19}},"12":{"start":{"line":37,"column":19},"end":{"line":37,"column":63}},"13":{"start":{"line":38,"column":4},"end":{"line":38,"column":30}},"14":{"start":{"line":38,"column":17},"end":{"line":38,"column":30}},"15":{"start":{"line":39,"column":55},"end":{"line":39,"column":61}},"16":{"start":{"line":40,"column":16},"end":{"line":40,"column":29}},"17":{"start":{"line":41,"column":4},"end":{"line":43,"column":5}},"18":{"start":{"line":42,"column":6},"end":{"line":42,"column":71}},"19":{"start":{"line":44,"column":4},"end":{"line":44,"column":29}},"20":{"start":{"line":44,"column":16},"end":{"line":44,"column":29}},"21":{"start":{"line":45,"column":26},"end":{"line":45,"column":28}},"22":{"start":{"line":46,"column":26},"end":{"line":46,"column":28}},"23":{"start":{"line":47,"column":23},"end":{"line":47,"column":48}},"24":{"start":{"line":48,"column":22},"end":{"line":48,"column":47}},"25":{"start":{"line":49,"column":22},"end":{"line":49,"column":115}},"26":{"start":{"line":50,"column":24},"end":{"line":50,"column":55}},"27":{"start":{"line":51,"column":27},"end":{"line":51,"column":108}},"28":{"start":{"line":52,"column":4},"end":{"line":78,"column":5}},"29":{"start":{"line":53,"column":24},"end":{"line":53,"column":42}},"30":{"start":{"line":54,"column":21},"end":{"line":54,"column":54}},"31":{"start":{"line":55,"column":30},"end":{"line":68,"column":7}},"32":{"start":{"line":64,"column":67},"end":{"line":67,"column":9}},"33":{"start":{"line":69,"column":6},"end":{"line":72,"column":9}},"34":{"start":{"line":73,"column":37},"end":{"line":76,"column":7}},"35":{"start":{"line":77,"column":6},"end":{"line":77,"column":87}},"36":{"start":{"line":79,"column":22},"end":{"line":79,"column":24}},"37":{"start":{"line":80,"column":4},"end":{"line":89,"column":7}},"38":{"start":{"line":81,"column":19},"end":{"line":81,"column":46}},"39":{"start":{"line":82,"column":6},"end":{"line":84,"column":7}},"40":{"start":{"line":83,"column":8},"end":{"line":83,"column":15}},"41":{"start":{"line":85,"column":6},"end":{"line":87,"column":7}},"42":{"start":{"line":86,"column":8},"end":{"line":86,"column":28}},"43":{"start":{"line":88,"column":6},"end":{"line":88,"column":42}},"44":{"start":{"line":90,"column":38},"end":{"line":96,"column":5}},"45":{"start":{"line":97,"column":61},"end":{"line":100,"column":5}},"46":{"start":{"line":101,"column":4},"end":{"line":101,"column":43}},"47":{"start":{"line":102,"column":4},"end":{"line":102,"column":43}},"48":{"start":{"line":103,"column":29},"end":{"line":106,"column":6}},"49":{"start":{"line":107,"column":4},"end":{"line":107,"column":50}},"50":{"start":{"line":108,"column":4},"end":{"line":108,"column":77}},"51":{"start":{"line":109,"column":4},"end":{"line":109,"column":59}},"52":{"start":{"line":110,"column":4},"end":{"line":110,"column":62}},"53":{"start":{"line":111,"column":4},"end":{"line":111,"column":53}},"54":{"start":{"line":112,"column":19},"end":{"line":112,"column":65}},"55":{"start":{"line":113,"column":4},"end":{"line":120,"column":5}},"56":{"start":{"line":114,"column":6},"end":{"line":118,"column":9}},"57":{"start":{"line":119,"column":6},"end":{"line":119,"column":18}},"58":{"start":{"line":121,"column":4},"end":{"line":121,"column":17}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":25,"column":11},"end":{"line":25,"column":12}},"loc":{"start":{"line":25,"column":39},"end":{"line":122,"column":3}},"line":25},"1":{"name":"(anonymous_1)","decl":{"start":{"line":64,"column":60},"end":{"line":64,"column":61}},"loc":{"start":{"line":64,"column":67},"end":{"line":67,"column":9}},"line":64},"2":{"name":"(anonymous_2)","decl":{"start":{"line":80,"column":25},"end":{"line":80,"column":26}},"loc":{"start":{"line":80,"column":39},"end":{"line":89,"column":5}},"line":80}},"branchMap":{"0":{"loc":{"start":{"line":33,"column":4},"end":{"line":36,"column":5}},"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":36,"column":5}},{"start":{},"end":{}}],"line":33},"1":{"loc":{"start":{"line":38,"column":4},"end":{"line":38,"column":30}},"type":"if","locations":[{"start":{"line":38,"column":4},"end":{"line":38,"column":30}},{"start":{},"end":{}}],"line":38},"2":{"loc":{"start":{"line":41,"column":4},"end":{"line":43,"column":5}},"type":"if","locations":[{"start":{"line":41,"column":4},"end":{"line":43,"column":5}},{"start":{},"end":{}}],"line":41},"3":{"loc":{"start":{"line":44,"column":4},"end":{"line":44,"column":29}},"type":"if","locations":[{"start":{"line":44,"column":4},"end":{"line":44,"column":29}},{"start":{},"end":{}}],"line":44},"4":{"loc":{"start":{"line":52,"column":4},"end":{"line":78,"column":5}},"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":78,"column":5}},{"start":{},"end":{}}],"line":52},"5":{"loc":{"start":{"line":82,"column":6},"end":{"line":84,"column":7}},"type":"if","locations":[{"start":{"line":82,"column":6},"end":{"line":84,"column":7}},{"start":{},"end":{}}],"line":82},"6":{"loc":{"start":{"line":85,"column":6},"end":{"line":87,"column":7}},"type":"if","locations":[{"start":{"line":85,"column":6},"end":{"line":87,"column":7}},{"start":{},"end":{}}],"line":85},"7":{"loc":{"start":{"line":109,"column":26},"end":{"line":109,"column":57}},"type":"binary-expr","locations":[{"start":{"line":109,"column":26},"end":{"line":109,"column":51}},{"start":{"line":109,"column":55},"end":{"line":109,"column":57}}],"line":109},"8":{"loc":{"start":{"line":110,"column":29},"end":{"line":110,"column":60}},"type":"binary-expr","locations":[{"start":{"line":110,"column":29},"end":{"line":110,"column":54}},{"start":{"line":110,"column":58},"end":{"line":110,"column":60}}],"line":110},"9":{"loc":{"start":{"line":113,"column":4},"end":{"line":120,"column":5}},"type":"if","locations":[{"start":{"line":113,"column":4},"end":{"line":120,"column":5}},{"start":{},"end":{}}],"line":113}},"s":{"0":1,"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0},"f":{"0":0,"1":0,"2":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/insert-range-move-down.command.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICellData, ICommand, IMutationInfo, IObjectMatrixPrimitiveType, IRange } from '@univerjs/core';\nimport type {\n    IInsertRangeMutationParams,\n    IInsertRowMutationParams,\n    IRemoveRowsMutationParams,\n} from '../../basics/interfaces/mutation-interface';\n\nimport {\n    BooleanNumber,\n    CommandType,\n    Dimension,\n    ErrorService,\n    ICommandService,\n    IUndoRedoService,\n    IUniverInstanceService,\n    LocaleService,\n    Range,\n    sequenceExecute,\n} from '@univerjs/core';\nimport { SheetsSelectionsService } from '../../services/selections/selection.service';\nimport { SheetInterceptorService } from '../../services/sheet-interceptor/sheet-interceptor.service';\nimport { InsertRowMutation, InsertRowMutationUndoFactory } from '../mutations/insert-row-col.mutation';\nimport { RemoveRowMutation } from '../mutations/remove-row-col.mutation';\nimport { getInsertRangeMutations } from '../utils/handle-range-mutation';\nimport { followSelectionOperation } from './utils/selection-utils';\nimport { getSheetCommandTarget } from './utils/target-util';\n\nexport interface InsertRangeMoveDownCommandParams {\n    range: IRange;\n}\n\nexport const InsertRangeMoveDownCommandId = 'sheet.command.insert-range-move-down';\n/**\n * The command to insert range.\n */\nexport const InsertRangeMoveDownCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.insert-range-move-down',\n\n    // eslint-disable-next-line max-lines-per-function\n    handler: async (accessor: IAccessor, params?: InsertRangeMoveDownCommandParams) => {\n        const commandService = accessor.get(ICommandService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n        const errorService = accessor.get(ErrorService);\n        const localeService = accessor.get(LocaleService);\n\n        if (selectionManagerService.isOverlapping()) {\n            errorService.emit(localeService.t('sheets.info.overlappingSelections'));\n            return false;\n        }\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { unitId, subUnitId, worksheet, workbook } = target;\n\n        let range = params?.range;\n        if (!range) {\n            range = selectionManagerService.getCurrentLastSelection()?.range;\n        }\n        if (!range) return false;\n\n        const redoMutations: IMutationInfo[] = [];\n        const undoMutations: IMutationInfo[] = [];\n\n        const cellMatrix = worksheet.getCellMatrix();\n        const dataRange = cellMatrix.getDataRange();\n        const moveSlice = cellMatrix.getSlice(dataRange.startRow, dataRange.endRow, range.startColumn, range.endColumn);\n        const sliceMaxRow = moveSlice.getDataRange().endRow;\n        const insertRowCount = Math.max(sliceMaxRow + (range.endRow - range.startRow + 1) - dataRange.endRow, 0);\n\n        if (insertRowCount > 0) {\n            const anchorRow = range.startRow - 1;\n            const height = worksheet.getRowHeight(anchorRow);\n\n            const insertRowParams: IInsertRowMutationParams = {\n                unitId,\n                subUnitId,\n                range: {\n                    startRow: dataRange.endRow + 1,\n                    endRow: dataRange.endRow + insertRowCount,\n                    startColumn: dataRange.startColumn,\n                    endColumn: dataRange.endColumn,\n                },\n                rowInfo: new Array(insertRowCount).fill(undefined).map(() => ({\n                    h: height,\n                    hd: BooleanNumber.FALSE,\n                })),\n            };\n\n            redoMutations.push({\n                id: InsertRowMutation.id,\n                params: insertRowParams,\n            });\n\n            const undoRowInsertionParams: IRemoveRowsMutationParams = InsertRowMutationUndoFactory(\n                accessor,\n                insertRowParams\n            );\n\n            undoMutations.push({ id: RemoveRowMutation.id, params: undoRowInsertionParams });\n        }\n\n        // to keep style.\n        const cellValue: IObjectMatrixPrimitiveType<ICellData> = {};\n        Range.foreach(range, (row, col) => {\n            const cell = worksheet.getCell(row, col);\n            if (!cell) {\n                return;\n            }\n            if (!cellValue[row]) {\n                cellValue[row] = {};\n            }\n            cellValue[row][col] = { s: cell.s };\n        });\n        const insertRangeMutationParams: IInsertRangeMutationParams = {\n            range,\n            subUnitId,\n            unitId,\n            shiftDimension: Dimension.ROWS,\n            cellValue,\n        };\n\n        const { redo: insertRangeRedo, undo: insertRangeUndo } = getInsertRangeMutations(\n            accessor,\n            insertRangeMutationParams\n        );\n\n        redoMutations.push(...insertRangeRedo);\n\n        undoMutations.push(...insertRangeUndo);\n\n        const sheetInterceptor = sheetInterceptorService.onCommandExecute({\n            id: InsertRangeMoveDownCommand.id,\n            params: { range } as InsertRangeMoveDownCommandParams,\n        });\n        redoMutations.push(...sheetInterceptor.redos);\n        redoMutations.push(followSelectionOperation(range, workbook, worksheet));\n        undoMutations.push(...(sheetInterceptor.preUndos ?? []));\n\n        redoMutations.unshift(...(sheetInterceptor.preRedos ?? []));\n        undoMutations.unshift(...sheetInterceptor.undos);\n\n        // execute do mutations and add undo mutations to undo stack if completed\n        const result = sequenceExecute(redoMutations, commandService);\n        if (result) {\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: undoMutations.reverse(),\n                redoMutations,\n            });\n\n            return true;\n        }\n\n        return false;\n    },\n    // all subsequent mutations should succeed inorder to make the whole process succeed\n    // Promise.all([]).then(() => true),\n};\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b51b5003f7236f5f6453f2def654a4da2c5d2a6c"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/insert-range-move-right.command.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/insert-range-move-right.command.ts","statementMap":{"0":{"start":{"line":20,"column":45},"end":{"line":20,"column":84}},"1":{"start":{"line":21,"column":43},"end":{"line":128,"column":1}},"2":{"start":{"line":26,"column":27},"end":{"line":26,"column":56}},"3":{"start":{"line":27,"column":28},"end":{"line":27,"column":58}},"4":{"start":{"line":28,"column":34},"end":{"line":28,"column":70}},"5":{"start":{"line":29,"column":36},"end":{"line":29,"column":73}},"6":{"start":{"line":30,"column":36},"end":{"line":30,"column":73}},"7":{"start":{"line":31,"column":25},"end":{"line":31,"column":51}},"8":{"start":{"line":32,"column":26},"end":{"line":32,"column":53}},"9":{"start":{"line":33,"column":4},"end":{"line":36,"column":5}},"10":{"start":{"line":34,"column":6},"end":{"line":34,"column":78}},"11":{"start":{"line":35,"column":6},"end":{"line":35,"column":19}},"12":{"start":{"line":37,"column":19},"end":{"line":37,"column":63}},"13":{"start":{"line":38,"column":4},"end":{"line":38,"column":30}},"14":{"start":{"line":38,"column":17},"end":{"line":38,"column":30}},"15":{"start":{"line":39,"column":55},"end":{"line":39,"column":61}},"16":{"start":{"line":40,"column":16},"end":{"line":40,"column":29}},"17":{"start":{"line":41,"column":4},"end":{"line":43,"column":5}},"18":{"start":{"line":42,"column":6},"end":{"line":42,"column":71}},"19":{"start":{"line":44,"column":4},"end":{"line":44,"column":29}},"20":{"start":{"line":44,"column":16},"end":{"line":44,"column":29}},"21":{"start":{"line":45,"column":26},"end":{"line":45,"column":28}},"22":{"start":{"line":46,"column":26},"end":{"line":46,"column":28}},"23":{"start":{"line":47,"column":23},"end":{"line":47,"column":48}},"24":{"start":{"line":48,"column":22},"end":{"line":48,"column":47}},"25":{"start":{"line":49,"column":22},"end":{"line":49,"column":115}},"26":{"start":{"line":50,"column":24},"end":{"line":50,"column":58}},"27":{"start":{"line":51,"column":27},"end":{"line":54,"column":5}},"28":{"start":{"line":55,"column":4},"end":{"line":81,"column":5}},"29":{"start":{"line":56,"column":24},"end":{"line":56,"column":45}},"30":{"start":{"line":57,"column":20},"end":{"line":57,"column":55}},"31":{"start":{"line":58,"column":30},"end":{"line":71,"column":7}},"32":{"start":{"line":67,"column":67},"end":{"line":70,"column":9}},"33":{"start":{"line":72,"column":6},"end":{"line":75,"column":9}},"34":{"start":{"line":76,"column":37},"end":{"line":79,"column":7}},"35":{"start":{"line":80,"column":6},"end":{"line":80,"column":87}},"36":{"start":{"line":82,"column":22},"end":{"line":82,"column":24}},"37":{"start":{"line":83,"column":4},"end":{"line":92,"column":7}},"38":{"start":{"line":84,"column":19},"end":{"line":84,"column":46}},"39":{"start":{"line":85,"column":6},"end":{"line":87,"column":7}},"40":{"start":{"line":86,"column":8},"end":{"line":86,"column":15}},"41":{"start":{"line":88,"column":6},"end":{"line":90,"column":7}},"42":{"start":{"line":89,"column":8},"end":{"line":89,"column":28}},"43":{"start":{"line":91,"column":6},"end":{"line":91,"column":42}},"44":{"start":{"line":93,"column":38},"end":{"line":99,"column":5}},"45":{"start":{"line":100,"column":61},"end":{"line":103,"column":5}},"46":{"start":{"line":104,"column":4},"end":{"line":104,"column":43}},"47":{"start":{"line":105,"column":4},"end":{"line":105,"column":43}},"48":{"start":{"line":106,"column":29},"end":{"line":109,"column":6}},"49":{"start":{"line":110,"column":4},"end":{"line":110,"column":50}},"50":{"start":{"line":111,"column":4},"end":{"line":111,"column":77}},"51":{"start":{"line":112,"column":4},"end":{"line":112,"column":59}},"52":{"start":{"line":113,"column":4},"end":{"line":113,"column":62}},"53":{"start":{"line":114,"column":4},"end":{"line":114,"column":53}},"54":{"start":{"line":115,"column":19},"end":{"line":115,"column":65}},"55":{"start":{"line":116,"column":4},"end":{"line":123,"column":5}},"56":{"start":{"line":117,"column":6},"end":{"line":121,"column":9}},"57":{"start":{"line":122,"column":6},"end":{"line":122,"column":18}},"58":{"start":{"line":124,"column":4},"end":{"line":124,"column":17}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":25,"column":11},"end":{"line":25,"column":12}},"loc":{"start":{"line":25,"column":39},"end":{"line":125,"column":3}},"line":25},"1":{"name":"(anonymous_1)","decl":{"start":{"line":67,"column":60},"end":{"line":67,"column":61}},"loc":{"start":{"line":67,"column":67},"end":{"line":70,"column":9}},"line":67},"2":{"name":"(anonymous_2)","decl":{"start":{"line":83,"column":25},"end":{"line":83,"column":26}},"loc":{"start":{"line":83,"column":39},"end":{"line":92,"column":5}},"line":83}},"branchMap":{"0":{"loc":{"start":{"line":33,"column":4},"end":{"line":36,"column":5}},"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":36,"column":5}},{"start":{},"end":{}}],"line":33},"1":{"loc":{"start":{"line":38,"column":4},"end":{"line":38,"column":30}},"type":"if","locations":[{"start":{"line":38,"column":4},"end":{"line":38,"column":30}},{"start":{},"end":{}}],"line":38},"2":{"loc":{"start":{"line":41,"column":4},"end":{"line":43,"column":5}},"type":"if","locations":[{"start":{"line":41,"column":4},"end":{"line":43,"column":5}},{"start":{},"end":{}}],"line":41},"3":{"loc":{"start":{"line":44,"column":4},"end":{"line":44,"column":29}},"type":"if","locations":[{"start":{"line":44,"column":4},"end":{"line":44,"column":29}},{"start":{},"end":{}}],"line":44},"4":{"loc":{"start":{"line":55,"column":4},"end":{"line":81,"column":5}},"type":"if","locations":[{"start":{"line":55,"column":4},"end":{"line":81,"column":5}},{"start":{},"end":{}}],"line":55},"5":{"loc":{"start":{"line":85,"column":6},"end":{"line":87,"column":7}},"type":"if","locations":[{"start":{"line":85,"column":6},"end":{"line":87,"column":7}},{"start":{},"end":{}}],"line":85},"6":{"loc":{"start":{"line":85,"column":10},"end":{"line":85,"column":26}},"type":"binary-expr","locations":[{"start":{"line":85,"column":10},"end":{"line":85,"column":15}},{"start":{"line":85,"column":19},"end":{"line":85,"column":26}}],"line":85},"7":{"loc":{"start":{"line":88,"column":6},"end":{"line":90,"column":7}},"type":"if","locations":[{"start":{"line":88,"column":6},"end":{"line":90,"column":7}},{"start":{},"end":{}}],"line":88},"8":{"loc":{"start":{"line":112,"column":26},"end":{"line":112,"column":57}},"type":"binary-expr","locations":[{"start":{"line":112,"column":26},"end":{"line":112,"column":51}},{"start":{"line":112,"column":55},"end":{"line":112,"column":57}}],"line":112},"9":{"loc":{"start":{"line":113,"column":29},"end":{"line":113,"column":60}},"type":"binary-expr","locations":[{"start":{"line":113,"column":29},"end":{"line":113,"column":54}},{"start":{"line":113,"column":58},"end":{"line":113,"column":60}}],"line":113},"10":{"loc":{"start":{"line":116,"column":4},"end":{"line":123,"column":5}},"type":"if","locations":[{"start":{"line":116,"column":4},"end":{"line":123,"column":5}},{"start":{},"end":{}}],"line":116}},"s":{"0":1,"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0},"f":{"0":0,"1":0,"2":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/insert-range-move-right.command.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICellData, ICommand, IMutationInfo, IObjectMatrixPrimitiveType, IRange } from '@univerjs/core';\nimport type {\n    IInsertColMutationParams,\n    IInsertRangeMutationParams,\n    IRemoveColMutationParams,\n} from '../../basics/interfaces/mutation-interface';\n\nimport {\n    BooleanNumber,\n    CommandType,\n    Dimension,\n    ErrorService,\n    ICommandService,\n    IUndoRedoService,\n    IUniverInstanceService,\n    LocaleService,\n    Range,\n    sequenceExecute,\n} from '@univerjs/core';\nimport { SheetsSelectionsService } from '../../services/selections/selection.service';\nimport { SheetInterceptorService } from '../../services/sheet-interceptor/sheet-interceptor.service';\nimport { InsertColMutation, InsertColMutationUndoFactory } from '../mutations/insert-row-col.mutation';\nimport { RemoveColMutation } from '../mutations/remove-row-col.mutation';\nimport { getInsertRangeMutations } from '../utils/handle-range-mutation';\nimport { followSelectionOperation } from './utils/selection-utils';\nimport { getSheetCommandTarget } from './utils/target-util';\n\nexport interface InsertRangeMoveRightCommandParams {\n    range: IRange;\n}\nexport const InsertRangeMoveRightCommandId = 'sheet.command.insert-range-move-right';\n/**\n * The command to insert range.\n */\nexport const InsertRangeMoveRightCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: InsertRangeMoveRightCommandId,\n\n    // eslint-disable-next-line max-lines-per-function\n    handler: async (accessor: IAccessor, params?: InsertRangeMoveRightCommandParams) => {\n        const commandService = accessor.get(ICommandService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n        const errorService = accessor.get(ErrorService);\n        const localeService = accessor.get(LocaleService);\n\n        if (selectionManagerService.isOverlapping()) {\n            errorService.emit(localeService.t('sheets.info.overlappingSelections'));\n            return false;\n        }\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { workbook, worksheet, unitId, subUnitId } = target;\n\n        let range = params?.range;\n        if (!range) {\n            range = selectionManagerService.getCurrentLastSelection()?.range;\n        }\n        if (!range) return false;\n\n        const redoMutations: IMutationInfo[] = [];\n        const undoMutations: IMutationInfo[] = [];\n\n        const cellMatrix = worksheet.getCellMatrix();\n        const dataRange = cellMatrix.getDataRange();\n        const moveSlice = cellMatrix.getSlice(range.startRow, range.endRow, dataRange.startColumn, dataRange.endColumn);\n        const sliceMaxCol = moveSlice.getDataRange().endColumn;\n        const insertColCount = Math.max(\n            sliceMaxCol + (range.endColumn - range.startColumn + 1) - dataRange.endColumn,\n            0\n        );\n        if (insertColCount > 0) {\n            const anchorCol = range.startColumn - 1;\n            const width = worksheet.getColumnWidth(anchorCol);\n\n            const insertColParams: IInsertColMutationParams = {\n                unitId,\n                subUnitId,\n                range: {\n                    startRow: dataRange.startRow + 1,\n                    endRow: dataRange.endRow,\n                    startColumn: dataRange.endColumn + 1,\n                    endColumn: dataRange.endColumn + insertColCount,\n                },\n                colInfo: new Array(insertColCount).fill(undefined).map(() => ({\n                    w: width,\n                    hd: BooleanNumber.FALSE,\n                })),\n            };\n\n            redoMutations.push({\n                id: InsertColMutation.id,\n                params: insertColParams,\n            });\n\n            const undoColInsertionParams: IRemoveColMutationParams = InsertColMutationUndoFactory(\n                accessor,\n                insertColParams\n            );\n\n            undoMutations.push({ id: RemoveColMutation.id, params: undoColInsertionParams });\n        }\n\n        // to keep style.\n        const cellValue: IObjectMatrixPrimitiveType<ICellData> = {};\n        Range.foreach(range, (row, col) => {\n            const cell = worksheet.getCell(row, col);\n            if (!cell || !cell.s) {\n                return;\n            }\n            if (!cellValue[row]) {\n                cellValue[row] = {};\n            }\n            cellValue[row][col] = { s: cell.s };\n        });\n        const insertRangeMutationParams: IInsertRangeMutationParams = {\n            range,\n            subUnitId,\n            unitId,\n            shiftDimension: Dimension.COLUMNS,\n            cellValue,\n        };\n\n        const { redo: insertRangeRedo, undo: insertRangeUndo } = getInsertRangeMutations(\n            accessor,\n            insertRangeMutationParams\n        );\n\n        redoMutations.push(...insertRangeRedo);\n        undoMutations.push(...insertRangeUndo);\n\n        const sheetInterceptor = sheetInterceptorService.onCommandExecute({\n            id: InsertRangeMoveRightCommand.id,\n            params: { range } as InsertRangeMoveRightCommandParams,\n        });\n        redoMutations.push(...sheetInterceptor.redos);\n        redoMutations.push(followSelectionOperation(range, workbook, worksheet));\n        undoMutations.push(...(sheetInterceptor.preUndos ?? []));\n\n        redoMutations.unshift(...(sheetInterceptor.preRedos ?? []));\n        undoMutations.unshift(...sheetInterceptor.undos);\n\n        // execute do mutations and add undo mutations to undo stack if completed\n        const result = sequenceExecute(redoMutations, commandService);\n        if (result.result) {\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: undoMutations.reverse(),\n                redoMutations,\n            });\n\n            return true;\n        }\n\n        return false;\n    },\n    // all subsequent mutations should succeed in order to make the whole process succeed\n    // Promise.all([]).then(() => true),\n};\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f95749cdfa3289f7deb4ac7bf5d111b6eef4a562"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/insert-row-col.command.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/insert-row-col.command.ts","statementMap":{"0":{"start":{"line":23,"column":34},"end":{"line":23,"column":60}},"1":{"start":{"line":24,"column":32},"end":{"line":46,"column":1}},"2":{"start":{"line":28,"column":27},"end":{"line":28,"column":56}},"3":{"start":{"line":29,"column":36},"end":{"line":29,"column":73}},"4":{"start":{"line":30,"column":63},"end":{"line":30,"column":69}},"5":{"start":{"line":31,"column":23},"end":{"line":34,"column":6}},"6":{"start":{"line":35,"column":4},"end":{"line":37,"column":5}},"7":{"start":{"line":36,"column":6},"end":{"line":36,"column":19}},"8":{"start":{"line":38,"column":4},"end":{"line":44,"column":7}},"9":{"start":{"line":47,"column":39},"end":{"line":109,"column":1}},"10":{"start":{"line":51,"column":27},"end":{"line":51,"column":56}},"11":{"start":{"line":52,"column":28},"end":{"line":52,"column":58}},"12":{"start":{"line":53,"column":34},"end":{"line":53,"column":70}},"13":{"start":{"line":54,"column":36},"end":{"line":54,"column":73}},"14":{"start":{"line":55,"column":19},"end":{"line":55,"column":71}},"15":{"start":{"line":56,"column":4},"end":{"line":56,"column":30}},"16":{"start":{"line":56,"column":17},"end":{"line":56,"column":30}},"17":{"start":{"line":57,"column":36},"end":{"line":57,"column":42}},"18":{"start":{"line":58,"column":63},"end":{"line":58,"column":69}},"19":{"start":{"line":59,"column":33},"end":{"line":59,"column":38}},"20":{"start":{"line":60,"column":4},"end":{"line":60,"column":37}},"21":{"start":{"line":61,"column":22},"end":{"line":61,"column":74}},"22":{"start":{"line":62,"column":19},"end":{"line":62,"column":52}},"23":{"start":{"line":63,"column":28},"end":{"line":72,"column":5}},"24":{"start":{"line":67,"column":72},"end":{"line":70,"column":7}},"25":{"start":{"line":73,"column":35},"end":{"line":76,"column":5}},"26":{"start":{"line":77,"column":18},"end":{"line":77,"column":73}},"27":{"start":{"line":78,"column":18},"end":{"line":78,"column":80}},"28":{"start":{"line":79,"column":4},"end":{"line":88,"column":5}},"29":{"start":{"line":80,"column":6},"end":{"line":87,"column":9}},"30":{"start":{"line":89,"column":24},"end":{"line":92,"column":6}},"31":{"start":{"line":93,"column":4},"end":{"line":93,"column":49}},"32":{"start":{"line":94,"column":4},"end":{"line":94,"column":43}},"33":{"start":{"line":95,"column":4},"end":{"line":95,"column":69}},"34":{"start":{"line":96,"column":4},"end":{"line":96,"column":49}},"35":{"start":{"line":97,"column":4},"end":{"line":97,"column":43}},"36":{"start":{"line":98,"column":19},"end":{"line":98,"column":57}},"37":{"start":{"line":99,"column":4},"end":{"line":106,"column":5}},"38":{"start":{"line":100,"column":6},"end":{"line":104,"column":9}},"39":{"start":{"line":105,"column":6},"end":{"line":105,"column":18}},"40":{"start":{"line":107,"column":4},"end":{"line":107,"column":17}},"41":{"start":{"line":110,"column":38},"end":{"line":144,"column":1}},"42":{"start":{"line":114,"column":36},"end":{"line":114,"column":73}},"43":{"start":{"line":115,"column":23},"end":{"line":115,"column":90}},"44":{"start":{"line":115,"column":82},"end":{"line":115,"column":89}},"45":{"start":{"line":117,"column":4},"end":{"line":121,"column":5}},"46":{"start":{"line":118,"column":6},"end":{"line":118,"column":28}},"47":{"start":{"line":120,"column":6},"end":{"line":120,"column":19}},"48":{"start":{"line":122,"column":34},"end":{"line":122,"column":70}},"49":{"start":{"line":123,"column":19},"end":{"line":123,"column":63}},"50":{"start":{"line":124,"column":4},"end":{"line":124,"column":30}},"51":{"start":{"line":124,"column":17},"end":{"line":124,"column":30}},"52":{"start":{"line":125,"column":45},"end":{"line":125,"column":51}},"53":{"start":{"line":126,"column":33},"end":{"line":126,"column":38}},"54":{"start":{"line":127,"column":24},"end":{"line":127,"column":25}},"55":{"start":{"line":128,"column":22},"end":{"line":128,"column":52}},"56":{"start":{"line":129,"column":28},"end":{"line":141,"column":5}},"57":{"start":{"line":142,"column":4},"end":{"line":142,"column":94}},"58":{"start":{"line":145,"column":37},"end":{"line":182,"column":1}},"59":{"start":{"line":149,"column":36},"end":{"line":149,"column":73}},"60":{"start":{"line":150,"column":23},"end":{"line":150,"column":90}},"61":{"start":{"line":150,"column":82},"end":{"line":150,"column":89}},"62":{"start":{"line":152,"column":4},"end":{"line":156,"column":5}},"63":{"start":{"line":153,"column":6},"end":{"line":153,"column":28}},"64":{"start":{"line":155,"column":6},"end":{"line":155,"column":19}},"65":{"start":{"line":157,"column":34},"end":{"line":157,"column":70}},"66":{"start":{"line":158,"column":19},"end":{"line":158,"column":63}},"67":{"start":{"line":159,"column":4},"end":{"line":159,"column":30}},"68":{"start":{"line":159,"column":17},"end":{"line":159,"column":30}},"69":{"start":{"line":160,"column":45},"end":{"line":160,"column":51}},"70":{"start":{"line":161,"column":18},"end":{"line":161,"column":51}},"71":{"start":{"line":162,"column":21},"end":{"line":162,"column":37}},"72":{"start":{"line":163,"column":19},"end":{"line":163,"column":39}},"73":{"start":{"line":164,"column":24},"end":{"line":164,"column":25}},"74":{"start":{"line":165,"column":22},"end":{"line":165,"column":52}},"75":{"start":{"line":166,"column":28},"end":{"line":179,"column":5}},"76":{"start":{"line":180,"column":4},"end":{"line":180,"column":94}},"77":{"start":{"line":183,"column":43},"end":{"line":221,"column":1}},"78":{"start":{"line":187,"column":36},"end":{"line":187,"column":73}},"79":{"start":{"line":188,"column":23},"end":{"line":188,"column":90}},"80":{"start":{"line":188,"column":82},"end":{"line":188,"column":89}},"81":{"start":{"line":190,"column":4},"end":{"line":194,"column":5}},"82":{"start":{"line":191,"column":6},"end":{"line":191,"column":28}},"83":{"start":{"line":193,"column":6},"end":{"line":193,"column":19}},"84":{"start":{"line":195,"column":34},"end":{"line":195,"column":70}},"85":{"start":{"line":196,"column":19},"end":{"line":196,"column":63}},"86":{"start":{"line":197,"column":4},"end":{"line":197,"column":30}},"87":{"start":{"line":197,"column":17},"end":{"line":197,"column":30}},"88":{"start":{"line":198,"column":45},"end":{"line":198,"column":51}},"89":{"start":{"line":199,"column":18},"end":{"line":199,"column":35}},"90":{"start":{"line":200,"column":21},"end":{"line":200,"column":35}},"91":{"start":{"line":201,"column":19},"end":{"line":201,"column":45}},"92":{"start":{"line":202,"column":24},"end":{"line":202,"column":25}},"93":{"start":{"line":203,"column":22},"end":{"line":203,"column":52}},"94":{"start":{"line":204,"column":24},"end":{"line":204,"column":112}},"95":{"start":{"line":205,"column":28},"end":{"line":218,"column":5}},"96":{"start":{"line":219,"column":4},"end":{"line":219,"column":94}},"97":{"start":{"line":222,"column":43},"end":{"line":259,"column":1}},"98":{"start":{"line":226,"column":36},"end":{"line":226,"column":73}},"99":{"start":{"line":227,"column":23},"end":{"line":227,"column":90}},"100":{"start":{"line":227,"column":82},"end":{"line":227,"column":89}},"101":{"start":{"line":229,"column":4},"end":{"line":233,"column":5}},"102":{"start":{"line":230,"column":6},"end":{"line":230,"column":28}},"103":{"start":{"line":232,"column":6},"end":{"line":232,"column":19}},"104":{"start":{"line":234,"column":34},"end":{"line":234,"column":70}},"105":{"start":{"line":235,"column":19},"end":{"line":235,"column":63}},"106":{"start":{"line":236,"column":4},"end":{"line":236,"column":30}},"107":{"start":{"line":236,"column":17},"end":{"line":236,"column":30}},"108":{"start":{"line":237,"column":45},"end":{"line":237,"column":51}},"109":{"start":{"line":238,"column":18},"end":{"line":238,"column":35}},"110":{"start":{"line":239,"column":21},"end":{"line":239,"column":37}},"111":{"start":{"line":240,"column":19},"end":{"line":240,"column":39}},"112":{"start":{"line":241,"column":24},"end":{"line":241,"column":25}},"113":{"start":{"line":242,"column":22},"end":{"line":242,"column":52}},"114":{"start":{"line":243,"column":28},"end":{"line":256,"column":5}},"115":{"start":{"line":257,"column":4},"end":{"line":257,"column":94}},"116":{"start":{"line":260,"column":34},"end":{"line":260,"column":60}},"117":{"start":{"line":261,"column":32},"end":{"line":283,"column":1}},"118":{"start":{"line":265,"column":27},"end":{"line":265,"column":56}},"119":{"start":{"line":266,"column":36},"end":{"line":266,"column":73}},"120":{"start":{"line":267,"column":63},"end":{"line":267,"column":69}},"121":{"start":{"line":268,"column":23},"end":{"line":271,"column":6}},"122":{"start":{"line":272,"column":4},"end":{"line":274,"column":5}},"123":{"start":{"line":273,"column":6},"end":{"line":273,"column":19}},"124":{"start":{"line":275,"column":4},"end":{"line":281,"column":7}},"125":{"start":{"line":284,"column":39},"end":{"line":344,"column":1}},"126":{"start":{"line":288,"column":27},"end":{"line":288,"column":56}},"127":{"start":{"line":289,"column":28},"end":{"line":289,"column":58}},"128":{"start":{"line":290,"column":34},"end":{"line":290,"column":70}},"129":{"start":{"line":291,"column":36},"end":{"line":291,"column":73}},"130":{"start":{"line":292,"column":63},"end":{"line":292,"column":69}},"131":{"start":{"line":293,"column":39},"end":{"line":293,"column":51}},"132":{"start":{"line":294,"column":4},"end":{"line":294,"column":40}},"133":{"start":{"line":295,"column":21},"end":{"line":295,"column":80}},"134":{"start":{"line":296,"column":22},"end":{"line":296,"column":66}},"135":{"start":{"line":297,"column":22},"end":{"line":297,"column":82}},"136":{"start":{"line":298,"column":18},"end":{"line":298,"column":53}},"137":{"start":{"line":299,"column":28},"end":{"line":307,"column":5}},"138":{"start":{"line":303,"column":78},"end":{"line":306,"column":7}},"139":{"start":{"line":308,"column":35},"end":{"line":311,"column":5}},"140":{"start":{"line":312,"column":18},"end":{"line":312,"column":73}},"141":{"start":{"line":313,"column":18},"end":{"line":313,"column":80}},"142":{"start":{"line":314,"column":4},"end":{"line":323,"column":5}},"143":{"start":{"line":315,"column":6},"end":{"line":322,"column":9}},"144":{"start":{"line":324,"column":24},"end":{"line":327,"column":6}},"145":{"start":{"line":328,"column":4},"end":{"line":328,"column":49}},"146":{"start":{"line":329,"column":4},"end":{"line":329,"column":43}},"147":{"start":{"line":330,"column":4},"end":{"line":330,"column":69}},"148":{"start":{"line":331,"column":4},"end":{"line":331,"column":49}},"149":{"start":{"line":332,"column":4},"end":{"line":332,"column":43}},"150":{"start":{"line":333,"column":19},"end":{"line":333,"column":57}},"151":{"start":{"line":334,"column":4},"end":{"line":341,"column":5}},"152":{"start":{"line":335,"column":6},"end":{"line":339,"column":9}},"153":{"start":{"line":340,"column":6},"end":{"line":340,"column":18}},"154":{"start":{"line":342,"column":4},"end":{"line":342,"column":17}},"155":{"start":{"line":345,"column":38},"end":{"line":380,"column":1}},"156":{"start":{"line":349,"column":36},"end":{"line":349,"column":73}},"157":{"start":{"line":350,"column":23},"end":{"line":350,"column":69}},"158":{"start":{"line":352,"column":4},"end":{"line":356,"column":5}},"159":{"start":{"line":353,"column":6},"end":{"line":353,"column":34}},"160":{"start":{"line":355,"column":6},"end":{"line":355,"column":19}},"161":{"start":{"line":357,"column":34},"end":{"line":357,"column":70}},"162":{"start":{"line":358,"column":19},"end":{"line":358,"column":63}},"163":{"start":{"line":359,"column":4},"end":{"line":359,"column":30}},"164":{"start":{"line":359,"column":17},"end":{"line":359,"column":30}},"165":{"start":{"line":360,"column":45},"end":{"line":360,"column":51}},"166":{"start":{"line":361,"column":39},"end":{"line":361,"column":44}},"167":{"start":{"line":362,"column":21},"end":{"line":362,"column":22}},"168":{"start":{"line":363,"column":19},"end":{"line":363,"column":46}},"169":{"start":{"line":364,"column":28},"end":{"line":377,"column":5}},"170":{"start":{"line":378,"column":4},"end":{"line":378,"column":94}},"171":{"start":{"line":381,"column":37},"end":{"line":417,"column":1}},"172":{"start":{"line":385,"column":36},"end":{"line":385,"column":73}},"173":{"start":{"line":386,"column":23},"end":{"line":386,"column":69}},"174":{"start":{"line":388,"column":4},"end":{"line":392,"column":5}},"175":{"start":{"line":389,"column":6},"end":{"line":389,"column":34}},"176":{"start":{"line":391,"column":6},"end":{"line":391,"column":19}},"177":{"start":{"line":393,"column":34},"end":{"line":393,"column":70}},"178":{"start":{"line":394,"column":19},"end":{"line":394,"column":63}},"179":{"start":{"line":395,"column":4},"end":{"line":395,"column":30}},"180":{"start":{"line":395,"column":17},"end":{"line":395,"column":30}},"181":{"start":{"line":396,"column":45},"end":{"line":396,"column":51}},"182":{"start":{"line":397,"column":18},"end":{"line":397,"column":57}},"183":{"start":{"line":398,"column":24},"end":{"line":398,"column":43}},"184":{"start":{"line":399,"column":22},"end":{"line":399,"column":45}},"185":{"start":{"line":400,"column":21},"end":{"line":400,"column":22}},"186":{"start":{"line":401,"column":19},"end":{"line":401,"column":46}},"187":{"start":{"line":402,"column":28},"end":{"line":414,"column":5}},"188":{"start":{"line":415,"column":4},"end":{"line":415,"column":94}},"189":{"start":{"line":418,"column":42},"end":{"line":455,"column":1}},"190":{"start":{"line":422,"column":36},"end":{"line":422,"column":73}},"191":{"start":{"line":423,"column":23},"end":{"line":423,"column":69}},"192":{"start":{"line":425,"column":4},"end":{"line":429,"column":5}},"193":{"start":{"line":426,"column":6},"end":{"line":426,"column":34}},"194":{"start":{"line":428,"column":6},"end":{"line":428,"column":19}},"195":{"start":{"line":430,"column":34},"end":{"line":430,"column":70}},"196":{"start":{"line":431,"column":19},"end":{"line":431,"column":63}},"197":{"start":{"line":432,"column":4},"end":{"line":432,"column":30}},"198":{"start":{"line":432,"column":17},"end":{"line":432,"column":30}},"199":{"start":{"line":433,"column":45},"end":{"line":433,"column":51}},"200":{"start":{"line":434,"column":18},"end":{"line":434,"column":35}},"201":{"start":{"line":435,"column":24},"end":{"line":435,"column":41}},"202":{"start":{"line":436,"column":22},"end":{"line":436,"column":51}},"203":{"start":{"line":437,"column":21},"end":{"line":437,"column":22}},"204":{"start":{"line":438,"column":19},"end":{"line":438,"column":46}},"205":{"start":{"line":439,"column":28},"end":{"line":452,"column":5}},"206":{"start":{"line":453,"column":4},"end":{"line":453,"column":94}},"207":{"start":{"line":456,"column":43},"end":{"line":492,"column":1}},"208":{"start":{"line":460,"column":36},"end":{"line":460,"column":73}},"209":{"start":{"line":461,"column":23},"end":{"line":461,"column":69}},"210":{"start":{"line":463,"column":4},"end":{"line":467,"column":5}},"211":{"start":{"line":464,"column":6},"end":{"line":464,"column":34}},"212":{"start":{"line":466,"column":6},"end":{"line":466,"column":19}},"213":{"start":{"line":468,"column":34},"end":{"line":468,"column":70}},"214":{"start":{"line":469,"column":19},"end":{"line":469,"column":63}},"215":{"start":{"line":470,"column":4},"end":{"line":470,"column":30}},"216":{"start":{"line":470,"column":17},"end":{"line":470,"column":30}},"217":{"start":{"line":471,"column":45},"end":{"line":471,"column":51}},"218":{"start":{"line":472,"column":18},"end":{"line":472,"column":35}},"219":{"start":{"line":473,"column":24},"end":{"line":473,"column":43}},"220":{"start":{"line":474,"column":22},"end":{"line":474,"column":45}},"221":{"start":{"line":475,"column":21},"end":{"line":475,"column":22}},"222":{"start":{"line":476,"column":19},"end":{"line":476,"column":46}},"223":{"start":{"line":477,"column":28},"end":{"line":489,"column":5}},"224":{"start":{"line":490,"column":4},"end":{"line":490,"column":94}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":27,"column":11},"end":{"line":27,"column":12}},"loc":{"start":{"line":27,"column":39},"end":{"line":45,"column":3}},"line":27},"1":{"name":"(anonymous_1)","decl":{"start":{"line":50,"column":11},"end":{"line":50,"column":12}},"loc":{"start":{"line":50,"column":33},"end":{"line":108,"column":3}},"line":50},"2":{"name":"(anonymous_2)","decl":{"start":{"line":67,"column":65},"end":{"line":67,"column":66}},"loc":{"start":{"line":67,"column":72},"end":{"line":70,"column":7}},"line":67},"3":{"name":"(anonymous_3)","decl":{"start":{"line":113,"column":11},"end":{"line":113,"column":12}},"loc":{"start":{"line":113,"column":31},"end":{"line":143,"column":3}},"line":113},"4":{"name":"(anonymous_4)","decl":{"start":{"line":115,"column":75},"end":{"line":115,"column":76}},"loc":{"start":{"line":115,"column":82},"end":{"line":115,"column":89}},"line":115},"5":{"name":"(anonymous_5)","decl":{"start":{"line":148,"column":11},"end":{"line":148,"column":12}},"loc":{"start":{"line":148,"column":31},"end":{"line":181,"column":3}},"line":148},"6":{"name":"(anonymous_6)","decl":{"start":{"line":150,"column":75},"end":{"line":150,"column":76}},"loc":{"start":{"line":150,"column":82},"end":{"line":150,"column":89}},"line":150},"7":{"name":"(anonymous_7)","decl":{"start":{"line":186,"column":11},"end":{"line":186,"column":12}},"loc":{"start":{"line":186,"column":39},"end":{"line":220,"column":3}},"line":186},"8":{"name":"(anonymous_8)","decl":{"start":{"line":188,"column":75},"end":{"line":188,"column":76}},"loc":{"start":{"line":188,"column":82},"end":{"line":188,"column":89}},"line":188},"9":{"name":"(anonymous_9)","decl":{"start":{"line":225,"column":11},"end":{"line":225,"column":12}},"loc":{"start":{"line":225,"column":39},"end":{"line":258,"column":3}},"line":225},"10":{"name":"(anonymous_10)","decl":{"start":{"line":227,"column":75},"end":{"line":227,"column":76}},"loc":{"start":{"line":227,"column":82},"end":{"line":227,"column":89}},"line":227},"11":{"name":"(anonymous_11)","decl":{"start":{"line":264,"column":11},"end":{"line":264,"column":12}},"loc":{"start":{"line":264,"column":39},"end":{"line":282,"column":3}},"line":264},"12":{"name":"(anonymous_12)","decl":{"start":{"line":287,"column":11},"end":{"line":287,"column":12}},"loc":{"start":{"line":287,"column":33},"end":{"line":343,"column":3}},"line":287},"13":{"name":"(anonymous_13)","decl":{"start":{"line":303,"column":71},"end":{"line":303,"column":72}},"loc":{"start":{"line":303,"column":78},"end":{"line":306,"column":7}},"line":303},"14":{"name":"(anonymous_14)","decl":{"start":{"line":348,"column":11},"end":{"line":348,"column":12}},"loc":{"start":{"line":348,"column":31},"end":{"line":379,"column":3}},"line":348},"15":{"name":"(anonymous_15)","decl":{"start":{"line":384,"column":11},"end":{"line":384,"column":12}},"loc":{"start":{"line":384,"column":31},"end":{"line":416,"column":3}},"line":384},"16":{"name":"(anonymous_16)","decl":{"start":{"line":421,"column":11},"end":{"line":421,"column":12}},"loc":{"start":{"line":421,"column":39},"end":{"line":454,"column":3}},"line":421},"17":{"name":"(anonymous_17)","decl":{"start":{"line":459,"column":11},"end":{"line":459,"column":12}},"loc":{"start":{"line":459,"column":39},"end":{"line":491,"column":3}},"line":459}},"branchMap":{"0":{"loc":{"start":{"line":35,"column":4},"end":{"line":37,"column":5}},"type":"if","locations":[{"start":{"line":35,"column":4},"end":{"line":37,"column":5}},{"start":{},"end":{}}],"line":35},"1":{"loc":{"start":{"line":56,"column":4},"end":{"line":56,"column":30}},"type":"if","locations":[{"start":{"line":56,"column":4},"end":{"line":56,"column":30}},{"start":{},"end":{}}],"line":56},"2":{"loc":{"start":{"line":61,"column":22},"end":{"line":61,"column":74}},"type":"cond-expr","locations":[{"start":{"line":61,"column":51},"end":{"line":61,"column":59}},{"start":{"line":61,"column":62},"end":{"line":61,"column":74}}],"line":61},"3":{"loc":{"start":{"line":79,"column":4},"end":{"line":88,"column":5}},"type":"if","locations":[{"start":{"line":79,"column":4},"end":{"line":88,"column":5}},{"start":{},"end":{}}],"line":79},"4":{"loc":{"start":{"line":93,"column":21},"end":{"line":93,"column":47}},"type":"binary-expr","locations":[{"start":{"line":93,"column":21},"end":{"line":93,"column":41}},{"start":{"line":93,"column":45},"end":{"line":93,"column":47}}],"line":93},"5":{"loc":{"start":{"line":94,"column":18},"end":{"line":94,"column":41}},"type":"binary-expr","locations":[{"start":{"line":94,"column":18},"end":{"line":94,"column":35}},{"start":{"line":94,"column":39},"end":{"line":94,"column":41}}],"line":94},"6":{"loc":{"start":{"line":96,"column":21},"end":{"line":96,"column":47}},"type":"binary-expr","locations":[{"start":{"line":96,"column":21},"end":{"line":96,"column":41}},{"start":{"line":96,"column":45},"end":{"line":96,"column":47}}],"line":96},"7":{"loc":{"start":{"line":97,"column":18},"end":{"line":97,"column":41}},"type":"binary-expr","locations":[{"start":{"line":97,"column":18},"end":{"line":97,"column":35}},{"start":{"line":97,"column":39},"end":{"line":97,"column":41}}],"line":97},"8":{"loc":{"start":{"line":99,"column":4},"end":{"line":106,"column":5}},"type":"if","locations":[{"start":{"line":99,"column":4},"end":{"line":106,"column":5}},{"start":{},"end":{}}],"line":99},"9":{"loc":{"start":{"line":117,"column":4},"end":{"line":121,"column":5}},"type":"if","locations":[{"start":{"line":117,"column":4},"end":{"line":121,"column":5}},{"start":{"line":119,"column":11},"end":{"line":121,"column":5}}],"line":117},"10":{"loc":{"start":{"line":124,"column":4},"end":{"line":124,"column":30}},"type":"if","locations":[{"start":{"line":124,"column":4},"end":{"line":124,"column":30}},{"start":{},"end":{}}],"line":124},"11":{"loc":{"start":{"line":152,"column":4},"end":{"line":156,"column":5}},"type":"if","locations":[{"start":{"line":152,"column":4},"end":{"line":156,"column":5}},{"start":{"line":154,"column":11},"end":{"line":156,"column":5}}],"line":152},"12":{"loc":{"start":{"line":159,"column":4},"end":{"line":159,"column":30}},"type":"if","locations":[{"start":{"line":159,"column":4},"end":{"line":159,"column":30}},{"start":{},"end":{}}],"line":159},"13":{"loc":{"start":{"line":190,"column":4},"end":{"line":194,"column":5}},"type":"if","locations":[{"start":{"line":190,"column":4},"end":{"line":194,"column":5}},{"start":{"line":192,"column":11},"end":{"line":194,"column":5}}],"line":190},"14":{"loc":{"start":{"line":197,"column":4},"end":{"line":197,"column":30}},"type":"if","locations":[{"start":{"line":197,"column":4},"end":{"line":197,"column":30}},{"start":{},"end":{}}],"line":197},"15":{"loc":{"start":{"line":199,"column":18},"end":{"line":199,"column":35}},"type":"binary-expr","locations":[{"start":{"line":199,"column":18},"end":{"line":199,"column":30}},{"start":{"line":199,"column":34},"end":{"line":199,"column":35}}],"line":199},"16":{"loc":{"start":{"line":229,"column":4},"end":{"line":233,"column":5}},"type":"if","locations":[{"start":{"line":229,"column":4},"end":{"line":233,"column":5}},{"start":{"line":231,"column":11},"end":{"line":233,"column":5}}],"line":229},"17":{"loc":{"start":{"line":236,"column":4},"end":{"line":236,"column":30}},"type":"if","locations":[{"start":{"line":236,"column":4},"end":{"line":236,"column":30}},{"start":{},"end":{}}],"line":236},"18":{"loc":{"start":{"line":238,"column":18},"end":{"line":238,"column":35}},"type":"binary-expr","locations":[{"start":{"line":238,"column":18},"end":{"line":238,"column":30}},{"start":{"line":238,"column":34},"end":{"line":238,"column":35}}],"line":238},"19":{"loc":{"start":{"line":272,"column":4},"end":{"line":274,"column":5}},"type":"if","locations":[{"start":{"line":272,"column":4},"end":{"line":274,"column":5}},{"start":{},"end":{}}],"line":272},"20":{"loc":{"start":{"line":297,"column":22},"end":{"line":297,"column":82}},"type":"cond-expr","locations":[{"start":{"line":297,"column":53},"end":{"line":297,"column":64}},{"start":{"line":297,"column":67},"end":{"line":297,"column":82}}],"line":297},"21":{"loc":{"start":{"line":314,"column":4},"end":{"line":323,"column":5}},"type":"if","locations":[{"start":{"line":314,"column":4},"end":{"line":323,"column":5}},{"start":{},"end":{}}],"line":314},"22":{"loc":{"start":{"line":328,"column":21},"end":{"line":328,"column":47}},"type":"binary-expr","locations":[{"start":{"line":328,"column":21},"end":{"line":328,"column":41}},{"start":{"line":328,"column":45},"end":{"line":328,"column":47}}],"line":328},"23":{"loc":{"start":{"line":329,"column":18},"end":{"line":329,"column":41}},"type":"binary-expr","locations":[{"start":{"line":329,"column":18},"end":{"line":329,"column":35}},{"start":{"line":329,"column":39},"end":{"line":329,"column":41}}],"line":329},"24":{"loc":{"start":{"line":331,"column":21},"end":{"line":331,"column":47}},"type":"binary-expr","locations":[{"start":{"line":331,"column":21},"end":{"line":331,"column":41}},{"start":{"line":331,"column":45},"end":{"line":331,"column":47}}],"line":331},"25":{"loc":{"start":{"line":332,"column":18},"end":{"line":332,"column":41}},"type":"binary-expr","locations":[{"start":{"line":332,"column":18},"end":{"line":332,"column":35}},{"start":{"line":332,"column":39},"end":{"line":332,"column":41}}],"line":332},"26":{"loc":{"start":{"line":334,"column":4},"end":{"line":341,"column":5}},"type":"if","locations":[{"start":{"line":334,"column":4},"end":{"line":341,"column":5}},{"start":{},"end":{}}],"line":334},"27":{"loc":{"start":{"line":352,"column":4},"end":{"line":356,"column":5}},"type":"if","locations":[{"start":{"line":352,"column":4},"end":{"line":356,"column":5}},{"start":{"line":354,"column":11},"end":{"line":356,"column":5}}],"line":352},"28":{"loc":{"start":{"line":359,"column":4},"end":{"line":359,"column":30}},"type":"if","locations":[{"start":{"line":359,"column":4},"end":{"line":359,"column":30}},{"start":{},"end":{}}],"line":359},"29":{"loc":{"start":{"line":388,"column":4},"end":{"line":392,"column":5}},"type":"if","locations":[{"start":{"line":388,"column":4},"end":{"line":392,"column":5}},{"start":{"line":390,"column":11},"end":{"line":392,"column":5}}],"line":388},"30":{"loc":{"start":{"line":395,"column":4},"end":{"line":395,"column":30}},"type":"if","locations":[{"start":{"line":395,"column":4},"end":{"line":395,"column":30}},{"start":{},"end":{}}],"line":395},"31":{"loc":{"start":{"line":425,"column":4},"end":{"line":429,"column":5}},"type":"if","locations":[{"start":{"line":425,"column":4},"end":{"line":429,"column":5}},{"start":{"line":427,"column":11},"end":{"line":429,"column":5}}],"line":425},"32":{"loc":{"start":{"line":432,"column":4},"end":{"line":432,"column":30}},"type":"if","locations":[{"start":{"line":432,"column":4},"end":{"line":432,"column":30}},{"start":{},"end":{}}],"line":432},"33":{"loc":{"start":{"line":434,"column":18},"end":{"line":434,"column":35}},"type":"binary-expr","locations":[{"start":{"line":434,"column":18},"end":{"line":434,"column":30}},{"start":{"line":434,"column":34},"end":{"line":434,"column":35}}],"line":434},"34":{"loc":{"start":{"line":463,"column":4},"end":{"line":467,"column":5}},"type":"if","locations":[{"start":{"line":463,"column":4},"end":{"line":467,"column":5}},{"start":{"line":465,"column":11},"end":{"line":467,"column":5}}],"line":463},"35":{"loc":{"start":{"line":470,"column":4},"end":{"line":470,"column":30}},"type":"if","locations":[{"start":{"line":470,"column":4},"end":{"line":470,"column":30}},{"start":{},"end":{}}],"line":470},"36":{"loc":{"start":{"line":472,"column":18},"end":{"line":472,"column":35}},"type":"binary-expr","locations":[{"start":{"line":472,"column":18},"end":{"line":472,"column":30}},{"start":{"line":472,"column":34},"end":{"line":472,"column":35}}],"line":472}},"s":{"0":1,"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":1,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":1,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":1,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":1,"117":1,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":1,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":1,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":1,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":1,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":1,"208":0,"209":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"216":0,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"223":0,"224":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/insert-row-col.command.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICellData, ICommand, IMutationInfo, IObjectMatrixPrimitiveType, IRange } from '@univerjs/core';\nimport type {\n    IInsertColMutationParams,\n    IInsertRowMutationParams,\n    IRemoveColMutationParams,\n    IRemoveRowsMutationParams,\n} from '../../basics/interfaces/mutation-interface';\n\nimport {\n    BooleanNumber,\n    CommandType,\n    Direction,\n    ICommandService,\n    IUndoRedoService,\n    IUniverInstanceService,\n    RANGE_TYPE,\n    sequenceExecute,\n} from '@univerjs/core';\nimport { SheetsSelectionsService } from '../../services/selections/selection.service';\nimport { SheetInterceptorService } from '../../services/sheet-interceptor/sheet-interceptor.service';\nimport {\n    InsertColMutation,\n    InsertColMutationUndoFactory,\n    InsertRowMutation,\n    InsertRowMutationUndoFactory,\n} from '../mutations/insert-row-col.mutation';\nimport { RemoveColMutation, RemoveRowMutation } from '../mutations/remove-row-col.mutation';\nimport { SetRangeValuesMutation } from '../mutations/set-range-values.mutation';\nimport { copyRangeStyles, followSelectionOperation } from './utils/selection-utils';\nimport { getSheetCommandTarget } from './utils/target-util';\n\nexport interface IInsertRowCommandParams {\n    unitId: string;\n    subUnitId: string;\n\n    /**\n     * whether it is inserting row after (DOWN) or inserting before (UP)\n     *\n     * this determines styles of the cells in the inserted rows\n     */\n    direction: Direction.UP | Direction.DOWN;\n    /**\n     * The range will the row be inserted.\n     */\n    range: IRange;\n    cellValue?: IObjectMatrixPrimitiveType<ICellData>;\n}\nexport const InsertRowCommandId = 'sheet.command.insert-row';\n\n/**\n * this command and its interface should not be exported from index.ts\n *\n * @internal\n */\nexport const InsertRowCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: InsertRowCommandId,\n    handler: async (accessor: IAccessor, params: IInsertRowCommandParams) => {\n        const commandService = accessor.get(ICommandService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n\n        const { range, direction, unitId, subUnitId, cellValue } = params;\n        const canPerform = await sheetInterceptorService.beforeCommandExecute({\n            id: InsertRowCommand.id,\n            params,\n        });\n\n        if (!canPerform) {\n            return false;\n        }\n\n        return commandService.syncExecuteCommand(InsertRowByRangeCommand.id, {\n            range,\n            direction,\n            unitId,\n            subUnitId,\n            cellValue,\n        });\n    },\n};\n\nexport const InsertRowByRangeCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.insert-row-by-range',\n    handler: (accessor: IAccessor, params: IInsertRowCommandParams) => {\n        const commandService = accessor.get(ICommandService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n\n        const target = getSheetCommandTarget(univerInstanceService, params);\n        if (!target) return false;\n\n        const { workbook, worksheet } = target;\n        const { range, direction, unitId, subUnitId, cellValue } = params;\n        const { startRow, endRow } = range;\n        range.rangeType = RANGE_TYPE.ROW;\n\n        const anchorRow = direction === Direction.UP ? startRow : startRow - 1;\n        const height = worksheet.getRowHeight(anchorRow);\n\n        // insert row properties & undos\n        const insertRowParams: IInsertRowMutationParams = {\n            unitId,\n            subUnitId,\n            range,\n            rowInfo: new Array(endRow - startRow + 1).fill(undefined).map(() => ({\n                h: height,\n                hd: BooleanNumber.FALSE,\n            })), // row height should inherit from the anchor row\n        };\n        const undoRowInsertionParams: IRemoveRowsMutationParams = InsertRowMutationUndoFactory(\n            accessor,\n            insertRowParams\n        );\n\n        const redos: IMutationInfo[] = [{ id: InsertRowMutation.id, params: insertRowParams }];\n        const undos: IMutationInfo[] = [{ id: RemoveRowMutation.id, params: undoRowInsertionParams }];\n\n        // set range values\n        if (cellValue) {\n            redos.push({\n                id: SetRangeValuesMutation.id,\n                params: {\n                    unitId,\n                    subUnitId,\n                    cellValue,\n                },\n            });\n        }\n\n        const intercepted = sheetInterceptorService.onCommandExecute({\n            id: InsertRowCommand.id,\n            params,\n        });\n\n        redos.unshift(...(intercepted.preRedos ?? []));\n        redos.push(...(intercepted.redos ?? []));\n        redos.push(followSelectionOperation(range, workbook, worksheet));\n        undos.unshift(...(intercepted.preUndos ?? []));\n        undos.push(...(intercepted.undos ?? []));\n\n        const result = sequenceExecute(redos, commandService);\n\n        if (result.result) {\n            undoRedoService.pushUndoRedo({\n                unitID: params.unitId,\n                undoMutations: undos,\n                redoMutations: redos,\n            });\n\n            return true;\n        }\n\n        return false;\n    },\n};\n\nexport const InsertRowBeforeCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.insert-row-before',\n    handler: async (accessor: IAccessor) => {\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const selections = selectionManagerService.getCurrentSelections()?.map((s) => s.range);\n        let range: IRange;\n\n        if (selections?.length === 1) {\n            range = selections[0];\n        } else {\n            // if there are multi selections, we can't decide which row to insert\n            // in fact, UI would hides / disables the insert row button\n            return false;\n        }\n\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet, subUnitId, unitId } = target;\n        const { startRow, endRow } = range;\n        const startColumn = 0;\n        const endColumn = worksheet.getColumnCount() - 1;\n        const insertRowParams: IInsertRowCommandParams = {\n            unitId,\n            subUnitId,\n            direction: Direction.UP,\n            range: {\n                startRow,\n                endRow,\n                startColumn,\n                endColumn,\n            },\n            // copy styles from the row above\n            cellValue: copyRangeStyles(worksheet, startRow, endRow, startColumn, endColumn, true, startRow - 1),\n        };\n\n        return accessor.get(ICommandService).executeCommand(InsertRowCommand.id, insertRowParams);\n    },\n};\n\nexport const InsertRowAfterCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.insert-row-after',\n    handler: async (accessor: IAccessor) => {\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const selections = selectionManagerService.getCurrentSelections()?.map((s) => s.range);\n        let range: IRange;\n\n        if (selections?.length === 1) {\n            range = selections[0];\n        } else {\n            // if there are multi selections, we can't decide which row to insert\n            // in fact, UI would hides / disables the insert row button\n            return false;\n        }\n\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet, unitId, subUnitId } = target;\n        const count = range.endRow - range.startRow + 1;\n\n        const startRow = range.endRow + 1;\n        const endRow = range.endRow + count;\n        const startColumn = 0;\n        const endColumn = worksheet.getColumnCount() - 1;\n\n        const insertRowParams: IInsertRowCommandParams = {\n            unitId,\n            subUnitId,\n            direction: Direction.DOWN,\n            range: {\n                startRow,\n                endRow,\n                startColumn,\n                endColumn,\n                rangeType: RANGE_TYPE.ROW,\n            },\n            // copy styles from the row below\n            cellValue: copyRangeStyles(worksheet, startRow, endRow, startColumn, endColumn, true, range.endRow),\n        };\n\n        return accessor.get(ICommandService).executeCommand(InsertRowCommand.id, insertRowParams);\n    },\n};\n\nexport interface IInsertMultiRowsCommandParams {\n    value: number;\n}\n\nexport const InsertMultiRowsAboveCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.insert-multi-rows-above',\n    handler: async (accessor: IAccessor, params: IInsertMultiRowsCommandParams) => {\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const selections = selectionManagerService.getCurrentSelections()?.map((s) => s.range);\n        let range: IRange;\n\n        if (selections?.length === 1) {\n            range = selections[0];\n        } else {\n            // if there are multi selections, we can't decide which row to insert\n            // in fact, UI would hides / disables the insert row button\n            return false;\n        }\n\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet, unitId, subUnitId } = target;\n        const count = params.value || 0;\n\n        const startRow = range.startRow;\n        const endRow = range.startRow + count - 1;\n        const startColumn = 0;\n        const endColumn = worksheet.getColumnCount() - 1;\n        const copiedStyle = copyRangeStyles(worksheet, startRow, endRow, startColumn, endColumn, true, startRow - 1);\n        const insertRowParams: IInsertRowCommandParams = {\n            unitId,\n            subUnitId,\n            direction: Direction.UP,\n            range: {\n                startRow,\n                endRow,\n                startColumn,\n                endColumn,\n                rangeType: RANGE_TYPE.ROW,\n            },\n            // copy styles from the row above\n            cellValue: copiedStyle,\n        };\n\n        return accessor.get(ICommandService).executeCommand(InsertRowCommand.id, insertRowParams);\n    },\n};\n\nexport const InsertMultiRowsAfterCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.insert-multi-rows-after',\n    handler: async (accessor: IAccessor, params: IInsertMultiRowsCommandParams) => {\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const selections = selectionManagerService.getCurrentSelections()?.map((s) => s.range);\n        let range: IRange;\n\n        if (selections?.length === 1) {\n            range = selections[0];\n        } else {\n            // if there are multi selections, we can't decide which row to insert\n            // in fact, UI would hides / disables the insert row button\n            return false;\n        }\n\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet, unitId, subUnitId } = target;\n        const count = params.value || 0;\n\n        const startRow = range.endRow + 1;\n        const endRow = range.endRow + count;\n        const startColumn = 0;\n        const endColumn = worksheet.getColumnCount() - 1;\n\n        const insertRowParams: IInsertRowCommandParams = {\n            unitId,\n            subUnitId,\n            direction: Direction.DOWN,\n            range: {\n                startRow,\n                endRow,\n                startColumn,\n                endColumn,\n                rangeType: RANGE_TYPE.ROW,\n            },\n            // copy styles from the row below\n            cellValue: copyRangeStyles(worksheet, startRow, endRow, startColumn, endColumn, true, range.endRow),\n        };\n\n        return accessor.get(ICommandService).executeCommand(InsertRowCommand.id, insertRowParams);\n    },\n};\n\nexport interface IInsertColCommandParams {\n    unitId: string;\n    subUnitId: string;\n    range: IRange;\n    direction: Direction.LEFT | Direction.RIGHT;\n    cellValue?: IObjectMatrixPrimitiveType<ICellData>;\n}\nexport const InsertColCommandId = 'sheet.command.insert-col';\nexport const InsertColCommand: ICommand<IInsertColCommandParams> = {\n    type: CommandType.COMMAND,\n    id: InsertColCommandId,\n\n    handler: async (accessor: IAccessor, params: IInsertColCommandParams) => {\n        const commandService = accessor.get(ICommandService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n\n        const { range, direction, subUnitId, unitId, cellValue } = params;\n        const canPerform = await sheetInterceptorService.beforeCommandExecute({\n            id: InsertColCommand.id,\n            params,\n        });\n\n        if (!canPerform) {\n            return false;\n        }\n\n        return commandService.syncExecuteCommand(InsertColByRangeCommand.id, {\n            range,\n            direction,\n            unitId,\n            subUnitId,\n            cellValue,\n        });\n    },\n};\n\nexport const InsertColByRangeCommand: ICommand<IInsertColCommandParams> = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.insert-col-by-range',\n\n    handler: (accessor: IAccessor, params: IInsertColCommandParams) => {\n        const commandService = accessor.get(ICommandService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n\n        const { range, direction, subUnitId, unitId, cellValue } = params;\n        const { startColumn, endColumn } = params.range;\n        range.rangeType = RANGE_TYPE.COLUMN;\n\n        const workbook = univerInstanceService.getUniverSheetInstance(params.unitId)!;\n        const worksheet = workbook.getSheetBySheetId(params.subUnitId)!;\n        const anchorCol = direction === Direction.LEFT ? startColumn : startColumn - 1;\n        const width = worksheet.getColumnWidth(anchorCol);\n\n        // insert cols & undos\n        const insertColParams: IInsertColMutationParams = {\n            unitId,\n            subUnitId,\n            range,\n            colInfo: new Array(endColumn - startColumn + 1).fill(undefined).map(() => ({\n                w: width,\n                hd: BooleanNumber.FALSE,\n            })),\n        };\n\n        const undoColInsertionParams: IRemoveColMutationParams = InsertColMutationUndoFactory(\n            accessor,\n            insertColParams\n        );\n\n        const redos: IMutationInfo[] = [{ id: InsertColMutation.id, params: insertColParams }];\n        const undos: IMutationInfo[] = [{ id: RemoveColMutation.id, params: undoColInsertionParams }];\n\n        // set range values\n        if (cellValue) {\n            redos.push({\n                id: SetRangeValuesMutation.id,\n                params: {\n                    unitId,\n                    subUnitId,\n                    cellValue,\n                },\n            });\n        }\n\n        const intercepted = sheetInterceptorService.onCommandExecute({\n            id: InsertColCommand.id,\n            params,\n        });\n\n        redos.unshift(...(intercepted.preRedos ?? []));\n        redos.push(...(intercepted.redos ?? []));\n        redos.push(followSelectionOperation(range, workbook, worksheet));\n        undos.unshift(...(intercepted.preUndos ?? []));\n        undos.push(...(intercepted.undos ?? []));\n\n        const result = sequenceExecute(redos, commandService);\n\n        if (result.result) {\n            undoRedoService.pushUndoRedo({\n                unitID: params.unitId,\n                undoMutations: undos.filter(Boolean),\n                redoMutations: redos.filter(Boolean),\n            });\n            return true;\n        }\n\n        return false;\n    },\n};\n\nexport const InsertColBeforeCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.insert-col-before',\n    handler: async (accessor: IAccessor) => {\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const selections = selectionManagerService.getCurrentSelections();\n        let range: IRange;\n\n        if (selections?.length === 1) {\n            range = selections[0].range;\n        } else {\n            return false;\n        }\n\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet, unitId, subUnitId } = target;\n\n        const { startColumn, endColumn } = range;\n        const startRow = 0;\n        const endRow = worksheet.getRowCount() - 1;\n\n        const insertColParams: IInsertColCommandParams = {\n            unitId,\n            subUnitId,\n            direction: Direction.LEFT,\n            range: {\n                startColumn,\n                endColumn,\n                startRow,\n                endRow,\n                rangeType: RANGE_TYPE.COLUMN,\n            },\n\n            // copy styles from the column before\n            cellValue: copyRangeStyles(worksheet, startRow, endRow, startColumn, endColumn, false, startColumn - 1),\n        };\n\n        return accessor.get(ICommandService).executeCommand(InsertColCommand.id, insertColParams);\n    },\n};\n\nexport const InsertColAfterCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.insert-col-after',\n    handler: async (accessor: IAccessor) => {\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const selections = selectionManagerService.getCurrentSelections();\n        let range: IRange;\n\n        if (selections?.length === 1) {\n            range = selections[0].range;\n        } else {\n            return false;\n        }\n\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet, unitId, subUnitId } = target;\n        const count = range.endColumn - range.startColumn + 1;\n\n        const startColumn = range.endColumn + 1;\n        const endColumn = range.endColumn + count;\n        const startRow = 0;\n        const endRow = worksheet.getRowCount() - 1;\n\n        const insertColParams: IInsertColCommandParams = {\n            unitId,\n            subUnitId,\n            direction: Direction.RIGHT,\n            range: {\n                startColumn,\n                endColumn,\n                startRow,\n                endRow,\n            },\n            // copy styles from the column after\n            cellValue: copyRangeStyles(worksheet, startRow, endRow, startColumn, endColumn, false, range.endColumn),\n        };\n\n        return accessor.get(ICommandService).executeCommand(InsertColCommand.id, insertColParams);\n    },\n};\n\nexport interface IInsertMultiColsCommandParams {\n    value: number;\n}\n\nexport const InsertMultiColsLeftCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.insert-multi-cols-before',\n    handler: async (accessor: IAccessor, params: IInsertMultiRowsCommandParams) => {\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const selections = selectionManagerService.getCurrentSelections();\n        let range: IRange;\n\n        if (selections?.length === 1) {\n            range = selections[0].range;\n        } else {\n            return false;\n        }\n\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet, unitId, subUnitId } = target;\n        const count = params.value || 0;\n        const startColumn = range.startColumn;\n        const endColumn = range.startColumn + count - 1;\n        const startRow = 0;\n        const endRow = worksheet.getRowCount() - 1;\n\n        const insertColParams: IInsertColCommandParams = {\n            unitId,\n            subUnitId,\n            direction: Direction.LEFT,\n            range: {\n                startColumn,\n                endColumn,\n                startRow,\n                endRow,\n                rangeType: RANGE_TYPE.COLUMN,\n            },\n\n            // copy styles from the column before\n            cellValue: copyRangeStyles(worksheet, startRow, endRow, startColumn, endColumn, false, startColumn - 1),\n        };\n\n        return accessor.get(ICommandService).executeCommand(InsertColCommand.id, insertColParams);\n    },\n};\n\nexport const InsertMultiColsRightCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.insert-multi-cols-right',\n    handler: async (accessor: IAccessor, params: IInsertMultiRowsCommandParams) => {\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const selections = selectionManagerService.getCurrentSelections();\n        let range: IRange;\n\n        if (selections?.length === 1) {\n            range = selections[0].range;\n        } else {\n            return false;\n        }\n\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet, unitId, subUnitId } = target;\n        const count = params.value || 0;\n\n        const startColumn = range.endColumn + 1;\n        const endColumn = range.endColumn + count;\n        const startRow = 0;\n        const endRow = worksheet.getRowCount() - 1;\n\n        const insertColParams: IInsertColCommandParams = {\n            unitId,\n            subUnitId,\n            direction: Direction.RIGHT,\n            range: {\n                startColumn,\n                endColumn,\n                startRow,\n                endRow,\n            },\n            // copy styles from the column after\n            cellValue: copyRangeStyles(worksheet, startRow, endRow, startColumn, endColumn, false, range.endColumn),\n        };\n\n        return accessor.get(ICommandService).executeCommand(InsertColCommand.id, insertColParams);\n    },\n};\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"fae734e95d6f7c09ee0bea1651152503c479b69f"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/remove-row-col.command.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/remove-row-col.command.ts","statementMap":{"0":{"start":{"line":21,"column":34},"end":{"line":21,"column":60}},"1":{"start":{"line":22,"column":39},"end":{"line":84,"column":1}},"2":{"start":{"line":26,"column":4},"end":{"line":28,"column":5}},"3":{"start":{"line":27,"column":6},"end":{"line":27,"column":19}},"4":{"start":{"line":29,"column":34},"end":{"line":29,"column":70}},"5":{"start":{"line":30,"column":19},"end":{"line":30,"column":71}},"6":{"start":{"line":31,"column":4},"end":{"line":31,"column":30}},"7":{"start":{"line":31,"column":17},"end":{"line":31,"column":30}},"8":{"start":{"line":32,"column":36},"end":{"line":32,"column":42}},"9":{"start":{"line":33,"column":36},"end":{"line":33,"column":73}},"10":{"start":{"line":34,"column":41},"end":{"line":34,"column":47}},"11":{"start":{"line":35,"column":26},"end":{"line":35,"column":90}},"12":{"start":{"line":36,"column":26},"end":{"line":36,"column":28}},"13":{"start":{"line":37,"column":26},"end":{"line":37,"column":28}},"14":{"start":{"line":38,"column":4},"end":{"line":69,"column":7}},"15":{"start":{"line":39,"column":20},"end":{"line":39,"column":22}},"16":{"start":{"line":40,"column":20},"end":{"line":40,"column":22}},"17":{"start":{"line":41,"column":31},"end":{"line":45,"column":7}},"18":{"start":{"line":46,"column":35},"end":{"line":49,"column":7}},"19":{"start":{"line":50,"column":26},"end":{"line":50,"column":139}},"20":{"start":{"line":51,"column":39},"end":{"line":55,"column":7}},"21":{"start":{"line":56,"column":26},"end":{"line":59,"column":8}},"22":{"start":{"line":60,"column":6},"end":{"line":60,"column":48}},"23":{"start":{"line":61,"column":6},"end":{"line":61,"column":73}},"24":{"start":{"line":62,"column":6},"end":{"line":62,"column":45}},"25":{"start":{"line":63,"column":6},"end":{"line":63,"column":48}},"26":{"start":{"line":64,"column":6},"end":{"line":64,"column":77}},"27":{"start":{"line":65,"column":6},"end":{"line":65,"column":86}},"28":{"start":{"line":66,"column":6},"end":{"line":66,"column":45}},"29":{"start":{"line":67,"column":6},"end":{"line":67,"column":35}},"30":{"start":{"line":68,"column":6},"end":{"line":68,"column":38}},"31":{"start":{"line":70,"column":4},"end":{"line":70,"column":77}},"32":{"start":{"line":71,"column":27},"end":{"line":71,"column":56}},"33":{"start":{"line":72,"column":19},"end":{"line":72,"column":65}},"34":{"start":{"line":73,"column":4},"end":{"line":81,"column":5}},"35":{"start":{"line":74,"column":30},"end":{"line":74,"column":60}},"36":{"start":{"line":75,"column":6},"end":{"line":79,"column":9}},"37":{"start":{"line":80,"column":6},"end":{"line":80,"column":18}},"38":{"start":{"line":82,"column":4},"end":{"line":82,"column":17}},"39":{"start":{"line":85,"column":32},"end":{"line":117,"column":1}},"40":{"start":{"line":89,"column":36},"end":{"line":89,"column":73}},"41":{"start":{"line":90,"column":36},"end":{"line":90,"column":73}},"42":{"start":{"line":91,"column":27},"end":{"line":91,"column":56}},"43":{"start":{"line":92,"column":16},"end":{"line":92,"column":29}},"44":{"start":{"line":93,"column":4},"end":{"line":93,"column":81}},"45":{"start":{"line":93,"column":16},"end":{"line":93,"column":81}},"46":{"start":{"line":94,"column":4},"end":{"line":94,"column":29}},"47":{"start":{"line":94,"column":16},"end":{"line":94,"column":29}},"48":{"start":{"line":95,"column":34},"end":{"line":95,"column":70}},"49":{"start":{"line":96,"column":19},"end":{"line":96,"column":63}},"50":{"start":{"line":97,"column":4},"end":{"line":97,"column":30}},"51":{"start":{"line":97,"column":17},"end":{"line":97,"column":30}},"52":{"start":{"line":98,"column":45},"end":{"line":98,"column":51}},"53":{"start":{"line":99,"column":4},"end":{"line":103,"column":6}},"54":{"start":{"line":104,"column":23},"end":{"line":107,"column":6}},"55":{"start":{"line":108,"column":4},"end":{"line":110,"column":5}},"56":{"start":{"line":109,"column":6},"end":{"line":109,"column":19}},"57":{"start":{"line":111,"column":4},"end":{"line":115,"column":7}},"58":{"start":{"line":118,"column":34},"end":{"line":118,"column":60}},"59":{"start":{"line":119,"column":39},"end":{"line":178,"column":1}},"60":{"start":{"line":123,"column":4},"end":{"line":125,"column":5}},"61":{"start":{"line":124,"column":6},"end":{"line":124,"column":19}},"62":{"start":{"line":126,"column":34},"end":{"line":126,"column":70}},"63":{"start":{"line":127,"column":19},"end":{"line":127,"column":71}},"64":{"start":{"line":128,"column":4},"end":{"line":128,"column":30}},"65":{"start":{"line":128,"column":17},"end":{"line":128,"column":30}},"66":{"start":{"line":129,"column":36},"end":{"line":129,"column":42}},"67":{"start":{"line":130,"column":36},"end":{"line":130,"column":73}},"68":{"start":{"line":131,"column":41},"end":{"line":131,"column":47}},"69":{"start":{"line":132,"column":28},"end":{"line":136,"column":5}},"70":{"start":{"line":137,"column":32},"end":{"line":137,"column":83}},"71":{"start":{"line":138,"column":24},"end":{"line":138,"column":126}},"72":{"start":{"line":139,"column":37},"end":{"line":143,"column":5}},"73":{"start":{"line":144,"column":24},"end":{"line":147,"column":6}},"74":{"start":{"line":148,"column":27},"end":{"line":148,"column":56}},"75":{"start":{"line":149,"column":19},"end":{"line":157,"column":5}},"76":{"start":{"line":158,"column":4},"end":{"line":175,"column":5}},"77":{"start":{"line":159,"column":30},"end":{"line":159,"column":60}},"78":{"start":{"line":160,"column":6},"end":{"line":173,"column":9}},"79":{"start":{"line":174,"column":6},"end":{"line":174,"column":18}},"80":{"start":{"line":176,"column":4},"end":{"line":176,"column":17}},"81":{"start":{"line":179,"column":32},"end":{"line":211,"column":1}},"82":{"start":{"line":183,"column":36},"end":{"line":183,"column":73}},"83":{"start":{"line":184,"column":36},"end":{"line":184,"column":73}},"84":{"start":{"line":185,"column":27},"end":{"line":185,"column":56}},"85":{"start":{"line":186,"column":16},"end":{"line":186,"column":29}},"86":{"start":{"line":187,"column":4},"end":{"line":187,"column":81}},"87":{"start":{"line":187,"column":16},"end":{"line":187,"column":81}},"88":{"start":{"line":188,"column":4},"end":{"line":188,"column":29}},"89":{"start":{"line":188,"column":16},"end":{"line":188,"column":29}},"90":{"start":{"line":189,"column":34},"end":{"line":189,"column":70}},"91":{"start":{"line":190,"column":19},"end":{"line":190,"column":63}},"92":{"start":{"line":191,"column":4},"end":{"line":191,"column":30}},"93":{"start":{"line":191,"column":17},"end":{"line":191,"column":30}},"94":{"start":{"line":192,"column":45},"end":{"line":192,"column":51}},"95":{"start":{"line":193,"column":4},"end":{"line":197,"column":6}},"96":{"start":{"line":198,"column":23},"end":{"line":201,"column":6}},"97":{"start":{"line":202,"column":4},"end":{"line":204,"column":5}},"98":{"start":{"line":203,"column":6},"end":{"line":203,"column":19}},"99":{"start":{"line":205,"column":4},"end":{"line":209,"column":7}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":25,"column":11},"end":{"line":25,"column":12}},"loc":{"start":{"line":25,"column":33},"end":{"line":83,"column":3}},"line":25},"1":{"name":"(anonymous_1)","decl":{"start":{"line":38,"column":26},"end":{"line":38,"column":27}},"loc":{"start":{"line":38,"column":44},"end":{"line":69,"column":5}},"line":38},"2":{"name":"(anonymous_2)","decl":{"start":{"line":88,"column":11},"end":{"line":88,"column":12}},"loc":{"start":{"line":88,"column":39},"end":{"line":116,"column":3}},"line":88},"3":{"name":"(anonymous_3)","decl":{"start":{"line":122,"column":11},"end":{"line":122,"column":12}},"loc":{"start":{"line":122,"column":33},"end":{"line":177,"column":3}},"line":122},"4":{"name":"(anonymous_4)","decl":{"start":{"line":182,"column":11},"end":{"line":182,"column":12}},"loc":{"start":{"line":182,"column":39},"end":{"line":210,"column":3}},"line":182}},"branchMap":{"0":{"loc":{"start":{"line":26,"column":4},"end":{"line":28,"column":5}},"type":"if","locations":[{"start":{"line":26,"column":4},"end":{"line":28,"column":5}},{"start":{},"end":{}}],"line":26},"1":{"loc":{"start":{"line":31,"column":4},"end":{"line":31,"column":30}},"type":"if","locations":[{"start":{"line":31,"column":4},"end":{"line":31,"column":30}},{"start":{},"end":{}}],"line":31},"2":{"loc":{"start":{"line":60,"column":20},"end":{"line":60,"column":46}},"type":"binary-expr","locations":[{"start":{"line":60,"column":20},"end":{"line":60,"column":40}},{"start":{"line":60,"column":44},"end":{"line":60,"column":46}}],"line":60},"3":{"loc":{"start":{"line":62,"column":20},"end":{"line":62,"column":43}},"type":"binary-expr","locations":[{"start":{"line":62,"column":20},"end":{"line":62,"column":37}},{"start":{"line":62,"column":41},"end":{"line":62,"column":43}}],"line":62},"4":{"loc":{"start":{"line":63,"column":20},"end":{"line":63,"column":46}},"type":"binary-expr","locations":[{"start":{"line":63,"column":20},"end":{"line":63,"column":40}},{"start":{"line":63,"column":44},"end":{"line":63,"column":46}}],"line":63},"5":{"loc":{"start":{"line":66,"column":20},"end":{"line":66,"column":43}},"type":"binary-expr","locations":[{"start":{"line":66,"column":20},"end":{"line":66,"column":37}},{"start":{"line":66,"column":41},"end":{"line":66,"column":43}}],"line":66},"6":{"loc":{"start":{"line":73,"column":4},"end":{"line":81,"column":5}},"type":"if","locations":[{"start":{"line":73,"column":4},"end":{"line":81,"column":5}},{"start":{},"end":{}}],"line":73},"7":{"loc":{"start":{"line":93,"column":4},"end":{"line":93,"column":81}},"type":"if","locations":[{"start":{"line":93,"column":4},"end":{"line":93,"column":81}},{"start":{},"end":{}}],"line":93},"8":{"loc":{"start":{"line":94,"column":4},"end":{"line":94,"column":29}},"type":"if","locations":[{"start":{"line":94,"column":4},"end":{"line":94,"column":29}},{"start":{},"end":{}}],"line":94},"9":{"loc":{"start":{"line":97,"column":4},"end":{"line":97,"column":30}},"type":"if","locations":[{"start":{"line":97,"column":4},"end":{"line":97,"column":30}},{"start":{},"end":{}}],"line":97},"10":{"loc":{"start":{"line":108,"column":4},"end":{"line":110,"column":5}},"type":"if","locations":[{"start":{"line":108,"column":4},"end":{"line":110,"column":5}},{"start":{},"end":{}}],"line":108},"11":{"loc":{"start":{"line":123,"column":4},"end":{"line":125,"column":5}},"type":"if","locations":[{"start":{"line":123,"column":4},"end":{"line":125,"column":5}},{"start":{},"end":{}}],"line":123},"12":{"loc":{"start":{"line":128,"column":4},"end":{"line":128,"column":30}},"type":"if","locations":[{"start":{"line":128,"column":4},"end":{"line":128,"column":30}},{"start":{},"end":{}}],"line":128},"13":{"loc":{"start":{"line":151,"column":11},"end":{"line":151,"column":37}},"type":"binary-expr","locations":[{"start":{"line":151,"column":11},"end":{"line":151,"column":31}},{"start":{"line":151,"column":35},"end":{"line":151,"column":37}}],"line":151},"14":{"loc":{"start":{"line":158,"column":4},"end":{"line":175,"column":5}},"type":"if","locations":[{"start":{"line":158,"column":4},"end":{"line":175,"column":5}},{"start":{},"end":{}}],"line":158},"15":{"loc":{"start":{"line":163,"column":13},"end":{"line":163,"column":39}},"type":"binary-expr","locations":[{"start":{"line":163,"column":13},"end":{"line":163,"column":33}},{"start":{"line":163,"column":37},"end":{"line":163,"column":39}}],"line":163},"16":{"loc":{"start":{"line":169,"column":13},"end":{"line":169,"column":39}},"type":"binary-expr","locations":[{"start":{"line":169,"column":13},"end":{"line":169,"column":33}},{"start":{"line":169,"column":37},"end":{"line":169,"column":39}}],"line":169},"17":{"loc":{"start":{"line":187,"column":4},"end":{"line":187,"column":81}},"type":"if","locations":[{"start":{"line":187,"column":4},"end":{"line":187,"column":81}},{"start":{},"end":{}}],"line":187},"18":{"loc":{"start":{"line":188,"column":4},"end":{"line":188,"column":29}},"type":"if","locations":[{"start":{"line":188,"column":4},"end":{"line":188,"column":29}},{"start":{},"end":{}}],"line":188},"19":{"loc":{"start":{"line":191,"column":4},"end":{"line":191,"column":30}},"type":"if","locations":[{"start":{"line":191,"column":4},"end":{"line":191,"column":30}},{"start":{},"end":{}}],"line":191},"20":{"loc":{"start":{"line":202,"column":4},"end":{"line":204,"column":5}},"type":"if","locations":[{"start":{"line":202,"column":4},"end":{"line":204,"column":5}},{"start":{},"end":{}}],"line":202}},"s":{"0":1,"1":1,"2":1,"3":0,"4":1,"5":1,"6":1,"7":0,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":0,"39":1,"40":1,"41":1,"42":1,"43":1,"44":1,"45":0,"46":1,"47":0,"48":1,"49":1,"50":1,"51":0,"52":1,"53":1,"54":1,"55":1,"56":0,"57":1,"58":1,"59":1,"60":1,"61":0,"62":1,"63":1,"64":1,"65":0,"66":1,"67":1,"68":1,"69":1,"70":1,"71":1,"72":1,"73":1,"74":1,"75":1,"76":1,"77":1,"78":1,"79":1,"80":0,"81":1,"82":1,"83":1,"84":1,"85":1,"86":1,"87":0,"88":1,"89":0,"90":1,"91":1,"92":1,"93":0,"94":1,"95":1,"96":1,"97":1,"98":0,"99":1},"f":{"0":1,"1":1,"2":1,"3":1,"4":1},"b":{"0":[0,1],"1":[0,1],"2":[1,0],"3":[1,0],"4":[1,0],"5":[1,0],"6":[1,0],"7":[0,1],"8":[0,1],"9":[0,1],"10":[0,1],"11":[0,1],"12":[0,1],"13":[1,0],"14":[1,0],"15":[1,0],"16":[1,0],"17":[0,1],"18":[0,1],"19":[0,1],"20":[0,1]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/remove-row-col.command.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand, IMutationInfo, IRange } from '@univerjs/core';\nimport type {\n    IInsertColMutationParams,\n    IInsertRowMutationParams,\n    IRemoveColMutationParams,\n    IRemoveRowsMutationParams,\n} from '../../basics/interfaces/mutation-interface';\n\nimport type { ISetRangeValuesMutationParams } from '../mutations/set-range-values.mutation';\nimport {\n    CommandType,\n    ICommandService,\n    IUndoRedoService,\n    IUniverInstanceService,\n    sequenceExecute,\n} from '@univerjs/core';\nimport { getVisibleRanges } from '../../basics/utils';\nimport { SheetsSelectionsService } from '../../services/selections/selection.service';\nimport { SheetInterceptorService } from '../../services/sheet-interceptor/sheet-interceptor.service';\nimport { InsertColMutation, InsertRowMutation } from '../mutations/insert-row-col.mutation';\nimport {\n    RemoveColMutation,\n    RemoveColMutationFactory,\n    RemoveRowMutation,\n    RemoveRowsUndoMutationFactory,\n} from '../mutations/remove-row-col.mutation';\nimport { SetRangeValuesMutation } from '../mutations/set-range-values.mutation';\nimport { followSelectionOperation } from './utils/selection-utils';\nimport { getSheetCommandTarget } from './utils/target-util';\n\nexport interface IRemoveRowColCommandParams {\n    range: IRange;\n}\n\nexport interface IRemoveRowColCommandInterceptParams extends IRemoveRowColCommandParams {\n    ranges?: IRange[];\n}\n\nexport interface IRemoveRowByRangeCommandParams {\n    range: IRange;\n    unitId: string;\n    subUnitId: string;\n}\n\nexport interface IRemoveColByRangeCommandParams {\n    range: IRange;\n    unitId: string;\n    subUnitId: string;\n}\n\nexport const RemoveRowCommandId = 'sheet.command.remove-row';\n\nexport const RemoveRowByRangeCommand: ICommand<IRemoveRowByRangeCommandParams> = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.remove-row-by-range',\n    handler: (accessor, params) => {\n        if (!params) {\n            return false;\n        }\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const target = getSheetCommandTarget(univerInstanceService, params);\n        if (!target) return false;\n\n        const { workbook, worksheet } = target;\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n        const { range, unitId, subUnitId } = params;\n\n        const visibleRanges = getVisibleRanges([range], accessor, unitId, subUnitId).reverse();\n\n        const undoMutations: IMutationInfo[] = [];\n        const redoMutations: IMutationInfo[] = [];\n\n        visibleRanges.forEach((visibleRange) => {\n            const undos: IMutationInfo[] = [];\n            const redos: IMutationInfo[] = [];\n            const removeRowsParams: IRemoveRowsMutationParams = {\n                unitId,\n                subUnitId,\n                range: visibleRange,\n            };\n            const undoRemoveRowsParams: IInsertRowMutationParams = RemoveRowsUndoMutationFactory(\n                removeRowsParams,\n                worksheet\n            );\n\n            const removedRows = worksheet.getCellMatrix().getSlice(visibleRange.startRow, visibleRange.endRow, 0, worksheet.getColumnCount() - 1);\n            const undoSetRangeValuesParams: ISetRangeValuesMutationParams = {\n                unitId,\n                subUnitId,\n                cellValue: removedRows.getMatrix(),\n            };\n\n            const intercepted = sheetInterceptorService.onCommandExecute({\n                id: RemoveRowCommandId,\n                params: { range: visibleRange } as IRemoveRowColCommandParams,\n            });\n\n            redos.push(...(intercepted.preRedos ?? []));\n            redos.push({ id: RemoveRowMutation.id, params: removeRowsParams });\n            redos.push(...(intercepted.redos ?? []));\n            undos.push(...(intercepted.preUndos ?? []));\n            undos.push({ id: InsertRowMutation.id, params: undoRemoveRowsParams });\n            undos.push({ id: SetRangeValuesMutation.id, params: undoSetRangeValuesParams });\n            undos.push(...(intercepted.undos ?? []));\n\n            redoMutations.push(...redos);\n            undoMutations.unshift(...undos);\n        });\n\n        redoMutations.push(followSelectionOperation(range, workbook, worksheet));\n\n        const commandService = accessor.get(ICommandService);\n        const result = sequenceExecute(redoMutations, commandService);\n        if (result.result) {\n            const undoRedoService = accessor.get(IUndoRedoService);\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations,\n                redoMutations,\n            });\n            return true;\n        }\n        return false;\n    },\n};\n\n/**\n * This command would remove the selected rows. These selected rows can be non-continuous.\n */\nexport const RemoveRowCommand: ICommand<IRemoveRowColCommandParams> = {\n    type: CommandType.COMMAND,\n\n    id: RemoveRowCommandId,\n\n    handler: async (accessor: IAccessor, params?: IRemoveRowColCommandParams) => {\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n        const commandService = accessor.get(ICommandService);\n        let range = params?.range;\n        if (!range) range = selectionManagerService.getCurrentLastSelection()?.range;\n        if (!range) return false;\n\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet, subUnitId, unitId } = target;\n\n        range = {\n            ...range,\n            startColumn: 0,\n            endColumn: Math.max(worksheet.getMaxColumns() - 1, 0),\n        };\n\n        const canPerform = await sheetInterceptorService.beforeCommandExecute({\n            id: RemoveRowCommand.id,\n            params: { range } as IRemoveRowColCommandParams,\n        });\n\n        if (!canPerform) {\n            return false;\n        }\n\n        return commandService.syncExecuteCommand(RemoveRowByRangeCommand.id, {\n            range,\n            unitId,\n            subUnitId,\n        });\n    },\n};\n\nexport const RemoveColCommandId = 'sheet.command.remove-col';\n\nexport const RemoveColByRangeCommand: ICommand<IRemoveColByRangeCommandParams> = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.remove-col-by-range',\n    handler: (accessor, parmas) => {\n        if (!parmas) {\n            return false;\n        }\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const target = getSheetCommandTarget(univerInstanceService, parmas);\n        if (!target) return false;\n\n        const { workbook, worksheet } = target;\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n        const { range, unitId, subUnitId } = parmas;\n        // col count\n        const removeColParams: IRemoveColMutationParams = {\n            unitId,\n            subUnitId,\n            range,\n        };\n        const undoRemoveColParams: IInsertColMutationParams = RemoveColMutationFactory(accessor, removeColParams);\n\n        const removedCols = worksheet.getCellMatrix().getSlice(0, worksheet.getRowCount() - 1, range.startColumn, range.endColumn);\n        const undoSetRangeValuesParams: ISetRangeValuesMutationParams = {\n            unitId,\n            subUnitId,\n            cellValue: removedCols.getMatrix(),\n        };\n\n        const intercepted = sheetInterceptorService.onCommandExecute({\n            id: RemoveColCommandId,\n            params: { range } as IRemoveRowColCommandParams,\n        });\n        const commandService = accessor.get(ICommandService);\n        const result = sequenceExecute(\n            [\n                ...(intercepted.preRedos ?? []),\n                { id: RemoveColMutation.id, params: removeColParams },\n                ...intercepted.redos,\n                followSelectionOperation(range, workbook, worksheet),\n            ],\n            commandService\n        );\n\n        if (result.result) {\n            const undoRedoService = accessor.get(IUndoRedoService);\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: [\n                    ...(intercepted.preUndos ?? []),\n                    { id: InsertColMutation.id, params: undoRemoveColParams },\n                    { id: SetRangeValuesMutation.id, params: undoSetRangeValuesParams },\n                    ...intercepted.undos,\n                ],\n                redoMutations: [\n                    ...(intercepted.preRedos ?? []),\n                    { id: RemoveColMutation.id, params: removeColParams },\n                    ...intercepted.redos,\n                ],\n            });\n\n            return true;\n        }\n        return false;\n    },\n};\n\n/**\n * This command would remove the selected columns. These selected rows can be non-continuous.\n */\nexport const RemoveColCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: RemoveColCommandId,\n\n    handler: async (accessor: IAccessor, params?: IRemoveRowColCommandParams) => {\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n        const commandService = accessor.get(ICommandService);\n        let range = params?.range;\n        if (!range) range = selectionManagerService.getCurrentLastSelection()?.range;\n        if (!range) return false;\n\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet, subUnitId, unitId } = target;\n\n        range = {\n            ...range,\n            startRow: 0,\n            endRow: Math.max(worksheet.getMaxRows() - 1, 0),\n        };\n\n        const canPerform = await sheetInterceptorService.beforeCommandExecute({\n            id: RemoveColCommand.id,\n            params: { range } as IRemoveRowColCommandParams,\n        });\n\n        if (!canPerform) {\n            return false;\n        }\n\n        return commandService.syncExecuteCommand(RemoveColByRangeCommand.id, {\n            range,\n            unitId,\n            subUnitId,\n        });\n    },\n};\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"510d01273562e4aa394d59b4c7997c9c38d749db"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/add-worksheet-merge.mutation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/add-worksheet-merge.mutation.ts","statementMap":{"0":{"start":{"line":2,"column":43},"end":{"line":13,"column":1}},"1":{"start":{"line":3,"column":32},"end":{"line":3,"column":68}},"2":{"start":{"line":4,"column":22},"end":{"line":4,"column":81}},"3":{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},"4":{"start":{"line":6,"column":4},"end":{"line":6,"column":50}},"5":{"start":{"line":8,"column":2},"end":{"line":12,"column":4}},"6":{"start":{"line":14,"column":41},"end":{"line":34,"column":1}},"7":{"start":{"line":18,"column":34},"end":{"line":18,"column":70}},"8":{"start":{"line":19,"column":24},"end":{"line":19,"column":83}},"9":{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},"10":{"start":{"line":21,"column":6},"end":{"line":21,"column":52}},"11":{"start":{"line":23,"column":22},"end":{"line":23,"column":69}},"12":{"start":{"line":24,"column":4},"end":{"line":24,"column":33}},"13":{"start":{"line":24,"column":20},"end":{"line":24,"column":33}},"14":{"start":{"line":25,"column":19},"end":{"line":25,"column":40}},"15":{"start":{"line":26,"column":28},"end":{"line":26,"column":44}},"16":{"start":{"line":27,"column":28},"end":{"line":27,"column":41}},"17":{"start":{"line":28,"column":4},"end":{"line":30,"column":5}},"18":{"start":{"line":28,"column":17},"end":{"line":28,"column":18}},"19":{"start":{"line":29,"column":6},"end":{"line":29,"column":47}},"20":{"start":{"line":31,"column":4},"end":{"line":31,"column":54}},"21":{"start":{"line":32,"column":4},"end":{"line":32,"column":16}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":43},"end":{"line":2,"column":44}},"loc":{"start":{"line":2,"column":65},"end":{"line":13,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":17,"column":11},"end":{"line":17,"column":12}},"loc":{"start":{"line":17,"column":33},"end":{"line":33,"column":3}},"line":17}},"branchMap":{"0":{"loc":{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},"type":"if","locations":[{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},{"start":{},"end":{}}],"line":5},"1":{"loc":{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},{"start":{},"end":{}}],"line":20},"2":{"loc":{"start":{"line":24,"column":4},"end":{"line":24,"column":33}},"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":24,"column":33}},{"start":{},"end":{}}],"line":24}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0},"f":{"0":0,"1":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/add-worksheet-merge.mutation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommandType, IUniverInstanceService, Tools } from '@univerjs/core';\nimport type { IAccessor, IMutation } from '@univerjs/core';\n\nimport type {\n    IAddWorksheetMergeMutationParams,\n    IRemoveWorksheetMergeMutationParams,\n} from '../../basics/interfaces/mutation-interface';\n\nexport const AddMergeUndoMutationFactory = (\n    accessor: IAccessor,\n    params: IAddWorksheetMergeMutationParams\n): IRemoveWorksheetMergeMutationParams => {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n    if (universheet == null) {\n        throw new Error('universheet is null error!');\n    }\n\n    return {\n        unitId: params.unitId,\n        subUnitId: params.subUnitId,\n        ranges: Tools.deepClone(params.ranges),\n    };\n};\n\nexport const AddWorksheetMergeMutation: IMutation<IAddWorksheetMergeMutationParams> = {\n    id: 'sheet.mutation.add-worksheet-merge',\n    type: CommandType.MUTATION,\n    handler: (accessor: IAccessor, params: IAddWorksheetMergeMutationParams) => {\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n        if (universheet == null) {\n            throw new Error('universheet is null error!');\n        }\n\n        const worksheet = universheet.getSheetBySheetId(params.subUnitId);\n        if (!worksheet) return false;\n\n        const config = worksheet.getConfig()!;\n        const mergeConfigData = config.mergeData;\n        const mergeAppendData = params.ranges;\n        for (let i = 0; i < mergeAppendData.length; i++) {\n            mergeConfigData.push(mergeAppendData[i]);\n        }\n        worksheet.getSpanModel().rebuild(mergeConfigData);\n\n        return true;\n    },\n};\n"],"mappings":"AAgBA,SAAS,aAAa,wBAAwB,aAAa;AAQpD,aAAM,8BAA8B,CACvC,UACA,WACsC;AACtC,QAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,QAAM,cAAc,sBAAsB,uBAAuB,OAAO,MAAM;AAE9E,MAAI,eAAe,MAAM;AACrB,UAAM,IAAI,MAAM,4BAA4B;AAAA,EAChD;AAEA,SAAO;AAAA,IACH,QAAQ,OAAO;AAAA,IACf,WAAW,OAAO;AAAA,IAClB,QAAQ,MAAM,UAAU,OAAO,MAAM;AAAA,EACzC;AACJ;AAEO,aAAM,4BAAyE;AAAA,EAClF,IAAI;AAAA,EACJ,MAAM,YAAY;AAAA,EAClB,SAAS,CAAC,UAAqB,WAA6C;AACxE,UAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,UAAM,cAAc,sBAAsB,uBAAuB,OAAO,MAAM;AAE9E,QAAI,eAAe,MAAM;AACrB,YAAM,IAAI,MAAM,4BAA4B;AAAA,IAChD;AAEA,UAAM,YAAY,YAAY,kBAAkB,OAAO,SAAS;AAChE,QAAI,CAAC,UAAW,QAAO;AAEvB,UAAM,SAAS,UAAU,UAAU;AACnC,UAAM,kBAAkB,OAAO;AAC/B,UAAM,kBAAkB,OAAO;AAC/B,aAAS,IAAI,GAAG,IAAI,gBAAgB,QAAQ,KAAK;AAC7C,sBAAgB,KAAK,gBAAgB,CAAC,CAAC;AAAA,IAC3C;AACA,cAAU,aAAa,EAAE,QAAQ,eAAe;AAEhD,WAAO;AAAA,EACX;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d86c5a274de10095e632f62c3703fbc435245526"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/move-rows-cols.mutation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/move-rows-cols.mutation.ts","statementMap":{"0":{"start":{"line":3,"column":58},"end":{"line":3,"column":64}},"1":{"start":{"line":4,"column":25},"end":{"line":4,"column":68}},"2":{"start":{"line":5,"column":16},"end":{"line":5,"column":61}},"3":{"start":{"line":6,"column":2},"end":{"line":17,"column":3}},"4":{"start":{"line":7,"column":4},"end":{"line":16,"column":6}},"5":{"start":{"line":18,"column":2},"end":{"line":27,"column":4}},"6":{"start":{"line":29,"column":32},"end":{"line":52,"column":1}},"7":{"start":{"line":33,"column":60},"end":{"line":33,"column":66}},"8":{"start":{"line":34,"column":34},"end":{"line":34,"column":70}},"9":{"start":{"line":35,"column":24},"end":{"line":35,"column":76}},"10":{"start":{"line":36,"column":4},"end":{"line":38,"column":5}},"11":{"start":{"line":37,"column":6},"end":{"line":37,"column":64}},"12":{"start":{"line":39,"column":22},"end":{"line":39,"column":62}},"13":{"start":{"line":40,"column":4},"end":{"line":42,"column":5}},"14":{"start":{"line":41,"column":6},"end":{"line":41,"column":62}},"15":{"start":{"line":43,"column":20},"end":{"line":43,"column":40}},"16":{"start":{"line":44,"column":18},"end":{"line":44,"column":63}},"17":{"start":{"line":45,"column":18},"end":{"line":45,"column":38}},"18":{"start":{"line":46,"column":23},"end":{"line":46,"column":61}},"19":{"start":{"line":47,"column":4},"end":{"line":47,"column":55}},"20":{"start":{"line":48,"column":23},"end":{"line":48,"column":48}},"21":{"start":{"line":49,"column":4},"end":{"line":49,"column":47}},"22":{"start":{"line":50,"column":4},"end":{"line":50,"column":16}},"23":{"start":{"line":54,"column":58},"end":{"line":54,"column":64}},"24":{"start":{"line":55,"column":25},"end":{"line":55,"column":74}},"25":{"start":{"line":56,"column":16},"end":{"line":56,"column":67}},"26":{"start":{"line":57,"column":2},"end":{"line":68,"column":3}},"27":{"start":{"line":58,"column":4},"end":{"line":67,"column":6}},"28":{"start":{"line":69,"column":2},"end":{"line":78,"column":4}},"29":{"start":{"line":80,"column":32},"end":{"line":103,"column":1}},"30":{"start":{"line":84,"column":60},"end":{"line":84,"column":66}},"31":{"start":{"line":85,"column":34},"end":{"line":85,"column":70}},"32":{"start":{"line":86,"column":24},"end":{"line":86,"column":76}},"33":{"start":{"line":87,"column":4},"end":{"line":89,"column":5}},"34":{"start":{"line":88,"column":6},"end":{"line":88,"column":67}},"35":{"start":{"line":90,"column":22},"end":{"line":90,"column":62}},"36":{"start":{"line":91,"column":4},"end":{"line":93,"column":5}},"37":{"start":{"line":92,"column":6},"end":{"line":92,"column":65}},"38":{"start":{"line":94,"column":20},"end":{"line":94,"column":43}},"39":{"start":{"line":95,"column":18},"end":{"line":95,"column":69}},"40":{"start":{"line":96,"column":18},"end":{"line":96,"column":41}},"41":{"start":{"line":97,"column":26},"end":{"line":97,"column":70}},"42":{"start":{"line":98,"column":4},"end":{"line":98,"column":58}},"43":{"start":{"line":99,"column":23},"end":{"line":99,"column":48}},"44":{"start":{"line":100,"column":4},"end":{"line":100,"column":50}},"45":{"start":{"line":101,"column":4},"end":{"line":101,"column":16}}},"fnMap":{"0":{"name":"MoveRowsMutationUndoFactory","decl":{"start":{"line":2,"column":16},"end":{"line":2,"column":43}},"loc":{"start":{"line":2,"column":63},"end":{"line":28,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":32,"column":11},"end":{"line":32,"column":12}},"loc":{"start":{"line":32,"column":33},"end":{"line":51,"column":3}},"line":32},"2":{"name":"MoveColsMutationUndoFactory","decl":{"start":{"line":53,"column":16},"end":{"line":53,"column":43}},"loc":{"start":{"line":53,"column":63},"end":{"line":79,"column":1}},"line":53},"3":{"name":"(anonymous_3)","decl":{"start":{"line":83,"column":11},"end":{"line":83,"column":12}},"loc":{"start":{"line":83,"column":33},"end":{"line":102,"column":3}},"line":83}},"branchMap":{"0":{"loc":{"start":{"line":6,"column":2},"end":{"line":17,"column":3}},"type":"if","locations":[{"start":{"line":6,"column":2},"end":{"line":17,"column":3}},{"start":{},"end":{}}],"line":6},"1":{"loc":{"start":{"line":36,"column":4},"end":{"line":38,"column":5}},"type":"if","locations":[{"start":{"line":36,"column":4},"end":{"line":38,"column":5}},{"start":{},"end":{}}],"line":36},"2":{"loc":{"start":{"line":40,"column":4},"end":{"line":42,"column":5}},"type":"if","locations":[{"start":{"line":40,"column":4},"end":{"line":42,"column":5}},{"start":{},"end":{}}],"line":40},"3":{"loc":{"start":{"line":57,"column":2},"end":{"line":68,"column":3}},"type":"if","locations":[{"start":{"line":57,"column":2},"end":{"line":68,"column":3}},{"start":{},"end":{}}],"line":57},"4":{"loc":{"start":{"line":87,"column":4},"end":{"line":89,"column":5}},"type":"if","locations":[{"start":{"line":87,"column":4},"end":{"line":89,"column":5}},{"start":{},"end":{}}],"line":87},"5":{"loc":{"start":{"line":91,"column":4},"end":{"line":93,"column":5}},"type":"if","locations":[{"start":{"line":91,"column":4},"end":{"line":93,"column":5}},{"start":{},"end":{}}],"line":91}},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":1,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0},"f":{"0":0,"1":0,"2":0,"3":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/move-rows-cols.mutation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, IMutation, IRange } from '@univerjs/core';\nimport { CommandType, IUniverInstanceService, moveMatrixArray, Rectangle } from '@univerjs/core';\n\nexport interface IMoveRowsMutationParams {\n    unitId: string;\n    subUnitId: string;\n    /**\n     * The rows to be moved.\n     */\n    sourceRange: IRange;\n    /**\n     * The destination range to move the source rows to. Note that the range is before the movement has occurred.\n     */\n    targetRange: IRange;\n}\n\n/**\n * Get an undo mutation for the move rows mutation.\n * @param accessor\n * @param params\n */\nexport function MoveRowsMutationUndoFactory(\n    _accessor: IAccessor | null,\n    params: IMoveRowsMutationParams\n): IMoveRowsMutationParams {\n    const { unitId, subUnitId, sourceRange, targetRange } = params;\n    const movingBackward = sourceRange.startRow > targetRange.startRow;\n    const count = sourceRange.endRow - sourceRange.startRow + 1;\n\n    if (movingBackward) {\n        // If is moving backward, target range should be `count` offset.\n        return {\n            unitId,\n            subUnitId,\n            sourceRange: Rectangle.clone(targetRange),\n            targetRange: {\n                ...sourceRange,\n                endRow: sourceRange.endRow + count,\n                startRow: sourceRange.startRow + count,\n            },\n        };\n    }\n    return {\n        unitId,\n        subUnitId,\n        targetRange: Rectangle.clone(sourceRange),\n        sourceRange: {\n            ...targetRange,\n            endRow: targetRange.endRow - count,\n            startRow: targetRange.startRow - count,\n        },\n    };\n}\n\nexport const MoveRowsMutation: IMutation<IMoveRowsMutationParams> = {\n    id: 'sheet.mutation.move-rows',\n    type: CommandType.MUTATION,\n    handler: (accessor, params) => {\n        const { unitId, subUnitId, sourceRange, targetRange } = params;\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const univerSheet = univerInstanceService.getUniverSheetInstance(unitId);\n        if (!univerSheet) {\n            throw new Error('[MoveRowMutation] univerSheet is null!');\n        }\n\n        const worksheet = univerSheet.getSheetBySheetId(subUnitId);\n        if (!worksheet) {\n            throw new Error('[MoveRowMutation] worksheet is null!');\n        }\n\n        const fromRow = sourceRange.startRow;\n        const count = sourceRange.endRow - sourceRange.startRow + 1;\n        const toRow = targetRange.startRow;\n\n        // move row properties by directing mutating\n        const rowWrapper = worksheet.getRowManager().getRowData();\n        moveMatrixArray(fromRow, count, toRow, rowWrapper);\n\n        // move cells contents by directly mutating worksheetCellMatrix\n        const cellMatrix = worksheet.getCellMatrix();\n        cellMatrix.moveRows(fromRow, count, toRow);\n\n        return true;\n    },\n};\n\nexport interface IMoveColumnsMutationParams {\n    unitId: string;\n    subUnitId: string;\n    /**\n     * The cols to be moved.\n     */\n    sourceRange: IRange;\n    /**\n     * The destination range to move the source cols to. Note that the range is before the movement has occurred.\n     */\n    targetRange: IRange;\n}\n\nexport function MoveColsMutationUndoFactory(\n    _accessor: IAccessor | null,\n    params: IMoveColumnsMutationParams\n): IMoveColumnsMutationParams {\n    const { unitId, subUnitId, sourceRange, targetRange } = params;\n    // Ror example, moving C col before B col.\n    const movingBackward = sourceRange.startColumn > targetRange.startColumn;\n    const count = sourceRange.endColumn - sourceRange.startColumn + 1;\n\n    if (movingBackward) {\n        // If is moving backward, target range should be `count` offset.\n        return {\n            unitId,\n            subUnitId,\n            sourceRange: Rectangle.clone(targetRange),\n            targetRange: {\n                ...sourceRange,\n                endColumn: sourceRange.endColumn + count,\n                startColumn: sourceRange.startColumn + count,\n            },\n        };\n    }\n\n    return {\n        unitId,\n        subUnitId,\n        targetRange: Rectangle.clone(sourceRange),\n        sourceRange: {\n            ...targetRange,\n            startColumn: targetRange.startColumn - count,\n            endColumn: targetRange.endColumn - count,\n        },\n    };\n}\n\nexport const MoveColsMutation: IMutation<IMoveColumnsMutationParams> = {\n    id: 'sheet.mutation.move-columns',\n    type: CommandType.MUTATION,\n    handler: (accessor, params) => {\n        const { unitId, subUnitId, sourceRange, targetRange } = params;\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const univerSheet = univerInstanceService.getUniverSheetInstance(unitId);\n        if (!univerSheet) {\n            throw new Error('[MoveColumnMutation] univerSheet is null!');\n        }\n\n        const worksheet = univerSheet.getSheetBySheetId(subUnitId);\n        if (!worksheet) {\n            throw new Error('[MoveColumnMutation] worksheet is null!');\n        }\n\n        const fromCol = sourceRange.startColumn;\n        const count = sourceRange.endColumn - sourceRange.startColumn + 1;\n        const toCol = targetRange.startColumn;\n\n        // move column properties by directing mutating\n        const columnWrapper = worksheet.getColumnManager().getColumnData();\n        moveMatrixArray(fromCol, count, toCol, columnWrapper);\n\n        // move cells contents by directly mutating worksheetCellMatrix\n        const cellMatrix = worksheet.getCellMatrix();\n        cellMatrix.moveColumns(fromCol, count, toCol);\n\n        return true;\n    },\n};\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"dda2904fd050c367e93dc0664f50f76b9bd67534"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/remove-worksheet-merge.mutation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/remove-worksheet-merge.mutation.ts","statementMap":{"0":{"start":{"line":2,"column":46},"end":{"line":30,"column":1}},"1":{"start":{"line":3,"column":32},"end":{"line":3,"column":68}},"2":{"start":{"line":4,"column":22},"end":{"line":4,"column":81}},"3":{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},"4":{"start":{"line":6,"column":4},"end":{"line":6,"column":50}},"5":{"start":{"line":8,"column":20},"end":{"line":8,"column":67}},"6":{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},"7":{"start":{"line":10,"column":4},"end":{"line":10,"column":48}},"8":{"start":{"line":12,"column":17},"end":{"line":12,"column":38}},"9":{"start":{"line":13,"column":26},"end":{"line":13,"column":42}},"10":{"start":{"line":14,"column":26},"end":{"line":14,"column":39}},"11":{"start":{"line":15,"column":17},"end":{"line":15,"column":19}},"12":{"start":{"line":16,"column":2},"end":{"line":24,"column":3}},"13":{"start":{"line":16,"column":15},"end":{"line":16,"column":16}},"14":{"start":{"line":17,"column":4},"end":{"line":23,"column":5}},"15":{"start":{"line":17,"column":17},"end":{"line":17,"column":43}},"16":{"start":{"line":18,"column":26},"end":{"line":18,"column":44}},"17":{"start":{"line":19,"column":26},"end":{"line":19,"column":44}},"18":{"start":{"line":20,"column":6},"end":{"line":22,"column":7}},"19":{"start":{"line":21,"column":8},"end":{"line":21,"column":40}},"20":{"start":{"line":25,"column":2},"end":{"line":29,"column":4}},"21":{"start":{"line":31,"column":44},"end":{"line":57,"column":1}},"22":{"start":{"line":35,"column":34},"end":{"line":35,"column":70}},"23":{"start":{"line":36,"column":24},"end":{"line":36,"column":83}},"24":{"start":{"line":37,"column":4},"end":{"line":39,"column":5}},"25":{"start":{"line":38,"column":6},"end":{"line":38,"column":52}},"26":{"start":{"line":40,"column":22},"end":{"line":40,"column":69}},"27":{"start":{"line":41,"column":4},"end":{"line":41,"column":33}},"28":{"start":{"line":41,"column":20},"end":{"line":41,"column":33}},"29":{"start":{"line":42,"column":19},"end":{"line":42,"column":40}},"30":{"start":{"line":43,"column":28},"end":{"line":43,"column":44}},"31":{"start":{"line":44,"column":28},"end":{"line":44,"column":41}},"32":{"start":{"line":45,"column":4},"end":{"line":53,"column":5}},"33":{"start":{"line":45,"column":17},"end":{"line":45,"column":18}},"34":{"start":{"line":46,"column":6},"end":{"line":52,"column":7}},"35":{"start":{"line":46,"column":19},"end":{"line":46,"column":45}},"36":{"start":{"line":47,"column":28},"end":{"line":47,"column":46}},"37":{"start":{"line":48,"column":28},"end":{"line":48,"column":46}},"38":{"start":{"line":49,"column":8},"end":{"line":51,"column":9}},"39":{"start":{"line":50,"column":10},"end":{"line":50,"column":39}},"40":{"start":{"line":54,"column":4},"end":{"line":54,"column":54}},"41":{"start":{"line":55,"column":4},"end":{"line":55,"column":16}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":46},"end":{"line":2,"column":47}},"loc":{"start":{"line":2,"column":68},"end":{"line":30,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":34,"column":11},"end":{"line":34,"column":12}},"loc":{"start":{"line":34,"column":33},"end":{"line":56,"column":3}},"line":34}},"branchMap":{"0":{"loc":{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},"type":"if","locations":[{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},{"start":{},"end":{}}],"line":5},"1":{"loc":{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},"type":"if","locations":[{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},{"start":{},"end":{}}],"line":9},"2":{"loc":{"start":{"line":20,"column":6},"end":{"line":22,"column":7}},"type":"if","locations":[{"start":{"line":20,"column":6},"end":{"line":22,"column":7}},{"start":{},"end":{}}],"line":20},"3":{"loc":{"start":{"line":37,"column":4},"end":{"line":39,"column":5}},"type":"if","locations":[{"start":{"line":37,"column":4},"end":{"line":39,"column":5}},{"start":{},"end":{}}],"line":37},"4":{"loc":{"start":{"line":41,"column":4},"end":{"line":41,"column":33}},"type":"if","locations":[{"start":{"line":41,"column":4},"end":{"line":41,"column":33}},{"start":{},"end":{}}],"line":41},"5":{"loc":{"start":{"line":49,"column":8},"end":{"line":51,"column":9}},"type":"if","locations":[{"start":{"line":49,"column":8},"end":{"line":51,"column":9}},{"start":{},"end":{}}],"line":49}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":1,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0},"f":{"0":0,"1":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/remove-worksheet-merge.mutation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommandType, IUniverInstanceService, Rectangle } from '@univerjs/core';\nimport type { IAccessor, IMutation } from '@univerjs/core';\n\nimport type {\n    IAddWorksheetMergeMutationParams,\n    IRemoveWorksheetMergeMutationParams,\n} from '../../basics/interfaces/mutation-interface';\n\nexport const RemoveMergeUndoMutationFactory = (\n    accessor: IAccessor,\n    params: IRemoveWorksheetMergeMutationParams\n): IAddWorksheetMergeMutationParams => {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n    if (universheet == null) {\n        throw new Error('universheet is null error!');\n    }\n\n    const worksheet = universheet.getSheetBySheetId(params.subUnitId);\n    if (worksheet == null) {\n        throw new Error('worksheet is null error!');\n    }\n    const config = worksheet.getConfig();\n    const mergeConfigData = config.mergeData;\n    const mergeRemoveData = params.ranges;\n    const ranges = [];\n    for (let j = 0; j < mergeRemoveData.length; j++) {\n        for (let i = mergeConfigData.length - 1; i >= 0; i--) {\n            const configMerge = mergeConfigData[i];\n            const removeMerge = mergeRemoveData[j];\n            if (Rectangle.intersects(configMerge, removeMerge)) {\n                ranges.push(mergeConfigData[i]);\n            }\n        }\n    }\n\n    return {\n        unitId: params.unitId,\n        subUnitId: params.subUnitId,\n        ranges,\n    };\n};\n\nexport const RemoveWorksheetMergeMutation: IMutation<IRemoveWorksheetMergeMutationParams> = {\n    id: 'sheet.mutation.remove-worksheet-merge',\n    type: CommandType.MUTATION,\n    handler: (accessor: IAccessor, params: IRemoveWorksheetMergeMutationParams) => {\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n        if (universheet == null) {\n            throw new Error('universheet is null error!');\n        }\n\n        const worksheet = universheet.getSheetBySheetId(params.subUnitId);\n        if (!worksheet) return false;\n        const config = worksheet.getConfig();\n        const mergeConfigData = config.mergeData;\n        const mergeRemoveData = params.ranges;\n        for (let j = 0; j < mergeRemoveData.length; j++) {\n            for (let i = mergeConfigData.length - 1; i >= 0; i--) {\n                const configMerge = mergeConfigData[i];\n                const removeMerge = mergeRemoveData[j];\n                if (Rectangle.intersects(configMerge, removeMerge)) {\n                    mergeConfigData.splice(i, 1);\n                }\n            }\n        }\n        // update merge data cache\n        worksheet.getSpanModel().rebuild(mergeConfigData);\n        return true;\n    },\n};\n"],"mappings":"AAgBA,SAAS,aAAa,wBAAwB,iBAAiB;AAQxD,aAAM,iCAAiC,CAC1C,UACA,WACmC;AACnC,QAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,QAAM,cAAc,sBAAsB,uBAAuB,OAAO,MAAM;AAE9E,MAAI,eAAe,MAAM;AACrB,UAAM,IAAI,MAAM,4BAA4B;AAAA,EAChD;AAEA,QAAM,YAAY,YAAY,kBAAkB,OAAO,SAAS;AAChE,MAAI,aAAa,MAAM;AACnB,UAAM,IAAI,MAAM,0BAA0B;AAAA,EAC9C;AACA,QAAM,SAAS,UAAU,UAAU;AACnC,QAAM,kBAAkB,OAAO;AAC/B,QAAM,kBAAkB,OAAO;AAC/B,QAAM,SAAS,CAAC;AAChB,WAAS,IAAI,GAAG,IAAI,gBAAgB,QAAQ,KAAK;AAC7C,aAAS,IAAI,gBAAgB,SAAS,GAAG,KAAK,GAAG,KAAK;AAClD,YAAM,cAAc,gBAAgB,CAAC;AACrC,YAAM,cAAc,gBAAgB,CAAC;AACrC,UAAI,UAAU,WAAW,aAAa,WAAW,GAAG;AAChD,eAAO,KAAK,gBAAgB,CAAC,CAAC;AAAA,MAClC;AAAA,IACJ;AAAA,EACJ;AAEA,SAAO;AAAA,IACH,QAAQ,OAAO;AAAA,IACf,WAAW,OAAO;AAAA,IAClB;AAAA,EACJ;AACJ;AAEO,aAAM,+BAA+E;AAAA,EACxF,IAAI;AAAA,EACJ,MAAM,YAAY;AAAA,EAClB,SAAS,CAAC,UAAqB,WAAgD;AAC3E,UAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,UAAM,cAAc,sBAAsB,uBAAuB,OAAO,MAAM;AAE9E,QAAI,eAAe,MAAM;AACrB,YAAM,IAAI,MAAM,4BAA4B;AAAA,IAChD;AAEA,UAAM,YAAY,YAAY,kBAAkB,OAAO,SAAS;AAChE,QAAI,CAAC,UAAW,QAAO;AACvB,UAAM,SAAS,UAAU,UAAU;AACnC,UAAM,kBAAkB,OAAO;AAC/B,UAAM,kBAAkB,OAAO;AAC/B,aAAS,IAAI,GAAG,IAAI,gBAAgB,QAAQ,KAAK;AAC7C,eAAS,IAAI,gBAAgB,SAAS,GAAG,KAAK,GAAG,KAAK;AAClD,cAAM,cAAc,gBAAgB,CAAC;AACrC,cAAM,cAAc,gBAAgB,CAAC;AACrC,YAAI,UAAU,WAAW,aAAa,WAAW,GAAG;AAChD,0BAAgB,OAAO,GAAG,CAAC;AAAA,QAC/B;AAAA,MACJ;AAAA,IACJ;AAEA,cAAU,aAAa,EAAE,QAAQ,eAAe;AAChD,WAAO;AAAA,EACX;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2143ddd6677d9372448f2b1b47a8e43a803f034d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/operations/set-worksheet-active.operation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/operations/set-worksheet-active.operation.ts","statementMap":{"0":{"start":{"line":2,"column":43},"end":{"line":17,"column":1}},"1":{"start":{"line":6,"column":21},"end":{"line":6,"column":95}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":32}},"3":{"start":{"line":7,"column":19},"end":{"line":7,"column":32}},"4":{"start":{"line":8,"column":23},"end":{"line":8,"column":47}},"5":{"start":{"line":9,"column":4},"end":{"line":14,"column":5}},"6":{"start":{"line":10,"column":6},"end":{"line":13,"column":7}},"7":{"start":{"line":11,"column":8},"end":{"line":11,"column":43}},"8":{"start":{"line":12,"column":8},"end":{"line":12,"column":20}},"9":{"start":{"line":15,"column":4},"end":{"line":15,"column":17}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":11},"end":{"line":5,"column":12}},"loc":{"start":{"line":5,"column":33},"end":{"line":16,"column":3}},"line":5}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":4},"end":{"line":7,"column":32}},"type":"if","locations":[{"start":{"line":7,"column":4},"end":{"line":7,"column":32}},{"start":{},"end":{}}],"line":7},"1":{"loc":{"start":{"line":10,"column":6},"end":{"line":13,"column":7}},"type":"if","locations":[{"start":{"line":10,"column":6},"end":{"line":13,"column":7}},{"start":{},"end":{}}],"line":10}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"f":{"0":0},"b":{"0":[0,0],"1":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/operations/set-worksheet-active.operation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IOperation } from '@univerjs/core';\nimport { CommandType, IUniverInstanceService } from '@univerjs/core';\n\nexport interface ISetWorksheetActiveOperationParams {\n    unitId: string;\n    subUnitId: string;\n}\n\nexport const SetWorksheetActiveOperation: IOperation<ISetWorksheetActiveOperationParams> = {\n    id: 'sheet.operation.set-worksheet-active',\n    type: CommandType.OPERATION,\n    handler: (accessor, params) => {\n        const workbook = accessor.get(IUniverInstanceService).getUniverSheetInstance(params.unitId);\n\n        if (!workbook) return false;\n\n        const worksheets = workbook.getWorksheets();\n        for (const [, worksheet] of worksheets) {\n            if (worksheet.getSheetId() === params.subUnitId) {\n                workbook.setActiveSheet(worksheet);\n                return true;\n            }\n        }\n\n        return false;\n    },\n};\n"],"mappings":"AAiBA,SAAS,aAAa,8BAA8B;AAO7C,aAAM,8BAA8E;AAAA,EACvF,IAAI;AAAA,EACJ,MAAM,YAAY;AAAA,EAClB,SAAS,CAAC,UAAU,WAAW;AAC3B,UAAM,WAAW,SAAS,IAAI,sBAAsB,EAAE,uBAAuB,OAAO,MAAM;AAE1F,QAAI,CAAC,SAAU,QAAO;AAEtB,UAAM,aAAa,SAAS,cAAc;AAC1C,eAAW,CAAC,EAAE,SAAS,KAAK,YAAY;AACpC,UAAI,UAAU,WAAW,MAAM,OAAO,WAAW;AAC7C,iBAAS,eAAe,SAAS;AACjC,eAAO;AAAA,MACX;AAAA,IACJ;AAEA,WAAO;AAAA,EACX;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"e21efb610c39de93e0d2b78e186415b3e5773d7d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/remove-sheet.mutation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/remove-sheet.mutation.ts","statementMap":{"0":{"start":{"line":3,"column":46},"end":{"line":19,"column":1}},"1":{"start":{"line":4,"column":32},"end":{"line":4,"column":68}},"2":{"start":{"line":5,"column":32},"end":{"line":5,"column":38}},"3":{"start":{"line":6,"column":17},"end":{"line":6,"column":70}},"4":{"start":{"line":7,"column":2},"end":{"line":9,"column":3}},"5":{"start":{"line":8,"column":4},"end":{"line":8,"column":82}},"6":{"start":{"line":10,"column":34},"end":{"line":10,"column":40}},"7":{"start":{"line":11,"column":16},"end":{"line":11,"column":37}},"8":{"start":{"line":12,"column":17},"end":{"line":12,"column":37}},"9":{"start":{"line":13,"column":16},"end":{"line":13,"column":69}},"10":{"start":{"line":13,"column":52},"end":{"line":13,"column":68}},"11":{"start":{"line":14,"column":2},"end":{"line":18,"column":4}},"12":{"start":{"line":20,"column":35},"end":{"line":32,"column":1}},"13":{"start":{"line":24,"column":34},"end":{"line":24,"column":70}},"14":{"start":{"line":25,"column":34},"end":{"line":25,"column":40}},"15":{"start":{"line":26,"column":21},"end":{"line":26,"column":73}},"16":{"start":{"line":27,"column":4},"end":{"line":29,"column":5}},"17":{"start":{"line":28,"column":6},"end":{"line":28,"column":19}},"18":{"start":{"line":30,"column":4},"end":{"line":30,"column":43}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":46},"end":{"line":3,"column":47}},"loc":{"start":{"line":3,"column":68},"end":{"line":19,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":13,"column":44},"end":{"line":13,"column":45}},"loc":{"start":{"line":13,"column":52},"end":{"line":13,"column":68}},"line":13},"2":{"name":"(anonymous_2)","decl":{"start":{"line":23,"column":11},"end":{"line":23,"column":12}},"loc":{"start":{"line":23,"column":33},"end":{"line":31,"column":3}},"line":23}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":2},"end":{"line":9,"column":3}},"type":"if","locations":[{"start":{"line":7,"column":2},"end":{"line":9,"column":3}},{"start":{},"end":{}}],"line":7},"1":{"loc":{"start":{"line":27,"column":4},"end":{"line":29,"column":5}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":29,"column":5}},{"start":{},"end":{}}],"line":27}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},"f":{"0":0,"1":0,"2":0},"b":{"0":[0,0],"1":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/remove-sheet.mutation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, IMutation } from '@univerjs/core';\nimport { CommandType, IUniverInstanceService } from '@univerjs/core';\n\nimport type {\n    IInsertSheetMutationParams,\n    IRemoveSheetMutationParams,\n} from '../../basics/interfaces/mutation-interface';\nimport { getSheetMutationTarget } from '../commands/utils/target-util';\n\n/**\n * Generate undo mutation of a `RemoveSheetMutation`\n *\n * @param {IAccessor} accessor - injector accessor\n * @param {IRemoveSheetMutationParams} params - do mutation params\n * @returns {IInsertSheetMutationParams} undo mutation params\n */\nexport const RemoveSheetUndoMutationFactory = (\n    accessor: IAccessor,\n    params: IRemoveSheetMutationParams\n): IInsertSheetMutationParams => {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const { subUnitId, unitId } = params;\n\n    const target = getSheetMutationTarget(univerInstanceService, params);\n    if (!target) {\n        throw new Error('[RemoveSheetUndoMutationFactory]: Worksheet is null error!');\n    }\n\n    const { workbook, worksheet } = target;\n    const sheet = worksheet.getConfig();\n    const config = workbook.getConfig();\n    const index = config.sheetOrder.findIndex((id) => id === subUnitId);\n\n    return {\n        index,\n        sheet,\n        unitId,\n    };\n};\n\nexport const RemoveSheetMutation: IMutation<IRemoveSheetMutationParams, boolean> = {\n    id: 'sheet.mutation.remove-sheet',\n    type: CommandType.MUTATION,\n    handler: (accessor, params) => {\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const { subUnitId, unitId } = params;\n        const workbook = univerInstanceService.getUniverSheetInstance(unitId);\n        if (!workbook) {\n            return false;\n        }\n\n        return workbook.removeSheet(subUnitId);\n    },\n};\n"],"mappings":"AAiBA,SAAS,aAAa,8BAA8B;AAMpD,SAAS,8BAA8B;AAShC,aAAM,iCAAiC,CAC1C,UACA,WAC6B;AAC7B,QAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,QAAM,EAAE,WAAW,OAAO,IAAI;AAE9B,QAAM,SAAS,uBAAuB,uBAAuB,MAAM;AACnE,MAAI,CAAC,QAAQ;AACT,UAAM,IAAI,MAAM,4DAA4D;AAAA,EAChF;AAEA,QAAM,EAAE,UAAU,UAAU,IAAI;AAChC,QAAM,QAAQ,UAAU,UAAU;AAClC,QAAM,SAAS,SAAS,UAAU;AAClC,QAAM,QAAQ,OAAO,WAAW,UAAU,CAAC,OAAO,OAAO,SAAS;AAElE,SAAO;AAAA,IACH;AAAA,IACA;AAAA,IACA;AAAA,EACJ;AACJ;AAEO,aAAM,sBAAsE;AAAA,EAC/E,IAAI;AAAA,EACJ,MAAM,YAAY;AAAA,EAClB,SAAS,CAAC,UAAU,WAAW;AAC3B,UAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,UAAM,EAAE,WAAW,OAAO,IAAI;AAC9B,UAAM,WAAW,sBAAsB,uBAAuB,MAAM;AACpE,QAAI,CAAC,UAAU;AACX,aAAO;AAAA,IACX;AAEA,WAAO,SAAS,YAAY,SAAS;AAAA,EACzC;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"9954e3deb0f7f80c90653f1e90d9006fe96ba634"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/move-rows-cols.command.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/move-rows-cols.command.ts","statementMap":{"0":{"start":{"line":25,"column":2},"end":{"line":25,"column":110}},"1":{"start":{"line":25,"column":55},"end":{"line":25,"column":108}},"2":{"start":{"line":28,"column":2},"end":{"line":28,"column":116}},"3":{"start":{"line":28,"column":55},"end":{"line":28,"column":114}},"4":{"start":{"line":30,"column":33},"end":{"line":30,"column":58}},"5":{"start":{"line":31,"column":31},"end":{"line":133,"column":1}},"6":{"start":{"line":36,"column":36},"end":{"line":36,"column":73}},"7":{"start":{"line":41,"column":8},"end":{"line":41,"column":14}},"8":{"start":{"line":42,"column":23},"end":{"line":42,"column":111}},"9":{"start":{"line":43,"column":31},"end":{"line":45,"column":5}},"10":{"start":{"line":44,"column":21},"end":{"line":44,"column":141}},"11":{"start":{"line":46,"column":4},"end":{"line":48,"column":5}},"12":{"start":{"line":47,"column":6},"end":{"line":47,"column":19}},"13":{"start":{"line":49,"column":36},"end":{"line":49,"column":73}},"14":{"start":{"line":50,"column":34},"end":{"line":50,"column":70}},"15":{"start":{"line":51,"column":19},"end":{"line":51,"column":71}},"16":{"start":{"line":52,"column":4},"end":{"line":52,"column":30}},"17":{"start":{"line":52,"column":17},"end":{"line":52,"column":30}},"18":{"start":{"line":53,"column":36},"end":{"line":53,"column":42}},"19":{"start":{"line":54,"column":19},"end":{"line":54,"column":39}},"20":{"start":{"line":55,"column":22},"end":{"line":55,"column":44}},"21":{"start":{"line":56,"column":25},"end":{"line":56,"column":51}},"22":{"start":{"line":57,"column":26},"end":{"line":57,"column":53}},"23":{"start":{"line":58,"column":24},"end":{"line":58,"column":51}},"24":{"start":{"line":59,"column":26},"end":{"line":59,"column":55}},"25":{"start":{"line":60,"column":25},"end":{"line":60,"column":81}},"26":{"start":{"line":61,"column":4},"end":{"line":64,"column":5}},"27":{"start":{"line":62,"column":6},"end":{"line":62,"column":67}},"28":{"start":{"line":63,"column":6},"end":{"line":63,"column":19}},"29":{"start":{"line":65,"column":4},"end":{"line":68,"column":5}},"30":{"start":{"line":66,"column":6},"end":{"line":66,"column":73}},"31":{"start":{"line":67,"column":6},"end":{"line":67,"column":19}},"32":{"start":{"line":69,"column":29},"end":{"line":73,"column":5}},"33":{"start":{"line":74,"column":27},"end":{"line":79,"column":5}},"34":{"start":{"line":80,"column":31},"end":{"line":80,"column":84}},"35":{"start":{"line":81,"column":27},"end":{"line":81,"column":56}},"36":{"start":{"line":82,"column":32},"end":{"line":82,"column":108}},"37":{"start":{"line":83,"column":18},"end":{"line":86,"column":5}},"38":{"start":{"line":87,"column":18},"end":{"line":90,"column":5}},"39":{"start":{"line":91,"column":4},"end":{"line":118,"column":5}},"40":{"start":{"line":92,"column":26},"end":{"line":92,"column":41}},"41":{"start":{"line":93,"column":27},"end":{"line":93,"column":42}},"42":{"start":{"line":94,"column":20},"end":{"line":94,"column":65}},"43":{"start":{"line":95,"column":28},"end":{"line":99,"column":7}},"44":{"start":{"line":100,"column":33},"end":{"line":109,"column":7}},"45":{"start":{"line":110,"column":37},"end":{"line":115,"column":7}},"46":{"start":{"line":116,"column":6},"end":{"line":116,"column":80}},"47":{"start":{"line":117,"column":6},"end":{"line":117,"column":84}},"48":{"start":{"line":119,"column":4},"end":{"line":119,"column":45}},"49":{"start":{"line":120,"column":4},"end":{"line":120,"column":45}},"50":{"start":{"line":121,"column":19},"end":{"line":121,"column":57}},"51":{"start":{"line":122,"column":4},"end":{"line":130,"column":5}},"52":{"start":{"line":123,"column":30},"end":{"line":123,"column":60}},"53":{"start":{"line":124,"column":6},"end":{"line":128,"column":9}},"54":{"start":{"line":129,"column":6},"end":{"line":129,"column":18}},"55":{"start":{"line":131,"column":4},"end":{"line":131,"column":17}},"56":{"start":{"line":134,"column":33},"end":{"line":134,"column":58}},"57":{"start":{"line":135,"column":31},"end":{"line":233,"column":1}},"58":{"start":{"line":140,"column":36},"end":{"line":140,"column":73}},"59":{"start":{"line":145,"column":8},"end":{"line":145,"column":14}},"60":{"start":{"line":146,"column":23},"end":{"line":146,"column":111}},"61":{"start":{"line":147,"column":31},"end":{"line":149,"column":5}},"62":{"start":{"line":148,"column":21},"end":{"line":148,"column":150}},"63":{"start":{"line":150,"column":4},"end":{"line":152,"column":5}},"64":{"start":{"line":151,"column":6},"end":{"line":151,"column":19}},"65":{"start":{"line":153,"column":36},"end":{"line":153,"column":73}},"66":{"start":{"line":154,"column":34},"end":{"line":154,"column":70}},"67":{"start":{"line":155,"column":19},"end":{"line":155,"column":71}},"68":{"start":{"line":156,"column":4},"end":{"line":156,"column":30}},"69":{"start":{"line":156,"column":17},"end":{"line":156,"column":30}},"70":{"start":{"line":157,"column":36},"end":{"line":157,"column":42}},"71":{"start":{"line":158,"column":19},"end":{"line":158,"column":39}},"72":{"start":{"line":159,"column":22},"end":{"line":159,"column":44}},"73":{"start":{"line":160,"column":25},"end":{"line":160,"column":51}},"74":{"start":{"line":161,"column":26},"end":{"line":161,"column":53}},"75":{"start":{"line":162,"column":24},"end":{"line":162,"column":51}},"76":{"start":{"line":163,"column":26},"end":{"line":163,"column":55}},"77":{"start":{"line":164,"column":25},"end":{"line":164,"column":81}},"78":{"start":{"line":165,"column":4},"end":{"line":168,"column":5}},"79":{"start":{"line":166,"column":6},"end":{"line":166,"column":67}},"80":{"start":{"line":167,"column":6},"end":{"line":167,"column":19}},"81":{"start":{"line":169,"column":4},"end":{"line":172,"column":5}},"82":{"start":{"line":170,"column":6},"end":{"line":170,"column":73}},"83":{"start":{"line":171,"column":6},"end":{"line":171,"column":19}},"84":{"start":{"line":173,"column":29},"end":{"line":177,"column":5}},"85":{"start":{"line":178,"column":27},"end":{"line":183,"column":5}},"86":{"start":{"line":184,"column":31},"end":{"line":184,"column":84}},"87":{"start":{"line":185,"column":27},"end":{"line":185,"column":56}},"88":{"start":{"line":186,"column":32},"end":{"line":186,"column":108}},"89":{"start":{"line":187,"column":18},"end":{"line":190,"column":5}},"90":{"start":{"line":191,"column":18},"end":{"line":194,"column":5}},"91":{"start":{"line":195,"column":4},"end":{"line":218,"column":5}},"92":{"start":{"line":196,"column":20},"end":{"line":196,"column":71}},"93":{"start":{"line":197,"column":26},"end":{"line":197,"column":41}},"94":{"start":{"line":198,"column":27},"end":{"line":198,"column":42}},"95":{"start":{"line":199,"column":28},"end":{"line":203,"column":7}},"96":{"start":{"line":204,"column":33},"end":{"line":209,"column":7}},"97":{"start":{"line":210,"column":37},"end":{"line":215,"column":7}},"98":{"start":{"line":216,"column":6},"end":{"line":216,"column":80}},"99":{"start":{"line":217,"column":6},"end":{"line":217,"column":84}},"100":{"start":{"line":219,"column":4},"end":{"line":219,"column":45}},"101":{"start":{"line":220,"column":4},"end":{"line":220,"column":45}},"102":{"start":{"line":221,"column":19},"end":{"line":221,"column":57}},"103":{"start":{"line":222,"column":4},"end":{"line":230,"column":5}},"104":{"start":{"line":223,"column":30},"end":{"line":223,"column":60}},"105":{"start":{"line":224,"column":6},"end":{"line":228,"column":9}},"106":{"start":{"line":229,"column":6},"end":{"line":229,"column":18}},"107":{"start":{"line":231,"column":4},"end":{"line":231,"column":16}},"108":{"start":{"line":235,"column":2},"end":{"line":239,"column":4}}},"fnMap":{"0":{"name":"rowAcrossMergedCell","decl":{"start":{"line":24,"column":9},"end":{"line":24,"column":28}},"loc":{"start":{"line":24,"column":45},"end":{"line":26,"column":1}},"line":24},"1":{"name":"(anonymous_1)","decl":{"start":{"line":25,"column":39},"end":{"line":25,"column":40}},"loc":{"start":{"line":25,"column":55},"end":{"line":25,"column":108}},"line":25},"2":{"name":"columnAcrossMergedCell","decl":{"start":{"line":27,"column":9},"end":{"line":27,"column":31}},"loc":{"start":{"line":27,"column":48},"end":{"line":29,"column":1}},"line":27},"3":{"name":"(anonymous_3)","decl":{"start":{"line":28,"column":39},"end":{"line":28,"column":40}},"loc":{"start":{"line":28,"column":55},"end":{"line":28,"column":114}},"line":28},"4":{"name":"(anonymous_4)","decl":{"start":{"line":35,"column":11},"end":{"line":35,"column":12}},"loc":{"start":{"line":35,"column":33},"end":{"line":132,"column":3}},"line":35},"5":{"name":"(anonymous_5)","decl":{"start":{"line":44,"column":6},"end":{"line":44,"column":7}},"loc":{"start":{"line":44,"column":21},"end":{"line":44,"column":141}},"line":44},"6":{"name":"(anonymous_6)","decl":{"start":{"line":139,"column":11},"end":{"line":139,"column":12}},"loc":{"start":{"line":139,"column":33},"end":{"line":232,"column":3}},"line":139},"7":{"name":"(anonymous_7)","decl":{"start":{"line":148,"column":6},"end":{"line":148,"column":7}},"loc":{"start":{"line":148,"column":21},"end":{"line":148,"column":150}},"line":148},"8":{"name":"covertRangeToSelection","decl":{"start":{"line":234,"column":9},"end":{"line":234,"column":31}},"loc":{"start":{"line":234,"column":39},"end":{"line":240,"column":1}},"line":234}},"branchMap":{"0":{"loc":{"start":{"line":25,"column":55},"end":{"line":25,"column":108}},"type":"binary-expr","locations":[{"start":{"line":25,"column":55},"end":{"line":25,"column":80}},{"start":{"line":25,"column":84},"end":{"line":25,"column":108}}],"line":25},"1":{"loc":{"start":{"line":28,"column":55},"end":{"line":28,"column":114}},"type":"binary-expr","locations":[{"start":{"line":28,"column":55},"end":{"line":28,"column":83}},{"start":{"line":28,"column":87},"end":{"line":28,"column":114}}],"line":28},"2":{"loc":{"start":{"line":42,"column":23},"end":{"line":42,"column":111}},"type":"cond-expr","locations":[{"start":{"line":42,"column":31},"end":{"line":42,"column":62}},{"start":{"line":42,"column":65},"end":{"line":42,"column":111}}],"line":42},"3":{"loc":{"start":{"line":44,"column":21},"end":{"line":44,"column":141}},"type":"binary-expr","locations":[{"start":{"line":44,"column":21},"end":{"line":44,"column":65}},{"start":{"line":44,"column":69},"end":{"line":44,"column":104}},{"start":{"line":44,"column":108},"end":{"line":44,"column":141}}],"line":44},"4":{"loc":{"start":{"line":46,"column":4},"end":{"line":48,"column":5}},"type":"if","locations":[{"start":{"line":46,"column":4},"end":{"line":48,"column":5}},{"start":{},"end":{}}],"line":46},"5":{"loc":{"start":{"line":52,"column":4},"end":{"line":52,"column":30}},"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":52,"column":30}},{"start":{},"end":{}}],"line":52},"6":{"loc":{"start":{"line":61,"column":4},"end":{"line":64,"column":5}},"type":"if","locations":[{"start":{"line":61,"column":4},"end":{"line":64,"column":5}},{"start":{},"end":{}}],"line":61},"7":{"loc":{"start":{"line":65,"column":4},"end":{"line":68,"column":5}},"type":"if","locations":[{"start":{"line":65,"column":4},"end":{"line":68,"column":5}},{"start":{},"end":{}}],"line":65},"8":{"loc":{"start":{"line":84,"column":9},"end":{"line":84,"column":43}},"type":"binary-expr","locations":[{"start":{"line":84,"column":9},"end":{"line":84,"column":37}},{"start":{"line":84,"column":41},"end":{"line":84,"column":43}}],"line":84},"9":{"loc":{"start":{"line":88,"column":9},"end":{"line":88,"column":43}},"type":"binary-expr","locations":[{"start":{"line":88,"column":9},"end":{"line":88,"column":37}},{"start":{"line":88,"column":41},"end":{"line":88,"column":43}}],"line":88},"10":{"loc":{"start":{"line":91,"column":4},"end":{"line":118,"column":5}},"type":"if","locations":[{"start":{"line":91,"column":4},"end":{"line":118,"column":5}},{"start":{},"end":{}}],"line":91},"11":{"loc":{"start":{"line":95,"column":28},"end":{"line":99,"column":7}},"type":"cond-expr","locations":[{"start":{"line":95,"column":43},"end":{"line":95,"column":59}},{"start":{"line":95,"column":62},"end":{"line":99,"column":7}}],"line":95},"12":{"loc":{"start":{"line":122,"column":4},"end":{"line":130,"column":5}},"type":"if","locations":[{"start":{"line":122,"column":4},"end":{"line":130,"column":5}},{"start":{},"end":{}}],"line":122},"13":{"loc":{"start":{"line":146,"column":23},"end":{"line":146,"column":111}},"type":"cond-expr","locations":[{"start":{"line":146,"column":31},"end":{"line":146,"column":62}},{"start":{"line":146,"column":65},"end":{"line":146,"column":111}}],"line":146},"14":{"loc":{"start":{"line":148,"column":21},"end":{"line":148,"column":150}},"type":"binary-expr","locations":[{"start":{"line":148,"column":21},"end":{"line":148,"column":68}},{"start":{"line":148,"column":72},"end":{"line":148,"column":110}},{"start":{"line":148,"column":114},"end":{"line":148,"column":150}}],"line":148},"15":{"loc":{"start":{"line":150,"column":4},"end":{"line":152,"column":5}},"type":"if","locations":[{"start":{"line":150,"column":4},"end":{"line":152,"column":5}},{"start":{},"end":{}}],"line":150},"16":{"loc":{"start":{"line":156,"column":4},"end":{"line":156,"column":30}},"type":"if","locations":[{"start":{"line":156,"column":4},"end":{"line":156,"column":30}},{"start":{},"end":{}}],"line":156},"17":{"loc":{"start":{"line":165,"column":4},"end":{"line":168,"column":5}},"type":"if","locations":[{"start":{"line":165,"column":4},"end":{"line":168,"column":5}},{"start":{},"end":{}}],"line":165},"18":{"loc":{"start":{"line":169,"column":4},"end":{"line":172,"column":5}},"type":"if","locations":[{"start":{"line":169,"column":4},"end":{"line":172,"column":5}},{"start":{},"end":{}}],"line":169},"19":{"loc":{"start":{"line":188,"column":9},"end":{"line":188,"column":43}},"type":"binary-expr","locations":[{"start":{"line":188,"column":9},"end":{"line":188,"column":37}},{"start":{"line":188,"column":41},"end":{"line":188,"column":43}}],"line":188},"20":{"loc":{"start":{"line":192,"column":9},"end":{"line":192,"column":43}},"type":"binary-expr","locations":[{"start":{"line":192,"column":9},"end":{"line":192,"column":37}},{"start":{"line":192,"column":41},"end":{"line":192,"column":43}}],"line":192},"21":{"loc":{"start":{"line":195,"column":4},"end":{"line":218,"column":5}},"type":"if","locations":[{"start":{"line":195,"column":4},"end":{"line":218,"column":5}},{"start":{},"end":{}}],"line":195},"22":{"loc":{"start":{"line":199,"column":28},"end":{"line":203,"column":7}},"type":"cond-expr","locations":[{"start":{"line":199,"column":43},"end":{"line":199,"column":59}},{"start":{"line":199,"column":62},"end":{"line":203,"column":7}}],"line":199},"23":{"loc":{"start":{"line":222,"column":4},"end":{"line":230,"column":5}},"type":"if","locations":[{"start":{"line":222,"column":4},"end":{"line":230,"column":5}},{"start":{},"end":{}}],"line":222}},"s":{"0":0,"1":0,"2":0,"3":0,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":1,"57":1,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/move-rows-cols.command.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand, IRange, Worksheet } from '@univerjs/core';\nimport type { ISelectionWithStyle } from '../../basics';\n\nimport type { IMoveColumnsMutationParams, IMoveRowsMutationParams } from '../mutations/move-rows-cols.mutation';\nimport type { ISetSelectionsOperationParams } from '../operations/selection.operation';\nimport {\n    CommandType,\n    ErrorService,\n    ICommandService,\n    IUndoRedoService,\n    IUniverInstanceService,\n    LocaleService,\n    RANGE_TYPE,\n    Rectangle,\n    sequenceExecute,\n} from '@univerjs/core';\nimport { SheetsSelectionsService } from '../../services/selections/selection.service';\nimport { SelectionMoveType } from '../../services/selections/type';\nimport { SheetInterceptorService } from '../../services/sheet-interceptor/sheet-interceptor.service';\nimport {\n    MoveColsMutation,\n    MoveColsMutationUndoFactory,\n    MoveRowsMutation,\n    MoveRowsMutationUndoFactory,\n} from '../mutations/move-rows-cols.mutation';\nimport { SetSelectionsOperation } from '../operations/selection.operation';\nimport { alignToMergedCellsBorders, getPrimaryForRange } from './utils/selection-utils';\nimport { getSheetCommandTarget } from './utils/target-util';\n\nexport interface IMoveRowsCommandParams {\n    unitId?: string;\n    subUnitId?: string;\n    range?: IRange; // for facade to use, accepting user parameters\n    fromRange: IRange;\n    toRange: IRange;\n}\n\nfunction rowAcrossMergedCell(row: number, worksheet: Worksheet): boolean {\n    return worksheet.getMergeData().some((mergedCell) => mergedCell.startRow < row && row <= mergedCell.endRow);\n}\n\nfunction columnAcrossMergedCell(col: number, worksheet: Worksheet): boolean {\n    return worksheet.getMergeData().some((mergedCell) => mergedCell.startColumn < col && col <= mergedCell.endColumn);\n}\n\nexport const MoveRowsCommandId = 'sheet.command.move-rows' as const;\n/**\n * Command to move the selected rows (must currently selected) to the specified row.\n */\nexport const MoveRowsCommand: ICommand<IMoveRowsCommandParams> = {\n    id: MoveRowsCommandId,\n    type: CommandType.COMMAND,\n\n    // eslint-disable-next-line max-lines-per-function\n    handler: (accessor: IAccessor, params: IMoveRowsCommandParams) => {\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const {\n            fromRange: { startRow: fromRow },\n            toRange: { startRow: toRow },\n            range,\n        } = params;\n\n        // user can specify the range to move, or use the current selection\n        const selections = range ? [covertRangeToSelection(range)] : selectionManagerService.getCurrentSelections();\n\n        const filteredSelections = selections?.filter(\n            (selection) =>\n                selection.range.rangeType === RANGE_TYPE.ROW &&\n                selection.range.startRow <= fromRow &&\n                fromRow <= selection.range.endRow\n        );\n        if (filteredSelections?.length !== 1) {\n            return false;\n        }\n\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const target = getSheetCommandTarget(univerInstanceService, params);\n        if (!target) return false;\n\n        const { workbook, worksheet } = target;\n\n        const unitId = workbook.getUnitId();\n        const subUnitId = worksheet.getSheetId();\n\n        const errorService = accessor.get(ErrorService);\n        const localeService = accessor.get(LocaleService);\n        // Forbid action when some parts of a merged cell are selected.\n        const rangeToMove = filteredSelections[0].range;\n        const beforePrimary = filteredSelections[0].primary;\n        const alignedRange = alignToMergedCellsBorders(rangeToMove, worksheet, false);\n        if (!Rectangle.equals(rangeToMove, alignedRange)) {\n            errorService.emit(localeService.t('sheets.info.partOfCell'));\n            return false;\n        }\n\n        if (rowAcrossMergedCell(toRow, worksheet)) {\n            errorService.emit(localeService.t('sheets.info.acrossMergedCell'));\n            return false;\n        }\n\n        const destinationRange: IRange = {\n            ...rangeToMove,\n            startRow: toRow,\n            endRow: toRow + rangeToMove.endRow - rangeToMove.startRow,\n        };\n        const moveRowsParams: IMoveRowsMutationParams = {\n            unitId,\n            subUnitId,\n            sourceRange: rangeToMove,\n            targetRange: destinationRange,\n        };\n        const undoMoveRowsParams = MoveRowsMutationUndoFactory(accessor, moveRowsParams);\n\n        const commandService = accessor.get(ICommandService);\n\n        const interceptorCommands = sheetInterceptorService.onCommandExecute({ id: MoveRowsCommand.id, params });\n\n        const redos = [\n            ...(interceptorCommands.preRedos ?? []),\n            { id: MoveRowsMutation.id, params: moveRowsParams },\n        ];\n\n        const undos = [\n            ...(interceptorCommands.preUndos ?? []),\n            { id: MoveRowsMutation.id, params: undoMoveRowsParams },\n        ];\n\n        // Handle selection in user interaction, not when using the Facade API\n        if (beforePrimary) {\n             // we could just move the merged cells because other situations are not allowed\n            // we should only deal with merged cell that is between the range of the rows to move\n            const movedLength = toRow - fromRow;\n            const moveBackward = movedLength < 0;\n            const count = rangeToMove.endRow - rangeToMove.startRow + 1;\n\n            // deal with selections\n            const destSelection: IRange = moveBackward\n                ? destinationRange\n                : {\n                    ...destinationRange,\n                    startRow: destinationRange.startRow - count,\n                    endRow: destinationRange.endRow - count,\n                };\n\n            const setSelectionsParam: ISetSelectionsOperationParams = {\n                unitId,\n                subUnitId,\n                type: SelectionMoveType.MOVE_END,\n                selections: [{\n                    range: destSelection,\n                    primary: getPrimaryForRange(destSelection, worksheet),\n                    style: null,\n                }],\n            };\n            const undoSetSelectionsParam: ISetSelectionsOperationParams = {\n                unitId,\n                subUnitId,\n                type: SelectionMoveType.MOVE_END,\n                selections: [{ range: rangeToMove, primary: beforePrimary, style: null }],\n            };\n\n            redos.push({ id: SetSelectionsOperation.id, params: setSelectionsParam });\n            undos.push({ id: SetSelectionsOperation.id, params: undoSetSelectionsParam });\n        }\n\n        redos.push(...interceptorCommands.redos);\n        undos.push(...interceptorCommands.undos);\n\n        const result = sequenceExecute(redos, commandService);\n\n        if (result.result) {\n            const undoRedoService = accessor.get(IUndoRedoService);\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: undos,\n                redoMutations: redos,\n            });\n            return true;\n        }\n\n        return false;\n    },\n};\n\nexport interface IMoveColsCommandParams {\n    unitId?: string;\n    subUnitId?: string;\n    range?: IRange; // for facade to use, accepting user parameters\n    fromRange: IRange;\n    toRange: IRange;\n}\nexport const MoveColsCommandId = 'sheet.command.move-cols' as const;\n\nexport const MoveColsCommand: ICommand<IMoveColsCommandParams> = {\n    id: MoveColsCommandId,\n    type: CommandType.COMMAND,\n\n    // eslint-disable-next-line max-lines-per-function\n    handler: (accessor: IAccessor, params: IMoveColsCommandParams) => {\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const {\n            fromRange: { startColumn: fromCol },\n            toRange: { startColumn: toCol },\n            range,\n        } = params;\n\n        // user can specify the range to move, or use the current selection\n        const selections = range ? [covertRangeToSelection(range)] : selectionManagerService.getCurrentSelections();\n\n        const filteredSelections = selections?.filter(\n            (selection) =>\n                selection.range.rangeType === RANGE_TYPE.COLUMN &&\n                selection.range.startColumn <= fromCol &&\n                fromCol <= selection.range.endColumn\n        );\n        if (filteredSelections?.length !== 1) {\n            return false;\n        }\n\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const target = getSheetCommandTarget(univerInstanceService, params);\n        if (!target) return false;\n\n        const { workbook, worksheet } = target;\n\n        const unitId = workbook.getUnitId();\n        const subUnitId = worksheet.getSheetId();\n\n        const errorService = accessor.get(ErrorService);\n        const localeService = accessor.get(LocaleService);\n        // Forbid action when some parts of a merged cell are selected.\n        const rangeToMove = filteredSelections[0].range;\n        const beforePrimary = filteredSelections[0].primary;\n        const alignedRange = alignToMergedCellsBorders(rangeToMove, worksheet, false);\n        if (!Rectangle.equals(rangeToMove, alignedRange)) {\n            errorService.emit(localeService.t('sheets.info.partOfCell'));\n            return false;\n        }\n\n        if (columnAcrossMergedCell(toCol, worksheet)) {\n            errorService.emit(localeService.t('sheets.info.acrossMergedCell'));\n            return false;\n        }\n\n        const destinationRange: IRange = {\n            ...rangeToMove,\n            startColumn: toCol,\n            endColumn: toCol + rangeToMove.endColumn - rangeToMove.startColumn,\n        };\n        const moveColsParams: IMoveColumnsMutationParams = {\n            unitId,\n            subUnitId,\n            sourceRange: rangeToMove,\n            targetRange: destinationRange,\n        };\n        const undoMoveColsParams = MoveColsMutationUndoFactory(accessor, moveColsParams);\n\n        const commandService = accessor.get(ICommandService);\n\n        const interceptorCommands = sheetInterceptorService.onCommandExecute({ id: MoveColsCommand.id, params });\n\n        const redos = [\n            ...(interceptorCommands.preRedos ?? []),\n            { id: MoveColsMutation.id, params: moveColsParams },\n        ];\n\n        const undos = [\n            ...(interceptorCommands.preUndos ?? []),\n            { id: MoveColsMutation.id, params: undoMoveColsParams },\n        ];\n\n        // Handle selection in user interaction, not when using the Facade API\n        if (beforePrimary) {\n            // we could just move the merged cells because other situations are not allowed\n            // we should only deal with merged cell that is between the range of the cols to move\n            const count = rangeToMove.endColumn - rangeToMove.startColumn + 1;\n            const movedLength = toCol - fromCol;\n            const moveBackward = movedLength < 0;\n\n            // deal with selections\n            const destSelection: IRange = moveBackward\n                ? destinationRange\n                : {\n                    ...destinationRange,\n                    startColumn: destinationRange.startColumn - count,\n                    endColumn: destinationRange.endColumn - count,\n                };\n            const setSelectionsParam: ISetSelectionsOperationParams = {\n                unitId,\n                subUnitId,\n                type: SelectionMoveType.MOVE_END,\n                selections: [{ range: destSelection, primary: getPrimaryForRange(destSelection, worksheet), style: null }],\n            };\n            const undoSetSelectionsParam: ISetSelectionsOperationParams = {\n                unitId,\n                subUnitId,\n                type: SelectionMoveType.MOVE_END,\n                selections: [{ range: rangeToMove, primary: beforePrimary, style: null }],\n            };\n\n            redos.push({ id: SetSelectionsOperation.id, params: setSelectionsParam });\n            undos.push({ id: SetSelectionsOperation.id, params: undoSetSelectionsParam });\n        }\n\n        redos.push(...interceptorCommands.redos);\n        undos.push(...interceptorCommands.undos);\n\n        const result = sequenceExecute(redos, commandService);\n\n        if (result.result) {\n            const undoRedoService = accessor.get(IUndoRedoService);\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: undos,\n                redoMutations: redos,\n            });\n            return true;\n        }\n\n        return true;\n    },\n};\n\nfunction covertRangeToSelection(range: IRange): ISelectionWithStyle {\n    return {\n        range,\n        primary: null,\n        style: null,\n    };\n}\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b356ec37cc66913b08ed8c3f176252e73893286b"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/reorder-range.mutation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/reorder-range.mutation.ts","statementMap":{"0":{"start":{"line":2,"column":47},"end":{"line":12,"column":1}},"1":{"start":{"line":3,"column":20},"end":{"line":3,"column":26}},"2":{"start":{"line":4,"column":19},"end":{"line":4,"column":21}},"3":{"start":{"line":5,"column":2},"end":{"line":7,"column":5}},"4":{"start":{"line":6,"column":4},"end":{"line":6,"column":47}},"5":{"start":{"line":8,"column":2},"end":{"line":11,"column":4}},"6":{"start":{"line":13,"column":36},"end":{"line":38,"column":1}},"7":{"start":{"line":17,"column":48},"end":{"line":17,"column":54}},"8":{"start":{"line":18,"column":34},"end":{"line":18,"column":70}},"9":{"start":{"line":19,"column":21},"end":{"line":19,"column":58}},"10":{"start":{"line":20,"column":22},"end":{"line":20,"column":59}},"11":{"start":{"line":21,"column":4},"end":{"line":23,"column":5}},"12":{"start":{"line":22,"column":6},"end":{"line":22,"column":19}},"13":{"start":{"line":24,"column":27},"end":{"line":24,"column":45}},"14":{"start":{"line":25,"column":4},"end":{"line":31,"column":7}},"15":{"start":{"line":26,"column":6},"end":{"line":30,"column":7}},"16":{"start":{"line":27,"column":26},"end":{"line":27,"column":36}},"17":{"start":{"line":28,"column":26},"end":{"line":28,"column":79}},"18":{"start":{"line":29,"column":8},"end":{"line":29,"column":53}},"19":{"start":{"line":32,"column":36},"end":{"line":32,"column":61}},"20":{"start":{"line":33,"column":4},"end":{"line":35,"column":7}},"21":{"start":{"line":34,"column":6},"end":{"line":34,"column":59}},"22":{"start":{"line":36,"column":4},"end":{"line":36,"column":16}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":47},"end":{"line":2,"column":48}},"loc":{"start":{"line":2,"column":59},"end":{"line":12,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":5,"column":29},"end":{"line":5,"column":30}},"loc":{"start":{"line":5,"column":38},"end":{"line":7,"column":3}},"line":5},"2":{"name":"(anonymous_2)","decl":{"start":{"line":16,"column":11},"end":{"line":16,"column":12}},"loc":{"start":{"line":16,"column":33},"end":{"line":37,"column":3}},"line":16},"3":{"name":"(anonymous_3)","decl":{"start":{"line":25,"column":25},"end":{"line":25,"column":26}},"loc":{"start":{"line":25,"column":39},"end":{"line":31,"column":5}},"line":25},"4":{"name":"(anonymous_4)","decl":{"start":{"line":33,"column":28},"end":{"line":33,"column":29}},"loc":{"start":{"line":33,"column":52},"end":{"line":35,"column":5}},"line":33}},"branchMap":{"0":{"loc":{"start":{"line":21,"column":4},"end":{"line":23,"column":5}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":23,"column":5}},{"start":{},"end":{}}],"line":21},"1":{"loc":{"start":{"line":26,"column":6},"end":{"line":30,"column":7}},"type":"if","locations":[{"start":{"line":26,"column":6},"end":{"line":30,"column":7}},{"start":{},"end":{}}],"line":26}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0},"b":{"0":[0,0],"1":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/reorder-range.mutation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellData, IMutation, IRange, Nullable, Workbook } from '@univerjs/core';\nimport type { ISheetCommandSharedParams } from '../../commands/utils/interface';\nimport { CommandType, IUniverInstanceService, ObjectMatrix, Range, Tools } from '@univerjs/core';\n\nexport interface IReorderRangeMutationParams extends ISheetCommandSharedParams {\n    range: IRange;\n    order: { [key: number]: number };\n}\n\nexport const ReorderRangeUndoMutationFactory = (params: IReorderRangeMutationParams): IReorderRangeMutationParams => {\n    const { order } = params;\n    const newOrder = {} as { [key: number]: number };\n    Object.keys(order).forEach((key) => {\n        newOrder[order[Number(key)]] = Number(key);\n    });\n    return {\n        ...params,\n        order: newOrder,\n    };\n};\n\nexport const ReorderRangeMutation: IMutation<IReorderRangeMutationParams> = {\n    id: 'sheet.mutation.reorder-range',\n    type: CommandType.MUTATION,\n    handler: (accessor, params) => {\n        const { subUnitId, unitId, range, order } = params;\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const workbook = univerInstanceService.getUnit(unitId) as Workbook;\n        const worksheet = workbook.getSheetBySheetId(subUnitId);\n        if (!worksheet) {\n            return false;\n        }\n        const cellDataMatrix = new ObjectMatrix<Nullable<ICellData>>();\n        Range.foreach(range, (row, col) => {\n            if (order.hasOwnProperty(row)) {\n                const targetRow = order[row];\n                const cloneCell = Tools.deepClone(worksheet.getCellRaw(targetRow, col));\n                cellDataMatrix.setValue(row, col, cloneCell);\n            }\n        });\n\n        const worksheetCellDataMatrix = worksheet.getCellMatrix();\n\n        cellDataMatrix.forValue((row, col, cellData) => {\n            worksheetCellDataMatrix.setValue(row, col, cellData);\n        });\n        return true;\n    },\n\n};\n"],"mappings":"AAkBA,SAAS,aAAa,wBAAwB,cAAc,OAAO,aAAa;AAOzE,aAAM,kCAAkC,CAAC,WAAqE;AACjH,QAAM,EAAE,MAAM,IAAI;AAClB,QAAM,WAAW,CAAC;AAClB,SAAO,KAAK,KAAK,EAAE,QAAQ,CAAC,QAAQ;AAChC,aAAS,MAAM,OAAO,GAAG,CAAC,CAAC,IAAI,OAAO,GAAG;AAAA,EAC7C,CAAC;AACD,SAAO;AAAA,IACH,GAAG;AAAA,IACH,OAAO;AAAA,EACX;AACJ;AAEO,aAAM,uBAA+D;AAAA,EACxE,IAAI;AAAA,EACJ,MAAM,YAAY;AAAA,EAClB,SAAS,CAAC,UAAU,WAAW;AAC3B,UAAM,EAAE,WAAW,QAAQ,OAAO,MAAM,IAAI;AAC5C,UAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,UAAM,WAAW,sBAAsB,QAAQ,MAAM;AACrD,UAAM,YAAY,SAAS,kBAAkB,SAAS;AACtD,QAAI,CAAC,WAAW;AACZ,aAAO;AAAA,IACX;AACA,UAAM,iBAAiB,IAAI,aAAkC;AAC7D,UAAM,QAAQ,OAAO,CAAC,KAAK,QAAQ;AAC/B,UAAI,MAAM,eAAe,GAAG,GAAG;AAC3B,cAAM,YAAY,MAAM,GAAG;AAC3B,cAAM,YAAY,MAAM,UAAU,UAAU,WAAW,WAAW,GAAG,CAAC;AACtE,uBAAe,SAAS,KAAK,KAAK,SAAS;AAAA,MAC/C;AAAA,IACJ,CAAC;AAED,UAAM,0BAA0B,UAAU,cAAc;AAExD,mBAAe,SAAS,CAAC,KAAK,KAAK,aAAa;AAC5C,8BAAwB,SAAS,KAAK,KAAK,QAAQ;AAAA,IACvD,CAAC;AACD,WAAO;AAAA,EACX;AAEJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f46052d6c14eb32fa84568dc3a22ab6de6395c35"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/reorder-range.command.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/reorder-range.command.ts","statementMap":{"0":{"start":{"line":4,"column":37},"end":{"line":4,"column":66}},"1":{"start":{"line":5,"column":35},"end":{"line":50,"column":1}},"2":{"start":{"line":9,"column":48},"end":{"line":9,"column":54}},"3":{"start":{"line":10,"column":27},"end":{"line":10,"column":56}},"4":{"start":{"line":11,"column":28},"end":{"line":19,"column":5}},"5":{"start":{"line":20,"column":32},"end":{"line":23,"column":5}},"6":{"start":{"line":24,"column":36},"end":{"line":24,"column":73}},"7":{"start":{"line":25,"column":32},"end":{"line":25,"column":112}},"8":{"start":{"line":26,"column":18},"end":{"line":30,"column":5}},"9":{"start":{"line":31,"column":18},"end":{"line":35,"column":5}},"10":{"start":{"line":36,"column":19},"end":{"line":36,"column":57}},"11":{"start":{"line":37,"column":35},"end":{"line":37,"column":118}},"12":{"start":{"line":38,"column":4},"end":{"line":47,"column":5}},"13":{"start":{"line":39,"column":6},"end":{"line":39,"column":68}},"14":{"start":{"line":40,"column":30},"end":{"line":40,"column":60}},"15":{"start":{"line":41,"column":6},"end":{"line":45,"column":9}},"16":{"start":{"line":46,"column":6},"end":{"line":46,"column":18}},"17":{"start":{"line":48,"column":4},"end":{"line":48,"column":17}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":11},"end":{"line":8,"column":12}},"loc":{"start":{"line":8,"column":33},"end":{"line":49,"column":3}},"line":8}},"branchMap":{"0":{"loc":{"start":{"line":27,"column":9},"end":{"line":27,"column":43}},"type":"binary-expr","locations":[{"start":{"line":27,"column":9},"end":{"line":27,"column":37}},{"start":{"line":27,"column":41},"end":{"line":27,"column":43}}],"line":27},"1":{"loc":{"start":{"line":32,"column":9},"end":{"line":32,"column":43}},"type":"binary-expr","locations":[{"start":{"line":32,"column":9},"end":{"line":32,"column":37}},{"start":{"line":32,"column":41},"end":{"line":32,"column":43}}],"line":32},"2":{"loc":{"start":{"line":38,"column":4},"end":{"line":47,"column":5}},"type":"if","locations":[{"start":{"line":38,"column":4},"end":{"line":47,"column":5}},{"start":{},"end":{}}],"line":38}},"s":{"0":1,"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},"f":{"0":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/reorder-range.command.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand, IRange } from '@univerjs/core';\nimport type { IReorderRangeMutationParams } from '../mutations/reorder-range.mutation';\nimport type { ISheetCommandSharedParams } from '../utils/interface';\nimport { CommandType, ICommandService, IUndoRedoService, sequenceExecute } from '@univerjs/core';\nimport { SheetInterceptorService } from '../../services/sheet-interceptor/sheet-interceptor.service';\nimport { ReorderRangeMutation, ReorderRangeUndoMutationFactory } from '../mutations/reorder-range.mutation';\n\nexport interface IReorderRangeCommandParams extends ISheetCommandSharedParams {\n    range: IRange;\n    order: { [key: number]: number };\n}\n\nexport const ReorderRangeCommandId = 'sheet.command.reorder-range' as const;\n\nexport const ReorderRangeCommand: ICommand<IReorderRangeCommandParams> = {\n    id: ReorderRangeCommandId,\n    type: CommandType.COMMAND,\n    handler: (accessor: IAccessor, params: IReorderRangeCommandParams) => {\n        const { subUnitId, unitId, range, order } = params;\n        const commandService = accessor.get(ICommandService);\n\n        const reorderMutation = {\n            id: ReorderRangeMutation.id,\n            params: {\n                unitId,\n                subUnitId,\n                order,\n                range,\n            } as IReorderRangeMutationParams,\n        };\n\n        const undoReorderMutation = {\n            id: ReorderRangeMutation.id,\n            params: ReorderRangeUndoMutationFactory(reorderMutation.params),\n        };\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n        const interceptorCommands = sheetInterceptorService.onCommandExecute({ id: ReorderRangeCommand.id, params });\n\n        const redos = [\n            ...(interceptorCommands.preRedos ?? []),\n            reorderMutation,\n            ...interceptorCommands.redos,\n        ];\n\n        const undos = [\n            ...(interceptorCommands.preUndos ?? []),\n            undoReorderMutation,\n            ...interceptorCommands.undos,\n        ];\n        const result = sequenceExecute(redos, commandService);\n\n        const reoderAfterIntercepted = sheetInterceptorService.afterCommandExecute({ id: ReorderRangeCommand.id, params });\n\n        if (result.result) {\n            sequenceExecute(reoderAfterIntercepted.redos, commandService);\n\n            const undoRedoService = accessor.get(IUndoRedoService);\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: [...undos, ...reoderAfterIntercepted.undos],\n                redoMutations: [...redos, ...reoderAfterIntercepted.redos],\n            });\n            return true;\n        }\n        return false;\n    },\n\n};\n"],"mappings":"AAmBA,SAAS,aAAa,iBAAiB,kBAAkB,uBAAuB;AAChF,SAAS,+BAA+B;AACxC,SAAS,sBAAsB,uCAAuC;AAO/D,aAAM,wBAAwB;AAE9B,aAAM,sBAA4D;AAAA,EACrE,IAAI;AAAA,EACJ,MAAM,YAAY;AAAA,EAClB,SAAS,CAAC,UAAqB,WAAuC;AAClE,UAAM,EAAE,WAAW,QAAQ,OAAO,MAAM,IAAI;AAC5C,UAAM,iBAAiB,SAAS,IAAI,eAAe;AAEnD,UAAM,kBAAkB;AAAA,MACpB,IAAI,qBAAqB;AAAA,MACzB,QAAQ;AAAA,QACJ;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACJ;AAAA,IACJ;AAEA,UAAM,sBAAsB;AAAA,MACxB,IAAI,qBAAqB;AAAA,MACzB,QAAQ,gCAAgC,gBAAgB,MAAM;AAAA,IAClE;AACA,UAAM,0BAA0B,SAAS,IAAI,uBAAuB;AACpE,UAAM,sBAAsB,wBAAwB,iBAAiB,EAAE,IAAI,oBAAoB,IAAI,OAAO,CAAC;AAE3G,UAAM,QAAQ;AAAA,MACV,GAAI,oBAAoB,YAAY,CAAC;AAAA,MACrC;AAAA,MACA,GAAG,oBAAoB;AAAA,IAC3B;AAEA,UAAM,QAAQ;AAAA,MACV,GAAI,oBAAoB,YAAY,CAAC;AAAA,MACrC;AAAA,MACA,GAAG,oBAAoB;AAAA,IAC3B;AACA,UAAM,SAAS,gBAAgB,OAAO,cAAc;AAEpD,UAAM,yBAAyB,wBAAwB,oBAAoB,EAAE,IAAI,oBAAoB,IAAI,OAAO,CAAC;AAEjH,QAAI,OAAO,QAAQ;AACf,sBAAgB,uBAAuB,OAAO,cAAc;AAE5D,YAAM,kBAAkB,SAAS,IAAI,gBAAgB;AACrD,sBAAgB,aAAa;AAAA,QACzB,QAAQ;AAAA,QACR,eAAe,CAAC,GAAG,OAAO,GAAG,uBAAuB,KAAK;AAAA,QACzD,eAAe,CAAC,GAAG,OAAO,GAAG,uBAAuB,KAAK;AAAA,MAC7D,CAAC;AACD,aAAO;AAAA,IACX;AACA,WAAO;AAAA,EACX;AAEJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ac4123e2372699a38e1e09a764ea72490853c043"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/ref-range/type.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/ref-range/type.ts","statementMap":{"0":{"start":{"line":10,"column":31},"end":{"line":23,"column":1}},"1":{"start":{"line":24,"column":42},"end":{"line":31,"column":22}},"2":{"start":{"line":25,"column":2},"end":{"line":25,"column":50}},"3":{"start":{"line":26,"column":2},"end":{"line":26,"column":56}},"4":{"start":{"line":27,"column":2},"end":{"line":27,"column":72}},"5":{"start":{"line":28,"column":2},"end":{"line":28,"column":68}},"6":{"start":{"line":29,"column":2},"end":{"line":29,"column":58}},"7":{"start":{"line":30,"column":2},"end":{"line":30,"column":23}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":24,"column":43},"end":{"line":24,"column":44}},"loc":{"start":{"line":24,"column":62},"end":{"line":31,"column":1}},"line":24}},"branchMap":{"0":{"loc":{"start":{"line":31,"column":3},"end":{"line":31,"column":21}},"type":"binary-expr","locations":[{"start":{"line":31,"column":3},"end":{"line":31,"column":15}},{"start":{"line":31,"column":19},"end":{"line":31,"column":21}}],"line":31}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1},"f":{"0":1},"b":{"0":[1,1]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/ref-range/type.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommandInfo, IRange } from '@univerjs/core';\n\nimport type { IDeleteRangeMoveLeftCommandParams } from '../../commands/commands/delete-range-move-left.command';\nimport { DeleteRangeMoveLeftCommandId } from '../../commands/commands/delete-range-move-left.command';\nimport type { IDeleteRangeMoveUpCommandParams } from '../../commands/commands/delete-range-move-up.command';\nimport { DeleteRangeMoveUpCommandId } from '../../commands/commands/delete-range-move-up.command';\nimport type { InsertRangeMoveDownCommandParams } from '../../commands/commands/insert-range-move-down.command';\nimport { InsertRangeMoveDownCommandId } from '../../commands/commands/insert-range-move-down.command';\nimport type { InsertRangeMoveRightCommandParams } from '../../commands/commands/insert-range-move-right.command';\nimport { InsertRangeMoveRightCommandId } from '../../commands/commands/insert-range-move-right.command';\nimport type { IInsertColCommandParams, IInsertRowCommandParams } from '../../commands/commands/insert-row-col.command';\nimport { InsertColCommandId, InsertRowCommandId } from '../../commands/commands/insert-row-col.command';\nimport type { IMoveRangeCommandParams } from '../../commands/commands/move-range.command';\nimport { MoveRangeCommandId } from '../../commands/commands/move-range.command';\nimport type { IMoveColsCommandParams, IMoveRowsCommandParams } from '../../commands/commands/move-rows-cols.command';\nimport { MoveColsCommandId, MoveRowsCommandId } from '../../commands/commands/move-rows-cols.command';\nimport type { IRemoveRowColCommandParams } from '../../commands/commands/remove-row-col.command';\nimport { RemoveColCommandId, RemoveRowCommandId } from '../../commands/commands/remove-row-col.command';\nimport type { IReorderRangeCommandParams } from '../../commands/commands/reorder-range.command';\nimport { ReorderRangeCommandId } from '../../commands/commands/reorder-range.command';\n\nexport type IMoveRowsCommand = ICommandInfo<IMoveRowsCommandParams> & { id: typeof MoveRowsCommandId };\nexport type IMoveColsCommand = ICommandInfo<IMoveColsCommandParams> & { id: typeof MoveColsCommandId };\n\nexport type IMoveRangeCommand = ICommandInfo<IMoveRangeCommandParams> & { id: typeof MoveRangeCommandId };\nexport type IInsertRowCommand = ICommandInfo<IInsertRowCommandParams> & { id: typeof InsertRowCommandId };\nexport type IInsertColCommand = ICommandInfo<IInsertColCommandParams> & { id: typeof InsertColCommandId };\nexport type IRemoveRowColCommand = ICommandInfo<IRemoveRowColCommandParams> & {\n    id: typeof RemoveColCommandId | typeof RemoveRowCommandId;\n};\nexport type IDeleteRangeMoveLeftCommand = ICommandInfo<IDeleteRangeMoveLeftCommandParams> & {\n    id: typeof DeleteRangeMoveLeftCommandId;\n};\nexport type IDeleteRangeMoveUpCommand = ICommandInfo<IDeleteRangeMoveUpCommandParams> & {\n    id: typeof DeleteRangeMoveUpCommandId;\n};\nexport type IInsertRangeMoveDownCommand = ICommandInfo<InsertRangeMoveDownCommandParams> & {\n    id: typeof InsertRangeMoveDownCommandId;\n};\nexport type IInsertRangeMoveRightCommand = ICommandInfo<InsertRangeMoveRightCommandParams> & {\n    id: typeof InsertRangeMoveRightCommandId;\n};\n\nexport type IReorderRangeCommand = ICommandInfo<IReorderRangeCommandParams> & { id: typeof ReorderRangeCommandId };\n\nexport type EffectRefRangeParams =\n    | IMoveRangeCommand\n    | IInsertRowCommand\n    | IInsertColCommand\n    | IRemoveRowColCommand\n    | IDeleteRangeMoveLeftCommand\n    | IDeleteRangeMoveUpCommand\n    | IInsertRangeMoveDownCommand\n    | IInsertRangeMoveRightCommand\n    | IMoveColsCommand\n    | IMoveRowsCommand\n    | IReorderRangeCommand;\n\nexport const EffectRefRangId = {\n    MoveRangeCommandId,\n    InsertRowCommandId,\n    InsertColCommandId,\n    RemoveColCommandId,\n    RemoveRowCommandId,\n    DeleteRangeMoveLeftCommandId,\n    DeleteRangeMoveUpCommandId,\n    InsertRangeMoveDownCommandId,\n    InsertRangeMoveRightCommandId,\n    MoveColsCommandId,\n    MoveRowsCommandId,\n    ReorderRangeCommandId,\n} as const;\n\nexport enum OperatorType {\n    Set = 0,\n    Delete,\n    HorizontalMove,\n    VerticalMove,\n    Unknown,\n}\n\nexport interface IDeleteOperator {\n    type: OperatorType.Delete;\n}\n\nexport interface ISetOperator {\n    type: OperatorType.Set;\n    range: IRange;\n}\n\nexport interface IHorizontalMoveOperator {\n    type: OperatorType.HorizontalMove;\n    step: number;\n    length?: number;\n}\n\nexport interface IVerticalMoveOperator {\n    type: OperatorType.VerticalMove;\n    step: number;\n    length?: number; // Do the step translation first, then delete from the end\n}\n\nexport interface IUnknownOperator {\n    type: OperatorType.Unknown;\n    commandInfo: EffectRefRangeParams;\n}\n\nexport type IOperator =\n    | IDeleteOperator\n    | IVerticalMoveOperator\n    | IHorizontalMoveOperator\n    | IUnknownOperator\n    | ISetOperator;\n"],"mappings":"AAmBA,SAAS,oCAAoC;AAE7C,SAAS,kCAAkC;AAE3C,SAAS,oCAAoC;AAE7C,SAAS,qCAAqC;AAE9C,SAAS,oBAAoB,0BAA0B;AAEvD,SAAS,0BAA0B;AAEnC,SAAS,mBAAmB,yBAAyB;AAErD,SAAS,oBAAoB,0BAA0B;AAEvD,SAAS,6BAA6B;AAuC/B,aAAM,kBAAkB;AAAA,EAC3B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ;AAEO,WAAK,eAAL,kBAAKA,kBAAL;AACH,EAAAA,4BAAA,SAAM,KAAN;AACA,EAAAA,4BAAA;AACA,EAAAA,4BAAA;AACA,EAAAA,4BAAA;AACA,EAAAA,4BAAA;AALQ,SAAAA;AAAA,GAAA;","names":["OperatorType"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"04606eec1e3fe02447438a540899a13940717039"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/ref-range/util.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/ref-range/util.ts","statementMap":{"0":{"start":{"line":14,"column":25},"end":{"line":14,"column":48}},"1":{"start":{"line":15,"column":36},"end":{"line":34,"column":1}},"2":{"start":{"line":16,"column":17},"end":{"line":16,"column":29}},"3":{"start":{"line":17,"column":19},"end":{"line":17,"column":151}},"4":{"start":{"line":18,"column":16},"end":{"line":18,"column":148}},"5":{"start":{"line":19,"column":2},"end":{"line":22,"column":3}},"6":{"start":{"line":20,"column":4},"end":{"line":20,"column":24}},"7":{"start":{"line":21,"column":4},"end":{"line":21,"column":37}},"8":{"start":{"line":23,"column":2},"end":{"line":26,"column":3}},"9":{"start":{"line":24,"column":4},"end":{"line":24,"column":27}},"10":{"start":{"line":25,"column":4},"end":{"line":25,"column":40}},"11":{"start":{"line":27,"column":2},"end":{"line":32,"column":3}},"12":{"start":{"line":28,"column":4},"end":{"line":28,"column":27}},"13":{"start":{"line":29,"column":4},"end":{"line":29,"column":40}},"14":{"start":{"line":30,"column":4},"end":{"line":30,"column":24}},"15":{"start":{"line":31,"column":4},"end":{"line":31,"column":37}},"16":{"start":{"line":33,"column":2},"end":{"line":33,"column":16}},"17":{"start":{"line":35,"column":37},"end":{"line":55,"column":1}},"18":{"start":{"line":36,"column":17},"end":{"line":36,"column":29}},"19":{"start":{"line":37,"column":2},"end":{"line":53,"column":3}},"20":{"start":{"line":38,"column":4},"end":{"line":38,"column":24}},"21":{"start":{"line":39,"column":4},"end":{"line":39,"column":27}},"22":{"start":{"line":40,"column":9},"end":{"line":53,"column":3}},"23":{"start":{"line":41,"column":4},"end":{"line":41,"column":27}},"24":{"start":{"line":42,"column":4},"end":{"line":42,"column":30}},"25":{"start":{"line":43,"column":9},"end":{"line":53,"column":3}},"26":{"start":{"line":44,"column":4},"end":{"line":44,"column":27}},"27":{"start":{"line":45,"column":4},"end":{"line":45,"column":24}},"28":{"start":{"line":46,"column":4},"end":{"line":46,"column":30}},"29":{"start":{"line":47,"column":4},"end":{"line":47,"column":27}},"30":{"start":{"line":49,"column":4},"end":{"line":49,"column":51}},"31":{"start":{"line":50,"column":4},"end":{"line":50,"column":52}},"32":{"start":{"line":51,"column":4},"end":{"line":51,"column":57}},"33":{"start":{"line":52,"column":4},"end":{"line":52,"column":58}},"34":{"start":{"line":54,"column":2},"end":{"line":54,"column":16}},"35":{"start":{"line":56,"column":27},"end":{"line":70,"column":1}},"36":{"start":{"line":57,"column":18},"end":{"line":57,"column":33}},"37":{"start":{"line":58,"column":2},"end":{"line":62,"column":3}},"38":{"start":{"line":59,"column":4},"end":{"line":59,"column":31}},"39":{"start":{"line":60,"column":9},"end":{"line":62,"column":3}},"40":{"start":{"line":61,"column":4},"end":{"line":61,"column":34}},"41":{"start":{"line":63,"column":2},"end":{"line":69,"column":4}},"42":{"start":{"line":71,"column":38},"end":{"line":158,"column":1}},"43":{"start":{"line":72,"column":23},"end":{"line":72,"column":41}},"44":{"start":{"line":73,"column":19},"end":{"line":73,"column":33}},"45":{"start":{"line":74,"column":24},"end":{"line":81,"column":3}},"46":{"start":{"line":75,"column":18},"end":{"line":75,"column":52}},"47":{"start":{"line":76,"column":16},"end":{"line":76,"column":46}},"48":{"start":{"line":77,"column":4},"end":{"line":79,"column":5}},"49":{"start":{"line":78,"column":6},"end":{"line":78,"column":18}},"50":{"start":{"line":80,"column":4},"end":{"line":80,"column":26}},"51":{"start":{"line":82,"column":20},"end":{"line":82,"column":55}},"52":{"start":{"line":82,"column":30},"end":{"line":82,"column":55}},"53":{"start":{"line":83,"column":22},"end":{"line":86,"column":4}},"54":{"start":{"line":83,"column":41},"end":{"line":86,"column":3}},"55":{"start":{"line":87,"column":22},"end":{"line":90,"column":4}},"56":{"start":{"line":87,"column":41},"end":{"line":90,"column":3}},"57":{"start":{"line":91,"column":24},"end":{"line":91,"column":55}},"58":{"start":{"line":92,"column":2},"end":{"line":96,"column":3}},"59":{"start":{"line":93,"column":17},"end":{"line":93,"column":77}},"60":{"start":{"line":94,"column":4},"end":{"line":94,"column":27}},"61":{"start":{"line":95,"column":4},"end":{"line":95,"column":25}},"62":{"start":{"line":97,"column":24},"end":{"line":97,"column":44}},"63":{"start":{"line":98,"column":22},"end":{"line":98,"column":35}},"64":{"start":{"line":99,"column":41},"end":{"line":99,"column":79}},"65":{"start":{"line":100,"column":40},"end":{"line":100,"column":142}},"66":{"start":{"line":101,"column":2},"end":{"line":130,"column":3}},"67":{"start":{"line":102,"column":4},"end":{"line":102,"column":40}},"68":{"start":{"line":103,"column":4},"end":{"line":103,"column":38}},"69":{"start":{"line":104,"column":9},"end":{"line":130,"column":3}},"70":{"start":{"line":105,"column":47},"end":{"line":105,"column":88}},"71":{"start":{"line":106,"column":4},"end":{"line":129,"column":5}},"72":{"start":{"line":107,"column":23},"end":{"line":107,"column":59}},"73":{"start":{"line":108,"column":22},"end":{"line":108,"column":53}},"74":{"start":{"line":109,"column":6},"end":{"line":109,"column":41}},"75":{"start":{"line":110,"column":6},"end":{"line":110,"column":37}},"76":{"start":{"line":111,"column":11},"end":{"line":129,"column":5}},"77":{"start":{"line":112,"column":6},"end":{"line":117,"column":7}},"78":{"start":{"line":113,"column":8},"end":{"line":113,"column":79}},"79":{"start":{"line":114,"column":8},"end":{"line":114,"column":44}},"80":{"start":{"line":116,"column":8},"end":{"line":116,"column":63}},"81":{"start":{"line":119,"column":6},"end":{"line":128,"column":7}},"82":{"start":{"line":120,"column":8},"end":{"line":120,"column":63}},"83":{"start":{"line":122,"column":8},"end":{"line":127,"column":9}},"84":{"start":{"line":123,"column":10},"end":{"line":123,"column":46}},"85":{"start":{"line":124,"column":10},"end":{"line":124,"column":81}},"86":{"start":{"line":126,"column":10},"end":{"line":126,"column":65}},"87":{"start":{"line":131,"column":39},"end":{"line":131,"column":76}},"88":{"start":{"line":132,"column":2},"end":{"line":153,"column":3}},"89":{"start":{"line":133,"column":4},"end":{"line":152,"column":5}},"90":{"start":{"line":134,"column":6},"end":{"line":134,"column":40}},"91":{"start":{"line":135,"column":6},"end":{"line":135,"column":38}},"92":{"start":{"line":136,"column":11},"end":{"line":152,"column":5}},"93":{"start":{"line":137,"column":6},"end":{"line":151,"column":7}},"94":{"start":{"line":138,"column":8},"end":{"line":143,"column":9}},"95":{"start":{"line":139,"column":10},"end":{"line":139,"column":42}},"96":{"start":{"line":140,"column":15},"end":{"line":143,"column":9}},"97":{"start":{"line":141,"column":10},"end":{"line":141,"column":42}},"98":{"start":{"line":142,"column":10},"end":{"line":142,"column":44}},"99":{"start":{"line":145,"column":8},"end":{"line":150,"column":9}},"100":{"start":{"line":146,"column":10},"end":{"line":146,"column":44}},"101":{"start":{"line":147,"column":10},"end":{"line":147,"column":42}},"102":{"start":{"line":148,"column":15},"end":{"line":150,"column":9}},"103":{"start":{"line":149,"column":10},"end":{"line":149,"column":42}},"104":{"start":{"line":154,"column":2},"end":{"line":157,"column":4}},"105":{"start":{"line":159,"column":30},"end":{"line":186,"column":1}},"106":{"start":{"line":160,"column":33},"end":{"line":160,"column":52}},"107":{"start":{"line":161,"column":2},"end":{"line":163,"column":3}},"108":{"start":{"line":162,"column":4},"end":{"line":162,"column":14}},"109":{"start":{"line":164,"column":21},"end":{"line":164,"column":52}},"110":{"start":{"line":165,"column":19},"end":{"line":165,"column":48}},"111":{"start":{"line":166,"column":23},"end":{"line":166,"column":56}},"112":{"start":{"line":167,"column":17},"end":{"line":171,"column":3}},"113":{"start":{"line":172,"column":2},"end":{"line":178,"column":3}},"114":{"start":{"line":173,"column":4},"end":{"line":177,"column":6}},"115":{"start":{"line":179,"column":2},"end":{"line":185,"column":4}},"116":{"start":{"line":187,"column":36},"end":{"line":202,"column":1}},"117":{"start":{"line":188,"column":33},"end":{"line":188,"column":52}},"118":{"start":{"line":189,"column":2},"end":{"line":191,"column":3}},"119":{"start":{"line":190,"column":4},"end":{"line":190,"column":25}},"120":{"start":{"line":192,"column":18},"end":{"line":192,"column":36}},"121":{"start":{"line":193,"column":16},"end":{"line":193,"column":57}},"122":{"start":{"line":194,"column":16},"end":{"line":194,"column":32}},"123":{"start":{"line":195,"column":17},"end":{"line":195,"column":35}},"124":{"start":{"line":196,"column":2},"end":{"line":198,"column":5}},"125":{"start":{"line":197,"column":4},"end":{"line":197,"column":33}},"126":{"start":{"line":199,"column":2},"end":{"line":199,"column":41}},"127":{"start":{"line":200,"column":14},"end":{"line":200,"column":63}},"128":{"start":{"line":200,"column":51},"end":{"line":200,"column":62}},"129":{"start":{"line":201,"column":2},"end":{"line":201,"column":13}},"130":{"start":{"line":203,"column":40},"end":{"line":225,"column":1}},"131":{"start":{"line":204,"column":27},"end":{"line":204,"column":45}},"132":{"start":{"line":205,"column":2},"end":{"line":207,"column":3}},"133":{"start":{"line":206,"column":4},"end":{"line":206,"column":25}},"134":{"start":{"line":208,"column":17},"end":{"line":208,"column":35}},"135":{"start":{"line":209,"column":2},"end":{"line":211,"column":5}},"136":{"start":{"line":210,"column":4},"end":{"line":210,"column":33}},"137":{"start":{"line":212,"column":22},"end":{"line":212,"column":40}},"138":{"start":{"line":213,"column":2},"end":{"line":219,"column":5}},"139":{"start":{"line":214,"column":4},"end":{"line":218,"column":5}},"140":{"start":{"line":215,"column":24},"end":{"line":215,"column":34}},"141":{"start":{"line":216,"column":24},"end":{"line":216,"column":60}},"142":{"start":{"line":217,"column":6},"end":{"line":217,"column":48}},"143":{"start":{"line":220,"column":2},"end":{"line":222,"column":5}},"144":{"start":{"line":221,"column":4},"end":{"line":221,"column":40}},"145":{"start":{"line":223,"column":14},"end":{"line":223,"column":63}},"146":{"start":{"line":223,"column":51},"end":{"line":223,"column":62}},"147":{"start":{"line":224,"column":2},"end":{"line":224,"column":13}},"148":{"start":{"line":226,"column":30},"end":{"line":253,"column":1}},"149":{"start":{"line":227,"column":33},"end":{"line":227,"column":52}},"150":{"start":{"line":228,"column":2},"end":{"line":230,"column":3}},"151":{"start":{"line":229,"column":4},"end":{"line":229,"column":14}},"152":{"start":{"line":231,"column":21},"end":{"line":231,"column":52}},"153":{"start":{"line":232,"column":19},"end":{"line":232,"column":48}},"154":{"start":{"line":233,"column":23},"end":{"line":233,"column":56}},"155":{"start":{"line":234,"column":17},"end":{"line":238,"column":3}},"156":{"start":{"line":239,"column":2},"end":{"line":245,"column":3}},"157":{"start":{"line":240,"column":4},"end":{"line":244,"column":6}},"158":{"start":{"line":246,"column":2},"end":{"line":252,"column":4}},"159":{"start":{"line":254,"column":36},"end":{"line":268,"column":1}},"160":{"start":{"line":255,"column":33},"end":{"line":255,"column":52}},"161":{"start":{"line":256,"column":2},"end":{"line":258,"column":3}},"162":{"start":{"line":257,"column":4},"end":{"line":257,"column":25}},"163":{"start":{"line":259,"column":18},"end":{"line":259,"column":39}},"164":{"start":{"line":260,"column":16},"end":{"line":260,"column":63}},"165":{"start":{"line":261,"column":16},"end":{"line":261,"column":35}},"166":{"start":{"line":262,"column":17},"end":{"line":262,"column":35}},"167":{"start":{"line":263,"column":2},"end":{"line":265,"column":5}},"168":{"start":{"line":264,"column":4},"end":{"line":264,"column":33}},"169":{"start":{"line":266,"column":2},"end":{"line":266,"column":44}},"170":{"start":{"line":267,"column":2},"end":{"line":267,"column":59}},"171":{"start":{"line":267,"column":46},"end":{"line":267,"column":57}},"172":{"start":{"line":269,"column":31},"end":{"line":295,"column":1}},"173":{"start":{"line":270,"column":18},"end":{"line":270,"column":39}},"174":{"start":{"line":271,"column":20},"end":{"line":271,"column":43}},"175":{"start":{"line":272,"column":2},"end":{"line":274,"column":3}},"176":{"start":{"line":273,"column":4},"end":{"line":273,"column":14}},"177":{"start":{"line":275,"column":20},"end":{"line":275,"column":22}},"178":{"start":{"line":276,"column":2},"end":{"line":280,"column":3}},"179":{"start":{"line":277,"column":4},"end":{"line":279,"column":7}},"180":{"start":{"line":281,"column":2},"end":{"line":293,"column":3}},"181":{"start":{"line":282,"column":4},"end":{"line":284,"column":7}},"182":{"start":{"line":285,"column":26},"end":{"line":285,"column":76}},"183":{"start":{"line":286,"column":26},"end":{"line":286,"column":76}},"184":{"start":{"line":287,"column":4},"end":{"line":292,"column":6}},"185":{"start":{"line":294,"column":2},"end":{"line":294,"column":19}},"186":{"start":{"line":296,"column":37},"end":{"line":337,"column":1}},"187":{"start":{"line":297,"column":18},"end":{"line":297,"column":39}},"188":{"start":{"line":298,"column":20},"end":{"line":298,"column":43}},"189":{"start":{"line":299,"column":2},"end":{"line":301,"column":3}},"190":{"start":{"line":300,"column":4},"end":{"line":300,"column":25}},"191":{"start":{"line":302,"column":2},"end":{"line":304,"column":3}},"192":{"start":{"line":303,"column":4},"end":{"line":303,"column":25}},"193":{"start":{"line":305,"column":2},"end":{"line":309,"column":3}},"194":{"start":{"line":306,"column":26},"end":{"line":306,"column":76}},"195":{"start":{"line":307,"column":26},"end":{"line":307,"column":76}},"196":{"start":{"line":308,"column":4},"end":{"line":308,"column":27}},"197":{"start":{"line":310,"column":17},"end":{"line":310,"column":35}},"198":{"start":{"line":311,"column":2},"end":{"line":313,"column":5}},"199":{"start":{"line":312,"column":4},"end":{"line":312,"column":33}},"200":{"start":{"line":314,"column":21},"end":{"line":314,"column":39}},"201":{"start":{"line":315,"column":24},"end":{"line":315,"column":71}},"202":{"start":{"line":316,"column":2},"end":{"line":321,"column":5}},"203":{"start":{"line":317,"column":4},"end":{"line":320,"column":5}},"204":{"start":{"line":318,"column":6},"end":{"line":318,"column":40}},"205":{"start":{"line":319,"column":6},"end":{"line":319,"column":39}},"206":{"start":{"line":322,"column":23},"end":{"line":322,"column":66}},"207":{"start":{"line":323,"column":20},"end":{"line":323,"column":57}},"208":{"start":{"line":324,"column":22},"end":{"line":329,"column":3}},"209":{"start":{"line":330,"column":2},"end":{"line":334,"column":5}},"210":{"start":{"line":331,"column":22},"end":{"line":331,"column":37}},"211":{"start":{"line":332,"column":22},"end":{"line":332,"column":40}},"212":{"start":{"line":333,"column":4},"end":{"line":333,"column":78}},"213":{"start":{"line":335,"column":14},"end":{"line":335,"column":63}},"214":{"start":{"line":335,"column":51},"end":{"line":335,"column":62}},"215":{"start":{"line":336,"column":2},"end":{"line":336,"column":13}},"216":{"start":{"line":338,"column":37},"end":{"line":372,"column":1}},"217":{"start":{"line":339,"column":22},"end":{"line":339,"column":56}},"218":{"start":{"line":340,"column":22},"end":{"line":340,"column":56}},"219":{"start":{"line":341,"column":20},"end":{"line":341,"column":70}},"220":{"start":{"line":341,"column":31},"end":{"line":341,"column":70}},"221":{"start":{"line":342,"column":23},"end":{"line":342,"column":67}},"222":{"start":{"line":342,"column":34},"end":{"line":342,"column":67}},"223":{"start":{"line":343,"column":2},"end":{"line":370,"column":3}},"224":{"start":{"line":344,"column":4},"end":{"line":354,"column":5}},"225":{"start":{"line":349,"column":31},"end":{"line":349,"column":80}},"226":{"start":{"line":350,"column":6},"end":{"line":353,"column":7}},"227":{"start":{"line":351,"column":23},"end":{"line":351,"column":51}},"228":{"start":{"line":352,"column":8},"end":{"line":352,"column":35}},"229":{"start":{"line":355,"column":4},"end":{"line":357,"column":5}},"230":{"start":{"line":356,"column":6},"end":{"line":356,"column":18}},"231":{"start":{"line":358,"column":4},"end":{"line":365,"column":5}},"232":{"start":{"line":359,"column":31},"end":{"line":359,"column":80}},"233":{"start":{"line":360,"column":6},"end":{"line":364,"column":7}},"234":{"start":{"line":361,"column":23},"end":{"line":361,"column":51}},"235":{"start":{"line":362,"column":21},"end":{"line":362,"column":76}},"236":{"start":{"line":363,"column":8},"end":{"line":363,"column":32}},"237":{"start":{"line":366,"column":4},"end":{"line":369,"column":5}},"238":{"start":{"line":367,"column":19},"end":{"line":367,"column":42}},"239":{"start":{"line":368,"column":6},"end":{"line":368,"column":33}},"240":{"start":{"line":371,"column":2},"end":{"line":371,"column":32}},"241":{"start":{"line":373,"column":32},"end":{"line":391,"column":1}},"242":{"start":{"line":374,"column":16},"end":{"line":374,"column":35}},"243":{"start":{"line":375,"column":2},"end":{"line":377,"column":3}},"244":{"start":{"line":376,"column":4},"end":{"line":376,"column":14}},"245":{"start":{"line":378,"column":20},"end":{"line":378,"column":22}},"246":{"start":{"line":379,"column":17},"end":{"line":379,"column":58}},"247":{"start":{"line":380,"column":2},"end":{"line":389,"column":3}},"248":{"start":{"line":381,"column":4},"end":{"line":381,"column":50}},"249":{"start":{"line":383,"column":29},"end":{"line":383,"column":35}},"250":{"start":{"line":384,"column":4},"end":{"line":388,"column":7}},"251":{"start":{"line":390,"column":2},"end":{"line":390,"column":19}},"252":{"start":{"line":392,"column":32},"end":{"line":410,"column":1}},"253":{"start":{"line":393,"column":16},"end":{"line":393,"column":35}},"254":{"start":{"line":394,"column":2},"end":{"line":396,"column":3}},"255":{"start":{"line":395,"column":4},"end":{"line":395,"column":14}},"256":{"start":{"line":397,"column":20},"end":{"line":397,"column":22}},"257":{"start":{"line":398,"column":17},"end":{"line":398,"column":84}},"258":{"start":{"line":399,"column":2},"end":{"line":408,"column":3}},"259":{"start":{"line":400,"column":4},"end":{"line":400,"column":50}},"260":{"start":{"line":402,"column":29},"end":{"line":402,"column":35}},"261":{"start":{"line":403,"column":4},"end":{"line":407,"column":7}},"262":{"start":{"line":409,"column":2},"end":{"line":409,"column":19}},"263":{"start":{"line":411,"column":34},"end":{"line":433,"column":1}},"264":{"start":{"line":412,"column":27},"end":{"line":412,"column":45}},"265":{"start":{"line":413,"column":2},"end":{"line":415,"column":3}},"266":{"start":{"line":414,"column":4},"end":{"line":414,"column":14}},"267":{"start":{"line":416,"column":2},"end":{"line":431,"column":3}},"268":{"start":{"line":417,"column":22},"end":{"line":417,"column":24}},"269":{"start":{"line":418,"column":22},"end":{"line":418,"column":42}},"270":{"start":{"line":419,"column":4},"end":{"line":429,"column":5}},"271":{"start":{"line":420,"column":6},"end":{"line":428,"column":7}},"272":{"start":{"line":421,"column":22},"end":{"line":421,"column":31}},"273":{"start":{"line":422,"column":8},"end":{"line":426,"column":11}},"274":{"start":{"line":427,"column":8},"end":{"line":427,"column":25}},"275":{"start":{"line":430,"column":4},"end":{"line":430,"column":14}},"276":{"start":{"line":432,"column":2},"end":{"line":432,"column":12}},"277":{"start":{"line":434,"column":37},"end":{"line":479,"column":1}},"278":{"start":{"line":435,"column":22},"end":{"line":435,"column":56}},"279":{"start":{"line":436,"column":22},"end":{"line":436,"column":56}},"280":{"start":{"line":437,"column":20},"end":{"line":437,"column":70}},"281":{"start":{"line":437,"column":31},"end":{"line":437,"column":70}},"282":{"start":{"line":438,"column":2},"end":{"line":440,"column":3}},"283":{"start":{"line":439,"column":4},"end":{"line":439,"column":34}},"284":{"start":{"line":441,"column":2},"end":{"line":457,"column":3}},"285":{"start":{"line":455,"column":19},"end":{"line":455,"column":41}},"286":{"start":{"line":456,"column":4},"end":{"line":456,"column":31}},"287":{"start":{"line":458,"column":2},"end":{"line":477,"column":3}},"288":{"start":{"line":475,"column":17},"end":{"line":475,"column":39}},"289":{"start":{"line":476,"column":4},"end":{"line":476,"column":31}},"290":{"start":{"line":478,"column":2},"end":{"line":478,"column":32}},"291":{"start":{"line":481,"column":20},"end":{"line":481,"column":22}},"292":{"start":{"line":482,"column":2},"end":{"line":486,"column":3}},"293":{"start":{"line":483,"column":4},"end":{"line":485,"column":7}},"294":{"start":{"line":487,"column":2},"end":{"line":499,"column":3}},"295":{"start":{"line":488,"column":4},"end":{"line":490,"column":7}},"296":{"start":{"line":491,"column":26},"end":{"line":491,"column":76}},"297":{"start":{"line":492,"column":26},"end":{"line":492,"column":76}},"298":{"start":{"line":493,"column":4},"end":{"line":498,"column":6}},"299":{"start":{"line":500,"column":2},"end":{"line":500,"column":19}},"300":{"start":{"line":503,"column":31},"end":{"line":517,"column":1}},"301":{"start":{"line":504,"column":16},"end":{"line":504,"column":35}},"302":{"start":{"line":505,"column":2},"end":{"line":507,"column":3}},"303":{"start":{"line":506,"column":4},"end":{"line":506,"column":14}},"304":{"start":{"line":508,"column":20},"end":{"line":508,"column":22}},"305":{"start":{"line":509,"column":17},"end":{"line":509,"column":84}},"306":{"start":{"line":510,"column":27},"end":{"line":510,"column":33}},"307":{"start":{"line":511,"column":2},"end":{"line":515,"column":5}},"308":{"start":{"line":516,"column":2},"end":{"line":516,"column":19}},"309":{"start":{"line":518,"column":31},"end":{"line":532,"column":1}},"310":{"start":{"line":519,"column":16},"end":{"line":519,"column":35}},"311":{"start":{"line":520,"column":2},"end":{"line":522,"column":3}},"312":{"start":{"line":521,"column":4},"end":{"line":521,"column":14}},"313":{"start":{"line":523,"column":20},"end":{"line":523,"column":22}},"314":{"start":{"line":524,"column":17},"end":{"line":524,"column":58}},"315":{"start":{"line":525,"column":27},"end":{"line":525,"column":33}},"316":{"start":{"line":526,"column":2},"end":{"line":530,"column":5}},"317":{"start":{"line":531,"column":2},"end":{"line":531,"column":19}},"318":{"start":{"line":533,"column":41},"end":{"line":547,"column":1}},"319":{"start":{"line":534,"column":16},"end":{"line":534,"column":35}},"320":{"start":{"line":535,"column":2},"end":{"line":537,"column":3}},"321":{"start":{"line":536,"column":4},"end":{"line":536,"column":14}},"322":{"start":{"line":538,"column":20},"end":{"line":538,"column":22}},"323":{"start":{"line":539,"column":17},"end":{"line":539,"column":84}},"324":{"start":{"line":540,"column":27},"end":{"line":540,"column":33}},"325":{"start":{"line":541,"column":2},"end":{"line":545,"column":5}},"326":{"start":{"line":546,"column":2},"end":{"line":546,"column":19}},"327":{"start":{"line":548,"column":47},"end":{"line":574,"column":1}},"328":{"start":{"line":549,"column":16},"end":{"line":549,"column":35}},"329":{"start":{"line":550,"column":2},"end":{"line":552,"column":3}},"330":{"start":{"line":551,"column":4},"end":{"line":551,"column":25}},"331":{"start":{"line":553,"column":20},"end":{"line":553,"column":53}},"332":{"start":{"line":554,"column":22},"end":{"line":558,"column":3}},"333":{"start":{"line":559,"column":23},"end":{"line":559,"column":67}},"334":{"start":{"line":560,"column":26},"end":{"line":560,"column":75}},"335":{"start":{"line":561,"column":2},"end":{"line":563,"column":3}},"336":{"start":{"line":562,"column":4},"end":{"line":562,"column":25}},"337":{"start":{"line":564,"column":17},"end":{"line":564,"column":35}},"338":{"start":{"line":565,"column":2},"end":{"line":569,"column":5}},"339":{"start":{"line":566,"column":4},"end":{"line":568,"column":7}},"340":{"start":{"line":567,"column":6},"end":{"line":567,"column":35}},"341":{"start":{"line":570,"column":2},"end":{"line":572,"column":5}},"342":{"start":{"line":571,"column":4},"end":{"line":571,"column":45}},"343":{"start":{"line":573,"column":2},"end":{"line":573,"column":51}},"344":{"start":{"line":573,"column":42},"end":{"line":573,"column":49}},"345":{"start":{"line":575,"column":42},"end":{"line":589,"column":1}},"346":{"start":{"line":576,"column":16},"end":{"line":576,"column":35}},"347":{"start":{"line":577,"column":2},"end":{"line":579,"column":3}},"348":{"start":{"line":578,"column":4},"end":{"line":578,"column":14}},"349":{"start":{"line":580,"column":20},"end":{"line":580,"column":22}},"350":{"start":{"line":581,"column":17},"end":{"line":581,"column":58}},"351":{"start":{"line":582,"column":27},"end":{"line":582,"column":33}},"352":{"start":{"line":583,"column":2},"end":{"line":587,"column":5}},"353":{"start":{"line":588,"column":2},"end":{"line":588,"column":19}},"354":{"start":{"line":590,"column":48},"end":{"line":616,"column":1}},"355":{"start":{"line":591,"column":16},"end":{"line":591,"column":35}},"356":{"start":{"line":592,"column":2},"end":{"line":594,"column":3}},"357":{"start":{"line":593,"column":4},"end":{"line":593,"column":25}},"358":{"start":{"line":595,"column":20},"end":{"line":595,"column":59}},"359":{"start":{"line":596,"column":22},"end":{"line":600,"column":3}},"360":{"start":{"line":601,"column":23},"end":{"line":601,"column":67}},"361":{"start":{"line":602,"column":26},"end":{"line":602,"column":75}},"362":{"start":{"line":603,"column":2},"end":{"line":605,"column":3}},"363":{"start":{"line":604,"column":4},"end":{"line":604,"column":25}},"364":{"start":{"line":606,"column":17},"end":{"line":606,"column":35}},"365":{"start":{"line":607,"column":2},"end":{"line":611,"column":5}},"366":{"start":{"line":608,"column":4},"end":{"line":610,"column":7}},"367":{"start":{"line":609,"column":6},"end":{"line":609,"column":35}},"368":{"start":{"line":612,"column":2},"end":{"line":614,"column":5}},"369":{"start":{"line":613,"column":4},"end":{"line":613,"column":45}},"370":{"start":{"line":615,"column":2},"end":{"line":615,"column":51}},"371":{"start":{"line":615,"column":42},"end":{"line":615,"column":49}},"372":{"start":{"line":617,"column":41},"end":{"line":635,"column":1}},"373":{"start":{"line":618,"column":16},"end":{"line":618,"column":35}},"374":{"start":{"line":619,"column":2},"end":{"line":621,"column":3}},"375":{"start":{"line":620,"column":4},"end":{"line":620,"column":14}},"376":{"start":{"line":622,"column":20},"end":{"line":622,"column":22}},"377":{"start":{"line":623,"column":17},"end":{"line":623,"column":58}},"378":{"start":{"line":624,"column":2},"end":{"line":633,"column":3}},"379":{"start":{"line":625,"column":4},"end":{"line":625,"column":50}},"380":{"start":{"line":627,"column":29},"end":{"line":627,"column":35}},"381":{"start":{"line":628,"column":4},"end":{"line":632,"column":7}},"382":{"start":{"line":634,"column":2},"end":{"line":634,"column":19}},"383":{"start":{"line":636,"column":47},"end":{"line":667,"column":1}},"384":{"start":{"line":637,"column":16},"end":{"line":637,"column":35}},"385":{"start":{"line":638,"column":2},"end":{"line":640,"column":3}},"386":{"start":{"line":639,"column":4},"end":{"line":639,"column":25}},"387":{"start":{"line":641,"column":21},"end":{"line":646,"column":3}},"388":{"start":{"line":647,"column":20},"end":{"line":647,"column":59}},"389":{"start":{"line":648,"column":28},"end":{"line":648,"column":71}},"390":{"start":{"line":649,"column":23},"end":{"line":649,"column":66}},"391":{"start":{"line":650,"column":26},"end":{"line":650,"column":74}},"392":{"start":{"line":651,"column":2},"end":{"line":653,"column":3}},"393":{"start":{"line":652,"column":4},"end":{"line":652,"column":25}},"394":{"start":{"line":654,"column":17},"end":{"line":654,"column":35}},"395":{"start":{"line":655,"column":2},"end":{"line":657,"column":5}},"396":{"start":{"line":656,"column":4},"end":{"line":656,"column":45}},"397":{"start":{"line":658,"column":2},"end":{"line":660,"column":5}},"398":{"start":{"line":659,"column":4},"end":{"line":659,"column":45}},"399":{"start":{"line":661,"column":2},"end":{"line":665,"column":5}},"400":{"start":{"line":662,"column":4},"end":{"line":664,"column":7}},"401":{"start":{"line":663,"column":6},"end":{"line":663,"column":35}},"402":{"start":{"line":666,"column":2},"end":{"line":666,"column":51}},"403":{"start":{"line":666,"column":42},"end":{"line":666,"column":49}},"404":{"start":{"line":668,"column":39},"end":{"line":686,"column":1}},"405":{"start":{"line":669,"column":16},"end":{"line":669,"column":35}},"406":{"start":{"line":670,"column":2},"end":{"line":672,"column":3}},"407":{"start":{"line":671,"column":4},"end":{"line":671,"column":14}},"408":{"start":{"line":673,"column":20},"end":{"line":673,"column":22}},"409":{"start":{"line":674,"column":17},"end":{"line":674,"column":84}},"410":{"start":{"line":675,"column":2},"end":{"line":684,"column":3}},"411":{"start":{"line":676,"column":4},"end":{"line":676,"column":50}},"412":{"start":{"line":678,"column":29},"end":{"line":678,"column":35}},"413":{"start":{"line":679,"column":4},"end":{"line":683,"column":7}},"414":{"start":{"line":685,"column":2},"end":{"line":685,"column":19}},"415":{"start":{"line":687,"column":45},"end":{"line":717,"column":1}},"416":{"start":{"line":688,"column":16},"end":{"line":688,"column":35}},"417":{"start":{"line":689,"column":2},"end":{"line":691,"column":3}},"418":{"start":{"line":690,"column":4},"end":{"line":690,"column":25}},"419":{"start":{"line":692,"column":22},"end":{"line":696,"column":3}},"420":{"start":{"line":697,"column":20},"end":{"line":697,"column":53}},"421":{"start":{"line":698,"column":28},"end":{"line":698,"column":71}},"422":{"start":{"line":699,"column":23},"end":{"line":699,"column":67}},"423":{"start":{"line":700,"column":26},"end":{"line":700,"column":75}},"424":{"start":{"line":701,"column":2},"end":{"line":703,"column":3}},"425":{"start":{"line":702,"column":4},"end":{"line":702,"column":25}},"426":{"start":{"line":704,"column":17},"end":{"line":704,"column":35}},"427":{"start":{"line":705,"column":2},"end":{"line":707,"column":5}},"428":{"start":{"line":706,"column":4},"end":{"line":706,"column":45}},"429":{"start":{"line":708,"column":2},"end":{"line":710,"column":5}},"430":{"start":{"line":709,"column":4},"end":{"line":709,"column":45}},"431":{"start":{"line":711,"column":2},"end":{"line":715,"column":5}},"432":{"start":{"line":712,"column":4},"end":{"line":714,"column":7}},"433":{"start":{"line":713,"column":6},"end":{"line":713,"column":35}},"434":{"start":{"line":716,"column":2},"end":{"line":716,"column":51}},"435":{"start":{"line":716,"column":42},"end":{"line":716,"column":49}},"436":{"start":{"line":718,"column":37},"end":{"line":731,"column":1}},"437":{"start":{"line":719,"column":17},"end":{"line":719,"column":46}},"438":{"start":{"line":720,"column":17},"end":{"line":720,"column":35}},"439":{"start":{"line":721,"column":2},"end":{"line":723,"column":5}},"440":{"start":{"line":722,"column":4},"end":{"line":722,"column":33}},"441":{"start":{"line":724,"column":2},"end":{"line":729,"column":5}},"442":{"start":{"line":725,"column":21},"end":{"line":725,"column":35}},"443":{"start":{"line":726,"column":19},"end":{"line":726,"column":31}},"444":{"start":{"line":727,"column":18},"end":{"line":727,"column":39}},"445":{"start":{"line":728,"column":4},"end":{"line":728,"column":39}},"446":{"start":{"line":730,"column":2},"end":{"line":730,"column":59}},"447":{"start":{"line":730,"column":46},"end":{"line":730,"column":57}},"448":{"start":{"line":732,"column":37},"end":{"line":753,"column":1}},"449":{"start":{"line":733,"column":16},"end":{"line":733,"column":27}},"450":{"start":{"line":734,"column":20},"end":{"line":734,"column":40}},"451":{"start":{"line":735,"column":22},"end":{"line":735,"column":67}},"452":{"start":{"line":736,"column":2},"end":{"line":752,"column":3}},"453":{"start":{"line":737,"column":4},"end":{"line":742,"column":7}},"454":{"start":{"line":743,"column":9},"end":{"line":752,"column":3}},"455":{"start":{"line":744,"column":4},"end":{"line":744,"column":25}},"456":{"start":{"line":746,"column":4},"end":{"line":751,"column":7}},"457":{"start":{"line":754,"column":37},"end":{"line":775,"column":1}},"458":{"start":{"line":755,"column":16},"end":{"line":755,"column":27}},"459":{"start":{"line":756,"column":23},"end":{"line":756,"column":46}},"460":{"start":{"line":757,"column":22},"end":{"line":757,"column":73}},"461":{"start":{"line":758,"column":2},"end":{"line":774,"column":3}},"462":{"start":{"line":759,"column":4},"end":{"line":764,"column":7}},"463":{"start":{"line":765,"column":9},"end":{"line":774,"column":3}},"464":{"start":{"line":766,"column":4},"end":{"line":766,"column":25}},"465":{"start":{"line":768,"column":4},"end":{"line":773,"column":7}},"466":{"start":{"line":776,"column":36},"end":{"line":812,"column":1}},"467":{"start":{"line":777,"column":15},"end":{"line":777,"column":27}},"468":{"start":{"line":778,"column":2},"end":{"line":805,"column":5}},"469":{"start":{"line":779,"column":4},"end":{"line":804,"column":5}},"470":{"start":{"line":781,"column":8},"end":{"line":781,"column":22}},"471":{"start":{"line":782,"column":8},"end":{"line":782,"column":14}},"472":{"start":{"line":785,"column":8},"end":{"line":787,"column":9}},"473":{"start":{"line":786,"column":10},"end":{"line":786,"column":17}},"474":{"start":{"line":788,"column":8},"end":{"line":788,"column":44}},"475":{"start":{"line":789,"column":8},"end":{"line":789,"column":67}},"476":{"start":{"line":790,"column":8},"end":{"line":790,"column":14}},"477":{"start":{"line":793,"column":8},"end":{"line":795,"column":9}},"478":{"start":{"line":794,"column":10},"end":{"line":794,"column":17}},"479":{"start":{"line":796,"column":8},"end":{"line":796,"column":41}},"480":{"start":{"line":797,"column":8},"end":{"line":797,"column":64}},"481":{"start":{"line":798,"column":8},"end":{"line":798,"column":14}},"482":{"start":{"line":801,"column":8},"end":{"line":801,"column":32}},"483":{"start":{"line":802,"column":8},"end":{"line":802,"column":14}},"484":{"start":{"line":806,"column":2},"end":{"line":810,"column":3}},"485":{"start":{"line":807,"column":4},"end":{"line":809,"column":5}},"486":{"start":{"line":808,"column":6},"end":{"line":808,"column":18}},"487":{"start":{"line":811,"column":2},"end":{"line":811,"column":16}},"488":{"start":{"line":813,"column":61},"end":{"line":867,"column":1}},"489":{"start":{"line":814,"column":17},"end":{"line":814,"column":19}},"490":{"start":{"line":815,"column":2},"end":{"line":864,"column":3}},"491":{"start":{"line":817,"column":6},"end":{"line":817,"column":63}},"492":{"start":{"line":818,"column":6},"end":{"line":818,"column":12}},"493":{"start":{"line":821,"column":6},"end":{"line":821,"column":61}},"494":{"start":{"line":822,"column":6},"end":{"line":822,"column":12}},"495":{"start":{"line":825,"column":6},"end":{"line":825,"column":53}},"496":{"start":{"line":826,"column":6},"end":{"line":826,"column":12}},"497":{"start":{"line":829,"column":6},"end":{"line":829,"column":63}},"498":{"start":{"line":830,"column":6},"end":{"line":830,"column":12}},"499":{"start":{"line":833,"column":6},"end":{"line":833,"column":64}},"500":{"start":{"line":834,"column":6},"end":{"line":834,"column":12}},"501":{"start":{"line":837,"column":6},"end":{"line":837,"column":53}},"502":{"start":{"line":838,"column":6},"end":{"line":838,"column":12}},"503":{"start":{"line":841,"column":6},"end":{"line":841,"column":52}},"504":{"start":{"line":842,"column":6},"end":{"line":842,"column":12}},"505":{"start":{"line":845,"column":6},"end":{"line":845,"column":53}},"506":{"start":{"line":846,"column":6},"end":{"line":846,"column":12}},"507":{"start":{"line":849,"column":6},"end":{"line":849,"column":52}},"508":{"start":{"line":850,"column":6},"end":{"line":850,"column":12}},"509":{"start":{"line":853,"column":6},"end":{"line":853,"column":54}},"510":{"start":{"line":854,"column":6},"end":{"line":854,"column":12}},"511":{"start":{"line":857,"column":6},"end":{"line":857,"column":54}},"512":{"start":{"line":858,"column":6},"end":{"line":858,"column":12}},"513":{"start":{"line":861,"column":6},"end":{"line":861,"column":56}},"514":{"start":{"line":862,"column":6},"end":{"line":862,"column":12}},"515":{"start":{"line":865,"column":22},"end":{"line":865,"column":59}},"516":{"start":{"line":866,"column":2},"end":{"line":866,"column":21}},"517":{"start":{"line":868,"column":76},"end":{"line":878,"column":1}},"518":{"start":{"line":869,"column":23},"end":{"line":869,"column":83}},"519":{"start":{"line":870,"column":2},"end":{"line":872,"column":3}},"520":{"start":{"line":871,"column":4},"end":{"line":871,"column":77}},"521":{"start":{"line":873,"column":23},"end":{"line":873,"column":68}},"522":{"start":{"line":874,"column":2},"end":{"line":876,"column":3}},"523":{"start":{"line":874,"column":41},"end":{"line":874,"column":81}},"524":{"start":{"line":875,"column":4},"end":{"line":875,"column":77}},"525":{"start":{"line":877,"column":2},"end":{"line":877,"column":15}},"526":{"start":{"line":879,"column":67},"end":{"line":922,"column":1}},"527":{"start":{"line":880,"column":17},"end":{"line":880,"column":19}},"528":{"start":{"line":881,"column":2},"end":{"line":919,"column":3}},"529":{"start":{"line":883,"column":6},"end":{"line":883,"column":65}},"530":{"start":{"line":886,"column":6},"end":{"line":886,"column":63}},"531":{"start":{"line":889,"column":6},"end":{"line":889,"column":65}},"532":{"start":{"line":892,"column":6},"end":{"line":892,"column":66}},"533":{"start":{"line":895,"column":6},"end":{"line":895,"column":55}},"534":{"start":{"line":898,"column":6},"end":{"line":898,"column":55}},"535":{"start":{"line":901,"column":6},"end":{"line":901,"column":54}},"536":{"start":{"line":904,"column":6},"end":{"line":904,"column":55}},"537":{"start":{"line":907,"column":6},"end":{"line":907,"column":54}},"538":{"start":{"line":910,"column":6},"end":{"line":910,"column":58}},"539":{"start":{"line":913,"column":6},"end":{"line":913,"column":54}},"540":{"start":{"line":914,"column":6},"end":{"line":914,"column":12}},"541":{"start":{"line":917,"column":6},"end":{"line":917,"column":62}},"542":{"start":{"line":920,"column":22},"end":{"line":920,"column":59}},"543":{"start":{"line":921,"column":2},"end":{"line":921,"column":42}},"544":{"start":{"line":923,"column":75},"end":{"line":933,"column":1}},"545":{"start":{"line":924,"column":23},"end":{"line":924,"column":145}},"546":{"start":{"line":925,"column":2},"end":{"line":927,"column":3}},"547":{"start":{"line":926,"column":4},"end":{"line":926,"column":83}},"548":{"start":{"line":928,"column":23},"end":{"line":928,"column":68}},"549":{"start":{"line":929,"column":2},"end":{"line":931,"column":3}},"550":{"start":{"line":929,"column":41},"end":{"line":929,"column":81}},"551":{"start":{"line":930,"column":4},"end":{"line":930,"column":83}},"552":{"start":{"line":932,"column":2},"end":{"line":932,"column":15}},"553":{"start":{"line":935,"column":25},"end":{"line":935,"column":33}},"554":{"start":{"line":936,"column":26},"end":{"line":940,"column":3}},"555":{"start":{"line":941,"column":2},"end":{"line":998,"column":3}},"556":{"start":{"line":943,"column":6},"end":{"line":943,"column":51}},"557":{"start":{"line":944,"column":6},"end":{"line":944,"column":12}},"558":{"start":{"line":946,"column":6},"end":{"line":950,"column":8}},"559":{"start":{"line":951,"column":6},"end":{"line":951,"column":57}},"560":{"start":{"line":952,"column":6},"end":{"line":952,"column":12}},"561":{"start":{"line":954,"column":6},"end":{"line":958,"column":8}},"562":{"start":{"line":959,"column":6},"end":{"line":959,"column":59}},"563":{"start":{"line":960,"column":6},"end":{"line":960,"column":12}},"564":{"start":{"line":962,"column":6},"end":{"line":962,"column":69}},"565":{"start":{"line":963,"column":6},"end":{"line":967,"column":7}},"566":{"start":{"line":964,"column":8},"end":{"line":964,"column":61}},"567":{"start":{"line":966,"column":8},"end":{"line":966,"column":78}},"568":{"start":{"line":968,"column":6},"end":{"line":968,"column":12}},"569":{"start":{"line":970,"column":6},"end":{"line":970,"column":95}},"570":{"start":{"line":971,"column":6},"end":{"line":975,"column":7}},"571":{"start":{"line":972,"column":8},"end":{"line":972,"column":59}},"572":{"start":{"line":974,"column":8},"end":{"line":974,"column":78}},"573":{"start":{"line":976,"column":6},"end":{"line":976,"column":12}},"574":{"start":{"line":978,"column":6},"end":{"line":978,"column":95}},"575":{"start":{"line":979,"column":6},"end":{"line":979,"column":57}},"576":{"start":{"line":980,"column":6},"end":{"line":980,"column":12}},"577":{"start":{"line":982,"column":6},"end":{"line":982,"column":69}},"578":{"start":{"line":983,"column":6},"end":{"line":983,"column":59}},"579":{"start":{"line":984,"column":6},"end":{"line":984,"column":12}},"580":{"start":{"line":987,"column":26},"end":{"line":987,"column":86}},"581":{"start":{"line":988,"column":24},"end":{"line":988,"column":80}},"582":{"start":{"line":989,"column":8},"end":{"line":993,"column":10}},"583":{"start":{"line":995,"column":6},"end":{"line":995,"column":12}},"584":{"start":{"line":997,"column":6},"end":{"line":997,"column":12}},"585":{"start":{"line":999,"column":2},"end":{"line":1003,"column":3}},"586":{"start":{"line":1000,"column":4},"end":{"line":1000,"column":144}},"587":{"start":{"line":1002,"column":4},"end":{"line":1002,"column":17}},"588":{"start":{"line":1006,"column":38},"end":{"line":1006,"column":42}},"589":{"start":{"line":1007,"column":2},"end":{"line":1100,"column":3}},"590":{"start":{"line":1009,"column":21},"end":{"line":1009,"column":35}},"591":{"start":{"line":1010,"column":6},"end":{"line":1017,"column":8}},"592":{"start":{"line":1020,"column":21},"end":{"line":1020,"column":35}},"593":{"start":{"line":1021,"column":6},"end":{"line":1028,"column":8}},"594":{"start":{"line":1031,"column":21},"end":{"line":1031,"column":28}},"595":{"start":{"line":1032,"column":6},"end":{"line":1032,"column":62}},"596":{"start":{"line":1035,"column":21},"end":{"line":1035,"column":28}},"597":{"start":{"line":1036,"column":20},"end":{"line":1036,"column":39}},"598":{"start":{"line":1037,"column":6},"end":{"line":1043,"column":8}},"599":{"start":{"line":1046,"column":21},"end":{"line":1046,"column":28}},"600":{"start":{"line":1047,"column":20},"end":{"line":1047,"column":39}},"601":{"start":{"line":1048,"column":6},"end":{"line":1054,"column":8}},"602":{"start":{"line":1057,"column":21},"end":{"line":1057,"column":28}},"603":{"start":{"line":1058,"column":20},"end":{"line":1058,"column":39}},"604":{"start":{"line":1059,"column":6},"end":{"line":1059,"column":21}},"605":{"start":{"line":1062,"column":21},"end":{"line":1062,"column":28}},"606":{"start":{"line":1063,"column":20},"end":{"line":1063,"column":39}},"607":{"start":{"line":1064,"column":6},"end":{"line":1064,"column":21}},"608":{"start":{"line":1068,"column":21},"end":{"line":1068,"column":28}},"609":{"start":{"line":1069,"column":20},"end":{"line":1069,"column":116}},"610":{"start":{"line":1069,"column":103},"end":{"line":1069,"column":110}},"611":{"start":{"line":1070,"column":6},"end":{"line":1072,"column":7}},"612":{"start":{"line":1071,"column":8},"end":{"line":1071,"column":18}},"613":{"start":{"line":1073,"column":6},"end":{"line":1073,"column":21}},"614":{"start":{"line":1077,"column":21},"end":{"line":1077,"column":28}},"615":{"start":{"line":1078,"column":20},"end":{"line":1078,"column":116}},"616":{"start":{"line":1078,"column":103},"end":{"line":1078,"column":110}},"617":{"start":{"line":1079,"column":6},"end":{"line":1081,"column":7}},"618":{"start":{"line":1080,"column":8},"end":{"line":1080,"column":18}},"619":{"start":{"line":1082,"column":6},"end":{"line":1082,"column":21}},"620":{"start":{"line":1085,"column":21},"end":{"line":1085,"column":28}},"621":{"start":{"line":1086,"column":31},"end":{"line":1086,"column":44}},"622":{"start":{"line":1087,"column":27},"end":{"line":1087,"column":29}},"623":{"start":{"line":1088,"column":6},"end":{"line":1097,"column":7}},"624":{"start":{"line":1088,"column":21},"end":{"line":1088,"column":35}},"625":{"start":{"line":1089,"column":8},"end":{"line":1096,"column":9}},"626":{"start":{"line":1090,"column":10},"end":{"line":1095,"column":13}},"627":{"start":{"line":1098,"column":6},"end":{"line":1098,"column":26}},"628":{"start":{"line":1103,"column":2},"end":{"line":1164,"column":3}},"629":{"start":{"line":1105,"column":21},"end":{"line":1105,"column":36}},"630":{"start":{"line":1106,"column":6},"end":{"line":1113,"column":8}},"631":{"start":{"line":1116,"column":21},"end":{"line":1116,"column":36}},"632":{"start":{"line":1117,"column":6},"end":{"line":1124,"column":8}},"633":{"start":{"line":1127,"column":21},"end":{"line":1127,"column":36}},"634":{"start":{"line":1128,"column":6},"end":{"line":1128,"column":108}},"635":{"start":{"line":1131,"column":21},"end":{"line":1131,"column":36}},"636":{"start":{"line":1132,"column":20},"end":{"line":1132,"column":32}},"637":{"start":{"line":1133,"column":6},"end":{"line":1139,"column":8}},"638":{"start":{"line":1142,"column":21},"end":{"line":1142,"column":36}},"639":{"start":{"line":1143,"column":20},"end":{"line":1143,"column":32}},"640":{"start":{"line":1144,"column":6},"end":{"line":1150,"column":8}},"641":{"start":{"line":1153,"column":21},"end":{"line":1153,"column":36}},"642":{"start":{"line":1154,"column":20},"end":{"line":1154,"column":32}},"643":{"start":{"line":1155,"column":6},"end":{"line":1155,"column":21}},"644":{"start":{"line":1158,"column":21},"end":{"line":1158,"column":36}},"645":{"start":{"line":1159,"column":20},"end":{"line":1159,"column":32}},"646":{"start":{"line":1160,"column":6},"end":{"line":1160,"column":21}},"647":{"start":{"line":1163,"column":6},"end":{"line":1163,"column":12}},"648":{"start":{"line":1167,"column":32},"end":{"line":1167,"column":68}},"649":{"start":{"line":1168,"column":34},"end":{"line":1168,"column":71}},"650":{"start":{"line":1169,"column":2},"end":{"line":1362,"column":3}},"651":{"start":{"line":1171,"column":21},"end":{"line":1171,"column":35}},"652":{"start":{"line":1172,"column":21},"end":{"line":1175,"column":8}},"653":{"start":{"line":1176,"column":6},"end":{"line":1187,"column":8}},"654":{"start":{"line":1190,"column":21},"end":{"line":1190,"column":35}},"655":{"start":{"line":1191,"column":21},"end":{"line":1194,"column":8}},"656":{"start":{"line":1195,"column":6},"end":{"line":1206,"column":8}},"657":{"start":{"line":1209,"column":21},"end":{"line":1209,"column":35}},"658":{"start":{"line":1210,"column":21},"end":{"line":1210,"column":65}},"659":{"start":{"line":1211,"column":6},"end":{"line":1215,"column":8}},"660":{"start":{"line":1218,"column":21},"end":{"line":1218,"column":35}},"661":{"start":{"line":1219,"column":20},"end":{"line":1219,"column":32}},"662":{"start":{"line":1220,"column":6},"end":{"line":1235,"column":8}},"663":{"start":{"line":1238,"column":21},"end":{"line":1238,"column":35}},"664":{"start":{"line":1239,"column":20},"end":{"line":1239,"column":32}},"665":{"start":{"line":1240,"column":6},"end":{"line":1255,"column":8}},"666":{"start":{"line":1258,"column":21},"end":{"line":1258,"column":35}},"667":{"start":{"line":1259,"column":20},"end":{"line":1259,"column":32}},"668":{"start":{"line":1260,"column":21},"end":{"line":1260,"column":65}},"669":{"start":{"line":1261,"column":6},"end":{"line":1272,"column":8}},"670":{"start":{"line":1275,"column":21},"end":{"line":1275,"column":35}},"671":{"start":{"line":1276,"column":20},"end":{"line":1276,"column":32}},"672":{"start":{"line":1277,"column":21},"end":{"line":1277,"column":65}},"673":{"start":{"line":1278,"column":6},"end":{"line":1289,"column":8}},"674":{"start":{"line":1293,"column":21},"end":{"line":1293,"column":28}},"675":{"start":{"line":1294,"column":21},"end":{"line":1294,"column":65}},"676":{"start":{"line":1295,"column":20},"end":{"line":1295,"column":116}},"677":{"start":{"line":1295,"column":103},"end":{"line":1295,"column":110}},"678":{"start":{"line":1296,"column":6},"end":{"line":1302,"column":7}},"679":{"start":{"line":1297,"column":8},"end":{"line":1301,"column":10}},"680":{"start":{"line":1303,"column":6},"end":{"line":1314,"column":8}},"681":{"start":{"line":1318,"column":21},"end":{"line":1318,"column":28}},"682":{"start":{"line":1319,"column":20},"end":{"line":1319,"column":116}},"683":{"start":{"line":1319,"column":103},"end":{"line":1319,"column":110}},"684":{"start":{"line":1320,"column":21},"end":{"line":1320,"column":65}},"685":{"start":{"line":1321,"column":6},"end":{"line":1327,"column":7}},"686":{"start":{"line":1322,"column":8},"end":{"line":1326,"column":10}},"687":{"start":{"line":1328,"column":6},"end":{"line":1339,"column":8}},"688":{"start":{"line":1342,"column":21},"end":{"line":1342,"column":28}},"689":{"start":{"line":1343,"column":31},"end":{"line":1343,"column":44}},"690":{"start":{"line":1344,"column":27},"end":{"line":1344,"column":29}},"691":{"start":{"line":1345,"column":6},"end":{"line":1354,"column":7}},"692":{"start":{"line":1345,"column":21},"end":{"line":1345,"column":35}},"693":{"start":{"line":1346,"column":8},"end":{"line":1353,"column":9}},"694":{"start":{"line":1347,"column":10},"end":{"line":1352,"column":13}},"695":{"start":{"line":1355,"column":21},"end":{"line":1355,"column":65}},"696":{"start":{"line":1356,"column":6},"end":{"line":1360,"column":8}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":15,"column":36},"end":{"line":15,"column":37}},"loc":{"start":{"line":15,"column":47},"end":{"line":34,"column":1}},"line":15},"1":{"name":"(anonymous_1)","decl":{"start":{"line":35,"column":37},"end":{"line":35,"column":38}},"loc":{"start":{"line":35,"column":64},"end":{"line":55,"column":1}},"line":35},"2":{"name":"(anonymous_2)","decl":{"start":{"line":56,"column":27},"end":{"line":56,"column":28}},"loc":{"start":{"line":56,"column":38},"end":{"line":70,"column":1}},"line":56},"3":{"name":"(anonymous_3)","decl":{"start":{"line":71,"column":38},"end":{"line":71,"column":39}},"loc":{"start":{"line":71,"column":75},"end":{"line":158,"column":1}},"line":71},"4":{"name":"(anonymous_4)","decl":{"start":{"line":74,"column":24},"end":{"line":74,"column":25}},"loc":{"start":{"line":74,"column":42},"end":{"line":81,"column":3}},"line":74},"5":{"name":"(anonymous_5)","decl":{"start":{"line":82,"column":20},"end":{"line":82,"column":21}},"loc":{"start":{"line":82,"column":30},"end":{"line":82,"column":55}},"line":82},"6":{"name":"(anonymous_6)","decl":{"start":{"line":83,"column":22},"end":{"line":83,"column":23}},"loc":{"start":{"line":83,"column":41},"end":{"line":86,"column":3}},"line":83},"7":{"name":"(anonymous_7)","decl":{"start":{"line":87,"column":22},"end":{"line":87,"column":23}},"loc":{"start":{"line":87,"column":41},"end":{"line":90,"column":3}},"line":87},"8":{"name":"(anonymous_8)","decl":{"start":{"line":159,"column":30},"end":{"line":159,"column":31}},"loc":{"start":{"line":159,"column":55},"end":{"line":186,"column":1}},"line":159},"9":{"name":"(anonymous_9)","decl":{"start":{"line":187,"column":36},"end":{"line":187,"column":37}},"loc":{"start":{"line":187,"column":61},"end":{"line":202,"column":1}},"line":187},"10":{"name":"(anonymous_10)","decl":{"start":{"line":196,"column":29},"end":{"line":196,"column":30}},"loc":{"start":{"line":196,"column":43},"end":{"line":198,"column":3}},"line":196},"11":{"name":"(anonymous_11)","decl":{"start":{"line":200,"column":40},"end":{"line":200,"column":41}},"loc":{"start":{"line":200,"column":51},"end":{"line":200,"column":62}},"line":200},"12":{"name":"(anonymous_12)","decl":{"start":{"line":203,"column":40},"end":{"line":203,"column":41}},"loc":{"start":{"line":203,"column":64},"end":{"line":225,"column":1}},"line":203},"13":{"name":"(anonymous_13)","decl":{"start":{"line":209,"column":29},"end":{"line":209,"column":30}},"loc":{"start":{"line":209,"column":43},"end":{"line":211,"column":3}},"line":209},"14":{"name":"(anonymous_14)","decl":{"start":{"line":213,"column":23},"end":{"line":213,"column":24}},"loc":{"start":{"line":213,"column":37},"end":{"line":219,"column":3}},"line":213},"15":{"name":"(anonymous_15)","decl":{"start":{"line":220,"column":23},"end":{"line":220,"column":24}},"loc":{"start":{"line":220,"column":47},"end":{"line":222,"column":3}},"line":220},"16":{"name":"(anonymous_16)","decl":{"start":{"line":223,"column":40},"end":{"line":223,"column":41}},"loc":{"start":{"line":223,"column":51},"end":{"line":223,"column":62}},"line":223},"17":{"name":"(anonymous_17)","decl":{"start":{"line":226,"column":30},"end":{"line":226,"column":31}},"loc":{"start":{"line":226,"column":55},"end":{"line":253,"column":1}},"line":226},"18":{"name":"(anonymous_18)","decl":{"start":{"line":254,"column":36},"end":{"line":254,"column":37}},"loc":{"start":{"line":254,"column":61},"end":{"line":268,"column":1}},"line":254},"19":{"name":"(anonymous_19)","decl":{"start":{"line":263,"column":29},"end":{"line":263,"column":30}},"loc":{"start":{"line":263,"column":43},"end":{"line":265,"column":3}},"line":263},"20":{"name":"(anonymous_20)","decl":{"start":{"line":267,"column":35},"end":{"line":267,"column":36}},"loc":{"start":{"line":267,"column":46},"end":{"line":267,"column":57}},"line":267},"21":{"name":"(anonymous_21)","decl":{"start":{"line":269,"column":31},"end":{"line":269,"column":32}},"loc":{"start":{"line":269,"column":55},"end":{"line":295,"column":1}},"line":269},"22":{"name":"(anonymous_22)","decl":{"start":{"line":296,"column":37},"end":{"line":296,"column":38}},"loc":{"start":{"line":296,"column":61},"end":{"line":337,"column":1}},"line":296},"23":{"name":"(anonymous_23)","decl":{"start":{"line":311,"column":29},"end":{"line":311,"column":30}},"loc":{"start":{"line":311,"column":43},"end":{"line":313,"column":3}},"line":311},"24":{"name":"(anonymous_24)","decl":{"start":{"line":316,"column":48},"end":{"line":316,"column":49}},"loc":{"start":{"line":316,"column":62},"end":{"line":321,"column":3}},"line":316},"25":{"name":"(anonymous_25)","decl":{"start":{"line":330,"column":44},"end":{"line":330,"column":45}},"loc":{"start":{"line":330,"column":58},"end":{"line":334,"column":3}},"line":330},"26":{"name":"(anonymous_26)","decl":{"start":{"line":335,"column":40},"end":{"line":335,"column":41}},"loc":{"start":{"line":335,"column":51},"end":{"line":335,"column":62}},"line":335},"27":{"name":"(anonymous_27)","decl":{"start":{"line":338,"column":37},"end":{"line":338,"column":38}},"loc":{"start":{"line":338,"column":69},"end":{"line":372,"column":1}},"line":338},"28":{"name":"(anonymous_28)","decl":{"start":{"line":341,"column":20},"end":{"line":341,"column":21}},"loc":{"start":{"line":341,"column":31},"end":{"line":341,"column":70}},"line":341},"29":{"name":"(anonymous_29)","decl":{"start":{"line":342,"column":23},"end":{"line":342,"column":24}},"loc":{"start":{"line":342,"column":34},"end":{"line":342,"column":67}},"line":342},"30":{"name":"(anonymous_30)","decl":{"start":{"line":373,"column":32},"end":{"line":373,"column":33}},"loc":{"start":{"line":373,"column":56},"end":{"line":391,"column":1}},"line":373},"31":{"name":"(anonymous_31)","decl":{"start":{"line":392,"column":32},"end":{"line":392,"column":33}},"loc":{"start":{"line":392,"column":56},"end":{"line":410,"column":1}},"line":392},"32":{"name":"(anonymous_32)","decl":{"start":{"line":411,"column":34},"end":{"line":411,"column":35}},"loc":{"start":{"line":411,"column":58},"end":{"line":433,"column":1}},"line":411},"33":{"name":"(anonymous_33)","decl":{"start":{"line":434,"column":37},"end":{"line":434,"column":38}},"loc":{"start":{"line":434,"column":69},"end":{"line":479,"column":1}},"line":434},"34":{"name":"(anonymous_34)","decl":{"start":{"line":437,"column":20},"end":{"line":437,"column":21}},"loc":{"start":{"line":437,"column":31},"end":{"line":437,"column":70}},"line":437},"35":{"name":"handleBaseMoveRange","decl":{"start":{"line":480,"column":9},"end":{"line":480,"column":28}},"loc":{"start":{"line":480,"column":62},"end":{"line":501,"column":1}},"line":480},"36":{"name":"(anonymous_36)","decl":{"start":{"line":503,"column":31},"end":{"line":503,"column":32}},"loc":{"start":{"line":503,"column":55},"end":{"line":517,"column":1}},"line":503},"37":{"name":"(anonymous_37)","decl":{"start":{"line":518,"column":31},"end":{"line":518,"column":32}},"loc":{"start":{"line":518,"column":55},"end":{"line":532,"column":1}},"line":518},"38":{"name":"(anonymous_38)","decl":{"start":{"line":533,"column":41},"end":{"line":533,"column":42}},"loc":{"start":{"line":533,"column":65},"end":{"line":547,"column":1}},"line":533},"39":{"name":"(anonymous_39)","decl":{"start":{"line":548,"column":47},"end":{"line":548,"column":48}},"loc":{"start":{"line":548,"column":71},"end":{"line":574,"column":1}},"line":548},"40":{"name":"(anonymous_40)","decl":{"start":{"line":565,"column":23},"end":{"line":565,"column":24}},"loc":{"start":{"line":565,"column":40},"end":{"line":569,"column":3}},"line":565},"41":{"name":"(anonymous_41)","decl":{"start":{"line":566,"column":31},"end":{"line":566,"column":32}},"loc":{"start":{"line":566,"column":45},"end":{"line":568,"column":5}},"line":566},"42":{"name":"(anonymous_42)","decl":{"start":{"line":570,"column":52},"end":{"line":570,"column":53}},"loc":{"start":{"line":570,"column":66},"end":{"line":572,"column":3}},"line":570},"43":{"name":"(anonymous_43)","decl":{"start":{"line":573,"column":35},"end":{"line":573,"column":36}},"loc":{"start":{"line":573,"column":42},"end":{"line":573,"column":49}},"line":573},"44":{"name":"(anonymous_44)","decl":{"start":{"line":575,"column":42},"end":{"line":575,"column":43}},"loc":{"start":{"line":575,"column":66},"end":{"line":589,"column":1}},"line":575},"45":{"name":"(anonymous_45)","decl":{"start":{"line":590,"column":48},"end":{"line":590,"column":49}},"loc":{"start":{"line":590,"column":72},"end":{"line":616,"column":1}},"line":590},"46":{"name":"(anonymous_46)","decl":{"start":{"line":607,"column":23},"end":{"line":607,"column":24}},"loc":{"start":{"line":607,"column":40},"end":{"line":611,"column":3}},"line":607},"47":{"name":"(anonymous_47)","decl":{"start":{"line":608,"column":31},"end":{"line":608,"column":32}},"loc":{"start":{"line":608,"column":45},"end":{"line":610,"column":5}},"line":608},"48":{"name":"(anonymous_48)","decl":{"start":{"line":612,"column":52},"end":{"line":612,"column":53}},"loc":{"start":{"line":612,"column":66},"end":{"line":614,"column":3}},"line":612},"49":{"name":"(anonymous_49)","decl":{"start":{"line":615,"column":35},"end":{"line":615,"column":36}},"loc":{"start":{"line":615,"column":42},"end":{"line":615,"column":49}},"line":615},"50":{"name":"(anonymous_50)","decl":{"start":{"line":617,"column":41},"end":{"line":617,"column":42}},"loc":{"start":{"line":617,"column":65},"end":{"line":635,"column":1}},"line":617},"51":{"name":"(anonymous_51)","decl":{"start":{"line":636,"column":47},"end":{"line":636,"column":48}},"loc":{"start":{"line":636,"column":71},"end":{"line":667,"column":1}},"line":636},"52":{"name":"(anonymous_52)","decl":{"start":{"line":655,"column":52},"end":{"line":655,"column":53}},"loc":{"start":{"line":655,"column":66},"end":{"line":657,"column":3}},"line":655},"53":{"name":"(anonymous_53)","decl":{"start":{"line":658,"column":56},"end":{"line":658,"column":57}},"loc":{"start":{"line":658,"column":70},"end":{"line":660,"column":3}},"line":658},"54":{"name":"(anonymous_54)","decl":{"start":{"line":661,"column":23},"end":{"line":661,"column":24}},"loc":{"start":{"line":661,"column":40},"end":{"line":665,"column":3}},"line":661},"55":{"name":"(anonymous_55)","decl":{"start":{"line":662,"column":31},"end":{"line":662,"column":32}},"loc":{"start":{"line":662,"column":45},"end":{"line":664,"column":5}},"line":662},"56":{"name":"(anonymous_56)","decl":{"start":{"line":666,"column":35},"end":{"line":666,"column":36}},"loc":{"start":{"line":666,"column":42},"end":{"line":666,"column":49}},"line":666},"57":{"name":"(anonymous_57)","decl":{"start":{"line":668,"column":39},"end":{"line":668,"column":40}},"loc":{"start":{"line":668,"column":63},"end":{"line":686,"column":1}},"line":668},"58":{"name":"(anonymous_58)","decl":{"start":{"line":687,"column":45},"end":{"line":687,"column":46}},"loc":{"start":{"line":687,"column":69},"end":{"line":717,"column":1}},"line":687},"59":{"name":"(anonymous_59)","decl":{"start":{"line":705,"column":52},"end":{"line":705,"column":53}},"loc":{"start":{"line":705,"column":66},"end":{"line":707,"column":3}},"line":705},"60":{"name":"(anonymous_60)","decl":{"start":{"line":708,"column":56},"end":{"line":708,"column":57}},"loc":{"start":{"line":708,"column":70},"end":{"line":710,"column":3}},"line":708},"61":{"name":"(anonymous_61)","decl":{"start":{"line":711,"column":23},"end":{"line":711,"column":24}},"loc":{"start":{"line":711,"column":40},"end":{"line":715,"column":3}},"line":711},"62":{"name":"(anonymous_62)","decl":{"start":{"line":712,"column":31},"end":{"line":712,"column":32}},"loc":{"start":{"line":712,"column":45},"end":{"line":714,"column":5}},"line":712},"63":{"name":"(anonymous_63)","decl":{"start":{"line":716,"column":35},"end":{"line":716,"column":36}},"loc":{"start":{"line":716,"column":42},"end":{"line":716,"column":49}},"line":716},"64":{"name":"(anonymous_64)","decl":{"start":{"line":718,"column":37},"end":{"line":718,"column":38}},"loc":{"start":{"line":718,"column":61},"end":{"line":731,"column":1}},"line":718},"65":{"name":"(anonymous_65)","decl":{"start":{"line":721,"column":29},"end":{"line":721,"column":30}},"loc":{"start":{"line":721,"column":43},"end":{"line":723,"column":3}},"line":721},"66":{"name":"(anonymous_66)","decl":{"start":{"line":724,"column":17},"end":{"line":724,"column":18}},"loc":{"start":{"line":724,"column":28},"end":{"line":729,"column":3}},"line":724},"67":{"name":"(anonymous_67)","decl":{"start":{"line":730,"column":35},"end":{"line":730,"column":36}},"loc":{"start":{"line":730,"column":46},"end":{"line":730,"column":57}},"line":730},"68":{"name":"(anonymous_68)","decl":{"start":{"line":732,"column":37},"end":{"line":732,"column":38}},"loc":{"start":{"line":732,"column":60},"end":{"line":753,"column":1}},"line":732},"69":{"name":"(anonymous_69)","decl":{"start":{"line":754,"column":37},"end":{"line":754,"column":38}},"loc":{"start":{"line":754,"column":60},"end":{"line":775,"column":1}},"line":754},"70":{"name":"(anonymous_70)","decl":{"start":{"line":776,"column":36},"end":{"line":776,"column":37}},"loc":{"start":{"line":776,"column":58},"end":{"line":812,"column":1}},"line":776},"71":{"name":"(anonymous_71)","decl":{"start":{"line":778,"column":20},"end":{"line":778,"column":21}},"loc":{"start":{"line":778,"column":34},"end":{"line":805,"column":3}},"line":778},"72":{"name":"(anonymous_72)","decl":{"start":{"line":813,"column":61},"end":{"line":813,"column":62}},"loc":{"start":{"line":813,"column":85},"end":{"line":867,"column":1}},"line":813},"73":{"name":"(anonymous_73)","decl":{"start":{"line":868,"column":76},"end":{"line":868,"column":77}},"loc":{"start":{"line":868,"column":106},"end":{"line":878,"column":1}},"line":868},"74":{"name":"(anonymous_74)","decl":{"start":{"line":874,"column":24},"end":{"line":874,"column":25}},"loc":{"start":{"line":874,"column":41},"end":{"line":874,"column":81}},"line":874},"75":{"name":"(anonymous_75)","decl":{"start":{"line":879,"column":67},"end":{"line":879,"column":68}},"loc":{"start":{"line":879,"column":91},"end":{"line":922,"column":1}},"line":879},"76":{"name":"(anonymous_76)","decl":{"start":{"line":923,"column":75},"end":{"line":923,"column":76}},"loc":{"start":{"line":923,"column":105},"end":{"line":933,"column":1}},"line":923},"77":{"name":"(anonymous_77)","decl":{"start":{"line":929,"column":24},"end":{"line":929,"column":25}},"loc":{"start":{"line":929,"column":41},"end":{"line":929,"column":81}},"line":929},"78":{"name":"adjustRangeOnMutation","decl":{"start":{"line":934,"column":16},"end":{"line":934,"column":37}},"loc":{"start":{"line":934,"column":55},"end":{"line":1004,"column":1}},"line":934},"79":{"name":"getEffectedRangesOnCommand","decl":{"start":{"line":1005,"column":16},"end":{"line":1005,"column":42}},"loc":{"start":{"line":1005,"column":58},"end":{"line":1101,"column":1}},"line":1005},"80":{"name":"(anonymous_80)","decl":{"start":{"line":1069,"column":96},"end":{"line":1069,"column":97}},"loc":{"start":{"line":1069,"column":103},"end":{"line":1069,"column":110}},"line":1069},"81":{"name":"(anonymous_81)","decl":{"start":{"line":1078,"column":96},"end":{"line":1078,"column":97}},"loc":{"start":{"line":1078,"column":103},"end":{"line":1078,"column":110}},"line":1078},"82":{"name":"getEffectedRangesOnMutation","decl":{"start":{"line":1102,"column":16},"end":{"line":1102,"column":43}},"loc":{"start":{"line":1102,"column":54},"end":{"line":1165,"column":1}},"line":1102},"83":{"name":"getSeparateEffectedRangesOnCommand","decl":{"start":{"line":1166,"column":16},"end":{"line":1166,"column":50}},"loc":{"start":{"line":1166,"column":70},"end":{"line":1363,"column":1}},"line":1166},"84":{"name":"(anonymous_84)","decl":{"start":{"line":1295,"column":96},"end":{"line":1295,"column":97}},"loc":{"start":{"line":1295,"column":103},"end":{"line":1295,"column":110}},"line":1295},"85":{"name":"(anonymous_85)","decl":{"start":{"line":1319,"column":96},"end":{"line":1319,"column":97}},"loc":{"start":{"line":1319,"column":103},"end":{"line":1319,"column":110}},"line":1319}},"branchMap":{"0":{"loc":{"start":{"line":17,"column":19},"end":{"line":17,"column":151}},"type":"binary-expr","locations":[{"start":{"line":17,"column":19},"end":{"line":17,"column":48}},{"start":{"line":17,"column":52},"end":{"line":17,"column":79}},{"start":{"line":17,"column":83},"end":{"line":17,"column":116}},{"start":{"line":17,"column":120},"end":{"line":17,"column":151}}],"line":17},"1":{"loc":{"start":{"line":18,"column":16},"end":{"line":18,"column":148}},"type":"binary-expr","locations":[{"start":{"line":18,"column":16},"end":{"line":18,"column":48}},{"start":{"line":18,"column":52},"end":{"line":18,"column":82}},{"start":{"line":18,"column":86},"end":{"line":18,"column":116}},{"start":{"line":18,"column":120},"end":{"line":18,"column":148}}],"line":18},"2":{"loc":{"start":{"line":19,"column":2},"end":{"line":22,"column":3}},"type":"if","locations":[{"start":{"line":19,"column":2},"end":{"line":22,"column":3}},{"start":{},"end":{}}],"line":19},"3":{"loc":{"start":{"line":19,"column":6},"end":{"line":19,"column":56}},"type":"binary-expr","locations":[{"start":{"line":19,"column":6},"end":{"line":19,"column":44}},{"start":{"line":19,"column":48},"end":{"line":19,"column":56}}],"line":19},"4":{"loc":{"start":{"line":23,"column":2},"end":{"line":26,"column":3}},"type":"if","locations":[{"start":{"line":23,"column":2},"end":{"line":26,"column":3}},{"start":{},"end":{}}],"line":23},"5":{"loc":{"start":{"line":23,"column":6},"end":{"line":23,"column":50}},"type":"binary-expr","locations":[{"start":{"line":23,"column":6},"end":{"line":23,"column":41}},{"start":{"line":23,"column":45},"end":{"line":23,"column":50}}],"line":23},"6":{"loc":{"start":{"line":27,"column":2},"end":{"line":32,"column":3}},"type":"if","locations":[{"start":{"line":27,"column":2},"end":{"line":32,"column":3}},{"start":{},"end":{}}],"line":27},"7":{"loc":{"start":{"line":37,"column":2},"end":{"line":53,"column":3}},"type":"if","locations":[{"start":{"line":37,"column":2},"end":{"line":53,"column":3}},{"start":{"line":40,"column":9},"end":{"line":53,"column":3}}],"line":37},"8":{"loc":{"start":{"line":40,"column":9},"end":{"line":53,"column":3}},"type":"if","locations":[{"start":{"line":40,"column":9},"end":{"line":53,"column":3}},{"start":{"line":43,"column":9},"end":{"line":53,"column":3}}],"line":40},"9":{"loc":{"start":{"line":43,"column":9},"end":{"line":53,"column":3}},"type":"if","locations":[{"start":{"line":43,"column":9},"end":{"line":53,"column":3}},{"start":{"line":48,"column":9},"end":{"line":53,"column":3}}],"line":43},"10":{"loc":{"start":{"line":58,"column":2},"end":{"line":62,"column":3}},"type":"if","locations":[{"start":{"line":58,"column":2},"end":{"line":62,"column":3}},{"start":{"line":60,"column":9},"end":{"line":62,"column":3}}],"line":58},"11":{"loc":{"start":{"line":60,"column":9},"end":{"line":62,"column":3}},"type":"if","locations":[{"start":{"line":60,"column":9},"end":{"line":62,"column":3}},{"start":{},"end":{}}],"line":60},"12":{"loc":{"start":{"line":77,"column":4},"end":{"line":79,"column":5}},"type":"if","locations":[{"start":{"line":77,"column":4},"end":{"line":79,"column":5}},{"start":{},"end":{}}],"line":77},"13":{"loc":{"start":{"line":92,"column":2},"end":{"line":96,"column":3}},"type":"if","locations":[{"start":{"line":92,"column":2},"end":{"line":96,"column":3}},{"start":{},"end":{}}],"line":92},"14":{"loc":{"start":{"line":100,"column":40},"end":{"line":100,"column":142}},"type":"binary-expr","locations":[{"start":{"line":100,"column":40},"end":{"line":100,"column":70}},{"start":{"line":100,"column":74},"end":{"line":100,"column":142}}],"line":100},"15":{"loc":{"start":{"line":101,"column":2},"end":{"line":130,"column":3}},"type":"if","locations":[{"start":{"line":101,"column":2},"end":{"line":130,"column":3}},{"start":{"line":104,"column":9},"end":{"line":130,"column":3}}],"line":101},"16":{"loc":{"start":{"line":104,"column":9},"end":{"line":130,"column":3}},"type":"if","locations":[{"start":{"line":104,"column":9},"end":{"line":130,"column":3}},{"start":{},"end":{}}],"line":104},"17":{"loc":{"start":{"line":106,"column":4},"end":{"line":129,"column":5}},"type":"if","locations":[{"start":{"line":106,"column":4},"end":{"line":129,"column":5}},{"start":{"line":111,"column":11},"end":{"line":129,"column":5}}],"line":106},"18":{"loc":{"start":{"line":111,"column":11},"end":{"line":129,"column":5}},"type":"if","locations":[{"start":{"line":111,"column":11},"end":{"line":129,"column":5}},{"start":{"line":118,"column":11},"end":{"line":129,"column":5}}],"line":111},"19":{"loc":{"start":{"line":112,"column":6},"end":{"line":117,"column":7}},"type":"if","locations":[{"start":{"line":112,"column":6},"end":{"line":117,"column":7}},{"start":{"line":115,"column":13},"end":{"line":117,"column":7}}],"line":112},"20":{"loc":{"start":{"line":119,"column":6},"end":{"line":128,"column":7}},"type":"if","locations":[{"start":{"line":119,"column":6},"end":{"line":128,"column":7}},{"start":{"line":121,"column":13},"end":{"line":128,"column":7}}],"line":119},"21":{"loc":{"start":{"line":122,"column":8},"end":{"line":127,"column":9}},"type":"if","locations":[{"start":{"line":122,"column":8},"end":{"line":127,"column":9}},{"start":{"line":125,"column":15},"end":{"line":127,"column":9}}],"line":122},"22":{"loc":{"start":{"line":122,"column":12},"end":{"line":122,"column":84}},"type":"binary-expr","locations":[{"start":{"line":122,"column":12},"end":{"line":122,"column":48}},{"start":{"line":122,"column":52},"end":{"line":122,"column":84}}],"line":122},"23":{"loc":{"start":{"line":132,"column":2},"end":{"line":153,"column":3}},"type":"if","locations":[{"start":{"line":132,"column":2},"end":{"line":153,"column":3}},{"start":{},"end":{}}],"line":132},"24":{"loc":{"start":{"line":133,"column":4},"end":{"line":152,"column":5}},"type":"if","locations":[{"start":{"line":133,"column":4},"end":{"line":152,"column":5}},{"start":{"line":136,"column":11},"end":{"line":152,"column":5}}],"line":133},"25":{"loc":{"start":{"line":136,"column":11},"end":{"line":152,"column":5}},"type":"if","locations":[{"start":{"line":136,"column":11},"end":{"line":152,"column":5}},{"start":{},"end":{}}],"line":136},"26":{"loc":{"start":{"line":137,"column":6},"end":{"line":151,"column":7}},"type":"if","locations":[{"start":{"line":137,"column":6},"end":{"line":151,"column":7}},{"start":{"line":144,"column":13},"end":{"line":151,"column":7}}],"line":137},"27":{"loc":{"start":{"line":138,"column":8},"end":{"line":143,"column":9}},"type":"if","locations":[{"start":{"line":138,"column":8},"end":{"line":143,"column":9}},{"start":{"line":140,"column":15},"end":{"line":143,"column":9}}],"line":138},"28":{"loc":{"start":{"line":138,"column":12},"end":{"line":138,"column":84}},"type":"binary-expr","locations":[{"start":{"line":138,"column":12},"end":{"line":138,"column":47}},{"start":{"line":138,"column":51},"end":{"line":138,"column":84}}],"line":138},"29":{"loc":{"start":{"line":140,"column":15},"end":{"line":143,"column":9}},"type":"if","locations":[{"start":{"line":140,"column":15},"end":{"line":143,"column":9}},{"start":{},"end":{}}],"line":140},"30":{"loc":{"start":{"line":140,"column":19},"end":{"line":140,"column":131}},"type":"binary-expr","locations":[{"start":{"line":140,"column":19},"end":{"line":140,"column":53}},{"start":{"line":140,"column":57},"end":{"line":140,"column":93}},{"start":{"line":140,"column":97},"end":{"line":140,"column":131}}],"line":140},"31":{"loc":{"start":{"line":145,"column":8},"end":{"line":150,"column":9}},"type":"if","locations":[{"start":{"line":145,"column":8},"end":{"line":150,"column":9}},{"start":{"line":148,"column":15},"end":{"line":150,"column":9}}],"line":145},"32":{"loc":{"start":{"line":145,"column":12},"end":{"line":145,"column":124}},"type":"binary-expr","locations":[{"start":{"line":145,"column":12},"end":{"line":145,"column":46}},{"start":{"line":145,"column":50},"end":{"line":145,"column":86}},{"start":{"line":145,"column":90},"end":{"line":145,"column":124}}],"line":145},"33":{"loc":{"start":{"line":148,"column":15},"end":{"line":150,"column":9}},"type":"if","locations":[{"start":{"line":148,"column":15},"end":{"line":150,"column":9}},{"start":{},"end":{}}],"line":148},"34":{"loc":{"start":{"line":148,"column":19},"end":{"line":148,"column":93}},"type":"binary-expr","locations":[{"start":{"line":148,"column":19},"end":{"line":148,"column":55}},{"start":{"line":148,"column":59},"end":{"line":148,"column":93}}],"line":148},"35":{"loc":{"start":{"line":160,"column":33},"end":{"line":160,"column":52}},"type":"binary-expr","locations":[{"start":{"line":160,"column":33},"end":{"line":160,"column":46}},{"start":{"line":160,"column":50},"end":{"line":160,"column":52}}],"line":160},"36":{"loc":{"start":{"line":161,"column":2},"end":{"line":163,"column":3}},"type":"if","locations":[{"start":{"line":161,"column":2},"end":{"line":163,"column":3}},{"start":{},"end":{}}],"line":161},"37":{"loc":{"start":{"line":161,"column":6},"end":{"line":161,"column":28}},"type":"binary-expr","locations":[{"start":{"line":161,"column":6},"end":{"line":161,"column":14}},{"start":{"line":161,"column":18},"end":{"line":161,"column":28}}],"line":161},"38":{"loc":{"start":{"line":172,"column":2},"end":{"line":178,"column":3}},"type":"if","locations":[{"start":{"line":172,"column":2},"end":{"line":178,"column":3}},{"start":{},"end":{}}],"line":172},"39":{"loc":{"start":{"line":182,"column":12},"end":{"line":182,"column":28}},"type":"binary-expr","locations":[{"start":{"line":182,"column":12},"end":{"line":182,"column":23}},{"start":{"line":182,"column":27},"end":{"line":182,"column":28}}],"line":182},"40":{"loc":{"start":{"line":183,"column":14},"end":{"line":183,"column":32}},"type":"binary-expr","locations":[{"start":{"line":183,"column":14},"end":{"line":183,"column":27}},{"start":{"line":183,"column":31},"end":{"line":183,"column":32}}],"line":183},"41":{"loc":{"start":{"line":188,"column":33},"end":{"line":188,"column":52}},"type":"binary-expr","locations":[{"start":{"line":188,"column":33},"end":{"line":188,"column":46}},{"start":{"line":188,"column":50},"end":{"line":188,"column":52}}],"line":188},"42":{"loc":{"start":{"line":189,"column":2},"end":{"line":191,"column":3}},"type":"if","locations":[{"start":{"line":189,"column":2},"end":{"line":191,"column":3}},{"start":{},"end":{}}],"line":189},"43":{"loc":{"start":{"line":189,"column":6},"end":{"line":189,"column":28}},"type":"binary-expr","locations":[{"start":{"line":189,"column":6},"end":{"line":189,"column":16}},{"start":{"line":189,"column":20},"end":{"line":189,"column":28}}],"line":189},"44":{"loc":{"start":{"line":204,"column":27},"end":{"line":204,"column":45}},"type":"binary-expr","locations":[{"start":{"line":204,"column":27},"end":{"line":204,"column":39}},{"start":{"line":204,"column":43},"end":{"line":204,"column":45}}],"line":204},"45":{"loc":{"start":{"line":205,"column":2},"end":{"line":207,"column":3}},"type":"if","locations":[{"start":{"line":205,"column":2},"end":{"line":207,"column":3}},{"start":{},"end":{}}],"line":205},"46":{"loc":{"start":{"line":205,"column":6},"end":{"line":205,"column":22}},"type":"binary-expr","locations":[{"start":{"line":205,"column":6},"end":{"line":205,"column":12}},{"start":{"line":205,"column":16},"end":{"line":205,"column":22}}],"line":205},"47":{"loc":{"start":{"line":214,"column":4},"end":{"line":218,"column":5}},"type":"if","locations":[{"start":{"line":214,"column":4},"end":{"line":218,"column":5}},{"start":{},"end":{}}],"line":214},"48":{"loc":{"start":{"line":216,"column":24},"end":{"line":216,"column":60}},"type":"binary-expr","locations":[{"start":{"line":216,"column":24},"end":{"line":216,"column":55}},{"start":{"line":216,"column":59},"end":{"line":216,"column":60}}],"line":216},"49":{"loc":{"start":{"line":227,"column":33},"end":{"line":227,"column":52}},"type":"binary-expr","locations":[{"start":{"line":227,"column":33},"end":{"line":227,"column":46}},{"start":{"line":227,"column":50},"end":{"line":227,"column":52}}],"line":227},"50":{"loc":{"start":{"line":228,"column":2},"end":{"line":230,"column":3}},"type":"if","locations":[{"start":{"line":228,"column":2},"end":{"line":230,"column":3}},{"start":{},"end":{}}],"line":228},"51":{"loc":{"start":{"line":228,"column":6},"end":{"line":228,"column":28}},"type":"binary-expr","locations":[{"start":{"line":228,"column":6},"end":{"line":228,"column":14}},{"start":{"line":228,"column":18},"end":{"line":228,"column":28}}],"line":228},"52":{"loc":{"start":{"line":239,"column":2},"end":{"line":245,"column":3}},"type":"if","locations":[{"start":{"line":239,"column":2},"end":{"line":245,"column":3}},{"start":{},"end":{}}],"line":239},"53":{"loc":{"start":{"line":249,"column":12},"end":{"line":249,"column":28}},"type":"binary-expr","locations":[{"start":{"line":249,"column":12},"end":{"line":249,"column":23}},{"start":{"line":249,"column":27},"end":{"line":249,"column":28}}],"line":249},"54":{"loc":{"start":{"line":250,"column":14},"end":{"line":250,"column":32}},"type":"binary-expr","locations":[{"start":{"line":250,"column":14},"end":{"line":250,"column":27}},{"start":{"line":250,"column":31},"end":{"line":250,"column":32}}],"line":250},"55":{"loc":{"start":{"line":255,"column":33},"end":{"line":255,"column":52}},"type":"binary-expr","locations":[{"start":{"line":255,"column":33},"end":{"line":255,"column":46}},{"start":{"line":255,"column":50},"end":{"line":255,"column":52}}],"line":255},"56":{"loc":{"start":{"line":256,"column":2},"end":{"line":258,"column":3}},"type":"if","locations":[{"start":{"line":256,"column":2},"end":{"line":258,"column":3}},{"start":{},"end":{}}],"line":256},"57":{"loc":{"start":{"line":256,"column":6},"end":{"line":256,"column":28}},"type":"binary-expr","locations":[{"start":{"line":256,"column":6},"end":{"line":256,"column":16}},{"start":{"line":256,"column":20},"end":{"line":256,"column":28}}],"line":256},"58":{"loc":{"start":{"line":272,"column":2},"end":{"line":274,"column":3}},"type":"if","locations":[{"start":{"line":272,"column":2},"end":{"line":274,"column":3}},{"start":{},"end":{}}],"line":272},"59":{"loc":{"start":{"line":272,"column":6},"end":{"line":272,"column":28}},"type":"binary-expr","locations":[{"start":{"line":272,"column":6},"end":{"line":272,"column":14}},{"start":{"line":272,"column":18},"end":{"line":272,"column":28}}],"line":272},"60":{"loc":{"start":{"line":276,"column":2},"end":{"line":280,"column":3}},"type":"if","locations":[{"start":{"line":276,"column":2},"end":{"line":280,"column":3}},{"start":{},"end":{}}],"line":276},"61":{"loc":{"start":{"line":281,"column":2},"end":{"line":293,"column":3}},"type":"if","locations":[{"start":{"line":281,"column":2},"end":{"line":293,"column":3}},{"start":{},"end":{}}],"line":281},"62":{"loc":{"start":{"line":299,"column":2},"end":{"line":301,"column":3}},"type":"if","locations":[{"start":{"line":299,"column":2},"end":{"line":301,"column":3}},{"start":{},"end":{}}],"line":299},"63":{"loc":{"start":{"line":299,"column":6},"end":{"line":299,"column":28}},"type":"binary-expr","locations":[{"start":{"line":299,"column":6},"end":{"line":299,"column":14}},{"start":{"line":299,"column":18},"end":{"line":299,"column":28}}],"line":299},"64":{"loc":{"start":{"line":302,"column":2},"end":{"line":304,"column":3}},"type":"if","locations":[{"start":{"line":302,"column":2},"end":{"line":304,"column":3}},{"start":{},"end":{}}],"line":302},"65":{"loc":{"start":{"line":302,"column":6},"end":{"line":302,"column":98}},"type":"binary-expr","locations":[{"start":{"line":302,"column":6},"end":{"line":302,"column":51}},{"start":{"line":302,"column":55},"end":{"line":302,"column":98}}],"line":302},"66":{"loc":{"start":{"line":305,"column":2},"end":{"line":309,"column":3}},"type":"if","locations":[{"start":{"line":305,"column":2},"end":{"line":309,"column":3}},{"start":{},"end":{}}],"line":305},"67":{"loc":{"start":{"line":316,"column":2},"end":{"line":321,"column":4}},"type":"binary-expr","locations":[{"start":{"line":316,"column":2},"end":{"line":316,"column":15}},{"start":{"line":316,"column":19},"end":{"line":321,"column":4}}],"line":316},"68":{"loc":{"start":{"line":317,"column":4},"end":{"line":320,"column":5}},"type":"if","locations":[{"start":{"line":317,"column":4},"end":{"line":320,"column":5}},{"start":{},"end":{}}],"line":317},"69":{"loc":{"start":{"line":330,"column":2},"end":{"line":334,"column":4}},"type":"binary-expr","locations":[{"start":{"line":330,"column":2},"end":{"line":330,"column":13}},{"start":{"line":330,"column":17},"end":{"line":334,"column":4}}],"line":330},"70":{"loc":{"start":{"line":333,"column":42},"end":{"line":333,"column":76}},"type":"binary-expr","locations":[{"start":{"line":333,"column":42},"end":{"line":333,"column":71}},{"start":{"line":333,"column":75},"end":{"line":333,"column":76}}],"line":333},"71":{"loc":{"start":{"line":343,"column":2},"end":{"line":370,"column":3}},"type":"if","locations":[{"start":{"line":343,"column":2},"end":{"line":370,"column":3}},{"start":{},"end":{}}],"line":343},"72":{"loc":{"start":{"line":343,"column":6},"end":{"line":343,"column":94}},"type":"binary-expr","locations":[{"start":{"line":343,"column":6},"end":{"line":343,"column":50}},{"start":{"line":343,"column":54},"end":{"line":343,"column":94}}],"line":343},"73":{"loc":{"start":{"line":344,"column":4},"end":{"line":354,"column":5}},"type":"if","locations":[{"start":{"line":344,"column":4},"end":{"line":354,"column":5}},{"start":{},"end":{}}],"line":344},"74":{"loc":{"start":{"line":346,"column":6},"end":{"line":347,"column":105}},"type":"binary-expr","locations":[{"start":{"line":346,"column":6},"end":{"line":346,"column":55}},{"start":{"line":346,"column":59},"end":{"line":346,"column":107}},{"start":{"line":346,"column":111},"end":{"line":346,"column":157}},{"start":{"line":347,"column":6},"end":{"line":347,"column":55}},{"start":{"line":347,"column":59},"end":{"line":347,"column":105}}],"line":346},"75":{"loc":{"start":{"line":350,"column":6},"end":{"line":353,"column":7}},"type":"if","locations":[{"start":{"line":350,"column":6},"end":{"line":353,"column":7}},{"start":{},"end":{}}],"line":350},"76":{"loc":{"start":{"line":355,"column":4},"end":{"line":357,"column":5}},"type":"if","locations":[{"start":{"line":355,"column":4},"end":{"line":357,"column":5}},{"start":{},"end":{}}],"line":355},"77":{"loc":{"start":{"line":355,"column":8},"end":{"line":355,"column":166}},"type":"binary-expr","locations":[{"start":{"line":355,"column":8},"end":{"line":355,"column":58}},{"start":{"line":355,"column":62},"end":{"line":355,"column":108}},{"start":{"line":355,"column":112},"end":{"line":355,"column":166}}],"line":355},"78":{"loc":{"start":{"line":358,"column":4},"end":{"line":365,"column":5}},"type":"if","locations":[{"start":{"line":358,"column":4},"end":{"line":365,"column":5}},{"start":{},"end":{}}],"line":358},"79":{"loc":{"start":{"line":358,"column":8},"end":{"line":358,"column":159}},"type":"binary-expr","locations":[{"start":{"line":358,"column":8},"end":{"line":358,"column":58}},{"start":{"line":358,"column":62},"end":{"line":358,"column":110}},{"start":{"line":358,"column":114},"end":{"line":358,"column":159}}],"line":358},"80":{"loc":{"start":{"line":360,"column":6},"end":{"line":364,"column":7}},"type":"if","locations":[{"start":{"line":360,"column":6},"end":{"line":364,"column":7}},{"start":{},"end":{}}],"line":360},"81":{"loc":{"start":{"line":366,"column":4},"end":{"line":369,"column":5}},"type":"if","locations":[{"start":{"line":366,"column":4},"end":{"line":369,"column":5}},{"start":{},"end":{}}],"line":366},"82":{"loc":{"start":{"line":375,"column":2},"end":{"line":377,"column":3}},"type":"if","locations":[{"start":{"line":375,"column":2},"end":{"line":377,"column":3}},{"start":{},"end":{}}],"line":375},"83":{"loc":{"start":{"line":380,"column":2},"end":{"line":389,"column":3}},"type":"if","locations":[{"start":{"line":380,"column":2},"end":{"line":389,"column":3}},{"start":{"line":382,"column":9},"end":{"line":389,"column":3}}],"line":380},"84":{"loc":{"start":{"line":394,"column":2},"end":{"line":396,"column":3}},"type":"if","locations":[{"start":{"line":394,"column":2},"end":{"line":396,"column":3}},{"start":{},"end":{}}],"line":394},"85":{"loc":{"start":{"line":399,"column":2},"end":{"line":408,"column":3}},"type":"if","locations":[{"start":{"line":399,"column":2},"end":{"line":408,"column":3}},{"start":{"line":401,"column":9},"end":{"line":408,"column":3}}],"line":399},"86":{"loc":{"start":{"line":412,"column":27},"end":{"line":412,"column":45}},"type":"binary-expr","locations":[{"start":{"line":412,"column":27},"end":{"line":412,"column":39}},{"start":{"line":412,"column":43},"end":{"line":412,"column":45}}],"line":412},"87":{"loc":{"start":{"line":413,"column":2},"end":{"line":415,"column":3}},"type":"if","locations":[{"start":{"line":413,"column":2},"end":{"line":415,"column":3}},{"start":{},"end":{}}],"line":413},"88":{"loc":{"start":{"line":413,"column":6},"end":{"line":413,"column":22}},"type":"binary-expr","locations":[{"start":{"line":413,"column":6},"end":{"line":413,"column":12}},{"start":{"line":413,"column":16},"end":{"line":413,"column":22}}],"line":413},"89":{"loc":{"start":{"line":416,"column":2},"end":{"line":431,"column":3}},"type":"if","locations":[{"start":{"line":416,"column":2},"end":{"line":431,"column":3}},{"start":{},"end":{}}],"line":416},"90":{"loc":{"start":{"line":416,"column":6},"end":{"line":416,"column":91}},"type":"binary-expr","locations":[{"start":{"line":416,"column":6},"end":{"line":416,"column":44}},{"start":{"line":416,"column":48},"end":{"line":416,"column":91}}],"line":416},"91":{"loc":{"start":{"line":420,"column":6},"end":{"line":428,"column":7}},"type":"if","locations":[{"start":{"line":420,"column":6},"end":{"line":428,"column":7}},{"start":{},"end":{}}],"line":420},"92":{"loc":{"start":{"line":438,"column":2},"end":{"line":440,"column":3}},"type":"if","locations":[{"start":{"line":438,"column":2},"end":{"line":440,"column":3}},{"start":{},"end":{}}],"line":438},"93":{"loc":{"start":{"line":438,"column":8},"end":{"line":438,"column":96}},"type":"binary-expr","locations":[{"start":{"line":438,"column":8},"end":{"line":438,"column":52}},{"start":{"line":438,"column":56},"end":{"line":438,"column":96}}],"line":438},"94":{"loc":{"start":{"line":441,"column":2},"end":{"line":457,"column":3}},"type":"if","locations":[{"start":{"line":441,"column":2},"end":{"line":457,"column":3}},{"start":{},"end":{}}],"line":441},"95":{"loc":{"start":{"line":448,"column":4},"end":{"line":453,"column":103}},"type":"binary-expr","locations":[{"start":{"line":448,"column":4},"end":{"line":448,"column":53}},{"start":{"line":448,"column":57},"end":{"line":448,"column":105}},{"start":{"line":448,"column":109},"end":{"line":448,"column":155}},{"start":{"line":453,"column":4},"end":{"line":453,"column":53}},{"start":{"line":453,"column":57},"end":{"line":453,"column":103}}],"line":448},"96":{"loc":{"start":{"line":458,"column":2},"end":{"line":477,"column":3}},"type":"if","locations":[{"start":{"line":458,"column":2},"end":{"line":477,"column":3}},{"start":{},"end":{}}],"line":458},"97":{"loc":{"start":{"line":464,"column":4},"end":{"line":473,"column":52}},"type":"binary-expr","locations":[{"start":{"line":464,"column":4},"end":{"line":464,"column":54}},{"start":{"line":464,"column":58},"end":{"line":464,"column":104}},{"start":{"line":469,"column":4},"end":{"line":469,"column":54}},{"start":{"line":469,"column":58},"end":{"line":469,"column":106}},{"start":{"line":469,"column":110},"end":{"line":469,"column":155}},{"start":{"line":473,"column":4},"end":{"line":473,"column":52}}],"line":464},"98":{"loc":{"start":{"line":482,"column":2},"end":{"line":486,"column":3}},"type":"if","locations":[{"start":{"line":482,"column":2},"end":{"line":486,"column":3}},{"start":{},"end":{}}],"line":482},"99":{"loc":{"start":{"line":487,"column":2},"end":{"line":499,"column":3}},"type":"if","locations":[{"start":{"line":487,"column":2},"end":{"line":499,"column":3}},{"start":{},"end":{}}],"line":487},"100":{"loc":{"start":{"line":505,"column":2},"end":{"line":507,"column":3}},"type":"if","locations":[{"start":{"line":505,"column":2},"end":{"line":507,"column":3}},{"start":{},"end":{}}],"line":505},"101":{"loc":{"start":{"line":520,"column":2},"end":{"line":522,"column":3}},"type":"if","locations":[{"start":{"line":520,"column":2},"end":{"line":522,"column":3}},{"start":{},"end":{}}],"line":520},"102":{"loc":{"start":{"line":535,"column":2},"end":{"line":537,"column":3}},"type":"if","locations":[{"start":{"line":535,"column":2},"end":{"line":537,"column":3}},{"start":{},"end":{}}],"line":535},"103":{"loc":{"start":{"line":550,"column":2},"end":{"line":552,"column":3}},"type":"if","locations":[{"start":{"line":550,"column":2},"end":{"line":552,"column":3}},{"start":{},"end":{}}],"line":550},"104":{"loc":{"start":{"line":561,"column":2},"end":{"line":563,"column":3}},"type":"if","locations":[{"start":{"line":561,"column":2},"end":{"line":563,"column":3}},{"start":{},"end":{}}],"line":561},"105":{"loc":{"start":{"line":570,"column":2},"end":{"line":572,"column":4}},"type":"binary-expr","locations":[{"start":{"line":570,"column":2},"end":{"line":570,"column":17}},{"start":{"line":570,"column":21},"end":{"line":572,"column":4}}],"line":570},"106":{"loc":{"start":{"line":577,"column":2},"end":{"line":579,"column":3}},"type":"if","locations":[{"start":{"line":577,"column":2},"end":{"line":579,"column":3}},{"start":{},"end":{}}],"line":577},"107":{"loc":{"start":{"line":592,"column":2},"end":{"line":594,"column":3}},"type":"if","locations":[{"start":{"line":592,"column":2},"end":{"line":594,"column":3}},{"start":{},"end":{}}],"line":592},"108":{"loc":{"start":{"line":603,"column":2},"end":{"line":605,"column":3}},"type":"if","locations":[{"start":{"line":603,"column":2},"end":{"line":605,"column":3}},{"start":{},"end":{}}],"line":603},"109":{"loc":{"start":{"line":612,"column":2},"end":{"line":614,"column":4}},"type":"binary-expr","locations":[{"start":{"line":612,"column":2},"end":{"line":612,"column":17}},{"start":{"line":612,"column":21},"end":{"line":614,"column":4}}],"line":612},"110":{"loc":{"start":{"line":619,"column":2},"end":{"line":621,"column":3}},"type":"if","locations":[{"start":{"line":619,"column":2},"end":{"line":621,"column":3}},{"start":{},"end":{}}],"line":619},"111":{"loc":{"start":{"line":624,"column":2},"end":{"line":633,"column":3}},"type":"if","locations":[{"start":{"line":624,"column":2},"end":{"line":633,"column":3}},{"start":{"line":626,"column":9},"end":{"line":633,"column":3}}],"line":624},"112":{"loc":{"start":{"line":638,"column":2},"end":{"line":640,"column":3}},"type":"if","locations":[{"start":{"line":638,"column":2},"end":{"line":640,"column":3}},{"start":{},"end":{}}],"line":638},"113":{"loc":{"start":{"line":651,"column":2},"end":{"line":653,"column":3}},"type":"if","locations":[{"start":{"line":651,"column":2},"end":{"line":653,"column":3}},{"start":{},"end":{}}],"line":651},"114":{"loc":{"start":{"line":651,"column":6},"end":{"line":651,"column":44}},"type":"binary-expr","locations":[{"start":{"line":651,"column":6},"end":{"line":651,"column":24}},{"start":{"line":651,"column":28},"end":{"line":651,"column":44}}],"line":651},"115":{"loc":{"start":{"line":655,"column":2},"end":{"line":657,"column":4}},"type":"binary-expr","locations":[{"start":{"line":655,"column":2},"end":{"line":655,"column":17}},{"start":{"line":655,"column":21},"end":{"line":657,"column":4}}],"line":655},"116":{"loc":{"start":{"line":658,"column":2},"end":{"line":660,"column":4}},"type":"binary-expr","locations":[{"start":{"line":658,"column":2},"end":{"line":658,"column":19}},{"start":{"line":658,"column":23},"end":{"line":660,"column":4}}],"line":658},"117":{"loc":{"start":{"line":670,"column":2},"end":{"line":672,"column":3}},"type":"if","locations":[{"start":{"line":670,"column":2},"end":{"line":672,"column":3}},{"start":{},"end":{}}],"line":670},"118":{"loc":{"start":{"line":675,"column":2},"end":{"line":684,"column":3}},"type":"if","locations":[{"start":{"line":675,"column":2},"end":{"line":684,"column":3}},{"start":{"line":677,"column":9},"end":{"line":684,"column":3}}],"line":675},"119":{"loc":{"start":{"line":689,"column":2},"end":{"line":691,"column":3}},"type":"if","locations":[{"start":{"line":689,"column":2},"end":{"line":691,"column":3}},{"start":{},"end":{}}],"line":689},"120":{"loc":{"start":{"line":701,"column":2},"end":{"line":703,"column":3}},"type":"if","locations":[{"start":{"line":701,"column":2},"end":{"line":703,"column":3}},{"start":{},"end":{}}],"line":701},"121":{"loc":{"start":{"line":701,"column":6},"end":{"line":701,"column":44}},"type":"binary-expr","locations":[{"start":{"line":701,"column":6},"end":{"line":701,"column":24}},{"start":{"line":701,"column":28},"end":{"line":701,"column":44}}],"line":701},"122":{"loc":{"start":{"line":705,"column":2},"end":{"line":707,"column":4}},"type":"binary-expr","locations":[{"start":{"line":705,"column":2},"end":{"line":705,"column":17}},{"start":{"line":705,"column":21},"end":{"line":707,"column":4}}],"line":705},"123":{"loc":{"start":{"line":708,"column":2},"end":{"line":710,"column":4}},"type":"binary-expr","locations":[{"start":{"line":708,"column":2},"end":{"line":708,"column":19}},{"start":{"line":708,"column":23},"end":{"line":710,"column":4}}],"line":708},"124":{"loc":{"start":{"line":719,"column":17},"end":{"line":719,"column":46}},"type":"binary-expr","locations":[{"start":{"line":719,"column":17},"end":{"line":719,"column":29}},{"start":{"line":719,"column":33},"end":{"line":719,"column":46}}],"line":719},"125":{"loc":{"start":{"line":736,"column":2},"end":{"line":752,"column":3}},"type":"if","locations":[{"start":{"line":736,"column":2},"end":{"line":752,"column":3}},{"start":{"line":743,"column":9},"end":{"line":752,"column":3}}],"line":736},"126":{"loc":{"start":{"line":743,"column":9},"end":{"line":752,"column":3}},"type":"if","locations":[{"start":{"line":743,"column":9},"end":{"line":752,"column":3}},{"start":{"line":745,"column":9},"end":{"line":752,"column":3}}],"line":743},"127":{"loc":{"start":{"line":758,"column":2},"end":{"line":774,"column":3}},"type":"if","locations":[{"start":{"line":758,"column":2},"end":{"line":774,"column":3}},{"start":{"line":765,"column":9},"end":{"line":774,"column":3}}],"line":758},"128":{"loc":{"start":{"line":765,"column":9},"end":{"line":774,"column":3}},"type":"if","locations":[{"start":{"line":765,"column":9},"end":{"line":774,"column":3}},{"start":{"line":767,"column":9},"end":{"line":774,"column":3}}],"line":765},"129":{"loc":{"start":{"line":779,"column":4},"end":{"line":804,"column":5}},"type":"switch","locations":[{"start":{"line":780,"column":6},"end":{"line":783,"column":7}},{"start":{"line":784,"column":6},"end":{"line":791,"column":7}},{"start":{"line":792,"column":6},"end":{"line":799,"column":7}},{"start":{"line":800,"column":6},"end":{"line":803,"column":7}}],"line":779},"130":{"loc":{"start":{"line":785,"column":8},"end":{"line":787,"column":9}},"type":"if","locations":[{"start":{"line":785,"column":8},"end":{"line":787,"column":9}},{"start":{},"end":{}}],"line":785},"131":{"loc":{"start":{"line":789,"column":45},"end":{"line":789,"column":65}},"type":"binary-expr","locations":[{"start":{"line":789,"column":45},"end":{"line":789,"column":60}},{"start":{"line":789,"column":64},"end":{"line":789,"column":65}}],"line":789},"132":{"loc":{"start":{"line":793,"column":8},"end":{"line":795,"column":9}},"type":"if","locations":[{"start":{"line":793,"column":8},"end":{"line":795,"column":9}},{"start":{},"end":{}}],"line":793},"133":{"loc":{"start":{"line":797,"column":42},"end":{"line":797,"column":62}},"type":"binary-expr","locations":[{"start":{"line":797,"column":42},"end":{"line":797,"column":57}},{"start":{"line":797,"column":61},"end":{"line":797,"column":62}}],"line":797},"134":{"loc":{"start":{"line":806,"column":2},"end":{"line":810,"column":3}},"type":"if","locations":[{"start":{"line":806,"column":2},"end":{"line":810,"column":3}},{"start":{},"end":{}}],"line":806},"135":{"loc":{"start":{"line":807,"column":4},"end":{"line":809,"column":5}},"type":"if","locations":[{"start":{"line":807,"column":4},"end":{"line":809,"column":5}},{"start":{},"end":{}}],"line":807},"136":{"loc":{"start":{"line":807,"column":8},"end":{"line":807,"column":80}},"type":"binary-expr","locations":[{"start":{"line":807,"column":8},"end":{"line":807,"column":45}},{"start":{"line":807,"column":49},"end":{"line":807,"column":80}}],"line":807},"137":{"loc":{"start":{"line":815,"column":2},"end":{"line":864,"column":3}},"type":"switch","locations":[{"start":{"line":816,"column":4},"end":{"line":819,"column":5}},{"start":{"line":820,"column":4},"end":{"line":823,"column":5}},{"start":{"line":824,"column":4},"end":{"line":827,"column":5}},{"start":{"line":828,"column":4},"end":{"line":831,"column":5}},{"start":{"line":832,"column":4},"end":{"line":835,"column":5}},{"start":{"line":836,"column":4},"end":{"line":839,"column":5}},{"start":{"line":840,"column":4},"end":{"line":843,"column":5}},{"start":{"line":844,"column":4},"end":{"line":847,"column":5}},{"start":{"line":848,"column":4},"end":{"line":851,"column":5}},{"start":{"line":852,"column":4},"end":{"line":855,"column":5}},{"start":{"line":856,"column":4},"end":{"line":859,"column":5}},{"start":{"line":860,"column":4},"end":{"line":863,"column":5}}],"line":815},"138":{"loc":{"start":{"line":870,"column":2},"end":{"line":872,"column":3}},"type":"if","locations":[{"start":{"line":870,"column":2},"end":{"line":872,"column":3}},{"start":{},"end":{}}],"line":870},"139":{"loc":{"start":{"line":874,"column":2},"end":{"line":876,"column":3}},"type":"if","locations":[{"start":{"line":874,"column":2},"end":{"line":876,"column":3}},{"start":{},"end":{}}],"line":874},"140":{"loc":{"start":{"line":881,"column":2},"end":{"line":919,"column":3}},"type":"switch","locations":[{"start":{"line":882,"column":4},"end":{"line":884,"column":5}},{"start":{"line":885,"column":4},"end":{"line":887,"column":5}},{"start":{"line":888,"column":4},"end":{"line":890,"column":5}},{"start":{"line":891,"column":4},"end":{"line":893,"column":5}},{"start":{"line":894,"column":4},"end":{"line":896,"column":5}},{"start":{"line":897,"column":4},"end":{"line":899,"column":5}},{"start":{"line":900,"column":4},"end":{"line":902,"column":5}},{"start":{"line":903,"column":4},"end":{"line":905,"column":5}},{"start":{"line":906,"column":4},"end":{"line":908,"column":5}},{"start":{"line":909,"column":4},"end":{"line":911,"column":5}},{"start":{"line":912,"column":4},"end":{"line":915,"column":5}},{"start":{"line":916,"column":4},"end":{"line":918,"column":5}}],"line":881},"141":{"loc":{"start":{"line":921,"column":9},"end":{"line":921,"column":41}},"type":"cond-expr","locations":[{"start":{"line":921,"column":23},"end":{"line":921,"column":36}},{"start":{"line":921,"column":39},"end":{"line":921,"column":41}}],"line":921},"142":{"loc":{"start":{"line":925,"column":2},"end":{"line":927,"column":3}},"type":"if","locations":[{"start":{"line":925,"column":2},"end":{"line":927,"column":3}},{"start":{},"end":{}}],"line":925},"143":{"loc":{"start":{"line":929,"column":2},"end":{"line":931,"column":3}},"type":"if","locations":[{"start":{"line":929,"column":2},"end":{"line":931,"column":3}},{"start":{},"end":{}}],"line":929},"144":{"loc":{"start":{"line":941,"column":2},"end":{"line":998,"column":3}},"type":"switch","locations":[{"start":{"line":942,"column":4},"end":{"line":944,"column":12}},{"start":{"line":945,"column":4},"end":{"line":952,"column":12}},{"start":{"line":953,"column":4},"end":{"line":960,"column":12}},{"start":{"line":961,"column":4},"end":{"line":968,"column":12}},{"start":{"line":969,"column":4},"end":{"line":976,"column":12}},{"start":{"line":977,"column":4},"end":{"line":980,"column":12}},{"start":{"line":981,"column":4},"end":{"line":984,"column":12}},{"start":{"line":985,"column":4},"end":{"line":995,"column":12}},{"start":{"line":996,"column":4},"end":{"line":997,"column":12}}],"line":941},"145":{"loc":{"start":{"line":963,"column":6},"end":{"line":967,"column":7}},"type":"if","locations":[{"start":{"line":963,"column":6},"end":{"line":967,"column":7}},{"start":{"line":965,"column":13},"end":{"line":967,"column":7}}],"line":963},"146":{"loc":{"start":{"line":971,"column":6},"end":{"line":975,"column":7}},"type":"if","locations":[{"start":{"line":971,"column":6},"end":{"line":975,"column":7}},{"start":{"line":973,"column":13},"end":{"line":975,"column":7}}],"line":971},"147":{"loc":{"start":{"line":987,"column":26},"end":{"line":987,"column":86}},"type":"binary-expr","locations":[{"start":{"line":987,"column":26},"end":{"line":987,"column":42}},{"start":{"line":987,"column":46},"end":{"line":987,"column":86}}],"line":987},"148":{"loc":{"start":{"line":988,"column":24},"end":{"line":988,"column":80}},"type":"binary-expr","locations":[{"start":{"line":988,"column":24},"end":{"line":988,"column":38}},{"start":{"line":988,"column":42},"end":{"line":988,"column":80}}],"line":988},"149":{"loc":{"start":{"line":999,"column":2},"end":{"line":1003,"column":3}},"type":"if","locations":[{"start":{"line":999,"column":2},"end":{"line":1003,"column":3}},{"start":{"line":1001,"column":9},"end":{"line":1003,"column":3}}],"line":999},"150":{"loc":{"start":{"line":1000,"column":11},"end":{"line":1000,"column":143}},"type":"cond-expr","locations":[{"start":{"line":1000,"column":46},"end":{"line":1000,"column":92}},{"start":{"line":1000,"column":95},"end":{"line":1000,"column":143}}],"line":1000},"151":{"loc":{"start":{"line":1007,"column":2},"end":{"line":1100,"column":3}},"type":"switch","locations":[{"start":{"line":1008,"column":4},"end":{"line":1018,"column":5}},{"start":{"line":1019,"column":4},"end":{"line":1029,"column":5}},{"start":{"line":1030,"column":4},"end":{"line":1033,"column":5}},{"start":{"line":1034,"column":4},"end":{"line":1044,"column":5}},{"start":{"line":1045,"column":4},"end":{"line":1055,"column":5}},{"start":{"line":1056,"column":4},"end":{"line":1060,"column":5}},{"start":{"line":1061,"column":4},"end":{"line":1065,"column":5}},{"start":{"line":1066,"column":4},"end":{"line":1066,"column":52}},{"start":{"line":1067,"column":4},"end":{"line":1074,"column":5}},{"start":{"line":1075,"column":4},"end":{"line":1075,"column":54}},{"start":{"line":1076,"column":4},"end":{"line":1083,"column":5}},{"start":{"line":1084,"column":4},"end":{"line":1099,"column":5}}],"line":1007},"152":{"loc":{"start":{"line":1069,"column":20},"end":{"line":1069,"column":116}},"type":"binary-expr","locations":[{"start":{"line":1069,"column":20},"end":{"line":1069,"column":40}},{"start":{"line":1069,"column":44},"end":{"line":1069,"column":116}}],"line":1069},"153":{"loc":{"start":{"line":1070,"column":6},"end":{"line":1072,"column":7}},"type":"if","locations":[{"start":{"line":1070,"column":6},"end":{"line":1072,"column":7}},{"start":{},"end":{}}],"line":1070},"154":{"loc":{"start":{"line":1078,"column":20},"end":{"line":1078,"column":116}},"type":"binary-expr","locations":[{"start":{"line":1078,"column":20},"end":{"line":1078,"column":40}},{"start":{"line":1078,"column":44},"end":{"line":1078,"column":116}}],"line":1078},"155":{"loc":{"start":{"line":1079,"column":6},"end":{"line":1081,"column":7}},"type":"if","locations":[{"start":{"line":1079,"column":6},"end":{"line":1081,"column":7}},{"start":{},"end":{}}],"line":1079},"156":{"loc":{"start":{"line":1089,"column":8},"end":{"line":1096,"column":9}},"type":"if","locations":[{"start":{"line":1089,"column":8},"end":{"line":1096,"column":9}},{"start":{},"end":{}}],"line":1089},"157":{"loc":{"start":{"line":1103,"column":2},"end":{"line":1164,"column":3}},"type":"switch","locations":[{"start":{"line":1104,"column":4},"end":{"line":1114,"column":5}},{"start":{"line":1115,"column":4},"end":{"line":1125,"column":5}},{"start":{"line":1126,"column":4},"end":{"line":1129,"column":5}},{"start":{"line":1130,"column":4},"end":{"line":1140,"column":5}},{"start":{"line":1141,"column":4},"end":{"line":1151,"column":5}},{"start":{"line":1152,"column":4},"end":{"line":1156,"column":5}},{"start":{"line":1157,"column":4},"end":{"line":1161,"column":5}},{"start":{"line":1162,"column":4},"end":{"line":1163,"column":12}}],"line":1103},"158":{"loc":{"start":{"line":1169,"column":2},"end":{"line":1362,"column":3}},"type":"switch","locations":[{"start":{"line":1170,"column":4},"end":{"line":1188,"column":5}},{"start":{"line":1189,"column":4},"end":{"line":1207,"column":5}},{"start":{"line":1208,"column":4},"end":{"line":1216,"column":5}},{"start":{"line":1217,"column":4},"end":{"line":1236,"column":5}},{"start":{"line":1237,"column":4},"end":{"line":1256,"column":5}},{"start":{"line":1257,"column":4},"end":{"line":1273,"column":5}},{"start":{"line":1274,"column":4},"end":{"line":1290,"column":5}},{"start":{"line":1291,"column":4},"end":{"line":1291,"column":52}},{"start":{"line":1292,"column":4},"end":{"line":1315,"column":5}},{"start":{"line":1316,"column":4},"end":{"line":1316,"column":54}},{"start":{"line":1317,"column":4},"end":{"line":1340,"column":5}},{"start":{"line":1341,"column":4},"end":{"line":1361,"column":5}}],"line":1169},"159":{"loc":{"start":{"line":1183,"column":25},"end":{"line":1183,"column":144}},"type":"cond-expr","locations":[{"start":{"line":1183,"column":85},"end":{"line":1183,"column":115}},{"start":{"line":1183,"column":118},"end":{"line":1183,"column":144}}],"line":1183},"160":{"loc":{"start":{"line":1184,"column":23},"end":{"line":1184,"column":146}},"type":"cond-expr","locations":[{"start":{"line":1184,"column":83},"end":{"line":1184,"column":111}},{"start":{"line":1184,"column":114},"end":{"line":1184,"column":146}}],"line":1184},"161":{"loc":{"start":{"line":1202,"column":22},"end":{"line":1202,"column":129}},"type":"cond-expr","locations":[{"start":{"line":1202,"column":76},"end":{"line":1202,"column":103}},{"start":{"line":1202,"column":106},"end":{"line":1202,"column":129}}],"line":1202},"162":{"loc":{"start":{"line":1203,"column":20},"end":{"line":1203,"column":131}},"type":"cond-expr","locations":[{"start":{"line":1203,"column":74},"end":{"line":1203,"column":99}},{"start":{"line":1203,"column":102},"end":{"line":1203,"column":131}}],"line":1203},"163":{"loc":{"start":{"line":1224,"column":13},"end":{"line":1228,"column":17}},"type":"cond-expr","locations":[{"start":{"line":1224,"column":34},"end":{"line":1228,"column":12}},{"start":{"line":1228,"column":15},"end":{"line":1228,"column":17}}],"line":1224},"164":{"loc":{"start":{"line":1244,"column":13},"end":{"line":1248,"column":17}},"type":"cond-expr","locations":[{"start":{"line":1244,"column":37},"end":{"line":1248,"column":12}},{"start":{"line":1248,"column":15},"end":{"line":1248,"column":17}}],"line":1244},"165":{"loc":{"start":{"line":1295,"column":20},"end":{"line":1295,"column":116}},"type":"binary-expr","locations":[{"start":{"line":1295,"column":20},"end":{"line":1295,"column":40}},{"start":{"line":1295,"column":44},"end":{"line":1295,"column":116}}],"line":1295},"166":{"loc":{"start":{"line":1296,"column":6},"end":{"line":1302,"column":7}},"type":"if","locations":[{"start":{"line":1296,"column":6},"end":{"line":1302,"column":7}},{"start":{},"end":{}}],"line":1296},"167":{"loc":{"start":{"line":1319,"column":20},"end":{"line":1319,"column":116}},"type":"binary-expr","locations":[{"start":{"line":1319,"column":20},"end":{"line":1319,"column":40}},{"start":{"line":1319,"column":44},"end":{"line":1319,"column":116}}],"line":1319},"168":{"loc":{"start":{"line":1321,"column":6},"end":{"line":1327,"column":7}},"type":"if","locations":[{"start":{"line":1321,"column":6},"end":{"line":1327,"column":7}},{"start":{},"end":{}}],"line":1321},"169":{"loc":{"start":{"line":1346,"column":8},"end":{"line":1353,"column":9}},"type":"if","locations":[{"start":{"line":1346,"column":8},"end":{"line":1353,"column":9}},{"start":{},"end":{}}],"line":1346}},"s":{"0":1,"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":1,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":1,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":1,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":1,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":1,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":1,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":1,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":1,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":1,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":1,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"216":1,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"223":0,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"230":0,"231":0,"232":0,"233":0,"234":0,"235":0,"236":0,"237":0,"238":0,"239":0,"240":0,"241":1,"242":0,"243":0,"244":0,"245":0,"246":0,"247":0,"248":0,"249":0,"250":0,"251":0,"252":1,"253":0,"254":0,"255":0,"256":0,"257":0,"258":0,"259":0,"260":0,"261":0,"262":0,"263":1,"264":0,"265":0,"266":0,"267":0,"268":0,"269":0,"270":0,"271":0,"272":0,"273":0,"274":0,"275":0,"276":0,"277":1,"278":0,"279":0,"280":0,"281":0,"282":0,"283":0,"284":0,"285":0,"286":0,"287":0,"288":0,"289":0,"290":0,"291":0,"292":0,"293":0,"294":0,"295":0,"296":0,"297":0,"298":0,"299":0,"300":1,"301":0,"302":0,"303":0,"304":0,"305":0,"306":0,"307":0,"308":0,"309":1,"310":0,"311":0,"312":0,"313":0,"314":0,"315":0,"316":0,"317":0,"318":1,"319":0,"320":0,"321":0,"322":0,"323":0,"324":0,"325":0,"326":0,"327":1,"328":0,"329":0,"330":0,"331":0,"332":0,"333":0,"334":0,"335":0,"336":0,"337":0,"338":0,"339":0,"340":0,"341":0,"342":0,"343":0,"344":0,"345":1,"346":0,"347":0,"348":0,"349":0,"350":0,"351":0,"352":0,"353":0,"354":1,"355":0,"356":0,"357":0,"358":0,"359":0,"360":0,"361":0,"362":0,"363":0,"364":0,"365":0,"366":0,"367":0,"368":0,"369":0,"370":0,"371":0,"372":1,"373":0,"374":0,"375":0,"376":0,"377":0,"378":0,"379":0,"380":0,"381":0,"382":0,"383":1,"384":0,"385":0,"386":0,"387":0,"388":0,"389":0,"390":0,"391":0,"392":0,"393":0,"394":0,"395":0,"396":0,"397":0,"398":0,"399":0,"400":0,"401":0,"402":0,"403":0,"404":1,"405":0,"406":0,"407":0,"408":0,"409":0,"410":0,"411":0,"412":0,"413":0,"414":0,"415":1,"416":0,"417":0,"418":0,"419":0,"420":0,"421":0,"422":0,"423":0,"424":0,"425":0,"426":0,"427":0,"428":0,"429":0,"430":0,"431":0,"432":0,"433":0,"434":0,"435":0,"436":1,"437":0,"438":0,"439":0,"440":0,"441":0,"442":0,"443":0,"444":0,"445":0,"446":0,"447":0,"448":1,"449":0,"450":0,"451":0,"452":0,"453":0,"454":0,"455":0,"456":0,"457":1,"458":0,"459":0,"460":0,"461":0,"462":0,"463":0,"464":0,"465":0,"466":1,"467":0,"468":0,"469":0,"470":0,"471":0,"472":0,"473":0,"474":0,"475":0,"476":0,"477":0,"478":0,"479":0,"480":0,"481":0,"482":0,"483":0,"484":0,"485":0,"486":0,"487":0,"488":1,"489":0,"490":0,"491":0,"492":0,"493":0,"494":0,"495":0,"496":0,"497":0,"498":0,"499":0,"500":0,"501":0,"502":0,"503":0,"504":0,"505":0,"506":0,"507":0,"508":0,"509":0,"510":0,"511":0,"512":0,"513":0,"514":0,"515":0,"516":0,"517":1,"518":0,"519":0,"520":0,"521":0,"522":0,"523":0,"524":0,"525":0,"526":1,"527":0,"528":0,"529":0,"530":0,"531":0,"532":0,"533":0,"534":0,"535":0,"536":0,"537":0,"538":0,"539":0,"540":0,"541":0,"542":0,"543":0,"544":1,"545":0,"546":0,"547":0,"548":0,"549":0,"550":0,"551":0,"552":0,"553":0,"554":0,"555":0,"556":0,"557":0,"558":0,"559":0,"560":0,"561":0,"562":0,"563":0,"564":0,"565":0,"566":0,"567":0,"568":0,"569":0,"570":0,"571":0,"572":0,"573":0,"574":0,"575":0,"576":0,"577":0,"578":0,"579":0,"580":0,"581":0,"582":0,"583":0,"584":0,"585":0,"586":0,"587":0,"588":0,"589":0,"590":0,"591":0,"592":0,"593":0,"594":0,"595":0,"596":0,"597":0,"598":0,"599":0,"600":0,"601":0,"602":0,"603":0,"604":0,"605":0,"606":0,"607":0,"608":0,"609":0,"610":0,"611":0,"612":0,"613":0,"614":0,"615":0,"616":0,"617":0,"618":0,"619":0,"620":0,"621":0,"622":0,"623":0,"624":0,"625":0,"626":0,"627":0,"628":0,"629":0,"630":0,"631":0,"632":0,"633":0,"634":0,"635":0,"636":0,"637":0,"638":0,"639":0,"640":0,"641":0,"642":0,"643":0,"644":0,"645":0,"646":0,"647":0,"648":0,"649":0,"650":0,"651":0,"652":0,"653":0,"654":0,"655":0,"656":0,"657":0,"658":0,"659":0,"660":0,"661":0,"662":0,"663":0,"664":0,"665":0,"666":0,"667":0,"668":0,"669":0,"670":0,"671":0,"672":0,"673":0,"674":0,"675":0,"676":0,"677":0,"678":0,"679":0,"680":0,"681":0,"682":0,"683":0,"684":0,"685":0,"686":0,"687":0,"688":0,"689":0,"690":0,"691":0,"692":0,"693":0,"694":0,"695":0,"696":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0},"b":{"0":[0,0,0,0],"1":[0,0,0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0,0],"31":[0,0],"32":[0,0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0],"52":[0,0],"53":[0,0],"54":[0,0],"55":[0,0],"56":[0,0],"57":[0,0],"58":[0,0],"59":[0,0],"60":[0,0],"61":[0,0],"62":[0,0],"63":[0,0],"64":[0,0],"65":[0,0],"66":[0,0],"67":[0,0],"68":[0,0],"69":[0,0],"70":[0,0],"71":[0,0],"72":[0,0],"73":[0,0],"74":[0,0,0,0,0],"75":[0,0],"76":[0,0],"77":[0,0,0],"78":[0,0],"79":[0,0,0],"80":[0,0],"81":[0,0],"82":[0,0],"83":[0,0],"84":[0,0],"85":[0,0],"86":[0,0],"87":[0,0],"88":[0,0],"89":[0,0],"90":[0,0],"91":[0,0],"92":[0,0],"93":[0,0],"94":[0,0],"95":[0,0,0,0,0],"96":[0,0],"97":[0,0,0,0,0,0],"98":[0,0],"99":[0,0],"100":[0,0],"101":[0,0],"102":[0,0],"103":[0,0],"104":[0,0],"105":[0,0],"106":[0,0],"107":[0,0],"108":[0,0],"109":[0,0],"110":[0,0],"111":[0,0],"112":[0,0],"113":[0,0],"114":[0,0],"115":[0,0],"116":[0,0],"117":[0,0],"118":[0,0],"119":[0,0],"120":[0,0],"121":[0,0],"122":[0,0],"123":[0,0],"124":[0,0],"125":[0,0],"126":[0,0],"127":[0,0],"128":[0,0],"129":[0,0,0,0],"130":[0,0],"131":[0,0],"132":[0,0],"133":[0,0],"134":[0,0],"135":[0,0],"136":[0,0],"137":[0,0,0,0,0,0,0,0,0,0,0,0],"138":[0,0],"139":[0,0],"140":[0,0,0,0,0,0,0,0,0,0,0,0],"141":[0,0],"142":[0,0],"143":[0,0],"144":[0,0,0,0,0,0,0,0,0],"145":[0,0],"146":[0,0],"147":[0,0],"148":[0,0],"149":[0,0],"150":[0,0],"151":[0,0,0,0,0,0,0,0,0,0,0,0],"152":[0,0],"153":[0,0],"154":[0,0],"155":[0,0],"156":[0,0],"157":[0,0,0,0,0,0,0,0],"158":[0,0,0,0,0,0,0,0,0,0,0,0],"159":[0,0],"160":[0,0],"161":[0,0],"162":[0,0],"163":[0,0],"164":[0,0],"165":[0,0],"166":[0,0],"167":[0,0],"168":[0,0],"169":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/ref-range/util.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommandInfo, IMutationInfo, IRange, Nullable } from '@univerjs/core';\nimport type { IInsertColMutationParams, IInsertRowMutationParams, IRemoveColMutationParams, IRemoveRowsMutationParams, IRemoveSheetMutationParams } from '../../basics';\nimport type { IInsertColCommandParams, IInsertRowCommandParams } from '../../commands/commands/insert-row-col.command';\nimport type { IRemoveRowColCommandInterceptParams } from '../../commands/commands/remove-row-col.command';\nimport type { IMoveRangeMutationParams } from '../../commands/mutations/move-range.mutation';\nimport type { IMoveColumnsMutationParams, IMoveRowsMutationParams } from '../../commands/mutations/move-rows-cols.mutation';\nimport type { ISheetCommandSharedParams } from '../../commands/utils/interface';\nimport type {\n    EffectRefRangeParams,\n    IDeleteRangeMoveLeftCommand,\n    IDeleteRangeMoveUpCommand,\n    IInsertColCommand,\n    IInsertRangeMoveDownCommand,\n    IInsertRangeMoveRightCommand,\n    IInsertRowCommand,\n    IMoveColsCommand,\n    IMoveRangeCommand,\n    IMoveRowsCommand,\n    IOperator,\n    IRemoveRowColCommand,\n    IReorderRangeCommand,\n} from './type';\nimport { IUniverInstanceService, ObjectMatrix, queryObjectMatrix, Range, RANGE_TYPE, Rectangle } from '@univerjs/core';\nimport { DeleteRangeMoveLeftCommand } from '../../commands/commands/delete-range-move-left.command';\nimport { DeleteRangeMoveUpCommand } from '../../commands/commands/delete-range-move-up.command';\nimport { InsertRangeMoveDownCommand } from '../../commands/commands/insert-range-move-down.command';\nimport { InsertRangeMoveRightCommandId } from '../../commands/commands/insert-range-move-right.command';\nimport { getSheetCommandTarget } from '../../commands/commands/utils/target-util';\nimport { InsertColMutation, InsertRowMutation } from '../../commands/mutations/insert-row-col.mutation';\nimport { MoveRangeMutation } from '../../commands/mutations/move-range.mutation';\nimport { MoveColsMutation, MoveRowsMutation } from '../../commands/mutations/move-rows-cols.mutation';\nimport { RemoveColMutation, RemoveRowMutation } from '../../commands/mutations/remove-row-col.mutation';\nimport { RemoveSheetMutation } from '../../commands/mutations/remove-sheet.mutation';\nimport { SheetsSelectionsService } from '../selections/selection.service';\nimport { EffectRefRangId, OperatorType } from './type';\n\nconst MAX_SAFE_INTEGER = Number.MAX_SAFE_INTEGER;\nexport const handleRangeTypeInput = (range: IRange) => {\n    const _range = { ...range };\n    const isColumn = Number.isNaN(_range.startRow) && Number.isNaN(_range.endRow) && !Number.isNaN(_range.startColumn) && !Number.isNaN(_range.endColumn);\n    const isRow = Number.isNaN(_range.startColumn) && Number.isNaN(_range.endColumn) && !Number.isNaN(_range.startRow) && !Number.isNaN(_range.endRow);\n    if (_range.rangeType === RANGE_TYPE.COLUMN || isColumn) {\n        _range.startRow = 0;\n        _range.endRow = MAX_SAFE_INTEGER;\n    }\n    if (_range.rangeType === RANGE_TYPE.ROW || isRow) {\n        _range.startColumn = 0;\n        _range.endColumn = MAX_SAFE_INTEGER;\n    }\n    if (_range.rangeType === RANGE_TYPE.ALL) {\n        _range.startColumn = 0;\n        _range.endColumn = MAX_SAFE_INTEGER;\n        _range.startRow = 0;\n        _range.endRow = MAX_SAFE_INTEGER;\n    }\n    return _range;\n};\nexport const handleRangeTypeOutput = (range: IRange, maxRow: number, maxCol: number) => {\n    const _range = { ...range };\n    if (_range.rangeType === RANGE_TYPE.COLUMN) {\n        _range.startRow = 0;\n        _range.endRow = maxRow;\n    } else if (_range.rangeType === RANGE_TYPE.ROW) {\n        _range.startColumn = 0;\n        _range.endColumn = maxCol;\n    } else if (_range.rangeType === RANGE_TYPE.ALL) {\n        _range.startColumn = 0;\n        _range.startRow = 0;\n        _range.endColumn = maxCol;\n        _range.endRow = maxRow;\n    } else {\n        _range.startRow = Math.max(0, _range.startRow);\n        _range.endRow = Math.min(maxRow, _range.endRow);\n        _range.startColumn = Math.max(0, _range.startColumn);\n        _range.endColumn = Math.min(maxCol, _range.endColumn);\n    }\n\n    return _range;\n};\nexport const rotateRange = (range: IRange): IRange => {\n    // rotate {startRow:2,endRow:3,startCol:3,endCol:10} to\n    // {startRow:3,endRow:10,startCol:2,endRow:3}\n    let rangeType = range.rangeType;\n    if (range.rangeType === RANGE_TYPE.COLUMN) {\n        rangeType = RANGE_TYPE.ROW;\n    } else if (range.rangeType === RANGE_TYPE.ROW) {\n        rangeType = RANGE_TYPE.COLUMN;\n    }\n    return {\n        startRow: range.startColumn,\n        endRow: range.endColumn,\n        startColumn: range.startRow,\n        endColumn: range.endRow,\n        rangeType,\n    };\n};\ninterface ILine {\n    start: number;\n    end: number;\n}\n/**\n * see docs/tldr/ref-range/move-rows-cols.tldr\n */\n// eslint-disable-next-line max-lines-per-function, complexity\nexport const handleBaseMoveRowsCols = (\n    fromRange: ILine,\n    toRange: ILine,\n    effectRange: ILine\n): { length: number; step: number } => {\n    const _effectRange = { ...effectRange };\n    const _toRange = { ...toRange };\n    const getIntersects = (line1: ILine, line2: ILine): Nullable<ILine> => {\n        const start = Math.max(line1.start, line2.start);\n        const end = Math.min(line1.end, line2.end);\n        if (end < start) {\n            return null;\n        }\n        return { start, end };\n    };\n    const getLength = (line: ILine) => line.end - line.start + 1;\n    const getRelative = (line: ILine, origin: ILine) => ({\n        start: line.start - origin.start,\n        end: line.start - origin.start + line.end - line.start,\n    });\n    const getAbsolute = (line: ILine, origin: ILine): ILine => ({\n        start: origin.start + line.start,\n        end: origin.start + line.start + line.end - line.start,\n    });\n    const isToLargeFrom = toRange.start > fromRange.start;\n    if (isToLargeFrom) {\n        const step = Math.min(fromRange.end, toRange.start) - fromRange.start + 1;\n        _toRange.start -= step;\n        _toRange.end -= step;\n    }\n    const fromRangeStep = getLength(fromRange);\n    const toRangeStep = fromRangeStep;\n    const fromRangeIntersectsEffectRange = getIntersects(fromRange, _effectRange);\n    const isFromRangeContainEffectRange =\n        fromRangeIntersectsEffectRange && getLength(fromRangeIntersectsEffectRange) >= getLength(_effectRange);\n    if (fromRange.end < _effectRange.start) {\n        _effectRange.start -= fromRangeStep;\n        _effectRange.end -= fromRangeStep;\n    } else if (fromRangeIntersectsEffectRange) {\n        //1- 4 5 8 9 11 12 14 15\n        //2- 6 7 8 10 11 13 14 15\n        //3- 3 5 6 7 8 9 11\n        const fromRangeIntersectsEffectRangeStep = getLength(fromRangeIntersectsEffectRange);\n        if (isFromRangeContainEffectRange) {\n            //1- 12\n            //2- 13\n            //3- 6 8 9\n            const relative = getRelative(_effectRange, fromRange);\n            const newLine = getAbsolute(relative, _toRange);\n            _effectRange.start = newLine.start;\n            _effectRange.end = newLine.end;\n        } else if (fromRangeIntersectsEffectRange.start > fromRange.start) {\n            //1- 5 8\n            //2- 6 8 10 11 14 15\n            //3- 5 7\n            if (isToLargeFrom) {\n                _effectRange.end -= fromRangeIntersectsEffectRangeStep + fromRangeStep;\n                _effectRange.start -= fromRangeStep;\n            } else {\n                _effectRange.end -= fromRangeIntersectsEffectRangeStep;\n            }\n        } else {\n            if (isToLargeFrom) {\n                //1- 4 9 11 14 15\n                //3- 3 11\n                _effectRange.end -= fromRangeIntersectsEffectRangeStep;\n            } else {\n                if (_effectRange.start > fromRange.start && _effectRange.end > fromRange.end) {\n                    // 2-7\n                    _effectRange.start -= fromRangeStep;\n                    _effectRange.end -= fromRangeStep + fromRangeIntersectsEffectRangeStep;\n                } else {\n                    // 2-6 10 11 14 15\n                    _effectRange.end -= fromRangeIntersectsEffectRangeStep;\n                }\n            }\n        }\n    }\n\n    const toRangeIntersectsEffectRange = getIntersects(_toRange, _effectRange);\n    if (!isFromRangeContainEffectRange) {\n        if (_toRange.start <= _effectRange.start) {\n            _effectRange.start += toRangeStep;\n            _effectRange.end += toRangeStep;\n        } else if (toRangeIntersectsEffectRange) {\n            if (!isToLargeFrom) {\n                if (_effectRange.start < _toRange.start && _effectRange.end > _toRange.start) {\n                    // 2-4 9 14 expend\n                    _effectRange.end += toRangeStep;\n                } else if (_effectRange.start >= _toRange.end || (_effectRange.start >= _toRange.start && _effectRange.start <= _toRange.end)) {\n                    // 2-5 8 12 15 move right\n                    _effectRange.end += toRangeStep;\n                    _effectRange.start += toRangeStep;\n                }\n            } else {\n                if (_toRange.end <= _effectRange.start || (_toRange.start <= _effectRange.start && _toRange.end >= _effectRange.start)) {\n                    // 1-3 7 13\n                    _effectRange.start += toRangeStep;\n                    _effectRange.end += toRangeStep;\n                } else if (_toRange.start >= _effectRange.start && _toRange.start <= _effectRange.end) {\n                    // 1-6 8 10  11 14 15\n                    _effectRange.end += toRangeStep;\n                }\n            }\n        }\n    }\n\n    return {\n        step: _effectRange.start - effectRange.start,\n        length: getLength(_effectRange) - getLength(effectRange),\n    };\n};\n\nexport const handleMoveRows = (params: IMoveRowsCommand, targetRange: IRange): IOperator[] => {\n    const { fromRange, toRange } = params.params || {};\n    if (!toRange || !fromRange) {\n        return [];\n    }\n    const _fromRange = handleRangeTypeInput(fromRange);\n    const _toRange = handleRangeTypeInput(toRange);\n    const _targetRange = handleRangeTypeInput(targetRange);\n    const result = handleBaseMoveRowsCols(\n        { start: _fromRange.startRow, end: _fromRange.endRow },\n        { start: _toRange.startRow, end: _toRange.endRow },\n        { start: _targetRange.startRow, end: _targetRange.endRow }\n    );\n    if (result === null) {\n        return [\n            {\n                type: OperatorType.Delete,\n            },\n        ];\n    }\n    return [\n        {\n            type: OperatorType.VerticalMove,\n            step: result.step || 0,\n            length: result.length || 0,\n        },\n    ];\n};\n\nexport const handleMoveRowsCommon = (params: IMoveRowsCommand, targetRange: IRange) => {\n    const { fromRange, toRange } = params.params || {};\n    if (!fromRange || !toRange) {\n        return [targetRange];\n    }\n\n    const fromRow = fromRange.startRow;\n    const count = fromRange.endRow - fromRange.startRow + 1;\n    const toRow = toRange.startRow;\n\n    const matrix = new ObjectMatrix();\n\n    Range.foreach(targetRange, (row, col) => {\n        matrix.setValue(row, col, 1);\n    });\n\n    matrix.moveRows(fromRow, count, toRow);\n\n    // TODO@zhangw try to remove queryObjectMatrix, this could case memory out of use in large range.\n    const res = queryObjectMatrix(matrix, (value) => value === 1);\n    return res;\n};\n\nexport const handleReorderRangeCommon = (param: IReorderRangeCommand, targetRange: IRange) => {\n    const { range, order } = param.params || {};\n    if (!range || !order) {\n        return [targetRange];\n    }\n    const matrix = new ObjectMatrix();\n    Range.foreach(targetRange, (row, col) => {\n        matrix.setValue(row, col, 1);\n    });\n\n    const cacheMatrix = new ObjectMatrix();\n    Range.foreach(range, (row, col) => {\n        if (Object.prototype.hasOwnProperty.call(order, row)) {\n            const targetRow = order[row];\n            const cloneCell = matrix.getValue(targetRow, col) ?? 0;\n            cacheMatrix.setValue(row, col, cloneCell);\n        }\n    });\n\n    cacheMatrix.forValue((row, col, cellData) => {\n        matrix.setValue(row, col, cellData);\n    });\n    // TODO@zhangw try to remove queryObjectMatrix, this could case memory out of use in large range.\n    const res = queryObjectMatrix(matrix, (value) => value === 1);\n    return res;\n};\n\nexport const handleMoveCols = (params: IMoveColsCommand, targetRange: IRange): IOperator[] => {\n    const { fromRange, toRange } = params.params || {};\n    if (!toRange || !fromRange) {\n        return [];\n    }\n    const _fromRange = handleRangeTypeInput(fromRange);\n    const _toRange = handleRangeTypeInput(toRange);\n    const _targetRange = handleRangeTypeInput(targetRange);\n    const result = handleBaseMoveRowsCols(\n        { start: _fromRange.startColumn, end: _fromRange.endColumn },\n        { start: _toRange.startColumn, end: _toRange.endColumn },\n        { start: _targetRange.startColumn, end: _targetRange.endColumn }\n    );\n    if (result === null) {\n        return [\n            {\n                type: OperatorType.Delete,\n            },\n        ];\n    }\n    return [\n        {\n            type: OperatorType.HorizontalMove,\n            step: result.step || 0,\n            length: result.length || 0,\n        },\n    ];\n};\n\nexport const handleMoveColsCommon = (params: IMoveColsCommand, targetRange: IRange) => {\n    const { fromRange, toRange } = params.params || {};\n    if (!fromRange || !toRange) {\n        return [targetRange];\n    }\n\n    const fromCol = fromRange.startColumn;\n    const count = fromRange.endColumn - fromRange.startColumn + 1;\n    const toCol = toRange.startColumn;\n\n    const matrix = new ObjectMatrix();\n\n    Range.foreach(targetRange, (row, col) => {\n        matrix.setValue(row, col, 1);\n    });\n\n    matrix.moveColumns(fromCol, count, toCol);\n    // TODO@zhangw try to remove queryObjectMatrix, this could case memory out of use in large range.\n    return queryObjectMatrix(matrix, (value) => value === 1);\n};\n\nexport const handleMoveRange = (param: IMoveRangeCommand, targetRange: IRange) => {\n    const toRange = param.params?.toRange;\n    const fromRange = param.params?.fromRange;\n    if (!toRange || !fromRange) {\n        return [];\n    }\n    const operators: IOperator[] = [];\n\n    if (Rectangle.contains(toRange, targetRange)) {\n        operators.push({\n            type: OperatorType.Delete,\n        });\n    }\n\n    if (Rectangle.contains(fromRange, targetRange)) {\n        operators.push({\n            type: OperatorType.Delete,\n        });\n        const relativeRange = Rectangle.getRelativeRange(targetRange, fromRange);\n        const positionRange = Rectangle.getPositionRange(relativeRange, toRange);\n        return [\n            {\n                type: OperatorType.Set,\n                range: positionRange,\n            },\n        ] as IOperator[];\n    }\n    return operators;\n};\n\nexport const handleMoveRangeCommon = (param: IMoveRangeCommand, targetRange: IRange) => {\n    const toRange = param.params?.toRange;\n    const fromRange = param.params?.fromRange;\n    // illegal\n    if (!toRange || !fromRange) {\n        return [targetRange];\n    }\n\n    if (!Rectangle.intersects(fromRange, targetRange) && !Rectangle.intersects(toRange, targetRange)) {\n        return [targetRange];\n    }\n\n    if (Rectangle.contains(fromRange, targetRange)) {\n        const relativeRange = Rectangle.getRelativeRange(targetRange, fromRange);\n        const positionRange = Rectangle.getPositionRange(relativeRange, toRange);\n        return [positionRange];\n    }\n\n    const matrix = new ObjectMatrix();\n\n    Range.foreach(targetRange, (row, col) => {\n        matrix.setValue(row, col, 1);\n    });\n\n    const fromMatrix = new ObjectMatrix();\n    const loopFromRange = Rectangle.getIntersects(fromRange, targetRange);\n\n    loopFromRange && Range.foreach(loopFromRange, (row, col) => {\n        if (matrix.getValue(row, col)) {\n            matrix.setValue(row, col, undefined);\n            fromMatrix.setValue(row, col, 1);\n        }\n    });\n\n    const columnOffset = toRange.startColumn - fromRange.startColumn;\n    const rowOffset = toRange.startRow - fromRange.startRow;\n\n    const loopToRange = {\n        startColumn: toRange.startColumn - columnOffset,\n        endColumn: toRange.endColumn - columnOffset,\n        startRow: toRange.startRow - rowOffset,\n        endRow: toRange.endRow - rowOffset,\n    };\n\n    loopToRange && Range.foreach(loopToRange, (row, col) => {\n        const targetRow = row + rowOffset;\n        const targetCol = col + columnOffset;\n        matrix.setValue(targetRow, targetCol, fromMatrix.getValue(row, col) ?? 0);\n    });\n\n    // TODO@zhangw try to remove queryObjectMatrix, this could case memory out of use in large range.\n    const res = queryObjectMatrix(matrix, (value) => value === 1);\n    return res;\n};\n\n// see docs/tldr/ref-range/remove-rows-cols.tldr\nexport const handleBaseRemoveRange = (_removeRange: IRange, _targetRange: IRange) => {\n    const removeRange = handleRangeTypeInput(_removeRange);\n    const targetRange = handleRangeTypeInput(_targetRange);\n    const getLength = (range: IRange): number => range.endColumn - range.startColumn + 1;\n    const getRowLength = (range: IRange): number => range.endRow - range.startRow + 1;\n    if (removeRange.startRow <= targetRange.startRow && removeRange.endRow >= targetRange.endRow) {\n        if (\n            // 2\n            (targetRange.startColumn < removeRange.startColumn &&\n                targetRange.endColumn >= removeRange.startColumn &&\n                targetRange.endColumn <= removeRange.endColumn) ||\n            // 6\n            (targetRange.startColumn < removeRange.startColumn && targetRange.endColumn >= removeRange.endColumn)\n        ) {\n            const intersectedRange = Rectangle.getIntersects(targetRange, removeRange);\n            if (intersectedRange) {\n                const length = -getLength(intersectedRange);\n                return { step: 0, length };\n            }\n        }\n        // 3\n        if (\n            targetRange.startColumn >= removeRange.startColumn &&\n            targetRange.endColumn <= removeRange.endColumn &&\n            getRowLength(removeRange) >= getRowLength(targetRange)\n        ) {\n            return null;\n        }\n        // 4\n        if (\n            targetRange.startColumn >= removeRange.startColumn &&\n            targetRange.startColumn <= removeRange.endColumn &&\n            targetRange.endColumn > removeRange.endColumn\n        ) {\n            const intersectedRange = Rectangle.getIntersects(targetRange, removeRange);\n            if (intersectedRange) {\n                const length = -getLength(intersectedRange);\n                const step = -(getLength(removeRange) - getLength(intersectedRange));\n\n                return { step, length };\n            }\n        }\n        // 5\n        if (targetRange.startColumn > removeRange.endColumn) {\n            const step = -getLength(removeRange);\n            return { step, length: 0 };\n        }\n    }\n    return { step: 0, length: 0 };\n};\nexport const handleIRemoveCol = (param: IRemoveRowColCommand, targetRange: IRange) => {\n    const range = param.params?.range;\n    if (!range) {\n        return [];\n    }\n    const operators: IOperator[] = [];\n    const result = handleBaseRemoveRange(range, targetRange);\n    if (!result) {\n        operators.push({ type: OperatorType.Delete });\n    } else {\n        const { step, length } = result;\n        operators.push({\n            type: OperatorType.HorizontalMove,\n            step,\n            length,\n        });\n    }\n    return operators;\n};\n\nexport const handleIRemoveRow = (param: IRemoveRowColCommand, targetRange: IRange) => {\n    const range = param.params?.range;\n    if (!range) {\n        return [];\n    }\n    const operators: IOperator[] = [];\n    const result = handleBaseRemoveRange(rotateRange(range), rotateRange(targetRange));\n    if (!result) {\n        operators.push({ type: OperatorType.Delete });\n    } else {\n        const { step, length } = result;\n        operators.push({\n            type: OperatorType.VerticalMove,\n            step,\n            length,\n        });\n    }\n    return operators;\n};\n\nexport const handleReorderRange = (param: IReorderRangeCommand, targetRange: IRange) => {\n    const { range, order } = param.params || {};\n    if (!range || !order) {\n        return [];\n    }\n\n    if (Rectangle.contains(range, targetRange) && targetRange.endRow === targetRange.startRow) {\n        const operators: IOperator[] = [];\n        const targetRow = targetRange.startRow;\n        for (const k in order) {\n            if (order[k] === targetRow) {\n                const toRow = Number(k);\n                operators.push({\n                    type: OperatorType.VerticalMove,\n                    step: toRow - targetRow,\n                    length: 0,\n                });\n                return operators;\n            }\n        }\n        return [];\n    }\n    return [];\n};\n\n/**\n * see docs/tldr/ref-range/insert-rows-cols.tldr\n * calculate insert steps(move step) or expand size(length) to ref range.\n *\n * @param _insertRange inserted range\n * @param _targetRange ref range\n * @returns {step: number, length: number} step means inserted count of row/col before ref range, that would cause range move few cells(steps) afterward.\n * length means expand size of row/col in ref range, that would make ref range larger than before.\n */\nexport const handleBaseInsertRange = (_insertRange: IRange, _targetRange: IRange) => {\n    const insertRange = handleRangeTypeInput(_insertRange);\n    const targetRange = handleRangeTypeInput(_targetRange);\n    const getLength = (range: IRange): number => range.endColumn - range.startColumn + 1;\n    if (!(insertRange.startRow <= targetRange.startRow && insertRange.endRow >= targetRange.endRow)) {\n        return { step: 0, length: 0 };\n    }\n\n    // expand range, that means insert new rows/cols in target range\n    if (\n        // 2\n        // Case 2: Overlap on the left side\n        // Target range starts before the insert range and ends within the insert range boundaries\n        // targetRange:  |----------|\n        // insertRange:         |-------|\n        // insertRange:\n        (targetRange.startColumn < insertRange.startColumn &&\n            targetRange.endColumn >= insertRange.startColumn &&\n            targetRange.endColumn <= insertRange.endColumn)\n        ||\n        // 6\n        // Case 6: Fully overlapping on both sides\n        // Target range starts before the insert range and ends after the insert range\n        // targetRange:  |----------------|\n        // insertRange:         |-------|\n        (targetRange.startColumn < insertRange.startColumn && targetRange.endColumn >= insertRange.endColumn)\n\n        // (targetRange.startColumn === insertRange.startColumn && targetRange.endColumn > insertRange.endColumn)\n    ) {\n        const length = getLength(insertRange);\n        return { step: 0, length };\n    }\n\n    // make range shifted backward, that means insert new rows/cols before target range\n    if (\n        // 3\n        // Case 3: Fully contained\n        // Target range is completely within the insert range\n        // targetRange:      |---|\n        // insertRange:    |-------|\n        (targetRange.startColumn >= insertRange.startColumn && targetRange.endColumn <= insertRange.endColumn) ||\n        // 4\n        // Case 4: Overlap on the right side\n        // Target range starts within the insert range and ends after the insert range\n        // targetRange:         |---------|\n        // insertRange:    |-------|\n        (targetRange.startColumn >= insertRange.startColumn &&\n            targetRange.startColumn <= insertRange.endColumn &&\n            targetRange.endColumn > insertRange.endColumn) ||\n        //5\n        // Case 5: No overlap (target range starts after the insert range ends)\n        // targetRange:                |-------|\n        // insertRange:    |-------|\n        targetRange.startColumn >= insertRange.endColumn\n\n    ) {\n        const step = getLength(insertRange);\n        return { step, length: 0 };\n    }\n\n    return { step: 0, length: 0 };\n};\n\nfunction handleBaseMoveRange(fromRange: IRange, toRange: IRange, targetRange: IRange) {\n    const operators: IOperator[] = [];\n\n    if (Rectangle.contains(toRange, targetRange)) {\n        operators.push({\n            type: OperatorType.Delete,\n        });\n    }\n\n    if (Rectangle.contains(fromRange, targetRange)) {\n        operators.push({\n            type: OperatorType.Delete,\n        });\n        const relativeRange = Rectangle.getRelativeRange(targetRange, fromRange);\n        const positionRange = Rectangle.getPositionRange(relativeRange, toRange);\n        return [\n            {\n                type: OperatorType.Set,\n                range: positionRange,\n            },\n        ] as IOperator[];\n    }\n    return operators;\n};\n\nexport const handleInsertRow = (param: IInsertRowCommand, targetRange: IRange) => {\n    const range = param.params?.range;\n    if (!range) {\n        return [];\n    }\n    const operators: IOperator[] = [];\n    const result = handleBaseInsertRange(rotateRange(range), rotateRange(targetRange));\n    const { step, length } = result;\n    operators.push({\n        type: OperatorType.VerticalMove,\n        step,\n        length,\n    });\n    return operators;\n};\n\nexport const handleInsertCol = (param: IInsertColCommand, targetRange: IRange) => {\n    const range = param.params?.range;\n    if (!range) {\n        return [];\n    }\n    const operators: IOperator[] = [];\n    const result = handleBaseInsertRange(range, targetRange);\n    const { step, length } = result;\n    operators.push({\n        type: OperatorType.HorizontalMove,\n        step,\n        length,\n    });\n    return operators;\n};\n\nexport const handleInsertRangeMoveDown = (param: IInsertRangeMoveDownCommand, targetRange: IRange) => {\n    const range = param.params?.range;\n    if (!range) {\n        return [];\n    }\n    const operators: IOperator[] = [];\n    const result = handleBaseInsertRange(rotateRange(range), rotateRange(targetRange));\n    const { step, length } = result;\n    operators.push({\n        type: OperatorType.VerticalMove,\n        step,\n        length,\n    });\n    return operators;\n};\n\nexport const handleInsertRangeMoveDownCommon = (param: IInsertRangeMoveDownCommand, targetRange: IRange) => {\n    const range = param.params?.range;\n    if (!range) {\n        return [targetRange];\n    }\n\n    const moveCount = range.endRow - range.startRow + 1;\n    const bottomRange: IRange = {\n        ...range,\n        startRow: range.startRow,\n        endRow: Number.POSITIVE_INFINITY,\n    };\n\n    const noMoveRanges = Rectangle.subtract(targetRange, bottomRange);\n    const targetMoveRange = Rectangle.getIntersects(bottomRange, targetRange);\n\n    if (!targetMoveRange) {\n        return [targetRange];\n    }\n\n    const matrix = new ObjectMatrix<number>();\n    noMoveRanges.forEach((noMoveRange) => {\n        Range.foreach(noMoveRange, (row, col) => {\n            matrix.setValue(row, col, 1);\n        });\n    });\n\n    targetMoveRange && Range.foreach(targetMoveRange, (row, col) => {\n        matrix.setValue(row + moveCount, col, 1);\n    });\n\n    // TODO@zhangw try to remove queryObjectMatrix, this could case memory out of use in large range.\n    return queryObjectMatrix(matrix, (v) => v === 1);\n};\n\nexport const handleInsertRangeMoveRight = (param: IInsertRangeMoveRightCommand, targetRange: IRange) => {\n    const range = param.params?.range;\n    if (!range) {\n        return [];\n    }\n    const operators: IOperator[] = [];\n    const result = handleBaseInsertRange(range, targetRange);\n    const { step, length } = result;\n    operators.push({\n        type: OperatorType.HorizontalMove,\n        step,\n        length,\n    });\n    return operators;\n};\n\nexport const handleInsertRangeMoveRightCommon = (param: IInsertRangeMoveRightCommand, targetRange: IRange) => {\n    const range = param.params?.range;\n    if (!range) {\n        return [targetRange];\n    }\n\n    const moveCount = range.endColumn - range.startColumn + 1;\n    const bottomRange: IRange = {\n        ...range,\n        startColumn: range.startColumn,\n        endColumn: Number.POSITIVE_INFINITY,\n    };\n\n    const noMoveRanges = Rectangle.subtract(targetRange, bottomRange);\n    const targetMoveRange = Rectangle.getIntersects(bottomRange, targetRange);\n\n    if (!targetMoveRange) {\n        return [targetRange];\n    }\n\n    const matrix = new ObjectMatrix<number>();\n    noMoveRanges.forEach((noMoveRange) => {\n        Range.foreach(noMoveRange, (row, col) => {\n            matrix.setValue(row, col, 1);\n        });\n    });\n\n    targetMoveRange && Range.foreach(targetMoveRange, (row, col) => {\n        matrix.setValue(row, col + moveCount, 1);\n    });\n\n    // TODO@zhangw try to remove queryObjectMatrix, this could case memory out of use in large range.\n    return queryObjectMatrix(matrix, (v) => v === 1);\n};\n\nexport const handleDeleteRangeMoveLeft = (param: IDeleteRangeMoveLeftCommand, targetRange: IRange) => {\n    const range = param.params?.range;\n    if (!range) {\n        return [];\n    }\n\n    const operators: IOperator[] = [];\n    const result = handleBaseRemoveRange(range, targetRange);\n\n    if (!result) {\n        operators.push({ type: OperatorType.Delete });\n    } else {\n        const { step, length } = result;\n        operators.push({\n            type: OperatorType.HorizontalMove,\n            step,\n            length,\n        });\n    }\n\n    return operators;\n};\n\nexport const handleDeleteRangeMoveLeftCommon = (param: IDeleteRangeMoveLeftCommand, targetRange: IRange) => {\n    const range = param.params?.range;\n    if (!range) {\n        return [targetRange];\n    }\n\n    const rightRange: IRange = {\n        startRow: range.startRow,\n        endRow: range.endRow,\n        startColumn: range.startColumn,\n        endColumn: Number.POSITIVE_INFINITY,\n    };\n\n    const moveCount = range.endColumn - range.startColumn + 1;\n    // this range need delete\n    const targetDeleteRange = Rectangle.getIntersects(range, targetRange);\n\n    const noMoveRanges = Rectangle.subtract(targetRange, rightRange);\n    const targetMoveRange = Rectangle.getIntersects(rightRange, targetRange);\n\n    if (!targetDeleteRange && !targetMoveRange) {\n        return [targetRange];\n    }\n\n    const matrix = new ObjectMatrix<number>();\n\n    targetMoveRange && Range.foreach(targetMoveRange, (row, col) => {\n        matrix.setValue(row, col - moveCount, 1);\n    });\n\n    targetDeleteRange && Range.foreach(targetDeleteRange, (row, col) => {\n        matrix.setValue(row, col - moveCount, 0);\n    });\n\n    noMoveRanges.forEach((noMoveRange) => {\n        Range.foreach(noMoveRange, (row, col) => {\n            matrix.setValue(row, col, 1);\n        });\n    });\n\n    // TODO@zhangw try to remove queryObjectMatrix, this could case memory out of use in large range.\n    return queryObjectMatrix(matrix, (v) => v === 1);\n};\n\nexport const handleDeleteRangeMoveUp = (param: IDeleteRangeMoveUpCommand, targetRange: IRange) => {\n    const range = param.params?.range;\n    if (!range) {\n        return [];\n    }\n    const operators: IOperator[] = [];\n    const result = handleBaseRemoveRange(rotateRange(range), rotateRange(targetRange));\n    if (!result) {\n        operators.push({ type: OperatorType.Delete });\n    } else {\n        const { step, length } = result;\n        operators.push({\n            type: OperatorType.VerticalMove,\n            step,\n            length,\n        });\n    }\n    return operators;\n};\n\nexport const handleDeleteRangeMoveUpCommon = (param: IDeleteRangeMoveUpCommand, targetRange: IRange) => {\n    const range = param.params?.range;\n    if (!range) {\n        return [targetRange];\n    }\n\n    const bottomRange: IRange = {\n        ...range,\n        startRow: range.startRow,\n        endRow: Number.POSITIVE_INFINITY,\n    };\n\n    const moveCount = range.endRow - range.startRow + 1;\n    // this range need delete\n    const targetDeleteRange = Rectangle.getIntersects(range, targetRange);\n\n    const noMoveRanges = Rectangle.subtract(targetRange, bottomRange);\n    const targetMoveRange = Rectangle.getIntersects(bottomRange, targetRange);\n\n    if (!targetDeleteRange && !targetMoveRange) {\n        return [targetRange];\n    }\n\n    const matrix = new ObjectMatrix<number>();\n\n    targetMoveRange && Range.foreach(targetMoveRange, (row, col) => {\n        matrix.setValue(row - moveCount, col, 1);\n    });\n\n    targetDeleteRange && Range.foreach(targetDeleteRange, (row, col) => {\n        matrix.setValue(row - moveCount, col, 0);\n    });\n\n    noMoveRanges.forEach((noMoveRange) => {\n        Range.foreach(noMoveRange, (row, col) => {\n            matrix.setValue(row, col, 1);\n        });\n    });\n\n    // TODO@zhangw try to remove queryObjectMatrix, this could case memory out of use in large range.\n    return queryObjectMatrix(matrix, (v) => v === 1);\n};\n\nexport const handleRemoveRowCommon = (param: IRemoveRowColCommandInterceptParams, targetRange: IRange) => {\n    const ranges = param.ranges ?? [param.range];\n    const matrix = new ObjectMatrix();\n\n    Range.foreach(targetRange, (row, col) => {\n        matrix.setValue(row, col, 1);\n    });\n\n    ranges.forEach((range) => {\n        const startRow = range.startRow;\n        const endRow = range.endRow;\n        const count = endRow - startRow + 1;\n        matrix.removeRows(startRow, count);\n    });\n\n    // TODO@zhangw try to remove queryObjectMatrix, this could case memory out of use in large range.\n    return queryObjectMatrix(matrix, (value) => value === 1);\n};\n\nexport const handleInsertRowCommon = (info: ICommandInfo<IInsertRowCommandParams>, targetRange: IRange) => {\n    const param = info.params!;\n    const insertRow = param.range.startRow;\n    const insertCount = param.range.endRow - param.range.startRow + 1;\n\n    if (targetRange.startRow >= insertRow) {\n        return [{\n            startRow: targetRange.startRow + insertCount,\n            endRow: targetRange.endRow + insertCount,\n            startColumn: targetRange.startColumn,\n            endColumn: targetRange.endColumn,\n        }];\n    } else if (targetRange.endRow < insertRow) {\n        return [targetRange];\n    } else {\n        return [{\n            startRow: targetRange.startRow,\n            endRow: targetRange.endRow + insertCount,\n            startColumn: targetRange.startColumn,\n            endColumn: targetRange.endColumn,\n        }];\n    }\n};\n\nexport const handleInsertColCommon = (info: ICommandInfo<IInsertColCommandParams>, targetRange: IRange) => {\n    const param = info.params!;\n    const insertColumn = param.range.startColumn;\n    const insertCount = param.range.endColumn - param.range.startColumn + 1;\n\n    if (targetRange.startColumn >= insertColumn) {\n        return [{\n            startRow: targetRange.startRow,\n            endRow: targetRange.endRow,\n            startColumn: targetRange.startColumn + insertCount,\n            endColumn: targetRange.endColumn + insertCount,\n        }];\n    } else if (targetRange.endColumn < insertColumn) {\n        return [targetRange];\n    } else {\n        return [{\n            startRow: targetRange.startRow,\n            endRow: targetRange.endRow,\n            startColumn: targetRange.startColumn,\n            endColumn: targetRange.endColumn + insertCount,\n        }];\n    }\n};\n\nexport const runRefRangeMutations = (operators: IOperator[], range: IRange) => {\n    let result: Nullable<IRange> = { ...range };\n    operators.forEach((operator) => {\n        switch (operator.type) {\n            case OperatorType.Delete: {\n                result = null;\n                break;\n            }\n            case OperatorType.HorizontalMove: {\n                if (!result) {\n                    return;\n                }\n                result.startColumn += operator.step;\n                result.endColumn += operator.step + (operator.length || 0);\n                break;\n            }\n            case OperatorType.VerticalMove: {\n                if (!result) {\n                    return;\n                }\n                result.startRow += operator.step;\n                result.endRow += operator.step + (operator.length || 0);\n                break;\n            }\n            case OperatorType.Set: {\n                result = operator.range;\n                break;\n            }\n        }\n    });\n    if (result) {\n        if (result.endColumn < result.startColumn || result.endRow < result.startRow) {\n            return null;\n        }\n    }\n    return result;\n};\n\nexport const handleDefaultRangeChangeWithEffectRefCommands = (range: IRange, commandInfo: ICommandInfo) => {\n    let operator: IOperator[] = [];\n    switch (commandInfo.id) {\n        case EffectRefRangId.DeleteRangeMoveLeftCommandId: {\n            operator = handleDeleteRangeMoveLeft(commandInfo as IDeleteRangeMoveLeftCommand, range);\n            break;\n        }\n        case EffectRefRangId.DeleteRangeMoveUpCommandId: {\n            operator = handleDeleteRangeMoveUp(commandInfo as IDeleteRangeMoveUpCommand, range);\n            break;\n        }\n        case EffectRefRangId.InsertColCommandId: {\n            operator = handleInsertCol(commandInfo as IInsertColCommand, range);\n            break;\n        }\n        case EffectRefRangId.InsertRangeMoveDownCommandId: {\n            operator = handleInsertRangeMoveDown(commandInfo as IInsertRangeMoveDownCommand, range);\n            break;\n        }\n        case EffectRefRangId.InsertRangeMoveRightCommandId: {\n            operator = handleInsertRangeMoveRight(commandInfo as IInsertRangeMoveRightCommand, range);\n            break;\n        }\n        case EffectRefRangId.InsertRowCommandId: {\n            operator = handleInsertRow(commandInfo as IInsertRowCommand, range);\n            break;\n        }\n        case EffectRefRangId.MoveColsCommandId: {\n            operator = handleMoveCols(commandInfo as IMoveColsCommand, range);\n            break;\n        }\n        case EffectRefRangId.MoveRangeCommandId: {\n            operator = handleMoveRange(commandInfo as IMoveRangeCommand, range);\n            break;\n        }\n        case EffectRefRangId.MoveRowsCommandId: {\n            operator = handleMoveRows(commandInfo as IMoveRowsCommand, range);\n            break;\n        }\n        case EffectRefRangId.RemoveColCommandId: {\n            operator = handleIRemoveCol(commandInfo as IRemoveRowColCommand, range);\n            break;\n        }\n        case EffectRefRangId.RemoveRowCommandId: {\n            operator = handleIRemoveRow(commandInfo as IRemoveRowColCommand, range);\n            break;\n        }\n        case EffectRefRangId.ReorderRangeCommandId: {\n            operator = handleReorderRange(commandInfo as IReorderRangeCommand, range);\n            break;\n        }\n    }\n\n    const resultRange = runRefRangeMutations(operator, range);\n    return resultRange;\n};\n\nexport const handleDefaultRangeChangeWithEffectRefCommandsSkipNoInterests = (range: IRange, commandInfo: ICommandInfo, deps: { selectionManagerService: SheetsSelectionsService }) => {\n    const skipCommands = [DeleteRangeMoveLeftCommand.id, DeleteRangeMoveUpCommand.id];\n    if (skipCommands.includes(commandInfo.id)) {\n        return handleDefaultRangeChangeWithEffectRefCommands(range, commandInfo);\n    }\n\n    const effectRanges = getEffectedRangesOnCommand(commandInfo as EffectRefRangeParams, deps);\n    if (effectRanges.some((effectRange) => Rectangle.intersects(effectRange, range))) {\n        return handleDefaultRangeChangeWithEffectRefCommands(range, commandInfo);\n    }\n\n    return range;\n};\n\nexport type MutationsAffectRange =\n    ISheetCommandSharedParams\n    | IRemoveSheetMutationParams\n    | IMoveRowsMutationParams\n    | IMoveColumnsMutationParams\n    | IRemoveRowsMutationParams\n    | IRemoveColMutationParams\n    | IInsertColMutationParams\n    | IInsertRowMutationParams\n    | IMoveRangeMutationParams;\n\nexport const handleCommonDefaultRangeChangeWithEffectRefCommands = (range: IRange, commandInfo: ICommandInfo): IRange[] => {\n    let operator: IOperator[] = [];\n    switch (commandInfo.id) {\n        case EffectRefRangId.DeleteRangeMoveLeftCommandId: {\n            return handleDeleteRangeMoveLeftCommon(commandInfo as IDeleteRangeMoveLeftCommand, range);\n        }\n        case EffectRefRangId.DeleteRangeMoveUpCommandId: {\n            return handleDeleteRangeMoveUpCommon(commandInfo as IDeleteRangeMoveUpCommand, range);\n        }\n        case EffectRefRangId.InsertRangeMoveDownCommandId: {\n            return handleInsertRangeMoveDownCommon(commandInfo as IInsertRangeMoveDownCommand, range);\n        }\n        case EffectRefRangId.InsertRangeMoveRightCommandId: {\n            return handleInsertRangeMoveRightCommon(commandInfo as IInsertRangeMoveRightCommand, range);\n        }\n        case EffectRefRangId.InsertColCommandId: {\n            return handleInsertColCommon(commandInfo as IInsertColCommand, range);\n        }\n        case EffectRefRangId.InsertRowCommandId: {\n            return handleInsertRowCommon(commandInfo as IInsertRowCommand, range);\n        }\n        case EffectRefRangId.MoveColsCommandId: {\n            return handleMoveColsCommon(commandInfo as IMoveColsCommand, range);\n        }\n        case EffectRefRangId.MoveRangeCommandId: {\n            return handleMoveRangeCommon(commandInfo as IMoveRangeCommand, range);\n        }\n        case EffectRefRangId.MoveRowsCommandId: {\n            return handleMoveRowsCommon(commandInfo as IMoveRowsCommand, range);\n        }\n        case EffectRefRangId.ReorderRangeCommandId: {\n            return handleReorderRangeCommon(commandInfo as IReorderRangeCommand, range);\n        }\n        case EffectRefRangId.RemoveColCommandId: {\n            operator = handleIRemoveCol(commandInfo as IRemoveRowColCommand, range);\n            break;\n        }\n        case EffectRefRangId.RemoveRowCommandId: {\n            return handleRemoveRowCommon(commandInfo.params as IRemoveRowColCommandInterceptParams, range);\n        }\n    }\n    const resultRange = runRefRangeMutations(operator, range);\n    return resultRange ? [resultRange] : [];\n};\n\nexport const handleCommonRangeChangeWithEffectRefCommandsSkipNoInterests = (range: IRange, commandInfo: ICommandInfo, deps: { selectionManagerService: SheetsSelectionsService }) => {\n    const skipCommands = [DeleteRangeMoveLeftCommand.id, DeleteRangeMoveUpCommand.id, InsertRangeMoveDownCommand.id, InsertRangeMoveRightCommandId];\n    if (skipCommands.includes(commandInfo.id)) {\n        return handleCommonDefaultRangeChangeWithEffectRefCommands(range, commandInfo);\n    }\n\n    const effectRanges = getEffectedRangesOnCommand(commandInfo as EffectRefRangeParams, deps);\n    if (effectRanges.some((effectRange) => Rectangle.intersects(effectRange, range))) {\n        return handleCommonDefaultRangeChangeWithEffectRefCommands(range, commandInfo);\n    }\n\n    return range;\n};\n\n/**\n * This function should work as a pure function.\n *\n * @pure\n * @param range\n * @param mutation\n * @returns the adjusted range\n */\n\nexport function adjustRangeOnMutation(range: Readonly<IRange>, mutation: IMutationInfo<MutationsAffectRange>): Nullable<IRange> {\n    // we map mutation params to corresponding\n    const { id, params } = mutation;\n    let baseRangeOperator: {\n        length: number;\n        step: number;\n        type?: OperatorType;\n    } | null | IOperator[] = {\n        length: 0,\n        step: 0,\n        type: OperatorType.Unknown,\n    };\n    switch (id) {\n        case RemoveSheetMutation.id:\n            baseRangeOperator.type = OperatorType.Delete;\n            break;\n        case MoveRowsMutation.id:\n            baseRangeOperator = handleBaseMoveRowsCols(\n                { start: (params as IMoveRowsMutationParams).sourceRange.startRow, end: (params as IMoveRowsMutationParams).sourceRange.endRow },\n                { start: (params as IMoveRowsMutationParams).targetRange.startRow, end: (params as IMoveRowsMutationParams).targetRange.endRow },\n                { start: range.startRow, end: range.endRow }\n            );\n            baseRangeOperator.type = OperatorType.VerticalMove;\n            break;\n        case MoveColsMutation.id:\n            baseRangeOperator = handleBaseMoveRowsCols(\n                { start: (params as IMoveColumnsMutationParams).sourceRange.startColumn, end: (params as IMoveColumnsMutationParams).sourceRange.endColumn },\n                { start: (params as IMoveColumnsMutationParams).targetRange.startColumn, end: (params as IMoveColumnsMutationParams).targetRange.endColumn },\n                { start: range.startColumn, end: range.endColumn }\n            );\n            baseRangeOperator.type = OperatorType.HorizontalMove;\n            break;\n        case RemoveColMutation.id:\n            baseRangeOperator = handleBaseRemoveRange((params as IRemoveColMutationParams).range, range);\n            if (baseRangeOperator) {\n                baseRangeOperator.type = OperatorType.HorizontalMove;\n            } else {\n                baseRangeOperator = { step: 0, length: 0, type: OperatorType.Delete };\n            }\n            break;\n        case RemoveRowMutation.id:\n            baseRangeOperator = handleBaseRemoveRange(rotateRange((params as IRemoveRowsMutationParams).range), rotateRange(range));\n            if (baseRangeOperator) {\n                baseRangeOperator.type = OperatorType.VerticalMove;\n            } else {\n                baseRangeOperator = { step: 0, length: 0, type: OperatorType.Delete };\n            }\n            break;\n        case InsertRowMutation.id:\n            baseRangeOperator = handleBaseInsertRange(rotateRange((params as IInsertRowMutationParams).range), rotateRange(range));\n            baseRangeOperator.type = OperatorType.VerticalMove;\n            break;\n        case InsertColMutation.id:\n            baseRangeOperator = handleBaseInsertRange((params as IInsertColMutationParams).range, range);\n            baseRangeOperator.type = OperatorType.HorizontalMove;\n            break;\n        case MoveRangeMutation.id:\n            {\n                const fromRange = (params as IMoveRangeMutationParams).fromRange || new ObjectMatrix((params as IMoveRangeMutationParams).from).getRange();\n                const toRange = (params as IMoveRangeMutationParams).toRange || new ObjectMatrix((params as IMoveRangeMutationParams).to).getRange();\n                baseRangeOperator = handleBaseMoveRange(\n                    fromRange,\n                    toRange,\n                    range\n                );\n            }\n            break;\n        default:\n            break;\n    }\n    if (baseRangeOperator) {\n        return Array.isArray(baseRangeOperator) ? runRefRangeMutations(baseRangeOperator, range) : runRefRangeMutations([baseRangeOperator as IOperator], range);\n    } else {\n        return range;\n    }\n}\n\n// eslint-disable-next-line max-lines-per-function, complexity\nexport function getEffectedRangesOnCommand(command: EffectRefRangeParams, deps: { selectionManagerService: SheetsSelectionsService }) {\n    const { selectionManagerService } = deps;\n    switch (command.id) {\n        case EffectRefRangId.MoveColsCommandId: {\n            const params = command.params!;\n            return [\n                params.fromRange,\n                {\n                    ...params.toRange,\n                    startColumn: params.toRange.startColumn - 0.5,\n                    endColumn: params.toRange.endColumn - 0.5,\n                },\n            ];\n        }\n        case EffectRefRangId.MoveRowsCommandId: {\n            const params = command.params!;\n            return [\n                params.fromRange,\n                {\n                    ...params.toRange,\n                    startRow: params.toRange.startRow - 0.5,\n                    endRow: params.toRange.startRow - 0.5,\n                },\n            ];\n        }\n        case EffectRefRangId.MoveRangeCommandId: {\n            const params = command;\n            return [params.params!.fromRange, params.params!.toRange];\n        }\n        case EffectRefRangId.InsertRowCommandId: {\n            const params = command;\n            const range: IRange = params.params!.range;\n            return [\n                {\n                    ...range,\n                    startRow: range.startRow - 0.5,\n                    endRow: range.endRow - 0.5,\n                },\n            ];\n        }\n        case EffectRefRangId.InsertColCommandId: {\n            const params = command;\n            const range: IRange = params.params!.range;\n            return [\n                {\n                    ...range,\n                    startColumn: range.startColumn - 0.5,\n                    endColumn: range.endColumn - 0.5,\n                },\n            ];\n        }\n        case EffectRefRangId.RemoveRowCommandId: {\n            const params = command;\n            const range: IRange = params.params!.range;\n            return [range];\n        }\n        case EffectRefRangId.RemoveColCommandId: {\n            const params = command;\n            const range: IRange = params.params!.range;\n            return [range];\n        }\n        case EffectRefRangId.DeleteRangeMoveUpCommandId:\n        case EffectRefRangId.InsertRangeMoveDownCommandId: {\n            const params = command;\n            const range = params.params?.range || selectionManagerService.getCurrentSelections()?.map((s) => s.range)?.[0];\n            if (!range) {\n                return [];\n            }\n            return [range];\n        }\n        case EffectRefRangId.DeleteRangeMoveLeftCommandId:\n        case EffectRefRangId.InsertRangeMoveRightCommandId: {\n            const params = command;\n            const range = params.params?.range || selectionManagerService.getCurrentSelections()?.map((s) => s.range)?.[0];\n            if (!range) {\n                return [];\n            }\n            return [range];\n        }\n        case EffectRefRangId.ReorderRangeCommandId: {\n            const params = command;\n            const { range, order } = params.params!;\n            const effectRanges = [];\n            for (let row = range.startRow; row <= range.endRow; row++) {\n                if (row in order) {\n                    effectRanges.push({\n                        startRow: row,\n                        endRow: row,\n                        startColumn: range.startColumn,\n                        endColumn: range.endColumn,\n                    });\n                }\n            }\n            return effectRanges;\n        }\n    }\n}\n\nexport function getEffectedRangesOnMutation(mutation: IMutationInfo<MutationsAffectRange>) {\n    switch (mutation.id) {\n        case MoveColsMutation.id: {\n            const params = mutation.params as IMoveColumnsMutationParams;\n            return [\n                params.sourceRange,\n                {\n                    ...params.targetRange,\n                    startColumn: params.targetRange.startColumn - 0.5,\n                    endColumn: params.targetRange.startColumn - 0.5,\n                },\n            ];\n        }\n        case MoveRowsMutation.id: {\n            const params = mutation.params as IMoveRowsMutationParams;\n            return [\n                params.sourceRange,\n                {\n                    ...params.targetRange,\n                    startRow: params.targetRange.startRow - 0.5,\n                    endRow: params.targetRange.startRow - 0.5,\n                },\n            ];\n        }\n\n        case MoveRangeMutation.id: {\n            const params = mutation.params as IMoveRangeMutationParams;\n            return [new ObjectMatrix(params.from.value).getRange(), new ObjectMatrix(params.to.value).getRange()];\n        }\n        case InsertColMutation.id: {\n            const params = mutation.params as IInsertColMutationParams;\n            const range: IRange = params.range;\n            return [\n                {\n                    ...range,\n                    startColumn: range.startColumn - 0.5,\n                    endColumn: range.startColumn - 0.5,\n                },\n            ];\n        }\n        case InsertRowMutation.id: {\n            const params = mutation.params as IInsertRowMutationParams;\n            const range: IRange = params.range;\n            return [\n                {\n                    ...range,\n                    startRow: range.startRow - 0.5,\n                    endRow: range.startRow - 0.5,\n                },\n            ];\n        }\n        case RemoveColMutation.id: {\n            const params = mutation.params as IRemoveColMutationParams;\n            const range: IRange = params.range;\n            return [range];\n        }\n        case RemoveRowMutation.id: {\n            const params = mutation.params as IRemoveRowsMutationParams;\n            const range: IRange = params.range;\n            return [range];\n        }\n        default:\n            break;\n    }\n}\n\n// eslint-disable-next-line max-lines-per-function, complexity\nexport function getSeparateEffectedRangesOnCommand(accessor: IAccessor, command: EffectRefRangeParams): {\n    unitId: string;\n    subUnitId: string;\n    ranges: IRange[];\n} {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n\n    switch (command.id) {\n        case EffectRefRangId.MoveColsCommandId: {\n            const params = command.params!;\n            const target = getSheetCommandTarget(univerInstanceService, {\n                unitId: params.unitId,\n                subUnitId: params.subUnitId,\n            })!;\n\n            return {\n                unitId: target.unitId,\n                subUnitId: target.subUnitId,\n                ranges: [\n                    params.fromRange,\n\n                    {\n                        ...params.toRange,\n                        startColumn: params.fromRange.startColumn < params.toRange.startColumn ? params.fromRange.endColumn + 1 : params.toRange.startColumn,\n                        endColumn: params.fromRange.startColumn < params.toRange.startColumn ? params.toRange.endColumn - 1 : params.fromRange.startColumn - 1,\n                    },\n                ],\n            };\n        }\n        case EffectRefRangId.MoveRowsCommandId: {\n            const params = command.params!;\n            const target = getSheetCommandTarget(univerInstanceService, {\n                unitId: params.unitId,\n                subUnitId: params.subUnitId,\n            })!;\n            return {\n                unitId: target.unitId,\n                subUnitId: target.subUnitId,\n                ranges: [\n                    params.fromRange,\n                    {\n                        ...params.toRange,\n                        startRow: params.fromRange.startRow < params.toRange.startRow ? params.fromRange.endRow + 1 : params.toRange.startRow,\n                        endRow: params.fromRange.startRow < params.toRange.startRow ? params.toRange.endRow - 1 : params.fromRange.startRow - 1,\n                    },\n                ],\n            };\n        }\n        case EffectRefRangId.MoveRangeCommandId: {\n            const params = command.params!;\n            const target = getSheetCommandTarget(univerInstanceService)!;\n\n            return {\n                unitId: target.unitId,\n                subUnitId: target.subUnitId,\n                ranges: [params.fromRange, params.toRange],\n            };\n        }\n        case EffectRefRangId.InsertRowCommandId: {\n            const params = command.params!;\n            const range: IRange = params.range;\n            return {\n                unitId: params.unitId,\n                subUnitId: params.subUnitId,\n                ranges: [\n                    ...range.startRow > 0\n                        ? [{\n                            ...range,\n                            startRow: range.startRow - 1,\n                            endRow: range.endRow - 1,\n                        }]\n                        : [],\n                    {\n                        ...range,\n                        startRow: range.startRow,\n                        endRow: Number.MAX_SAFE_INTEGER,\n                    },\n                ],\n            };\n        }\n        case EffectRefRangId.InsertColCommandId: {\n            const params = command.params!;\n            const range: IRange = params.range;\n            return {\n                unitId: params.unitId,\n                subUnitId: params.subUnitId,\n                ranges: [\n                    ...range.startColumn > 0\n                        ? [{\n                            ...range,\n                            startColumn: range.startColumn - 1,\n                            endColumn: range.endColumn - 1,\n                        }]\n                        : [],\n                    {\n                        ...range,\n                        startColumn: range.startColumn,\n                        endColumn: Number.MAX_SAFE_INTEGER,\n                    },\n                ],\n            };\n        }\n        case EffectRefRangId.RemoveRowCommandId: {\n            const params = command.params!;\n            const range: IRange = params.range;\n            const target = getSheetCommandTarget(univerInstanceService)!;\n            return {\n                unitId: target.unitId,\n                subUnitId: target.subUnitId,\n                ranges: [\n                    range,\n                    {\n                        ...range,\n                        startRow: range.endRow + 1,\n                        endRow: Number.MAX_SAFE_INTEGER,\n                    },\n                ],\n            };\n        }\n        case EffectRefRangId.RemoveColCommandId: {\n            const params = command.params!;\n            const range: IRange = params.range;\n            const target = getSheetCommandTarget(univerInstanceService)!;\n\n            return {\n                unitId: target.unitId,\n                subUnitId: target.subUnitId,\n                ranges: [\n                    range,\n                    {\n                        ...range,\n                        startColumn: range.endColumn + 1,\n                        endColumn: Number.MAX_SAFE_INTEGER,\n                    },\n                ],\n            };\n        }\n        case EffectRefRangId.DeleteRangeMoveUpCommandId:\n        case EffectRefRangId.InsertRangeMoveDownCommandId: {\n            const params = command;\n            const target = getSheetCommandTarget(univerInstanceService)!;\n            const range = params.params?.range || selectionManagerService.getCurrentSelections()?.map((s) => s.range)?.[0];\n            if (!range) {\n                return {\n                    unitId: target.unitId,\n                    subUnitId: target.subUnitId,\n                    ranges: [],\n                };\n            }\n\n            return {\n                unitId: target.unitId,\n                subUnitId: target.subUnitId,\n                ranges: [\n                    range,\n                    {\n                        ...range,\n                        startRow: range.endRow + 1,\n                        endRow: Number.MAX_SAFE_INTEGER,\n                    },\n                ],\n            };\n        }\n        case EffectRefRangId.DeleteRangeMoveLeftCommandId:\n        case EffectRefRangId.InsertRangeMoveRightCommandId: {\n            const params = command;\n            const range = params.params?.range || selectionManagerService.getCurrentSelections()?.map((s) => s.range)?.[0];\n            const target = getSheetCommandTarget(univerInstanceService)!;\n            if (!range) {\n                return {\n                    unitId: target.unitId,\n                    subUnitId: target.subUnitId,\n                    ranges: [],\n                };\n            }\n            return {\n                unitId: target.unitId,\n                subUnitId: target.subUnitId,\n                ranges: [\n                    range,\n                    {\n                        ...range,\n                        startColumn: range.endColumn + 1,\n                        endColumn: Number.MAX_SAFE_INTEGER,\n                    },\n                ],\n            };\n        }\n        case EffectRefRangId.ReorderRangeCommandId: {\n            const params = command;\n            const { range, order } = params.params!;\n            const effectRanges = [];\n            for (let row = range.startRow; row <= range.endRow; row++) {\n                if (row in order) {\n                    effectRanges.push({\n                        startRow: row,\n                        endRow: row,\n                        startColumn: range.startColumn,\n                        endColumn: range.endColumn,\n                    });\n                }\n            }\n            const target = getSheetCommandTarget(univerInstanceService)!;\n            return {\n                unitId: target.unitId,\n                subUnitId: target.subUnitId,\n                ranges: effectRanges,\n            };\n        }\n    }\n}\n"],"mappings":"AAsCA,SAAS,wBAAwB,cAAc,mBAAmB,OAAO,YAAY,iBAAiB;AACtG,SAAS,kCAAkC;AAC3C,SAAS,gCAAgC;AACzC,SAAS,kCAAkC;AAC3C,SAAS,qCAAqC;AAC9C,SAAS,6BAA6B;AACtC,SAAS,mBAAmB,yBAAyB;AACrD,SAAS,yBAAyB;AAClC,SAAS,kBAAkB,wBAAwB;AACnD,SAAS,mBAAmB,yBAAyB;AACrD,SAAS,2BAA2B;AACpC,SAAS,+BAA+B;AACxC,SAAS,iBAAiB,oBAAoB;AAE9C,MAAM,mBAAmB,OAAO;AACzB,aAAM,uBAAuB,CAAC,UAAkB;AACnD,QAAM,SAAS,EAAE,GAAG,MAAM;AAC1B,QAAM,WAAW,OAAO,MAAM,OAAO,QAAQ,KAAK,OAAO,MAAM,OAAO,MAAM,KAAK,CAAC,OAAO,MAAM,OAAO,WAAW,KAAK,CAAC,OAAO,MAAM,OAAO,SAAS;AACpJ,QAAM,QAAQ,OAAO,MAAM,OAAO,WAAW,KAAK,OAAO,MAAM,OAAO,SAAS,KAAK,CAAC,OAAO,MAAM,OAAO,QAAQ,KAAK,CAAC,OAAO,MAAM,OAAO,MAAM;AACjJ,MAAI,OAAO,cAAc,WAAW,UAAU,UAAU;AACpD,WAAO,WAAW;AAClB,WAAO,SAAS;AAAA,EACpB;AACA,MAAI,OAAO,cAAc,WAAW,OAAO,OAAO;AAC9C,WAAO,cAAc;AACrB,WAAO,YAAY;AAAA,EACvB;AACA,MAAI,OAAO,cAAc,WAAW,KAAK;AACrC,WAAO,cAAc;AACrB,WAAO,YAAY;AACnB,WAAO,WAAW;AAClB,WAAO,SAAS;AAAA,EACpB;AACA,SAAO;AACX;AACO,aAAM,wBAAwB,CAAC,OAAe,QAAgB,WAAmB;AACpF,QAAM,SAAS,EAAE,GAAG,MAAM;AAC1B,MAAI,OAAO,cAAc,WAAW,QAAQ;AACxC,WAAO,WAAW;AAClB,WAAO,SAAS;AAAA,EACpB,WAAW,OAAO,cAAc,WAAW,KAAK;AAC5C,WAAO,cAAc;AACrB,WAAO,YAAY;AAAA,EACvB,WAAW,OAAO,cAAc,WAAW,KAAK;AAC5C,WAAO,cAAc;AACrB,WAAO,WAAW;AAClB,WAAO,YAAY;AACnB,WAAO,SAAS;AAAA,EACpB,OAAO;AACH,WAAO,WAAW,KAAK,IAAI,GAAG,OAAO,QAAQ;AAC7C,WAAO,SAAS,KAAK,IAAI,QAAQ,OAAO,MAAM;AAC9C,WAAO,cAAc,KAAK,IAAI,GAAG,OAAO,WAAW;AACnD,WAAO,YAAY,KAAK,IAAI,QAAQ,OAAO,SAAS;AAAA,EACxD;AAEA,SAAO;AACX;AACO,aAAM,cAAc,CAAC,UAA0B;AAGlD,MAAI,YAAY,MAAM;AACtB,MAAI,MAAM,cAAc,WAAW,QAAQ;AACvC,gBAAY,WAAW;AAAA,EAC3B,WAAW,MAAM,cAAc,WAAW,KAAK;AAC3C,gBAAY,WAAW;AAAA,EAC3B;AACA,SAAO;AAAA,IACH,UAAU,MAAM;AAAA,IAChB,QAAQ,MAAM;AAAA,IACd,aAAa,MAAM;AAAA,IACnB,WAAW,MAAM;AAAA,IACjB;AAAA,EACJ;AACJ;AASO,aAAM,yBAAyB,CAClC,WACA,SACA,gBACmC;AACnC,QAAM,eAAe,EAAE,GAAG,YAAY;AACtC,QAAM,WAAW,EAAE,GAAG,QAAQ;AAC9B,QAAM,gBAAgB,CAAC,OAAc,UAAkC;AACnE,UAAM,QAAQ,KAAK,IAAI,MAAM,OAAO,MAAM,KAAK;AAC/C,UAAM,MAAM,KAAK,IAAI,MAAM,KAAK,MAAM,GAAG;AACzC,QAAI,MAAM,OAAO;AACb,aAAO;AAAA,IACX;AACA,WAAO,EAAE,OAAO,IAAI;AAAA,EACxB;AACA,QAAM,YAAY,CAAC,SAAgB,KAAK,MAAM,KAAK,QAAQ;AAC3D,QAAM,cAAc,CAAC,MAAa,YAAmB;AAAA,IACjD,OAAO,KAAK,QAAQ,OAAO;AAAA,IAC3B,KAAK,KAAK,QAAQ,OAAO,QAAQ,KAAK,MAAM,KAAK;AAAA,EACrD;AACA,QAAM,cAAc,CAAC,MAAa,YAA0B;AAAA,IACxD,OAAO,OAAO,QAAQ,KAAK;AAAA,IAC3B,KAAK,OAAO,QAAQ,KAAK,QAAQ,KAAK,MAAM,KAAK;AAAA,EACrD;AACA,QAAM,gBAAgB,QAAQ,QAAQ,UAAU;AAChD,MAAI,eAAe;AACf,UAAM,OAAO,KAAK,IAAI,UAAU,KAAK,QAAQ,KAAK,IAAI,UAAU,QAAQ;AACxE,aAAS,SAAS;AAClB,aAAS,OAAO;AAAA,EACpB;AACA,QAAM,gBAAgB,UAAU,SAAS;AACzC,QAAM,cAAc;AACpB,QAAM,iCAAiC,cAAc,WAAW,YAAY;AAC5E,QAAM,gCACF,kCAAkC,UAAU,8BAA8B,KAAK,UAAU,YAAY;AACzG,MAAI,UAAU,MAAM,aAAa,OAAO;AACpC,iBAAa,SAAS;AACtB,iBAAa,OAAO;AAAA,EACxB,WAAW,gCAAgC;AAIvC,UAAM,qCAAqC,UAAU,8BAA8B;AACnF,QAAI,+BAA+B;AAI/B,YAAM,WAAW,YAAY,cAAc,SAAS;AACpD,YAAM,UAAU,YAAY,UAAU,QAAQ;AAC9C,mBAAa,QAAQ,QAAQ;AAC7B,mBAAa,MAAM,QAAQ;AAAA,IAC/B,WAAW,+BAA+B,QAAQ,UAAU,OAAO;AAI/D,UAAI,eAAe;AACf,qBAAa,OAAO,qCAAqC;AACzD,qBAAa,SAAS;AAAA,MAC1B,OAAO;AACH,qBAAa,OAAO;AAAA,MACxB;AAAA,IACJ,OAAO;AACH,UAAI,eAAe;AAGf,qBAAa,OAAO;AAAA,MACxB,OAAO;AACH,YAAI,aAAa,QAAQ,UAAU,SAAS,aAAa,MAAM,UAAU,KAAK;AAE1E,uBAAa,SAAS;AACtB,uBAAa,OAAO,gBAAgB;AAAA,QACxC,OAAO;AAEH,uBAAa,OAAO;AAAA,QACxB;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ;AAEA,QAAM,+BAA+B,cAAc,UAAU,YAAY;AACzE,MAAI,CAAC,+BAA+B;AAChC,QAAI,SAAS,SAAS,aAAa,OAAO;AACtC,mBAAa,SAAS;AACtB,mBAAa,OAAO;AAAA,IACxB,WAAW,8BAA8B;AACrC,UAAI,CAAC,eAAe;AAChB,YAAI,aAAa,QAAQ,SAAS,SAAS,aAAa,MAAM,SAAS,OAAO;AAE1E,uBAAa,OAAO;AAAA,QACxB,WAAW,aAAa,SAAS,SAAS,OAAQ,aAAa,SAAS,SAAS,SAAS,aAAa,SAAS,SAAS,KAAM;AAE3H,uBAAa,OAAO;AACpB,uBAAa,SAAS;AAAA,QAC1B;AAAA,MACJ,OAAO;AACH,YAAI,SAAS,OAAO,aAAa,SAAU,SAAS,SAAS,aAAa,SAAS,SAAS,OAAO,aAAa,OAAQ;AAEpH,uBAAa,SAAS;AACtB,uBAAa,OAAO;AAAA,QACxB,WAAW,SAAS,SAAS,aAAa,SAAS,SAAS,SAAS,aAAa,KAAK;AAEnF,uBAAa,OAAO;AAAA,QACxB;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ;AAEA,SAAO;AAAA,IACH,MAAM,aAAa,QAAQ,YAAY;AAAA,IACvC,QAAQ,UAAU,YAAY,IAAI,UAAU,WAAW;AAAA,EAC3D;AACJ;AAEO,aAAM,iBAAiB,CAAC,QAA0B,gBAAqC;AAC1F,QAAM,EAAE,WAAW,QAAQ,IAAI,OAAO,UAAU,CAAC;AACjD,MAAI,CAAC,WAAW,CAAC,WAAW;AACxB,WAAO,CAAC;AAAA,EACZ;AACA,QAAM,aAAa,qBAAqB,SAAS;AACjD,QAAM,WAAW,qBAAqB,OAAO;AAC7C,QAAM,eAAe,qBAAqB,WAAW;AACrD,QAAM,SAAS;AAAA,IACX,EAAE,OAAO,WAAW,UAAU,KAAK,WAAW,OAAO;AAAA,IACrD,EAAE,OAAO,SAAS,UAAU,KAAK,SAAS,OAAO;AAAA,IACjD,EAAE,OAAO,aAAa,UAAU,KAAK,aAAa,OAAO;AAAA,EAC7D;AACA,MAAI,WAAW,MAAM;AACjB,WAAO;AAAA,MACH;AAAA,QACI,MAAM,aAAa;AAAA,MACvB;AAAA,IACJ;AAAA,EACJ;AACA,SAAO;AAAA,IACH;AAAA,MACI,MAAM,aAAa;AAAA,MACnB,MAAM,OAAO,QAAQ;AAAA,MACrB,QAAQ,OAAO,UAAU;AAAA,IAC7B;AAAA,EACJ;AACJ;AAEO,aAAM,uBAAuB,CAAC,QAA0B,gBAAwB;AACnF,QAAM,EAAE,WAAW,QAAQ,IAAI,OAAO,UAAU,CAAC;AACjD,MAAI,CAAC,aAAa,CAAC,SAAS;AACxB,WAAO,CAAC,WAAW;AAAA,EACvB;AAEA,QAAM,UAAU,UAAU;AAC1B,QAAM,QAAQ,UAAU,SAAS,UAAU,WAAW;AACtD,QAAM,QAAQ,QAAQ;AAEtB,QAAM,SAAS,IAAI,aAAa;AAEhC,QAAM,QAAQ,aAAa,CAAC,KAAK,QAAQ;AACrC,WAAO,SAAS,KAAK,KAAK,CAAC;AAAA,EAC/B,CAAC;AAED,SAAO,SAAS,SAAS,OAAO,KAAK;AAGrC,QAAM,MAAM,kBAAkB,QAAQ,CAAC,UAAU,UAAU,CAAC;AAC5D,SAAO;AACX;AAEO,aAAM,2BAA2B,CAAC,OAA6B,gBAAwB;AAC1F,QAAM,EAAE,OAAO,MAAM,IAAI,MAAM,UAAU,CAAC;AAC1C,MAAI,CAAC,SAAS,CAAC,OAAO;AAClB,WAAO,CAAC,WAAW;AAAA,EACvB;AACA,QAAM,SAAS,IAAI,aAAa;AAChC,QAAM,QAAQ,aAAa,CAAC,KAAK,QAAQ;AACrC,WAAO,SAAS,KAAK,KAAK,CAAC;AAAA,EAC/B,CAAC;AAED,QAAM,cAAc,IAAI,aAAa;AACrC,QAAM,QAAQ,OAAO,CAAC,KAAK,QAAQ;AAC/B,QAAI,OAAO,UAAU,eAAe,KAAK,OAAO,GAAG,GAAG;AAClD,YAAM,YAAY,MAAM,GAAG;AAC3B,YAAM,YAAY,OAAO,SAAS,WAAW,GAAG,KAAK;AACrD,kBAAY,SAAS,KAAK,KAAK,SAAS;AAAA,IAC5C;AAAA,EACJ,CAAC;AAED,cAAY,SAAS,CAAC,KAAK,KAAK,aAAa;AACzC,WAAO,SAAS,KAAK,KAAK,QAAQ;AAAA,EACtC,CAAC;AAED,QAAM,MAAM,kBAAkB,QAAQ,CAAC,UAAU,UAAU,CAAC;AAC5D,SAAO;AACX;AAEO,aAAM,iBAAiB,CAAC,QAA0B,gBAAqC;AAC1F,QAAM,EAAE,WAAW,QAAQ,IAAI,OAAO,UAAU,CAAC;AACjD,MAAI,CAAC,WAAW,CAAC,WAAW;AACxB,WAAO,CAAC;AAAA,EACZ;AACA,QAAM,aAAa,qBAAqB,SAAS;AACjD,QAAM,WAAW,qBAAqB,OAAO;AAC7C,QAAM,eAAe,qBAAqB,WAAW;AACrD,QAAM,SAAS;AAAA,IACX,EAAE,OAAO,WAAW,aAAa,KAAK,WAAW,UAAU;AAAA,IAC3D,EAAE,OAAO,SAAS,aAAa,KAAK,SAAS,UAAU;AAAA,IACvD,EAAE,OAAO,aAAa,aAAa,KAAK,aAAa,UAAU;AAAA,EACnE;AACA,MAAI,WAAW,MAAM;AACjB,WAAO;AAAA,MACH;AAAA,QACI,MAAM,aAAa;AAAA,MACvB;AAAA,IACJ;AAAA,EACJ;AACA,SAAO;AAAA,IACH;AAAA,MACI,MAAM,aAAa;AAAA,MACnB,MAAM,OAAO,QAAQ;AAAA,MACrB,QAAQ,OAAO,UAAU;AAAA,IAC7B;AAAA,EACJ;AACJ;AAEO,aAAM,uBAAuB,CAAC,QAA0B,gBAAwB;AACnF,QAAM,EAAE,WAAW,QAAQ,IAAI,OAAO,UAAU,CAAC;AACjD,MAAI,CAAC,aAAa,CAAC,SAAS;AACxB,WAAO,CAAC,WAAW;AAAA,EACvB;AAEA,QAAM,UAAU,UAAU;AAC1B,QAAM,QAAQ,UAAU,YAAY,UAAU,cAAc;AAC5D,QAAM,QAAQ,QAAQ;AAEtB,QAAM,SAAS,IAAI,aAAa;AAEhC,QAAM,QAAQ,aAAa,CAAC,KAAK,QAAQ;AACrC,WAAO,SAAS,KAAK,KAAK,CAAC;AAAA,EAC/B,CAAC;AAED,SAAO,YAAY,SAAS,OAAO,KAAK;AAExC,SAAO,kBAAkB,QAAQ,CAAC,UAAU,UAAU,CAAC;AAC3D;AAEO,aAAM,kBAAkB,CAAC,OAA0B,gBAAwB;AAC9E,QAAM,UAAU,MAAM,QAAQ;AAC9B,QAAM,YAAY,MAAM,QAAQ;AAChC,MAAI,CAAC,WAAW,CAAC,WAAW;AACxB,WAAO,CAAC;AAAA,EACZ;AACA,QAAM,YAAyB,CAAC;AAEhC,MAAI,UAAU,SAAS,SAAS,WAAW,GAAG;AAC1C,cAAU,KAAK;AAAA,MACX,MAAM,aAAa;AAAA,IACvB,CAAC;AAAA,EACL;AAEA,MAAI,UAAU,SAAS,WAAW,WAAW,GAAG;AAC5C,cAAU,KAAK;AAAA,MACX,MAAM,aAAa;AAAA,IACvB,CAAC;AACD,UAAM,gBAAgB,UAAU,iBAAiB,aAAa,SAAS;AACvE,UAAM,gBAAgB,UAAU,iBAAiB,eAAe,OAAO;AACvE,WAAO;AAAA,MACH;AAAA,QACI,MAAM,aAAa;AAAA,QACnB,OAAO;AAAA,MACX;AAAA,IACJ;AAAA,EACJ;AACA,SAAO;AACX;AAEO,aAAM,wBAAwB,CAAC,OAA0B,gBAAwB;AACpF,QAAM,UAAU,MAAM,QAAQ;AAC9B,QAAM,YAAY,MAAM,QAAQ;AAEhC,MAAI,CAAC,WAAW,CAAC,WAAW;AACxB,WAAO,CAAC,WAAW;AAAA,EACvB;AAEA,MAAI,CAAC,UAAU,WAAW,WAAW,WAAW,KAAK,CAAC,UAAU,WAAW,SAAS,WAAW,GAAG;AAC9F,WAAO,CAAC,WAAW;AAAA,EACvB;AAEA,MAAI,UAAU,SAAS,WAAW,WAAW,GAAG;AAC5C,UAAM,gBAAgB,UAAU,iBAAiB,aAAa,SAAS;AACvE,UAAM,gBAAgB,UAAU,iBAAiB,eAAe,OAAO;AACvE,WAAO,CAAC,aAAa;AAAA,EACzB;AAEA,QAAM,SAAS,IAAI,aAAa;AAEhC,QAAM,QAAQ,aAAa,CAAC,KAAK,QAAQ;AACrC,WAAO,SAAS,KAAK,KAAK,CAAC;AAAA,EAC/B,CAAC;AAED,QAAM,aAAa,IAAI,aAAa;AACpC,QAAM,gBAAgB,UAAU,cAAc,WAAW,WAAW;AAEpE,mBAAiB,MAAM,QAAQ,eAAe,CAAC,KAAK,QAAQ;AACxD,QAAI,OAAO,SAAS,KAAK,GAAG,GAAG;AAC3B,aAAO,SAAS,KAAK,KAAK,MAAS;AACnC,iBAAW,SAAS,KAAK,KAAK,CAAC;AAAA,IACnC;AAAA,EACJ,CAAC;AAED,QAAM,eAAe,QAAQ,cAAc,UAAU;AACrD,QAAM,YAAY,QAAQ,WAAW,UAAU;AAE/C,QAAM,cAAc;AAAA,IAChB,aAAa,QAAQ,cAAc;AAAA,IACnC,WAAW,QAAQ,YAAY;AAAA,IAC/B,UAAU,QAAQ,WAAW;AAAA,IAC7B,QAAQ,QAAQ,SAAS;AAAA,EAC7B;AAEA,iBAAe,MAAM,QAAQ,aAAa,CAAC,KAAK,QAAQ;AACpD,UAAM,YAAY,MAAM;AACxB,UAAM,YAAY,MAAM;AACxB,WAAO,SAAS,WAAW,WAAW,WAAW,SAAS,KAAK,GAAG,KAAK,CAAC;AAAA,EAC5E,CAAC;AAGD,QAAM,MAAM,kBAAkB,QAAQ,CAAC,UAAU,UAAU,CAAC;AAC5D,SAAO;AACX;AAGO,aAAM,wBAAwB,CAAC,cAAsB,iBAAyB;AACjF,QAAM,cAAc,qBAAqB,YAAY;AACrD,QAAM,cAAc,qBAAqB,YAAY;AACrD,QAAM,YAAY,CAAC,UAA0B,MAAM,YAAY,MAAM,cAAc;AACnF,QAAM,eAAe,CAAC,UAA0B,MAAM,SAAS,MAAM,WAAW;AAChF,MAAI,YAAY,YAAY,YAAY,YAAY,YAAY,UAAU,YAAY,QAAQ;AAC1F;AAAA;AAAA,MAEK,YAAY,cAAc,YAAY,eACnC,YAAY,aAAa,YAAY,eACrC,YAAY,aAAa,YAAY;AAAA,MAExC,YAAY,cAAc,YAAY,eAAe,YAAY,aAAa,YAAY;AAAA,MAC7F;AACE,YAAM,mBAAmB,UAAU,cAAc,aAAa,WAAW;AACzE,UAAI,kBAAkB;AAClB,cAAM,SAAS,CAAC,UAAU,gBAAgB;AAC1C,eAAO,EAAE,MAAM,GAAG,OAAO;AAAA,MAC7B;AAAA,IACJ;AAEA,QACI,YAAY,eAAe,YAAY,eACvC,YAAY,aAAa,YAAY,aACrC,aAAa,WAAW,KAAK,aAAa,WAAW,GACvD;AACE,aAAO;AAAA,IACX;AAEA,QACI,YAAY,eAAe,YAAY,eACvC,YAAY,eAAe,YAAY,aACvC,YAAY,YAAY,YAAY,WACtC;AACE,YAAM,mBAAmB,UAAU,cAAc,aAAa,WAAW;AACzE,UAAI,kBAAkB;AAClB,cAAM,SAAS,CAAC,UAAU,gBAAgB;AAC1C,cAAM,OAAO,EAAE,UAAU,WAAW,IAAI,UAAU,gBAAgB;AAElE,eAAO,EAAE,MAAM,OAAO;AAAA,MAC1B;AAAA,IACJ;AAEA,QAAI,YAAY,cAAc,YAAY,WAAW;AACjD,YAAM,OAAO,CAAC,UAAU,WAAW;AACnC,aAAO,EAAE,MAAM,QAAQ,EAAE;AAAA,IAC7B;AAAA,EACJ;AACA,SAAO,EAAE,MAAM,GAAG,QAAQ,EAAE;AAChC;AACO,aAAM,mBAAmB,CAAC,OAA6B,gBAAwB;AAClF,QAAM,QAAQ,MAAM,QAAQ;AAC5B,MAAI,CAAC,OAAO;AACR,WAAO,CAAC;AAAA,EACZ;AACA,QAAM,YAAyB,CAAC;AAChC,QAAM,SAAS,sBAAsB,OAAO,WAAW;AACvD,MAAI,CAAC,QAAQ;AACT,cAAU,KAAK,EAAE,MAAM,aAAa,OAAO,CAAC;AAAA,EAChD,OAAO;AACH,UAAM,EAAE,MAAM,OAAO,IAAI;AACzB,cAAU,KAAK;AAAA,MACX,MAAM,aAAa;AAAA,MACnB;AAAA,MACA;AAAA,IACJ,CAAC;AAAA,EACL;AACA,SAAO;AACX;AAEO,aAAM,mBAAmB,CAAC,OAA6B,gBAAwB;AAClF,QAAM,QAAQ,MAAM,QAAQ;AAC5B,MAAI,CAAC,OAAO;AACR,WAAO,CAAC;AAAA,EACZ;AACA,QAAM,YAAyB,CAAC;AAChC,QAAM,SAAS,sBAAsB,YAAY,KAAK,GAAG,YAAY,WAAW,CAAC;AACjF,MAAI,CAAC,QAAQ;AACT,cAAU,KAAK,EAAE,MAAM,aAAa,OAAO,CAAC;AAAA,EAChD,OAAO;AACH,UAAM,EAAE,MAAM,OAAO,IAAI;AACzB,cAAU,KAAK;AAAA,MACX,MAAM,aAAa;AAAA,MACnB;AAAA,MACA;AAAA,IACJ,CAAC;AAAA,EACL;AACA,SAAO;AACX;AAEO,aAAM,qBAAqB,CAAC,OAA6B,gBAAwB;AACpF,QAAM,EAAE,OAAO,MAAM,IAAI,MAAM,UAAU,CAAC;AAC1C,MAAI,CAAC,SAAS,CAAC,OAAO;AAClB,WAAO,CAAC;AAAA,EACZ;AAEA,MAAI,UAAU,SAAS,OAAO,WAAW,KAAK,YAAY,WAAW,YAAY,UAAU;AACvF,UAAM,YAAyB,CAAC;AAChC,UAAM,YAAY,YAAY;AAC9B,eAAW,KAAK,OAAO;AACnB,UAAI,MAAM,CAAC,MAAM,WAAW;AACxB,cAAM,QAAQ,OAAO,CAAC;AACtB,kBAAU,KAAK;AAAA,UACX,MAAM,aAAa;AAAA,UACnB,MAAM,QAAQ;AAAA,UACd,QAAQ;AAAA,QACZ,CAAC;AACD,eAAO;AAAA,MACX;AAAA,IACJ;AACA,WAAO,CAAC;AAAA,EACZ;AACA,SAAO,CAAC;AACZ;AAWO,aAAM,wBAAwB,CAAC,cAAsB,iBAAyB;AACjF,QAAM,cAAc,qBAAqB,YAAY;AACrD,QAAM,cAAc,qBAAqB,YAAY;AACrD,QAAM,YAAY,CAAC,UAA0B,MAAM,YAAY,MAAM,cAAc;AACnF,MAAI,EAAE,YAAY,YAAY,YAAY,YAAY,YAAY,UAAU,YAAY,SAAS;AAC7F,WAAO,EAAE,MAAM,GAAG,QAAQ,EAAE;AAAA,EAChC;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOK,YAAY,cAAc,YAAY,eACnC,YAAY,aAAa,YAAY,eACrC,YAAY,aAAa,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,IAOxC,YAAY,cAAc,YAAY,eAAe,YAAY,aAAa,YAAY;AAAA,IAG7F;AACE,UAAM,SAAS,UAAU,WAAW;AACpC,WAAO,EAAE,MAAM,GAAG,OAAO;AAAA,EAC7B;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAMK,YAAY,eAAe,YAAY,eAAe,YAAY,aAAa,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,IAM3F,YAAY,eAAe,YAAY,eACpC,YAAY,eAAe,YAAY,aACvC,YAAY,YAAY,YAAY;AAAA;AAAA;AAAA;AAAA,IAKxC,YAAY,eAAe,YAAY;AAAA,IAEzC;AACE,UAAM,OAAO,UAAU,WAAW;AAClC,WAAO,EAAE,MAAM,QAAQ,EAAE;AAAA,EAC7B;AAEA,SAAO,EAAE,MAAM,GAAG,QAAQ,EAAE;AAChC;AAEA,SAAS,oBAAoB,WAAmB,SAAiB,aAAqB;AAClF,QAAM,YAAyB,CAAC;AAEhC,MAAI,UAAU,SAAS,SAAS,WAAW,GAAG;AAC1C,cAAU,KAAK;AAAA,MACX,MAAM,aAAa;AAAA,IACvB,CAAC;AAAA,EACL;AAEA,MAAI,UAAU,SAAS,WAAW,WAAW,GAAG;AAC5C,cAAU,KAAK;AAAA,MACX,MAAM,aAAa;AAAA,IACvB,CAAC;AACD,UAAM,gBAAgB,UAAU,iBAAiB,aAAa,SAAS;AACvE,UAAM,gBAAgB,UAAU,iBAAiB,eAAe,OAAO;AACvE,WAAO;AAAA,MACH;AAAA,QACI,MAAM,aAAa;AAAA,QACnB,OAAO;AAAA,MACX;AAAA,IACJ;AAAA,EACJ;AACA,SAAO;AACX;AAAC;AAEM,aAAM,kBAAkB,CAAC,OAA0B,gBAAwB;AAC9E,QAAM,QAAQ,MAAM,QAAQ;AAC5B,MAAI,CAAC,OAAO;AACR,WAAO,CAAC;AAAA,EACZ;AACA,QAAM,YAAyB,CAAC;AAChC,QAAM,SAAS,sBAAsB,YAAY,KAAK,GAAG,YAAY,WAAW,CAAC;AACjF,QAAM,EAAE,MAAM,OAAO,IAAI;AACzB,YAAU,KAAK;AAAA,IACX,MAAM,aAAa;AAAA,IACnB;AAAA,IACA;AAAA,EACJ,CAAC;AACD,SAAO;AACX;AAEO,aAAM,kBAAkB,CAAC,OAA0B,gBAAwB;AAC9E,QAAM,QAAQ,MAAM,QAAQ;AAC5B,MAAI,CAAC,OAAO;AACR,WAAO,CAAC;AAAA,EACZ;AACA,QAAM,YAAyB,CAAC;AAChC,QAAM,SAAS,sBAAsB,OAAO,WAAW;AACvD,QAAM,EAAE,MAAM,OAAO,IAAI;AACzB,YAAU,KAAK;AAAA,IACX,MAAM,aAAa;AAAA,IACnB;AAAA,IACA;AAAA,EACJ,CAAC;AACD,SAAO;AACX;AAEO,aAAM,4BAA4B,CAAC,OAAoC,gBAAwB;AAClG,QAAM,QAAQ,MAAM,QAAQ;AAC5B,MAAI,CAAC,OAAO;AACR,WAAO,CAAC;AAAA,EACZ;AACA,QAAM,YAAyB,CAAC;AAChC,QAAM,SAAS,sBAAsB,YAAY,KAAK,GAAG,YAAY,WAAW,CAAC;AACjF,QAAM,EAAE,MAAM,OAAO,IAAI;AACzB,YAAU,KAAK;AAAA,IACX,MAAM,aAAa;AAAA,IACnB;AAAA,IACA;AAAA,EACJ,CAAC;AACD,SAAO;AACX;AAEO,aAAM,kCAAkC,CAAC,OAAoC,gBAAwB;AACxG,QAAM,QAAQ,MAAM,QAAQ;AAC5B,MAAI,CAAC,OAAO;AACR,WAAO,CAAC,WAAW;AAAA,EACvB;AAEA,QAAM,YAAY,MAAM,SAAS,MAAM,WAAW;AAClD,QAAM,cAAsB;AAAA,IACxB,GAAG;AAAA,IACH,UAAU,MAAM;AAAA,IAChB,QAAQ,OAAO;AAAA,EACnB;AAEA,QAAM,eAAe,UAAU,SAAS,aAAa,WAAW;AAChE,QAAM,kBAAkB,UAAU,cAAc,aAAa,WAAW;AAExE,MAAI,CAAC,iBAAiB;AAClB,WAAO,CAAC,WAAW;AAAA,EACvB;AAEA,QAAM,SAAS,IAAI,aAAqB;AACxC,eAAa,QAAQ,CAAC,gBAAgB;AAClC,UAAM,QAAQ,aAAa,CAAC,KAAK,QAAQ;AACrC,aAAO,SAAS,KAAK,KAAK,CAAC;AAAA,IAC/B,CAAC;AAAA,EACL,CAAC;AAED,qBAAmB,MAAM,QAAQ,iBAAiB,CAAC,KAAK,QAAQ;AAC5D,WAAO,SAAS,MAAM,WAAW,KAAK,CAAC;AAAA,EAC3C,CAAC;AAGD,SAAO,kBAAkB,QAAQ,CAAC,MAAM,MAAM,CAAC;AACnD;AAEO,aAAM,6BAA6B,CAAC,OAAqC,gBAAwB;AACpG,QAAM,QAAQ,MAAM,QAAQ;AAC5B,MAAI,CAAC,OAAO;AACR,WAAO,CAAC;AAAA,EACZ;AACA,QAAM,YAAyB,CAAC;AAChC,QAAM,SAAS,sBAAsB,OAAO,WAAW;AACvD,QAAM,EAAE,MAAM,OAAO,IAAI;AACzB,YAAU,KAAK;AAAA,IACX,MAAM,aAAa;AAAA,IACnB;AAAA,IACA;AAAA,EACJ,CAAC;AACD,SAAO;AACX;AAEO,aAAM,mCAAmC,CAAC,OAAqC,gBAAwB;AAC1G,QAAM,QAAQ,MAAM,QAAQ;AAC5B,MAAI,CAAC,OAAO;AACR,WAAO,CAAC,WAAW;AAAA,EACvB;AAEA,QAAM,YAAY,MAAM,YAAY,MAAM,cAAc;AACxD,QAAM,cAAsB;AAAA,IACxB,GAAG;AAAA,IACH,aAAa,MAAM;AAAA,IACnB,WAAW,OAAO;AAAA,EACtB;AAEA,QAAM,eAAe,UAAU,SAAS,aAAa,WAAW;AAChE,QAAM,kBAAkB,UAAU,cAAc,aAAa,WAAW;AAExE,MAAI,CAAC,iBAAiB;AAClB,WAAO,CAAC,WAAW;AAAA,EACvB;AAEA,QAAM,SAAS,IAAI,aAAqB;AACxC,eAAa,QAAQ,CAAC,gBAAgB;AAClC,UAAM,QAAQ,aAAa,CAAC,KAAK,QAAQ;AACrC,aAAO,SAAS,KAAK,KAAK,CAAC;AAAA,IAC/B,CAAC;AAAA,EACL,CAAC;AAED,qBAAmB,MAAM,QAAQ,iBAAiB,CAAC,KAAK,QAAQ;AAC5D,WAAO,SAAS,KAAK,MAAM,WAAW,CAAC;AAAA,EAC3C,CAAC;AAGD,SAAO,kBAAkB,QAAQ,CAAC,MAAM,MAAM,CAAC;AACnD;AAEO,aAAM,4BAA4B,CAAC,OAAoC,gBAAwB;AAClG,QAAM,QAAQ,MAAM,QAAQ;AAC5B,MAAI,CAAC,OAAO;AACR,WAAO,CAAC;AAAA,EACZ;AAEA,QAAM,YAAyB,CAAC;AAChC,QAAM,SAAS,sBAAsB,OAAO,WAAW;AAEvD,MAAI,CAAC,QAAQ;AACT,cAAU,KAAK,EAAE,MAAM,aAAa,OAAO,CAAC;AAAA,EAChD,OAAO;AACH,UAAM,EAAE,MAAM,OAAO,IAAI;AACzB,cAAU,KAAK;AAAA,MACX,MAAM,aAAa;AAAA,MACnB;AAAA,MACA;AAAA,IACJ,CAAC;AAAA,EACL;AAEA,SAAO;AACX;AAEO,aAAM,kCAAkC,CAAC,OAAoC,gBAAwB;AACxG,QAAM,QAAQ,MAAM,QAAQ;AAC5B,MAAI,CAAC,OAAO;AACR,WAAO,CAAC,WAAW;AAAA,EACvB;AAEA,QAAM,aAAqB;AAAA,IACvB,UAAU,MAAM;AAAA,IAChB,QAAQ,MAAM;AAAA,IACd,aAAa,MAAM;AAAA,IACnB,WAAW,OAAO;AAAA,EACtB;AAEA,QAAM,YAAY,MAAM,YAAY,MAAM,cAAc;AAExD,QAAM,oBAAoB,UAAU,cAAc,OAAO,WAAW;AAEpE,QAAM,eAAe,UAAU,SAAS,aAAa,UAAU;AAC/D,QAAM,kBAAkB,UAAU,cAAc,YAAY,WAAW;AAEvE,MAAI,CAAC,qBAAqB,CAAC,iBAAiB;AACxC,WAAO,CAAC,WAAW;AAAA,EACvB;AAEA,QAAM,SAAS,IAAI,aAAqB;AAExC,qBAAmB,MAAM,QAAQ,iBAAiB,CAAC,KAAK,QAAQ;AAC5D,WAAO,SAAS,KAAK,MAAM,WAAW,CAAC;AAAA,EAC3C,CAAC;AAED,uBAAqB,MAAM,QAAQ,mBAAmB,CAAC,KAAK,QAAQ;AAChE,WAAO,SAAS,KAAK,MAAM,WAAW,CAAC;AAAA,EAC3C,CAAC;AAED,eAAa,QAAQ,CAAC,gBAAgB;AAClC,UAAM,QAAQ,aAAa,CAAC,KAAK,QAAQ;AACrC,aAAO,SAAS,KAAK,KAAK,CAAC;AAAA,IAC/B,CAAC;AAAA,EACL,CAAC;AAGD,SAAO,kBAAkB,QAAQ,CAAC,MAAM,MAAM,CAAC;AACnD;AAEO,aAAM,0BAA0B,CAAC,OAAkC,gBAAwB;AAC9F,QAAM,QAAQ,MAAM,QAAQ;AAC5B,MAAI,CAAC,OAAO;AACR,WAAO,CAAC;AAAA,EACZ;AACA,QAAM,YAAyB,CAAC;AAChC,QAAM,SAAS,sBAAsB,YAAY,KAAK,GAAG,YAAY,WAAW,CAAC;AACjF,MAAI,CAAC,QAAQ;AACT,cAAU,KAAK,EAAE,MAAM,aAAa,OAAO,CAAC;AAAA,EAChD,OAAO;AACH,UAAM,EAAE,MAAM,OAAO,IAAI;AACzB,cAAU,KAAK;AAAA,MACX,MAAM,aAAa;AAAA,MACnB;AAAA,MACA;AAAA,IACJ,CAAC;AAAA,EACL;AACA,SAAO;AACX;AAEO,aAAM,gCAAgC,CAAC,OAAkC,gBAAwB;AACpG,QAAM,QAAQ,MAAM,QAAQ;AAC5B,MAAI,CAAC,OAAO;AACR,WAAO,CAAC,WAAW;AAAA,EACvB;AAEA,QAAM,cAAsB;AAAA,IACxB,GAAG;AAAA,IACH,UAAU,MAAM;AAAA,IAChB,QAAQ,OAAO;AAAA,EACnB;AAEA,QAAM,YAAY,MAAM,SAAS,MAAM,WAAW;AAElD,QAAM,oBAAoB,UAAU,cAAc,OAAO,WAAW;AAEpE,QAAM,eAAe,UAAU,SAAS,aAAa,WAAW;AAChE,QAAM,kBAAkB,UAAU,cAAc,aAAa,WAAW;AAExE,MAAI,CAAC,qBAAqB,CAAC,iBAAiB;AACxC,WAAO,CAAC,WAAW;AAAA,EACvB;AAEA,QAAM,SAAS,IAAI,aAAqB;AAExC,qBAAmB,MAAM,QAAQ,iBAAiB,CAAC,KAAK,QAAQ;AAC5D,WAAO,SAAS,MAAM,WAAW,KAAK,CAAC;AAAA,EAC3C,CAAC;AAED,uBAAqB,MAAM,QAAQ,mBAAmB,CAAC,KAAK,QAAQ;AAChE,WAAO,SAAS,MAAM,WAAW,KAAK,CAAC;AAAA,EAC3C,CAAC;AAED,eAAa,QAAQ,CAAC,gBAAgB;AAClC,UAAM,QAAQ,aAAa,CAAC,KAAK,QAAQ;AACrC,aAAO,SAAS,KAAK,KAAK,CAAC;AAAA,IAC/B,CAAC;AAAA,EACL,CAAC;AAGD,SAAO,kBAAkB,QAAQ,CAAC,MAAM,MAAM,CAAC;AACnD;AAEO,aAAM,wBAAwB,CAAC,OAA4C,gBAAwB;AACtG,QAAM,SAAS,MAAM,UAAU,CAAC,MAAM,KAAK;AAC3C,QAAM,SAAS,IAAI,aAAa;AAEhC,QAAM,QAAQ,aAAa,CAAC,KAAK,QAAQ;AACrC,WAAO,SAAS,KAAK,KAAK,CAAC;AAAA,EAC/B,CAAC;AAED,SAAO,QAAQ,CAAC,UAAU;AACtB,UAAM,WAAW,MAAM;AACvB,UAAM,SAAS,MAAM;AACrB,UAAM,QAAQ,SAAS,WAAW;AAClC,WAAO,WAAW,UAAU,KAAK;AAAA,EACrC,CAAC;AAGD,SAAO,kBAAkB,QAAQ,CAAC,UAAU,UAAU,CAAC;AAC3D;AAEO,aAAM,wBAAwB,CAAC,MAA6C,gBAAwB;AACvG,QAAM,QAAQ,KAAK;AACnB,QAAM,YAAY,MAAM,MAAM;AAC9B,QAAM,cAAc,MAAM,MAAM,SAAS,MAAM,MAAM,WAAW;AAEhE,MAAI,YAAY,YAAY,WAAW;AACnC,WAAO,CAAC;AAAA,MACJ,UAAU,YAAY,WAAW;AAAA,MACjC,QAAQ,YAAY,SAAS;AAAA,MAC7B,aAAa,YAAY;AAAA,MACzB,WAAW,YAAY;AAAA,IAC3B,CAAC;AAAA,EACL,WAAW,YAAY,SAAS,WAAW;AACvC,WAAO,CAAC,WAAW;AAAA,EACvB,OAAO;AACH,WAAO,CAAC;AAAA,MACJ,UAAU,YAAY;AAAA,MACtB,QAAQ,YAAY,SAAS;AAAA,MAC7B,aAAa,YAAY;AAAA,MACzB,WAAW,YAAY;AAAA,IAC3B,CAAC;AAAA,EACL;AACJ;AAEO,aAAM,wBAAwB,CAAC,MAA6C,gBAAwB;AACvG,QAAM,QAAQ,KAAK;AACnB,QAAM,eAAe,MAAM,MAAM;AACjC,QAAM,cAAc,MAAM,MAAM,YAAY,MAAM,MAAM,cAAc;AAEtE,MAAI,YAAY,eAAe,cAAc;AACzC,WAAO,CAAC;AAAA,MACJ,UAAU,YAAY;AAAA,MACtB,QAAQ,YAAY;AAAA,MACpB,aAAa,YAAY,cAAc;AAAA,MACvC,WAAW,YAAY,YAAY;AAAA,IACvC,CAAC;AAAA,EACL,WAAW,YAAY,YAAY,cAAc;AAC7C,WAAO,CAAC,WAAW;AAAA,EACvB,OAAO;AACH,WAAO,CAAC;AAAA,MACJ,UAAU,YAAY;AAAA,MACtB,QAAQ,YAAY;AAAA,MACpB,aAAa,YAAY;AAAA,MACzB,WAAW,YAAY,YAAY;AAAA,IACvC,CAAC;AAAA,EACL;AACJ;AAEO,aAAM,uBAAuB,CAAC,WAAwB,UAAkB;AAC3E,MAAI,SAA2B,EAAE,GAAG,MAAM;AAC1C,YAAU,QAAQ,CAAC,aAAa;AAC5B,YAAQ,SAAS,MAAM;AAAA,MACnB,KAAK,aAAa,QAAQ;AACtB,iBAAS;AACT;AAAA,MACJ;AAAA,MACA,KAAK,aAAa,gBAAgB;AAC9B,YAAI,CAAC,QAAQ;AACT;AAAA,QACJ;AACA,eAAO,eAAe,SAAS;AAC/B,eAAO,aAAa,SAAS,QAAQ,SAAS,UAAU;AACxD;AAAA,MACJ;AAAA,MACA,KAAK,aAAa,cAAc;AAC5B,YAAI,CAAC,QAAQ;AACT;AAAA,QACJ;AACA,eAAO,YAAY,SAAS;AAC5B,eAAO,UAAU,SAAS,QAAQ,SAAS,UAAU;AACrD;AAAA,MACJ;AAAA,MACA,KAAK,aAAa,KAAK;AACnB,iBAAS,SAAS;AAClB;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ,CAAC;AACD,MAAI,QAAQ;AACR,QAAI,OAAO,YAAY,OAAO,eAAe,OAAO,SAAS,OAAO,UAAU;AAC1E,aAAO;AAAA,IACX;AAAA,EACJ;AACA,SAAO;AACX;AAEO,aAAM,gDAAgD,CAAC,OAAe,gBAA8B;AACvG,MAAI,WAAwB,CAAC;AAC7B,UAAQ,YAAY,IAAI;AAAA,IACpB,KAAK,gBAAgB,8BAA8B;AAC/C,iBAAW,0BAA0B,aAA4C,KAAK;AACtF;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,4BAA4B;AAC7C,iBAAW,wBAAwB,aAA0C,KAAK;AAClF;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,iBAAW,gBAAgB,aAAkC,KAAK;AAClE;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,8BAA8B;AAC/C,iBAAW,0BAA0B,aAA4C,KAAK;AACtF;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,+BAA+B;AAChD,iBAAW,2BAA2B,aAA6C,KAAK;AACxF;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,iBAAW,gBAAgB,aAAkC,KAAK;AAClE;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,mBAAmB;AACpC,iBAAW,eAAe,aAAiC,KAAK;AAChE;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,iBAAW,gBAAgB,aAAkC,KAAK;AAClE;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,mBAAmB;AACpC,iBAAW,eAAe,aAAiC,KAAK;AAChE;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,iBAAW,iBAAiB,aAAqC,KAAK;AACtE;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,iBAAW,iBAAiB,aAAqC,KAAK;AACtE;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,uBAAuB;AACxC,iBAAW,mBAAmB,aAAqC,KAAK;AACxE;AAAA,IACJ;AAAA,EACJ;AAEA,QAAM,cAAc,qBAAqB,UAAU,KAAK;AACxD,SAAO;AACX;AAEO,aAAM,+DAA+D,CAAC,OAAe,aAA2B,SAA+D;AAClL,QAAM,eAAe,CAAC,2BAA2B,IAAI,yBAAyB,EAAE;AAChF,MAAI,aAAa,SAAS,YAAY,EAAE,GAAG;AACvC,WAAO,8CAA8C,OAAO,WAAW;AAAA,EAC3E;AAEA,QAAM,eAAe,2BAA2B,aAAqC,IAAI;AACzF,MAAI,aAAa,KAAK,CAAC,gBAAgB,UAAU,WAAW,aAAa,KAAK,CAAC,GAAG;AAC9E,WAAO,8CAA8C,OAAO,WAAW;AAAA,EAC3E;AAEA,SAAO;AACX;AAaO,aAAM,sDAAsD,CAAC,OAAe,gBAAwC;AACvH,MAAI,WAAwB,CAAC;AAC7B,UAAQ,YAAY,IAAI;AAAA,IACpB,KAAK,gBAAgB,8BAA8B;AAC/C,aAAO,gCAAgC,aAA4C,KAAK;AAAA,IAC5F;AAAA,IACA,KAAK,gBAAgB,4BAA4B;AAC7C,aAAO,8BAA8B,aAA0C,KAAK;AAAA,IACxF;AAAA,IACA,KAAK,gBAAgB,8BAA8B;AAC/C,aAAO,gCAAgC,aAA4C,KAAK;AAAA,IAC5F;AAAA,IACA,KAAK,gBAAgB,+BAA+B;AAChD,aAAO,iCAAiC,aAA6C,KAAK;AAAA,IAC9F;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,aAAO,sBAAsB,aAAkC,KAAK;AAAA,IACxE;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,aAAO,sBAAsB,aAAkC,KAAK;AAAA,IACxE;AAAA,IACA,KAAK,gBAAgB,mBAAmB;AACpC,aAAO,qBAAqB,aAAiC,KAAK;AAAA,IACtE;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,aAAO,sBAAsB,aAAkC,KAAK;AAAA,IACxE;AAAA,IACA,KAAK,gBAAgB,mBAAmB;AACpC,aAAO,qBAAqB,aAAiC,KAAK;AAAA,IACtE;AAAA,IACA,KAAK,gBAAgB,uBAAuB;AACxC,aAAO,yBAAyB,aAAqC,KAAK;AAAA,IAC9E;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,iBAAW,iBAAiB,aAAqC,KAAK;AACtE;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,aAAO,sBAAsB,YAAY,QAA+C,KAAK;AAAA,IACjG;AAAA,EACJ;AACA,QAAM,cAAc,qBAAqB,UAAU,KAAK;AACxD,SAAO,cAAc,CAAC,WAAW,IAAI,CAAC;AAC1C;AAEO,aAAM,8DAA8D,CAAC,OAAe,aAA2B,SAA+D;AACjL,QAAM,eAAe,CAAC,2BAA2B,IAAI,yBAAyB,IAAI,2BAA2B,IAAI,6BAA6B;AAC9I,MAAI,aAAa,SAAS,YAAY,EAAE,GAAG;AACvC,WAAO,oDAAoD,OAAO,WAAW;AAAA,EACjF;AAEA,QAAM,eAAe,2BAA2B,aAAqC,IAAI;AACzF,MAAI,aAAa,KAAK,CAAC,gBAAgB,UAAU,WAAW,aAAa,KAAK,CAAC,GAAG;AAC9E,WAAO,oDAAoD,OAAO,WAAW;AAAA,EACjF;AAEA,SAAO;AACX;AAWO,gBAAS,sBAAsB,OAAyB,UAAiE;AAE5H,QAAM,EAAE,IAAI,OAAO,IAAI;AACvB,MAAI,oBAIqB;AAAA,IACrB,QAAQ;AAAA,IACR,MAAM;AAAA,IACN,MAAM,aAAa;AAAA,EACvB;AACA,UAAQ,IAAI;AAAA,IACR,KAAK,oBAAoB;AACrB,wBAAkB,OAAO,aAAa;AACtC;AAAA,IACJ,KAAK,iBAAiB;AAClB,0BAAoB;AAAA,QAChB,EAAE,OAAQ,OAAmC,YAAY,UAAU,KAAM,OAAmC,YAAY,OAAO;AAAA,QAC/H,EAAE,OAAQ,OAAmC,YAAY,UAAU,KAAM,OAAmC,YAAY,OAAO;AAAA,QAC/H,EAAE,OAAO,MAAM,UAAU,KAAK,MAAM,OAAO;AAAA,MAC/C;AACA,wBAAkB,OAAO,aAAa;AACtC;AAAA,IACJ,KAAK,iBAAiB;AAClB,0BAAoB;AAAA,QAChB,EAAE,OAAQ,OAAsC,YAAY,aAAa,KAAM,OAAsC,YAAY,UAAU;AAAA,QAC3I,EAAE,OAAQ,OAAsC,YAAY,aAAa,KAAM,OAAsC,YAAY,UAAU;AAAA,QAC3I,EAAE,OAAO,MAAM,aAAa,KAAK,MAAM,UAAU;AAAA,MACrD;AACA,wBAAkB,OAAO,aAAa;AACtC;AAAA,IACJ,KAAK,kBAAkB;AACnB,0BAAoB,sBAAuB,OAAoC,OAAO,KAAK;AAC3F,UAAI,mBAAmB;AACnB,0BAAkB,OAAO,aAAa;AAAA,MAC1C,OAAO;AACH,4BAAoB,EAAE,MAAM,GAAG,QAAQ,GAAG,MAAM,aAAa,OAAO;AAAA,MACxE;AACA;AAAA,IACJ,KAAK,kBAAkB;AACnB,0BAAoB,sBAAsB,YAAa,OAAqC,KAAK,GAAG,YAAY,KAAK,CAAC;AACtH,UAAI,mBAAmB;AACnB,0BAAkB,OAAO,aAAa;AAAA,MAC1C,OAAO;AACH,4BAAoB,EAAE,MAAM,GAAG,QAAQ,GAAG,MAAM,aAAa,OAAO;AAAA,MACxE;AACA;AAAA,IACJ,KAAK,kBAAkB;AACnB,0BAAoB,sBAAsB,YAAa,OAAoC,KAAK,GAAG,YAAY,KAAK,CAAC;AACrH,wBAAkB,OAAO,aAAa;AACtC;AAAA,IACJ,KAAK,kBAAkB;AACnB,0BAAoB,sBAAuB,OAAoC,OAAO,KAAK;AAC3F,wBAAkB,OAAO,aAAa;AACtC;AAAA,IACJ,KAAK,kBAAkB;AACnB;AACI,cAAM,YAAa,OAAoC,aAAa,IAAI,aAAc,OAAoC,IAAI,EAAE,SAAS;AACzI,cAAM,UAAW,OAAoC,WAAW,IAAI,aAAc,OAAoC,EAAE,EAAE,SAAS;AACnI,4BAAoB;AAAA,UAChB;AAAA,UACA;AAAA,UACA;AAAA,QACJ;AAAA,MACJ;AACA;AAAA,IACJ;AACI;AAAA,EACR;AACA,MAAI,mBAAmB;AACnB,WAAO,MAAM,QAAQ,iBAAiB,IAAI,qBAAqB,mBAAmB,KAAK,IAAI,qBAAqB,CAAC,iBAA8B,GAAG,KAAK;AAAA,EAC3J,OAAO;AACH,WAAO;AAAA,EACX;AACJ;AAGO,gBAAS,2BAA2B,SAA+B,MAA4D;AAClI,QAAM,EAAE,wBAAwB,IAAI;AACpC,UAAQ,QAAQ,IAAI;AAAA,IAChB,KAAK,gBAAgB,mBAAmB;AACpC,YAAM,SAAS,QAAQ;AACvB,aAAO;AAAA,QACH,OAAO;AAAA,QACP;AAAA,UACI,GAAG,OAAO;AAAA,UACV,aAAa,OAAO,QAAQ,cAAc;AAAA,UAC1C,WAAW,OAAO,QAAQ,YAAY;AAAA,QAC1C;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,mBAAmB;AACpC,YAAM,SAAS,QAAQ;AACvB,aAAO;AAAA,QACH,OAAO;AAAA,QACP;AAAA,UACI,GAAG,OAAO;AAAA,UACV,UAAU,OAAO,QAAQ,WAAW;AAAA,UACpC,QAAQ,OAAO,QAAQ,WAAW;AAAA,QACtC;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,YAAM,SAAS;AACf,aAAO,CAAC,OAAO,OAAQ,WAAW,OAAO,OAAQ,OAAO;AAAA,IAC5D;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,YAAM,SAAS;AACf,YAAM,QAAgB,OAAO,OAAQ;AACrC,aAAO;AAAA,QACH;AAAA,UACI,GAAG;AAAA,UACH,UAAU,MAAM,WAAW;AAAA,UAC3B,QAAQ,MAAM,SAAS;AAAA,QAC3B;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,YAAM,SAAS;AACf,YAAM,QAAgB,OAAO,OAAQ;AACrC,aAAO;AAAA,QACH;AAAA,UACI,GAAG;AAAA,UACH,aAAa,MAAM,cAAc;AAAA,UACjC,WAAW,MAAM,YAAY;AAAA,QACjC;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,YAAM,SAAS;AACf,YAAM,QAAgB,OAAO,OAAQ;AACrC,aAAO,CAAC,KAAK;AAAA,IACjB;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,YAAM,SAAS;AACf,YAAM,QAAgB,OAAO,OAAQ;AACrC,aAAO,CAAC,KAAK;AAAA,IACjB;AAAA,IACA,KAAK,gBAAgB;AAAA,IACrB,KAAK,gBAAgB,8BAA8B;AAC/C,YAAM,SAAS;AACf,YAAM,QAAQ,OAAO,QAAQ,SAAS,wBAAwB,qBAAqB,GAAG,IAAI,CAAC,MAAM,EAAE,KAAK,IAAI,CAAC;AAC7G,UAAI,CAAC,OAAO;AACR,eAAO,CAAC;AAAA,MACZ;AACA,aAAO,CAAC,KAAK;AAAA,IACjB;AAAA,IACA,KAAK,gBAAgB;AAAA,IACrB,KAAK,gBAAgB,+BAA+B;AAChD,YAAM,SAAS;AACf,YAAM,QAAQ,OAAO,QAAQ,SAAS,wBAAwB,qBAAqB,GAAG,IAAI,CAAC,MAAM,EAAE,KAAK,IAAI,CAAC;AAC7G,UAAI,CAAC,OAAO;AACR,eAAO,CAAC;AAAA,MACZ;AACA,aAAO,CAAC,KAAK;AAAA,IACjB;AAAA,IACA,KAAK,gBAAgB,uBAAuB;AACxC,YAAM,SAAS;AACf,YAAM,EAAE,OAAO,MAAM,IAAI,OAAO;AAChC,YAAM,eAAe,CAAC;AACtB,eAAS,MAAM,MAAM,UAAU,OAAO,MAAM,QAAQ,OAAO;AACvD,YAAI,OAAO,OAAO;AACd,uBAAa,KAAK;AAAA,YACd,UAAU;AAAA,YACV,QAAQ;AAAA,YACR,aAAa,MAAM;AAAA,YACnB,WAAW,MAAM;AAAA,UACrB,CAAC;AAAA,QACL;AAAA,MACJ;AACA,aAAO;AAAA,IACX;AAAA,EACJ;AACJ;AAEO,gBAAS,4BAA4B,UAA+C;AACvF,UAAQ,SAAS,IAAI;AAAA,IACjB,KAAK,iBAAiB,IAAI;AACtB,YAAM,SAAS,SAAS;AACxB,aAAO;AAAA,QACH,OAAO;AAAA,QACP;AAAA,UACI,GAAG,OAAO;AAAA,UACV,aAAa,OAAO,YAAY,cAAc;AAAA,UAC9C,WAAW,OAAO,YAAY,cAAc;AAAA,QAChD;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,KAAK,iBAAiB,IAAI;AACtB,YAAM,SAAS,SAAS;AACxB,aAAO;AAAA,QACH,OAAO;AAAA,QACP;AAAA,UACI,GAAG,OAAO;AAAA,UACV,UAAU,OAAO,YAAY,WAAW;AAAA,UACxC,QAAQ,OAAO,YAAY,WAAW;AAAA,QAC1C;AAAA,MACJ;AAAA,IACJ;AAAA,IAEA,KAAK,kBAAkB,IAAI;AACvB,YAAM,SAAS,SAAS;AACxB,aAAO,CAAC,IAAI,aAAa,OAAO,KAAK,KAAK,EAAE,SAAS,GAAG,IAAI,aAAa,OAAO,GAAG,KAAK,EAAE,SAAS,CAAC;AAAA,IACxG;AAAA,IACA,KAAK,kBAAkB,IAAI;AACvB,YAAM,SAAS,SAAS;AACxB,YAAM,QAAgB,OAAO;AAC7B,aAAO;AAAA,QACH;AAAA,UACI,GAAG;AAAA,UACH,aAAa,MAAM,cAAc;AAAA,UACjC,WAAW,MAAM,cAAc;AAAA,QACnC;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,KAAK,kBAAkB,IAAI;AACvB,YAAM,SAAS,SAAS;AACxB,YAAM,QAAgB,OAAO;AAC7B,aAAO;AAAA,QACH;AAAA,UACI,GAAG;AAAA,UACH,UAAU,MAAM,WAAW;AAAA,UAC3B,QAAQ,MAAM,WAAW;AAAA,QAC7B;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,KAAK,kBAAkB,IAAI;AACvB,YAAM,SAAS,SAAS;AACxB,YAAM,QAAgB,OAAO;AAC7B,aAAO,CAAC,KAAK;AAAA,IACjB;AAAA,IACA,KAAK,kBAAkB,IAAI;AACvB,YAAM,SAAS,SAAS;AACxB,YAAM,QAAgB,OAAO;AAC7B,aAAO,CAAC,KAAK;AAAA,IACjB;AAAA,IACA;AACI;AAAA,EACR;AACJ;AAGO,gBAAS,mCAAmC,UAAqB,SAItE;AACE,QAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,QAAM,0BAA0B,SAAS,IAAI,uBAAuB;AAEpE,UAAQ,QAAQ,IAAI;AAAA,IAChB,KAAK,gBAAgB,mBAAmB;AACpC,YAAM,SAAS,QAAQ;AACvB,YAAM,SAAS,sBAAsB,uBAAuB;AAAA,QACxD,QAAQ,OAAO;AAAA,QACf,WAAW,OAAO;AAAA,MACtB,CAAC;AAED,aAAO;AAAA,QACH,QAAQ,OAAO;AAAA,QACf,WAAW,OAAO;AAAA,QAClB,QAAQ;AAAA,UACJ,OAAO;AAAA,UAEP;AAAA,YACI,GAAG,OAAO;AAAA,YACV,aAAa,OAAO,UAAU,cAAc,OAAO,QAAQ,cAAc,OAAO,UAAU,YAAY,IAAI,OAAO,QAAQ;AAAA,YACzH,WAAW,OAAO,UAAU,cAAc,OAAO,QAAQ,cAAc,OAAO,QAAQ,YAAY,IAAI,OAAO,UAAU,cAAc;AAAA,UACzI;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,mBAAmB;AACpC,YAAM,SAAS,QAAQ;AACvB,YAAM,SAAS,sBAAsB,uBAAuB;AAAA,QACxD,QAAQ,OAAO;AAAA,QACf,WAAW,OAAO;AAAA,MACtB,CAAC;AACD,aAAO;AAAA,QACH,QAAQ,OAAO;AAAA,QACf,WAAW,OAAO;AAAA,QAClB,QAAQ;AAAA,UACJ,OAAO;AAAA,UACP;AAAA,YACI,GAAG,OAAO;AAAA,YACV,UAAU,OAAO,UAAU,WAAW,OAAO,QAAQ,WAAW,OAAO,UAAU,SAAS,IAAI,OAAO,QAAQ;AAAA,YAC7G,QAAQ,OAAO,UAAU,WAAW,OAAO,QAAQ,WAAW,OAAO,QAAQ,SAAS,IAAI,OAAO,UAAU,WAAW;AAAA,UAC1H;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,YAAM,SAAS,QAAQ;AACvB,YAAM,SAAS,sBAAsB,qBAAqB;AAE1D,aAAO;AAAA,QACH,QAAQ,OAAO;AAAA,QACf,WAAW,OAAO;AAAA,QAClB,QAAQ,CAAC,OAAO,WAAW,OAAO,OAAO;AAAA,MAC7C;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,YAAM,SAAS,QAAQ;AACvB,YAAM,QAAgB,OAAO;AAC7B,aAAO;AAAA,QACH,QAAQ,OAAO;AAAA,QACf,WAAW,OAAO;AAAA,QAClB,QAAQ;AAAA,UACJ,GAAG,MAAM,WAAW,IACd,CAAC;AAAA,YACC,GAAG;AAAA,YACH,UAAU,MAAM,WAAW;AAAA,YAC3B,QAAQ,MAAM,SAAS;AAAA,UAC3B,CAAC,IACC,CAAC;AAAA,UACP;AAAA,YACI,GAAG;AAAA,YACH,UAAU,MAAM;AAAA,YAChB,QAAQ,OAAO;AAAA,UACnB;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,YAAM,SAAS,QAAQ;AACvB,YAAM,QAAgB,OAAO;AAC7B,aAAO;AAAA,QACH,QAAQ,OAAO;AAAA,QACf,WAAW,OAAO;AAAA,QAClB,QAAQ;AAAA,UACJ,GAAG,MAAM,cAAc,IACjB,CAAC;AAAA,YACC,GAAG;AAAA,YACH,aAAa,MAAM,cAAc;AAAA,YACjC,WAAW,MAAM,YAAY;AAAA,UACjC,CAAC,IACC,CAAC;AAAA,UACP;AAAA,YACI,GAAG;AAAA,YACH,aAAa,MAAM;AAAA,YACnB,WAAW,OAAO;AAAA,UACtB;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,YAAM,SAAS,QAAQ;AACvB,YAAM,QAAgB,OAAO;AAC7B,YAAM,SAAS,sBAAsB,qBAAqB;AAC1D,aAAO;AAAA,QACH,QAAQ,OAAO;AAAA,QACf,WAAW,OAAO;AAAA,QAClB,QAAQ;AAAA,UACJ;AAAA,UACA;AAAA,YACI,GAAG;AAAA,YACH,UAAU,MAAM,SAAS;AAAA,YACzB,QAAQ,OAAO;AAAA,UACnB;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,oBAAoB;AACrC,YAAM,SAAS,QAAQ;AACvB,YAAM,QAAgB,OAAO;AAC7B,YAAM,SAAS,sBAAsB,qBAAqB;AAE1D,aAAO;AAAA,QACH,QAAQ,OAAO;AAAA,QACf,WAAW,OAAO;AAAA,QAClB,QAAQ;AAAA,UACJ;AAAA,UACA;AAAA,YACI,GAAG;AAAA,YACH,aAAa,MAAM,YAAY;AAAA,YAC/B,WAAW,OAAO;AAAA,UACtB;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB;AAAA,IACrB,KAAK,gBAAgB,8BAA8B;AAC/C,YAAM,SAAS;AACf,YAAM,SAAS,sBAAsB,qBAAqB;AAC1D,YAAM,QAAQ,OAAO,QAAQ,SAAS,wBAAwB,qBAAqB,GAAG,IAAI,CAAC,MAAM,EAAE,KAAK,IAAI,CAAC;AAC7G,UAAI,CAAC,OAAO;AACR,eAAO;AAAA,UACH,QAAQ,OAAO;AAAA,UACf,WAAW,OAAO;AAAA,UAClB,QAAQ,CAAC;AAAA,QACb;AAAA,MACJ;AAEA,aAAO;AAAA,QACH,QAAQ,OAAO;AAAA,QACf,WAAW,OAAO;AAAA,QAClB,QAAQ;AAAA,UACJ;AAAA,UACA;AAAA,YACI,GAAG;AAAA,YACH,UAAU,MAAM,SAAS;AAAA,YACzB,QAAQ,OAAO;AAAA,UACnB;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB;AAAA,IACrB,KAAK,gBAAgB,+BAA+B;AAChD,YAAM,SAAS;AACf,YAAM,QAAQ,OAAO,QAAQ,SAAS,wBAAwB,qBAAqB,GAAG,IAAI,CAAC,MAAM,EAAE,KAAK,IAAI,CAAC;AAC7G,YAAM,SAAS,sBAAsB,qBAAqB;AAC1D,UAAI,CAAC,OAAO;AACR,eAAO;AAAA,UACH,QAAQ,OAAO;AAAA,UACf,WAAW,OAAO;AAAA,UAClB,QAAQ,CAAC;AAAA,QACb;AAAA,MACJ;AACA,aAAO;AAAA,QACH,QAAQ,OAAO;AAAA,QACf,WAAW,OAAO;AAAA,QAClB,QAAQ;AAAA,UACJ;AAAA,UACA;AAAA,YACI,GAAG;AAAA,YACH,aAAa,MAAM,YAAY;AAAA,YAC/B,WAAW,OAAO;AAAA,UACtB;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,KAAK,gBAAgB,uBAAuB;AACxC,YAAM,SAAS;AACf,YAAM,EAAE,OAAO,MAAM,IAAI,OAAO;AAChC,YAAM,eAAe,CAAC;AACtB,eAAS,MAAM,MAAM,UAAU,OAAO,MAAM,QAAQ,OAAO;AACvD,YAAI,OAAO,OAAO;AACd,uBAAa,KAAK;AAAA,YACd,UAAU;AAAA,YACV,QAAQ;AAAA,YACR,aAAa,MAAM;AAAA,YACnB,WAAW,MAAM;AAAA,UACrB,CAAC;AAAA,QACL;AAAA,MACJ;AACA,YAAM,SAAS,sBAAsB,qBAAqB;AAC1D,aAAO;AAAA,QACH,QAAQ,OAAO;AAAA,QACf,WAAW,OAAO;AAAA,QAClB,QAAQ;AAAA,MACZ;AAAA,IACJ;AAAA,EACJ;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"55d5d3c3e8132975ecb3db62ca3acc451dc31926"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/ref-range/ref-range.service.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/ref-range/ref-range.service.ts","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":37}},"1":{"start":{"line":2,"column":23},"end":{"line":2,"column":54}},"2":{"start":{"line":3,"column":22},"end":{"line":10,"column":1}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"4":{"start":{"line":5,"column":2},"end":{"line":7,"column":85}},"5":{"start":{"line":5,"column":15},"end":{"line":5,"column":36}},"6":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"7":{"start":{"line":7,"column":6},"end":{"line":7,"column":85}},"8":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"9":{"start":{"line":8,"column":22},"end":{"line":8,"column":53}},"10":{"start":{"line":9,"column":2},"end":{"line":9,"column":16}},"11":{"start":{"line":11,"column":22},"end":{"line":11,"column":90}},"12":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"13":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"14":{"start":{"line":31,"column":19},"end":{"line":31,"column":53}},"15":{"start":{"line":32,"column":19},"end":{"line":32,"column":53}},"16":{"start":{"line":33,"column":20},"end":{"line":33,"column":60}},"17":{"start":{"line":36,"column":4},"end":{"line":36,"column":12}},"18":{"start":{"line":37,"column":4},"end":{"line":37,"column":27}},"19":{"start":{"line":38,"column":4},"end":{"line":38,"column":33}},"20":{"start":{"line":39,"column":4},"end":{"line":39,"column":25}},"21":{"start":{"line":40,"column":4},"end":{"line":40,"column":31}},"22":{"start":{"line":41,"column":4},"end":{"line":41,"column":43}},"23":{"start":{"line":44,"column":4},"end":{"line":46,"column":5}},"24":{"start":{"line":45,"column":6},"end":{"line":45,"column":13}},"25":{"start":{"line":47,"column":4},"end":{"line":54,"column":5}},"26":{"start":{"line":48,"column":21},"end":{"line":48,"column":36}},"27":{"start":{"line":49,"column":6},"end":{"line":51,"column":7}},"28":{"start":{"line":50,"column":8},"end":{"line":50,"column":15}},"29":{"start":{"line":52,"column":11},"end":{"line":54,"column":5}},"30":{"start":{"line":53,"column":6},"end":{"line":53,"column":13}},"31":{"start":{"line":55,"column":4},"end":{"line":57,"column":5}},"32":{"start":{"line":56,"column":6},"end":{"line":56,"column":13}},"33":{"start":{"line":58,"column":4},"end":{"line":66,"column":5}},"34":{"start":{"line":59,"column":6},"end":{"line":61,"column":7}},"35":{"start":{"line":60,"column":8},"end":{"line":60,"column":15}},"36":{"start":{"line":62,"column":27},"end":{"line":62,"column":64}},"37":{"start":{"line":63,"column":6},"end":{"line":65,"column":7}},"38":{"start":{"line":63,"column":46},"end":{"line":63,"column":92}},"39":{"start":{"line":64,"column":8},"end":{"line":64,"column":15}},"40":{"start":{"line":67,"column":23},"end":{"line":67,"column":67}},"41":{"start":{"line":68,"column":4},"end":{"line":70,"column":5}},"42":{"start":{"line":69,"column":6},"end":{"line":69,"column":19}},"43":{"start":{"line":71,"column":25},"end":{"line":71,"column":36}},"44":{"start":{"line":72,"column":4},"end":{"line":72,"column":29}},"45":{"start":{"line":73,"column":4},"end":{"line":73,"column":45}},"46":{"start":{"line":76,"column":29},"end":{"line":357,"column":1}},"47":{"start":{"line":78,"column":4},"end":{"line":78,"column":12}},"48":{"start":{"line":79,"column":4},"end":{"line":79,"column":43}},"49":{"start":{"line":80,"column":4},"end":{"line":80,"column":61}},"50":{"start":{"line":81,"column":4},"end":{"line":81,"column":57}},"51":{"start":{"line":82,"column":4},"end":{"line":82,"column":61}},"52":{"start":{"line":83,"column":4},"end":{"line":83,"column":29}},"53":{"start":{"line":84,"column":4},"end":{"line":87,"column":7}},"54":{"start":{"line":86,"column":25},"end":{"line":86,"column":29}},"55":{"start":{"line":88,"column":4},"end":{"line":91,"column":7}},"56":{"start":{"line":90,"column":25},"end":{"line":90,"column":29}},"57":{"start":{"line":93,"column":16},"end":{"line":93,"column":66}},"58":{"start":{"line":94,"column":33},"end":{"line":94,"column":42}},"59":{"start":{"line":97,"column":4},"end":{"line":104,"column":5}},"60":{"start":{"line":98,"column":6},"end":{"line":103,"column":9}},"61":{"start":{"line":99,"column":8},"end":{"line":99,"column":64}},"62":{"start":{"line":99,"column":51},"end":{"line":99,"column":64}},"63":{"start":{"line":100,"column":8},"end":{"line":102,"column":9}},"64":{"start":{"line":101,"column":10},"end":{"line":101,"column":42}},"65":{"start":{"line":105,"column":23},"end":{"line":105,"column":89}},"66":{"start":{"line":106,"column":4},"end":{"line":106,"column":38}},"67":{"start":{"line":107,"column":29},"end":{"line":113,"column":6}},"68":{"start":{"line":108,"column":6},"end":{"line":108,"column":43}},"69":{"start":{"line":109,"column":6},"end":{"line":112,"column":7}},"70":{"start":{"line":110,"column":8},"end":{"line":110,"column":39}},"71":{"start":{"line":111,"column":8},"end":{"line":111,"column":35}},"72":{"start":{"line":114,"column":30},"end":{"line":114,"column":66}},"73":{"start":{"line":115,"column":4},"end":{"line":118,"column":7}},"74":{"start":{"line":116,"column":6},"end":{"line":116,"column":34}},"75":{"start":{"line":117,"column":6},"end":{"line":117,"column":33}},"76":{"start":{"line":120,"column":40},"end":{"line":120,"column":49}},"77":{"start":{"line":121,"column":16},"end":{"line":121,"column":39}},"78":{"start":{"line":123,"column":22},"end":{"line":288,"column":3}},"79":{"start":{"line":124,"column":4},"end":{"line":287,"column":7}},"80":{"start":{"line":127,"column":26},"end":{"line":127,"column":125}},"81":{"start":{"line":128,"column":23},"end":{"line":128,"column":61}},"82":{"start":{"line":129,"column":26},"end":{"line":129,"column":67}},"83":{"start":{"line":130,"column":8},"end":{"line":132,"column":9}},"84":{"start":{"line":131,"column":10},"end":{"line":131,"column":70}},"85":{"start":{"line":133,"column":33},"end":{"line":250,"column":9}},"86":{"start":{"line":134,"column":10},"end":{"line":249,"column":11}},"87":{"start":{"line":136,"column":29},"end":{"line":136,"column":43}},"88":{"start":{"line":137,"column":34},"end":{"line":137,"column":100}},"89":{"start":{"line":138,"column":14},"end":{"line":142,"column":16}},"90":{"start":{"line":145,"column":29},"end":{"line":145,"column":43}},"91":{"start":{"line":146,"column":31},"end":{"line":146,"column":91}},"92":{"start":{"line":147,"column":14},"end":{"line":151,"column":16}},"93":{"start":{"line":154,"column":29},"end":{"line":154,"column":36}},"94":{"start":{"line":155,"column":14},"end":{"line":159,"column":16}},"95":{"start":{"line":162,"column":29},"end":{"line":162,"column":36}},"96":{"start":{"line":163,"column":31},"end":{"line":163,"column":59}},"97":{"start":{"line":164,"column":28},"end":{"line":170,"column":15}},"98":{"start":{"line":171,"column":14},"end":{"line":171,"column":66}},"99":{"start":{"line":174,"column":29},"end":{"line":174,"column":36}},"100":{"start":{"line":175,"column":31},"end":{"line":175,"column":62}},"101":{"start":{"line":176,"column":28},"end":{"line":182,"column":15}},"102":{"start":{"line":183,"column":14},"end":{"line":183,"column":66}},"103":{"start":{"line":186,"column":29},"end":{"line":186,"column":36}},"104":{"start":{"line":187,"column":31},"end":{"line":187,"column":59}},"105":{"start":{"line":188,"column":28},"end":{"line":194,"column":15}},"106":{"start":{"line":195,"column":14},"end":{"line":195,"column":66}},"107":{"start":{"line":198,"column":29},"end":{"line":198,"column":36}},"108":{"start":{"line":199,"column":31},"end":{"line":199,"column":62}},"109":{"start":{"line":200,"column":28},"end":{"line":206,"column":15}},"110":{"start":{"line":207,"column":14},"end":{"line":207,"column":66}},"111":{"start":{"line":211,"column":29},"end":{"line":211,"column":36}},"112":{"start":{"line":212,"column":28},"end":{"line":212,"column":103}},"113":{"start":{"line":213,"column":34},"end":{"line":218,"column":15}},"114":{"start":{"line":219,"column":14},"end":{"line":219,"column":72}},"115":{"start":{"line":223,"column":29},"end":{"line":223,"column":36}},"116":{"start":{"line":224,"column":28},"end":{"line":224,"column":103}},"117":{"start":{"line":225,"column":34},"end":{"line":230,"column":15}},"118":{"start":{"line":231,"column":14},"end":{"line":231,"column":72}},"119":{"start":{"line":234,"column":29},"end":{"line":234,"column":36}},"120":{"start":{"line":235,"column":39},"end":{"line":235,"column":52}},"121":{"start":{"line":236,"column":35},"end":{"line":236,"column":37}},"122":{"start":{"line":237,"column":14},"end":{"line":246,"column":15}},"123":{"start":{"line":237,"column":29},"end":{"line":237,"column":43}},"124":{"start":{"line":238,"column":16},"end":{"line":245,"column":17}},"125":{"start":{"line":239,"column":18},"end":{"line":244,"column":21}},"126":{"start":{"line":247,"column":14},"end":{"line":247,"column":71}},"127":{"start":{"line":251,"column":23},"end":{"line":251,"column":47}},"128":{"start":{"line":252,"column":23},"end":{"line":268,"column":9}},"129":{"start":{"line":254,"column":22},"end":{"line":254,"column":40}},"130":{"start":{"line":255,"column":12},"end":{"line":255,"column":28}},"131":{"start":{"line":256,"column":12},"end":{"line":256,"column":27}},"132":{"start":{"line":261,"column":12},"end":{"line":261,"column":54}},"133":{"start":{"line":262,"column":12},"end":{"line":262,"column":54}},"134":{"start":{"line":263,"column":12},"end":{"line":263,"column":66}},"135":{"start":{"line":264,"column":12},"end":{"line":264,"column":66}},"136":{"start":{"line":265,"column":12},"end":{"line":265,"column":27}},"137":{"start":{"line":269,"column":25},"end":{"line":272,"column":15}},"138":{"start":{"line":273,"column":22},"end":{"line":276,"column":15}},"139":{"start":{"line":277,"column":25},"end":{"line":280,"column":15}},"140":{"start":{"line":281,"column":22},"end":{"line":284,"column":15}},"141":{"start":{"line":285,"column":8},"end":{"line":285,"column":52}},"142":{"start":{"line":289,"column":16},"end":{"line":315,"column":3}},"143":{"start":{"line":290,"column":22},"end":{"line":290,"column":53}},"144":{"start":{"line":291,"column":20},"end":{"line":291,"column":59}},"145":{"start":{"line":292,"column":4},"end":{"line":313,"column":5}},"146":{"start":{"line":293,"column":42},"end":{"line":293,"column":51}},"147":{"start":{"line":294,"column":22},"end":{"line":294,"column":41}},"148":{"start":{"line":295,"column":6},"end":{"line":311,"column":9}},"149":{"start":{"line":296,"column":23},"end":{"line":296,"column":39}},"150":{"start":{"line":297,"column":22},"end":{"line":297,"column":55}},"151":{"start":{"line":298,"column":26},"end":{"line":305,"column":9}},"152":{"start":{"line":306,"column":8},"end":{"line":310,"column":9}},"153":{"start":{"line":306,"column":40},"end":{"line":306,"column":77}},"154":{"start":{"line":307,"column":10},"end":{"line":309,"column":13}},"155":{"start":{"line":308,"column":12},"end":{"line":308,"column":38}},"156":{"start":{"line":312,"column":6},"end":{"line":312,"column":30}},"157":{"start":{"line":314,"column":4},"end":{"line":314,"column":14}},"158":{"start":{"line":324,"column":21},"end":{"line":356,"column":3}},"159":{"start":{"line":325,"column":19},"end":{"line":325,"column":68}},"160":{"start":{"line":326,"column":22},"end":{"line":326,"column":77}},"161":{"start":{"line":327,"column":4},"end":{"line":330,"column":5}},"162":{"start":{"line":328,"column":6},"end":{"line":329,"column":9}},"163":{"start":{"line":331,"column":30},"end":{"line":331,"column":61}},"164":{"start":{"line":332,"column":24},"end":{"line":332,"column":57}},"165":{"start":{"line":333,"column":18},"end":{"line":333,"column":65}},"166":{"start":{"line":334,"column":4},"end":{"line":337,"column":5}},"167":{"start":{"line":335,"column":6},"end":{"line":335,"column":42}},"168":{"start":{"line":336,"column":6},"end":{"line":336,"column":63}},"169":{"start":{"line":338,"column":33},"end":{"line":338,"column":57}},"170":{"start":{"line":339,"column":4},"end":{"line":343,"column":5}},"171":{"start":{"line":340,"column":6},"end":{"line":340,"column":41}},"172":{"start":{"line":342,"column":6},"end":{"line":342,"column":68}},"173":{"start":{"line":344,"column":4},"end":{"line":355,"column":7}},"174":{"start":{"line":345,"column":36},"end":{"line":345,"column":60}},"175":{"start":{"line":346,"column":6},"end":{"line":354,"column":7}},"176":{"start":{"line":347,"column":8},"end":{"line":347,"column":47}},"177":{"start":{"line":348,"column":8},"end":{"line":353,"column":9}},"178":{"start":{"line":349,"column":10},"end":{"line":349,"column":38}},"179":{"start":{"line":350,"column":10},"end":{"line":352,"column":11}},"180":{"start":{"line":351,"column":12},"end":{"line":351,"column":63}},"181":{"start":{"line":358,"column":0},"end":{"line":363,"column":20}},"182":{"start":{"line":365,"column":2},"end":{"line":365,"column":98}},"183":{"start":{"line":368,"column":2},"end":{"line":368,"column":117}},"184":{"start":{"line":371,"column":2},"end":{"line":371,"column":83}},"185":{"start":{"line":371,"column":68},"end":{"line":371,"column":75}},"186":{"start":{"line":374,"column":2},"end":{"line":374,"column":34}},"187":{"start":{"line":377,"column":18},"end":{"line":377,"column":81}},"188":{"start":{"line":378,"column":21},"end":{"line":378,"column":24}},"189":{"start":{"line":379,"column":2},"end":{"line":407,"column":4}},"190":{"start":{"line":381,"column":18},"end":{"line":387,"column":7}},"191":{"start":{"line":383,"column":10},"end":{"line":383,"column":49}},"192":{"start":{"line":384,"column":10},"end":{"line":384,"column":26}},"193":{"start":{"line":388,"column":18},"end":{"line":397,"column":7}},"194":{"start":{"line":390,"column":24},"end":{"line":390,"column":38}},"195":{"start":{"line":391,"column":10},"end":{"line":393,"column":11}},"196":{"start":{"line":392,"column":12},"end":{"line":392,"column":48}},"197":{"start":{"line":394,"column":10},"end":{"line":394,"column":26}},"198":{"start":{"line":398,"column":6},"end":{"line":398,"column":17}},"199":{"start":{"line":400,"column":26},"end":{"line":406,"column":10}},"200":{"start":{"line":401,"column":20},"end":{"line":401,"column":39}},"201":{"start":{"line":402,"column":6},"end":{"line":404,"column":7}},"202":{"start":{"line":403,"column":8},"end":{"line":403,"column":67}},"203":{"start":{"line":405,"column":6},"end":{"line":405,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":22},"end":{"line":3,"column":23}},"loc":{"start":{"line":3,"column":57},"end":{"line":10,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":44},"end":{"line":11,"column":45}},"loc":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":35,"column":2},"end":{"line":35,"column":3}},"loc":{"start":{"line":35,"column":79},"end":{"line":42,"column":3}},"line":35},"4":{"name":"(anonymous_4)","decl":{"start":{"line":43,"column":2},"end":{"line":43,"column":3}},"loc":{"start":{"line":43,"column":23},"end":{"line":74,"column":3}},"line":43},"5":{"name":"(anonymous_5)","decl":{"start":{"line":63,"column":29},"end":{"line":63,"column":30}},"loc":{"start":{"line":63,"column":46},"end":{"line":63,"column":92}},"line":63},"6":{"name":"(anonymous_6)","decl":{"start":{"line":77,"column":2},"end":{"line":77,"column":3}},"loc":{"start":{"line":77,"column":107},"end":{"line":92,"column":3}},"line":77},"7":{"name":"(anonymous_7)","decl":{"start":{"line":86,"column":15},"end":{"line":86,"column":16}},"loc":{"start":{"line":86,"column":25},"end":{"line":86,"column":29}},"line":86},"8":{"name":"(anonymous_8)","decl":{"start":{"line":90,"column":15},"end":{"line":90,"column":16}},"loc":{"start":{"line":90,"column":25},"end":{"line":90,"column":29}},"line":90},"9":{"name":"(anonymous_9)","decl":{"start":{"line":95,"column":2},"end":{"line":95,"column":3}},"loc":{"start":{"line":95,"column":65},"end":{"line":119,"column":3}},"line":95},"10":{"name":"(anonymous_10)","decl":{"start":{"line":98,"column":67},"end":{"line":98,"column":68}},"loc":{"start":{"line":98,"column":80},"end":{"line":103,"column":7}},"line":98},"11":{"name":"(anonymous_11)","decl":{"start":{"line":107,"column":42},"end":{"line":107,"column":43}},"loc":{"start":{"line":107,"column":48},"end":{"line":113,"column":5}},"line":107},"12":{"name":"(anonymous_12)","decl":{"start":{"line":115,"column":24},"end":{"line":115,"column":25}},"loc":{"start":{"line":115,"column":30},"end":{"line":118,"column":5}},"line":115},"13":{"name":"(anonymous_13)","decl":{"start":{"line":123,"column":22},"end":{"line":123,"column":23}},"loc":{"start":{"line":123,"column":28},"end":{"line":288,"column":3}},"line":123},"14":{"name":"(anonymous_14)","decl":{"start":{"line":126,"column":20},"end":{"line":126,"column":21}},"loc":{"start":{"line":126,"column":33},"end":{"line":286,"column":7}},"line":126},"15":{"name":"(anonymous_15)","decl":{"start":{"line":133,"column":33},"end":{"line":133,"column":34}},"loc":{"start":{"line":133,"column":39},"end":{"line":250,"column":9}},"line":133},"16":{"name":"(anonymous_16)","decl":{"start":{"line":253,"column":10},"end":{"line":253,"column":11}},"loc":{"start":{"line":253,"column":34},"end":{"line":257,"column":11}},"line":253},"17":{"name":"(anonymous_17)","decl":{"start":{"line":260,"column":10},"end":{"line":260,"column":11}},"loc":{"start":{"line":260,"column":37},"end":{"line":266,"column":11}},"line":260},"18":{"name":"(anonymous_18)","decl":{"start":{"line":289,"column":16},"end":{"line":289,"column":17}},"loc":{"start":{"line":289,"column":53},"end":{"line":315,"column":3}},"line":289},"19":{"name":"(anonymous_19)","decl":{"start":{"line":295,"column":22},"end":{"line":295,"column":23}},"loc":{"start":{"line":295,"column":31},"end":{"line":311,"column":7}},"line":295},"20":{"name":"(anonymous_20)","decl":{"start":{"line":306,"column":30},"end":{"line":306,"column":31}},"loc":{"start":{"line":306,"column":40},"end":{"line":306,"column":77}},"line":306},"21":{"name":"(anonymous_21)","decl":{"start":{"line":307,"column":35},"end":{"line":307,"column":36}},"loc":{"start":{"line":307,"column":49},"end":{"line":309,"column":11}},"line":307},"22":{"name":"(anonymous_22)","decl":{"start":{"line":324,"column":21},"end":{"line":324,"column":22}},"loc":{"start":{"line":324,"column":63},"end":{"line":356,"column":3}},"line":324},"23":{"name":"(anonymous_23)","decl":{"start":{"line":328,"column":26},"end":{"line":328,"column":27}},"loc":{"start":{"line":328,"column":32},"end":{"line":329,"column":7}},"line":328},"24":{"name":"(anonymous_24)","decl":{"start":{"line":344,"column":24},"end":{"line":344,"column":25}},"loc":{"start":{"line":344,"column":30},"end":{"line":355,"column":5}},"line":344},"25":{"name":"getUnitId","decl":{"start":{"line":364,"column":9},"end":{"line":364,"column":18}},"loc":{"start":{"line":364,"column":42},"end":{"line":366,"column":1}},"line":364},"26":{"name":"getSubUnitId","decl":{"start":{"line":367,"column":9},"end":{"line":367,"column":21}},"loc":{"start":{"line":367,"column":45},"end":{"line":369,"column":1}},"line":367},"27":{"name":"getSelectionRanges","decl":{"start":{"line":370,"column":9},"end":{"line":370,"column":27}},"loc":{"start":{"line":370,"column":53},"end":{"line":372,"column":1}},"line":370},"28":{"name":"(anonymous_28)","decl":{"start":{"line":371,"column":61},"end":{"line":371,"column":62}},"loc":{"start":{"line":371,"column":68},"end":{"line":371,"column":75}},"line":371},"29":{"name":"getRefRangId","decl":{"start":{"line":373,"column":9},"end":{"line":373,"column":21}},"loc":{"start":{"line":373,"column":41},"end":{"line":375,"column":1}},"line":373},"30":{"name":"createRangeSerializer","decl":{"start":{"line":376,"column":9},"end":{"line":376,"column":30}},"loc":{"start":{"line":376,"column":33},"end":{"line":408,"column":1}},"line":376},"31":{"name":"(anonymous_31)","decl":{"start":{"line":380,"column":17},"end":{"line":380,"column":18}},"loc":{"start":{"line":380,"column":34},"end":{"line":399,"column":5}},"line":380},"32":{"name":"(anonymous_32)","decl":{"start":{"line":382,"column":8},"end":{"line":382,"column":9}},"loc":{"start":{"line":382,"column":43},"end":{"line":385,"column":9}},"line":382},"33":{"name":"(anonymous_33)","decl":{"start":{"line":389,"column":8},"end":{"line":389,"column":9}},"loc":{"start":{"line":389,"column":44},"end":{"line":395,"column":9}},"line":389},"34":{"name":"(anonymous_34)","decl":{"start":{"line":400,"column":15},"end":{"line":400,"column":16}},"loc":{"start":{"line":400,"column":26},"end":{"line":406,"column":10}},"line":400},"35":{"name":"(anonymous_35)","decl":{"start":{"line":400,"column":41},"end":{"line":400,"column":42}},"loc":{"start":{"line":400,"column":76},"end":{"line":406,"column":5}},"line":400}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":26},"end":{"line":4,"column":32}},{"start":{"line":4,"column":35},"end":{"line":4,"column":80}}],"line":4},"1":{"loc":{"start":{"line":4,"column":35},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":42},"end":{"line":4,"column":71}},{"start":{"line":4,"column":74},"end":{"line":4,"column":80}}],"line":4},"2":{"loc":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"type":"if","locations":[{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},{"start":{},"end":{}}],"line":6},"3":{"loc":{"start":{"line":7,"column":15},"end":{"line":7,"column":84}},"type":"binary-expr","locations":[{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},{"start":{"line":7,"column":78},"end":{"line":7,"column":84}}],"line":7},"4":{"loc":{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},"type":"cond-expr","locations":[{"start":{"line":7,"column":23},"end":{"line":7,"column":53}},{"start":{"line":7,"column":56},"end":{"line":7,"column":73}}],"line":7},"5":{"loc":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},{"start":{},"end":{}}],"line":8},"6":{"loc":{"start":{"line":8,"column":6},"end":{"line":8,"column":20}},"type":"binary-expr","locations":[{"start":{"line":8,"column":6},"end":{"line":8,"column":10}},{"start":{"line":8,"column":14},"end":{"line":8,"column":20}}],"line":8},"7":{"loc":{"start":{"line":35,"column":54},"end":{"line":35,"column":77}},"type":"default-arg","locations":[{"start":{"line":35,"column":72},"end":{"line":35,"column":77}}],"line":35},"8":{"loc":{"start":{"line":44,"column":4},"end":{"line":46,"column":5}},"type":"if","locations":[{"start":{"line":44,"column":4},"end":{"line":46,"column":5}},{"start":{},"end":{}}],"line":44},"9":{"loc":{"start":{"line":47,"column":4},"end":{"line":54,"column":5}},"type":"if","locations":[{"start":{"line":47,"column":4},"end":{"line":54,"column":5}},{"start":{"line":52,"column":11},"end":{"line":54,"column":5}}],"line":47},"10":{"loc":{"start":{"line":49,"column":6},"end":{"line":51,"column":7}},"type":"if","locations":[{"start":{"line":49,"column":6},"end":{"line":51,"column":7}},{"start":{},"end":{}}],"line":49},"11":{"loc":{"start":{"line":49,"column":10},"end":{"line":49,"column":94}},"type":"binary-expr","locations":[{"start":{"line":49,"column":10},"end":{"line":49,"column":51}},{"start":{"line":49,"column":55},"end":{"line":49,"column":94}}],"line":49},"12":{"loc":{"start":{"line":52,"column":11},"end":{"line":54,"column":5}},"type":"if","locations":[{"start":{"line":52,"column":11},"end":{"line":54,"column":5}},{"start":{},"end":{}}],"line":52},"13":{"loc":{"start":{"line":55,"column":4},"end":{"line":57,"column":5}},"type":"if","locations":[{"start":{"line":55,"column":4},"end":{"line":57,"column":5}},{"start":{},"end":{}}],"line":55},"14":{"loc":{"start":{"line":58,"column":4},"end":{"line":66,"column":5}},"type":"if","locations":[{"start":{"line":58,"column":4},"end":{"line":66,"column":5}},{"start":{},"end":{}}],"line":58},"15":{"loc":{"start":{"line":59,"column":6},"end":{"line":61,"column":7}},"type":"if","locations":[{"start":{"line":59,"column":6},"end":{"line":61,"column":7}},{"start":{},"end":{}}],"line":59},"16":{"loc":{"start":{"line":63,"column":6},"end":{"line":65,"column":7}},"type":"if","locations":[{"start":{"line":63,"column":6},"end":{"line":65,"column":7}},{"start":{},"end":{}}],"line":63},"17":{"loc":{"start":{"line":68,"column":4},"end":{"line":70,"column":5}},"type":"if","locations":[{"start":{"line":68,"column":4},"end":{"line":70,"column":5}},{"start":{},"end":{}}],"line":68},"18":{"loc":{"start":{"line":68,"column":8},"end":{"line":68,"column":63}},"type":"binary-expr","locations":[{"start":{"line":68,"column":8},"end":{"line":68,"column":18}},{"start":{"line":68,"column":22},"end":{"line":68,"column":63}}],"line":68},"19":{"loc":{"start":{"line":97,"column":4},"end":{"line":104,"column":5}},"type":"if","locations":[{"start":{"line":97,"column":4},"end":{"line":104,"column":5}},{"start":{},"end":{}}],"line":97},"20":{"loc":{"start":{"line":99,"column":8},"end":{"line":99,"column":64}},"type":"if","locations":[{"start":{"line":99,"column":8},"end":{"line":99,"column":64}},{"start":{},"end":{}}],"line":99},"21":{"loc":{"start":{"line":109,"column":6},"end":{"line":112,"column":7}},"type":"if","locations":[{"start":{"line":109,"column":6},"end":{"line":112,"column":7}},{"start":{},"end":{}}],"line":109},"22":{"loc":{"start":{"line":130,"column":8},"end":{"line":132,"column":9}},"type":"if","locations":[{"start":{"line":130,"column":8},"end":{"line":132,"column":9}},{"start":{},"end":{}}],"line":130},"23":{"loc":{"start":{"line":130,"column":12},"end":{"line":130,"column":47}},"type":"binary-expr","locations":[{"start":{"line":130,"column":12},"end":{"line":130,"column":22}},{"start":{"line":130,"column":26},"end":{"line":130,"column":33}},{"start":{"line":130,"column":37},"end":{"line":130,"column":47}}],"line":130},"24":{"loc":{"start":{"line":134,"column":10},"end":{"line":249,"column":11}},"type":"switch","locations":[{"start":{"line":135,"column":12},"end":{"line":143,"column":13}},{"start":{"line":144,"column":12},"end":{"line":152,"column":13}},{"start":{"line":153,"column":12},"end":{"line":160,"column":13}},{"start":{"line":161,"column":12},"end":{"line":172,"column":13}},{"start":{"line":173,"column":12},"end":{"line":184,"column":13}},{"start":{"line":185,"column":12},"end":{"line":196,"column":13}},{"start":{"line":197,"column":12},"end":{"line":208,"column":13}},{"start":{"line":209,"column":12},"end":{"line":209,"column":60}},{"start":{"line":210,"column":12},"end":{"line":220,"column":13}},{"start":{"line":221,"column":12},"end":{"line":221,"column":62}},{"start":{"line":222,"column":12},"end":{"line":232,"column":13}},{"start":{"line":233,"column":12},"end":{"line":248,"column":13}}],"line":134},"25":{"loc":{"start":{"line":212,"column":28},"end":{"line":212,"column":103}},"type":"binary-expr","locations":[{"start":{"line":212,"column":28},"end":{"line":212,"column":47}},{"start":{"line":212,"column":51},"end":{"line":212,"column":103}}],"line":212},"26":{"loc":{"start":{"line":224,"column":28},"end":{"line":224,"column":103}},"type":"binary-expr","locations":[{"start":{"line":224,"column":28},"end":{"line":224,"column":47}},{"start":{"line":224,"column":51},"end":{"line":224,"column":103}}],"line":224},"27":{"loc":{"start":{"line":238,"column":16},"end":{"line":245,"column":17}},"type":"if","locations":[{"start":{"line":238,"column":16},"end":{"line":245,"column":17}},{"start":{},"end":{}}],"line":238},"28":{"loc":{"start":{"line":251,"column":23},"end":{"line":251,"column":47}},"type":"binary-expr","locations":[{"start":{"line":251,"column":23},"end":{"line":251,"column":41}},{"start":{"line":251,"column":45},"end":{"line":251,"column":47}}],"line":251},"29":{"loc":{"start":{"line":263,"column":37},"end":{"line":263,"column":64}},"type":"binary-expr","locations":[{"start":{"line":263,"column":37},"end":{"line":263,"column":58}},{"start":{"line":263,"column":62},"end":{"line":263,"column":64}}],"line":263},"30":{"loc":{"start":{"line":264,"column":37},"end":{"line":264,"column":64}},"type":"binary-expr","locations":[{"start":{"line":264,"column":37},"end":{"line":264,"column":58}},{"start":{"line":264,"column":62},"end":{"line":264,"column":64}}],"line":264},"31":{"loc":{"start":{"line":269,"column":25},"end":{"line":272,"column":15}},"type":"binary-expr","locations":[{"start":{"line":269,"column":25},"end":{"line":272,"column":9}},{"start":{"line":272,"column":13},"end":{"line":272,"column":15}}],"line":269},"32":{"loc":{"start":{"line":273,"column":22},"end":{"line":276,"column":15}},"type":"binary-expr","locations":[{"start":{"line":273,"column":22},"end":{"line":276,"column":9}},{"start":{"line":276,"column":13},"end":{"line":276,"column":15}}],"line":273},"33":{"loc":{"start":{"line":277,"column":25},"end":{"line":280,"column":15}},"type":"binary-expr","locations":[{"start":{"line":277,"column":25},"end":{"line":280,"column":9}},{"start":{"line":280,"column":13},"end":{"line":280,"column":15}}],"line":277},"34":{"loc":{"start":{"line":281,"column":22},"end":{"line":284,"column":15}},"type":"binary-expr","locations":[{"start":{"line":281,"column":22},"end":{"line":284,"column":9}},{"start":{"line":284,"column":13},"end":{"line":284,"column":15}}],"line":281},"35":{"loc":{"start":{"line":292,"column":4},"end":{"line":313,"column":5}},"type":"if","locations":[{"start":{"line":292,"column":4},"end":{"line":313,"column":5}},{"start":{},"end":{}}],"line":292},"36":{"loc":{"start":{"line":304,"column":21},"end":{"line":304,"column":56}},"type":"binary-expr","locations":[{"start":{"line":304,"column":21},"end":{"line":304,"column":36}},{"start":{"line":304,"column":40},"end":{"line":304,"column":56}}],"line":304},"37":{"loc":{"start":{"line":306,"column":8},"end":{"line":310,"column":9}},"type":"if","locations":[{"start":{"line":306,"column":8},"end":{"line":310,"column":9}},{"start":{},"end":{}}],"line":306},"38":{"loc":{"start":{"line":307,"column":10},"end":{"line":309,"column":12}},"type":"binary-expr","locations":[{"start":{"line":307,"column":10},"end":{"line":307,"column":16}},{"start":{"line":307,"column":20},"end":{"line":309,"column":12}}],"line":307},"39":{"loc":{"start":{"line":325,"column":19},"end":{"line":325,"column":68}},"type":"binary-expr","locations":[{"start":{"line":325,"column":19},"end":{"line":325,"column":26}},{"start":{"line":325,"column":30},"end":{"line":325,"column":68}}],"line":325},"40":{"loc":{"start":{"line":326,"column":22},"end":{"line":326,"column":77}},"type":"binary-expr","locations":[{"start":{"line":326,"column":22},"end":{"line":326,"column":32}},{"start":{"line":326,"column":36},"end":{"line":326,"column":77}}],"line":326},"41":{"loc":{"start":{"line":327,"column":4},"end":{"line":330,"column":5}},"type":"if","locations":[{"start":{"line":327,"column":4},"end":{"line":330,"column":5}},{"start":{},"end":{}}],"line":327},"42":{"loc":{"start":{"line":327,"column":8},"end":{"line":327,"column":29}},"type":"binary-expr","locations":[{"start":{"line":327,"column":8},"end":{"line":327,"column":15}},{"start":{"line":327,"column":19},"end":{"line":327,"column":29}}],"line":327},"43":{"loc":{"start":{"line":334,"column":4},"end":{"line":337,"column":5}},"type":"if","locations":[{"start":{"line":334,"column":4},"end":{"line":337,"column":5}},{"start":{},"end":{}}],"line":334},"44":{"loc":{"start":{"line":339,"column":4},"end":{"line":343,"column":5}},"type":"if","locations":[{"start":{"line":339,"column":4},"end":{"line":343,"column":5}},{"start":{"line":341,"column":11},"end":{"line":343,"column":5}}],"line":339},"45":{"loc":{"start":{"line":346,"column":6},"end":{"line":354,"column":7}},"type":"if","locations":[{"start":{"line":346,"column":6},"end":{"line":354,"column":7}},{"start":{},"end":{}}],"line":346},"46":{"loc":{"start":{"line":348,"column":8},"end":{"line":353,"column":9}},"type":"if","locations":[{"start":{"line":348,"column":8},"end":{"line":353,"column":9}},{"start":{},"end":{}}],"line":348},"47":{"loc":{"start":{"line":350,"column":10},"end":{"line":352,"column":11}},"type":"if","locations":[{"start":{"line":350,"column":10},"end":{"line":352,"column":11}},{"start":{},"end":{}}],"line":350},"48":{"loc":{"start":{"line":371,"column":9},"end":{"line":371,"column":82}},"type":"binary-expr","locations":[{"start":{"line":371,"column":9},"end":{"line":371,"column":76}},{"start":{"line":371,"column":80},"end":{"line":371,"column":82}}],"line":371},"49":{"loc":{"start":{"line":391,"column":10},"end":{"line":393,"column":11}},"type":"if","locations":[{"start":{"line":391,"column":10},"end":{"line":393,"column":11}},{"start":{},"end":{}}],"line":391},"50":{"loc":{"start":{"line":391,"column":14},"end":{"line":391,"column":40}},"type":"binary-expr","locations":[{"start":{"line":391,"column":14},"end":{"line":391,"column":26}},{"start":{"line":391,"column":30},"end":{"line":391,"column":40}}],"line":391},"51":{"loc":{"start":{"line":402,"column":6},"end":{"line":404,"column":7}},"type":"if","locations":[{"start":{"line":402,"column":6},"end":{"line":404,"column":7}},{"start":{},"end":{}}],"line":402},"52":{"loc":{"start":{"line":403,"column":29},"end":{"line":403,"column":56}},"type":"cond-expr","locations":[{"start":{"line":403,"column":41},"end":{"line":403,"column":51}},{"start":{"line":403,"column":54},"end":{"line":403,"column":56}}],"line":403}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":4,"7":4,"8":1,"9":0,"10":1,"11":1,"12":4,"13":4,"14":1,"15":1,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":1,"47":2,"48":2,"49":2,"50":2,"51":2,"52":2,"53":2,"54":4,"55":2,"56":4,"57":2,"58":2,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":2,"77":2,"78":2,"79":2,"80":2,"81":2,"82":2,"83":2,"84":0,"85":2,"86":2,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":1,"104":1,"105":1,"106":1,"107":1,"108":1,"109":1,"110":1,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":2,"128":2,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":2,"138":2,"139":2,"140":2,"141":2,"142":2,"143":2,"144":2,"145":2,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":2,"158":2,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":1,"182":2,"183":2,"184":0,"185":0,"186":2,"187":2,"188":2,"189":2,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0},"f":{"0":1,"1":4,"2":4,"3":0,"4":0,"5":0,"6":2,"7":4,"8":4,"9":0,"10":0,"11":0,"12":0,"13":2,"14":2,"15":2,"16":0,"17":0,"18":2,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":2,"26":2,"27":0,"28":0,"29":2,"30":2,"31":0,"32":0,"33":0,"34":0,"35":0},"b":{"0":[0,1],"1":[0,1],"2":[4,0],"3":[4,4],"4":[0,4],"5":[0,1],"6":[1,0],"7":[0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,2],"23":[2,2,2],"24":[0,0,0,0,0,1,1,0,0,0,0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[2,0],"29":[0,0],"30":[0,0],"31":[2,0],"32":[2,0],"33":[2,0],"34":[2,0],"35":[0,2],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0],"52":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/ref-range/ref-range.service.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IDisposable, IMutationInfo, IRange, Nullable, Workbook } from '@univerjs/core';\nimport type { IMoveRangeMutationParams } from '../../commands/mutations/move-range.mutation';\n\nimport type { ISheetCommandSharedParams } from '../../commands/utils/interface';\nimport type { EffectRefRangeParams } from './type';\nimport {\n    CommandType,\n    createInterceptorKey,\n    Disposable,\n    ICommandService,\n    Inject,\n    InterceptorManager,\n    IUniverInstanceService,\n    RANGE_TYPE,\n    Rectangle,\n    toDisposable,\n    UniverInstanceType,\n} from '@univerjs/core';\nimport { MoveRangeMutation } from '../../commands/mutations/move-range.mutation';\nimport { RemoveSheetMutation } from '../../commands/mutations/remove-sheet.mutation';\nimport { SheetsSelectionsService } from '../selections/selection.service';\nimport { SheetInterceptorService } from '../sheet-interceptor/sheet-interceptor.service';\nimport { EffectRefRangId } from './type';\nimport { adjustRangeOnMutation, getEffectedRangesOnMutation } from './util';\n\ntype RefRangCallback = (params: EffectRefRangeParams) => {\n    redos: IMutationInfo[];\n    undos: IMutationInfo[];\n    preRedos?: IMutationInfo[];\n    preUndos?: IMutationInfo[];\n};\n\nexport type WatchRangeCallback = (before: IRange, after: Nullable<IRange>) => void;\n\nconst MERGE_REDO = createInterceptorKey<IMutationInfo[], null>('MERGE_REDO');\nconst MERGE_UNDO = createInterceptorKey<IMutationInfo[], null>('MERGE_UNDO');\n\nconst MAX_ROW_COL = Math.floor(Number.MAX_SAFE_INTEGER / 10);\n\nclass WatchRange extends Disposable {\n    constructor(\n        private readonly _unitId: string,\n        private readonly _subUnitId: string,\n        private _range: Nullable<IRange>,\n        private readonly _callback: WatchRangeCallback,\n        private readonly _skipIntersects: boolean = false\n    ) {\n        super();\n    }\n\n    onMutation(mutation: IMutationInfo<ISheetCommandSharedParams>) {\n        if (mutation.params?.unitId !== this._unitId) {\n            return;\n        }\n        // move range don't have subUnitId on params\n        if (mutation.id === MoveRangeMutation.id) {\n            const params = mutation.params as unknown as IMoveRangeMutationParams;\n            if (params.from.subUnitId !== this._subUnitId || params.to.subUnitId !== this._subUnitId) {\n                return;\n            }\n        } else if (mutation.params?.subUnitId !== this._subUnitId) {\n            return;\n        }\n\n        if (!this._range) {\n            return;\n        }\n\n        if (this._skipIntersects) {\n            if (mutation.id === RemoveSheetMutation.id) {\n                return;\n            }\n            const effectRanges = getEffectedRangesOnMutation(mutation);\n            if (effectRanges?.some((effectRange) => Rectangle.intersects(effectRange, this._range!))) {\n                return;\n            }\n        }\n\n        const afterRange: Nullable<IRange> = adjustRangeOnMutation(this._range, mutation);\n        if (afterRange && Rectangle.equals(afterRange, this._range)) {\n            return false;\n        }\n\n        const beforeChange = this._range;\n        this._range = afterRange;\n        this._callback(beforeChange, afterRange);\n    }\n}\n\n/**\n * Collect side effects caused by ref range change\n */\nexport class RefRangeService extends Disposable {\n    interceptor = new InterceptorManager({ MERGE_REDO, MERGE_UNDO });\n\n    private _watchRanges = new Set<WatchRange>();\n\n    constructor(\n        @ICommandService private readonly _commandService: ICommandService,\n        @Inject(SheetInterceptorService) private _sheetInterceptorService: SheetInterceptorService,\n        @Inject(IUniverInstanceService) private _univerInstanceService: IUniverInstanceService,\n        @Inject(SheetsSelectionsService) private _selectionManagerService: SheetsSelectionsService\n    ) {\n        super();\n        this._onRefRangeChange();\n        this.interceptor.intercept(this.interceptor.getInterceptPoints().MERGE_REDO, {\n            priority: -1,\n            handler: (list) => list,\n        });\n        this.interceptor.intercept(this.interceptor.getInterceptPoints().MERGE_UNDO, {\n            priority: -1,\n            handler: (list) => list,\n        });\n    }\n\n    watchRange(unitId: string, subUnitId: string, range: IRange, callback: WatchRangeCallback, skipIntersects?: boolean): IDisposable {\n        let watchRangesListener: Nullable<IDisposable>;\n        if (this._watchRanges.size === 0) {\n            watchRangesListener = this._commandService.onCommandExecuted((command) => {\n                if (command.type !== CommandType.MUTATION) return false;\n                for (const watchRange of this._watchRanges) {\n                    watchRange.onMutation(command as IMutationInfo<ISheetCommandSharedParams>);\n                }\n            });\n        }\n\n        const watchRange = new WatchRange(unitId, subUnitId, range, callback, skipIntersects);\n        this._watchRanges.add(watchRange);\n\n        const teardownWatching = toDisposable(() => {\n            this._watchRanges.delete(watchRange);\n\n            if (this._watchRanges.size === 0) {\n                watchRangesListener?.dispose();\n                watchRangesListener = null;\n            }\n        });\n\n        const registerToService = this.disposeWithMe(teardownWatching);\n\n        return toDisposable(() => {\n            registerToService.dispose();\n            teardownWatching.dispose();\n        });\n    }\n\n    private _refRangeManagerMap = new Map<string, Map<string, Set<RefRangCallback>>>();\n\n    private _serializer = createRangeSerializer();\n\n    // eslint-disable-next-line max-lines-per-function\n    private _onRefRangeChange = () => {\n        this._sheetInterceptorService.interceptCommand({\n            // eslint-disable-next-line max-lines-per-function\n            getMutations: (command: EffectRefRangeParams) => {\n                const worksheet = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!.getActiveSheet();\n                const unitId = getUnitId(this._univerInstanceService);\n                const subUnitId = getSubUnitId(this._univerInstanceService);\n                if (!worksheet || !unitId || !subUnitId) {\n                    return { redos: [], undos: [], preRedos: [], preUndos: [] };\n                }\n                // eslint-disable-next-line max-lines-per-function\n                const getEffectsCbList = () => {\n                    switch (command.id) {\n                        case EffectRefRangId.MoveColsCommandId: {\n                            const params = command.params!;\n                            const startColumn = Math.min(params.fromRange.startColumn, params.toRange.startColumn);\n                            return this._checkRange(\n                                [{ ...params.fromRange, startColumn, endColumn: worksheet.getColumnCount() - 1 }],\n                                unitId,\n                                subUnitId\n                            );\n                        }\n                        case EffectRefRangId.MoveRowsCommandId: {\n                            const params = command.params!;\n                            const startRow = Math.min(params.fromRange.startRow, params.toRange.startRow);\n\n                            return this._checkRange(\n                                [{ ...params.fromRange, startRow, endRow: worksheet.getRowCount() - 1 }],\n                                unitId,\n                                subUnitId\n                            );\n                        }\n                        case EffectRefRangId.MoveRangeCommandId: {\n                            const params = command;\n                            return this._checkRange(\n                                [params.params!.fromRange, params.params!.toRange],\n                                unitId,\n                                subUnitId\n                            );\n                        }\n                        case EffectRefRangId.InsertRowCommandId: {\n                            const params = command;\n                            const rowStart = params.params!.range.startRow;\n                            const range: IRange = {\n                                startRow: rowStart,\n                                endRow: worksheet.getRowCount() - 1,\n                                startColumn: 0,\n                                endColumn: worksheet.getColumnCount() - 1,\n                                rangeType: RANGE_TYPE.ROW,\n                            };\n                            return this._checkRange([range], unitId, subUnitId);\n                        }\n                        case EffectRefRangId.InsertColCommandId: {\n                            const params = command;\n                            const colStart = params.params!.range.startColumn;\n                            const range: IRange = {\n                                startRow: 0,\n                                endRow: worksheet.getRowCount() - 1,\n                                startColumn: colStart,\n                                endColumn: worksheet.getColumnCount() - 1,\n                                rangeType: RANGE_TYPE.COLUMN,\n                            };\n                            return this._checkRange([range], unitId, subUnitId);\n                        }\n                        case EffectRefRangId.RemoveRowCommandId: {\n                            const params = command;\n\n                            const rowStart = params.params!.range.startRow;\n                            const range: IRange = {\n                                startRow: rowStart,\n                                endRow: worksheet.getRowCount() - 1,\n                                startColumn: 0,\n                                endColumn: worksheet.getColumnCount() - 1,\n                                rangeType: RANGE_TYPE.ROW,\n                            };\n                            return this._checkRange([range], unitId, subUnitId);\n                        }\n                        case EffectRefRangId.RemoveColCommandId: {\n                            const params = command;\n                            const colStart = params.params!.range.startColumn;\n                            const range: IRange = {\n                                startRow: 0,\n                                endRow: worksheet.getRowCount() - 1,\n                                startColumn: colStart,\n                                endColumn: worksheet.getColumnCount() - 1,\n                                rangeType: RANGE_TYPE.COLUMN,\n                            };\n                            return this._checkRange([range], unitId, subUnitId);\n                        }\n                        case EffectRefRangId.DeleteRangeMoveUpCommandId:\n                        case EffectRefRangId.InsertRangeMoveDownCommandId: {\n                            const params = command;\n                            const range = params.params!.range || getSelectionRanges(this._selectionManagerService)[0];\n                            const effectRange = {\n                                startRow: range.startRow,\n                                startColumn: range.startColumn,\n                                endColumn: range.endColumn,\n                                endRow: MAX_ROW_COL,\n                            };\n                            return this._checkRange([effectRange], unitId, subUnitId);\n                        }\n                        case EffectRefRangId.DeleteRangeMoveLeftCommandId:\n                        case EffectRefRangId.InsertRangeMoveRightCommandId: {\n                            const params = command;\n                            const range = params.params!.range || getSelectionRanges(this._selectionManagerService)[0];\n                            const effectRange = {\n                                startRow: range.startRow,\n                                startColumn: range.startColumn,\n                                endColumn: MAX_ROW_COL,\n                                endRow: range.endRow,\n                            };\n                            return this._checkRange([effectRange], unitId, subUnitId);\n                        }\n                        case EffectRefRangId.ReorderRangeCommandId: {\n                            const params = command;\n                            const { range, order } = params.params!;\n                            const effectRanges = [];\n                            for (let row = range.startRow; row <= range.endRow; row++) {\n                                if (row in order) {\n                                    effectRanges.push({\n                                        startRow: row,\n                                        endRow: row,\n                                        startColumn: range.startColumn,\n                                        endColumn: range.endColumn,\n                                    });\n                                }\n                            }\n                            return this._checkRange(effectRanges, unitId, subUnitId);\n                        }\n                    }\n                };\n                const cbList = getEffectsCbList() || [];\n                const result = cbList\n                    .reduce(\n                        (result, currentFn) => {\n                            const v = currentFn(command);\n                            result.push(v);\n                            return result;\n                        },\n                        [] as Array<{ redos: IMutationInfo[]; undos: IMutationInfo[]; preUndos?: IMutationInfo[]; preRedos?: IMutationInfo[] }>\n                    )\n                    .reduce(\n                        (result, currentValue) => {\n                            result.redos.push(...currentValue.redos);\n                            result.undos.push(...currentValue.undos);\n                            result.preRedos!.push(...(currentValue.preRedos ?? []));\n                            result.preUndos!.push(...(currentValue.preUndos ?? []));\n                            return result;\n                        },\n                        { redos: [], undos: [], preUndos: [], preRedos: [] }\n                    );\n\n                const preRedos = this.interceptor.fetchThroughInterceptors(this.interceptor.getInterceptPoints().MERGE_REDO)(\n                    result.preRedos,\n                    null\n                ) || [];\n\n                const redos =\n                    this.interceptor.fetchThroughInterceptors(this.interceptor.getInterceptPoints().MERGE_REDO)(\n                        result.redos,\n                        null\n                    ) || [];\n\n                const preUndos = this.interceptor.fetchThroughInterceptors(this.interceptor.getInterceptPoints().MERGE_UNDO)(\n                    result.preUndos,\n                    null\n                ) || [];\n\n                const undos =\n                    this.interceptor.fetchThroughInterceptors(this.interceptor.getInterceptPoints().MERGE_UNDO)(\n                        result.undos,\n                        null\n                    ) || [];\n\n                return { redos, undos, preRedos, preUndos };\n            },\n        });\n    };\n\n    private _checkRange = (effectRanges: IRange[], unitId: string, subUnitId: string) => {\n        const managerId = getRefRangId(unitId, subUnitId);\n        const manager = this._refRangeManagerMap.get(managerId);\n        if (manager) {\n            const callbackSet = new Set<RefRangCallback>();\n            // this keyList will to prevent an endless cycle \n            const keyList = [...manager.keys()];\n\n            keyList.forEach((key) => {\n                const cbList = manager.get(key);\n\n                const range = this._serializer.deserialize(key);\n                const realRange: IRange = {\n                    ...range,\n                    startRow: +range.startRow,\n                    endRow: +range.endRow,\n                    startColumn: +range.startColumn,\n                    endColumn: +range.endColumn,\n                    rangeType: range.rangeType && +range.rangeType,\n                };\n                // Todo@Gggpound : How to reduce this calculation\n                if (\n                    effectRanges.some((item) => Rectangle.intersects(item, realRange))\n                ) {\n                    cbList &&\n                        cbList.forEach((callback) => {\n                            callbackSet.add(callback);\n                        });\n                }\n            });\n            return [...callbackSet];\n        }\n        return [];\n    };\n\n    /**\n     * Listens to an area and triggers a fall back when movement occurs\n     * @param {IRange} range the area that needs to be monitored\n     * @param {RefRangCallback} callback the callback function that is executed when the range changes\n     * @param {string} [_unitId]\n     * @param {string} [_subUnitId]\n     * @memberof RefRangeService\n     */\n    registerRefRange = (\n        range: IRange,\n        callback: RefRangCallback,\n        _unitId?: string,\n        _subUnitId?: string\n    ): IDisposable => {\n        const unitId = _unitId || getUnitId(this._univerInstanceService);\n        const subUnitId = _subUnitId || getSubUnitId(this._univerInstanceService);\n        if (!unitId || !subUnitId) {\n            return toDisposable(() => {});\n        }\n\n        const refRangeManagerId = getRefRangId(unitId, subUnitId);\n        const rangeString = this._serializer.serialize(range);\n\n        let manager = this._refRangeManagerMap.get(refRangeManagerId) as Map<string, Set<RefRangCallback>>;\n        if (!manager) {\n            manager = new Map();\n            this._refRangeManagerMap.set(refRangeManagerId, manager);\n        }\n        const refRangeCallbackList = manager.get(rangeString);\n\n        if (refRangeCallbackList) {\n            refRangeCallbackList.add(callback);\n        } else {\n            manager.set(rangeString, new Set([callback]));\n        }\n        return toDisposable(() => {\n            const refRangeCallbackList = manager.get(rangeString);\n            if (refRangeCallbackList) {\n                refRangeCallbackList.delete(callback);\n                if (!refRangeCallbackList.size) {\n                    manager.delete(rangeString);\n                    if (!manager.size) {\n                        this._refRangeManagerMap.delete(refRangeManagerId);\n                    }\n                }\n            }\n        });\n    };\n}\n\nfunction getUnitId(univerInstanceService: IUniverInstanceService) {\n    return univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!.getUnitId();\n}\n\nfunction getSubUnitId(univerInstanceService: IUniverInstanceService) {\n    return univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!.getActiveSheet()?.getSheetId();\n}\n\nfunction getSelectionRanges(selectionManagerService: SheetsSelectionsService) {\n    return selectionManagerService.getCurrentSelections()?.map((s) => s.range) || [];\n}\n\nfunction getRefRangId(unitId: string, subUnitId: string) {\n    return `${unitId}_${subUnitId}`;\n}\n\nfunction createRangeSerializer() {\n    const keyList = ['startRow', 'startColumn', 'endRow', 'endColumn', 'rangeType'];\n    const SPLIT_CODE = '_';\n    return {\n        deserialize: (rangeString: string) => {\n            const map = keyList.reduce(\n                (preValue, currentValue, index) => {\n                    preValue[String(index)] = currentValue;\n                    return preValue;\n                },\n                {} as Record<string, string>\n            );\n            const res = rangeString.split(SPLIT_CODE).reduce(\n                (preValue, currentValue, _index) => {\n                    const index = String(_index) as keyof typeof map;\n                    if (currentValue && map[index]) {\n                        preValue[map[index]] = currentValue;\n                    }\n                    return preValue;\n                },\n                {} as Record<string, string>\n            );\n            return res as unknown as IRange;\n        },\n        serialize: (range: IRange) =>\n            keyList.reduce((preValue, currentValue, index) => {\n                const value = range[currentValue as keyof IRange];\n                if (value !== undefined) {\n                    return `${preValue}${index > 0 ? SPLIT_CODE : ''}${value}`;\n                }\n                return `${preValue}`;\n            }, ''),\n    };\n}\n"],"mappings":"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","names":["watchRange","result","refRangeCallbackList"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"842167a4233bacd6a74202f6170e1f7b07c26108"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/controllers/merge-cell.controller.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/controllers/merge-cell.controller.ts","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":37}},"1":{"start":{"line":2,"column":23},"end":{"line":2,"column":54}},"2":{"start":{"line":3,"column":22},"end":{"line":10,"column":1}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"4":{"start":{"line":5,"column":2},"end":{"line":7,"column":85}},"5":{"start":{"line":5,"column":15},"end":{"line":5,"column":36}},"6":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"7":{"start":{"line":7,"column":6},"end":{"line":7,"column":85}},"8":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"9":{"start":{"line":8,"column":22},"end":{"line":8,"column":53}},"10":{"start":{"line":9,"column":2},"end":{"line":9,"column":16}},"11":{"start":{"line":11,"column":22},"end":{"line":11,"column":90}},"12":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"13":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"14":{"start":{"line":54,"column":27},"end":{"line":54,"column":115}},"15":{"start":{"line":55,"column":28},"end":{"line":55,"column":70}},"16":{"start":{"line":57,"column":15},"end":{"line":57,"column":24}},"17":{"start":{"line":58,"column":2},"end":{"line":85,"column":3}},"18":{"start":{"line":59,"column":23},"end":{"line":59,"column":25}},"19":{"start":{"line":60,"column":4},"end":{"line":83,"column":5}},"20":{"start":{"line":60,"column":17},"end":{"line":60,"column":18}},"21":{"start":{"line":61,"column":59},"end":{"line":61,"column":68}},"22":{"start":{"line":62,"column":6},"end":{"line":82,"column":7}},"23":{"start":{"line":63,"column":8},"end":{"line":71,"column":9}},"24":{"start":{"line":63,"column":21},"end":{"line":63,"column":29}},"25":{"start":{"line":64,"column":23},"end":{"line":69,"column":11}},"26":{"start":{"line":70,"column":10},"end":{"line":70,"column":32}},"27":{"start":{"line":72,"column":13},"end":{"line":82,"column":7}},"28":{"start":{"line":73,"column":8},"end":{"line":81,"column":9}},"29":{"start":{"line":73,"column":21},"end":{"line":73,"column":32}},"30":{"start":{"line":74,"column":23},"end":{"line":79,"column":11}},"31":{"start":{"line":80,"column":10},"end":{"line":80,"column":32}},"32":{"start":{"line":84,"column":4},"end":{"line":84,"column":24}},"33":{"start":{"line":86,"column":2},"end":{"line":86,"column":16}},"34":{"start":{"line":88,"column":44},"end":{"line":88,"column":92}},"35":{"start":{"line":89,"column":33},"end":{"line":1087,"column":1}},"36":{"start":{"line":91,"column":4},"end":{"line":91,"column":12}},"37":{"start":{"line":92,"column":4},"end":{"line":92,"column":43}},"38":{"start":{"line":93,"column":4},"end":{"line":93,"column":45}},"39":{"start":{"line":94,"column":4},"end":{"line":94,"column":57}},"40":{"start":{"line":95,"column":4},"end":{"line":95,"column":31}},"41":{"start":{"line":96,"column":4},"end":{"line":96,"column":61}},"42":{"start":{"line":97,"column":4},"end":{"line":97,"column":61}},"43":{"start":{"line":98,"column":4},"end":{"line":98,"column":29}},"44":{"start":{"line":99,"column":4},"end":{"line":99,"column":35}},"45":{"start":{"line":100,"column":4},"end":{"line":100,"column":36}},"46":{"start":{"line":102,"column":25},"end":{"line":102,"column":51}},"47":{"start":{"line":103,"column":16},"end":{"line":103,"column":72}},"48":{"start":{"line":105,"column":17},"end":{"line":105,"column":21}},"49":{"start":{"line":106,"column":4},"end":{"line":144,"column":7}},"50":{"start":{"line":108,"column":8},"end":{"line":141,"column":9}},"51":{"start":{"line":111,"column":29},"end":{"line":111,"column":111}},"52":{"start":{"line":112,"column":27},"end":{"line":112,"column":47}},"53":{"start":{"line":113,"column":30},"end":{"line":113,"column":56}},"54":{"start":{"line":114,"column":12},"end":{"line":116,"column":13}},"55":{"start":{"line":115,"column":14},"end":{"line":115,"column":46}},"56":{"start":{"line":117,"column":30},"end":{"line":117,"column":52}},"57":{"start":{"line":118,"column":30},"end":{"line":118,"column":61}},"58":{"start":{"line":119,"column":31},"end":{"line":119,"column":104}},"59":{"start":{"line":119,"column":96},"end":{"line":119,"column":103}},"60":{"start":{"line":120,"column":12},"end":{"line":139,"column":13}},"61":{"start":{"line":121,"column":33},"end":{"line":123,"column":15}},"62":{"start":{"line":122,"column":27},"end":{"line":122,"column":86}},"63":{"start":{"line":122,"column":52},"end":{"line":122,"column":85}},"64":{"start":{"line":124,"column":14},"end":{"line":138,"column":15}},"65":{"start":{"line":125,"column":42},"end":{"line":129,"column":17}},"66":{"start":{"line":130,"column":46},"end":{"line":130,"column":111}},"67":{"start":{"line":131,"column":30},"end":{"line":133,"column":17}},"68":{"start":{"line":134,"column":30},"end":{"line":136,"column":17}},"69":{"start":{"line":137,"column":16},"end":{"line":137,"column":40}},"70":{"start":{"line":142,"column":8},"end":{"line":142,"column":40}},"71":{"start":{"line":145,"column":4},"end":{"line":181,"column":7}},"72":{"start":{"line":147,"column":22},"end":{"line":147,"column":24}},"73":{"start":{"line":148,"column":22},"end":{"line":148,"column":24}},"74":{"start":{"line":149,"column":36},"end":{"line":149,"column":52}},"75":{"start":{"line":150,"column":8},"end":{"line":152,"column":9}},"76":{"start":{"line":151,"column":10},"end":{"line":151,"column":37}},"77":{"start":{"line":153,"column":23},"end":{"line":153,"column":96}},"78":{"start":{"line":154,"column":8},"end":{"line":156,"column":9}},"79":{"start":{"line":155,"column":10},"end":{"line":155,"column":37}},"80":{"start":{"line":157,"column":30},"end":{"line":157,"column":36}},"81":{"start":{"line":158,"column":26},"end":{"line":158,"column":50}},"82":{"start":{"line":159,"column":30},"end":{"line":159,"column":115}},"83":{"start":{"line":159,"column":57},"end":{"line":159,"column":114}},"84":{"start":{"line":159,"column":80},"end":{"line":159,"column":113}},"85":{"start":{"line":160,"column":8},"end":{"line":178,"column":9}},"86":{"start":{"line":161,"column":10},"end":{"line":168,"column":13}},"87":{"start":{"line":169,"column":10},"end":{"line":176,"column":13}},"88":{"start":{"line":177,"column":10},"end":{"line":177,"column":34}},"89":{"start":{"line":179,"column":8},"end":{"line":179,"column":35}},"90":{"start":{"line":184,"column":4},"end":{"line":233,"column":5}},"91":{"start":{"line":186,"column":23},"end":{"line":186,"column":36}},"92":{"start":{"line":187,"column":8},"end":{"line":187,"column":70}},"93":{"start":{"line":190,"column":23},"end":{"line":190,"column":36}},"94":{"start":{"line":191,"column":8},"end":{"line":191,"column":70}},"95":{"start":{"line":194,"column":23},"end":{"line":194,"column":36}},"96":{"start":{"line":195,"column":24},"end":{"line":195,"column":47}},"97":{"start":{"line":196,"column":27},"end":{"line":196,"column":56}},"98":{"start":{"line":197,"column":8},"end":{"line":197,"column":73}},"99":{"start":{"line":200,"column":23},"end":{"line":200,"column":36}},"100":{"start":{"line":201,"column":24},"end":{"line":201,"column":47}},"101":{"start":{"line":202,"column":27},"end":{"line":202,"column":56}},"102":{"start":{"line":203,"column":8},"end":{"line":203,"column":73}},"103":{"start":{"line":206,"column":23},"end":{"line":206,"column":36}},"104":{"start":{"line":207,"column":8},"end":{"line":207,"column":71}},"105":{"start":{"line":210,"column":23},"end":{"line":210,"column":36}},"106":{"start":{"line":211,"column":8},"end":{"line":211,"column":71}},"107":{"start":{"line":214,"column":23},"end":{"line":214,"column":36}},"108":{"start":{"line":215,"column":8},"end":{"line":215,"column":71}},"109":{"start":{"line":218,"column":23},"end":{"line":218,"column":36}},"110":{"start":{"line":219,"column":8},"end":{"line":219,"column":82}},"111":{"start":{"line":222,"column":23},"end":{"line":222,"column":36}},"112":{"start":{"line":223,"column":8},"end":{"line":223,"column":81}},"113":{"start":{"line":226,"column":23},"end":{"line":226,"column":36}},"114":{"start":{"line":227,"column":8},"end":{"line":227,"column":79}},"115":{"start":{"line":230,"column":23},"end":{"line":230,"column":36}},"116":{"start":{"line":231,"column":8},"end":{"line":231,"column":81}},"117":{"start":{"line":234,"column":4},"end":{"line":234,"column":36}},"118":{"start":{"line":237,"column":29},"end":{"line":254,"column":5}},"119":{"start":{"line":238,"column":23},"end":{"line":238,"column":81}},"120":{"start":{"line":239,"column":6},"end":{"line":241,"column":7}},"121":{"start":{"line":240,"column":8},"end":{"line":240,"column":15}},"122":{"start":{"line":242,"column":24},"end":{"line":242,"column":62}},"123":{"start":{"line":243,"column":6},"end":{"line":245,"column":7}},"124":{"start":{"line":244,"column":8},"end":{"line":244,"column":15}},"125":{"start":{"line":246,"column":6},"end":{"line":246,"column":42}},"126":{"start":{"line":247,"column":24},"end":{"line":247,"column":48}},"127":{"start":{"line":248,"column":22},"end":{"line":250,"column":7}},"128":{"start":{"line":249,"column":8},"end":{"line":249,"column":62}},"129":{"start":{"line":251,"column":6},"end":{"line":253,"column":9}},"130":{"start":{"line":252,"column":8},"end":{"line":252,"column":113}},"131":{"start":{"line":255,"column":4},"end":{"line":276,"column":6}},"132":{"start":{"line":257,"column":8},"end":{"line":265,"column":9}},"133":{"start":{"line":258,"column":25},"end":{"line":258,"column":43}},"134":{"start":{"line":259,"column":26},"end":{"line":259,"column":42}},"135":{"start":{"line":260,"column":25},"end":{"line":260,"column":38}},"136":{"start":{"line":261,"column":10},"end":{"line":263,"column":11}},"137":{"start":{"line":262,"column":12},"end":{"line":262,"column":19}},"138":{"start":{"line":264,"column":10},"end":{"line":264,"column":44}},"139":{"start":{"line":266,"column":8},"end":{"line":274,"column":9}},"140":{"start":{"line":267,"column":25},"end":{"line":267,"column":43}},"141":{"start":{"line":268,"column":26},"end":{"line":268,"column":42}},"142":{"start":{"line":269,"column":25},"end":{"line":269,"column":38}},"143":{"start":{"line":270,"column":10},"end":{"line":272,"column":11}},"144":{"start":{"line":271,"column":12},"end":{"line":271,"column":19}},"145":{"start":{"line":273,"column":10},"end":{"line":273,"column":60}},"146":{"start":{"line":277,"column":4},"end":{"line":281,"column":7}},"147":{"start":{"line":277,"column":112},"end":{"line":277,"column":122}},"148":{"start":{"line":278,"column":20},"end":{"line":278,"column":45}},"149":{"start":{"line":279,"column":6},"end":{"line":279,"column":25}},"150":{"start":{"line":279,"column":18},"end":{"line":279,"column":25}},"151":{"start":{"line":280,"column":6},"end":{"line":280,"column":65}},"152":{"start":{"line":284,"column":21},"end":{"line":284,"column":69}},"153":{"start":{"line":285,"column":4},"end":{"line":287,"column":5}},"154":{"start":{"line":286,"column":6},"end":{"line":286,"column":32}},"155":{"start":{"line":288,"column":22},"end":{"line":288,"column":55}},"156":{"start":{"line":289,"column":4},"end":{"line":291,"column":5}},"157":{"start":{"line":290,"column":6},"end":{"line":290,"column":32}},"158":{"start":{"line":292,"column":22},"end":{"line":292,"column":51}},"159":{"start":{"line":293,"column":25},"end":{"line":293,"column":58}},"160":{"start":{"line":294,"column":22},"end":{"line":294,"column":55}},"161":{"start":{"line":295,"column":26},"end":{"line":295,"column":32}},"162":{"start":{"line":296,"column":57},"end":{"line":296,"column":66}},"163":{"start":{"line":297,"column":4},"end":{"line":304,"column":7}},"164":{"start":{"line":298,"column":6},"end":{"line":303,"column":7}},"165":{"start":{"line":299,"column":8},"end":{"line":299,"column":40}},"166":{"start":{"line":300,"column":26},"end":{"line":300,"column":98}},"167":{"start":{"line":301,"column":23},"end":{"line":301,"column":61}},"168":{"start":{"line":302,"column":8},"end":{"line":302,"column":48}},"169":{"start":{"line":305,"column":4},"end":{"line":307,"column":5}},"170":{"start":{"line":306,"column":6},"end":{"line":306,"column":32}},"171":{"start":{"line":308,"column":23},"end":{"line":308,"column":83}},"172":{"start":{"line":309,"column":20},"end":{"line":309,"column":74}},"173":{"start":{"line":310,"column":4},"end":{"line":315,"column":6}},"174":{"start":{"line":318,"column":21},"end":{"line":318,"column":69}},"175":{"start":{"line":319,"column":4},"end":{"line":321,"column":5}},"176":{"start":{"line":320,"column":6},"end":{"line":320,"column":32}},"177":{"start":{"line":322,"column":22},"end":{"line":322,"column":55}},"178":{"start":{"line":323,"column":4},"end":{"line":325,"column":5}},"179":{"start":{"line":324,"column":6},"end":{"line":324,"column":32}},"180":{"start":{"line":326,"column":22},"end":{"line":326,"column":51}},"181":{"start":{"line":327,"column":25},"end":{"line":327,"column":58}},"182":{"start":{"line":328,"column":22},"end":{"line":328,"column":55}},"183":{"start":{"line":329,"column":26},"end":{"line":329,"column":32}},"184":{"start":{"line":330,"column":63},"end":{"line":330,"column":72}},"185":{"start":{"line":331,"column":4},"end":{"line":338,"column":7}},"186":{"start":{"line":332,"column":6},"end":{"line":337,"column":7}},"187":{"start":{"line":333,"column":8},"end":{"line":333,"column":40}},"188":{"start":{"line":334,"column":26},"end":{"line":334,"column":98}},"189":{"start":{"line":335,"column":23},"end":{"line":335,"column":61}},"190":{"start":{"line":336,"column":8},"end":{"line":336,"column":48}},"191":{"start":{"line":339,"column":4},"end":{"line":341,"column":5}},"192":{"start":{"line":340,"column":6},"end":{"line":340,"column":32}},"193":{"start":{"line":342,"column":23},"end":{"line":342,"column":83}},"194":{"start":{"line":343,"column":20},"end":{"line":343,"column":74}},"195":{"start":{"line":344,"column":4},"end":{"line":349,"column":6}},"196":{"start":{"line":352,"column":21},"end":{"line":352,"column":69}},"197":{"start":{"line":353,"column":4},"end":{"line":355,"column":5}},"198":{"start":{"line":354,"column":6},"end":{"line":354,"column":32}},"199":{"start":{"line":356,"column":22},"end":{"line":356,"column":55}},"200":{"start":{"line":357,"column":4},"end":{"line":359,"column":5}},"201":{"start":{"line":358,"column":6},"end":{"line":358,"column":32}},"202":{"start":{"line":360,"column":22},"end":{"line":360,"column":46}},"203":{"start":{"line":361,"column":28},"end":{"line":361,"column":100}},"204":{"start":{"line":361,"column":55},"end":{"line":361,"column":99}},"205":{"start":{"line":362,"column":26},"end":{"line":362,"column":96}},"206":{"start":{"line":362,"column":53},"end":{"line":362,"column":95}},"207":{"start":{"line":363,"column":34},"end":{"line":363,"column":209}},"208":{"start":{"line":363,"column":70},"end":{"line":363,"column":126}},"209":{"start":{"line":363,"column":151},"end":{"line":363,"column":208}},"210":{"start":{"line":364,"column":31},"end":{"line":366,"column":5}},"211":{"start":{"line":365,"column":17},"end":{"line":365,"column":85}},"212":{"start":{"line":365,"column":49},"end":{"line":365,"column":84}},"213":{"start":{"line":367,"column":18},"end":{"line":392,"column":5}},"214":{"start":{"line":393,"column":18},"end":{"line":418,"column":5}},"215":{"start":{"line":419,"column":4},"end":{"line":419,"column":28}},"216":{"start":{"line":422,"column":21},"end":{"line":422,"column":69}},"217":{"start":{"line":423,"column":4},"end":{"line":425,"column":5}},"218":{"start":{"line":424,"column":6},"end":{"line":424,"column":32}},"219":{"start":{"line":426,"column":22},"end":{"line":426,"column":55}},"220":{"start":{"line":427,"column":4},"end":{"line":429,"column":5}},"221":{"start":{"line":428,"column":6},"end":{"line":428,"column":32}},"222":{"start":{"line":430,"column":22},"end":{"line":430,"column":28}},"223":{"start":{"line":431,"column":33},"end":{"line":431,"column":38}},"224":{"start":{"line":432,"column":26},"end":{"line":437,"column":10}},"225":{"start":{"line":433,"column":6},"end":{"line":435,"column":7}},"226":{"start":{"line":434,"column":8},"end":{"line":434,"column":40}},"227":{"start":{"line":436,"column":6},"end":{"line":436,"column":34}},"228":{"start":{"line":438,"column":4},"end":{"line":440,"column":5}},"229":{"start":{"line":439,"column":6},"end":{"line":439,"column":32}},"230":{"start":{"line":441,"column":26},"end":{"line":450,"column":10}},"231":{"start":{"line":442,"column":6},"end":{"line":448,"column":7}},"232":{"start":{"line":443,"column":22},"end":{"line":443,"column":43}},"233":{"start":{"line":444,"column":8},"end":{"line":444,"column":29}},"234":{"start":{"line":445,"column":8},"end":{"line":447,"column":9}},"235":{"start":{"line":446,"column":10},"end":{"line":446,"column":42}},"236":{"start":{"line":449,"column":6},"end":{"line":449,"column":34}},"237":{"start":{"line":451,"column":30},"end":{"line":455,"column":5}},"238":{"start":{"line":456,"column":34},"end":{"line":459,"column":5}},"239":{"start":{"line":460,"column":27},"end":{"line":464,"column":5}},"240":{"start":{"line":465,"column":31},"end":{"line":468,"column":5}},"241":{"start":{"line":469,"column":18},"end":{"line":472,"column":5}},"242":{"start":{"line":473,"column":18},"end":{"line":476,"column":5}},"243":{"start":{"line":477,"column":4},"end":{"line":477,"column":28}},"244":{"start":{"line":480,"column":22},"end":{"line":480,"column":28}},"245":{"start":{"line":481,"column":21},"end":{"line":481,"column":69}},"246":{"start":{"line":482,"column":4},"end":{"line":484,"column":5}},"247":{"start":{"line":483,"column":6},"end":{"line":483,"column":32}},"248":{"start":{"line":485,"column":22},"end":{"line":485,"column":55}},"249":{"start":{"line":486,"column":4},"end":{"line":488,"column":5}},"250":{"start":{"line":487,"column":6},"end":{"line":487,"column":32}},"251":{"start":{"line":489,"column":39},"end":{"line":489,"column":44}},"252":{"start":{"line":490,"column":26},"end":{"line":495,"column":10}},"253":{"start":{"line":491,"column":6},"end":{"line":493,"column":7}},"254":{"start":{"line":492,"column":8},"end":{"line":492,"column":40}},"255":{"start":{"line":494,"column":6},"end":{"line":494,"column":34}},"256":{"start":{"line":496,"column":4},"end":{"line":498,"column":5}},"257":{"start":{"line":497,"column":6},"end":{"line":497,"column":32}},"258":{"start":{"line":499,"column":26},"end":{"line":508,"column":10}},"259":{"start":{"line":500,"column":6},"end":{"line":506,"column":7}},"260":{"start":{"line":501,"column":22},"end":{"line":501,"column":49}},"261":{"start":{"line":502,"column":8},"end":{"line":502,"column":32}},"262":{"start":{"line":503,"column":8},"end":{"line":505,"column":9}},"263":{"start":{"line":504,"column":10},"end":{"line":504,"column":42}},"264":{"start":{"line":507,"column":6},"end":{"line":507,"column":34}},"265":{"start":{"line":509,"column":30},"end":{"line":513,"column":5}},"266":{"start":{"line":514,"column":34},"end":{"line":517,"column":5}},"267":{"start":{"line":518,"column":27},"end":{"line":522,"column":5}},"268":{"start":{"line":523,"column":31},"end":{"line":526,"column":5}},"269":{"start":{"line":527,"column":18},"end":{"line":530,"column":5}},"270":{"start":{"line":531,"column":18},"end":{"line":534,"column":5}},"271":{"start":{"line":535,"column":4},"end":{"line":535,"column":28}},"272":{"start":{"line":538,"column":21},"end":{"line":538,"column":69}},"273":{"start":{"line":539,"column":4},"end":{"line":541,"column":5}},"274":{"start":{"line":540,"column":6},"end":{"line":540,"column":32}},"275":{"start":{"line":542,"column":22},"end":{"line":542,"column":55}},"276":{"start":{"line":543,"column":4},"end":{"line":545,"column":5}},"277":{"start":{"line":544,"column":6},"end":{"line":544,"column":32}},"278":{"start":{"line":546,"column":22},"end":{"line":546,"column":28}},"279":{"start":{"line":547,"column":39},"end":{"line":547,"column":44}},"280":{"start":{"line":548,"column":26},"end":{"line":553,"column":10}},"281":{"start":{"line":549,"column":6},"end":{"line":551,"column":7}},"282":{"start":{"line":550,"column":8},"end":{"line":550,"column":40}},"283":{"start":{"line":552,"column":6},"end":{"line":552,"column":34}},"284":{"start":{"line":554,"column":4},"end":{"line":556,"column":5}},"285":{"start":{"line":555,"column":6},"end":{"line":555,"column":32}},"286":{"start":{"line":557,"column":26},"end":{"line":574,"column":10}},"287":{"start":{"line":558,"column":6},"end":{"line":572,"column":7}},"288":{"start":{"line":559,"column":8},"end":{"line":568,"column":9}},"289":{"start":{"line":560,"column":10},"end":{"line":560,"column":38}},"290":{"start":{"line":561,"column":15},"end":{"line":568,"column":9}},"291":{"start":{"line":562,"column":10},"end":{"line":562,"column":56}},"292":{"start":{"line":563,"column":15},"end":{"line":568,"column":9}},"293":{"start":{"line":564,"column":10},"end":{"line":564,"column":41}},"294":{"start":{"line":565,"column":10},"end":{"line":565,"column":56}},"295":{"start":{"line":566,"column":15},"end":{"line":568,"column":9}},"296":{"start":{"line":567,"column":10},"end":{"line":567,"column":43}},"297":{"start":{"line":569,"column":8},"end":{"line":571,"column":9}},"298":{"start":{"line":570,"column":10},"end":{"line":570,"column":42}},"299":{"start":{"line":573,"column":6},"end":{"line":573,"column":34}},"300":{"start":{"line":575,"column":38},"end":{"line":579,"column":5}},"301":{"start":{"line":580,"column":42},"end":{"line":583,"column":5}},"302":{"start":{"line":584,"column":35},"end":{"line":588,"column":5}},"303":{"start":{"line":589,"column":31},"end":{"line":592,"column":5}},"304":{"start":{"line":593,"column":21},"end":{"line":593,"column":97}},"305":{"start":{"line":594,"column":18},"end":{"line":594,"column":88}},"306":{"start":{"line":595,"column":21},"end":{"line":595,"column":90}},"307":{"start":{"line":596,"column":18},"end":{"line":596,"column":95}},"308":{"start":{"line":597,"column":4},"end":{"line":597,"column":48}},"309":{"start":{"line":600,"column":22},"end":{"line":600,"column":28}},"310":{"start":{"line":601,"column":21},"end":{"line":601,"column":69}},"311":{"start":{"line":602,"column":4},"end":{"line":604,"column":5}},"312":{"start":{"line":603,"column":6},"end":{"line":603,"column":32}},"313":{"start":{"line":605,"column":22},"end":{"line":605,"column":55}},"314":{"start":{"line":606,"column":4},"end":{"line":608,"column":5}},"315":{"start":{"line":607,"column":6},"end":{"line":607,"column":32}},"316":{"start":{"line":609,"column":33},"end":{"line":609,"column":38}},"317":{"start":{"line":610,"column":26},"end":{"line":615,"column":10}},"318":{"start":{"line":611,"column":6},"end":{"line":613,"column":7}},"319":{"start":{"line":612,"column":8},"end":{"line":612,"column":40}},"320":{"start":{"line":614,"column":6},"end":{"line":614,"column":34}},"321":{"start":{"line":616,"column":4},"end":{"line":618,"column":5}},"322":{"start":{"line":617,"column":6},"end":{"line":617,"column":32}},"323":{"start":{"line":619,"column":26},"end":{"line":636,"column":10}},"324":{"start":{"line":620,"column":6},"end":{"line":634,"column":7}},"325":{"start":{"line":621,"column":8},"end":{"line":630,"column":9}},"326":{"start":{"line":622,"column":10},"end":{"line":622,"column":38}},"327":{"start":{"line":623,"column":15},"end":{"line":630,"column":9}},"328":{"start":{"line":624,"column":10},"end":{"line":624,"column":47}},"329":{"start":{"line":625,"column":15},"end":{"line":630,"column":9}},"330":{"start":{"line":626,"column":10},"end":{"line":626,"column":35}},"331":{"start":{"line":627,"column":10},"end":{"line":627,"column":47}},"332":{"start":{"line":628,"column":15},"end":{"line":630,"column":9}},"333":{"start":{"line":629,"column":10},"end":{"line":629,"column":37}},"334":{"start":{"line":631,"column":8},"end":{"line":633,"column":9}},"335":{"start":{"line":632,"column":10},"end":{"line":632,"column":42}},"336":{"start":{"line":635,"column":6},"end":{"line":635,"column":34}},"337":{"start":{"line":637,"column":38},"end":{"line":641,"column":5}},"338":{"start":{"line":642,"column":42},"end":{"line":645,"column":5}},"339":{"start":{"line":646,"column":35},"end":{"line":650,"column":5}},"340":{"start":{"line":651,"column":31},"end":{"line":654,"column":5}},"341":{"start":{"line":655,"column":21},"end":{"line":655,"column":97}},"342":{"start":{"line":656,"column":18},"end":{"line":656,"column":88}},"343":{"start":{"line":657,"column":21},"end":{"line":657,"column":90}},"344":{"start":{"line":658,"column":18},"end":{"line":658,"column":95}},"345":{"start":{"line":659,"column":4},"end":{"line":659,"column":48}},"346":{"start":{"line":662,"column":21},"end":{"line":662,"column":69}},"347":{"start":{"line":663,"column":4},"end":{"line":665,"column":5}},"348":{"start":{"line":664,"column":6},"end":{"line":664,"column":32}},"349":{"start":{"line":666,"column":22},"end":{"line":666,"column":55}},"350":{"start":{"line":667,"column":4},"end":{"line":669,"column":5}},"351":{"start":{"line":668,"column":6},"end":{"line":668,"column":32}},"352":{"start":{"line":670,"column":18},"end":{"line":670,"column":30}},"353":{"start":{"line":671,"column":19},"end":{"line":671,"column":48}},"354":{"start":{"line":672,"column":22},"end":{"line":672,"column":46}},"355":{"start":{"line":673,"column":28},"end":{"line":673,"column":30}},"356":{"start":{"line":674,"column":25},"end":{"line":674,"column":27}},"357":{"start":{"line":675,"column":4},"end":{"line":707,"column":7}},"358":{"start":{"line":676,"column":59},"end":{"line":676,"column":64}},"359":{"start":{"line":677,"column":25},"end":{"line":685,"column":7}},"360":{"start":{"line":686,"column":6},"end":{"line":706,"column":7}},"361":{"start":{"line":687,"column":8},"end":{"line":687,"column":35}},"362":{"start":{"line":688,"column":25},"end":{"line":696,"column":9}},"363":{"start":{"line":697,"column":8},"end":{"line":705,"column":9}},"364":{"start":{"line":698,"column":38},"end":{"line":698,"column":65}},"365":{"start":{"line":699,"column":10},"end":{"line":704,"column":13}},"366":{"start":{"line":708,"column":30},"end":{"line":712,"column":5}},"367":{"start":{"line":713,"column":34},"end":{"line":716,"column":5}},"368":{"start":{"line":717,"column":27},"end":{"line":721,"column":5}},"369":{"start":{"line":722,"column":31},"end":{"line":725,"column":5}},"370":{"start":{"line":726,"column":4},"end":{"line":745,"column":6}},"371":{"start":{"line":748,"column":21},"end":{"line":748,"column":69}},"372":{"start":{"line":749,"column":4},"end":{"line":751,"column":5}},"373":{"start":{"line":750,"column":6},"end":{"line":750,"column":32}},"374":{"start":{"line":752,"column":22},"end":{"line":752,"column":55}},"375":{"start":{"line":753,"column":4},"end":{"line":755,"column":5}},"376":{"start":{"line":754,"column":6},"end":{"line":754,"column":32}},"377":{"start":{"line":756,"column":18},"end":{"line":756,"column":30}},"378":{"start":{"line":757,"column":19},"end":{"line":757,"column":45}},"379":{"start":{"line":758,"column":22},"end":{"line":758,"column":46}},"380":{"start":{"line":759,"column":28},"end":{"line":759,"column":30}},"381":{"start":{"line":760,"column":25},"end":{"line":760,"column":27}},"382":{"start":{"line":761,"column":4},"end":{"line":777,"column":7}},"383":{"start":{"line":762,"column":59},"end":{"line":762,"column":64}},"384":{"start":{"line":763,"column":25},"end":{"line":763,"column":105}},"385":{"start":{"line":764,"column":6},"end":{"line":776,"column":7}},"386":{"start":{"line":765,"column":8},"end":{"line":765,"column":35}},"387":{"start":{"line":766,"column":25},"end":{"line":766,"column":103}},"388":{"start":{"line":767,"column":8},"end":{"line":775,"column":9}},"389":{"start":{"line":768,"column":27},"end":{"line":768,"column":48}},"390":{"start":{"line":769,"column":10},"end":{"line":774,"column":13}},"391":{"start":{"line":778,"column":30},"end":{"line":782,"column":5}},"392":{"start":{"line":783,"column":34},"end":{"line":786,"column":5}},"393":{"start":{"line":787,"column":27},"end":{"line":791,"column":5}},"394":{"start":{"line":792,"column":31},"end":{"line":795,"column":5}},"395":{"start":{"line":796,"column":21},"end":{"line":801,"column":5}},"396":{"start":{"line":802,"column":18},"end":{"line":807,"column":5}},"397":{"start":{"line":808,"column":21},"end":{"line":813,"column":5}},"398":{"start":{"line":814,"column":18},"end":{"line":819,"column":5}},"399":{"start":{"line":820,"column":4},"end":{"line":820,"column":48}},"400":{"start":{"line":823,"column":21},"end":{"line":823,"column":69}},"401":{"start":{"line":824,"column":4},"end":{"line":826,"column":5}},"402":{"start":{"line":825,"column":6},"end":{"line":825,"column":32}},"403":{"start":{"line":827,"column":22},"end":{"line":827,"column":55}},"404":{"start":{"line":828,"column":4},"end":{"line":830,"column":5}},"405":{"start":{"line":829,"column":6},"end":{"line":829,"column":32}},"406":{"start":{"line":831,"column":18},"end":{"line":831,"column":30}},"407":{"start":{"line":832,"column":19},"end":{"line":832,"column":45}},"408":{"start":{"line":833,"column":22},"end":{"line":833,"column":46}},"409":{"start":{"line":834,"column":28},"end":{"line":834,"column":30}},"410":{"start":{"line":835,"column":25},"end":{"line":835,"column":27}},"411":{"start":{"line":836,"column":4},"end":{"line":848,"column":7}},"412":{"start":{"line":837,"column":59},"end":{"line":837,"column":64}},"413":{"start":{"line":838,"column":25},"end":{"line":838,"column":105}},"414":{"start":{"line":839,"column":6},"end":{"line":847,"column":7}},"415":{"start":{"line":840,"column":8},"end":{"line":840,"column":35}},"416":{"start":{"line":841,"column":25},"end":{"line":841,"column":103}},"417":{"start":{"line":842,"column":8},"end":{"line":846,"column":9}},"418":{"start":{"line":843,"column":27},"end":{"line":843,"column":48}},"419":{"start":{"line":844,"column":25},"end":{"line":844,"column":64}},"420":{"start":{"line":845,"column":10},"end":{"line":845,"column":36}},"421":{"start":{"line":849,"column":30},"end":{"line":853,"column":5}},"422":{"start":{"line":854,"column":34},"end":{"line":857,"column":5}},"423":{"start":{"line":858,"column":27},"end":{"line":862,"column":5}},"424":{"start":{"line":863,"column":31},"end":{"line":866,"column":5}},"425":{"start":{"line":867,"column":21},"end":{"line":872,"column":5}},"426":{"start":{"line":873,"column":18},"end":{"line":878,"column":5}},"427":{"start":{"line":879,"column":21},"end":{"line":884,"column":5}},"428":{"start":{"line":885,"column":18},"end":{"line":890,"column":5}},"429":{"start":{"line":891,"column":4},"end":{"line":891,"column":48}},"430":{"start":{"line":894,"column":21},"end":{"line":894,"column":69}},"431":{"start":{"line":895,"column":4},"end":{"line":897,"column":5}},"432":{"start":{"line":896,"column":6},"end":{"line":896,"column":32}},"433":{"start":{"line":898,"column":22},"end":{"line":898,"column":55}},"434":{"start":{"line":899,"column":4},"end":{"line":901,"column":5}},"435":{"start":{"line":900,"column":6},"end":{"line":900,"column":32}},"436":{"start":{"line":902,"column":18},"end":{"line":902,"column":30}},"437":{"start":{"line":903,"column":19},"end":{"line":903,"column":48}},"438":{"start":{"line":904,"column":22},"end":{"line":904,"column":46}},"439":{"start":{"line":905,"column":28},"end":{"line":905,"column":30}},"440":{"start":{"line":906,"column":25},"end":{"line":906,"column":27}},"441":{"start":{"line":907,"column":4},"end":{"line":939,"column":7}},"442":{"start":{"line":908,"column":59},"end":{"line":908,"column":64}},"443":{"start":{"line":909,"column":25},"end":{"line":917,"column":7}},"444":{"start":{"line":918,"column":6},"end":{"line":938,"column":7}},"445":{"start":{"line":919,"column":8},"end":{"line":919,"column":35}},"446":{"start":{"line":920,"column":25},"end":{"line":928,"column":9}},"447":{"start":{"line":929,"column":8},"end":{"line":937,"column":9}},"448":{"start":{"line":930,"column":38},"end":{"line":930,"column":65}},"449":{"start":{"line":931,"column":10},"end":{"line":936,"column":13}},"450":{"start":{"line":940,"column":30},"end":{"line":944,"column":5}},"451":{"start":{"line":945,"column":34},"end":{"line":945,"column":99}},"452":{"start":{"line":946,"column":27},"end":{"line":950,"column":5}},"453":{"start":{"line":951,"column":31},"end":{"line":951,"column":90}},"454":{"start":{"line":952,"column":4},"end":{"line":971,"column":6}},"455":{"start":{"line":974,"column":4},"end":{"line":974,"column":83}},"456":{"start":{"line":977,"column":4},"end":{"line":977,"column":36}},"457":{"start":{"line":980,"column":4},"end":{"line":1085,"column":8}},"458":{"start":{"line":981,"column":6},"end":{"line":1028,"column":7}},"459":{"start":{"line":982,"column":8},"end":{"line":982,"column":36}},"460":{"start":{"line":982,"column":29},"end":{"line":982,"column":36}},"461":{"start":{"line":983,"column":25},"end":{"line":983,"column":98}},"462":{"start":{"line":984,"column":8},"end":{"line":984,"column":30}},"463":{"start":{"line":984,"column":23},"end":{"line":984,"column":30}},"464":{"start":{"line":985,"column":26},"end":{"line":985,"column":78}},"465":{"start":{"line":986,"column":8},"end":{"line":986,"column":31}},"466":{"start":{"line":986,"column":24},"end":{"line":986,"column":31}},"467":{"start":{"line":987,"column":45},"end":{"line":987,"column":59}},"468":{"start":{"line":988,"column":26},"end":{"line":988,"column":128}},"469":{"start":{"line":989,"column":27},"end":{"line":989,"column":138}},"470":{"start":{"line":990,"column":28},"end":{"line":990,"column":86}},"471":{"start":{"line":991,"column":28},"end":{"line":991,"column":86}},"472":{"start":{"line":992,"column":26},"end":{"line":992,"column":57}},"473":{"start":{"line":993,"column":36},"end":{"line":993,"column":38}},"474":{"start":{"line":994,"column":8},"end":{"line":1018,"column":11}},"475":{"start":{"line":995,"column":72},"end":{"line":995,"column":77}},"476":{"start":{"line":996,"column":10},"end":{"line":1014,"column":11}},"477":{"start":{"line":997,"column":12},"end":{"line":1013,"column":13}},"478":{"start":{"line":998,"column":14},"end":{"line":1004,"column":15}},"479":{"start":{"line":999,"column":16},"end":{"line":999,"column":39}},"480":{"start":{"line":1000,"column":16},"end":{"line":1000,"column":37}},"481":{"start":{"line":1001,"column":21},"end":{"line":1004,"column":15}},"482":{"start":{"line":1002,"column":16},"end":{"line":1002,"column":39}},"483":{"start":{"line":1003,"column":16},"end":{"line":1003,"column":37}},"484":{"start":{"line":1006,"column":14},"end":{"line":1012,"column":15}},"485":{"start":{"line":1007,"column":16},"end":{"line":1007,"column":42}},"486":{"start":{"line":1008,"column":16},"end":{"line":1008,"column":40}},"487":{"start":{"line":1009,"column":21},"end":{"line":1012,"column":15}},"488":{"start":{"line":1010,"column":16},"end":{"line":1010,"column":42}},"489":{"start":{"line":1011,"column":16},"end":{"line":1011,"column":40}},"490":{"start":{"line":1015,"column":10},"end":{"line":1017,"column":11}},"491":{"start":{"line":1016,"column":12},"end":{"line":1016,"column":94}},"492":{"start":{"line":1019,"column":8},"end":{"line":1019,"column":52}},"493":{"start":{"line":1020,"column":8},"end":{"line":1020,"column":44}},"494":{"start":{"line":1021,"column":38},"end":{"line":1021,"column":52}},"495":{"start":{"line":1022,"column":24},"end":{"line":1024,"column":9}},"496":{"start":{"line":1023,"column":10},"end":{"line":1023,"column":64}},"497":{"start":{"line":1025,"column":8},"end":{"line":1027,"column":11}},"498":{"start":{"line":1026,"column":10},"end":{"line":1026,"column":115}},"499":{"start":{"line":1029,"column":6},"end":{"line":1084,"column":7}},"500":{"start":{"line":1030,"column":25},"end":{"line":1030,"column":98}},"501":{"start":{"line":1031,"column":8},"end":{"line":1031,"column":30}},"502":{"start":{"line":1031,"column":23},"end":{"line":1031,"column":30}},"503":{"start":{"line":1032,"column":26},"end":{"line":1032,"column":78}},"504":{"start":{"line":1033,"column":8},"end":{"line":1033,"column":31}},"505":{"start":{"line":1033,"column":24},"end":{"line":1033,"column":31}},"506":{"start":{"line":1034,"column":26},"end":{"line":1034,"column":57}},"507":{"start":{"line":1035,"column":23},"end":{"line":1035,"column":37}},"508":{"start":{"line":1036,"column":8},"end":{"line":1036,"column":28}},"509":{"start":{"line":1036,"column":21},"end":{"line":1036,"column":28}},"510":{"start":{"line":1037,"column":26},"end":{"line":1037,"column":32}},"511":{"start":{"line":1038,"column":31},"end":{"line":1038,"column":57}},"512":{"start":{"line":1039,"column":31},"end":{"line":1039,"column":60}},"513":{"start":{"line":1040,"column":31},"end":{"line":1040,"column":82}},"514":{"start":{"line":1041,"column":29},"end":{"line":1041,"column":76}},"515":{"start":{"line":1042,"column":31},"end":{"line":1042,"column":64}},"516":{"start":{"line":1043,"column":36},"end":{"line":1043,"column":38}},"517":{"start":{"line":1044,"column":8},"end":{"line":1074,"column":11}},"518":{"start":{"line":1045,"column":72},"end":{"line":1045,"column":77}},"519":{"start":{"line":1046,"column":10},"end":{"line":1070,"column":11}},"520":{"start":{"line":1047,"column":12},"end":{"line":1057,"column":13}},"521":{"start":{"line":1048,"column":14},"end":{"line":1051,"column":15}},"522":{"start":{"line":1049,"column":16},"end":{"line":1049,"column":43}},"523":{"start":{"line":1050,"column":16},"end":{"line":1050,"column":41}},"524":{"start":{"line":1053,"column":14},"end":{"line":1056,"column":15}},"525":{"start":{"line":1054,"column":16},"end":{"line":1054,"column":46}},"526":{"start":{"line":1055,"column":16},"end":{"line":1055,"column":44}},"527":{"start":{"line":1059,"column":12},"end":{"line":1069,"column":13}},"528":{"start":{"line":1060,"column":14},"end":{"line":1063,"column":15}},"529":{"start":{"line":1061,"column":16},"end":{"line":1061,"column":43}},"530":{"start":{"line":1062,"column":16},"end":{"line":1062,"column":41}},"531":{"start":{"line":1065,"column":14},"end":{"line":1068,"column":15}},"532":{"start":{"line":1066,"column":16},"end":{"line":1066,"column":46}},"533":{"start":{"line":1067,"column":16},"end":{"line":1067,"column":44}},"534":{"start":{"line":1071,"column":10},"end":{"line":1073,"column":11}},"535":{"start":{"line":1072,"column":12},"end":{"line":1072,"column":94}},"536":{"start":{"line":1075,"column":8},"end":{"line":1075,"column":52}},"537":{"start":{"line":1076,"column":8},"end":{"line":1076,"column":44}},"538":{"start":{"line":1077,"column":38},"end":{"line":1077,"column":52}},"539":{"start":{"line":1078,"column":24},"end":{"line":1080,"column":9}},"540":{"start":{"line":1079,"column":10},"end":{"line":1079,"column":64}},"541":{"start":{"line":1081,"column":8},"end":{"line":1083,"column":11}},"542":{"start":{"line":1082,"column":10},"end":{"line":1082,"column":116}},"543":{"start":{"line":1088,"column":0},"end":{"line":1095,"column":24}},"544":{"start":{"line":1097,"column":2},"end":{"line":1099,"column":3}},"545":{"start":{"line":1098,"column":4},"end":{"line":1098,"column":64}},"546":{"start":{"line":1100,"column":2},"end":{"line":1100,"column":86}},"547":{"start":{"line":1103,"column":2},"end":{"line":1105,"column":3}},"548":{"start":{"line":1104,"column":4},"end":{"line":1104,"column":49}},"549":{"start":{"line":1106,"column":2},"end":{"line":1106,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":22},"end":{"line":3,"column":23}},"loc":{"start":{"line":3,"column":57},"end":{"line":10,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":44},"end":{"line":11,"column":45}},"loc":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"line":11},"3":{"name":"getAddMergeMutationRangeByType","decl":{"start":{"line":56,"column":16},"end":{"line":56,"column":46}},"loc":{"start":{"line":56,"column":64},"end":{"line":87,"column":1}},"line":56},"4":{"name":"(anonymous_4)","decl":{"start":{"line":90,"column":2},"end":{"line":90,"column":3}},"loc":{"start":{"line":90,"column":136},"end":{"line":101,"column":3}},"line":90},"5":{"name":"(anonymous_5)","decl":{"start":{"line":104,"column":2},"end":{"line":104,"column":3}},"loc":{"start":{"line":104,"column":28},"end":{"line":182,"column":3}},"line":104},"6":{"name":"(anonymous_6)","decl":{"start":{"line":107,"column":6},"end":{"line":107,"column":7}},"loc":{"start":{"line":107,"column":32},"end":{"line":143,"column":7}},"line":107},"7":{"name":"(anonymous_7)","decl":{"start":{"line":119,"column":89},"end":{"line":119,"column":90}},"loc":{"start":{"line":119,"column":96},"end":{"line":119,"column":103}},"line":119},"8":{"name":"(anonymous_8)","decl":{"start":{"line":122,"column":16},"end":{"line":122,"column":17}},"loc":{"start":{"line":122,"column":27},"end":{"line":122,"column":86}},"line":122},"9":{"name":"(anonymous_9)","decl":{"start":{"line":122,"column":42},"end":{"line":122,"column":43}},"loc":{"start":{"line":122,"column":52},"end":{"line":122,"column":85}},"line":122},"10":{"name":"(anonymous_10)","decl":{"start":{"line":146,"column":20},"end":{"line":146,"column":21}},"loc":{"start":{"line":146,"column":55},"end":{"line":180,"column":7}},"line":146},"11":{"name":"(anonymous_11)","decl":{"start":{"line":159,"column":47},"end":{"line":159,"column":48}},"loc":{"start":{"line":159,"column":57},"end":{"line":159,"column":114}},"line":159},"12":{"name":"(anonymous_12)","decl":{"start":{"line":159,"column":69},"end":{"line":159,"column":70}},"loc":{"start":{"line":159,"column":80},"end":{"line":159,"column":113}},"line":159},"13":{"name":"(anonymous_13)","decl":{"start":{"line":183,"column":2},"end":{"line":183,"column":3}},"loc":{"start":{"line":183,"column":44},"end":{"line":235,"column":3}},"line":183},"14":{"name":"(anonymous_14)","decl":{"start":{"line":236,"column":2},"end":{"line":236,"column":3}},"loc":{"start":{"line":236,"column":22},"end":{"line":282,"column":3}},"line":236},"15":{"name":"(anonymous_15)","decl":{"start":{"line":237,"column":29},"end":{"line":237,"column":30}},"loc":{"start":{"line":237,"column":52},"end":{"line":254,"column":5}},"line":237},"16":{"name":"(anonymous_16)","decl":{"start":{"line":248,"column":22},"end":{"line":248,"column":23}},"loc":{"start":{"line":248,"column":34},"end":{"line":250,"column":7}},"line":248},"17":{"name":"(anonymous_17)","decl":{"start":{"line":251,"column":24},"end":{"line":251,"column":25}},"loc":{"start":{"line":251,"column":35},"end":{"line":253,"column":7}},"line":251},"18":{"name":"(anonymous_18)","decl":{"start":{"line":256,"column":45},"end":{"line":256,"column":46}},"loc":{"start":{"line":256,"column":62},"end":{"line":275,"column":7}},"line":256},"19":{"name":"(anonymous_19)","decl":{"start":{"line":277,"column":98},"end":{"line":277,"column":99}},"loc":{"start":{"line":277,"column":112},"end":{"line":277,"column":122}},"line":277},"20":{"name":"(anonymous_20)","decl":{"start":{"line":277,"column":135},"end":{"line":277,"column":136}},"loc":{"start":{"line":277,"column":149},"end":{"line":281,"column":5}},"line":277},"21":{"name":"(anonymous_21)","decl":{"start":{"line":283,"column":2},"end":{"line":283,"column":3}},"loc":{"start":{"line":283,"column":52},"end":{"line":316,"column":3}},"line":283},"22":{"name":"(anonymous_22)","decl":{"start":{"line":297,"column":22},"end":{"line":297,"column":23}},"loc":{"start":{"line":297,"column":33},"end":{"line":304,"column":5}},"line":297},"23":{"name":"(anonymous_23)","decl":{"start":{"line":317,"column":2},"end":{"line":317,"column":3}},"loc":{"start":{"line":317,"column":52},"end":{"line":350,"column":3}},"line":317},"24":{"name":"(anonymous_24)","decl":{"start":{"line":331,"column":22},"end":{"line":331,"column":23}},"loc":{"start":{"line":331,"column":33},"end":{"line":338,"column":5}},"line":331},"25":{"name":"(anonymous_25)","decl":{"start":{"line":351,"column":2},"end":{"line":351,"column":3}},"loc":{"start":{"line":351,"column":53},"end":{"line":420,"column":3}},"line":351},"26":{"name":"(anonymous_26)","decl":{"start":{"line":361,"column":45},"end":{"line":361,"column":46}},"loc":{"start":{"line":361,"column":55},"end":{"line":361,"column":99}},"line":361},"27":{"name":"(anonymous_27)","decl":{"start":{"line":362,"column":43},"end":{"line":362,"column":44}},"loc":{"start":{"line":362,"column":53},"end":{"line":362,"column":95}},"line":362},"28":{"name":"(anonymous_28)","decl":{"start":{"line":363,"column":54},"end":{"line":363,"column":55}},"loc":{"start":{"line":363,"column":70},"end":{"line":363,"column":126}},"line":363},"29":{"name":"(anonymous_29)","decl":{"start":{"line":363,"column":132},"end":{"line":363,"column":133}},"loc":{"start":{"line":363,"column":151},"end":{"line":363,"column":208}},"line":363},"30":{"name":"(anonymous_30)","decl":{"start":{"line":365,"column":6},"end":{"line":365,"column":7}},"loc":{"start":{"line":365,"column":17},"end":{"line":365,"column":85}},"line":365},"31":{"name":"(anonymous_31)","decl":{"start":{"line":365,"column":33},"end":{"line":365,"column":34}},"loc":{"start":{"line":365,"column":49},"end":{"line":365,"column":84}},"line":365},"32":{"name":"(anonymous_32)","decl":{"start":{"line":421,"column":2},"end":{"line":421,"column":3}},"loc":{"start":{"line":421,"column":53},"end":{"line":478,"column":3}},"line":421},"33":{"name":"(anonymous_33)","decl":{"start":{"line":432,"column":75},"end":{"line":432,"column":76}},"loc":{"start":{"line":432,"column":107},"end":{"line":437,"column":5}},"line":432},"34":{"name":"(anonymous_34)","decl":{"start":{"line":441,"column":75},"end":{"line":441,"column":76}},"loc":{"start":{"line":441,"column":107},"end":{"line":450,"column":5}},"line":441},"35":{"name":"(anonymous_35)","decl":{"start":{"line":479,"column":2},"end":{"line":479,"column":3}},"loc":{"start":{"line":479,"column":53},"end":{"line":536,"column":3}},"line":479},"36":{"name":"(anonymous_36)","decl":{"start":{"line":490,"column":75},"end":{"line":490,"column":76}},"loc":{"start":{"line":490,"column":107},"end":{"line":495,"column":5}},"line":490},"37":{"name":"(anonymous_37)","decl":{"start":{"line":499,"column":75},"end":{"line":499,"column":76}},"loc":{"start":{"line":499,"column":107},"end":{"line":508,"column":5}},"line":499},"38":{"name":"(anonymous_38)","decl":{"start":{"line":537,"column":2},"end":{"line":537,"column":3}},"loc":{"start":{"line":537,"column":53},"end":{"line":598,"column":3}},"line":537},"39":{"name":"(anonymous_39)","decl":{"start":{"line":548,"column":75},"end":{"line":548,"column":76}},"loc":{"start":{"line":548,"column":107},"end":{"line":553,"column":5}},"line":548},"40":{"name":"(anonymous_40)","decl":{"start":{"line":557,"column":75},"end":{"line":557,"column":76}},"loc":{"start":{"line":557,"column":107},"end":{"line":574,"column":5}},"line":557},"41":{"name":"(anonymous_41)","decl":{"start":{"line":599,"column":2},"end":{"line":599,"column":3}},"loc":{"start":{"line":599,"column":53},"end":{"line":660,"column":3}},"line":599},"42":{"name":"(anonymous_42)","decl":{"start":{"line":610,"column":75},"end":{"line":610,"column":76}},"loc":{"start":{"line":610,"column":107},"end":{"line":615,"column":5}},"line":610},"43":{"name":"(anonymous_43)","decl":{"start":{"line":619,"column":75},"end":{"line":619,"column":76}},"loc":{"start":{"line":619,"column":107},"end":{"line":636,"column":5}},"line":619},"44":{"name":"(anonymous_44)","decl":{"start":{"line":661,"column":2},"end":{"line":661,"column":3}},"loc":{"start":{"line":661,"column":64},"end":{"line":746,"column":3}},"line":661},"45":{"name":"(anonymous_45)","decl":{"start":{"line":675,"column":22},"end":{"line":675,"column":23}},"loc":{"start":{"line":675,"column":32},"end":{"line":707,"column":5}},"line":675},"46":{"name":"(anonymous_46)","decl":{"start":{"line":747,"column":2},"end":{"line":747,"column":3}},"loc":{"start":{"line":747,"column":63},"end":{"line":821,"column":3}},"line":747},"47":{"name":"(anonymous_47)","decl":{"start":{"line":761,"column":22},"end":{"line":761,"column":23}},"loc":{"start":{"line":761,"column":32},"end":{"line":777,"column":5}},"line":761},"48":{"name":"(anonymous_48)","decl":{"start":{"line":822,"column":2},"end":{"line":822,"column":3}},"loc":{"start":{"line":822,"column":61},"end":{"line":892,"column":3}},"line":822},"49":{"name":"(anonymous_49)","decl":{"start":{"line":836,"column":22},"end":{"line":836,"column":23}},"loc":{"start":{"line":836,"column":32},"end":{"line":848,"column":5}},"line":836},"50":{"name":"(anonymous_50)","decl":{"start":{"line":893,"column":2},"end":{"line":893,"column":3}},"loc":{"start":{"line":893,"column":63},"end":{"line":972,"column":3}},"line":893},"51":{"name":"(anonymous_51)","decl":{"start":{"line":907,"column":22},"end":{"line":907,"column":23}},"loc":{"start":{"line":907,"column":32},"end":{"line":939,"column":5}},"line":907},"52":{"name":"(anonymous_52)","decl":{"start":{"line":973,"column":2},"end":{"line":973,"column":3}},"loc":{"start":{"line":973,"column":26},"end":{"line":975,"column":3}},"line":973},"53":{"name":"(anonymous_53)","decl":{"start":{"line":976,"column":2},"end":{"line":976,"column":3}},"loc":{"start":{"line":976,"column":16},"end":{"line":978,"column":3}},"line":976},"54":{"name":"(anonymous_54)","decl":{"start":{"line":979,"column":2},"end":{"line":979,"column":3}},"loc":{"start":{"line":979,"column":29},"end":{"line":1086,"column":3}},"line":979},"55":{"name":"(anonymous_55)","decl":{"start":{"line":980,"column":62},"end":{"line":980,"column":63}},"loc":{"start":{"line":980,"column":75},"end":{"line":1085,"column":5}},"line":980},"56":{"name":"(anonymous_56)","decl":{"start":{"line":994,"column":26},"end":{"line":994,"column":27}},"loc":{"start":{"line":994,"column":37},"end":{"line":1018,"column":9}},"line":994},"57":{"name":"(anonymous_57)","decl":{"start":{"line":1022,"column":24},"end":{"line":1022,"column":25}},"loc":{"start":{"line":1022,"column":36},"end":{"line":1024,"column":9}},"line":1022},"58":{"name":"(anonymous_58)","decl":{"start":{"line":1025,"column":36},"end":{"line":1025,"column":37}},"loc":{"start":{"line":1025,"column":47},"end":{"line":1027,"column":9}},"line":1025},"59":{"name":"(anonymous_59)","decl":{"start":{"line":1044,"column":26},"end":{"line":1044,"column":27}},"loc":{"start":{"line":1044,"column":37},"end":{"line":1074,"column":9}},"line":1044},"60":{"name":"(anonymous_60)","decl":{"start":{"line":1078,"column":24},"end":{"line":1078,"column":25}},"loc":{"start":{"line":1078,"column":36},"end":{"line":1080,"column":9}},"line":1078},"61":{"name":"(anonymous_61)","decl":{"start":{"line":1081,"column":36},"end":{"line":1081,"column":37}},"loc":{"start":{"line":1081,"column":48},"end":{"line":1083,"column":9}},"line":1081},"62":{"name":"getWorkbook","decl":{"start":{"line":1096,"column":9},"end":{"line":1096,"column":20}},"loc":{"start":{"line":1096,"column":52},"end":{"line":1101,"column":1}},"line":1096},"63":{"name":"getWorksheet","decl":{"start":{"line":1102,"column":9},"end":{"line":1102,"column":21}},"loc":{"start":{"line":1102,"column":43},"end":{"line":1107,"column":1}},"line":1102}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":26},"end":{"line":4,"column":32}},{"start":{"line":4,"column":35},"end":{"line":4,"column":80}}],"line":4},"1":{"loc":{"start":{"line":4,"column":35},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":42},"end":{"line":4,"column":71}},{"start":{"line":4,"column":74},"end":{"line":4,"column":80}}],"line":4},"2":{"loc":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"type":"if","locations":[{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},{"start":{},"end":{}}],"line":6},"3":{"loc":{"start":{"line":7,"column":15},"end":{"line":7,"column":84}},"type":"binary-expr","locations":[{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},{"start":{"line":7,"column":78},"end":{"line":7,"column":84}}],"line":7},"4":{"loc":{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},"type":"cond-expr","locations":[{"start":{"line":7,"column":23},"end":{"line":7,"column":53}},{"start":{"line":7,"column":56},"end":{"line":7,"column":73}}],"line":7},"5":{"loc":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},{"start":{},"end":{}}],"line":8},"6":{"loc":{"start":{"line":8,"column":6},"end":{"line":8,"column":20}},"type":"binary-expr","locations":[{"start":{"line":8,"column":6},"end":{"line":8,"column":10}},{"start":{"line":8,"column":14},"end":{"line":8,"column":20}}],"line":8},"7":{"loc":{"start":{"line":58,"column":2},"end":{"line":85,"column":3}},"type":"if","locations":[{"start":{"line":58,"column":2},"end":{"line":85,"column":3}},{"start":{},"end":{}}],"line":58},"8":{"loc":{"start":{"line":62,"column":6},"end":{"line":82,"column":7}},"type":"if","locations":[{"start":{"line":62,"column":6},"end":{"line":82,"column":7}},{"start":{"line":72,"column":13},"end":{"line":82,"column":7}}],"line":62},"9":{"loc":{"start":{"line":72,"column":13},"end":{"line":82,"column":7}},"type":"if","locations":[{"start":{"line":72,"column":13},"end":{"line":82,"column":7}},{"start":{},"end":{}}],"line":72},"10":{"loc":{"start":{"line":108,"column":8},"end":{"line":141,"column":9}},"type":"switch","locations":[{"start":{"line":109,"column":10},"end":{"line":109,"column":43}},{"start":{"line":110,"column":10},"end":{"line":140,"column":11}}],"line":108},"11":{"loc":{"start":{"line":114,"column":12},"end":{"line":116,"column":13}},"type":"if","locations":[{"start":{"line":114,"column":12},"end":{"line":116,"column":13}},{"start":{},"end":{}}],"line":114},"12":{"loc":{"start":{"line":120,"column":12},"end":{"line":139,"column":13}},"type":"if","locations":[{"start":{"line":120,"column":12},"end":{"line":139,"column":13}},{"start":{},"end":{}}],"line":120},"13":{"loc":{"start":{"line":120,"column":16},"end":{"line":120,"column":51}},"type":"binary-expr","locations":[{"start":{"line":120,"column":16},"end":{"line":120,"column":26}},{"start":{"line":120,"column":30},"end":{"line":120,"column":51}}],"line":120},"14":{"loc":{"start":{"line":124,"column":14},"end":{"line":138,"column":15}},"type":"if","locations":[{"start":{"line":124,"column":14},"end":{"line":138,"column":15}},{"start":{},"end":{}}],"line":124},"15":{"loc":{"start":{"line":150,"column":8},"end":{"line":152,"column":9}},"type":"if","locations":[{"start":{"line":150,"column":8},"end":{"line":152,"column":9}},{"start":{},"end":{}}],"line":150},"16":{"loc":{"start":{"line":150,"column":12},"end":{"line":150,"column":37}},"type":"binary-expr","locations":[{"start":{"line":150,"column":12},"end":{"line":150,"column":19}},{"start":{"line":150,"column":23},"end":{"line":150,"column":37}}],"line":150},"17":{"loc":{"start":{"line":154,"column":8},"end":{"line":156,"column":9}},"type":"if","locations":[{"start":{"line":154,"column":8},"end":{"line":156,"column":9}},{"start":{},"end":{}}],"line":154},"18":{"loc":{"start":{"line":160,"column":8},"end":{"line":178,"column":9}},"type":"if","locations":[{"start":{"line":160,"column":8},"end":{"line":178,"column":9}},{"start":{},"end":{}}],"line":160},"19":{"loc":{"start":{"line":184,"column":4},"end":{"line":233,"column":5}},"type":"switch","locations":[{"start":{"line":185,"column":6},"end":{"line":188,"column":7}},{"start":{"line":189,"column":6},"end":{"line":192,"column":7}},{"start":{"line":193,"column":6},"end":{"line":198,"column":7}},{"start":{"line":199,"column":6},"end":{"line":204,"column":7}},{"start":{"line":205,"column":6},"end":{"line":208,"column":7}},{"start":{"line":209,"column":6},"end":{"line":212,"column":7}},{"start":{"line":213,"column":6},"end":{"line":216,"column":7}},{"start":{"line":217,"column":6},"end":{"line":220,"column":7}},{"start":{"line":221,"column":6},"end":{"line":224,"column":7}},{"start":{"line":225,"column":6},"end":{"line":228,"column":7}},{"start":{"line":229,"column":6},"end":{"line":232,"column":7}}],"line":184},"20":{"loc":{"start":{"line":195,"column":24},"end":{"line":195,"column":47}},"type":"binary-expr","locations":[{"start":{"line":195,"column":24},"end":{"line":195,"column":37}},{"start":{"line":195,"column":41},"end":{"line":195,"column":47}}],"line":195},"21":{"loc":{"start":{"line":196,"column":27},"end":{"line":196,"column":56}},"type":"binary-expr","locations":[{"start":{"line":196,"column":27},"end":{"line":196,"column":43}},{"start":{"line":196,"column":47},"end":{"line":196,"column":56}}],"line":196},"22":{"loc":{"start":{"line":201,"column":24},"end":{"line":201,"column":47}},"type":"binary-expr","locations":[{"start":{"line":201,"column":24},"end":{"line":201,"column":37}},{"start":{"line":201,"column":41},"end":{"line":201,"column":47}}],"line":201},"23":{"loc":{"start":{"line":202,"column":27},"end":{"line":202,"column":56}},"type":"binary-expr","locations":[{"start":{"line":202,"column":27},"end":{"line":202,"column":43}},{"start":{"line":202,"column":47},"end":{"line":202,"column":56}}],"line":202},"24":{"loc":{"start":{"line":239,"column":6},"end":{"line":241,"column":7}},"type":"if","locations":[{"start":{"line":239,"column":6},"end":{"line":241,"column":7}},{"start":{},"end":{}}],"line":239},"25":{"loc":{"start":{"line":243,"column":6},"end":{"line":245,"column":7}},"type":"if","locations":[{"start":{"line":243,"column":6},"end":{"line":245,"column":7}},{"start":{},"end":{}}],"line":243},"26":{"loc":{"start":{"line":257,"column":8},"end":{"line":265,"column":9}},"type":"if","locations":[{"start":{"line":257,"column":8},"end":{"line":265,"column":9}},{"start":{},"end":{}}],"line":257},"27":{"loc":{"start":{"line":261,"column":10},"end":{"line":263,"column":11}},"type":"if","locations":[{"start":{"line":261,"column":10},"end":{"line":263,"column":11}},{"start":{},"end":{}}],"line":261},"28":{"loc":{"start":{"line":261,"column":14},"end":{"line":261,"column":33}},"type":"binary-expr","locations":[{"start":{"line":261,"column":14},"end":{"line":261,"column":22}},{"start":{"line":261,"column":26},"end":{"line":261,"column":33}}],"line":261},"29":{"loc":{"start":{"line":266,"column":8},"end":{"line":274,"column":9}},"type":"if","locations":[{"start":{"line":266,"column":8},"end":{"line":274,"column":9}},{"start":{},"end":{}}],"line":266},"30":{"loc":{"start":{"line":270,"column":10},"end":{"line":272,"column":11}},"type":"if","locations":[{"start":{"line":270,"column":10},"end":{"line":272,"column":11}},{"start":{},"end":{}}],"line":270},"31":{"loc":{"start":{"line":270,"column":14},"end":{"line":270,"column":33}},"type":"binary-expr","locations":[{"start":{"line":270,"column":14},"end":{"line":270,"column":22}},{"start":{"line":270,"column":26},"end":{"line":270,"column":33}}],"line":270},"32":{"loc":{"start":{"line":279,"column":6},"end":{"line":279,"column":25}},"type":"if","locations":[{"start":{"line":279,"column":6},"end":{"line":279,"column":25}},{"start":{},"end":{}}],"line":279},"33":{"loc":{"start":{"line":285,"column":4},"end":{"line":287,"column":5}},"type":"if","locations":[{"start":{"line":285,"column":4},"end":{"line":287,"column":5}},{"start":{},"end":{}}],"line":285},"34":{"loc":{"start":{"line":289,"column":4},"end":{"line":291,"column":5}},"type":"if","locations":[{"start":{"line":289,"column":4},"end":{"line":291,"column":5}},{"start":{},"end":{}}],"line":289},"35":{"loc":{"start":{"line":298,"column":6},"end":{"line":303,"column":7}},"type":"if","locations":[{"start":{"line":298,"column":6},"end":{"line":303,"column":7}},{"start":{},"end":{}}],"line":298},"36":{"loc":{"start":{"line":298,"column":10},"end":{"line":298,"column":68}},"type":"binary-expr","locations":[{"start":{"line":298,"column":10},"end":{"line":298,"column":39}},{"start":{"line":298,"column":43},"end":{"line":298,"column":68}}],"line":298},"37":{"loc":{"start":{"line":302,"column":8},"end":{"line":302,"column":47}},"type":"binary-expr","locations":[{"start":{"line":302,"column":8},"end":{"line":302,"column":14}},{"start":{"line":302,"column":18},"end":{"line":302,"column":47}}],"line":302},"38":{"loc":{"start":{"line":305,"column":4},"end":{"line":307,"column":5}},"type":"if","locations":[{"start":{"line":305,"column":4},"end":{"line":307,"column":5}},{"start":{},"end":{}}],"line":305},"39":{"loc":{"start":{"line":319,"column":4},"end":{"line":321,"column":5}},"type":"if","locations":[{"start":{"line":319,"column":4},"end":{"line":321,"column":5}},{"start":{},"end":{}}],"line":319},"40":{"loc":{"start":{"line":323,"column":4},"end":{"line":325,"column":5}},"type":"if","locations":[{"start":{"line":323,"column":4},"end":{"line":325,"column":5}},{"start":{},"end":{}}],"line":323},"41":{"loc":{"start":{"line":332,"column":6},"end":{"line":337,"column":7}},"type":"if","locations":[{"start":{"line":332,"column":6},"end":{"line":337,"column":7}},{"start":{},"end":{}}],"line":332},"42":{"loc":{"start":{"line":332,"column":10},"end":{"line":332,"column":74}},"type":"binary-expr","locations":[{"start":{"line":332,"column":10},"end":{"line":332,"column":42}},{"start":{"line":332,"column":46},"end":{"line":332,"column":74}}],"line":332},"43":{"loc":{"start":{"line":336,"column":8},"end":{"line":336,"column":47}},"type":"binary-expr","locations":[{"start":{"line":336,"column":8},"end":{"line":336,"column":14}},{"start":{"line":336,"column":18},"end":{"line":336,"column":47}}],"line":336},"44":{"loc":{"start":{"line":339,"column":4},"end":{"line":341,"column":5}},"type":"if","locations":[{"start":{"line":339,"column":4},"end":{"line":341,"column":5}},{"start":{},"end":{}}],"line":339},"45":{"loc":{"start":{"line":353,"column":4},"end":{"line":355,"column":5}},"type":"if","locations":[{"start":{"line":353,"column":4},"end":{"line":355,"column":5}},{"start":{},"end":{}}],"line":353},"46":{"loc":{"start":{"line":357,"column":4},"end":{"line":359,"column":5}},"type":"if","locations":[{"start":{"line":357,"column":4},"end":{"line":359,"column":5}},{"start":{},"end":{}}],"line":357},"47":{"loc":{"start":{"line":423,"column":4},"end":{"line":425,"column":5}},"type":"if","locations":[{"start":{"line":423,"column":4},"end":{"line":425,"column":5}},{"start":{},"end":{}}],"line":423},"48":{"loc":{"start":{"line":427,"column":4},"end":{"line":429,"column":5}},"type":"if","locations":[{"start":{"line":427,"column":4},"end":{"line":429,"column":5}},{"start":{},"end":{}}],"line":427},"49":{"loc":{"start":{"line":433,"column":6},"end":{"line":435,"column":7}},"type":"if","locations":[{"start":{"line":433,"column":6},"end":{"line":435,"column":7}},{"start":{},"end":{}}],"line":433},"50":{"loc":{"start":{"line":433,"column":10},"end":{"line":433,"column":61}},"type":"binary-expr","locations":[{"start":{"line":433,"column":10},"end":{"line":433,"column":34}},{"start":{"line":433,"column":38},"end":{"line":433,"column":61}}],"line":433},"51":{"loc":{"start":{"line":438,"column":4},"end":{"line":440,"column":5}},"type":"if","locations":[{"start":{"line":438,"column":4},"end":{"line":440,"column":5}},{"start":{},"end":{}}],"line":438},"52":{"loc":{"start":{"line":442,"column":6},"end":{"line":448,"column":7}},"type":"if","locations":[{"start":{"line":442,"column":6},"end":{"line":448,"column":7}},{"start":{},"end":{}}],"line":442},"53":{"loc":{"start":{"line":442,"column":10},"end":{"line":442,"column":61}},"type":"binary-expr","locations":[{"start":{"line":442,"column":10},"end":{"line":442,"column":34}},{"start":{"line":442,"column":38},"end":{"line":442,"column":61}}],"line":442},"54":{"loc":{"start":{"line":445,"column":8},"end":{"line":447,"column":9}},"type":"if","locations":[{"start":{"line":445,"column":8},"end":{"line":447,"column":9}},{"start":{},"end":{}}],"line":445},"55":{"loc":{"start":{"line":482,"column":4},"end":{"line":484,"column":5}},"type":"if","locations":[{"start":{"line":482,"column":4},"end":{"line":484,"column":5}},{"start":{},"end":{}}],"line":482},"56":{"loc":{"start":{"line":486,"column":4},"end":{"line":488,"column":5}},"type":"if","locations":[{"start":{"line":486,"column":4},"end":{"line":488,"column":5}},{"start":{},"end":{}}],"line":486},"57":{"loc":{"start":{"line":491,"column":6},"end":{"line":493,"column":7}},"type":"if","locations":[{"start":{"line":491,"column":6},"end":{"line":493,"column":7}},{"start":{},"end":{}}],"line":491},"58":{"loc":{"start":{"line":491,"column":10},"end":{"line":491,"column":73}},"type":"binary-expr","locations":[{"start":{"line":491,"column":10},"end":{"line":491,"column":40}},{"start":{"line":491,"column":44},"end":{"line":491,"column":73}}],"line":491},"59":{"loc":{"start":{"line":496,"column":4},"end":{"line":498,"column":5}},"type":"if","locations":[{"start":{"line":496,"column":4},"end":{"line":498,"column":5}},{"start":{},"end":{}}],"line":496},"60":{"loc":{"start":{"line":500,"column":6},"end":{"line":506,"column":7}},"type":"if","locations":[{"start":{"line":500,"column":6},"end":{"line":506,"column":7}},{"start":{},"end":{}}],"line":500},"61":{"loc":{"start":{"line":500,"column":10},"end":{"line":500,"column":73}},"type":"binary-expr","locations":[{"start":{"line":500,"column":10},"end":{"line":500,"column":40}},{"start":{"line":500,"column":44},"end":{"line":500,"column":73}}],"line":500},"62":{"loc":{"start":{"line":503,"column":8},"end":{"line":505,"column":9}},"type":"if","locations":[{"start":{"line":503,"column":8},"end":{"line":505,"column":9}},{"start":{},"end":{}}],"line":503},"63":{"loc":{"start":{"line":539,"column":4},"end":{"line":541,"column":5}},"type":"if","locations":[{"start":{"line":539,"column":4},"end":{"line":541,"column":5}},{"start":{},"end":{}}],"line":539},"64":{"loc":{"start":{"line":543,"column":4},"end":{"line":545,"column":5}},"type":"if","locations":[{"start":{"line":543,"column":4},"end":{"line":545,"column":5}},{"start":{},"end":{}}],"line":543},"65":{"loc":{"start":{"line":549,"column":6},"end":{"line":551,"column":7}},"type":"if","locations":[{"start":{"line":549,"column":6},"end":{"line":551,"column":7}},{"start":{},"end":{}}],"line":549},"66":{"loc":{"start":{"line":554,"column":4},"end":{"line":556,"column":5}},"type":"if","locations":[{"start":{"line":554,"column":4},"end":{"line":556,"column":5}},{"start":{},"end":{}}],"line":554},"67":{"loc":{"start":{"line":558,"column":6},"end":{"line":572,"column":7}},"type":"if","locations":[{"start":{"line":558,"column":6},"end":{"line":572,"column":7}},{"start":{},"end":{}}],"line":558},"68":{"loc":{"start":{"line":559,"column":8},"end":{"line":568,"column":9}},"type":"if","locations":[{"start":{"line":559,"column":8},"end":{"line":568,"column":9}},{"start":{"line":561,"column":15},"end":{"line":568,"column":9}}],"line":559},"69":{"loc":{"start":{"line":559,"column":12},"end":{"line":559,"column":74}},"type":"binary-expr","locations":[{"start":{"line":559,"column":12},"end":{"line":559,"column":43}},{"start":{"line":559,"column":47},"end":{"line":559,"column":74}}],"line":559},"70":{"loc":{"start":{"line":561,"column":15},"end":{"line":568,"column":9}},"type":"if","locations":[{"start":{"line":561,"column":15},"end":{"line":568,"column":9}},{"start":{"line":563,"column":15},"end":{"line":568,"column":9}}],"line":561},"71":{"loc":{"start":{"line":561,"column":19},"end":{"line":561,"column":81}},"type":"binary-expr","locations":[{"start":{"line":561,"column":19},"end":{"line":561,"column":50}},{"start":{"line":561,"column":54},"end":{"line":561,"column":81}}],"line":561},"72":{"loc":{"start":{"line":563,"column":15},"end":{"line":568,"column":9}},"type":"if","locations":[{"start":{"line":563,"column":15},"end":{"line":568,"column":9}},{"start":{"line":566,"column":15},"end":{"line":568,"column":9}}],"line":563},"73":{"loc":{"start":{"line":566,"column":15},"end":{"line":568,"column":9}},"type":"if","locations":[{"start":{"line":566,"column":15},"end":{"line":568,"column":9}},{"start":{},"end":{}}],"line":566},"74":{"loc":{"start":{"line":569,"column":8},"end":{"line":571,"column":9}},"type":"if","locations":[{"start":{"line":569,"column":8},"end":{"line":571,"column":9}},{"start":{},"end":{}}],"line":569},"75":{"loc":{"start":{"line":602,"column":4},"end":{"line":604,"column":5}},"type":"if","locations":[{"start":{"line":602,"column":4},"end":{"line":604,"column":5}},{"start":{},"end":{}}],"line":602},"76":{"loc":{"start":{"line":606,"column":4},"end":{"line":608,"column":5}},"type":"if","locations":[{"start":{"line":606,"column":4},"end":{"line":608,"column":5}},{"start":{},"end":{}}],"line":606},"77":{"loc":{"start":{"line":611,"column":6},"end":{"line":613,"column":7}},"type":"if","locations":[{"start":{"line":611,"column":6},"end":{"line":613,"column":7}},{"start":{},"end":{}}],"line":611},"78":{"loc":{"start":{"line":616,"column":4},"end":{"line":618,"column":5}},"type":"if","locations":[{"start":{"line":616,"column":4},"end":{"line":618,"column":5}},{"start":{},"end":{}}],"line":616},"79":{"loc":{"start":{"line":620,"column":6},"end":{"line":634,"column":7}},"type":"if","locations":[{"start":{"line":620,"column":6},"end":{"line":634,"column":7}},{"start":{},"end":{}}],"line":620},"80":{"loc":{"start":{"line":621,"column":8},"end":{"line":630,"column":9}},"type":"if","locations":[{"start":{"line":621,"column":8},"end":{"line":630,"column":9}},{"start":{"line":623,"column":15},"end":{"line":630,"column":9}}],"line":621},"81":{"loc":{"start":{"line":621,"column":12},"end":{"line":621,"column":62}},"type":"binary-expr","locations":[{"start":{"line":621,"column":12},"end":{"line":621,"column":37}},{"start":{"line":621,"column":41},"end":{"line":621,"column":62}}],"line":621},"82":{"loc":{"start":{"line":623,"column":15},"end":{"line":630,"column":9}},"type":"if","locations":[{"start":{"line":623,"column":15},"end":{"line":630,"column":9}},{"start":{"line":625,"column":15},"end":{"line":630,"column":9}}],"line":623},"83":{"loc":{"start":{"line":623,"column":19},"end":{"line":623,"column":69}},"type":"binary-expr","locations":[{"start":{"line":623,"column":19},"end":{"line":623,"column":44}},{"start":{"line":623,"column":48},"end":{"line":623,"column":69}}],"line":623},"84":{"loc":{"start":{"line":625,"column":15},"end":{"line":630,"column":9}},"type":"if","locations":[{"start":{"line":625,"column":15},"end":{"line":630,"column":9}},{"start":{"line":628,"column":15},"end":{"line":630,"column":9}}],"line":625},"85":{"loc":{"start":{"line":628,"column":15},"end":{"line":630,"column":9}},"type":"if","locations":[{"start":{"line":628,"column":15},"end":{"line":630,"column":9}},{"start":{},"end":{}}],"line":628},"86":{"loc":{"start":{"line":631,"column":8},"end":{"line":633,"column":9}},"type":"if","locations":[{"start":{"line":631,"column":8},"end":{"line":633,"column":9}},{"start":{},"end":{}}],"line":631},"87":{"loc":{"start":{"line":663,"column":4},"end":{"line":665,"column":5}},"type":"if","locations":[{"start":{"line":663,"column":4},"end":{"line":665,"column":5}},{"start":{},"end":{}}],"line":663},"88":{"loc":{"start":{"line":667,"column":4},"end":{"line":669,"column":5}},"type":"if","locations":[{"start":{"line":667,"column":4},"end":{"line":669,"column":5}},{"start":{},"end":{}}],"line":667},"89":{"loc":{"start":{"line":686,"column":6},"end":{"line":706,"column":7}},"type":"if","locations":[{"start":{"line":686,"column":6},"end":{"line":706,"column":7}},{"start":{},"end":{}}],"line":686},"90":{"loc":{"start":{"line":697,"column":8},"end":{"line":705,"column":9}},"type":"if","locations":[{"start":{"line":697,"column":8},"end":{"line":705,"column":9}},{"start":{},"end":{}}],"line":697},"91":{"loc":{"start":{"line":749,"column":4},"end":{"line":751,"column":5}},"type":"if","locations":[{"start":{"line":749,"column":4},"end":{"line":751,"column":5}},{"start":{},"end":{}}],"line":749},"92":{"loc":{"start":{"line":753,"column":4},"end":{"line":755,"column":5}},"type":"if","locations":[{"start":{"line":753,"column":4},"end":{"line":755,"column":5}},{"start":{},"end":{}}],"line":753},"93":{"loc":{"start":{"line":764,"column":6},"end":{"line":776,"column":7}},"type":"if","locations":[{"start":{"line":764,"column":6},"end":{"line":776,"column":7}},{"start":{},"end":{}}],"line":764},"94":{"loc":{"start":{"line":767,"column":8},"end":{"line":775,"column":9}},"type":"if","locations":[{"start":{"line":767,"column":8},"end":{"line":775,"column":9}},{"start":{},"end":{}}],"line":767},"95":{"loc":{"start":{"line":824,"column":4},"end":{"line":826,"column":5}},"type":"if","locations":[{"start":{"line":824,"column":4},"end":{"line":826,"column":5}},{"start":{},"end":{}}],"line":824},"96":{"loc":{"start":{"line":828,"column":4},"end":{"line":830,"column":5}},"type":"if","locations":[{"start":{"line":828,"column":4},"end":{"line":830,"column":5}},{"start":{},"end":{}}],"line":828},"97":{"loc":{"start":{"line":839,"column":6},"end":{"line":847,"column":7}},"type":"if","locations":[{"start":{"line":839,"column":6},"end":{"line":847,"column":7}},{"start":{},"end":{}}],"line":839},"98":{"loc":{"start":{"line":842,"column":8},"end":{"line":846,"column":9}},"type":"if","locations":[{"start":{"line":842,"column":8},"end":{"line":846,"column":9}},{"start":{},"end":{}}],"line":842},"99":{"loc":{"start":{"line":895,"column":4},"end":{"line":897,"column":5}},"type":"if","locations":[{"start":{"line":895,"column":4},"end":{"line":897,"column":5}},{"start":{},"end":{}}],"line":895},"100":{"loc":{"start":{"line":899,"column":4},"end":{"line":901,"column":5}},"type":"if","locations":[{"start":{"line":899,"column":4},"end":{"line":901,"column":5}},{"start":{},"end":{}}],"line":899},"101":{"loc":{"start":{"line":918,"column":6},"end":{"line":938,"column":7}},"type":"if","locations":[{"start":{"line":918,"column":6},"end":{"line":938,"column":7}},{"start":{},"end":{}}],"line":918},"102":{"loc":{"start":{"line":929,"column":8},"end":{"line":937,"column":9}},"type":"if","locations":[{"start":{"line":929,"column":8},"end":{"line":937,"column":9}},{"start":{},"end":{}}],"line":929},"103":{"loc":{"start":{"line":974,"column":13},"end":{"line":974,"column":81}},"type":"binary-expr","locations":[{"start":{"line":974,"column":13},"end":{"line":974,"column":42}},{"start":{"line":974,"column":46},"end":{"line":974,"column":81}}],"line":974},"104":{"loc":{"start":{"line":981,"column":6},"end":{"line":1028,"column":7}},"type":"if","locations":[{"start":{"line":981,"column":6},"end":{"line":1028,"column":7}},{"start":{},"end":{}}],"line":981},"105":{"loc":{"start":{"line":982,"column":8},"end":{"line":982,"column":36}},"type":"if","locations":[{"start":{"line":982,"column":8},"end":{"line":982,"column":36}},{"start":{},"end":{}}],"line":982},"106":{"loc":{"start":{"line":984,"column":8},"end":{"line":984,"column":30}},"type":"if","locations":[{"start":{"line":984,"column":8},"end":{"line":984,"column":30}},{"start":{},"end":{}}],"line":984},"107":{"loc":{"start":{"line":986,"column":8},"end":{"line":986,"column":31}},"type":"if","locations":[{"start":{"line":986,"column":8},"end":{"line":986,"column":31}},{"start":{},"end":{}}],"line":986},"108":{"loc":{"start":{"line":988,"column":26},"end":{"line":988,"column":128}},"type":"binary-expr","locations":[{"start":{"line":988,"column":26},"end":{"line":988,"column":77}},{"start":{"line":988,"column":81},"end":{"line":988,"column":128}}],"line":988},"109":{"loc":{"start":{"line":989,"column":27},"end":{"line":989,"column":138}},"type":"cond-expr","locations":[{"start":{"line":989,"column":39},"end":{"line":989,"column":84}},{"start":{"line":989,"column":87},"end":{"line":989,"column":138}}],"line":989},"110":{"loc":{"start":{"line":990,"column":28},"end":{"line":990,"column":86}},"type":"cond-expr","locations":[{"start":{"line":990,"column":40},"end":{"line":990,"column":60}},{"start":{"line":990,"column":63},"end":{"line":990,"column":86}}],"line":990},"111":{"loc":{"start":{"line":991,"column":28},"end":{"line":991,"column":86}},"type":"cond-expr","locations":[{"start":{"line":991,"column":40},"end":{"line":991,"column":60}},{"start":{"line":991,"column":63},"end":{"line":991,"column":86}}],"line":991},"112":{"loc":{"start":{"line":996,"column":10},"end":{"line":1014,"column":11}},"type":"if","locations":[{"start":{"line":996,"column":10},"end":{"line":1014,"column":11}},{"start":{},"end":{}}],"line":996},"113":{"loc":{"start":{"line":997,"column":12},"end":{"line":1013,"column":13}},"type":"if","locations":[{"start":{"line":997,"column":12},"end":{"line":1013,"column":13}},{"start":{"line":1005,"column":19},"end":{"line":1013,"column":13}}],"line":997},"114":{"loc":{"start":{"line":998,"column":14},"end":{"line":1004,"column":15}},"type":"if","locations":[{"start":{"line":998,"column":14},"end":{"line":1004,"column":15}},{"start":{"line":1001,"column":21},"end":{"line":1004,"column":15}}],"line":998},"115":{"loc":{"start":{"line":998,"column":18},"end":{"line":998,"column":64}},"type":"binary-expr","locations":[{"start":{"line":998,"column":18},"end":{"line":998,"column":40}},{"start":{"line":998,"column":44},"end":{"line":998,"column":64}}],"line":998},"116":{"loc":{"start":{"line":1001,"column":21},"end":{"line":1004,"column":15}},"type":"if","locations":[{"start":{"line":1001,"column":21},"end":{"line":1004,"column":15}},{"start":{},"end":{}}],"line":1001},"117":{"loc":{"start":{"line":1001,"column":25},"end":{"line":1001,"column":72}},"type":"binary-expr","locations":[{"start":{"line":1001,"column":25},"end":{"line":1001,"column":45}},{"start":{"line":1001,"column":49},"end":{"line":1001,"column":72}}],"line":1001},"118":{"loc":{"start":{"line":1006,"column":14},"end":{"line":1012,"column":15}},"type":"if","locations":[{"start":{"line":1006,"column":14},"end":{"line":1012,"column":15}},{"start":{"line":1009,"column":21},"end":{"line":1012,"column":15}}],"line":1006},"119":{"loc":{"start":{"line":1006,"column":18},"end":{"line":1006,"column":70}},"type":"binary-expr","locations":[{"start":{"line":1006,"column":18},"end":{"line":1006,"column":43}},{"start":{"line":1006,"column":47},"end":{"line":1006,"column":70}}],"line":1006},"120":{"loc":{"start":{"line":1009,"column":21},"end":{"line":1012,"column":15}},"type":"if","locations":[{"start":{"line":1009,"column":21},"end":{"line":1012,"column":15}},{"start":{},"end":{}}],"line":1009},"121":{"loc":{"start":{"line":1009,"column":25},"end":{"line":1009,"column":78}},"type":"binary-expr","locations":[{"start":{"line":1009,"column":25},"end":{"line":1009,"column":48}},{"start":{"line":1009,"column":52},"end":{"line":1009,"column":78}}],"line":1009},"122":{"loc":{"start":{"line":1015,"column":10},"end":{"line":1017,"column":11}},"type":"if","locations":[{"start":{"line":1015,"column":10},"end":{"line":1017,"column":11}},{"start":{},"end":{}}],"line":1015},"123":{"loc":{"start":{"line":1015,"column":16},"end":{"line":1015,"column":88}},"type":"binary-expr","locations":[{"start":{"line":1015,"column":16},"end":{"line":1015,"column":47}},{"start":{"line":1015,"column":51},"end":{"line":1015,"column":88}}],"line":1015},"124":{"loc":{"start":{"line":1029,"column":6},"end":{"line":1084,"column":7}},"type":"if","locations":[{"start":{"line":1029,"column":6},"end":{"line":1084,"column":7}},{"start":{},"end":{}}],"line":1029},"125":{"loc":{"start":{"line":1031,"column":8},"end":{"line":1031,"column":30}},"type":"if","locations":[{"start":{"line":1031,"column":8},"end":{"line":1031,"column":30}},{"start":{},"end":{}}],"line":1031},"126":{"loc":{"start":{"line":1033,"column":8},"end":{"line":1033,"column":31}},"type":"if","locations":[{"start":{"line":1033,"column":8},"end":{"line":1033,"column":31}},{"start":{},"end":{}}],"line":1033},"127":{"loc":{"start":{"line":1036,"column":8},"end":{"line":1036,"column":28}},"type":"if","locations":[{"start":{"line":1036,"column":8},"end":{"line":1036,"column":28}},{"start":{},"end":{}}],"line":1036},"128":{"loc":{"start":{"line":1040,"column":31},"end":{"line":1040,"column":82}},"type":"cond-expr","locations":[{"start":{"line":1040,"column":48},"end":{"line":1040,"column":62}},{"start":{"line":1040,"column":65},"end":{"line":1040,"column":82}}],"line":1040},"129":{"loc":{"start":{"line":1041,"column":29},"end":{"line":1041,"column":76}},"type":"cond-expr","locations":[{"start":{"line":1041,"column":46},"end":{"line":1041,"column":58}},{"start":{"line":1041,"column":61},"end":{"line":1041,"column":76}}],"line":1041},"130":{"loc":{"start":{"line":1046,"column":10},"end":{"line":1070,"column":11}},"type":"if","locations":[{"start":{"line":1046,"column":10},"end":{"line":1070,"column":11}},{"start":{"line":1058,"column":17},"end":{"line":1070,"column":11}}],"line":1046},"131":{"loc":{"start":{"line":1047,"column":12},"end":{"line":1057,"column":13}},"type":"if","locations":[{"start":{"line":1047,"column":12},"end":{"line":1057,"column":13}},{"start":{"line":1052,"column":19},"end":{"line":1057,"column":13}}],"line":1047},"132":{"loc":{"start":{"line":1048,"column":14},"end":{"line":1051,"column":15}},"type":"if","locations":[{"start":{"line":1048,"column":14},"end":{"line":1051,"column":15}},{"start":{},"end":{}}],"line":1048},"133":{"loc":{"start":{"line":1053,"column":14},"end":{"line":1056,"column":15}},"type":"if","locations":[{"start":{"line":1053,"column":14},"end":{"line":1056,"column":15}},{"start":{},"end":{}}],"line":1053},"134":{"loc":{"start":{"line":1059,"column":12},"end":{"line":1069,"column":13}},"type":"if","locations":[{"start":{"line":1059,"column":12},"end":{"line":1069,"column":13}},{"start":{"line":1064,"column":19},"end":{"line":1069,"column":13}}],"line":1059},"135":{"loc":{"start":{"line":1060,"column":14},"end":{"line":1063,"column":15}},"type":"if","locations":[{"start":{"line":1060,"column":14},"end":{"line":1063,"column":15}},{"start":{},"end":{}}],"line":1060},"136":{"loc":{"start":{"line":1065,"column":14},"end":{"line":1068,"column":15}},"type":"if","locations":[{"start":{"line":1065,"column":14},"end":{"line":1068,"column":15}},{"start":{},"end":{}}],"line":1065},"137":{"loc":{"start":{"line":1071,"column":10},"end":{"line":1073,"column":11}},"type":"if","locations":[{"start":{"line":1071,"column":10},"end":{"line":1073,"column":11}},{"start":{},"end":{}}],"line":1071},"138":{"loc":{"start":{"line":1071,"column":16},"end":{"line":1071,"column":88}},"type":"binary-expr","locations":[{"start":{"line":1071,"column":16},"end":{"line":1071,"column":47}},{"start":{"line":1071,"column":51},"end":{"line":1071,"column":88}}],"line":1071},"139":{"loc":{"start":{"line":1097,"column":2},"end":{"line":1099,"column":3}},"type":"if","locations":[{"start":{"line":1097,"column":2},"end":{"line":1099,"column":3}},{"start":{},"end":{}}],"line":1097},"140":{"loc":{"start":{"line":1103,"column":2},"end":{"line":1105,"column":3}},"type":"if","locations":[{"start":{"line":1103,"column":2},"end":{"line":1105,"column":3}},{"start":{},"end":{}}],"line":1103}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":6,"7":6,"8":1,"9":0,"10":1,"11":1,"12":6,"13":6,"14":1,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":1,"36":2,"37":2,"38":2,"39":2,"40":2,"41":2,"42":2,"43":2,"44":2,"45":2,"46":2,"47":2,"48":2,"49":2,"50":2,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":2,"71":2,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":2,"119":2,"120":2,"121":0,"122":2,"123":2,"124":0,"125":2,"126":2,"127":2,"128":0,"129":2,"130":0,"131":2,"132":19,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":19,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":2,"147":2,"148":2,"149":2,"150":0,"151":2,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"216":0,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"223":0,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"230":0,"231":0,"232":0,"233":0,"234":0,"235":0,"236":0,"237":0,"238":0,"239":0,"240":0,"241":0,"242":0,"243":0,"244":0,"245":0,"246":0,"247":0,"248":0,"249":0,"250":0,"251":0,"252":0,"253":0,"254":0,"255":0,"256":0,"257":0,"258":0,"259":0,"260":0,"261":0,"262":0,"263":0,"264":0,"265":0,"266":0,"267":0,"268":0,"269":0,"270":0,"271":0,"272":0,"273":0,"274":0,"275":0,"276":0,"277":0,"278":0,"279":0,"280":0,"281":0,"282":0,"283":0,"284":0,"285":0,"286":0,"287":0,"288":0,"289":0,"290":0,"291":0,"292":0,"293":0,"294":0,"295":0,"296":0,"297":0,"298":0,"299":0,"300":0,"301":0,"302":0,"303":0,"304":0,"305":0,"306":0,"307":0,"308":0,"309":0,"310":0,"311":0,"312":0,"313":0,"314":0,"315":0,"316":0,"317":0,"318":0,"319":0,"320":0,"321":0,"322":0,"323":0,"324":0,"325":0,"326":0,"327":0,"328":0,"329":0,"330":0,"331":0,"332":0,"333":0,"334":0,"335":0,"336":0,"337":0,"338":0,"339":0,"340":0,"341":0,"342":0,"343":0,"344":0,"345":0,"346":0,"347":0,"348":0,"349":0,"350":0,"351":0,"352":0,"353":0,"354":0,"355":0,"356":0,"357":0,"358":0,"359":0,"360":0,"361":0,"362":0,"363":0,"364":0,"365":0,"366":0,"367":0,"368":0,"369":0,"370":0,"371":0,"372":0,"373":0,"374":0,"375":0,"376":0,"377":0,"378":0,"379":0,"380":0,"381":0,"382":0,"383":0,"384":0,"385":0,"386":0,"387":0,"388":0,"389":0,"390":0,"391":0,"392":0,"393":0,"394":0,"395":0,"396":0,"397":0,"398":0,"399":0,"400":0,"401":0,"402":0,"403":0,"404":0,"405":0,"406":0,"407":0,"408":0,"409":0,"410":0,"411":0,"412":0,"413":0,"414":0,"415":0,"416":0,"417":0,"418":0,"419":0,"420":0,"421":0,"422":0,"423":0,"424":0,"425":0,"426":0,"427":0,"428":0,"429":0,"430":0,"431":0,"432":0,"433":0,"434":0,"435":0,"436":0,"437":0,"438":0,"439":0,"440":0,"441":0,"442":0,"443":0,"444":0,"445":0,"446":0,"447":0,"448":0,"449":0,"450":0,"451":0,"452":0,"453":0,"454":0,"455":0,"456":0,"457":2,"458":19,"459":0,"460":0,"461":0,"462":0,"463":0,"464":0,"465":0,"466":0,"467":0,"468":0,"469":0,"470":0,"471":0,"472":0,"473":0,"474":0,"475":0,"476":0,"477":0,"478":0,"479":0,"480":0,"481":0,"482":0,"483":0,"484":0,"485":0,"486":0,"487":0,"488":0,"489":0,"490":0,"491":0,"492":0,"493":0,"494":0,"495":0,"496":0,"497":0,"498":0,"499":19,"500":6,"501":6,"502":0,"503":6,"504":6,"505":0,"506":6,"507":6,"508":6,"509":0,"510":6,"511":6,"512":6,"513":6,"514":6,"515":6,"516":6,"517":6,"518":0,"519":0,"520":0,"521":0,"522":0,"523":0,"524":0,"525":0,"526":0,"527":0,"528":0,"529":0,"530":0,"531":0,"532":0,"533":0,"534":0,"535":0,"536":6,"537":6,"538":6,"539":6,"540":0,"541":6,"542":0,"543":1,"544":0,"545":0,"546":0,"547":0,"548":0,"549":0},"f":{"0":1,"1":6,"2":6,"3":0,"4":2,"5":2,"6":2,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":2,"15":2,"16":0,"17":0,"18":19,"19":2,"20":2,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":2,"55":19,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0},"b":{"0":[0,1],"1":[0,1],"2":[6,0],"3":[6,6],"4":[0,6],"5":[0,1],"6":[1,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0,0,0,0,0,0,0,0,0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,2],"25":[0,2],"26":[0,19],"27":[0,0],"28":[0,0],"29":[0,19],"30":[0,0],"31":[0,0],"32":[0,2],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0],"52":[0,0],"53":[0,0],"54":[0,0],"55":[0,0],"56":[0,0],"57":[0,0],"58":[0,0],"59":[0,0],"60":[0,0],"61":[0,0],"62":[0,0],"63":[0,0],"64":[0,0],"65":[0,0],"66":[0,0],"67":[0,0],"68":[0,0],"69":[0,0],"70":[0,0],"71":[0,0],"72":[0,0],"73":[0,0],"74":[0,0],"75":[0,0],"76":[0,0],"77":[0,0],"78":[0,0],"79":[0,0],"80":[0,0],"81":[0,0],"82":[0,0],"83":[0,0],"84":[0,0],"85":[0,0],"86":[0,0],"87":[0,0],"88":[0,0],"89":[0,0],"90":[0,0],"91":[0,0],"92":[0,0],"93":[0,0],"94":[0,0],"95":[0,0],"96":[0,0],"97":[0,0],"98":[0,0],"99":[0,0],"100":[0,0],"101":[0,0],"102":[0,0],"103":[0,0],"104":[0,19],"105":[0,0],"106":[0,0],"107":[0,0],"108":[0,0],"109":[0,0],"110":[0,0],"111":[0,0],"112":[0,0],"113":[0,0],"114":[0,0],"115":[0,0],"116":[0,0],"117":[0,0],"118":[0,0],"119":[0,0],"120":[0,0],"121":[0,0],"122":[0,0],"123":[0,0],"124":[6,13],"125":[0,6],"126":[0,6],"127":[0,6],"128":[3,3],"129":[3,3],"130":[0,0],"131":[0,0],"132":[0,0],"133":[0,0],"134":[0,0],"135":[0,0],"136":[0,0],"137":[0,0],"138":[0,0],"139":[0,0],"140":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/controllers/merge-cell.controller.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-lines-per-function */\n\nimport type {\n    ICommandInfo,\n    IMutationInfo,\n    IRange,\n    Workbook,\n} from '@univerjs/core';\nimport type {\n    IAddWorksheetMergeMutationParams,\n    IInsertColMutationParams,\n    IRemoveColMutationParams,\n    IRemoveRowsMutationParams,\n    IRemoveWorksheetMergeMutationParams,\n} from '../basics/interfaces/mutation-interface';\n\nimport type { IDeleteRangeMoveLeftCommandParams } from '../commands/commands/delete-range-move-left.command';\nimport type { IDeleteRangeMoveUpCommandParams } from '../commands/commands/delete-range-move-up.command';\nimport type { InsertRangeMoveDownCommandParams } from '../commands/commands/insert-range-move-down.command';\nimport type { InsertRangeMoveRightCommandParams } from '../commands/commands/insert-range-move-right.command';\nimport type { IInsertColCommandParams, IInsertRowCommandParams } from '../commands/commands/insert-row-col.command';\nimport type { IMoveRangeCommandParams } from '../commands/commands/move-range.command';\nimport type { IMoveColsCommandParams, IMoveRowsCommandParams } from '../commands/commands/move-rows-cols.command';\nimport type { IMoveRowsMutationParams } from '../commands/mutations/move-rows-cols.mutation';\nimport type { ISetWorksheetActiveOperationParams } from '../commands/operations/set-worksheet-active.operation';\nimport type { EffectRefRangeParams } from '../services/ref-range/type';\nimport {\n    createInterceptorKey,\n    Dimension,\n    Disposable,\n    DisposableCollection,\n    ICommandService,\n    Inject,\n    Injector,\n    InterceptorManager,\n    IUniverInstanceService,\n    Rectangle,\n    Tools,\n    UniverInstanceType,\n} from '@univerjs/core';\nimport { first } from 'rxjs';\nimport { ClearSelectionAllCommand } from '../commands/commands/clear-selection-all.command';\nimport { ClearSelectionFormatCommand } from '../commands/commands/clear-selection-format.command';\nimport { DeleteRangeMoveLeftCommand } from '../commands/commands/delete-range-move-left.command';\nimport { DeleteRangeMoveUpCommand } from '../commands/commands/delete-range-move-up.command';\nimport { InsertRangeMoveDownCommand } from '../commands/commands/insert-range-move-down.command';\nimport { InsertRangeMoveRightCommand } from '../commands/commands/insert-range-move-right.command';\nimport { InsertColCommand, InsertRowCommand } from '../commands/commands/insert-row-col.command';\nimport { MoveRangeCommand } from '../commands/commands/move-range.command';\nimport { RemoveColCommand, RemoveRowCommand } from '../commands/commands/remove-row-col.command';\nimport { getSheetCommandTarget } from '../commands/commands/utils/target-util';\nimport {\n    AddMergeUndoMutationFactory,\n    AddWorksheetMergeMutation,\n} from '../commands/mutations/add-worksheet-merge.mutation';\nimport { InsertColMutation, InsertRowMutation } from '../commands/mutations/insert-row-col.mutation';\nimport { MoveColsMutation, MoveRowsMutation } from '../commands/mutations/move-rows-cols.mutation';\nimport { RemoveColMutation, RemoveRowMutation } from '../commands/mutations/remove-row-col.mutation';\nimport {\n    RemoveMergeUndoMutationFactory,\n    RemoveWorksheetMergeMutation,\n} from '../commands/mutations/remove-worksheet-merge.mutation';\nimport { SetWorksheetActiveOperation } from '../commands/operations/set-worksheet-active.operation';\nimport { RefRangeService } from '../services/ref-range/ref-range.service';\nimport { EffectRefRangId } from '../services/ref-range/type';\nimport { handleMoveCols, handleMoveRows, runRefRangeMutations } from '../services/ref-range/util';\nimport { SheetsSelectionsService } from '../services/selections/selection.service';\nimport { SheetInterceptorService } from '../services/sheet-interceptor/sheet-interceptor.service';\n\nconst mutationIdByRowCol = [InsertColMutation.id, InsertRowMutation.id, RemoveColMutation.id, RemoveRowMutation.id];\nconst mutationIdArrByMove = [MoveRowsMutation.id, MoveColsMutation.id];\n\ntype IMoveRowsOrColsMutationParams = IMoveRowsMutationParams;\n\n/**\n * calculates the selection based on the merged cell type\n * @param {IRange[]} selection\n * @param {Dimension} [type]\n * @return {*}\n */\nexport function getAddMergeMutationRangeByType(selection: IRange[], type?: Dimension) {\n    let ranges = selection;\n    if (type !== undefined) {\n        const rectangles: IRange[] = [];\n        for (let i = 0; i < ranges.length; i++) {\n            const { startRow, endRow, startColumn, endColumn } = ranges[i];\n            if (type === Dimension.ROWS) {\n                for (let r = startRow; r <= endRow; r++) {\n                    const data = {\n                        startRow: r,\n                        endRow: r,\n                        startColumn,\n                        endColumn,\n                    };\n                    rectangles.push(data);\n                }\n            } else if (type === Dimension.COLUMNS) {\n                for (let c = startColumn; c <= endColumn; c++) {\n                    const data = {\n                        startRow,\n                        endRow,\n                        startColumn: c,\n                        endColumn: c,\n                    };\n                    rectangles.push(data);\n                }\n            }\n        }\n        ranges = rectangles;\n    }\n    return ranges;\n}\n\nexport const MERGE_CELL_INTERCEPTOR_CHECK = createInterceptorKey<boolean, IRange[]>('mergeCellPermissionCheck');\n\nexport class MergeCellController extends Disposable {\n    disposableCollection = new DisposableCollection();\n\n    public readonly interceptor = new InterceptorManager({ MERGE_CELL_INTERCEPTOR_CHECK });\n\n    constructor(\n        @Inject(ICommandService) private readonly _commandService: ICommandService,\n        @Inject(RefRangeService) private readonly _refRangeService: RefRangeService,\n        @Inject(IUniverInstanceService) private readonly _univerInstanceService: IUniverInstanceService,\n        @Inject(Injector) private _injector: Injector,\n        @Inject(SheetInterceptorService) private _sheetInterceptorService: SheetInterceptorService,\n        @Inject(SheetsSelectionsService) private _selectionManagerService: SheetsSelectionsService\n    ) {\n        super();\n        this._onRefRangeChange();\n        this._initCommandInterceptor();\n        this._commandExecutedListener();\n    }\n\n    private _initCommandInterceptor() {\n        const self = this;\n        this._sheetInterceptorService.interceptCommand({\n            getMutations(commandInfo) {\n                switch (commandInfo.id) {\n                    case ClearSelectionAllCommand.id:\n                    case ClearSelectionFormatCommand.id: {\n                        // TODO@Gggpound: get by unit id and subUnitId\n                        const workbook = self._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n                        const unitId = workbook.getUnitId();\n                        const worksheet = workbook?.getActiveSheet();\n                        if (!worksheet) {\n                            return { redos: [], undos: [] };\n                        }\n\n                        const subUnitId = worksheet.getSheetId();\n                        const mergeData = worksheet.getConfig().mergeData;\n                        const selections = self._selectionManagerService.getCurrentSelections()?.map((s) => s.range);\n                        if (selections && selections.length > 0) {\n                            const isHasMerge = selections.some((range) =>\n                                mergeData.some((item) => Rectangle.intersects(item, range))\n                            );\n                            if (isHasMerge) {\n                                const removeMergeParams: IRemoveWorksheetMergeMutationParams = {\n                                    unitId,\n                                    subUnitId,\n                                    ranges: selections,\n                                };\n                                const undoRemoveMergeParams: IAddWorksheetMergeMutationParams =\n                                    RemoveMergeUndoMutationFactory(self._injector, removeMergeParams);\n                                const redos: IMutationInfo[] = [\n                                    { id: RemoveWorksheetMergeMutation.id, params: removeMergeParams },\n                                ];\n                                const undos: IMutationInfo[] = [\n                                    { id: AddWorksheetMergeMutation.id, params: undoRemoveMergeParams },\n                                ];\n                                return { redos, undos };\n                            }\n                        }\n                    }\n                }\n\n                return { redos: [], undos: [] };\n            },\n        });\n\n        this._sheetInterceptorService.interceptRanges({\n            getMutations: ({ unitId, subUnitId, ranges }) => {\n                const redos: IMutationInfo[] = [];\n                const undos: IMutationInfo[] = [];\n                const emptyInterceptorArr = { redos, undos };\n                if (!ranges || !ranges.length) {\n                    return emptyInterceptorArr;\n                }\n                const target = getSheetCommandTarget(this._univerInstanceService, { unitId, subUnitId });\n                if (!target) {\n                    return emptyInterceptorArr;\n                }\n                const { worksheet } = target;\n                const mergeData = worksheet.getMergeData();\n                const overlapRanges = mergeData.filter((item) => ranges.some((range) => Rectangle.intersects(item, range)));\n                if (overlapRanges.length) {\n                    redos.push({\n                        id: RemoveWorksheetMergeMutation.id,\n                        params: {\n                            unitId,\n                            subUnitId,\n                            ranges: overlapRanges,\n                        },\n                    });\n                    undos.push({\n                        id: AddWorksheetMergeMutation.id,\n                        params: {\n                            unitId,\n                            subUnitId,\n                            ranges: overlapRanges,\n                        },\n                    });\n                    return { undos, redos };\n                }\n\n                return emptyInterceptorArr;\n            },\n        });\n    }\n\n    refRangeHandle(config: EffectRefRangeParams, unitId: string, subUnitId: string) {\n        switch (config.id) {\n            case EffectRefRangId.MoveColsCommandId: {\n                const params = config.params as unknown as IMoveColsCommandParams;\n                return this._handleMoveColsCommand(params, unitId, subUnitId);\n            }\n            case EffectRefRangId.MoveRowsCommandId: {\n                const params = config.params as unknown as IMoveRowsCommandParams;\n                return this._handleMoveRowsCommand(params, unitId, subUnitId);\n            }\n            case InsertRowCommand.id: {\n                const params = config.params as unknown as IInsertRowCommandParams;\n                const _unitId = params.unitId || unitId;\n                const _subUnitId = params.subUnitId || subUnitId;\n                return this._handleInsertRowCommand(params, _unitId, _subUnitId);\n            }\n            case InsertColCommand.id: {\n                const params = config.params as unknown as IInsertColCommandParams;\n                const _unitId = params.unitId || unitId;\n                const _subUnitId = params.subUnitId || subUnitId;\n                return this._handleInsertColCommand(params, _unitId, _subUnitId);\n            }\n            case RemoveColCommand.id: {\n                const params = config.params as unknown as IRemoveColMutationParams;\n                return this._handleRemoveColCommand(params, unitId, subUnitId);\n            }\n            case RemoveRowCommand.id: {\n                const params = config.params as unknown as IRemoveRowsMutationParams;\n                return this._handleRemoveRowCommand(params, unitId, subUnitId);\n            }\n\n            case MoveRangeCommand.id: {\n                const params = config.params as IMoveRangeCommandParams;\n                return this._handleMoveRangeCommand(params, unitId, subUnitId);\n            }\n            case InsertRangeMoveRightCommand.id: {\n                const params = config.params as unknown as InsertRangeMoveRightCommandParams;\n                return this._handleInsertRangeMoveRightCommand(params, unitId, subUnitId);\n            }\n            case InsertRangeMoveDownCommand.id: {\n                const params = config.params as unknown as InsertRangeMoveDownCommandParams;\n                return this._handleInsertRangeMoveDownCommand(params, unitId, subUnitId);\n            }\n            case DeleteRangeMoveUpCommand.id: {\n                const params = config.params as unknown as IDeleteRangeMoveUpCommandParams;\n                return this._handleDeleteRangeMoveUpCommand(params, unitId, subUnitId);\n            }\n            case DeleteRangeMoveLeftCommand.id: {\n                const params = config.params as unknown as IDeleteRangeMoveLeftCommandParams;\n                return this._handleDeleteRangeMoveLeftCommand(params, unitId, subUnitId);\n            }\n        }\n        return { redos: [], undos: [] };\n    }\n\n    private _onRefRangeChange() {\n        const registerRefRange = (unitId: string, subUnitId: string) => {\n            const workbook = this._univerInstanceService.getUniverSheetInstance(unitId);\n            if (!workbook) {\n                return;\n            }\n            const workSheet = workbook?.getSheetBySheetId(subUnitId);\n            if (!workSheet) {\n                return;\n            }\n\n            this.disposableCollection.dispose();\n            const mergeData = workSheet.getMergeData();\n            // Handles all merged unit tasks,if multiple range effect and called only once.\n            const handler = (config: EffectRefRangeParams) => {\n                return this.refRangeHandle(config, unitId, subUnitId);\n            };\n            mergeData.forEach((range) => {\n                this.disposableCollection.add(this._refRangeService.registerRefRange(range, handler, unitId, subUnitId));\n            });\n        };\n        this.disposeWithMe(\n            this._commandService.onCommandExecuted((commandInfo) => {\n                if (commandInfo.id === SetWorksheetActiveOperation.id) {\n                    const params = commandInfo.params as ISetWorksheetActiveOperationParams;\n                    const sheetId = params.subUnitId;\n                    const unitId = params.unitId;\n                    if (!sheetId || !unitId) {\n                        return;\n                    }\n                    registerRefRange(unitId, sheetId);\n                }\n                if (commandInfo.id === AddWorksheetMergeMutation.id) {\n                    const params = commandInfo.params as IAddWorksheetMergeMutationParams;\n                    const sheetId = params.subUnitId;\n                    const unitId = params.unitId;\n                    if (!sheetId || !unitId) {\n                        return;\n                    }\n                    registerRefRange(params.unitId, params.subUnitId);\n                }\n            })\n        );\n\n        this._univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET).pipe(first((workbook) => !!workbook)).subscribe((workbook) => {\n            const sheet = workbook!.getActiveSheet();\n            if (!sheet) return;\n\n            registerRefRange(workbook!.getUnitId(), sheet.getSheetId());\n        });\n    }\n\n    private _handleMoveRowsCommand(params: IMoveRowsCommandParams, unitId: string, subUnitId: string) {\n        const workbook = getWorkbook(this._univerInstanceService, unitId);\n        if (!workbook) {\n            return this._handleNull();\n        }\n        const worksheet = getWorksheet(workbook, subUnitId);\n        if (!worksheet) {\n            return this._handleNull();\n        }\n        const mergeData = [...worksheet.getMergeData()];\n\n        const removeParams: IRemoveWorksheetMergeMutationParams = { unitId, subUnitId, ranges: [] };\n        const addParams: IAddWorksheetMergeMutationParams = { unitId, subUnitId, ranges: [] };\n        const { fromRange } = params;\n        const { startRow: sourceStart, endRow: sourceEnd } = fromRange;\n        mergeData.forEach((range) => {\n            if (sourceStart <= range.startRow && sourceEnd >= range.endRow) {\n                removeParams.ranges.push(range);\n                const operation = handleMoveRows({ id: EffectRefRangId.MoveRowsCommandId, params }, range);\n                const result = runRefRangeMutations(operation, range);\n                result && addParams.ranges.push(result);\n            }\n        });\n        if (removeParams.ranges.length === 0) {\n            return this._handleNull();\n        }\n        const removeUndo = RemoveMergeUndoMutationFactory(this._injector, removeParams);\n        const addUndo = AddMergeUndoMutationFactory(this._injector, addParams);\n        return {\n            preRedos: [{ id: RemoveWorksheetMergeMutation.id, params: removeParams }],\n            redos: [{ id: AddWorksheetMergeMutation.id, params: addParams }],\n            preUndos: [{ id: RemoveWorksheetMergeMutation.id, params: addUndo }],\n            undos: [{ id: AddWorksheetMergeMutation.id, params: removeUndo }],\n        };\n    }\n\n    private _handleMoveColsCommand(params: IMoveColsCommandParams, unitId: string, subUnitId: string) {\n        const workbook = getWorkbook(this._univerInstanceService, unitId);\n        if (!workbook) {\n            return this._handleNull();\n        }\n        const worksheet = getWorksheet(workbook, subUnitId);\n        if (!worksheet) {\n            return this._handleNull();\n        }\n        const mergeData = [...worksheet.getMergeData()];\n\n        const removeParams: IRemoveWorksheetMergeMutationParams = { unitId, subUnitId, ranges: [] };\n        const addParams: IAddWorksheetMergeMutationParams = { unitId, subUnitId, ranges: [] };\n        const { fromRange } = params;\n        const { startColumn: sourceStart, endColumn: sourceEnd } = fromRange;\n        mergeData.forEach((range) => {\n            if (sourceStart <= range.startColumn && sourceEnd >= range.endColumn) {\n                removeParams.ranges.push(range);\n                const operation = handleMoveCols({ id: EffectRefRangId.MoveColsCommandId, params }, range);\n                const result = runRefRangeMutations(operation, range);\n                result && addParams.ranges.push(result);\n            }\n        });\n        if (removeParams.ranges.length === 0) {\n            return this._handleNull();\n        }\n        const removeUndo = RemoveMergeUndoMutationFactory(this._injector, removeParams);\n        const addUndo = AddMergeUndoMutationFactory(this._injector, addParams);\n        return {\n            preRedos: [{ id: RemoveWorksheetMergeMutation.id, params: removeParams }],\n            redos: [{ id: AddWorksheetMergeMutation.id, params: addParams }],\n            preUndos: [{ id: RemoveWorksheetMergeMutation.id, params: addUndo }],\n            undos: [{ id: AddWorksheetMergeMutation.id, params: removeUndo }],\n        };\n    }\n\n    private _handleMoveRangeCommand(params: IMoveRangeCommandParams, unitId: string, subUnitId: string) {\n        const workbook = getWorkbook(this._univerInstanceService, unitId);\n        if (!workbook) {\n            return this._handleNull();\n        }\n        const worksheet = getWorksheet(workbook, subUnitId);\n        if (!worksheet) {\n            return this._handleNull();\n        }\n        const mergeData = worksheet.getMergeData();\n        const fromMergeRanges = mergeData.filter((item) => Rectangle.intersects(item, params.fromRange));\n        const toMergeRanges = mergeData.filter((item) => Rectangle.intersects(item, params.toRange));\n\n        const willMoveToMergeRanges = fromMergeRanges\n            .map((mergeRange) => Rectangle.getRelativeRange(mergeRange, params.fromRange))\n            .map((relativeRange) => Rectangle.getPositionRange(relativeRange, params.toRange));\n\n        const addMergeCellRanges = getAddMergeMutationRangeByType(willMoveToMergeRanges).filter(\n            (range) => !mergeData.some((mergeRange) => Rectangle.equals(range, mergeRange))\n        );\n\n        const redos: Array<{\n            id: string;\n            params: IAddWorksheetMergeMutationParams | IRemoveWorksheetMergeMutationParams;\n        }> = [\n            {\n                id: RemoveWorksheetMergeMutation.id,\n                params: {\n                    unitId,\n                    subUnitId,\n                    ranges: fromMergeRanges,\n                },\n            },\n            {\n                id: RemoveWorksheetMergeMutation.id,\n                params: {\n                    unitId,\n                    subUnitId,\n                    ranges: toMergeRanges,\n                },\n            },\n            {\n                id: AddWorksheetMergeMutation.id,\n                params: {\n                    unitId,\n                    subUnitId,\n                    ranges: addMergeCellRanges,\n                },\n            },\n        ];\n        const undos: Array<{\n            id: string;\n            params: IAddWorksheetMergeMutationParams | IRemoveWorksheetMergeMutationParams;\n        }> = [\n            {\n                id: RemoveWorksheetMergeMutation.id,\n                params: {\n                    unitId,\n                    subUnitId,\n                    ranges: addMergeCellRanges,\n                },\n            },\n            {\n                id: AddWorksheetMergeMutation.id,\n                params: {\n                    unitId,\n                    subUnitId,\n                    ranges: toMergeRanges,\n                },\n            },\n            {\n                id: AddWorksheetMergeMutation.id,\n                params: {\n                    unitId,\n                    subUnitId,\n                    ranges: fromMergeRanges,\n                },\n            },\n        ];\n        return { redos, undos };\n    }\n\n    private _handleInsertRowCommand(config: IInsertRowCommandParams, unitId: string, subUnitId: string) {\n        const workbook = getWorkbook(this._univerInstanceService, unitId);\n        if (!workbook) {\n            return this._handleNull();\n        }\n        const worksheet = getWorksheet(workbook, subUnitId);\n        if (!worksheet) {\n            return this._handleNull();\n        }\n        const { range } = config;\n        const { startRow, endRow } = range;\n        const oldMergeCells = Tools.deepClone(worksheet.getMergeData()).reduce((mergeCellsHasLapping, cell) => {\n            if (startRow > cell.startRow && startRow <= cell.endRow) {\n                mergeCellsHasLapping.push(cell);\n            }\n            return mergeCellsHasLapping;\n        }, [] as IRange[]);\n\n        if (oldMergeCells.length === 0) {\n            return this._handleNull();\n        }\n\n        const newMergeCells = Tools.deepClone(worksheet.getMergeData()).reduce((mergeCellsHasLapping, cell) => {\n            if (startRow > cell.startRow && startRow <= cell.endRow) {\n                const count = endRow - startRow + 1;\n                cell.endRow += count;\n\n                if (this._checkIsMergeCell(cell)) {\n                    mergeCellsHasLapping.push(cell);\n                }\n            }\n            return mergeCellsHasLapping;\n        }, [] as IRange[]);\n\n        const removeMergeParams: IRemoveWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: oldMergeCells,\n        };\n        const undoRemoveMergeParams: IAddWorksheetMergeMutationParams = RemoveMergeUndoMutationFactory(\n            this._injector,\n            removeMergeParams\n        );\n        const addMergeParams: IAddWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: newMergeCells,\n        };\n        const undoAddMergeParams: IRemoveWorksheetMergeMutationParams = AddMergeUndoMutationFactory(\n            this._injector,\n            addMergeParams\n        );\n        const redos = [\n            { id: RemoveWorksheetMergeMutation.id, params: removeMergeParams },\n            { id: AddWorksheetMergeMutation.id, params: addMergeParams },\n        ];\n        const undos = [\n            { id: RemoveWorksheetMergeMutation.id, params: undoAddMergeParams },\n            { id: AddWorksheetMergeMutation.id, params: undoRemoveMergeParams },\n        ];\n        return { redos, undos };\n    }\n\n    private _handleInsertColCommand(config: IInsertColCommandParams, unitId: string, subUnitId: string) {\n        const { range } = config;\n        const workbook = getWorkbook(this._univerInstanceService, unitId);\n        if (!workbook) {\n            return this._handleNull();\n        }\n        const worksheet = getWorksheet(workbook, subUnitId);\n        if (!worksheet) {\n            return this._handleNull();\n        }\n        const { startColumn, endColumn } = range;\n        const oldMergeCells = Tools.deepClone(worksheet.getMergeData()).reduce((mergeCellsHasLapping, cell) => {\n            if (startColumn > cell.startColumn && startColumn <= cell.endColumn) {\n                mergeCellsHasLapping.push(cell);\n            }\n            return mergeCellsHasLapping;\n        }, [] as IRange[]);\n\n        if (oldMergeCells.length === 0) {\n            return this._handleNull();\n        }\n\n        const newMergeCells = Tools.deepClone(worksheet.getMergeData()).reduce((mergeCellsHasLapping, cell) => {\n            if (startColumn > cell.startColumn && startColumn <= cell.endColumn) {\n                const count = endColumn - startColumn + 1;\n                cell.endColumn += count;\n\n                if (this._checkIsMergeCell(cell)) {\n                    mergeCellsHasLapping.push(cell);\n                }\n            }\n            return mergeCellsHasLapping;\n        }, [] as IRange[]);\n\n        const removeMergeParams: IRemoveWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: oldMergeCells,\n        };\n        const undoRemoveMergeParams: IAddWorksheetMergeMutationParams = RemoveMergeUndoMutationFactory(\n            this._injector,\n            removeMergeParams\n        );\n        const addMergeParams: IAddWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: newMergeCells,\n        };\n        const undoAddMergeParams: IRemoveWorksheetMergeMutationParams = AddMergeUndoMutationFactory(\n            this._injector,\n            addMergeParams\n        );\n        const redos = [\n            { id: RemoveWorksheetMergeMutation.id, params: removeMergeParams },\n            { id: AddWorksheetMergeMutation.id, params: addMergeParams },\n        ];\n        const undos = [\n            { id: RemoveWorksheetMergeMutation.id, params: undoAddMergeParams },\n            { id: AddWorksheetMergeMutation.id, params: undoRemoveMergeParams },\n        ];\n        return { redos, undos };\n    }\n\n    private _handleRemoveColCommand(config: IRemoveColMutationParams, unitId: string, subUnitId: string) {\n        const workbook = getWorkbook(this._univerInstanceService, unitId);\n        if (!workbook) {\n            return this._handleNull();\n        }\n        const worksheet = getWorksheet(workbook, subUnitId);\n        if (!worksheet) {\n            return this._handleNull();\n        }\n        const { range } = config;\n        const { startColumn, endColumn } = range;\n\n        const oldMergeCells = Tools.deepClone(worksheet.getMergeData()).reduce((mergeCellsHasLapping, cell) => {\n            if (Rectangle.intersects(range, cell)) {\n                mergeCellsHasLapping.push(cell);\n            }\n            return mergeCellsHasLapping;\n        }, [] as IRange[]);\n\n        if (oldMergeCells.length === 0) {\n            return this._handleNull();\n        }\n\n        const newMergeCells = Tools.deepClone(worksheet.getMergeData()).reduce((mergeCellsHasLapping, cell) => {\n            if (Rectangle.intersects(range, cell)) {\n                if (startColumn <= cell.startColumn && endColumn >= cell.endColumn) {\n                    return mergeCellsHasLapping;\n                } else if (startColumn >= cell.startColumn && endColumn <= cell.endColumn) {\n                    cell.endColumn -= endColumn - startColumn + 1;\n                } else if (startColumn < cell.startColumn) {\n                    cell.startColumn = startColumn;\n                    cell.endColumn -= endColumn - startColumn + 1;\n                } else if (endColumn > cell.endColumn) {\n                    cell.endColumn = startColumn - 1;\n                }\n                if (this._checkIsMergeCell(cell)) {\n                    mergeCellsHasLapping.push(cell);\n                }\n            }\n            return mergeCellsHasLapping;\n        }, [] as IRange[]);\n\n        const removeMergeMutationParams: IRemoveWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: oldMergeCells,\n        };\n        const undoRemoveMergeMutationParams: IAddWorksheetMergeMutationParams = RemoveMergeUndoMutationFactory(\n            this._injector,\n            removeMergeMutationParams\n        );\n        const addMergeMutationParams: IAddWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: newMergeCells,\n        };\n        const undoAddMergeParams: IRemoveWorksheetMergeMutationParams = AddMergeUndoMutationFactory(\n            this._injector,\n            addMergeMutationParams\n        );\n\n        const preRedos = [{ id: RemoveWorksheetMergeMutation.id, params: removeMergeMutationParams }];\n        const redos = [{ id: AddWorksheetMergeMutation.id, params: addMergeMutationParams }];\n        const preUndos = [{ id: RemoveWorksheetMergeMutation.id, params: undoAddMergeParams }];\n        const undos = [{ id: AddWorksheetMergeMutation.id, params: undoRemoveMergeMutationParams }];\n        return { preUndos, undos, preRedos, redos };\n    }\n\n    private _handleRemoveRowCommand(config: IRemoveRowsMutationParams, unitId: string, subUnitId: string) {\n        const { range } = config;\n        const workbook = getWorkbook(this._univerInstanceService, unitId);\n        if (!workbook) {\n            return this._handleNull();\n        }\n        const worksheet = getWorksheet(workbook, subUnitId);\n        if (!worksheet) {\n            return this._handleNull();\n        }\n\n        const { startRow, endRow } = range;\n\n        const oldMergeCells = Tools.deepClone(worksheet.getMergeData()).reduce((mergeCellsHasLapping, cell) => {\n            if (Rectangle.intersects(range, cell)) {\n                mergeCellsHasLapping.push(cell);\n            }\n            return mergeCellsHasLapping;\n        }, [] as IRange[]);\n\n        if (oldMergeCells.length === 0) {\n            return this._handleNull();\n        }\n\n        const newMergeCells = Tools.deepClone(worksheet.getMergeData()).reduce((mergeCellsHasLapping, cell) => {\n            if (Rectangle.intersects(range, cell)) {\n                if (startRow <= cell.startRow && endRow >= cell.endRow) {\n                    return mergeCellsHasLapping;\n                } else if (startRow >= cell.startRow && endRow <= cell.endRow) {\n                    cell.endRow -= endRow - startRow + 1;\n                } else if (startRow < cell.startRow) {\n                    cell.startRow = startRow;\n                    cell.endRow -= endRow - startRow + 1;\n                } else if (endRow > cell.endRow) {\n                    cell.endRow = startRow - 1;\n                }\n                if (this._checkIsMergeCell(cell)) {\n                    mergeCellsHasLapping.push(cell);\n                }\n            }\n            return mergeCellsHasLapping;\n        }, [] as IRange[]);\n\n        const removeMergeMutationParams: IRemoveWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: oldMergeCells,\n        };\n        const undoRemoveMergeMutationParams: IAddWorksheetMergeMutationParams = RemoveMergeUndoMutationFactory(\n            this._injector,\n            removeMergeMutationParams\n        );\n        const addMergeMutationParams: IAddWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: newMergeCells,\n        };\n        const undoAddMergeParams: IRemoveWorksheetMergeMutationParams = AddMergeUndoMutationFactory(\n            this._injector,\n            addMergeMutationParams\n        );\n\n        const preRedos = [{ id: RemoveWorksheetMergeMutation.id, params: removeMergeMutationParams }];\n        const redos = [{ id: AddWorksheetMergeMutation.id, params: addMergeMutationParams }];\n        const preUndos = [{ id: RemoveWorksheetMergeMutation.id, params: undoAddMergeParams }];\n        const undos = [{ id: AddWorksheetMergeMutation.id, params: undoRemoveMergeMutationParams }];\n        return { preUndos, undos, preRedos, redos };\n    }\n\n    private _handleInsertRangeMoveRightCommand(\n        config: InsertRangeMoveRightCommandParams,\n        unitId: string,\n        subUnitId: string\n    ) {\n        const workbook = getWorkbook(this._univerInstanceService, unitId);\n        if (!workbook) {\n            return this._handleNull();\n        }\n        const worksheet = getWorksheet(workbook, subUnitId);\n        if (!worksheet) {\n            return this._handleNull();\n        }\n        const range = config.range;\n        const maxCol = worksheet.getMaxColumns() - 1;\n        const mergeData = worksheet.getMergeData();\n        const removeMergeData: IRange[] = [];\n        const addMergeData: IRange[] = [];\n        mergeData.forEach((rect) => {\n            const { startRow, endRow, startColumn, endColumn } = range;\n            const intersects = Rectangle.intersects(\n                {\n                    startRow,\n                    startColumn,\n                    endRow,\n                    endColumn: maxCol,\n                },\n                rect\n            );\n            if (intersects) {\n                removeMergeData.push(rect);\n                const contains = Rectangle.contains(\n                    {\n                        startRow,\n                        startColumn,\n                        endRow,\n                        endColumn: maxCol,\n                    },\n                    rect\n                );\n                if (contains) {\n                    const currentColumnsCount = endColumn - startColumn + 1;\n                    addMergeData.push({\n                        startRow: rect.startRow,\n                        startColumn: rect.startColumn + currentColumnsCount,\n                        endRow: rect.endRow,\n                        endColumn: rect.endColumn + currentColumnsCount,\n                    });\n                }\n            }\n        });\n        const removeMergeParams: IRemoveWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: removeMergeData,\n        };\n        const undoRemoveMergeParams: IAddWorksheetMergeMutationParams = RemoveMergeUndoMutationFactory(\n            this._injector,\n            removeMergeParams\n        );\n        const addMergeParams: IAddWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: addMergeData,\n        };\n        const undoAddMergeParams: IRemoveWorksheetMergeMutationParams = AddMergeUndoMutationFactory(\n            this._injector,\n            addMergeParams\n        );\n        return {\n            preRedos: [\n                { id: RemoveWorksheetMergeMutation.id, params: removeMergeParams },\n            ],\n            redos: [\n                {\n                    id: AddWorksheetMergeMutation.id,\n                    params: addMergeParams,\n                },\n            ],\n            preUndos: [\n                { id: RemoveWorksheetMergeMutation.id, params: undoAddMergeParams },\n            ],\n            undos: [\n                {\n                    id: AddWorksheetMergeMutation.id,\n                    params: undoRemoveMergeParams,\n                },\n            ],\n        };\n    }\n\n    private _handleInsertRangeMoveDownCommand(\n        config: InsertRangeMoveDownCommandParams,\n        unitId: string,\n        subUnitId: string\n    ) {\n        const workbook = getWorkbook(this._univerInstanceService, unitId);\n        if (!workbook) {\n            return this._handleNull();\n        }\n        const worksheet = getWorksheet(workbook, subUnitId);\n        if (!worksheet) {\n            return this._handleNull();\n        }\n        const range = config.range;\n        const maxRow = worksheet.getMaxRows() - 1;\n        const mergeData = worksheet.getMergeData();\n        const removeMergeData: IRange[] = [];\n        const addMergeData: IRange[] = [];\n        mergeData.forEach((rect) => {\n            const { startRow, startColumn, endColumn, endRow } = range;\n            const intersects = Rectangle.intersects({ startRow, startColumn, endRow: maxRow, endColumn }, rect);\n            if (intersects) {\n                removeMergeData.push(rect);\n                const contains = Rectangle.contains({ startRow, startColumn, endRow: maxRow, endColumn }, rect);\n                if (contains) {\n                    const rowCount = endRow - startRow + 1;\n                    addMergeData.push({\n                        startRow: rect.startRow + rowCount,\n                        startColumn: rect.startColumn,\n                        endRow: rect.endRow + rowCount,\n                        endColumn: rect.endColumn,\n                    });\n                }\n            }\n        });\n        const removeMergeParams: IRemoveWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: removeMergeData,\n        };\n        const undoRemoveMergeParams: IAddWorksheetMergeMutationParams = RemoveMergeUndoMutationFactory(\n            this._injector,\n            removeMergeParams\n        );\n        const addMergeParams: IAddWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: addMergeData,\n        };\n        const undoAddMergeParams: IRemoveWorksheetMergeMutationParams = AddMergeUndoMutationFactory(\n            this._injector,\n\n            addMergeParams\n        );\n        const preRedos = [\n            {\n                id: RemoveWorksheetMergeMutation.id,\n                params: removeMergeParams,\n            },\n        ];\n        const redos = [\n            {\n                id: AddWorksheetMergeMutation.id,\n                params: addMergeParams,\n            },\n        ];\n        const preUndos = [\n            {\n                id: RemoveWorksheetMergeMutation.id,\n                params: undoAddMergeParams,\n            },\n        ];\n        const undos = [\n            {\n                id: AddWorksheetMergeMutation.id,\n                params: undoRemoveMergeParams,\n            },\n\n        ];\n        return { redos, undos, preRedos, preUndos };\n    }\n\n    private _handleDeleteRangeMoveUpCommand(\n        config: IDeleteRangeMoveUpCommandParams,\n        unitId: string,\n        subUnitId: string\n    ) {\n        const workbook = getWorkbook(this._univerInstanceService, unitId);\n        if (!workbook) {\n            return this._handleNull();\n        }\n        const worksheet = getWorksheet(workbook, subUnitId);\n        if (!worksheet) {\n            return this._handleNull();\n        }\n        const range = config.range;\n        const maxRow = worksheet.getMaxRows() - 1;\n        const mergeData = worksheet.getMergeData();\n        const removeMergeData: IRange[] = [];\n        const addMergeData: IRange[] = [];\n        mergeData.forEach((rect) => {\n            const { startRow, startColumn, endColumn, endRow } = range;\n            const intersects = Rectangle.intersects({ startRow, startColumn, endRow: maxRow, endColumn }, rect);\n            if (intersects) {\n                removeMergeData.push(rect);\n                const contains = Rectangle.contains({ startRow, startColumn, endRow: maxRow, endColumn }, rect);\n                if (contains) {\n                    const rowCount = endRow - startRow + 1;\n                    const range = Rectangle.moveVertical(rect, -rowCount);\n                    addMergeData.push(range);\n                }\n            }\n        });\n        const removeMergeParams: IRemoveWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: removeMergeData,\n        };\n        const undoRemoveMergeParams: IAddWorksheetMergeMutationParams = RemoveMergeUndoMutationFactory(\n            this._injector,\n            removeMergeParams\n        );\n        const addMergeParams: IAddWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: addMergeData,\n        };\n        const undoAddMergeParams: IRemoveWorksheetMergeMutationParams = AddMergeUndoMutationFactory(\n            this._injector,\n            addMergeParams\n        );\n        const preRedos = [\n            {\n                id: RemoveWorksheetMergeMutation.id,\n                params: removeMergeParams,\n            },\n        ];\n        const redos = [\n\n            {\n                id: AddWorksheetMergeMutation.id,\n                params: addMergeParams,\n            },\n        ];\n        const preUndos = [\n            {\n                id: RemoveWorksheetMergeMutation.id,\n                params: undoAddMergeParams,\n            },\n        ];\n        const undos = [\n            {\n                id: AddWorksheetMergeMutation.id,\n                params: undoRemoveMergeParams,\n            },\n\n        ];\n        return { redos, undos, preRedos, preUndos };\n    }\n\n    private _handleDeleteRangeMoveLeftCommand(\n        config: IDeleteRangeMoveLeftCommandParams,\n        unitId: string,\n        subUnitId: string\n    ) {\n        const workbook = getWorkbook(this._univerInstanceService, unitId);\n        if (!workbook) {\n            return this._handleNull();\n        }\n        const worksheet = getWorksheet(workbook, subUnitId);\n        if (!worksheet) {\n            return this._handleNull();\n        }\n        const range = config.range;\n        const maxCol = worksheet.getMaxColumns() - 1;\n        const mergeData = worksheet.getMergeData();\n        const removeMergeData: IRange[] = [];\n        const addMergeData: IRange[] = [];\n        mergeData.forEach((rect) => {\n            const { startRow, endRow, startColumn, endColumn } = range;\n            const intersects = Rectangle.intersects(\n                {\n                    startRow,\n                    startColumn,\n                    endRow,\n                    endColumn: maxCol,\n                },\n                rect\n            );\n            if (intersects) {\n                removeMergeData.push(rect);\n                const contains = Rectangle.contains(\n                    {\n                        startRow,\n                        startColumn,\n                        endRow,\n                        endColumn: maxCol,\n                    },\n                    rect\n                );\n                if (contains) {\n                    const currentColumnsCount = endColumn - startColumn + 1;\n                    addMergeData.push({\n                        startRow: rect.startRow,\n                        startColumn: rect.startColumn - currentColumnsCount,\n                        endRow: rect.endRow,\n                        endColumn: rect.endColumn - currentColumnsCount,\n                    });\n                }\n            }\n        });\n        const removeMergeParams: IRemoveWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: removeMergeData,\n        };\n        const undoRemoveMergeParams: IAddWorksheetMergeMutationParams = RemoveMergeUndoMutationFactory(this._injector, removeMergeParams);\n        const addMergeParams: IAddWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: addMergeData,\n        };\n        const undoAddMergeParams: IRemoveWorksheetMergeMutationParams = AddMergeUndoMutationFactory(this._injector, addMergeParams);\n        return {\n            preRedos: [\n                { id: RemoveWorksheetMergeMutation.id, params: removeMergeParams },\n            ],\n            redos: [\n\n                {\n                    id: AddWorksheetMergeMutation.id,\n                    params: addMergeParams,\n                },\n            ],\n            undos: [\n                {\n                    id: AddWorksheetMergeMutation.id,\n                    params: undoRemoveMergeParams,\n                },\n\n            ],\n            preUndos: [\n                { id: RemoveWorksheetMergeMutation.id, params: undoAddMergeParams },\n            ],\n        };\n    }\n\n    private _checkIsMergeCell(cell: IRange) {\n        return !(cell.startRow === cell.endRow && cell.startColumn === cell.endColumn);\n    }\n\n    private _handleNull() {\n        return { redos: [], undos: [] };\n    }\n\n    private _commandExecutedListener() {\n        this.disposeWithMe(this._commandService.onCommandExecuted((command: ICommandInfo) => {\n            // 1. MoveRowsOrColsMutation\n            if (mutationIdArrByMove.includes(command.id)) {\n                if (!command.params) return;\n                const workbook = this._univerInstanceService.getUniverSheetInstance((command.params as IMoveRowsMutationParams).unitId);\n                if (!workbook) return;\n                const worksheet = workbook.getSheetBySheetId((command.params as IMoveRowsMutationParams).subUnitId);\n                if (!worksheet) return;\n                const { sourceRange, targetRange } = command.params as IMoveRowsOrColsMutationParams;\n                const isRowMove = sourceRange.startColumn === targetRange.startColumn && sourceRange.endColumn === targetRange.endColumn;\n                const moveLength = isRowMove\n                    ? sourceRange.endRow - sourceRange.startRow + 1\n                    : sourceRange.endColumn - sourceRange.startColumn + 1;\n                const sourceStart = isRowMove ? sourceRange.startRow : sourceRange.startColumn;\n                const targetStart = isRowMove ? targetRange.startRow : targetRange.startColumn;\n                const mergeData = worksheet.getConfig().mergeData;\n\n                const adjustedMergedCells: IRange[] = [];\n                mergeData.forEach((merge) => {\n                    let { startRow, endRow, startColumn, endColumn, rangeType } = merge;\n\n                    if (!Rectangle.intersects(merge, sourceRange)) {\n                        if (isRowMove) {\n                            if (sourceStart < startRow && targetStart > endRow) {\n                                startRow -= moveLength;\n                                endRow -= moveLength;\n                            } else if (sourceStart > endRow && targetStart <= startRow) {\n                                startRow += moveLength;\n                                endRow += moveLength;\n                            }\n                        } else {\n                            if (sourceStart < startColumn && targetStart > endColumn) {\n                                startColumn -= moveLength;\n                                endColumn -= moveLength;\n                            } else if (sourceStart > endColumn && targetStart <= startColumn) {\n                                startColumn += moveLength;\n                                endColumn += moveLength;\n                            }\n                        }\n                    }\n\n                    if (!(merge.startRow === merge.endRow && merge.startColumn === merge.endColumn)) {\n                        adjustedMergedCells.push({ startRow, endRow, startColumn, endColumn, rangeType });\n                    }\n                });\n                worksheet.setMergeData(adjustedMergedCells);\n\n                this.disposableCollection.dispose();\n                const { unitId, subUnitId } = command.params as IMoveRowsMutationParams;\n                const handler = (config: EffectRefRangeParams) => {\n                    return this.refRangeHandle(config, unitId, subUnitId);\n                };\n                adjustedMergedCells.forEach((range) => {\n                    this.disposableCollection.add(this._refRangeService.registerRefRange(range, handler, unitId, subUnitId));\n                });\n            }\n\n            // 2. InsertRowsOrCols / RemoveRowsOrCols Mutations\n            if (mutationIdByRowCol.includes(command.id)) {\n                const workbook = this._univerInstanceService.getUniverSheetInstance((command.params as IInsertColMutationParams).unitId);\n                if (!workbook) return;\n                const worksheet = workbook.getSheetBySheetId((command.params as IInsertColMutationParams).subUnitId);\n                if (!worksheet) return;\n\n                const mergeData = worksheet.getConfig().mergeData;\n                const params = command.params as IInsertRowCommandParams;\n                if (!params) return;\n                const { range } = params;\n\n                const isRowOperation = command.id.includes('row');\n                const isAddOperation = command.id.includes('insert');\n\n                const operationStart = isRowOperation ? range.startRow : range.startColumn;\n                const operationEnd = isRowOperation ? range.endRow : range.endColumn;\n                const operationCount = operationEnd - operationStart + 1;\n                const adjustedMergedCells: IRange[] = [];\n\n                mergeData.forEach((merge) => {\n                    let { startRow, endRow, startColumn, endColumn, rangeType } = merge;\n\n                    if (isAddOperation) {\n                        if (isRowOperation) {\n                            if (operationStart <= startRow) {\n                                startRow += operationCount;\n                                endRow += operationCount;\n                            }\n                        } else {\n                            if (operationStart <= startColumn) {\n                                startColumn += operationCount;\n                                endColumn += operationCount;\n                            }\n                        }\n                    } else {\n                        if (isRowOperation) {\n                            if (operationEnd < startRow) {\n                                startRow -= operationCount;\n                                endRow -= operationCount;\n                            }\n                        } else {\n                            if (operationEnd < startColumn) {\n                                startColumn -= operationCount;\n                                endColumn -= operationCount;\n                            }\n                        }\n                    }\n\n                    if (!(merge.startRow === merge.endRow && merge.startColumn === merge.endColumn)) {\n                        adjustedMergedCells.push({ startRow, endRow, startColumn, endColumn, rangeType });\n                    }\n                });\n\n                worksheet.setMergeData(adjustedMergedCells);\n\n                this.disposableCollection.dispose();\n                const { unitId, subUnitId } = command.params as IMoveRowsMutationParams;\n                const handler = (config: EffectRefRangeParams) => {\n                    return this.refRangeHandle(config, unitId, subUnitId);\n                };\n                adjustedMergedCells.forEach((range) => {\n                    this.disposableCollection.add(this._refRangeService.registerRefRange(range, handler, unitId, subUnitId));\n                });\n            }\n        }));\n    }\n}\n\nfunction getWorkbook(univerInstanceService: IUniverInstanceService, unitId?: string) {\n    if (unitId) {\n        return univerInstanceService.getUniverSheetInstance(unitId);\n    }\n    return univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n}\n\nfunction getWorksheet(workbook: Workbook, subUnitId?: string) {\n    if (subUnitId) {\n        return workbook.getSheetBySheetId(subUnitId);\n    }\n    return workbook.getActiveSheet();\n}\n"],"mappings":"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","names":["range"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"cb02b4872926555b778ddf5cbd7595e754a11c4d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/model/range-protection-rule.model.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/model/range-protection-rule.model.ts","statementMap":{"0":{"start":{"line":3,"column":43},"end":{"line":7,"column":23}},"1":{"start":{"line":4,"column":2},"end":{"line":4,"column":52}},"2":{"start":{"line":5,"column":2},"end":{"line":5,"column":58}},"3":{"start":{"line":6,"column":2},"end":{"line":6,"column":24}},"4":{"start":{"line":8,"column":43},"end":{"line":12,"column":23}},"5":{"start":{"line":9,"column":2},"end":{"line":9,"column":64}},"6":{"start":{"line":10,"column":2},"end":{"line":10,"column":38}},"7":{"start":{"line":11,"column":2},"end":{"line":11,"column":24}},"8":{"start":{"line":17,"column":27},"end":{"line":17,"column":36}},"9":{"start":{"line":18,"column":17},"end":{"line":18,"column":30}},"10":{"start":{"line":19,"column":16},"end":{"line":19,"column":48}},"11":{"start":{"line":20,"column":18},"end":{"line":20,"column":31}},"12":{"start":{"line":21,"column":17},"end":{"line":21,"column":50}},"13":{"start":{"line":23,"column":4},"end":{"line":23,"column":33}},"14":{"start":{"line":24,"column":4},"end":{"line":24,"column":34}},"15":{"start":{"line":27,"column":4},"end":{"line":27,"column":32}},"16":{"start":{"line":29,"column":30},"end":{"line":29,"column":56}},"17":{"start":{"line":30,"column":30},"end":{"line":30,"column":75}},"18":{"start":{"line":32,"column":4},"end":{"line":32,"column":48}},"19":{"start":{"line":35,"column":4},"end":{"line":35,"column":47}},"20":{"start":{"line":38,"column":20},"end":{"line":38,"column":58}},"21":{"start":{"line":39,"column":4},"end":{"line":39,"column":31}},"22":{"start":{"line":40,"column":4},"end":{"line":40,"column":69}},"23":{"start":{"line":43,"column":17},"end":{"line":43,"column":65}},"24":{"start":{"line":44,"column":4},"end":{"line":47,"column":5}},"25":{"start":{"line":45,"column":6},"end":{"line":45,"column":58}},"26":{"start":{"line":46,"column":6},"end":{"line":46,"column":74}},"27":{"start":{"line":50,"column":20},"end":{"line":50,"column":55}},"28":{"start":{"line":51,"column":4},"end":{"line":54,"column":5}},"29":{"start":{"line":52,"column":6},"end":{"line":52,"column":61}},"30":{"start":{"line":53,"column":6},"end":{"line":53,"column":80}},"31":{"start":{"line":57,"column":4},"end":{"line":57,"column":60}},"32":{"start":{"line":60,"column":16},"end":{"line":60,"column":84}},"33":{"start":{"line":61,"column":4},"end":{"line":61,"column":29}},"34":{"start":{"line":64,"column":16},"end":{"line":64,"column":55}},"35":{"start":{"line":65,"column":4},"end":{"line":65,"column":30}},"36":{"start":{"line":68,"column":21},"end":{"line":68,"column":44}},"37":{"start":{"line":69,"column":4},"end":{"line":72,"column":5}},"38":{"start":{"line":70,"column":6},"end":{"line":70,"column":45}},"39":{"start":{"line":71,"column":6},"end":{"line":71,"column":42}},"40":{"start":{"line":73,"column":18},"end":{"line":73,"column":43}},"41":{"start":{"line":74,"column":4},"end":{"line":77,"column":5}},"42":{"start":{"line":75,"column":6},"end":{"line":75,"column":42}},"43":{"start":{"line":76,"column":6},"end":{"line":76,"column":41}},"44":{"start":{"line":78,"column":4},"end":{"line":78,"column":19}},"45":{"start":{"line":81,"column":19},"end":{"line":81,"column":21}},"46":{"start":{"line":82,"column":21},"end":{"line":82,"column":44}},"47":{"start":{"line":83,"column":4},"end":{"line":91,"column":7}},"48":{"start":{"line":84,"column":24},"end":{"line":84,"column":47}},"49":{"start":{"line":85,"column":26},"end":{"line":85,"column":47}},"50":{"start":{"line":86,"column":6},"end":{"line":86,"column":26}},"51":{"start":{"line":87,"column":6},"end":{"line":90,"column":9}},"52":{"start":{"line":88,"column":24},"end":{"line":88,"column":48}},"53":{"start":{"line":89,"column":8},"end":{"line":89,"column":58}},"54":{"start":{"line":92,"column":4},"end":{"line":92,"column":18}},"55":{"start":{"line":95,"column":35},"end":{"line":95,"column":44}},"56":{"start":{"line":96,"column":4},"end":{"line":107,"column":7}},"57":{"start":{"line":97,"column":25},"end":{"line":97,"column":36}},"58":{"start":{"line":98,"column":34},"end":{"line":98,"column":43}},"59":{"start":{"line":99,"column":6},"end":{"line":105,"column":9}},"60":{"start":{"line":100,"column":24},"end":{"line":103,"column":37}},"61":{"start":{"line":101,"column":10},"end":{"line":101,"column":35}},"62":{"start":{"line":102,"column":10},"end":{"line":102,"column":25}},"63":{"start":{"line":104,"column":8},"end":{"line":104,"column":36}},"64":{"start":{"line":106,"column":6},"end":{"line":106,"column":30}},"65":{"start":{"line":108,"column":4},"end":{"line":108,"column":25}},"66":{"start":{"line":111,"column":4},"end":{"line":111,"column":31}},"67":{"start":{"line":114,"column":13},"end":{"line":114,"column":38}},"68":{"start":{"line":115,"column":20},"end":{"line":115,"column":58}},"69":{"start":{"line":116,"column":4},"end":{"line":118,"column":5}},"70":{"start":{"line":117,"column":6},"end":{"line":117,"column":37}},"71":{"start":{"line":119,"column":4},"end":{"line":119,"column":14}},"72":{"start":{"line":122,"column":23},"end":{"line":122,"column":46}},"73":{"start":{"line":123,"column":4},"end":{"line":123,"column":33}},"74":{"start":{"line":123,"column":21},"end":{"line":123,"column":33}},"75":{"start":{"line":124,"column":4},"end":{"line":130,"column":5}},"76":{"start":{"line":125,"column":6},"end":{"line":129,"column":7}},"77":{"start":{"line":126,"column":8},"end":{"line":128,"column":9}},"78":{"start":{"line":127,"column":10},"end":{"line":127,"column":37}},"79":{"start":{"line":131,"column":4},"end":{"line":131,"column":16}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":44},"end":{"line":3,"column":45}},"loc":{"start":{"line":3,"column":64},"end":{"line":7,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":8,"column":44},"end":{"line":8,"column":45}},"loc":{"start":{"line":8,"column":64},"end":{"line":12,"column":1}},"line":8},"2":{"name":"(anonymous_2)","decl":{"start":{"line":22,"column":2},"end":{"line":22,"column":3}},"loc":{"start":{"line":22,"column":12},"end":{"line":25,"column":3}},"line":22},"3":{"name":"(anonymous_3)","decl":{"start":{"line":26,"column":2},"end":{"line":26,"column":3}},"loc":{"start":{"line":26,"column":18},"end":{"line":28,"column":3}},"line":26},"4":{"name":"(anonymous_4)","decl":{"start":{"line":31,"column":2},"end":{"line":31,"column":3}},"loc":{"start":{"line":31,"column":26},"end":{"line":33,"column":3}},"line":31},"5":{"name":"(anonymous_5)","decl":{"start":{"line":34,"column":2},"end":{"line":34,"column":3}},"loc":{"start":{"line":34,"column":29},"end":{"line":36,"column":3}},"line":34},"6":{"name":"(anonymous_6)","decl":{"start":{"line":37,"column":2},"end":{"line":37,"column":3}},"loc":{"start":{"line":37,"column":35},"end":{"line":41,"column":3}},"line":37},"7":{"name":"(anonymous_7)","decl":{"start":{"line":42,"column":2},"end":{"line":42,"column":3}},"loc":{"start":{"line":42,"column":36},"end":{"line":48,"column":3}},"line":42},"8":{"name":"(anonymous_8)","decl":{"start":{"line":49,"column":2},"end":{"line":49,"column":3}},"loc":{"start":{"line":49,"column":39},"end":{"line":55,"column":3}},"line":49},"9":{"name":"(anonymous_9)","decl":{"start":{"line":56,"column":2},"end":{"line":56,"column":3}},"loc":{"start":{"line":56,"column":33},"end":{"line":58,"column":3}},"line":56},"10":{"name":"(anonymous_10)","decl":{"start":{"line":59,"column":2},"end":{"line":59,"column":3}},"loc":{"start":{"line":59,"column":40},"end":{"line":62,"column":3}},"line":59},"11":{"name":"(anonymous_11)","decl":{"start":{"line":63,"column":2},"end":{"line":63,"column":3}},"loc":{"start":{"line":63,"column":46},"end":{"line":66,"column":3}},"line":63},"12":{"name":"(anonymous_12)","decl":{"start":{"line":67,"column":2},"end":{"line":67,"column":3}},"loc":{"start":{"line":67,"column":36},"end":{"line":79,"column":3}},"line":67},"13":{"name":"(anonymous_13)","decl":{"start":{"line":80,"column":2},"end":{"line":80,"column":3}},"loc":{"start":{"line":80,"column":13},"end":{"line":93,"column":3}},"line":80},"14":{"name":"(anonymous_14)","decl":{"start":{"line":83,"column":21},"end":{"line":83,"column":22}},"loc":{"start":{"line":83,"column":33},"end":{"line":91,"column":5}},"line":83},"15":{"name":"(anonymous_15)","decl":{"start":{"line":87,"column":26},"end":{"line":87,"column":27}},"loc":{"start":{"line":87,"column":41},"end":{"line":90,"column":7}},"line":87},"16":{"name":"(anonymous_16)","decl":{"start":{"line":94,"column":2},"end":{"line":94,"column":3}},"loc":{"start":{"line":94,"column":18},"end":{"line":109,"column":3}},"line":94},"17":{"name":"(anonymous_17)","decl":{"start":{"line":96,"column":29},"end":{"line":96,"column":30}},"loc":{"start":{"line":96,"column":41},"end":{"line":107,"column":5}},"line":96},"18":{"name":"(anonymous_18)","decl":{"start":{"line":99,"column":38},"end":{"line":99,"column":39}},"loc":{"start":{"line":99,"column":53},"end":{"line":105,"column":7}},"line":99},"19":{"name":"(anonymous_19)","decl":{"start":{"line":100,"column":53},"end":{"line":100,"column":54}},"loc":{"start":{"line":100,"column":71},"end":{"line":103,"column":9}},"line":100},"20":{"name":"(anonymous_20)","decl":{"start":{"line":110,"column":2},"end":{"line":110,"column":3}},"loc":{"start":{"line":110,"column":26},"end":{"line":112,"column":3}},"line":110},"21":{"name":"(anonymous_21)","decl":{"start":{"line":113,"column":2},"end":{"line":113,"column":3}},"loc":{"start":{"line":113,"column":34},"end":{"line":120,"column":3}},"line":113},"22":{"name":"(anonymous_22)","decl":{"start":{"line":121,"column":2},"end":{"line":121,"column":3}},"loc":{"start":{"line":121,"column":48},"end":{"line":132,"column":3}},"line":121}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":3},"end":{"line":7,"column":22}},"type":"binary-expr","locations":[{"start":{"line":7,"column":3},"end":{"line":7,"column":16}},{"start":{"line":7,"column":20},"end":{"line":7,"column":22}}],"line":7},"1":{"loc":{"start":{"line":12,"column":3},"end":{"line":12,"column":22}},"type":"binary-expr","locations":[{"start":{"line":12,"column":3},"end":{"line":12,"column":16}},{"start":{"line":12,"column":20},"end":{"line":12,"column":22}}],"line":12},"2":{"loc":{"start":{"line":44,"column":4},"end":{"line":47,"column":5}},"type":"if","locations":[{"start":{"line":44,"column":4},"end":{"line":47,"column":5}},{"start":{},"end":{}}],"line":44},"3":{"loc":{"start":{"line":51,"column":4},"end":{"line":54,"column":5}},"type":"if","locations":[{"start":{"line":51,"column":4},"end":{"line":54,"column":5}},{"start":{},"end":{}}],"line":51},"4":{"loc":{"start":{"line":60,"column":16},"end":{"line":60,"column":84}},"type":"binary-expr","locations":[{"start":{"line":60,"column":16},"end":{"line":60,"column":55}},{"start":{"line":60,"column":75},"end":{"line":60,"column":84}}],"line":60},"5":{"loc":{"start":{"line":65,"column":11},"end":{"line":65,"column":29}},"type":"cond-expr","locations":[{"start":{"line":65,"column":17},"end":{"line":65,"column":25}},{"start":{"line":65,"column":28},"end":{"line":65,"column":29}}],"line":65},"6":{"loc":{"start":{"line":69,"column":4},"end":{"line":72,"column":5}},"type":"if","locations":[{"start":{"line":69,"column":4},"end":{"line":72,"column":5}},{"start":{},"end":{}}],"line":69},"7":{"loc":{"start":{"line":74,"column":4},"end":{"line":77,"column":5}},"type":"if","locations":[{"start":{"line":74,"column":4},"end":{"line":77,"column":5}},{"start":{},"end":{}}],"line":74},"8":{"loc":{"start":{"line":123,"column":4},"end":{"line":123,"column":33}},"type":"if","locations":[{"start":{"line":123,"column":4},"end":{"line":123,"column":33}},{"start":{},"end":{}}],"line":123},"9":{"loc":{"start":{"line":126,"column":8},"end":{"line":128,"column":9}},"type":"if","locations":[{"start":{"line":126,"column":8},"end":{"line":128,"column":9}},{"start":{},"end":{}}],"line":126}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":2,"9":2,"10":2,"11":2,"12":2,"13":0,"14":0,"15":0,"16":2,"17":2,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0},"f":{"0":1,"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},"b":{"0":[1,1],"1":[1,1],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/model/range-protection-rule.model.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IDisposable, IRange } from '@univerjs/core';\nimport type { UnitObject } from '@univerjs/protocol';\nimport { Tools } from '@univerjs/core';\n\nimport { BehaviorSubject, Subject } from 'rxjs';\n\nexport enum ViewStateEnum {\n    OthersCanView = 'othersCanView',\n    NoOneElseCanView = 'noOneElseCanView',\n}\n\nexport enum EditStateEnum {\n    DesignedUserCanEdit = 'designedUserCanEdit',\n    OnlyMe = 'onlyMe',\n}\n\nexport interface IRangeProtectionRule {\n    ranges: IRange[];\n    permissionId: string;\n    id: string;\n    description?: string;\n    unitType: UnitObject;\n    unitId: string;\n    subUnitId: string;\n    viewState: ViewStateEnum;\n    editState: EditStateEnum;\n}\nexport type IObjectModel = Record<string, Record<string, IRangeProtectionRule[]>>;\n\nexport type IModel = Map<string, Map<string, Map<string, IRangeProtectionRule>>>;\n\nexport interface IRuleChange {\n    unitId: string;\n    subUnitId: string;\n    rule: IRangeProtectionRule;\n    oldRule?: IRangeProtectionRule;\n    type: IRuleChangeType;\n}\n\ntype IRuleChangeType = 'add' | 'set' | 'delete';\n\nexport class RangeProtectionRuleModel implements IDisposable {\n    /**\n     * Map<unitId, Map<subUnitId, Map<ruleId, IRangeProtectionRule>>>\n     */\n    private _model: IModel = new Map();\n\n    private readonly _ruleChange$ = new Subject<IRuleChange>();\n    readonly ruleChange$ = this._ruleChange$.asObservable();\n\n    private _ruleRefresh$ = new Subject<string>();\n    ruleRefresh$ = this._ruleRefresh$.asObservable();\n\n    dispose(): void {\n        this._ruleChange$.complete();\n        this._ruleRefresh$.complete();\n    }\n\n    ruleRefresh(id: string) {\n        this._ruleRefresh$.next(id);\n    }\n\n    private _rangeRuleInitStateChange = new BehaviorSubject<boolean>(false);\n    rangeRuleInitStateChange$ = this._rangeRuleInitStateChange.asObservable();\n\n    getRangeRuleInitState() {\n        return this._rangeRuleInitStateChange.value;\n    }\n\n    changeRuleInitState(state: boolean) {\n        this._rangeRuleInitStateChange.next(state);\n    }\n\n    addRule(unitId: string, subUnitId: string, rule: IRangeProtectionRule) {\n        const ruleMap = this._ensureRuleMap(unitId, subUnitId);\n        ruleMap.set(rule.id, rule);\n        this._ruleChange$.next({ unitId, subUnitId, rule, type: 'add' });\n    }\n\n    deleteRule(unitId: string, subUnitId: string, id: string) {\n        const rule = this._model.get(unitId)?.get(subUnitId)?.get(id);\n        if (rule) {\n            this._model.get(unitId)?.get(subUnitId)?.delete(id);\n            this._ruleChange$.next({ unitId, subUnitId, rule, type: 'delete' });\n        }\n    }\n\n    setRule(unitId: string, subUnitId: string, id: string, rule: IRangeProtectionRule) {\n        const oldRule = this.getRule(unitId, subUnitId, id);\n        if (oldRule) {\n            this._model.get(unitId)?.get(subUnitId)?.set(id, rule);\n            this._ruleChange$.next({ unitId, subUnitId, oldRule, rule, type: 'set' });\n        }\n    }\n\n    getRule(unitId: string, subUnitId: string, id: string) {\n        return this._model.get(unitId)?.get(subUnitId)?.get(id);\n    }\n\n    getSubunitRuleList(unitId: string, subUnitId: string) {\n        const map = this._model.get(unitId)?.get(subUnitId) || new Map();\n        return [...map.values()] as IRangeProtectionRule[];\n    }\n\n    getSubunitRuleListLength(unitId: string, subUnitId: string) {\n        const map = this._model.get(unitId)?.get(subUnitId);\n        return map ? map.size : 0;\n    }\n\n    private _ensureRuleMap(unitId: string, subUnitId: string) {\n        let subUnitMap = this._model.get(unitId);\n        if (!subUnitMap) {\n            subUnitMap = new Map();\n            this._model.set(unitId, subUnitMap);\n        }\n        let ruleMap = subUnitMap.get(subUnitId);\n\n        if (!ruleMap) {\n            ruleMap = new Map<string, IRangeProtectionRule>();\n            subUnitMap.set(subUnitId, ruleMap);\n        }\n        return ruleMap;\n    }\n\n    toObject() {\n        const result: IObjectModel = {};\n        const unitKeys = [...this._model.keys()];\n        unitKeys.forEach((unitId) => {\n            const submitMap = this._model.get(unitId)!;\n            const subUnitKeys = [...submitMap.keys()];\n            result[unitId] = {};\n            subUnitKeys.forEach((subunitId) => {\n                const ruleMap = submitMap.get(subunitId)!;\n                result[unitId][subunitId] = [...ruleMap.values()];\n            });\n        });\n        return result;\n    }\n\n    fromObject(obj: IObjectModel) {\n        const result: IModel = new Map();\n        Object.keys(obj).forEach((unitId) => {\n            const subUnitObj = obj[unitId];\n            const map = new Map<string, Map<string, IRangeProtectionRule>>();\n            Object.keys(subUnitObj).forEach((subunitId) => {\n                const ruleMap = subUnitObj[subunitId].reduce((result, cur) => {\n                    result.set(cur.id, cur);\n                    return result;\n                }, new Map<string, IRangeProtectionRule>());\n                map.set(subunitId, ruleMap);\n            });\n            result.set(unitId, map);\n        });\n        this._model = result;\n    }\n\n    deleteUnitModel(unitId: string) {\n        this._model.delete(unitId);\n    }\n\n    createRuleId(unitId: string, subUnitId: string) {\n        let id = Tools.generateRandomId(4);\n        const ruleMap = this._ensureRuleMap(unitId, subUnitId);\n        while (ruleMap.has(id)) {\n            id = Tools.generateRandomId(4);\n        }\n        return id;\n    }\n\n    getTargetByPermissionId(unitId: string, permissionId: string) {\n        const subUnitMap = this._model.get(unitId);\n        if (!subUnitMap) return null;\n        for (const [subUnitId, ruleMap] of subUnitMap) {\n            for (const rule of ruleMap.values()) {\n                if (rule.permissionId === permissionId) {\n                    return [unitId, subUnitId];\n                }\n            }\n        }\n        return null;\n    }\n}\n"],"mappings":"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","names":["ViewStateEnum","EditStateEnum","result"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"e75ecdfdf8ac7cd531fc82b4ec9407a86dd462f7"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/border-style-manager.service.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/border-style-manager.service.ts","statementMap":{"0":{"start":{"line":4,"column":16},"end":{"line":9,"column":3}},"1":{"start":{"line":10,"column":17},"end":{"line":10,"column":54}},"2":{"start":{"line":11,"column":16},"end":{"line":11,"column":48}},"3":{"start":{"line":13,"column":4},"end":{"line":13,"column":33}},"4":{"start":{"line":16,"column":4},"end":{"line":16,"column":33}},"5":{"start":{"line":17,"column":4},"end":{"line":17,"column":35}},"6":{"start":{"line":18,"column":4},"end":{"line":18,"column":20}},"7":{"start":{"line":21,"column":4},"end":{"line":21,"column":35}},"8":{"start":{"line":22,"column":4},"end":{"line":22,"column":20}},"9":{"start":{"line":25,"column":4},"end":{"line":25,"column":35}},"10":{"start":{"line":26,"column":4},"end":{"line":26,"column":20}},"11":{"start":{"line":29,"column":4},"end":{"line":29,"column":47}},"12":{"start":{"line":32,"column":4},"end":{"line":32,"column":28}},"13":{"start":{"line":35,"column":4},"end":{"line":35,"column":45}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":2},"end":{"line":12,"column":3}},"loc":{"start":{"line":12,"column":12},"end":{"line":14,"column":3}},"line":12},"1":{"name":"(anonymous_1)","decl":{"start":{"line":15,"column":2},"end":{"line":15,"column":3}},"loc":{"start":{"line":15,"column":16},"end":{"line":19,"column":3}},"line":15},"2":{"name":"(anonymous_2)","decl":{"start":{"line":20,"column":2},"end":{"line":20,"column":3}},"loc":{"start":{"line":20,"column":18},"end":{"line":23,"column":3}},"line":20},"3":{"name":"(anonymous_3)","decl":{"start":{"line":24,"column":2},"end":{"line":24,"column":3}},"loc":{"start":{"line":24,"column":18},"end":{"line":27,"column":3}},"line":24},"4":{"name":"(anonymous_4)","decl":{"start":{"line":28,"column":2},"end":{"line":28,"column":3}},"loc":{"start":{"line":28,"column":30},"end":{"line":30,"column":3}},"line":28},"5":{"name":"(anonymous_5)","decl":{"start":{"line":31,"column":2},"end":{"line":31,"column":3}},"loc":{"start":{"line":31,"column":18},"end":{"line":33,"column":3}},"line":31},"6":{"name":"(anonymous_6)","decl":{"start":{"line":34,"column":2},"end":{"line":34,"column":3}},"loc":{"start":{"line":34,"column":13},"end":{"line":36,"column":3}},"line":34}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/border-style-manager.service.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IDisposable } from '@univerjs/core';\nimport { BorderStyleTypes, BorderType } from '@univerjs/core';\nimport { BehaviorSubject } from 'rxjs';\n\nexport interface IBorderInfo {\n    type: BorderType;\n    color: string | undefined;\n    style: BorderStyleTypes;\n    activeBorderType: boolean; // When you click on the border type, then click on the color and style, it should take effect immediately.\n}\n\n/**\n * This service is for managing settings border style status.\n */\nexport class BorderStyleManagerService implements IDisposable {\n    private readonly _borderInfo: IBorderInfo = {\n        type: BorderType.ALL,\n        color: '#000000',\n        style: BorderStyleTypes.THIN,\n        activeBorderType: false,\n    };\n\n    private readonly _borderInfo$ = new BehaviorSubject<IBorderInfo>(this._borderInfo);\n    readonly borderInfo$ = this._borderInfo$.asObservable();\n\n    dispose(): void {\n        this._borderInfo$.complete();\n    }\n\n    setType(type: BorderType): void {\n        this._borderInfo.type = type;\n        this.setActiveBorderType(true);\n        this._refresh();\n    }\n\n    setColor(color: string): void {\n        this._borderInfo.color = color;\n        this._refresh();\n    }\n\n    setStyle(style: BorderStyleTypes): void {\n        this._borderInfo.style = style;\n        this._refresh();\n    }\n\n    setActiveBorderType(status: boolean) {\n        this._borderInfo.activeBorderType = status;\n    }\n\n    getBorderInfo(): Readonly<IBorderInfo> {\n        return this._borderInfo;\n    }\n\n    private _refresh(): void {\n        this._borderInfo$.next(this._borderInfo);\n    }\n}\n"],"mappings":"AAiBA,SAAS,kBAAkB,kBAAkB;AAC7C,SAAS,uBAAuB;AAYzB,aAAM,0BAAiD;AAAA,EACzC,cAA2B;AAAA,IACxC,MAAM,WAAW;AAAA,IACjB,OAAO;AAAA,IACP,OAAO,iBAAiB;AAAA,IACxB,kBAAkB;AAAA,EACtB;AAAA,EAEiB,eAAe,IAAI,gBAA6B,KAAK,WAAW;AAAA,EACxE,cAAc,KAAK,aAAa,aAAa;AAAA,EAEtD,UAAgB;AACZ,SAAK,aAAa,SAAS;AAAA,EAC/B;AAAA,EAEA,QAAQ,MAAwB;AAC5B,SAAK,YAAY,OAAO;AACxB,SAAK,oBAAoB,IAAI;AAC7B,SAAK,SAAS;AAAA,EAClB;AAAA,EAEA,SAAS,OAAqB;AAC1B,SAAK,YAAY,QAAQ;AACzB,SAAK,SAAS;AAAA,EAClB;AAAA,EAEA,SAAS,OAA+B;AACpC,SAAK,YAAY,QAAQ;AACzB,SAAK,SAAS;AAAA,EAClB;AAAA,EAEA,oBAAoB,QAAiB;AACjC,SAAK,YAAY,mBAAmB;AAAA,EACxC;AAAA,EAEA,gBAAuC;AACnC,WAAO,KAAK;AAAA,EAChB;AAAA,EAEQ,WAAiB;AACrB,SAAK,aAAa,KAAK,KAAK,WAAW;AAAA,EAC3C;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"fc07f189dda3059ee2d0113eff570284c64274c3"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/delete-protection.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/delete-protection.ts","statementMap":{"0":{"start":{"line":4,"column":9},"end":{"line":4,"column":31}},"1":{"start":{"line":5,"column":12},"end":{"line":5,"column":29}},"2":{"start":{"line":6,"column":11},"end":{"line":6,"column":32}},"3":{"start":{"line":7,"column":10},"end":{"line":7,"column":14}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":25}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":31}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":37}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":79}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":2},"end":{"line":12,"column":3}},"loc":{"start":{"line":12,"column":47},"end":{"line":17,"column":3}},"line":12}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/delete-protection.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class RangeProtectionPermissionDeleteProtectionPoint implements IPermissionPoint {\n    type = UnitObject.SelectRange;\n    subType = UnitAction.Delete;\n    status = PermissionStatus.INIT;\n    value = true;\n    id: string;\n    unitId: string;\n    subUnitId: string;\n    permissionId: string;\n    constructor(unitId: string, subUnitId: string, permissionId: string) {\n        this.unitId = unitId;\n        this.subUnitId = subUnitId;\n        this.permissionId = permissionId;\n        this.id = `${UnitObject.SelectRange}.${UnitAction.Delete}.${permissionId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,+CAA2E;AAAA,EACpF,OAAO,WAAW;AAAA,EAClB,UAAU,WAAW;AAAA,EACrB,SAAS,iBAAiB;AAAA,EAC1B,QAAQ;AAAA,EACR;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,YAAY,QAAgB,WAAmB,cAAsB;AACjE,SAAK,SAAS;AACd,SAAK,YAAY;AACjB,SAAK,eAAe;AACpB,SAAK,KAAK,GAAG,WAAW,WAAW,IAAI,WAAW,MAAM,IAAI,YAAY;AAAA,EAC5E;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"92913ae64053429b40685e29dc015fde3b465ad7"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/manage-collaborator.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/manage-collaborator.ts","statementMap":{"0":{"start":{"line":4,"column":9},"end":{"line":4,"column":31}},"1":{"start":{"line":5,"column":12},"end":{"line":5,"column":41}},"2":{"start":{"line":6,"column":11},"end":{"line":6,"column":32}},"3":{"start":{"line":7,"column":10},"end":{"line":7,"column":14}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":25}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":31}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":37}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":91}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":2},"end":{"line":12,"column":3}},"loc":{"start":{"line":12,"column":47},"end":{"line":17,"column":3}},"line":12}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/manage-collaborator.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class RangeProtectionPermissionManageCollaPoint implements IPermissionPoint {\n    type = UnitObject.SelectRange;\n    subType = UnitAction.ManageCollaborator;\n    status = PermissionStatus.INIT;\n    value = true;\n    id: string;\n    unitId: string;\n    subUnitId: string;\n    permissionId: string;\n    constructor(unitId: string, subUnitId: string, permissionId: string) {\n        this.unitId = unitId;\n        this.subUnitId = subUnitId;\n        this.permissionId = permissionId;\n        this.id = `${UnitObject.SelectRange}.${UnitAction.ManageCollaborator}.${permissionId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,0CAAsE;AAAA,EAC/E,OAAO,WAAW;AAAA,EAClB,UAAU,WAAW;AAAA,EACrB,SAAS,iBAAiB;AAAA,EAC1B,QAAQ;AAAA,EACR;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,YAAY,QAAgB,WAAmB,cAAsB;AACjE,SAAK,SAAS;AACd,SAAK,YAAY;AACjB,SAAK,eAAe;AACpB,SAAK,KAAK,GAAG,WAAW,WAAW,IAAI,WAAW,kBAAkB,IAAI,YAAY;AAAA,EACxF;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c2583668b2500d16234334d15593f5dac2b8ddf1"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/range-permission/util.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/range-permission/util.ts","statementMap":{"0":{"start":{"line":6,"column":42},"end":{"line":6,"column":211}},"1":{"start":{"line":6,"column":48},"end":{"line":6,"column":211}},"2":{"start":{"line":7,"column":37},"end":{"line":7,"column":121}},"3":{"start":{"line":8,"column":41},"end":{"line":12,"column":6}},"4":{"start":{"line":8,"column":120},"end":{"line":12,"column":6}},"5":{"start":{"line":9,"column":12},"end":{"line":9,"column":50}},"6":{"start":{"line":10,"column":2},"end":{"line":10,"column":25}},"7":{"start":{"line":11,"column":2},"end":{"line":11,"column":11}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":42},"end":{"line":6,"column":43}},"loc":{"start":{"line":6,"column":48},"end":{"line":6,"column":211}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":8,"column":41},"end":{"line":8,"column":42}},"loc":{"start":{"line":8,"column":120},"end":{"line":12,"column":6}},"line":8},"2":{"name":"(anonymous_2)","decl":{"start":{"line":8,"column":156},"end":{"line":8,"column":157}},"loc":{"start":{"line":8,"column":166},"end":{"line":12,"column":1}},"line":8}},"branchMap":{"0":{"loc":{"start":{"line":8,"column":42},"end":{"line":8,"column":59}},"type":"default-arg","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":59}}],"line":8},"1":{"loc":{"start":{"line":8,"column":61},"end":{"line":8,"column":84}},"type":"default-arg","locations":[{"start":{"line":8,"column":73},"end":{"line":8,"column":84}}],"line":8},"2":{"loc":{"start":{"line":8,"column":86},"end":{"line":8,"column":115}},"type":"default-arg","locations":[{"start":{"line":8,"column":101},"end":{"line":8,"column":115}}],"line":8}},"s":{"0":1,"1":0,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0},"f":{"0":0,"1":0,"2":0},"b":{"0":[0],"1":[0],"2":[0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/range-permission/util.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UnitAction } from '@univerjs/protocol';\nimport { RangeProtectionPermissionDeleteProtectionPoint } from '../permission-point/range/delete-protection';\nimport { RangeProtectionPermissionEditPoint } from '../permission-point/range/edit';\nimport { RangeProtectionPermissionManageCollaPoint } from '../permission-point/range/manage-collaborator';\nimport { RangeProtectionPermissionViewPoint } from '../permission-point/range/view';\n\nexport type IRangePermissionPoint = RangeProtectionPermissionEditPoint | RangeProtectionPermissionViewPoint;\n\nexport const getAllRangePermissionPoint = () => [RangeProtectionPermissionViewPoint, RangeProtectionPermissionEditPoint, RangeProtectionPermissionManageCollaPoint, RangeProtectionPermissionDeleteProtectionPoint];\n\nexport const baseProtectionActions = [UnitAction.Edit, UnitAction.View, UnitAction.ManageCollaborator, UnitAction.Delete];\n\nexport const getDefaultRangePermission = (unitId = 'unitId', subUnitId = 'subUnitId', permissionId = 'permissionId') => getAllRangePermissionPoint().reduce((r, F) => {\n    const i = new F(unitId, subUnitId, permissionId);\n    r[i.subType] = i.value;\n    return r;\n}, {} as Record<UnitAction, boolean>);\n"],"mappings":"AAgBA,SAAS,kBAAkB;AAC3B,SAAS,sDAAsD;AAC/D,SAAS,0CAA0C;AACnD,SAAS,iDAAiD;AAC1D,SAAS,0CAA0C;AAI5C,aAAM,6BAA6B,MAAM,CAAC,oCAAoC,oCAAoC,2CAA2C,8CAA8C;AAE3M,aAAM,wBAAwB,CAAC,WAAW,MAAM,WAAW,MAAM,WAAW,oBAAoB,WAAW,MAAM;AAEjH,aAAM,4BAA4B,CAAC,SAAS,UAAU,YAAY,aAAa,eAAe,mBAAmB,2BAA2B,EAAE,OAAO,CAAC,GAAG,MAAM;AAClK,QAAM,IAAI,IAAI,EAAE,QAAQ,WAAW,YAAY;AAC/C,IAAE,EAAE,OAAO,IAAI,EAAE;AACjB,SAAO;AACX,GAAG,CAAC,CAAgC;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"98561f63789a6bf27b06de273ba52f1ac31c7851"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/index.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/index.ts","statementMap":{},"fnMap":{},"branchMap":{},"s":{},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/index.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport { WorksheetProtectionPointModel } from './worksheet-permission-point.model';\nexport { WorksheetProtectionRuleModel } from './worksheet-permission-rule.model';\nexport { WorksheetPermissionService } from './worksheet-permission.service';\n"],"mappings":"AAgBA,SAAS,qCAAqC;AAC9C,SAAS,oCAAoC;AAC7C,SAAS,kCAAkC;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"02c010c187659fba59fdd95827cc2dc9634fa0fe"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission-point.model.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission-point.model.ts","statementMap":{"0":{"start":{"line":3,"column":27},"end":{"line":3,"column":36}},"1":{"start":{"line":4,"column":17},"end":{"line":4,"column":30}},"2":{"start":{"line":5,"column":17},"end":{"line":5,"column":49}},"3":{"start":{"line":7,"column":23},"end":{"line":7,"column":58}},"4":{"start":{"line":8,"column":4},"end":{"line":8,"column":41}},"5":{"start":{"line":9,"column":4},"end":{"line":9,"column":33}},"6":{"start":{"line":12,"column":17},"end":{"line":12,"column":56}},"7":{"start":{"line":13,"column":4},"end":{"line":16,"column":5}},"8":{"start":{"line":14,"column":6},"end":{"line":14,"column":50}},"9":{"start":{"line":15,"column":6},"end":{"line":15,"column":35}},"10":{"start":{"line":19,"column":4},"end":{"line":19,"column":52}},"11":{"start":{"line":22,"column":19},"end":{"line":22,"column":21}},"12":{"start":{"line":23,"column":21},"end":{"line":23,"column":44}},"13":{"start":{"line":24,"column":4},"end":{"line":36,"column":7}},"14":{"start":{"line":25,"column":25},"end":{"line":25,"column":48}},"15":{"start":{"line":26,"column":6},"end":{"line":35,"column":7}},"16":{"start":{"line":27,"column":8},"end":{"line":27,"column":28}},"17":{"start":{"line":28,"column":28},"end":{"line":28,"column":50}},"18":{"start":{"line":29,"column":8},"end":{"line":34,"column":11}},"19":{"start":{"line":30,"column":23},"end":{"line":30,"column":48}},"20":{"start":{"line":31,"column":10},"end":{"line":33,"column":11}},"21":{"start":{"line":32,"column":12},"end":{"line":32,"column":38}},"22":{"start":{"line":37,"column":4},"end":{"line":37,"column":18}},"23":{"start":{"line":40,"column":35},"end":{"line":40,"column":44}},"24":{"start":{"line":41,"column":4},"end":{"line":50,"column":7}},"25":{"start":{"line":42,"column":26},"end":{"line":42,"column":37}},"26":{"start":{"line":43,"column":6},"end":{"line":49,"column":7}},"27":{"start":{"line":44,"column":43},"end":{"line":44,"column":52}},"28":{"start":{"line":45,"column":8},"end":{"line":47,"column":11}},"29":{"start":{"line":46,"column":10},"end":{"line":46,"column":47}},"30":{"start":{"line":48,"column":8},"end":{"line":48,"column":39}},"31":{"start":{"line":51,"column":4},"end":{"line":51,"column":25}},"32":{"start":{"line":54,"column":4},"end":{"line":54,"column":31}},"33":{"start":{"line":57,"column":21},"end":{"line":57,"column":44}},"34":{"start":{"line":58,"column":4},"end":{"line":61,"column":5}},"35":{"start":{"line":59,"column":6},"end":{"line":59,"column":45}},"36":{"start":{"line":60,"column":6},"end":{"line":60,"column":42}},"37":{"start":{"line":62,"column":4},"end":{"line":62,"column":22}},"38":{"start":{"line":65,"column":23},"end":{"line":65,"column":46}},"39":{"start":{"line":66,"column":4},"end":{"line":66,"column":33}},"40":{"start":{"line":66,"column":21},"end":{"line":66,"column":33}},"41":{"start":{"line":67,"column":4},"end":{"line":71,"column":5}},"42":{"start":{"line":68,"column":6},"end":{"line":70,"column":7}},"43":{"start":{"line":69,"column":8},"end":{"line":69,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":2},"end":{"line":6,"column":3}},"loc":{"start":{"line":6,"column":16},"end":{"line":10,"column":3}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":2},"end":{"line":11,"column":3}},"loc":{"start":{"line":11,"column":32},"end":{"line":17,"column":3}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":18,"column":2},"end":{"line":18,"column":3}},"loc":{"start":{"line":18,"column":29},"end":{"line":20,"column":3}},"line":18},"3":{"name":"(anonymous_3)","decl":{"start":{"line":21,"column":2},"end":{"line":21,"column":3}},"loc":{"start":{"line":21,"column":13},"end":{"line":38,"column":3}},"line":21},"4":{"name":"(anonymous_4)","decl":{"start":{"line":24,"column":21},"end":{"line":24,"column":22}},"loc":{"start":{"line":24,"column":33},"end":{"line":36,"column":5}},"line":24},"5":{"name":"(anonymous_5)","decl":{"start":{"line":29,"column":28},"end":{"line":29,"column":29}},"loc":{"start":{"line":29,"column":43},"end":{"line":34,"column":9}},"line":29},"6":{"name":"(anonymous_6)","decl":{"start":{"line":39,"column":2},"end":{"line":39,"column":3}},"loc":{"start":{"line":39,"column":18},"end":{"line":52,"column":3}},"line":39},"7":{"name":"(anonymous_7)","decl":{"start":{"line":41,"column":29},"end":{"line":41,"column":30}},"loc":{"start":{"line":41,"column":41},"end":{"line":50,"column":5}},"line":41},"8":{"name":"(anonymous_8)","decl":{"start":{"line":45,"column":28},"end":{"line":45,"column":29}},"loc":{"start":{"line":45,"column":38},"end":{"line":47,"column":9}},"line":45},"9":{"name":"(anonymous_9)","decl":{"start":{"line":53,"column":2},"end":{"line":53,"column":3}},"loc":{"start":{"line":53,"column":26},"end":{"line":55,"column":3}},"line":53},"10":{"name":"(anonymous_10)","decl":{"start":{"line":56,"column":2},"end":{"line":56,"column":3}},"loc":{"start":{"line":56,"column":28},"end":{"line":63,"column":3}},"line":56},"11":{"name":"(anonymous_11)","decl":{"start":{"line":64,"column":2},"end":{"line":64,"column":3}},"loc":{"start":{"line":64,"column":48},"end":{"line":72,"column":3}},"line":64}},"branchMap":{"0":{"loc":{"start":{"line":13,"column":4},"end":{"line":16,"column":5}},"type":"if","locations":[{"start":{"line":13,"column":4},"end":{"line":16,"column":5}},{"start":{},"end":{}}],"line":13},"1":{"loc":{"start":{"line":26,"column":6},"end":{"line":35,"column":7}},"type":"if","locations":[{"start":{"line":26,"column":6},"end":{"line":35,"column":7}},{"start":{},"end":{}}],"line":26},"2":{"loc":{"start":{"line":31,"column":10},"end":{"line":33,"column":11}},"type":"if","locations":[{"start":{"line":31,"column":10},"end":{"line":33,"column":11}},{"start":{},"end":{}}],"line":31},"3":{"loc":{"start":{"line":43,"column":6},"end":{"line":49,"column":7}},"type":"if","locations":[{"start":{"line":43,"column":6},"end":{"line":49,"column":7}},{"start":{},"end":{}}],"line":43},"4":{"loc":{"start":{"line":58,"column":4},"end":{"line":61,"column":5}},"type":"if","locations":[{"start":{"line":58,"column":4},"end":{"line":61,"column":5}},{"start":{},"end":{}}],"line":58},"5":{"loc":{"start":{"line":66,"column":4},"end":{"line":66,"column":33}},"type":"if","locations":[{"start":{"line":66,"column":4},"end":{"line":66,"column":33}},{"start":{},"end":{}}],"line":66},"6":{"loc":{"start":{"line":68,"column":6},"end":{"line":70,"column":7}},"type":"if","locations":[{"start":{"line":68,"column":6},"end":{"line":70,"column":7}},{"start":{},"end":{}}],"line":68}},"s":{"0":2,"1":2,"2":2,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission-point.model.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IObjectPointModel, IPointRuleModel, IWorksheetProtectionPointRule } from '../type';\nimport { Subject } from 'rxjs';\n\nexport class WorksheetProtectionPointModel {\n    private _model: IPointRuleModel = new Map();\n\n    private _pointChange = new Subject<{\n        unitId: string;\n        subUnitId: string;\n        permissionId: string;\n    }>();\n\n    pointChange$ = this._pointChange.asObservable();\n\n    addRule(rule: IWorksheetProtectionPointRule) {\n        const subUnitMap = this._ensureSubUnitMap(rule.unitId);\n        subUnitMap.set(rule.subUnitId, rule);\n        this._pointChange.next(rule);\n    }\n\n    deleteRule(unitId: string, subUnitId: string) {\n        const rule = this._model.get(unitId)?.get(subUnitId);\n        if (rule) {\n            this._model?.get(unitId)?.delete(subUnitId);\n            this._pointChange.next(rule);\n        }\n    }\n\n    getRule(unitId: string, subUnitId: string) {\n        return this._model?.get(unitId)?.get(subUnitId);\n    }\n\n    toObject() {\n        const result: IObjectPointModel = {};\n        const unitKeys = [...this._model.keys()];\n        unitKeys.forEach((unitId) => {\n            const subUnitMap = this._model.get(unitId);\n            if (subUnitMap?.size) {\n                result[unitId] = [];\n                const subUnitKeys = [...subUnitMap.keys()];\n                subUnitKeys.forEach((subUnitId) => {\n                    const rule = subUnitMap.get(subUnitId);\n                    if (rule) {\n                        result[unitId].push(rule);\n                    }\n                });\n            }\n        });\n        return result;\n    }\n\n    fromObject(obj: IObjectPointModel) {\n        const result: IPointRuleModel = new Map();\n        Object.keys(obj).forEach((unitId) => {\n            const subUnitList = obj[unitId];\n            if (subUnitList?.length) {\n                const subUnitMap = new Map();\n                subUnitList.forEach((rule) => {\n                    subUnitMap.set(rule.subUnitId, rule);\n                });\n                result.set(unitId, subUnitMap);\n            }\n        });\n        this._model = result;\n    }\n\n    deleteUnitModel(unitId: string) {\n        this._model.delete(unitId);\n    }\n\n    private _ensureSubUnitMap(unitId: string) {\n        let subUnitMap = this._model.get(unitId);\n        if (!subUnitMap) {\n            subUnitMap = new Map();\n            this._model.set(unitId, subUnitMap);\n        }\n        return subUnitMap;\n    }\n\n    getTargetByPermissionId(unitId: string, permissionId: string) {\n        const subUnitMap = this._model.get(unitId);\n        if (!subUnitMap) return null;\n        for (const [subUnitId, rule] of subUnitMap) {\n            if (rule.permissionId === permissionId) {\n                return [unitId, subUnitId];\n            }\n        }\n    }\n}\n"],"mappings":"AAiBA,SAAS,eAAe;AAEjB,aAAM,8BAA8B;AAAA,EAC/B,SAA0B,oBAAI,IAAI;AAAA,EAElC,eAAe,IAAI,QAIxB;AAAA,EAEH,eAAe,KAAK,aAAa,aAAa;AAAA,EAE9C,QAAQ,MAAqC;AACzC,UAAM,aAAa,KAAK,kBAAkB,KAAK,MAAM;AACrD,eAAW,IAAI,KAAK,WAAW,IAAI;AACnC,SAAK,aAAa,KAAK,IAAI;AAAA,EAC/B;AAAA,EAEA,WAAW,QAAgB,WAAmB;AAC1C,UAAM,OAAO,KAAK,OAAO,IAAI,MAAM,GAAG,IAAI,SAAS;AACnD,QAAI,MAAM;AACN,WAAK,QAAQ,IAAI,MAAM,GAAG,OAAO,SAAS;AAC1C,WAAK,aAAa,KAAK,IAAI;AAAA,IAC/B;AAAA,EACJ;AAAA,EAEA,QAAQ,QAAgB,WAAmB;AACvC,WAAO,KAAK,QAAQ,IAAI,MAAM,GAAG,IAAI,SAAS;AAAA,EAClD;AAAA,EAEA,WAAW;AACP,UAAM,SAA4B,CAAC;AACnC,UAAM,WAAW,CAAC,GAAG,KAAK,OAAO,KAAK,CAAC;AACvC,aAAS,QAAQ,CAAC,WAAW;AACzB,YAAM,aAAa,KAAK,OAAO,IAAI,MAAM;AACzC,UAAI,YAAY,MAAM;AAClB,eAAO,MAAM,IAAI,CAAC;AAClB,cAAM,cAAc,CAAC,GAAG,WAAW,KAAK,CAAC;AACzC,oBAAY,QAAQ,CAAC,cAAc;AAC/B,gBAAM,OAAO,WAAW,IAAI,SAAS;AACrC,cAAI,MAAM;AACN,mBAAO,MAAM,EAAE,KAAK,IAAI;AAAA,UAC5B;AAAA,QACJ,CAAC;AAAA,MACL;AAAA,IACJ,CAAC;AACD,WAAO;AAAA,EACX;AAAA,EAEA,WAAW,KAAwB;AAC/B,UAAM,SAA0B,oBAAI,IAAI;AACxC,WAAO,KAAK,GAAG,EAAE,QAAQ,CAAC,WAAW;AACjC,YAAM,cAAc,IAAI,MAAM;AAC9B,UAAI,aAAa,QAAQ;AACrB,cAAM,aAAa,oBAAI,IAAI;AAC3B,oBAAY,QAAQ,CAAC,SAAS;AAC1B,qBAAW,IAAI,KAAK,WAAW,IAAI;AAAA,QACvC,CAAC;AACD,eAAO,IAAI,QAAQ,UAAU;AAAA,MACjC;AAAA,IACJ,CAAC;AACD,SAAK,SAAS;AAAA,EAClB;AAAA,EAEA,gBAAgB,QAAgB;AAC5B,SAAK,OAAO,OAAO,MAAM;AAAA,EAC7B;AAAA,EAEQ,kBAAkB,QAAgB;AACtC,QAAI,aAAa,KAAK,OAAO,IAAI,MAAM;AACvC,QAAI,CAAC,YAAY;AACb,mBAAa,oBAAI,IAAI;AACrB,WAAK,OAAO,IAAI,QAAQ,UAAU;AAAA,IACtC;AACA,WAAO;AAAA,EACX;AAAA,EAEA,wBAAwB,QAAgB,cAAsB;AAC1D,UAAM,aAAa,KAAK,OAAO,IAAI,MAAM;AACzC,QAAI,CAAC,WAAY,QAAO;AACxB,eAAW,CAAC,WAAW,IAAI,KAAK,YAAY;AACxC,UAAI,KAAK,iBAAiB,cAAc;AACpC,eAAO,CAAC,QAAQ,SAAS;AAAA,MAC7B;AAAA,IACJ;AAAA,EACJ;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"aeb856c4661ce4bcf89f86653d4866d12e72331c"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission-rule.model.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission-rule.model.ts","statementMap":{"0":{"start":{"line":7,"column":27},"end":{"line":7,"column":36}},"1":{"start":{"line":8,"column":16},"end":{"line":8,"column":29}},"2":{"start":{"line":9,"column":17},"end":{"line":9,"column":30}},"3":{"start":{"line":10,"column":16},"end":{"line":10,"column":29}},"4":{"start":{"line":11,"column":16},"end":{"line":11,"column":47}},"5":{"start":{"line":12,"column":17},"end":{"line":12,"column":49}},"6":{"start":{"line":13,"column":16},"end":{"line":13,"column":47}},"7":{"start":{"line":14,"column":34},"end":{"line":14,"column":60}},"8":{"start":{"line":15,"column":34},"end":{"line":15,"column":83}},"9":{"start":{"line":17,"column":4},"end":{"line":17,"column":51}},"10":{"start":{"line":20,"column":4},"end":{"line":20,"column":52}},"11":{"start":{"line":23,"column":23},"end":{"line":23,"column":53}},"12":{"start":{"line":24,"column":4},"end":{"line":24,"column":41}},"13":{"start":{"line":25,"column":4},"end":{"line":25,"column":84}},"14":{"start":{"line":28,"column":17},"end":{"line":28,"column":57}},"15":{"start":{"line":29,"column":4},"end":{"line":32,"column":5}},"16":{"start":{"line":30,"column":6},"end":{"line":30,"column":49}},"17":{"start":{"line":31,"column":6},"end":{"line":31,"column":73}},"18":{"start":{"line":35,"column":20},"end":{"line":35,"column":51}},"19":{"start":{"line":36,"column":4},"end":{"line":39,"column":5}},"20":{"start":{"line":37,"column":6},"end":{"line":37,"column":53}},"21":{"start":{"line":38,"column":6},"end":{"line":38,"column":79}},"22":{"start":{"line":42,"column":4},"end":{"line":42,"column":52}},"23":{"start":{"line":45,"column":19},"end":{"line":45,"column":21}},"24":{"start":{"line":46,"column":21},"end":{"line":46,"column":44}},"25":{"start":{"line":47,"column":4},"end":{"line":59,"column":7}},"26":{"start":{"line":48,"column":25},"end":{"line":48,"column":48}},"27":{"start":{"line":49,"column":6},"end":{"line":58,"column":7}},"28":{"start":{"line":50,"column":8},"end":{"line":50,"column":28}},"29":{"start":{"line":51,"column":28},"end":{"line":51,"column":50}},"30":{"start":{"line":52,"column":8},"end":{"line":57,"column":11}},"31":{"start":{"line":53,"column":23},"end":{"line":53,"column":48}},"32":{"start":{"line":54,"column":10},"end":{"line":56,"column":11}},"33":{"start":{"line":55,"column":12},"end":{"line":55,"column":38}},"34":{"start":{"line":60,"column":4},"end":{"line":60,"column":18}},"35":{"start":{"line":63,"column":35},"end":{"line":63,"column":44}},"36":{"start":{"line":64,"column":4},"end":{"line":73,"column":7}},"37":{"start":{"line":65,"column":26},"end":{"line":65,"column":37}},"38":{"start":{"line":66,"column":6},"end":{"line":72,"column":7}},"39":{"start":{"line":67,"column":43},"end":{"line":67,"column":52}},"40":{"start":{"line":68,"column":8},"end":{"line":70,"column":11}},"41":{"start":{"line":69,"column":10},"end":{"line":69,"column":47}},"42":{"start":{"line":71,"column":8},"end":{"line":71,"column":39}},"43":{"start":{"line":74,"column":4},"end":{"line":74,"column":25}},"44":{"start":{"line":77,"column":4},"end":{"line":77,"column":31}},"45":{"start":{"line":80,"column":21},"end":{"line":80,"column":44}},"46":{"start":{"line":81,"column":4},"end":{"line":84,"column":5}},"47":{"start":{"line":82,"column":6},"end":{"line":82,"column":45}},"48":{"start":{"line":83,"column":6},"end":{"line":83,"column":42}},"49":{"start":{"line":85,"column":4},"end":{"line":85,"column":22}},"50":{"start":{"line":88,"column":4},"end":{"line":88,"column":41}},"51":{"start":{"line":91,"column":4},"end":{"line":91,"column":41}},"52":{"start":{"line":94,"column":23},"end":{"line":94,"column":46}},"53":{"start":{"line":95,"column":4},"end":{"line":95,"column":33}},"54":{"start":{"line":95,"column":21},"end":{"line":95,"column":33}},"55":{"start":{"line":96,"column":4},"end":{"line":100,"column":5}},"56":{"start":{"line":97,"column":6},"end":{"line":99,"column":7}},"57":{"start":{"line":98,"column":8},"end":{"line":98,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":16,"column":2},"end":{"line":16,"column":3}},"loc":{"start":{"line":16,"column":29},"end":{"line":18,"column":3}},"line":16},"1":{"name":"(anonymous_1)","decl":{"start":{"line":19,"column":2},"end":{"line":19,"column":3}},"loc":{"start":{"line":19,"column":26},"end":{"line":21,"column":3}},"line":19},"2":{"name":"(anonymous_2)","decl":{"start":{"line":22,"column":2},"end":{"line":22,"column":3}},"loc":{"start":{"line":22,"column":24},"end":{"line":26,"column":3}},"line":22},"3":{"name":"(anonymous_3)","decl":{"start":{"line":27,"column":2},"end":{"line":27,"column":3}},"loc":{"start":{"line":27,"column":32},"end":{"line":33,"column":3}},"line":27},"4":{"name":"(anonymous_4)","decl":{"start":{"line":34,"column":2},"end":{"line":34,"column":3}},"loc":{"start":{"line":34,"column":35},"end":{"line":40,"column":3}},"line":34},"5":{"name":"(anonymous_5)","decl":{"start":{"line":41,"column":2},"end":{"line":41,"column":3}},"loc":{"start":{"line":41,"column":29},"end":{"line":43,"column":3}},"line":41},"6":{"name":"(anonymous_6)","decl":{"start":{"line":44,"column":2},"end":{"line":44,"column":3}},"loc":{"start":{"line":44,"column":13},"end":{"line":61,"column":3}},"line":44},"7":{"name":"(anonymous_7)","decl":{"start":{"line":47,"column":21},"end":{"line":47,"column":22}},"loc":{"start":{"line":47,"column":33},"end":{"line":59,"column":5}},"line":47},"8":{"name":"(anonymous_8)","decl":{"start":{"line":52,"column":28},"end":{"line":52,"column":29}},"loc":{"start":{"line":52,"column":43},"end":{"line":57,"column":9}},"line":52},"9":{"name":"(anonymous_9)","decl":{"start":{"line":62,"column":2},"end":{"line":62,"column":3}},"loc":{"start":{"line":62,"column":18},"end":{"line":75,"column":3}},"line":62},"10":{"name":"(anonymous_10)","decl":{"start":{"line":64,"column":29},"end":{"line":64,"column":30}},"loc":{"start":{"line":64,"column":41},"end":{"line":73,"column":5}},"line":64},"11":{"name":"(anonymous_11)","decl":{"start":{"line":68,"column":28},"end":{"line":68,"column":29}},"loc":{"start":{"line":68,"column":38},"end":{"line":70,"column":9}},"line":68},"12":{"name":"(anonymous_12)","decl":{"start":{"line":76,"column":2},"end":{"line":76,"column":3}},"loc":{"start":{"line":76,"column":26},"end":{"line":78,"column":3}},"line":76},"13":{"name":"(anonymous_13)","decl":{"start":{"line":79,"column":2},"end":{"line":79,"column":3}},"loc":{"start":{"line":79,"column":28},"end":{"line":86,"column":3}},"line":79},"14":{"name":"(anonymous_14)","decl":{"start":{"line":87,"column":2},"end":{"line":87,"column":3}},"loc":{"start":{"line":87,"column":28},"end":{"line":89,"column":3}},"line":87},"15":{"name":"(anonymous_15)","decl":{"start":{"line":90,"column":2},"end":{"line":90,"column":3}},"loc":{"start":{"line":90,"column":15},"end":{"line":92,"column":3}},"line":90},"16":{"name":"(anonymous_16)","decl":{"start":{"line":93,"column":2},"end":{"line":93,"column":3}},"loc":{"start":{"line":93,"column":48},"end":{"line":101,"column":3}},"line":93}},"branchMap":{"0":{"loc":{"start":{"line":29,"column":4},"end":{"line":32,"column":5}},"type":"if","locations":[{"start":{"line":29,"column":4},"end":{"line":32,"column":5}},{"start":{},"end":{}}],"line":29},"1":{"loc":{"start":{"line":36,"column":4},"end":{"line":39,"column":5}},"type":"if","locations":[{"start":{"line":36,"column":4},"end":{"line":39,"column":5}},{"start":{},"end":{}}],"line":36},"2":{"loc":{"start":{"line":49,"column":6},"end":{"line":58,"column":7}},"type":"if","locations":[{"start":{"line":49,"column":6},"end":{"line":58,"column":7}},{"start":{},"end":{}}],"line":49},"3":{"loc":{"start":{"line":54,"column":10},"end":{"line":56,"column":11}},"type":"if","locations":[{"start":{"line":54,"column":10},"end":{"line":56,"column":11}},{"start":{},"end":{}}],"line":54},"4":{"loc":{"start":{"line":66,"column":6},"end":{"line":72,"column":7}},"type":"if","locations":[{"start":{"line":66,"column":6},"end":{"line":72,"column":7}},{"start":{},"end":{}}],"line":66},"5":{"loc":{"start":{"line":81,"column":4},"end":{"line":84,"column":5}},"type":"if","locations":[{"start":{"line":81,"column":4},"end":{"line":84,"column":5}},{"start":{},"end":{}}],"line":81},"6":{"loc":{"start":{"line":95,"column":4},"end":{"line":95,"column":33}},"type":"if","locations":[{"start":{"line":95,"column":4},"end":{"line":95,"column":33}},{"start":{},"end":{}}],"line":95},"7":{"loc":{"start":{"line":97,"column":6},"end":{"line":99,"column":7}},"type":"if","locations":[{"start":{"line":97,"column":6},"end":{"line":99,"column":7}},{"start":{},"end":{}}],"line":97}},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":2,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission-rule.model.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IModel, IObjectModel, IWorksheetProtectionRule } from '../type';\nimport { BehaviorSubject, Subject } from 'rxjs';\n\ntype IRuleChangeType = 'add' | 'set' | 'delete';\n\nexport class WorksheetProtectionRuleModel {\n    /**\n     *\n     * Map<unitId, Map<subUnitId, Map<subUnitId, IWorksheetProtectionRule>>>\n     */\n    private _model: IModel = new Map();\n\n    private _ruleChange = new Subject<{\n        unitId: string;\n        subUnitId: string;\n        rule: IWorksheetProtectionRule;\n        oldRule?: IWorksheetProtectionRule;\n        type: IRuleChangeType;\n    }>();\n\n    private _ruleRefresh = new Subject<string>();\n    private _resetOrder = new Subject();\n\n    ruleChange$ = this._ruleChange.asObservable();\n\n    ruleRefresh$ = this._ruleRefresh.asObservable();\n\n    resetOrder$ = this._resetOrder.asObservable();\n\n    private _worksheetRuleInitStateChange = new BehaviorSubject<boolean>(false);\n    worksheetRuleInitStateChange$ = this._worksheetRuleInitStateChange.asObservable();\n\n    changeRuleInitState(state: boolean) {\n        this._worksheetRuleInitStateChange.next(state);\n    }\n\n    getSheetRuleInitState() {\n        return this._worksheetRuleInitStateChange.value;\n    }\n\n    addRule(unitId: string, rule: IWorksheetProtectionRule) {\n        const subUnitMap = this._ensureSubUnitMap(unitId);\n        subUnitMap.set(rule.subUnitId, rule);\n        this._ruleChange.next({ unitId, rule, type: 'add', subUnitId: rule.subUnitId });\n    }\n\n    deleteRule(unitId: string, subUnitId: string) {\n        const rule = this._model?.get(unitId)?.get(subUnitId);\n        if (rule) {\n            this._model.get(unitId)?.delete(subUnitId);\n            this._ruleChange.next({ unitId, rule, type: 'delete', subUnitId });\n        }\n    }\n\n    setRule(unitId: string, subUnitId: string, rule: IWorksheetProtectionRule) {\n        const oldRule = this.getRule(unitId, subUnitId);\n        if (oldRule) {\n            this._model?.get(unitId)?.set(subUnitId, rule);\n            this._ruleChange.next({ unitId, oldRule, rule, type: 'set', subUnitId });\n        }\n    }\n\n    getRule(unitId: string, subUnitId: string) {\n        return this._model?.get(unitId)?.get(subUnitId);\n    }\n\n    toObject() {\n        const result: IObjectModel = {};\n        const unitKeys = [...this._model.keys()];\n        unitKeys.forEach((unitId) => {\n            const subUnitMap = this._model.get(unitId);\n            if (subUnitMap?.size) {\n                result[unitId] = [];\n                const subUnitKeys = [...subUnitMap.keys()];\n                subUnitKeys.forEach((subUnitId) => {\n                    const rule = subUnitMap.get(subUnitId);\n                    if (rule) {\n                        result[unitId].push(rule);\n                    }\n                });\n            }\n        });\n        return result;\n    }\n\n    fromObject(obj: IObjectModel) {\n        const result: IModel = new Map();\n        Object.keys(obj).forEach((unitId) => {\n            const subUnitList = obj[unitId];\n            if (subUnitList?.length) {\n                const subUnitMap = new Map();\n                subUnitList.forEach((rule) => {\n                    subUnitMap.set(rule.subUnitId, rule);\n                });\n                result.set(unitId, subUnitMap);\n            }\n        });\n        this._model = result;\n    }\n\n    deleteUnitModel(unitId: string) {\n        this._model.delete(unitId);\n    }\n\n    private _ensureSubUnitMap(unitId: string) {\n        let subUnitMap = this._model.get(unitId);\n        if (!subUnitMap) {\n            subUnitMap = new Map();\n            this._model.set(unitId, subUnitMap);\n        }\n        return subUnitMap;\n    }\n\n    ruleRefresh(permissionId: string) {\n        this._ruleRefresh.next(permissionId);\n    }\n\n    resetOrder() {\n        this._resetOrder.next(Math.random());\n    }\n\n    getTargetByPermissionId(unitId: string, permissionId: string) {\n        const subUnitMap = this._model.get(unitId);\n        if (!subUnitMap) return null;\n        for (const [subUnitId, rule] of subUnitMap) {\n            if (rule.permissionId === permissionId) {\n                return [unitId, subUnitId];\n            }\n        }\n    }\n}\n"],"mappings":"AAiBA,SAAS,iBAAiB,eAAe;AAIlC,aAAM,6BAA6B;AAAA;AAAA;AAAA;AAAA;AAAA,EAK9B,SAAiB,oBAAI,IAAI;AAAA,EAEzB,cAAc,IAAI,QAMvB;AAAA,EAEK,eAAe,IAAI,QAAgB;AAAA,EACnC,cAAc,IAAI,QAAQ;AAAA,EAElC,cAAc,KAAK,YAAY,aAAa;AAAA,EAE5C,eAAe,KAAK,aAAa,aAAa;AAAA,EAE9C,cAAc,KAAK,YAAY,aAAa;AAAA,EAEpC,gCAAgC,IAAI,gBAAyB,KAAK;AAAA,EAC1E,gCAAgC,KAAK,8BAA8B,aAAa;AAAA,EAEhF,oBAAoB,OAAgB;AAChC,SAAK,8BAA8B,KAAK,KAAK;AAAA,EACjD;AAAA,EAEA,wBAAwB;AACpB,WAAO,KAAK,8BAA8B;AAAA,EAC9C;AAAA,EAEA,QAAQ,QAAgB,MAAgC;AACpD,UAAM,aAAa,KAAK,kBAAkB,MAAM;AAChD,eAAW,IAAI,KAAK,WAAW,IAAI;AACnC,SAAK,YAAY,KAAK,EAAE,QAAQ,MAAM,MAAM,OAAO,WAAW,KAAK,UAAU,CAAC;AAAA,EAClF;AAAA,EAEA,WAAW,QAAgB,WAAmB;AAC1C,UAAM,OAAO,KAAK,QAAQ,IAAI,MAAM,GAAG,IAAI,SAAS;AACpD,QAAI,MAAM;AACN,WAAK,OAAO,IAAI,MAAM,GAAG,OAAO,SAAS;AACzC,WAAK,YAAY,KAAK,EAAE,QAAQ,MAAM,MAAM,UAAU,UAAU,CAAC;AAAA,IACrE;AAAA,EACJ;AAAA,EAEA,QAAQ,QAAgB,WAAmB,MAAgC;AACvE,UAAM,UAAU,KAAK,QAAQ,QAAQ,SAAS;AAC9C,QAAI,SAAS;AACT,WAAK,QAAQ,IAAI,MAAM,GAAG,IAAI,WAAW,IAAI;AAC7C,WAAK,YAAY,KAAK,EAAE,QAAQ,SAAS,MAAM,MAAM,OAAO,UAAU,CAAC;AAAA,IAC3E;AAAA,EACJ;AAAA,EAEA,QAAQ,QAAgB,WAAmB;AACvC,WAAO,KAAK,QAAQ,IAAI,MAAM,GAAG,IAAI,SAAS;AAAA,EAClD;AAAA,EAEA,WAAW;AACP,UAAM,SAAuB,CAAC;AAC9B,UAAM,WAAW,CAAC,GAAG,KAAK,OAAO,KAAK,CAAC;AACvC,aAAS,QAAQ,CAAC,WAAW;AACzB,YAAM,aAAa,KAAK,OAAO,IAAI,MAAM;AACzC,UAAI,YAAY,MAAM;AAClB,eAAO,MAAM,IAAI,CAAC;AAClB,cAAM,cAAc,CAAC,GAAG,WAAW,KAAK,CAAC;AACzC,oBAAY,QAAQ,CAAC,cAAc;AAC/B,gBAAM,OAAO,WAAW,IAAI,SAAS;AACrC,cAAI,MAAM;AACN,mBAAO,MAAM,EAAE,KAAK,IAAI;AAAA,UAC5B;AAAA,QACJ,CAAC;AAAA,MACL;AAAA,IACJ,CAAC;AACD,WAAO;AAAA,EACX;AAAA,EAEA,WAAW,KAAmB;AAC1B,UAAM,SAAiB,oBAAI,IAAI;AAC/B,WAAO,KAAK,GAAG,EAAE,QAAQ,CAAC,WAAW;AACjC,YAAM,cAAc,IAAI,MAAM;AAC9B,UAAI,aAAa,QAAQ;AACrB,cAAM,aAAa,oBAAI,IAAI;AAC3B,oBAAY,QAAQ,CAAC,SAAS;AAC1B,qBAAW,IAAI,KAAK,WAAW,IAAI;AAAA,QACvC,CAAC;AACD,eAAO,IAAI,QAAQ,UAAU;AAAA,MACjC;AAAA,IACJ,CAAC;AACD,SAAK,SAAS;AAAA,EAClB;AAAA,EAEA,gBAAgB,QAAgB;AAC5B,SAAK,OAAO,OAAO,MAAM;AAAA,EAC7B;AAAA,EAEQ,kBAAkB,QAAgB;AACtC,QAAI,aAAa,KAAK,OAAO,IAAI,MAAM;AACvC,QAAI,CAAC,YAAY;AACb,mBAAa,oBAAI,IAAI;AACrB,WAAK,OAAO,IAAI,QAAQ,UAAU;AAAA,IACtC;AACA,WAAO;AAAA,EACX;AAAA,EAEA,YAAY,cAAsB;AAC9B,SAAK,aAAa,KAAK,YAAY;AAAA,EACvC;AAAA,EAEA,aAAa;AACT,SAAK,YAAY,KAAK,KAAK,OAAO,CAAC;AAAA,EACvC;AAAA,EAEA,wBAAwB,QAAgB,cAAsB;AAC1D,UAAM,aAAa,KAAK,OAAO,IAAI,MAAM;AACzC,QAAI,CAAC,WAAY,QAAO;AACxB,eAAW,CAAC,WAAW,IAAI,KAAK,YAAY;AACxC,UAAI,KAAK,iBAAiB,cAAc;AACpC,eAAO,CAAC,QAAQ,SAAS;AAAA,MAC7B;AAAA,IACJ;AAAA,EACJ;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ead29d308c2ab8bdfb78505c478297794e1202c7"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/index.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/index.ts","statementMap":{},"fnMap":{},"branchMap":{},"s":{},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/index.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport { getAllWorkbookPermissionPoint, defaultWorkbookPermissionPoints } from './util';\n"],"mappings":"AAgBA,SAAS,+BAA+B,uCAAuC;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"11cafdf04fea9cb4f902e1f5b98a9a1327b2a8c5"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/util.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/util.ts","statementMap":{"0":{"start":{"line":4,"column":45},"end":{"line":23,"column":1}},"1":{"start":{"line":4,"column":51},"end":{"line":23,"column":1}},"2":{"start":{"line":24,"column":47},"end":{"line":43,"column":1}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":45},"end":{"line":4,"column":46}},"loc":{"start":{"line":4,"column":51},"end":{"line":23,"column":1}},"line":4}},"branchMap":{},"s":{"0":1,"1":2,"2":1},"f":{"0":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/util.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UnitAction } from '@univerjs/protocol';\nimport { WorkbookCommentPermission, WorkbookCopyPermission, WorkbookCopySheetPermission, WorkbookCreateSheetPermission, WorkbookDeleteSheetPermission, WorkbookDuplicatePermission, WorkbookEditablePermission, WorkbookExportPermission, WorkbookHideSheetPermission, WorkbookManageCollaboratorPermission, WorkbookMoveSheetPermission, WorkbookPrintPermission, WorkbookRecoverHistoryPermission, WorkbookRenameSheetPermission, WorkbookSharePermission, WorkbookViewHistoryPermission, WorkbookViewPermission } from '../permission-point';\nimport { WorkbookCreateProtectPermission } from '../permission-point/workbook/create-permission';\n\nexport const getAllWorkbookPermissionPoint = () => [\n    WorkbookEditablePermission,\n    WorkbookPrintPermission,\n    WorkbookCommentPermission,\n    WorkbookViewPermission,\n    WorkbookCopyPermission,\n    WorkbookExportPermission,\n    WorkbookManageCollaboratorPermission,\n    WorkbookCreateSheetPermission,\n    WorkbookDeleteSheetPermission,\n    WorkbookRenameSheetPermission,\n    WorkbookHideSheetPermission,\n    WorkbookDuplicatePermission,\n    WorkbookSharePermission,\n    WorkbookMoveSheetPermission,\n    WorkbookCopySheetPermission,\n    WorkbookViewHistoryPermission,\n    WorkbookRecoverHistoryPermission,\n    WorkbookCreateProtectPermission,\n];\n\nexport const defaultWorkbookPermissionPoints = [\n    UnitAction.Edit,\n    UnitAction.Print,\n    UnitAction.Comment,\n    UnitAction.View,\n    UnitAction.Copy,\n    UnitAction.Export,\n    UnitAction.ManageCollaborator,\n    UnitAction.CreateSheet,\n    UnitAction.DeleteSheet,\n    UnitAction.RenameSheet,\n    UnitAction.HideSheet,\n    UnitAction.Duplicate,\n    UnitAction.Share,\n    UnitAction.MoveSheet,\n    UnitAction.CopySheet,\n    UnitAction.RecoverHistory,\n    UnitAction.ViewHistory,\n    UnitAction.CreatePermissionObject,\n];\n"],"mappings":"AAgBA,SAAS,kBAAkB;AAC3B,SAAS,2BAA2B,wBAAwB,6BAA6B,+BAA+B,+BAA+B,6BAA6B,4BAA4B,0BAA0B,6BAA6B,sCAAsC,6BAA6B,yBAAyB,kCAAkC,+BAA+B,yBAAyB,+BAA+B,8BAA8B;AAC1f,SAAS,uCAAuC;AAEzC,aAAM,gCAAgC,MAAM;AAAA,EAC/C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ;AAEO,aAAM,kCAAkC;AAAA,EAC3C,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AACf;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"cdac87228b1eaf4e3336da30b02bbd7ac4763e9d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/utils.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/utils.ts","statementMap":{"0":{"start":{"line":3,"column":46},"end":{"line":8,"column":1}},"1":{"start":{"line":3,"column":52},"end":{"line":8,"column":1}},"2":{"start":{"line":9,"column":58},"end":{"line":24,"column":1}},"3":{"start":{"line":9,"column":64},"end":{"line":24,"column":1}},"4":{"start":{"line":25,"column":47},"end":{"line":40,"column":1}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":46},"end":{"line":3,"column":47}},"loc":{"start":{"line":3,"column":52},"end":{"line":8,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":58},"end":{"line":9,"column":59}},"loc":{"start":{"line":9,"column":64},"end":{"line":24,"column":1}},"line":9}},"branchMap":{},"s":{"0":1,"1":2,"2":1,"3":2,"4":1},"f":{"0":2,"1":2},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/utils.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UnitAction } from '@univerjs/protocol';\nimport { WorksheetCopyPermission, WorksheetDeleteColumnPermission, WorksheetDeleteProtectionPermission, WorksheetDeleteRowPermission, WorksheetEditExtraObjectPermission, WorksheetEditPermission, WorksheetFilterPermission, WorksheetInsertColumnPermission, WorksheetInsertHyperlinkPermission, WorksheetInsertRowPermission, WorksheetManageCollaboratorPermission, WorksheetPivotTablePermission, WorksheetSetCellStylePermission, WorksheetSetCellValuePermission, WorksheetSetColumnStylePermission, WorksheetSetRowStylePermission, WorksheetSortPermission, WorksheetViewPermission } from '../permission-point';\n\nexport const getAllWorksheetPermissionPoint = () => [\n    WorksheetEditPermission,\n    WorksheetViewPermission,\n    WorksheetManageCollaboratorPermission,\n    WorksheetDeleteProtectionPermission,\n];\n\n// Changes require synchronization of the following arrays\nexport const getAllWorksheetPermissionPointByPointPanel = () => [\n    WorksheetCopyPermission,\n    WorksheetDeleteColumnPermission,\n    WorksheetDeleteRowPermission,\n    WorksheetEditExtraObjectPermission,\n    WorksheetFilterPermission,\n    WorksheetInsertColumnPermission,\n    WorksheetInsertRowPermission,\n    WorksheetInsertHyperlinkPermission,\n    WorksheetPivotTablePermission,\n    WorksheetSetCellStylePermission,\n    WorksheetSetCellValuePermission,\n    WorksheetSetColumnStylePermission,\n    WorksheetSetRowStylePermission,\n    WorksheetSortPermission,\n];\n\nexport const defaultWorksheetPermissionPoint = [\n    UnitAction.Copy,\n    UnitAction.DeleteColumn,\n    UnitAction.DeleteRow,\n    UnitAction.EditExtraObject,\n    UnitAction.Filter,\n    UnitAction.InsertColumn,\n    UnitAction.InsertRow,\n    UnitAction.InsertHyperlink,\n    UnitAction.PivotTable,\n    UnitAction.SetCellStyle,\n    UnitAction.SetCellValue,\n    UnitAction.SetColumnStyle,\n    UnitAction.SetRowStyle,\n    UnitAction.Sort,\n];\n"],"mappings":"AAgBA,SAAS,kBAAkB;AAC3B,SAAS,yBAAyB,iCAAiC,qCAAqC,8BAA8B,oCAAoC,yBAAyB,2BAA2B,iCAAiC,oCAAoC,8BAA8B,uCAAuC,+BAA+B,iCAAiC,iCAAiC,mCAAmC,gCAAgC,yBAAyB,+BAA+B;AAE7jB,aAAM,iCAAiC,MAAM;AAAA,EAChD;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ;AAGO,aAAM,6CAA6C,MAAM;AAAA,EAC5D;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ;AAEO,aAAM,kCAAkC;AAAA,EAC3C,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AACf;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c7248bb8c5b5c7f7a5617ee981de10f0893c0f1d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission.service.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission.service.ts","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":37}},"1":{"start":{"line":2,"column":23},"end":{"line":2,"column":54}},"2":{"start":{"line":3,"column":22},"end":{"line":10,"column":1}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"4":{"start":{"line":5,"column":2},"end":{"line":7,"column":85}},"5":{"start":{"line":5,"column":15},"end":{"line":5,"column":36}},"6":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"7":{"start":{"line":7,"column":6},"end":{"line":7,"column":85}},"8":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"9":{"start":{"line":8,"column":22},"end":{"line":8,"column":53}},"10":{"start":{"line":9,"column":2},"end":{"line":9,"column":16}},"11":{"start":{"line":11,"column":22},"end":{"line":11,"column":90}},"12":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"13":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"14":{"start":{"line":21,"column":38},"end":{"line":21,"column":73}},"15":{"start":{"line":22,"column":39},"end":{"line":22,"column":80}},"16":{"start":{"line":23,"column":40},"end":{"line":199,"column":1}},"17":{"start":{"line":25,"column":4},"end":{"line":25,"column":12}},"18":{"start":{"line":26,"column":4},"end":{"line":26,"column":49}},"19":{"start":{"line":27,"column":4},"end":{"line":27,"column":57}},"20":{"start":{"line":28,"column":4},"end":{"line":28,"column":31}},"21":{"start":{"line":29,"column":4},"end":{"line":29,"column":71}},"22":{"start":{"line":30,"column":4},"end":{"line":30,"column":81}},"23":{"start":{"line":31,"column":4},"end":{"line":31,"column":59}},"24":{"start":{"line":32,"column":4},"end":{"line":32,"column":63}},"25":{"start":{"line":33,"column":4},"end":{"line":33,"column":35}},"26":{"start":{"line":34,"column":4},"end":{"line":34,"column":17}},"27":{"start":{"line":35,"column":4},"end":{"line":35,"column":27}},"28":{"start":{"line":36,"column":4},"end":{"line":36,"column":29}},"29":{"start":{"line":37,"column":4},"end":{"line":37,"column":30}},"30":{"start":{"line":40,"column":27},"end":{"line":70,"column":5}},"31":{"start":{"line":41,"column":21},"end":{"line":41,"column":41}},"32":{"start":{"line":42,"column":30},"end":{"line":49,"column":7}},"33":{"start":{"line":43,"column":26},"end":{"line":43,"column":48}},"34":{"start":{"line":44,"column":8},"end":{"line":47,"column":11}},"35":{"start":{"line":45,"column":27},"end":{"line":45,"column":51}},"36":{"start":{"line":46,"column":10},"end":{"line":46,"column":63}},"37":{"start":{"line":48,"column":8},"end":{"line":48,"column":110}},"38":{"start":{"line":50,"column":6},"end":{"line":52,"column":9}},"39":{"start":{"line":51,"column":8},"end":{"line":51,"column":35}},"40":{"start":{"line":53,"column":6},"end":{"line":55,"column":9}},"41":{"start":{"line":54,"column":8},"end":{"line":54,"column":35}},"42":{"start":{"line":56,"column":6},"end":{"line":69,"column":9}},"43":{"start":{"line":57,"column":26},"end":{"line":57,"column":48}},"44":{"start":{"line":58,"column":30},"end":{"line":58,"column":98}},"45":{"start":{"line":59,"column":8},"end":{"line":64,"column":11}},"46":{"start":{"line":60,"column":10},"end":{"line":63,"column":13}},"47":{"start":{"line":61,"column":29},"end":{"line":61,"column":72}},"48":{"start":{"line":62,"column":12},"end":{"line":62,"column":71}},"49":{"start":{"line":65,"column":8},"end":{"line":68,"column":11}},"50":{"start":{"line":66,"column":27},"end":{"line":66,"column":51}},"51":{"start":{"line":67,"column":10},"end":{"line":67,"column":69}},"52":{"start":{"line":71,"column":4},"end":{"line":73,"column":7}},"53":{"start":{"line":72,"column":6},"end":{"line":72,"column":31}},"54":{"start":{"line":74,"column":4},"end":{"line":74,"column":142}},"55":{"start":{"line":75,"column":4},"end":{"line":84,"column":7}},"56":{"start":{"line":76,"column":6},"end":{"line":83,"column":9}},"57":{"start":{"line":77,"column":23},"end":{"line":77,"column":43}},"58":{"start":{"line":78,"column":26},"end":{"line":78,"column":48}},"59":{"start":{"line":79,"column":8},"end":{"line":82,"column":11}},"60":{"start":{"line":80,"column":27},"end":{"line":80,"column":51}},"61":{"start":{"line":81,"column":10},"end":{"line":81,"column":69}},"62":{"start":{"line":87,"column":4},"end":{"line":109,"column":6}},"63":{"start":{"line":89,"column":8},"end":{"line":107,"column":9}},"64":{"start":{"line":91,"column":12},"end":{"line":91,"column":18}},"65":{"start":{"line":94,"column":12},"end":{"line":97,"column":15}},"66":{"start":{"line":95,"column":31},"end":{"line":95,"column":65}},"67":{"start":{"line":96,"column":14},"end":{"line":96,"column":79}},"68":{"start":{"line":98,"column":12},"end":{"line":98,"column":18}},"69":{"start":{"line":101,"column":12},"end":{"line":104,"column":15}},"70":{"start":{"line":102,"column":31},"end":{"line":102,"column":65}},"71":{"start":{"line":103,"column":14},"end":{"line":103,"column":84}},"72":{"start":{"line":105,"column":12},"end":{"line":105,"column":18}},"73":{"start":{"line":112,"column":19},"end":{"line":115,"column":5}},"74":{"start":{"line":113,"column":21},"end":{"line":113,"column":66}},"75":{"start":{"line":114,"column":6},"end":{"line":114,"column":36}},"76":{"start":{"line":116,"column":22},"end":{"line":125,"column":5}},"77":{"start":{"line":117,"column":6},"end":{"line":119,"column":7}},"78":{"start":{"line":118,"column":8},"end":{"line":118,"column":18}},"79":{"start":{"line":120,"column":6},"end":{"line":124,"column":7}},"80":{"start":{"line":121,"column":8},"end":{"line":121,"column":32}},"81":{"start":{"line":123,"column":8},"end":{"line":123,"column":18}},"82":{"start":{"line":126,"column":4},"end":{"line":161,"column":6}},"83":{"start":{"line":133,"column":10},"end":{"line":133,"column":67}},"84":{"start":{"line":134,"column":10},"end":{"line":140,"column":13}},"85":{"start":{"line":135,"column":12},"end":{"line":139,"column":15}},"86":{"start":{"line":136,"column":31},"end":{"line":136,"column":55}},"87":{"start":{"line":137,"column":14},"end":{"line":137,"column":37}},"88":{"start":{"line":138,"column":14},"end":{"line":138,"column":67}},"89":{"start":{"line":141,"column":10},"end":{"line":141,"column":71}},"90":{"start":{"line":144,"column":27},"end":{"line":144,"column":70}},"91":{"start":{"line":145,"column":10},"end":{"line":157,"column":11}},"92":{"start":{"line":146,"column":12},"end":{"line":152,"column":15}},"93":{"start":{"line":147,"column":32},"end":{"line":147,"column":54}},"94":{"start":{"line":148,"column":14},"end":{"line":151,"column":17}},"95":{"start":{"line":149,"column":33},"end":{"line":149,"column":57}},"96":{"start":{"line":150,"column":16},"end":{"line":150,"column":75}},"97":{"start":{"line":153,"column":12},"end":{"line":156,"column":15}},"98":{"start":{"line":154,"column":31},"end":{"line":154,"column":44}},"99":{"start":{"line":155,"column":14},"end":{"line":155,"column":73}},"100":{"start":{"line":158,"column":10},"end":{"line":158,"column":69}},"101":{"start":{"line":164,"column":19},"end":{"line":167,"column":5}},"102":{"start":{"line":165,"column":21},"end":{"line":165,"column":71}},"103":{"start":{"line":166,"column":6},"end":{"line":166,"column":36}},"104":{"start":{"line":168,"column":22},"end":{"line":177,"column":5}},"105":{"start":{"line":169,"column":6},"end":{"line":171,"column":7}},"106":{"start":{"line":170,"column":8},"end":{"line":170,"column":18}},"107":{"start":{"line":172,"column":6},"end":{"line":176,"column":7}},"108":{"start":{"line":173,"column":8},"end":{"line":173,"column":32}},"109":{"start":{"line":175,"column":8},"end":{"line":175,"column":18}},"110":{"start":{"line":178,"column":4},"end":{"line":197,"column":6}},"111":{"start":{"line":185,"column":10},"end":{"line":185,"column":72}},"112":{"start":{"line":186,"column":10},"end":{"line":191,"column":13}},"113":{"start":{"line":187,"column":12},"end":{"line":190,"column":15}},"114":{"start":{"line":188,"column":31},"end":{"line":188,"column":55}},"115":{"start":{"line":189,"column":14},"end":{"line":189,"column":67}},"116":{"start":{"line":194,"column":10},"end":{"line":194,"column":74}},"117":{"start":{"line":200,"column":0},"end":{"line":209,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":22},"end":{"line":3,"column":23}},"loc":{"start":{"line":3,"column":57},"end":{"line":10,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":44},"end":{"line":11,"column":45}},"loc":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":24,"column":2},"end":{"line":24,"column":3}},"loc":{"start":{"line":24,"column":201},"end":{"line":38,"column":3}},"line":24},"4":{"name":"(anonymous_4)","decl":{"start":{"line":39,"column":2},"end":{"line":39,"column":3}},"loc":{"start":{"line":39,"column":10},"end":{"line":85,"column":3}},"line":39},"5":{"name":"(anonymous_5)","decl":{"start":{"line":40,"column":27},"end":{"line":40,"column":28}},"loc":{"start":{"line":40,"column":41},"end":{"line":70,"column":5}},"line":40},"6":{"name":"(anonymous_6)","decl":{"start":{"line":42,"column":30},"end":{"line":42,"column":31}},"loc":{"start":{"line":42,"column":45},"end":{"line":49,"column":7}},"line":42},"7":{"name":"(anonymous_7)","decl":{"start":{"line":44,"column":103},"end":{"line":44,"column":104}},"loc":{"start":{"line":44,"column":110},"end":{"line":47,"column":9}},"line":44},"8":{"name":"(anonymous_8)","decl":{"start":{"line":50,"column":35},"end":{"line":50,"column":36}},"loc":{"start":{"line":50,"column":50},"end":{"line":52,"column":7}},"line":50},"9":{"name":"(anonymous_9)","decl":{"start":{"line":53,"column":39},"end":{"line":53,"column":40}},"loc":{"start":{"line":53,"column":54},"end":{"line":55,"column":7}},"line":53},"10":{"name":"(anonymous_10)","decl":{"start":{"line":56,"column":40},"end":{"line":56,"column":41}},"loc":{"start":{"line":56,"column":55},"end":{"line":69,"column":7}},"line":56},"11":{"name":"(anonymous_11)","decl":{"start":{"line":59,"column":30},"end":{"line":59,"column":31}},"loc":{"start":{"line":59,"column":40},"end":{"line":64,"column":9}},"line":59},"12":{"name":"(anonymous_12)","decl":{"start":{"line":60,"column":52},"end":{"line":60,"column":53}},"loc":{"start":{"line":60,"column":59},"end":{"line":63,"column":11}},"line":60},"13":{"name":"(anonymous_13)","decl":{"start":{"line":65,"column":103},"end":{"line":65,"column":104}},"loc":{"start":{"line":65,"column":110},"end":{"line":68,"column":9}},"line":65},"14":{"name":"(anonymous_14)","decl":{"start":{"line":71,"column":92},"end":{"line":71,"column":93}},"loc":{"start":{"line":71,"column":106},"end":{"line":73,"column":5}},"line":71},"15":{"name":"(anonymous_15)","decl":{"start":{"line":75,"column":129},"end":{"line":75,"column":130}},"loc":{"start":{"line":75,"column":143},"end":{"line":84,"column":5}},"line":75},"16":{"name":"(anonymous_16)","decl":{"start":{"line":76,"column":35},"end":{"line":76,"column":36}},"loc":{"start":{"line":76,"column":50},"end":{"line":83,"column":7}},"line":76},"17":{"name":"(anonymous_17)","decl":{"start":{"line":79,"column":49},"end":{"line":79,"column":50}},"loc":{"start":{"line":79,"column":56},"end":{"line":82,"column":9}},"line":79},"18":{"name":"(anonymous_18)","decl":{"start":{"line":86,"column":2},"end":{"line":86,"column":3}},"loc":{"start":{"line":86,"column":20},"end":{"line":110,"column":3}},"line":86},"19":{"name":"(anonymous_19)","decl":{"start":{"line":88,"column":63},"end":{"line":88,"column":64}},"loc":{"start":{"line":88,"column":73},"end":{"line":108,"column":7}},"line":88},"20":{"name":"(anonymous_20)","decl":{"start":{"line":94,"column":53},"end":{"line":94,"column":54}},"loc":{"start":{"line":94,"column":60},"end":{"line":97,"column":13}},"line":94},"21":{"name":"(anonymous_21)","decl":{"start":{"line":101,"column":53},"end":{"line":101,"column":54}},"loc":{"start":{"line":101,"column":60},"end":{"line":104,"column":13}},"line":101},"22":{"name":"(anonymous_22)","decl":{"start":{"line":111,"column":2},"end":{"line":111,"column":3}},"loc":{"start":{"line":111,"column":22},"end":{"line":162,"column":3}},"line":111},"23":{"name":"(anonymous_23)","decl":{"start":{"line":112,"column":19},"end":{"line":112,"column":20}},"loc":{"start":{"line":112,"column":25},"end":{"line":115,"column":5}},"line":112},"24":{"name":"(anonymous_24)","decl":{"start":{"line":116,"column":22},"end":{"line":116,"column":23}},"loc":{"start":{"line":116,"column":32},"end":{"line":125,"column":5}},"line":116},"25":{"name":"(anonymous_25)","decl":{"start":{"line":132,"column":16},"end":{"line":132,"column":17}},"loc":{"start":{"line":132,"column":39},"end":{"line":142,"column":9}},"line":132},"26":{"name":"(anonymous_26)","decl":{"start":{"line":134,"column":41},"end":{"line":134,"column":42}},"loc":{"start":{"line":134,"column":56},"end":{"line":140,"column":11}},"line":134},"27":{"name":"(anonymous_27)","decl":{"start":{"line":135,"column":53},"end":{"line":135,"column":54}},"loc":{"start":{"line":135,"column":60},"end":{"line":139,"column":13}},"line":135},"28":{"name":"(anonymous_28)","decl":{"start":{"line":143,"column":18},"end":{"line":143,"column":19}},"loc":{"start":{"line":143,"column":30},"end":{"line":159,"column":9}},"line":143},"29":{"name":"(anonymous_29)","decl":{"start":{"line":146,"column":41},"end":{"line":146,"column":42}},"loc":{"start":{"line":146,"column":56},"end":{"line":152,"column":13}},"line":146},"30":{"name":"(anonymous_30)","decl":{"start":{"line":148,"column":109},"end":{"line":148,"column":110}},"loc":{"start":{"line":148,"column":116},"end":{"line":151,"column":15}},"line":148},"31":{"name":"(anonymous_31)","decl":{"start":{"line":153,"column":52},"end":{"line":153,"column":53}},"loc":{"start":{"line":153,"column":59},"end":{"line":156,"column":13}},"line":153},"32":{"name":"(anonymous_32)","decl":{"start":{"line":163,"column":2},"end":{"line":163,"column":3}},"loc":{"start":{"line":163,"column":23},"end":{"line":198,"column":3}},"line":163},"33":{"name":"(anonymous_33)","decl":{"start":{"line":164,"column":19},"end":{"line":164,"column":20}},"loc":{"start":{"line":164,"column":25},"end":{"line":167,"column":5}},"line":164},"34":{"name":"(anonymous_34)","decl":{"start":{"line":168,"column":22},"end":{"line":168,"column":23}},"loc":{"start":{"line":168,"column":32},"end":{"line":177,"column":5}},"line":168},"35":{"name":"(anonymous_35)","decl":{"start":{"line":184,"column":16},"end":{"line":184,"column":17}},"loc":{"start":{"line":184,"column":39},"end":{"line":192,"column":9}},"line":184},"36":{"name":"(anonymous_36)","decl":{"start":{"line":186,"column":41},"end":{"line":186,"column":42}},"loc":{"start":{"line":186,"column":56},"end":{"line":191,"column":11}},"line":186},"37":{"name":"(anonymous_37)","decl":{"start":{"line":187,"column":65},"end":{"line":187,"column":66}},"loc":{"start":{"line":187,"column":72},"end":{"line":190,"column":13}},"line":187},"38":{"name":"(anonymous_38)","decl":{"start":{"line":193,"column":18},"end":{"line":193,"column":19}},"loc":{"start":{"line":193,"column":30},"end":{"line":195,"column":9}},"line":193}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":26},"end":{"line":4,"column":32}},{"start":{"line":4,"column":35},"end":{"line":4,"column":80}}],"line":4},"1":{"loc":{"start":{"line":4,"column":35},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":42},"end":{"line":4,"column":71}},{"start":{"line":4,"column":74},"end":{"line":4,"column":80}}],"line":4},"2":{"loc":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"type":"if","locations":[{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},{"start":{},"end":{}}],"line":6},"3":{"loc":{"start":{"line":7,"column":15},"end":{"line":7,"column":84}},"type":"binary-expr","locations":[{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},{"start":{"line":7,"column":78},"end":{"line":7,"column":84}}],"line":7},"4":{"loc":{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},"type":"cond-expr","locations":[{"start":{"line":7,"column":23},"end":{"line":7,"column":53}},{"start":{"line":7,"column":56},"end":{"line":7,"column":73}}],"line":7},"5":{"loc":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},{"start":{},"end":{}}],"line":8},"6":{"loc":{"start":{"line":8,"column":6},"end":{"line":8,"column":20}},"type":"binary-expr","locations":[{"start":{"line":8,"column":6},"end":{"line":8,"column":10}},{"start":{"line":8,"column":14},"end":{"line":8,"column":20}}],"line":8},"7":{"loc":{"start":{"line":89,"column":8},"end":{"line":107,"column":9}},"type":"switch","locations":[{"start":{"line":90,"column":10},"end":{"line":92,"column":11}},{"start":{"line":93,"column":10},"end":{"line":99,"column":11}},{"start":{"line":100,"column":10},"end":{"line":106,"column":11}}],"line":89},"8":{"loc":{"start":{"line":117,"column":6},"end":{"line":119,"column":7}},"type":"if","locations":[{"start":{"line":117,"column":6},"end":{"line":119,"column":7}},{"start":{},"end":{}}],"line":117},"9":{"loc":{"start":{"line":145,"column":10},"end":{"line":157,"column":11}},"type":"if","locations":[{"start":{"line":145,"column":10},"end":{"line":157,"column":11}},{"start":{},"end":{}}],"line":145},"10":{"loc":{"start":{"line":169,"column":6},"end":{"line":171,"column":7}},"type":"if","locations":[{"start":{"line":169,"column":6},"end":{"line":171,"column":7}},{"start":{},"end":{}}],"line":169}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":8,"7":8,"8":1,"9":0,"10":1,"11":1,"12":8,"13":8,"14":1,"15":1,"16":1,"17":2,"18":2,"19":2,"20":2,"21":2,"22":2,"23":2,"24":2,"25":2,"26":2,"27":2,"28":2,"29":2,"30":2,"31":2,"32":2,"33":2,"34":2,"35":36,"36":36,"37":2,"38":2,"39":2,"40":2,"41":0,"42":2,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":2,"53":0,"54":2,"55":2,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":2,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":2,"74":0,"75":0,"76":2,"77":0,"78":0,"79":0,"80":0,"81":0,"82":2,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":2,"102":0,"103":0,"104":2,"105":0,"106":0,"107":0,"108":0,"109":0,"110":2,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":1},"f":{"0":1,"1":8,"2":8,"3":2,"4":2,"5":2,"6":2,"7":36,"8":2,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":2,"19":0,"20":0,"21":0,"22":2,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":2,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0},"b":{"0":[0,1],"1":[0,1],"2":[8,0],"3":[8,8],"4":[0,8],"5":[0,1],"6":[1,0],"7":[0,0,0],"8":[0,0],"9":[0,0],"10":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission.service.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook, Worksheet } from '@univerjs/core';\nimport type { IObjectModel, IObjectPointModel } from '../type';\nimport { ILogService, Inject, Injector, IPermissionService, IResourceManagerService, IUniverInstanceService, RxDisposable, UniverInstanceType } from '@univerjs/core';\nimport { UniverType } from '@univerjs/protocol';\n\nimport { takeUntil } from 'rxjs/operators';\nimport { RangeProtectionRuleModel } from '../../../model/range-protection-rule.model';\nimport { getAllRangePermissionPoint } from '../range-permission/util';\nimport { getAllWorkbookPermissionPoint } from '../workbook-permission';\nimport { getAllWorksheetPermissionPoint, getAllWorksheetPermissionPointByPointPanel } from './utils';\nimport { WorksheetProtectionPointModel } from './worksheet-permission-point.model';\nimport { WorksheetProtectionRuleModel } from './worksheet-permission-rule.model';\n\nexport const RULE_MODEL_PLUGIN_NAME = 'SHEET_WORKSHEET_PROTECTION_PLUGIN';\nexport const POINT_MODEL_PLUGIN_NAME = 'SHEET_WORKSHEET_PROTECTION_POINT_PLUGIN';\n\nexport class WorksheetPermissionService extends RxDisposable {\n    constructor(\n        @Inject(IPermissionService) private _permissionService: IPermissionService,\n        @Inject(IUniverInstanceService) private _univerInstanceService: IUniverInstanceService,\n        @Inject(Injector) readonly _injector: Injector,\n        @Inject(WorksheetProtectionRuleModel) private _worksheetProtectionRuleModel: WorksheetProtectionRuleModel,\n        @Inject(WorksheetProtectionPointModel) private _worksheetProtectionPointRuleModel: WorksheetProtectionPointModel,\n        @Inject(IResourceManagerService) private _resourceManagerService: IResourceManagerService,\n        @Inject(RangeProtectionRuleModel) private _rangeProtectionRuleModel: RangeProtectionRuleModel,\n        @Inject(ILogService) private _logService: ILogService\n    ) {\n        super();\n        this._init();\n        this._initRuleChange();\n        this._initRuleSnapshot();\n        this._initPointSnapshot();\n    }\n\n    private _init() {\n        const handleWorkbook = (workbook: Workbook) => {\n            const unitId = workbook.getUnitId();\n            const handleWorksheet = (worksheet: Worksheet) => {\n                const subUnitId = worksheet.getSheetId();\n                [...getAllWorksheetPermissionPoint(), ...getAllWorksheetPermissionPointByPointPanel()].forEach((F) => {\n                    const instance = new F(unitId, subUnitId);\n                    this._permissionService.addPermissionPoint(instance);\n                });\n                this._logService.debug('[WorksheetPermissionService]', 'Initialization completed', unitId, subUnitId);\n            };\n            workbook.getSheets().forEach((worksheet) => {\n                handleWorksheet(worksheet);\n            });\n            workbook.sheetCreated$.subscribe((worksheet) => {\n                handleWorksheet(worksheet);\n            });\n            workbook.sheetDisposed$.subscribe((worksheet) => {\n                const subUnitId = worksheet.getSheetId();\n\n                const rangeRuleList = this._rangeProtectionRuleModel.getSubunitRuleList(unitId, subUnitId);\n                rangeRuleList.forEach((rule) => {\n                    [...getAllRangePermissionPoint()].forEach((F) => {\n                        const instance = new F(unitId, subUnitId, rule.permissionId);\n                        this._permissionService.deletePermissionPoint(instance.id);\n                    });\n                });\n\n                [...getAllWorksheetPermissionPoint(), ...getAllWorksheetPermissionPointByPointPanel()].forEach((F) => {\n                    const instance = new F(unitId, subUnitId);\n                    this._permissionService.deletePermissionPoint(instance.id);\n                });\n            });\n        };\n\n        this._univerInstanceService.getAllUnitsForType<Workbook>(UniverInstanceType.UNIVER_SHEET).forEach((workbook) => {\n            handleWorkbook(workbook);\n        });\n\n        this._univerInstanceService.getTypeOfUnitAdded$<Workbook>(UniverInstanceType.UNIVER_SHEET).pipe(takeUntil(this.dispose$)).subscribe(handleWorkbook);\n\n        this._univerInstanceService.getTypeOfUnitDisposed$<Workbook>(UniverInstanceType.UNIVER_SHEET).pipe(takeUntil(this.dispose$)).subscribe((workbook) => {\n            workbook.getSheets().forEach((worksheet) => {\n                const unitId = workbook.getUnitId();\n                const subUnitId = worksheet.getSheetId();\n                getAllWorksheetPermissionPoint().forEach((F) => {\n                    const instance = new F(unitId, subUnitId);\n                    this._permissionService.deletePermissionPoint(instance.id);\n                });\n            });\n        });\n    }\n\n    private _initRuleChange() {\n        this.disposeWithMe(\n            this._worksheetProtectionRuleModel.ruleChange$.subscribe((info) => {\n                switch (info.type) {\n                    case 'add': {\n                        break;\n                    }\n                    case 'delete': {\n                        getAllWorksheetPermissionPoint().forEach((F) => {\n                            const instance = new F(info.unitId, info.subUnitId);\n                            this._permissionService.updatePermissionPoint(instance.id, true);\n                        });\n                        break;\n                    }\n                    case 'set': {\n                        getAllWorksheetPermissionPoint().forEach((F) => {\n                            const instance = new F(info.unitId, info.subUnitId);\n                            this._permissionService.updatePermissionPoint(instance.id, info.rule);\n                        });\n                        break;\n                    }\n                }\n            })\n        );\n    }\n\n    private _initRuleSnapshot() {\n        const toJson = () => {\n            const object = this._worksheetProtectionRuleModel.toObject();\n            return JSON.stringify(object);\n        };\n        const parseJson = (json: string): IObjectModel => {\n            if (!json) {\n                return {};\n            }\n            try {\n                return JSON.parse(json);\n            } catch (err) {\n                return {};\n            }\n        };\n        this.disposeWithMe(\n            this._resourceManagerService.registerPluginResource({\n                toJson,\n                parseJson,\n                pluginName: RULE_MODEL_PLUGIN_NAME,\n                businesses: [UniverType.UNIVER_SHEET],\n                onLoad: (unitId, resources) => {\n                    this._worksheetProtectionRuleModel.fromObject(resources);\n                    Object.keys(resources).forEach((subUnitId) => {\n                        getAllWorksheetPermissionPoint().forEach((F) => {\n                            const instance = new F(unitId, subUnitId);\n                            instance.value = false;\n                            this._permissionService.addPermissionPoint(instance);\n                        });\n                    });\n                    this._worksheetProtectionRuleModel.changeRuleInitState(true);\n                },\n                onUnLoad: (unitId: string) => {\n                    const workbook = this._univerInstanceService.getUnit<Workbook>(unitId);\n                    if (workbook) {\n                        workbook.getSheets().forEach((worksheet) => {\n                            const subUnitId = worksheet.getSheetId();\n\n                            [...getAllWorksheetPermissionPoint(), ...getAllWorksheetPermissionPointByPointPanel()].forEach((F) => {\n                                const instance = new F(unitId, subUnitId);\n                                this._permissionService.deletePermissionPoint(instance.id);\n                            });\n                        });\n                        getAllWorkbookPermissionPoint().forEach((F) => {\n                            const instance = new F(unitId);\n                            this._permissionService.deletePermissionPoint(instance.id);\n                        });\n                    }\n\n                    this._worksheetProtectionRuleModel.deleteUnitModel(unitId);\n                },\n            })\n        );\n    }\n\n    private _initPointSnapshot() {\n        const toJson = () => {\n            const object = this._worksheetProtectionPointRuleModel.toObject();\n            return JSON.stringify(object);\n        };\n        const parseJson = (json: string): IObjectPointModel => {\n            if (!json) {\n                return {};\n            }\n            try {\n                return JSON.parse(json);\n            } catch (err) {\n                return {};\n            }\n        };\n        this.disposeWithMe(\n            this._resourceManagerService.registerPluginResource({\n                toJson,\n                parseJson,\n                pluginName: POINT_MODEL_PLUGIN_NAME,\n                businesses: [UniverType.UNIVER_SHEET],\n                onLoad: (unitId, resources) => {\n                    this._worksheetProtectionPointRuleModel.fromObject(resources);\n                    Object.keys(resources).forEach((subUnitId) => {\n                        getAllWorksheetPermissionPointByPointPanel().forEach((F) => {\n                            const instance = new F(unitId, subUnitId);\n                            this._permissionService.addPermissionPoint(instance);\n                        });\n                    });\n                },\n                onUnLoad: (unitId: string) => {\n                    this._worksheetProtectionPointRuleModel.deleteUnitModel(unitId);\n                },\n            })\n        );\n    }\n}\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2cff6eeff4b37afeee3f942eeeb98834565ee6e2"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/workbook-permission.service.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/workbook-permission.service.ts","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":37}},"1":{"start":{"line":2,"column":23},"end":{"line":2,"column":54}},"2":{"start":{"line":3,"column":22},"end":{"line":10,"column":1}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"4":{"start":{"line":5,"column":2},"end":{"line":7,"column":85}},"5":{"start":{"line":5,"column":15},"end":{"line":5,"column":36}},"6":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"7":{"start":{"line":7,"column":6},"end":{"line":7,"column":85}},"8":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"9":{"start":{"line":8,"column":22},"end":{"line":8,"column":53}},"10":{"start":{"line":9,"column":2},"end":{"line":9,"column":16}},"11":{"start":{"line":11,"column":22},"end":{"line":11,"column":90}},"12":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"13":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"14":{"start":{"line":18,"column":39},"end":{"line":67,"column":1}},"15":{"start":{"line":20,"column":4},"end":{"line":20,"column":12}},"16":{"start":{"line":21,"column":4},"end":{"line":21,"column":49}},"17":{"start":{"line":22,"column":4},"end":{"line":22,"column":57}},"18":{"start":{"line":23,"column":4},"end":{"line":23,"column":63}},"19":{"start":{"line":24,"column":4},"end":{"line":24,"column":71}},"20":{"start":{"line":25,"column":4},"end":{"line":25,"column":73}},"21":{"start":{"line":26,"column":4},"end":{"line":26,"column":17}},"22":{"start":{"line":29,"column":27},"end":{"line":35,"column":5}},"23":{"start":{"line":30,"column":21},"end":{"line":30,"column":41}},"24":{"start":{"line":31,"column":6},"end":{"line":34,"column":9}},"25":{"start":{"line":32,"column":25},"end":{"line":32,"column":38}},"26":{"start":{"line":33,"column":8},"end":{"line":33,"column":61}},"27":{"start":{"line":36,"column":4},"end":{"line":38,"column":7}},"28":{"start":{"line":37,"column":6},"end":{"line":37,"column":31}},"29":{"start":{"line":39,"column":4},"end":{"line":41,"column":8}},"30":{"start":{"line":40,"column":6},"end":{"line":40,"column":31}},"31":{"start":{"line":42,"column":4},"end":{"line":65,"column":8}},"32":{"start":{"line":43,"column":21},"end":{"line":43,"column":41}},"33":{"start":{"line":44,"column":6},"end":{"line":57,"column":9}},"34":{"start":{"line":45,"column":26},"end":{"line":45,"column":48}},"35":{"start":{"line":46,"column":30},"end":{"line":46,"column":98}},"36":{"start":{"line":47,"column":8},"end":{"line":52,"column":11}},"37":{"start":{"line":48,"column":10},"end":{"line":51,"column":13}},"38":{"start":{"line":49,"column":29},"end":{"line":49,"column":72}},"39":{"start":{"line":50,"column":12},"end":{"line":50,"column":71}},"40":{"start":{"line":53,"column":8},"end":{"line":56,"column":11}},"41":{"start":{"line":54,"column":27},"end":{"line":54,"column":51}},"42":{"start":{"line":55,"column":10},"end":{"line":55,"column":69}},"43":{"start":{"line":58,"column":6},"end":{"line":61,"column":9}},"44":{"start":{"line":59,"column":25},"end":{"line":59,"column":38}},"45":{"start":{"line":60,"column":8},"end":{"line":60,"column":67}},"46":{"start":{"line":62,"column":6},"end":{"line":62,"column":61}},"47":{"start":{"line":63,"column":6},"end":{"line":63,"column":66}},"48":{"start":{"line":64,"column":6},"end":{"line":64,"column":65}},"49":{"start":{"line":68,"column":0},"end":{"line":74,"column":30}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":22},"end":{"line":3,"column":23}},"loc":{"start":{"line":3,"column":57},"end":{"line":10,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":44},"end":{"line":11,"column":45}},"loc":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":19,"column":2},"end":{"line":19,"column":3}},"loc":{"start":{"line":19,"column":148},"end":{"line":27,"column":3}},"line":19},"4":{"name":"(anonymous_4)","decl":{"start":{"line":28,"column":2},"end":{"line":28,"column":3}},"loc":{"start":{"line":28,"column":10},"end":{"line":66,"column":3}},"line":28},"5":{"name":"(anonymous_5)","decl":{"start":{"line":29,"column":27},"end":{"line":29,"column":28}},"loc":{"start":{"line":29,"column":41},"end":{"line":35,"column":5}},"line":29},"6":{"name":"(anonymous_6)","decl":{"start":{"line":31,"column":46},"end":{"line":31,"column":47}},"loc":{"start":{"line":31,"column":53},"end":{"line":34,"column":7}},"line":31},"7":{"name":"(anonymous_7)","decl":{"start":{"line":36,"column":92},"end":{"line":36,"column":93}},"loc":{"start":{"line":36,"column":106},"end":{"line":38,"column":5}},"line":36},"8":{"name":"(anonymous_8)","decl":{"start":{"line":39,"column":114},"end":{"line":39,"column":115}},"loc":{"start":{"line":39,"column":128},"end":{"line":41,"column":5}},"line":39},"9":{"name":"(anonymous_9)","decl":{"start":{"line":42,"column":117},"end":{"line":42,"column":118}},"loc":{"start":{"line":42,"column":131},"end":{"line":65,"column":5}},"line":42},"10":{"name":"(anonymous_10)","decl":{"start":{"line":44,"column":35},"end":{"line":44,"column":36}},"loc":{"start":{"line":44,"column":50},"end":{"line":57,"column":7}},"line":44},"11":{"name":"(anonymous_11)","decl":{"start":{"line":47,"column":30},"end":{"line":47,"column":31}},"loc":{"start":{"line":47,"column":40},"end":{"line":52,"column":9}},"line":47},"12":{"name":"(anonymous_12)","decl":{"start":{"line":48,"column":52},"end":{"line":48,"column":53}},"loc":{"start":{"line":48,"column":59},"end":{"line":51,"column":11}},"line":48},"13":{"name":"(anonymous_13)","decl":{"start":{"line":53,"column":103},"end":{"line":53,"column":104}},"loc":{"start":{"line":53,"column":110},"end":{"line":56,"column":9}},"line":53},"14":{"name":"(anonymous_14)","decl":{"start":{"line":58,"column":46},"end":{"line":58,"column":47}},"loc":{"start":{"line":58,"column":53},"end":{"line":61,"column":7}},"line":58}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":26},"end":{"line":4,"column":32}},{"start":{"line":4,"column":35},"end":{"line":4,"column":80}}],"line":4},"1":{"loc":{"start":{"line":4,"column":35},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":42},"end":{"line":4,"column":71}},{"start":{"line":4,"column":74},"end":{"line":4,"column":80}}],"line":4},"2":{"loc":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"type":"if","locations":[{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},{"start":{},"end":{}}],"line":6},"3":{"loc":{"start":{"line":7,"column":15},"end":{"line":7,"column":84}},"type":"binary-expr","locations":[{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},{"start":{"line":7,"column":78},"end":{"line":7,"column":84}}],"line":7},"4":{"loc":{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},"type":"cond-expr","locations":[{"start":{"line":7,"column":23},"end":{"line":7,"column":53}},{"start":{"line":7,"column":56},"end":{"line":7,"column":73}}],"line":7},"5":{"loc":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},{"start":{},"end":{}}],"line":8},"6":{"loc":{"start":{"line":8,"column":6},"end":{"line":8,"column":20}},"type":"binary-expr","locations":[{"start":{"line":8,"column":6},"end":{"line":8,"column":10}},{"start":{"line":8,"column":14},"end":{"line":8,"column":20}}],"line":8}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":5,"7":5,"8":1,"9":0,"10":1,"11":1,"12":5,"13":5,"14":1,"15":2,"16":2,"17":2,"18":2,"19":2,"20":2,"21":2,"22":2,"23":2,"24":2,"25":36,"26":36,"27":2,"28":0,"29":2,"30":2,"31":2,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":1},"f":{"0":1,"1":5,"2":5,"3":2,"4":2,"5":2,"6":36,"7":0,"8":2,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"b":{"0":[0,1],"1":[0,1],"2":[5,0],"3":[5,5],"4":[0,5],"5":[0,1],"6":[1,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/workbook-permission.service.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport { Disposable, Inject, IPermissionService, IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport { RangeProtectionRuleModel } from '../../../model/range-protection-rule.model';\nimport { getAllRangePermissionPoint } from '../range-permission/util';\nimport { WorksheetProtectionPointModel, WorksheetProtectionRuleModel } from '../worksheet-permission';\nimport { getAllWorksheetPermissionPoint, getAllWorksheetPermissionPointByPointPanel } from '../worksheet-permission/utils';\nimport { getAllWorkbookPermissionPoint } from './util';\n\nexport class WorkbookPermissionService extends Disposable {\n    constructor(\n        @Inject(IPermissionService) private _permissionService: IPermissionService,\n        @Inject(IUniverInstanceService) private _univerInstanceService: IUniverInstanceService,\n        @Inject(RangeProtectionRuleModel) private _rangeProtectionRuleModel: RangeProtectionRuleModel,\n        @Inject(WorksheetProtectionRuleModel) private _worksheetProtectionRuleModel: WorksheetProtectionRuleModel,\n        @Inject(WorksheetProtectionPointModel) private _worksheetProtectionPointModel: WorksheetProtectionPointModel\n    ) {\n        super();\n\n        this._init();\n    }\n\n    private _init() {\n        const handleWorkbook = (workbook: Workbook) => {\n            const unitId = workbook.getUnitId();\n            getAllWorkbookPermissionPoint().forEach((F) => {\n                const instance = new F(unitId);\n                this._permissionService.addPermissionPoint(instance);\n            });\n        };\n\n        this._univerInstanceService.getAllUnitsForType<Workbook>(UniverInstanceType.UNIVER_SHEET).forEach((workbook) => {\n            handleWorkbook(workbook);\n        });\n\n        this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$<Workbook>(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) => {\n            handleWorkbook(workbook);\n        }));\n\n        this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$<Workbook>(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) => {\n            const unitId = workbook.getUnitId();\n            workbook.getSheets().forEach((worksheet) => {\n                const subUnitId = worksheet.getSheetId();\n\n                const rangeRuleList = this._rangeProtectionRuleModel.getSubunitRuleList(unitId, subUnitId);\n                rangeRuleList.forEach((rule) => {\n                    [...getAllRangePermissionPoint()].forEach((F) => {\n                        const instance = new F(unitId, subUnitId, rule.permissionId);\n                        this._permissionService.deletePermissionPoint(instance.id);\n                    });\n                });\n\n                [...getAllWorksheetPermissionPoint(), ...getAllWorksheetPermissionPointByPointPanel()].forEach((F) => {\n                    const instance = new F(unitId, subUnitId);\n                    this._permissionService.deletePermissionPoint(instance.id);\n                });\n            });\n            getAllWorkbookPermissionPoint().forEach((F) => {\n                const instance = new F(unitId);\n                this._permissionService.deletePermissionPoint(instance.id);\n            });\n\n            this._rangeProtectionRuleModel.deleteUnitModel(unitId);\n            this._worksheetProtectionPointModel.deleteUnitModel(unitId);\n            this._worksheetProtectionRuleModel.deleteUnitModel(unitId);\n        }));\n    }\n}\n"],"mappings":";;;;;;;;;;;AAiBA,SAAS,YAAY,QAAQ,oBAAoB,wBAAwB,0BAA0B;AACnG,SAAS,gCAAgC;AACzC,SAAS,kCAAkC;AAC3C,SAAS,+BAA+B,oCAAoC;AAC5E,SAAS,gCAAgC,kDAAkD;AAC3F,SAAS,qCAAqC;AAEvC,WAAM,4BAAN,cAAwC,WAAW;AAAA,EACtD,YACwC,oBACI,wBACE,2BACI,+BACC,gCACjD;AACE,UAAM;AAN8B;AACI;AACE;AACI;AACC;AAI/C,SAAK,MAAM;AAAA,EACf;AAAA,EAEQ,QAAQ;AACZ,UAAM,iBAAiB,CAAC,aAAuB;AAC3C,YAAM,SAAS,SAAS,UAAU;AAClC,oCAA8B,EAAE,QAAQ,CAAC,MAAM;AAC3C,cAAM,WAAW,IAAI,EAAE,MAAM;AAC7B,aAAK,mBAAmB,mBAAmB,QAAQ;AAAA,MACvD,CAAC;AAAA,IACL;AAEA,SAAK,uBAAuB,mBAA6B,mBAAmB,YAAY,EAAE,QAAQ,CAAC,aAAa;AAC5G,qBAAe,QAAQ;AAAA,IAC3B,CAAC;AAED,SAAK,cAAc,KAAK,uBAAuB,oBAA8B,mBAAmB,YAAY,EAAE,UAAU,CAAC,aAAa;AAClI,qBAAe,QAAQ;AAAA,IAC3B,CAAC,CAAC;AAEF,SAAK,cAAc,KAAK,uBAAuB,uBAAiC,mBAAmB,YAAY,EAAE,UAAU,CAAC,aAAa;AACrI,YAAM,SAAS,SAAS,UAAU;AAClC,eAAS,UAAU,EAAE,QAAQ,CAAC,cAAc;AACxC,cAAM,YAAY,UAAU,WAAW;AAEvC,cAAM,gBAAgB,KAAK,0BAA0B,mBAAmB,QAAQ,SAAS;AACzF,sBAAc,QAAQ,CAAC,SAAS;AAC5B,WAAC,GAAG,2BAA2B,CAAC,EAAE,QAAQ,CAAC,MAAM;AAC7C,kBAAM,WAAW,IAAI,EAAE,QAAQ,WAAW,KAAK,YAAY;AAC3D,iBAAK,mBAAmB,sBAAsB,SAAS,EAAE;AAAA,UAC7D,CAAC;AAAA,QACL,CAAC;AAED,SAAC,GAAG,+BAA+B,GAAG,GAAG,2CAA2C,CAAC,EAAE,QAAQ,CAAC,MAAM;AAClG,gBAAM,WAAW,IAAI,EAAE,QAAQ,SAAS;AACxC,eAAK,mBAAmB,sBAAsB,SAAS,EAAE;AAAA,QAC7D,CAAC;AAAA,MACL,CAAC;AACD,oCAA8B,EAAE,QAAQ,CAAC,MAAM;AAC3C,cAAM,WAAW,IAAI,EAAE,MAAM;AAC7B,aAAK,mBAAmB,sBAAsB,SAAS,EAAE;AAAA,MAC7D,CAAC;AAED,WAAK,0BAA0B,gBAAgB,MAAM;AACrD,WAAK,+BAA+B,gBAAgB,MAAM;AAC1D,WAAK,8BAA8B,gBAAgB,MAAM;AAAA,IAC7D,CAAC,CAAC;AAAA,EACN;AACJ;AA1Da,4BAAN;AAAA,EAEE,0BAAO,kBAAkB;AAAA,EACzB,0BAAO,sBAAsB;AAAA,EAC7B,0BAAO,wBAAwB;AAAA,EAC/B,0BAAO,4BAA4B;AAAA,EACnC,0BAAO,6BAA6B;AAAA,GANhC;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b11a0a8e514a3cef8fad998738863bb6694d417e"}}