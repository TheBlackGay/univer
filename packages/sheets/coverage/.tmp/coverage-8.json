{"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/type.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/type.ts","statementMap":{"0":{"start":{"line":1,"column":47},"end":{"line":7,"column":27}},"1":{"start":{"line":2,"column":2},"end":{"line":2,"column":74}},"2":{"start":{"line":3,"column":2},"end":{"line":3,"column":66}},"3":{"start":{"line":4,"column":2},"end":{"line":4,"column":70}},"4":{"start":{"line":5,"column":2},"end":{"line":5,"column":70}},"5":{"start":{"line":6,"column":2},"end":{"line":6,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":1,"column":48},"end":{"line":1,"column":49}},"loc":{"start":{"line":1,"column":72},"end":{"line":7,"column":1}},"line":1}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":3},"end":{"line":7,"column":26}},"type":"binary-expr","locations":[{"start":{"line":7,"column":3},"end":{"line":7,"column":20}},{"start":{"line":7,"column":24},"end":{"line":7,"column":26}}],"line":7}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1},"f":{"0":1},"b":{"0":[1,1]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/type.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface ISelectionManagerSearchParam {\n    unitId: string;\n    sheetId: string;\n}\n\nexport enum SelectionMoveType {\n    MOVE_START,\n    MOVING,\n    MOVE_END,\n    /**\n     * Events are not triggered by cursor movement\n     */\n    ONLY_SET,\n}\n"],"mappings":"AAqBO,WAAK,oBAAL,kBAAKA,uBAAL;AACH,EAAAA,sCAAA;AACA,EAAAA,sCAAA;AACA,EAAAA,sCAAA;AAIA,EAAAA,sCAAA;AAPQ,SAAAA;AAAA,GAAA;","names":["SelectionMoveType"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"51f6428312fde8c31d809a38f0c341bd74784748"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/selection-data-model.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/selection-data-model.ts","statementMap":{"0":{"start":{"line":6,"column":4},"end":{"line":6,"column":12}},"1":{"start":{"line":7,"column":4},"end":{"line":7,"column":31}},"2":{"start":{"line":8,"column":4},"end":{"line":8,"column":81}},"3":{"start":{"line":13,"column":41},"end":{"line":13,"column":50}},"4":{"start":{"line":14,"column":25},"end":{"line":14,"column":38}},"5":{"start":{"line":15,"column":24},"end":{"line":15,"column":64}},"6":{"start":{"line":16,"column":22},"end":{"line":16,"column":35}},"7":{"start":{"line":17,"column":21},"end":{"line":17,"column":58}},"8":{"start":{"line":18,"column":23},"end":{"line":18,"column":46}},"9":{"start":{"line":19,"column":22},"end":{"line":19,"column":60}},"10":{"start":{"line":20,"column":19},"end":{"line":20,"column":42}},"11":{"start":{"line":21,"column":18},"end":{"line":21,"column":52}},"12":{"start":{"line":23,"column":29},"end":{"line":23,"column":52}},"13":{"start":{"line":24,"column":28},"end":{"line":24,"column":72}},"14":{"start":{"line":26,"column":4},"end":{"line":26,"column":20}},"15":{"start":{"line":27,"column":4},"end":{"line":27,"column":45}},"16":{"start":{"line":28,"column":4},"end":{"line":28,"column":39}},"17":{"start":{"line":29,"column":4},"end":{"line":29,"column":38}},"18":{"start":{"line":30,"column":4},"end":{"line":30,"column":41}},"19":{"start":{"line":31,"column":4},"end":{"line":31,"column":35}},"20":{"start":{"line":34,"column":23},"end":{"line":34,"column":61}},"21":{"start":{"line":35,"column":4},"end":{"line":35,"column":39}},"22":{"start":{"line":36,"column":4},"end":{"line":36,"column":41}},"23":{"start":{"line":45,"column":4},"end":{"line":45,"column":59}},"24":{"start":{"line":46,"column":4},"end":{"line":64,"column":5}},"25":{"start":{"line":48,"column":8},"end":{"line":48,"column":55}},"26":{"start":{"line":49,"column":8},"end":{"line":49,"column":14}},"27":{"start":{"line":51,"column":8},"end":{"line":51,"column":52}},"28":{"start":{"line":52,"column":8},"end":{"line":52,"column":14}},"29":{"start":{"line":54,"column":8},"end":{"line":54,"column":59}},"30":{"start":{"line":55,"column":8},"end":{"line":55,"column":53}},"31":{"start":{"line":56,"column":8},"end":{"line":56,"column":14}},"32":{"start":{"line":58,"column":8},"end":{"line":58,"column":49}},"33":{"start":{"line":59,"column":8},"end":{"line":59,"column":14}},"34":{"start":{"line":62,"column":8},"end":{"line":62,"column":49}},"35":{"start":{"line":63,"column":8},"end":{"line":63,"column":14}},"36":{"start":{"line":67,"column":4},"end":{"line":67,"column":40}},"37":{"start":{"line":75,"column":4},"end":{"line":75,"column":50}},"38":{"start":{"line":78,"column":4},"end":{"line":80,"column":5}},"39":{"start":{"line":79,"column":6},"end":{"line":79,"column":49}},"40":{"start":{"line":81,"column":4},"end":{"line":81,"column":50}},"41":{"start":{"line":84,"column":4},"end":{"line":84,"column":60}},"42":{"start":{"line":87,"column":4},"end":{"line":87,"column":47}},"43":{"start":{"line":91,"column":4},"end":{"line":91,"column":38}},"44":{"start":{"line":92,"column":4},"end":{"line":92,"column":33}},"45":{"start":{"line":95,"column":4},"end":{"line":95,"column":87}},"46":{"start":{"line":98,"column":26},"end":{"line":98,"column":54}},"47":{"start":{"line":99,"column":4},"end":{"line":99,"column":51}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":2},"end":{"line":5,"column":3}},"loc":{"start":{"line":5,"column":25},"end":{"line":9,"column":3}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":25,"column":2},"end":{"line":25,"column":3}},"loc":{"start":{"line":25,"column":12},"end":{"line":32,"column":3}},"line":25},"2":{"name":"(anonymous_2)","decl":{"start":{"line":33,"column":2},"end":{"line":33,"column":3}},"loc":{"start":{"line":33,"column":41},"end":{"line":37,"column":3}},"line":33},"3":{"name":"(anonymous_3)","decl":{"start":{"line":44,"column":2},"end":{"line":44,"column":3}},"loc":{"start":{"line":44,"column":52},"end":{"line":65,"column":3}},"line":44},"4":{"name":"(anonymous_4)","decl":{"start":{"line":66,"column":2},"end":{"line":66,"column":3}},"loc":{"start":{"line":66,"column":25},"end":{"line":68,"column":3}},"line":66},"5":{"name":"(anonymous_5)","decl":{"start":{"line":74,"column":2},"end":{"line":74,"column":3}},"loc":{"start":{"line":74,"column":35},"end":{"line":76,"column":3}},"line":74},"6":{"name":"(anonymous_6)","decl":{"start":{"line":77,"column":2},"end":{"line":77,"column":3}},"loc":{"start":{"line":77,"column":36},"end":{"line":82,"column":3}},"line":77},"7":{"name":"(anonymous_7)","decl":{"start":{"line":83,"column":2},"end":{"line":83,"column":3}},"loc":{"start":{"line":83,"column":48},"end":{"line":85,"column":3}},"line":83},"8":{"name":"(anonymous_8)","decl":{"start":{"line":86,"column":2},"end":{"line":86,"column":3}},"loc":{"start":{"line":86,"column":32},"end":{"line":88,"column":3}},"line":86},"9":{"name":"(anonymous_9)","decl":{"start":{"line":90,"column":2},"end":{"line":90,"column":3}},"loc":{"start":{"line":90,"column":10},"end":{"line":93,"column":3}},"line":90},"10":{"name":"(anonymous_10)","decl":{"start":{"line":94,"column":2},"end":{"line":94,"column":3}},"loc":{"start":{"line":94,"column":26},"end":{"line":96,"column":3}},"line":94},"11":{"name":"(anonymous_11)","decl":{"start":{"line":97,"column":2},"end":{"line":97,"column":3}},"loc":{"start":{"line":97,"column":28},"end":{"line":100,"column":3}},"line":97}},"branchMap":{"0":{"loc":{"start":{"line":44,"column":25},"end":{"line":44,"column":44}},"type":"default-arg","locations":[{"start":{"line":44,"column":42},"end":{"line":44,"column":44}}],"line":44},"1":{"loc":{"start":{"line":46,"column":4},"end":{"line":64,"column":5}},"type":"switch","locations":[{"start":{"line":47,"column":6},"end":{"line":49,"column":14}},{"start":{"line":50,"column":6},"end":{"line":52,"column":14}},{"start":{"line":53,"column":6},"end":{"line":56,"column":14}},{"start":{"line":57,"column":6},"end":{"line":60,"column":7}},{"start":{"line":61,"column":6},"end":{"line":63,"column":14}}],"line":46},"2":{"loc":{"start":{"line":78,"column":4},"end":{"line":80,"column":5}},"type":"if","locations":[{"start":{"line":78,"column":4},"end":{"line":80,"column":5}},{"start":{},"end":{}}],"line":78}},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4,"7":4,"8":4,"9":4,"10":4,"11":4,"12":4,"13":4,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":6,"24":6,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":6,"33":6,"34":0,"35":0,"36":0,"37":0,"38":6,"39":2,"40":6,"41":6,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0},"f":{"0":4,"1":0,"2":0,"3":6,"4":0,"5":0,"6":6,"7":6,"8":0,"9":0,"10":0,"11":0},"b":{"0":[0],"1":[0,0,0,6,0],"2":[2,4]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/selection-data-model.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ISelectionCell, Nullable, Workbook } from '@univerjs/core';\nimport type { Observable } from 'rxjs';\nimport type { ISelectionWithStyle } from '../../basics/selection';\n\nimport { Disposable } from '@univerjs/core';\nimport { BehaviorSubject, merge, Subject } from 'rxjs';\nimport { SelectionMoveType } from './type';\n\n/**\n * Origin name: WorkbookSelections\n * NOT Same as @univerjs/sheets-ui.SelectionRenderModel, that's data for SelectionControl in rendering.\n */\nexport class WorkbookSelectionModel extends Disposable {\n    /**\n     * Selection data model for each worksheet.\n     */\n    private _worksheetSelections = new Map<string, ISelectionWithStyle[]>();\n\n    private readonly _selectionMoveStart$ = new Subject<Nullable<ISelectionWithStyle[]>>();\n    readonly selectionMoveStart$ = this._selectionMoveStart$.asObservable();\n\n    private readonly _selectionMoving$ = new Subject<Nullable<ISelectionWithStyle[]>>();\n    readonly selectionMoving$ = this._selectionMoving$.asObservable();\n\n    readonly _selectionMoveEnd$ = new BehaviorSubject<ISelectionWithStyle[]>([]);\n    readonly selectionMoveEnd$ = this._selectionMoveEnd$.asObservable();\n\n    private readonly _selectionSet$ = new BehaviorSubject<ISelectionWithStyle[]>([]);\n    readonly selectionSet$ = this._selectionSet$.asObservable();\n\n    selectionChanged$: Observable<ISelectionWithStyle[]>;\n\n    private readonly _beforeSelectionMoveEnd$ = new BehaviorSubject<ISelectionWithStyle[]>([]);\n    readonly beforeSelectionMoveEnd$ = this._beforeSelectionMoveEnd$.asObservable();\n\n    constructor(\n        private readonly _workbook: Workbook\n    ) {\n        super();\n        this.selectionChanged$ = merge(this._selectionMoveEnd$, this._selectionSet$);\n    }\n\n    override dispose(): void {\n        super.dispose();\n\n        this._beforeSelectionMoveEnd$.complete();\n        this._selectionMoveEnd$.complete();\n        this._selectionMoving$.complete();\n        this._selectionMoveStart$.complete();\n        this._selectionSet$.complete();\n    }\n\n    addSelections(sheetId: string, selectionDatas: ISelectionWithStyle[]): void {\n        const selections = this.getSelectionsOfWorksheet(sheetId);\n        selections.push(...selectionDatas);\n        this._selectionSet$.next(selections);\n    }\n\n    /**\n     * Set selectionDatas to _worksheetSelections, and emit selectionDatas by type.\n     * @param sheetId\n     * @param selectionDatas\n     * @param type\n     */\n    setSelections(sheetId: string, selectionDatas: ISelectionWithStyle[] = [], type: SelectionMoveType): void {\n        // selectionDatas should not be same variable as this._worksheetSelections !!!\n        // but there are some place get selection from this._worksheetSelections and set selectionDatas(2nd parameter of this function ) cause selectionDatas is always []\n        // see univer/pull/2909\n        // this.deleteSheetSelection(sheetId);\n        this.setSelectionsOfWorksheet(sheetId, selectionDatas);\n\n        switch (type) {\n            case SelectionMoveType.MOVE_START:\n                this._selectionMoveStart$.next(selectionDatas);\n                break;\n            case SelectionMoveType.MOVING:\n                this._selectionMoving$.next(selectionDatas);\n                break;\n            case SelectionMoveType.MOVE_END:\n                this._beforeSelectionMoveEnd$.next(selectionDatas);\n                this._selectionMoveEnd$.next(selectionDatas);\n                break;\n            case SelectionMoveType.ONLY_SET: {\n                this._selectionSet$.next(selectionDatas);\n                break;\n            }\n            default:\n                this._selectionSet$.next(selectionDatas);\n                break;\n        }\n    }\n\n    getCurrentSelections(): Readonly<ISelectionWithStyle[]> {\n        return this._getCurrentSelections();\n    }\n\n    /**\n     * @deprecated use `getSelectionsOfWorksheet` instead.\n     * @param sheetId\n     * @returns\n     */\n    getSelectionOfWorksheet(sheetId: string): ISelectionWithStyle[] {\n        return this.getSelectionsOfWorksheet(sheetId);\n    }\n\n    getSelectionsOfWorksheet(sheetId: string): ISelectionWithStyle[] {\n        if (!this._worksheetSelections.has(sheetId)) {\n            this._worksheetSelections.set(sheetId, []);\n        }\n\n        return this._worksheetSelections.get(sheetId)!;\n    }\n\n    setSelectionsOfWorksheet(sheetId: string, selections: ISelectionWithStyle[]): void {\n        this._worksheetSelections.set(sheetId, [...selections]);\n    }\n\n    deleteSheetSelection(sheetId: string) {\n        this._worksheetSelections.set(sheetId, []);\n    }\n\n    /** Clear all selections in this workbook. */\n    clear(): void {\n        this._worksheetSelections.clear();\n        this._selectionSet$.next([]);\n    }\n\n    private _getCurrentSelections(): ISelectionWithStyle[] {\n        return this.getSelectionsOfWorksheet(this._workbook.getActiveSheet()!.getSheetId());\n    }\n\n    getCurrentLastSelection(): Readonly<Nullable<ISelectionWithStyle & { primary: ISelectionCell }>> {\n        const selectionData = this._getCurrentSelections();\n        return selectionData[selectionData.length - 1] as Readonly<Nullable<ISelectionWithStyle & { primary: ISelectionCell }>>;\n    }\n}\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d65e983a192a7b520ce26d3bfaa6187256b3ed7c"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/selection.service.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/selection.service.ts","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":37}},"1":{"start":{"line":2,"column":23},"end":{"line":2,"column":54}},"2":{"start":{"line":3,"column":22},"end":{"line":10,"column":1}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"4":{"start":{"line":5,"column":2},"end":{"line":7,"column":85}},"5":{"start":{"line":5,"column":15},"end":{"line":5,"column":36}},"6":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"7":{"start":{"line":7,"column":6},"end":{"line":7,"column":85}},"8":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"9":{"start":{"line":8,"column":22},"end":{"line":8,"column":53}},"10":{"start":{"line":9,"column":2},"end":{"line":9,"column":16}},"11":{"start":{"line":11,"column":22},"end":{"line":11,"column":90}},"12":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"13":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"14":{"start":{"line":16,"column":37},"end":{"line":168,"column":1}},"15":{"start":{"line":18,"column":4},"end":{"line":18,"column":12}},"16":{"start":{"line":19,"column":4},"end":{"line":19,"column":37}},"17":{"start":{"line":20,"column":4},"end":{"line":20,"column":17}},"18":{"start":{"line":23,"column":21},"end":{"line":23,"column":93}},"19":{"start":{"line":24,"column":4},"end":{"line":24,"column":31}},"20":{"start":{"line":24,"column":19},"end":{"line":24,"column":31}},"21":{"start":{"line":25,"column":22},"end":{"line":25,"column":47}},"22":{"start":{"line":26,"column":4},"end":{"line":26,"column":77}},"23":{"start":{"line":29,"column":4},"end":{"line":29,"column":37}},"24":{"start":{"line":52,"column":15},"end":{"line":52,"column":134}},"25":{"start":{"line":53,"column":4},"end":{"line":53,"column":156}},"26":{"start":{"line":53,"column":63},"end":{"line":53,"column":153}},"27":{"start":{"line":54,"column":4},"end":{"line":54,"column":150}},"28":{"start":{"line":54,"column":60},"end":{"line":54,"column":147}},"29":{"start":{"line":55,"column":4},"end":{"line":55,"column":154}},"30":{"start":{"line":55,"column":61},"end":{"line":55,"column":151}},"31":{"start":{"line":56,"column":4},"end":{"line":56,"column":146}},"32":{"start":{"line":56,"column":57},"end":{"line":56,"column":143}},"33":{"start":{"line":57,"column":4},"end":{"line":66,"column":6}},"34":{"start":{"line":57,"column":61},"end":{"line":57,"column":151}},"35":{"start":{"line":59,"column":8},"end":{"line":59,"column":54}},"36":{"start":{"line":59,"column":41},"end":{"line":59,"column":54}},"37":{"start":{"line":60,"column":8},"end":{"line":60,"column":64}},"38":{"start":{"line":60,"column":52},"end":{"line":60,"column":64}},"39":{"start":{"line":61,"column":8},"end":{"line":63,"column":11}},"40":{"start":{"line":62,"column":10},"end":{"line":62,"column":70}},"41":{"start":{"line":67,"column":4},"end":{"line":69,"column":7}},"42":{"start":{"line":68,"column":6},"end":{"line":68,"column":58}},"43":{"start":{"line":76,"column":4},"end":{"line":76,"column":75}},"44":{"start":{"line":76,"column":54},"end":{"line":76,"column":73}},"45":{"start":{"line":79,"column":4},"end":{"line":79,"column":40}},"46":{"start":{"line":82,"column":26},"end":{"line":82,"column":54}},"47":{"start":{"line":83,"column":4},"end":{"line":83,"column":53}},"48":{"start":{"line":86,"column":4},"end":{"line":89,"column":5}},"49":{"start":{"line":87,"column":6},"end":{"line":87,"column":99}},"50":{"start":{"line":88,"column":6},"end":{"line":88,"column":13}},"51":{"start":{"line":90,"column":20},"end":{"line":90,"column":45}},"52":{"start":{"line":91,"column":4},"end":{"line":93,"column":5}},"53":{"start":{"line":92,"column":6},"end":{"line":92,"column":92}},"54":{"start":{"line":94,"column":32},"end":{"line":94,"column":39}},"55":{"start":{"line":95,"column":4},"end":{"line":95,"column":85}},"56":{"start":{"line":98,"column":4},"end":{"line":106,"column":5}},"57":{"start":{"line":99,"column":22},"end":{"line":99,"column":40}},"58":{"start":{"line":100,"column":6},"end":{"line":104,"column":8}},"59":{"start":{"line":105,"column":6},"end":{"line":105,"column":13}},"60":{"start":{"line":107,"column":20},"end":{"line":107,"column":45}},"61":{"start":{"line":108,"column":4},"end":{"line":110,"column":5}},"62":{"start":{"line":109,"column":6},"end":{"line":109,"column":92}},"63":{"start":{"line":111,"column":32},"end":{"line":111,"column":39}},"64":{"start":{"line":112,"column":4},"end":{"line":116,"column":5}},"65":{"start":{"line":113,"column":28},"end":{"line":113,"column":64}},"66":{"start":{"line":114,"column":20},"end":{"line":114,"column":67}},"67":{"start":{"line":115,"column":6},"end":{"line":115,"column":89}},"68":{"start":{"line":119,"column":26},"end":{"line":119,"column":54}},"69":{"start":{"line":120,"column":4},"end":{"line":120,"column":28}},"70":{"start":{"line":128,"column":30},"end":{"line":128,"column":57}},"71":{"start":{"line":129,"column":4},"end":{"line":131,"column":5}},"72":{"start":{"line":130,"column":6},"end":{"line":130,"column":19}},"73":{"start":{"line":132,"column":4},"end":{"line":139,"column":6}},"74":{"start":{"line":133,"column":28},"end":{"line":138,"column":8}},"75":{"start":{"line":134,"column":8},"end":{"line":136,"column":9}},"76":{"start":{"line":135,"column":10},"end":{"line":135,"column":23}},"77":{"start":{"line":137,"column":8},"end":{"line":137,"column":164}},"78":{"start":{"line":142,"column":20},"end":{"line":142,"column":45}},"79":{"start":{"line":143,"column":4},"end":{"line":145,"column":5}},"80":{"start":{"line":144,"column":6},"end":{"line":144,"column":16}},"81":{"start":{"line":146,"column":32},"end":{"line":146,"column":39}},"82":{"start":{"line":147,"column":4},"end":{"line":147,"column":83}},"83":{"start":{"line":150,"column":4},"end":{"line":150,"column":49}},"84":{"start":{"line":152,"column":40},"end":{"line":152,"column":49}},"85":{"start":{"line":154,"column":22},"end":{"line":154,"column":58}},"86":{"start":{"line":155,"column":4},"end":{"line":162,"column":5}},"87":{"start":{"line":156,"column":23},"end":{"line":156,"column":56}},"88":{"start":{"line":157,"column":6},"end":{"line":159,"column":7}},"89":{"start":{"line":158,"column":8},"end":{"line":158,"column":95}},"90":{"start":{"line":160,"column":6},"end":{"line":160,"column":57}},"91":{"start":{"line":161,"column":6},"end":{"line":161,"column":56}},"92":{"start":{"line":163,"column":4},"end":{"line":163,"column":23}},"93":{"start":{"line":166,"column":4},"end":{"line":166,"column":44}},"94":{"start":{"line":169,"column":0},"end":{"line":171,"column":28}},"95":{"start":{"line":172,"column":41},"end":{"line":172,"column":68}},"96":{"start":{"line":173,"column":34},"end":{"line":173,"column":54}},"97":{"start":{"line":174,"column":38},"end":{"line":174,"column":62}},"98":{"start":{"line":175,"column":30},"end":{"line":175,"column":50}},"99":{"start":{"line":176,"column":43},"end":{"line":180,"column":23}},"100":{"start":{"line":177,"column":2},"end":{"line":177,"column":58}},"101":{"start":{"line":178,"column":2},"end":{"line":178,"column":52}},"102":{"start":{"line":179,"column":2},"end":{"line":179,"column":24}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":22},"end":{"line":3,"column":23}},"loc":{"start":{"line":3,"column":57},"end":{"line":10,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":44},"end":{"line":11,"column":45}},"loc":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":17,"column":2},"end":{"line":17,"column":3}},"loc":{"start":{"line":17,"column":28},"end":{"line":21,"column":3}},"line":17},"4":{"name":"(anonymous_4)","decl":{"start":{"line":22,"column":2},"end":{"line":22,"column":3}},"loc":{"start":{"line":22,"column":29},"end":{"line":27,"column":3}},"line":22},"5":{"name":"(anonymous_5)","decl":{"start":{"line":28,"column":2},"end":{"line":28,"column":3}},"loc":{"start":{"line":28,"column":30},"end":{"line":30,"column":3}},"line":28},"6":{"name":"(anonymous_6)","decl":{"start":{"line":51,"column":2},"end":{"line":51,"column":3}},"loc":{"start":{"line":51,"column":10},"end":{"line":70,"column":3}},"line":51},"7":{"name":"(anonymous_7)","decl":{"start":{"line":53,"column":49},"end":{"line":53,"column":50}},"loc":{"start":{"line":53,"column":63},"end":{"line":53,"column":153}},"line":53},"8":{"name":"(anonymous_8)","decl":{"start":{"line":54,"column":46},"end":{"line":54,"column":47}},"loc":{"start":{"line":54,"column":60},"end":{"line":54,"column":147}},"line":54},"9":{"name":"(anonymous_9)","decl":{"start":{"line":55,"column":47},"end":{"line":55,"column":48}},"loc":{"start":{"line":55,"column":61},"end":{"line":55,"column":151}},"line":55},"10":{"name":"(anonymous_10)","decl":{"start":{"line":56,"column":43},"end":{"line":56,"column":44}},"loc":{"start":{"line":56,"column":57},"end":{"line":56,"column":143}},"line":56},"11":{"name":"(anonymous_11)","decl":{"start":{"line":57,"column":47},"end":{"line":57,"column":48}},"loc":{"start":{"line":57,"column":61},"end":{"line":57,"column":151}},"line":57},"12":{"name":"(anonymous_12)","decl":{"start":{"line":58,"column":27},"end":{"line":58,"column":28}},"loc":{"start":{"line":58,"column":43},"end":{"line":64,"column":7}},"line":58},"13":{"name":"(anonymous_13)","decl":{"start":{"line":61,"column":26},"end":{"line":61,"column":27}},"loc":{"start":{"line":61,"column":43},"end":{"line":63,"column":9}},"line":61},"14":{"name":"(anonymous_14)","decl":{"start":{"line":67,"column":119},"end":{"line":67,"column":120}},"loc":{"start":{"line":67,"column":133},"end":{"line":69,"column":5}},"line":67},"15":{"name":"(anonymous_15)","decl":{"start":{"line":75,"column":2},"end":{"line":75,"column":3}},"loc":{"start":{"line":75,"column":10},"end":{"line":77,"column":3}},"line":75},"16":{"name":"(anonymous_16)","decl":{"start":{"line":76,"column":37},"end":{"line":76,"column":38}},"loc":{"start":{"line":76,"column":54},"end":{"line":76,"column":73}},"line":76},"17":{"name":"(anonymous_17)","decl":{"start":{"line":78,"column":2},"end":{"line":78,"column":3}},"loc":{"start":{"line":78,"column":25},"end":{"line":80,"column":3}},"line":78},"18":{"name":"(anonymous_18)","decl":{"start":{"line":81,"column":2},"end":{"line":81,"column":3}},"loc":{"start":{"line":81,"column":28},"end":{"line":84,"column":3}},"line":81},"19":{"name":"(anonymous_19)","decl":{"start":{"line":85,"column":2},"end":{"line":85,"column":3}},"loc":{"start":{"line":85,"column":65},"end":{"line":96,"column":3}},"line":85},"20":{"name":"(anonymous_20)","decl":{"start":{"line":97,"column":2},"end":{"line":97,"column":3}},"loc":{"start":{"line":97,"column":77},"end":{"line":117,"column":3}},"line":97},"21":{"name":"(anonymous_21)","decl":{"start":{"line":118,"column":2},"end":{"line":118,"column":3}},"loc":{"start":{"line":118,"column":27},"end":{"line":121,"column":3}},"line":118},"22":{"name":"(anonymous_22)","decl":{"start":{"line":127,"column":2},"end":{"line":127,"column":3}},"loc":{"start":{"line":127,"column":18},"end":{"line":140,"column":3}},"line":127},"23":{"name":"(anonymous_23)","decl":{"start":{"line":133,"column":6},"end":{"line":133,"column":7}},"loc":{"start":{"line":133,"column":28},"end":{"line":138,"column":8}},"line":133},"24":{"name":"(anonymous_24)","decl":{"start":{"line":133,"column":51},"end":{"line":133,"column":52}},"loc":{"start":{"line":133,"column":82},"end":{"line":138,"column":7}},"line":133},"25":{"name":"(anonymous_25)","decl":{"start":{"line":141,"column":2},"end":{"line":141,"column":3}},"loc":{"start":{"line":141,"column":26},"end":{"line":148,"column":3}},"line":141},"26":{"name":"(anonymous_26)","decl":{"start":{"line":149,"column":2},"end":{"line":149,"column":3}},"loc":{"start":{"line":149,"column":32},"end":{"line":151,"column":3}},"line":149},"27":{"name":"(anonymous_27)","decl":{"start":{"line":153,"column":2},"end":{"line":153,"column":3}},"loc":{"start":{"line":153,"column":35},"end":{"line":164,"column":3}},"line":153},"28":{"name":"(anonymous_28)","decl":{"start":{"line":165,"column":2},"end":{"line":165,"column":3}},"loc":{"start":{"line":165,"column":35},"end":{"line":167,"column":3}},"line":165},"29":{"name":"(anonymous_29)","decl":{"start":{"line":176,"column":44},"end":{"line":176,"column":45}},"loc":{"start":{"line":176,"column":64},"end":{"line":180,"column":1}},"line":176}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":26},"end":{"line":4,"column":32}},{"start":{"line":4,"column":35},"end":{"line":4,"column":80}}],"line":4},"1":{"loc":{"start":{"line":4,"column":35},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":42},"end":{"line":4,"column":71}},{"start":{"line":4,"column":74},"end":{"line":4,"column":80}}],"line":4},"2":{"loc":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"type":"if","locations":[{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},{"start":{},"end":{}}],"line":6},"3":{"loc":{"start":{"line":7,"column":15},"end":{"line":7,"column":84}},"type":"binary-expr","locations":[{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},{"start":{"line":7,"column":78},"end":{"line":7,"column":84}}],"line":7},"4":{"loc":{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},"type":"cond-expr","locations":[{"start":{"line":7,"column":23},"end":{"line":7,"column":53}},{"start":{"line":7,"column":56},"end":{"line":7,"column":73}}],"line":7},"5":{"loc":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},{"start":{},"end":{}}],"line":8},"6":{"loc":{"start":{"line":8,"column":6},"end":{"line":8,"column":20}},"type":"binary-expr","locations":[{"start":{"line":8,"column":6},"end":{"line":8,"column":10}},{"start":{"line":8,"column":14},"end":{"line":8,"column":20}}],"line":8},"7":{"loc":{"start":{"line":24,"column":4},"end":{"line":24,"column":31}},"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":24,"column":31}},{"start":{},"end":{}}],"line":24},"8":{"loc":{"start":{"line":53,"column":63},"end":{"line":53,"column":153}},"type":"cond-expr","locations":[{"start":{"line":53,"column":75},"end":{"line":53,"column":79}},{"start":{"line":53,"column":82},"end":{"line":53,"column":153}}],"line":53},"9":{"loc":{"start":{"line":54,"column":60},"end":{"line":54,"column":147}},"type":"cond-expr","locations":[{"start":{"line":54,"column":72},"end":{"line":54,"column":76}},{"start":{"line":54,"column":79},"end":{"line":54,"column":147}}],"line":54},"10":{"loc":{"start":{"line":55,"column":61},"end":{"line":55,"column":151}},"type":"cond-expr","locations":[{"start":{"line":55,"column":73},"end":{"line":55,"column":79}},{"start":{"line":55,"column":82},"end":{"line":55,"column":151}}],"line":55},"11":{"loc":{"start":{"line":56,"column":57},"end":{"line":56,"column":143}},"type":"cond-expr","locations":[{"start":{"line":56,"column":69},"end":{"line":56,"column":75}},{"start":{"line":56,"column":78},"end":{"line":56,"column":143}}],"line":56},"12":{"loc":{"start":{"line":57,"column":61},"end":{"line":57,"column":151}},"type":"cond-expr","locations":[{"start":{"line":57,"column":73},"end":{"line":57,"column":79}},{"start":{"line":57,"column":82},"end":{"line":57,"column":151}}],"line":57},"13":{"loc":{"start":{"line":59,"column":8},"end":{"line":59,"column":54}},"type":"if","locations":[{"start":{"line":59,"column":8},"end":{"line":59,"column":54}},{"start":{},"end":{}}],"line":59},"14":{"loc":{"start":{"line":60,"column":8},"end":{"line":60,"column":64}},"type":"if","locations":[{"start":{"line":60,"column":8},"end":{"line":60,"column":64}},{"start":{},"end":{}}],"line":60},"15":{"loc":{"start":{"line":60,"column":12},"end":{"line":60,"column":50}},"type":"binary-expr","locations":[{"start":{"line":60,"column":12},"end":{"line":60,"column":29}},{"start":{"line":60,"column":33},"end":{"line":60,"column":50}}],"line":60},"16":{"loc":{"start":{"line":86,"column":4},"end":{"line":89,"column":5}},"type":"if","locations":[{"start":{"line":86,"column":4},"end":{"line":89,"column":5}},{"start":{},"end":{}}],"line":86},"17":{"loc":{"start":{"line":91,"column":4},"end":{"line":93,"column":5}},"type":"if","locations":[{"start":{"line":91,"column":4},"end":{"line":93,"column":5}},{"start":{},"end":{}}],"line":91},"18":{"loc":{"start":{"line":98,"column":4},"end":{"line":106,"column":5}},"type":"if","locations":[{"start":{"line":98,"column":4},"end":{"line":106,"column":5}},{"start":{},"end":{}}],"line":98},"19":{"loc":{"start":{"line":98,"column":8},"end":{"line":98,"column":87}},"type":"binary-expr","locations":[{"start":{"line":98,"column":8},"end":{"line":98,"column":46}},{"start":{"line":98,"column":50},"end":{"line":98,"column":87}}],"line":98},"20":{"loc":{"start":{"line":102,"column":8},"end":{"line":102,"column":28}},"type":"binary-expr","locations":[{"start":{"line":102,"column":8},"end":{"line":102,"column":22}},{"start":{"line":102,"column":26},"end":{"line":102,"column":28}}],"line":102},"21":{"loc":{"start":{"line":103,"column":8},"end":{"line":103,"column":42}},"type":"binary-expr","locations":[{"start":{"line":103,"column":8},"end":{"line":103,"column":12}},{"start":{"line":103,"column":16},"end":{"line":103,"column":42}}],"line":103},"22":{"loc":{"start":{"line":108,"column":4},"end":{"line":110,"column":5}},"type":"if","locations":[{"start":{"line":108,"column":4},"end":{"line":110,"column":5}},{"start":{},"end":{}}],"line":108},"23":{"loc":{"start":{"line":112,"column":4},"end":{"line":116,"column":5}},"type":"if","locations":[{"start":{"line":112,"column":4},"end":{"line":116,"column":5}},{"start":{},"end":{}}],"line":112},"24":{"loc":{"start":{"line":113,"column":28},"end":{"line":113,"column":64}},"type":"binary-expr","locations":[{"start":{"line":113,"column":28},"end":{"line":113,"column":46}},{"start":{"line":113,"column":50},"end":{"line":113,"column":64}}],"line":113},"25":{"loc":{"start":{"line":114,"column":20},"end":{"line":114,"column":67}},"type":"binary-expr","locations":[{"start":{"line":114,"column":20},"end":{"line":114,"column":37}},{"start":{"line":114,"column":41},"end":{"line":114,"column":67}}],"line":114},"26":{"loc":{"start":{"line":129,"column":4},"end":{"line":131,"column":5}},"type":"if","locations":[{"start":{"line":129,"column":4},"end":{"line":131,"column":5}},{"start":{},"end":{}}],"line":129},"27":{"loc":{"start":{"line":134,"column":8},"end":{"line":136,"column":9}},"type":"if","locations":[{"start":{"line":134,"column":8},"end":{"line":136,"column":9}},{"start":{},"end":{}}],"line":134},"28":{"loc":{"start":{"line":137,"column":15},"end":{"line":137,"column":163}},"type":"binary-expr","locations":[{"start":{"line":137,"column":15},"end":{"line":137,"column":46}},{"start":{"line":137,"column":50},"end":{"line":137,"column":81}},{"start":{"line":137,"column":85},"end":{"line":137,"column":122}},{"start":{"line":137,"column":126},"end":{"line":137,"column":163}}],"line":137},"29":{"loc":{"start":{"line":143,"column":4},"end":{"line":145,"column":5}},"type":"if","locations":[{"start":{"line":143,"column":4},"end":{"line":145,"column":5}},{"start":{},"end":{}}],"line":143},"30":{"loc":{"start":{"line":155,"column":4},"end":{"line":162,"column":5}},"type":"if","locations":[{"start":{"line":155,"column":4},"end":{"line":162,"column":5}},{"start":{},"end":{}}],"line":155},"31":{"loc":{"start":{"line":157,"column":6},"end":{"line":159,"column":7}},"type":"if","locations":[{"start":{"line":157,"column":6},"end":{"line":159,"column":7}},{"start":{},"end":{}}],"line":157},"32":{"loc":{"start":{"line":180,"column":3},"end":{"line":180,"column":22}},"type":"binary-expr","locations":[{"start":{"line":180,"column":3},"end":{"line":180,"column":16}},{"start":{"line":180,"column":20},"end":{"line":180,"column":22}}],"line":180}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1,"11":1,"12":1,"13":1,"14":1,"15":4,"16":4,"17":4,"18":8,"19":8,"20":0,"21":8,"22":8,"23":0,"24":4,"25":4,"26":0,"27":4,"28":0,"29":4,"30":0,"31":4,"32":0,"33":4,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":4,"42":0,"43":0,"44":0,"45":0,"46":4,"47":4,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":6,"57":4,"58":4,"59":4,"60":2,"61":2,"62":0,"63":2,"64":2,"65":2,"66":2,"67":2,"68":2,"69":2,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":6,"79":6,"80":0,"81":6,"82":6,"83":0,"84":4,"85":12,"86":12,"87":4,"88":4,"89":0,"90":4,"91":4,"92":12,"93":0,"94":1,"95":1,"96":1,"97":1,"98":1,"99":1,"100":1,"101":1,"102":1},"f":{"0":1,"1":1,"2":1,"3":4,"4":8,"5":0,"6":4,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":4,"19":0,"20":6,"21":2,"22":0,"23":0,"24":0,"25":6,"26":0,"27":12,"28":0,"29":1},"b":{"0":[0,1],"1":[0,1],"2":[1,0],"3":[1,1],"4":[0,1],"5":[0,1],"6":[1,0],"7":[0,8],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[4,2],"19":[6,4],"20":[4,0],"21":[4,4],"22":[0,2],"23":[2,0],"24":[2,0],"25":[2,2],"26":[0,0],"27":[0,0],"28":[0,0,0,0],"29":[0,6],"30":[4,8],"31":[0,4],"32":[1,1]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/selection.service.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { DeepReadonly, ISelectionCell, Nullable, Workbook } from '@univerjs/core';\nimport type { Observable } from 'rxjs';\nimport type { ISelectionWithStyle } from '../../basics/selection';\nimport type { ISelectionManagerSearchParam } from './type';\n\nimport { IUniverInstanceService, RxDisposable, UniverInstanceType } from '@univerjs/core';\nimport { distinctUntilChanged, of, shareReplay, skip, switchMap, takeUntil } from 'rxjs';\nimport { WorkbookSelectionModel } from './selection-data-model';\nimport { SelectionMoveType } from './type';\n\n/**\n * For normal selection.\n * Ref selection is in RefSelectionService which extends this class.\n */\nexport class SheetsSelectionsService extends RxDisposable {\n    private get _currentSelectionPos(): Nullable<ISelectionManagerSearchParam> {\n        const workbook = this._instanceSrv.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        if (!workbook) return null;\n\n        const worksheet = workbook.getActiveSheet();\n        return { unitId: workbook.getUnitId(), sheetId: worksheet.getSheetId() };\n    }\n\n    get currentSelectionParam() {\n        return this._currentSelectionPos;\n    }\n\n    /**\n     * Selection Events, usually triggered when pointerdown in spreadsheet by selection render service after selectionModel has updated.\n     */\n    selectionMoveStart$: Observable<Nullable<ISelectionWithStyle[]>>;\n\n    /**\n     * Selection Events, usually triggered when pointermove in spreadsheet by selection render service after selectionModel has updated.\n     */\n    selectionMoving$: Observable<Nullable<ISelectionWithStyle[]>>;\n\n    /**\n     * Selection Events, usually triggered when pointerup in spreadsheet by selection render service after selectionModel has updated.\n     */\n    selectionMoveEnd$: Observable<ISelectionWithStyle[]>;\n\n    /**\n     * Selection Events, usually triggered when changing unit.(focus in formula editor)\n     */\n    selectionSet$: Observable<Nullable<ISelectionWithStyle[]>>;\n\n    /**\n     * Selection Events, merge moveEnd$ and selectionSet$\n     */\n    selectionChanged$: Observable<Nullable<ISelectionWithStyle[]>>;\n\n    constructor(\n        @IUniverInstanceService protected readonly _instanceSrv: IUniverInstanceService\n    ) {\n        super();\n        this._init();\n    }\n\n    protected _init(): void {\n        const c$ = this._instanceSrv.getCurrentTypeOfUnit$(UniverInstanceType.UNIVER_SHEET).pipe(shareReplay(1), takeUntil(this.dispose$));\n        // When workbook changed, unsubscribe the previous workbook selection$ and subscribe the new workbook selection$.\n        this.selectionMoveStart$ = c$.pipe(switchMap((workbook) => !workbook ? of() : this._ensureWorkbookSelection(workbook.getUnitId()).selectionMoveStart$));\n        this.selectionMoving$ = c$.pipe(switchMap((workbook) => !workbook ? of() : this._ensureWorkbookSelection(workbook.getUnitId()).selectionMoving$));\n        this.selectionMoveEnd$ = c$.pipe(switchMap((workbook) => !workbook ? of([]) : this._ensureWorkbookSelection(workbook.getUnitId()).selectionMoveEnd$));\n        this.selectionSet$ = c$.pipe(switchMap((workbook) => !workbook ? of([]) : this._ensureWorkbookSelection(workbook.getUnitId()).selectionSet$));\n        this.selectionChanged$ = c$.pipe(switchMap((workbook) => !workbook ? of([]) : this._ensureWorkbookSelection(workbook.getUnitId()).selectionChanged$)).pipe(\n            distinctUntilChanged((prev, curr) => {\n                if (prev.length !== curr.length) return false;\n                if (prev.length === 0 && curr.length === 0) return true;\n                return prev.every((item, index) => {\n                    return JSON.stringify(item) === JSON.stringify(curr[index]);\n                });\n            }),\n            skip(1)\n        );\n\n        this._instanceSrv.getTypeOfUnitDisposed$(UniverInstanceType.UNIVER_SHEET).pipe(takeUntil(this.dispose$)).subscribe((workbook) => {\n            this._removeWorkbookSelection(workbook.getUnitId());\n        });\n    }\n\n    /**\n     * Clear all selections in all workbooks.\n     * invoked by prompt.controller\n     */\n    clear(): void {\n        this._workbookSelections.forEach((wbSelection) => wbSelection.clear());\n    }\n\n    getCurrentSelections(): Readonly<ISelectionWithStyle[]> {\n        return this._getCurrentSelections();\n    }\n\n    getCurrentLastSelection(): DeepReadonly<Nullable<ISelectionWithStyle & { primary: ISelectionCell }>> {\n        const selectionData = this._getCurrentSelections();\n        return selectionData?.[selectionData.length - 1] as Readonly<Nullable<ISelectionWithStyle & { primary: ISelectionCell }>>;\n    }\n\n    addSelections(selectionsData: ISelectionWithStyle[]): void;\n    addSelections(unitId: string, worksheetId: string, selectionDatas: ISelectionWithStyle[]): void;\n    addSelections(unitIdOrSelections: string | ISelectionWithStyle[], worksheetId?: string, selectionDatas?: ISelectionWithStyle[]): void {\n        if (typeof unitIdOrSelections === 'string') {\n            this._ensureWorkbookSelection(unitIdOrSelections).addSelections(worksheetId!, selectionDatas!);\n            return;\n        }\n\n        const current = this._currentSelectionPos;\n        if (!current) {\n            throw new Error('[SheetsSelectionsService]: cannot find current selection position!');\n        }\n        const { unitId, sheetId } = current;\n        this._ensureWorkbookSelection(unitId).addSelections(sheetId, unitIdOrSelections);\n    }\n\n    /**\n     * Set selection data to WorkbookSelectionModel.\n     *\n     * @param unitIdOrSelections\n     * @param worksheetIdOrType\n     * @param selectionDatas\n     * @param type\n     */\n    setSelections(selectionDatas: ISelectionWithStyle[], type?: SelectionMoveType): void;\n    setSelections(unitId: string, worksheetId: string, selectionDatas: ISelectionWithStyle[], type?: SelectionMoveType): void;\n    setSelections(\n        unitIdOrSelections: string | ISelectionWithStyle[],\n        worksheetIdOrType: string | SelectionMoveType | undefined,\n        selectionDatas?: ISelectionWithStyle[],\n        type?: SelectionMoveType\n    ): void {\n        if (typeof unitIdOrSelections === 'string' && typeof worksheetIdOrType === 'string') {\n            const unitId = unitIdOrSelections as string;\n            this._ensureWorkbookSelection(unitId).setSelections(\n                worksheetIdOrType,\n                selectionDatas || [],\n                type ?? SelectionMoveType.ONLY_SET\n            );\n            return;\n        }\n\n        const current = this._currentSelectionPos;\n        if (!current) {\n            throw new Error('[SheetsSelectionsService]: cannot find current selection position!');\n        }\n\n        const { unitId, sheetId } = current;\n        if (typeof unitIdOrSelections === 'object') {\n            const selectionData = unitIdOrSelections ?? selectionDatas;\n            const type = worksheetIdOrType as SelectionMoveType ?? SelectionMoveType.ONLY_SET;\n            this._ensureWorkbookSelection(unitId).setSelections(sheetId, selectionData, type);\n        }\n    }\n\n    clearCurrentSelections(): void {\n        const selectionData = this._getCurrentSelections();\n        selectionData.splice(0);\n    }\n\n    /**\n     * Determine whether multiple current selections overlap\n     *\n     * @deprecated this should be extracted to an pure function\n     */\n    isOverlapping(): boolean {\n        const selectionDataList = this.getCurrentSelections();\n        if (selectionDataList == null) {\n            return false;\n        }\n\n        return selectionDataList.some(({ range }, index) =>\n            selectionDataList.some(({ range: range2 }, index2) => {\n                if (index === index2) {\n                    return false;\n                }\n                return (\n                    range.startRow <= range2.endRow &&\n                    range.endRow >= range2.startRow &&\n                    range.startColumn <= range2.endColumn &&\n                    range.endColumn >= range2.startColumn\n                );\n            })\n        );\n    }\n\n    protected _getCurrentSelections() {\n        const current = this._currentSelectionPos;\n        if (!current) {\n            return [];\n        }\n\n        const { unitId, sheetId } = current;\n        return this._ensureWorkbookSelection(unitId).getSelectionsOfWorksheet(sheetId);\n    }\n\n    getWorkbookSelections(unitId: string): WorkbookSelectionModel {\n        return this._ensureWorkbookSelection(unitId);\n    }\n\n    protected _workbookSelections = new Map<string, WorkbookSelectionModel>();\n    protected _ensureWorkbookSelection(unitId: string): WorkbookSelectionModel {\n        let wbSelection = this._workbookSelections.get(unitId);\n        if (!wbSelection) {\n            const workbook = this._instanceSrv.getUnit<Workbook>(unitId);\n            if (!workbook) {\n                throw new Error(`[SheetsSelectionsService]: cannot resolve unit with id \"${unitId}\"!`);\n            }\n\n            wbSelection = new WorkbookSelectionModel(workbook);\n            this._workbookSelections.set(unitId, wbSelection);\n        }\n\n        return wbSelection;\n    }\n\n    protected _removeWorkbookSelection(unitId: string): void {\n        this._workbookSelections.delete(unitId);\n    }\n}\n\n/** An context key to disable normal selections if its value is set to `true`. */\n// so Bad! why not enableXXX\nexport const DISABLE_NORMAL_SELECTIONS = 'DISABLE_NORMAL_SELECTIONS';\nexport const SELECTIONS_ENABLED = 'SELECTIONS_ENABLED';\nexport const REF_SELECTIONS_ENABLED = 'REF_SELECTIONS_ENABLED';\nexport const SELECTION_MODE = '__SELECTION_MODE__';\nexport enum SelectionMode {\n    NORMAL,\n    REF,\n}\n"],"mappings":"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","names":["unitId","type","SelectionMode"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b16e153c94b4eb4eacefc64dc6cf5e11f8cf2046"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/add-worksheet-merge.mutation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/add-worksheet-merge.mutation.ts","statementMap":{"0":{"start":{"line":2,"column":43},"end":{"line":13,"column":1}},"1":{"start":{"line":3,"column":32},"end":{"line":3,"column":68}},"2":{"start":{"line":4,"column":22},"end":{"line":4,"column":81}},"3":{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},"4":{"start":{"line":6,"column":4},"end":{"line":6,"column":50}},"5":{"start":{"line":8,"column":2},"end":{"line":12,"column":4}},"6":{"start":{"line":14,"column":41},"end":{"line":34,"column":1}},"7":{"start":{"line":18,"column":34},"end":{"line":18,"column":70}},"8":{"start":{"line":19,"column":24},"end":{"line":19,"column":83}},"9":{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},"10":{"start":{"line":21,"column":6},"end":{"line":21,"column":52}},"11":{"start":{"line":23,"column":22},"end":{"line":23,"column":69}},"12":{"start":{"line":24,"column":4},"end":{"line":24,"column":33}},"13":{"start":{"line":24,"column":20},"end":{"line":24,"column":33}},"14":{"start":{"line":25,"column":19},"end":{"line":25,"column":40}},"15":{"start":{"line":26,"column":28},"end":{"line":26,"column":44}},"16":{"start":{"line":27,"column":28},"end":{"line":27,"column":41}},"17":{"start":{"line":28,"column":4},"end":{"line":30,"column":5}},"18":{"start":{"line":28,"column":17},"end":{"line":28,"column":18}},"19":{"start":{"line":29,"column":6},"end":{"line":29,"column":47}},"20":{"start":{"line":31,"column":4},"end":{"line":31,"column":54}},"21":{"start":{"line":32,"column":4},"end":{"line":32,"column":16}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":43},"end":{"line":2,"column":44}},"loc":{"start":{"line":2,"column":65},"end":{"line":13,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":17,"column":11},"end":{"line":17,"column":12}},"loc":{"start":{"line":17,"column":33},"end":{"line":33,"column":3}},"line":17}},"branchMap":{"0":{"loc":{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},"type":"if","locations":[{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},{"start":{},"end":{}}],"line":5},"1":{"loc":{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},{"start":{},"end":{}}],"line":20},"2":{"loc":{"start":{"line":24,"column":4},"end":{"line":24,"column":33}},"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":24,"column":33}},{"start":{},"end":{}}],"line":24}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0},"f":{"0":0,"1":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/add-worksheet-merge.mutation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommandType, IUniverInstanceService, Tools } from '@univerjs/core';\nimport type { IAccessor, IMutation } from '@univerjs/core';\n\nimport type {\n    IAddWorksheetMergeMutationParams,\n    IRemoveWorksheetMergeMutationParams,\n} from '../../basics/interfaces/mutation-interface';\n\nexport const AddMergeUndoMutationFactory = (\n    accessor: IAccessor,\n    params: IAddWorksheetMergeMutationParams\n): IRemoveWorksheetMergeMutationParams => {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n    if (universheet == null) {\n        throw new Error('universheet is null error!');\n    }\n\n    return {\n        unitId: params.unitId,\n        subUnitId: params.subUnitId,\n        ranges: Tools.deepClone(params.ranges),\n    };\n};\n\nexport const AddWorksheetMergeMutation: IMutation<IAddWorksheetMergeMutationParams> = {\n    id: 'sheet.mutation.add-worksheet-merge',\n    type: CommandType.MUTATION,\n    handler: (accessor: IAccessor, params: IAddWorksheetMergeMutationParams) => {\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n        if (universheet == null) {\n            throw new Error('universheet is null error!');\n        }\n\n        const worksheet = universheet.getSheetBySheetId(params.subUnitId);\n        if (!worksheet) return false;\n\n        const config = worksheet.getConfig()!;\n        const mergeConfigData = config.mergeData;\n        const mergeAppendData = params.ranges;\n        for (let i = 0; i < mergeAppendData.length; i++) {\n            mergeConfigData.push(mergeAppendData[i]);\n        }\n        worksheet.getSpanModel().rebuild(mergeConfigData);\n\n        return true;\n    },\n};\n"],"mappings":"AAgBA,SAAS,aAAa,wBAAwB,aAAa;AAQpD,aAAM,8BAA8B,CACvC,UACA,WACsC;AACtC,QAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,QAAM,cAAc,sBAAsB,uBAAuB,OAAO,MAAM;AAE9E,MAAI,eAAe,MAAM;AACrB,UAAM,IAAI,MAAM,4BAA4B;AAAA,EAChD;AAEA,SAAO;AAAA,IACH,QAAQ,OAAO;AAAA,IACf,WAAW,OAAO;AAAA,IAClB,QAAQ,MAAM,UAAU,OAAO,MAAM;AAAA,EACzC;AACJ;AAEO,aAAM,4BAAyE;AAAA,EAClF,IAAI;AAAA,EACJ,MAAM,YAAY;AAAA,EAClB,SAAS,CAAC,UAAqB,WAA6C;AACxE,UAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,UAAM,cAAc,sBAAsB,uBAAuB,OAAO,MAAM;AAE9E,QAAI,eAAe,MAAM;AACrB,YAAM,IAAI,MAAM,4BAA4B;AAAA,IAChD;AAEA,UAAM,YAAY,YAAY,kBAAkB,OAAO,SAAS;AAChE,QAAI,CAAC,UAAW,QAAO;AAEvB,UAAM,SAAS,UAAU,UAAU;AACnC,UAAM,kBAAkB,OAAO;AAC/B,UAAM,kBAAkB,OAAO;AAC/B,aAAS,IAAI,GAAG,IAAI,gBAAgB,QAAQ,KAAK;AAC7C,sBAAgB,KAAK,gBAAgB,CAAC,CAAC;AAAA,IAC3C;AACA,cAAU,aAAa,EAAE,QAAQ,eAAe;AAEhD,WAAO;AAAA,EACX;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d86c5a274de10095e632f62c3703fbc435245526"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/insert-row-col.mutation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/insert-row-col.mutation.ts","statementMap":{"0":{"start":{"line":2,"column":44},"end":{"line":13,"column":1}},"1":{"start":{"line":3,"column":32},"end":{"line":3,"column":68}},"2":{"start":{"line":4,"column":22},"end":{"line":4,"column":81}},"3":{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},"4":{"start":{"line":6,"column":4},"end":{"line":6,"column":50}},"5":{"start":{"line":8,"column":2},"end":{"line":12,"column":4}},"6":{"start":{"line":14,"column":33},"end":{"line":47,"column":1}},"7":{"start":{"line":18,"column":50},"end":{"line":18,"column":56}},"8":{"start":{"line":19,"column":34},"end":{"line":19,"column":70}},"9":{"start":{"line":20,"column":24},"end":{"line":20,"column":76}},"10":{"start":{"line":21,"column":4},"end":{"line":23,"column":5}},"11":{"start":{"line":22,"column":6},"end":{"line":22,"column":52}},"12":{"start":{"line":24,"column":22},"end":{"line":24,"column":62}},"13":{"start":{"line":25,"column":4},"end":{"line":27,"column":5}},"14":{"start":{"line":26,"column":6},"end":{"line":26,"column":50}},"15":{"start":{"line":28,"column":23},"end":{"line":28,"column":61}},"16":{"start":{"line":29,"column":27},"end":{"line":32,"column":5}},"17":{"start":{"line":33,"column":21},"end":{"line":33,"column":35}},"18":{"start":{"line":34,"column":21},"end":{"line":34,"column":54}},"19":{"start":{"line":35,"column":4},"end":{"line":41,"column":5}},"20":{"start":{"line":35,"column":17},"end":{"line":35,"column":25}},"21":{"start":{"line":36,"column":6},"end":{"line":40,"column":7}},"22":{"start":{"line":37,"column":8},"end":{"line":37,"column":88}},"23":{"start":{"line":39,"column":8},"end":{"line":39,"column":57}},"24":{"start":{"line":42,"column":4},"end":{"line":42,"column":87}},"25":{"start":{"line":43,"column":23},"end":{"line":43,"column":48}},"26":{"start":{"line":44,"column":4},"end":{"line":44,"column":52}},"27":{"start":{"line":45,"column":4},"end":{"line":45,"column":16}},"28":{"start":{"line":48,"column":44},"end":{"line":59,"column":1}},"29":{"start":{"line":49,"column":32},"end":{"line":49,"column":68}},"30":{"start":{"line":50,"column":22},"end":{"line":50,"column":81}},"31":{"start":{"line":51,"column":2},"end":{"line":53,"column":3}},"32":{"start":{"line":52,"column":4},"end":{"line":52,"column":50}},"33":{"start":{"line":54,"column":2},"end":{"line":58,"column":4}},"34":{"start":{"line":60,"column":33},"end":{"line":94,"column":1}},"35":{"start":{"line":64,"column":34},"end":{"line":64,"column":70}},"36":{"start":{"line":65,"column":24},"end":{"line":65,"column":83}},"37":{"start":{"line":66,"column":4},"end":{"line":68,"column":5}},"38":{"start":{"line":67,"column":6},"end":{"line":67,"column":52}},"39":{"start":{"line":69,"column":22},"end":{"line":69,"column":69}},"40":{"start":{"line":70,"column":4},"end":{"line":70,"column":33}},"41":{"start":{"line":70,"column":20},"end":{"line":70,"column":33}},"42":{"start":{"line":71,"column":20},"end":{"line":71,"column":48}},"43":{"start":{"line":72,"column":31},"end":{"line":72,"column":37}},"44":{"start":{"line":73,"column":28},"end":{"line":73,"column":51}},"45":{"start":{"line":74,"column":26},"end":{"line":74,"column":41}},"46":{"start":{"line":75,"column":21},"end":{"line":75,"column":38}},"47":{"start":{"line":76,"column":21},"end":{"line":76,"column":60}},"48":{"start":{"line":77,"column":28},"end":{"line":77,"column":68}},"49":{"start":{"line":78,"column":4},"end":{"line":88,"column":5}},"50":{"start":{"line":78,"column":17},"end":{"line":78,"column":25}},"51":{"start":{"line":79,"column":29},"end":{"line":82,"column":7}},"52":{"start":{"line":83,"column":6},"end":{"line":87,"column":7}},"53":{"start":{"line":84,"column":8},"end":{"line":84,"column":94}},"54":{"start":{"line":86,"column":8},"end":{"line":86,"column":60}},"55":{"start":{"line":89,"column":4},"end":{"line":89,"column":99}},"56":{"start":{"line":90,"column":23},"end":{"line":90,"column":48}},"57":{"start":{"line":91,"column":4},"end":{"line":91,"column":58}},"58":{"start":{"line":92,"column":4},"end":{"line":92,"column":16}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":66},"end":{"line":13,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":17,"column":11},"end":{"line":17,"column":12}},"loc":{"start":{"line":17,"column":33},"end":{"line":46,"column":3}},"line":17},"2":{"name":"(anonymous_2)","decl":{"start":{"line":48,"column":44},"end":{"line":48,"column":45}},"loc":{"start":{"line":48,"column":66},"end":{"line":59,"column":1}},"line":48},"3":{"name":"(anonymous_3)","decl":{"start":{"line":63,"column":11},"end":{"line":63,"column":12}},"loc":{"start":{"line":63,"column":33},"end":{"line":93,"column":3}},"line":63}},"branchMap":{"0":{"loc":{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},"type":"if","locations":[{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},{"start":{},"end":{}}],"line":5},"1":{"loc":{"start":{"line":21,"column":4},"end":{"line":23,"column":5}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":23,"column":5}},{"start":{},"end":{}}],"line":21},"2":{"loc":{"start":{"line":25,"column":4},"end":{"line":27,"column":5}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":27,"column":5}},{"start":{},"end":{}}],"line":25},"3":{"loc":{"start":{"line":36,"column":6},"end":{"line":40,"column":7}},"type":"if","locations":[{"start":{"line":36,"column":6},"end":{"line":40,"column":7}},{"start":{"line":38,"column":13},"end":{"line":40,"column":7}}],"line":36},"4":{"loc":{"start":{"line":37,"column":29},"end":{"line":37,"column":74}},"type":"binary-expr","locations":[{"start":{"line":37,"column":29},"end":{"line":37,"column":56}},{"start":{"line":37,"column":60},"end":{"line":37,"column":74}}],"line":37},"5":{"loc":{"start":{"line":51,"column":2},"end":{"line":53,"column":3}},"type":"if","locations":[{"start":{"line":51,"column":2},"end":{"line":53,"column":3}},{"start":{},"end":{}}],"line":51},"6":{"loc":{"start":{"line":66,"column":4},"end":{"line":68,"column":5}},"type":"if","locations":[{"start":{"line":66,"column":4},"end":{"line":68,"column":5}},{"start":{},"end":{}}],"line":66},"7":{"loc":{"start":{"line":70,"column":4},"end":{"line":70,"column":33}},"type":"if","locations":[{"start":{"line":70,"column":4},"end":{"line":70,"column":33}},{"start":{},"end":{}}],"line":70},"8":{"loc":{"start":{"line":83,"column":6},"end":{"line":87,"column":7}},"type":"if","locations":[{"start":{"line":83,"column":6},"end":{"line":87,"column":7}},{"start":{"line":85,"column":13},"end":{"line":87,"column":7}}],"line":83},"9":{"loc":{"start":{"line":84,"column":29},"end":{"line":84,"column":77}},"type":"binary-expr","locations":[{"start":{"line":84,"column":29},"end":{"line":84,"column":59}},{"start":{"line":84,"column":63},"end":{"line":84,"column":77}}],"line":84}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":1,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0},"f":{"0":0,"1":0,"2":0,"3":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/insert-row-col.mutation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, IMutation } from '@univerjs/core';\nimport { CommandType, insertMatrixArray, IUniverInstanceService } from '@univerjs/core';\n\nimport type {\n    IInsertColMutationParams,\n    IInsertRowMutationParams,\n    IRemoveColMutationParams,\n    IRemoveRowsMutationParams,\n} from '../../basics/interfaces/mutation-interface';\n\nexport const InsertRowMutationUndoFactory = (\n    accessor: IAccessor,\n    params: IInsertRowMutationParams\n): IRemoveRowsMutationParams => {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n    if (universheet == null) {\n        throw new Error('universheet is null error!');\n    }\n\n    return {\n        unitId: params.unitId,\n        subUnitId: params.subUnitId,\n        range: params.range,\n    };\n};\n\nexport const InsertRowMutation: IMutation<IInsertRowMutationParams> = {\n    id: 'sheet.mutation.insert-row',\n    type: CommandType.MUTATION,\n    handler: (accessor, params) => {\n        const { unitId, subUnitId, range, rowInfo } = params;\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const universheet = univerInstanceService.getUniverSheetInstance(unitId);\n        if (universheet == null) {\n            throw new Error('universheet is null error!');\n        }\n\n        const worksheet = universheet.getSheetBySheetId(subUnitId);\n        if (worksheet == null) {\n            throw new Error('worksheet is null error!');\n        }\n\n        // TODO@wzhudev: should not expose row data and let outside modules to modify it directly\n        // the correct way to do this is to provide a method from RowManager to modify row data\n        const rowWrapper = worksheet.getRowManager().getRowData();\n        const defaultRowInfo = {\n            h: worksheet.getConfig().defaultRowHeight,\n            hd: 0,\n        };\n\n        const rowIndex = range.startRow;\n        const rowCount = range.endRow - range.startRow + 1;\n\n        for (let j = rowIndex; j < rowIndex + rowCount; j++) {\n            if (rowInfo) {\n                insertMatrixArray(j, rowInfo[j - range.startRow] ?? defaultRowInfo, rowWrapper);\n            } else {\n                insertMatrixArray(j, defaultRowInfo, rowWrapper);\n            }\n        }\n\n        worksheet.setRowCount(worksheet.getRowCount() + range.endRow - range.startRow + 1);\n\n        // remove cells contents by directly mutating worksheetCellMatrix\n        const cellMatrix = worksheet.getCellMatrix();\n        cellMatrix.insertRows(range.startRow, rowCount);\n\n        return true;\n    },\n};\n\nexport const InsertColMutationUndoFactory = (\n    accessor: IAccessor,\n    params: IInsertColMutationParams\n): IRemoveColMutationParams => {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n    if (universheet == null) {\n        throw new Error('universheet is null error!');\n    }\n\n    return {\n        unitId: params.unitId,\n        subUnitId: params.subUnitId,\n        range: params.range,\n    };\n};\n\nexport const InsertColMutation: IMutation<IInsertColMutationParams> = {\n    id: 'sheet.mutation.insert-col',\n    type: CommandType.MUTATION,\n    handler: (accessor, params) => {\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n        if (universheet == null) {\n            throw new Error('universheet is null error!');\n        }\n\n        const worksheet = universheet.getSheetBySheetId(params.subUnitId);\n        if (!worksheet) return false;\n        const manager = worksheet.getColumnManager();\n        const { range, colInfo } = params;\n        const columnPrimitive = manager.getColumnData();\n        const columnWrapper = columnPrimitive;\n\n        const colIndex = range.startColumn;\n        const colCount = range.endColumn - range.startColumn + 1;\n        const defaultColWidth = worksheet.getConfig().defaultColumnWidth;\n        for (let j = colIndex; j < colIndex + colCount; j++) {\n            const defaultColInfo = {\n                w: defaultColWidth,\n                hd: 0,\n            };\n            if (colInfo) {\n                insertMatrixArray(j, colInfo[j - range.startColumn] ?? defaultColInfo, columnWrapper);\n            } else {\n                insertMatrixArray(j, defaultColInfo, columnWrapper);\n            }\n        }\n\n        worksheet.setColumnCount(worksheet.getColumnCount() + range.endColumn - range.startColumn + 1);\n\n        // remove cells contents by directly mutating worksheetCellMatrix\n        const cellMatrix = worksheet.getCellMatrix();\n        cellMatrix.insertColumns(range.startColumn, colCount);\n\n        return true;\n    },\n};\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"136f17d3503c2524f8af9379339362834d480879"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/move-range.mutation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/move-range.mutation.ts","statementMap":{"0":{"start":{"line":2,"column":33},"end":{"line":30,"column":1}},"1":{"start":{"line":6,"column":25},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":9,"column":5}},"3":{"start":{"line":8,"column":6},"end":{"line":8,"column":19}},"4":{"start":{"line":10,"column":34},"end":{"line":10,"column":70}},"5":{"start":{"line":11,"column":21},"end":{"line":11,"column":97}},"6":{"start":{"line":12,"column":4},"end":{"line":14,"column":5}},"7":{"start":{"line":13,"column":6},"end":{"line":13,"column":19}},"8":{"start":{"line":15,"column":26},"end":{"line":15,"column":75}},"9":{"start":{"line":16,"column":24},"end":{"line":16,"column":71}},"10":{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},"11":{"start":{"line":18,"column":6},"end":{"line":18,"column":19}},"12":{"start":{"line":20,"column":27},"end":{"line":20,"column":56}},"13":{"start":{"line":21,"column":25},"end":{"line":21,"column":52}},"14":{"start":{"line":22,"column":4},"end":{"line":24,"column":7}},"15":{"start":{"line":23,"column":6},"end":{"line":23,"column":48}},"16":{"start":{"line":25,"column":4},"end":{"line":27,"column":7}},"17":{"start":{"line":26,"column":6},"end":{"line":26,"column":46}},"18":{"start":{"line":28,"column":4},"end":{"line":28,"column":16}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":11},"end":{"line":5,"column":12}},"loc":{"start":{"line":5,"column":33},"end":{"line":29,"column":3}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":22,"column":42},"end":{"line":22,"column":43}},"loc":{"start":{"line":22,"column":64},"end":{"line":24,"column":5}},"line":22},"2":{"name":"(anonymous_2)","decl":{"start":{"line":25,"column":40},"end":{"line":25,"column":41}},"loc":{"start":{"line":25,"column":62},"end":{"line":27,"column":5}},"line":25}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":4},"end":{"line":9,"column":5}},"type":"if","locations":[{"start":{"line":7,"column":4},"end":{"line":9,"column":5}},{"start":{},"end":{}}],"line":7},"1":{"loc":{"start":{"line":7,"column":8},"end":{"line":7,"column":20}},"type":"binary-expr","locations":[{"start":{"line":7,"column":8},"end":{"line":7,"column":13}},{"start":{"line":7,"column":17},"end":{"line":7,"column":20}}],"line":7},"2":{"loc":{"start":{"line":12,"column":4},"end":{"line":14,"column":5}},"type":"if","locations":[{"start":{"line":12,"column":4},"end":{"line":14,"column":5}},{"start":{},"end":{}}],"line":12},"3":{"loc":{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},"type":"if","locations":[{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},{"start":{},"end":{}}],"line":17},"4":{"loc":{"start":{"line":17,"column":8},"end":{"line":17,"column":38}},"type":"binary-expr","locations":[{"start":{"line":17,"column":8},"end":{"line":17,"column":22}},{"start":{"line":17,"column":26},"end":{"line":17,"column":38}}],"line":17}},"s":{"0":1,"1":8,"2":8,"3":0,"4":8,"5":8,"6":8,"7":0,"8":8,"9":8,"10":8,"11":0,"12":8,"13":8,"14":8,"15":28,"16":8,"17":28,"18":8},"f":{"0":8,"1":28,"2":28},"b":{"0":[0,8],"1":[8,8],"2":[0,8],"3":[0,8],"4":[8,8]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/move-range.mutation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellData, IMutation, IObjectMatrixPrimitiveType, IRange, Nullable, Workbook } from '@univerjs/core';\nimport { CommandType, IUniverInstanceService, ObjectMatrix, UniverInstanceType } from '@univerjs/core';\n\nexport interface IMoveRangeMutationParams {\n    unitId: string;\n    fromRange: IRange;\n    toRange: IRange;\n    from: {\n        subUnitId: string;\n        value: IObjectMatrixPrimitiveType<Nullable<ICellData>>;\n    };\n    to: {\n        subUnitId: string;\n        value: IObjectMatrixPrimitiveType<Nullable<ICellData>>;\n    };\n}\n\nexport const MoveRangeMutation: IMutation<IMoveRangeMutationParams, boolean> = {\n    id: 'sheet.mutation.move-range',\n    type: CommandType.MUTATION,\n    handler: (accessor, params) => {\n        const { from, to } = params;\n\n        if (!from || !to) {\n            return false;\n        }\n\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        if (!workbook) {\n            return false;\n        }\n\n        const fromWorksheet = workbook.getSheetBySheetId(params.from.subUnitId);\n        const toWorksheet = workbook.getSheetBySheetId(params.to.subUnitId);\n\n        if (!fromWorksheet || !toWorksheet) {\n            return false;\n        }\n\n        const fromCellMatrix = fromWorksheet.getCellMatrix();\n        const toCellMatrix = toWorksheet.getCellMatrix();\n\n        new ObjectMatrix<Nullable<ICellData>>(from.value).forValue((row, col, newVal) => {\n            fromCellMatrix.setValue(row, col, newVal);\n        });\n\n        new ObjectMatrix<Nullable<ICellData>>(to.value).forValue((row, col, newVal) => {\n            toCellMatrix.setValue(row, col, newVal);\n        });\n\n        return true;\n    },\n};\n"],"mappings":"AAiBA,SAAS,aAAa,wBAAwB,cAAc,0BAA0B;AAgB/E,aAAM,oBAAkE;AAAA,EAC3E,IAAI;AAAA,EACJ,MAAM,YAAY;AAAA,EAClB,SAAS,CAAC,UAAU,WAAW;AAC3B,UAAM,EAAE,MAAM,GAAG,IAAI;AAErB,QAAI,CAAC,QAAQ,CAAC,IAAI;AACd,aAAO;AAAA,IACX;AAEA,UAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,UAAM,WAAW,sBAAsB,sBAAgC,mBAAmB,YAAY;AACtG,QAAI,CAAC,UAAU;AACX,aAAO;AAAA,IACX;AAEA,UAAM,gBAAgB,SAAS,kBAAkB,OAAO,KAAK,SAAS;AACtE,UAAM,cAAc,SAAS,kBAAkB,OAAO,GAAG,SAAS;AAElE,QAAI,CAAC,iBAAiB,CAAC,aAAa;AAChC,aAAO;AAAA,IACX;AAEA,UAAM,iBAAiB,cAAc,cAAc;AACnD,UAAM,eAAe,YAAY,cAAc;AAE/C,QAAI,aAAkC,KAAK,KAAK,EAAE,SAAS,CAAC,KAAK,KAAK,WAAW;AAC7E,qBAAe,SAAS,KAAK,KAAK,MAAM;AAAA,IAC5C,CAAC;AAED,QAAI,aAAkC,GAAG,KAAK,EAAE,SAAS,CAAC,KAAK,KAAK,WAAW;AAC3E,mBAAa,SAAS,KAAK,KAAK,MAAM;AAAA,IAC1C,CAAC;AAED,WAAO;AAAA,EACX;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"451da5749b100f709e0e613a585e3e778aa91c73"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/remove-row-col.mutation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/remove-row-col.mutation.ts","statementMap":{"0":{"start":{"line":2,"column":45},"end":{"line":16,"column":1}},"1":{"start":{"line":3,"column":18},"end":{"line":3,"column":43}},"2":{"start":{"line":4,"column":23},"end":{"line":4,"column":43}},"3":{"start":{"line":5,"column":21},"end":{"line":5,"column":33}},"4":{"start":{"line":6,"column":18},"end":{"line":6,"column":20}},"5":{"start":{"line":7,"column":16},"end":{"line":7,"column":28}},"6":{"start":{"line":8,"column":16},"end":{"line":8,"column":74}},"7":{"start":{"line":9,"column":19},"end":{"line":9,"column":52}},"8":{"start":{"line":10,"column":2},"end":{"line":15,"column":4}},"9":{"start":{"line":17,"column":33},"end":{"line":44,"column":1}},"10":{"start":{"line":21,"column":34},"end":{"line":21,"column":70}},"11":{"start":{"line":22,"column":24},"end":{"line":22,"column":83}},"12":{"start":{"line":23,"column":4},"end":{"line":25,"column":5}},"13":{"start":{"line":24,"column":6},"end":{"line":24,"column":52}},"14":{"start":{"line":26,"column":22},"end":{"line":26,"column":69}},"15":{"start":{"line":27,"column":4},"end":{"line":27,"column":33}},"16":{"start":{"line":27,"column":20},"end":{"line":27,"column":33}},"17":{"start":{"line":28,"column":18},"end":{"line":28,"column":30}},"18":{"start":{"line":29,"column":20},"end":{"line":29,"column":45}},"19":{"start":{"line":30,"column":25},"end":{"line":30,"column":45}},"20":{"start":{"line":31,"column":26},"end":{"line":31,"column":28}},"21":{"start":{"line":32,"column":4},"end":{"line":36,"column":5}},"22":{"start":{"line":32,"column":17},"end":{"line":32,"column":31}},"23":{"start":{"line":33,"column":6},"end":{"line":35,"column":7}},"24":{"start":{"line":34,"column":8},"end":{"line":34,"column":30}},"25":{"start":{"line":37,"column":21},"end":{"line":37,"column":54}},"26":{"start":{"line":38,"column":4},"end":{"line":38,"column":56}},"27":{"start":{"line":39,"column":23},"end":{"line":39,"column":48}},"28":{"start":{"line":40,"column":4},"end":{"line":40,"column":52}},"29":{"start":{"line":41,"column":4},"end":{"line":41,"column":62}},"30":{"start":{"line":42,"column":4},"end":{"line":42,"column":16}},"31":{"start":{"line":45,"column":40},"end":{"line":68,"column":1}},"32":{"start":{"line":46,"column":32},"end":{"line":46,"column":68}},"33":{"start":{"line":47,"column":22},"end":{"line":47,"column":81}},"34":{"start":{"line":48,"column":2},"end":{"line":50,"column":3}},"35":{"start":{"line":49,"column":4},"end":{"line":49,"column":50}},"36":{"start":{"line":51,"column":20},"end":{"line":51,"column":67}},"37":{"start":{"line":52,"column":2},"end":{"line":54,"column":3}},"38":{"start":{"line":53,"column":4},"end":{"line":53,"column":48}},"39":{"start":{"line":55,"column":18},"end":{"line":55,"column":46}},"40":{"start":{"line":56,"column":26},"end":{"line":56,"column":49}},"41":{"start":{"line":57,"column":24},"end":{"line":57,"column":39}},"42":{"start":{"line":58,"column":18},"end":{"line":58,"column":20}},"43":{"start":{"line":59,"column":16},"end":{"line":59,"column":28}},"44":{"start":{"line":60,"column":16},"end":{"line":60,"column":83}},"45":{"start":{"line":61,"column":19},"end":{"line":61,"column":52}},"46":{"start":{"line":62,"column":2},"end":{"line":67,"column":4}},"47":{"start":{"line":69,"column":33},"end":{"line":90,"column":1}},"48":{"start":{"line":73,"column":34},"end":{"line":73,"column":70}},"49":{"start":{"line":74,"column":24},"end":{"line":74,"column":83}},"50":{"start":{"line":75,"column":4},"end":{"line":77,"column":5}},"51":{"start":{"line":76,"column":6},"end":{"line":76,"column":52}},"52":{"start":{"line":78,"column":22},"end":{"line":78,"column":69}},"53":{"start":{"line":79,"column":4},"end":{"line":79,"column":33}},"54":{"start":{"line":79,"column":20},"end":{"line":79,"column":33}},"55":{"start":{"line":80,"column":18},"end":{"line":80,"column":30}},"56":{"start":{"line":81,"column":20},"end":{"line":81,"column":48}},"57":{"start":{"line":82,"column":25},"end":{"line":82,"column":48}},"58":{"start":{"line":83,"column":21},"end":{"line":83,"column":60}},"59":{"start":{"line":84,"column":4},"end":{"line":84,"column":59}},"60":{"start":{"line":85,"column":4},"end":{"line":85,"column":68}},"61":{"start":{"line":86,"column":23},"end":{"line":86,"column":48}},"62":{"start":{"line":87,"column":4},"end":{"line":87,"column":58}},"63":{"start":{"line":88,"column":4},"end":{"line":88,"column":16}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":45},"end":{"line":2,"column":46}},"loc":{"start":{"line":2,"column":68},"end":{"line":16,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":20,"column":11},"end":{"line":20,"column":12}},"loc":{"start":{"line":20,"column":33},"end":{"line":43,"column":3}},"line":20},"2":{"name":"(anonymous_2)","decl":{"start":{"line":45,"column":40},"end":{"line":45,"column":41}},"loc":{"start":{"line":45,"column":62},"end":{"line":68,"column":1}},"line":45},"3":{"name":"(anonymous_3)","decl":{"start":{"line":72,"column":11},"end":{"line":72,"column":12}},"loc":{"start":{"line":72,"column":33},"end":{"line":89,"column":3}},"line":72}},"branchMap":{"0":{"loc":{"start":{"line":23,"column":4},"end":{"line":25,"column":5}},"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":25,"column":5}},{"start":{},"end":{}}],"line":23},"1":{"loc":{"start":{"line":27,"column":4},"end":{"line":27,"column":33}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":27,"column":33}},{"start":{},"end":{}}],"line":27},"2":{"loc":{"start":{"line":33,"column":6},"end":{"line":35,"column":7}},"type":"if","locations":[{"start":{"line":33,"column":6},"end":{"line":35,"column":7}},{"start":{},"end":{}}],"line":33},"3":{"loc":{"start":{"line":48,"column":2},"end":{"line":50,"column":3}},"type":"if","locations":[{"start":{"line":48,"column":2},"end":{"line":50,"column":3}},{"start":{},"end":{}}],"line":48},"4":{"loc":{"start":{"line":52,"column":2},"end":{"line":54,"column":3}},"type":"if","locations":[{"start":{"line":52,"column":2},"end":{"line":54,"column":3}},{"start":{},"end":{}}],"line":52},"5":{"loc":{"start":{"line":75,"column":4},"end":{"line":77,"column":5}},"type":"if","locations":[{"start":{"line":75,"column":4},"end":{"line":77,"column":5}},{"start":{},"end":{}}],"line":75},"6":{"loc":{"start":{"line":79,"column":4},"end":{"line":79,"column":33}},"type":"if","locations":[{"start":{"line":79,"column":4},"end":{"line":79,"column":33}},{"start":{},"end":{}}],"line":79}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":1,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":1,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0},"f":{"0":0,"1":0,"2":0,"3":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/remove-row-col.mutation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, IColumnData, IMutation, IObjectArrayPrimitiveType, IRowData, Worksheet } from '@univerjs/core';\nimport { CommandType, concatMatrixArray, IUniverInstanceService, sliceMatrixArray, spliceArray } from '@univerjs/core';\n\nimport type {\n    IInsertColMutationParams,\n    IInsertRowMutationParams,\n    IRemoveColMutationParams,\n    IRemoveRowsMutationParams,\n} from '../../basics/interfaces/mutation-interface';\n\nexport const RemoveRowsUndoMutationFactory = (\n    params: IRemoveRowsMutationParams,\n    worksheet: Worksheet\n): IInsertRowMutationParams => {\n    const manager = worksheet.getRowManager();\n    const rowPrimitive = manager.getRowData();\n    const rowWrapper = rowPrimitive;\n    const rowInfo: IObjectArrayPrimitiveType<IRowData> = {};\n\n    const range = params.range;\n    const slice = sliceMatrixArray(range.startRow, range.endRow, rowWrapper);\n    const _rowInfo = concatMatrixArray(rowInfo, slice);\n\n    return {\n        unitId: params.unitId,\n        subUnitId: params.subUnitId,\n        range: params.range,\n        rowInfo: _rowInfo as IObjectArrayPrimitiveType<IRowData>,\n    };\n};\n\nexport const RemoveRowMutation: IMutation<IRemoveRowsMutationParams> = {\n    id: 'sheet.mutation.remove-rows',\n\n    type: CommandType.MUTATION,\n\n    handler: (accessor, params) => {\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n        if (universheet == null) {\n            throw new Error('universheet is null error!');\n        }\n\n        const worksheet = universheet.getSheetBySheetId(params.subUnitId);\n        if (!worksheet) return false;\n        const range = params.range;\n        const manager = worksheet.getRowManager();\n        const rowPrimitive = manager.getRowData();\n\n        const filterOutRows = [];\n        for (let i = range.startRow; i <= range.endRow; i++) {\n            if (worksheet.getRowFiltered(i)) {\n                filterOutRows.push(i);\n            }\n        }\n\n        const rowCount = range.endRow - range.startRow + 1;\n        spliceArray(range.startRow, rowCount, rowPrimitive);\n\n        // remove cells contents by directly mutating worksheetCellMatrix\n        const cellMatrix = worksheet.getCellMatrix();\n        cellMatrix.removeRows(range.startRow, rowCount);\n\n        worksheet.setRowCount(worksheet.getRowCount() - rowCount);\n\n        return true;\n    },\n};\n\nexport const RemoveColMutationFactory = (\n    accessor: IAccessor,\n    params: IRemoveColMutationParams\n): IInsertColMutationParams => {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n    if (universheet == null) {\n        throw new Error('universheet is null error!');\n    }\n\n    const worksheet = universheet.getSheetBySheetId(params.subUnitId);\n\n    if (worksheet == null) {\n        throw new Error('worksheet is null error!');\n    }\n\n    const manager = worksheet.getColumnManager();\n    const columnPrimitive = manager.getColumnData();\n    const columnWrapper = columnPrimitive;\n    const colInfo: IObjectArrayPrimitiveType<IColumnData> = {};\n\n    const range = params.range;\n\n    const slice = sliceMatrixArray(range.startColumn, range.endColumn, columnWrapper);\n\n    const _colInfo = concatMatrixArray(colInfo, slice);\n\n    return {\n        unitId: params.unitId,\n        subUnitId: params.subUnitId,\n        range: params.range,\n        colInfo: _colInfo as IObjectArrayPrimitiveType<IColumnData>,\n    };\n};\n\nexport const RemoveColMutation: IMutation<IRemoveColMutationParams> = {\n    id: 'sheet.mutation.remove-col',\n    type: CommandType.MUTATION,\n    handler: (accessor, params) => {\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n        if (universheet == null) {\n            throw new Error('universheet is null error!');\n        }\n\n        const worksheet = universheet.getSheetBySheetId(params.subUnitId);\n        if (!worksheet) return false;\n\n        const range = params.range;\n        const manager = worksheet.getColumnManager();\n        const colPrimitive = manager.getColumnData();\n        const colCount = range.endColumn - range.startColumn + 1;\n        spliceArray(range.startColumn, colCount, colPrimitive);\n        worksheet.setColumnCount(worksheet.getColumnCount() - colCount);\n\n        // remove cells contents by directly mutating worksheetCellMatrix\n        const cellMatrix = worksheet.getCellMatrix();\n        cellMatrix.removeColumns(range.startColumn, colCount);\n\n        return true;\n    },\n};\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2bdcee57d551686db29dbac569ef2ba5916d3b80"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/remove-worksheet-merge.mutation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/remove-worksheet-merge.mutation.ts","statementMap":{"0":{"start":{"line":2,"column":46},"end":{"line":30,"column":1}},"1":{"start":{"line":3,"column":32},"end":{"line":3,"column":68}},"2":{"start":{"line":4,"column":22},"end":{"line":4,"column":81}},"3":{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},"4":{"start":{"line":6,"column":4},"end":{"line":6,"column":50}},"5":{"start":{"line":8,"column":20},"end":{"line":8,"column":67}},"6":{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},"7":{"start":{"line":10,"column":4},"end":{"line":10,"column":48}},"8":{"start":{"line":12,"column":17},"end":{"line":12,"column":38}},"9":{"start":{"line":13,"column":26},"end":{"line":13,"column":42}},"10":{"start":{"line":14,"column":26},"end":{"line":14,"column":39}},"11":{"start":{"line":15,"column":17},"end":{"line":15,"column":19}},"12":{"start":{"line":16,"column":2},"end":{"line":24,"column":3}},"13":{"start":{"line":16,"column":15},"end":{"line":16,"column":16}},"14":{"start":{"line":17,"column":4},"end":{"line":23,"column":5}},"15":{"start":{"line":17,"column":17},"end":{"line":17,"column":43}},"16":{"start":{"line":18,"column":26},"end":{"line":18,"column":44}},"17":{"start":{"line":19,"column":26},"end":{"line":19,"column":44}},"18":{"start":{"line":20,"column":6},"end":{"line":22,"column":7}},"19":{"start":{"line":21,"column":8},"end":{"line":21,"column":40}},"20":{"start":{"line":25,"column":2},"end":{"line":29,"column":4}},"21":{"start":{"line":31,"column":44},"end":{"line":57,"column":1}},"22":{"start":{"line":35,"column":34},"end":{"line":35,"column":70}},"23":{"start":{"line":36,"column":24},"end":{"line":36,"column":83}},"24":{"start":{"line":37,"column":4},"end":{"line":39,"column":5}},"25":{"start":{"line":38,"column":6},"end":{"line":38,"column":52}},"26":{"start":{"line":40,"column":22},"end":{"line":40,"column":69}},"27":{"start":{"line":41,"column":4},"end":{"line":41,"column":33}},"28":{"start":{"line":41,"column":20},"end":{"line":41,"column":33}},"29":{"start":{"line":42,"column":19},"end":{"line":42,"column":40}},"30":{"start":{"line":43,"column":28},"end":{"line":43,"column":44}},"31":{"start":{"line":44,"column":28},"end":{"line":44,"column":41}},"32":{"start":{"line":45,"column":4},"end":{"line":53,"column":5}},"33":{"start":{"line":45,"column":17},"end":{"line":45,"column":18}},"34":{"start":{"line":46,"column":6},"end":{"line":52,"column":7}},"35":{"start":{"line":46,"column":19},"end":{"line":46,"column":45}},"36":{"start":{"line":47,"column":28},"end":{"line":47,"column":46}},"37":{"start":{"line":48,"column":28},"end":{"line":48,"column":46}},"38":{"start":{"line":49,"column":8},"end":{"line":51,"column":9}},"39":{"start":{"line":50,"column":10},"end":{"line":50,"column":39}},"40":{"start":{"line":54,"column":4},"end":{"line":54,"column":54}},"41":{"start":{"line":55,"column":4},"end":{"line":55,"column":16}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":46},"end":{"line":2,"column":47}},"loc":{"start":{"line":2,"column":68},"end":{"line":30,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":34,"column":11},"end":{"line":34,"column":12}},"loc":{"start":{"line":34,"column":33},"end":{"line":56,"column":3}},"line":34}},"branchMap":{"0":{"loc":{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},"type":"if","locations":[{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},{"start":{},"end":{}}],"line":5},"1":{"loc":{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},"type":"if","locations":[{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},{"start":{},"end":{}}],"line":9},"2":{"loc":{"start":{"line":20,"column":6},"end":{"line":22,"column":7}},"type":"if","locations":[{"start":{"line":20,"column":6},"end":{"line":22,"column":7}},{"start":{},"end":{}}],"line":20},"3":{"loc":{"start":{"line":37,"column":4},"end":{"line":39,"column":5}},"type":"if","locations":[{"start":{"line":37,"column":4},"end":{"line":39,"column":5}},{"start":{},"end":{}}],"line":37},"4":{"loc":{"start":{"line":41,"column":4},"end":{"line":41,"column":33}},"type":"if","locations":[{"start":{"line":41,"column":4},"end":{"line":41,"column":33}},{"start":{},"end":{}}],"line":41},"5":{"loc":{"start":{"line":49,"column":8},"end":{"line":51,"column":9}},"type":"if","locations":[{"start":{"line":49,"column":8},"end":{"line":51,"column":9}},{"start":{},"end":{}}],"line":49}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":1,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0},"f":{"0":0,"1":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/remove-worksheet-merge.mutation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommandType, IUniverInstanceService, Rectangle } from '@univerjs/core';\nimport type { IAccessor, IMutation } from '@univerjs/core';\n\nimport type {\n    IAddWorksheetMergeMutationParams,\n    IRemoveWorksheetMergeMutationParams,\n} from '../../basics/interfaces/mutation-interface';\n\nexport const RemoveMergeUndoMutationFactory = (\n    accessor: IAccessor,\n    params: IRemoveWorksheetMergeMutationParams\n): IAddWorksheetMergeMutationParams => {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n    if (universheet == null) {\n        throw new Error('universheet is null error!');\n    }\n\n    const worksheet = universheet.getSheetBySheetId(params.subUnitId);\n    if (worksheet == null) {\n        throw new Error('worksheet is null error!');\n    }\n    const config = worksheet.getConfig();\n    const mergeConfigData = config.mergeData;\n    const mergeRemoveData = params.ranges;\n    const ranges = [];\n    for (let j = 0; j < mergeRemoveData.length; j++) {\n        for (let i = mergeConfigData.length - 1; i >= 0; i--) {\n            const configMerge = mergeConfigData[i];\n            const removeMerge = mergeRemoveData[j];\n            if (Rectangle.intersects(configMerge, removeMerge)) {\n                ranges.push(mergeConfigData[i]);\n            }\n        }\n    }\n\n    return {\n        unitId: params.unitId,\n        subUnitId: params.subUnitId,\n        ranges,\n    };\n};\n\nexport const RemoveWorksheetMergeMutation: IMutation<IRemoveWorksheetMergeMutationParams> = {\n    id: 'sheet.mutation.remove-worksheet-merge',\n    type: CommandType.MUTATION,\n    handler: (accessor: IAccessor, params: IRemoveWorksheetMergeMutationParams) => {\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const universheet = univerInstanceService.getUniverSheetInstance(params.unitId);\n\n        if (universheet == null) {\n            throw new Error('universheet is null error!');\n        }\n\n        const worksheet = universheet.getSheetBySheetId(params.subUnitId);\n        if (!worksheet) return false;\n        const config = worksheet.getConfig();\n        const mergeConfigData = config.mergeData;\n        const mergeRemoveData = params.ranges;\n        for (let j = 0; j < mergeRemoveData.length; j++) {\n            for (let i = mergeConfigData.length - 1; i >= 0; i--) {\n                const configMerge = mergeConfigData[i];\n                const removeMerge = mergeRemoveData[j];\n                if (Rectangle.intersects(configMerge, removeMerge)) {\n                    mergeConfigData.splice(i, 1);\n                }\n            }\n        }\n        // update merge data cache\n        worksheet.getSpanModel().rebuild(mergeConfigData);\n        return true;\n    },\n};\n"],"mappings":"AAgBA,SAAS,aAAa,wBAAwB,iBAAiB;AAQxD,aAAM,iCAAiC,CAC1C,UACA,WACmC;AACnC,QAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,QAAM,cAAc,sBAAsB,uBAAuB,OAAO,MAAM;AAE9E,MAAI,eAAe,MAAM;AACrB,UAAM,IAAI,MAAM,4BAA4B;AAAA,EAChD;AAEA,QAAM,YAAY,YAAY,kBAAkB,OAAO,SAAS;AAChE,MAAI,aAAa,MAAM;AACnB,UAAM,IAAI,MAAM,0BAA0B;AAAA,EAC9C;AACA,QAAM,SAAS,UAAU,UAAU;AACnC,QAAM,kBAAkB,OAAO;AAC/B,QAAM,kBAAkB,OAAO;AAC/B,QAAM,SAAS,CAAC;AAChB,WAAS,IAAI,GAAG,IAAI,gBAAgB,QAAQ,KAAK;AAC7C,aAAS,IAAI,gBAAgB,SAAS,GAAG,KAAK,GAAG,KAAK;AAClD,YAAM,cAAc,gBAAgB,CAAC;AACrC,YAAM,cAAc,gBAAgB,CAAC;AACrC,UAAI,UAAU,WAAW,aAAa,WAAW,GAAG;AAChD,eAAO,KAAK,gBAAgB,CAAC,CAAC;AAAA,MAClC;AAAA,IACJ;AAAA,EACJ;AAEA,SAAO;AAAA,IACH,QAAQ,OAAO;AAAA,IACf,WAAW,OAAO;AAAA,IAClB;AAAA,EACJ;AACJ;AAEO,aAAM,+BAA+E;AAAA,EACxF,IAAI;AAAA,EACJ,MAAM,YAAY;AAAA,EAClB,SAAS,CAAC,UAAqB,WAAgD;AAC3E,UAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,UAAM,cAAc,sBAAsB,uBAAuB,OAAO,MAAM;AAE9E,QAAI,eAAe,MAAM;AACrB,YAAM,IAAI,MAAM,4BAA4B;AAAA,IAChD;AAEA,UAAM,YAAY,YAAY,kBAAkB,OAAO,SAAS;AAChE,QAAI,CAAC,UAAW,QAAO;AACvB,UAAM,SAAS,UAAU,UAAU;AACnC,UAAM,kBAAkB,OAAO;AAC/B,UAAM,kBAAkB,OAAO;AAC/B,aAAS,IAAI,GAAG,IAAI,gBAAgB,QAAQ,KAAK;AAC7C,eAAS,IAAI,gBAAgB,SAAS,GAAG,KAAK,GAAG,KAAK;AAClD,cAAM,cAAc,gBAAgB,CAAC;AACrC,cAAM,cAAc,gBAAgB,CAAC;AACrC,YAAI,UAAU,WAAW,aAAa,WAAW,GAAG;AAChD,0BAAgB,OAAO,GAAG,CAAC;AAAA,QAC/B;AAAA,MACJ;AAAA,IACJ;AAEA,cAAU,aAAa,EAAE,QAAQ,eAAe;AAChD,WAAO;AAAA,EACX;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2143ddd6677d9372448f2b1b47a8e43a803f034d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/cell-style.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/cell-style.ts","statementMap":{"0":{"start":{"line":3,"column":19},"end":{"line":3,"column":48}},"1":{"start":{"line":4,"column":2},"end":{"line":6,"column":3}},"2":{"start":{"line":5,"column":4},"end":{"line":5,"column":20}},"3":{"start":{"line":7,"column":2},"end":{"line":9,"column":3}},"4":{"start":{"line":8,"column":4},"end":{"line":8,"column":36}},"5":{"start":{"line":10,"column":16},"end":{"line":10,"column":64}},"6":{"start":{"line":11,"column":2},"end":{"line":18,"column":3}},"7":{"start":{"line":12,"column":4},"end":{"line":12,"column":28}},"8":{"start":{"line":13,"column":4},"end":{"line":17,"column":7}},"9":{"start":{"line":14,"column":6},"end":{"line":16,"column":7}},"10":{"start":{"line":15,"column":8},"end":{"line":15,"column":26}},"11":{"start":{"line":19,"column":2},"end":{"line":23,"column":3}},"12":{"start":{"line":20,"column":4},"end":{"line":20,"column":20}},"13":{"start":{"line":22,"column":4},"end":{"line":22,"column":38}},"14":{"start":{"line":24,"column":25},"end":{"line":25,"column":6}},"15":{"start":{"line":26,"column":2},"end":{"line":32,"column":3}},"16":{"start":{"line":27,"column":4},"end":{"line":31,"column":5}},"17":{"start":{"line":28,"column":6},"end":{"line":28,"column":22}},"18":{"start":{"line":30,"column":6},"end":{"line":30,"column":63}},"19":{"start":{"line":35,"column":2},"end":{"line":37,"column":3}},"20":{"start":{"line":36,"column":4},"end":{"line":36,"column":20}},"21":{"start":{"line":38,"column":22},"end":{"line":38,"column":36}},"22":{"start":{"line":39,"column":2},"end":{"line":45,"column":3}},"23":{"start":{"line":40,"column":4},"end":{"line":44,"column":5}},"24":{"start":{"line":41,"column":6},"end":{"line":41,"column":75}},"25":{"start":{"line":42,"column":11},"end":{"line":44,"column":5}},"26":{"start":{"line":43,"column":6},"end":{"line":43,"column":28}},"27":{"start":{"line":46,"column":2},"end":{"line":46,"column":21}},"28":{"start":{"line":49,"column":2},"end":{"line":51,"column":3}},"29":{"start":{"line":50,"column":4},"end":{"line":50,"column":22}},"30":{"start":{"line":52,"column":2},"end":{"line":56,"column":3}},"31":{"start":{"line":53,"column":4},"end":{"line":55,"column":5}},"32":{"start":{"line":54,"column":6},"end":{"line":54,"column":27}},"33":{"start":{"line":57,"column":2},"end":{"line":57,"column":20}},"34":{"start":{"line":60,"column":2},"end":{"line":60,"column":41}},"35":{"start":{"line":60,"column":25},"end":{"line":60,"column":41}},"36":{"start":{"line":61,"column":2},"end":{"line":61,"column":43}},"37":{"start":{"line":61,"column":27},"end":{"line":61,"column":43}},"38":{"start":{"line":62,"column":22},"end":{"line":62,"column":53}},"39":{"start":{"line":63,"column":2},"end":{"line":72,"column":3}},"40":{"start":{"line":64,"column":4},"end":{"line":66,"column":5}},"41":{"start":{"line":65,"column":6},"end":{"line":65,"column":15}},"42":{"start":{"line":67,"column":4},"end":{"line":71,"column":5}},"43":{"start":{"line":68,"column":6},"end":{"line":68,"column":66}},"44":{"start":{"line":70,"column":6},"end":{"line":70,"column":35}},"45":{"start":{"line":73,"column":2},"end":{"line":83,"column":3}},"46":{"start":{"line":74,"column":4},"end":{"line":76,"column":5}},"47":{"start":{"line":75,"column":6},"end":{"line":75,"column":41}},"48":{"start":{"line":77,"column":4},"end":{"line":79,"column":5}},"49":{"start":{"line":78,"column":6},"end":{"line":78,"column":41}},"50":{"start":{"line":80,"column":4},"end":{"line":82,"column":5}},"51":{"start":{"line":81,"column":6},"end":{"line":81,"column":41}},"52":{"start":{"line":84,"column":2},"end":{"line":84,"column":21}},"53":{"start":{"line":87,"column":2},"end":{"line":89,"column":3}},"54":{"start":{"line":87,"column":29},"end":{"line":87,"column":52}},"55":{"start":{"line":88,"column":4},"end":{"line":88,"column":50}},"56":{"start":{"line":90,"column":2},"end":{"line":90,"column":16}},"57":{"start":{"line":93,"column":2},"end":{"line":95,"column":3}},"58":{"start":{"line":94,"column":4},"end":{"line":94,"column":11}},"59":{"start":{"line":96,"column":2},"end":{"line":98,"column":3}},"60":{"start":{"line":97,"column":4},"end":{"line":97,"column":25}},"61":{"start":{"line":99,"column":14},"end":{"line":99,"column":15}},"62":{"start":{"line":100,"column":22},"end":{"line":100,"column":24}},"63":{"start":{"line":101,"column":21},"end":{"line":101,"column":45}},"64":{"start":{"line":102,"column":2},"end":{"line":125,"column":3}},"65":{"start":{"line":103,"column":32},"end":{"line":103,"column":39}},"66":{"start":{"line":104,"column":4},"end":{"line":115,"column":5}},"67":{"start":{"line":105,"column":17},"end":{"line":108,"column":7}},"68":{"start":{"line":109,"column":21},"end":{"line":109,"column":51}},"69":{"start":{"line":110,"column":6},"end":{"line":110,"column":41}},"70":{"start":{"line":111,"column":6},"end":{"line":113,"column":7}},"71":{"start":{"line":112,"column":8},"end":{"line":112,"column":23}},"72":{"start":{"line":114,"column":6},"end":{"line":114,"column":27}},"73":{"start":{"line":116,"column":18},"end":{"line":116,"column":48}},"74":{"start":{"line":117,"column":4},"end":{"line":117,"column":37}},"75":{"start":{"line":118,"column":4},"end":{"line":122,"column":5}},"76":{"start":{"line":119,"column":6},"end":{"line":119,"column":24}},"77":{"start":{"line":121,"column":6},"end":{"line":121,"column":25}},"78":{"start":{"line":123,"column":4},"end":{"line":123,"column":30}},"79":{"start":{"line":124,"column":4},"end":{"line":124,"column":43}},"80":{"start":{"line":126,"column":19},"end":{"line":126,"column":111}},"81":{"start":{"line":127,"column":2},"end":{"line":138,"column":3}},"82":{"start":{"line":128,"column":15},"end":{"line":131,"column":5}},"83":{"start":{"line":132,"column":18},"end":{"line":132,"column":48}},"84":{"start":{"line":133,"column":4},"end":{"line":133,"column":37}},"85":{"start":{"line":134,"column":4},"end":{"line":136,"column":5}},"86":{"start":{"line":135,"column":6},"end":{"line":135,"column":20}},"87":{"start":{"line":137,"column":4},"end":{"line":137,"column":25}},"88":{"start":{"line":139,"column":2},"end":{"line":139,"column":51}}},"fnMap":{"0":{"name":"handleStyle","decl":{"start":{"line":2,"column":16},"end":{"line":2,"column":27}},"loc":{"start":{"line":2,"column":52},"end":{"line":33,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":13,"column":34},"end":{"line":13,"column":35}},"loc":{"start":{"line":13,"column":50},"end":{"line":17,"column":5}},"line":13},"2":{"name":"transformStyle","decl":{"start":{"line":34,"column":16},"end":{"line":34,"column":30}},"loc":{"start":{"line":34,"column":51},"end":{"line":47,"column":1}},"line":34},"3":{"name":"transformBorders","decl":{"start":{"line":48,"column":9},"end":{"line":48,"column":25}},"loc":{"start":{"line":48,"column":50},"end":{"line":58,"column":1}},"line":48},"4":{"name":"mergeStyle","decl":{"start":{"line":59,"column":9},"end":{"line":59,"column":19}},"loc":{"start":{"line":59,"column":60},"end":{"line":85,"column":1}},"line":59},"5":{"name":"skipParagraphs","decl":{"start":{"line":86,"column":9},"end":{"line":86,"column":23}},"loc":{"start":{"line":86,"column":44},"end":{"line":91,"column":1}},"line":86},"6":{"name":"(anonymous_6)","decl":{"start":{"line":87,"column":22},"end":{"line":87,"column":23}},"loc":{"start":{"line":87,"column":29},"end":{"line":87,"column":52}},"line":87},"7":{"name":"mergeRichTextStyle","decl":{"start":{"line":92,"column":9},"end":{"line":92,"column":27}},"loc":{"start":{"line":92,"column":41},"end":{"line":140,"column":1}},"line":92}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":2},"end":{"line":6,"column":3}},"type":"if","locations":[{"start":{"line":4,"column":2},"end":{"line":6,"column":3}},{"start":{},"end":{}}],"line":4},"1":{"loc":{"start":{"line":7,"column":2},"end":{"line":9,"column":3}},"type":"if","locations":[{"start":{"line":7,"column":2},"end":{"line":9,"column":3}},{"start":{},"end":{}}],"line":7},"2":{"loc":{"start":{"line":10,"column":37},"end":{"line":10,"column":63}},"type":"cond-expr","locations":[{"start":{"line":10,"column":48},"end":{"line":10,"column":56}},{"start":{"line":10,"column":59},"end":{"line":10,"column":63}}],"line":10},"3":{"loc":{"start":{"line":11,"column":2},"end":{"line":18,"column":3}},"type":"if","locations":[{"start":{"line":11,"column":2},"end":{"line":18,"column":3}},{"start":{},"end":{}}],"line":11},"4":{"loc":{"start":{"line":14,"column":6},"end":{"line":16,"column":7}},"type":"if","locations":[{"start":{"line":14,"column":6},"end":{"line":16,"column":7}},{"start":{},"end":{}}],"line":14},"5":{"loc":{"start":{"line":14,"column":10},"end":{"line":14,"column":82}},"type":"binary-expr","locations":[{"start":{"line":14,"column":10},"end":{"line":14,"column":33}},{"start":{"line":14,"column":37},"end":{"line":14,"column":49}},{"start":{"line":14,"column":53},"end":{"line":14,"column":82}}],"line":14},"6":{"loc":{"start":{"line":19,"column":2},"end":{"line":23,"column":3}},"type":"if","locations":[{"start":{"line":19,"column":2},"end":{"line":23,"column":3}},{"start":{"line":21,"column":9},"end":{"line":23,"column":3}}],"line":19},"7":{"loc":{"start":{"line":24,"column":25},"end":{"line":25,"column":6}},"type":"cond-expr","locations":[{"start":{"line":24,"column":36},"end":{"line":25,"column":1}},{"start":{"line":25,"column":4},"end":{"line":25,"column":6}}],"line":24},"8":{"loc":{"start":{"line":26,"column":2},"end":{"line":32,"column":3}},"type":"if","locations":[{"start":{"line":26,"column":2},"end":{"line":32,"column":3}},{"start":{},"end":{}}],"line":26},"9":{"loc":{"start":{"line":26,"column":6},"end":{"line":26,"column":27}},"type":"binary-expr","locations":[{"start":{"line":26,"column":6},"end":{"line":26,"column":15}},{"start":{"line":26,"column":19},"end":{"line":26,"column":27}}],"line":26},"10":{"loc":{"start":{"line":27,"column":4},"end":{"line":31,"column":5}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":31,"column":5}},{"start":{"line":29,"column":11},"end":{"line":31,"column":5}}],"line":27},"11":{"loc":{"start":{"line":27,"column":8},"end":{"line":27,"column":70}},"type":"binary-expr","locations":[{"start":{"line":27,"column":8},"end":{"line":27,"column":22}},{"start":{"line":27,"column":26},"end":{"line":27,"column":70}}],"line":27},"12":{"loc":{"start":{"line":30,"column":35},"end":{"line":30,"column":61}},"type":"cond-expr","locations":[{"start":{"line":30,"column":46},"end":{"line":30,"column":54}},{"start":{"line":30,"column":57},"end":{"line":30,"column":61}}],"line":30},"13":{"loc":{"start":{"line":35,"column":2},"end":{"line":37,"column":3}},"type":"if","locations":[{"start":{"line":35,"column":2},"end":{"line":37,"column":3}},{"start":{},"end":{}}],"line":35},"14":{"loc":{"start":{"line":35,"column":6},"end":{"line":35,"column":48}},"type":"binary-expr","locations":[{"start":{"line":35,"column":6},"end":{"line":35,"column":15}},{"start":{"line":35,"column":19},"end":{"line":35,"column":48}}],"line":35},"15":{"loc":{"start":{"line":38,"column":22},"end":{"line":38,"column":36}},"type":"binary-expr","locations":[{"start":{"line":38,"column":22},"end":{"line":38,"column":30}},{"start":{"line":38,"column":34},"end":{"line":38,"column":36}}],"line":38},"16":{"loc":{"start":{"line":40,"column":4},"end":{"line":44,"column":5}},"type":"if","locations":[{"start":{"line":40,"column":4},"end":{"line":44,"column":5}},{"start":{"line":42,"column":11},"end":{"line":44,"column":5}}],"line":40},"17":{"loc":{"start":{"line":41,"column":40},"end":{"line":41,"column":60}},"type":"binary-expr","locations":[{"start":{"line":41,"column":40},"end":{"line":41,"column":54}},{"start":{"line":41,"column":58},"end":{"line":41,"column":60}}],"line":41},"18":{"loc":{"start":{"line":42,"column":11},"end":{"line":44,"column":5}},"type":"if","locations":[{"start":{"line":42,"column":11},"end":{"line":44,"column":5}},{"start":{},"end":{}}],"line":42},"19":{"loc":{"start":{"line":49,"column":2},"end":{"line":51,"column":3}},"type":"if","locations":[{"start":{"line":49,"column":2},"end":{"line":51,"column":3}},{"start":{},"end":{}}],"line":49},"20":{"loc":{"start":{"line":49,"column":6},"end":{"line":49,"column":52}},"type":"binary-expr","locations":[{"start":{"line":49,"column":6},"end":{"line":49,"column":17}},{"start":{"line":49,"column":21},"end":{"line":49,"column":52}}],"line":49},"21":{"loc":{"start":{"line":53,"column":4},"end":{"line":55,"column":5}},"type":"if","locations":[{"start":{"line":53,"column":4},"end":{"line":55,"column":5}},{"start":{},"end":{}}],"line":53},"22":{"loc":{"start":{"line":59,"column":40},"end":{"line":59,"column":58}},"type":"default-arg","locations":[{"start":{"line":59,"column":53},"end":{"line":59,"column":58}}],"line":59},"23":{"loc":{"start":{"line":60,"column":2},"end":{"line":60,"column":41}},"type":"if","locations":[{"start":{"line":60,"column":2},"end":{"line":60,"column":41}},{"start":{},"end":{}}],"line":60},"24":{"loc":{"start":{"line":61,"column":2},"end":{"line":61,"column":43}},"type":"if","locations":[{"start":{"line":61,"column":2},"end":{"line":61,"column":43}},{"start":{},"end":{}}],"line":61},"25":{"loc":{"start":{"line":62,"column":22},"end":{"line":62,"column":53}},"type":"binary-expr","locations":[{"start":{"line":62,"column":22},"end":{"line":62,"column":47}},{"start":{"line":62,"column":51},"end":{"line":62,"column":53}}],"line":62},"26":{"loc":{"start":{"line":64,"column":4},"end":{"line":66,"column":5}},"type":"if","locations":[{"start":{"line":64,"column":4},"end":{"line":66,"column":5}},{"start":{},"end":{}}],"line":64},"27":{"loc":{"start":{"line":64,"column":8},"end":{"line":64,"column":82}},"type":"binary-expr","locations":[{"start":{"line":64,"column":8},"end":{"line":64,"column":18}},{"start":{"line":64,"column":22},"end":{"line":64,"column":82}}],"line":64},"28":{"loc":{"start":{"line":67,"column":4},"end":{"line":71,"column":5}},"type":"if","locations":[{"start":{"line":67,"column":4},"end":{"line":71,"column":5}},{"start":{"line":69,"column":11},"end":{"line":71,"column":5}}],"line":67},"29":{"loc":{"start":{"line":67,"column":8},"end":{"line":67,"column":38}},"type":"binary-expr","locations":[{"start":{"line":67,"column":8},"end":{"line":67,"column":24}},{"start":{"line":67,"column":28},"end":{"line":67,"column":38}}],"line":67},"30":{"loc":{"start":{"line":73,"column":2},"end":{"line":83,"column":3}},"type":"if","locations":[{"start":{"line":73,"column":2},"end":{"line":83,"column":3}},{"start":{},"end":{}}],"line":73},"31":{"loc":{"start":{"line":74,"column":4},"end":{"line":76,"column":5}},"type":"if","locations":[{"start":{"line":74,"column":4},"end":{"line":76,"column":5}},{"start":{},"end":{}}],"line":74},"32":{"loc":{"start":{"line":74,"column":8},"end":{"line":74,"column":45}},"type":"binary-expr","locations":[{"start":{"line":74,"column":8},"end":{"line":74,"column":27}},{"start":{"line":74,"column":31},"end":{"line":74,"column":45}}],"line":74},"33":{"loc":{"start":{"line":77,"column":4},"end":{"line":79,"column":5}},"type":"if","locations":[{"start":{"line":77,"column":4},"end":{"line":79,"column":5}},{"start":{},"end":{}}],"line":77},"34":{"loc":{"start":{"line":77,"column":8},"end":{"line":77,"column":45}},"type":"binary-expr","locations":[{"start":{"line":77,"column":8},"end":{"line":77,"column":27}},{"start":{"line":77,"column":31},"end":{"line":77,"column":45}}],"line":77},"35":{"loc":{"start":{"line":80,"column":4},"end":{"line":82,"column":5}},"type":"if","locations":[{"start":{"line":80,"column":4},"end":{"line":82,"column":5}},{"start":{},"end":{}}],"line":80},"36":{"loc":{"start":{"line":80,"column":8},"end":{"line":80,"column":45}},"type":"binary-expr","locations":[{"start":{"line":80,"column":8},"end":{"line":80,"column":27}},{"start":{"line":80,"column":31},"end":{"line":80,"column":45}}],"line":80},"37":{"loc":{"start":{"line":87,"column":2},"end":{"line":89,"column":3}},"type":"if","locations":[{"start":{"line":87,"column":2},"end":{"line":89,"column":3}},{"start":{},"end":{}}],"line":87},"38":{"loc":{"start":{"line":93,"column":2},"end":{"line":95,"column":3}},"type":"if","locations":[{"start":{"line":93,"column":2},"end":{"line":95,"column":3}},{"start":{},"end":{}}],"line":93},"39":{"loc":{"start":{"line":96,"column":2},"end":{"line":98,"column":3}},"type":"if","locations":[{"start":{"line":96,"column":2},"end":{"line":98,"column":3}},{"start":{},"end":{}}],"line":96},"40":{"loc":{"start":{"line":101,"column":21},"end":{"line":101,"column":45}},"type":"binary-expr","locations":[{"start":{"line":101,"column":21},"end":{"line":101,"column":39}},{"start":{"line":101,"column":43},"end":{"line":101,"column":45}}],"line":101},"41":{"loc":{"start":{"line":103,"column":20},"end":{"line":103,"column":27}},"type":"default-arg","locations":[{"start":{"line":103,"column":25},"end":{"line":103,"column":27}}],"line":103},"42":{"loc":{"start":{"line":104,"column":4},"end":{"line":115,"column":5}},"type":"if","locations":[{"start":{"line":104,"column":4},"end":{"line":115,"column":5}},{"start":{},"end":{}}],"line":104},"43":{"loc":{"start":{"line":110,"column":6},"end":{"line":110,"column":40}},"type":"binary-expr","locations":[{"start":{"line":110,"column":6},"end":{"line":110,"column":12}},{"start":{"line":110,"column":16},"end":{"line":110,"column":40}}],"line":110},"44":{"loc":{"start":{"line":111,"column":6},"end":{"line":113,"column":7}},"type":"if","locations":[{"start":{"line":111,"column":6},"end":{"line":113,"column":7}},{"start":{},"end":{}}],"line":111},"45":{"loc":{"start":{"line":117,"column":4},"end":{"line":117,"column":36}},"type":"binary-expr","locations":[{"start":{"line":117,"column":4},"end":{"line":117,"column":9}},{"start":{"line":117,"column":13},"end":{"line":117,"column":36}}],"line":117},"46":{"loc":{"start":{"line":118,"column":4},"end":{"line":122,"column":5}},"type":"if","locations":[{"start":{"line":118,"column":4},"end":{"line":122,"column":5}},{"start":{"line":120,"column":11},"end":{"line":122,"column":5}}],"line":118},"47":{"loc":{"start":{"line":126,"column":19},"end":{"line":126,"column":111}},"type":"cond-expr","locations":[{"start":{"line":126,"column":56},"end":{"line":126,"column":84}},{"start":{"line":126,"column":87},"end":{"line":126,"column":111}}],"line":126},"48":{"loc":{"start":{"line":127,"column":2},"end":{"line":138,"column":3}},"type":"if","locations":[{"start":{"line":127,"column":2},"end":{"line":138,"column":3}},{"start":{},"end":{}}],"line":127},"49":{"loc":{"start":{"line":133,"column":4},"end":{"line":133,"column":36}},"type":"binary-expr","locations":[{"start":{"line":133,"column":4},"end":{"line":133,"column":9}},{"start":{"line":133,"column":13},"end":{"line":133,"column":36}}],"line":133},"50":{"loc":{"start":{"line":134,"column":4},"end":{"line":136,"column":5}},"type":"if","locations":[{"start":{"line":134,"column":4},"end":{"line":136,"column":5}},{"start":{},"end":{}}],"line":134}},"s":{"0":4,"1":4,"2":4,"3":4,"4":0,"5":4,"6":4,"7":0,"8":0,"9":0,"10":0,"11":4,"12":4,"13":0,"14":4,"15":4,"16":0,"17":0,"18":0,"19":2,"20":2,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":4,"35":4,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0},"f":{"0":4,"1":0,"2":2,"3":0,"4":4,"5":0,"6":0,"7":0},"b":{"0":[4,0],"1":[0,4],"2":[0,4],"3":[0,4],"4":[0,0],"5":[0,0,0],"6":[4,0],"7":[4,0],"8":[0,4],"9":[4,4],"10":[0,0],"11":[0,0],"12":[0,0],"13":[2,0],"14":[2,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[4],"23":[4,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/cell-style.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IBorderData, ICellData, IDocumentData, IKeyValue, IParagraph, IStyleData, ITextRun, ITextStyle, Nullable, Styles } from '@univerjs/core';\nimport { normalizeTextRuns, Tools } from '@univerjs/core';\n\n/**\n *\n * @param styles\n * @param oldVal\n * @param newVal\n */\nexport function handleStyle(styles: Styles, oldVal: ICellData, newVal: ICellData) {\n    // use null to clear style\n    const oldStyle = styles.getStyleByCell(oldVal);\n\n    if (oldStyle == null) {\n        // clear\n        delete oldVal.s;\n    }\n\n    if (typeof newVal.s === 'string') {\n        newVal.s = styles.get(newVal.s);\n    }\n\n    // set style\n    const merge = mergeStyle(oldStyle, newVal.s ? (newVal.s as Nullable<IStyleData>) : null);\n\n    // then remove null\n    if (merge) {\n        Tools.removeNull(merge);\n\n        // remove empty object\n        Object.entries(merge).forEach(([key, val]) => {\n            if (typeof val === 'object' && val !== null && Object.keys(val).length === 0) {\n                delete merge[key as keyof IStyleData];\n            }\n        });\n    }\n\n    if (Tools.isEmptyObject(merge)) {\n        delete oldVal.s;\n    } else {\n        oldVal.s = styles.setValue(merge);\n    }\n\n    const newValueStream = newVal.v ? `${newVal.v}\\r\\n` : '';\n    // Only need to copy newValue.s to oldValue.p when you modify the cell style, not when you modify the cell value.\n    if (!newVal.p && oldVal.p) {\n        if (newValueStream && newValueStream !== oldVal.p.body?.dataStream) {\n            delete oldVal.p;\n        } else {\n            mergeRichTextStyle(oldVal.p, newVal.s ? (newVal.s as Nullable<IStyleData>) : null);\n        }\n    }\n}\n\n/**\n * Convert old style data for storage\n * @param style\n * @param oldStyle\n * @param newStyle\n */\nexport function transformStyle(oldStyle: Nullable<IStyleData>, newStyle: Nullable<IStyleData>): Nullable<IStyleData> {\n    // If there is no newly set style, directly store the historical style\n    if (!newStyle || !Object.keys(newStyle).length) {\n        return oldStyle;\n    }\n    const backupStyle: Record<string, any> = oldStyle || {};\n\n    for (const k in newStyle) {\n        if (k === 'bd') {\n            backupStyle[k] = transformBorders(backupStyle[k] || {}, newStyle[k]);\n        }\n        // 1. To modify the existing style,we need original setting to undo\n        // 2. Newly set the style, we need null to undo\n        else if (!(k in backupStyle)) {\n            backupStyle[k] = null;\n        }\n    }\n    return backupStyle;\n}\n\n/**\n * Convert old style border for storage\n * @param style\n * @param oldBorders\n * @param newBorders\n */\nfunction transformBorders(oldBorders: IBorderData, newBorders: Nullable<IBorderData>): IBorderData {\n    // If there is no newly set border, directly store the historical border\n    if (!newBorders || !Object.keys(newBorders).length) {\n        return oldBorders;\n    }\n\n    for (const k in newBorders) {\n        // 1. To modify the existing border,we need original setting to undo\n        // 2. Newly set the border, we need null to undo\n        if (!(k in oldBorders)) {\n            (oldBorders as IKeyValue)[k] = null;\n        }\n    }\n\n    return oldBorders;\n}\n\n/**\n * merge new style to old style\n * @param oldStyle\n * @param newStyle\n * @param isRichText\n */\nfunction mergeStyle(\n    oldStyle: Nullable<IStyleData>,\n    newStyle: Nullable<IStyleData>,\n    isRichText: boolean = false\n): Nullable<IStyleData> {\n    // clear style\n    if (newStyle === null) return newStyle;\n    // don't operate\n    if (newStyle === undefined) return oldStyle;\n\n    const backupStyle: Record<string, any> = Tools.deepClone(oldStyle) || {};\n\n    for (const k in newStyle) {\n        // Do not copy cell background color to rich text background color.\n        if (isRichText && ['bd', 'tr', 'td', 'ht', 'vt', 'tb', 'pd', 'bg'].includes(k)) {\n            continue;\n        }\n        // you can only choose one of the themeColor and rgbColor of the border setting\n        if (k in backupStyle && k === 'bd') {\n            backupStyle[k] = Object.assign(backupStyle[k], newStyle[k]);\n        } else {\n            backupStyle[k] = (newStyle as IKeyValue)[k];\n        }\n    }\n\n    if ('cl' in backupStyle) {\n        if ('ul' in backupStyle && backupStyle.ul) {\n            backupStyle.ul.cl = backupStyle.cl;\n        }\n\n        if ('ol' in backupStyle && backupStyle.ol) {\n            backupStyle.ol.cl = backupStyle.cl;\n        }\n\n        if ('st' in backupStyle && backupStyle.st) {\n            backupStyle.st.cl = backupStyle.cl;\n        }\n    }\n\n    return backupStyle;\n}\n\n/**\n *\n * @param paragraphs\n * @param offset\n */\nfunction skipParagraphs(paragraphs: IParagraph[], offset: number): number {\n    if (paragraphs.some((p) => p.startIndex === offset)) {\n        return skipParagraphs(paragraphs, offset + 1);\n    }\n\n    return offset;\n}\n\n/**\n * Find the text style of all paragraphs and modify it to the new style\n * @param p\n * @param newStyle\n */\nfunction mergeRichTextStyle(p: IDocumentData, newStyle: Nullable<IStyleData>) {\n    if (p.body == null) {\n        return;\n    }\n\n    if (!Array.isArray(p.body.textRuns)) {\n        p.body.textRuns = [];\n    }\n\n    let index = 0;\n    const newTextRuns = [];\n    const paragraphs = p.body?.paragraphs || [];\n\n    for (const textRun of p.body.textRuns) {\n        const { st, ed, ts = {} } = textRun;\n\n        if (index < st) {\n            const tr: ITextRun = {\n                st: index,\n                ed: st,\n            };\n\n            const merge = mergeStyle({}, newStyle, true);\n\n            // then remove null\n            merge && Tools.removeNull(merge);\n\n            if (!Tools.isEmptyObject(merge)) {\n                tr.ts = merge!;\n            }\n\n            newTextRuns.push(tr);\n        }\n\n        const merge = mergeStyle(ts, newStyle, true);\n\n        // then remove null\n        merge && Tools.removeNull(merge);\n\n        if (Tools.isEmptyObject(merge)) {\n            delete textRun.ts;\n        } else {\n            textRun.ts = merge as ITextStyle;\n        }\n\n        newTextRuns.push(textRun);\n\n        index = skipParagraphs(paragraphs, ed);\n    }\n\n    const endIndex = p.body.dataStream.endsWith('\\r\\n') ? p.body.dataStream.length - 2 : p.body.dataStream.length;\n\n    if (index < endIndex) {\n        const tr: ITextRun = {\n            st: index,\n            ed: endIndex,\n        };\n\n        const merge = mergeStyle({}, newStyle, true);\n\n        // then remove null\n        merge && Tools.removeNull(merge);\n\n        if (!Tools.isEmptyObject(merge)) {\n            tr.ts = merge!;\n        }\n\n        newTextRuns.push(tr);\n    }\n\n    p.body.textRuns = normalizeTextRuns(newTextRuns);\n}\n"],"mappings":"AAiBA,SAAS,mBAAmB,aAAa;AAQlC,gBAAS,YAAY,QAAgB,QAAmB,QAAmB;AAE9E,QAAM,WAAW,OAAO,eAAe,MAAM;AAE7C,MAAI,YAAY,MAAM;AAElB,WAAO,OAAO;AAAA,EAClB;AAEA,MAAI,OAAO,OAAO,MAAM,UAAU;AAC9B,WAAO,IAAI,OAAO,IAAI,OAAO,CAAC;AAAA,EAClC;AAGA,QAAM,QAAQ,WAAW,UAAU,OAAO,IAAK,OAAO,IAA6B,IAAI;AAGvF,MAAI,OAAO;AACP,UAAM,WAAW,KAAK;AAGtB,WAAO,QAAQ,KAAK,EAAE,QAAQ,CAAC,CAAC,KAAK,GAAG,MAAM;AAC1C,UAAI,OAAO,QAAQ,YAAY,QAAQ,QAAQ,OAAO,KAAK,GAAG,EAAE,WAAW,GAAG;AAC1E,eAAO,MAAM,GAAuB;AAAA,MACxC;AAAA,IACJ,CAAC;AAAA,EACL;AAEA,MAAI,MAAM,cAAc,KAAK,GAAG;AAC5B,WAAO,OAAO;AAAA,EAClB,OAAO;AACH,WAAO,IAAI,OAAO,SAAS,KAAK;AAAA,EACpC;AAEA,QAAM,iBAAiB,OAAO,IAAI,GAAG,OAAO,CAAC;AAAA,IAAS;AAEtD,MAAI,CAAC,OAAO,KAAK,OAAO,GAAG;AACvB,QAAI,kBAAkB,mBAAmB,OAAO,EAAE,MAAM,YAAY;AAChE,aAAO,OAAO;AAAA,IAClB,OAAO;AACH,yBAAmB,OAAO,GAAG,OAAO,IAAK,OAAO,IAA6B,IAAI;AAAA,IACrF;AAAA,EACJ;AACJ;AAQO,gBAAS,eAAe,UAAgC,UAAsD;AAEjH,MAAI,CAAC,YAAY,CAAC,OAAO,KAAK,QAAQ,EAAE,QAAQ;AAC5C,WAAO;AAAA,EACX;AACA,QAAM,cAAmC,YAAY,CAAC;AAEtD,aAAW,KAAK,UAAU;AACtB,QAAI,MAAM,MAAM;AACZ,kBAAY,CAAC,IAAI,iBAAiB,YAAY,CAAC,KAAK,CAAC,GAAG,SAAS,CAAC,CAAC;AAAA,IACvE,WAGS,EAAE,KAAK,cAAc;AAC1B,kBAAY,CAAC,IAAI;AAAA,IACrB;AAAA,EACJ;AACA,SAAO;AACX;AAQA,SAAS,iBAAiB,YAAyB,YAAgD;AAE/F,MAAI,CAAC,cAAc,CAAC,OAAO,KAAK,UAAU,EAAE,QAAQ;AAChD,WAAO;AAAA,EACX;AAEA,aAAW,KAAK,YAAY;AAGxB,QAAI,EAAE,KAAK,aAAa;AACpB,MAAC,WAAyB,CAAC,IAAI;AAAA,IACnC;AAAA,EACJ;AAEA,SAAO;AACX;AAQA,SAAS,WACL,UACA,UACA,aAAsB,OACF;AAEpB,MAAI,aAAa,KAAM,QAAO;AAE9B,MAAI,aAAa,OAAW,QAAO;AAEnC,QAAM,cAAmC,MAAM,UAAU,QAAQ,KAAK,CAAC;AAEvE,aAAW,KAAK,UAAU;AAEtB,QAAI,cAAc,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,IAAI,EAAE,SAAS,CAAC,GAAG;AAC5E;AAAA,IACJ;AAEA,QAAI,KAAK,eAAe,MAAM,MAAM;AAChC,kBAAY,CAAC,IAAI,OAAO,OAAO,YAAY,CAAC,GAAG,SAAS,CAAC,CAAC;AAAA,IAC9D,OAAO;AACH,kBAAY,CAAC,IAAK,SAAuB,CAAC;AAAA,IAC9C;AAAA,EACJ;AAEA,MAAI,QAAQ,aAAa;AACrB,QAAI,QAAQ,eAAe,YAAY,IAAI;AACvC,kBAAY,GAAG,KAAK,YAAY;AAAA,IACpC;AAEA,QAAI,QAAQ,eAAe,YAAY,IAAI;AACvC,kBAAY,GAAG,KAAK,YAAY;AAAA,IACpC;AAEA,QAAI,QAAQ,eAAe,YAAY,IAAI;AACvC,kBAAY,GAAG,KAAK,YAAY;AAAA,IACpC;AAAA,EACJ;AAEA,SAAO;AACX;AAOA,SAAS,eAAe,YAA0B,QAAwB;AACtE,MAAI,WAAW,KAAK,CAAC,MAAM,EAAE,eAAe,MAAM,GAAG;AACjD,WAAO,eAAe,YAAY,SAAS,CAAC;AAAA,EAChD;AAEA,SAAO;AACX;AAOA,SAAS,mBAAmB,GAAkB,UAAgC;AAC1E,MAAI,EAAE,QAAQ,MAAM;AAChB;AAAA,EACJ;AAEA,MAAI,CAAC,MAAM,QAAQ,EAAE,KAAK,QAAQ,GAAG;AACjC,MAAE,KAAK,WAAW,CAAC;AAAA,EACvB;AAEA,MAAI,QAAQ;AACZ,QAAM,cAAc,CAAC;AACrB,QAAM,aAAa,EAAE,MAAM,cAAc,CAAC;AAE1C,aAAW,WAAW,EAAE,KAAK,UAAU;AACnC,UAAM,EAAE,IAAI,IAAI,KAAK,CAAC,EAAE,IAAI;AAE5B,QAAI,QAAQ,IAAI;AACZ,YAAM,KAAe;AAAA,QACjB,IAAI;AAAA,QACJ,IAAI;AAAA,MACR;AAEA,YAAMA,SAAQ,WAAW,CAAC,GAAG,UAAU,IAAI;AAG3C,MAAAA,UAAS,MAAM,WAAWA,MAAK;AAE/B,UAAI,CAAC,MAAM,cAAcA,MAAK,GAAG;AAC7B,WAAG,KAAKA;AAAA,MACZ;AAEA,kBAAY,KAAK,EAAE;AAAA,IACvB;AAEA,UAAM,QAAQ,WAAW,IAAI,UAAU,IAAI;AAG3C,aAAS,MAAM,WAAW,KAAK;AAE/B,QAAI,MAAM,cAAc,KAAK,GAAG;AAC5B,aAAO,QAAQ;AAAA,IACnB,OAAO;AACH,cAAQ,KAAK;AAAA,IACjB;AAEA,gBAAY,KAAK,OAAO;AAExB,YAAQ,eAAe,YAAY,EAAE;AAAA,EACzC;AAEA,QAAM,WAAW,EAAE,KAAK,WAAW,SAAS,MAAM,IAAI,EAAE,KAAK,WAAW,SAAS,IAAI,EAAE,KAAK,WAAW;AAEvG,MAAI,QAAQ,UAAU;AAClB,UAAM,KAAe;AAAA,MACjB,IAAI;AAAA,MACJ,IAAI;AAAA,IACR;AAEA,UAAM,QAAQ,WAAW,CAAC,GAAG,UAAU,IAAI;AAG3C,aAAS,MAAM,WAAW,KAAK;AAE/B,QAAI,CAAC,MAAM,cAAc,KAAK,GAAG;AAC7B,SAAG,KAAK;AAAA,IACZ;AAEA,gBAAY,KAAK,EAAE;AAAA,EACvB;AAEA,IAAE,KAAK,WAAW,kBAAkB,WAAW;AACnD;","names":["merge"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3f0747412e964079c684167a85016565625a624d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/cell-type.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/cell-type.ts","statementMap":{"0":{"start":{"line":4,"column":2},"end":{"line":4,"column":32}},"1":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"2":{"start":{"line":5,"column":2},"end":{"line":5,"column":37}},"3":{"start":{"line":5,"column":25},"end":{"line":5,"column":37}},"4":{"start":{"line":6,"column":19},"end":{"line":6,"column":48}},"5":{"start":{"line":7,"column":19},"end":{"line":7,"column":48}},"6":{"start":{"line":8,"column":2},"end":{"line":17,"column":3}},"7":{"start":{"line":9,"column":4},"end":{"line":15,"column":5}},"8":{"start":{"line":10,"column":6},"end":{"line":14,"column":7}},"9":{"start":{"line":11,"column":8},"end":{"line":11,"column":36}},"10":{"start":{"line":12,"column":13},"end":{"line":14,"column":7}},"11":{"start":{"line":13,"column":8},"end":{"line":13,"column":37}},"12":{"start":{"line":16,"column":4},"end":{"line":16,"column":38}},"13":{"start":{"line":18,"column":2},"end":{"line":23,"column":3}},"14":{"start":{"line":19,"column":4},"end":{"line":21,"column":5}},"15":{"start":{"line":20,"column":6},"end":{"line":20,"column":34}},"16":{"start":{"line":22,"column":4},"end":{"line":22,"column":53}},"17":{"start":{"line":24,"column":2},"end":{"line":26,"column":3}},"18":{"start":{"line":25,"column":4},"end":{"line":25,"column":32}},"19":{"start":{"line":27,"column":2},"end":{"line":27,"column":51}},"20":{"start":{"line":30,"column":2},"end":{"line":30,"column":111}},"21":{"start":{"line":33,"column":2},"end":{"line":33,"column":29}},"22":{"start":{"line":36,"column":2},"end":{"line":36,"column":30}},"23":{"start":{"line":36,"column":18},"end":{"line":36,"column":30}},"24":{"start":{"line":37,"column":2},"end":{"line":47,"column":3}},"25":{"start":{"line":38,"column":4},"end":{"line":45,"column":5}},"26":{"start":{"line":39,"column":6},"end":{"line":41,"column":7}},"27":{"start":{"line":40,"column":8},"end":{"line":40,"column":37}},"28":{"start":{"line":42,"column":6},"end":{"line":42,"column":34}},"29":{"start":{"line":43,"column":11},"end":{"line":45,"column":5}},"30":{"start":{"line":44,"column":6},"end":{"line":44,"column":35}},"31":{"start":{"line":46,"column":4},"end":{"line":46,"column":32}},"32":{"start":{"line":48,"column":2},"end":{"line":53,"column":3}},"33":{"start":{"line":49,"column":4},"end":{"line":51,"column":5}},"34":{"start":{"line":50,"column":6},"end":{"line":50,"column":35}},"35":{"start":{"line":52,"column":4},"end":{"line":52,"column":32}},"36":{"start":{"line":54,"column":2},"end":{"line":56,"column":3}},"37":{"start":{"line":55,"column":4},"end":{"line":55,"column":33}},"38":{"start":{"line":57,"column":2},"end":{"line":57,"column":36}},"39":{"start":{"line":60,"column":2},"end":{"line":62,"column":3}},"40":{"start":{"line":61,"column":4},"end":{"line":61,"column":38}},"41":{"start":{"line":63,"column":2},"end":{"line":65,"column":3}},"42":{"start":{"line":64,"column":4},"end":{"line":64,"column":32}},"43":{"start":{"line":66,"column":2},"end":{"line":66,"column":44}}},"fnMap":{"0":{"name":"getCellType","decl":{"start":{"line":3,"column":16},"end":{"line":3,"column":27}},"loc":{"start":{"line":3,"column":52},"end":{"line":28,"column":1}},"line":3},"1":{"name":"checkCellValueTypeByValue","decl":{"start":{"line":29,"column":9},"end":{"line":29,"column":34}},"loc":{"start":{"line":29,"column":51},"end":{"line":31,"column":1}},"line":29},"2":{"name":"hasNumberFormat","decl":{"start":{"line":32,"column":9},"end":{"line":32,"column":24}},"loc":{"start":{"line":32,"column":32},"end":{"line":34,"column":1}},"line":32},"3":{"name":"checkCellValueType","decl":{"start":{"line":35,"column":16},"end":{"line":35,"column":34}},"loc":{"start":{"line":35,"column":44},"end":{"line":58,"column":1}},"line":35},"4":{"name":"getCellTypeByPattern","decl":{"start":{"line":59,"column":16},"end":{"line":59,"column":36}},"loc":{"start":{"line":59,"column":52},"end":{"line":67,"column":1}},"line":59}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":2},"end":{"line":4,"column":32}},"type":"if","locations":[{"start":{"line":4,"column":2},"end":{"line":4,"column":32}},{"start":{},"end":{}}],"line":4},"1":{"loc":{"start":{"line":5,"column":2},"end":{"line":5,"column":37}},"type":"if","locations":[{"start":{"line":5,"column":2},"end":{"line":5,"column":37}},{"start":{},"end":{}}],"line":5},"2":{"loc":{"start":{"line":8,"column":2},"end":{"line":17,"column":3}},"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":17,"column":3}},{"start":{},"end":{}}],"line":8},"3":{"loc":{"start":{"line":9,"column":4},"end":{"line":15,"column":5}},"type":"if","locations":[{"start":{"line":9,"column":4},"end":{"line":15,"column":5}},{"start":{},"end":{}}],"line":9},"4":{"loc":{"start":{"line":9,"column":8},"end":{"line":9,"column":66}},"type":"binary-expr","locations":[{"start":{"line":9,"column":8},"end":{"line":9,"column":43}},{"start":{"line":9,"column":47},"end":{"line":9,"column":66}}],"line":9},"5":{"loc":{"start":{"line":10,"column":6},"end":{"line":14,"column":7}},"type":"if","locations":[{"start":{"line":10,"column":6},"end":{"line":14,"column":7}},{"start":{"line":12,"column":13},"end":{"line":14,"column":7}}],"line":10},"6":{"loc":{"start":{"line":12,"column":13},"end":{"line":14,"column":7}},"type":"if","locations":[{"start":{"line":12,"column":13},"end":{"line":14,"column":7}},{"start":{},"end":{}}],"line":12},"7":{"loc":{"start":{"line":18,"column":2},"end":{"line":23,"column":3}},"type":"if","locations":[{"start":{"line":18,"column":2},"end":{"line":23,"column":3}},{"start":{},"end":{}}],"line":18},"8":{"loc":{"start":{"line":19,"column":4},"end":{"line":21,"column":5}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":21,"column":5}},{"start":{},"end":{}}],"line":19},"9":{"loc":{"start":{"line":24,"column":2},"end":{"line":26,"column":3}},"type":"if","locations":[{"start":{"line":24,"column":2},"end":{"line":26,"column":3}},{"start":{},"end":{}}],"line":24},"10":{"loc":{"start":{"line":30,"column":9},"end":{"line":30,"column":110}},"type":"cond-expr","locations":[{"start":{"line":30,"column":31},"end":{"line":30,"column":69}},{"start":{"line":30,"column":72},"end":{"line":30,"column":110}}],"line":30},"11":{"loc":{"start":{"line":36,"column":2},"end":{"line":36,"column":30}},"type":"if","locations":[{"start":{"line":36,"column":2},"end":{"line":36,"column":30}},{"start":{},"end":{}}],"line":36},"12":{"loc":{"start":{"line":37,"column":2},"end":{"line":47,"column":3}},"type":"if","locations":[{"start":{"line":37,"column":2},"end":{"line":47,"column":3}},{"start":{},"end":{}}],"line":37},"13":{"loc":{"start":{"line":38,"column":4},"end":{"line":45,"column":5}},"type":"if","locations":[{"start":{"line":38,"column":4},"end":{"line":45,"column":5}},{"start":{"line":43,"column":11},"end":{"line":45,"column":5}}],"line":38},"14":{"loc":{"start":{"line":39,"column":6},"end":{"line":41,"column":7}},"type":"if","locations":[{"start":{"line":39,"column":6},"end":{"line":41,"column":7}},{"start":{},"end":{}}],"line":39},"15":{"loc":{"start":{"line":39,"column":10},"end":{"line":39,"column":66}},"type":"binary-expr","locations":[{"start":{"line":39,"column":11},"end":{"line":39,"column":19}},{"start":{"line":39,"column":23},"end":{"line":39,"column":31}},{"start":{"line":39,"column":36},"end":{"line":39,"column":66}}],"line":39},"16":{"loc":{"start":{"line":43,"column":11},"end":{"line":45,"column":5}},"type":"if","locations":[{"start":{"line":43,"column":11},"end":{"line":45,"column":5}},{"start":{},"end":{}}],"line":43},"17":{"loc":{"start":{"line":48,"column":2},"end":{"line":53,"column":3}},"type":"if","locations":[{"start":{"line":48,"column":2},"end":{"line":53,"column":3}},{"start":{},"end":{}}],"line":48},"18":{"loc":{"start":{"line":49,"column":4},"end":{"line":51,"column":5}},"type":"if","locations":[{"start":{"line":49,"column":4},"end":{"line":51,"column":5}},{"start":{},"end":{}}],"line":49},"19":{"loc":{"start":{"line":49,"column":8},"end":{"line":49,"column":62}},"type":"binary-expr","locations":[{"start":{"line":49,"column":9},"end":{"line":49,"column":16}},{"start":{"line":49,"column":20},"end":{"line":49,"column":27}},{"start":{"line":49,"column":32},"end":{"line":49,"column":62}}],"line":49},"20":{"loc":{"start":{"line":54,"column":2},"end":{"line":56,"column":3}},"type":"if","locations":[{"start":{"line":54,"column":2},"end":{"line":56,"column":3}},{"start":{},"end":{}}],"line":54},"21":{"loc":{"start":{"line":60,"column":2},"end":{"line":62,"column":3}},"type":"if","locations":[{"start":{"line":60,"column":2},"end":{"line":62,"column":3}},{"start":{},"end":{}}],"line":60},"22":{"loc":{"start":{"line":63,"column":2},"end":{"line":65,"column":3}},"type":"if","locations":[{"start":{"line":63,"column":2},"end":{"line":65,"column":3}},{"start":{},"end":{}}],"line":63}},"s":{"0":4,"1":0,"2":4,"3":0,"4":4,"5":4,"6":4,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":4,"14":0,"15":0,"16":0,"17":4,"18":0,"19":4,"20":4,"21":4,"22":4,"23":0,"24":4,"25":4,"26":0,"27":0,"28":0,"29":4,"30":0,"31":4,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0},"f":{"0":4,"1":4,"2":4,"3":4,"4":0},"b":{"0":[0,4],"1":[0,4],"2":[0,4],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,4],"8":[0,0],"9":[0,4],"10":[4,0],"11":[0,4],"12":[4,0],"13":[0,4],"14":[0,0],"15":[0,0,0],"16":[0,4],"17":[0,0],"18":[0,0],"19":[0,0,0],"20":[0,0],"21":[0,0],"22":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/cell-type.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { CellValue, ICellData, IStyleData, Nullable, Styles } from '@univerjs/core';\nimport { CellValueType, isBooleanString, isRealNum } from '@univerjs/core';\nimport { isTextFormat } from '@univerjs/engine-numfmt';\n\n/**\n * Get cell value type by style, new value and old value.\n * If the new value contains t, then take t directly. In other cases, we need to dynamically determine based on actual data and styles\n * @param newVal\n * @param oldVal\n * @returns\n */\nexport function getCellType(styles: Styles, newVal: ICellData, oldVal: ICellData) {\n    if (newVal.t) return newVal.t;\n    if (newVal.v === null) return null;\n\n    const newStyle = styles.getStyleByCell(newVal);\n    const oldStyle = styles.getStyleByCell(oldVal);\n\n    if (oldVal.t === CellValueType.FORCE_STRING) {\n        // For cells with forced strings, set the percentage format and still use forced strings\n        // For cells with forced strings, update to the number and convert to ordinary numbers\n        // For cells with forced strings and text formats, update to the number and still use forced strings\n        if (!isTextFormat(oldStyle?.n?.pattern) && newVal.v !== undefined) {\n            if (isRealNum(newVal.v)) {\n                return CellValueType.NUMBER;\n            } else if (isBooleanString(`${newVal.v}`)) {\n                return CellValueType.BOOLEAN;\n            }\n        }\n\n        return CellValueType.FORCE_STRING;\n    }\n\n    // For cells with ordinary numbers, set the text format and convert the cell type to text\n    if (hasNumberFormat(newStyle)) {\n        if (isTextFormat(newStyle?.n?.pattern)) {\n            return CellValueType.STRING;\n        }\n\n        return checkCellValueTypeByValue(newVal, oldVal);\n    }\n\n    // For cells with text format, the cell type is still text when numbers are written, because the ISNUMBER function detects FALSE\n    if (isTextFormat(oldStyle?.n?.pattern)) {\n        return CellValueType.STRING;\n    }\n\n    return checkCellValueTypeByValue(newVal, oldVal);\n}\n\nfunction checkCellValueTypeByValue(newVal: ICellData, oldVal: ICellData): Nullable<CellValueType> {\n    return newVal.v !== undefined ? checkCellValueType(newVal.v, newVal.t) : checkCellValueType(oldVal.v, oldVal.t);\n}\n\nfunction hasNumberFormat(style: Nullable<IStyleData>) {\n    return !!style?.n?.pattern;\n}\n\n/**\n * Get the correct type after setting values to a cell.\n *\n * @param v the new value\n * @param type the old type\n * @returns the new type\n */\nexport function checkCellValueType(v: Nullable<CellValue>, type: Nullable<CellValueType>): Nullable<CellValueType> {\n    if (v === null) return null;\n\n    if (typeof v === 'string') {\n        // Support scientific notation, such as 10e+1\n        if (isRealNum(v)) {\n            if ((+v === 0 || +v === 1) && type === CellValueType.BOOLEAN) {\n                return CellValueType.BOOLEAN;\n            }\n\n            return CellValueType.NUMBER;\n        } else if (isBooleanString(v)) {\n            return CellValueType.BOOLEAN;\n        }\n        return CellValueType.STRING;\n    }\n\n    if (typeof v === 'number') {\n        if ((v === 0 || v === 1) && type === CellValueType.BOOLEAN) {\n            return CellValueType.BOOLEAN;\n        }\n        return CellValueType.NUMBER;\n    }\n\n    if (typeof v === 'boolean') {\n        return CellValueType.BOOLEAN;\n    }\n\n    return CellValueType.FORCE_STRING;\n}\n\nexport function getCellTypeByPattern(cell: ICellData, pattern: string) {\n    if (cell.t === CellValueType.FORCE_STRING) {\n        return CellValueType.FORCE_STRING;\n    }\n\n    if (isTextFormat(pattern)) {\n        return CellValueType.STRING;\n    }\n\n    return checkCellValueType(cell.v, cell.t);\n}\n"],"mappings":"AAiBA,SAAS,eAAe,iBAAiB,iBAAiB;AAC1D,SAAS,oBAAoB;AAStB,gBAAS,YAAY,QAAgB,QAAmB,QAAmB;AAC9E,MAAI,OAAO,EAAG,QAAO,OAAO;AAC5B,MAAI,OAAO,MAAM,KAAM,QAAO;AAE9B,QAAM,WAAW,OAAO,eAAe,MAAM;AAC7C,QAAM,WAAW,OAAO,eAAe,MAAM;AAE7C,MAAI,OAAO,MAAM,cAAc,cAAc;AAIzC,QAAI,CAAC,aAAa,UAAU,GAAG,OAAO,KAAK,OAAO,MAAM,QAAW;AAC/D,UAAI,UAAU,OAAO,CAAC,GAAG;AACrB,eAAO,cAAc;AAAA,MACzB,WAAW,gBAAgB,GAAG,OAAO,CAAC,EAAE,GAAG;AACvC,eAAO,cAAc;AAAA,MACzB;AAAA,IACJ;AAEA,WAAO,cAAc;AAAA,EACzB;AAGA,MAAI,gBAAgB,QAAQ,GAAG;AAC3B,QAAI,aAAa,UAAU,GAAG,OAAO,GAAG;AACpC,aAAO,cAAc;AAAA,IACzB;AAEA,WAAO,0BAA0B,QAAQ,MAAM;AAAA,EACnD;AAGA,MAAI,aAAa,UAAU,GAAG,OAAO,GAAG;AACpC,WAAO,cAAc;AAAA,EACzB;AAEA,SAAO,0BAA0B,QAAQ,MAAM;AACnD;AAEA,SAAS,0BAA0B,QAAmB,QAA4C;AAC9F,SAAO,OAAO,MAAM,SAAY,mBAAmB,OAAO,GAAG,OAAO,CAAC,IAAI,mBAAmB,OAAO,GAAG,OAAO,CAAC;AAClH;AAEA,SAAS,gBAAgB,OAA6B;AAClD,SAAO,CAAC,CAAC,OAAO,GAAG;AACvB;AASO,gBAAS,mBAAmB,GAAwB,MAAwD;AAC/G,MAAI,MAAM,KAAM,QAAO;AAEvB,MAAI,OAAO,MAAM,UAAU;AAEvB,QAAI,UAAU,CAAC,GAAG;AACd,WAAK,CAAC,MAAM,KAAK,CAAC,MAAM,MAAM,SAAS,cAAc,SAAS;AAC1D,eAAO,cAAc;AAAA,MACzB;AAEA,aAAO,cAAc;AAAA,IACzB,WAAW,gBAAgB,CAAC,GAAG;AAC3B,aAAO,cAAc;AAAA,IACzB;AACA,WAAO,cAAc;AAAA,EACzB;AAEA,MAAI,OAAO,MAAM,UAAU;AACvB,SAAK,MAAM,KAAK,MAAM,MAAM,SAAS,cAAc,SAAS;AACxD,aAAO,cAAc;AAAA,IACzB;AACA,WAAO,cAAc;AAAA,EACzB;AAEA,MAAI,OAAO,MAAM,WAAW;AACxB,WAAO,cAAc;AAAA,EACzB;AAEA,SAAO,cAAc;AACzB;AAEO,gBAAS,qBAAqB,MAAiB,SAAiB;AACnE,MAAI,KAAK,MAAM,cAAc,cAAc;AACvC,WAAO,cAAc;AAAA,EACzB;AAEA,MAAI,aAAa,OAAO,GAAG;AACvB,WAAO,cAAc;AAAA,EACzB;AAEA,SAAO,mBAAmB,KAAK,GAAG,KAAK,CAAC;AAC5C;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"41f5b16c476cc5bd17bdfe15655be2c939aed4b1"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/cell-value.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/cell-value.ts","statementMap":{"0":{"start":{"line":3,"column":2},"end":{"line":5,"column":3}},"1":{"start":{"line":4,"column":4},"end":{"line":4,"column":26}},"2":{"start":{"line":6,"column":2},"end":{"line":8,"column":3}},"3":{"start":{"line":7,"column":4},"end":{"line":7,"column":47}},"4":{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},"5":{"start":{"line":10,"column":4},"end":{"line":10,"column":23}},"6":{"start":{"line":12,"column":2},"end":{"line":12,"column":16}},"7":{"start":{"line":15,"column":2},"end":{"line":31,"column":3}},"8":{"start":{"line":16,"column":4},"end":{"line":18,"column":5}},"9":{"start":{"line":17,"column":6},"end":{"line":17,"column":18}},"10":{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},"11":{"start":{"line":21,"column":6},"end":{"line":21,"column":19}},"12":{"start":{"line":23,"column":4},"end":{"line":30,"column":5}},"13":{"start":{"line":24,"column":6},"end":{"line":26,"column":7}},"14":{"start":{"line":25,"column":8},"end":{"line":25,"column":21}},"15":{"start":{"line":27,"column":6},"end":{"line":29,"column":7}},"16":{"start":{"line":28,"column":8},"end":{"line":28,"column":20}},"17":{"start":{"line":32,"column":2},"end":{"line":39,"column":3}},"18":{"start":{"line":33,"column":4},"end":{"line":35,"column":5}},"19":{"start":{"line":34,"column":6},"end":{"line":34,"column":19}},"20":{"start":{"line":36,"column":4},"end":{"line":38,"column":5}},"21":{"start":{"line":37,"column":6},"end":{"line":37,"column":18}},"22":{"start":{"line":40,"column":2},"end":{"line":42,"column":3}},"23":{"start":{"line":41,"column":4},"end":{"line":41,"column":17}},"24":{"start":{"line":43,"column":2},"end":{"line":43,"column":14}},"25":{"start":{"line":46,"column":2},"end":{"line":46,"column":33}},"26":{"start":{"line":46,"column":21},"end":{"line":46,"column":33}},"27":{"start":{"line":47,"column":2},"end":{"line":49,"column":3}},"28":{"start":{"line":48,"column":4},"end":{"line":48,"column":19}},"29":{"start":{"line":50,"column":2},"end":{"line":52,"column":3}},"30":{"start":{"line":51,"column":4},"end":{"line":51,"column":20}},"31":{"start":{"line":53,"column":2},"end":{"line":55,"column":3}},"32":{"start":{"line":54,"column":4},"end":{"line":54,"column":19}},"33":{"start":{"line":56,"column":2},"end":{"line":58,"column":3}},"34":{"start":{"line":57,"column":4},"end":{"line":57,"column":19}},"35":{"start":{"line":59,"column":2},"end":{"line":61,"column":3}},"36":{"start":{"line":60,"column":4},"end":{"line":60,"column":19}},"37":{"start":{"line":62,"column":2},"end":{"line":64,"column":3}},"38":{"start":{"line":63,"column":4},"end":{"line":63,"column":19}},"39":{"start":{"line":65,"column":2},"end":{"line":67,"column":3}},"40":{"start":{"line":66,"column":4},"end":{"line":66,"column":24}},"41":{"start":{"line":68,"column":2},"end":{"line":68,"column":15}}},"fnMap":{"0":{"name":"getCellValue","decl":{"start":{"line":2,"column":16},"end":{"line":2,"column":28}},"loc":{"start":{"line":2,"column":41},"end":{"line":13,"column":1}},"line":2},"1":{"name":"extractBooleanValue","decl":{"start":{"line":14,"column":16},"end":{"line":14,"column":35}},"loc":{"start":{"line":14,"column":43},"end":{"line":44,"column":1}},"line":14},"2":{"name":"setNull","decl":{"start":{"line":45,"column":16},"end":{"line":45,"column":23}},"loc":{"start":{"line":45,"column":31},"end":{"line":69,"column":1}},"line":45}},"branchMap":{"0":{"loc":{"start":{"line":3,"column":2},"end":{"line":5,"column":3}},"type":"if","locations":[{"start":{"line":3,"column":2},"end":{"line":5,"column":3}},{"start":{},"end":{}}],"line":3},"1":{"loc":{"start":{"line":6,"column":2},"end":{"line":8,"column":3}},"type":"if","locations":[{"start":{"line":6,"column":2},"end":{"line":8,"column":3}},{"start":{},"end":{}}],"line":6},"2":{"loc":{"start":{"line":7,"column":11},"end":{"line":7,"column":46}},"type":"cond-expr","locations":[{"start":{"line":7,"column":41},"end":{"line":7,"column":42}},{"start":{"line":7,"column":45},"end":{"line":7,"column":46}}],"line":7},"3":{"loc":{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},"type":"if","locations":[{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},{"start":{},"end":{}}],"line":9},"4":{"loc":{"start":{"line":9,"column":6},"end":{"line":9,"column":74}},"type":"binary-expr","locations":[{"start":{"line":9,"column":6},"end":{"line":9,"column":35}},{"start":{"line":9,"column":39},"end":{"line":9,"column":74}}],"line":9},"5":{"loc":{"start":{"line":15,"column":2},"end":{"line":31,"column":3}},"type":"if","locations":[{"start":{"line":15,"column":2},"end":{"line":31,"column":3}},{"start":{},"end":{}}],"line":15},"6":{"loc":{"start":{"line":16,"column":4},"end":{"line":18,"column":5}},"type":"if","locations":[{"start":{"line":16,"column":4},"end":{"line":18,"column":5}},{"start":{},"end":{}}],"line":16},"7":{"loc":{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},{"start":{},"end":{}}],"line":20},"8":{"loc":{"start":{"line":23,"column":4},"end":{"line":30,"column":5}},"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":30,"column":5}},{"start":{},"end":{}}],"line":23},"9":{"loc":{"start":{"line":24,"column":6},"end":{"line":26,"column":7}},"type":"if","locations":[{"start":{"line":24,"column":6},"end":{"line":26,"column":7}},{"start":{},"end":{}}],"line":24},"10":{"loc":{"start":{"line":27,"column":6},"end":{"line":29,"column":7}},"type":"if","locations":[{"start":{"line":27,"column":6},"end":{"line":29,"column":7}},{"start":{},"end":{}}],"line":27},"11":{"loc":{"start":{"line":32,"column":2},"end":{"line":39,"column":3}},"type":"if","locations":[{"start":{"line":32,"column":2},"end":{"line":39,"column":3}},{"start":{},"end":{}}],"line":32},"12":{"loc":{"start":{"line":33,"column":4},"end":{"line":35,"column":5}},"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":35,"column":5}},{"start":{},"end":{}}],"line":33},"13":{"loc":{"start":{"line":36,"column":4},"end":{"line":38,"column":5}},"type":"if","locations":[{"start":{"line":36,"column":4},"end":{"line":38,"column":5}},{"start":{},"end":{}}],"line":36},"14":{"loc":{"start":{"line":40,"column":2},"end":{"line":42,"column":3}},"type":"if","locations":[{"start":{"line":40,"column":2},"end":{"line":42,"column":3}},{"start":{},"end":{}}],"line":40},"15":{"loc":{"start":{"line":46,"column":2},"end":{"line":46,"column":33}},"type":"if","locations":[{"start":{"line":46,"column":2},"end":{"line":46,"column":33}},{"start":{},"end":{}}],"line":46},"16":{"loc":{"start":{"line":47,"column":2},"end":{"line":49,"column":3}},"type":"if","locations":[{"start":{"line":47,"column":2},"end":{"line":49,"column":3}},{"start":{},"end":{}}],"line":47},"17":{"loc":{"start":{"line":50,"column":2},"end":{"line":52,"column":3}},"type":"if","locations":[{"start":{"line":50,"column":2},"end":{"line":52,"column":3}},{"start":{},"end":{}}],"line":50},"18":{"loc":{"start":{"line":53,"column":2},"end":{"line":55,"column":3}},"type":"if","locations":[{"start":{"line":53,"column":2},"end":{"line":55,"column":3}},{"start":{},"end":{}}],"line":53},"19":{"loc":{"start":{"line":56,"column":2},"end":{"line":58,"column":3}},"type":"if","locations":[{"start":{"line":56,"column":2},"end":{"line":58,"column":3}},{"start":{},"end":{}}],"line":56},"20":{"loc":{"start":{"line":59,"column":2},"end":{"line":61,"column":3}},"type":"if","locations":[{"start":{"line":59,"column":2},"end":{"line":61,"column":3}},{"start":{},"end":{}}],"line":59},"21":{"loc":{"start":{"line":62,"column":2},"end":{"line":64,"column":3}},"type":"if","locations":[{"start":{"line":62,"column":2},"end":{"line":64,"column":3}},{"start":{},"end":{}}],"line":62},"22":{"loc":{"start":{"line":65,"column":2},"end":{"line":67,"column":3}},"type":"if","locations":[{"start":{"line":65,"column":2},"end":{"line":67,"column":3}},{"start":{},"end":{}}],"line":65}},"s":{"0":8,"1":0,"2":8,"3":0,"4":8,"5":8,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":2,"26":0,"27":2,"28":2,"29":2,"30":2,"31":2,"32":2,"33":2,"34":0,"35":2,"36":2,"37":2,"38":2,"39":2,"40":2,"41":2},"f":{"0":8,"1":0,"2":2},"b":{"0":[0,8],"1":[0,8],"2":[0,0],"3":[8,0],"4":[8,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,2],"16":[2,0],"17":[2,0],"18":[2,0],"19":[0,2],"20":[2,0],"21":[2,0],"22":[2,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/cell-value.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellData, Nullable } from '@univerjs/core';\nimport { CellValueType, isSafeNumeric } from '@univerjs/core';\n\n/**\n * Get cell value from new value by type\n * @param type\n * @param cell\n * @returns\n */\nexport function getCellValue(type: Nullable<CellValueType>, cell: ICellData) {\n    if (type === CellValueType.NUMBER) {\n        return Number(cell.v);\n    }\n\n    if (type === CellValueType.BOOLEAN) {\n        return extractBooleanValue(cell.v) ? 1 : 0;\n    }\n\n    if (type === CellValueType.STRING || type === CellValueType.FORCE_STRING) {\n        return `${cell.v}`;\n    }\n\n    return cell.v;\n}\n\n/**\n * Check if the value can be casted to a boolean.\n * @internal\n * @param value\n * @returns It would return null if the value cannot be casted to a boolean, and would return the boolean value if it can be casted.\n */\nexport function extractBooleanValue(value: Nullable<string | number | boolean>): Nullable<boolean> {\n    if (typeof value === 'string') {\n        if (value.toUpperCase() === 'TRUE') {\n            return true;\n        };\n\n        if (value.toUpperCase() === 'FALSE') {\n            return false;\n        }\n\n        if (isSafeNumeric(value)) {\n            if (Number(value) === 0) {\n                return false;\n            }\n\n            if (Number(value) === 1) {\n                return true;\n            }\n        }\n    }\n\n    if (typeof value === 'number') {\n        if (value === 0) {\n            return false;\n        }\n\n        if (value === 1) {\n            return true;\n        }\n    }\n\n    if (typeof value === 'boolean') {\n        return value;\n    }\n\n    return null;\n}\n\n/**\n * Supplement the data of the cell, set the other value to NULL, Used to reset properties when undoing\n * @param value\n * @returns\n */\nexport function setNull(value: Nullable<ICellData>) {\n    if (value == null) return null;\n\n    if (value.f === undefined) {\n        value.f = null;\n    }\n\n    if (value.si === undefined) {\n        value.si = null;\n    }\n\n    if (value.p === undefined) {\n        value.p = null;\n    }\n\n    if (value.v === undefined) {\n        value.v = null;\n    }\n\n    if (value.t === undefined) {\n        value.t = null;\n    }\n\n    if (value.s === undefined) {\n        value.s = null;\n    }\n\n    if (value.custom === undefined) {\n        value.custom = null;\n    }\n\n    return value;\n}\n"],"mappings":"AAiBA,SAAS,eAAe,qBAAqB;AAQtC,gBAAS,aAAa,MAA+B,MAAiB;AACzE,MAAI,SAAS,cAAc,QAAQ;AAC/B,WAAO,OAAO,KAAK,CAAC;AAAA,EACxB;AAEA,MAAI,SAAS,cAAc,SAAS;AAChC,WAAO,oBAAoB,KAAK,CAAC,IAAI,IAAI;AAAA,EAC7C;AAEA,MAAI,SAAS,cAAc,UAAU,SAAS,cAAc,cAAc;AACtE,WAAO,GAAG,KAAK,CAAC;AAAA,EACpB;AAEA,SAAO,KAAK;AAChB;AAQO,gBAAS,oBAAoB,OAA+D;AAC/F,MAAI,OAAO,UAAU,UAAU;AAC3B,QAAI,MAAM,YAAY,MAAM,QAAQ;AAChC,aAAO;AAAA,IACX;AAAC;AAED,QAAI,MAAM,YAAY,MAAM,SAAS;AACjC,aAAO;AAAA,IACX;AAEA,QAAI,cAAc,KAAK,GAAG;AACtB,UAAI,OAAO,KAAK,MAAM,GAAG;AACrB,eAAO;AAAA,MACX;AAEA,UAAI,OAAO,KAAK,MAAM,GAAG;AACrB,eAAO;AAAA,MACX;AAAA,IACJ;AAAA,EACJ;AAEA,MAAI,OAAO,UAAU,UAAU;AAC3B,QAAI,UAAU,GAAG;AACb,aAAO;AAAA,IACX;AAEA,QAAI,UAAU,GAAG;AACb,aAAO;AAAA,IACX;AAAA,EACJ;AAEA,MAAI,OAAO,UAAU,WAAW;AAC5B,WAAO;AAAA,EACX;AAEA,SAAO;AACX;AAOO,gBAAS,QAAQ,OAA4B;AAChD,MAAI,SAAS,KAAM,QAAO;AAE1B,MAAI,MAAM,MAAM,QAAW;AACvB,UAAM,IAAI;AAAA,EACd;AAEA,MAAI,MAAM,OAAO,QAAW;AACxB,UAAM,KAAK;AAAA,EACf;AAEA,MAAI,MAAM,MAAM,QAAW;AACvB,UAAM,IAAI;AAAA,EACd;AAEA,MAAI,MAAM,MAAM,QAAW;AACvB,UAAM,IAAI;AAAA,EACd;AAEA,MAAI,MAAM,MAAM,QAAW;AACvB,UAAM,IAAI;AAAA,EACd;AAEA,MAAI,MAAM,MAAM,QAAW;AACvB,UAAM,IAAI;AAAA,EACd;AAEA,MAAI,MAAM,WAAW,QAAW;AAC5B,UAAM,SAAS;AAAA,EACnB;AAEA,SAAO;AACX;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"15e226475a9ac53551d777b78e513d1dd1352813"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/set-range-values.mutation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/set-range-values.mutation.ts","statementMap":{"0":{"start":{"line":5,"column":49},"end":{"line":32,"column":1}},"1":{"start":{"line":6,"column":43},"end":{"line":6,"column":49}},"2":{"start":{"line":7,"column":32},"end":{"line":7,"column":68}},"3":{"start":{"line":8,"column":19},"end":{"line":8,"column":71}},"4":{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},"5":{"start":{"line":10,"column":4},"end":{"line":10,"column":47}},"6":{"start":{"line":12,"column":20},"end":{"line":12,"column":57}},"7":{"start":{"line":13,"column":2},"end":{"line":15,"column":3}},"8":{"start":{"line":14,"column":4},"end":{"line":14,"column":48}},"9":{"start":{"line":16,"column":21},"end":{"line":16,"column":46}},"10":{"start":{"line":17,"column":17},"end":{"line":17,"column":37}},"11":{"start":{"line":18,"column":19},"end":{"line":18,"column":37}},"12":{"start":{"line":19,"column":20},"end":{"line":19,"column":47}},"13":{"start":{"line":20,"column":2},"end":{"line":26,"column":5}},"14":{"start":{"line":21,"column":17},"end":{"line":21,"column":70}},"15":{"start":{"line":22,"column":21},"end":{"line":22,"column":48}},"16":{"start":{"line":23,"column":21},"end":{"line":23,"column":50}},"17":{"start":{"line":24,"column":4},"end":{"line":24,"column":48}},"18":{"start":{"line":25,"column":4},"end":{"line":25,"column":47}},"19":{"start":{"line":27,"column":2},"end":{"line":31,"column":4}},"20":{"start":{"line":33,"column":38},"end":{"line":83,"column":1}},"21":{"start":{"line":37,"column":45},"end":{"line":37,"column":51}},"22":{"start":{"line":38,"column":34},"end":{"line":38,"column":70}},"23":{"start":{"line":39,"column":21},"end":{"line":39,"column":58}},"24":{"start":{"line":40,"column":4},"end":{"line":42,"column":5}},"25":{"start":{"line":41,"column":6},"end":{"line":41,"column":19}},"26":{"start":{"line":43,"column":22},"end":{"line":43,"column":59}},"27":{"start":{"line":44,"column":4},"end":{"line":46,"column":5}},"28":{"start":{"line":45,"column":6},"end":{"line":45,"column":19}},"29":{"start":{"line":47,"column":23},"end":{"line":47,"column":48}},"30":{"start":{"line":48,"column":19},"end":{"line":48,"column":39}},"31":{"start":{"line":49,"column":22},"end":{"line":49,"column":49}},"32":{"start":{"line":50,"column":4},"end":{"line":80,"column":7}},"33":{"start":{"line":51,"column":6},"end":{"line":79,"column":7}},"34":{"start":{"line":52,"column":8},"end":{"line":52,"column":43}},"35":{"start":{"line":54,"column":23},"end":{"line":54,"column":58}},"36":{"start":{"line":55,"column":21},"end":{"line":55,"column":56}},"37":{"start":{"line":56,"column":8},"end":{"line":58,"column":9}},"38":{"start":{"line":57,"column":10},"end":{"line":57,"column":30}},"39":{"start":{"line":59,"column":8},"end":{"line":61,"column":9}},"40":{"start":{"line":60,"column":10},"end":{"line":60,"column":32}},"41":{"start":{"line":62,"column":8},"end":{"line":64,"column":9}},"42":{"start":{"line":63,"column":10},"end":{"line":63,"column":30}},"43":{"start":{"line":65,"column":8},"end":{"line":67,"column":9}},"44":{"start":{"line":66,"column":10},"end":{"line":66,"column":48}},"45":{"start":{"line":68,"column":8},"end":{"line":71,"column":9}},"46":{"start":{"line":69,"column":10},"end":{"line":69,"column":26}},"47":{"start":{"line":70,"column":10},"end":{"line":70,"column":48}},"48":{"start":{"line":72,"column":8},"end":{"line":74,"column":9}},"49":{"start":{"line":73,"column":10},"end":{"line":73,"column":46}},"50":{"start":{"line":75,"column":8},"end":{"line":77,"column":9}},"51":{"start":{"line":76,"column":10},"end":{"line":76,"column":40}},"52":{"start":{"line":78,"column":8},"end":{"line":78,"column":64}},"53":{"start":{"line":81,"column":4},"end":{"line":81,"column":16}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":49},"end":{"line":5,"column":50}},"loc":{"start":{"line":5,"column":71},"end":{"line":32,"column":1}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":20,"column":21},"end":{"line":20,"column":22}},"loc":{"start":{"line":20,"column":43},"end":{"line":26,"column":3}},"line":20},"2":{"name":"(anonymous_2)","decl":{"start":{"line":36,"column":11},"end":{"line":36,"column":12}},"loc":{"start":{"line":36,"column":33},"end":{"line":82,"column":3}},"line":36},"3":{"name":"(anonymous_3)","decl":{"start":{"line":50,"column":23},"end":{"line":50,"column":24}},"loc":{"start":{"line":50,"column":45},"end":{"line":80,"column":5}},"line":50}},"branchMap":{"0":{"loc":{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},"type":"if","locations":[{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},{"start":{},"end":{}}],"line":9},"1":{"loc":{"start":{"line":13,"column":2},"end":{"line":15,"column":3}},"type":"if","locations":[{"start":{"line":13,"column":2},"end":{"line":15,"column":3}},{"start":{},"end":{}}],"line":13},"2":{"loc":{"start":{"line":21,"column":17},"end":{"line":21,"column":70}},"type":"binary-expr","locations":[{"start":{"line":21,"column":17},"end":{"line":21,"column":64}},{"start":{"line":21,"column":68},"end":{"line":21,"column":70}}],"line":21},"3":{"loc":{"start":{"line":40,"column":4},"end":{"line":42,"column":5}},"type":"if","locations":[{"start":{"line":40,"column":4},"end":{"line":42,"column":5}},{"start":{},"end":{}}],"line":40},"4":{"loc":{"start":{"line":44,"column":4},"end":{"line":46,"column":5}},"type":"if","locations":[{"start":{"line":44,"column":4},"end":{"line":46,"column":5}},{"start":{},"end":{}}],"line":44},"5":{"loc":{"start":{"line":51,"column":6},"end":{"line":79,"column":7}},"type":"if","locations":[{"start":{"line":51,"column":6},"end":{"line":79,"column":7}},{"start":{"line":53,"column":13},"end":{"line":79,"column":7}}],"line":51},"6":{"loc":{"start":{"line":54,"column":23},"end":{"line":54,"column":58}},"type":"binary-expr","locations":[{"start":{"line":54,"column":23},"end":{"line":54,"column":52}},{"start":{"line":54,"column":56},"end":{"line":54,"column":58}}],"line":54},"7":{"loc":{"start":{"line":56,"column":8},"end":{"line":58,"column":9}},"type":"if","locations":[{"start":{"line":56,"column":8},"end":{"line":58,"column":9}},{"start":{},"end":{}}],"line":56},"8":{"loc":{"start":{"line":59,"column":8},"end":{"line":61,"column":9}},"type":"if","locations":[{"start":{"line":59,"column":8},"end":{"line":61,"column":9}},{"start":{},"end":{}}],"line":59},"9":{"loc":{"start":{"line":62,"column":8},"end":{"line":64,"column":9}},"type":"if","locations":[{"start":{"line":62,"column":8},"end":{"line":64,"column":9}},{"start":{},"end":{}}],"line":62},"10":{"loc":{"start":{"line":65,"column":8},"end":{"line":67,"column":9}},"type":"if","locations":[{"start":{"line":65,"column":8},"end":{"line":67,"column":9}},{"start":{},"end":{}}],"line":65},"11":{"loc":{"start":{"line":68,"column":8},"end":{"line":71,"column":9}},"type":"if","locations":[{"start":{"line":68,"column":8},"end":{"line":71,"column":9}},{"start":{},"end":{}}],"line":68},"12":{"loc":{"start":{"line":72,"column":8},"end":{"line":74,"column":9}},"type":"if","locations":[{"start":{"line":72,"column":8},"end":{"line":74,"column":9}},{"start":{},"end":{}}],"line":72},"13":{"loc":{"start":{"line":75,"column":8},"end":{"line":77,"column":9}},"type":"if","locations":[{"start":{"line":75,"column":8},"end":{"line":77,"column":9}},{"start":{},"end":{}}],"line":75}},"s":{"0":1,"1":2,"2":2,"3":2,"4":2,"5":0,"6":2,"7":2,"8":0,"9":2,"10":2,"11":2,"12":2,"13":2,"14":2,"15":2,"16":2,"17":2,"18":2,"19":2,"20":1,"21":8,"22":8,"23":8,"24":8,"25":0,"26":8,"27":8,"28":0,"29":8,"30":8,"31":8,"32":8,"33":8,"34":4,"35":4,"36":4,"37":4,"38":4,"39":4,"40":4,"41":4,"42":4,"43":4,"44":4,"45":4,"46":4,"47":4,"48":4,"49":4,"50":4,"51":4,"52":4,"53":8},"f":{"0":2,"1":2,"2":8,"3":8},"b":{"0":[0,2],"1":[0,2],"2":[2,0],"3":[0,8],"4":[0,8],"5":[4,4],"6":[4,0],"7":[4,0],"8":[4,0],"9":[4,0],"10":[4,0],"11":[4,0],"12":[4,0],"13":[4,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/mutations/set-range-values.mutation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type {\n    IAccessor,\n    ICellData,\n    ICopyToOptionsData,\n    IMutation,\n    IMutationCommonParams,\n    IObjectMatrixPrimitiveType,\n    IRange,\n    Nullable,\n    Workbook,\n} from '@univerjs/core';\nimport { CommandType, IUniverInstanceService, ObjectMatrix, Tools } from '@univerjs/core';\nimport { handleStyle, transformStyle } from '../../basics/cell-style';\nimport { getCellType } from '../../basics/cell-type';\nimport { getCellValue, setNull } from '../../basics/cell-value';\n\n/** Params of `SetRangeValuesMutation` */\nexport interface ISetRangeValuesMutationParams extends IMutationCommonParams {\n    subUnitId: string;\n    unitId: string;\n\n    /**\n     * null for clear all\n     */\n    cellValue?: IObjectMatrixPrimitiveType<Nullable<ICellData>>;\n\n    /**\n     * @deprecated not a good design\n     */\n    options?: ICopyToOptionsData;\n}\n\nexport interface ISetRangeValuesRangeMutationParams extends ISetRangeValuesMutationParams {\n    range: IRange[];\n}\n\n/**\n * Generate undo mutation of a `SetRangeValuesMutation`\n *\n * @param {IAccessor} accessor - injector accessor\n * @param {ISetRangeValuesMutationParams} params - do mutation params\n * @returns {ISetRangeValuesMutationParams} undo mutation params\n */\nexport const SetRangeValuesUndoMutationFactory = (\n    accessor: IAccessor,\n    params: ISetRangeValuesMutationParams\n): ISetRangeValuesMutationParams => {\n    const { unitId, subUnitId, cellValue } = params;\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const workbook = univerInstanceService.getUniverSheetInstance(unitId);\n\n    if (workbook == null) {\n        throw new Error('workbook is null error!');\n    }\n\n    const worksheet = workbook.getSheetBySheetId(subUnitId);\n    if (worksheet == null) {\n        throw new Error('worksheet is null error!');\n    }\n\n    const cellMatrix = worksheet.getCellMatrix();\n    const styles = workbook.getStyles();\n    const undoData = new ObjectMatrix<Nullable<ICellData>>();\n\n    const newValues = new ObjectMatrix(cellValue);\n\n    newValues.forValue((row, col, newVal) => {\n        const cell = Tools.deepClone(cellMatrix?.getValue(row, col)) || {}; // clone cell dataprevent modify the original data\n        const oldStyle = styles.getStyleByCell(cell);\n        // transformStyle does not accept style id\n        const newStyle = styles.getStyleByCell(newVal);\n\n        cell.s = transformStyle(oldStyle, newStyle);\n\n        undoData.setValue(row, col, setNull(cell));\n    });\n\n    return {\n        ...params,\n        options: {},\n        cellValue: undoData.getMatrix(),\n    } as ISetRangeValuesMutationParams;\n};\n\nexport const SetRangeValuesMutation: IMutation<ISetRangeValuesMutationParams, boolean> = {\n    id: 'sheet.mutation.set-range-values',\n\n    type: CommandType.MUTATION,\n\n    handler: (accessor, params) => {\n        const { cellValue, subUnitId, unitId } = params;\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const workbook = univerInstanceService.getUnit<Workbook>(unitId);\n        if (!workbook) {\n            return false;\n        }\n\n        const worksheet = workbook.getSheetBySheetId(subUnitId);\n        if (!worksheet) {\n            return false;\n        }\n\n        const cellMatrix = worksheet.getCellMatrix();\n        const styles = workbook.getStyles();\n        const newValues = new ObjectMatrix(cellValue);\n\n        newValues.forValue((row, col, newVal) => {\n            // clear all\n            if (!newVal) {\n                cellMatrix?.setValue(row, col, {});\n            } else {\n                const oldVal = cellMatrix.getValue(row, col) || {};\n\n                // NOTE: we may need to take `p` into account\n                const type = getCellType(styles, newVal, oldVal);\n\n                if (newVal.f !== undefined) {\n                    oldVal.f = newVal.f;\n                }\n\n                if (newVal.si !== undefined) {\n                    oldVal.si = newVal.si;\n                }\n\n                if (newVal.p !== undefined) {\n                    oldVal.p = newVal.p;\n                }\n\n                // Set to null, clear content\n                if (newVal.v !== undefined) {\n                    oldVal.v = getCellValue(type, newVal);\n                }\n\n                if (oldVal.v !== undefined) {\n                    oldVal.t = type;\n                    // The text format may be set for the numeric cell, and cell.v needs to be converted to text\n                    oldVal.v = getCellValue(type, oldVal);\n                }\n\n                // handle style\n                if (newVal.s !== undefined) {\n                    handleStyle(styles, oldVal, newVal);\n                }\n\n                if (newVal.custom !== undefined) {\n                    // Custom will overwrite the original value\n                    oldVal.custom = newVal.custom;\n                }\n\n                cellMatrix.setValue(row, col, Tools.removeNull(oldVal));\n            }\n        });\n\n        return true;\n    },\n};\n"],"mappings":"AA2BA,SAAS,aAAa,wBAAwB,cAAc,aAAa;AACzE,SAAS,aAAa,sBAAsB;AAC5C,SAAS,mBAAmB;AAC5B,SAAS,cAAc,eAAe;AA6B/B,aAAM,oCAAoC,CAC7C,UACA,WACgC;AAChC,QAAM,EAAE,QAAQ,WAAW,UAAU,IAAI;AACzC,QAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,QAAM,WAAW,sBAAsB,uBAAuB,MAAM;AAEpE,MAAI,YAAY,MAAM;AAClB,UAAM,IAAI,MAAM,yBAAyB;AAAA,EAC7C;AAEA,QAAM,YAAY,SAAS,kBAAkB,SAAS;AACtD,MAAI,aAAa,MAAM;AACnB,UAAM,IAAI,MAAM,0BAA0B;AAAA,EAC9C;AAEA,QAAM,aAAa,UAAU,cAAc;AAC3C,QAAM,SAAS,SAAS,UAAU;AAClC,QAAM,WAAW,IAAI,aAAkC;AAEvD,QAAM,YAAY,IAAI,aAAa,SAAS;AAE5C,YAAU,SAAS,CAAC,KAAK,KAAK,WAAW;AACrC,UAAM,OAAO,MAAM,UAAU,YAAY,SAAS,KAAK,GAAG,CAAC,KAAK,CAAC;AACjE,UAAM,WAAW,OAAO,eAAe,IAAI;AAE3C,UAAM,WAAW,OAAO,eAAe,MAAM;AAE7C,SAAK,IAAI,eAAe,UAAU,QAAQ;AAE1C,aAAS,SAAS,KAAK,KAAK,QAAQ,IAAI,CAAC;AAAA,EAC7C,CAAC;AAED,SAAO;AAAA,IACH,GAAG;AAAA,IACH,SAAS,CAAC;AAAA,IACV,WAAW,SAAS,UAAU;AAAA,EAClC;AACJ;AAEO,aAAM,yBAA4E;AAAA,EACrF,IAAI;AAAA,EAEJ,MAAM,YAAY;AAAA,EAElB,SAAS,CAAC,UAAU,WAAW;AAC3B,UAAM,EAAE,WAAW,WAAW,OAAO,IAAI;AACzC,UAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,UAAM,WAAW,sBAAsB,QAAkB,MAAM;AAC/D,QAAI,CAAC,UAAU;AACX,aAAO;AAAA,IACX;AAEA,UAAM,YAAY,SAAS,kBAAkB,SAAS;AACtD,QAAI,CAAC,WAAW;AACZ,aAAO;AAAA,IACX;AAEA,UAAM,aAAa,UAAU,cAAc;AAC3C,UAAM,SAAS,SAAS,UAAU;AAClC,UAAM,YAAY,IAAI,aAAa,SAAS;AAE5C,cAAU,SAAS,CAAC,KAAK,KAAK,WAAW;AAErC,UAAI,CAAC,QAAQ;AACT,oBAAY,SAAS,KAAK,KAAK,CAAC,CAAC;AAAA,MACrC,OAAO;AACH,cAAM,SAAS,WAAW,SAAS,KAAK,GAAG,KAAK,CAAC;AAGjD,cAAM,OAAO,YAAY,QAAQ,QAAQ,MAAM;AAE/C,YAAI,OAAO,MAAM,QAAW;AACxB,iBAAO,IAAI,OAAO;AAAA,QACtB;AAEA,YAAI,OAAO,OAAO,QAAW;AACzB,iBAAO,KAAK,OAAO;AAAA,QACvB;AAEA,YAAI,OAAO,MAAM,QAAW;AACxB,iBAAO,IAAI,OAAO;AAAA,QACtB;AAGA,YAAI,OAAO,MAAM,QAAW;AACxB,iBAAO,IAAI,aAAa,MAAM,MAAM;AAAA,QACxC;AAEA,YAAI,OAAO,MAAM,QAAW;AACxB,iBAAO,IAAI;AAEX,iBAAO,IAAI,aAAa,MAAM,MAAM;AAAA,QACxC;AAGA,YAAI,OAAO,MAAM,QAAW;AACxB,sBAAY,QAAQ,QAAQ,MAAM;AAAA,QACtC;AAEA,YAAI,OAAO,WAAW,QAAW;AAE7B,iBAAO,SAAS,OAAO;AAAA,QAC3B;AAEA,mBAAW,SAAS,KAAK,KAAK,MAAM,WAAW,MAAM,CAAC;AAAA,MAC1D;AAAA,IACJ,CAAC;AAED,WAAO;AAAA,EACX;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"cac588d9ead82bf8a18e08492238887fb6b52d6a"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/sheet-interceptor/interceptor-const.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/sheet-interceptor/interceptor-const.ts","statementMap":{"0":{"start":{"line":2,"column":21},"end":{"line":2,"column":57}},"1":{"start":{"line":3,"column":21},"end":{"line":3,"column":57}},"2":{"start":{"line":4,"column":33},"end":{"line":7,"column":1}},"3":{"start":{"line":8,"column":58},"end":{"line":13,"column":38}},"4":{"start":{"line":9,"column":2},"end":{"line":9,"column":106}},"5":{"start":{"line":10,"column":2},"end":{"line":10,"column":89}},"6":{"start":{"line":11,"column":2},"end":{"line":11,"column":97}},"7":{"start":{"line":12,"column":2},"end":{"line":12,"column":39}},"8":{"start":{"line":14,"column":39},"end":{"line":14,"column":73}},"9":{"start":{"line":15,"column":46},"end":{"line":15,"column":84}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":59},"end":{"line":8,"column":60}},"loc":{"start":{"line":8,"column":94},"end":{"line":13,"column":1}},"line":8}},"branchMap":{"0":{"loc":{"start":{"line":13,"column":3},"end":{"line":13,"column":37}},"type":"binary-expr","locations":[{"start":{"line":13,"column":3},"end":{"line":13,"column":31}},{"start":{"line":13,"column":35},"end":{"line":13,"column":37}}],"line":13}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1},"f":{"0":1},"b":{"0":[1,1]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/sheet-interceptor/interceptor-const.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellData, ICellDataForSheetInterceptor, ICellInterceptor, Nullable } from '@univerjs/core';\nimport type { ISheetLocation, ISheetRowLocation } from './utils/interceptor';\n\nimport { createInterceptorKey } from '@univerjs/core';\n\nconst CELL_CONTENT = createInterceptorKey<ICellDataForSheetInterceptor, ISheetLocation & { rawData: Nullable<ICellData> }>('CELL_CONTENT') as ICellInterceptor<ICellDataForSheetInterceptor, ISheetLocation & { rawData: Nullable<ICellData> }>;\nconst ROW_FILTERED = createInterceptorKey<boolean, ISheetRowLocation>('ROW_FILTERED');\n\nexport const INTERCEPTOR_POINT = {\n    CELL_CONTENT,\n    ROW_FILTERED,\n};\n\nexport enum InterceptCellContentPriority {\n    DATA_VALIDATION = 9,\n    NUMFMT = 10,\n    CELL_IMAGE = 11,\n}\n// used for define the range theme interceptor, it will also use to ignore the range theme interceptor\nexport const RangeThemeInterceptorId = 'sheet.interceptor.range-theme-id';\n\nexport const IgnoreRangeThemeInterceptorKey = 'sheet.interceptor.ignore-range-theme';\n"],"mappings":"AAmBA,SAAS,4BAA4B;AAErC,MAAM,eAAe,qBAAsG,cAAc;AACzI,MAAM,eAAe,qBAAiD,cAAc;AAE7E,aAAM,oBAAoB;AAAA,EAC7B;AAAA,EACA;AACJ;AAEO,WAAK,+BAAL,kBAAKA,kCAAL;AACH,EAAAA,4DAAA,qBAAkB,KAAlB;AACA,EAAAA,4DAAA,YAAS,MAAT;AACA,EAAAA,4DAAA,gBAAa,MAAb;AAHQ,SAAAA;AAAA,GAAA;AAML,aAAM,0BAA0B;AAEhC,aAAM,iCAAiC;","names":["InterceptCellContentPriority"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7895c8d2e97066b0ade87500952f58c224d5f641"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/utils/selection-utils.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/utils/selection-utils.ts","statementMap":{"0":{"start":{"line":5,"column":29},"end":{"line":5,"column":96}},"1":{"start":{"line":6,"column":30},"end":{"line":6,"column":32}},"2":{"start":{"line":7,"column":2},"end":{"line":19,"column":5}},"3":{"start":{"line":8,"column":4},"end":{"line":18,"column":5}},"4":{"start":{"line":9,"column":30},"end":{"line":14,"column":7}},"5":{"start":{"line":15,"column":6},"end":{"line":17,"column":7}},"6":{"start":{"line":16,"column":8},"end":{"line":16,"column":50}},"7":{"start":{"line":20,"column":2},"end":{"line":22,"column":3}},"8":{"start":{"line":21,"column":4},"end":{"line":21,"column":22}},"9":{"start":{"line":23,"column":16},"end":{"line":23,"column":67}},"10":{"start":{"line":24,"column":2},"end":{"line":26,"column":3}},"11":{"start":{"line":25,"column":4},"end":{"line":25,"column":72}},"12":{"start":{"line":27,"column":2},"end":{"line":27,"column":15}},"13":{"start":{"line":30,"column":18},"end":{"line":30,"column":22}},"14":{"start":{"line":31,"column":17},"end":{"line":31,"column":71}},"15":{"start":{"line":32,"column":2},"end":{"line":45,"column":5}},"16":{"start":{"line":33,"column":4},"end":{"line":43,"column":6}},"17":{"start":{"line":44,"column":4},"end":{"line":44,"column":17}},"18":{"start":{"line":46,"column":2},"end":{"line":58,"column":3}},"19":{"start":{"line":47,"column":4},"end":{"line":57,"column":6}},"20":{"start":{"line":59,"column":2},"end":{"line":59,"column":19}},"21":{"start":{"line":62,"column":55},"end":{"line":62,"column":60}},"22":{"start":{"line":63,"column":2},"end":{"line":65,"column":3}},"23":{"start":{"line":64,"column":4},"end":{"line":64,"column":23}},"24":{"start":{"line":66,"column":2},"end":{"line":68,"column":3}},"25":{"start":{"line":67,"column":4},"end":{"line":67,"column":32}},"26":{"start":{"line":69,"column":2},"end":{"line":71,"column":3}},"27":{"start":{"line":70,"column":4},"end":{"line":70,"column":26}},"28":{"start":{"line":72,"column":2},"end":{"line":74,"column":3}},"29":{"start":{"line":73,"column":4},"end":{"line":73,"column":38}},"30":{"start":{"line":75,"column":2},"end":{"line":75,"column":15}},"31":{"start":{"line":78,"column":19},"end":{"line":78,"column":68}},"32":{"start":{"line":79,"column":22},"end":{"line":79,"column":77}},"33":{"start":{"line":80,"column":22},"end":{"line":80,"column":68}},"34":{"start":{"line":81,"column":2},"end":{"line":93,"column":3}},"35":{"start":{"line":82,"column":4},"end":{"line":92,"column":6}},"36":{"start":{"line":94,"column":2},"end":{"line":101,"column":4}},"37":{"start":{"line":104,"column":17},"end":{"line":104,"column":19}},"38":{"start":{"line":105,"column":2},"end":{"line":108,"column":5}},"39":{"start":{"line":106,"column":25},"end":{"line":106,"column":45}},"40":{"start":{"line":107,"column":4},"end":{"line":107,"column":28}},"41":{"start":{"line":109,"column":2},"end":{"line":109,"column":31}},"42":{"start":{"line":109,"column":24},"end":{"line":109,"column":29}},"43":{"start":{"line":110,"column":20},"end":{"line":110,"column":21}},"44":{"start":{"line":111,"column":2},"end":{"line":116,"column":3}},"45":{"start":{"line":111,"column":15},"end":{"line":111,"column":16}},"46":{"start":{"line":112,"column":18},"end":{"line":112,"column":27}},"47":{"start":{"line":113,"column":16},"end":{"line":113,"column":29}},"48":{"start":{"line":114,"column":19},"end":{"line":114,"column":30}},"49":{"start":{"line":115,"column":4},"end":{"line":115,"column":26}},"50":{"start":{"line":117,"column":2},"end":{"line":117,"column":25}},"51":{"start":{"line":119,"column":40},"end":{"line":127,"column":2}},"52":{"start":{"line":119,"column":73},"end":{"line":127,"column":1}},"53":{"start":{"line":129,"column":2},"end":{"line":131,"column":3}},"54":{"start":{"line":130,"column":4},"end":{"line":130,"column":17}},"55":{"start":{"line":132,"column":29},"end":{"line":132,"column":38}},"56":{"start":{"line":133,"column":2},"end":{"line":133,"column":42}},"57":{"start":{"line":138,"column":6},"end":{"line":145,"column":7}},"58":{"start":{"line":138,"column":19},"end":{"line":138,"column":33}},"59":{"start":{"line":139,"column":8},"end":{"line":141,"column":9}},"60":{"start":{"line":140,"column":10},"end":{"line":140,"column":19}},"61":{"start":{"line":142,"column":8},"end":{"line":144,"column":9}},"62":{"start":{"line":142,"column":21},"end":{"line":142,"column":38}},"63":{"start":{"line":143,"column":10},"end":{"line":143,"column":32}},"64":{"start":{"line":148,"column":4},"end":{"line":148,"column":20}},"65":{"start":{"line":150,"column":2},"end":{"line":152,"column":4}},"66":{"start":{"line":154,"column":42},"end":{"line":154,"column":101}},"67":{"start":{"line":154,"column":59},"end":{"line":154,"column":101}},"68":{"start":{"line":156,"column":20},"end":{"line":156,"column":22}},"69":{"start":{"line":157,"column":2},"end":{"line":168,"column":3}},"70":{"start":{"line":157,"column":17},"end":{"line":157,"column":25}},"71":{"start":{"line":158,"column":4},"end":{"line":167,"column":5}},"72":{"start":{"line":158,"column":22},"end":{"line":158,"column":33}},"73":{"start":{"line":159,"column":19},"end":{"line":159,"column":295}},"74":{"start":{"line":160,"column":6},"end":{"line":162,"column":7}},"75":{"start":{"line":161,"column":8},"end":{"line":161,"column":17}},"76":{"start":{"line":163,"column":6},"end":{"line":165,"column":7}},"77":{"start":{"line":164,"column":8},"end":{"line":164,"column":28}},"78":{"start":{"line":166,"column":6},"end":{"line":166,"column":45}},"79":{"start":{"line":169,"column":2},"end":{"line":169,"column":19}},"80":{"start":{"line":172,"column":20},"end":{"line":172,"column":22}},"81":{"start":{"line":173,"column":2},"end":{"line":195,"column":3}},"82":{"start":{"line":173,"column":17},"end":{"line":173,"column":25}},"83":{"start":{"line":174,"column":4},"end":{"line":194,"column":5}},"84":{"start":{"line":174,"column":22},"end":{"line":174,"column":33}},"85":{"start":{"line":175,"column":19},"end":{"line":175,"column":295}},"86":{"start":{"line":176,"column":6},"end":{"line":178,"column":7}},"87":{"start":{"line":177,"column":8},"end":{"line":177,"column":17}},"88":{"start":{"line":179,"column":6},"end":{"line":181,"column":7}},"89":{"start":{"line":180,"column":8},"end":{"line":180,"column":28}},"90":{"start":{"line":182,"column":6},"end":{"line":192,"column":7}},"91":{"start":{"line":183,"column":26},"end":{"line":183,"column":62}},"92":{"start":{"line":184,"column":8},"end":{"line":187,"column":9}},"93":{"start":{"line":185,"column":10},"end":{"line":185,"column":30}},"94":{"start":{"line":186,"column":10},"end":{"line":186,"column":53}},"95":{"start":{"line":189,"column":26},"end":{"line":189,"column":39}},"96":{"start":{"line":190,"column":8},"end":{"line":190,"column":28}},"97":{"start":{"line":191,"column":8},"end":{"line":191,"column":51}},"98":{"start":{"line":193,"column":6},"end":{"line":193,"column":45}},"99":{"start":{"line":196,"column":2},"end":{"line":196,"column":19}}},"fnMap":{"0":{"name":"alignToMergedCellsBorders","decl":{"start":{"line":4,"column":16},"end":{"line":4,"column":41}},"loc":{"start":{"line":4,"column":89},"end":{"line":28,"column":1}},"line":4},"1":{"name":"(anonymous_1)","decl":{"start":{"line":7,"column":30},"end":{"line":7,"column":31}},"loc":{"start":{"line":7,"column":51},"end":{"line":19,"column":3}},"line":7},"2":{"name":"getCellAtRowCol","decl":{"start":{"line":29,"column":16},"end":{"line":29,"column":31}},"loc":{"start":{"line":29,"column":53},"end":{"line":60,"column":1}},"line":29},"3":{"name":"(anonymous_3)","decl":{"start":{"line":32,"column":18},"end":{"line":32,"column":19}},"loc":{"start":{"line":32,"column":41},"end":{"line":45,"column":3}},"line":32},"4":{"name":"setEndForRange","decl":{"start":{"line":61,"column":16},"end":{"line":61,"column":30}},"loc":{"start":{"line":61,"column":61},"end":{"line":76,"column":1}},"line":61},"5":{"name":"getPrimaryForRange","decl":{"start":{"line":77,"column":16},"end":{"line":77,"column":34}},"loc":{"start":{"line":77,"column":53},"end":{"line":102,"column":1}},"line":77},"6":{"name":"calculateTotalLength","decl":{"start":{"line":103,"column":16},"end":{"line":103,"column":36}},"loc":{"start":{"line":103,"column":54},"end":{"line":118,"column":1}},"line":103},"7":{"name":"(anonymous_7)","decl":{"start":{"line":105,"column":39},"end":{"line":105,"column":40}},"loc":{"start":{"line":105,"column":48},"end":{"line":108,"column":3}},"line":105},"8":{"name":"(anonymous_8)","decl":{"start":{"line":109,"column":14},"end":{"line":109,"column":15}},"loc":{"start":{"line":109,"column":24},"end":{"line":109,"column":29}},"line":109},"9":{"name":"(anonymous_9)","decl":{"start":{"line":119,"column":40},"end":{"line":119,"column":41}},"loc":{"start":{"line":119,"column":73},"end":{"line":127,"column":1}},"line":119},"10":{"name":"isSingleCellSelection","decl":{"start":{"line":128,"column":16},"end":{"line":128,"column":37}},"loc":{"start":{"line":128,"column":49},"end":{"line":134,"column":1}},"line":128},"11":{"name":"createRangeIteratorWithSkipFilteredRows","decl":{"start":{"line":135,"column":16},"end":{"line":135,"column":55}},"loc":{"start":{"line":135,"column":63},"end":{"line":153,"column":1}},"line":135},"12":{"name":"forOperableEach","decl":{"start":{"line":136,"column":11},"end":{"line":136,"column":26}},"loc":{"start":{"line":136,"column":45},"end":{"line":149,"column":3}},"line":136},"13":{"name":"iterate","decl":{"start":{"line":137,"column":13},"end":{"line":137,"column":20}},"loc":{"start":{"line":137,"column":28},"end":{"line":146,"column":5}},"line":137},"14":{"name":"(anonymous_14)","decl":{"start":{"line":154,"column":42},"end":{"line":154,"column":43}},"loc":{"start":{"line":154,"column":59},"end":{"line":154,"column":101}},"line":154},"15":{"name":"copyRangeStyles","decl":{"start":{"line":155,"column":16},"end":{"line":155,"column":31}},"loc":{"start":{"line":155,"column":110},"end":{"line":170,"column":1}},"line":155},"16":{"name":"copyRangeStylesWithoutBorder","decl":{"start":{"line":171,"column":16},"end":{"line":171,"column":44}},"loc":{"start":{"line":171,"column":123},"end":{"line":197,"column":1}},"line":171}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":65},"end":{"line":4,"column":87}},"type":"default-arg","locations":[{"start":{"line":4,"column":83},"end":{"line":4,"column":87}}],"line":4},"1":{"loc":{"start":{"line":8,"column":4},"end":{"line":18,"column":5}},"type":"if","locations":[{"start":{"line":8,"column":4},"end":{"line":18,"column":5}},{"start":{},"end":{}}],"line":8},"2":{"loc":{"start":{"line":8,"column":8},"end":{"line":8,"column":60}},"type":"binary-expr","locations":[{"start":{"line":8,"column":8},"end":{"line":8,"column":32}},{"start":{"line":8,"column":36},"end":{"line":8,"column":60}}],"line":8},"3":{"loc":{"start":{"line":15,"column":6},"end":{"line":17,"column":7}},"type":"if","locations":[{"start":{"line":15,"column":6},"end":{"line":17,"column":7}},{"start":{},"end":{}}],"line":15},"4":{"loc":{"start":{"line":20,"column":2},"end":{"line":22,"column":3}},"type":"if","locations":[{"start":{"line":20,"column":2},"end":{"line":22,"column":3}},{"start":{},"end":{}}],"line":20},"5":{"loc":{"start":{"line":24,"column":2},"end":{"line":26,"column":3}},"type":"if","locations":[{"start":{"line":24,"column":2},"end":{"line":26,"column":3}},{"start":{},"end":{}}],"line":24},"6":{"loc":{"start":{"line":38,"column":16},"end":{"line":38,"column":68}},"type":"binary-expr","locations":[{"start":{"line":38,"column":16},"end":{"line":38,"column":40}},{"start":{"line":38,"column":44},"end":{"line":38,"column":68}}],"line":38},"7":{"loc":{"start":{"line":39,"column":24},"end":{"line":39,"column":76}},"type":"binary-expr","locations":[{"start":{"line":39,"column":24},"end":{"line":39,"column":48}},{"start":{"line":39,"column":52},"end":{"line":39,"column":76}}],"line":39},"8":{"loc":{"start":{"line":40,"column":22},"end":{"line":40,"column":70}},"type":"cond-expr","locations":[{"start":{"line":40,"column":49},"end":{"line":40,"column":66}},{"start":{"line":40,"column":69},"end":{"line":40,"column":70}}],"line":40},"9":{"loc":{"start":{"line":41,"column":25},"end":{"line":41,"column":73}},"type":"cond-expr","locations":[{"start":{"line":41,"column":52},"end":{"line":41,"column":69}},{"start":{"line":41,"column":72},"end":{"line":41,"column":73}}],"line":41},"10":{"loc":{"start":{"line":46,"column":2},"end":{"line":58,"column":3}},"type":"if","locations":[{"start":{"line":46,"column":2},"end":{"line":58,"column":3}},{"start":{},"end":{}}],"line":46},"11":{"loc":{"start":{"line":63,"column":2},"end":{"line":65,"column":3}},"type":"if","locations":[{"start":{"line":63,"column":2},"end":{"line":65,"column":3}},{"start":{},"end":{}}],"line":63},"12":{"loc":{"start":{"line":66,"column":2},"end":{"line":68,"column":3}},"type":"if","locations":[{"start":{"line":66,"column":2},"end":{"line":68,"column":3}},{"start":{},"end":{}}],"line":66},"13":{"loc":{"start":{"line":69,"column":2},"end":{"line":71,"column":3}},"type":"if","locations":[{"start":{"line":69,"column":2},"end":{"line":71,"column":3}},{"start":{},"end":{}}],"line":69},"14":{"loc":{"start":{"line":72,"column":2},"end":{"line":74,"column":3}},"type":"if","locations":[{"start":{"line":72,"column":2},"end":{"line":74,"column":3}},{"start":{},"end":{}}],"line":72},"15":{"loc":{"start":{"line":78,"column":19},"end":{"line":78,"column":68}},"type":"cond-expr","locations":[{"start":{"line":78,"column":50},"end":{"line":78,"column":51}},{"start":{"line":78,"column":54},"end":{"line":78,"column":68}}],"line":78},"16":{"loc":{"start":{"line":79,"column":22},"end":{"line":79,"column":77}},"type":"cond-expr","locations":[{"start":{"line":79,"column":56},"end":{"line":79,"column":57}},{"start":{"line":79,"column":60},"end":{"line":79,"column":77}}],"line":79},"17":{"loc":{"start":{"line":81,"column":2},"end":{"line":93,"column":3}},"type":"if","locations":[{"start":{"line":81,"column":2},"end":{"line":93,"column":3}},{"start":{},"end":{}}],"line":81},"18":{"loc":{"start":{"line":129,"column":2},"end":{"line":131,"column":3}},"type":"if","locations":[{"start":{"line":129,"column":2},"end":{"line":131,"column":3}},{"start":{},"end":{}}],"line":129},"19":{"loc":{"start":{"line":139,"column":8},"end":{"line":141,"column":9}},"type":"if","locations":[{"start":{"line":139,"column":8},"end":{"line":141,"column":9}},{"start":{},"end":{}}],"line":139},"20":{"loc":{"start":{"line":159,"column":19},"end":{"line":159,"column":295}},"type":"cond-expr","locations":[{"start":{"line":159,"column":27},"end":{"line":159,"column":161}},{"start":{"line":159,"column":164},"end":{"line":159,"column":295}}],"line":159},"21":{"loc":{"start":{"line":160,"column":6},"end":{"line":162,"column":7}},"type":"if","locations":[{"start":{"line":160,"column":6},"end":{"line":162,"column":7}},{"start":{},"end":{}}],"line":160},"22":{"loc":{"start":{"line":160,"column":10},"end":{"line":160,"column":26}},"type":"binary-expr","locations":[{"start":{"line":160,"column":10},"end":{"line":160,"column":15}},{"start":{"line":160,"column":19},"end":{"line":160,"column":26}}],"line":160},"23":{"loc":{"start":{"line":163,"column":6},"end":{"line":165,"column":7}},"type":"if","locations":[{"start":{"line":163,"column":6},"end":{"line":165,"column":7}},{"start":{},"end":{}}],"line":163},"24":{"loc":{"start":{"line":175,"column":19},"end":{"line":175,"column":295}},"type":"cond-expr","locations":[{"start":{"line":175,"column":27},"end":{"line":175,"column":161}},{"start":{"line":175,"column":164},"end":{"line":175,"column":295}}],"line":175},"25":{"loc":{"start":{"line":176,"column":6},"end":{"line":178,"column":7}},"type":"if","locations":[{"start":{"line":176,"column":6},"end":{"line":178,"column":7}},{"start":{},"end":{}}],"line":176},"26":{"loc":{"start":{"line":176,"column":10},"end":{"line":176,"column":26}},"type":"binary-expr","locations":[{"start":{"line":176,"column":10},"end":{"line":176,"column":15}},{"start":{"line":176,"column":19},"end":{"line":176,"column":26}}],"line":176},"27":{"loc":{"start":{"line":179,"column":6},"end":{"line":181,"column":7}},"type":"if","locations":[{"start":{"line":179,"column":6},"end":{"line":181,"column":7}},{"start":{},"end":{}}],"line":179},"28":{"loc":{"start":{"line":182,"column":6},"end":{"line":192,"column":7}},"type":"if","locations":[{"start":{"line":182,"column":6},"end":{"line":192,"column":7}},{"start":{"line":188,"column":13},"end":{"line":192,"column":7}}],"line":182},"29":{"loc":{"start":{"line":184,"column":8},"end":{"line":187,"column":9}},"type":"if","locations":[{"start":{"line":184,"column":8},"end":{"line":187,"column":9}},{"start":{},"end":{}}],"line":184}},"s":{"0":2,"1":2,"2":2,"3":4,"4":0,"5":0,"6":0,"7":2,"8":2,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":2,"32":2,"33":2,"34":2,"35":2,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":1,"52":2,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":1,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0},"f":{"0":2,"1":4,"2":0,"3":0,"4":0,"5":2,"6":0,"7":0,"8":0,"9":2,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"b":{"0":[0],"1":[0,4],"2":[4,0],"3":[0,0],"4":[2,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,2],"16":[0,2],"17":[2,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/utils/selection-utils.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellData, IInterceptor, IObjectMatrixPrimitiveType, IRange, ISelectionCell, Nullable, Workbook, Worksheet } from '@univerjs/core';\nimport type { ISelectionWithStyle } from '../../../basics/selection';\n\nimport type { ISetSelectionsOperationParams } from '../../operations/selection.operation';\nimport { RANGE_TYPE, Rectangle, selectionToArray } from '@univerjs/core';\nimport { IgnoreRangeThemeInterceptorKey, RangeThemeInterceptorId } from '../../../services/sheet-interceptor/interceptor-const';\nimport { SetSelectionsOperation } from '../../operations/selection.operation';\n\nexport interface IExpandParams {\n    left?: boolean;\n    right?: boolean;\n    up?: boolean;\n    down?: boolean;\n}\n\n/**\n * Adjust the range to align merged cell's borders.\n */\nexport function alignToMergedCellsBorders(startRange: IRange, worksheet: Worksheet, shouldRecursive = true) {\n    const coveredMergedCells = worksheet.getMatrixWithMergedCells(...selectionToArray(startRange));\n    const exceededMergedCells: IRange[] = [];\n\n    coveredMergedCells.forValue((row, col, value) => {\n        if (value.colSpan !== undefined && value.rowSpan !== undefined) {\n            const mergedCellRange = {\n                startRow: row,\n                startColumn: col,\n                endRow: row + value.rowSpan! - 1,\n                endColumn: col + value.colSpan! - 1,\n            };\n\n            if (!Rectangle.contains(startRange, mergedCellRange)) {\n                exceededMergedCells.push(mergedCellRange);\n            }\n        }\n    });\n\n    if (exceededMergedCells.length === 0) {\n        return startRange;\n    }\n\n    const union = Rectangle.union(startRange, ...exceededMergedCells);\n    if (shouldRecursive) {\n        return alignToMergedCellsBorders(union, worksheet, shouldRecursive);\n    }\n    return union;\n}\n\nexport function getCellAtRowCol(row: number, col: number, worksheet: Worksheet): ISelectionCell {\n    let destRange: ISelectionCell | null = null;\n\n    const matrix = worksheet.getMatrixWithMergedCells(row, col, row, col);\n    matrix.forValue((row, col, value) => {\n        destRange = {\n            actualRow: row,\n            actualColumn: col,\n            startRow: row,\n            startColumn: col,\n            isMerged: value.rowSpan !== undefined || value.colSpan !== undefined,\n            isMergedMainCell: value.rowSpan !== undefined && value.colSpan !== undefined,\n            endRow: row + (value.rowSpan !== undefined ? value.rowSpan - 1 : 0),\n            endColumn: col + (value.colSpan !== undefined ? value.colSpan - 1 : 0),\n            rangeType: RANGE_TYPE.NORMAL,\n        };\n\n        return false;\n    });\n\n    if (!destRange) {\n        return {\n            actualColumn: col,\n            actualRow: row,\n            startRow: row,\n            startColumn: col,\n            endRow: row,\n            endColumn: col,\n            isMerged: false,\n            isMergedMainCell: false,\n            rangeType: RANGE_TYPE.NORMAL,\n        };\n    }\n\n    return destRange;\n}\n\nexport function setEndForRange(range: IRange, rowCount: number, columnCount: number) {\n    const { startRow, startColumn, endRow, endColumn } = range;\n\n    if (Number.isNaN(startRow)) {\n        range.startRow = 0;\n    }\n\n    if (Number.isNaN(endRow)) {\n        range.endRow = rowCount - 1;\n    }\n\n    if (Number.isNaN(startColumn)) {\n        range.startColumn = 0;\n    }\n\n    if (Number.isNaN(endColumn)) {\n        range.endColumn = columnCount - 1;\n    }\n\n    return range;\n}\n\n/**\n * Get the default primary cell (the most top-left cell) of a range.\n * @param range\n * @param worksheet\n */\nexport function getPrimaryForRange(range: IRange, worksheet: Worksheet): ISelectionCell {\n    const startRow = Number.isNaN(range.startRow) ? 0 : range.startRow;\n    const startColumn = Number.isNaN(range.startColumn) ? 0 : range.startColumn;\n    const mergedRange = worksheet.getMergedCell(startRow, startColumn);\n    if (!mergedRange) {\n        return {\n            startRow,\n            startColumn,\n            endRow: range.startRow,\n            endColumn: range.startColumn,\n            actualRow: startRow,\n            actualColumn: startColumn,\n            rangeType: RANGE_TYPE.NORMAL,\n            isMerged: false,\n            isMergedMainCell: false,\n        };\n    }\n\n    return {\n        ...mergedRange,\n        actualRow: startRow,\n        actualColumn: startColumn,\n        rangeType: RANGE_TYPE.NORMAL,\n        isMerged: true,\n        isMergedMainCell: true,\n    };\n}\n\nexport interface IInterval {\n    [index: string]: [start: number, end: number];\n}\n\n/**\n * Calculate the real length of the intervals\n * @param intervalsObject\n * @returns\n */\nexport function calculateTotalLength(intervalsObject: IInterval): number {\n    const points: number[] = [];\n\n    // Put the start and end points of the interval into the points array\n\n    Object.keys(intervalsObject).forEach((key: string) => {\n        const [start, end] = intervalsObject[key];\n        points.push(start, end);\n    });\n\n    // Sort the points array\n    points.sort((a, b) => a - b);\n\n    let totalLength = 0;\n    for (let i = 0; i < points.length - 1; i++) {\n        const start = points[i];\n        const end = points[i + 1];\n        const length = end - start;\n        totalLength += length;\n    }\n\n    return totalLength + 1;\n}\n\nexport const followSelectionOperation = (range: IRange, workbook: Workbook, worksheet: Worksheet) => ({\n    id: SetSelectionsOperation.id,\n    params: {\n        unitId: workbook.getUnitId(),\n        subUnitId: worksheet.getSheetId(),\n        reveal: true,\n        selections: [{ range, primary: getPrimaryForRange(range, worksheet) }],\n    } as ISetSelectionsOperationParams,\n});\n\n/**\n * Examine if a selection only contains a single cell (a merged cell is considered as a single cell in this case).\n * @param selection\n * @returns `true` if the selection only contains a single cell.\n */\nexport function isSingleCellSelection(selection: Nullable<ISelectionWithStyle & { primary: ISelectionCell }>): boolean {\n    if (!selection) {\n        return false;\n    }\n\n    const { range, primary } = selection;\n    return Rectangle.equals(range, primary);\n}\n/**\n * Create an iterator to iterate over cells in range.\n * It will skip the row that has been filtered.\n * @param sheet bind a sheet\n * @returns iterator\n */\nexport function createRangeIteratorWithSkipFilteredRows(sheet: Worksheet) {\n    function forOperableEach(ranges: IRange, operator: (row: number, col: number, range: IRange) => void) {\n        function iterate(range: IRange) {\n            for (let r = range.startRow; r <= range.endRow; r++) {\n                if (sheet.getRowFiltered(r)) {\n                    continue;\n                }\n                for (let c = range.startColumn; c <= range.endColumn; c++) {\n                    operator(r, c, range);\n                }\n            }\n        };\n        iterate(ranges);\n    }\n    return {\n        forOperableEach,\n    };\n}\n\nconst ignoreRangeThemeInterceptorFilter = (interceptor: IInterceptor<unknown, unknown>) => interceptor.id !== RangeThemeInterceptorId;\n\n/**\n * Copy the styles of a range of cells to another range. Used for insert row and insert column.\n * @param worksheet\n * @param startRow\n * @param endRow\n * @param startColumn\n * @param endColumn\n * @param isRow\n * @param sourceRangeIndex\n */\nexport function copyRangeStyles(\n    worksheet: Worksheet,\n    startRow: number,\n    endRow: number,\n    startColumn: number,\n    endColumn: number,\n    isRow: boolean,\n    sourceRangeIndex: number\n): IObjectMatrixPrimitiveType<ICellData> {\n    const cellValue: IObjectMatrixPrimitiveType<ICellData> = {};\n    for (let row = startRow; row <= endRow; row++) {\n        for (let column = startColumn; column <= endColumn; column++) {\n            const cell = isRow ?\n                worksheet.getCellWithFilteredInterceptors(sourceRangeIndex, column, IgnoreRangeThemeInterceptorKey, ignoreRangeThemeInterceptorFilter)\n                : worksheet.getCellWithFilteredInterceptors(row, sourceRangeIndex, IgnoreRangeThemeInterceptorKey, ignoreRangeThemeInterceptorFilter);\n\n            if (!cell || !cell.s) {\n                continue;\n            }\n            if (!cellValue[row]) {\n                cellValue[row] = {};\n            }\n            cellValue[row][column] = { s: cell.s };\n        }\n    }\n    return cellValue;\n}\n\nexport function copyRangeStylesWithoutBorder(\n    worksheet: Worksheet,\n    startRow: number,\n    endRow: number,\n    startColumn: number,\n    endColumn: number,\n    isRow: boolean,\n    styleRowOrColumn: number\n): IObjectMatrixPrimitiveType<ICellData> {\n    const cellValue: IObjectMatrixPrimitiveType<ICellData> = {};\n    for (let row = startRow; row <= endRow; row++) {\n        for (let column = startColumn; column <= endColumn; column++) {\n            const cell = isRow\n                ? worksheet.getCellWithFilteredInterceptors(styleRowOrColumn, column, IgnoreRangeThemeInterceptorKey, ignoreRangeThemeInterceptorFilter)\n                : worksheet.getCellWithFilteredInterceptors(row, styleRowOrColumn, IgnoreRangeThemeInterceptorKey, ignoreRangeThemeInterceptorFilter);\n\n            if (!cell || !cell.s) {\n                continue;\n            }\n            if (!cellValue[row]) {\n                cellValue[row] = {};\n            }\n\n            // univer-pro/issues/3016  insert row/column should not reuse border style\n            if (typeof cell.s === 'string') {\n                const styleData = worksheet.getStyleDataByHash(cell.s);\n                if (styleData) {\n                    delete styleData.bd;\n                    cell.s = worksheet.setStyleData(styleData);\n                }\n            } else {\n                const styleData = { ...cell.s };\n                delete styleData.bd;\n                cell.s = worksheet.setStyleData(styleData);\n            }\n            cellValue[row][column] = { s: cell.s };\n        }\n    }\n    return cellValue;\n}\n"],"mappings":"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","names":["row","col"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"64d079424728a5fd2c1812357554b6d105798e81"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/utils/target-util.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/utils/target-util.ts","statementMap":{"0":{"start":{"line":3,"column":21},"end":{"line":3,"column":27}},"1":{"start":{"line":4,"column":19},"end":{"line":4,"column":159}},"2":{"start":{"line":5,"column":2},"end":{"line":5,"column":29}},"3":{"start":{"line":5,"column":17},"end":{"line":5,"column":29}},"4":{"start":{"line":6,"column":2},"end":{"line":9,"column":4}},"5":{"start":{"line":12,"column":32},"end":{"line":12,"column":38}},"6":{"start":{"line":13,"column":19},"end":{"line":13,"column":159}},"7":{"start":{"line":14,"column":2},"end":{"line":14,"column":29}},"8":{"start":{"line":14,"column":17},"end":{"line":14,"column":29}},"9":{"start":{"line":15,"column":20},"end":{"line":15,"column":101}},"10":{"start":{"line":16,"column":2},"end":{"line":18,"column":3}},"11":{"start":{"line":17,"column":4},"end":{"line":17,"column":16}},"12":{"start":{"line":19,"column":2},"end":{"line":24,"column":4}},"13":{"start":{"line":27,"column":32},"end":{"line":27,"column":38}},"14":{"start":{"line":28,"column":19},"end":{"line":28,"column":71}},"15":{"start":{"line":29,"column":2},"end":{"line":29,"column":29}},"16":{"start":{"line":29,"column":17},"end":{"line":29,"column":29}},"17":{"start":{"line":30,"column":20},"end":{"line":30,"column":57}},"18":{"start":{"line":31,"column":2},"end":{"line":33,"column":3}},"19":{"start":{"line":32,"column":4},"end":{"line":32,"column":16}},"20":{"start":{"line":34,"column":2},"end":{"line":37,"column":4}}},"fnMap":{"0":{"name":"getSheetCommandTargetWorkbook","decl":{"start":{"line":2,"column":16},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":77},"end":{"line":10,"column":1}},"line":2},"1":{"name":"getSheetCommandTarget","decl":{"start":{"line":11,"column":16},"end":{"line":11,"column":37}},"loc":{"start":{"line":11,"column":74},"end":{"line":25,"column":1}},"line":11},"2":{"name":"getSheetMutationTarget","decl":{"start":{"line":26,"column":16},"end":{"line":26,"column":38}},"loc":{"start":{"line":26,"column":70},"end":{"line":38,"column":1}},"line":26}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":19},"end":{"line":4,"column":159}},"type":"cond-expr","locations":[{"start":{"line":4,"column":28},"end":{"line":4,"column":80}},{"start":{"line":4,"column":83},"end":{"line":4,"column":159}}],"line":4},"1":{"loc":{"start":{"line":5,"column":2},"end":{"line":5,"column":29}},"type":"if","locations":[{"start":{"line":5,"column":2},"end":{"line":5,"column":29}},{"start":{},"end":{}}],"line":5},"2":{"loc":{"start":{"line":11,"column":61},"end":{"line":11,"column":72}},"type":"default-arg","locations":[{"start":{"line":11,"column":70},"end":{"line":11,"column":72}}],"line":11},"3":{"loc":{"start":{"line":13,"column":19},"end":{"line":13,"column":159}},"type":"cond-expr","locations":[{"start":{"line":13,"column":28},"end":{"line":13,"column":80}},{"start":{"line":13,"column":83},"end":{"line":13,"column":159}}],"line":13},"4":{"loc":{"start":{"line":14,"column":2},"end":{"line":14,"column":29}},"type":"if","locations":[{"start":{"line":14,"column":2},"end":{"line":14,"column":29}},{"start":{},"end":{}}],"line":14},"5":{"loc":{"start":{"line":15,"column":20},"end":{"line":15,"column":101}},"type":"cond-expr","locations":[{"start":{"line":15,"column":32},"end":{"line":15,"column":69}},{"start":{"line":15,"column":72},"end":{"line":15,"column":101}}],"line":15},"6":{"loc":{"start":{"line":16,"column":2},"end":{"line":18,"column":3}},"type":"if","locations":[{"start":{"line":16,"column":2},"end":{"line":18,"column":3}},{"start":{},"end":{}}],"line":16},"7":{"loc":{"start":{"line":29,"column":2},"end":{"line":29,"column":29}},"type":"if","locations":[{"start":{"line":29,"column":2},"end":{"line":29,"column":29}},{"start":{},"end":{}}],"line":29},"8":{"loc":{"start":{"line":31,"column":2},"end":{"line":33,"column":3}},"type":"if","locations":[{"start":{"line":31,"column":2},"end":{"line":33,"column":3}},{"start":{},"end":{}}],"line":31}},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":4,"6":4,"7":4,"8":0,"9":4,"10":4,"11":0,"12":4,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},"f":{"0":0,"1":4,"2":0},"b":{"0":[0,0],"1":[0,0],"2":[4],"3":[0,4],"4":[0,4],"5":[0,4],"6":[0,4],"7":[0,0],"8":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/utils/target-util.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type IUniverInstanceService, type Nullable, UniverInstanceType, type Workbook, type Worksheet } from '@univerjs/core';\n\nexport function getSheetCommandTargetWorkbook(univerInstanceService: IUniverInstanceService, params: { unitId?: string }): Nullable<{\n    workbook: Workbook;\n    unitId: string;\n}> {\n    const { unitId } = params;\n    const workbook = unitId\n        ? univerInstanceService.getUniverSheetInstance(unitId)\n        : univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n\n    if (!workbook) return null;\n\n    return {\n        workbook,\n        unitId: workbook.getUnitId(),\n    };\n}\n\nexport interface IResult {\n    workbook: Workbook;\n    worksheet: Worksheet;\n    unitId: string;\n    subUnitId: string;\n}\n\n/**\n * Get targeted Workbook & Worksheet of a command. If `unitId` and `subUnitId` are given, the function would\n * try to get these instances. If not, it would try to get the current active instances.\n *\n * @param univerInstanceService\n * @param params - unitId and subUnitId\n * @param params.unitId - The unitId of the Workbook\n * @param params.subUnitId - The subUnitId of the Worksheet\n * @returns Targeted Workbook & Worksheet\n */\nexport function getSheetCommandTarget(univerInstanceService: IUniverInstanceService, params: { unitId?: string; subUnitId?: string } = {}): Nullable<IResult> {\n    const { unitId, subUnitId } = params;\n\n    const workbook = unitId\n        ? univerInstanceService.getUniverSheetInstance(unitId)\n        : univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    if (!workbook) return null;\n\n    const worksheet = subUnitId ? workbook.getSheetBySheetId(subUnitId) : workbook.getActiveSheet(true);\n    if (!worksheet) {\n        return null;\n    }\n\n    return {\n        worksheet,\n        workbook,\n        unitId: workbook.getUnitId(),\n        subUnitId: worksheet.getSheetId(),\n    };\n}\n\nexport function getSheetMutationTarget(univerInstanceService: IUniverInstanceService, params: { unitId: string; subUnitId: string }): Nullable<Pick<IResult, 'workbook' | 'worksheet'>> {\n    const { unitId, subUnitId } = params;\n\n    const workbook = univerInstanceService.getUniverSheetInstance(unitId);\n    if (!workbook) return null;\n\n    const worksheet = workbook.getSheetBySheetId(subUnitId);\n    if (!worksheet) {\n        return null;\n    }\n\n    return {\n        worksheet,\n        workbook,\n    };\n}\n"],"mappings":"AAgBA,SAAqD,0BAAyD;AAEvG,gBAAS,8BAA8B,uBAA+C,QAG1F;AACC,QAAM,EAAE,OAAO,IAAI;AACnB,QAAM,WAAW,SACX,sBAAsB,uBAAuB,MAAM,IACnD,sBAAsB,sBAAgC,mBAAmB,YAAY;AAE3F,MAAI,CAAC,SAAU,QAAO;AAEtB,SAAO;AAAA,IACH;AAAA,IACA,QAAQ,SAAS,UAAU;AAAA,EAC/B;AACJ;AAmBO,gBAAS,sBAAsB,uBAA+C,SAAkD,CAAC,GAAsB;AAC1J,QAAM,EAAE,QAAQ,UAAU,IAAI;AAE9B,QAAM,WAAW,SACX,sBAAsB,uBAAuB,MAAM,IACnD,sBAAsB,sBAAgC,mBAAmB,YAAY;AAC3F,MAAI,CAAC,SAAU,QAAO;AAEtB,QAAM,YAAY,YAAY,SAAS,kBAAkB,SAAS,IAAI,SAAS,eAAe,IAAI;AAClG,MAAI,CAAC,WAAW;AACZ,WAAO;AAAA,EACX;AAEA,SAAO;AAAA,IACH;AAAA,IACA;AAAA,IACA,QAAQ,SAAS,UAAU;AAAA,IAC3B,WAAW,UAAU,WAAW;AAAA,EACpC;AACJ;AAEO,gBAAS,uBAAuB,uBAA+C,QAAkG;AACpL,QAAM,EAAE,QAAQ,UAAU,IAAI;AAE9B,QAAM,WAAW,sBAAsB,uBAAuB,MAAM;AACpE,MAAI,CAAC,SAAU,QAAO;AAEtB,QAAM,YAAY,SAAS,kBAAkB,SAAS;AACtD,MAAI,CAAC,WAAW;AACZ,WAAO;AAAA,EACX;AAEA,SAAO;AAAA,IACH;AAAA,IACA;AAAA,EACJ;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"80d2c4ddf9c0f11306f8b30b3ff160bf961cfc34"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/ref-selections.service.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/ref-selections.service.ts","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":37}},"1":{"start":{"line":2,"column":23},"end":{"line":2,"column":54}},"2":{"start":{"line":3,"column":22},"end":{"line":10,"column":1}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"4":{"start":{"line":5,"column":2},"end":{"line":7,"column":85}},"5":{"start":{"line":5,"column":15},"end":{"line":5,"column":36}},"6":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"7":{"start":{"line":7,"column":6},"end":{"line":7,"column":85}},"8":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"9":{"start":{"line":8,"column":22},"end":{"line":8,"column":53}},"10":{"start":{"line":9,"column":2},"end":{"line":9,"column":16}},"11":{"start":{"line":11,"column":22},"end":{"line":11,"column":90}},"12":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"13":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"14":{"start":{"line":15,"column":37},"end":{"line":15,"column":94}},"15":{"start":{"line":16,"column":34},"end":{"line":41,"column":1}},"16":{"start":{"line":18,"column":4},"end":{"line":18,"column":24}},"17":{"start":{"line":21,"column":14},"end":{"line":21,"column":71}},"18":{"start":{"line":22,"column":4},"end":{"line":22,"column":105}},"19":{"start":{"line":22,"column":56},"end":{"line":22,"column":102}},"20":{"start":{"line":22,"column":79},"end":{"line":22,"column":100}},"21":{"start":{"line":23,"column":4},"end":{"line":23,"column":99}},"22":{"start":{"line":23,"column":53},"end":{"line":23,"column":96}},"23":{"start":{"line":23,"column":76},"end":{"line":23,"column":94}},"24":{"start":{"line":24,"column":4},"end":{"line":24,"column":101}},"25":{"start":{"line":24,"column":54},"end":{"line":24,"column":98}},"26":{"start":{"line":24,"column":77},"end":{"line":24,"column":96}},"27":{"start":{"line":25,"column":4},"end":{"line":25,"column":93}},"28":{"start":{"line":25,"column":50},"end":{"line":25,"column":90}},"29":{"start":{"line":25,"column":73},"end":{"line":25,"column":88}},"30":{"start":{"line":28,"column":27},"end":{"line":28,"column":96}},"31":{"start":{"line":29,"column":4},"end":{"line":29,"column":94}},"32":{"start":{"line":29,"column":41},"end":{"line":29,"column":92}},"33":{"start":{"line":30,"column":23},"end":{"line":30,"column":58}},"34":{"start":{"line":31,"column":4},"end":{"line":34,"column":8}},"35":{"start":{"line":32,"column":6},"end":{"line":32,"column":58}},"36":{"start":{"line":33,"column":6},"end":{"line":33,"column":60}},"37":{"start":{"line":35,"column":4},"end":{"line":38,"column":8}},"38":{"start":{"line":36,"column":6},"end":{"line":36,"column":58}},"39":{"start":{"line":37,"column":6},"end":{"line":37,"column":81}},"40":{"start":{"line":37,"column":61},"end":{"line":37,"column":78}},"41":{"start":{"line":39,"column":4},"end":{"line":39,"column":115}},"42":{"start":{"line":39,"column":46},"end":{"line":39,"column":112}},"43":{"start":{"line":39,"column":67},"end":{"line":39,"column":111}},"44":{"start":{"line":42,"column":0},"end":{"line":44,"column":25}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":22},"end":{"line":3,"column":23}},"loc":{"start":{"line":3,"column":57},"end":{"line":10,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":44},"end":{"line":11,"column":45}},"loc":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":17,"column":2},"end":{"line":17,"column":3}},"loc":{"start":{"line":17,"column":28},"end":{"line":19,"column":3}},"line":17},"4":{"name":"(anonymous_4)","decl":{"start":{"line":20,"column":2},"end":{"line":20,"column":3}},"loc":{"start":{"line":20,"column":10},"end":{"line":26,"column":3}},"line":20},"5":{"name":"(anonymous_5)","decl":{"start":{"line":22,"column":48},"end":{"line":22,"column":49}},"loc":{"start":{"line":22,"column":56},"end":{"line":22,"column":102}},"line":22},"6":{"name":"(anonymous_6)","decl":{"start":{"line":22,"column":72},"end":{"line":22,"column":73}},"loc":{"start":{"line":22,"column":79},"end":{"line":22,"column":100}},"line":22},"7":{"name":"(anonymous_7)","decl":{"start":{"line":23,"column":45},"end":{"line":23,"column":46}},"loc":{"start":{"line":23,"column":53},"end":{"line":23,"column":96}},"line":23},"8":{"name":"(anonymous_8)","decl":{"start":{"line":23,"column":69},"end":{"line":23,"column":70}},"loc":{"start":{"line":23,"column":76},"end":{"line":23,"column":94}},"line":23},"9":{"name":"(anonymous_9)","decl":{"start":{"line":24,"column":46},"end":{"line":24,"column":47}},"loc":{"start":{"line":24,"column":54},"end":{"line":24,"column":98}},"line":24},"10":{"name":"(anonymous_10)","decl":{"start":{"line":24,"column":70},"end":{"line":24,"column":71}},"loc":{"start":{"line":24,"column":77},"end":{"line":24,"column":96}},"line":24},"11":{"name":"(anonymous_11)","decl":{"start":{"line":25,"column":42},"end":{"line":25,"column":43}},"loc":{"start":{"line":25,"column":50},"end":{"line":25,"column":90}},"line":25},"12":{"name":"(anonymous_12)","decl":{"start":{"line":25,"column":66},"end":{"line":25,"column":67}},"loc":{"start":{"line":25,"column":73},"end":{"line":25,"column":88}},"line":25},"13":{"name":"(anonymous_13)","decl":{"start":{"line":27,"column":2},"end":{"line":27,"column":3}},"loc":{"start":{"line":27,"column":24},"end":{"line":40,"column":3}},"line":27},"14":{"name":"(anonymous_14)","decl":{"start":{"line":29,"column":27},"end":{"line":29,"column":28}},"loc":{"start":{"line":29,"column":41},"end":{"line":29,"column":92}},"line":29},"15":{"name":"(anonymous_15)","decl":{"start":{"line":31,"column":104},"end":{"line":31,"column":105}},"loc":{"start":{"line":31,"column":118},"end":{"line":34,"column":5}},"line":31},"16":{"name":"(anonymous_16)","decl":{"start":{"line":35,"column":107},"end":{"line":35,"column":108}},"loc":{"start":{"line":35,"column":121},"end":{"line":38,"column":5}},"line":35},"17":{"name":"(anonymous_17)","decl":{"start":{"line":37,"column":51},"end":{"line":37,"column":52}},"loc":{"start":{"line":37,"column":61},"end":{"line":37,"column":78}},"line":37},"18":{"name":"(anonymous_18)","decl":{"start":{"line":39,"column":31},"end":{"line":39,"column":32}},"loc":{"start":{"line":39,"column":46},"end":{"line":39,"column":112}},"line":39},"19":{"name":"(anonymous_19)","decl":{"start":{"line":39,"column":60},"end":{"line":39,"column":61}},"loc":{"start":{"line":39,"column":67},"end":{"line":39,"column":111}},"line":39}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":26},"end":{"line":4,"column":32}},{"start":{"line":4,"column":35},"end":{"line":4,"column":80}}],"line":4},"1":{"loc":{"start":{"line":4,"column":35},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":42},"end":{"line":4,"column":71}},{"start":{"line":4,"column":74},"end":{"line":4,"column":80}}],"line":4},"2":{"loc":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"type":"if","locations":[{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},{"start":{},"end":{}}],"line":6},"3":{"loc":{"start":{"line":7,"column":15},"end":{"line":7,"column":84}},"type":"binary-expr","locations":[{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},{"start":{"line":7,"column":78},"end":{"line":7,"column":84}}],"line":7},"4":{"loc":{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},"type":"cond-expr","locations":[{"start":{"line":7,"column":23},"end":{"line":7,"column":53}},{"start":{"line":7,"column":56},"end":{"line":7,"column":73}}],"line":7},"5":{"loc":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},{"start":{},"end":{}}],"line":8},"6":{"loc":{"start":{"line":8,"column":6},"end":{"line":8,"column":20}},"type":"binary-expr","locations":[{"start":{"line":8,"column":6},"end":{"line":8,"column":10}},{"start":{"line":8,"column":14},"end":{"line":8,"column":20}}],"line":8}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":1},"f":{"0":1,"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},"b":{"0":[0,1],"1":[0,1],"2":[1,0],"3":[1,1],"4":[0,1],"5":[0,1],"6":[1,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/selections/ref-selections.service.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport type { Observable } from 'rxjs';\nimport type { WorkbookSelectionModel } from './selection-data-model';\nimport { createIdentifier, IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport { BehaviorSubject, map, merge, switchMap, takeUntil } from 'rxjs';\nimport { SheetsSelectionsService } from './selection.service';\n\n/**\n * Ref selections service reuses code of `SelectionManagerService`. And it only contains ref selections\n * when user is editing formula.\n *\n * Its data should be cleared by the caller quit editing formula and reconstructed when user starts editing.\n */\nexport const IRefSelectionsService = createIdentifier<SheetsSelectionsService>('sheets-formula.ref-selections.service');\n\n/**\n * RefSelectionsService treats `selectionMoveStart$` `selectionMoving$` and `selectionMoveEnd$` differently\n * than `SheetsSelectionsService`. Because ref selections can be in different workbooks.\n */\nexport class RefSelectionsService extends SheetsSelectionsService {\n    constructor(\n        @IUniverInstanceService _instanceSrv: IUniverInstanceService\n    ) {\n        super(_instanceSrv);\n    }\n\n    protected override _init(): void {\n        const $ = this._getAliveWorkbooks$().pipe(takeUntil(this.dispose$));\n        this.selectionMoveStart$ = $.pipe(switchMap((ss) => merge(...ss.map((s) => s.selectionMoveStart$))));\n        this.selectionMoving$ = $.pipe(switchMap((ss) => merge(...ss.map((s) => s.selectionMoving$))));\n        this.selectionMoveEnd$ = $.pipe(switchMap((ss) => merge(...ss.map((s) => s.selectionMoveEnd$))));\n        this.selectionSet$ = $.pipe(switchMap((ss) => merge(...ss.map((s) => s.selectionSet$))));\n    }\n\n    private _getAliveWorkbooks$(): Observable<WorkbookSelectionModel[]> {\n        const aliveWorkbooks = this._instanceSrv.getAllUnitsForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        aliveWorkbooks.forEach((workbook) => this._ensureWorkbookSelection(workbook.getUnitId()));\n\n        const workbooks$ = new BehaviorSubject(aliveWorkbooks);\n        this.disposeWithMe(this._instanceSrv.getTypeOfUnitAdded$<Workbook>(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) => {\n            this._ensureWorkbookSelection(workbook.getUnitId());\n            workbooks$.next([...workbooks$.getValue(), workbook]);\n        }));\n        this.disposeWithMe(this._instanceSrv.getTypeOfUnitDisposed$<Workbook>(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) => {\n            this._removeWorkbookSelection(workbook.getUnitId());\n            workbooks$.next(workbooks$.getValue().filter((unit) => unit !== workbook));\n        }));\n\n        return workbooks$.pipe(map((workbooks) => workbooks.map((w) => this._ensureWorkbookSelection(w.getUnitId()))));\n    }\n}\n"],"mappings":";;;;;;;;;;;AAmBA,SAAS,kBAAkB,wBAAwB,0BAA0B;AAC7E,SAAS,iBAAiB,KAAK,OAAO,WAAW,iBAAiB;AAClE,SAAS,+BAA+B;AAQjC,aAAM,wBAAwB,iBAA0C,uCAAuC;AAM/G,WAAM,uBAAN,cAAmC,wBAAwB;AAAA,EAC9D,YAC4B,cAC1B;AACE,UAAM,YAAY;AAAA,EACtB;AAAA,EAEmB,QAAc;AAC7B,UAAM,IAAI,KAAK,oBAAoB,EAAE,KAAK,UAAU,KAAK,QAAQ,CAAC;AAClE,SAAK,sBAAsB,EAAE,KAAK,UAAU,CAAC,OAAO,MAAM,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,mBAAmB,CAAC,CAAC,CAAC;AACnG,SAAK,mBAAmB,EAAE,KAAK,UAAU,CAAC,OAAO,MAAM,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC,CAAC;AAC7F,SAAK,oBAAoB,EAAE,KAAK,UAAU,CAAC,OAAO,MAAM,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,iBAAiB,CAAC,CAAC,CAAC;AAC/F,SAAK,gBAAgB,EAAE,KAAK,UAAU,CAAC,OAAO,MAAM,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC,CAAC;AAAA,EAC3F;AAAA,EAEQ,sBAA4D;AAChE,UAAM,iBAAiB,KAAK,aAAa,mBAA6B,mBAAmB,YAAY;AACrG,mBAAe,QAAQ,CAAC,aAAa,KAAK,yBAAyB,SAAS,UAAU,CAAC,CAAC;AAExF,UAAM,aAAa,IAAI,gBAAgB,cAAc;AACrD,SAAK,cAAc,KAAK,aAAa,oBAA8B,mBAAmB,YAAY,EAAE,UAAU,CAAC,aAAa;AACxH,WAAK,yBAAyB,SAAS,UAAU,CAAC;AAClD,iBAAW,KAAK,CAAC,GAAG,WAAW,SAAS,GAAG,QAAQ,CAAC;AAAA,IACxD,CAAC,CAAC;AACF,SAAK,cAAc,KAAK,aAAa,uBAAiC,mBAAmB,YAAY,EAAE,UAAU,CAAC,aAAa;AAC3H,WAAK,yBAAyB,SAAS,UAAU,CAAC;AAClD,iBAAW,KAAK,WAAW,SAAS,EAAE,OAAO,CAAC,SAAS,SAAS,QAAQ,CAAC;AAAA,IAC7E,CAAC,CAAC;AAEF,WAAO,WAAW,KAAK,IAAI,CAAC,cAAc,UAAU,IAAI,CAAC,MAAM,KAAK,yBAAyB,EAAE,UAAU,CAAC,CAAC,CAAC,CAAC;AAAA,EACjH;AACJ;AA/Ba,uBAAN;AAAA,EAEE;AAAA,GAFI;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"982f6603367d5a04baa9ff761aa93a623ae65042"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/utils/selection-command-util.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/utils/selection-command-util.ts","statementMap":{"0":{"start":{"line":5,"column":25},"end":{"line":5,"column":54}},"1":{"start":{"line":6,"column":31},"end":{"line":6,"column":85}},"2":{"start":{"line":7,"column":2},"end":{"line":7,"column":119}}},"fnMap":{"0":{"name":"getSelectionsService","decl":{"start":{"line":4,"column":16},"end":{"line":4,"column":36}},"loc":{"start":{"line":4,"column":69},"end":{"line":8,"column":1}},"line":4}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":22},"end":{"line":7,"column":117}},"type":"cond-expr","locations":[{"start":{"line":7,"column":70},"end":{"line":7,"column":91}},{"start":{"line":7,"column":94},"end":{"line":7,"column":117}}],"line":7},"1":{"loc":{"start":{"line":7,"column":22},"end":{"line":7,"column":67}},"type":"binary-expr","locations":[{"start":{"line":7,"column":22},"end":{"line":7,"column":42}},{"start":{"line":7,"column":46},"end":{"line":7,"column":67}}],"line":7}},"s":{"0":4,"1":4,"2":4},"f":{"0":4},"b":{"0":[0,4],"1":[4,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/utils/selection-command-util.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor } from '@univerjs/core';\nimport { IContextService } from '@univerjs/core';\nimport { IRefSelectionsService } from '../../services/selections/ref-selections.service';\nimport { REF_SELECTIONS_ENABLED, SheetsSelectionsService } from '../../services/selections/selection.service';\n\nexport function getSelectionsService(\n    accessor: IAccessor,\n    fromCurrentSelection?: boolean\n): SheetsSelectionsService {\n    const contextService = accessor.get(IContextService);\n    const isInRefSelectionMode = contextService.getContextValue(REF_SELECTIONS_ENABLED);\n\n    return accessor.get(isInRefSelectionMode && !fromCurrentSelection ? IRefSelectionsService : SheetsSelectionsService);\n}\n"],"mappings":"AAiBA,SAAS,uBAAuB;AAChC,SAAS,6BAA6B;AACtC,SAAS,wBAAwB,+BAA+B;AAEzD,gBAAS,qBACZ,UACA,sBACuB;AACvB,QAAM,iBAAiB,SAAS,IAAI,eAAe;AACnD,QAAM,uBAAuB,eAAe,gBAAgB,sBAAsB;AAElF,SAAO,SAAS,IAAI,wBAAwB,CAAC,uBAAuB,wBAAwB,uBAAuB;AACvH;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ffc4a17863ef7dbd7849349e2387751b978fe86c"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/operations/selection.operation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/operations/selection.operation.ts","statementMap":{"0":{"start":{"line":5,"column":38},"end":{"line":15,"column":1}},"1":{"start":{"line":9,"column":4},"end":{"line":9,"column":30}},"2":{"start":{"line":9,"column":17},"end":{"line":9,"column":30}},"3":{"start":{"line":10,"column":52},"end":{"line":10,"column":58}},"4":{"start":{"line":11,"column":36},"end":{"line":11,"column":66}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":84}},"6":{"start":{"line":13,"column":4},"end":{"line":13,"column":16}},"7":{"start":{"line":16,"column":34},"end":{"line":36,"column":1}},"8":{"start":{"line":20,"column":4},"end":{"line":20,"column":30}},"9":{"start":{"line":20,"column":17},"end":{"line":20,"column":30}},"10":{"start":{"line":21,"column":39},"end":{"line":21,"column":45}},"11":{"start":{"line":22,"column":27},"end":{"line":22,"column":56}},"12":{"start":{"line":23,"column":19},"end":{"line":23,"column":86}},"13":{"start":{"line":24,"column":4},"end":{"line":24,"column":30}},"14":{"start":{"line":24,"column":17},"end":{"line":24,"column":30}},"15":{"start":{"line":25,"column":23},"end":{"line":29,"column":6}},"16":{"start":{"line":30,"column":4},"end":{"line":34,"column":7}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":11},"end":{"line":8,"column":12}},"loc":{"start":{"line":8,"column":33},"end":{"line":14,"column":3}},"line":8},"1":{"name":"(anonymous_1)","decl":{"start":{"line":19,"column":11},"end":{"line":19,"column":12}},"loc":{"start":{"line":19,"column":33},"end":{"line":35,"column":3}},"line":19}},"branchMap":{"0":{"loc":{"start":{"line":9,"column":4},"end":{"line":9,"column":30}},"type":"if","locations":[{"start":{"line":9,"column":4},"end":{"line":9,"column":30}},{"start":{},"end":{}}],"line":9},"1":{"loc":{"start":{"line":20,"column":4},"end":{"line":20,"column":30}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":20,"column":30}},{"start":{},"end":{}}],"line":20},"2":{"loc":{"start":{"line":24,"column":4},"end":{"line":24,"column":30}},"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":24,"column":30}},{"start":{},"end":{}}],"line":24}},"s":{"0":1,"1":4,"2":0,"3":4,"4":4,"5":4,"6":4,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"f":{"0":4,"1":0},"b":{"0":[0,4],"1":[0,0],"2":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/operations/selection.operation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand, IOperation, IRange } from '@univerjs/core';\nimport type { ISelectionWithStyle } from '../../basics/selection';\nimport type { SelectionMoveType } from '../../services/selections/type';\nimport { CommandType, ICommandService, IUniverInstanceService } from '@univerjs/core';\nimport { getPrimaryForRange } from '../commands/utils/selection-utils';\nimport { getSheetCommandTarget } from '../commands/utils/target-util';\nimport { getSelectionsService } from '../utils/selection-command-util';\n\nexport interface ISetSelectionsOperationParams {\n    unitId: string;\n    subUnitId: string;\n    selections: ISelectionWithStyle[];\n    type?: SelectionMoveType;\n\n    /** If should scroll to the selected range. */\n    reveal?: boolean;\n    extra?: string;\n}\n\n/**\n * Set selections to SelectionModel(WorkbookSelectionModel) by selectionManagerService.\n */\nexport const SetSelectionsOperation: IOperation<ISetSelectionsOperationParams> = {\n    id: 'sheet.operation.set-selections',\n    type: CommandType.OPERATION,\n    handler: (accessor, params) => {\n        if (!params) return false;\n\n        const { selections, type, unitId, subUnitId } = params;\n        const selectionManagerService = getSelectionsService(accessor);\n\n        // Must update selections array ref.\n        // See https://github.com/dream-num/univer/issues/2199\n        selectionManagerService.setSelections(unitId, subUnitId, [...selections], type);\n        return true;\n    },\n};\n\nexport interface ISelectRangeCommandParams {\n    unitId: string;\n    subUnit: string;\n    range: IRange;\n\n    /** If should scroll to the selected range. */\n    reveal?: boolean;\n    extra?: string;\n}\n\nexport const SelectRangeCommand: ICommand<ISelectRangeCommandParams> = {\n    id: 'sheet.command.select-range',\n    type: CommandType.COMMAND,\n    handler: (accessor: IAccessor, params: ISelectRangeCommandParams) => {\n        if (!params) return false;\n\n        const { unitId, subUnit, range } = params;\n        const commandService = accessor.get(ICommandService);\n        const target = getSheetCommandTarget(accessor.get(IUniverInstanceService), params);\n        if (!target) return false;\n\n        const selections: ISelectionWithStyle[] = [{\n            range,\n            primary: getPrimaryForRange(range, target.worksheet),\n            style: null,\n        }];\n\n        return commandService.syncExecuteCommand(SetSelectionsOperation.id, {\n            unitId,\n            subUnitId: subUnit,\n            selections,\n        } as ISetSelectionsOperationParams);\n    },\n};\n"],"mappings":"AAmBA,SAAS,aAAa,iBAAiB,8BAA8B;AACrE,SAAS,0BAA0B;AACnC,SAAS,6BAA6B;AACtC,SAAS,4BAA4B;AAgB9B,aAAM,yBAAoE;AAAA,EAC7E,IAAI;AAAA,EACJ,MAAM,YAAY;AAAA,EAClB,SAAS,CAAC,UAAU,WAAW;AAC3B,QAAI,CAAC,OAAQ,QAAO;AAEpB,UAAM,EAAE,YAAY,MAAM,QAAQ,UAAU,IAAI;AAChD,UAAM,0BAA0B,qBAAqB,QAAQ;AAI7D,4BAAwB,cAAc,QAAQ,WAAW,CAAC,GAAG,UAAU,GAAG,IAAI;AAC9E,WAAO;AAAA,EACX;AACJ;AAYO,aAAM,qBAA0D;AAAA,EACnE,IAAI;AAAA,EACJ,MAAM,YAAY;AAAA,EAClB,SAAS,CAAC,UAAqB,WAAsC;AACjE,QAAI,CAAC,OAAQ,QAAO;AAEpB,UAAM,EAAE,QAAQ,SAAS,MAAM,IAAI;AACnC,UAAM,iBAAiB,SAAS,IAAI,eAAe;AACnD,UAAM,SAAS,sBAAsB,SAAS,IAAI,sBAAsB,GAAG,MAAM;AACjF,QAAI,CAAC,OAAQ,QAAO;AAEpB,UAAM,aAAoC,CAAC;AAAA,MACvC;AAAA,MACA,SAAS,mBAAmB,OAAO,OAAO,SAAS;AAAA,MACnD,OAAO;AAAA,IACX,CAAC;AAED,WAAO,eAAe,mBAAmB,uBAAuB,IAAI;AAAA,MAChE;AAAA,MACA,WAAW;AAAA,MACX;AAAA,IACJ,CAAkC;AAAA,EACtC;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d38d442e00bce523324e7e89a1cde14994ba12de"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/sheet-interceptor/sheet-interceptor.service.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/sheet-interceptor/sheet-interceptor.service.ts","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":37}},"1":{"start":{"line":2,"column":23},"end":{"line":2,"column":54}},"2":{"start":{"line":3,"column":22},"end":{"line":10,"column":1}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"4":{"start":{"line":5,"column":2},"end":{"line":7,"column":85}},"5":{"start":{"line":5,"column":15},"end":{"line":5,"column":36}},"6":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"7":{"start":{"line":7,"column":6},"end":{"line":7,"column":85}},"8":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"9":{"start":{"line":8,"column":22},"end":{"line":8,"column":53}},"10":{"start":{"line":9,"column":2},"end":{"line":9,"column":16}},"11":{"start":{"line":11,"column":22},"end":{"line":11,"column":90}},"12":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"13":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"14":{"start":{"line":26,"column":32},"end":{"line":26,"column":72}},"15":{"start":{"line":27,"column":31},"end":{"line":27,"column":70}},"16":{"start":{"line":28,"column":29},"end":{"line":28,"column":66}},"17":{"start":{"line":29,"column":37},"end":{"line":317,"column":1}},"18":{"start":{"line":32,"column":4},"end":{"line":32,"column":12}},"19":{"start":{"line":33,"column":4},"end":{"line":33,"column":57}},"20":{"start":{"line":34,"column":4},"end":{"line":36,"column":8}},"21":{"start":{"line":35,"column":6},"end":{"line":35,"column":40}},"22":{"start":{"line":37,"column":4},"end":{"line":39,"column":7}},"23":{"start":{"line":38,"column":20},"end":{"line":38,"column":62}},"24":{"start":{"line":40,"column":4},"end":{"line":50,"column":7}},"25":{"start":{"line":44,"column":24},"end":{"line":44,"column":78}},"26":{"start":{"line":45,"column":8},"end":{"line":47,"column":9}},"27":{"start":{"line":46,"column":10},"end":{"line":46,"column":42}},"28":{"start":{"line":48,"column":8},"end":{"line":48,"column":23}},"29":{"start":{"line":51,"column":4},"end":{"line":54,"column":8}},"30":{"start":{"line":53,"column":27},"end":{"line":53,"column":33}},"31":{"start":{"line":55,"column":4},"end":{"line":58,"column":8}},"32":{"start":{"line":57,"column":27},"end":{"line":57,"column":33}},"33":{"start":{"line":59,"column":4},"end":{"line":62,"column":8}},"34":{"start":{"line":61,"column":27},"end":{"line":61,"column":33}},"35":{"start":{"line":64,"column":40},"end":{"line":64,"column":49}},"36":{"start":{"line":65,"column":25},"end":{"line":65,"column":27}},"37":{"start":{"line":66,"column":23},"end":{"line":66,"column":25}},"38":{"start":{"line":67,"column":30},"end":{"line":67,"column":32}},"39":{"start":{"line":68,"column":30},"end":{"line":68,"column":32}},"40":{"start":{"line":69,"column":41},"end":{"line":69,"column":50}},"41":{"start":{"line":70,"column":42},"end":{"line":70,"column":51}},"42":{"start":{"line":71,"column":23},"end":{"line":71,"column":28}},"43":{"start":{"line":72,"column":46},"end":{"line":72,"column":55}},"44":{"start":{"line":73,"column":25},"end":{"line":77,"column":4}},"45":{"start":{"line":79,"column":4},"end":{"line":79,"column":20}},"46":{"start":{"line":80,"column":4},"end":{"line":80,"column":76}},"47":{"start":{"line":80,"column":54},"end":{"line":80,"column":74}},"48":{"start":{"line":81,"column":4},"end":{"line":81,"column":38}},"49":{"start":{"line":82,"column":4},"end":{"line":82,"column":39}},"50":{"start":{"line":83,"column":4},"end":{"line":83,"column":37}},"51":{"start":{"line":95,"column":4},"end":{"line":97,"column":5}},"52":{"start":{"line":96,"column":6},"end":{"line":96,"column":80}},"53":{"start":{"line":98,"column":4},"end":{"line":98,"column":48}},"54":{"start":{"line":99,"column":4},"end":{"line":99,"column":84}},"55":{"start":{"line":99,"column":45},"end":{"line":99,"column":82}},"56":{"start":{"line":100,"column":4},"end":{"line":100,"column":98}},"57":{"start":{"line":100,"column":49},"end":{"line":100,"column":95}},"58":{"start":{"line":108,"column":18},"end":{"line":108,"column":76}},"59":{"start":{"line":108,"column":55},"end":{"line":108,"column":75}},"60":{"start":{"line":109,"column":4},"end":{"line":114,"column":6}},"61":{"start":{"line":110,"column":33},"end":{"line":110,"column":49}},"62":{"start":{"line":111,"column":30},"end":{"line":111,"column":37}},"63":{"start":{"line":112,"column":33},"end":{"line":112,"column":49}},"64":{"start":{"line":113,"column":30},"end":{"line":113,"column":37}},"65":{"start":{"line":117,"column":4},"end":{"line":119,"column":5}},"66":{"start":{"line":118,"column":6},"end":{"line":118,"column":80}},"67":{"start":{"line":120,"column":4},"end":{"line":120,"column":53}},"68":{"start":{"line":121,"column":4},"end":{"line":121,"column":89}},"69":{"start":{"line":121,"column":50},"end":{"line":121,"column":87}},"70":{"start":{"line":122,"column":4},"end":{"line":122,"column":103}},"71":{"start":{"line":122,"column":49},"end":{"line":122,"column":100}},"72":{"start":{"line":125,"column":18},"end":{"line":125,"column":81}},"73":{"start":{"line":125,"column":60},"end":{"line":125,"column":80}},"74":{"start":{"line":126,"column":4},"end":{"line":129,"column":6}},"75":{"start":{"line":127,"column":30},"end":{"line":127,"column":37}},"76":{"start":{"line":128,"column":30},"end":{"line":128,"column":37}},"77":{"start":{"line":141,"column":4},"end":{"line":143,"column":5}},"78":{"start":{"line":142,"column":6},"end":{"line":142,"column":80}},"79":{"start":{"line":144,"column":4},"end":{"line":144,"column":53}},"80":{"start":{"line":145,"column":4},"end":{"line":145,"column":89}},"81":{"start":{"line":145,"column":50},"end":{"line":145,"column":87}},"82":{"start":{"line":146,"column":4},"end":{"line":146,"column":103}},"83":{"start":{"line":146,"column":49},"end":{"line":146,"column":100}},"84":{"start":{"line":154,"column":31},"end":{"line":154,"column":113}},"85":{"start":{"line":154,"column":91},"end":{"line":154,"column":111}},"86":{"start":{"line":155,"column":4},"end":{"line":155,"column":58}},"87":{"start":{"line":155,"column":49},"end":{"line":155,"column":56}},"88":{"start":{"line":165,"column":4},"end":{"line":167,"column":5}},"89":{"start":{"line":166,"column":6},"end":{"line":166,"column":80}},"90":{"start":{"line":168,"column":4},"end":{"line":168,"column":46}},"91":{"start":{"line":169,"column":4},"end":{"line":169,"column":82}},"92":{"start":{"line":169,"column":43},"end":{"line":169,"column":80}},"93":{"start":{"line":170,"column":4},"end":{"line":170,"column":96}},"94":{"start":{"line":170,"column":49},"end":{"line":170,"column":93}},"95":{"start":{"line":173,"column":18},"end":{"line":173,"column":74}},"96":{"start":{"line":173,"column":53},"end":{"line":173,"column":73}},"97":{"start":{"line":174,"column":4},"end":{"line":179,"column":6}},"98":{"start":{"line":175,"column":33},"end":{"line":175,"column":49}},"99":{"start":{"line":176,"column":30},"end":{"line":176,"column":37}},"100":{"start":{"line":177,"column":33},"end":{"line":177,"column":49}},"101":{"start":{"line":178,"column":30},"end":{"line":178,"column":37}},"102":{"start":{"line":184,"column":20},"end":{"line":192,"column":5}},"103":{"start":{"line":193,"column":4},"end":{"line":193,"column":98}},"104":{"start":{"line":197,"column":20},"end":{"line":204,"column":5}},"105":{"start":{"line":205,"column":4},"end":{"line":205,"column":109}},"106":{"start":{"line":208,"column":16},"end":{"line":208,"column":20}},"107":{"start":{"line":209,"column":4},"end":{"line":211,"column":5}},"108":{"start":{"line":210,"column":6},"end":{"line":210,"column":44}},"109":{"start":{"line":212,"column":25},"end":{"line":212,"column":58}},"110":{"start":{"line":213,"column":4},"end":{"line":213,"column":35}},"111":{"start":{"line":214,"column":31},"end":{"line":214,"column":97}},"112":{"start":{"line":214,"column":59},"end":{"line":214,"column":96}},"113":{"start":{"line":215,"column":4},"end":{"line":215,"column":35}},"114":{"start":{"line":216,"column":4},"end":{"line":237,"column":5}},"115":{"start":{"line":217,"column":28},"end":{"line":217,"column":85}},"116":{"start":{"line":218,"column":6},"end":{"line":218,"column":82}},"117":{"start":{"line":219,"column":26},"end":{"line":219,"column":83}},"118":{"start":{"line":220,"column":6},"end":{"line":223,"column":8}},"119":{"start":{"line":222,"column":41},"end":{"line":222,"column":102}},"120":{"start":{"line":224,"column":6},"end":{"line":227,"column":8}},"121":{"start":{"line":226,"column":41},"end":{"line":226,"column":102}},"122":{"start":{"line":228,"column":6},"end":{"line":233,"column":10}},"123":{"start":{"line":229,"column":8},"end":{"line":229,"column":63}},"124":{"start":{"line":230,"column":8},"end":{"line":230,"column":85}},"125":{"start":{"line":231,"column":8},"end":{"line":231,"column":99}},"126":{"start":{"line":232,"column":8},"end":{"line":232,"column":99}},"127":{"start":{"line":235,"column":6},"end":{"line":235,"column":60}},"128":{"start":{"line":236,"column":6},"end":{"line":236,"column":108}},"129":{"start":{"line":236,"column":51},"end":{"line":236,"column":105}},"130":{"start":{"line":240,"column":23},"end":{"line":240,"column":69}},"131":{"start":{"line":241,"column":16},"end":{"line":241,"column":34}},"132":{"start":{"line":242,"column":19},"end":{"line":242,"column":58}},"133":{"start":{"line":243,"column":4},"end":{"line":250,"column":5}},"134":{"start":{"line":244,"column":25},"end":{"line":244,"column":65}},"135":{"start":{"line":245,"column":6},"end":{"line":247,"column":7}},"136":{"start":{"line":246,"column":8},"end":{"line":246,"column":51}},"137":{"start":{"line":248,"column":6},"end":{"line":248,"column":57}},"138":{"start":{"line":249,"column":6},"end":{"line":249,"column":56}},"139":{"start":{"line":251,"column":4},"end":{"line":251,"column":20}},"140":{"start":{"line":254,"column":24},"end":{"line":254,"column":50}},"141":{"start":{"line":255,"column":19},"end":{"line":255,"column":39}},"142":{"start":{"line":256,"column":36},"end":{"line":256,"column":40}},"143":{"start":{"line":257,"column":31},"end":{"line":294,"column":5}},"144":{"start":{"line":258,"column":24},"end":{"line":258,"column":46}},"145":{"start":{"line":259,"column":6},"end":{"line":293,"column":9}},"146":{"start":{"line":260,"column":33},"end":{"line":260,"column":59}},"147":{"start":{"line":261,"column":8},"end":{"line":261,"column":121}},"148":{"start":{"line":262,"column":8},"end":{"line":278,"column":12}},"149":{"start":{"line":264,"column":28},"end":{"line":264,"column":58}},"150":{"start":{"line":265,"column":12},"end":{"line":276,"column":14}},"151":{"start":{"line":279,"column":8},"end":{"line":292,"column":12}},"152":{"start":{"line":281,"column":12},"end":{"line":290,"column":14}},"153":{"start":{"line":295,"column":4},"end":{"line":295,"column":79}},"154":{"start":{"line":295,"column":48},"end":{"line":295,"column":77}},"155":{"start":{"line":296,"column":4},"end":{"line":296,"column":100}},"156":{"start":{"line":296,"column":68},"end":{"line":296,"column":97}},"157":{"start":{"line":297,"column":4},"end":{"line":297,"column":135}},"158":{"start":{"line":297,"column":39},"end":{"line":297,"column":132}},"159":{"start":{"line":297,"column":83},"end":{"line":297,"column":131}},"160":{"start":{"line":298,"column":4},"end":{"line":298,"column":120}},"161":{"start":{"line":298,"column":69},"end":{"line":298,"column":117}},"162":{"start":{"line":299,"column":4},"end":{"line":299,"column":55}},"163":{"start":{"line":302,"column":19},"end":{"line":302,"column":39}},"164":{"start":{"line":303,"column":23},"end":{"line":303,"column":60}},"165":{"start":{"line":304,"column":4},"end":{"line":307,"column":5}},"166":{"start":{"line":305,"column":6},"end":{"line":305,"column":27}},"167":{"start":{"line":306,"column":6},"end":{"line":306,"column":47}},"168":{"start":{"line":310,"column":25},"end":{"line":310,"column":68}},"169":{"start":{"line":311,"column":23},"end":{"line":311,"column":67}},"170":{"start":{"line":312,"column":4},"end":{"line":315,"column":5}},"171":{"start":{"line":313,"column":6},"end":{"line":313,"column":27}},"172":{"start":{"line":314,"column":6},"end":{"line":314,"column":54}},"173":{"start":{"line":318,"column":0},"end":{"line":320,"column":28}},"174":{"start":{"line":322,"column":2},"end":{"line":322,"column":47}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":22},"end":{"line":3,"column":23}},"loc":{"start":{"line":3,"column":57},"end":{"line":10,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":44},"end":{"line":11,"column":45}},"loc":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":31,"column":2},"end":{"line":31,"column":3}},"loc":{"start":{"line":31,"column":38},"end":{"line":63,"column":3}},"line":31},"4":{"name":"(anonymous_4)","decl":{"start":{"line":34,"column":114},"end":{"line":34,"column":115}},"loc":{"start":{"line":34,"column":128},"end":{"line":36,"column":5}},"line":34},"5":{"name":"(anonymous_5)","decl":{"start":{"line":38,"column":6},"end":{"line":38,"column":7}},"loc":{"start":{"line":38,"column":20},"end":{"line":38,"column":62}},"line":38},"6":{"name":"(anonymous_6)","decl":{"start":{"line":43,"column":6},"end":{"line":43,"column":7}},"loc":{"start":{"line":43,"column":30},"end":{"line":49,"column":7}},"line":43},"7":{"name":"(anonymous_7)","decl":{"start":{"line":53,"column":15},"end":{"line":53,"column":16}},"loc":{"start":{"line":53,"column":27},"end":{"line":53,"column":33}},"line":53},"8":{"name":"(anonymous_8)","decl":{"start":{"line":57,"column":15},"end":{"line":57,"column":16}},"loc":{"start":{"line":57,"column":27},"end":{"line":57,"column":33}},"line":57},"9":{"name":"(anonymous_9)","decl":{"start":{"line":61,"column":15},"end":{"line":61,"column":16}},"loc":{"start":{"line":61,"column":27},"end":{"line":61,"column":33}},"line":61},"10":{"name":"(anonymous_10)","decl":{"start":{"line":78,"column":2},"end":{"line":78,"column":3}},"loc":{"start":{"line":78,"column":12},"end":{"line":84,"column":3}},"line":78},"11":{"name":"(anonymous_11)","decl":{"start":{"line":80,"column":38},"end":{"line":80,"column":39}},"loc":{"start":{"line":80,"column":54},"end":{"line":80,"column":74}},"line":80},"12":{"name":"(anonymous_12)","decl":{"start":{"line":94,"column":2},"end":{"line":94,"column":3}},"loc":{"start":{"line":94,"column":32},"end":{"line":101,"column":3}},"line":94},"13":{"name":"(anonymous_13)","decl":{"start":{"line":99,"column":35},"end":{"line":99,"column":36}},"loc":{"start":{"line":99,"column":45},"end":{"line":99,"column":82}},"line":99},"14":{"name":"(anonymous_14)","decl":{"start":{"line":100,"column":43},"end":{"line":100,"column":44}},"loc":{"start":{"line":100,"column":49},"end":{"line":100,"column":95}},"line":100},"15":{"name":"(anonymous_15)","decl":{"start":{"line":107,"column":2},"end":{"line":107,"column":3}},"loc":{"start":{"line":107,"column":25},"end":{"line":115,"column":3}},"line":107},"16":{"name":"(anonymous_16)","decl":{"start":{"line":108,"column":48},"end":{"line":108,"column":49}},"loc":{"start":{"line":108,"column":55},"end":{"line":108,"column":75}},"line":108},"17":{"name":"(anonymous_17)","decl":{"start":{"line":110,"column":26},"end":{"line":110,"column":27}},"loc":{"start":{"line":110,"column":33},"end":{"line":110,"column":49}},"line":110},"18":{"name":"(anonymous_18)","decl":{"start":{"line":111,"column":23},"end":{"line":111,"column":24}},"loc":{"start":{"line":111,"column":30},"end":{"line":111,"column":37}},"line":111},"19":{"name":"(anonymous_19)","decl":{"start":{"line":112,"column":26},"end":{"line":112,"column":27}},"loc":{"start":{"line":112,"column":33},"end":{"line":112,"column":49}},"line":112},"20":{"name":"(anonymous_20)","decl":{"start":{"line":113,"column":23},"end":{"line":113,"column":24}},"loc":{"start":{"line":113,"column":30},"end":{"line":113,"column":37}},"line":113},"21":{"name":"(anonymous_21)","decl":{"start":{"line":116,"column":2},"end":{"line":116,"column":3}},"loc":{"start":{"line":116,"column":37},"end":{"line":123,"column":3}},"line":116},"22":{"name":"(anonymous_22)","decl":{"start":{"line":121,"column":40},"end":{"line":121,"column":41}},"loc":{"start":{"line":121,"column":50},"end":{"line":121,"column":87}},"line":121},"23":{"name":"(anonymous_23)","decl":{"start":{"line":122,"column":43},"end":{"line":122,"column":44}},"loc":{"start":{"line":122,"column":49},"end":{"line":122,"column":100}},"line":122},"24":{"name":"(anonymous_24)","decl":{"start":{"line":124,"column":2},"end":{"line":124,"column":3}},"loc":{"start":{"line":124,"column":28},"end":{"line":130,"column":3}},"line":124},"25":{"name":"(anonymous_25)","decl":{"start":{"line":125,"column":53},"end":{"line":125,"column":54}},"loc":{"start":{"line":125,"column":60},"end":{"line":125,"column":80}},"line":125},"26":{"name":"(anonymous_26)","decl":{"start":{"line":127,"column":23},"end":{"line":127,"column":24}},"loc":{"start":{"line":127,"column":30},"end":{"line":127,"column":37}},"line":127},"27":{"name":"(anonymous_27)","decl":{"start":{"line":128,"column":23},"end":{"line":128,"column":24}},"loc":{"start":{"line":128,"column":30},"end":{"line":128,"column":37}},"line":128},"28":{"name":"(anonymous_28)","decl":{"start":{"line":140,"column":2},"end":{"line":140,"column":3}},"loc":{"start":{"line":140,"column":38},"end":{"line":147,"column":3}},"line":140},"29":{"name":"(anonymous_29)","decl":{"start":{"line":145,"column":40},"end":{"line":145,"column":41}},"loc":{"start":{"line":145,"column":50},"end":{"line":145,"column":87}},"line":145},"30":{"name":"(anonymous_30)","decl":{"start":{"line":146,"column":43},"end":{"line":146,"column":44}},"loc":{"start":{"line":146,"column":49},"end":{"line":146,"column":100}},"line":146},"31":{"name":"(anonymous_31)","decl":{"start":{"line":153,"column":2},"end":{"line":153,"column":3}},"loc":{"start":{"line":153,"column":35},"end":{"line":156,"column":3}},"line":153},"32":{"name":"(anonymous_32)","decl":{"start":{"line":154,"column":84},"end":{"line":154,"column":85}},"loc":{"start":{"line":154,"column":91},"end":{"line":154,"column":111}},"line":154},"33":{"name":"(anonymous_33)","decl":{"start":{"line":155,"column":36},"end":{"line":155,"column":37}},"loc":{"start":{"line":155,"column":49},"end":{"line":155,"column":56}},"line":155},"34":{"name":"(anonymous_34)","decl":{"start":{"line":164,"column":2},"end":{"line":164,"column":3}},"loc":{"start":{"line":164,"column":31},"end":{"line":171,"column":3}},"line":164},"35":{"name":"(anonymous_35)","decl":{"start":{"line":169,"column":33},"end":{"line":169,"column":34}},"loc":{"start":{"line":169,"column":43},"end":{"line":169,"column":80}},"line":169},"36":{"name":"(anonymous_36)","decl":{"start":{"line":170,"column":43},"end":{"line":170,"column":44}},"loc":{"start":{"line":170,"column":49},"end":{"line":170,"column":93}},"line":170},"37":{"name":"(anonymous_37)","decl":{"start":{"line":172,"column":2},"end":{"line":172,"column":3}},"loc":{"start":{"line":172,"column":34},"end":{"line":180,"column":3}},"line":172},"38":{"name":"(anonymous_38)","decl":{"start":{"line":173,"column":46},"end":{"line":173,"column":47}},"loc":{"start":{"line":173,"column":53},"end":{"line":173,"column":73}},"line":173},"39":{"name":"(anonymous_39)","decl":{"start":{"line":175,"column":26},"end":{"line":175,"column":27}},"loc":{"start":{"line":175,"column":33},"end":{"line":175,"column":49}},"line":175},"40":{"name":"(anonymous_40)","decl":{"start":{"line":176,"column":23},"end":{"line":176,"column":24}},"loc":{"start":{"line":176,"column":30},"end":{"line":176,"column":37}},"line":176},"41":{"name":"(anonymous_41)","decl":{"start":{"line":177,"column":26},"end":{"line":177,"column":27}},"loc":{"start":{"line":177,"column":33},"end":{"line":177,"column":49}},"line":177},"42":{"name":"(anonymous_42)","decl":{"start":{"line":178,"column":23},"end":{"line":178,"column":24}},"loc":{"start":{"line":178,"column":30},"end":{"line":178,"column":37}},"line":178},"43":{"name":"(anonymous_43)","decl":{"start":{"line":183,"column":2},"end":{"line":183,"column":3}},"loc":{"start":{"line":183,"column":55},"end":{"line":194,"column":3}},"line":183},"44":{"name":"(anonymous_44)","decl":{"start":{"line":196,"column":2},"end":{"line":196,"column":3}},"loc":{"start":{"line":196,"column":48},"end":{"line":206,"column":3}},"line":196},"45":{"name":"(anonymous_45)","decl":{"start":{"line":207,"column":2},"end":{"line":207,"column":3}},"loc":{"start":{"line":207,"column":31},"end":{"line":238,"column":3}},"line":207},"46":{"name":"(anonymous_46)","decl":{"start":{"line":214,"column":49},"end":{"line":214,"column":50}},"loc":{"start":{"line":214,"column":59},"end":{"line":214,"column":96}},"line":214},"47":{"name":"(anonymous_47)","decl":{"start":{"line":222,"column":34},"end":{"line":222,"column":35}},"loc":{"start":{"line":222,"column":41},"end":{"line":222,"column":102}},"line":222},"48":{"name":"(anonymous_48)","decl":{"start":{"line":226,"column":34},"end":{"line":226,"column":35}},"loc":{"start":{"line":226,"column":41},"end":{"line":226,"column":102}},"line":226},"49":{"name":"(anonymous_49)","decl":{"start":{"line":228,"column":45},"end":{"line":228,"column":46}},"loc":{"start":{"line":228,"column":51},"end":{"line":233,"column":7}},"line":228},"50":{"name":"(anonymous_50)","decl":{"start":{"line":236,"column":45},"end":{"line":236,"column":46}},"loc":{"start":{"line":236,"column":51},"end":{"line":236,"column":105}},"line":236},"51":{"name":"(anonymous_51)","decl":{"start":{"line":239,"column":2},"end":{"line":239,"column":3}},"loc":{"start":{"line":239,"column":55},"end":{"line":252,"column":3}},"line":239},"52":{"name":"(anonymous_52)","decl":{"start":{"line":253,"column":2},"end":{"line":253,"column":3}},"loc":{"start":{"line":253,"column":31},"end":{"line":300,"column":3}},"line":253},"53":{"name":"(anonymous_53)","decl":{"start":{"line":257,"column":31},"end":{"line":257,"column":32}},"loc":{"start":{"line":257,"column":46},"end":{"line":294,"column":5}},"line":257},"54":{"name":"(anonymous_54)","decl":{"start":{"line":259,"column":37},"end":{"line":259,"column":38}},"loc":{"start":{"line":259,"column":52},"end":{"line":293,"column":7}},"line":259},"55":{"name":"(anonymous_55)","decl":{"start":{"line":263,"column":10},"end":{"line":263,"column":11}},"loc":{"start":{"line":263,"column":49},"end":{"line":277,"column":11}},"line":263},"56":{"name":"(anonymous_56)","decl":{"start":{"line":280,"column":10},"end":{"line":280,"column":11}},"loc":{"start":{"line":280,"column":30},"end":{"line":291,"column":11}},"line":280},"57":{"name":"(anonymous_57)","decl":{"start":{"line":295,"column":33},"end":{"line":295,"column":34}},"loc":{"start":{"line":295,"column":48},"end":{"line":295,"column":77}},"line":295},"58":{"name":"(anonymous_58)","decl":{"start":{"line":296,"column":53},"end":{"line":296,"column":54}},"loc":{"start":{"line":296,"column":68},"end":{"line":296,"column":97}},"line":296},"59":{"name":"(anonymous_59)","decl":{"start":{"line":297,"column":33},"end":{"line":297,"column":34}},"loc":{"start":{"line":297,"column":39},"end":{"line":297,"column":132}},"line":297},"60":{"name":"(anonymous_60)","decl":{"start":{"line":297,"column":68},"end":{"line":297,"column":69}},"loc":{"start":{"line":297,"column":83},"end":{"line":297,"column":131}},"line":297},"61":{"name":"(anonymous_61)","decl":{"start":{"line":298,"column":54},"end":{"line":298,"column":55}},"loc":{"start":{"line":298,"column":69},"end":{"line":298,"column":117}},"line":298},"62":{"name":"(anonymous_62)","decl":{"start":{"line":301,"column":2},"end":{"line":301,"column":3}},"loc":{"start":{"line":301,"column":40},"end":{"line":308,"column":3}},"line":301},"63":{"name":"(anonymous_63)","decl":{"start":{"line":309,"column":2},"end":{"line":309,"column":3}},"loc":{"start":{"line":309,"column":46},"end":{"line":316,"column":3}},"line":309},"64":{"name":"getWorksheetDisposableID","decl":{"start":{"line":321,"column":9},"end":{"line":321,"column":33}},"loc":{"start":{"line":321,"column":53},"end":{"line":323,"column":1}},"line":321}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":26},"end":{"line":4,"column":32}},{"start":{"line":4,"column":35},"end":{"line":4,"column":80}}],"line":4},"1":{"loc":{"start":{"line":4,"column":35},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":42},"end":{"line":4,"column":71}},{"start":{"line":4,"column":74},"end":{"line":4,"column":80}}],"line":4},"2":{"loc":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"type":"if","locations":[{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},{"start":{},"end":{}}],"line":6},"3":{"loc":{"start":{"line":7,"column":15},"end":{"line":7,"column":84}},"type":"binary-expr","locations":[{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},{"start":{"line":7,"column":78},"end":{"line":7,"column":84}}],"line":7},"4":{"loc":{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},"type":"cond-expr","locations":[{"start":{"line":7,"column":23},"end":{"line":7,"column":53}},{"start":{"line":7,"column":56},"end":{"line":7,"column":73}}],"line":7},"5":{"loc":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},{"start":{},"end":{}}],"line":8},"6":{"loc":{"start":{"line":8,"column":6},"end":{"line":8,"column":20}},"type":"binary-expr","locations":[{"start":{"line":8,"column":6},"end":{"line":8,"column":10}},{"start":{"line":8,"column":14},"end":{"line":8,"column":20}}],"line":8},"7":{"loc":{"start":{"line":45,"column":8},"end":{"line":47,"column":9}},"type":"if","locations":[{"start":{"line":45,"column":8},"end":{"line":47,"column":9}},{"start":{},"end":{}}],"line":45},"8":{"loc":{"start":{"line":95,"column":4},"end":{"line":97,"column":5}},"type":"if","locations":[{"start":{"line":95,"column":4},"end":{"line":97,"column":5}},{"start":{},"end":{}}],"line":95},"9":{"loc":{"start":{"line":99,"column":46},"end":{"line":99,"column":61}},"type":"binary-expr","locations":[{"start":{"line":99,"column":46},"end":{"line":99,"column":56}},{"start":{"line":99,"column":60},"end":{"line":99,"column":61}}],"line":99},"10":{"loc":{"start":{"line":99,"column":66},"end":{"line":99,"column":81}},"type":"binary-expr","locations":[{"start":{"line":99,"column":66},"end":{"line":99,"column":76}},{"start":{"line":99,"column":80},"end":{"line":99,"column":81}}],"line":99},"11":{"loc":{"start":{"line":110,"column":33},"end":{"line":110,"column":49}},"type":"binary-expr","locations":[{"start":{"line":110,"column":33},"end":{"line":110,"column":43}},{"start":{"line":110,"column":47},"end":{"line":110,"column":49}}],"line":110},"12":{"loc":{"start":{"line":112,"column":33},"end":{"line":112,"column":49}},"type":"binary-expr","locations":[{"start":{"line":112,"column":33},"end":{"line":112,"column":43}},{"start":{"line":112,"column":47},"end":{"line":112,"column":49}}],"line":112},"13":{"loc":{"start":{"line":117,"column":4},"end":{"line":119,"column":5}},"type":"if","locations":[{"start":{"line":117,"column":4},"end":{"line":119,"column":5}},{"start":{},"end":{}}],"line":117},"14":{"loc":{"start":{"line":121,"column":51},"end":{"line":121,"column":66}},"type":"binary-expr","locations":[{"start":{"line":121,"column":51},"end":{"line":121,"column":61}},{"start":{"line":121,"column":65},"end":{"line":121,"column":66}}],"line":121},"15":{"loc":{"start":{"line":121,"column":71},"end":{"line":121,"column":86}},"type":"binary-expr","locations":[{"start":{"line":121,"column":71},"end":{"line":121,"column":81}},{"start":{"line":121,"column":85},"end":{"line":121,"column":86}}],"line":121},"16":{"loc":{"start":{"line":141,"column":4},"end":{"line":143,"column":5}},"type":"if","locations":[{"start":{"line":141,"column":4},"end":{"line":143,"column":5}},{"start":{},"end":{}}],"line":141},"17":{"loc":{"start":{"line":145,"column":51},"end":{"line":145,"column":66}},"type":"binary-expr","locations":[{"start":{"line":145,"column":51},"end":{"line":145,"column":61}},{"start":{"line":145,"column":65},"end":{"line":145,"column":66}}],"line":145},"18":{"loc":{"start":{"line":145,"column":71},"end":{"line":145,"column":86}},"type":"binary-expr","locations":[{"start":{"line":145,"column":71},"end":{"line":145,"column":81}},{"start":{"line":145,"column":85},"end":{"line":145,"column":86}}],"line":145},"19":{"loc":{"start":{"line":165,"column":4},"end":{"line":167,"column":5}},"type":"if","locations":[{"start":{"line":165,"column":4},"end":{"line":167,"column":5}},{"start":{},"end":{}}],"line":165},"20":{"loc":{"start":{"line":169,"column":44},"end":{"line":169,"column":59}},"type":"binary-expr","locations":[{"start":{"line":169,"column":44},"end":{"line":169,"column":54}},{"start":{"line":169,"column":58},"end":{"line":169,"column":59}}],"line":169},"21":{"loc":{"start":{"line":169,"column":64},"end":{"line":169,"column":79}},"type":"binary-expr","locations":[{"start":{"line":169,"column":64},"end":{"line":169,"column":74}},{"start":{"line":169,"column":78},"end":{"line":169,"column":79}}],"line":169},"22":{"loc":{"start":{"line":175,"column":33},"end":{"line":175,"column":49}},"type":"binary-expr","locations":[{"start":{"line":175,"column":33},"end":{"line":175,"column":43}},{"start":{"line":175,"column":47},"end":{"line":175,"column":49}}],"line":175},"23":{"loc":{"start":{"line":177,"column":33},"end":{"line":177,"column":49}},"type":"binary-expr","locations":[{"start":{"line":177,"column":33},"end":{"line":177,"column":43}},{"start":{"line":177,"column":47},"end":{"line":177,"column":49}}],"line":177},"24":{"loc":{"start":{"line":209,"column":4},"end":{"line":211,"column":5}},"type":"if","locations":[{"start":{"line":209,"column":4},"end":{"line":211,"column":5}},{"start":{},"end":{}}],"line":209},"25":{"loc":{"start":{"line":214,"column":60},"end":{"line":214,"column":75}},"type":"binary-expr","locations":[{"start":{"line":214,"column":60},"end":{"line":214,"column":70}},{"start":{"line":214,"column":74},"end":{"line":214,"column":75}}],"line":214},"26":{"loc":{"start":{"line":214,"column":80},"end":{"line":214,"column":95}},"type":"binary-expr","locations":[{"start":{"line":214,"column":80},"end":{"line":214,"column":90}},{"start":{"line":214,"column":94},"end":{"line":214,"column":95}}],"line":214},"27":{"loc":{"start":{"line":216,"column":4},"end":{"line":237,"column":5}},"type":"if","locations":[{"start":{"line":216,"column":4},"end":{"line":237,"column":5}},{"start":{"line":234,"column":11},"end":{"line":237,"column":5}}],"line":216},"28":{"loc":{"start":{"line":222,"column":43},"end":{"line":222,"column":66}},"type":"binary-expr","locations":[{"start":{"line":222,"column":43},"end":{"line":222,"column":51}},{"start":{"line":222,"column":55},"end":{"line":222,"column":66}}],"line":222},"29":{"loc":{"start":{"line":226,"column":43},"end":{"line":226,"column":66}},"type":"binary-expr","locations":[{"start":{"line":226,"column":43},"end":{"line":226,"column":51}},{"start":{"line":226,"column":55},"end":{"line":226,"column":66}}],"line":226},"30":{"loc":{"start":{"line":240,"column":23},"end":{"line":240,"column":69}},"type":"cond-expr","locations":[{"start":{"line":240,"column":43},"end":{"line":240,"column":47}},{"start":{"line":240,"column":50},"end":{"line":240,"column":69}}],"line":240},"31":{"loc":{"start":{"line":241,"column":16},"end":{"line":241,"column":34}},"type":"binary-expr","locations":[{"start":{"line":241,"column":16},"end":{"line":241,"column":20}},{"start":{"line":241,"column":24},"end":{"line":241,"column":34}}],"line":241},"32":{"loc":{"start":{"line":243,"column":4},"end":{"line":250,"column":5}},"type":"if","locations":[{"start":{"line":243,"column":4},"end":{"line":250,"column":5}},{"start":{},"end":{}}],"line":243},"33":{"loc":{"start":{"line":243,"column":8},"end":{"line":243,"column":44}},"type":"binary-expr","locations":[{"start":{"line":243,"column":8},"end":{"line":243,"column":17}},{"start":{"line":243,"column":21},"end":{"line":243,"column":44}}],"line":243},"34":{"loc":{"start":{"line":245,"column":6},"end":{"line":247,"column":7}},"type":"if","locations":[{"start":{"line":245,"column":6},"end":{"line":247,"column":7}},{"start":{},"end":{}}],"line":245},"35":{"loc":{"start":{"line":245,"column":10},"end":{"line":245,"column":32}},"type":"binary-expr","locations":[{"start":{"line":245,"column":10},"end":{"line":245,"column":22}},{"start":{"line":245,"column":26},"end":{"line":245,"column":32}}],"line":245},"36":{"loc":{"start":{"line":248,"column":37},"end":{"line":248,"column":55}},"type":"binary-expr","locations":[{"start":{"line":248,"column":37},"end":{"line":248,"column":49}},{"start":{"line":248,"column":53},"end":{"line":248,"column":55}}],"line":248},"37":{"loc":{"start":{"line":304,"column":4},"end":{"line":307,"column":5}},"type":"if","locations":[{"start":{"line":304,"column":4},"end":{"line":307,"column":5}},{"start":{},"end":{}}],"line":304},"38":{"loc":{"start":{"line":312,"column":4},"end":{"line":315,"column":5}},"type":"if","locations":[{"start":{"line":312,"column":4},"end":{"line":315,"column":5}},{"start":{},"end":{}}],"line":312}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":4,"19":4,"20":4,"21":4,"22":4,"23":0,"24":4,"25":0,"26":0,"27":0,"28":0,"29":4,"30":0,"31":4,"32":0,"33":4,"34":0,"35":4,"36":4,"37":4,"38":4,"39":4,"40":4,"41":4,"42":4,"43":4,"44":4,"45":4,"46":4,"47":4,"48":4,"49":4,"50":4,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":4,"59":0,"60":4,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":4,"107":4,"108":4,"109":4,"110":4,"111":4,"112":0,"113":4,"114":4,"115":4,"116":4,"117":4,"118":4,"119":4,"120":4,"121":4,"122":4,"123":4,"124":4,"125":4,"126":4,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":4,"141":4,"142":4,"143":4,"144":4,"145":4,"146":4,"147":4,"148":4,"149":0,"150":0,"151":4,"152":0,"153":4,"154":4,"155":4,"156":0,"157":4,"158":4,"159":4,"160":4,"161":0,"162":4,"163":0,"164":0,"165":0,"166":0,"167":0,"168":4,"169":4,"170":4,"171":4,"172":4,"173":1,"174":8},"f":{"0":1,"1":1,"2":1,"3":4,"4":4,"5":0,"6":0,"7":0,"8":0,"9":0,"10":4,"11":4,"12":0,"13":0,"14":0,"15":4,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":4,"46":0,"47":4,"48":4,"49":4,"50":0,"51":0,"52":4,"53":4,"54":4,"55":0,"56":0,"57":4,"58":0,"59":4,"60":4,"61":0,"62":0,"63":4,"64":8},"b":{"0":[0,1],"1":[0,1],"2":[1,0],"3":[1,1],"4":[0,1],"5":[0,1],"6":[1,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[4,0],"25":[0,0],"26":[0,0],"27":[4,0],"28":[4,0],"29":[4,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[4,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/sheet-interceptor/sheet-interceptor.service.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable ts/no-explicit-any */\n\nimport type {\n    ICellData,\n    ICellDataForSheetInterceptor,\n    ICellInterceptor,\n    ICommandInfo,\n    IComposeInterceptors,\n    IDisposable,\n    IInterceptor,\n    IRange,\n    IUndoRedoCommandInfosByInterceptor,\n    Nullable,\n    Workbook,\n    Worksheet,\n} from '@univerjs/core';\nimport type { ISheetLocation } from './utils/interceptor';\n\nimport {\n    composeInterceptors,\n    createInterceptorKey,\n    Disposable,\n    DisposableCollection,\n    InterceptorEffectEnum,\n    InterceptorManager,\n    IUniverInstanceService,\n    remove,\n    toDisposable,\n    Tools,\n    UniverInstanceType,\n} from '@univerjs/core';\nimport { INTERCEPTOR_POINT } from './interceptor-const';\n\nexport interface IBeforeCommandInterceptor {\n    priority?: number;\n    performCheck(info: ICommandInfo): Promise<boolean>;\n}\n\nexport interface ICommandInterceptor {\n    priority?: number;\n    getMutations(command: ICommandInfo): IUndoRedoCommandInfosByInterceptor;\n}\n\nexport interface IRangesInfo {\n    unitId: string;\n    subUnitId: string;\n    ranges: IRange[];\n}\n\nexport interface IRangeInterceptors {\n    priority?: number;\n    getMutations(rangesInfo: IRangesInfo): IUndoRedoCommandInfosByInterceptor;\n}\n\ninterface ISheetLocationForEditor extends ISheetLocation {\n    origin: Nullable<ICellData>;\n}\n\nexport const BEFORE_CELL_EDIT = createInterceptorKey<ICellDataForSheetInterceptor, ISheetLocationForEditor>('BEFORE_CELL_EDIT');\nexport const AFTER_CELL_EDIT = createInterceptorKey<ICellDataForSheetInterceptor, ISheetLocationForEditor>('AFTER_CELL_EDIT');\nexport const VALIDATE_CELL = createInterceptorKey<Promise<boolean>, ISheetLocation>('VALIDATE_CELL');\n\n/**\n * This class expose methods for sheet features to inject code to sheet underlying logic.\n */\nexport class SheetInterceptorService extends Disposable {\n    private _interceptorsByName: Map<string, Array<IInterceptor<unknown, unknown>>> = new Map();\n    private _commandInterceptors: ICommandInterceptor[] = [];\n    private _rangeInterceptors: IRangeInterceptors[] = [];\n\n    private _beforeCommandInterceptor: IBeforeCommandInterceptor[] = [];\n    private _afterCommandInterceptors: ICommandInterceptor[] = [];\n\n    private readonly _workbookDisposables = new Map<string, IDisposable>();\n    private readonly _worksheetDisposables = new Map<string, IDisposable>();\n\n    private _interceptorsDirty = false;\n    private _composedInterceptorByKey: Map<string, ReturnType<IComposeInterceptors<any, any>>> = new Map();\n\n    readonly writeCellInterceptor = new InterceptorManager({\n        BEFORE_CELL_EDIT,\n        AFTER_CELL_EDIT,\n        VALIDATE_CELL,\n    });\n\n    /** @ignore */\n    constructor(\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService\n    ) {\n        super();\n\n        // When a workbook is created or a worksheet is added after when workbook is created,\n        // `SheetInterceptorService` inject interceptors to worksheet instances to it.\n        this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$<Workbook>(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) => {\n            this._interceptWorkbook(workbook);\n        }));\n\n        this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$<Workbook>(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) =>\n            this._disposeWorkbookInterceptor(workbook)\n        ));\n\n        // register default viewModel interceptor\n        this.intercept(INTERCEPTOR_POINT.CELL_CONTENT, {\n            priority: -1,\n            effect: InterceptorEffectEnum.Style | InterceptorEffectEnum.Value,\n            handler(value, context): Nullable<ICellData> {\n                const rawData = context.worksheet.getCellRaw(context.row, context.col);\n                if (value) {\n                    return { ...rawData, ...value };\n                }\n\n                return rawData;\n            },\n        });\n\n        this.disposeWithMe(this.writeCellInterceptor.intercept(AFTER_CELL_EDIT, {\n            priority: -1,\n            handler: (_value) => _value,\n        }));\n\n        this.disposeWithMe(this.writeCellInterceptor.intercept(BEFORE_CELL_EDIT, {\n            priority: -1,\n            handler: (_value) => _value,\n        }));\n\n        this.disposeWithMe(this.writeCellInterceptor.intercept(VALIDATE_CELL, {\n            priority: -1,\n            handler: (_value) => _value,\n        }));\n    }\n\n    override dispose(): void {\n        super.dispose();\n\n        this._workbookDisposables.forEach((disposable) => disposable.dispose());\n        this._workbookDisposables.clear();\n        this._worksheetDisposables.clear();\n\n        this._interceptorsByName.clear();\n    }\n\n    // #region intercept command execution\n\n    /**\n     * Add a listener function to a specific command to add affiliated mutations. It should be called in controllers.\n     *\n     * Pairs with {@link onCommandExecute}.\n     *\n     * @param interceptor\n     * @returns\n     */\n    interceptCommand(interceptor: ICommandInterceptor): IDisposable {\n        if (this._commandInterceptors.includes(interceptor)) {\n            throw new Error('[SheetInterceptorService]: Interceptor already exists!');\n        }\n\n        this._commandInterceptors.push(interceptor);\n        this._commandInterceptors.sort((a, b) => (b.priority ?? 0) - (a.priority ?? 0));\n\n        return this.disposeWithMe(toDisposable(() => remove(this._commandInterceptors, interceptor)));\n    }\n\n    /**\n     * When command is executing, call this method to gether undo redo mutations from upper features.\n     * @param command\n     * @returns\n     */\n    onCommandExecute(info: ICommandInfo): IUndoRedoCommandInfosByInterceptor {\n        const infos = this._commandInterceptors.map((i) => i.getMutations(info));\n\n        return {\n            preUndos: infos.map((i) => i.preUndos ?? []).flat(),\n            undos: infos.map((i) => i.undos).flat(),\n            preRedos: infos.map((i) => i.preRedos ?? []).flat(),\n            redos: infos.map((i) => i.redos).flat(),\n        };\n    }\n\n    interceptAfterCommand(interceptor: ICommandInterceptor): IDisposable {\n        if (this._afterCommandInterceptors.includes(interceptor)) {\n            throw new Error('[SheetInterceptorService]: Interceptor already exists!');\n        }\n\n        this._afterCommandInterceptors.push(interceptor);\n        this._afterCommandInterceptors.sort((a, b) => (b.priority ?? 0) - (a.priority ?? 0));\n\n        return this.disposeWithMe(toDisposable(() => remove(this._afterCommandInterceptors, interceptor)));\n    }\n\n    afterCommandExecute(info: ICommandInfo): IUndoRedoCommandInfosByInterceptor {\n        const infos = this._afterCommandInterceptors.map((i) => i.getMutations(info));\n\n        return {\n            undos: infos.map((i) => i.undos).flat(),\n            redos: infos.map((i) => i.redos).flat(),\n        };\n    }\n\n    /**\n     * Add a listener function to a specific command to determine if the command can execute mutations. It should be\n     * called in controllers.\n     *\n     * Pairs with {@link beforeCommandExecute}.\n     *\n     * @param interceptor\n     * @returns\n     */\n    interceptBeforeCommand(interceptor: IBeforeCommandInterceptor): IDisposable {\n        if (this._beforeCommandInterceptor.includes(interceptor)) {\n            throw new Error('[SheetInterceptorService]: Interceptor already exists!');\n        }\n\n        this._beforeCommandInterceptor.push(interceptor);\n        this._beforeCommandInterceptor.sort((a, b) => (b.priority ?? 0) - (a.priority ?? 0));\n\n        return this.disposeWithMe(toDisposable(() => remove(this._beforeCommandInterceptor, interceptor)));\n    }\n\n    /**\n     * before command execute, call this method to get the flag of whether it can be executed the command\n     * @param info ICommandInfo\n     * @returns Promise<boolean>\n     */\n    async beforeCommandExecute(info: ICommandInfo): Promise<boolean> {\n        const allPerformCheckRes = await Promise.all(this._beforeCommandInterceptor.map((i) => i.performCheck(info)));\n        return allPerformCheckRes.every((perform) => perform);\n    }\n\n    // #endregion\n\n    // #region intercept ranges - mainly for pivot table currently (2024/10/28).\n\n    /**\n     * By adding callbacks to some Ranges can get some additional mutations, such as clearing all plugin data in a certain area.\n     * @param interceptor IRangeInterceptors\n     * @returns IDisposable\n     */\n    interceptRanges(interceptor: IRangeInterceptors): IDisposable {\n        if (this._rangeInterceptors.includes(interceptor)) {\n            throw new Error('[SheetInterceptorService]: Interceptor already exists!');\n        }\n\n        this._rangeInterceptors.push(interceptor);\n        this._rangeInterceptors.sort((a, b) => (b.priority ?? 0) - (a.priority ?? 0));\n\n        return this.disposeWithMe(toDisposable(() => remove(this._rangeInterceptors, interceptor)));\n    }\n\n    generateMutationsByRanges(info: IRangesInfo): IUndoRedoCommandInfosByInterceptor {\n        const infos = this._rangeInterceptors.map((i) => i.getMutations(info));\n\n        return {\n            preUndos: infos.map((i) => i.preUndos ?? []).flat(),\n            undos: infos.map((i) => i.undos).flat(),\n            preRedos: infos.map((i) => i.preRedos ?? []).flat(),\n            redos: infos.map((i) => i.redos).flat(),\n        };\n    }\n\n    // #endregion\n\n    // #region intercept on writing cell\n\n    onWriteCell(workbook: Workbook, worksheet: Worksheet, row: number, col: number, cellData: ICellData) {\n        const context = {\n            subUnitId: worksheet.getSheetId(),\n            unitId: workbook.getUnitId(),\n            workbook: workbook!,\n            worksheet,\n            row,\n            col,\n            origin: Tools.deepClone(cellData),\n        };\n\n        return this.writeCellInterceptor.fetchThroughInterceptors(AFTER_CELL_EDIT)(cellData, context);\n    }\n\n    // #endregion\n\n    onValidateCell(workbook: Workbook, worksheet: Worksheet, row: number, col: number) {\n        const context: ISheetLocation = {\n            subUnitId: worksheet.getSheetId(),\n            unitId: workbook.getUnitId(),\n            workbook: workbook!,\n            worksheet,\n            row,\n            col,\n        };\n\n        return this.writeCellInterceptor.fetchThroughInterceptors(VALIDATE_CELL)(Promise.resolve(true), context);\n    }\n\n    intercept<T extends IInterceptor<any, any>>(name: T, interceptor: T): IDisposable {\n        const key = name as unknown as string;\n        if (!this._interceptorsByName.has(key)) {\n            this._interceptorsByName.set(key, []);\n        }\n\n        const interceptors = this._interceptorsByName.get(key)!;\n        interceptors.push(interceptor);\n        const sortedInterceptors = interceptors.sort((a, b) => (b.priority ?? 0) - (a.priority ?? 0));\n\n        this._interceptorsDirty = true;\n\n        if (key === INTERCEPTOR_POINT.CELL_CONTENT as unknown as string) {\n            const JOINED_EFFECT = InterceptorEffectEnum.Style | InterceptorEffectEnum.Value;\n            this._interceptorsByName.set(`${key}-${JOINED_EFFECT}`, sortedInterceptors);\n\n            const BOTH_EFFECT = InterceptorEffectEnum.Style | InterceptorEffectEnum.Value;\n            this._interceptorsByName.set(\n                `${key}-${(InterceptorEffectEnum.Style)}`,\n                (sortedInterceptors as ICellInterceptor<unknown, unknown>[]).filter((i) => ((i.effect || BOTH_EFFECT) & InterceptorEffectEnum.Style) > 0)\n            );\n            this._interceptorsByName.set(\n                `${key}-${(InterceptorEffectEnum.Value)}`,\n                (sortedInterceptors as ICellInterceptor<unknown, unknown>[]).filter((i) => ((i.effect || BOTH_EFFECT) & InterceptorEffectEnum.Value) > 0)\n            );\n\n            return this.disposeWithMe(toDisposable(() => {\n                remove(this._interceptorsByName.get(key)!, interceptor);\n                remove(this._interceptorsByName.get(`${key}-${JOINED_EFFECT}`)!, interceptor);\n                remove(this._interceptorsByName.get(`${key}-${(InterceptorEffectEnum.Style)}`)!, interceptor);\n                remove(this._interceptorsByName.get(`${key}-${(InterceptorEffectEnum.Value)}`)!, interceptor);\n            }));\n        } else {\n            this._interceptorsByName.set(key, sortedInterceptors);\n            return this.disposeWithMe(toDisposable(() => remove(this._interceptorsByName.get(key)!, interceptor)));\n        }\n    }\n\n    fetchThroughInterceptors<T, C>(\n        name: IInterceptor<T, C>,\n        effect?: InterceptorEffectEnum,\n        _key?: string,\n        filter?: (interceptor: IInterceptor<any, any>) => boolean\n    ): ReturnType<IComposeInterceptors<T, C>> {\n        const byNamesKey = effect === undefined ? name as unknown as string : `${name as unknown as string}-${effect}`;\n        const key = _key ?? byNamesKey;\n        let composed = this._composedInterceptorByKey.get(key);\n\n        if (!composed || this._interceptorsDirty) {\n            let interceptors = this._interceptorsByName.get(byNamesKey) as unknown as Array<IInterceptor<any, any>> | undefined;\n            if (interceptors && filter) {\n                interceptors = interceptors.filter(filter);\n            }\n\n            composed = composeInterceptors<T, C>(interceptors || []);\n            this._composedInterceptorByKey.set(key, composed);\n        }\n\n        return composed;\n    }\n\n    private _interceptWorkbook(workbook: Workbook): void {\n        const disposables = new DisposableCollection();\n        const unitId = workbook.getUnitId();\n\n        // eslint-disable-next-line ts/no-this-alias\n        const sheetInterceptorService = this;\n        const interceptViewModel = (worksheet: Worksheet): void => {\n            const subUnitId = worksheet.getSheetId();\n            worksheet.__interceptViewModel((viewModel) => {\n                const sheetDisposables = new DisposableCollection();\n                sheetInterceptorService._worksheetDisposables.set(getWorksheetDisposableID(unitId, worksheet), sheetDisposables);\n\n                sheetDisposables.add(viewModel.registerCellContentInterceptor({\n                    getCell(\n                        row: number,\n                        col: number,\n                        effect: InterceptorEffectEnum,\n                        key?: string,\n                        filter?: (interceptor: IInterceptor<any, any>) => boolean\n                    ): Nullable<ICellData> {\n                        const rawData = worksheet.getCellRaw(row, col);\n                        return sheetInterceptorService.fetchThroughInterceptors(INTERCEPTOR_POINT.CELL_CONTENT, effect, key, filter)(\n                            rawData,\n                            {\n                                unitId,\n                                subUnitId,\n                                row,\n                                col,\n                                worksheet,\n                                workbook,\n                                rawData,\n                            }\n                        );\n                    },\n                }));\n\n                sheetDisposables.add(viewModel.registerRowFilteredInterceptor({\n                    getRowFiltered(row: number): boolean {\n                        return !!sheetInterceptorService.fetchThroughInterceptors(INTERCEPTOR_POINT.ROW_FILTERED)(\n                            false,\n                            {\n                                unitId,\n                                subUnitId,\n                                row,\n                                workbook,\n                                worksheet,\n                            }\n                        );\n                    },\n                }));\n            });\n        };\n\n        // We should intercept all instantiated worksheet and should subscribe to\n        // worksheet creation event to intercept newly created worksheet.\n        workbook.getSheets().forEach((worksheet) => interceptViewModel(worksheet));\n        disposables.add(workbook.sheetCreated$.subscribe((worksheet) => interceptViewModel(worksheet)));\n\n        // Dispose all underlying interceptors when workbook is disposed.\n        disposables.add(toDisposable(() => workbook.getSheets().forEach((worksheet) => this._disposeSheetInterceptor(unitId, worksheet))));\n        // Dispose interceptor when a worksheet is destroyed.\n        disposables.add(workbook.sheetDisposed$.subscribe((worksheet) => this._disposeSheetInterceptor(unitId, worksheet)));\n\n        this._workbookDisposables.set(unitId, disposables);\n    }\n\n    private _disposeWorkbookInterceptor(workbook: Workbook): void {\n        const unitId = workbook.getUnitId();\n        const disposable = this._workbookDisposables.get(unitId);\n\n        if (disposable) {\n            disposable.dispose();\n            this._workbookDisposables.delete(unitId);\n        }\n    }\n\n    private _disposeSheetInterceptor(unitId: string, worksheet: Worksheet): void {\n        const disposableId = getWorksheetDisposableID(unitId, worksheet);\n        const disposable = this._worksheetDisposables.get(disposableId);\n\n        if (disposable) {\n            disposable.dispose();\n            this._worksheetDisposables.delete(disposableId);\n        }\n    }\n}\n\nfunction getWorksheetDisposableID(unitId: string, worksheet: Worksheet): string {\n    return `${unitId}|${worksheet.getSheetId()}`;\n}\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"e8fae290e776aad55f3370861ebfec9517e4fb57"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/move-range.command.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/move-range.command.ts","statementMap":{"0":{"start":{"line":21,"column":34},"end":{"line":21,"column":60}},"1":{"start":{"line":22,"column":32},"end":{"line":96,"column":1}},"2":{"start":{"line":26,"column":27},"end":{"line":26,"column":56}},"3":{"start":{"line":27,"column":28},"end":{"line":27,"column":58}},"4":{"start":{"line":28,"column":34},"end":{"line":28,"column":70}},"5":{"start":{"line":29,"column":25},"end":{"line":29,"column":51}},"6":{"start":{"line":30,"column":26},"end":{"line":30,"column":53}},"7":{"start":{"line":31,"column":36},"end":{"line":31,"column":73}},"8":{"start":{"line":32,"column":19},"end":{"line":32,"column":63}},"9":{"start":{"line":33,"column":4},"end":{"line":33,"column":30}},"10":{"start":{"line":33,"column":17},"end":{"line":33,"column":30}},"11":{"start":{"line":34,"column":20},"end":{"line":34,"column":107}},"12":{"start":{"line":35,"column":4},"end":{"line":37,"column":5}},"13":{"start":{"line":36,"column":6},"end":{"line":36,"column":19}},"14":{"start":{"line":38,"column":45},"end":{"line":38,"column":51}},"15":{"start":{"line":39,"column":31},"end":{"line":43,"column":5}},"16":{"start":{"line":44,"column":4},"end":{"line":47,"column":5}},"17":{"start":{"line":45,"column":6},"end":{"line":45,"column":73}},"18":{"start":{"line":46,"column":6},"end":{"line":46,"column":19}},"19":{"start":{"line":48,"column":32},"end":{"line":51,"column":6}},"20":{"start":{"line":52,"column":18},"end":{"line":65,"column":5}},"21":{"start":{"line":66,"column":18},"end":{"line":79,"column":5}},"22":{"start":{"line":80,"column":19},"end":{"line":80,"column":64}},"23":{"start":{"line":81,"column":30},"end":{"line":84,"column":6}},"24":{"start":{"line":85,"column":4},"end":{"line":93,"column":5}},"25":{"start":{"line":86,"column":6},"end":{"line":86,"column":63}},"26":{"start":{"line":87,"column":6},"end":{"line":91,"column":9}},"27":{"start":{"line":92,"column":6},"end":{"line":92,"column":18}},"28":{"start":{"line":94,"column":4},"end":{"line":94,"column":17}},"29":{"start":{"line":98,"column":16},"end":{"line":98,"column":18}},"30":{"start":{"line":99,"column":16},"end":{"line":99,"column":18}},"31":{"start":{"line":100,"column":65},"end":{"line":100,"column":69}},"32":{"start":{"line":101,"column":53},"end":{"line":101,"column":55}},"33":{"start":{"line":102,"column":32},"end":{"line":102,"column":68}},"34":{"start":{"line":103,"column":19},"end":{"line":103,"column":71}},"35":{"start":{"line":104,"column":22},"end":{"line":104,"column":62}},"36":{"start":{"line":105,"column":24},"end":{"line":105,"column":66}},"37":{"start":{"line":106,"column":23},"end":{"line":106,"column":51}},"38":{"start":{"line":107,"column":25},"end":{"line":107,"column":55}},"39":{"start":{"line":108,"column":2},"end":{"line":169,"column":3}},"40":{"start":{"line":109,"column":36},"end":{"line":109,"column":90}},"41":{"start":{"line":110,"column":4},"end":{"line":112,"column":5}},"42":{"start":{"line":111,"column":6},"end":{"line":111,"column":18}},"43":{"start":{"line":113,"column":26},"end":{"line":113,"column":44}},"44":{"start":{"line":114,"column":29},"end":{"line":114,"column":47}},"45":{"start":{"line":115,"column":26},"end":{"line":115,"column":44}},"46":{"start":{"line":116,"column":4},"end":{"line":124,"column":7}},"47":{"start":{"line":117,"column":23},"end":{"line":117,"column":56}},"48":{"start":{"line":118,"column":6},"end":{"line":118,"column":66}},"49":{"start":{"line":119,"column":6},"end":{"line":122,"column":7}},"50":{"start":{"line":120,"column":22},"end":{"line":120,"column":59}},"51":{"start":{"line":121,"column":8},"end":{"line":121,"column":65}},"52":{"start":{"line":123,"column":6},"end":{"line":123,"column":48}},"53":{"start":{"line":125,"column":24},"end":{"line":125,"column":42}},"54":{"start":{"line":126,"column":27},"end":{"line":126,"column":45}},"55":{"start":{"line":127,"column":4},"end":{"line":129,"column":7}},"56":{"start":{"line":128,"column":6},"end":{"line":128,"column":87}},"57":{"start":{"line":130,"column":4},"end":{"line":140,"column":7}},"58":{"start":{"line":131,"column":24},"end":{"line":131,"column":45}},"59":{"start":{"line":132,"column":28},"end":{"line":132,"column":76}},"60":{"start":{"line":133,"column":20},"end":{"line":133,"column":70}},"61":{"start":{"line":134,"column":25},"end":{"line":134,"column":74}},"62":{"start":{"line":135,"column":24},"end":{"line":135,"column":73}},"63":{"start":{"line":136,"column":6},"end":{"line":138,"column":7}},"64":{"start":{"line":137,"column":8},"end":{"line":137,"column":33}},"65":{"start":{"line":139,"column":6},"end":{"line":139,"column":76}},"66":{"start":{"line":141,"column":32},"end":{"line":153,"column":5}},"67":{"start":{"line":154,"column":34},"end":{"line":166,"column":5}},"68":{"start":{"line":167,"column":4},"end":{"line":167,"column":74}},"69":{"start":{"line":168,"column":4},"end":{"line":168,"column":76}},"70":{"start":{"line":170,"column":2},"end":{"line":173,"column":4}},"71":{"start":{"line":176,"column":19},"end":{"line":176,"column":37}},"72":{"start":{"line":177,"column":22},"end":{"line":177,"column":43}},"73":{"start":{"line":178,"column":20},"end":{"line":178,"column":66}},"74":{"start":{"line":179,"column":14},"end":{"line":179,"column":52}},"75":{"start":{"line":180,"column":2},"end":{"line":189,"column":3}},"76":{"start":{"line":181,"column":26},"end":{"line":181,"column":67}},"77":{"start":{"line":182,"column":26},"end":{"line":182,"column":73}},"78":{"start":{"line":183,"column":4},"end":{"line":183,"column":50}},"79":{"start":{"line":184,"column":4},"end":{"line":184,"column":56}},"80":{"start":{"line":185,"column":4},"end":{"line":185,"column":33}},"81":{"start":{"line":186,"column":4},"end":{"line":186,"column":39}},"82":{"start":{"line":187,"column":4},"end":{"line":187,"column":25}},"83":{"start":{"line":188,"column":4},"end":{"line":188,"column":32}},"84":{"start":{"line":190,"column":2},"end":{"line":190,"column":13}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":25,"column":11},"end":{"line":25,"column":12}},"loc":{"start":{"line":25,"column":39},"end":{"line":95,"column":3}},"line":25},"1":{"name":"getMoveRangeUndoRedoMutations","decl":{"start":{"line":97,"column":16},"end":{"line":97,"column":45}},"loc":{"start":{"line":97,"column":87},"end":{"line":174,"column":1}},"line":97},"2":{"name":"(anonymous_2)","decl":{"start":{"line":116,"column":29},"end":{"line":116,"column":30}},"loc":{"start":{"line":116,"column":43},"end":{"line":124,"column":5}},"line":116},"3":{"name":"(anonymous_3)","decl":{"start":{"line":127,"column":27},"end":{"line":127,"column":28}},"loc":{"start":{"line":127,"column":41},"end":{"line":129,"column":5}},"line":127},"4":{"name":"(anonymous_4)","decl":{"start":{"line":130,"column":29},"end":{"line":130,"column":30}},"loc":{"start":{"line":130,"column":43},"end":{"line":140,"column":5}},"line":130},"5":{"name":"getPrimaryAfterMove","decl":{"start":{"line":175,"column":9},"end":{"line":175,"column":28}},"loc":{"start":{"line":175,"column":60},"end":{"line":191,"column":1}},"line":175}},"branchMap":{"0":{"loc":{"start":{"line":33,"column":4},"end":{"line":33,"column":30}},"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":33,"column":30}},{"start":{},"end":{}}],"line":33},"1":{"loc":{"start":{"line":35,"column":4},"end":{"line":37,"column":5}},"type":"if","locations":[{"start":{"line":35,"column":4},"end":{"line":37,"column":5}},{"start":{},"end":{}}],"line":35},"2":{"loc":{"start":{"line":44,"column":4},"end":{"line":47,"column":5}},"type":"if","locations":[{"start":{"line":44,"column":4},"end":{"line":47,"column":5}},{"start":{},"end":{}}],"line":44},"3":{"loc":{"start":{"line":53,"column":9},"end":{"line":53,"column":43}},"type":"binary-expr","locations":[{"start":{"line":53,"column":9},"end":{"line":53,"column":37}},{"start":{"line":53,"column":41},"end":{"line":53,"column":43}}],"line":53},"4":{"loc":{"start":{"line":67,"column":9},"end":{"line":67,"column":43}},"type":"binary-expr","locations":[{"start":{"line":67,"column":9},"end":{"line":67,"column":37}},{"start":{"line":67,"column":41},"end":{"line":67,"column":43}}],"line":67},"5":{"loc":{"start":{"line":85,"column":4},"end":{"line":93,"column":5}},"type":"if","locations":[{"start":{"line":85,"column":4},"end":{"line":93,"column":5}},{"start":{},"end":{}}],"line":85},"6":{"loc":{"start":{"line":97,"column":66},"end":{"line":97,"column":85}},"type":"default-arg","locations":[{"start":{"line":97,"column":80},"end":{"line":97,"column":85}}],"line":97},"7":{"loc":{"start":{"line":108,"column":2},"end":{"line":169,"column":3}},"type":"if","locations":[{"start":{"line":108,"column":2},"end":{"line":169,"column":3}},{"start":{},"end":{}}],"line":108},"8":{"loc":{"start":{"line":108,"column":6},"end":{"line":108,"column":68}},"type":"binary-expr","locations":[{"start":{"line":108,"column":6},"end":{"line":108,"column":17}},{"start":{"line":108,"column":21},"end":{"line":108,"column":34}},{"start":{"line":108,"column":38},"end":{"line":108,"column":50}},{"start":{"line":108,"column":54},"end":{"line":108,"column":68}}],"line":108},"9":{"loc":{"start":{"line":110,"column":4},"end":{"line":112,"column":5}},"type":"if","locations":[{"start":{"line":110,"column":4},"end":{"line":112,"column":5}},{"start":{},"end":{}}],"line":110},"10":{"loc":{"start":{"line":110,"column":8},"end":{"line":110,"column":75}},"type":"binary-expr","locations":[{"start":{"line":110,"column":8},"end":{"line":110,"column":59}},{"start":{"line":110,"column":63},"end":{"line":110,"column":75}}],"line":110},"11":{"loc":{"start":{"line":119,"column":6},"end":{"line":122,"column":7}},"type":"if","locations":[{"start":{"line":119,"column":6},"end":{"line":122,"column":7}},{"start":{},"end":{}}],"line":119},"12":{"loc":{"start":{"line":136,"column":6},"end":{"line":138,"column":7}},"type":"if","locations":[{"start":{"line":136,"column":6},"end":{"line":138,"column":7}},{"start":{},"end":{}}],"line":136},"13":{"loc":{"start":{"line":136,"column":10},"end":{"line":136,"column":33}},"type":"binary-expr","locations":[{"start":{"line":136,"column":10},"end":{"line":136,"column":19}},{"start":{"line":136,"column":23},"end":{"line":136,"column":33}}],"line":136},"14":{"loc":{"start":{"line":180,"column":2},"end":{"line":189,"column":3}},"type":"if","locations":[{"start":{"line":180,"column":2},"end":{"line":189,"column":3}},{"start":{},"end":{}}],"line":180}},"s":{"0":1,"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":2,"30":2,"31":2,"32":2,"33":2,"34":2,"35":2,"36":2,"37":2,"38":2,"39":2,"40":2,"41":2,"42":0,"43":2,"44":2,"45":2,"46":2,"47":7,"48":7,"49":7,"50":3,"51":3,"52":7,"53":2,"54":2,"55":2,"56":7,"57":2,"58":7,"59":7,"60":7,"61":7,"62":7,"63":7,"64":0,"65":7,"66":2,"67":2,"68":2,"69":2,"70":2,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0},"f":{"0":0,"1":2,"2":7,"3":7,"4":7,"5":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0],"7":[2,0],"8":[2,2,2,2],"9":[0,2],"10":[2,0],"11":[3,4],"12":[0,7],"13":[7,3],"14":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/move-range.command.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICellData, ICommand, IMutationInfo, IRange, ISelectionCell, IStyleData, Nullable, Worksheet } from '@univerjs/core';\nimport type { IMoveRangeMutationParams } from '../mutations/move-range.mutation';\n\nimport type { ISetSelectionsOperationParams } from '../operations/selection.operation';\nimport {\n    cellToRange,\n    CommandType,\n    ErrorService,\n    ICommandService,\n    IUndoRedoService,\n    IUniverInstanceService,\n    LocaleService,\n    ObjectMatrix,\n    Range,\n    Rectangle,\n    sequenceExecute,\n    Tools,\n} from '@univerjs/core';\nimport { SelectionMoveType } from '../../services/selections/type';\nimport { SheetInterceptorService } from '../../services/sheet-interceptor/sheet-interceptor.service';\nimport { MoveRangeMutation } from '../mutations/move-range.mutation';\nimport { SetSelectionsOperation } from '../operations/selection.operation';\nimport { alignToMergedCellsBorders, getPrimaryForRange } from './utils/selection-utils';\nimport { getSheetCommandTarget } from './utils/target-util';\n\nexport interface IMoveRangeCommandParams {\n    toRange: IRange;\n    fromRange: IRange;\n}\nexport const MoveRangeCommandId = 'sheet.command.move-range';\n\nexport const MoveRangeCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: MoveRangeCommandId,\n\n    handler: async (accessor: IAccessor, params: IMoveRangeCommandParams) => {\n        const commandService = accessor.get(ICommandService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const errorService = accessor.get(ErrorService);\n        const localeService = accessor.get(LocaleService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const perform = await sheetInterceptorService.beforeCommandExecute({ id: MoveRangeCommand.id, params });\n\n        if (!perform) {\n            return false;\n        }\n\n        const { worksheet, subUnitId, unitId } = target;\n        const moveRangeMutations = getMoveRangeUndoRedoMutations(\n            accessor,\n            { unitId, subUnitId, range: params.fromRange },\n            { unitId, subUnitId, range: params.toRange }\n        );\n        if (moveRangeMutations === null) {\n            errorService.emit(localeService.t('sheets.info.acrossMergedCell'));\n            return false;\n        }\n\n        const interceptorCommands = sheetInterceptorService.onCommandExecute({\n            id: MoveRangeCommand.id,\n            params: { ...params },\n        });\n\n        const redos = [\n            ...(interceptorCommands.preRedos ?? []),\n            ...moveRangeMutations.redos,\n            ...interceptorCommands.redos,\n            {\n                id: SetSelectionsOperation.id,\n                params: {\n                    unitId,\n                    subUnitId,\n                    selections: [{ range: params.toRange, primary: getPrimaryAfterMove(params.fromRange, params.toRange, worksheet) }],\n                    type: SelectionMoveType.MOVE_END,\n                } as ISetSelectionsOperationParams,\n            },\n        ];\n        const undos = [\n            ...(interceptorCommands.preUndos ?? []),\n            ...moveRangeMutations.undos,\n            ...interceptorCommands.undos,\n            {\n                id: SetSelectionsOperation.id,\n                params: {\n                    unitId,\n                    subUnitId,\n                    selections: [{ range: params.fromRange, primary: getPrimaryForRange(params.fromRange, worksheet) }],\n                    type: SelectionMoveType.MOVE_END,\n                } as ISetSelectionsOperationParams,\n            },\n        ];\n\n        const result = sequenceExecute(redos, commandService).result;\n\n        const afterInterceptors = sheetInterceptorService.afterCommandExecute({\n            id: MoveRangeCommand.id,\n            params: { ...params },\n        });\n\n        if (result) {\n            sequenceExecute(afterInterceptors.redos, commandService);\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: [...undos, ...afterInterceptors.undos],\n                redoMutations: [...redos, ...afterInterceptors.redos],\n            });\n            return true;\n        }\n        return false;\n    },\n};\n\nexport interface IRangeUnit {\n    unitId: string;\n    subUnitId: string;\n    range: IRange;\n}\n\n// eslint-disable-next-line max-lines-per-function\nexport function getMoveRangeUndoRedoMutations(\n    accessor: IAccessor,\n    from: IRangeUnit,\n    to: IRangeUnit,\n    ignoreMerge = false\n) {\n    const redos: IMutationInfo[] = [];\n    const undos: IMutationInfo[] = [];\n    const { range: fromRange, subUnitId: fromSubUnitId, unitId } = from;\n    const { range: toRange, subUnitId: toSubUnitId } = to;\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const workbook = univerInstanceService.getUniverSheetInstance(unitId);\n    const toWorksheet = workbook?.getSheetBySheetId(toSubUnitId);\n    const fromWorksheet = workbook?.getSheetBySheetId(fromSubUnitId);\n    const toCellMatrix = toWorksheet?.getCellMatrix();\n    const fromCellMatrix = fromWorksheet?.getCellMatrix();\n    if (toWorksheet && fromWorksheet && toCellMatrix && fromCellMatrix) {\n        const alignedRangeWithToRange = alignToMergedCellsBorders(toRange, toWorksheet, false);\n\n        if (!Rectangle.equals(toRange, alignedRangeWithToRange) && !ignoreMerge) {\n            return null;\n        }\n\n        const fromCellValue = new ObjectMatrix<Nullable<ICellData>>();\n        const newFromCellValue = new ObjectMatrix<Nullable<ICellData>>();\n        const fromCellStyle = new ObjectMatrix<Nullable<IStyleData>>();\n\n        Range.foreach(fromRange, (row, col) => {\n            const cellData = fromCellMatrix.getValue(row, col);\n            fromCellValue.setValue(row, col, Tools.deepClone(cellData));\n            if (cellData) {\n                const style = workbook?.getStyles().get(cellData.s);\n                fromCellStyle.setValue(row, col, Tools.deepClone(style));\n            }\n            newFromCellValue.setValue(row, col, null);\n        });\n        const toCellValue = new ObjectMatrix<Nullable<ICellData>>();\n        const newToCellValue = new ObjectMatrix<Nullable<ICellData>>();\n\n        Range.foreach(toRange, (row, col) => {\n            toCellValue.setValue(row, col, Tools.deepClone(toCellMatrix.getValue(row, col)));\n        });\n\n        Range.foreach(fromRange, (row, col) => {\n            const cellRange = cellToRange(row, col);\n            const relativeRange = Rectangle.getRelativeRange(cellRange, fromRange);\n            const range = Rectangle.getPositionRange(relativeRange, toRange);\n\n            const styleValue = Tools.deepClone(fromCellStyle.getValue(row, col));\n            const cellValue = Tools.deepClone(fromCellValue.getValue(row, col));\n            if (cellValue && styleValue) {\n                cellValue.s = styleValue;\n            }\n            newToCellValue.setValue(range.startRow, range.startColumn, cellValue);\n        });\n\n        const doMoveRangeMutation: IMoveRangeMutationParams = {\n            fromRange: from.range,\n            toRange: to.range,\n            from: {\n                value: newFromCellValue.getMatrix(),\n                subUnitId: fromSubUnitId,\n            },\n            to: {\n                value: newToCellValue.getMatrix(),\n                subUnitId: toSubUnitId,\n            },\n            unitId,\n        };\n        const undoMoveRangeMutation: IMoveRangeMutationParams = {\n            fromRange: to.range,\n            toRange: from.range,\n            from: {\n                value: fromCellValue.getMatrix(),\n                subUnitId: fromSubUnitId,\n            },\n            to: {\n                value: toCellValue.getMatrix(),\n                subUnitId: toSubUnitId,\n            },\n            unitId,\n        };\n\n        redos.push({ id: MoveRangeMutation.id, params: doMoveRangeMutation });\n        undos.push({ id: MoveRangeMutation.id, params: undoMoveRangeMutation });\n    }\n\n    return {\n        redos,\n        undos,\n    };\n}\n\n// Before moveRange is executed, the target area has no merge cell yet.\n// So need to get the merge info of the start cell and then transform it\nfunction getPrimaryAfterMove(fromRange: IRange, toRange: IRange, worksheet: Worksheet): ISelectionCell {\n    const startRow = fromRange.startRow;\n    const startColumn = fromRange.startColumn;\n    const mergeInfo = worksheet.getMergedCell(startRow, startColumn);\n\n    const res = getPrimaryForRange(toRange, worksheet);\n    if (mergeInfo) {\n        const mergeRowCount = mergeInfo.endRow - mergeInfo.startRow + 1;\n        const mergeColCount = mergeInfo.endColumn - mergeInfo.startColumn + 1;\n        res.endRow = res.startRow + mergeRowCount - 1;\n        res.endColumn = res.startColumn + mergeColCount - 1;\n        res.actualRow = res.startRow;\n        res.actualColumn = res.startColumn;\n        res.isMerged = false;\n        res.isMergedMainCell = true;\n    }\n\n    return res;\n}\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"35e6db448db8c7e1339eef1e383aaf6892ad4ce8"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/index.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/index.ts","statementMap":{},"fnMap":{},"branchMap":{},"s":{},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/index.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport { RangeProtectionPermissionEditPoint } from './range/edit';\nexport { RangeProtectionPermissionViewPoint } from './range/view';\nexport { WorkbookCommentPermission } from './workbook/comment';\nexport { WorkbookCopyPermission } from './workbook/copy';\nexport { WorkbookCopySheetPermission } from './workbook/copy-sheet';\nexport { WorkbookCreateProtectPermission } from './workbook/create-permission';\nexport { WorkbookCreateSheetPermission } from './workbook/create-sheet';\nexport { WorkbookDeleteSheetPermission } from './workbook/delete-sheet';\nexport { WorkbookDuplicatePermission } from './workbook/duplicate';\nexport { WorkbookEditablePermission } from './workbook/editable';\nexport { WorkbookExportPermission } from './workbook/export';\nexport { WorkbookHideSheetPermission } from './workbook/hide-sheet';\nexport { WorkbookHistoryPermission } from './workbook/history';\nexport { WorkbookManageCollaboratorPermission } from './workbook/manage-collaborator';\nexport { WorkbookMoveSheetPermission } from './workbook/move-sheet';\nexport { WorkbookPrintPermission } from './workbook/print';\nexport { WorkbookRecoverHistoryPermission } from './workbook/recover-history';\nexport { WorkbookRenameSheetPermission } from './workbook/rename-sheet';\nexport { WorkbookSharePermission } from './workbook/share';\nexport { WorkbookViewPermission } from './workbook/view';\n\nexport { WorkbookViewHistoryPermission } from './workbook/view-history';\nexport { WorksheetCopyPermission } from './worksheet/copy';\nexport { WorksheetDeleteColumnPermission } from './worksheet/delete-column';\nexport { WorksheetDeleteProtectionPermission } from './worksheet/delete-protection';\nexport { WorksheetDeleteRowPermission } from './worksheet/delete-row';\nexport { WorksheetEditPermission } from './worksheet/edit';\nexport { WorksheetEditExtraObjectPermission } from './worksheet/edit-extra-object';\nexport { WorksheetFilterPermission } from './worksheet/filter';\nexport { WorksheetInsertColumnPermission } from './worksheet/insert-column';\nexport { WorksheetInsertHyperlinkPermission } from './worksheet/insert-hyperlink';\nexport { WorksheetInsertRowPermission } from './worksheet/insert-row';\nexport { WorksheetManageCollaboratorPermission } from './worksheet/manage-collaborator';\nexport { WorksheetPivotTablePermission } from './worksheet/pivot-table';\nexport { WorksheetSelectProtectedCellsPermission } from './worksheet/select-protected-cells';\nexport { WorksheetSelectUnProtectedCellsPermission } from './worksheet/select-un-protected-cells';\nexport { WorksheetSetCellStylePermission } from './worksheet/set-cell-style';\nexport { WorksheetSetCellValuePermission } from './worksheet/set-cell-value';\nexport { WorksheetSetColumnStylePermission } from './worksheet/set-column-style';\nexport { WorksheetSetRowStylePermission } from './worksheet/set-row-style';\n\nexport { WorksheetSortPermission } from './worksheet/sort';\nexport { WorksheetViewPermission } from './worksheet/view';\n"],"mappings":"AAgBA,SAAS,0CAA0C;AACnD,SAAS,0CAA0C;AACnD,SAAS,iCAAiC;AAC1C,SAAS,8BAA8B;AACvC,SAAS,mCAAmC;AAC5C,SAAS,uCAAuC;AAChD,SAAS,qCAAqC;AAC9C,SAAS,qCAAqC;AAC9C,SAAS,mCAAmC;AAC5C,SAAS,kCAAkC;AAC3C,SAAS,gCAAgC;AACzC,SAAS,mCAAmC;AAC5C,SAAS,iCAAiC;AAC1C,SAAS,4CAA4C;AACrD,SAAS,mCAAmC;AAC5C,SAAS,+BAA+B;AACxC,SAAS,wCAAwC;AACjD,SAAS,qCAAqC;AAC9C,SAAS,+BAA+B;AACxC,SAAS,8BAA8B;AAEvC,SAAS,qCAAqC;AAC9C,SAAS,+BAA+B;AACxC,SAAS,uCAAuC;AAChD,SAAS,2CAA2C;AACpD,SAAS,oCAAoC;AAC7C,SAAS,+BAA+B;AACxC,SAAS,0CAA0C;AACnD,SAAS,iCAAiC;AAC1C,SAAS,uCAAuC;AAChD,SAAS,0CAA0C;AACnD,SAAS,oCAAoC;AAC7C,SAAS,6CAA6C;AACtD,SAAS,qCAAqC;AAC9C,SAAS,+CAA+C;AACxD,SAAS,iDAAiD;AAC1D,SAAS,uCAAuC;AAChD,SAAS,uCAAuC;AAChD,SAAS,yCAAyC;AAClD,SAAS,sCAAsC;AAE/C,SAAS,+BAA+B;AACxC,SAAS,+BAA+B;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"fa4266c34bfe75a1f0cfdd2a4a5ffa2d40e38efe"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/edit.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/edit.ts","statementMap":{"0":{"start":{"line":4,"column":9},"end":{"line":4,"column":31}},"1":{"start":{"line":5,"column":12},"end":{"line":5,"column":27}},"2":{"start":{"line":6,"column":11},"end":{"line":6,"column":32}},"3":{"start":{"line":7,"column":10},"end":{"line":7,"column":14}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":25}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":31}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":37}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":77}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":2},"end":{"line":12,"column":3}},"loc":{"start":{"line":12,"column":47},"end":{"line":17,"column":3}},"line":12}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/edit.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\nimport type { IPermissionPoint } from '@univerjs/core';\n\nexport class RangeProtectionPermissionEditPoint implements IPermissionPoint {\n    type = UnitObject.SelectRange;\n    subType = UnitAction.Edit;\n    status = PermissionStatus.INIT;\n    value = true;\n    id: string;\n    unitId: string;\n    subUnitId: string;\n    permissionId: string;\n    constructor(unitId: string, subUnitId: string, permissionId: string) {\n        this.unitId = unitId;\n        this.subUnitId = subUnitId;\n        this.permissionId = permissionId;\n        this.id = `${UnitObject.SelectRange}.${UnitAction.Edit}.${permissionId}`;\n    }\n}\n"],"mappings":"AAgBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAGhC,aAAM,mCAA+D;AAAA,EACxE,OAAO,WAAW;AAAA,EAClB,UAAU,WAAW;AAAA,EACrB,SAAS,iBAAiB;AAAA,EAC1B,QAAQ;AAAA,EACR;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,YAAY,QAAgB,WAAmB,cAAsB;AACjE,SAAK,SAAS;AACd,SAAK,YAAY;AACjB,SAAK,eAAe;AACpB,SAAK,KAAK,GAAG,WAAW,WAAW,IAAI,WAAW,IAAI,IAAI,YAAY;AAAA,EAC1E;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"1f979d45273f5510d2a13dcfd8d8a2ce2f4f7e33"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/view.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/view.ts","statementMap":{"0":{"start":{"line":4,"column":9},"end":{"line":4,"column":31}},"1":{"start":{"line":5,"column":12},"end":{"line":5,"column":27}},"2":{"start":{"line":6,"column":11},"end":{"line":6,"column":32}},"3":{"start":{"line":7,"column":10},"end":{"line":7,"column":14}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":25}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":31}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":37}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":77}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":2},"end":{"line":12,"column":3}},"loc":{"start":{"line":12,"column":47},"end":{"line":17,"column":3}},"line":12}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/view.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class RangeProtectionPermissionViewPoint implements IPermissionPoint {\n    type = UnitObject.SelectRange;\n    subType = UnitAction.View;\n    status = PermissionStatus.INIT;\n    value = true;\n    id: string;\n    unitId: string;\n    subUnitId: string;\n    permissionId: string;\n    constructor(unitId: string, subUnitId: string, permissionId: string) {\n        this.unitId = unitId;\n        this.subUnitId = subUnitId;\n        this.permissionId = permissionId;\n        this.id = `${UnitObject.SelectRange}.${UnitAction.View}.${permissionId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,mCAA+D;AAAA,EACxE,OAAO,WAAW;AAAA,EAClB,UAAU,WAAW;AAAA,EACrB,SAAS,iBAAiB;AAAA,EAC1B,QAAQ;AAAA,EACR;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,YAAY,QAAgB,WAAmB,cAAsB;AACjE,SAAK,SAAS;AACd,SAAK,YAAY;AACjB,SAAK,eAAe;AACpB,SAAK,KAAK,GAAG,WAAW,WAAW,IAAI,WAAW,IAAI,IAAI,YAAY;AAAA,EAC1E;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a103a7ade3c1ac529d07805a0dcbb27f4201432b"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/comment.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/comment.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":61}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":30}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/comment.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookCommentPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Comment;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Comment}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,0BAAsD;AAAA,EAO/D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,OAAO,IAAI,MAAM;AAAA,EAC1D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"acb1d70be03de548d6cf145bdabfd267faa5e05d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/copy.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/copy.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":58}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/copy.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookCopyPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Copy;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Copy}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,uBAAmD;AAAA,EAO5D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM;AAAA,EACvD;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"59b0fc2a437bf6fda1be8ba3917a57290157dcc7"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/copy-sheet.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/copy-sheet.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":63}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":12},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":11},"end":{"line":13,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/copy-sheet.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookCopySheetPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    subType = UnitAction.CopySheet;\n    status = PermissionStatus.INIT;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.CopySheet}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,4BAAwD;AAAA,EAOjE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,SAAS,IAAI,MAAM;AAAA,EAC5D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,UAAU,WAAW;AAAA,EACrB,SAAS,iBAAiB;AAM9B;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d181d2ad7a5923b0db812c30e34a0bcc0c5f555d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/create-permission.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/create-permission.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":76}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":45}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/create-permission.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookCreateProtectPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.CreatePermissionObject;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.CreatePermissionObject}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,gCAA4D;AAAA,EAOrE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,sBAAsB,IAAI,MAAM;AAAA,EACzE;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"320bd8d74183d935d56676a52764bebc5a680592"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/create-sheet.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/create-sheet.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":65}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/create-sheet.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookCreateSheetPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.CreateSheet;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.CreateSheet}_${unitId}` as string;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,8BAA0D;AAAA,EAOnE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,WAAW,IAAI,MAAM;AAAA,EAC9D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b80d74a3af8531ed64550fe04162d07c640c05ac"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/delete-sheet.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/delete-sheet.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":65}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/delete-sheet.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookDeleteSheetPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.DeleteSheet;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.DeleteSheet}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,8BAA0D;AAAA,EAOnE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,WAAW,IAAI,MAAM;AAAA,EAC9D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8f6eb134a8444fc3a13fd7d7e1d2fd85e1f6d424"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/duplicate.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/duplicate.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":63}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/duplicate.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookDuplicatePermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Duplicate;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Duplicate}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,4BAAwD;AAAA,EAOjE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,SAAS,IAAI,MAAM;AAAA,EAC5D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"64e2b236449a0acc8b0b7d3de96c6467f50a910b"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/editable.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/editable.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":58}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/editable.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookEditablePermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Edit;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Edit}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,2BAAuD;AAAA,EAOhE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM;AAAA,EACvD;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"6e0d59c5d6d9527843b57ac21a4b28d9797c37e2"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/export.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/export.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":60}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":29}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/export.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookExportPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Export;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Export}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,yBAAqD;AAAA,EAO9D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,MAAM,IAAI,MAAM;AAAA,EACzD;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8de16c24a19f99ef977b1550ecf0c75af3f24d56"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/hide-sheet.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/hide-sheet.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":63}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/hide-sheet.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookHideSheetPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.HideSheet;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.HideSheet}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,4BAAwD;AAAA,EAOjE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,SAAS,IAAI,MAAM;AAAA,EAC5D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"60bf1e36e89bc7f96f0e7559ece6242ff5c7134e"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/history.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/history.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":61}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":30}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/history.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookHistoryPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.History;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.History}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,0BAAsD;AAAA,EAO/D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,OAAO,IAAI,MAAM;AAAA,EAC1D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4aa618f5274448687c11ddc343128a2dd353aeda"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/manage-collaborator.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/manage-collaborator.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":72}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":41}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/manage-collaborator.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookManageCollaboratorPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.ManageCollaborator;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.ManageCollaborator}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,qCAAiE;AAAA,EAO1E,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,kBAAkB,IAAI,MAAM;AAAA,EACrE;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d9738d4246c11548c06873e8cce33c6d53612cc9"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/move-sheet.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/move-sheet.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":63}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/move-sheet.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookMoveSheetPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.MoveSheet;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.MoveSheet}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,4BAAwD;AAAA,EAOjE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,SAAS,IAAI,MAAM;AAAA,EAC5D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"5d93f4bec413312ab6ca902e276a835ab1cb29f8"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/print.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/print.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":59}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/print.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookPrintPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Print;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Print}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wBAAoD;AAAA,EAO7D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,KAAK,IAAI,MAAM;AAAA,EACxD;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c46c6b1ca99286ab7f9b18b2113279ef7afafa3f"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/recover-history.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/recover-history.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":68}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":37}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/recover-history.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookRecoverHistoryPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.RecoverHistory;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.RecoverHistory}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,iCAA6D;AAAA,EAOtE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,cAAc,IAAI,MAAM;AAAA,EACjE;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c38f9a9afee2f3057817c99cfe05b4d0560a926d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/rename-sheet.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/rename-sheet.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":65}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/rename-sheet.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookRenameSheetPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.RenameSheet;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.RenameSheet}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,8BAA0D;AAAA,EAOnE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,WAAW,IAAI,MAAM;AAAA,EAC9D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c383f4f41f9cfd68575dafeff179fa5f3922908c"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/share.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/share.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":59}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/share.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookSharePermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.Share;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.Share}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wBAAoD;AAAA,EAO7D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,KAAK,IAAI,MAAM;AAAA,EACxD;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8e8b4f15b99f6622512b834c06982b1d9952d1af"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/view.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/view.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":58}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/view.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookViewPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.View;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.View}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,uBAAmD;AAAA,EAO5D,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM;AAAA,EACvD;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f56cae2d7543fcf71af6451f909e1188713e655e"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/view-history.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/view-history.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":65}},"3":{"start":{"line":10,"column":10},"end":{"line":10,"column":14}},"4":{"start":{"line":11,"column":9},"end":{"line":11,"column":28}},"5":{"start":{"line":12,"column":11},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":22},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/workbook/view-history.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorkbookViewHistoryPermission implements IPermissionPoint {\n    id: string;\n    value = true;\n    type = UnitObject.Workbook;\n    status = PermissionStatus.INIT;\n    subType = UnitAction.ViewHistory;\n\n    constructor(public unitId: string) {\n        this.unitId = unitId;\n        this.id = `${this.type}.${UnitAction.ViewHistory}_${unitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,8BAA0D;AAAA,EAOnE,YAAmB,QAAgB;AAAhB;AACf,SAAK,SAAS;AACd,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,WAAW,IAAI,MAAM;AAAA,EAC9D;AAAA,EATA;AAAA,EACA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B,UAAU,WAAW;AAMzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"38f11cb409b273b5765689ea65528dd1c4144e38"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/copy.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/copy.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":71}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/copy.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetCopyPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.Copy;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.Copy}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wBAAoD;AAAA,EAM7D,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM,IAAI,SAAS;AAAA,EACpE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"edb6eab66d507ad7af58e27df19ebe85aae589df"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-column.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-column.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":79}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-column.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetDeleteColumnPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.DeleteColumn;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.DeleteColumn}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,gCAA4D;AAAA,EAMrE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,YAAY,IAAI,MAAM,IAAI,SAAS;AAAA,EAC5E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"657e5ebfa657abd820172f0924841baddd268e1f"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-protection.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-protection.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":73}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":29}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-protection.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetDeleteProtectionPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.Delete;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.Delete}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,oCAAgE;AAAA,EAMzE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,MAAM,IAAI,MAAM,IAAI,SAAS;AAAA,EACtE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"80bbe7442806cc5fb316b375a9203d12fe8217f6"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-row.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-row.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":76}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/delete-row.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetDeleteRowPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.DeleteRow;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.DeleteRow}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,6BAAyD;AAAA,EAMlE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,SAAS,IAAI,MAAM,IAAI,SAAS;AAAA,EACzE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f3e624df8bd63beb6e411a183402a6a2821391e1"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/edit.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/edit.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":71}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/edit.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetEditPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.Edit;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.Edit}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wBAAoD;AAAA,EAM7D,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM,IAAI,SAAS;AAAA,EACpE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"90cd3e55ce78bdf2284bbd5d5aebe3e712571f25"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/edit-extra-object.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/edit-extra-object.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":82}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/edit-extra-object.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetEditExtraObjectPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.EditExtraObject;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.EditExtraObject}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,mCAA+D;AAAA,EAMxE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,eAAe,IAAI,MAAM,IAAI,SAAS;AAAA,EAC/E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8854e96e5038b199172845fc04f522bd027a4409"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/filter.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/filter.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":73}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":29}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/filter.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetFilterPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.Filter;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.Filter}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,0BAAsD;AAAA,EAM/D,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,MAAM,IAAI,MAAM,IAAI,SAAS;AAAA,EACtE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d568570ec793378990983e537584027ec3014255"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-column.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-column.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":79}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-column.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetInsertColumnPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.InsertColumn;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.InsertColumn}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,gCAA4D;AAAA,EAMrE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,YAAY,IAAI,MAAM,IAAI,SAAS;AAAA,EAC5E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"003eaca68a726878766369e89d516c6822545850"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-hyperlink.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-hyperlink.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":82}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-hyperlink.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetInsertHyperlinkPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.InsertHyperlink;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.InsertHyperlink}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,mCAA+D;AAAA,EAMxE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,eAAe,IAAI,MAAM,IAAI,SAAS;AAAA,EAC/E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3a80156fc473dd4ebff9268ebbaa6ac7e9cefd9b"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-row.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-row.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":76}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/insert-row.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetInsertRowPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.InsertRow;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.InsertRow}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,6BAAyD;AAAA,EAMlE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,SAAS,IAAI,MAAM,IAAI,SAAS;AAAA,EACzE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"bebca7733858d3f60415904c18c179b0e87f922d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/manage-collaborator.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/manage-collaborator.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":85}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":41}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/manage-collaborator.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetManageCollaboratorPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.ManageCollaborator;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.ManageCollaborator}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,sCAAkE;AAAA,EAM3E,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,kBAAkB,IAAI,MAAM,IAAI,SAAS;AAAA,EAClF;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c16cdce57e4c261b4ecec4fd2a86965372522947"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/pivot-table.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/pivot-table.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":77}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":33}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/pivot-table.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetPivotTablePermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.PivotTable;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.PivotTable}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,8BAA0D;AAAA,EAMnE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,UAAU,IAAI,MAAM,IAAI,SAAS;AAAA,EAC1E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"58fdbf984a967c04831a859635aa181ad81c737f"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/select-protected-cells.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/select-protected-cells.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":87}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":43}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/select-protected-cells.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSelectProtectedCellsPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.SelectProtectedCells;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.SelectProtectedCells}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wCAAoE;AAAA,EAM7E,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,oBAAoB,IAAI,MAAM,IAAI,SAAS;AAAA,EACpF;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8481b1a839f1c62f07b2106c96bc1cad75e35741"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/select-un-protected-cells.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/select-un-protected-cells.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":89}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":45}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/select-un-protected-cells.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSelectUnProtectedCellsPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.SelectUnProtectedCells;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.SelectUnProtectedCells}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,0CAAsE;AAAA,EAM/E,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,sBAAsB,IAAI,MAAM,IAAI,SAAS;AAAA,EACtF;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"adb1791d3b95cb791b034b2322cfda7dbd7457ca"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-cell-style.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-cell-style.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":79}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-cell-style.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSetCellStylePermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.SetCellStyle;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.SetCellStyle}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,gCAA4D;AAAA,EAMrE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,YAAY,IAAI,MAAM,IAAI,SAAS;AAAA,EAC5E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4795966c1f688514909e89fcb6c528b41dd3fb19"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-cell-value.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-cell-value.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":79}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-cell-value.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSetCellValuePermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.SetCellValue;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.SetCellValue}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,gCAA4D;AAAA,EAMrE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,YAAY,IAAI,MAAM,IAAI,SAAS;AAAA,EAC5E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"89776ecc2ffc57e1bdca5b0b5db80f0cb9f0d341"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-column-style.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-column-style.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":81}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":37}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-column-style.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSetColumnStylePermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.SetColumnStyle;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.SetColumnStyle}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,kCAA8D;AAAA,EAMvE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,cAAc,IAAI,MAAM,IAAI,SAAS;AAAA,EAC9E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"81926dfe4e3987a2088f6e0395342c5a68a61957"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-row-style.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-row-style.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":78}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/set-row-style.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSetRowStylePermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.SetRowStyle;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.SetRowStyle}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,+BAA2D;AAAA,EAMpE,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,WAAW,IAAI,MAAM,IAAI,SAAS;AAAA,EAC3E;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"449fd0cad040c2e43a34493e1713c039349a731b"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/sort.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/sort.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":71}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/sort.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetSortPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.Sort;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.Sort}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wBAAoD;AAAA,EAM7D,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM,IAAI,SAAS;AAAA,EACpE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"bf2d337517ebd85a8b28be48174d34760447355a"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/view.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/view.ts","statementMap":{"0":{"start":{"line":5,"column":4},"end":{"line":5,"column":25}},"1":{"start":{"line":6,"column":4},"end":{"line":6,"column":31}},"2":{"start":{"line":7,"column":4},"end":{"line":7,"column":71}},"3":{"start":{"line":9,"column":10},"end":{"line":9,"column":14}},"4":{"start":{"line":10,"column":9},"end":{"line":10,"column":29}},"5":{"start":{"line":11,"column":11},"end":{"line":11,"column":32}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":2},"end":{"line":4,"column":3}},"loc":{"start":{"line":4,"column":33},"end":{"line":8,"column":3}},"line":4}},"branchMap":{},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/worksheet/view.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class WorksheetViewPermission implements IPermissionPoint {\n    value = true;\n    type = UnitObject.Worksheet;\n    status = PermissionStatus.INIT;\n    id: string;\n    subType = UnitAction.View;\n    constructor(public unitId: string, public subUnitId: string) {\n        this.id = `${this.type}.${UnitAction.View}_${unitId}_${subUnitId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,wBAAoD;AAAA,EAM7D,YAAmB,QAAuB,WAAmB;AAA1C;AAAuB;AACtC,SAAK,KAAK,GAAG,KAAK,IAAI,IAAI,WAAW,IAAI,IAAI,MAAM,IAAI,SAAS;AAAA,EACpE;AAAA,EAPA,QAAQ;AAAA,EACR,OAAO,WAAW;AAAA,EAClB,SAAS,iBAAiB;AAAA,EAC1B;AAAA,EACA,UAAU,WAAW;AAIzB;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2801f2c609d83e25e4bf6ea22e8938037deda1ca"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/set-range-values.command.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/set-range-values.command.ts","statementMap":{"0":{"start":{"line":18,"column":37},"end":{"line":87,"column":1}},"1":{"start":{"line":22,"column":27},"end":{"line":22,"column":56}},"2":{"start":{"line":23,"column":28},"end":{"line":23,"column":58}},"3":{"start":{"line":24,"column":34},"end":{"line":24,"column":70}},"4":{"start":{"line":25,"column":36},"end":{"line":25,"column":73}},"5":{"start":{"line":26,"column":36},"end":{"line":26,"column":73}},"6":{"start":{"line":27,"column":30},"end":{"line":27,"column":62}},"7":{"start":{"line":28,"column":19},"end":{"line":28,"column":71}},"8":{"start":{"line":29,"column":4},"end":{"line":29,"column":30}},"9":{"start":{"line":29,"column":17},"end":{"line":29,"column":30}},"10":{"start":{"line":30,"column":55},"end":{"line":30,"column":61}},"11":{"start":{"line":31,"column":41},"end":{"line":31,"column":47}},"12":{"start":{"line":32,"column":30},"end":{"line":32,"column":115}},"13":{"start":{"line":32,"column":107},"end":{"line":32,"column":114}},"14":{"start":{"line":33,"column":4},"end":{"line":33,"column":70}},"15":{"start":{"line":33,"column":57},"end":{"line":33,"column":70}},"16":{"start":{"line":34,"column":4},"end":{"line":34,"column":111}},"17":{"start":{"line":34,"column":98},"end":{"line":34,"column":111}},"18":{"start":{"line":35,"column":22},"end":{"line":35,"column":40}},"19":{"start":{"line":37,"column":4},"end":{"line":57,"column":5}},"20":{"start":{"line":38,"column":6},"end":{"line":45,"column":7}},"21":{"start":{"line":38,"column":19},"end":{"line":38,"column":20}},"22":{"start":{"line":39,"column":61},"end":{"line":39,"column":81}},"23":{"start":{"line":40,"column":8},"end":{"line":44,"column":9}},"24":{"start":{"line":40,"column":21},"end":{"line":40,"column":22}},"25":{"start":{"line":41,"column":10},"end":{"line":43,"column":11}},"26":{"start":{"line":41,"column":23},"end":{"line":41,"column":24}},"27":{"start":{"line":42,"column":12},"end":{"line":42,"column":75}},"28":{"start":{"line":46,"column":11},"end":{"line":57,"column":5}},"29":{"start":{"line":47,"column":6},"end":{"line":54,"column":7}},"30":{"start":{"line":47,"column":19},"end":{"line":47,"column":20}},"31":{"start":{"line":48,"column":61},"end":{"line":48,"column":81}},"32":{"start":{"line":49,"column":8},"end":{"line":53,"column":9}},"33":{"start":{"line":49,"column":21},"end":{"line":49,"column":29}},"34":{"start":{"line":50,"column":10},"end":{"line":52,"column":11}},"35":{"start":{"line":50,"column":23},"end":{"line":50,"column":34}},"36":{"start":{"line":51,"column":12},"end":{"line":51,"column":44}},"37":{"start":{"line":56,"column":6},"end":{"line":56,"column":28}},"38":{"start":{"line":58,"column":41},"end":{"line":58,"column":113}},"39":{"start":{"line":59,"column":23},"end":{"line":59,"column":96}},"40":{"start":{"line":60,"column":35},"end":{"line":60,"column":125}},"41":{"start":{"line":61,"column":4},"end":{"line":61,"column":46}},"42":{"start":{"line":61,"column":33},"end":{"line":61,"column":46}},"43":{"start":{"line":62,"column":29},"end":{"line":65,"column":6}},"44":{"start":{"line":66,"column":19},"end":{"line":66,"column":62}},"45":{"start":{"line":67,"column":4},"end":{"line":84,"column":5}},"46":{"start":{"line":68,"column":33},"end":{"line":68,"column":109}},"47":{"start":{"line":69,"column":6},"end":{"line":82,"column":9}},"48":{"start":{"line":83,"column":6},"end":{"line":83,"column":18}},"49":{"start":{"line":85,"column":4},"end":{"line":85,"column":17}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":21,"column":11},"end":{"line":21,"column":12}},"loc":{"start":{"line":21,"column":33},"end":{"line":86,"column":3}},"line":21},"1":{"name":"(anonymous_1)","decl":{"start":{"line":32,"column":100},"end":{"line":32,"column":101}},"loc":{"start":{"line":32,"column":107},"end":{"line":32,"column":114}},"line":32}},"branchMap":{"0":{"loc":{"start":{"line":29,"column":4},"end":{"line":29,"column":30}},"type":"if","locations":[{"start":{"line":29,"column":4},"end":{"line":29,"column":30}},{"start":{},"end":{}}],"line":29},"1":{"loc":{"start":{"line":32,"column":30},"end":{"line":32,"column":115}},"type":"cond-expr","locations":[{"start":{"line":32,"column":38},"end":{"line":32,"column":45}},{"start":{"line":32,"column":48},"end":{"line":32,"column":115}}],"line":32},"2":{"loc":{"start":{"line":33,"column":4},"end":{"line":33,"column":70}},"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":33,"column":70}},{"start":{},"end":{}}],"line":33},"3":{"loc":{"start":{"line":33,"column":8},"end":{"line":33,"column":55}},"type":"binary-expr","locations":[{"start":{"line":33,"column":8},"end":{"line":33,"column":26}},{"start":{"line":33,"column":30},"end":{"line":33,"column":55}}],"line":33},"4":{"loc":{"start":{"line":34,"column":4},"end":{"line":34,"column":111}},"type":"if","locations":[{"start":{"line":34,"column":4},"end":{"line":34,"column":111}},{"start":{},"end":{}}],"line":34},"5":{"loc":{"start":{"line":37,"column":4},"end":{"line":57,"column":5}},"type":"if","locations":[{"start":{"line":37,"column":4},"end":{"line":57,"column":5}},{"start":{"line":46,"column":11},"end":{"line":57,"column":5}}],"line":37},"6":{"loc":{"start":{"line":46,"column":11},"end":{"line":57,"column":5}},"type":"if","locations":[{"start":{"line":46,"column":11},"end":{"line":57,"column":5}},{"start":{"line":55,"column":11},"end":{"line":57,"column":5}}],"line":46},"7":{"loc":{"start":{"line":58,"column":73},"end":{"line":58,"column":111}},"type":"binary-expr","locations":[{"start":{"line":58,"column":73},"end":{"line":58,"column":86}},{"start":{"line":58,"column":90},"end":{"line":58,"column":111}}],"line":58},"8":{"loc":{"start":{"line":61,"column":4},"end":{"line":61,"column":46}},"type":"if","locations":[{"start":{"line":61,"column":4},"end":{"line":61,"column":46}},{"start":{},"end":{}}],"line":61},"9":{"loc":{"start":{"line":67,"column":4},"end":{"line":84,"column":5}},"type":"if","locations":[{"start":{"line":67,"column":4},"end":{"line":84,"column":5}},{"start":{},"end":{}}],"line":67},"10":{"loc":{"start":{"line":68,"column":58},"end":{"line":68,"column":87}},"type":"binary-expr","locations":[{"start":{"line":68,"column":58},"end":{"line":68,"column":63}},{"start":{"line":68,"column":67},"end":{"line":68,"column":87}}],"line":68}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0},"f":{"0":0,"1":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/set-range-values.command.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICellData, ICommand, IObjectMatrixPrimitiveType, IRange } from '@univerjs/core';\nimport type { ISheetCommandSharedParams } from '../utils/interface';\n\nimport {\n    CommandType,\n    ICommandService,\n    IPermissionService,\n    isICellData,\n    IUndoRedoService,\n    IUniverInstanceService,\n    ObjectMatrix,\n    sequenceExecute,\n    Tools,\n} from '@univerjs/core';\nimport { WorksheetEditPermission } from '../../services/permission/permission-point';\nimport { SheetsSelectionsService } from '../../services/selections/selection.service';\nimport { SheetInterceptorService } from '../../services/sheet-interceptor/sheet-interceptor.service';\nimport { SetRangeValuesMutation, SetRangeValuesUndoMutationFactory } from '../mutations/set-range-values.mutation';\nimport { followSelectionOperation } from './utils/selection-utils';\nimport { getSheetCommandTarget } from './utils/target-util';\n\nexport interface ISetRangeValuesCommandParams extends Partial<ISheetCommandSharedParams> {\n    range?: IRange;\n\n    /**\n     * 1. ICellData: Normal cell data\n     * 2. ICellData[][]: The two-dimensional array indicates the data of multiple cells\n     * 3. IObjectMatrixPrimitiveType<ICellData>: Bring the row/column information MATRIX, indicating the data of multiple cells\n     */\n    value: ICellData | ICellData[][] | IObjectMatrixPrimitiveType<ICellData>;\n\n    redoUndoId?: string;\n}\n\n/**\n * The command to set values for ranges.\n */\nexport const SetRangeValuesCommand: ICommand = {\n    id: 'sheet.command.set-range-values',\n    type: CommandType.COMMAND,\n\n    handler: (accessor: IAccessor, params: ISetRangeValuesCommandParams) => {\n        const commandService = accessor.get(ICommandService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n        const permissionService = accessor.get(IPermissionService);\n        const target = getSheetCommandTarget(univerInstanceService, params);\n        if (!target) return false;\n\n        const { subUnitId, unitId, workbook, worksheet } = target;\n        const { value, range, redoUndoId } = params;\n        const currentSelections = range ? [range] : selectionManagerService.getCurrentSelections()?.map((s) => s.range);\n\n        if (!currentSelections || !currentSelections.length) return false;\n        if (!permissionService.getPermissionPoint(new WorksheetEditPermission(unitId, subUnitId).id)) return false;\n\n        const cellValue = new ObjectMatrix<ICellData>();\n        let realCellValue: IObjectMatrixPrimitiveType<ICellData> | undefined;\n\n        if (Tools.isArray(value)) {\n            for (let i = 0; i < currentSelections.length; i++) {\n                const { startRow, startColumn, endRow, endColumn } = currentSelections[i];\n\n                for (let r = 0; r <= endRow - startRow; r++) {\n                    for (let c = 0; c <= endColumn - startColumn; c++) {\n                        cellValue.setValue(r + startRow, c + startColumn, value[r][c]);\n                    }\n                }\n            }\n        } else if (isICellData(value)) {\n            for (let i = 0; i < currentSelections.length; i++) {\n                const { startRow, startColumn, endRow, endColumn } = currentSelections[i];\n\n                for (let r = startRow; r <= endRow; r++) {\n                    for (let c = startColumn; c <= endColumn; c++) {\n                        cellValue.setValue(r, c, value);\n                    }\n                }\n            }\n        } else {\n            realCellValue = value as IObjectMatrixPrimitiveType<ICellData>;\n        }\n\n        const setRangeValuesMutationParams = { subUnitId, unitId, cellValue: realCellValue ?? cellValue.getMatrix() };\n        const redoParams = SetRangeValuesUndoMutationFactory(accessor, setRangeValuesMutationParams);\n\n        const setValueMutationResult = commandService.syncExecuteCommand(SetRangeValuesMutation.id, setRangeValuesMutationParams);\n        if (!setValueMutationResult) return false;\n\n        const { undos, redos } = sheetInterceptorService.onCommandExecute({\n            id: SetRangeValuesCommand.id,\n            params: { ...setRangeValuesMutationParams, range: currentSelections },\n        });\n\n        const result = sequenceExecute([...redos], commandService);\n        if (result.result) {\n            const selectionOperation = followSelectionOperation(range ?? cellValue.getRange(), workbook, worksheet);\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: [\n                    { id: SetRangeValuesMutation.id, params: redoParams },\n                    ...undos,\n                    selectionOperation,\n                ],\n                redoMutations: [\n                    { id: SetRangeValuesMutation.id, params: setRangeValuesMutationParams },\n                    ...redos,\n                    Tools.deepClone(selectionOperation),\n                ],\n                id: redoUndoId,\n            });\n\n            return true;\n        }\n\n        return false;\n    },\n};\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ccc944c3a0e31cfba53ebf7bbbfb2a111252dfe8"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/utils.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/utils.ts","statementMap":{"0":{"start":{"line":2,"column":26},"end":{"line":22,"column":1}},"1":{"start":{"line":3,"column":2},"end":{"line":21,"column":4}},"2":{"start":{"line":5,"column":20},"end":{"line":5,"column":43}},"3":{"start":{"line":6,"column":6},"end":{"line":9,"column":7}},"4":{"start":{"line":7,"column":8},"end":{"line":7,"column":54}},"5":{"start":{"line":8,"column":8},"end":{"line":8,"column":22}},"6":{"start":{"line":10,"column":6},"end":{"line":17,"column":7}},"7":{"start":{"line":11,"column":8},"end":{"line":13,"column":9}},"8":{"start":{"line":12,"column":10},"end":{"line":12,"column":29}},"9":{"start":{"line":14,"column":8},"end":{"line":14,"column":36}},"10":{"start":{"line":16,"column":8},"end":{"line":16,"column":39}},"11":{"start":{"line":18,"column":6},"end":{"line":18,"column":20}},"12":{"start":{"line":23,"column":31},"end":{"line":28,"column":1}},"13":{"start":{"line":24,"column":19},"end":{"line":24,"column":28}},"14":{"start":{"line":25,"column":2},"end":{"line":27,"column":4}},"15":{"start":{"line":26,"column":4},"end":{"line":26,"column":24}},"16":{"start":{"line":30,"column":2},"end":{"line":32,"column":3}},"17":{"start":{"line":31,"column":4},"end":{"line":31,"column":17}},"18":{"start":{"line":33,"column":2},"end":{"line":33,"column":84}},"19":{"start":{"line":36,"column":36},"end":{"line":36,"column":46}},"20":{"start":{"line":37,"column":17},"end":{"line":37,"column":39}},"21":{"start":{"line":38,"column":20},"end":{"line":38,"column":45}},"22":{"start":{"line":39,"column":16},"end":{"line":39,"column":20}},"23":{"start":{"line":40,"column":20},"end":{"line":40,"column":37}},"24":{"start":{"line":41,"column":20},"end":{"line":41,"column":87}},"25":{"start":{"line":42,"column":2},"end":{"line":121,"column":3}},"26":{"start":{"line":43,"column":4},"end":{"line":43,"column":20}},"27":{"start":{"line":44,"column":4},"end":{"line":61,"column":5}},"28":{"start":{"line":45,"column":22},"end":{"line":45,"column":44}},"29":{"start":{"line":46,"column":25},"end":{"line":51,"column":7}},"30":{"start":{"line":52,"column":6},"end":{"line":60,"column":7}},"31":{"start":{"line":52,"column":21},"end":{"line":52,"column":43}},"32":{"start":{"line":53,"column":21},"end":{"line":53,"column":65}},"33":{"start":{"line":54,"column":8},"end":{"line":59,"column":9}},"34":{"start":{"line":55,"column":10},"end":{"line":55,"column":81}},"35":{"start":{"line":56,"column":10},"end":{"line":56,"column":71}},"36":{"start":{"line":57,"column":10},"end":{"line":57,"column":67}},"37":{"start":{"line":58,"column":10},"end":{"line":58,"column":25}},"38":{"start":{"line":62,"column":4},"end":{"line":83,"column":5}},"39":{"start":{"line":63,"column":22},"end":{"line":63,"column":42}},"40":{"start":{"line":64,"column":25},"end":{"line":69,"column":7}},"41":{"start":{"line":70,"column":6},"end":{"line":82,"column":7}},"42":{"start":{"line":70,"column":21},"end":{"line":70,"column":43}},"43":{"start":{"line":71,"column":26},"end":{"line":71,"column":70}},"44":{"start":{"line":72,"column":8},"end":{"line":81,"column":9}},"45":{"start":{"line":73,"column":10},"end":{"line":73,"column":75}},"46":{"start":{"line":74,"column":10},"end":{"line":77,"column":12}},"47":{"start":{"line":78,"column":10},"end":{"line":78,"column":71}},"48":{"start":{"line":79,"column":10},"end":{"line":79,"column":67}},"49":{"start":{"line":80,"column":10},"end":{"line":80,"column":25}},"50":{"start":{"line":84,"column":4},"end":{"line":101,"column":5}},"51":{"start":{"line":85,"column":22},"end":{"line":85,"column":47}},"52":{"start":{"line":86,"column":25},"end":{"line":91,"column":7}},"53":{"start":{"line":92,"column":6},"end":{"line":100,"column":7}},"54":{"start":{"line":92,"column":21},"end":{"line":92,"column":40}},"55":{"start":{"line":93,"column":21},"end":{"line":93,"column":68}},"56":{"start":{"line":94,"column":8},"end":{"line":99,"column":9}},"57":{"start":{"line":95,"column":10},"end":{"line":95,"column":90}},"58":{"start":{"line":96,"column":10},"end":{"line":96,"column":65}},"59":{"start":{"line":97,"column":10},"end":{"line":97,"column":61}},"60":{"start":{"line":98,"column":10},"end":{"line":98,"column":25}},"61":{"start":{"line":102,"column":4},"end":{"line":120,"column":5}},"62":{"start":{"line":103,"column":22},"end":{"line":103,"column":45}},"63":{"start":{"line":104,"column":25},"end":{"line":109,"column":7}},"64":{"start":{"line":110,"column":6},"end":{"line":119,"column":7}},"65":{"start":{"line":110,"column":21},"end":{"line":110,"column":40}},"66":{"start":{"line":111,"column":26},"end":{"line":111,"column":71}},"67":{"start":{"line":112,"column":8},"end":{"line":118,"column":9}},"68":{"start":{"line":113,"column":10},"end":{"line":116,"column":12}},"69":{"start":{"line":117,"column":10},"end":{"line":117,"column":25}},"70":{"start":{"line":122,"column":2},"end":{"line":122,"column":19}},"71":{"start":{"line":125,"column":20},"end":{"line":125,"column":38}},"72":{"start":{"line":126,"column":2},"end":{"line":133,"column":5}},"73":{"start":{"line":127,"column":57},"end":{"line":127,"column":63}},"74":{"start":{"line":128,"column":4},"end":{"line":132,"column":5}},"75":{"start":{"line":128,"column":17},"end":{"line":128,"column":25}},"76":{"start":{"line":129,"column":6},"end":{"line":131,"column":7}},"77":{"start":{"line":129,"column":19},"end":{"line":129,"column":30}},"78":{"start":{"line":130,"column":8},"end":{"line":130,"column":39}},"79":{"start":{"line":134,"column":2},"end":{"line":134,"column":27}},"80":{"start":{"line":137,"column":20},"end":{"line":137,"column":38}},"81":{"start":{"line":138,"column":2},"end":{"line":151,"column":5}},"82":{"start":{"line":139,"column":57},"end":{"line":139,"column":63}},"83":{"start":{"line":140,"column":4},"end":{"line":150,"column":5}},"84":{"start":{"line":140,"column":17},"end":{"line":140,"column":25}},"85":{"start":{"line":141,"column":6},"end":{"line":149,"column":7}},"86":{"start":{"line":141,"column":19},"end":{"line":141,"column":30}},"87":{"start":{"line":142,"column":8},"end":{"line":148,"column":11}},"88":{"start":{"line":152,"column":2},"end":{"line":152,"column":27}},"89":{"start":{"line":155,"column":20},"end":{"line":155,"column":38}},"90":{"start":{"line":156,"column":2},"end":{"line":165,"column":5}},"91":{"start":{"line":157,"column":57},"end":{"line":157,"column":62}},"92":{"start":{"line":158,"column":4},"end":{"line":164,"column":5}},"93":{"start":{"line":158,"column":17},"end":{"line":158,"column":25}},"94":{"start":{"line":159,"column":6},"end":{"line":163,"column":7}},"95":{"start":{"line":159,"column":19},"end":{"line":159,"column":30}},"96":{"start":{"line":160,"column":8},"end":{"line":162,"column":11}},"97":{"start":{"line":166,"column":2},"end":{"line":166,"column":27}},"98":{"start":{"line":169,"column":19},"end":{"line":169,"column":89}},"99":{"start":{"line":170,"column":20},"end":{"line":170,"column":46}},"100":{"start":{"line":171,"column":2},"end":{"line":171,"column":31}},"101":{"start":{"line":174,"column":32},"end":{"line":174,"column":68}},"102":{"start":{"line":175,"column":19},"end":{"line":175,"column":177}},"103":{"start":{"line":176,"column":20},"end":{"line":176,"column":99}},"104":{"start":{"line":177,"column":2},"end":{"line":179,"column":3}},"105":{"start":{"line":178,"column":4},"end":{"line":178,"column":16}},"106":{"start":{"line":180,"column":55},"end":{"line":180,"column":60}},"107":{"start":{"line":181,"column":15},"end":{"line":181,"column":17}},"108":{"start":{"line":182,"column":15},"end":{"line":182,"column":17}},"109":{"start":{"line":183,"column":2},"end":{"line":193,"column":3}},"110":{"start":{"line":183,"column":15},"end":{"line":183,"column":23}},"111":{"start":{"line":184,"column":4},"end":{"line":192,"column":5}},"112":{"start":{"line":185,"column":6},"end":{"line":191,"column":7}},"113":{"start":{"line":186,"column":8},"end":{"line":188,"column":9}},"114":{"start":{"line":187,"column":10},"end":{"line":187,"column":23}},"115":{"start":{"line":190,"column":8},"end":{"line":190,"column":21}},"116":{"start":{"line":194,"column":2},"end":{"line":202,"column":3}},"117":{"start":{"line":194,"column":15},"end":{"line":194,"column":26}},"118":{"start":{"line":195,"column":4},"end":{"line":201,"column":5}},"119":{"start":{"line":196,"column":6},"end":{"line":198,"column":7}},"120":{"start":{"line":197,"column":8},"end":{"line":197,"column":21}},"121":{"start":{"line":200,"column":6},"end":{"line":200,"column":19}},"122":{"start":{"line":203,"column":2},"end":{"line":206,"column":4}},"123":{"start":{"line":209,"column":18},"end":{"line":209,"column":20}},"124":{"start":{"line":210,"column":18},"end":{"line":210,"column":20}},"125":{"start":{"line":211,"column":2},"end":{"line":217,"column":3}},"126":{"start":{"line":212,"column":26},"end":{"line":212,"column":88}},"127":{"start":{"line":213,"column":4},"end":{"line":216,"column":5}},"128":{"start":{"line":214,"column":6},"end":{"line":214,"column":42}},"129":{"start":{"line":215,"column":6},"end":{"line":215,"column":42}},"130":{"start":{"line":218,"column":21},"end":{"line":218,"column":71}},"131":{"start":{"line":218,"column":65},"end":{"line":218,"column":70}},"132":{"start":{"line":219,"column":21},"end":{"line":219,"column":71}},"133":{"start":{"line":219,"column":65},"end":{"line":219,"column":70}},"134":{"start":{"line":220,"column":24},"end":{"line":220,"column":26}},"135":{"start":{"line":222,"column":21},"end":{"line":222,"column":23}},"136":{"start":{"line":223,"column":16},"end":{"line":223,"column":22}},"137":{"start":{"line":224,"column":4},"end":{"line":229,"column":5}},"138":{"start":{"line":224,"column":17},"end":{"line":224,"column":18}},"139":{"start":{"line":225,"column":6},"end":{"line":228,"column":7}},"140":{"start":{"line":226,"column":8},"end":{"line":226,"column":43}},"141":{"start":{"line":227,"column":8},"end":{"line":227,"column":23}},"142":{"start":{"line":230,"column":4},"end":{"line":230,"column":48}},"143":{"start":{"line":231,"column":4},"end":{"line":231,"column":20}},"144":{"start":{"line":233,"column":22},"end":{"line":233,"column":56}},"145":{"start":{"line":234,"column":22},"end":{"line":234,"column":56}},"146":{"start":{"line":235,"column":2},"end":{"line":244,"column":3}},"147":{"start":{"line":236,"column":4},"end":{"line":243,"column":5}},"148":{"start":{"line":237,"column":6},"end":{"line":242,"column":9}},"149":{"start":{"line":245,"column":2},"end":{"line":245,"column":23}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":26},"end":{"line":2,"column":27}},"loc":{"start":{"line":2,"column":55},"end":{"line":22,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":4,"column":4},"end":{"line":4,"column":5}},"loc":{"start":{"line":4,"column":25},"end":{"line":19,"column":5}},"line":4},"2":{"name":"(anonymous_2)","decl":{"start":{"line":23,"column":31},"end":{"line":23,"column":32}},"loc":{"start":{"line":23,"column":50},"end":{"line":28,"column":1}},"line":23},"3":{"name":"getKey","decl":{"start":{"line":25,"column":18},"end":{"line":25,"column":24}},"loc":{"start":{"line":25,"column":27},"end":{"line":27,"column":3}},"line":25},"4":{"name":"cellHasValue","decl":{"start":{"line":29,"column":9},"end":{"line":29,"column":21}},"loc":{"start":{"line":29,"column":28},"end":{"line":34,"column":1}},"line":29},"5":{"name":"expandToContinuousRange","decl":{"start":{"line":35,"column":16},"end":{"line":35,"column":39}},"loc":{"start":{"line":35,"column":75},"end":{"line":123,"column":1}},"line":35},"6":{"name":"generateNullCell","decl":{"start":{"line":124,"column":16},"end":{"line":124,"column":32}},"loc":{"start":{"line":124,"column":40},"end":{"line":135,"column":1}},"line":124},"7":{"name":"(anonymous_7)","decl":{"start":{"line":126,"column":16},"end":{"line":126,"column":17}},"loc":{"start":{"line":126,"column":28},"end":{"line":133,"column":3}},"line":126},"8":{"name":"generateNullCellValue","decl":{"start":{"line":136,"column":16},"end":{"line":136,"column":37}},"loc":{"start":{"line":136,"column":45},"end":{"line":153,"column":1}},"line":136},"9":{"name":"(anonymous_9)","decl":{"start":{"line":138,"column":16},"end":{"line":138,"column":17}},"loc":{"start":{"line":138,"column":28},"end":{"line":151,"column":3}},"line":138},"10":{"name":"generateNullCellStyle","decl":{"start":{"line":154,"column":16},"end":{"line":154,"column":37}},"loc":{"start":{"line":154,"column":46},"end":{"line":167,"column":1}},"line":154},"11":{"name":"(anonymous_11)","decl":{"start":{"line":156,"column":17},"end":{"line":156,"column":18}},"loc":{"start":{"line":156,"column":28},"end":{"line":165,"column":3}},"line":156},"12":{"name":"getActiveWorksheet","decl":{"start":{"line":168,"column":16},"end":{"line":168,"column":34}},"loc":{"start":{"line":168,"column":52},"end":{"line":172,"column":1}},"line":168},"13":{"name":"rangeToDiscreteRange","decl":{"start":{"line":173,"column":16},"end":{"line":173,"column":36}},"loc":{"start":{"line":173,"column":87},"end":{"line":207,"column":1}},"line":173},"14":{"name":"getVisibleRanges","decl":{"start":{"line":208,"column":16},"end":{"line":208,"column":32}},"loc":{"start":{"line":208,"column":70},"end":{"line":246,"column":1}},"line":208},"15":{"name":"(anonymous_15)","decl":{"start":{"line":218,"column":55},"end":{"line":218,"column":56}},"loc":{"start":{"line":218,"column":65},"end":{"line":218,"column":70}},"line":218},"16":{"name":"(anonymous_16)","decl":{"start":{"line":219,"column":55},"end":{"line":219,"column":56}},"loc":{"start":{"line":219,"column":65},"end":{"line":219,"column":70}},"line":219},"17":{"name":"findContinuousSegments","decl":{"start":{"line":221,"column":11},"end":{"line":221,"column":33}},"loc":{"start":{"line":221,"column":39},"end":{"line":232,"column":3}},"line":221}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":37},"end":{"line":2,"column":50}},"type":"default-arg","locations":[{"start":{"line":2,"column":48},"end":{"line":2,"column":50}}],"line":2},"1":{"loc":{"start":{"line":5,"column":20},"end":{"line":5,"column":43}},"type":"binary-expr","locations":[{"start":{"line":5,"column":20},"end":{"line":5,"column":27}},{"start":{"line":5,"column":31},"end":{"line":5,"column":43}}],"line":5},"2":{"loc":{"start":{"line":6,"column":6},"end":{"line":9,"column":7}},"type":"if","locations":[{"start":{"line":6,"column":6},"end":{"line":9,"column":7}},{"start":{},"end":{}}],"line":6},"3":{"loc":{"start":{"line":10,"column":6},"end":{"line":17,"column":7}},"type":"if","locations":[{"start":{"line":10,"column":6},"end":{"line":17,"column":7}},{"start":{"line":15,"column":13},"end":{"line":17,"column":7}}],"line":10},"4":{"loc":{"start":{"line":11,"column":8},"end":{"line":13,"column":9}},"type":"if","locations":[{"start":{"line":11,"column":8},"end":{"line":13,"column":9}},{"start":{},"end":{}}],"line":11},"5":{"loc":{"start":{"line":23,"column":32},"end":{"line":23,"column":45}},"type":"default-arg","locations":[{"start":{"line":23,"column":44},"end":{"line":23,"column":45}}],"line":23},"6":{"loc":{"start":{"line":30,"column":2},"end":{"line":32,"column":3}},"type":"if","locations":[{"start":{"line":30,"column":2},"end":{"line":32,"column":3}},{"start":{},"end":{}}],"line":30},"7":{"loc":{"start":{"line":30,"column":6},"end":{"line":30,"column":38}},"type":"binary-expr","locations":[{"start":{"line":30,"column":6},"end":{"line":30,"column":21}},{"start":{"line":30,"column":25},"end":{"line":30,"column":38}}],"line":30},"8":{"loc":{"start":{"line":33,"column":9},"end":{"line":33,"column":83}},"type":"binary-expr","locations":[{"start":{"line":33,"column":9},"end":{"line":33,"column":26}},{"start":{"line":33,"column":30},"end":{"line":33,"column":45}},{"start":{"line":33,"column":49},"end":{"line":33,"column":62}},{"start":{"line":33,"column":66},"end":{"line":33,"column":83}}],"line":33},"9":{"loc":{"start":{"line":44,"column":4},"end":{"line":61,"column":5}},"type":"if","locations":[{"start":{"line":44,"column":4},"end":{"line":61,"column":5}},{"start":{},"end":{}}],"line":44},"10":{"loc":{"start":{"line":44,"column":8},"end":{"line":44,"column":38}},"type":"binary-expr","locations":[{"start":{"line":44,"column":8},"end":{"line":44,"column":10}},{"start":{"line":44,"column":14},"end":{"line":44,"column":38}}],"line":44},"11":{"loc":{"start":{"line":54,"column":8},"end":{"line":59,"column":9}},"type":"if","locations":[{"start":{"line":54,"column":8},"end":{"line":59,"column":9}},{"start":{},"end":{}}],"line":54},"12":{"loc":{"start":{"line":62,"column":4},"end":{"line":83,"column":5}},"type":"if","locations":[{"start":{"line":62,"column":4},"end":{"line":83,"column":5}},{"start":{},"end":{}}],"line":62},"13":{"loc":{"start":{"line":62,"column":8},"end":{"line":62,"column":47}},"type":"binary-expr","locations":[{"start":{"line":62,"column":8},"end":{"line":62,"column":12}},{"start":{"line":62,"column":16},"end":{"line":62,"column":47}}],"line":62},"14":{"loc":{"start":{"line":72,"column":8},"end":{"line":81,"column":9}},"type":"if","locations":[{"start":{"line":72,"column":8},"end":{"line":81,"column":9}},{"start":{},"end":{}}],"line":72},"15":{"loc":{"start":{"line":75,"column":33},"end":{"line":75,"column":89}},"type":"cond-expr","locations":[{"start":{"line":75,"column":64},"end":{"line":75,"column":85}},{"start":{"line":75,"column":88},"end":{"line":75,"column":89}}],"line":75},"16":{"loc":{"start":{"line":84,"column":4},"end":{"line":101,"column":5}},"type":"if","locations":[{"start":{"line":84,"column":4},"end":{"line":101,"column":5}},{"start":{},"end":{}}],"line":84},"17":{"loc":{"start":{"line":84,"column":8},"end":{"line":84,"column":43}},"type":"binary-expr","locations":[{"start":{"line":84,"column":8},"end":{"line":84,"column":12}},{"start":{"line":84,"column":16},"end":{"line":84,"column":43}}],"line":84},"18":{"loc":{"start":{"line":94,"column":8},"end":{"line":99,"column":9}},"type":"if","locations":[{"start":{"line":94,"column":8},"end":{"line":99,"column":9}},{"start":{},"end":{}}],"line":94},"19":{"loc":{"start":{"line":102,"column":4},"end":{"line":120,"column":5}},"type":"if","locations":[{"start":{"line":102,"column":4},"end":{"line":120,"column":5}},{"start":{},"end":{}}],"line":102},"20":{"loc":{"start":{"line":102,"column":8},"end":{"line":102,"column":54}},"type":"binary-expr","locations":[{"start":{"line":102,"column":8},"end":{"line":102,"column":13}},{"start":{"line":102,"column":17},"end":{"line":102,"column":54}}],"line":102},"21":{"loc":{"start":{"line":112,"column":8},"end":{"line":118,"column":9}},"type":"if","locations":[{"start":{"line":112,"column":8},"end":{"line":118,"column":9}},{"start":{},"end":{}}],"line":112},"22":{"loc":{"start":{"line":114,"column":36},"end":{"line":114,"column":92}},"type":"cond-expr","locations":[{"start":{"line":114,"column":67},"end":{"line":114,"column":88}},{"start":{"line":114,"column":91},"end":{"line":114,"column":92}}],"line":114},"23":{"loc":{"start":{"line":175,"column":19},"end":{"line":175,"column":177}},"type":"cond-expr","locations":[{"start":{"line":175,"column":28},"end":{"line":175,"column":98}},{"start":{"line":175,"column":101},"end":{"line":175,"column":177}}],"line":175},"24":{"loc":{"start":{"line":176,"column":20},"end":{"line":176,"column":99}},"type":"cond-expr","locations":[{"start":{"line":176,"column":32},"end":{"line":176,"column":70}},{"start":{"line":176,"column":73},"end":{"line":176,"column":99}}],"line":176},"25":{"loc":{"start":{"line":177,"column":2},"end":{"line":179,"column":3}},"type":"if","locations":[{"start":{"line":177,"column":2},"end":{"line":179,"column":3}},{"start":{},"end":{}}],"line":177},"26":{"loc":{"start":{"line":184,"column":4},"end":{"line":192,"column":5}},"type":"if","locations":[{"start":{"line":184,"column":4},"end":{"line":192,"column":5}},{"start":{},"end":{}}],"line":184},"27":{"loc":{"start":{"line":185,"column":6},"end":{"line":191,"column":7}},"type":"if","locations":[{"start":{"line":185,"column":6},"end":{"line":191,"column":7}},{"start":{"line":189,"column":13},"end":{"line":191,"column":7}}],"line":185},"28":{"loc":{"start":{"line":186,"column":8},"end":{"line":188,"column":9}},"type":"if","locations":[{"start":{"line":186,"column":8},"end":{"line":188,"column":9}},{"start":{},"end":{}}],"line":186},"29":{"loc":{"start":{"line":195,"column":4},"end":{"line":201,"column":5}},"type":"if","locations":[{"start":{"line":195,"column":4},"end":{"line":201,"column":5}},{"start":{"line":199,"column":11},"end":{"line":201,"column":5}}],"line":195},"30":{"loc":{"start":{"line":196,"column":6},"end":{"line":198,"column":7}},"type":"if","locations":[{"start":{"line":196,"column":6},"end":{"line":198,"column":7}},{"start":{},"end":{}}],"line":196},"31":{"loc":{"start":{"line":213,"column":4},"end":{"line":216,"column":5}},"type":"if","locations":[{"start":{"line":213,"column":4},"end":{"line":216,"column":5}},{"start":{},"end":{}}],"line":213},"32":{"loc":{"start":{"line":225,"column":6},"end":{"line":228,"column":7}},"type":"if","locations":[{"start":{"line":225,"column":6},"end":{"line":228,"column":7}},{"start":{},"end":{}}],"line":225}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":2,"72":2,"73":2,"74":2,"75":2,"76":2,"77":2,"78":2,"79":2,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":2,"7":2,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},"b":{"0":[0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0],"6":[0,0],"7":[0,0],"8":[0,0,0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/basics/utils.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICellData, IObjectMatrixPrimitiveType, IRange, Nullable, UniverInstanceService, Workbook, Worksheet } from '@univerjs/core';\nimport type { IExpandParams } from '../commands/commands/utils/selection-utils';\nimport type { IDiscreteRange } from './interfaces';\nimport { IUniverInstanceService, ObjectMatrix, UniverInstanceType } from '@univerjs/core';\n\nexport const groupByKey = <T = Record<string, unknown>>(arr: T[], key: string, blankKey = '') => {\n    return arr.reduce(\n        (result, current) => {\n            const value = current && ((current as Record<string, unknown>)[key] as string);\n\n            if (typeof value !== 'string') {\n                console.warn(current, `${key} is not string`);\n                return result;\n            }\n\n            if (value) {\n                if (!result[value]) {\n                    result[value] = [];\n                }\n                result[value].push(current);\n            } else {\n                result[blankKey].push(current);\n            }\n            return result;\n        },\n        {} as Record<string, T[]>\n    );\n};\n\nexport const createUniqueKey = (initValue = 0) => {\n    let _initValue = initValue;\n    /**\n     * Increments 1 per call\n     */\n    return function getKey() {\n        return _initValue++;\n    };\n};\n\nfunction cellHasValue(cell: ICellData | undefined): boolean {\n    if (cell === undefined || cell === null) {\n        return false;\n    }\n    return (cell.v !== undefined && cell.v !== null && cell.v !== '') || cell.p !== undefined;\n}\n\n// eslint-disable-next-line max-lines-per-function\nexport function expandToContinuousRange(startRange: IRange, directions: IExpandParams, worksheet: Worksheet): IRange {\n    const { left, right, up, down } = directions;\n    const maxRow = worksheet.getMaxRows();\n    const maxColumn = worksheet.getMaxColumns();\n\n    let changed = true;\n    const destRange: IRange = { ...startRange }; // startRange should not be used below\n\n    const allMatrix = worksheet.getMatrixWithMergedCells(0, 0, maxRow - 1, maxColumn - 1);\n    while (changed) {\n        changed = false;\n\n        if (up && destRange.startRow !== 0) {\n            // see if there are value in the upper row of contents\n            // set `changed` to true if `startRow` really changes\n            const destRow = destRange.startRow - 1; // it may decrease if there are merged cell\n\n            const checkRange = {\n                startRow: destRow,\n                startColumn: destRange.startColumn,\n                endRow: destRow,\n                endColumn: destRange.endColumn,\n            };\n            for (let col = checkRange.startColumn; col <= checkRange.endColumn; col++) {\n                const cell = allMatrix.getValue(checkRange.startRow, col)!;\n                if (cellHasValue(cell)) {\n                    destRange.startRow = Math.min(checkRange.startRow, destRange.startRow);\n                    destRange.startColumn = Math.min(col, destRange.startColumn);\n                    destRange.endColumn = Math.max(col, destRange.endColumn);\n                    changed = true;\n                }\n            }\n        }\n\n        if (down && destRange.endRow !== maxRow - 1) {\n            const destRow = destRange.endRow + 1;\n            const checkRange = {\n                startRow: destRow,\n                startColumn: destRange.startColumn,\n                endRow: destRow,\n                endColumn: destRange.endColumn,\n            };\n            for (let col = checkRange.startColumn; col <= checkRange.endColumn; col++) {\n                const cellValue = allMatrix.getValue(checkRange.startRow, col)!;\n                if (cellHasValue(cellValue)) {\n                    destRange.endRow = Math.max(checkRange.endRow, destRange.endRow);\n                    destRange.endRow = Math.max(\n                        checkRange.endRow + (cellValue.rowSpan !== undefined ? cellValue.rowSpan - 1 : 0),\n                        destRange.endRow\n                    );\n                    destRange.startColumn = Math.min(col, destRange.startColumn);\n                    destRange.endColumn = Math.max(col, destRange.endColumn);\n                    changed = true;\n                }\n            }\n        }\n\n        if (left && destRange.startColumn !== 0) {\n            const destCol = destRange.startColumn - 1;\n            const checkRange = {\n                startRow: destRange.startRow,\n                startColumn: destCol,\n                endRow: destRange.endRow,\n                endColumn: destCol,\n            };\n            for (let row = checkRange.startRow; row <= checkRange.endRow; row++) {\n                const cell = allMatrix.getValue(row, checkRange.startColumn)!;\n                if (cellHasValue(cell)) {\n                    destRange.startColumn = Math.min(checkRange.startColumn, destRange.startColumn);\n                    destRange.startRow = Math.min(row, destRange.startRow);\n                    destRange.endRow = Math.max(row, destRange.endRow);\n                    changed = true;\n                }\n            }\n        }\n\n        if (right && destRange.endColumn !== maxColumn - 1) {\n            const destCol = destRange.endColumn + 1;\n            const checkRange = {\n                startRow: destRange.startRow,\n                startColumn: destCol,\n                endRow: destRange.endRow,\n                endColumn: destCol,\n            };\n            for (let row = checkRange.startRow; row <= checkRange.endRow; row++) {\n                const cellValue = allMatrix.getValue(row, checkRange.endColumn)!;\n                if (cellHasValue(cellValue)) {\n                    destRange.endColumn = Math.max(\n                        checkRange.endColumn + (cellValue.colSpan !== undefined ? cellValue.colSpan - 1 : 0),\n                        destRange.endColumn\n                    );\n                    changed = true;\n                }\n            }\n        }\n    }\n\n    return destRange;\n}\n/**\n * Generate cellValue from range and set null\n * @param range\n * @returns\n */\nexport function generateNullCell(range: IRange[]): IObjectMatrixPrimitiveType<Nullable<ICellData>> {\n    const cellValue = new ObjectMatrix<Nullable<ICellData>>();\n    range.forEach((range: IRange) => {\n        const { startRow, startColumn, endRow, endColumn } = range;\n        for (let i = startRow; i <= endRow; i++) {\n            for (let j = startColumn; j <= endColumn; j++) {\n                cellValue.setValue(i, j, null);\n            }\n        }\n    });\n\n    return cellValue.clone();\n}\n\n/**\n * Generate cellValue from range and set v/p/f/si/custom to null\n * @param range\n * @returns\n */\nexport function generateNullCellValue(range: IRange[]): IObjectMatrixPrimitiveType<ICellData> {\n    const cellValue = new ObjectMatrix<ICellData>();\n    range.forEach((range: IRange) => {\n        const { startRow, startColumn, endRow, endColumn } = range;\n        for (let i = startRow; i <= endRow; i++) {\n            for (let j = startColumn; j <= endColumn; j++) {\n                cellValue.setValue(i, j, {\n                    v: null,\n                    p: null,\n                    f: null,\n                    si: null,\n                    custom: null,\n                });\n            }\n        }\n    });\n\n    return cellValue.clone();\n}\n\n// Generate cellValue from range and set s to null\nexport function generateNullCellStyle(ranges: IRange[]): IObjectMatrixPrimitiveType<ICellData> {\n    const cellValue = new ObjectMatrix<ICellData>();\n\n    ranges.forEach((range: IRange) => {\n        const { startRow, startColumn, endRow, endColumn } = range;\n\n        for (let i = startRow; i <= endRow; i++) {\n            for (let j = startColumn; j <= endColumn; j++) {\n                cellValue.setValue(i, j, {\n                    s: null,\n                });\n            }\n        }\n    });\n\n    return cellValue.clone();\n}\n\nexport function getActiveWorksheet(instanceService: UniverInstanceService): [Nullable<Workbook>, Nullable<Worksheet>] {\n    const workbook = instanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    const worksheet = workbook?.getActiveSheet();\n    return [workbook, worksheet];\n}\n\nexport function rangeToDiscreteRange(range: IRange, accessor: IAccessor, unitId?: string, subUnitId?: string, considerHide?: boolean): IDiscreteRange | null {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const workbook = unitId\n        ? univerInstanceService.getUnit<Workbook>(unitId, UniverInstanceType.UNIVER_SHEET)\n        : univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    const worksheet = subUnitId ? workbook?.getSheetBySheetId(subUnitId) : workbook?.getActiveSheet();\n    if (!worksheet) {\n        return null;\n    }\n    const { startRow, endRow, startColumn, endColumn } = range;\n\n    const rows = [];\n    const cols = [];\n    for (let r = startRow; r <= endRow; r++) {\n        if (!worksheet.getRowFiltered(r)) {\n            if (considerHide) {\n                if (worksheet.getRowRawVisible(r)) {\n                    rows.push(r);\n                }\n            } else {\n                rows.push(r);\n            }\n        }\n    }\n    for (let c = startColumn; c <= endColumn; c++) {\n        if (considerHide) {\n            if (worksheet.getColVisible(c)) {\n                cols.push(c);\n            }\n        } else {\n            cols.push(c);\n        }\n    }\n    return {\n        rows,\n        cols,\n    };\n}\n\nexport function getVisibleRanges(ranges: IRange[], accessor: IAccessor, unitId?: string, subUnitId?: string): IRange[] {\n    const allRows: number[] = [];\n    const allCols: number[] = [];\n\n    for (const range of ranges) {\n        const discreteRange = rangeToDiscreteRange(range, accessor, unitId, subUnitId, true);\n\n        if (discreteRange) {\n            allRows.push(...discreteRange.rows);\n            allCols.push(...discreteRange.cols);\n        }\n    }\n\n    const uniqueRows = Array.from(new Set(allRows)).sort((a, b) => a - b);\n    const uniqueCols = Array.from(new Set(allCols)).sort((a, b) => a - b);\n\n    const visibleRanges: IRange[] = [];\n\n    function findContinuousSegments(arr: number[]): number[][] {\n        const segments: number[][] = [];\n        let start = arr[0];\n\n        for (let i = 1; i < arr.length; i++) {\n            if (arr[i] !== arr[i - 1] + 1) {\n                segments.push([start, arr[i - 1]]);\n                start = arr[i];\n            }\n        }\n        segments.push([start, arr[arr.length - 1]]);\n        return segments;\n    }\n\n    const rowSegments = findContinuousSegments(uniqueRows);\n    const colSegments = findContinuousSegments(uniqueCols);\n\n    for (const [startRow, endRow] of rowSegments) {\n        for (const [startCol, endCol] of colSegments) {\n            visibleRanges.push({\n                startRow,\n                endRow,\n                startColumn: startCol,\n                endColumn: endCol,\n            });\n        }\n    }\n\n    return visibleRanges;\n}\n"],"mappings":"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","names":["range"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4f028f98b18ba0edd562f63732b3477ed303870b"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/utils/handle-range-mutation.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/utils/handle-range-mutation.ts","statementMap":{"0":{"start":{"line":11,"column":46},"end":{"line":16,"column":2}},"1":{"start":{"line":11,"column":69},"end":{"line":16,"column":1}},"2":{"start":{"line":18,"column":15},"end":{"line":18,"column":17}},"3":{"start":{"line":19,"column":15},"end":{"line":19,"column":17}},"4":{"start":{"line":20,"column":71},"end":{"line":20,"column":77}},"5":{"start":{"line":21,"column":26},"end":{"line":21,"column":62}},"6":{"start":{"line":22,"column":34},"end":{"line":22,"column":71}},"7":{"start":{"line":23,"column":19},"end":{"line":23,"column":65}},"8":{"start":{"line":24,"column":20},"end":{"line":24,"column":58}},"9":{"start":{"line":25,"column":2},"end":{"line":105,"column":3}},"10":{"start":{"line":26,"column":23},"end":{"line":26,"column":48}},"11":{"start":{"line":27,"column":22},"end":{"line":27,"column":47}},"12":{"start":{"line":28,"column":4},"end":{"line":79,"column":5}},"13":{"start":{"line":31,"column":6},"end":{"line":68,"column":7}},"14":{"start":{"line":32,"column":23},"end":{"line":32,"column":63}},"15":{"start":{"line":33,"column":24},"end":{"line":33,"column":25}},"16":{"start":{"line":34,"column":8},"end":{"line":38,"column":9}},"17":{"start":{"line":34,"column":23},"end":{"line":34,"column":37}},"18":{"start":{"line":35,"column":26},"end":{"line":35,"column":48}},"19":{"start":{"line":36,"column":28},"end":{"line":36,"column":69}},"20":{"start":{"line":37,"column":10},"end":{"line":37,"column":53}},"21":{"start":{"line":39,"column":8},"end":{"line":44,"column":10}},"22":{"start":{"line":45,"column":22},"end":{"line":45,"column":61}},"23":{"start":{"line":46,"column":8},"end":{"line":51,"column":10}},"24":{"start":{"line":53,"column":26},"end":{"line":53,"column":72}},"25":{"start":{"line":54,"column":23},"end":{"line":54,"column":39}},"26":{"start":{"line":55,"column":8},"end":{"line":60,"column":10}},"27":{"start":{"line":61,"column":22},"end":{"line":61,"column":55}},"28":{"start":{"line":62,"column":8},"end":{"line":67,"column":10}},"29":{"start":{"line":69,"column":33},"end":{"line":74,"column":7}},"30":{"start":{"line":75,"column":6},"end":{"line":78,"column":7}},"31":{"start":{"line":76,"column":8},"end":{"line":76,"column":47}},"32":{"start":{"line":77,"column":8},"end":{"line":77,"column":47}},"33":{"start":{"line":80,"column":4},"end":{"line":89,"column":5}},"34":{"start":{"line":81,"column":6},"end":{"line":88,"column":7}},"35":{"start":{"line":81,"column":21},"end":{"line":81,"column":35}},"36":{"start":{"line":82,"column":8},"end":{"line":84,"column":9}},"37":{"start":{"line":83,"column":10},"end":{"line":83,"column":30}},"38":{"start":{"line":85,"column":8},"end":{"line":87,"column":9}},"39":{"start":{"line":85,"column":26},"end":{"line":85,"column":43}},"40":{"start":{"line":86,"column":10},"end":{"line":86,"column":40}},"41":{"start":{"line":90,"column":41},"end":{"line":94,"column":5}},"42":{"start":{"line":95,"column":45},"end":{"line":98,"column":5}},"43":{"start":{"line":99,"column":65},"end":{"line":102,"column":6}},"44":{"start":{"line":103,"column":4},"end":{"line":103,"column":108}},"45":{"start":{"line":104,"column":4},"end":{"line":104,"column":112}},"46":{"start":{"line":106,"column":2},"end":{"line":109,"column":4}},"47":{"start":{"line":112,"column":15},"end":{"line":112,"column":17}},"48":{"start":{"line":113,"column":15},"end":{"line":113,"column":17}},"49":{"start":{"line":114,"column":55},"end":{"line":114,"column":61}},"50":{"start":{"line":115,"column":26},"end":{"line":115,"column":62}},"51":{"start":{"line":116,"column":34},"end":{"line":116,"column":71}},"52":{"start":{"line":117,"column":19},"end":{"line":117,"column":65}},"53":{"start":{"line":118,"column":20},"end":{"line":118,"column":58}},"54":{"start":{"line":119,"column":2},"end":{"line":195,"column":3}},"55":{"start":{"line":120,"column":23},"end":{"line":120,"column":48}},"56":{"start":{"line":121,"column":22},"end":{"line":121,"column":47}},"57":{"start":{"line":122,"column":41},"end":{"line":126,"column":5}},"58":{"start":{"line":127,"column":45},"end":{"line":130,"column":5}},"59":{"start":{"line":131,"column":24},"end":{"line":134,"column":6}},"60":{"start":{"line":135,"column":4},"end":{"line":135,"column":109}},"61":{"start":{"line":136,"column":4},"end":{"line":139,"column":7}},"62":{"start":{"line":140,"column":4},"end":{"line":194,"column":5}},"63":{"start":{"line":141,"column":26},"end":{"line":141,"column":30}},"64":{"start":{"line":142,"column":24},"end":{"line":142,"column":28}},"65":{"start":{"line":143,"column":6},"end":{"line":164,"column":7}},"66":{"start":{"line":144,"column":23},"end":{"line":144,"column":63}},"67":{"start":{"line":145,"column":24},"end":{"line":145,"column":25}},"68":{"start":{"line":146,"column":8},"end":{"line":150,"column":9}},"69":{"start":{"line":146,"column":23},"end":{"line":146,"column":37}},"70":{"start":{"line":147,"column":26},"end":{"line":147,"column":48}},"71":{"start":{"line":148,"column":28},"end":{"line":148,"column":69}},"72":{"start":{"line":149,"column":10},"end":{"line":149,"column":53}},"73":{"start":{"line":151,"column":8},"end":{"line":156,"column":10}},"74":{"start":{"line":157,"column":22},"end":{"line":157,"column":61}},"75":{"start":{"line":158,"column":8},"end":{"line":163,"column":10}},"76":{"start":{"line":165,"column":6},"end":{"line":181,"column":7}},"77":{"start":{"line":166,"column":26},"end":{"line":166,"column":72}},"78":{"start":{"line":167,"column":23},"end":{"line":167,"column":39}},"79":{"start":{"line":168,"column":8},"end":{"line":173,"column":10}},"80":{"start":{"line":174,"column":22},"end":{"line":174,"column":55}},"81":{"start":{"line":175,"column":8},"end":{"line":180,"column":10}},"82":{"start":{"line":182,"column":6},"end":{"line":193,"column":7}},"83":{"start":{"line":183,"column":35},"end":{"line":188,"column":9}},"84":{"start":{"line":189,"column":8},"end":{"line":192,"column":9}},"85":{"start":{"line":190,"column":10},"end":{"line":190,"column":49}},"86":{"start":{"line":191,"column":10},"end":{"line":191,"column":49}},"87":{"start":{"line":196,"column":2},"end":{"line":199,"column":4}},"88":{"start":{"line":202,"column":55},"end":{"line":202,"column":60}},"89":{"start":{"line":203,"column":2},"end":{"line":245,"column":3}},"90":{"start":{"line":204,"column":17},"end":{"line":204,"column":38}},"91":{"start":{"line":205,"column":4},"end":{"line":214,"column":5}},"92":{"start":{"line":205,"column":17},"end":{"line":205,"column":27}},"93":{"start":{"line":206,"column":6},"end":{"line":213,"column":7}},"94":{"start":{"line":206,"column":19},"end":{"line":206,"column":30}},"95":{"start":{"line":207,"column":22},"end":{"line":207,"column":47}},"96":{"start":{"line":208,"column":8},"end":{"line":212,"column":9}},"97":{"start":{"line":209,"column":10},"end":{"line":209,"column":50}},"98":{"start":{"line":211,"column":10},"end":{"line":211,"column":50}},"99":{"start":{"line":215,"column":4},"end":{"line":223,"column":5}},"100":{"start":{"line":215,"column":17},"end":{"line":215,"column":23}},"101":{"start":{"line":216,"column":6},"end":{"line":222,"column":7}},"102":{"start":{"line":216,"column":19},"end":{"line":216,"column":30}},"103":{"start":{"line":217,"column":8},"end":{"line":221,"column":9}},"104":{"start":{"line":218,"column":10},"end":{"line":218,"column":53}},"105":{"start":{"line":220,"column":10},"end":{"line":220,"column":43}},"106":{"start":{"line":224,"column":9},"end":{"line":245,"column":3}},"107":{"start":{"line":225,"column":20},"end":{"line":225,"column":47}},"108":{"start":{"line":226,"column":4},"end":{"line":235,"column":5}},"109":{"start":{"line":226,"column":17},"end":{"line":226,"column":25}},"110":{"start":{"line":227,"column":6},"end":{"line":234,"column":7}},"111":{"start":{"line":227,"column":19},"end":{"line":227,"column":32}},"112":{"start":{"line":228,"column":22},"end":{"line":228,"column":47}},"113":{"start":{"line":229,"column":8},"end":{"line":233,"column":9}},"114":{"start":{"line":230,"column":10},"end":{"line":230,"column":53}},"115":{"start":{"line":232,"column":10},"end":{"line":232,"column":53}},"116":{"start":{"line":236,"column":4},"end":{"line":244,"column":5}},"117":{"start":{"line":236,"column":17},"end":{"line":236,"column":25}},"118":{"start":{"line":237,"column":6},"end":{"line":243,"column":7}},"119":{"start":{"line":237,"column":19},"end":{"line":237,"column":28}},"120":{"start":{"line":238,"column":8},"end":{"line":242,"column":9}},"121":{"start":{"line":239,"column":10},"end":{"line":239,"column":53}},"122":{"start":{"line":241,"column":10},"end":{"line":241,"column":43}},"123":{"start":{"line":247,"column":46},"end":{"line":285,"column":1}},"124":{"start":{"line":248,"column":32},"end":{"line":248,"column":68}},"125":{"start":{"line":249,"column":17},"end":{"line":249,"column":70}},"126":{"start":{"line":250,"column":2},"end":{"line":250,"column":27}},"127":{"start":{"line":250,"column":15},"end":{"line":250,"column":27}},"128":{"start":{"line":251,"column":24},"end":{"line":251,"column":30}},"129":{"start":{"line":252,"column":21},"end":{"line":252,"column":46}},"130":{"start":{"line":253,"column":19},"end":{"line":253,"column":37}},"131":{"start":{"line":254,"column":21},"end":{"line":254,"column":51}},"132":{"start":{"line":255,"column":24},"end":{"line":255,"column":57}},"133":{"start":{"line":256,"column":55},"end":{"line":256,"column":67}},"134":{"start":{"line":257,"column":2},"end":{"line":280,"column":3}},"135":{"start":{"line":258,"column":4},"end":{"line":265,"column":5}},"136":{"start":{"line":258,"column":17},"end":{"line":258,"column":25}},"137":{"start":{"line":259,"column":6},"end":{"line":264,"column":7}},"138":{"start":{"line":259,"column":19},"end":{"line":259,"column":30}},"139":{"start":{"line":260,"column":8},"end":{"line":263,"column":9}},"140":{"start":{"line":261,"column":23},"end":{"line":261,"column":48}},"141":{"start":{"line":262,"column":10},"end":{"line":262,"column":40}},"142":{"start":{"line":266,"column":9},"end":{"line":280,"column":3}},"143":{"start":{"line":267,"column":4},"end":{"line":279,"column":5}},"144":{"start":{"line":267,"column":17},"end":{"line":267,"column":25}},"145":{"start":{"line":268,"column":6},"end":{"line":278,"column":7}},"146":{"start":{"line":268,"column":19},"end":{"line":268,"column":30}},"147":{"start":{"line":269,"column":8},"end":{"line":277,"column":9}},"148":{"start":{"line":270,"column":23},"end":{"line":270,"column":48}},"149":{"start":{"line":271,"column":10},"end":{"line":271,"column":40}},"150":{"start":{"line":273,"column":10},"end":{"line":276,"column":11}},"151":{"start":{"line":273,"column":23},"end":{"line":273,"column":24}},"152":{"start":{"line":274,"column":25},"end":{"line":274,"column":50}},"153":{"start":{"line":275,"column":12},"end":{"line":275,"column":46}},"154":{"start":{"line":281,"column":2},"end":{"line":284,"column":4}},"155":{"start":{"line":287,"column":55},"end":{"line":287,"column":60}},"156":{"start":{"line":288,"column":15},"end":{"line":288,"column":36}},"157":{"start":{"line":289,"column":18},"end":{"line":289,"column":45}},"158":{"start":{"line":290,"column":2},"end":{"line":312,"column":3}},"159":{"start":{"line":291,"column":4},"end":{"line":300,"column":5}},"160":{"start":{"line":291,"column":17},"end":{"line":291,"column":25}},"161":{"start":{"line":292,"column":6},"end":{"line":299,"column":7}},"162":{"start":{"line":292,"column":19},"end":{"line":292,"column":30}},"163":{"start":{"line":293,"column":22},"end":{"line":293,"column":54}},"164":{"start":{"line":294,"column":8},"end":{"line":298,"column":9}},"165":{"start":{"line":295,"column":10},"end":{"line":295,"column":43}},"166":{"start":{"line":297,"column":10},"end":{"line":297,"column":43}},"167":{"start":{"line":301,"column":9},"end":{"line":312,"column":3}},"168":{"start":{"line":302,"column":4},"end":{"line":311,"column":5}},"169":{"start":{"line":302,"column":17},"end":{"line":302,"column":25}},"170":{"start":{"line":303,"column":6},"end":{"line":310,"column":7}},"171":{"start":{"line":303,"column":19},"end":{"line":303,"column":30}},"172":{"start":{"line":304,"column":22},"end":{"line":304,"column":57}},"173":{"start":{"line":305,"column":8},"end":{"line":309,"column":9}},"174":{"start":{"line":306,"column":10},"end":{"line":306,"column":43}},"175":{"start":{"line":308,"column":10},"end":{"line":308,"column":43}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":11,"column":46},"end":{"line":11,"column":47}},"loc":{"start":{"line":11,"column":69},"end":{"line":16,"column":1}},"line":11},"1":{"name":"getInsertRangeMutations","decl":{"start":{"line":17,"column":16},"end":{"line":17,"column":39}},"loc":{"start":{"line":17,"column":58},"end":{"line":110,"column":1}},"line":17},"2":{"name":"getRemoveRangeMutations","decl":{"start":{"line":111,"column":16},"end":{"line":111,"column":39}},"loc":{"start":{"line":111,"column":58},"end":{"line":200,"column":1}},"line":111},"3":{"name":"handleInsertRangeMutation","decl":{"start":{"line":201,"column":16},"end":{"line":201,"column":41}},"loc":{"start":{"line":201,"column":115},"end":{"line":246,"column":1}},"line":201},"4":{"name":"(anonymous_4)","decl":{"start":{"line":247,"column":46},"end":{"line":247,"column":47}},"loc":{"start":{"line":247,"column":68},"end":{"line":285,"column":1}},"line":247},"5":{"name":"handleDeleteRangeMutation","decl":{"start":{"line":286,"column":16},"end":{"line":286,"column":41}},"loc":{"start":{"line":286,"column":104},"end":{"line":313,"column":1}},"line":286}},"branchMap":{"0":{"loc":{"start":{"line":20,"column":52},"end":{"line":20,"column":66}},"type":"default-arg","locations":[{"start":{"line":20,"column":64},"end":{"line":20,"column":66}}],"line":20},"1":{"loc":{"start":{"line":25,"column":2},"end":{"line":105,"column":3}},"type":"if","locations":[{"start":{"line":25,"column":2},"end":{"line":105,"column":3}},{"start":{},"end":{}}],"line":25},"2":{"loc":{"start":{"line":28,"column":4},"end":{"line":79,"column":5}},"type":"if","locations":[{"start":{"line":28,"column":4},"end":{"line":79,"column":5}},{"start":{},"end":{}}],"line":28},"3":{"loc":{"start":{"line":28,"column":8},"end":{"line":28,"column":86}},"type":"binary-expr","locations":[{"start":{"line":28,"column":8},"end":{"line":28,"column":48}},{"start":{"line":28,"column":52},"end":{"line":28,"column":86}}],"line":28},"4":{"loc":{"start":{"line":31,"column":6},"end":{"line":68,"column":7}},"type":"if","locations":[{"start":{"line":31,"column":6},"end":{"line":68,"column":7}},{"start":{"line":52,"column":13},"end":{"line":68,"column":7}}],"line":31},"5":{"loc":{"start":{"line":36,"column":28},"end":{"line":36,"column":69}},"type":"cond-expr","locations":[{"start":{"line":36,"column":38},"end":{"line":36,"column":65}},{"start":{"line":36,"column":68},"end":{"line":36,"column":69}}],"line":36},"6":{"loc":{"start":{"line":75,"column":6},"end":{"line":78,"column":7}},"type":"if","locations":[{"start":{"line":75,"column":6},"end":{"line":78,"column":7}},{"start":{},"end":{}}],"line":75},"7":{"loc":{"start":{"line":80,"column":4},"end":{"line":89,"column":5}},"type":"if","locations":[{"start":{"line":80,"column":4},"end":{"line":89,"column":5}},{"start":{},"end":{}}],"line":80},"8":{"loc":{"start":{"line":82,"column":8},"end":{"line":84,"column":9}},"type":"if","locations":[{"start":{"line":82,"column":8},"end":{"line":84,"column":9}},{"start":{},"end":{}}],"line":82},"9":{"loc":{"start":{"line":119,"column":2},"end":{"line":195,"column":3}},"type":"if","locations":[{"start":{"line":119,"column":2},"end":{"line":195,"column":3}},{"start":{},"end":{}}],"line":119},"10":{"loc":{"start":{"line":140,"column":4},"end":{"line":194,"column":5}},"type":"if","locations":[{"start":{"line":140,"column":4},"end":{"line":194,"column":5}},{"start":{},"end":{}}],"line":140},"11":{"loc":{"start":{"line":140,"column":8},"end":{"line":140,"column":86}},"type":"binary-expr","locations":[{"start":{"line":140,"column":8},"end":{"line":140,"column":48}},{"start":{"line":140,"column":52},"end":{"line":140,"column":86}}],"line":140},"12":{"loc":{"start":{"line":143,"column":6},"end":{"line":164,"column":7}},"type":"if","locations":[{"start":{"line":143,"column":6},"end":{"line":164,"column":7}},{"start":{},"end":{}}],"line":143},"13":{"loc":{"start":{"line":143,"column":10},"end":{"line":143,"column":87}},"type":"binary-expr","locations":[{"start":{"line":143,"column":10},"end":{"line":143,"column":46}},{"start":{"line":143,"column":50},"end":{"line":143,"column":87}}],"line":143},"14":{"loc":{"start":{"line":148,"column":28},"end":{"line":148,"column":69}},"type":"cond-expr","locations":[{"start":{"line":148,"column":38},"end":{"line":148,"column":65}},{"start":{"line":148,"column":68},"end":{"line":148,"column":69}}],"line":148},"15":{"loc":{"start":{"line":165,"column":6},"end":{"line":181,"column":7}},"type":"if","locations":[{"start":{"line":165,"column":6},"end":{"line":181,"column":7}},{"start":{},"end":{}}],"line":165},"16":{"loc":{"start":{"line":165,"column":10},"end":{"line":165,"column":78}},"type":"binary-expr","locations":[{"start":{"line":165,"column":10},"end":{"line":165,"column":43}},{"start":{"line":165,"column":47},"end":{"line":165,"column":78}}],"line":165},"17":{"loc":{"start":{"line":182,"column":6},"end":{"line":193,"column":7}},"type":"if","locations":[{"start":{"line":182,"column":6},"end":{"line":193,"column":7}},{"start":{},"end":{}}],"line":182},"18":{"loc":{"start":{"line":182,"column":10},"end":{"line":182,"column":38}},"type":"binary-expr","locations":[{"start":{"line":182,"column":10},"end":{"line":182,"column":23}},{"start":{"line":182,"column":27},"end":{"line":182,"column":38}}],"line":182},"19":{"loc":{"start":{"line":189,"column":8},"end":{"line":192,"column":9}},"type":"if","locations":[{"start":{"line":189,"column":8},"end":{"line":192,"column":9}},{"start":{},"end":{}}],"line":189},"20":{"loc":{"start":{"line":203,"column":2},"end":{"line":245,"column":3}},"type":"if","locations":[{"start":{"line":203,"column":2},"end":{"line":245,"column":3}},{"start":{"line":224,"column":9},"end":{"line":245,"column":3}}],"line":203},"21":{"loc":{"start":{"line":208,"column":8},"end":{"line":212,"column":9}},"type":"if","locations":[{"start":{"line":208,"column":8},"end":{"line":212,"column":9}},{"start":{"line":210,"column":15},"end":{"line":212,"column":9}}],"line":208},"22":{"loc":{"start":{"line":217,"column":8},"end":{"line":221,"column":9}},"type":"if","locations":[{"start":{"line":217,"column":8},"end":{"line":221,"column":9}},{"start":{"line":219,"column":15},"end":{"line":221,"column":9}}],"line":217},"23":{"loc":{"start":{"line":217,"column":12},"end":{"line":217,"column":56}},"type":"binary-expr","locations":[{"start":{"line":217,"column":12},"end":{"line":217,"column":21}},{"start":{"line":217,"column":25},"end":{"line":217,"column":37}},{"start":{"line":217,"column":41},"end":{"line":217,"column":56}}],"line":217},"24":{"loc":{"start":{"line":224,"column":9},"end":{"line":245,"column":3}},"type":"if","locations":[{"start":{"line":224,"column":9},"end":{"line":245,"column":3}},{"start":{},"end":{}}],"line":224},"25":{"loc":{"start":{"line":229,"column":8},"end":{"line":233,"column":9}},"type":"if","locations":[{"start":{"line":229,"column":8},"end":{"line":233,"column":9}},{"start":{"line":231,"column":15},"end":{"line":233,"column":9}}],"line":229},"26":{"loc":{"start":{"line":238,"column":8},"end":{"line":242,"column":9}},"type":"if","locations":[{"start":{"line":238,"column":8},"end":{"line":242,"column":9}},{"start":{"line":240,"column":15},"end":{"line":242,"column":9}}],"line":238},"27":{"loc":{"start":{"line":238,"column":12},"end":{"line":238,"column":56}},"type":"binary-expr","locations":[{"start":{"line":238,"column":12},"end":{"line":238,"column":21}},{"start":{"line":238,"column":25},"end":{"line":238,"column":37}},{"start":{"line":238,"column":41},"end":{"line":238,"column":56}}],"line":238},"28":{"loc":{"start":{"line":250,"column":2},"end":{"line":250,"column":27}},"type":"if","locations":[{"start":{"line":250,"column":2},"end":{"line":250,"column":27}},{"start":{},"end":{}}],"line":250},"29":{"loc":{"start":{"line":257,"column":2},"end":{"line":280,"column":3}},"type":"if","locations":[{"start":{"line":257,"column":2},"end":{"line":280,"column":3}},{"start":{"line":266,"column":9},"end":{"line":280,"column":3}}],"line":257},"30":{"loc":{"start":{"line":260,"column":8},"end":{"line":263,"column":9}},"type":"if","locations":[{"start":{"line":260,"column":8},"end":{"line":263,"column":9}},{"start":{},"end":{}}],"line":260},"31":{"loc":{"start":{"line":266,"column":9},"end":{"line":280,"column":3}},"type":"if","locations":[{"start":{"line":266,"column":9},"end":{"line":280,"column":3}},{"start":{},"end":{}}],"line":266},"32":{"loc":{"start":{"line":269,"column":8},"end":{"line":277,"column":9}},"type":"if","locations":[{"start":{"line":269,"column":8},"end":{"line":277,"column":9}},{"start":{"line":272,"column":15},"end":{"line":277,"column":9}}],"line":269},"33":{"loc":{"start":{"line":290,"column":2},"end":{"line":312,"column":3}},"type":"if","locations":[{"start":{"line":290,"column":2},"end":{"line":312,"column":3}},{"start":{"line":301,"column":9},"end":{"line":312,"column":3}}],"line":290},"34":{"loc":{"start":{"line":294,"column":8},"end":{"line":298,"column":9}},"type":"if","locations":[{"start":{"line":294,"column":8},"end":{"line":298,"column":9}},{"start":{"line":296,"column":15},"end":{"line":298,"column":9}}],"line":294},"35":{"loc":{"start":{"line":301,"column":9},"end":{"line":312,"column":3}},"type":"if","locations":[{"start":{"line":301,"column":9},"end":{"line":312,"column":3}},{"start":{},"end":{}}],"line":301},"36":{"loc":{"start":{"line":305,"column":8},"end":{"line":309,"column":9}},"type":"if","locations":[{"start":{"line":305,"column":8},"end":{"line":309,"column":9}},{"start":{"line":307,"column":15},"end":{"line":309,"column":9}}],"line":305}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":2,"48":2,"49":2,"50":2,"51":2,"52":2,"53":2,"54":2,"55":2,"56":2,"57":2,"58":2,"59":2,"60":2,"61":2,"62":2,"63":2,"64":2,"65":2,"66":1,"67":1,"68":1,"69":1,"70":1,"71":1,"72":1,"73":1,"74":1,"75":1,"76":2,"77":1,"78":1,"79":1,"80":1,"81":1,"82":2,"83":2,"84":2,"85":2,"86":2,"87":2,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":1,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0},"f":{"0":0,"1":0,"2":2,"3":0,"4":0,"5":0},"b":{"0":[0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[2,0],"10":[2,0],"11":[2,0],"12":[1,1],"13":[2,1],"14":[1,0],"15":[1,1],"16":[2,1],"17":[2,0],"18":[2,2],"19":[2,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/utils/handle-range-mutation.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICellData, IMutationInfo, IObjectMatrixPrimitiveType, IRange, Nullable } from '@univerjs/core';\nimport { Dimension, getArrayLength, IUniverInstanceService, ObjectMatrix, Tools } from '@univerjs/core';\n\nimport type {\n    IDeleteRangeMutationParams,\n    IInsertRangeMutationParams,\n} from '../../basics/interfaces/mutation-interface';\nimport { SheetInterceptorService } from '../../services/sheet-interceptor/sheet-interceptor.service';\nimport { getMoveRangeUndoRedoMutations } from '../commands/move-range.command';\nimport { SetRangeValuesCommand } from '../commands/set-range-values.command';\nimport {\n    type ISetRangeValuesMutationParams,\n    SetRangeValuesMutation,\n    SetRangeValuesUndoMutationFactory,\n} from '../mutations/set-range-values.mutation';\nimport { getSheetMutationTarget } from '../commands/utils/target-util';\nimport { generateNullCell } from '../../basics/utils';\n\n/**\n * Generate undo mutation of a `InsertRangeMutation`\n *\n * @param {IAccessor} accessor - injector accessor\n * @param {IInsertRangeMutationParams} params - do mutation params\n * @returns {IDeleteRangeMutationParams} undo mutation params\n */\nexport const InsertRangeUndoMutationFactory = (\n    accessor: IAccessor,\n    params: IInsertRangeMutationParams\n): IDeleteRangeMutationParams => ({\n    unitId: params.unitId,\n    subUnitId: params.subUnitId,\n    range: params.range,\n    shiftDimension: params.shiftDimension,\n});\n\n// export const InsertRangeMutation: IMutation<IInsertRangeMutationParams, boolean> = {\n//     id: 'sheet.mutation.insert-range',\n//     type: CommandType.MUTATION,\n//     handler: (accessor, params) => {\n//         const { unitId, subUnitId, range, cellValue, shiftDimension } = params;\n//         const univerInstanceService = accessor.get(IUniverInstanceService);\n//         const workbook = univerInstanceService.getUniverSheetInstance(unitId);\n//         if (!workbook) return false;\n//         const worksheet = workbook.getSheetBySheetId(subUnitId);\n//         if (!worksheet) return false;\n\n//         const cellMatrix = worksheet.getCellMatrix();\n//         const lastEndRow = worksheet.getLastRowWithContent();\n//         const lastEndColumn = worksheet.getLastColumnWithContent();\n\n//         handleInsertRangeMutation(cellMatrix, range, lastEndRow, lastEndColumn, shiftDimension, cellValue);\n\n//         return true;\n//     },\n// };\n\n/**\n * InsertRange is not a mutation but combination of `SetRangeValuesMutation` and `MoveRangeMutation`.\n * @param accessor\n * @param params\n * @returns\n */\n\nexport function getInsertRangeMutations(accessor: IAccessor, params: IInsertRangeMutationParams) {\n    const redo: IMutationInfo[] = [];\n    const undo: IMutationInfo[] = [];\n    const { unitId, subUnitId, range, shiftDimension, cellValue = {} } = params;\n    const instanceService = accessor.get(IUniverInstanceService);\n    const sheetInterceptorService = accessor.get(SheetInterceptorService);\n\n    const workbook = instanceService.getUniverSheetInstance(unitId);\n    const worksheet = workbook?.getSheetBySheetId(subUnitId);\n    if (worksheet) {\n        const cellMatrix = worksheet.getCellMatrix();\n        const dataRange = cellMatrix.getDataRange();\n\n        if (range.startColumn <= dataRange.endColumn || range.startRow <= dataRange.endRow) {\n            let moveFromRange: IRange;\n            let moveToRange: IRange;\n            if (shiftDimension === Dimension.COLUMNS) {\n                const endRow = Math.min(range.endRow, dataRange.endRow);\n                let endColumn = 0;\n                for (let row = range.startRow; row <= endRow; row++) {\n                    const rowData = cellMatrix.getRow(row);\n                    const rowLength = rowData ? getArrayLength(rowData) - 1 : 0;\n                    endColumn = Math.max(endColumn, rowLength);\n                }\n\n                moveFromRange = {\n                    startRow: range.startRow,\n                    startColumn: range.startColumn,\n                    endRow,\n                    endColumn,\n                };\n                const shift = range.endColumn - range.startColumn + 1;\n                moveToRange = {\n                    startRow: range.startRow,\n                    startColumn: moveFromRange.startColumn + shift,\n                    endRow,\n                    endColumn: moveFromRange.endColumn + shift,\n                };\n            } else {\n                const endColumn = Math.min(range.endColumn, dataRange.endColumn);\n                const endRow = dataRange.endRow;\n                moveFromRange = {\n                    startRow: range.startRow,\n                    startColumn: range.startColumn,\n                    endRow,\n                    endColumn,\n                };\n                const shift = range.endRow - range.startRow + 1;\n                moveToRange = {\n                    startRow: moveFromRange.startRow + shift,\n                    startColumn: range.startColumn,\n                    endRow: moveFromRange.endRow + shift,\n                    endColumn,\n                };\n            }\n\n            const moveRangeMutations = getMoveRangeUndoRedoMutations(\n                accessor,\n                { unitId, subUnitId, range: moveFromRange },\n                { unitId, subUnitId, range: moveToRange },\n                true\n            );\n            if (moveRangeMutations) {\n                redo.push(...moveRangeMutations.redos);\n                undo.push(...moveRangeMutations.undos);\n            }\n        }\n\n        if (Object.entries(cellValue).length === 0) {\n            for (let row = range.startRow; row <= range.endRow; row++) {\n                if (!cellValue[row]) {\n                    cellValue[row] = {};\n                }\n                for (let column = range.startColumn; column <= range.endColumn; column++) {\n                    cellValue[row][column] = null;\n                }\n            }\n        }\n\n        const setRangeValuesMutationParams: ISetRangeValuesMutationParams = {\n            subUnitId,\n            unitId,\n            cellValue,\n        };\n        const undoSetRangeValuesMutationParams: ISetRangeValuesMutationParams = SetRangeValuesUndoMutationFactory(\n            accessor,\n            setRangeValuesMutationParams\n        );\n        const { undos: interceptorUndos, redos: interceptorRedos } = sheetInterceptorService.onCommandExecute({\n            id: SetRangeValuesCommand.id,\n            params: { ...setRangeValuesMutationParams, range },\n        });\n\n        redo.push({ id: SetRangeValuesMutation.id, params: setRangeValuesMutationParams }, ...interceptorRedos);\n        undo.push({ id: SetRangeValuesMutation.id, params: undoSetRangeValuesMutationParams }, ...interceptorUndos);\n    }\n    return {\n        redo,\n        undo,\n    };\n}\n\n// eslint-disable-next-line max-lines-per-function\nexport function getRemoveRangeMutations(accessor: IAccessor, params: IDeleteRangeMutationParams) {\n    const redo: IMutationInfo[] = [];\n    const undo: IMutationInfo[] = [];\n    const { unitId, subUnitId, range, shiftDimension } = params;\n    const instanceService = accessor.get(IUniverInstanceService);\n    const sheetInterceptorService = accessor.get(SheetInterceptorService);\n\n    const workbook = instanceService.getUniverSheetInstance(unitId);\n    const worksheet = workbook?.getSheetBySheetId(subUnitId);\n    if (worksheet) {\n        const cellMatrix = worksheet.getCellMatrix();\n        const dataRange = cellMatrix.getDataRange();\n\n        const setRangeValuesMutationParams: ISetRangeValuesMutationParams = {\n            subUnitId,\n            unitId,\n            cellValue: generateNullCell([range]),\n        };\n        const undoSetRangeValuesMutationParams: ISetRangeValuesMutationParams = SetRangeValuesUndoMutationFactory(\n            accessor,\n            setRangeValuesMutationParams\n        );\n        const intercepted = sheetInterceptorService.onCommandExecute({\n            id: SetRangeValuesCommand.id,\n            params: setRangeValuesMutationParams,\n        });\n        redo.push({ id: SetRangeValuesMutation.id, params: setRangeValuesMutationParams }, ...intercepted.redos);\n        undo.push(...intercepted.undos, {\n            id: SetRangeValuesMutation.id,\n            params: undoSetRangeValuesMutationParams,\n        });\n\n        if (range.startColumn <= dataRange.endColumn || range.startRow <= dataRange.endRow) {\n            let moveFromRange: IRange | null = null;\n            let moveToRange: IRange | null = null;\n            if (shiftDimension === Dimension.COLUMNS && range.endColumn < dataRange.endColumn) {\n                const endRow = Math.min(range.endRow, dataRange.endRow);\n                let endColumn = 0;\n                for (let row = range.startRow; row <= endRow; row++) {\n                    const rowData = cellMatrix.getRow(row);\n                    const rowLength = rowData ? getArrayLength(rowData) - 1 : 0;\n                    endColumn = Math.max(endColumn, rowLength);\n                }\n\n                moveFromRange = {\n                    startRow: range.startRow,\n                    startColumn: range.endColumn + 1,\n                    endRow,\n                    endColumn,\n                };\n                const shift = range.endColumn - range.startColumn + 1;\n                moveToRange = {\n                    startRow: range.startRow,\n                    startColumn: moveFromRange.startColumn - shift,\n                    endRow,\n                    endColumn: moveFromRange.endColumn - shift,\n                };\n            }\n\n            if (shiftDimension === Dimension.ROWS && range.endRow < dataRange.endRow) {\n                const endColumn = Math.min(range.endColumn, dataRange.endColumn);\n                const endRow = dataRange.endRow;\n                moveFromRange = {\n                    startRow: range.endRow + 1,\n                    startColumn: range.startColumn,\n                    endRow,\n                    endColumn,\n                };\n                const shift = range.endRow - range.startRow + 1;\n                moveToRange = {\n                    startRow: moveFromRange.startRow - shift,\n                    startColumn: range.startColumn,\n                    endRow: moveFromRange.endRow - shift,\n                    endColumn,\n                };\n            }\n\n            if (moveFromRange && moveToRange) {\n                const moveRangeMutations = getMoveRangeUndoRedoMutations(\n                    accessor,\n                    { unitId, subUnitId, range: moveFromRange },\n                    { unitId, subUnitId, range: moveToRange },\n                    true\n                );\n                if (moveRangeMutations) {\n                    redo.push(...moveRangeMutations.redos);\n                    undo.push(...moveRangeMutations.undos);\n                }\n            }\n        }\n    }\n    return {\n        redo,\n        undo,\n    };\n}\n\nexport function handleInsertRangeMutation<T>(\n    cellMatrix: ObjectMatrix<T>,\n    range: IRange,\n    lastEndRow: number,\n    lastEndColumn: number,\n    shiftDimension: Dimension,\n    cellValue?: IObjectMatrixPrimitiveType<T>\n) {\n    const { startRow, endRow, startColumn, endColumn } = range;\n    if (shiftDimension === Dimension.ROWS) {\n        const rows = endRow - startRow + 1;\n        // build new data\n        for (let r = lastEndRow; r >= startRow; r--) {\n            for (let c = startColumn; c <= endColumn; c++) {\n                // get value blow current range\n\n                const value = cellMatrix.getValue(r, c);\n                if (value == null) {\n                    cellMatrix.realDeleteValue(r + rows, c);\n                } else {\n                    cellMatrix.setValue(r + rows, c, value);\n                }\n            }\n        }\n        // insert cell value from user\n        for (let r = endRow; r >= startRow; r--) {\n            for (let c = startColumn; c <= endColumn; c++) {\n                if (cellValue && cellValue[r] && cellValue[r][c]) {\n                    cellMatrix.setValue(r, c, cellValue[r][c]);\n                } else {\n                    cellMatrix.realDeleteValue(r, c);\n                }\n            }\n        }\n    } else if (shiftDimension === Dimension.COLUMNS) {\n        const columns = endColumn - startColumn + 1;\n        for (let r = startRow; r <= endRow; r++) {\n            for (let c = lastEndColumn; c >= startColumn; c--) {\n                // get value blow current range\n                const value = cellMatrix.getValue(r, c);\n\n                if (value == null) {\n                    cellMatrix.realDeleteValue(r, c + columns);\n                } else {\n                    cellMatrix.setValue(r, c + columns, value);\n                }\n            }\n        }\n        // insert cell value from user\n        for (let r = startRow; r <= endRow; r++) {\n            for (let c = endColumn; c >= startColumn; c--) {\n                if (cellValue && cellValue[r] && cellValue[r][c]) {\n                    cellMatrix.setValue(r, c, cellValue[r][c]);\n                } else {\n                    cellMatrix.realDeleteValue(r, c);\n                }\n            }\n        }\n    }\n}\n\n/**\n * Generate undo mutation of a `DeleteRangeMutation`\n *\n * @param {IAccessor} accessor - injector accessor\n * @param {IDeleteRangeMutationParams} params - do mutation params\n * @returns {IInsertRangeMutationParams} undo mutation params\n */\nexport const DeleteRangeUndoMutationFactory = (\n    accessor: IAccessor,\n    params: IDeleteRangeMutationParams\n): Nullable<IInsertRangeMutationParams> => {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const target = getSheetMutationTarget(univerInstanceService, params);\n    if (!target) return null;\n\n    const { worksheet } = target;\n    const cellMatrix = worksheet.getCellMatrix();\n    const undoData = new ObjectMatrix<ICellData>();\n    const lastEndRow = worksheet.getConfig().rowCount;\n    const lastEndColumn = worksheet.getConfig().columnCount;\n\n    const { startRow, endRow, startColumn, endColumn } = params.range;\n    if (params.shiftDimension === Dimension.ROWS) {\n        // build new data\n        for (let r = startRow; r <= lastEndRow; r++) {\n            for (let c = startColumn; c <= endColumn; c++) {\n                // store old value\n                if (r <= endRow) {\n                    const cell: Nullable<ICellData> = cellMatrix.getValue(r, c);\n                    undoData.setValue(r, c, cell as ICellData);\n                }\n            }\n        }\n    } else if (params.shiftDimension === Dimension.COLUMNS) {\n        // build new data\n        for (let r = startRow; r <= endRow; r++) {\n            for (let c = startColumn; c <= lastEndColumn; c++) {\n                // store old value\n                if (c <= endColumn) {\n                    const cell: Nullable<ICellData> = cellMatrix.getValue(r, c);\n                    undoData.setValue(r, c, cell as ICellData);\n                } else {\n                    for (let i = 0; i <= endColumn; i++) {\n                        const cell: Nullable<ICellData> = cellMatrix.getValue(r, c);\n                        undoData.setValue(r, c + i, cell as ICellData);\n                    }\n                }\n            }\n        }\n    }\n\n    return {\n        ...Tools.deepClone(params),\n        cellValue: undoData.getData(),\n    };\n};\n\nexport function handleDeleteRangeMutation<T>(\n    cellMatrix: ObjectMatrix<T>,\n    range: IRange,\n    lastEndRow: number,\n    lastEndColumn: number,\n    shiftDimension: Dimension\n) {\n    const { startRow, endRow, startColumn, endColumn } = range;\n\n    const rows = endRow - startRow + 1;\n    const columns = endColumn - startColumn + 1;\n\n    if (shiftDimension === Dimension.ROWS) {\n        // build new data\n        for (let r = startRow; r <= lastEndRow; r++) {\n            for (let c = startColumn; c <= endColumn; c++) {\n                // get value blow current range\n                const value = cellMatrix.getValue(r + rows, c);\n                if (value == null) {\n                    cellMatrix.realDeleteValue(r, c);\n                } else {\n                    cellMatrix.setValue(r, c, value);\n                }\n            }\n        }\n    } else if (shiftDimension === Dimension.COLUMNS) {\n        // build new data\n        for (let r = startRow; r <= endRow; r++) {\n            for (let c = startColumn; c <= lastEndColumn; c++) {\n                // get value blow current range\n\n                const value = cellMatrix.getValue(r, c + columns);\n                if (value == null) {\n                    cellMatrix.realDeleteValue(r, c);\n                } else {\n                    cellMatrix.setValue(r, c, value);\n                }\n            }\n        }\n    }\n}\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"bdc49a084386f2530f080acd9c749183e6ebce77"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/delete-range-move-left.command.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/delete-range-move-left.command.ts","statementMap":{"0":{"start":{"line":14,"column":44},"end":{"line":14,"column":82}},"1":{"start":{"line":15,"column":42},"end":{"line":64,"column":1}},"2":{"start":{"line":19,"column":27},"end":{"line":19,"column":56}},"3":{"start":{"line":20,"column":28},"end":{"line":20,"column":58}},"4":{"start":{"line":21,"column":34},"end":{"line":21,"column":70}},"5":{"start":{"line":22,"column":36},"end":{"line":22,"column":73}},"6":{"start":{"line":23,"column":36},"end":{"line":23,"column":73}},"7":{"start":{"line":24,"column":19},"end":{"line":24,"column":63}},"8":{"start":{"line":25,"column":4},"end":{"line":25,"column":30}},"9":{"start":{"line":25,"column":17},"end":{"line":25,"column":30}},"10":{"start":{"line":26,"column":55},"end":{"line":26,"column":61}},"11":{"start":{"line":27,"column":16},"end":{"line":27,"column":29}},"12":{"start":{"line":28,"column":4},"end":{"line":30,"column":5}},"13":{"start":{"line":29,"column":6},"end":{"line":29,"column":71}},"14":{"start":{"line":31,"column":4},"end":{"line":31,"column":29}},"15":{"start":{"line":31,"column":16},"end":{"line":31,"column":29}},"16":{"start":{"line":32,"column":38},"end":{"line":37,"column":5}},"17":{"start":{"line":38,"column":29},"end":{"line":41,"column":6}},"18":{"start":{"line":42,"column":61},"end":{"line":45,"column":5}},"19":{"start":{"line":46,"column":18},"end":{"line":46,"column":74}},"20":{"start":{"line":47,"column":18},"end":{"line":47,"column":65}},"21":{"start":{"line":48,"column":4},"end":{"line":48,"column":42}},"22":{"start":{"line":49,"column":4},"end":{"line":49,"column":69}},"23":{"start":{"line":50,"column":4},"end":{"line":50,"column":51}},"24":{"start":{"line":51,"column":19},"end":{"line":51,"column":64}},"25":{"start":{"line":52,"column":4},"end":{"line":59,"column":5}},"26":{"start":{"line":53,"column":6},"end":{"line":57,"column":9}},"27":{"start":{"line":58,"column":6},"end":{"line":58,"column":18}},"28":{"start":{"line":60,"column":4},"end":{"line":60,"column":17}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":18,"column":11},"end":{"line":18,"column":12}},"loc":{"start":{"line":18,"column":39},"end":{"line":61,"column":3}},"line":18}},"branchMap":{"0":{"loc":{"start":{"line":25,"column":4},"end":{"line":25,"column":30}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":30}},{"start":{},"end":{}}],"line":25},"1":{"loc":{"start":{"line":28,"column":4},"end":{"line":30,"column":5}},"type":"if","locations":[{"start":{"line":28,"column":4},"end":{"line":30,"column":5}},{"start":{},"end":{}}],"line":28},"2":{"loc":{"start":{"line":31,"column":4},"end":{"line":31,"column":29}},"type":"if","locations":[{"start":{"line":31,"column":4},"end":{"line":31,"column":29}},{"start":{},"end":{}}],"line":31},"3":{"loc":{"start":{"line":46,"column":22},"end":{"line":46,"column":53}},"type":"binary-expr","locations":[{"start":{"line":46,"column":22},"end":{"line":46,"column":47}},{"start":{"line":46,"column":51},"end":{"line":46,"column":53}}],"line":46},"4":{"loc":{"start":{"line":50,"column":18},"end":{"line":50,"column":49}},"type":"binary-expr","locations":[{"start":{"line":50,"column":18},"end":{"line":50,"column":43}},{"start":{"line":50,"column":47},"end":{"line":50,"column":49}}],"line":50},"5":{"loc":{"start":{"line":52,"column":4},"end":{"line":59,"column":5}},"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":59,"column":5}},{"start":{},"end":{}}],"line":52}},"s":{"0":1,"1":1,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":2,"9":0,"10":2,"11":2,"12":2,"13":2,"14":2,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":0},"f":{"0":2},"b":{"0":[0,2],"1":[2,0],"2":[1,1],"3":[1,0],"4":[1,0],"5":[1,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/delete-range-move-left.command.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand, IMutationInfo, IRange } from '@univerjs/core';\nimport type { IDeleteRangeMutationParams } from '../../basics/interfaces/mutation-interface';\n\nimport {\n    CommandType,\n    Dimension,\n    ICommandService,\n    IUndoRedoService,\n    IUniverInstanceService,\n    sequenceExecute,\n} from '@univerjs/core';\nimport { SheetsSelectionsService } from '../../services/selections/selection.service';\nimport { SheetInterceptorService } from '../../services/sheet-interceptor/sheet-interceptor.service';\nimport { getRemoveRangeMutations } from '../utils/handle-range-mutation';\nimport { followSelectionOperation } from './utils/selection-utils';\nimport { getSheetCommandTarget } from './utils/target-util';\n\nexport interface IDeleteRangeMoveLeftCommandParams {\n    range: IRange;\n}\n\nexport const DeleteRangeMoveLeftCommandId = 'sheet.command.delete-range-move-left';\n/**\n * The command to delete range.\n */\nexport const DeleteRangeMoveLeftCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: DeleteRangeMoveLeftCommandId,\n\n    handler: async (accessor: IAccessor, params?: IDeleteRangeMoveLeftCommandParams) => {\n        const commandService = accessor.get(ICommandService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet, workbook, subUnitId, unitId } = target;\n\n        let range = params?.range;\n        if (!range) {\n            range = selectionManagerService.getCurrentLastSelection()?.range;\n        }\n\n        if (!range) return false;\n        const deleteRangeMutationParams: IDeleteRangeMutationParams = {\n            range,\n            subUnitId,\n            unitId,\n            shiftDimension: Dimension.COLUMNS,\n        };\n\n        const sheetInterceptor = sheetInterceptorService.onCommandExecute({\n            id: DeleteRangeMoveLeftCommand.id,\n            params: { range } as IDeleteRangeMoveLeftCommandParams,\n        });\n        const { redo: removeRangeRedo, undo: removeRangeUndo } = getRemoveRangeMutations(\n            accessor,\n            deleteRangeMutationParams\n        );\n        const redos: IMutationInfo[] = [...(sheetInterceptor.preRedos ?? []), ...removeRangeRedo];\n        const undos: IMutationInfo[] = [...sheetInterceptor.undos, ...removeRangeUndo];\n        redos.push(...sheetInterceptor.redos);\n        redos.push(followSelectionOperation(range, workbook, worksheet));\n        undos.push(...(sheetInterceptor.preUndos ?? []));\n        // execute do mutations and add undo mutations to undo stack if completed\n        const result = sequenceExecute(redos, commandService).result;\n\n        if (result) {\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: undos.reverse(),\n                redoMutations: redos,\n            });\n\n            return true;\n        }\n\n        return false;\n    },\n    // all subsequent mutations should succeed inorder to make the whole process succeed\n    // Promise.all([]).then(() => true),\n};\n"],"mappings":"AAmBA;AAAA,EACI;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,OACG;AACP,SAAS,+BAA+B;AACxC,SAAS,+BAA+B;AACxC,SAAS,+BAA+B;AACxC,SAAS,gCAAgC;AACzC,SAAS,6BAA6B;AAM/B,aAAM,+BAA+B;AAIrC,aAAM,6BAAuC;AAAA,EAChD,MAAM,YAAY;AAAA,EAClB,IAAI;AAAA,EAEJ,SAAS,OAAO,UAAqB,WAA+C;AAChF,UAAM,iBAAiB,SAAS,IAAI,eAAe;AACnD,UAAM,kBAAkB,SAAS,IAAI,gBAAgB;AACrD,UAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,UAAM,0BAA0B,SAAS,IAAI,uBAAuB;AACpE,UAAM,0BAA0B,SAAS,IAAI,uBAAuB;AAEpE,UAAM,SAAS,sBAAsB,qBAAqB;AAC1D,QAAI,CAAC,OAAQ,QAAO;AAEpB,UAAM,EAAE,WAAW,UAAU,WAAW,OAAO,IAAI;AAEnD,QAAI,QAAQ,QAAQ;AACpB,QAAI,CAAC,OAAO;AACR,cAAQ,wBAAwB,wBAAwB,GAAG;AAAA,IAC/D;AAEA,QAAI,CAAC,MAAO,QAAO;AACnB,UAAM,4BAAwD;AAAA,MAC1D;AAAA,MACA;AAAA,MACA;AAAA,MACA,gBAAgB,UAAU;AAAA,IAC9B;AAEA,UAAM,mBAAmB,wBAAwB,iBAAiB;AAAA,MAC9D,IAAI,2BAA2B;AAAA,MAC/B,QAAQ,EAAE,MAAM;AAAA,IACpB,CAAC;AACD,UAAM,EAAE,MAAM,iBAAiB,MAAM,gBAAgB,IAAI;AAAA,MACrD;AAAA,MACA;AAAA,IACJ;AACA,UAAM,QAAyB,CAAC,GAAI,iBAAiB,YAAY,CAAC,GAAI,GAAG,eAAe;AACxF,UAAM,QAAyB,CAAC,GAAG,iBAAiB,OAAO,GAAG,eAAe;AAC7E,UAAM,KAAK,GAAG,iBAAiB,KAAK;AACpC,UAAM,KAAK,yBAAyB,OAAO,UAAU,SAAS,CAAC;AAC/D,UAAM,KAAK,GAAI,iBAAiB,YAAY,CAAC,CAAE;AAE/C,UAAM,SAAS,gBAAgB,OAAO,cAAc,EAAE;AAEtD,QAAI,QAAQ;AACR,sBAAgB,aAAa;AAAA,QACzB,QAAQ;AAAA,QACR,eAAe,MAAM,QAAQ;AAAA,QAC7B,eAAe;AAAA,MACnB,CAAC;AAED,aAAO;AAAA,IACX;AAEA,WAAO;AAAA,EACX;AAAA;AAAA;AAGJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7ec8146764161d4882b89a2fa8c5b505d1635a60"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/delete-range-move-up.command.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/delete-range-move-up.command.ts","statementMap":{"0":{"start":{"line":14,"column":42},"end":{"line":14,"column":78}},"1":{"start":{"line":15,"column":40},"end":{"line":64,"column":1}},"2":{"start":{"line":19,"column":27},"end":{"line":19,"column":56}},"3":{"start":{"line":20,"column":28},"end":{"line":20,"column":58}},"4":{"start":{"line":21,"column":34},"end":{"line":21,"column":70}},"5":{"start":{"line":22,"column":36},"end":{"line":22,"column":73}},"6":{"start":{"line":23,"column":36},"end":{"line":23,"column":73}},"7":{"start":{"line":24,"column":19},"end":{"line":24,"column":63}},"8":{"start":{"line":25,"column":4},"end":{"line":25,"column":30}},"9":{"start":{"line":25,"column":17},"end":{"line":25,"column":30}},"10":{"start":{"line":26,"column":55},"end":{"line":26,"column":61}},"11":{"start":{"line":27,"column":16},"end":{"line":27,"column":29}},"12":{"start":{"line":28,"column":4},"end":{"line":30,"column":5}},"13":{"start":{"line":29,"column":6},"end":{"line":29,"column":71}},"14":{"start":{"line":31,"column":4},"end":{"line":31,"column":29}},"15":{"start":{"line":31,"column":16},"end":{"line":31,"column":29}},"16":{"start":{"line":32,"column":38},"end":{"line":37,"column":5}},"17":{"start":{"line":38,"column":29},"end":{"line":41,"column":6}},"18":{"start":{"line":42,"column":61},"end":{"line":45,"column":5}},"19":{"start":{"line":46,"column":18},"end":{"line":46,"column":74}},"20":{"start":{"line":47,"column":18},"end":{"line":47,"column":65}},"21":{"start":{"line":48,"column":4},"end":{"line":48,"column":42}},"22":{"start":{"line":49,"column":4},"end":{"line":49,"column":69}},"23":{"start":{"line":50,"column":4},"end":{"line":50,"column":51}},"24":{"start":{"line":51,"column":19},"end":{"line":51,"column":64}},"25":{"start":{"line":52,"column":4},"end":{"line":59,"column":5}},"26":{"start":{"line":53,"column":6},"end":{"line":57,"column":9}},"27":{"start":{"line":58,"column":6},"end":{"line":58,"column":18}},"28":{"start":{"line":60,"column":4},"end":{"line":60,"column":17}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":18,"column":11},"end":{"line":18,"column":12}},"loc":{"start":{"line":18,"column":39},"end":{"line":61,"column":3}},"line":18}},"branchMap":{"0":{"loc":{"start":{"line":25,"column":4},"end":{"line":25,"column":30}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":30}},{"start":{},"end":{}}],"line":25},"1":{"loc":{"start":{"line":28,"column":4},"end":{"line":30,"column":5}},"type":"if","locations":[{"start":{"line":28,"column":4},"end":{"line":30,"column":5}},{"start":{},"end":{}}],"line":28},"2":{"loc":{"start":{"line":31,"column":4},"end":{"line":31,"column":29}},"type":"if","locations":[{"start":{"line":31,"column":4},"end":{"line":31,"column":29}},{"start":{},"end":{}}],"line":31},"3":{"loc":{"start":{"line":46,"column":22},"end":{"line":46,"column":53}},"type":"binary-expr","locations":[{"start":{"line":46,"column":22},"end":{"line":46,"column":47}},{"start":{"line":46,"column":51},"end":{"line":46,"column":53}}],"line":46},"4":{"loc":{"start":{"line":50,"column":18},"end":{"line":50,"column":49}},"type":"binary-expr","locations":[{"start":{"line":50,"column":18},"end":{"line":50,"column":43}},{"start":{"line":50,"column":47},"end":{"line":50,"column":49}}],"line":50},"5":{"loc":{"start":{"line":52,"column":4},"end":{"line":59,"column":5}},"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":59,"column":5}},{"start":{},"end":{}}],"line":52}},"s":{"0":1,"1":1,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":2,"9":0,"10":2,"11":2,"12":2,"13":2,"14":2,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":0},"f":{"0":2},"b":{"0":[0,2],"1":[2,0],"2":[1,1],"3":[1,0],"4":[1,0],"5":[1,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/commands/commands/delete-range-move-up.command.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand, IMutationInfo, IRange } from '@univerjs/core';\nimport type { IDeleteRangeMutationParams } from '../../basics/interfaces/mutation-interface';\n\nimport {\n    CommandType,\n    Dimension,\n    ICommandService,\n    IUndoRedoService,\n    IUniverInstanceService,\n    sequenceExecute,\n} from '@univerjs/core';\nimport { SheetsSelectionsService } from '../../services/selections/selection.service';\nimport { SheetInterceptorService } from '../../services/sheet-interceptor/sheet-interceptor.service';\nimport { getRemoveRangeMutations } from '../utils/handle-range-mutation';\nimport { followSelectionOperation } from './utils/selection-utils';\nimport { getSheetCommandTarget } from './utils/target-util';\n\nexport interface IDeleteRangeMoveUpCommandParams {\n    range: IRange;\n}\n\nexport const DeleteRangeMoveUpCommandId = 'sheet.command.delete-range-move-up';\n/**\n * The command to delete range.\n */\nexport const DeleteRangeMoveUpCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: DeleteRangeMoveUpCommandId,\n\n    handler: async (accessor: IAccessor, params: IDeleteRangeMoveUpCommandParams) => {\n        const commandService = accessor.get(ICommandService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { unitId, subUnitId, workbook, worksheet } = target;\n        let range = params?.range;\n        if (!range) {\n            range = selectionManagerService.getCurrentLastSelection()?.range!;\n        }\n        if (!range) return false;\n\n        const deleteRangeMutationParams: IDeleteRangeMutationParams = {\n            range,\n            subUnitId,\n            unitId,\n            shiftDimension: Dimension.ROWS,\n        };\n\n        const sheetInterceptor = sheetInterceptorService.onCommandExecute({\n            id: DeleteRangeMoveUpCommand.id,\n            params: { range } as IDeleteRangeMoveUpCommandParams,\n        });\n\n        const { redo: removeRangeRedo, undo: removeRangeUndo } = getRemoveRangeMutations(\n            accessor,\n            deleteRangeMutationParams\n        );\n        const redos: IMutationInfo[] = [...(sheetInterceptor.preRedos ?? []), ...removeRangeRedo];\n        const undos: IMutationInfo[] = [...sheetInterceptor.undos, ...removeRangeUndo];\n        redos.push(...sheetInterceptor.redos);\n        redos.push(followSelectionOperation(range, workbook, worksheet));\n        undos.push(...(sheetInterceptor.preUndos ?? []));\n        const result = sequenceExecute(redos, commandService).result;\n\n        if (result) {\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: undos.reverse(),\n                redoMutations: redos,\n            });\n\n            return true;\n        }\n\n        return false;\n    },\n    // all subsequent mutations should succeed inorder to make the whole process succeed\n    // Promise.all([]).then(() => true),\n};\n"],"mappings":"AAmBA;AAAA,EACI;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,OACG;AACP,SAAS,+BAA+B;AACxC,SAAS,+BAA+B;AACxC,SAAS,+BAA+B;AACxC,SAAS,gCAAgC;AACzC,SAAS,6BAA6B;AAM/B,aAAM,6BAA6B;AAInC,aAAM,2BAAqC;AAAA,EAC9C,MAAM,YAAY;AAAA,EAClB,IAAI;AAAA,EAEJ,SAAS,OAAO,UAAqB,WAA4C;AAC7E,UAAM,iBAAiB,SAAS,IAAI,eAAe;AACnD,UAAM,kBAAkB,SAAS,IAAI,gBAAgB;AACrD,UAAM,wBAAwB,SAAS,IAAI,sBAAsB;AACjE,UAAM,0BAA0B,SAAS,IAAI,uBAAuB;AACpE,UAAM,0BAA0B,SAAS,IAAI,uBAAuB;AAEpE,UAAM,SAAS,sBAAsB,qBAAqB;AAC1D,QAAI,CAAC,OAAQ,QAAO;AAEpB,UAAM,EAAE,QAAQ,WAAW,UAAU,UAAU,IAAI;AACnD,QAAI,QAAQ,QAAQ;AACpB,QAAI,CAAC,OAAO;AACR,cAAQ,wBAAwB,wBAAwB,GAAG;AAAA,IAC/D;AACA,QAAI,CAAC,MAAO,QAAO;AAEnB,UAAM,4BAAwD;AAAA,MAC1D;AAAA,MACA;AAAA,MACA;AAAA,MACA,gBAAgB,UAAU;AAAA,IAC9B;AAEA,UAAM,mBAAmB,wBAAwB,iBAAiB;AAAA,MAC9D,IAAI,yBAAyB;AAAA,MAC7B,QAAQ,EAAE,MAAM;AAAA,IACpB,CAAC;AAED,UAAM,EAAE,MAAM,iBAAiB,MAAM,gBAAgB,IAAI;AAAA,MACrD;AAAA,MACA;AAAA,IACJ;AACA,UAAM,QAAyB,CAAC,GAAI,iBAAiB,YAAY,CAAC,GAAI,GAAG,eAAe;AACxF,UAAM,QAAyB,CAAC,GAAG,iBAAiB,OAAO,GAAG,eAAe;AAC7E,UAAM,KAAK,GAAG,iBAAiB,KAAK;AACpC,UAAM,KAAK,yBAAyB,OAAO,UAAU,SAAS,CAAC;AAC/D,UAAM,KAAK,GAAI,iBAAiB,YAAY,CAAC,CAAE;AAC/C,UAAM,SAAS,gBAAgB,OAAO,cAAc,EAAE;AAEtD,QAAI,QAAQ;AACR,sBAAgB,aAAa;AAAA,QACzB,QAAQ;AAAA,QACR,eAAe,MAAM,QAAQ;AAAA,QAC7B,eAAe;AAAA,MACnB,CAAC;AAED,aAAO;AAAA,IACX;AAEA,WAAO;AAAA,EACX;AAAA;AAAA;AAGJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"89b6569d0840d740467a9462986ac7dad39235e0"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/model/range-protection-rule.model.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/model/range-protection-rule.model.ts","statementMap":{"0":{"start":{"line":3,"column":43},"end":{"line":7,"column":23}},"1":{"start":{"line":4,"column":2},"end":{"line":4,"column":52}},"2":{"start":{"line":5,"column":2},"end":{"line":5,"column":58}},"3":{"start":{"line":6,"column":2},"end":{"line":6,"column":24}},"4":{"start":{"line":8,"column":43},"end":{"line":12,"column":23}},"5":{"start":{"line":9,"column":2},"end":{"line":9,"column":64}},"6":{"start":{"line":10,"column":2},"end":{"line":10,"column":38}},"7":{"start":{"line":11,"column":2},"end":{"line":11,"column":24}},"8":{"start":{"line":17,"column":27},"end":{"line":17,"column":36}},"9":{"start":{"line":18,"column":17},"end":{"line":18,"column":30}},"10":{"start":{"line":19,"column":16},"end":{"line":19,"column":48}},"11":{"start":{"line":20,"column":18},"end":{"line":20,"column":31}},"12":{"start":{"line":21,"column":17},"end":{"line":21,"column":50}},"13":{"start":{"line":23,"column":4},"end":{"line":23,"column":33}},"14":{"start":{"line":24,"column":4},"end":{"line":24,"column":34}},"15":{"start":{"line":27,"column":4},"end":{"line":27,"column":32}},"16":{"start":{"line":29,"column":30},"end":{"line":29,"column":56}},"17":{"start":{"line":30,"column":30},"end":{"line":30,"column":75}},"18":{"start":{"line":32,"column":4},"end":{"line":32,"column":48}},"19":{"start":{"line":35,"column":4},"end":{"line":35,"column":47}},"20":{"start":{"line":38,"column":20},"end":{"line":38,"column":58}},"21":{"start":{"line":39,"column":4},"end":{"line":39,"column":31}},"22":{"start":{"line":40,"column":4},"end":{"line":40,"column":69}},"23":{"start":{"line":43,"column":17},"end":{"line":43,"column":65}},"24":{"start":{"line":44,"column":4},"end":{"line":47,"column":5}},"25":{"start":{"line":45,"column":6},"end":{"line":45,"column":58}},"26":{"start":{"line":46,"column":6},"end":{"line":46,"column":74}},"27":{"start":{"line":50,"column":20},"end":{"line":50,"column":55}},"28":{"start":{"line":51,"column":4},"end":{"line":54,"column":5}},"29":{"start":{"line":52,"column":6},"end":{"line":52,"column":61}},"30":{"start":{"line":53,"column":6},"end":{"line":53,"column":80}},"31":{"start":{"line":57,"column":4},"end":{"line":57,"column":60}},"32":{"start":{"line":60,"column":16},"end":{"line":60,"column":84}},"33":{"start":{"line":61,"column":4},"end":{"line":61,"column":29}},"34":{"start":{"line":64,"column":16},"end":{"line":64,"column":55}},"35":{"start":{"line":65,"column":4},"end":{"line":65,"column":30}},"36":{"start":{"line":68,"column":21},"end":{"line":68,"column":44}},"37":{"start":{"line":69,"column":4},"end":{"line":72,"column":5}},"38":{"start":{"line":70,"column":6},"end":{"line":70,"column":45}},"39":{"start":{"line":71,"column":6},"end":{"line":71,"column":42}},"40":{"start":{"line":73,"column":18},"end":{"line":73,"column":43}},"41":{"start":{"line":74,"column":4},"end":{"line":77,"column":5}},"42":{"start":{"line":75,"column":6},"end":{"line":75,"column":42}},"43":{"start":{"line":76,"column":6},"end":{"line":76,"column":41}},"44":{"start":{"line":78,"column":4},"end":{"line":78,"column":19}},"45":{"start":{"line":81,"column":19},"end":{"line":81,"column":21}},"46":{"start":{"line":82,"column":21},"end":{"line":82,"column":44}},"47":{"start":{"line":83,"column":4},"end":{"line":91,"column":7}},"48":{"start":{"line":84,"column":24},"end":{"line":84,"column":47}},"49":{"start":{"line":85,"column":26},"end":{"line":85,"column":47}},"50":{"start":{"line":86,"column":6},"end":{"line":86,"column":26}},"51":{"start":{"line":87,"column":6},"end":{"line":90,"column":9}},"52":{"start":{"line":88,"column":24},"end":{"line":88,"column":48}},"53":{"start":{"line":89,"column":8},"end":{"line":89,"column":58}},"54":{"start":{"line":92,"column":4},"end":{"line":92,"column":18}},"55":{"start":{"line":95,"column":35},"end":{"line":95,"column":44}},"56":{"start":{"line":96,"column":4},"end":{"line":107,"column":7}},"57":{"start":{"line":97,"column":25},"end":{"line":97,"column":36}},"58":{"start":{"line":98,"column":34},"end":{"line":98,"column":43}},"59":{"start":{"line":99,"column":6},"end":{"line":105,"column":9}},"60":{"start":{"line":100,"column":24},"end":{"line":103,"column":37}},"61":{"start":{"line":101,"column":10},"end":{"line":101,"column":35}},"62":{"start":{"line":102,"column":10},"end":{"line":102,"column":25}},"63":{"start":{"line":104,"column":8},"end":{"line":104,"column":36}},"64":{"start":{"line":106,"column":6},"end":{"line":106,"column":30}},"65":{"start":{"line":108,"column":4},"end":{"line":108,"column":25}},"66":{"start":{"line":111,"column":4},"end":{"line":111,"column":31}},"67":{"start":{"line":114,"column":13},"end":{"line":114,"column":38}},"68":{"start":{"line":115,"column":20},"end":{"line":115,"column":58}},"69":{"start":{"line":116,"column":4},"end":{"line":118,"column":5}},"70":{"start":{"line":117,"column":6},"end":{"line":117,"column":37}},"71":{"start":{"line":119,"column":4},"end":{"line":119,"column":14}},"72":{"start":{"line":122,"column":23},"end":{"line":122,"column":46}},"73":{"start":{"line":123,"column":4},"end":{"line":123,"column":33}},"74":{"start":{"line":123,"column":21},"end":{"line":123,"column":33}},"75":{"start":{"line":124,"column":4},"end":{"line":130,"column":5}},"76":{"start":{"line":125,"column":6},"end":{"line":129,"column":7}},"77":{"start":{"line":126,"column":8},"end":{"line":128,"column":9}},"78":{"start":{"line":127,"column":10},"end":{"line":127,"column":37}},"79":{"start":{"line":131,"column":4},"end":{"line":131,"column":16}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":44},"end":{"line":3,"column":45}},"loc":{"start":{"line":3,"column":64},"end":{"line":7,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":8,"column":44},"end":{"line":8,"column":45}},"loc":{"start":{"line":8,"column":64},"end":{"line":12,"column":1}},"line":8},"2":{"name":"(anonymous_2)","decl":{"start":{"line":22,"column":2},"end":{"line":22,"column":3}},"loc":{"start":{"line":22,"column":12},"end":{"line":25,"column":3}},"line":22},"3":{"name":"(anonymous_3)","decl":{"start":{"line":26,"column":2},"end":{"line":26,"column":3}},"loc":{"start":{"line":26,"column":18},"end":{"line":28,"column":3}},"line":26},"4":{"name":"(anonymous_4)","decl":{"start":{"line":31,"column":2},"end":{"line":31,"column":3}},"loc":{"start":{"line":31,"column":26},"end":{"line":33,"column":3}},"line":31},"5":{"name":"(anonymous_5)","decl":{"start":{"line":34,"column":2},"end":{"line":34,"column":3}},"loc":{"start":{"line":34,"column":29},"end":{"line":36,"column":3}},"line":34},"6":{"name":"(anonymous_6)","decl":{"start":{"line":37,"column":2},"end":{"line":37,"column":3}},"loc":{"start":{"line":37,"column":35},"end":{"line":41,"column":3}},"line":37},"7":{"name":"(anonymous_7)","decl":{"start":{"line":42,"column":2},"end":{"line":42,"column":3}},"loc":{"start":{"line":42,"column":36},"end":{"line":48,"column":3}},"line":42},"8":{"name":"(anonymous_8)","decl":{"start":{"line":49,"column":2},"end":{"line":49,"column":3}},"loc":{"start":{"line":49,"column":39},"end":{"line":55,"column":3}},"line":49},"9":{"name":"(anonymous_9)","decl":{"start":{"line":56,"column":2},"end":{"line":56,"column":3}},"loc":{"start":{"line":56,"column":33},"end":{"line":58,"column":3}},"line":56},"10":{"name":"(anonymous_10)","decl":{"start":{"line":59,"column":2},"end":{"line":59,"column":3}},"loc":{"start":{"line":59,"column":40},"end":{"line":62,"column":3}},"line":59},"11":{"name":"(anonymous_11)","decl":{"start":{"line":63,"column":2},"end":{"line":63,"column":3}},"loc":{"start":{"line":63,"column":46},"end":{"line":66,"column":3}},"line":63},"12":{"name":"(anonymous_12)","decl":{"start":{"line":67,"column":2},"end":{"line":67,"column":3}},"loc":{"start":{"line":67,"column":36},"end":{"line":79,"column":3}},"line":67},"13":{"name":"(anonymous_13)","decl":{"start":{"line":80,"column":2},"end":{"line":80,"column":3}},"loc":{"start":{"line":80,"column":13},"end":{"line":93,"column":3}},"line":80},"14":{"name":"(anonymous_14)","decl":{"start":{"line":83,"column":21},"end":{"line":83,"column":22}},"loc":{"start":{"line":83,"column":33},"end":{"line":91,"column":5}},"line":83},"15":{"name":"(anonymous_15)","decl":{"start":{"line":87,"column":26},"end":{"line":87,"column":27}},"loc":{"start":{"line":87,"column":41},"end":{"line":90,"column":7}},"line":87},"16":{"name":"(anonymous_16)","decl":{"start":{"line":94,"column":2},"end":{"line":94,"column":3}},"loc":{"start":{"line":94,"column":18},"end":{"line":109,"column":3}},"line":94},"17":{"name":"(anonymous_17)","decl":{"start":{"line":96,"column":29},"end":{"line":96,"column":30}},"loc":{"start":{"line":96,"column":41},"end":{"line":107,"column":5}},"line":96},"18":{"name":"(anonymous_18)","decl":{"start":{"line":99,"column":38},"end":{"line":99,"column":39}},"loc":{"start":{"line":99,"column":53},"end":{"line":105,"column":7}},"line":99},"19":{"name":"(anonymous_19)","decl":{"start":{"line":100,"column":53},"end":{"line":100,"column":54}},"loc":{"start":{"line":100,"column":71},"end":{"line":103,"column":9}},"line":100},"20":{"name":"(anonymous_20)","decl":{"start":{"line":110,"column":2},"end":{"line":110,"column":3}},"loc":{"start":{"line":110,"column":26},"end":{"line":112,"column":3}},"line":110},"21":{"name":"(anonymous_21)","decl":{"start":{"line":113,"column":2},"end":{"line":113,"column":3}},"loc":{"start":{"line":113,"column":34},"end":{"line":120,"column":3}},"line":113},"22":{"name":"(anonymous_22)","decl":{"start":{"line":121,"column":2},"end":{"line":121,"column":3}},"loc":{"start":{"line":121,"column":48},"end":{"line":132,"column":3}},"line":121}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":3},"end":{"line":7,"column":22}},"type":"binary-expr","locations":[{"start":{"line":7,"column":3},"end":{"line":7,"column":16}},{"start":{"line":7,"column":20},"end":{"line":7,"column":22}}],"line":7},"1":{"loc":{"start":{"line":12,"column":3},"end":{"line":12,"column":22}},"type":"binary-expr","locations":[{"start":{"line":12,"column":3},"end":{"line":12,"column":16}},{"start":{"line":12,"column":20},"end":{"line":12,"column":22}}],"line":12},"2":{"loc":{"start":{"line":44,"column":4},"end":{"line":47,"column":5}},"type":"if","locations":[{"start":{"line":44,"column":4},"end":{"line":47,"column":5}},{"start":{},"end":{}}],"line":44},"3":{"loc":{"start":{"line":51,"column":4},"end":{"line":54,"column":5}},"type":"if","locations":[{"start":{"line":51,"column":4},"end":{"line":54,"column":5}},{"start":{},"end":{}}],"line":51},"4":{"loc":{"start":{"line":60,"column":16},"end":{"line":60,"column":84}},"type":"binary-expr","locations":[{"start":{"line":60,"column":16},"end":{"line":60,"column":55}},{"start":{"line":60,"column":75},"end":{"line":60,"column":84}}],"line":60},"5":{"loc":{"start":{"line":65,"column":11},"end":{"line":65,"column":29}},"type":"cond-expr","locations":[{"start":{"line":65,"column":17},"end":{"line":65,"column":25}},{"start":{"line":65,"column":28},"end":{"line":65,"column":29}}],"line":65},"6":{"loc":{"start":{"line":69,"column":4},"end":{"line":72,"column":5}},"type":"if","locations":[{"start":{"line":69,"column":4},"end":{"line":72,"column":5}},{"start":{},"end":{}}],"line":69},"7":{"loc":{"start":{"line":74,"column":4},"end":{"line":77,"column":5}},"type":"if","locations":[{"start":{"line":74,"column":4},"end":{"line":77,"column":5}},{"start":{},"end":{}}],"line":74},"8":{"loc":{"start":{"line":123,"column":4},"end":{"line":123,"column":33}},"type":"if","locations":[{"start":{"line":123,"column":4},"end":{"line":123,"column":33}},{"start":{},"end":{}}],"line":123},"9":{"loc":{"start":{"line":126,"column":8},"end":{"line":128,"column":9}},"type":"if","locations":[{"start":{"line":126,"column":8},"end":{"line":128,"column":9}},{"start":{},"end":{}}],"line":126}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":4,"9":4,"10":4,"11":4,"12":4,"13":4,"14":4,"15":0,"16":4,"17":4,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0},"f":{"0":1,"1":1,"2":4,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},"b":{"0":[1,1],"1":[1,1],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/model/range-protection-rule.model.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IDisposable, IRange } from '@univerjs/core';\nimport type { UnitObject } from '@univerjs/protocol';\nimport { Tools } from '@univerjs/core';\n\nimport { BehaviorSubject, Subject } from 'rxjs';\n\nexport enum ViewStateEnum {\n    OthersCanView = 'othersCanView',\n    NoOneElseCanView = 'noOneElseCanView',\n}\n\nexport enum EditStateEnum {\n    DesignedUserCanEdit = 'designedUserCanEdit',\n    OnlyMe = 'onlyMe',\n}\n\nexport interface IRangeProtectionRule {\n    ranges: IRange[];\n    permissionId: string;\n    id: string;\n    description?: string;\n    unitType: UnitObject;\n    unitId: string;\n    subUnitId: string;\n    viewState: ViewStateEnum;\n    editState: EditStateEnum;\n}\nexport type IObjectModel = Record<string, Record<string, IRangeProtectionRule[]>>;\n\nexport type IModel = Map<string, Map<string, Map<string, IRangeProtectionRule>>>;\n\nexport interface IRuleChange {\n    unitId: string;\n    subUnitId: string;\n    rule: IRangeProtectionRule;\n    oldRule?: IRangeProtectionRule;\n    type: IRuleChangeType;\n}\n\ntype IRuleChangeType = 'add' | 'set' | 'delete';\n\nexport class RangeProtectionRuleModel implements IDisposable {\n    /**\n     * Map<unitId, Map<subUnitId, Map<ruleId, IRangeProtectionRule>>>\n     */\n    private _model: IModel = new Map();\n\n    private readonly _ruleChange$ = new Subject<IRuleChange>();\n    readonly ruleChange$ = this._ruleChange$.asObservable();\n\n    private _ruleRefresh$ = new Subject<string>();\n    ruleRefresh$ = this._ruleRefresh$.asObservable();\n\n    dispose(): void {\n        this._ruleChange$.complete();\n        this._ruleRefresh$.complete();\n    }\n\n    ruleRefresh(id: string) {\n        this._ruleRefresh$.next(id);\n    }\n\n    private _rangeRuleInitStateChange = new BehaviorSubject<boolean>(false);\n    rangeRuleInitStateChange$ = this._rangeRuleInitStateChange.asObservable();\n\n    getRangeRuleInitState() {\n        return this._rangeRuleInitStateChange.value;\n    }\n\n    changeRuleInitState(state: boolean) {\n        this._rangeRuleInitStateChange.next(state);\n    }\n\n    addRule(unitId: string, subUnitId: string, rule: IRangeProtectionRule) {\n        const ruleMap = this._ensureRuleMap(unitId, subUnitId);\n        ruleMap.set(rule.id, rule);\n        this._ruleChange$.next({ unitId, subUnitId, rule, type: 'add' });\n    }\n\n    deleteRule(unitId: string, subUnitId: string, id: string) {\n        const rule = this._model.get(unitId)?.get(subUnitId)?.get(id);\n        if (rule) {\n            this._model.get(unitId)?.get(subUnitId)?.delete(id);\n            this._ruleChange$.next({ unitId, subUnitId, rule, type: 'delete' });\n        }\n    }\n\n    setRule(unitId: string, subUnitId: string, id: string, rule: IRangeProtectionRule) {\n        const oldRule = this.getRule(unitId, subUnitId, id);\n        if (oldRule) {\n            this._model.get(unitId)?.get(subUnitId)?.set(id, rule);\n            this._ruleChange$.next({ unitId, subUnitId, oldRule, rule, type: 'set' });\n        }\n    }\n\n    getRule(unitId: string, subUnitId: string, id: string) {\n        return this._model.get(unitId)?.get(subUnitId)?.get(id);\n    }\n\n    getSubunitRuleList(unitId: string, subUnitId: string) {\n        const map = this._model.get(unitId)?.get(subUnitId) || new Map();\n        return [...map.values()] as IRangeProtectionRule[];\n    }\n\n    getSubunitRuleListLength(unitId: string, subUnitId: string) {\n        const map = this._model.get(unitId)?.get(subUnitId);\n        return map ? map.size : 0;\n    }\n\n    private _ensureRuleMap(unitId: string, subUnitId: string) {\n        let subUnitMap = this._model.get(unitId);\n        if (!subUnitMap) {\n            subUnitMap = new Map();\n            this._model.set(unitId, subUnitMap);\n        }\n        let ruleMap = subUnitMap.get(subUnitId);\n\n        if (!ruleMap) {\n            ruleMap = new Map<string, IRangeProtectionRule>();\n            subUnitMap.set(subUnitId, ruleMap);\n        }\n        return ruleMap;\n    }\n\n    toObject() {\n        const result: IObjectModel = {};\n        const unitKeys = [...this._model.keys()];\n        unitKeys.forEach((unitId) => {\n            const submitMap = this._model.get(unitId)!;\n            const subUnitKeys = [...submitMap.keys()];\n            result[unitId] = {};\n            subUnitKeys.forEach((subunitId) => {\n                const ruleMap = submitMap.get(subunitId)!;\n                result[unitId][subunitId] = [...ruleMap.values()];\n            });\n        });\n        return result;\n    }\n\n    fromObject(obj: IObjectModel) {\n        const result: IModel = new Map();\n        Object.keys(obj).forEach((unitId) => {\n            const subUnitObj = obj[unitId];\n            const map = new Map<string, Map<string, IRangeProtectionRule>>();\n            Object.keys(subUnitObj).forEach((subunitId) => {\n                const ruleMap = subUnitObj[subunitId].reduce((result, cur) => {\n                    result.set(cur.id, cur);\n                    return result;\n                }, new Map<string, IRangeProtectionRule>());\n                map.set(subunitId, ruleMap);\n            });\n            result.set(unitId, map);\n        });\n        this._model = result;\n    }\n\n    deleteUnitModel(unitId: string) {\n        this._model.delete(unitId);\n    }\n\n    createRuleId(unitId: string, subUnitId: string) {\n        let id = Tools.generateRandomId(4);\n        const ruleMap = this._ensureRuleMap(unitId, subUnitId);\n        while (ruleMap.has(id)) {\n            id = Tools.generateRandomId(4);\n        }\n        return id;\n    }\n\n    getTargetByPermissionId(unitId: string, permissionId: string) {\n        const subUnitMap = this._model.get(unitId);\n        if (!subUnitMap) return null;\n        for (const [subUnitId, ruleMap] of subUnitMap) {\n            for (const rule of ruleMap.values()) {\n                if (rule.permissionId === permissionId) {\n                    return [unitId, subUnitId];\n                }\n            }\n        }\n        return null;\n    }\n}\n"],"mappings":"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","names":["ViewStateEnum","EditStateEnum","result"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"e75ecdfdf8ac7cd531fc82b4ec9407a86dd462f7"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/border-style-manager.service.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/border-style-manager.service.ts","statementMap":{"0":{"start":{"line":4,"column":16},"end":{"line":9,"column":3}},"1":{"start":{"line":10,"column":17},"end":{"line":10,"column":54}},"2":{"start":{"line":11,"column":16},"end":{"line":11,"column":48}},"3":{"start":{"line":13,"column":4},"end":{"line":13,"column":33}},"4":{"start":{"line":16,"column":4},"end":{"line":16,"column":33}},"5":{"start":{"line":17,"column":4},"end":{"line":17,"column":35}},"6":{"start":{"line":18,"column":4},"end":{"line":18,"column":20}},"7":{"start":{"line":21,"column":4},"end":{"line":21,"column":35}},"8":{"start":{"line":22,"column":4},"end":{"line":22,"column":20}},"9":{"start":{"line":25,"column":4},"end":{"line":25,"column":35}},"10":{"start":{"line":26,"column":4},"end":{"line":26,"column":20}},"11":{"start":{"line":29,"column":4},"end":{"line":29,"column":47}},"12":{"start":{"line":32,"column":4},"end":{"line":32,"column":28}},"13":{"start":{"line":35,"column":4},"end":{"line":35,"column":45}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":2},"end":{"line":12,"column":3}},"loc":{"start":{"line":12,"column":12},"end":{"line":14,"column":3}},"line":12},"1":{"name":"(anonymous_1)","decl":{"start":{"line":15,"column":2},"end":{"line":15,"column":3}},"loc":{"start":{"line":15,"column":16},"end":{"line":19,"column":3}},"line":15},"2":{"name":"(anonymous_2)","decl":{"start":{"line":20,"column":2},"end":{"line":20,"column":3}},"loc":{"start":{"line":20,"column":18},"end":{"line":23,"column":3}},"line":20},"3":{"name":"(anonymous_3)","decl":{"start":{"line":24,"column":2},"end":{"line":24,"column":3}},"loc":{"start":{"line":24,"column":18},"end":{"line":27,"column":3}},"line":24},"4":{"name":"(anonymous_4)","decl":{"start":{"line":28,"column":2},"end":{"line":28,"column":3}},"loc":{"start":{"line":28,"column":30},"end":{"line":30,"column":3}},"line":28},"5":{"name":"(anonymous_5)","decl":{"start":{"line":31,"column":2},"end":{"line":31,"column":3}},"loc":{"start":{"line":31,"column":18},"end":{"line":33,"column":3}},"line":31},"6":{"name":"(anonymous_6)","decl":{"start":{"line":34,"column":2},"end":{"line":34,"column":3}},"loc":{"start":{"line":34,"column":13},"end":{"line":36,"column":3}},"line":34}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/border-style-manager.service.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IDisposable } from '@univerjs/core';\nimport { BorderStyleTypes, BorderType } from '@univerjs/core';\nimport { BehaviorSubject } from 'rxjs';\n\nexport interface IBorderInfo {\n    type: BorderType;\n    color: string | undefined;\n    style: BorderStyleTypes;\n    activeBorderType: boolean; // When you click on the border type, then click on the color and style, it should take effect immediately.\n}\n\n/**\n * This service is for managing settings border style status.\n */\nexport class BorderStyleManagerService implements IDisposable {\n    private readonly _borderInfo: IBorderInfo = {\n        type: BorderType.ALL,\n        color: '#000000',\n        style: BorderStyleTypes.THIN,\n        activeBorderType: false,\n    };\n\n    private readonly _borderInfo$ = new BehaviorSubject<IBorderInfo>(this._borderInfo);\n    readonly borderInfo$ = this._borderInfo$.asObservable();\n\n    dispose(): void {\n        this._borderInfo$.complete();\n    }\n\n    setType(type: BorderType): void {\n        this._borderInfo.type = type;\n        this.setActiveBorderType(true);\n        this._refresh();\n    }\n\n    setColor(color: string): void {\n        this._borderInfo.color = color;\n        this._refresh();\n    }\n\n    setStyle(style: BorderStyleTypes): void {\n        this._borderInfo.style = style;\n        this._refresh();\n    }\n\n    setActiveBorderType(status: boolean) {\n        this._borderInfo.activeBorderType = status;\n    }\n\n    getBorderInfo(): Readonly<IBorderInfo> {\n        return this._borderInfo;\n    }\n\n    private _refresh(): void {\n        this._borderInfo$.next(this._borderInfo);\n    }\n}\n"],"mappings":"AAiBA,SAAS,kBAAkB,kBAAkB;AAC7C,SAAS,uBAAuB;AAYzB,aAAM,0BAAiD;AAAA,EACzC,cAA2B;AAAA,IACxC,MAAM,WAAW;AAAA,IACjB,OAAO;AAAA,IACP,OAAO,iBAAiB;AAAA,IACxB,kBAAkB;AAAA,EACtB;AAAA,EAEiB,eAAe,IAAI,gBAA6B,KAAK,WAAW;AAAA,EACxE,cAAc,KAAK,aAAa,aAAa;AAAA,EAEtD,UAAgB;AACZ,SAAK,aAAa,SAAS;AAAA,EAC/B;AAAA,EAEA,QAAQ,MAAwB;AAC5B,SAAK,YAAY,OAAO;AACxB,SAAK,oBAAoB,IAAI;AAC7B,SAAK,SAAS;AAAA,EAClB;AAAA,EAEA,SAAS,OAAqB;AAC1B,SAAK,YAAY,QAAQ;AACzB,SAAK,SAAS;AAAA,EAClB;AAAA,EAEA,SAAS,OAA+B;AACpC,SAAK,YAAY,QAAQ;AACzB,SAAK,SAAS;AAAA,EAClB;AAAA,EAEA,oBAAoB,QAAiB;AACjC,SAAK,YAAY,mBAAmB;AAAA,EACxC;AAAA,EAEA,gBAAuC;AACnC,WAAO,KAAK;AAAA,EAChB;AAAA,EAEQ,WAAiB;AACrB,SAAK,aAAa,KAAK,KAAK,WAAW;AAAA,EAC3C;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"fc07f189dda3059ee2d0113eff570284c64274c3"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/delete-protection.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/delete-protection.ts","statementMap":{"0":{"start":{"line":4,"column":9},"end":{"line":4,"column":31}},"1":{"start":{"line":5,"column":12},"end":{"line":5,"column":29}},"2":{"start":{"line":6,"column":11},"end":{"line":6,"column":32}},"3":{"start":{"line":7,"column":10},"end":{"line":7,"column":14}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":25}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":31}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":37}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":79}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":2},"end":{"line":12,"column":3}},"loc":{"start":{"line":12,"column":47},"end":{"line":17,"column":3}},"line":12}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/delete-protection.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class RangeProtectionPermissionDeleteProtectionPoint implements IPermissionPoint {\n    type = UnitObject.SelectRange;\n    subType = UnitAction.Delete;\n    status = PermissionStatus.INIT;\n    value = true;\n    id: string;\n    unitId: string;\n    subUnitId: string;\n    permissionId: string;\n    constructor(unitId: string, subUnitId: string, permissionId: string) {\n        this.unitId = unitId;\n        this.subUnitId = subUnitId;\n        this.permissionId = permissionId;\n        this.id = `${UnitObject.SelectRange}.${UnitAction.Delete}.${permissionId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,+CAA2E;AAAA,EACpF,OAAO,WAAW;AAAA,EAClB,UAAU,WAAW;AAAA,EACrB,SAAS,iBAAiB;AAAA,EAC1B,QAAQ;AAAA,EACR;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,YAAY,QAAgB,WAAmB,cAAsB;AACjE,SAAK,SAAS;AACd,SAAK,YAAY;AACjB,SAAK,eAAe;AACpB,SAAK,KAAK,GAAG,WAAW,WAAW,IAAI,WAAW,MAAM,IAAI,YAAY;AAAA,EAC5E;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"92913ae64053429b40685e29dc015fde3b465ad7"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/manage-collaborator.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/manage-collaborator.ts","statementMap":{"0":{"start":{"line":4,"column":9},"end":{"line":4,"column":31}},"1":{"start":{"line":5,"column":12},"end":{"line":5,"column":41}},"2":{"start":{"line":6,"column":11},"end":{"line":6,"column":32}},"3":{"start":{"line":7,"column":10},"end":{"line":7,"column":14}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":25}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":31}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":37}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":91}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":2},"end":{"line":12,"column":3}},"loc":{"start":{"line":12,"column":47},"end":{"line":17,"column":3}},"line":12}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/permission-point/range/manage-collaborator.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPoint } from '@univerjs/core';\nimport { PermissionStatus } from '@univerjs/core';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\n\nexport class RangeProtectionPermissionManageCollaPoint implements IPermissionPoint {\n    type = UnitObject.SelectRange;\n    subType = UnitAction.ManageCollaborator;\n    status = PermissionStatus.INIT;\n    value = true;\n    id: string;\n    unitId: string;\n    subUnitId: string;\n    permissionId: string;\n    constructor(unitId: string, subUnitId: string, permissionId: string) {\n        this.unitId = unitId;\n        this.subUnitId = subUnitId;\n        this.permissionId = permissionId;\n        this.id = `${UnitObject.SelectRange}.${UnitAction.ManageCollaborator}.${permissionId}`;\n    }\n}\n"],"mappings":"AAiBA,SAAS,wBAAwB;AACjC,SAAS,YAAY,kBAAkB;AAEhC,aAAM,0CAAsE;AAAA,EAC/E,OAAO,WAAW;AAAA,EAClB,UAAU,WAAW;AAAA,EACrB,SAAS,iBAAiB;AAAA,EAC1B,QAAQ;AAAA,EACR;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,YAAY,QAAgB,WAAmB,cAAsB;AACjE,SAAK,SAAS;AACd,SAAK,YAAY;AACjB,SAAK,eAAe;AACpB,SAAK,KAAK,GAAG,WAAW,WAAW,IAAI,WAAW,kBAAkB,IAAI,YAAY;AAAA,EACxF;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c2583668b2500d16234334d15593f5dac2b8ddf1"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/range-permission/util.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/range-permission/util.ts","statementMap":{"0":{"start":{"line":6,"column":42},"end":{"line":6,"column":211}},"1":{"start":{"line":6,"column":48},"end":{"line":6,"column":211}},"2":{"start":{"line":7,"column":37},"end":{"line":7,"column":121}},"3":{"start":{"line":8,"column":41},"end":{"line":12,"column":6}},"4":{"start":{"line":8,"column":120},"end":{"line":12,"column":6}},"5":{"start":{"line":9,"column":12},"end":{"line":9,"column":50}},"6":{"start":{"line":10,"column":2},"end":{"line":10,"column":25}},"7":{"start":{"line":11,"column":2},"end":{"line":11,"column":11}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":42},"end":{"line":6,"column":43}},"loc":{"start":{"line":6,"column":48},"end":{"line":6,"column":211}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":8,"column":41},"end":{"line":8,"column":42}},"loc":{"start":{"line":8,"column":120},"end":{"line":12,"column":6}},"line":8},"2":{"name":"(anonymous_2)","decl":{"start":{"line":8,"column":156},"end":{"line":8,"column":157}},"loc":{"start":{"line":8,"column":166},"end":{"line":12,"column":1}},"line":8}},"branchMap":{"0":{"loc":{"start":{"line":8,"column":42},"end":{"line":8,"column":59}},"type":"default-arg","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":59}}],"line":8},"1":{"loc":{"start":{"line":8,"column":61},"end":{"line":8,"column":84}},"type":"default-arg","locations":[{"start":{"line":8,"column":73},"end":{"line":8,"column":84}}],"line":8},"2":{"loc":{"start":{"line":8,"column":86},"end":{"line":8,"column":115}},"type":"default-arg","locations":[{"start":{"line":8,"column":101},"end":{"line":8,"column":115}}],"line":8}},"s":{"0":1,"1":0,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0},"f":{"0":0,"1":0,"2":0},"b":{"0":[0],"1":[0],"2":[0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/range-permission/util.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UnitAction } from '@univerjs/protocol';\nimport { RangeProtectionPermissionDeleteProtectionPoint } from '../permission-point/range/delete-protection';\nimport { RangeProtectionPermissionEditPoint } from '../permission-point/range/edit';\nimport { RangeProtectionPermissionManageCollaPoint } from '../permission-point/range/manage-collaborator';\nimport { RangeProtectionPermissionViewPoint } from '../permission-point/range/view';\n\nexport type IRangePermissionPoint = RangeProtectionPermissionEditPoint | RangeProtectionPermissionViewPoint;\n\nexport const getAllRangePermissionPoint = () => [RangeProtectionPermissionViewPoint, RangeProtectionPermissionEditPoint, RangeProtectionPermissionManageCollaPoint, RangeProtectionPermissionDeleteProtectionPoint];\n\nexport const baseProtectionActions = [UnitAction.Edit, UnitAction.View, UnitAction.ManageCollaborator, UnitAction.Delete];\n\nexport const getDefaultRangePermission = (unitId = 'unitId', subUnitId = 'subUnitId', permissionId = 'permissionId') => getAllRangePermissionPoint().reduce((r, F) => {\n    const i = new F(unitId, subUnitId, permissionId);\n    r[i.subType] = i.value;\n    return r;\n}, {} as Record<UnitAction, boolean>);\n"],"mappings":"AAgBA,SAAS,kBAAkB;AAC3B,SAAS,sDAAsD;AAC/D,SAAS,0CAA0C;AACnD,SAAS,iDAAiD;AAC1D,SAAS,0CAA0C;AAI5C,aAAM,6BAA6B,MAAM,CAAC,oCAAoC,oCAAoC,2CAA2C,8CAA8C;AAE3M,aAAM,wBAAwB,CAAC,WAAW,MAAM,WAAW,MAAM,WAAW,oBAAoB,WAAW,MAAM;AAEjH,aAAM,4BAA4B,CAAC,SAAS,UAAU,YAAY,aAAa,eAAe,mBAAmB,2BAA2B,EAAE,OAAO,CAAC,GAAG,MAAM;AAClK,QAAM,IAAI,IAAI,EAAE,QAAQ,WAAW,YAAY;AAC/C,IAAE,EAAE,OAAO,IAAI,EAAE;AACjB,SAAO;AACX,GAAG,CAAC,CAAgC;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"98561f63789a6bf27b06de273ba52f1ac31c7851"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/index.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/index.ts","statementMap":{},"fnMap":{},"branchMap":{},"s":{},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/index.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport { WorksheetProtectionPointModel } from './worksheet-permission-point.model';\nexport { WorksheetProtectionRuleModel } from './worksheet-permission-rule.model';\nexport { WorksheetPermissionService } from './worksheet-permission.service';\n"],"mappings":"AAgBA,SAAS,qCAAqC;AAC9C,SAAS,oCAAoC;AAC7C,SAAS,kCAAkC;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"02c010c187659fba59fdd95827cc2dc9634fa0fe"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission-point.model.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission-point.model.ts","statementMap":{"0":{"start":{"line":3,"column":27},"end":{"line":3,"column":36}},"1":{"start":{"line":4,"column":17},"end":{"line":4,"column":30}},"2":{"start":{"line":5,"column":17},"end":{"line":5,"column":49}},"3":{"start":{"line":7,"column":23},"end":{"line":7,"column":58}},"4":{"start":{"line":8,"column":4},"end":{"line":8,"column":41}},"5":{"start":{"line":9,"column":4},"end":{"line":9,"column":33}},"6":{"start":{"line":12,"column":17},"end":{"line":12,"column":56}},"7":{"start":{"line":13,"column":4},"end":{"line":16,"column":5}},"8":{"start":{"line":14,"column":6},"end":{"line":14,"column":50}},"9":{"start":{"line":15,"column":6},"end":{"line":15,"column":35}},"10":{"start":{"line":19,"column":4},"end":{"line":19,"column":52}},"11":{"start":{"line":22,"column":19},"end":{"line":22,"column":21}},"12":{"start":{"line":23,"column":21},"end":{"line":23,"column":44}},"13":{"start":{"line":24,"column":4},"end":{"line":36,"column":7}},"14":{"start":{"line":25,"column":25},"end":{"line":25,"column":48}},"15":{"start":{"line":26,"column":6},"end":{"line":35,"column":7}},"16":{"start":{"line":27,"column":8},"end":{"line":27,"column":28}},"17":{"start":{"line":28,"column":28},"end":{"line":28,"column":50}},"18":{"start":{"line":29,"column":8},"end":{"line":34,"column":11}},"19":{"start":{"line":30,"column":23},"end":{"line":30,"column":48}},"20":{"start":{"line":31,"column":10},"end":{"line":33,"column":11}},"21":{"start":{"line":32,"column":12},"end":{"line":32,"column":38}},"22":{"start":{"line":37,"column":4},"end":{"line":37,"column":18}},"23":{"start":{"line":40,"column":35},"end":{"line":40,"column":44}},"24":{"start":{"line":41,"column":4},"end":{"line":50,"column":7}},"25":{"start":{"line":42,"column":26},"end":{"line":42,"column":37}},"26":{"start":{"line":43,"column":6},"end":{"line":49,"column":7}},"27":{"start":{"line":44,"column":43},"end":{"line":44,"column":52}},"28":{"start":{"line":45,"column":8},"end":{"line":47,"column":11}},"29":{"start":{"line":46,"column":10},"end":{"line":46,"column":47}},"30":{"start":{"line":48,"column":8},"end":{"line":48,"column":39}},"31":{"start":{"line":51,"column":4},"end":{"line":51,"column":25}},"32":{"start":{"line":54,"column":4},"end":{"line":54,"column":31}},"33":{"start":{"line":57,"column":21},"end":{"line":57,"column":44}},"34":{"start":{"line":58,"column":4},"end":{"line":61,"column":5}},"35":{"start":{"line":59,"column":6},"end":{"line":59,"column":45}},"36":{"start":{"line":60,"column":6},"end":{"line":60,"column":42}},"37":{"start":{"line":62,"column":4},"end":{"line":62,"column":22}},"38":{"start":{"line":65,"column":23},"end":{"line":65,"column":46}},"39":{"start":{"line":66,"column":4},"end":{"line":66,"column":33}},"40":{"start":{"line":66,"column":21},"end":{"line":66,"column":33}},"41":{"start":{"line":67,"column":4},"end":{"line":71,"column":5}},"42":{"start":{"line":68,"column":6},"end":{"line":70,"column":7}},"43":{"start":{"line":69,"column":8},"end":{"line":69,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":2},"end":{"line":6,"column":3}},"loc":{"start":{"line":6,"column":16},"end":{"line":10,"column":3}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":2},"end":{"line":11,"column":3}},"loc":{"start":{"line":11,"column":32},"end":{"line":17,"column":3}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":18,"column":2},"end":{"line":18,"column":3}},"loc":{"start":{"line":18,"column":29},"end":{"line":20,"column":3}},"line":18},"3":{"name":"(anonymous_3)","decl":{"start":{"line":21,"column":2},"end":{"line":21,"column":3}},"loc":{"start":{"line":21,"column":13},"end":{"line":38,"column":3}},"line":21},"4":{"name":"(anonymous_4)","decl":{"start":{"line":24,"column":21},"end":{"line":24,"column":22}},"loc":{"start":{"line":24,"column":33},"end":{"line":36,"column":5}},"line":24},"5":{"name":"(anonymous_5)","decl":{"start":{"line":29,"column":28},"end":{"line":29,"column":29}},"loc":{"start":{"line":29,"column":43},"end":{"line":34,"column":9}},"line":29},"6":{"name":"(anonymous_6)","decl":{"start":{"line":39,"column":2},"end":{"line":39,"column":3}},"loc":{"start":{"line":39,"column":18},"end":{"line":52,"column":3}},"line":39},"7":{"name":"(anonymous_7)","decl":{"start":{"line":41,"column":29},"end":{"line":41,"column":30}},"loc":{"start":{"line":41,"column":41},"end":{"line":50,"column":5}},"line":41},"8":{"name":"(anonymous_8)","decl":{"start":{"line":45,"column":28},"end":{"line":45,"column":29}},"loc":{"start":{"line":45,"column":38},"end":{"line":47,"column":9}},"line":45},"9":{"name":"(anonymous_9)","decl":{"start":{"line":53,"column":2},"end":{"line":53,"column":3}},"loc":{"start":{"line":53,"column":26},"end":{"line":55,"column":3}},"line":53},"10":{"name":"(anonymous_10)","decl":{"start":{"line":56,"column":2},"end":{"line":56,"column":3}},"loc":{"start":{"line":56,"column":28},"end":{"line":63,"column":3}},"line":56},"11":{"name":"(anonymous_11)","decl":{"start":{"line":64,"column":2},"end":{"line":64,"column":3}},"loc":{"start":{"line":64,"column":48},"end":{"line":72,"column":3}},"line":64}},"branchMap":{"0":{"loc":{"start":{"line":13,"column":4},"end":{"line":16,"column":5}},"type":"if","locations":[{"start":{"line":13,"column":4},"end":{"line":16,"column":5}},{"start":{},"end":{}}],"line":13},"1":{"loc":{"start":{"line":26,"column":6},"end":{"line":35,"column":7}},"type":"if","locations":[{"start":{"line":26,"column":6},"end":{"line":35,"column":7}},{"start":{},"end":{}}],"line":26},"2":{"loc":{"start":{"line":31,"column":10},"end":{"line":33,"column":11}},"type":"if","locations":[{"start":{"line":31,"column":10},"end":{"line":33,"column":11}},{"start":{},"end":{}}],"line":31},"3":{"loc":{"start":{"line":43,"column":6},"end":{"line":49,"column":7}},"type":"if","locations":[{"start":{"line":43,"column":6},"end":{"line":49,"column":7}},{"start":{},"end":{}}],"line":43},"4":{"loc":{"start":{"line":58,"column":4},"end":{"line":61,"column":5}},"type":"if","locations":[{"start":{"line":58,"column":4},"end":{"line":61,"column":5}},{"start":{},"end":{}}],"line":58},"5":{"loc":{"start":{"line":66,"column":4},"end":{"line":66,"column":33}},"type":"if","locations":[{"start":{"line":66,"column":4},"end":{"line":66,"column":33}},{"start":{},"end":{}}],"line":66},"6":{"loc":{"start":{"line":68,"column":6},"end":{"line":70,"column":7}},"type":"if","locations":[{"start":{"line":68,"column":6},"end":{"line":70,"column":7}},{"start":{},"end":{}}],"line":68}},"s":{"0":4,"1":4,"2":4,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission-point.model.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IObjectPointModel, IPointRuleModel, IWorksheetProtectionPointRule } from '../type';\nimport { Subject } from 'rxjs';\n\nexport class WorksheetProtectionPointModel {\n    private _model: IPointRuleModel = new Map();\n\n    private _pointChange = new Subject<{\n        unitId: string;\n        subUnitId: string;\n        permissionId: string;\n    }>();\n\n    pointChange$ = this._pointChange.asObservable();\n\n    addRule(rule: IWorksheetProtectionPointRule) {\n        const subUnitMap = this._ensureSubUnitMap(rule.unitId);\n        subUnitMap.set(rule.subUnitId, rule);\n        this._pointChange.next(rule);\n    }\n\n    deleteRule(unitId: string, subUnitId: string) {\n        const rule = this._model.get(unitId)?.get(subUnitId);\n        if (rule) {\n            this._model?.get(unitId)?.delete(subUnitId);\n            this._pointChange.next(rule);\n        }\n    }\n\n    getRule(unitId: string, subUnitId: string) {\n        return this._model?.get(unitId)?.get(subUnitId);\n    }\n\n    toObject() {\n        const result: IObjectPointModel = {};\n        const unitKeys = [...this._model.keys()];\n        unitKeys.forEach((unitId) => {\n            const subUnitMap = this._model.get(unitId);\n            if (subUnitMap?.size) {\n                result[unitId] = [];\n                const subUnitKeys = [...subUnitMap.keys()];\n                subUnitKeys.forEach((subUnitId) => {\n                    const rule = subUnitMap.get(subUnitId);\n                    if (rule) {\n                        result[unitId].push(rule);\n                    }\n                });\n            }\n        });\n        return result;\n    }\n\n    fromObject(obj: IObjectPointModel) {\n        const result: IPointRuleModel = new Map();\n        Object.keys(obj).forEach((unitId) => {\n            const subUnitList = obj[unitId];\n            if (subUnitList?.length) {\n                const subUnitMap = new Map();\n                subUnitList.forEach((rule) => {\n                    subUnitMap.set(rule.subUnitId, rule);\n                });\n                result.set(unitId, subUnitMap);\n            }\n        });\n        this._model = result;\n    }\n\n    deleteUnitModel(unitId: string) {\n        this._model.delete(unitId);\n    }\n\n    private _ensureSubUnitMap(unitId: string) {\n        let subUnitMap = this._model.get(unitId);\n        if (!subUnitMap) {\n            subUnitMap = new Map();\n            this._model.set(unitId, subUnitMap);\n        }\n        return subUnitMap;\n    }\n\n    getTargetByPermissionId(unitId: string, permissionId: string) {\n        const subUnitMap = this._model.get(unitId);\n        if (!subUnitMap) return null;\n        for (const [subUnitId, rule] of subUnitMap) {\n            if (rule.permissionId === permissionId) {\n                return [unitId, subUnitId];\n            }\n        }\n    }\n}\n"],"mappings":"AAiBA,SAAS,eAAe;AAEjB,aAAM,8BAA8B;AAAA,EAC/B,SAA0B,oBAAI,IAAI;AAAA,EAElC,eAAe,IAAI,QAIxB;AAAA,EAEH,eAAe,KAAK,aAAa,aAAa;AAAA,EAE9C,QAAQ,MAAqC;AACzC,UAAM,aAAa,KAAK,kBAAkB,KAAK,MAAM;AACrD,eAAW,IAAI,KAAK,WAAW,IAAI;AACnC,SAAK,aAAa,KAAK,IAAI;AAAA,EAC/B;AAAA,EAEA,WAAW,QAAgB,WAAmB;AAC1C,UAAM,OAAO,KAAK,OAAO,IAAI,MAAM,GAAG,IAAI,SAAS;AACnD,QAAI,MAAM;AACN,WAAK,QAAQ,IAAI,MAAM,GAAG,OAAO,SAAS;AAC1C,WAAK,aAAa,KAAK,IAAI;AAAA,IAC/B;AAAA,EACJ;AAAA,EAEA,QAAQ,QAAgB,WAAmB;AACvC,WAAO,KAAK,QAAQ,IAAI,MAAM,GAAG,IAAI,SAAS;AAAA,EAClD;AAAA,EAEA,WAAW;AACP,UAAM,SAA4B,CAAC;AACnC,UAAM,WAAW,CAAC,GAAG,KAAK,OAAO,KAAK,CAAC;AACvC,aAAS,QAAQ,CAAC,WAAW;AACzB,YAAM,aAAa,KAAK,OAAO,IAAI,MAAM;AACzC,UAAI,YAAY,MAAM;AAClB,eAAO,MAAM,IAAI,CAAC;AAClB,cAAM,cAAc,CAAC,GAAG,WAAW,KAAK,CAAC;AACzC,oBAAY,QAAQ,CAAC,cAAc;AAC/B,gBAAM,OAAO,WAAW,IAAI,SAAS;AACrC,cAAI,MAAM;AACN,mBAAO,MAAM,EAAE,KAAK,IAAI;AAAA,UAC5B;AAAA,QACJ,CAAC;AAAA,MACL;AAAA,IACJ,CAAC;AACD,WAAO;AAAA,EACX;AAAA,EAEA,WAAW,KAAwB;AAC/B,UAAM,SAA0B,oBAAI,IAAI;AACxC,WAAO,KAAK,GAAG,EAAE,QAAQ,CAAC,WAAW;AACjC,YAAM,cAAc,IAAI,MAAM;AAC9B,UAAI,aAAa,QAAQ;AACrB,cAAM,aAAa,oBAAI,IAAI;AAC3B,oBAAY,QAAQ,CAAC,SAAS;AAC1B,qBAAW,IAAI,KAAK,WAAW,IAAI;AAAA,QACvC,CAAC;AACD,eAAO,IAAI,QAAQ,UAAU;AAAA,MACjC;AAAA,IACJ,CAAC;AACD,SAAK,SAAS;AAAA,EAClB;AAAA,EAEA,gBAAgB,QAAgB;AAC5B,SAAK,OAAO,OAAO,MAAM;AAAA,EAC7B;AAAA,EAEQ,kBAAkB,QAAgB;AACtC,QAAI,aAAa,KAAK,OAAO,IAAI,MAAM;AACvC,QAAI,CAAC,YAAY;AACb,mBAAa,oBAAI,IAAI;AACrB,WAAK,OAAO,IAAI,QAAQ,UAAU;AAAA,IACtC;AACA,WAAO;AAAA,EACX;AAAA,EAEA,wBAAwB,QAAgB,cAAsB;AAC1D,UAAM,aAAa,KAAK,OAAO,IAAI,MAAM;AACzC,QAAI,CAAC,WAAY,QAAO;AACxB,eAAW,CAAC,WAAW,IAAI,KAAK,YAAY;AACxC,UAAI,KAAK,iBAAiB,cAAc;AACpC,eAAO,CAAC,QAAQ,SAAS;AAAA,MAC7B;AAAA,IACJ;AAAA,EACJ;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"aeb856c4661ce4bcf89f86653d4866d12e72331c"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission-rule.model.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission-rule.model.ts","statementMap":{"0":{"start":{"line":7,"column":27},"end":{"line":7,"column":36}},"1":{"start":{"line":8,"column":16},"end":{"line":8,"column":29}},"2":{"start":{"line":9,"column":17},"end":{"line":9,"column":30}},"3":{"start":{"line":10,"column":16},"end":{"line":10,"column":29}},"4":{"start":{"line":11,"column":16},"end":{"line":11,"column":47}},"5":{"start":{"line":12,"column":17},"end":{"line":12,"column":49}},"6":{"start":{"line":13,"column":16},"end":{"line":13,"column":47}},"7":{"start":{"line":14,"column":34},"end":{"line":14,"column":60}},"8":{"start":{"line":15,"column":34},"end":{"line":15,"column":83}},"9":{"start":{"line":17,"column":4},"end":{"line":17,"column":51}},"10":{"start":{"line":20,"column":4},"end":{"line":20,"column":52}},"11":{"start":{"line":23,"column":23},"end":{"line":23,"column":53}},"12":{"start":{"line":24,"column":4},"end":{"line":24,"column":41}},"13":{"start":{"line":25,"column":4},"end":{"line":25,"column":84}},"14":{"start":{"line":28,"column":17},"end":{"line":28,"column":57}},"15":{"start":{"line":29,"column":4},"end":{"line":32,"column":5}},"16":{"start":{"line":30,"column":6},"end":{"line":30,"column":49}},"17":{"start":{"line":31,"column":6},"end":{"line":31,"column":73}},"18":{"start":{"line":35,"column":20},"end":{"line":35,"column":51}},"19":{"start":{"line":36,"column":4},"end":{"line":39,"column":5}},"20":{"start":{"line":37,"column":6},"end":{"line":37,"column":53}},"21":{"start":{"line":38,"column":6},"end":{"line":38,"column":79}},"22":{"start":{"line":42,"column":4},"end":{"line":42,"column":52}},"23":{"start":{"line":45,"column":19},"end":{"line":45,"column":21}},"24":{"start":{"line":46,"column":21},"end":{"line":46,"column":44}},"25":{"start":{"line":47,"column":4},"end":{"line":59,"column":7}},"26":{"start":{"line":48,"column":25},"end":{"line":48,"column":48}},"27":{"start":{"line":49,"column":6},"end":{"line":58,"column":7}},"28":{"start":{"line":50,"column":8},"end":{"line":50,"column":28}},"29":{"start":{"line":51,"column":28},"end":{"line":51,"column":50}},"30":{"start":{"line":52,"column":8},"end":{"line":57,"column":11}},"31":{"start":{"line":53,"column":23},"end":{"line":53,"column":48}},"32":{"start":{"line":54,"column":10},"end":{"line":56,"column":11}},"33":{"start":{"line":55,"column":12},"end":{"line":55,"column":38}},"34":{"start":{"line":60,"column":4},"end":{"line":60,"column":18}},"35":{"start":{"line":63,"column":35},"end":{"line":63,"column":44}},"36":{"start":{"line":64,"column":4},"end":{"line":73,"column":7}},"37":{"start":{"line":65,"column":26},"end":{"line":65,"column":37}},"38":{"start":{"line":66,"column":6},"end":{"line":72,"column":7}},"39":{"start":{"line":67,"column":43},"end":{"line":67,"column":52}},"40":{"start":{"line":68,"column":8},"end":{"line":70,"column":11}},"41":{"start":{"line":69,"column":10},"end":{"line":69,"column":47}},"42":{"start":{"line":71,"column":8},"end":{"line":71,"column":39}},"43":{"start":{"line":74,"column":4},"end":{"line":74,"column":25}},"44":{"start":{"line":77,"column":4},"end":{"line":77,"column":31}},"45":{"start":{"line":80,"column":21},"end":{"line":80,"column":44}},"46":{"start":{"line":81,"column":4},"end":{"line":84,"column":5}},"47":{"start":{"line":82,"column":6},"end":{"line":82,"column":45}},"48":{"start":{"line":83,"column":6},"end":{"line":83,"column":42}},"49":{"start":{"line":85,"column":4},"end":{"line":85,"column":22}},"50":{"start":{"line":88,"column":4},"end":{"line":88,"column":41}},"51":{"start":{"line":91,"column":4},"end":{"line":91,"column":41}},"52":{"start":{"line":94,"column":23},"end":{"line":94,"column":46}},"53":{"start":{"line":95,"column":4},"end":{"line":95,"column":33}},"54":{"start":{"line":95,"column":21},"end":{"line":95,"column":33}},"55":{"start":{"line":96,"column":4},"end":{"line":100,"column":5}},"56":{"start":{"line":97,"column":6},"end":{"line":99,"column":7}},"57":{"start":{"line":98,"column":8},"end":{"line":98,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":16,"column":2},"end":{"line":16,"column":3}},"loc":{"start":{"line":16,"column":29},"end":{"line":18,"column":3}},"line":16},"1":{"name":"(anonymous_1)","decl":{"start":{"line":19,"column":2},"end":{"line":19,"column":3}},"loc":{"start":{"line":19,"column":26},"end":{"line":21,"column":3}},"line":19},"2":{"name":"(anonymous_2)","decl":{"start":{"line":22,"column":2},"end":{"line":22,"column":3}},"loc":{"start":{"line":22,"column":24},"end":{"line":26,"column":3}},"line":22},"3":{"name":"(anonymous_3)","decl":{"start":{"line":27,"column":2},"end":{"line":27,"column":3}},"loc":{"start":{"line":27,"column":32},"end":{"line":33,"column":3}},"line":27},"4":{"name":"(anonymous_4)","decl":{"start":{"line":34,"column":2},"end":{"line":34,"column":3}},"loc":{"start":{"line":34,"column":35},"end":{"line":40,"column":3}},"line":34},"5":{"name":"(anonymous_5)","decl":{"start":{"line":41,"column":2},"end":{"line":41,"column":3}},"loc":{"start":{"line":41,"column":29},"end":{"line":43,"column":3}},"line":41},"6":{"name":"(anonymous_6)","decl":{"start":{"line":44,"column":2},"end":{"line":44,"column":3}},"loc":{"start":{"line":44,"column":13},"end":{"line":61,"column":3}},"line":44},"7":{"name":"(anonymous_7)","decl":{"start":{"line":47,"column":21},"end":{"line":47,"column":22}},"loc":{"start":{"line":47,"column":33},"end":{"line":59,"column":5}},"line":47},"8":{"name":"(anonymous_8)","decl":{"start":{"line":52,"column":28},"end":{"line":52,"column":29}},"loc":{"start":{"line":52,"column":43},"end":{"line":57,"column":9}},"line":52},"9":{"name":"(anonymous_9)","decl":{"start":{"line":62,"column":2},"end":{"line":62,"column":3}},"loc":{"start":{"line":62,"column":18},"end":{"line":75,"column":3}},"line":62},"10":{"name":"(anonymous_10)","decl":{"start":{"line":64,"column":29},"end":{"line":64,"column":30}},"loc":{"start":{"line":64,"column":41},"end":{"line":73,"column":5}},"line":64},"11":{"name":"(anonymous_11)","decl":{"start":{"line":68,"column":28},"end":{"line":68,"column":29}},"loc":{"start":{"line":68,"column":38},"end":{"line":70,"column":9}},"line":68},"12":{"name":"(anonymous_12)","decl":{"start":{"line":76,"column":2},"end":{"line":76,"column":3}},"loc":{"start":{"line":76,"column":26},"end":{"line":78,"column":3}},"line":76},"13":{"name":"(anonymous_13)","decl":{"start":{"line":79,"column":2},"end":{"line":79,"column":3}},"loc":{"start":{"line":79,"column":28},"end":{"line":86,"column":3}},"line":79},"14":{"name":"(anonymous_14)","decl":{"start":{"line":87,"column":2},"end":{"line":87,"column":3}},"loc":{"start":{"line":87,"column":28},"end":{"line":89,"column":3}},"line":87},"15":{"name":"(anonymous_15)","decl":{"start":{"line":90,"column":2},"end":{"line":90,"column":3}},"loc":{"start":{"line":90,"column":15},"end":{"line":92,"column":3}},"line":90},"16":{"name":"(anonymous_16)","decl":{"start":{"line":93,"column":2},"end":{"line":93,"column":3}},"loc":{"start":{"line":93,"column":48},"end":{"line":101,"column":3}},"line":93}},"branchMap":{"0":{"loc":{"start":{"line":29,"column":4},"end":{"line":32,"column":5}},"type":"if","locations":[{"start":{"line":29,"column":4},"end":{"line":32,"column":5}},{"start":{},"end":{}}],"line":29},"1":{"loc":{"start":{"line":36,"column":4},"end":{"line":39,"column":5}},"type":"if","locations":[{"start":{"line":36,"column":4},"end":{"line":39,"column":5}},{"start":{},"end":{}}],"line":36},"2":{"loc":{"start":{"line":49,"column":6},"end":{"line":58,"column":7}},"type":"if","locations":[{"start":{"line":49,"column":6},"end":{"line":58,"column":7}},{"start":{},"end":{}}],"line":49},"3":{"loc":{"start":{"line":54,"column":10},"end":{"line":56,"column":11}},"type":"if","locations":[{"start":{"line":54,"column":10},"end":{"line":56,"column":11}},{"start":{},"end":{}}],"line":54},"4":{"loc":{"start":{"line":66,"column":6},"end":{"line":72,"column":7}},"type":"if","locations":[{"start":{"line":66,"column":6},"end":{"line":72,"column":7}},{"start":{},"end":{}}],"line":66},"5":{"loc":{"start":{"line":81,"column":4},"end":{"line":84,"column":5}},"type":"if","locations":[{"start":{"line":81,"column":4},"end":{"line":84,"column":5}},{"start":{},"end":{}}],"line":81},"6":{"loc":{"start":{"line":95,"column":4},"end":{"line":95,"column":33}},"type":"if","locations":[{"start":{"line":95,"column":4},"end":{"line":95,"column":33}},{"start":{},"end":{}}],"line":95},"7":{"loc":{"start":{"line":97,"column":6},"end":{"line":99,"column":7}},"type":"if","locations":[{"start":{"line":97,"column":6},"end":{"line":99,"column":7}},{"start":{},"end":{}}],"line":97}},"s":{"0":4,"1":4,"2":4,"3":4,"4":4,"5":4,"6":4,"7":4,"8":4,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission-rule.model.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IModel, IObjectModel, IWorksheetProtectionRule } from '../type';\nimport { BehaviorSubject, Subject } from 'rxjs';\n\ntype IRuleChangeType = 'add' | 'set' | 'delete';\n\nexport class WorksheetProtectionRuleModel {\n    /**\n     *\n     * Map<unitId, Map<subUnitId, Map<subUnitId, IWorksheetProtectionRule>>>\n     */\n    private _model: IModel = new Map();\n\n    private _ruleChange = new Subject<{\n        unitId: string;\n        subUnitId: string;\n        rule: IWorksheetProtectionRule;\n        oldRule?: IWorksheetProtectionRule;\n        type: IRuleChangeType;\n    }>();\n\n    private _ruleRefresh = new Subject<string>();\n    private _resetOrder = new Subject();\n\n    ruleChange$ = this._ruleChange.asObservable();\n\n    ruleRefresh$ = this._ruleRefresh.asObservable();\n\n    resetOrder$ = this._resetOrder.asObservable();\n\n    private _worksheetRuleInitStateChange = new BehaviorSubject<boolean>(false);\n    worksheetRuleInitStateChange$ = this._worksheetRuleInitStateChange.asObservable();\n\n    changeRuleInitState(state: boolean) {\n        this._worksheetRuleInitStateChange.next(state);\n    }\n\n    getSheetRuleInitState() {\n        return this._worksheetRuleInitStateChange.value;\n    }\n\n    addRule(unitId: string, rule: IWorksheetProtectionRule) {\n        const subUnitMap = this._ensureSubUnitMap(unitId);\n        subUnitMap.set(rule.subUnitId, rule);\n        this._ruleChange.next({ unitId, rule, type: 'add', subUnitId: rule.subUnitId });\n    }\n\n    deleteRule(unitId: string, subUnitId: string) {\n        const rule = this._model?.get(unitId)?.get(subUnitId);\n        if (rule) {\n            this._model.get(unitId)?.delete(subUnitId);\n            this._ruleChange.next({ unitId, rule, type: 'delete', subUnitId });\n        }\n    }\n\n    setRule(unitId: string, subUnitId: string, rule: IWorksheetProtectionRule) {\n        const oldRule = this.getRule(unitId, subUnitId);\n        if (oldRule) {\n            this._model?.get(unitId)?.set(subUnitId, rule);\n            this._ruleChange.next({ unitId, oldRule, rule, type: 'set', subUnitId });\n        }\n    }\n\n    getRule(unitId: string, subUnitId: string) {\n        return this._model?.get(unitId)?.get(subUnitId);\n    }\n\n    toObject() {\n        const result: IObjectModel = {};\n        const unitKeys = [...this._model.keys()];\n        unitKeys.forEach((unitId) => {\n            const subUnitMap = this._model.get(unitId);\n            if (subUnitMap?.size) {\n                result[unitId] = [];\n                const subUnitKeys = [...subUnitMap.keys()];\n                subUnitKeys.forEach((subUnitId) => {\n                    const rule = subUnitMap.get(subUnitId);\n                    if (rule) {\n                        result[unitId].push(rule);\n                    }\n                });\n            }\n        });\n        return result;\n    }\n\n    fromObject(obj: IObjectModel) {\n        const result: IModel = new Map();\n        Object.keys(obj).forEach((unitId) => {\n            const subUnitList = obj[unitId];\n            if (subUnitList?.length) {\n                const subUnitMap = new Map();\n                subUnitList.forEach((rule) => {\n                    subUnitMap.set(rule.subUnitId, rule);\n                });\n                result.set(unitId, subUnitMap);\n            }\n        });\n        this._model = result;\n    }\n\n    deleteUnitModel(unitId: string) {\n        this._model.delete(unitId);\n    }\n\n    private _ensureSubUnitMap(unitId: string) {\n        let subUnitMap = this._model.get(unitId);\n        if (!subUnitMap) {\n            subUnitMap = new Map();\n            this._model.set(unitId, subUnitMap);\n        }\n        return subUnitMap;\n    }\n\n    ruleRefresh(permissionId: string) {\n        this._ruleRefresh.next(permissionId);\n    }\n\n    resetOrder() {\n        this._resetOrder.next(Math.random());\n    }\n\n    getTargetByPermissionId(unitId: string, permissionId: string) {\n        const subUnitMap = this._model.get(unitId);\n        if (!subUnitMap) return null;\n        for (const [subUnitId, rule] of subUnitMap) {\n            if (rule.permissionId === permissionId) {\n                return [unitId, subUnitId];\n            }\n        }\n    }\n}\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ead29d308c2ab8bdfb78505c478297794e1202c7"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/index.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/index.ts","statementMap":{},"fnMap":{},"branchMap":{},"s":{},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/index.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport { getAllWorkbookPermissionPoint, defaultWorkbookPermissionPoints } from './util';\n"],"mappings":"AAgBA,SAAS,+BAA+B,uCAAuC;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"11cafdf04fea9cb4f902e1f5b98a9a1327b2a8c5"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/util.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/util.ts","statementMap":{"0":{"start":{"line":4,"column":45},"end":{"line":23,"column":1}},"1":{"start":{"line":4,"column":51},"end":{"line":23,"column":1}},"2":{"start":{"line":24,"column":47},"end":{"line":43,"column":1}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":45},"end":{"line":4,"column":46}},"loc":{"start":{"line":4,"column":51},"end":{"line":23,"column":1}},"line":4}},"branchMap":{},"s":{"0":1,"1":4,"2":1},"f":{"0":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/util.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UnitAction } from '@univerjs/protocol';\nimport { WorkbookCommentPermission, WorkbookCopyPermission, WorkbookCopySheetPermission, WorkbookCreateSheetPermission, WorkbookDeleteSheetPermission, WorkbookDuplicatePermission, WorkbookEditablePermission, WorkbookExportPermission, WorkbookHideSheetPermission, WorkbookManageCollaboratorPermission, WorkbookMoveSheetPermission, WorkbookPrintPermission, WorkbookRecoverHistoryPermission, WorkbookRenameSheetPermission, WorkbookSharePermission, WorkbookViewHistoryPermission, WorkbookViewPermission } from '../permission-point';\nimport { WorkbookCreateProtectPermission } from '../permission-point/workbook/create-permission';\n\nexport const getAllWorkbookPermissionPoint = () => [\n    WorkbookEditablePermission,\n    WorkbookPrintPermission,\n    WorkbookCommentPermission,\n    WorkbookViewPermission,\n    WorkbookCopyPermission,\n    WorkbookExportPermission,\n    WorkbookManageCollaboratorPermission,\n    WorkbookCreateSheetPermission,\n    WorkbookDeleteSheetPermission,\n    WorkbookRenameSheetPermission,\n    WorkbookHideSheetPermission,\n    WorkbookDuplicatePermission,\n    WorkbookSharePermission,\n    WorkbookMoveSheetPermission,\n    WorkbookCopySheetPermission,\n    WorkbookViewHistoryPermission,\n    WorkbookRecoverHistoryPermission,\n    WorkbookCreateProtectPermission,\n];\n\nexport const defaultWorkbookPermissionPoints = [\n    UnitAction.Edit,\n    UnitAction.Print,\n    UnitAction.Comment,\n    UnitAction.View,\n    UnitAction.Copy,\n    UnitAction.Export,\n    UnitAction.ManageCollaborator,\n    UnitAction.CreateSheet,\n    UnitAction.DeleteSheet,\n    UnitAction.RenameSheet,\n    UnitAction.HideSheet,\n    UnitAction.Duplicate,\n    UnitAction.Share,\n    UnitAction.MoveSheet,\n    UnitAction.CopySheet,\n    UnitAction.RecoverHistory,\n    UnitAction.ViewHistory,\n    UnitAction.CreatePermissionObject,\n];\n"],"mappings":"AAgBA,SAAS,kBAAkB;AAC3B,SAAS,2BAA2B,wBAAwB,6BAA6B,+BAA+B,+BAA+B,6BAA6B,4BAA4B,0BAA0B,6BAA6B,sCAAsC,6BAA6B,yBAAyB,kCAAkC,+BAA+B,yBAAyB,+BAA+B,8BAA8B;AAC1f,SAAS,uCAAuC;AAEzC,aAAM,gCAAgC,MAAM;AAAA,EAC/C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ;AAEO,aAAM,kCAAkC;AAAA,EAC3C,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AACf;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"cdac87228b1eaf4e3336da30b02bbd7ac4763e9d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/utils.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/utils.ts","statementMap":{"0":{"start":{"line":3,"column":46},"end":{"line":8,"column":1}},"1":{"start":{"line":3,"column":52},"end":{"line":8,"column":1}},"2":{"start":{"line":9,"column":58},"end":{"line":24,"column":1}},"3":{"start":{"line":9,"column":64},"end":{"line":24,"column":1}},"4":{"start":{"line":25,"column":47},"end":{"line":40,"column":1}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":46},"end":{"line":3,"column":47}},"loc":{"start":{"line":3,"column":52},"end":{"line":8,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":58},"end":{"line":9,"column":59}},"loc":{"start":{"line":9,"column":64},"end":{"line":24,"column":1}},"line":9}},"branchMap":{},"s":{"0":1,"1":4,"2":1,"3":4,"4":1},"f":{"0":4,"1":4},"b":{},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/utils.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UnitAction } from '@univerjs/protocol';\nimport { WorksheetCopyPermission, WorksheetDeleteColumnPermission, WorksheetDeleteProtectionPermission, WorksheetDeleteRowPermission, WorksheetEditExtraObjectPermission, WorksheetEditPermission, WorksheetFilterPermission, WorksheetInsertColumnPermission, WorksheetInsertHyperlinkPermission, WorksheetInsertRowPermission, WorksheetManageCollaboratorPermission, WorksheetPivotTablePermission, WorksheetSetCellStylePermission, WorksheetSetCellValuePermission, WorksheetSetColumnStylePermission, WorksheetSetRowStylePermission, WorksheetSortPermission, WorksheetViewPermission } from '../permission-point';\n\nexport const getAllWorksheetPermissionPoint = () => [\n    WorksheetEditPermission,\n    WorksheetViewPermission,\n    WorksheetManageCollaboratorPermission,\n    WorksheetDeleteProtectionPermission,\n];\n\n// Changes require synchronization of the following arrays\nexport const getAllWorksheetPermissionPointByPointPanel = () => [\n    WorksheetCopyPermission,\n    WorksheetDeleteColumnPermission,\n    WorksheetDeleteRowPermission,\n    WorksheetEditExtraObjectPermission,\n    WorksheetFilterPermission,\n    WorksheetInsertColumnPermission,\n    WorksheetInsertRowPermission,\n    WorksheetInsertHyperlinkPermission,\n    WorksheetPivotTablePermission,\n    WorksheetSetCellStylePermission,\n    WorksheetSetCellValuePermission,\n    WorksheetSetColumnStylePermission,\n    WorksheetSetRowStylePermission,\n    WorksheetSortPermission,\n];\n\nexport const defaultWorksheetPermissionPoint = [\n    UnitAction.Copy,\n    UnitAction.DeleteColumn,\n    UnitAction.DeleteRow,\n    UnitAction.EditExtraObject,\n    UnitAction.Filter,\n    UnitAction.InsertColumn,\n    UnitAction.InsertRow,\n    UnitAction.InsertHyperlink,\n    UnitAction.PivotTable,\n    UnitAction.SetCellStyle,\n    UnitAction.SetCellValue,\n    UnitAction.SetColumnStyle,\n    UnitAction.SetRowStyle,\n    UnitAction.Sort,\n];\n"],"mappings":"AAgBA,SAAS,kBAAkB;AAC3B,SAAS,yBAAyB,iCAAiC,qCAAqC,8BAA8B,oCAAoC,yBAAyB,2BAA2B,iCAAiC,oCAAoC,8BAA8B,uCAAuC,+BAA+B,iCAAiC,iCAAiC,mCAAmC,gCAAgC,yBAAyB,+BAA+B;AAE7jB,aAAM,iCAAiC,MAAM;AAAA,EAChD;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ;AAGO,aAAM,6CAA6C,MAAM;AAAA,EAC5D;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ;AAEO,aAAM,kCAAkC;AAAA,EAC3C,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AACf;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c7248bb8c5b5c7f7a5617ee981de10f0893c0f1d"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission.service.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission.service.ts","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":37}},"1":{"start":{"line":2,"column":23},"end":{"line":2,"column":54}},"2":{"start":{"line":3,"column":22},"end":{"line":10,"column":1}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"4":{"start":{"line":5,"column":2},"end":{"line":7,"column":85}},"5":{"start":{"line":5,"column":15},"end":{"line":5,"column":36}},"6":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"7":{"start":{"line":7,"column":6},"end":{"line":7,"column":85}},"8":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"9":{"start":{"line":8,"column":22},"end":{"line":8,"column":53}},"10":{"start":{"line":9,"column":2},"end":{"line":9,"column":16}},"11":{"start":{"line":11,"column":22},"end":{"line":11,"column":90}},"12":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"13":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"14":{"start":{"line":21,"column":38},"end":{"line":21,"column":73}},"15":{"start":{"line":22,"column":39},"end":{"line":22,"column":80}},"16":{"start":{"line":23,"column":40},"end":{"line":199,"column":1}},"17":{"start":{"line":25,"column":4},"end":{"line":25,"column":12}},"18":{"start":{"line":26,"column":4},"end":{"line":26,"column":49}},"19":{"start":{"line":27,"column":4},"end":{"line":27,"column":57}},"20":{"start":{"line":28,"column":4},"end":{"line":28,"column":31}},"21":{"start":{"line":29,"column":4},"end":{"line":29,"column":71}},"22":{"start":{"line":30,"column":4},"end":{"line":30,"column":81}},"23":{"start":{"line":31,"column":4},"end":{"line":31,"column":59}},"24":{"start":{"line":32,"column":4},"end":{"line":32,"column":63}},"25":{"start":{"line":33,"column":4},"end":{"line":33,"column":35}},"26":{"start":{"line":34,"column":4},"end":{"line":34,"column":17}},"27":{"start":{"line":35,"column":4},"end":{"line":35,"column":27}},"28":{"start":{"line":36,"column":4},"end":{"line":36,"column":29}},"29":{"start":{"line":37,"column":4},"end":{"line":37,"column":30}},"30":{"start":{"line":40,"column":27},"end":{"line":70,"column":5}},"31":{"start":{"line":41,"column":21},"end":{"line":41,"column":41}},"32":{"start":{"line":42,"column":30},"end":{"line":49,"column":7}},"33":{"start":{"line":43,"column":26},"end":{"line":43,"column":48}},"34":{"start":{"line":44,"column":8},"end":{"line":47,"column":11}},"35":{"start":{"line":45,"column":27},"end":{"line":45,"column":51}},"36":{"start":{"line":46,"column":10},"end":{"line":46,"column":63}},"37":{"start":{"line":48,"column":8},"end":{"line":48,"column":110}},"38":{"start":{"line":50,"column":6},"end":{"line":52,"column":9}},"39":{"start":{"line":51,"column":8},"end":{"line":51,"column":35}},"40":{"start":{"line":53,"column":6},"end":{"line":55,"column":9}},"41":{"start":{"line":54,"column":8},"end":{"line":54,"column":35}},"42":{"start":{"line":56,"column":6},"end":{"line":69,"column":9}},"43":{"start":{"line":57,"column":26},"end":{"line":57,"column":48}},"44":{"start":{"line":58,"column":30},"end":{"line":58,"column":98}},"45":{"start":{"line":59,"column":8},"end":{"line":64,"column":11}},"46":{"start":{"line":60,"column":10},"end":{"line":63,"column":13}},"47":{"start":{"line":61,"column":29},"end":{"line":61,"column":72}},"48":{"start":{"line":62,"column":12},"end":{"line":62,"column":71}},"49":{"start":{"line":65,"column":8},"end":{"line":68,"column":11}},"50":{"start":{"line":66,"column":27},"end":{"line":66,"column":51}},"51":{"start":{"line":67,"column":10},"end":{"line":67,"column":69}},"52":{"start":{"line":71,"column":4},"end":{"line":73,"column":7}},"53":{"start":{"line":72,"column":6},"end":{"line":72,"column":31}},"54":{"start":{"line":74,"column":4},"end":{"line":74,"column":142}},"55":{"start":{"line":75,"column":4},"end":{"line":84,"column":7}},"56":{"start":{"line":76,"column":6},"end":{"line":83,"column":9}},"57":{"start":{"line":77,"column":23},"end":{"line":77,"column":43}},"58":{"start":{"line":78,"column":26},"end":{"line":78,"column":48}},"59":{"start":{"line":79,"column":8},"end":{"line":82,"column":11}},"60":{"start":{"line":80,"column":27},"end":{"line":80,"column":51}},"61":{"start":{"line":81,"column":10},"end":{"line":81,"column":69}},"62":{"start":{"line":87,"column":4},"end":{"line":109,"column":6}},"63":{"start":{"line":89,"column":8},"end":{"line":107,"column":9}},"64":{"start":{"line":91,"column":12},"end":{"line":91,"column":18}},"65":{"start":{"line":94,"column":12},"end":{"line":97,"column":15}},"66":{"start":{"line":95,"column":31},"end":{"line":95,"column":65}},"67":{"start":{"line":96,"column":14},"end":{"line":96,"column":79}},"68":{"start":{"line":98,"column":12},"end":{"line":98,"column":18}},"69":{"start":{"line":101,"column":12},"end":{"line":104,"column":15}},"70":{"start":{"line":102,"column":31},"end":{"line":102,"column":65}},"71":{"start":{"line":103,"column":14},"end":{"line":103,"column":84}},"72":{"start":{"line":105,"column":12},"end":{"line":105,"column":18}},"73":{"start":{"line":112,"column":19},"end":{"line":115,"column":5}},"74":{"start":{"line":113,"column":21},"end":{"line":113,"column":66}},"75":{"start":{"line":114,"column":6},"end":{"line":114,"column":36}},"76":{"start":{"line":116,"column":22},"end":{"line":125,"column":5}},"77":{"start":{"line":117,"column":6},"end":{"line":119,"column":7}},"78":{"start":{"line":118,"column":8},"end":{"line":118,"column":18}},"79":{"start":{"line":120,"column":6},"end":{"line":124,"column":7}},"80":{"start":{"line":121,"column":8},"end":{"line":121,"column":32}},"81":{"start":{"line":123,"column":8},"end":{"line":123,"column":18}},"82":{"start":{"line":126,"column":4},"end":{"line":161,"column":6}},"83":{"start":{"line":133,"column":10},"end":{"line":133,"column":67}},"84":{"start":{"line":134,"column":10},"end":{"line":140,"column":13}},"85":{"start":{"line":135,"column":12},"end":{"line":139,"column":15}},"86":{"start":{"line":136,"column":31},"end":{"line":136,"column":55}},"87":{"start":{"line":137,"column":14},"end":{"line":137,"column":37}},"88":{"start":{"line":138,"column":14},"end":{"line":138,"column":67}},"89":{"start":{"line":141,"column":10},"end":{"line":141,"column":71}},"90":{"start":{"line":144,"column":27},"end":{"line":144,"column":70}},"91":{"start":{"line":145,"column":10},"end":{"line":157,"column":11}},"92":{"start":{"line":146,"column":12},"end":{"line":152,"column":15}},"93":{"start":{"line":147,"column":32},"end":{"line":147,"column":54}},"94":{"start":{"line":148,"column":14},"end":{"line":151,"column":17}},"95":{"start":{"line":149,"column":33},"end":{"line":149,"column":57}},"96":{"start":{"line":150,"column":16},"end":{"line":150,"column":75}},"97":{"start":{"line":153,"column":12},"end":{"line":156,"column":15}},"98":{"start":{"line":154,"column":31},"end":{"line":154,"column":44}},"99":{"start":{"line":155,"column":14},"end":{"line":155,"column":73}},"100":{"start":{"line":158,"column":10},"end":{"line":158,"column":69}},"101":{"start":{"line":164,"column":19},"end":{"line":167,"column":5}},"102":{"start":{"line":165,"column":21},"end":{"line":165,"column":71}},"103":{"start":{"line":166,"column":6},"end":{"line":166,"column":36}},"104":{"start":{"line":168,"column":22},"end":{"line":177,"column":5}},"105":{"start":{"line":169,"column":6},"end":{"line":171,"column":7}},"106":{"start":{"line":170,"column":8},"end":{"line":170,"column":18}},"107":{"start":{"line":172,"column":6},"end":{"line":176,"column":7}},"108":{"start":{"line":173,"column":8},"end":{"line":173,"column":32}},"109":{"start":{"line":175,"column":8},"end":{"line":175,"column":18}},"110":{"start":{"line":178,"column":4},"end":{"line":197,"column":6}},"111":{"start":{"line":185,"column":10},"end":{"line":185,"column":72}},"112":{"start":{"line":186,"column":10},"end":{"line":191,"column":13}},"113":{"start":{"line":187,"column":12},"end":{"line":190,"column":15}},"114":{"start":{"line":188,"column":31},"end":{"line":188,"column":55}},"115":{"start":{"line":189,"column":14},"end":{"line":189,"column":67}},"116":{"start":{"line":194,"column":10},"end":{"line":194,"column":74}},"117":{"start":{"line":200,"column":0},"end":{"line":209,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":22},"end":{"line":3,"column":23}},"loc":{"start":{"line":3,"column":57},"end":{"line":10,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":44},"end":{"line":11,"column":45}},"loc":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":24,"column":2},"end":{"line":24,"column":3}},"loc":{"start":{"line":24,"column":201},"end":{"line":38,"column":3}},"line":24},"4":{"name":"(anonymous_4)","decl":{"start":{"line":39,"column":2},"end":{"line":39,"column":3}},"loc":{"start":{"line":39,"column":10},"end":{"line":85,"column":3}},"line":39},"5":{"name":"(anonymous_5)","decl":{"start":{"line":40,"column":27},"end":{"line":40,"column":28}},"loc":{"start":{"line":40,"column":41},"end":{"line":70,"column":5}},"line":40},"6":{"name":"(anonymous_6)","decl":{"start":{"line":42,"column":30},"end":{"line":42,"column":31}},"loc":{"start":{"line":42,"column":45},"end":{"line":49,"column":7}},"line":42},"7":{"name":"(anonymous_7)","decl":{"start":{"line":44,"column":103},"end":{"line":44,"column":104}},"loc":{"start":{"line":44,"column":110},"end":{"line":47,"column":9}},"line":44},"8":{"name":"(anonymous_8)","decl":{"start":{"line":50,"column":35},"end":{"line":50,"column":36}},"loc":{"start":{"line":50,"column":50},"end":{"line":52,"column":7}},"line":50},"9":{"name":"(anonymous_9)","decl":{"start":{"line":53,"column":39},"end":{"line":53,"column":40}},"loc":{"start":{"line":53,"column":54},"end":{"line":55,"column":7}},"line":53},"10":{"name":"(anonymous_10)","decl":{"start":{"line":56,"column":40},"end":{"line":56,"column":41}},"loc":{"start":{"line":56,"column":55},"end":{"line":69,"column":7}},"line":56},"11":{"name":"(anonymous_11)","decl":{"start":{"line":59,"column":30},"end":{"line":59,"column":31}},"loc":{"start":{"line":59,"column":40},"end":{"line":64,"column":9}},"line":59},"12":{"name":"(anonymous_12)","decl":{"start":{"line":60,"column":52},"end":{"line":60,"column":53}},"loc":{"start":{"line":60,"column":59},"end":{"line":63,"column":11}},"line":60},"13":{"name":"(anonymous_13)","decl":{"start":{"line":65,"column":103},"end":{"line":65,"column":104}},"loc":{"start":{"line":65,"column":110},"end":{"line":68,"column":9}},"line":65},"14":{"name":"(anonymous_14)","decl":{"start":{"line":71,"column":92},"end":{"line":71,"column":93}},"loc":{"start":{"line":71,"column":106},"end":{"line":73,"column":5}},"line":71},"15":{"name":"(anonymous_15)","decl":{"start":{"line":75,"column":129},"end":{"line":75,"column":130}},"loc":{"start":{"line":75,"column":143},"end":{"line":84,"column":5}},"line":75},"16":{"name":"(anonymous_16)","decl":{"start":{"line":76,"column":35},"end":{"line":76,"column":36}},"loc":{"start":{"line":76,"column":50},"end":{"line":83,"column":7}},"line":76},"17":{"name":"(anonymous_17)","decl":{"start":{"line":79,"column":49},"end":{"line":79,"column":50}},"loc":{"start":{"line":79,"column":56},"end":{"line":82,"column":9}},"line":79},"18":{"name":"(anonymous_18)","decl":{"start":{"line":86,"column":2},"end":{"line":86,"column":3}},"loc":{"start":{"line":86,"column":20},"end":{"line":110,"column":3}},"line":86},"19":{"name":"(anonymous_19)","decl":{"start":{"line":88,"column":63},"end":{"line":88,"column":64}},"loc":{"start":{"line":88,"column":73},"end":{"line":108,"column":7}},"line":88},"20":{"name":"(anonymous_20)","decl":{"start":{"line":94,"column":53},"end":{"line":94,"column":54}},"loc":{"start":{"line":94,"column":60},"end":{"line":97,"column":13}},"line":94},"21":{"name":"(anonymous_21)","decl":{"start":{"line":101,"column":53},"end":{"line":101,"column":54}},"loc":{"start":{"line":101,"column":60},"end":{"line":104,"column":13}},"line":101},"22":{"name":"(anonymous_22)","decl":{"start":{"line":111,"column":2},"end":{"line":111,"column":3}},"loc":{"start":{"line":111,"column":22},"end":{"line":162,"column":3}},"line":111},"23":{"name":"(anonymous_23)","decl":{"start":{"line":112,"column":19},"end":{"line":112,"column":20}},"loc":{"start":{"line":112,"column":25},"end":{"line":115,"column":5}},"line":112},"24":{"name":"(anonymous_24)","decl":{"start":{"line":116,"column":22},"end":{"line":116,"column":23}},"loc":{"start":{"line":116,"column":32},"end":{"line":125,"column":5}},"line":116},"25":{"name":"(anonymous_25)","decl":{"start":{"line":132,"column":16},"end":{"line":132,"column":17}},"loc":{"start":{"line":132,"column":39},"end":{"line":142,"column":9}},"line":132},"26":{"name":"(anonymous_26)","decl":{"start":{"line":134,"column":41},"end":{"line":134,"column":42}},"loc":{"start":{"line":134,"column":56},"end":{"line":140,"column":11}},"line":134},"27":{"name":"(anonymous_27)","decl":{"start":{"line":135,"column":53},"end":{"line":135,"column":54}},"loc":{"start":{"line":135,"column":60},"end":{"line":139,"column":13}},"line":135},"28":{"name":"(anonymous_28)","decl":{"start":{"line":143,"column":18},"end":{"line":143,"column":19}},"loc":{"start":{"line":143,"column":30},"end":{"line":159,"column":9}},"line":143},"29":{"name":"(anonymous_29)","decl":{"start":{"line":146,"column":41},"end":{"line":146,"column":42}},"loc":{"start":{"line":146,"column":56},"end":{"line":152,"column":13}},"line":146},"30":{"name":"(anonymous_30)","decl":{"start":{"line":148,"column":109},"end":{"line":148,"column":110}},"loc":{"start":{"line":148,"column":116},"end":{"line":151,"column":15}},"line":148},"31":{"name":"(anonymous_31)","decl":{"start":{"line":153,"column":52},"end":{"line":153,"column":53}},"loc":{"start":{"line":153,"column":59},"end":{"line":156,"column":13}},"line":153},"32":{"name":"(anonymous_32)","decl":{"start":{"line":163,"column":2},"end":{"line":163,"column":3}},"loc":{"start":{"line":163,"column":23},"end":{"line":198,"column":3}},"line":163},"33":{"name":"(anonymous_33)","decl":{"start":{"line":164,"column":19},"end":{"line":164,"column":20}},"loc":{"start":{"line":164,"column":25},"end":{"line":167,"column":5}},"line":164},"34":{"name":"(anonymous_34)","decl":{"start":{"line":168,"column":22},"end":{"line":168,"column":23}},"loc":{"start":{"line":168,"column":32},"end":{"line":177,"column":5}},"line":168},"35":{"name":"(anonymous_35)","decl":{"start":{"line":184,"column":16},"end":{"line":184,"column":17}},"loc":{"start":{"line":184,"column":39},"end":{"line":192,"column":9}},"line":184},"36":{"name":"(anonymous_36)","decl":{"start":{"line":186,"column":41},"end":{"line":186,"column":42}},"loc":{"start":{"line":186,"column":56},"end":{"line":191,"column":11}},"line":186},"37":{"name":"(anonymous_37)","decl":{"start":{"line":187,"column":65},"end":{"line":187,"column":66}},"loc":{"start":{"line":187,"column":72},"end":{"line":190,"column":13}},"line":187},"38":{"name":"(anonymous_38)","decl":{"start":{"line":193,"column":18},"end":{"line":193,"column":19}},"loc":{"start":{"line":193,"column":30},"end":{"line":195,"column":9}},"line":193}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":26},"end":{"line":4,"column":32}},{"start":{"line":4,"column":35},"end":{"line":4,"column":80}}],"line":4},"1":{"loc":{"start":{"line":4,"column":35},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":42},"end":{"line":4,"column":71}},{"start":{"line":4,"column":74},"end":{"line":4,"column":80}}],"line":4},"2":{"loc":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"type":"if","locations":[{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},{"start":{},"end":{}}],"line":6},"3":{"loc":{"start":{"line":7,"column":15},"end":{"line":7,"column":84}},"type":"binary-expr","locations":[{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},{"start":{"line":7,"column":78},"end":{"line":7,"column":84}}],"line":7},"4":{"loc":{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},"type":"cond-expr","locations":[{"start":{"line":7,"column":23},"end":{"line":7,"column":53}},{"start":{"line":7,"column":56},"end":{"line":7,"column":73}}],"line":7},"5":{"loc":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},{"start":{},"end":{}}],"line":8},"6":{"loc":{"start":{"line":8,"column":6},"end":{"line":8,"column":20}},"type":"binary-expr","locations":[{"start":{"line":8,"column":6},"end":{"line":8,"column":10}},{"start":{"line":8,"column":14},"end":{"line":8,"column":20}}],"line":8},"7":{"loc":{"start":{"line":89,"column":8},"end":{"line":107,"column":9}},"type":"switch","locations":[{"start":{"line":90,"column":10},"end":{"line":92,"column":11}},{"start":{"line":93,"column":10},"end":{"line":99,"column":11}},{"start":{"line":100,"column":10},"end":{"line":106,"column":11}}],"line":89},"8":{"loc":{"start":{"line":117,"column":6},"end":{"line":119,"column":7}},"type":"if","locations":[{"start":{"line":117,"column":6},"end":{"line":119,"column":7}},{"start":{},"end":{}}],"line":117},"9":{"loc":{"start":{"line":145,"column":10},"end":{"line":157,"column":11}},"type":"if","locations":[{"start":{"line":145,"column":10},"end":{"line":157,"column":11}},{"start":{},"end":{}}],"line":145},"10":{"loc":{"start":{"line":169,"column":6},"end":{"line":171,"column":7}},"type":"if","locations":[{"start":{"line":169,"column":6},"end":{"line":171,"column":7}},{"start":{},"end":{}}],"line":169}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":8,"7":8,"8":1,"9":0,"10":1,"11":1,"12":8,"13":8,"14":1,"15":1,"16":1,"17":4,"18":4,"19":4,"20":4,"21":4,"22":4,"23":4,"24":4,"25":4,"26":4,"27":4,"28":4,"29":4,"30":4,"31":4,"32":4,"33":4,"34":4,"35":72,"36":72,"37":4,"38":4,"39":4,"40":4,"41":0,"42":4,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":4,"53":0,"54":4,"55":4,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":4,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":4,"74":0,"75":0,"76":4,"77":0,"78":0,"79":0,"80":0,"81":0,"82":4,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":4,"102":0,"103":0,"104":4,"105":0,"106":0,"107":0,"108":0,"109":0,"110":4,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":1},"f":{"0":1,"1":8,"2":8,"3":4,"4":4,"5":4,"6":4,"7":72,"8":4,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":4,"19":0,"20":0,"21":0,"22":4,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":4,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0},"b":{"0":[0,1],"1":[0,1],"2":[8,0],"3":[8,8],"4":[0,8],"5":[0,1],"6":[1,0],"7":[0,0,0],"8":[0,0],"9":[0,0],"10":[0,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/worksheet-permission/worksheet-permission.service.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook, Worksheet } from '@univerjs/core';\nimport type { IObjectModel, IObjectPointModel } from '../type';\nimport { ILogService, Inject, Injector, IPermissionService, IResourceManagerService, IUniverInstanceService, RxDisposable, UniverInstanceType } from '@univerjs/core';\nimport { UniverType } from '@univerjs/protocol';\n\nimport { takeUntil } from 'rxjs/operators';\nimport { RangeProtectionRuleModel } from '../../../model/range-protection-rule.model';\nimport { getAllRangePermissionPoint } from '../range-permission/util';\nimport { getAllWorkbookPermissionPoint } from '../workbook-permission';\nimport { getAllWorksheetPermissionPoint, getAllWorksheetPermissionPointByPointPanel } from './utils';\nimport { WorksheetProtectionPointModel } from './worksheet-permission-point.model';\nimport { WorksheetProtectionRuleModel } from './worksheet-permission-rule.model';\n\nexport const RULE_MODEL_PLUGIN_NAME = 'SHEET_WORKSHEET_PROTECTION_PLUGIN';\nexport const POINT_MODEL_PLUGIN_NAME = 'SHEET_WORKSHEET_PROTECTION_POINT_PLUGIN';\n\nexport class WorksheetPermissionService extends RxDisposable {\n    constructor(\n        @Inject(IPermissionService) private _permissionService: IPermissionService,\n        @Inject(IUniverInstanceService) private _univerInstanceService: IUniverInstanceService,\n        @Inject(Injector) readonly _injector: Injector,\n        @Inject(WorksheetProtectionRuleModel) private _worksheetProtectionRuleModel: WorksheetProtectionRuleModel,\n        @Inject(WorksheetProtectionPointModel) private _worksheetProtectionPointRuleModel: WorksheetProtectionPointModel,\n        @Inject(IResourceManagerService) private _resourceManagerService: IResourceManagerService,\n        @Inject(RangeProtectionRuleModel) private _rangeProtectionRuleModel: RangeProtectionRuleModel,\n        @Inject(ILogService) private _logService: ILogService\n    ) {\n        super();\n        this._init();\n        this._initRuleChange();\n        this._initRuleSnapshot();\n        this._initPointSnapshot();\n    }\n\n    private _init() {\n        const handleWorkbook = (workbook: Workbook) => {\n            const unitId = workbook.getUnitId();\n            const handleWorksheet = (worksheet: Worksheet) => {\n                const subUnitId = worksheet.getSheetId();\n                [...getAllWorksheetPermissionPoint(), ...getAllWorksheetPermissionPointByPointPanel()].forEach((F) => {\n                    const instance = new F(unitId, subUnitId);\n                    this._permissionService.addPermissionPoint(instance);\n                });\n                this._logService.debug('[WorksheetPermissionService]', 'Initialization completed', unitId, subUnitId);\n            };\n            workbook.getSheets().forEach((worksheet) => {\n                handleWorksheet(worksheet);\n            });\n            workbook.sheetCreated$.subscribe((worksheet) => {\n                handleWorksheet(worksheet);\n            });\n            workbook.sheetDisposed$.subscribe((worksheet) => {\n                const subUnitId = worksheet.getSheetId();\n\n                const rangeRuleList = this._rangeProtectionRuleModel.getSubunitRuleList(unitId, subUnitId);\n                rangeRuleList.forEach((rule) => {\n                    [...getAllRangePermissionPoint()].forEach((F) => {\n                        const instance = new F(unitId, subUnitId, rule.permissionId);\n                        this._permissionService.deletePermissionPoint(instance.id);\n                    });\n                });\n\n                [...getAllWorksheetPermissionPoint(), ...getAllWorksheetPermissionPointByPointPanel()].forEach((F) => {\n                    const instance = new F(unitId, subUnitId);\n                    this._permissionService.deletePermissionPoint(instance.id);\n                });\n            });\n        };\n\n        this._univerInstanceService.getAllUnitsForType<Workbook>(UniverInstanceType.UNIVER_SHEET).forEach((workbook) => {\n            handleWorkbook(workbook);\n        });\n\n        this._univerInstanceService.getTypeOfUnitAdded$<Workbook>(UniverInstanceType.UNIVER_SHEET).pipe(takeUntil(this.dispose$)).subscribe(handleWorkbook);\n\n        this._univerInstanceService.getTypeOfUnitDisposed$<Workbook>(UniverInstanceType.UNIVER_SHEET).pipe(takeUntil(this.dispose$)).subscribe((workbook) => {\n            workbook.getSheets().forEach((worksheet) => {\n                const unitId = workbook.getUnitId();\n                const subUnitId = worksheet.getSheetId();\n                getAllWorksheetPermissionPoint().forEach((F) => {\n                    const instance = new F(unitId, subUnitId);\n                    this._permissionService.deletePermissionPoint(instance.id);\n                });\n            });\n        });\n    }\n\n    private _initRuleChange() {\n        this.disposeWithMe(\n            this._worksheetProtectionRuleModel.ruleChange$.subscribe((info) => {\n                switch (info.type) {\n                    case 'add': {\n                        break;\n                    }\n                    case 'delete': {\n                        getAllWorksheetPermissionPoint().forEach((F) => {\n                            const instance = new F(info.unitId, info.subUnitId);\n                            this._permissionService.updatePermissionPoint(instance.id, true);\n                        });\n                        break;\n                    }\n                    case 'set': {\n                        getAllWorksheetPermissionPoint().forEach((F) => {\n                            const instance = new F(info.unitId, info.subUnitId);\n                            this._permissionService.updatePermissionPoint(instance.id, info.rule);\n                        });\n                        break;\n                    }\n                }\n            })\n        );\n    }\n\n    private _initRuleSnapshot() {\n        const toJson = () => {\n            const object = this._worksheetProtectionRuleModel.toObject();\n            return JSON.stringify(object);\n        };\n        const parseJson = (json: string): IObjectModel => {\n            if (!json) {\n                return {};\n            }\n            try {\n                return JSON.parse(json);\n            } catch (err) {\n                return {};\n            }\n        };\n        this.disposeWithMe(\n            this._resourceManagerService.registerPluginResource({\n                toJson,\n                parseJson,\n                pluginName: RULE_MODEL_PLUGIN_NAME,\n                businesses: [UniverType.UNIVER_SHEET],\n                onLoad: (unitId, resources) => {\n                    this._worksheetProtectionRuleModel.fromObject(resources);\n                    Object.keys(resources).forEach((subUnitId) => {\n                        getAllWorksheetPermissionPoint().forEach((F) => {\n                            const instance = new F(unitId, subUnitId);\n                            instance.value = false;\n                            this._permissionService.addPermissionPoint(instance);\n                        });\n                    });\n                    this._worksheetProtectionRuleModel.changeRuleInitState(true);\n                },\n                onUnLoad: (unitId: string) => {\n                    const workbook = this._univerInstanceService.getUnit<Workbook>(unitId);\n                    if (workbook) {\n                        workbook.getSheets().forEach((worksheet) => {\n                            const subUnitId = worksheet.getSheetId();\n\n                            [...getAllWorksheetPermissionPoint(), ...getAllWorksheetPermissionPointByPointPanel()].forEach((F) => {\n                                const instance = new F(unitId, subUnitId);\n                                this._permissionService.deletePermissionPoint(instance.id);\n                            });\n                        });\n                        getAllWorkbookPermissionPoint().forEach((F) => {\n                            const instance = new F(unitId);\n                            this._permissionService.deletePermissionPoint(instance.id);\n                        });\n                    }\n\n                    this._worksheetProtectionRuleModel.deleteUnitModel(unitId);\n                },\n            })\n        );\n    }\n\n    private _initPointSnapshot() {\n        const toJson = () => {\n            const object = this._worksheetProtectionPointRuleModel.toObject();\n            return JSON.stringify(object);\n        };\n        const parseJson = (json: string): IObjectPointModel => {\n            if (!json) {\n                return {};\n            }\n            try {\n                return JSON.parse(json);\n            } catch (err) {\n                return {};\n            }\n        };\n        this.disposeWithMe(\n            this._resourceManagerService.registerPluginResource({\n                toJson,\n                parseJson,\n                pluginName: POINT_MODEL_PLUGIN_NAME,\n                businesses: [UniverType.UNIVER_SHEET],\n                onLoad: (unitId, resources) => {\n                    this._worksheetProtectionPointRuleModel.fromObject(resources);\n                    Object.keys(resources).forEach((subUnitId) => {\n                        getAllWorksheetPermissionPointByPointPanel().forEach((F) => {\n                            const instance = new F(unitId, subUnitId);\n                            this._permissionService.addPermissionPoint(instance);\n                        });\n                    });\n                },\n                onUnLoad: (unitId: string) => {\n                    this._worksheetProtectionPointRuleModel.deleteUnitModel(unitId);\n                },\n            })\n        );\n    }\n}\n"],"mappings":"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","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2cff6eeff4b37afeee3f942eeeb98834565ee6e2"},"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/workbook-permission.service.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/workbook-permission.service.ts","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":37}},"1":{"start":{"line":2,"column":23},"end":{"line":2,"column":54}},"2":{"start":{"line":3,"column":22},"end":{"line":10,"column":1}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"4":{"start":{"line":5,"column":2},"end":{"line":7,"column":85}},"5":{"start":{"line":5,"column":15},"end":{"line":5,"column":36}},"6":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"7":{"start":{"line":7,"column":6},"end":{"line":7,"column":85}},"8":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"9":{"start":{"line":8,"column":22},"end":{"line":8,"column":53}},"10":{"start":{"line":9,"column":2},"end":{"line":9,"column":16}},"11":{"start":{"line":11,"column":22},"end":{"line":11,"column":90}},"12":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"13":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"14":{"start":{"line":18,"column":39},"end":{"line":67,"column":1}},"15":{"start":{"line":20,"column":4},"end":{"line":20,"column":12}},"16":{"start":{"line":21,"column":4},"end":{"line":21,"column":49}},"17":{"start":{"line":22,"column":4},"end":{"line":22,"column":57}},"18":{"start":{"line":23,"column":4},"end":{"line":23,"column":63}},"19":{"start":{"line":24,"column":4},"end":{"line":24,"column":71}},"20":{"start":{"line":25,"column":4},"end":{"line":25,"column":73}},"21":{"start":{"line":26,"column":4},"end":{"line":26,"column":17}},"22":{"start":{"line":29,"column":27},"end":{"line":35,"column":5}},"23":{"start":{"line":30,"column":21},"end":{"line":30,"column":41}},"24":{"start":{"line":31,"column":6},"end":{"line":34,"column":9}},"25":{"start":{"line":32,"column":25},"end":{"line":32,"column":38}},"26":{"start":{"line":33,"column":8},"end":{"line":33,"column":61}},"27":{"start":{"line":36,"column":4},"end":{"line":38,"column":7}},"28":{"start":{"line":37,"column":6},"end":{"line":37,"column":31}},"29":{"start":{"line":39,"column":4},"end":{"line":41,"column":8}},"30":{"start":{"line":40,"column":6},"end":{"line":40,"column":31}},"31":{"start":{"line":42,"column":4},"end":{"line":65,"column":8}},"32":{"start":{"line":43,"column":21},"end":{"line":43,"column":41}},"33":{"start":{"line":44,"column":6},"end":{"line":57,"column":9}},"34":{"start":{"line":45,"column":26},"end":{"line":45,"column":48}},"35":{"start":{"line":46,"column":30},"end":{"line":46,"column":98}},"36":{"start":{"line":47,"column":8},"end":{"line":52,"column":11}},"37":{"start":{"line":48,"column":10},"end":{"line":51,"column":13}},"38":{"start":{"line":49,"column":29},"end":{"line":49,"column":72}},"39":{"start":{"line":50,"column":12},"end":{"line":50,"column":71}},"40":{"start":{"line":53,"column":8},"end":{"line":56,"column":11}},"41":{"start":{"line":54,"column":27},"end":{"line":54,"column":51}},"42":{"start":{"line":55,"column":10},"end":{"line":55,"column":69}},"43":{"start":{"line":58,"column":6},"end":{"line":61,"column":9}},"44":{"start":{"line":59,"column":25},"end":{"line":59,"column":38}},"45":{"start":{"line":60,"column":8},"end":{"line":60,"column":67}},"46":{"start":{"line":62,"column":6},"end":{"line":62,"column":61}},"47":{"start":{"line":63,"column":6},"end":{"line":63,"column":66}},"48":{"start":{"line":64,"column":6},"end":{"line":64,"column":65}},"49":{"start":{"line":68,"column":0},"end":{"line":74,"column":30}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":22},"end":{"line":3,"column":23}},"loc":{"start":{"line":3,"column":57},"end":{"line":10,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":44},"end":{"line":11,"column":90}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":44},"end":{"line":11,"column":45}},"loc":{"start":{"line":11,"column":61},"end":{"line":11,"column":90}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":19,"column":2},"end":{"line":19,"column":3}},"loc":{"start":{"line":19,"column":148},"end":{"line":27,"column":3}},"line":19},"4":{"name":"(anonymous_4)","decl":{"start":{"line":28,"column":2},"end":{"line":28,"column":3}},"loc":{"start":{"line":28,"column":10},"end":{"line":66,"column":3}},"line":28},"5":{"name":"(anonymous_5)","decl":{"start":{"line":29,"column":27},"end":{"line":29,"column":28}},"loc":{"start":{"line":29,"column":41},"end":{"line":35,"column":5}},"line":29},"6":{"name":"(anonymous_6)","decl":{"start":{"line":31,"column":46},"end":{"line":31,"column":47}},"loc":{"start":{"line":31,"column":53},"end":{"line":34,"column":7}},"line":31},"7":{"name":"(anonymous_7)","decl":{"start":{"line":36,"column":92},"end":{"line":36,"column":93}},"loc":{"start":{"line":36,"column":106},"end":{"line":38,"column":5}},"line":36},"8":{"name":"(anonymous_8)","decl":{"start":{"line":39,"column":114},"end":{"line":39,"column":115}},"loc":{"start":{"line":39,"column":128},"end":{"line":41,"column":5}},"line":39},"9":{"name":"(anonymous_9)","decl":{"start":{"line":42,"column":117},"end":{"line":42,"column":118}},"loc":{"start":{"line":42,"column":131},"end":{"line":65,"column":5}},"line":42},"10":{"name":"(anonymous_10)","decl":{"start":{"line":44,"column":35},"end":{"line":44,"column":36}},"loc":{"start":{"line":44,"column":50},"end":{"line":57,"column":7}},"line":44},"11":{"name":"(anonymous_11)","decl":{"start":{"line":47,"column":30},"end":{"line":47,"column":31}},"loc":{"start":{"line":47,"column":40},"end":{"line":52,"column":9}},"line":47},"12":{"name":"(anonymous_12)","decl":{"start":{"line":48,"column":52},"end":{"line":48,"column":53}},"loc":{"start":{"line":48,"column":59},"end":{"line":51,"column":11}},"line":48},"13":{"name":"(anonymous_13)","decl":{"start":{"line":53,"column":103},"end":{"line":53,"column":104}},"loc":{"start":{"line":53,"column":110},"end":{"line":56,"column":9}},"line":53},"14":{"name":"(anonymous_14)","decl":{"start":{"line":58,"column":46},"end":{"line":58,"column":47}},"loc":{"start":{"line":58,"column":53},"end":{"line":61,"column":7}},"line":58}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":15},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":26},"end":{"line":4,"column":32}},{"start":{"line":4,"column":35},"end":{"line":4,"column":80}}],"line":4},"1":{"loc":{"start":{"line":4,"column":35},"end":{"line":4,"column":80}},"type":"cond-expr","locations":[{"start":{"line":4,"column":42},"end":{"line":4,"column":71}},{"start":{"line":4,"column":74},"end":{"line":4,"column":80}}],"line":4},"2":{"loc":{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},"type":"if","locations":[{"start":{"line":6,"column":4},"end":{"line":7,"column":85}},{"start":{},"end":{}}],"line":6},"3":{"loc":{"start":{"line":7,"column":15},"end":{"line":7,"column":84}},"type":"binary-expr","locations":[{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},{"start":{"line":7,"column":78},"end":{"line":7,"column":84}}],"line":7},"4":{"loc":{"start":{"line":7,"column":16},"end":{"line":7,"column":73}},"type":"cond-expr","locations":[{"start":{"line":7,"column":23},"end":{"line":7,"column":53}},{"start":{"line":7,"column":56},"end":{"line":7,"column":73}}],"line":7},"5":{"loc":{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":8,"column":53}},{"start":{},"end":{}}],"line":8},"6":{"loc":{"start":{"line":8,"column":6},"end":{"line":8,"column":20}},"type":"binary-expr","locations":[{"start":{"line":8,"column":6},"end":{"line":8,"column":10}},{"start":{"line":8,"column":14},"end":{"line":8,"column":20}}],"line":8}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":5,"7":5,"8":1,"9":0,"10":1,"11":1,"12":5,"13":5,"14":1,"15":4,"16":4,"17":4,"18":4,"19":4,"20":4,"21":4,"22":4,"23":4,"24":4,"25":72,"26":72,"27":4,"28":0,"29":4,"30":4,"31":4,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":1},"f":{"0":1,"1":5,"2":5,"3":4,"4":4,"5":4,"6":72,"7":0,"8":4,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"b":{"0":[0,1],"1":[0,1],"2":[5,0],"3":[5,5],"4":[0,5],"5":[0,1],"6":[1,0]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets/src/services/permission/workbook-permission/workbook-permission.service.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport { Disposable, Inject, IPermissionService, IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport { RangeProtectionRuleModel } from '../../../model/range-protection-rule.model';\nimport { getAllRangePermissionPoint } from '../range-permission/util';\nimport { WorksheetProtectionPointModel, WorksheetProtectionRuleModel } from '../worksheet-permission';\nimport { getAllWorksheetPermissionPoint, getAllWorksheetPermissionPointByPointPanel } from '../worksheet-permission/utils';\nimport { getAllWorkbookPermissionPoint } from './util';\n\nexport class WorkbookPermissionService extends Disposable {\n    constructor(\n        @Inject(IPermissionService) private _permissionService: IPermissionService,\n        @Inject(IUniverInstanceService) private _univerInstanceService: IUniverInstanceService,\n        @Inject(RangeProtectionRuleModel) private _rangeProtectionRuleModel: RangeProtectionRuleModel,\n        @Inject(WorksheetProtectionRuleModel) private _worksheetProtectionRuleModel: WorksheetProtectionRuleModel,\n        @Inject(WorksheetProtectionPointModel) private _worksheetProtectionPointModel: WorksheetProtectionPointModel\n    ) {\n        super();\n\n        this._init();\n    }\n\n    private _init() {\n        const handleWorkbook = (workbook: Workbook) => {\n            const unitId = workbook.getUnitId();\n            getAllWorkbookPermissionPoint().forEach((F) => {\n                const instance = new F(unitId);\n                this._permissionService.addPermissionPoint(instance);\n            });\n        };\n\n        this._univerInstanceService.getAllUnitsForType<Workbook>(UniverInstanceType.UNIVER_SHEET).forEach((workbook) => {\n            handleWorkbook(workbook);\n        });\n\n        this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$<Workbook>(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) => {\n            handleWorkbook(workbook);\n        }));\n\n        this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$<Workbook>(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) => {\n            const unitId = workbook.getUnitId();\n            workbook.getSheets().forEach((worksheet) => {\n                const subUnitId = worksheet.getSheetId();\n\n                const rangeRuleList = this._rangeProtectionRuleModel.getSubunitRuleList(unitId, subUnitId);\n                rangeRuleList.forEach((rule) => {\n                    [...getAllRangePermissionPoint()].forEach((F) => {\n                        const instance = new F(unitId, subUnitId, rule.permissionId);\n                        this._permissionService.deletePermissionPoint(instance.id);\n                    });\n                });\n\n                [...getAllWorksheetPermissionPoint(), ...getAllWorksheetPermissionPointByPointPanel()].forEach((F) => {\n                    const instance = new F(unitId, subUnitId);\n                    this._permissionService.deletePermissionPoint(instance.id);\n                });\n            });\n            getAllWorkbookPermissionPoint().forEach((F) => {\n                const instance = new F(unitId);\n                this._permissionService.deletePermissionPoint(instance.id);\n            });\n\n            this._rangeProtectionRuleModel.deleteUnitModel(unitId);\n            this._worksheetProtectionPointModel.deleteUnitModel(unitId);\n            this._worksheetProtectionRuleModel.deleteUnitModel(unitId);\n        }));\n    }\n}\n"],"mappings":";;;;;;;;;;;AAiBA,SAAS,YAAY,QAAQ,oBAAoB,wBAAwB,0BAA0B;AACnG,SAAS,gCAAgC;AACzC,SAAS,kCAAkC;AAC3C,SAAS,+BAA+B,oCAAoC;AAC5E,SAAS,gCAAgC,kDAAkD;AAC3F,SAAS,qCAAqC;AAEvC,WAAM,4BAAN,cAAwC,WAAW;AAAA,EACtD,YACwC,oBACI,wBACE,2BACI,+BACC,gCACjD;AACE,UAAM;AAN8B;AACI;AACE;AACI;AACC;AAI/C,SAAK,MAAM;AAAA,EACf;AAAA,EAEQ,QAAQ;AACZ,UAAM,iBAAiB,CAAC,aAAuB;AAC3C,YAAM,SAAS,SAAS,UAAU;AAClC,oCAA8B,EAAE,QAAQ,CAAC,MAAM;AAC3C,cAAM,WAAW,IAAI,EAAE,MAAM;AAC7B,aAAK,mBAAmB,mBAAmB,QAAQ;AAAA,MACvD,CAAC;AAAA,IACL;AAEA,SAAK,uBAAuB,mBAA6B,mBAAmB,YAAY,EAAE,QAAQ,CAAC,aAAa;AAC5G,qBAAe,QAAQ;AAAA,IAC3B,CAAC;AAED,SAAK,cAAc,KAAK,uBAAuB,oBAA8B,mBAAmB,YAAY,EAAE,UAAU,CAAC,aAAa;AAClI,qBAAe,QAAQ;AAAA,IAC3B,CAAC,CAAC;AAEF,SAAK,cAAc,KAAK,uBAAuB,uBAAiC,mBAAmB,YAAY,EAAE,UAAU,CAAC,aAAa;AACrI,YAAM,SAAS,SAAS,UAAU;AAClC,eAAS,UAAU,EAAE,QAAQ,CAAC,cAAc;AACxC,cAAM,YAAY,UAAU,WAAW;AAEvC,cAAM,gBAAgB,KAAK,0BAA0B,mBAAmB,QAAQ,SAAS;AACzF,sBAAc,QAAQ,CAAC,SAAS;AAC5B,WAAC,GAAG,2BAA2B,CAAC,EAAE,QAAQ,CAAC,MAAM;AAC7C,kBAAM,WAAW,IAAI,EAAE,QAAQ,WAAW,KAAK,YAAY;AAC3D,iBAAK,mBAAmB,sBAAsB,SAAS,EAAE;AAAA,UAC7D,CAAC;AAAA,QACL,CAAC;AAED,SAAC,GAAG,+BAA+B,GAAG,GAAG,2CAA2C,CAAC,EAAE,QAAQ,CAAC,MAAM;AAClG,gBAAM,WAAW,IAAI,EAAE,QAAQ,SAAS;AACxC,eAAK,mBAAmB,sBAAsB,SAAS,EAAE;AAAA,QAC7D,CAAC;AAAA,MACL,CAAC;AACD,oCAA8B,EAAE,QAAQ,CAAC,MAAM;AAC3C,cAAM,WAAW,IAAI,EAAE,MAAM;AAC7B,aAAK,mBAAmB,sBAAsB,SAAS,EAAE;AAAA,MAC7D,CAAC;AAED,WAAK,0BAA0B,gBAAgB,MAAM;AACrD,WAAK,+BAA+B,gBAAgB,MAAM;AAC1D,WAAK,8BAA8B,gBAAgB,MAAM;AAAA,IAC7D,CAAC,CAAC;AAAA,EACN;AACJ;AA1Da,4BAAN;AAAA,EAEE,0BAAO,kBAAkB;AAAA,EACzB,0BAAO,sBAAsB;AAAA,EAC7B,0BAAO,wBAAwB;AAAA,EAC/B,0BAAO,4BAA4B;AAAA,EACnC,0BAAO,6BAA6B;AAAA,GANhC;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b11a0a8e514a3cef8fad998738863bb6694d417e"}}