{"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets-formula/src/controllers/utils/offset-formula-data.ts":{"path":"/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets-formula/src/controllers/utils/offset-formula-data.ts","statementMap":{"0":{"start":{"line":2,"column":2},"end":{"line":4,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":16}},"2":{"start":{"line":5,"column":2},"end":{"line":5,"column":15}},"3":{"start":{"line":8,"column":2},"end":{"line":24,"column":3}},"4":{"start":{"line":9,"column":4},"end":{"line":16,"column":5}},"5":{"start":{"line":10,"column":6},"end":{"line":10,"column":42}},"6":{"start":{"line":11,"column":6},"end":{"line":15,"column":8}},"7":{"start":{"line":18,"column":4},"end":{"line":23,"column":5}},"8":{"start":{"line":19,"column":6},"end":{"line":19,"column":33}},"9":{"start":{"line":20,"column":6},"end":{"line":22,"column":8}}},"fnMap":{"0":{"name":"checkFormulaDataNull","decl":{"start":{"line":1,"column":16},"end":{"line":1,"column":36}},"loc":{"start":{"line":1,"column":67},"end":{"line":6,"column":1}},"line":1},"1":{"name":"removeFormulaData","decl":{"start":{"line":7,"column":16},"end":{"line":7,"column":33}},"loc":{"start":{"line":7,"column":64},"end":{"line":25,"column":1}},"line":7}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":2},"end":{"line":4,"column":3}},"type":"if","locations":[{"start":{"line":2,"column":2},"end":{"line":4,"column":3}},{"start":{},"end":{}}],"line":2},"1":{"loc":{"start":{"line":2,"column":6},"end":{"line":2,"column":98}},"type":"binary-expr","locations":[{"start":{"line":2,"column":6},"end":{"line":2,"column":25}},{"start":{"line":2,"column":29},"end":{"line":2,"column":56}},{"start":{"line":2,"column":60},"end":{"line":2,"column":98}}],"line":2},"2":{"loc":{"start":{"line":8,"column":2},"end":{"line":24,"column":3}},"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":24,"column":3}},{"start":{"line":17,"column":9},"end":{"line":24,"column":3}}],"line":8},"3":{"loc":{"start":{"line":9,"column":4},"end":{"line":16,"column":5}},"type":"if","locations":[{"start":{"line":9,"column":4},"end":{"line":16,"column":5}},{"start":{},"end":{}}],"line":9},"4":{"loc":{"start":{"line":9,"column":8},"end":{"line":9,"column":76}},"type":"binary-expr","locations":[{"start":{"line":9,"column":8},"end":{"line":9,"column":19}},{"start":{"line":9,"column":23},"end":{"line":9,"column":42}},{"start":{"line":9,"column":46},"end":{"line":9,"column":76}}],"line":9},"5":{"loc":{"start":{"line":18,"column":4},"end":{"line":23,"column":5}},"type":"if","locations":[{"start":{"line":18,"column":4},"end":{"line":23,"column":5}},{"start":{},"end":{}}],"line":18},"6":{"loc":{"start":{"line":18,"column":8},"end":{"line":18,"column":42}},"type":"binary-expr","locations":[{"start":{"line":18,"column":8},"end":{"line":18,"column":19}},{"start":{"line":18,"column":23},"end":{"line":18,"column":42}}],"line":18}},"s":{"0":0,"1":0,"2":0,"3":7,"4":4,"5":2,"6":2,"7":3,"8":2,"9":2},"f":{"0":0,"1":7},"b":{"0":[0,0],"1":[0,0,0],"2":[4,3],"3":[2,2],"4":[4,4,3],"5":[2,1],"6":[3,3]},"inputSourceMap":{"version":3,"sources":["/Users/zhongjiafeng/Desktop/5000_Project/github/githubuniver/univer/packages/sheets-formula/src/controllers/utils/offset-formula-data.ts"],"sourcesContent":["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IRange } from '@univerjs/core';\nimport type { IArrayFormulaRangeType, IArrayFormulaUnitCellType, IFormulaData } from '@univerjs/engine-formula';\n\nexport interface IRefRangeWithPosition {\n    row: number;\n    column: number;\n    range: IRange;\n}\n\nexport function checkFormulaDataNull(formulaData: IFormulaData, unitId: string, sheetId: string) {\n    if (formulaData == null || formulaData[unitId] == null || formulaData[unitId]?.[sheetId] == null) {\n        return true;\n    }\n\n    return false;\n}\n\nexport function removeFormulaData(formulaData: IFormulaData | IArrayFormulaRangeType | IArrayFormulaUnitCellType, unitId: string, sheetId?: string) {\n    if (sheetId) {\n        if (formulaData && formulaData[unitId] && formulaData[unitId]?.[sheetId]) {\n            delete formulaData[unitId]![sheetId];\n            return {\n                [unitId]: {\n                    [sheetId]: null,\n                },\n            };\n        }\n    } else {\n        if (formulaData && formulaData[unitId]) {\n            delete formulaData[unitId];\n            return {\n                [unitId]: null,\n            };\n        }\n    }\n}\n"],"mappings":"AAyBO,gBAAS,qBAAqB,aAA2B,QAAgB,SAAiB;AAC7F,MAAI,eAAe,QAAQ,YAAY,MAAM,KAAK,QAAQ,YAAY,MAAM,IAAI,OAAO,KAAK,MAAM;AAC9F,WAAO;AAAA,EACX;AAEA,SAAO;AACX;AAEO,gBAAS,kBAAkB,aAAgF,QAAgB,SAAkB;AAChJ,MAAI,SAAS;AACT,QAAI,eAAe,YAAY,MAAM,KAAK,YAAY,MAAM,IAAI,OAAO,GAAG;AACtE,aAAO,YAAY,MAAM,EAAG,OAAO;AACnC,aAAO;AAAA,QACH,CAAC,MAAM,GAAG;AAAA,UACN,CAAC,OAAO,GAAG;AAAA,QACf;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ,OAAO;AACH,QAAI,eAAe,YAAY,MAAM,GAAG;AACpC,aAAO,YAAY,MAAM;AACzB,aAAO;AAAA,QACH,CAAC,MAAM,GAAG;AAAA,MACd;AAAA,IACJ;AAAA,EACJ;AACJ;","names":[]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8003e22b8c1e21daf5d082efc607026f4b961b97"}}