{
  "version": 3,
  "sources": ["../../packages/sheets-ui/src/common/utils.ts", "../../packages/sheets-ui/src/commands/commands/utils/selection-utils.ts", "../../packages/sheets-ui/src/commands/commands/add-worksheet-merge.command.ts", "../../packages/sheets-ui/src/common/keys.ts", "../../packages/sheets-ui/src/commands/commands/headersize-changed.command.ts", "../../packages/sheets-ui/src/services/selection/const.ts", "../../packages/sheets-ui/src/services/selection/selection-render-model.ts", "../../packages/sheets-ui/src/services/selection/util.ts", "../../packages/sheets-ui/src/services/selection/selection-shape-extension.ts", "../../packages/sheets-ui/src/services/selection/selection-control.ts", "../../packages/sheets-ui/src/services/selection/selection-layer.ts", "../../packages/sheets-ui/src/services/selection/base-selection-render.service.ts", "../../packages/sheets-ui/src/services/sheet-skeleton-manager.service.ts", "../../packages/sheets-ui/src/controllers/config.schema.ts", "../../packages/sheets-ui/src/controllers/auto-height.controller.ts", "../../packages/sheets-ui/src/controllers/utils/range-tools.ts", "../../packages/sheets-ui/src/services/auto-fill/tools.ts", "../../packages/sheets-ui/src/services/auto-fill/rules.ts", "../../packages/sheets-ui/src/services/auto-fill/auto-fill.service.ts", "../../packages/sheets-ui/src/commands/commands/auto-fill.command.ts", "../../packages/sheets-ui/src/commands/commands/delete-range-move-left-confirm.command.ts", "../../packages/sheets-ui/src/commands/commands/delete-range-move-up-confirm.command.ts", "../../packages/sheets-ui/src/commands/commands/hide-row-col-confirm.command.ts", "../../packages/sheets-ui/src/commands/commands/inline-format.command.ts", "../../packages/sheets-ui/src/commands/commands/insert-range-move-down-confirm.command.ts", "../../packages/sheets-ui/src/commands/commands/insert-range-move-right-confirm.command.ts", "../../packages/sheets-ui/src/consts/permission.ts", "../../packages/sheets-ui/src/services/permission/sheet-permission-panel.model.ts", "../../packages/sheets-ui/src/services/permission/sheet-permission-user-list.service.ts", "../../packages/sheets-ui/src/commands/operations/sheet-permission-open-panel.operation.ts", "../../packages/sheets-ui/src/commands/commands/range-protection.command.ts", "../../packages/sheets-ui/src/commands/commands/refill.command.ts", "../../packages/sheets-ui/src/commands/commands/remove-row-col-confirm.command.ts", "../../packages/sheets-ui/src/commands/commands/remove-sheet-confirm.command.ts", "../../packages/sheets-ui/src/services/mark-selection/mark-selection.service.ts", "../../packages/sheets-ui/src/services/utils/selection-util.ts", "../../packages/sheets-ui/src/services/format-painter/format-painter.service.ts", "../../packages/sheets-ui/src/commands/operations/set-format-painter.operation.ts", "../../packages/sheets-ui/src/commands/commands/set-format-painter.command.ts", "../../packages/sheets-ui/src/services/scroll-manager.service.ts", "../../packages/sheets-ui/src/commands/commands/set-frozen.command.ts", "../../packages/sheets-ui/src/services/select-all/select-all.service.ts", "../../packages/sheets-ui/src/services/shortcut-experience.service.ts", "../../packages/sheets-ui/src/commands/commands/set-selection.command.ts", "../../packages/sheets-ui/src/controllers/utils/component-tools.ts", "../../packages/sheets-ui/src/controllers/render-controllers/scroll.render-controller.ts", "../../packages/sheets-ui/src/commands/operations/scroll.operation.ts", "../../packages/sheets-ui/src/commands/commands/set-scroll.command.ts", "../../packages/sheets-ui/src/controllers/auto-width.controller.ts", "../../packages/sheets-ui/src/commands/commands/set-worksheet-auto-col-width.command.ts", "../../packages/sheets-ui/src/services/editor-bridge.service.ts", "../../packages/sheets-ui/src/controllers/render-controllers/zoom.render-controller.ts", "../../packages/sheets-ui/src/commands/operations/set-zoom-ratio.operation.ts", "../../packages/sheets-ui/src/commands/commands/set-zoom-ratio.command.ts", "../../packages/sheets-ui/src/services/sheet-bar/sheet-bar.service.ts", "../../packages/sheets-ui/src/commands/commands/unhide.command.ts", "../../packages/sheets-ui/src/commands/commands/worksheet-protection.command.ts", "../../packages/sheets-ui/src/commands/operations/activate-cell-edit.operation.ts", "../../packages/sheets-ui/src/commands/operations/cell-edit.operation.ts", "../../packages/sheets-ui/src/commands/operations/rename-sheet.operation.ts", "../../packages/sheets-ui/src/commands/operations/scroll-to-range.operation.ts", "../../packages/sheets-ui/src/commands/operations/sheet-permission-open-dialog.operation.ts", "../../packages/sheets-ui/src/views/defined-name/component-name.ts", "../../packages/sheets-ui/src/commands/operations/sidebar-defined-name.operation.ts", "../../packages/sheets-ui/src/components/border-panel/border-line/icons/BorderDashDot.tsx", "../../packages/sheets-ui/src/components/border-panel/border-line/icons/BorderDashDotDot.tsx", "../../packages/sheets-ui/src/components/border-panel/border-line/icons/BorderDashed.tsx", "../../packages/sheets-ui/src/components/border-panel/border-line/icons/BorderHair.tsx", "../../packages/sheets-ui/src/components/border-panel/border-line/icons/BorderMedium.tsx", "../../packages/sheets-ui/src/components/border-panel/border-line/icons/BorderMediumDashDot.tsx", "../../packages/sheets-ui/src/components/border-panel/border-line/icons/BorderMediumDashDotDot.tsx", "../../packages/sheets-ui/src/components/border-panel/border-line/icons/BorderMediumDashed.tsx", "../../packages/sheets-ui/src/components/border-panel/border-line/icons/BorderThick.tsx", "../../packages/sheets-ui/src/components/border-panel/border-line/icons/BorderThin.tsx", "../../packages/sheets-ui/src/components/border-panel/border-line/BorderLine.tsx", "../../packages/sheets-ui/src/components/const.ts", "../../packages/sheets-ui/src/components/border-panel/interface.ts", "../../packages/sheets-ui/src/components/border-panel/BorderPanel.tsx", "../../packages/sheets-ui/src/components/color-picker/interface.ts", "../../packages/sheets-ui/src/components/font-family/interface.ts", "../../packages/sheets-ui/src/components/font-size/interface.ts", "../../packages/sheets-ui/src/components/menu-item-input/interface.ts", "../../packages/sheets-ui/src/components/menu-item-input/MenuItemInput.tsx", "/Users/zhongjiafeng/Desktop/5000_Project/github/univer/packages/sheets-ui/src/components/menu-item-input/index.module.less", "../../packages/sheets-ui/src/views/defined-name/DefinedNameContainer.tsx", "../../packages/sheets-ui/src/views/defined-name/DefinedNameInput.tsx", "/Users/zhongjiafeng/Desktop/5000_Project/github/univer/packages/sheets-ui/src/views/defined-name/index.module.less", "../../packages/sheets-ui/src/views/sheet-container/SheetContainer.tsx", "../../packages/sheets-ui/src/components/hook.ts", "../../packages/sheets-ui/src/views/auto-fill-popup-menu/AutoFillPopupMenu.tsx", "/Users/zhongjiafeng/Desktop/5000_Project/github/univer/packages/sheets-ui/src/views/count-bar/index.module.less", "../../packages/sheets-ui/src/views/count-bar/ZoomSlider.tsx", "../../packages/sheets-ui/src/views/count-bar/CountBar.tsx", "../../packages/sheets-ui/src/views/editor-container/EditorContainer.tsx", "../../packages/sheets-ui/src/services/editor/cell-editor-manager.service.ts", "../../packages/sheets-ui/src/views/editor-container/hooks.ts", "/Users/zhongjiafeng/Desktop/5000_Project/github/univer/packages/sheets-ui/src/views/editor-container/index.module.less", "../../packages/sheets-ui/src/views/formula-bar/FormulaBar.tsx", "../../packages/sheets-ui/src/services/editor/formula-editor-manager.service.ts", "../../packages/sheets-ui/src/views/defined-name/DefinedName.tsx", "../../packages/sheets-ui/src/views/defined-name/DefinedNameOverlay.tsx", "/Users/zhongjiafeng/Desktop/5000_Project/github/univer/packages/sheets-ui/src/views/formula-bar/index.module.less", "../../packages/sheets-ui/src/views/sheet-bar/SheetBar.tsx", "/Users/zhongjiafeng/Desktop/5000_Project/github/univer/packages/sheets-ui/src/views/sheet-bar/index.module.less", "/Users/zhongjiafeng/Desktop/5000_Project/github/univer/packages/sheets-ui/src/views/sheet-bar/sheet-bar-button/index.module.less", "../../packages/sheets-ui/src/views/sheet-bar/sheet-bar-button/SheetBarButton.tsx", "../../packages/sheets-ui/src/views/sheet-bar/sheet-bar-menu/SheetBarMenu.tsx", "../../packages/sheets-ui/src/views/sheet-bar/sheet-bar-tabs/SheetBarTabs.tsx", "/Users/zhongjiafeng/Desktop/5000_Project/github/univer/packages/sheets-ui/src/views/sheet-bar/sheet-bar-tabs/index.module.less", "../../packages/sheets-ui/src/views/sheet-bar/sheet-bar-tabs/SheetBarItem.tsx", "../../packages/sheets-ui/src/views/sheet-bar/sheet-bar-tabs/utils/animate.ts", "../../packages/sheets-ui/src/views/sheet-bar/sheet-bar-tabs/utils/slide-tab-bar.ts", "../../packages/sheets-ui/src/views/status-bar/StatusBar.tsx", "../../packages/sheets-ui/src/services/status-bar.service.ts", "/Users/zhongjiafeng/Desktop/5000_Project/github/univer/packages/sheets-ui/src/views/status-bar/index.module.less", "../../packages/sheets-ui/src/views/status-bar/CopyableStatisticItem.tsx", "../../packages/sheets-ui/src/controllers/shortcuts/utils.ts", "../../packages/sheets-ui/src/services/clipboard/copy-content-cache.ts", "../../packages/sheets-ui/src/services/clipboard/html-to-usm/parse-node-style.ts", "../../packages/sheets-ui/src/services/clipboard/html-to-usm/utils.ts", "../../packages/sheets-ui/src/services/clipboard/html-to-usm/converter.ts", "../../packages/sheets-ui/src/services/clipboard/html-to-usm/paste-plugins/plugin-lark.ts", "../../packages/sheets-ui/src/services/clipboard/html-to-usm/paste-plugins/plugin-univer.ts", "../../packages/sheets-ui/src/services/clipboard/html-to-usm/paste-plugins/plugin-word.ts", "../../packages/sheets-ui/src/services/clipboard/usm-to-html/convertor.ts", "../../packages/sheets-ui/src/services/clipboard/utils.ts", "../../packages/sheets-ui/src/services/clipboard/clipboard.service.ts", "../../packages/sheets-ui/src/commands/commands/clipboard.command.ts", "../../packages/sheets-ui/src/controllers/menu/menu-util.ts", "../../packages/sheets-ui/src/controllers/menu/border.menu.ts", "../../packages/sheets-ui/src/controllers/menu/clear.menu.ts", "../../packages/sheets-ui/src/controllers/menu/delete.menu.ts", "../../packages/sheets-ui/src/controllers/menu/gridlines.menu.ts", "../../packages/sheets-ui/src/controllers/menu/insert.menu.ts", "../../packages/sheets-ui/src/controllers/menu/menu.ts", "../../packages/sheets-ui/src/controllers/utils/selections-tools.ts", "../../packages/sheets-ui/src/controllers/menu/merge.menu.ts", "../../packages/sheets-ui/src/controllers/menu/permission-menu-util.ts", "../../packages/sheets-ui/src/controllers/menu/permission.menu.ts", "../../packages/sheets-ui/src/controllers/menu/sheet.menu.ts", "../../packages/sheets-ui/src/controllers/menu.schema.ts", "../../packages/sheets-ui/src/controllers/shortcuts/editor.shortcut.ts", "../../packages/sheets-ui/src/controllers/shortcuts/operation.shortcut.ts", "../../packages/sheets-ui/src/controllers/shortcuts/selection.shortcut.ts", "../../packages/sheets-ui/src/controllers/shortcuts/style.shortcut.ts", "../../packages/sheets-ui/src/controllers/shortcuts/value.shortcut.ts", "../../packages/sheets-ui/src/controllers/shortcuts/view.shortcut.ts", "../../packages/sheets-ui/src/controllers/sheet-ui.controller.ts", "../../packages/sheets-ui/src/controllers/active-worksheet/active-worksheet.controller.ts", "../../packages/sheets-ui/src/services/canvas-pop-manager.service.ts", "../../packages/sheets-ui/src/services/cell-alert-manager.service.ts", "/Users/zhongjiafeng/Desktop/5000_Project/github/univer/packages/sheets-ui/src/views/cell-alert/index.module.less", "../../packages/sheets-ui/src/views/cell-alert/CellAlertPopup.tsx", "../../packages/sheets-ui/src/views/cell-alert/index.ts", "../../packages/sheets-ui/src/controllers/cell-alert.controller.ts", "../../packages/sheets-ui/src/controllers/cell-custom-render.controller.ts", "../../packages/sheets-ui/src/views/clipboard/ClipboardPopupMenu.tsx", "/Users/zhongjiafeng/Desktop/5000_Project/github/univer/packages/sheets-ui/src/views/clipboard/index.module.less", "../../packages/sheets-ui/src/controllers/clipboard/const.ts", "../../packages/sheets-ui/src/basics/editor/get-editor-object.ts", "../../packages/sheets-ui/src/services/editor/cell-editor-resize.service.ts", "../../packages/sheets-ui/src/controllers/utils/cell-tools.ts", "../../packages/sheets-ui/src/controllers/utils/char-tools.ts", "../../packages/sheets-ui/src/controllers/editor/utils/is-range-selector.ts", "../../packages/sheets-ui/src/controllers/editor/editing.render-controller.ts", "../../packages/sheets-ui/src/controllers/clipboard/utils.ts", "../../packages/sheets-ui/src/controllers/clipboard/clipboard.controller.ts", "../../packages/sheets-ui/src/services/drag-manager.service.ts", "../../packages/sheets-ui/src/controllers/drag-render.controller.ts", "../../packages/sheets-ui/src/services/utils/doc-skeleton-util.ts", "../../packages/sheets-ui/src/services/hover-manager.service.ts", "../../packages/sheets-ui/src/controllers/force-string-alert-render.controller.ts", "../../packages/sheets-ui/src/controllers/force-string-render.controller.ts", "../../packages/sheets-ui/src/controllers/hover-render.controller.ts", "../../packages/sheets-ui/src/controllers/mark-selection.controller.ts", "../../packages/sheets-ui/src/views/mobile/sheet-bar/MobileSheetBar.tsx", "/Users/zhongjiafeng/Desktop/5000_Project/github/univer/packages/sheets-ui/src/views/mobile/sheet-bar/index.module.less", "../../packages/sheets-ui/src/controllers/mobile/menu.schema.ts", "../../packages/sheets-ui/src/controllers/mobile/mobile-sheet-ui.controller.ts", "../../packages/sheets-ui/src/views/permission/error-msg-dialog/interface.ts", "../../packages/sheets-ui/src/controllers/permission/sheet-permission-check-ui.controller.ts", "../../packages/sheets-ui/src/controllers/render-controllers/freeze.render-controller.ts", "../../packages/sheets-ui/src/controllers/render-controllers/header-move.render-controller.ts", "../../packages/sheets-ui/src/views/header-resize-shape.ts", "../../packages/sheets-ui/src/controllers/render-controllers/header-resize.render-controller.ts", "../../packages/sheets-ui/src/controllers/permission/sheet-permission-interceptor-canvas-render.controller.ts", "../../packages/sheets-ui/src/controllers/permission/sheet-permission-interceptor-clipboard.controller.ts", "../../packages/sheets-ui/src/controllers/status-bar.controller.ts", "../../packages/sheets-ui/src/controllers/permission/sheet-permission-interceptor-formula-render.controller.ts", "../../packages/sheets-ui/src/views/permission/panel-detail/PermissionDetailPanel.tsx", "../../packages/sheets-ui/src/views/permission/util.ts", "/Users/zhongjiafeng/Desktop/5000_Project/github/univer/packages/sheets-ui/src/views/permission/panel-detail/index.module.less", "../../packages/sheets-ui/src/views/permission/panel-detail/PermissionDetailFooterPart.tsx", "../../packages/sheets-ui/src/views/permission/panel-detail/PermissionDetailMainPart.tsx", "../../packages/sheets-ui/src/views/permission/panel-list/index.tsx", "../../packages/sheets-ui/src/hooks/use-highlight-range.ts", "../../packages/sheets-ui/src/views/permission/panel-list/constant.ts", "/Users/zhongjiafeng/Desktop/5000_Project/github/univer/packages/sheets-ui/src/views/permission/panel-list/index.module.less", "../../packages/sheets-ui/src/views/permission/panel/index.tsx", "../../packages/sheets-ui/src/views/permission/permission-dialog/index.tsx", "/Users/zhongjiafeng/Desktop/5000_Project/github/univer/packages/sheets-ui/src/views/permission/spin/index.module.less", "../../packages/sheets-ui/src/views/permission/spin/index.tsx", "/Users/zhongjiafeng/Desktop/5000_Project/github/univer/packages/sheets-ui/src/views/permission/permission-dialog/index.module.less", "../../packages/sheets-ui/src/views/permission/user-dialog/index.tsx", "../../packages/sheets-ui/src/views/permission/user-dialog/constant.ts", "/Users/zhongjiafeng/Desktop/5000_Project/github/univer/packages/sheets-ui/src/views/permission/user-dialog/index.module.less", "/Users/zhongjiafeng/Desktop/5000_Project/github/univer/packages/sheets-ui/src/views/permission/error-msg-dialog/index.module.less", "../../packages/sheets-ui/src/views/permission/error-msg-dialog/index.tsx", "../../packages/sheets-ui/src/views/permission/extensions/protect-background-img.ts", "../../packages/sheets-ui/src/views/permission/extensions/range-protection.render.ts", "../../packages/sheets-ui/src/views/permission/extensions/worksheet-permission.render.ts", "../../packages/sheets-ui/src/views/permission/panel-detail/PermissionDetailUserPart.tsx", "../../packages/sheets-ui/src/controllers/permission/sheet-permission-render.controller.ts", "../../packages/sheets-ui/src/controllers/render-controllers/format-painter.render-controller.ts", "../../packages/sheets-ui/src/controllers/render-controllers/mobile/mobile-contextmenu.render-controller.ts", "../../packages/sheets-ui/src/controllers/render-controllers/mobile/mobile-scroll.render-controller.ts", "../../packages/telemetry/src/services/telemetry-service.ts", "../../packages/sheets-ui/src/services/sheets-render.service.ts", "../../packages/sheets-ui/src/controllers/render-controllers/sheet.render-controller.ts", "../../packages/sheets-ui/src/services/print-interceptor.service.ts", "../../packages/sheets-ui/src/services/selection/mobile-selection-shape.ts", "../../packages/sheets-ui/src/services/selection/mobile-selection-render.service.ts", "../../packages/sheets-ui/src/mobile-plugin.ts", "../../packages/sheets-ui/src/controllers/auto-fill.controller.ts", "../../packages/sheets-ui/src/controllers/checkbox.controller.ts", "../../packages/sheets-ui/src/controllers/defined-name/defined-name.controller.ts", "../../packages/sheets-ui/src/controllers/editor/formula-editor.controller.ts", "../../packages/sheets-ui/src/controllers/editor/data-sync.controller.ts", "../../packages/sheets-ui/src/controllers/format-painter/format-painter.controller.ts", "../../packages/sheets-ui/src/controllers/move-range.controller.ts", "../../packages/sheets-ui/src/controllers/permission/sheet-permission-init-ui.controller.ts", "../../packages/sheets-ui/src/controllers/render-controllers/clipboard.render-controller.ts", "../../packages/sheets-ui/src/controllers/render-controllers/contextmenu.render-controller.ts", "../../packages/sheets-ui/src/controllers/render-controllers/editor-bridge.render-controller.ts", "../../packages/sheets-ui/src/views/header-menu-shape.ts", "../../packages/sheets-ui/src/controllers/render-controllers/header-menu.render-controller.ts", "../../packages/sheets-ui/src/views/header-unhide-shape.ts", "../../packages/sheets-ui/src/controllers/render-controllers/header-unhide.render-controller.ts", "../../packages/sheets-ui/src/controllers/render-controllers/skeleton.render-controller.ts", "../../packages/sheets-ui/src/services/selection/selection-render.service.ts", "../../packages/sheets-ui/src/plugin.ts", "../../packages/sheets-ui/src/controllers/editor/utils/is-embedding-formula-editor.ts", "../../packages/sheets-ui/src/services/utils/drawing-position-util.ts"],
  "sourcesContent": ["/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICellData, IMutationInfo, IPosition, IRange, Nullable, Workbook, Worksheet } from '@univerjs/core';\nimport type { IBoundRectNoAngle, IRender, Scene, SpreadsheetSkeleton } from '@univerjs/engine-render';\nimport type { ICollaborator } from '@univerjs/protocol';\nimport type { ISetRangeValuesMutationParams, ISheetLocation } from '@univerjs/sheets';\nimport type { ISheetSkeletonManagerParam } from '../services/sheet-skeleton-manager.service';\nimport { CellModeEnum, ObjectMatrix } from '@univerjs/core';\nimport { SHEET_VIEWPORT_KEY, Vector2 } from '@univerjs/engine-render';\nimport { SetRangeValuesMutation, SetRangeValuesUndoMutationFactory } from '@univerjs/sheets';\n\nexport function getUserListEqual(userList1: ICollaborator[], userList2: ICollaborator[]) {\n    if (userList1.length !== userList2.length) return false;\n\n    const sorted1 = userList1.sort((a, b) => a.id.localeCompare(b.id));\n    const sorted2 = userList2.sort((a, b) => a.id.localeCompare(b.id));\n\n    return sorted1.every((user, index) => {\n        return user.subject?.userID === sorted2[index].subject?.userID && user.role === sorted2[index].role;\n    });\n}\n\nexport function checkCellContentInRanges(worksheet: Worksheet, ranges: IRange[]): boolean {\n    return ranges.some((range) => checkCellContentInRange(worksheet, range));\n}\n\nexport function checkCellContentInRange(worksheet: Worksheet, range: IRange): boolean {\n    const { startRow, startColumn, endColumn, endRow } = range;\n    const cellMatrix = worksheet.getMatrixWithMergedCells(startRow, startColumn, endRow, endColumn);\n\n    let someCellGoingToBeRemoved = false;\n    cellMatrix.forValue((row, col, cellData) => {\n        if (cellData && (row !== startRow || col !== startColumn) && worksheet.cellHasValue(cellData)) {\n            someCellGoingToBeRemoved = true;\n            return false;\n        }\n    });\n    return someCellGoingToBeRemoved;\n}\n\nexport function getClearContentMutationParamsForRanges(\n    accessor: IAccessor,\n    unitId: string,\n    worksheet: Worksheet,\n    ranges: IRange[]\n): { undos: IMutationInfo[]; redos: IMutationInfo[] } {\n    const undos: IMutationInfo[] = [];\n    const redos: IMutationInfo[] = [];\n\n    const subUnitId = worksheet.getSheetId();\n\n    // Use the following file as a reference.\n    // packages/sheets/src/commands/commands/clear-selection-all.command.ts\n    // packages/sheets/src/commands/mutations/set-range-values.mutation.ts\n    ranges.forEach((range) => {\n        const redoMatrix = getClearContentMutationParamForRange(worksheet, range);\n        const redoMutationParams: ISetRangeValuesMutationParams = {\n            unitId,\n            subUnitId,\n            cellValue: redoMatrix.getData(),\n        };\n        const undoMutationParams: ISetRangeValuesMutationParams = SetRangeValuesUndoMutationFactory(\n            accessor,\n            redoMutationParams\n        );\n\n        undos.push({ id: SetRangeValuesMutation.id, params: undoMutationParams });\n        redos.push({ id: SetRangeValuesMutation.id, params: redoMutationParams });\n    });\n\n    return {\n        undos,\n        redos,\n    };\n}\n\nexport function getClearContentMutationParamForRange(worksheet: Worksheet, range: IRange): ObjectMatrix<Nullable<ICellData>> {\n    const { startRow, startColumn, endColumn, endRow } = range;\n    const cellMatrix = worksheet.getMatrixWithMergedCells(startRow, startColumn, endRow, endColumn, CellModeEnum.Intercepted);\n    const redoMatrix = new ObjectMatrix<Nullable<ICellData>>();\n    let leftTopCellValue: Nullable<ICellData> = null;\n    cellMatrix.forValue((row, col, cellData) => {\n        if (cellData && row >= startRow && col >= startColumn) {\n            if (!leftTopCellValue && worksheet.cellHasValue(cellData) && (cellData.v !== '' || (cellData.p?.body?.dataStream?.length ?? 0) > 2)) {\n                leftTopCellValue = cellData;\n            }\n            redoMatrix.setValue(row, col, null);\n        }\n    });\n    redoMatrix.setValue(startRow, startColumn, leftTopCellValue);\n\n    return redoMatrix;\n}\n\nexport function getCellIndexByOffsetWithMerge(offsetX: number, offsetY: number, scene: Scene, skeleton: SpreadsheetSkeleton) {\n    const activeViewport = scene.getActiveViewportByCoord(\n        Vector2.FromArray([offsetX, offsetY])\n    );\n\n    if (!activeViewport) {\n        return;\n    }\n\n    const { scaleX, scaleY } = scene.getAncestorScale();\n\n    const scrollXY = {\n        x: activeViewport.viewportScrollX,\n        y: activeViewport.viewportScrollY,\n    };\n\n    const cellIndex = skeleton.getCellIndexByOffset(offsetX, offsetY, scaleX, scaleY, scrollXY);\n\n    // const mergeCell = skeleton.mergeData.find((range) => {\n    //     const { startColumn, startRow, endColumn, endRow } = range;\n    //     return cellPos.row >= startRow && cellPos.column >= startColumn && cellPos.row <= endRow && cellPos.column <= endColumn;\n    // });\n    const mergeCell = skeleton.worksheet.getMergedCell(cellIndex.row, cellIndex.column);\n\n    const params = {\n        actualRow: mergeCell ? mergeCell.startRow : cellIndex.row,\n        actualCol: mergeCell ? mergeCell.startColumn : cellIndex.column,\n        mergeCell,\n        row: cellIndex.row,\n        col: cellIndex.column,\n    };\n\n    return params;\n}\n\nexport function getViewportByCell(row: number, column: number, scene: Scene, worksheet: Worksheet) {\n    const freeze = worksheet.getFreeze();\n    if (!freeze || (freeze.startRow <= 0 && freeze.startColumn <= 0)) {\n        return scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n    }\n\n    if (row >= freeze.startRow && column >= freeze.startColumn) {\n        return scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n    }\n\n    if (row < freeze.startRow && column < freeze.startColumn) {\n        return scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP);\n    }\n\n    if (row < freeze.startRow && column >= freeze.startColumn) {\n        return scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP);\n    }\n\n    if (row >= freeze.startRow && column < freeze.startColumn) {\n        return scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT);\n    }\n}\n\nexport function transformBound2OffsetBound(originBound: IBoundRectNoAngle, scene: Scene, skeleton: SpreadsheetSkeleton, worksheet: Worksheet): IBoundRectNoAngle {\n    const topLeft = transformPosition2Offset(originBound.left, originBound.top, scene, skeleton, worksheet);\n    const bottomRight = transformPosition2Offset(originBound.right, originBound.bottom, scene, skeleton, worksheet);\n\n    return {\n        left: topLeft.x,\n        top: topLeft.y,\n        right: bottomRight.x,\n        bottom: bottomRight.y,\n    };\n}\n\nexport function transformPosition2Offset(x: number, y: number, scene: Scene, skeleton: SpreadsheetSkeleton, worksheet: Worksheet) {\n    const { scaleX, scaleY } = scene.getAncestorScale();\n    const viewMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n    if (!viewMain) {\n        return {\n            x,\n            y,\n        };\n    }\n    const freeze = worksheet.getFreeze();\n    const { startColumn, startRow, xSplit, ySplit } = freeze;\n    // freeze start\n    const startSheetView = skeleton.getNoMergeCellWithCoordByIndex(startRow - ySplit, startColumn - xSplit, false);\n    // freeze end\n    const endSheetView = skeleton.getNoMergeCellWithCoordByIndex(startRow, startColumn, false);\n    const { rowHeaderWidth, columnHeaderHeight } = skeleton;\n    const freezeWidth = endSheetView.startX - startSheetView.startX;\n    const freezeHeight = endSheetView.startY - startSheetView.startY;\n\n    const { top, left, viewportScrollX, viewportScrollY } = viewMain;\n    let offsetX: number;\n    // viewMain or viewTop\n    if (x > left) {\n        offsetX = (x - viewportScrollX) * scaleX;\n    } else {\n        offsetX = ((freezeWidth + rowHeaderWidth) - (left - x)) * scaleX;\n    }\n\n    let offsetY: number;\n    if (y > top) {\n        offsetY = (y - viewportScrollY) * scaleY;\n    } else {\n        offsetY = ((freezeHeight + columnHeaderHeight) - (top - y)) * scaleX;\n    }\n\n    return {\n        x: offsetX,\n        y: offsetY,\n    };\n}\n\nexport function getCellRealRange(workbook: Workbook, worksheet: Worksheet, skeleton: SpreadsheetSkeleton, row: number, col: number) {\n    let actualRow = row;\n    let actualCol = col;\n\n    skeleton.overflowCache.forValue((r, c, range) => {\n        if (range.startRow <= actualRow && range.endRow >= actualRow && range.startColumn <= actualCol && range.endColumn >= actualCol) {\n            actualCol = c;\n            actualRow = r;\n        }\n    });\n\n    const actualCell = skeleton.getCellWithCoordByIndex(actualRow, actualCol);\n\n    const location: ISheetLocation = {\n        unitId: workbook.getUnitId(),\n        subUnitId: worksheet.getSheetId(),\n        workbook,\n        worksheet,\n        row: actualCell.actualRow,\n        col: actualCell.actualColumn,\n    };\n\n    return location;\n}\n\nexport function getHoverCellPosition(currentRender: IRender, workbook: Workbook, worksheet: Worksheet, skeletonParam: ISheetSkeletonManagerParam, offsetX: number, offsetY: number) {\n    const { scene } = currentRender;\n\n    const unitId = workbook.getUnitId();\n    const { skeleton, sheetId } = skeletonParam;\n\n    const cellIndex = getCellIndexByOffsetWithMerge(offsetX, offsetY, scene, skeleton);\n\n    if (!cellIndex) {\n        return null;\n    }\n\n    let { actualCol, actualRow } = cellIndex;\n    const originLocation = {\n        unitId,\n        subUnitId: sheetId,\n        workbook,\n        worksheet,\n        row: actualRow,\n        col: actualCol,\n    };\n\n    skeleton.overflowCache.forValue((r, c, range) => {\n        if (range.startRow <= actualRow && range.endRow >= actualRow && range.startColumn <= actualCol && range.endColumn >= actualCol) {\n            actualCol = c;\n            actualRow = r;\n        }\n    });\n\n    const actualCell = skeleton.getCellWithCoordByIndex(actualRow, actualCol);\n    const location: ISheetLocation = getCellRealRange(workbook, worksheet, skeleton, actualRow, actualCol);\n    let anchorCell: IRange;\n    if (actualCell.mergeInfo) {\n        anchorCell = actualCell.mergeInfo;\n    } else {\n        anchorCell = {\n            startRow: location.row,\n            endRow: location.row,\n            startColumn: location.col,\n            endColumn: location.col,\n        };\n    }\n\n    const activeViewport = scene.getActiveViewportByCoord(\n        Vector2.FromArray([offsetX, offsetY])\n    );\n\n    if (!activeViewport) {\n        return;\n    }\n\n    const { scaleX, scaleY } = scene.getAncestorScale();\n\n    const scrollXY = {\n        x: activeViewport.viewportScrollX,\n        y: activeViewport.viewportScrollY,\n    };\n\n    const position: IPosition = {\n        startX: (skeleton.getOffsetByColumn(anchorCell.startColumn - 1) - scrollXY.x) * scaleX,\n        endX: (skeleton.getOffsetByColumn(anchorCell.endColumn) - scrollXY.x) * scaleX,\n        startY: (skeleton.getOffsetByRow(anchorCell.startRow - 1) - scrollXY.y) * scaleY,\n        endY: (skeleton.getOffsetByRow(anchorCell.endRow) - scrollXY.y) * scaleY,\n    };\n\n    return {\n        position,\n        location: originLocation,\n        overflowLocation: location,\n    };\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellData, IRange, ISelection, ISelectionCell, Nullable, ObjectMatrix, Worksheet } from '@univerjs/core';\nimport { Direction, getReverseDirection, RANGE_TYPE, Rectangle } from '@univerjs/core';\nimport { alignToMergedCellsBorders } from '@univerjs/sheets';\n\nexport enum MergeType {\n    MergeAll = 'mergeAll',\n    MergeVertical = 'mergeVertical',\n    MergeHorizontal = 'mergeHorizontal',\n}\n\nexport interface IExpandParams {\n    left?: boolean;\n    right?: boolean;\n    up?: boolean;\n    down?: boolean;\n}\n\n// TODO@wzhudev: methods in this file should use `worksheet.getCell()` instead of using raw data\n\nexport function findNextRange(\n    startRange: IRange,\n    direction: Direction,\n    worksheet: Worksheet,\n    boundary?: IRange,\n    isFindNext: boolean = true,\n    nextStep: number = 1,\n    isGoBack: boolean = true\n): IRange {\n    let destRange: IRange = { ...startRange };\n\n    /**\n     * Set the boundaries for moving the selection area.\n     * Here you can customize the boundaries to implement the ability to move the primary within the selection area.\n     */\n    if (boundary == null) {\n        boundary = {\n            startRow: 0,\n            endRow: worksheet.getRowCount() - 1,\n            startColumn: 0,\n            endColumn: worksheet.getColumnCount() - 1,\n        };\n    }\n\n    let next: number;\n    switch (direction) {\n        case Direction.UP:\n            next = startRange.startRow - nextStep;\n            while (next > -1 && !worksheet.getRowVisible(next)) {\n                next -= 1;\n            }\n            if (next >= boundary.startRow) {\n                destRange.startRow = next;\n                destRange.endRow = next;\n            } else if (isGoBack) {\n                destRange.startRow = boundary.endRow;\n                destRange.endRow = boundary.endRow;\n\n                if (isFindNext) {\n                    destRange = findNextRange(destRange, Direction.LEFT, worksheet, boundary, false);\n                }\n            }\n            break;\n        case Direction.DOWN:\n            next = startRange.endRow + nextStep;\n            while (next < worksheet.getRowCount() && !worksheet.getRowVisible(next)) {\n                next += 1;\n            }\n            if (next <= boundary.endRow) {\n                destRange.startRow = next;\n                destRange.endRow = next;\n            } else if (isGoBack) {\n                destRange.startRow = boundary.startRow;\n                destRange.endRow = boundary.startRow;\n\n                if (isFindNext) {\n                    destRange = findNextRange(destRange, Direction.RIGHT, worksheet, boundary, false);\n                }\n            }\n            break;\n        case Direction.LEFT:\n            next = startRange.startColumn - nextStep;\n            while (next > -1 && !worksheet.getColVisible(next)) {\n                next -= 1;\n            }\n            if (next >= boundary.startColumn) {\n                destRange.startColumn = next;\n                destRange.endColumn = next;\n            } else if (isGoBack) {\n                destRange.startColumn = boundary.endColumn;\n                destRange.endColumn = boundary.endColumn;\n\n                if (isFindNext) {\n                    destRange = findNextRange(destRange, Direction.UP, worksheet, boundary, false);\n                }\n            }\n            break;\n        case Direction.RIGHT:\n            next = startRange.endColumn + nextStep;\n            while (next < worksheet.getColumnCount() && !worksheet.getColVisible(next)) {\n                next += 1;\n            }\n            if (next <= boundary.endColumn) {\n                destRange.startColumn = next;\n                destRange.endColumn = next;\n            } else if (isGoBack) {\n                destRange.startColumn = boundary.startColumn;\n                destRange.endColumn = boundary.startColumn;\n\n                if (isFindNext) {\n                    destRange = findNextRange(destRange, Direction.DOWN, worksheet, boundary, false);\n                }\n            }\n            break;\n        default:\n            break;\n    }\n\n    return destRange;\n}\n\nexport function findNextGapRange(startRange: IRange, direction: Direction, worksheet: Worksheet): IRange {\n    const destRange = { ...startRange };\n    const { startRow, startColumn, endRow, endColumn } = getEdgeOfRange(startRange, direction, worksheet);\n\n    let currentPositionHasValue = rangeHasValue(worksheet, startRow, startColumn, endRow, endColumn).hasValue;\n    let firstMove = true;\n    let shouldContinue = true;\n\n    while (shouldContinue) {\n        if (Direction.UP === direction) {\n            let next = destRange.startRow - 1;\n            while (next > -1 && !worksheet.getRowVisible(next)) {\n                next -= 1;\n            }\n            if (next === -1) {\n                shouldContinue = false;\n                break;\n            }\n\n            const { hasValue: nextRangeHasValue, matrix } = rangeHasValue(\n                worksheet,\n                next,\n                destRange.startColumn,\n                next,\n                destRange.endColumn\n            );\n\n            if (currentPositionHasValue && !nextRangeHasValue && !firstMove) {\n                shouldContinue = false;\n                break;\n            } else {\n                if (matrix.getLength() !== 0) {\n                    // update searching ranges\n                    let min = next;\n                    matrix.forValue((row) => {\n                        min = Math.min(row, min);\n                    });\n                    destRange.startRow = min;\n                } else {\n                    destRange.startRow = next;\n                }\n\n                destRange.endRow = destRange.startRow;\n\n                if (!currentPositionHasValue && nextRangeHasValue) {\n                    shouldContinue = false;\n                    break;\n                }\n\n                currentPositionHasValue = nextRangeHasValue;\n                firstMove = false;\n            }\n        }\n\n        if (Direction.DOWN === direction) {\n            let next = destRange.endRow + 1;\n            while (next < worksheet.getRowCount() && !worksheet.getRowVisible(next)) {\n                next += 1;\n            }\n            if (next === worksheet.getRowCount()) {\n                shouldContinue = false;\n                break;\n            }\n\n            const { hasValue: nextRangeHasValue, matrix } = rangeHasValue(\n                worksheet,\n                next,\n                destRange.startColumn,\n                next,\n                destRange.endColumn\n            );\n\n            if (currentPositionHasValue && !nextRangeHasValue && !firstMove) {\n                shouldContinue = false;\n                break;\n            } else {\n                if (matrix.getLength() !== 0) {\n                    let max = next;\n                    matrix.forValue((row, _, value) => {\n                        max = Math.max(row + (value.rowSpan || 1) - 1, max);\n                    });\n                    destRange.endRow = max;\n                } else {\n                    destRange.endRow = next;\n                }\n\n                destRange.startRow = destRange.endRow;\n\n                if (!currentPositionHasValue && nextRangeHasValue) {\n                    shouldContinue = false;\n                    break;\n                }\n\n                currentPositionHasValue = nextRangeHasValue;\n                firstMove = false;\n            }\n        }\n\n        if (Direction.LEFT === direction) {\n            let next = destRange.startColumn - 1;\n            while (next > -1 && !worksheet.getColVisible(next)) {\n                next -= 1;\n            }\n            if (next === -1) {\n                shouldContinue = false;\n                break;\n            }\n\n            const { hasValue: nextRangeHasValue, matrix } = rangeHasValue(\n                worksheet,\n                destRange.startRow,\n                next,\n                destRange.endRow,\n                next\n            );\n\n            if (currentPositionHasValue && !nextRangeHasValue && !firstMove) {\n                shouldContinue = false;\n                break;\n            } else {\n                if (matrix.getLength() !== 0) {\n                    let min = next;\n                    matrix.forValue((_, col) => {\n                        min = Math.min(col, min);\n                    });\n                    destRange.startColumn = min;\n                } else {\n                    destRange.startColumn = next;\n                }\n\n                destRange.endColumn = destRange.startColumn;\n\n                if (!currentPositionHasValue && nextRangeHasValue) {\n                    shouldContinue = false;\n                    break;\n                }\n\n                currentPositionHasValue = nextRangeHasValue;\n                firstMove = false;\n            }\n        }\n\n        if (Direction.RIGHT === direction) {\n            let next = destRange.endColumn + 1;\n            while (next < worksheet.getColumnCount() && !worksheet.getColVisible(next)) {\n                next += 1;\n            }\n\n            if (next === worksheet.getColumnCount()) {\n                shouldContinue = false;\n                break;\n            }\n\n            const { hasValue: nextRangeHasValue, matrix } = rangeHasValue(\n                worksheet,\n                destRange.startRow,\n                next,\n                destRange.endRow,\n                next\n            );\n\n            if (currentPositionHasValue && !nextRangeHasValue && !firstMove) {\n                shouldContinue = false;\n                break;\n            } else {\n                if (matrix.getLength() !== 0) {\n                    let max = next;\n                    matrix.forValue((_, col, value) => {\n                        max = Math.max(col + (value.colSpan || 1) - 1, max);\n                    });\n                    destRange.endColumn = max;\n                } else {\n                    destRange.endColumn = next;\n                }\n\n                destRange.startColumn = destRange.endColumn;\n\n                if (!currentPositionHasValue && nextRangeHasValue) {\n                    shouldContinue = false;\n                    break;\n                }\n\n                currentPositionHasValue = nextRangeHasValue;\n                firstMove = false;\n            }\n        }\n    }\n\n    return alignToMergedCellsBorders(destRange, worksheet, true);\n}\n\nexport function findNextRangeExpand(startRange: IRange, direction: Direction, worksheet: Worksheet): IRange {\n    return findNextRange(startRange, direction, worksheet, undefined, false, 1, false);\n}\n\nexport function expandToNextGapRange(startRange: IRange, direction: Direction, worksheet: Worksheet): IRange {\n    const next = findNextGapRange(startRange, direction, worksheet);\n    return alignToMergedCellsBorders(Rectangle.union(next, startRange), worksheet, true);\n}\n\nexport function expandToNextCell(startRange: IRange, direction: Direction, worksheet: Worksheet): IRange {\n    const next = findNextRangeExpand(startRange, direction, worksheet);\n    const destRange: IRange = {\n        startRow: Math.min(startRange.startRow, next.startRow),\n        startColumn: Math.min(startRange.startColumn, next.startColumn),\n        endRow: Math.max(startRange.endRow, next.endRow),\n        endColumn: Math.max(startRange.endColumn, next.endColumn),\n    };\n\n    return alignToMergedCellsBorders(Rectangle.union(startRange, destRange), worksheet);\n}\n\n/**\n * This function is considered as a reversed operation of `expandToNextGapCell` but there are slightly differences.\n * @param startRange\n * @param direction\n * @param worksheet\n */\nexport function shrinkToNextGapRange(\n    startRange: IRange,\n    anchorRange: IRange,\n    direction: Direction,\n    worksheet: Worksheet\n): IRange {\n    // use `moveToNextGapCell` reversely to get the next going to cell\n    const reversedDirection = getReverseDirection(direction);\n    const nextGap = findNextGapRange(getEdgeOfRange(startRange, reversedDirection, worksheet), direction, worksheet);\n\n    // if next exceed the startRange we should just expand anchorRange with\n    if (direction === Direction.UP && nextGap.startRow <= startRange.startRow) {\n        return alignToMergedCellsBorders(\n            { ...anchorRange, startColumn: startRange.startColumn, endColumn: startRange.endColumn },\n            worksheet,\n            true\n        );\n    }\n    if (direction === Direction.DOWN && nextGap.endRow >= startRange.endRow) {\n        return alignToMergedCellsBorders(\n            { ...anchorRange, startColumn: startRange.startColumn, endColumn: startRange.endColumn },\n            worksheet,\n            true\n        );\n    }\n    if (direction === Direction.LEFT && nextGap.startColumn <= startRange.startColumn) {\n        return alignToMergedCellsBorders(\n            { ...anchorRange, startRow: startRange.startRow, endRow: startRange.endRow },\n            worksheet,\n            true\n        );\n    }\n    if (direction === Direction.RIGHT && nextGap.endColumn >= startRange.endColumn) {\n        return alignToMergedCellsBorders(\n            { ...anchorRange, startRow: startRange.startRow, endRow: startRange.endRow },\n            worksheet,\n            true\n        );\n    }\n    return Rectangle.union(Rectangle.clone(anchorRange), nextGap);\n}\n\n/**\n * This function is considered as a reversed operation of `expandToNextCell` but there are some slightly differences.\n * @param startRange\n * @param direction\n * @param worksheet\n */\nexport function shrinkToNextCell(startRange: IRange, direction: Direction, worksheet: Worksheet): IRange {\n    // use `moveToNextCell` reversely to get the next going to range\n    const reversedDirection = getReverseDirection(direction);\n    const shrinkFromEdge = getEdgeOfRange(startRange, reversedDirection, worksheet);\n    const otherEdge = getEdgeOfRange(startRange, direction, worksheet);\n    const next = findNextRangeExpand(shrinkFromEdge, direction, worksheet);\n    return alignToMergedCellsBorders(Rectangle.union(otherEdge, next), worksheet, false);\n}\n\nexport function expandToWholeSheet(worksheet: Worksheet): IRange {\n    // DEBT: RANGE_TYPE.ALL should not use startRow, startColumn, endRow, endColumn\n    return {\n        startRow: 0,\n        startColumn: 0,\n        endRow: worksheet.getRowCount() - 1,\n        endColumn: worksheet.getColumnCount() - 1,\n        rangeType: RANGE_TYPE.ALL,\n    };\n}\n\nfunction getEdgeOfRange(startRange: IRange, direction: Direction, worksheet: Worksheet): IRange {\n    let destRange: IRange;\n    switch (direction) {\n        case Direction.UP:\n            destRange = {\n                startRow: startRange.startRow,\n                startColumn: startRange.startColumn,\n                endRow: startRange.startRow,\n                endColumn: startRange.endColumn,\n                rangeType: RANGE_TYPE.NORMAL,\n            };\n\n            break;\n        case Direction.DOWN:\n            destRange = {\n                startRow: startRange.endRow,\n                startColumn: startRange.startColumn,\n                endRow: startRange.endRow,\n                endColumn: startRange.endColumn,\n                rangeType: RANGE_TYPE.NORMAL,\n            };\n            break;\n        case Direction.LEFT:\n            destRange = {\n                startRow: startRange.startRow,\n                startColumn: startRange.startColumn,\n                endRow: startRange.endRow,\n                endColumn: startRange.startColumn,\n                rangeType: RANGE_TYPE.NORMAL,\n            };\n            break;\n        case Direction.RIGHT:\n            destRange = {\n                startRow: startRange.startRow,\n                startColumn: startRange.endColumn,\n                endRow: startRange.endRow,\n                endColumn: startRange.endColumn,\n                rangeType: RANGE_TYPE.NORMAL,\n            };\n            break;\n        default:\n            throw new Error('Invalid direction');\n    }\n\n    return alignToMergedCellsBorders(destRange, worksheet, false);\n}\n\nfunction rangeHasValue(\n    worksheet: Worksheet,\n    row: number,\n    col: number,\n    rowEnd: number,\n    colEnd: number\n): { hasValue: boolean; matrix: ObjectMatrix<ICellData & { rowSpan?: number; colSpan?: number }> } {\n    let hasValue = false;\n\n    const matrix = worksheet.getMatrixWithMergedCells(row, col, rowEnd, colEnd).forValue((_, __, value) => {\n        if (cellHasValue(value)) {\n            hasValue = true;\n            return false; // stop looping\n        }\n    });\n\n    return {\n        hasValue,\n        matrix,\n    };\n}\n\nexport function getStartRange(range: IRange, primary: Nullable<ISelectionCell>, direction: Direction): IRange {\n    const ret = Rectangle.clone(range);\n\n    if (primary == null) {\n        return ret;\n    }\n\n    switch (direction) {\n        case Direction.UP:\n        case Direction.DOWN:\n            ret.startColumn = ret.endColumn = primary.actualColumn;\n            break;\n        case Direction.LEFT:\n        case Direction.RIGHT:\n            ret.startRow = ret.endRow = primary.actualRow;\n            break;\n    }\n\n    return ret;\n}\n\nexport function checkIfShrink(selection: ISelection, direction: Direction, worksheet: Worksheet): boolean {\n    const { primary, range } = selection;\n\n    const startRange: IRange = Rectangle.clone(range);\n    switch (direction) {\n        case Direction.UP:\n        case Direction.DOWN:\n            startRange.startRow = primary?.startRow ?? range.startRow;\n            startRange.endRow = primary?.endRow ?? range.startRow;\n            break;\n        case Direction.LEFT:\n        case Direction.RIGHT:\n            startRange.startColumn = primary?.startColumn ?? range.startColumn;\n            startRange.endColumn = primary?.endColumn ?? range.startColumn;\n            break;\n    }\n\n    const anchorRange = getEdgeOfRange(startRange, direction, worksheet);\n    switch (direction) {\n        case Direction.DOWN:\n            return range.startRow < anchorRange.startRow;\n        case Direction.UP:\n            return range.endRow > anchorRange.endRow;\n        case Direction.LEFT:\n            return anchorRange.endColumn < range.endColumn;\n        case Direction.RIGHT:\n            return anchorRange.startColumn > range.startColumn;\n    }\n}\n\n/**\n * Determine whether the entire row is selected\n * @param allRowRanges Range of all rows\n * @param ranges Range of selected rows\n * @returns Whether the entire row is selected\n */\nexport function isAllRowsCovered(allRowRanges: IRange[], ranges: IRange[]): boolean {\n    // Find the minimum start point and maximum end point in all row ranges\n    let start = allRowRanges[0].startRow;\n    let end = allRowRanges[0].endRow;\n    allRowRanges.forEach((range) => {\n        const { startRow, endRow } = range;\n        start = Math.min(start, startRow);\n        end = Math.max(end, endRow);\n    });\n\n    const covered = new Array(end - start + 1).fill(false);\n\n    // Mark true in ranges\n    ranges.forEach((range) => {\n        const { startRow, endRow } = range;\n        for (let i = Math.max(startRow, start); i <= Math.min(endRow, end); i++) {\n            covered[i - start] = true;\n        }\n    });\n\n    // Check if every range in allRowRanges is covered\n    return allRowRanges.every((range) => {\n        const { startRow, endRow } = range;\n        for (let i = startRow; i <= endRow; i++) {\n            if (!covered[i - start]) {\n                return false;\n            }\n        }\n        return true;\n    });\n}\n\n/**\n * Determine whether the entire column is selected\n * @param allColumnRanges Range of all columns\n * @param ranges Range of selected columns\n * @returns Whether the entire column is selected\n */\nexport function isAllColumnsCovered(allColumnRanges: IRange[], ranges: IRange[]): boolean {\n    // Find the minimum start point and maximum end point in all column ranges\n    let start = allColumnRanges[0].startColumn;\n    let end = allColumnRanges[0].endColumn;\n    allColumnRanges.forEach((range) => {\n        const { startColumn, endColumn } = range;\n        start = Math.min(start, startColumn);\n        end = Math.max(end, endColumn);\n    });\n\n    const covered = new Array(end - start + 1).fill(false);\n\n    // Mark true in ranges\n    ranges.forEach((range) => {\n        const { startColumn, endColumn } = range;\n        for (let i = Math.max(startColumn, start); i <= Math.min(endColumn, end); i++) {\n            covered[i - start] = true;\n        }\n    });\n\n    // Check if every range in allColumnRanges is covered\n    return allColumnRanges.every((range) => {\n        const { startColumn, endColumn } = range;\n        for (let i = startColumn; i <= endColumn; i++) {\n            if (!covered[i - start]) {\n                return false;\n            }\n        }\n        return true;\n    });\n}\n\nexport function getMergeableSelectionsByType(type: MergeType, selections: Nullable<IRange[]>): Nullable<IRange[]> {\n    if (!selections) return null;\n    if (type === MergeType.MergeAll) {\n        return selections.filter((selection) => {\n            if (selection.startRow === selection.endRow && selection.startColumn === selection.endColumn) {\n                return false;\n            }\n            return true;\n        });\n    } else if (type === MergeType.MergeVertical) {\n        return selections.filter((selection) => {\n            if (selection.startRow === selection.endRow) {\n                return false;\n            }\n            return true;\n        });\n    } else if (type === MergeType.MergeHorizontal) {\n        return selections.filter((selection) => {\n            if (selection.startColumn === selection.endColumn) {\n                return false;\n            }\n            return true;\n        });\n    }\n\n    return selections;\n}\n\nfunction cellHasValue(cell: ICellData): boolean {\n    return (cell.v !== undefined && cell.v !== null && cell.v !== '') || cell.p !== undefined;\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-lines-per-function */\n\nimport type { IAccessor, ICommand, IMutationInfo, IRange, Workbook } from '@univerjs/core';\nimport type { IAddWorksheetMergeMutationParams, IRemoveWorksheetMergeMutationParams } from '@univerjs/sheets';\nimport {\n    CommandType,\n    Dimension,\n    ICommandService,\n    IUndoRedoService,\n    IUniverInstanceService,\n    LocaleService,\n    sequenceExecute,\n    Tools,\n    UniverInstanceType,\n} from '@univerjs/core';\nimport {\n    AddMergeRedoSelectionsOperationFactory,\n    AddMergeUndoMutationFactory,\n    AddMergeUndoSelectionsOperationFactory,\n    AddWorksheetMergeMutation,\n    getAddMergeMutationRangeByType,\n    RemoveMergeUndoMutationFactory,\n    RemoveWorksheetMergeMutation,\n    SheetInterceptorService,\n    SheetsSelectionsService,\n} from '@univerjs/sheets';\nimport { IConfirmService } from '@univerjs/ui';\n\nimport { checkCellContentInRanges, getClearContentMutationParamsForRanges } from '../../common/utils';\nimport { getMergeableSelectionsByType, MergeType } from './utils/selection-utils';\n\nexport interface IAddMergeCommandParams {\n    value?: Dimension.ROWS | Dimension.COLUMNS;\n    selections: IRange[];\n    unitId: string;\n    subUnitId: string;\n    defaultMerge?: boolean;\n}\n\nexport const AddWorksheetMergeCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.add-worksheet-merge',\n\n    handler: async (accessor: IAccessor, params: IAddMergeCommandParams) => {\n        const commandService = accessor.get(ICommandService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const confirmService = accessor.get(IConfirmService);\n        const localeService = accessor.get(LocaleService);\n\n        const unitId = params.unitId;\n        const subUnitId = params.subUnitId;\n        const selections = params.selections;\n        const ranges = getAddMergeMutationRangeByType(selections, params.value);\n        const worksheet = univerInstanceService.getUniverSheetInstance(unitId)!.getSheetBySheetId(subUnitId)!;\n\n        const redoMutations: IMutationInfo[] = [];\n        const undoMutations: IMutationInfo[] = [];\n\n        // First we should check if there are values in the going-to-be-merged cells.\n        const willClearSomeCell = checkCellContentInRanges(worksheet, ranges);\n        if (willClearSomeCell && !params.defaultMerge) {\n            const result = await confirmService.confirm({\n                id: 'merge.confirm.add-worksheet-merge',\n                title: {\n                    title: 'merge.confirm.title',\n                },\n                cancelText: localeService.t('merge.confirm.cancel'),\n                confirmText: localeService.t('merge.confirm.confirm'),\n            });\n\n            if (!result) {\n                return false;\n            }\n        }\n\n        // prepare redo mutations\n        const removeMergeMutationParams: IRemoveWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: Tools.deepClone(ranges),\n        };\n        const addMergeMutationParams: IAddWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: Tools.deepClone(ranges),\n        };\n\n        // prepare undo mutations\n        const undoRemoveMergeMutationParams = RemoveMergeUndoMutationFactory(accessor, removeMergeMutationParams);\n        const undoMutationParams = AddMergeUndoMutationFactory(accessor, addMergeMutationParams);\n\n        // params should be the merged cells to be deleted accurately, rather than the selection\n        if (undoRemoveMergeMutationParams.ranges.length > 0) {\n            redoMutations.push({ id: RemoveWorksheetMergeMutation.id, params: undoRemoveMergeMutationParams });\n        }\n\n        redoMutations.push({ id: AddWorksheetMergeMutation.id, params: addMergeMutationParams });\n        undoMutations.push({ id: RemoveWorksheetMergeMutation.id, params: undoMutationParams });\n        if (undoRemoveMergeMutationParams.ranges.length > 0) {\n            undoMutations.push({ id: AddWorksheetMergeMutation.id, params: undoRemoveMergeMutationParams });\n        }\n\n        // add set range values mutations to undo redo mutations\n        if (willClearSomeCell) {\n            const data = getClearContentMutationParamsForRanges(accessor, unitId, worksheet, ranges);\n            redoMutations.unshift(...data.redos);\n            undoMutations.push(...data.undos);\n        }\n\n        const addMergeRedoSelectionsMutation = AddMergeRedoSelectionsOperationFactory(accessor, params, ranges);\n        addMergeRedoSelectionsMutation && redoMutations.push(addMergeRedoSelectionsMutation);\n\n        const addMergeUndoSelectionsMutation = AddMergeUndoSelectionsOperationFactory(accessor, params);\n        addMergeUndoSelectionsMutation && undoMutations.push(addMergeUndoSelectionsMutation);\n\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n        const interceptor = sheetInterceptorService.onCommandExecute({\n            id: AddWorksheetMergeCommand.id,\n            params: { unitId, subUnitId, ranges },\n        });\n\n        redoMutations.push(...interceptor.redos);\n        undoMutations.push(...interceptor.undos);\n\n        const result = sequenceExecute(redoMutations, commandService);\n        if (result.result) {\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations,\n                redoMutations,\n            });\n            return true;\n        }\n        return false;\n    },\n};\n\nexport const AddWorksheetMergeAllCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.add-worksheet-merge-all',\n    handler: async (accessor) => {\n        const commandService = accessor.get(ICommandService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const selections = selectionManagerService.getCurrentSelections()?.map((s) => s.range);\n        const mergeableSelections = getMergeableSelectionsByType(MergeType.MergeAll, selections);\n        if (!mergeableSelections?.length) {\n            return false;\n        }\n\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        if (!workbook) return false;\n\n        const workSheet = workbook.getActiveSheet();\n        if (!workSheet) return false;\n\n        const unitId = workbook.getUnitId();\n        const subUnitId = workSheet.getSheetId();\n\n        return commandService.executeCommand(AddWorksheetMergeCommand.id, {\n            selections: mergeableSelections,\n            unitId,\n            subUnitId,\n        } as IAddMergeCommandParams);\n    },\n};\n\nexport const AddWorksheetMergeVerticalCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.add-worksheet-merge-vertical',\n    handler: async (accessor) => {\n        const commandService = accessor.get(ICommandService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const selections = selectionManagerService.getCurrentSelections()?.map((s) => s.range);\n        const mergeableSelections = getMergeableSelectionsByType(MergeType.MergeVertical, selections);\n        if (!mergeableSelections?.length) {\n            return false;\n        }\n\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        if (!workbook) return false;\n\n        const workSheet = workbook.getActiveSheet();\n        if (!workSheet) return false;\n\n        const unitId = workbook.getUnitId();\n        const subUnitId = workSheet.getSheetId();\n\n        return commandService.executeCommand(AddWorksheetMergeCommand.id, {\n            value: Dimension.COLUMNS,\n            selections: mergeableSelections,\n            unitId,\n            subUnitId,\n        } as IAddMergeCommandParams);\n    },\n};\n\nexport const AddWorksheetMergeHorizontalCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.add-worksheet-merge-horizontal',\n    handler: async (accessor) => {\n        const commandService = accessor.get(ICommandService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const selections = selectionManagerService.getCurrentSelections()?.map((s) => s.range);\n        const mergeableSelections = getMergeableSelectionsByType(MergeType.MergeHorizontal, selections);\n        if (!mergeableSelections?.length) {\n            return false;\n        }\n\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        if (!workbook) return false;\n\n        const workSheet = workbook.getActiveSheet();\n        if (!workSheet) return false;\n\n        const unitId = workbook.getUnitId();\n        const subUnitId = workSheet.getSheetId();\n        return commandService.executeCommand(AddWorksheetMergeCommand.id, {\n            value: Dimension.ROWS,\n            selections: mergeableSelections,\n            unitId,\n            subUnitId,\n        } as IAddMergeCommandParams);\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const SHEET_ZOOM_RANGE = [10, 400];\n\n/**\n * TODO@ggg: To avoid introducing the range-selector of the sheet-formula-ui package into sheet-ui, use a component key for now\n */\nexport const RANGE_SELECTOR_COMPONENT_KEY = 'RANGE_SELECTOR_COMPONENT_KEY';\nexport const EMBEDDING_FORMULA_EDITOR_COMPONENT_KEY = 'EMBEDDING_FORMULA_EDITOR_COMPONENT_KEY';\nexport const EMBEDDING_CELL_EDITOR_COMPONENT_KEY = 'EMBEDDING_CELL_EDITOR_COMPONENT_KEY';\n// end\n\nexport enum SHEET_VIEW_KEY {\n    MAIN = '__SpreadsheetRender__',\n    ROW = '__SpreadsheetRowHeader__',\n    COLUMN = '__SpreadsheetColumnHeader__',\n    LEFT_TOP = '__SpreadsheetLeftTopPlaceholder__',\n}\n\nexport const SHEET_COMPONENT_MAIN_LAYER_INDEX = 0;\n\nexport const SHEET_COMPONENT_SELECTION_LAYER_INDEX = 1;\n\nexport const SHEET_COMPONENT_HEADER_LAYER_INDEX = 10;\n\nexport const SHEET_COMPONENT_HEADER_SELECTION_LAYER_INDEX = 11;\n\nexport const SHEET_COMPONENT_UNHIDE_LAYER_INDEX = 12;\n\n// TODO@wzhudev: there should be a global zIndex layer fo sheet selections // And global zIndex for extension\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommand } from '@univerjs/core';\nimport type { SpreadsheetColumnHeader, SpreadsheetRowHeader } from '@univerjs/engine-render';\n\nimport { CommandType } from '@univerjs/core';\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport { SHEET_VIEW_KEY } from '../../common/keys';\nimport { SheetSkeletonManagerService } from '../../services/sheet-skeleton-manager.service';\n\nexport interface ISetHeaderSizeParams {\n    size: number;\n    unitId: string;\n    subUnitId: string;\n}\n\nexport const SetRowHeaderWidthCommand: ICommand<ISetHeaderSizeParams> = {\n    id: 'sheet.command.set-row-header-width',\n    type: CommandType.COMMAND,\n    handler: async (accessor, params) => {\n        if (!params) {\n            return false;\n        }\n\n        const renderManagerSrv = accessor.get(IRenderManagerService);\n        if (!renderManagerSrv) {\n            return false;\n        }\n        const { unitId, subUnitId, size } = params;\n        const render = renderManagerSrv.getRenderById(unitId);\n        if (render) {\n            const skm = renderManagerSrv.getRenderById(unitId)!.with(SheetSkeletonManagerService);\n            skm.setRowHeaderSize(render, subUnitId, size);\n\n            const { components } = render;\n            const renderComponent = components.get(SHEET_VIEW_KEY.ROW);\n            if (renderComponent) {\n                (renderComponent as SpreadsheetRowHeader).setCustomHeader({ headerStyle: { size } });\n            }\n        }\n\n        return true;\n    },\n};\n\nexport const SetColumnHeaderHeightCommand: ICommand<ISetHeaderSizeParams> = {\n    id: 'sheet.command.set-col-header-height',\n    type: CommandType.COMMAND,\n    handler: async (accessor, params) => {\n        if (!params) {\n            return false;\n        }\n\n        const renderManagerSrv = accessor.get(IRenderManagerService);\n        if (!renderManagerSrv) {\n            return false;\n        }\n        const { unitId, subUnitId, size } = params;\n        const render = renderManagerSrv.getRenderById(unitId);\n        if (render) {\n            const skm = renderManagerSrv.getRenderById(unitId)!.with(SheetSkeletonManagerService);\n            skm.setColumnHeaderSize(render, subUnitId, size);\n            const { components } = render;\n            const renderComponent = components.get(SHEET_VIEW_KEY.COLUMN);\n            if (renderComponent) {\n                (renderComponent as SpreadsheetColumnHeader).setCustomHeader({ headerStyle: { size } });\n            }\n        }\n\n        return true;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ThemeService } from '@univerjs/core';\nimport type { Scene, SpreadsheetSkeleton } from '@univerjs/engine-render';\nimport type { ISelectionStyle } from '@univerjs/sheets';\nimport { ColorKit, createInterceptorKey } from '@univerjs/core';\n\nexport const RANGE_MOVE_PERMISSION_CHECK = createInterceptorKey<boolean, null>('rangeMovePermissionCheck');\nexport const RANGE_FILL_PERMISSION_CHECK = createInterceptorKey<boolean, { x: number; y: number; skeleton: SpreadsheetSkeleton; scene: Scene }>('rangeFillPermissionCheck');\n\nexport enum SELECTION_SHAPE_DEPTH {\n    FORMULA_EDITOR_SHOW = 100, // see packages/sheets-formula/src/controllers/formula-editor-show.controller.ts\n    MARK_SELECTION = 10000,\n};\n\nexport function genNormalSelectionStyle(themeService: ThemeService): ISelectionStyle {\n    const styleSheet = themeService.getCurrentTheme();\n    const fill = new ColorKit(styleSheet.primaryColor).setAlpha(0.07).toRgbString();\n    return {\n        strokeWidth: 1,\n        stroke: styleSheet.primaryColor,\n        fill,\n        // widgets: { tl: true, tc: true, tr: true, ml: true, mr: true, bl: true, bc: true, br: true },\n        widgets: {},\n        widgetSize: 6,\n        widgetStrokeWidth: 1,\n        widgetStroke: styleSheet.colorWhite,\n\n        autofillSize: 6,\n        autofillStrokeWidth: 1,\n        autofillStroke: styleSheet.colorWhite,\n\n        rowHeaderFill: fill,\n        rowHeaderStroke: styleSheet.primaryColor,\n        rowHeaderStrokeWidth: 1,\n\n        columnHeaderFill: fill,\n        columnHeaderStroke: styleSheet.primaryColor,\n        columnHeaderStrokeWidth: 1,\n\n        expandCornerSize: 40,\n    };\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellWithCoord, IRangeWithCoord, Nullable } from '@univerjs/core';\nimport type { ISelectionWithCoord } from '@univerjs/sheets';\nimport { convertCellToRange, RANGE_TYPE } from '@univerjs/core';\n\n/**\n * Data model for SelectionControl.model\n * NOT Same as @univerjs/sheet.WorkbookSelectionModel, that's data model for Workbook\n */\nexport class SelectionRenderModel implements IRangeWithCoord {\n    private _startColumn: number = -1;\n    private _startRow: number = -1;\n    private _endColumn: number = -1;\n    private _endRow: number = -1;\n    private _startX: number = 0;\n    private _startY: number = 0;\n    private _endX: number = 0;\n    private _endY: number = 0;\n\n    /**\n     * The highlight cell of a selection. aka: current cell\n     */\n    private _primary: Nullable<ICellWithCoord>;\n    private _rangeType: RANGE_TYPE = RANGE_TYPE.NORMAL;\n\n    constructor() {\n    }\n\n    get startColumn() { return this._startColumn; }\n    get startRow() { return this._startRow; }\n    get endColumn() { return this._endColumn; }\n    get endRow() { return this._endRow; }\n    get startX() { return this._startX; }\n    get startY() { return this._startY; }\n    get endX() { return this._endX; }\n    get endY() { return this._endY; }\n    get currentCell() { return this._primary; }\n    get rangeType() { return this._rangeType; }\n\n    /**\n     * @deprecated, Duplicate with `Rectangle`\n     */\n    isEqual(rangeWithCoord: IRangeWithCoord) {\n        const { startColumn, startRow, endColumn, endRow } = this;\n        const {\n            startColumn: newStartColumn,\n            startRow: newStartRow,\n            endColumn: newEndColumn,\n            endRow: newEndRow,\n        } = rangeWithCoord;\n\n        if (\n            startColumn === newStartColumn &&\n            startRow === newStartRow &&\n            endColumn === newEndColumn &&\n            endRow === newEndRow\n        ) {\n            return true;\n        }\n\n        return false;\n    }\n\n    highlightToSelection(): Nullable<IRangeWithCoord> {\n        if (!this._primary) return;\n        return convertCellToRange(this._primary);\n    }\n\n    getRange(): IRangeWithCoord {\n        return {\n            startColumn: this._startColumn,\n            startRow: this._startRow,\n            endColumn: this._endColumn,\n            endRow: this._endRow,\n            startX: this._startX,\n            startY: this._startY,\n            endX: this._endX,\n            endY: this._endY,\n            rangeType: this.rangeType,\n        };\n    }\n\n    getCell() {\n        return this._primary;\n    }\n\n    getRangeType() {\n        return this._rangeType;\n    }\n\n    setRangeType(rangeType: RANGE_TYPE) {\n        this._rangeType = rangeType;\n    }\n\n    getValue(): ISelectionWithCoord {\n        return {\n            rangeWithCoord: this.getRange(),\n            primaryWithCoord: this._primary,\n        };\n    }\n\n    setValue(newSelectionRange: IRangeWithCoord, currentCell: Nullable<ICellWithCoord>) {\n        const {\n            startColumn,\n            startRow,\n            endColumn,\n            endRow,\n            startX,\n            startY,\n            endX,\n            endY,\n            rangeType,\n        } = newSelectionRange;\n\n        this._startColumn = startColumn;\n        this._startRow = startRow;\n        this._endColumn = endColumn;\n        this._endRow = endRow;\n        this._startX = startX;\n        this._startY = startY;\n        this._endX = endX;\n        this._endY = endY;\n\n        // !! rangeType various from 0 ~ 3\n        if (rangeType !== undefined) {\n            this._rangeType = rangeType;\n        }\n        if (currentCell !== undefined) {\n            this.setCurrentCell(currentCell);\n        }\n    }\n\n    /**\n     * Set primary cell.\n     * @TODO lumixraku there are 3 concepts for same thing, primary and current and highlight\n     * highlight is best. primary sometimes means the actual cell(actual means ignore merge)\n     * @param currentCell\n     */\n    setCurrentCell(currentCell: Nullable<ICellWithCoord>) {\n        this._primary = currentCell;\n    }\n\n    clearCurrentCell() {\n        this._primary = null;\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellWithCoord, IRange, IRangeWithCoord, ISelectionCell } from '@univerjs/core';\nimport type { SpreadsheetSkeleton } from '@univerjs/engine-render';\nimport type { ISelectionWithCoord, ISelectionWithStyle } from '@univerjs/sheets';\n\n/**\n * Add startXY endXY to range, XY are no merge cell position.\n * @param skeleton\n * @param range\n * @returns {IRangeWithCoord}\n */\nexport function attachRangeWithCoord(skeleton: SpreadsheetSkeleton, range: IRange): IRangeWithCoord {\n    const { startRow, startColumn, endRow, endColumn, rangeType } = range;\n\n    // after the selection is moved, it may be stored endRow < startRow or endColumn < startColumn\n    // so startCell and endCell need get min value to draw the selection\n    const _startRow = endRow < startRow ? endRow : startRow;\n    const _endRow = endRow < startRow ? startRow : endRow;\n\n    const _startColumn = endColumn < startColumn ? endColumn : startColumn;\n    const _endColumn = endColumn < startColumn ? startColumn : endColumn;\n\n    const startCell = skeleton.getNoMergeCellWithCoordByIndex(_startRow, _startColumn);\n    const endCell = skeleton.getNoMergeCellWithCoordByIndex(_endRow, _endColumn);\n\n    return {\n        startRow,\n        startColumn,\n        endRow,\n        endColumn,\n        rangeType,\n        startY: startCell?.startY || 0,\n        endY: endCell?.endY || 0,\n        startX: startCell?.startX || 0,\n        endX: endCell?.endX || 0,\n    };\n}\n\n/**\n * Return selection with coord and style from selection, which has range & primary & style.\n * coord are no merge cell position.\n * @param selection\n * @param skeleton\n * @returns {ISelectionWithCoord} selection with coord and style\n */\nexport function attachSelectionWithCoord(selection: ISelectionWithStyle, skeleton: SpreadsheetSkeleton): ISelectionWithCoord {\n    const { range, primary, style } = selection;\n    const rangeWithCoord = attachRangeWithCoord(skeleton, range);\n    const primaryWithCoord = primary ? attachPrimaryWithCoord(skeleton, primary) : primary;\n    return {\n        rangeWithCoord,\n        primaryWithCoord,\n        style,\n    } as ISelectionWithCoord;\n}\n\nexport function attachPrimaryWithCoord(skeleton: SpreadsheetSkeleton, primary: ISelectionCell): ICellWithCoord {\n    const { actualRow, actualColumn, isMerged, isMergedMainCell, startRow, startColumn, endRow, endColumn } = primary;\n    const cellPosition = skeleton.getNoMergeCellWithCoordByIndex(actualRow, actualColumn);\n    const startCell = skeleton.getNoMergeCellWithCoordByIndex(startRow, startColumn);\n    const endCell = skeleton.getNoMergeCellWithCoordByIndex(endRow, endColumn);\n\n    return {\n        actualRow,\n        actualColumn,\n        isMerged,\n        isMergedMainCell,\n        startX: cellPosition.startX,\n        startY: cellPosition.startY,\n        endX: cellPosition.endX,\n        endY: cellPosition.endY,\n        mergeInfo: {\n            startRow,\n            startColumn,\n            endRow,\n            endColumn,\n            startY: startCell?.startY || 0,\n            endY: endCell?.endY || 0,\n            startX: startCell?.startX || 0,\n            endX: endCell?.endX || 0,\n        },\n    } as ICellWithCoord;\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IFreeze, Injector, IRange, IRangeWithCoord, Nullable, ThemeService } from '@univerjs/core';\nimport type { IMouseEvent, IPointerEvent, Scene, SpreadsheetSkeleton, Viewport } from '@univerjs/engine-render';\nimport type { ISelectionWithStyle } from '@univerjs/sheets';\nimport type { Subscription } from 'rxjs';\nimport type { SelectionControl } from './selection-control';\nimport { ColorKit, IUniverInstanceService, Quantity, UniverInstanceType } from '@univerjs/core';\nimport { CURSOR_TYPE, IRenderManagerService, Rect, ScrollTimer, ScrollTimerType, SHEET_VIEWPORT_KEY, Vector2, withCurrentTypeOfRenderer } from '@univerjs/engine-render';\nimport { SELECTION_CONTROL_BORDER_BUFFER_WIDTH } from '@univerjs/sheets';\nimport { SheetSkeletonManagerService } from '../sheet-skeleton-manager.service';\nimport { ISheetSelectionRenderService } from './base-selection-render.service';\nimport { genNormalSelectionStyle, RANGE_FILL_PERMISSION_CHECK, RANGE_MOVE_PERMISSION_CHECK } from './const';\nimport { attachSelectionWithCoord } from './util';\n\nconst HELPER_SELECTION_TEMP_NAME = '__SpreadsheetHelperSelectionTempRect';\n\nconst SELECTION_CONTROL_DELETING_LIGHTEN = 35;\n\nexport interface ISelectionShapeTargetSelection {\n    originControl: SelectionControl;\n    targetSelection: IRangeWithCoord;\n}\n\nexport interface ISelectionShapeExtensionOption {\n    skeleton: SpreadsheetSkeleton;\n    scene: Scene;\n    themeService: ThemeService;\n    injector: Injector;\n    selectionHooks: Record<string, () => void>;\n}\n\n/**\n * for auto-fill (crosshair expand selection range)\n * drag selection range\n */\nexport class SelectionShapeExtension {\n    private _startOffsetX: number = 0;\n\n    private _startOffsetY: number = 0;\n\n    private _relativeSelectionPositionRow = 0;\n\n    private _relativeSelectionPositionColumn = 0;\n\n    private _relativeSelectionRowLength = 0;\n\n    private _relativeSelectionColumnLength = 0;\n\n    private _scenePointerMoveSub: Nullable<Subscription>;\n\n    private _scenePointerUpSub: Nullable<Subscription>;\n\n    /**\n     * The shadow selection under cursor when move whole selection control(for moving normal selection)\n     */\n    private _helperSelection: Nullable<Rect>;\n\n    private _scrollTimer!: ScrollTimer;\n\n    private _activeViewport!: Viewport;\n\n    private _targetSelection: IRangeWithCoord = {\n        startY: 0,\n        endY: 0,\n        startX: 0,\n        endX: 0,\n        startRow: -1,\n        endRow: -1,\n        startColumn: -1,\n        endColumn: -1,\n    };\n\n    private _isInMergeState: boolean = false;\n\n    private _fillControlColors: string[] = [];\n\n    private _skeleton: SpreadsheetSkeleton;\n    private _scene: Scene;\n    private readonly _themeService: ThemeService;\n    private readonly _injector: Injector;\n    private _selectionHooks: Record<string, () => void>;\n\n    constructor(\n        private _control: SelectionControl,\n        options: ISelectionShapeExtensionOption\n    ) {\n        this._skeleton = options.skeleton;\n        this._scene = options.scene;\n        this._themeService = options.themeService;\n        this._injector = options.injector;\n        this._selectionHooks = options.selectionHooks;\n\n        this._initialControl();\n        this._initialWidget();\n        this._initialAutoFill();\n\n        this._control.dispose$.subscribe(() => {\n            this.dispose();\n        });\n    }\n\n    get isHelperSelection() {\n        return this._control.isHelperSelection;\n    }\n\n    dispose() {\n        this._scrollTimer?.dispose();\n        this._fillControlColors = [];\n        this._clearObserverEvent();\n        this._helperSelection?.dispose();\n    }\n\n    private _getFreeze() {\n        const freeze = withCurrentTypeOfRenderer(\n            UniverInstanceType.UNIVER_SHEET,\n            SheetSkeletonManagerService,\n            this._injector.get(IUniverInstanceService),\n            this._injector.get(IRenderManagerService)\n        )\n            ?.getCurrentParam()\n            ?.skeleton\n            .getWorksheetConfig()\n            .freeze;\n        return freeze;\n    }\n\n    private _isSelectionInViewport(selection: IRangeWithCoord, viewport: Viewport) {\n        const freeze: IFreeze = this._getFreeze() || {\n            startRow: -1,\n            startColumn: -1,\n            xSplit: 0,\n            ySplit: 0,\n        };\n\n        switch (viewport.viewportKey) {\n            case SHEET_VIEWPORT_KEY.VIEW_MAIN:\n                return selection.endRow >= freeze.startRow && selection.endColumn >= freeze.startColumn;\n\n            case SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP:\n            case SHEET_VIEWPORT_KEY.VIEW_COLUMN_RIGHT:\n                return selection.endColumn >= freeze.startColumn && selection.startRow < freeze.startRow;\n\n            case SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT:\n            case SHEET_VIEWPORT_KEY.VIEW_ROW_BOTTOM:\n                return selection.endRow >= freeze.startRow && selection.startColumn < freeze.startColumn;\n\n            case SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP:\n            case SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT:\n            case SHEET_VIEWPORT_KEY.VIEW_ROW_TOP:\n            case SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP:\n                return selection.startRow < freeze.startRow && selection.startColumn < freeze.startColumn;\n            default:\n                break;\n        }\n    }\n\n    private _clearObserverEvent() {\n        this._scenePointerMoveSub?.unsubscribe();\n        this._scenePointerUpSub?.unsubscribe();\n        this._scenePointerMoveSub = null;\n        this._scenePointerUpSub = null;\n    }\n\n    private _initialControl() {\n        const { leftControl, rightControl, topControl, bottomControl } = this._control;\n\n        [leftControl, rightControl, topControl, bottomControl].forEach((control) => {\n            control.onPointerEnter$.subscribeEvent(() => {\n                const permissionCheck = this._injector.get(ISheetSelectionRenderService, Quantity.OPTIONAL)\n                    ?.interceptor\n                    .fetchThroughInterceptors(RANGE_MOVE_PERMISSION_CHECK)(false, null);\n                if (permissionCheck === false) {\n                    return;\n                }\n\n                control.setCursor(CURSOR_TYPE.MOVE);\n            });\n\n            control.onPointerLeave$.subscribeEvent(() => {\n                control.resetCursor();\n            });\n\n            control.onPointerDown$.subscribeEvent(this._controlPointerDownHandler.bind(this));\n        });\n    }\n\n    /**\n     * Move the whole selection control after cursor turn into move state.\n     * NOT same as widgetMoving, that's for 8 control points.\n     * @param moveOffsetX\n     * @param moveOffsetY\n     */\n    private _controlMoving(moveOffsetX: number, moveOffsetY: number) {\n        const scene = this._scene;\n        const scrollXY = scene.getScrollXYInfoByViewport(Vector2.FromArray([moveOffsetX, moveOffsetY]));\n        const { scaleX, scaleY } = scene.getAncestorScale();\n\n        const actualCellIndex = this._skeleton.getCellIndexByOffset(\n            moveOffsetX,\n            moveOffsetY,\n            scaleX,\n            scaleY,\n            scrollXY\n        );\n\n        const { row, column } = actualCellIndex;\n        const maxRow = this._skeleton.getRowCount() - 1;\n        const maxColumn = this._skeleton.getColumnCount() - 1;\n\n        let startRow = Math.max(0, row + this._relativeSelectionPositionRow);\n        let endRow = startRow + this._relativeSelectionRowLength;\n        if (endRow > maxRow) {\n            endRow = maxRow;\n            if (endRow - startRow < this._relativeSelectionRowLength) {\n                startRow = endRow - this._relativeSelectionRowLength;\n            }\n        }\n\n        let startColumn = Math.max(0, column + this._relativeSelectionPositionColumn);\n        let endColumn = startColumn + this._relativeSelectionColumnLength;\n        if (endColumn > maxColumn) {\n            endColumn = maxColumn;\n            if (endColumn - startColumn < this._relativeSelectionColumnLength) {\n                startColumn = endColumn - this._relativeSelectionColumnLength;\n            }\n        }\n        const primaryCell = this._skeleton.worksheet.getCellInfoInMergeData(startRow, startColumn);\n        const selection: ISelectionWithStyle = {\n            range: { startRow, endRow, startColumn, endColumn },\n            primary: primaryCell,\n            style: null,\n        };\n        const selectionWithCoord = attachSelectionWithCoord(selection, this._skeleton);\n        const startCell = this._skeleton.getNoMergeCellWithCoordByIndex(startRow, startColumn);\n        const endCell = this._skeleton.getNoMergeCellWithCoordByIndex(endRow, endColumn);\n        const startY = startCell?.startY || 0;\n        const endY = endCell?.endY || 0;\n        const startX = startCell?.startX || 0;\n        const endX = endCell?.endX || 0;\n\n        this._helperSelection?.transformByState({\n            left: startX,\n            top: startY,\n            width: endX - startX,\n            height: endY - startY,\n        });\n\n        this._targetSelection = { ...selectionWithCoord.rangeWithCoord };\n        // DO NOT UPDATE CURR CELL while dragging whole selection.\n        // Updating the primary cell during the middle of a drag operation may result in the primary cell being out of range in certain scenarios.\n        // ex: dragging normal selection to a merged area. there is a check to see if this move is valid, if not, the selection process would revert back to  original state.\n\n        // normal selection should keep the original state when dragging whole selection.\n        // Now ref selection needs _control.selectionMoving$ update selection when dragging.\n        this._control.selectionMoving$.next(selectionWithCoord.rangeWithCoord);\n    }\n\n    /**\n     * Drag move whole selectionControl when cursor turns to crosshair. Not for dragging 8 control points.\n     * @param evt\n     */\n    private _controlPointerDownHandler(evt: IMouseEvent | IPointerEvent) {\n        const { offsetX: evtOffsetX, offsetY: evtOffsetY } = evt;\n\n        const scene = this._scene;\n\n        const relativeCoords = scene.getCoordRelativeToViewport(Vector2.FromArray([evtOffsetX, evtOffsetY]));\n\n        const { x: newEvtOffsetX, y: newEvtOffsetY } = relativeCoords;\n\n        const scrollXY = scene.getScrollXYInfoByViewport(relativeCoords);\n\n        const { scaleX, scaleY } = scene.getAncestorScale();\n\n        const actualSelection = this._skeleton.getCellIndexByOffset(\n            newEvtOffsetX,\n            newEvtOffsetY,\n            scaleX,\n            scaleY,\n            scrollXY\n        );\n\n        this._startOffsetX = newEvtOffsetX;\n        this._startOffsetY = newEvtOffsetY;\n\n        const { row, column } = actualSelection;\n\n        const {\n            startRow: originStartRow,\n            startColumn: originStartColumn,\n            endRow: originEndRow,\n            endColumn: originEndColumn,\n        } = this._control.model;\n\n        let fixRow = 0;\n        let fixColumn = 0;\n\n        if (row < originStartRow) {\n            fixRow -= 1;\n        } else if (row > originEndRow) {\n            fixRow += 1;\n        }\n\n        if (column < originStartColumn) {\n            fixColumn -= 1;\n        } else if (column > originEndColumn) {\n            fixColumn += 1;\n        }\n\n        this._relativeSelectionPositionRow = originStartRow - row + fixRow;\n        this._relativeSelectionPositionColumn = originStartColumn - column + fixColumn;\n        this._relativeSelectionRowLength = originEndRow - originStartRow;\n        this._relativeSelectionColumnLength = originEndColumn - originStartColumn;\n\n        const style = this._control.currentStyle!;\n        const scale = this._getScale();\n\n        if (this.isHelperSelection) {\n            this._helperSelection = new Rect(HELPER_SELECTION_TEMP_NAME, {\n                stroke: style.stroke,\n                strokeWidth: style.strokeWidth / scale,\n            });\n            scene.addObject(this._helperSelection);\n        }\n\n        // const relativeCoords = scene.getRelativeCoord(Vector2.FromArray([evtOffsetX, evtOffsetY]));\n        // const { x: newEvtOffsetX, y: newEvtOffsetY } = relativeCoords;\n        const viewMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN)!;\n        const scrollTimer = ScrollTimer.create(scene);\n        this._scrollTimer = scrollTimer;\n        scrollTimer.startScroll(newEvtOffsetX, newEvtOffsetY, viewMain);\n\n        scene.disableObjectsEvent();\n\n        this._scenePointerMoveSub = scene.onPointerMove$.subscribeEvent((moveEvt: IPointerEvent | IMouseEvent) => {\n            const { offsetX: moveOffsetX, offsetY: moveOffsetY } = moveEvt;\n\n            const permissionCheck = this._injector.get(ISheetSelectionRenderService, Quantity.OPTIONAL)\n                ?.interceptor\n                .fetchThroughInterceptors(RANGE_MOVE_PERMISSION_CHECK)(false, null);\n            if (permissionCheck === false) {\n                return;\n            }\n\n            const { x: newMoveOffsetX, y: newMoveOffsetY } = scene.getCoordRelativeToViewport(\n                Vector2.FromArray([moveOffsetX, moveOffsetY])\n            );\n\n            this._controlMoving(newMoveOffsetX, newMoveOffsetY);\n\n            scene.setCursor(CURSOR_TYPE.MOVE);\n\n            scrollTimer.scrolling(newMoveOffsetX, newMoveOffsetY, () => {\n                this._controlMoving(newMoveOffsetX, newMoveOffsetY);\n            });\n        });\n\n        this._scenePointerUpSub = scene.onPointerUp$.subscribeEvent(() => {\n            this._helperSelection?.dispose();\n            const scene = this._scene;\n            scene.resetCursor();\n            this._clearObserverEvent();\n            scene.enableObjectsEvent();\n            this._scrollTimer?.dispose();\n            this._control.selectionMoveEnd$.next(this._targetSelection);\n\n            // _selectionHooks.selectionMoveEnd should placed after this._control.selectionMoveEnd$\n            this._selectionHooks.selectionMoveEnd?.();\n        });\n    }\n\n    private _initialWidget() {\n        const {\n            topLeftWidget,\n            topCenterWidget,\n            topRightWidget,\n            middleLeftWidget,\n            middleRightWidget,\n            bottomLeftWidget,\n            bottomCenterWidget,\n            bottomRightWidget,\n        } = this._control;\n\n        const cursors: CURSOR_TYPE[] = [\n            CURSOR_TYPE.NORTH_WEST_RESIZE,\n            CURSOR_TYPE.NORTH_RESIZE,\n            CURSOR_TYPE.NORTH_EAST_RESIZE,\n            CURSOR_TYPE.WEST_RESIZE,\n            CURSOR_TYPE.EAST_RESIZE,\n            CURSOR_TYPE.SOUTH_WEST_RESIZE,\n            CURSOR_TYPE.SOUTH_RESIZE,\n            CURSOR_TYPE.SOUTH_EAST_RESIZE,\n        ];\n\n        [\n            topLeftWidget,\n            topCenterWidget,\n            topRightWidget,\n            middleLeftWidget,\n            middleRightWidget,\n            bottomLeftWidget,\n            bottomCenterWidget,\n            bottomRightWidget,\n        ].forEach((control, index) => {\n            control.onPointerEnter$.subscribeEvent(() => {\n                control.setCursor(cursors[index]);\n            });\n\n            control.onPointerLeave$.subscribeEvent(() => {\n                control.resetCursor();\n            });\n\n            control.onPointerDown$.subscribeEvent((evt: IMouseEvent | IPointerEvent) => {\n                this._widgetPointerDownEvent(evt, cursors[index]);\n            });\n        });\n    }\n\n    /**\n     * Pointer down Events for 8 control point.\n     * @param evt\n     * @param cursor\n     */\n    private _widgetPointerDownEvent(evt: IMouseEvent | IPointerEvent, cursor: CURSOR_TYPE) {\n        const scene = this._scene;\n\n        const { offsetX: evtOffsetX, offsetY: evtOffsetY } = evt;\n        const relativeCoords = scene.getCoordRelativeToViewport(Vector2.FromArray([evtOffsetX, evtOffsetY]));\n        const { x: newEvtOffsetX, y: newEvtOffsetY } = relativeCoords;\n        this._startOffsetX = evtOffsetX;\n        this._startOffsetY = evtOffsetY;\n\n        const {\n            startRow: originStartRow,\n            startColumn: originStartColumn,\n            endRow: originEndRow,\n            endColumn: originEndColumn,\n        } = this._control.model;\n\n        // When dragging the bottom line of the selection area over the previous top line, at this time, endRow < startRow\n        // when dragging top line lower than the previous bottom line, at this time, startRow > endRow\n        // see https://github.com/dream-num/univer-pro/issues/1451\n        const startRow = Math.min(originStartRow, originEndRow);\n        const startColumn = Math.min(originStartColumn, originEndColumn);\n        const endRow = Math.max(originStartRow, originEndRow);\n        const endColumn = Math.max(originStartColumn, originEndColumn);\n\n        this._relativeSelectionPositionRow = startRow;\n        this._relativeSelectionPositionColumn = startColumn;\n        this._relativeSelectionRowLength = endRow - startRow;\n        this._relativeSelectionColumnLength = endColumn - startColumn;\n\n        if (cursor === CURSOR_TYPE.NORTH_WEST_RESIZE) {\n            this._relativeSelectionPositionRow = endRow;\n            this._relativeSelectionPositionColumn = endColumn;\n        } else if (cursor === CURSOR_TYPE.NORTH_RESIZE) {\n            this._relativeSelectionPositionRow = endRow;\n        } else if (cursor === CURSOR_TYPE.NORTH_EAST_RESIZE) {\n            this._relativeSelectionPositionRow = endRow;\n        } else if (cursor === CURSOR_TYPE.WEST_RESIZE) {\n            this._relativeSelectionPositionColumn = endColumn;\n        } else if (cursor === CURSOR_TYPE.SOUTH_WEST_RESIZE) {\n            this._relativeSelectionPositionColumn = endColumn;\n        } else if (cursor === CURSOR_TYPE.SOUTH_RESIZE) {\n            this._relativeSelectionPositionRow = startRow;\n        }\n        const scrollTimer = ScrollTimer.create(scene);\n        const viewMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN)!;\n        scrollTimer.startScroll(newEvtOffsetX, newEvtOffsetY, viewMain);\n        this._scrollTimer = scrollTimer;\n\n        scene.disableObjectsEvent();\n\n        this._scenePointerMoveSub = scene.onPointerMove$.subscribeEvent((moveEvt: IPointerEvent | IMouseEvent) => {\n            const { offsetX: moveOffsetX, offsetY: moveOffsetY } = moveEvt;\n\n            const { x: newMoveOffsetX, y: newMoveOffsetY } = scene.getCoordRelativeToViewport(\n                Vector2.FromArray([moveOffsetX, moveOffsetY])\n            );\n\n            this._widgetMoving(newMoveOffsetX, newMoveOffsetY, cursor);\n\n            scene.setCursor(cursor);\n\n            scrollTimer.scrolling(newMoveOffsetX, newMoveOffsetY, () => {\n                this._widgetMoving(newMoveOffsetX, newMoveOffsetY, cursor);\n            });\n        });\n\n        this._scenePointerUpSub = scene.onPointerUp$.subscribeEvent(() => {\n            const scene = this._scene;\n            scene.resetCursor();\n            this._clearObserverEvent();\n            scene.enableObjectsEvent();\n            this._scrollTimer?.dispose();\n            this._control.selectionScaled$.next(this._targetSelection);\n\n            // _selectionHooks.selectionMoveEnd should placed after this._control.selectionMoveEnd$,\n            this._selectionHooks.selectionMoveEnd?.();\n        });\n    }\n\n    /**\n     * Pointer move Events for 8 control point.\n     * @param moveOffsetX\n     * @param moveOffsetY\n     * @param cursor\n     */\n    private _widgetMoving(moveOffsetX: number, moveOffsetY: number, cursor: CURSOR_TYPE) {\n        const scene = this._scene;\n\n        const scrollXY = scene.getScrollXYInfoByViewport(Vector2.FromArray([this._startOffsetX, this._startOffsetY]));\n        const { scaleX, scaleY } = scene.getAncestorScale();\n        const moveActualSelection = this._skeleton.getCellIndexByOffset(\n            moveOffsetX,\n            moveOffsetY,\n            scaleX,\n            scaleY,\n            scrollXY\n        );\n\n        const { row, column } = moveActualSelection;\n        // const { rowHeaderWidth, columnHeaderHeight } = this._skeleton;\n        // const maxRow = this._skeleton.getRowCount() - 1;\n        // const maxColumn = this._skeleton.getColumnCount() - 1;\n        let startRow = this._relativeSelectionPositionRow;\n        let startColumn = this._relativeSelectionPositionColumn;\n        let endRow = row;\n        let endColumn = column;\n\n        if (cursor === CURSOR_TYPE.NORTH_WEST_RESIZE) {\n            startRow = row;\n            startColumn = column;\n            endRow = this._relativeSelectionPositionRow;\n            endColumn = this._relativeSelectionPositionColumn;\n        } else if (cursor === CURSOR_TYPE.NORTH_RESIZE) {\n            startRow = row;\n            startColumn = this._relativeSelectionPositionColumn;\n            endRow = this._relativeSelectionPositionRow;\n            endColumn = this._relativeSelectionPositionColumn + this._relativeSelectionColumnLength;\n        } else if (cursor === CURSOR_TYPE.NORTH_EAST_RESIZE) {\n            startRow = row;\n            startColumn = this._relativeSelectionPositionColumn;\n            endRow = this._relativeSelectionPositionRow;\n            endColumn = column;\n        } else if (cursor === CURSOR_TYPE.WEST_RESIZE) {\n            startRow = this._relativeSelectionPositionRow;\n            startColumn = column;\n            endRow = this._relativeSelectionPositionRow + this._relativeSelectionRowLength;\n            endColumn = this._relativeSelectionPositionColumn;\n        } else if (cursor === CURSOR_TYPE.EAST_RESIZE) {\n            endRow = this._relativeSelectionPositionRow + this._relativeSelectionRowLength;\n        } else if (cursor === CURSOR_TYPE.SOUTH_WEST_RESIZE) {\n            startRow = this._relativeSelectionPositionRow;\n            startColumn = column;\n            endRow = row;\n            endColumn = this._relativeSelectionPositionColumn;\n        } else if (cursor === CURSOR_TYPE.SOUTH_RESIZE) {\n            startRow = this._relativeSelectionPositionRow;\n            startColumn = this._relativeSelectionPositionColumn;\n            endRow = row;\n            endColumn = this._relativeSelectionPositionColumn + this._relativeSelectionColumnLength;\n        }\n\n        const range = this._swapPositions(startRow, startColumn, endRow, endColumn);\n        const primaryCell = this._skeleton.getCellWithMergeInfoByIndex(startRow, startColumn);\n        const selectionWithStyle: ISelectionWithStyle = { range, primary: primaryCell, style: null };\n        const selectionRangeWithCoord = attachSelectionWithCoord(selectionWithStyle, this._skeleton);\n        this._targetSelection = { ...selectionRangeWithCoord.rangeWithCoord };\n        // const startCell = this._skeleton.getNoMergeCellPositionByIndex(finalStartRow, finalStartColumn);\n        // const endCell = this._skeleton.getNoMergeCellPositionByIndex(finalEndRow, finalEndColumn);\n\n        // const startY = startCell?.startY || 0;\n        // const endY = endCell?.endY || 0;\n        // const startX = startCell?.startX || 0;\n        // const endX = endCell?.endX || 0;\n\n        // this._targetSelection = {\n        //     startY,\n        //     endY,\n        //     startX,\n        //     endX,\n        //     startRow,\n        //     endRow,\n        //     startColumn,\n        //     endColumn,\n        // };\n        // const primaryWithCoord = this._skeleton.getCellWithCoordByIndex(startRow, startColumn);\n        // this._control.updateRange(this._targetSelection, primaryWithCoord);\n\n        this._control.updateRangeBySelectionWithCoord(selectionRangeWithCoord);\n        this._control.selectionScaling$.next(this._targetSelection);\n    }\n\n    private _initialAutoFill() {\n        const { fillControl } = this._control;\n\n        fillControl.onPointerEnter$.subscribeEvent((evt: IPointerEvent | IMouseEvent) => {\n            const permissionCheck = this._injector.get(ISheetSelectionRenderService).interceptor.fetchThroughInterceptors(RANGE_FILL_PERMISSION_CHECK)(false, { x: evt.offsetX, y: evt.offsetY, skeleton: this._skeleton, scene: this._scene });\n\n            if (!permissionCheck) {\n                return;\n            }\n            fillControl.setCursor(CURSOR_TYPE.CROSSHAIR);\n        });\n\n        fillControl.onPointerLeave$.subscribeEvent(() => {\n            fillControl.resetCursor();\n        });\n\n        fillControl.onPointerDown$.subscribeEvent(this._autoFillForPointerdown.bind(this));\n    }\n\n    // eslint-disable-next-line complexity\n    private _autoFillMoving(moveOffsetX: number, moveOffsetY: number) {\n        const scene = this._scene;\n        // const activeViewport = scene.getActiveViewportByCoord(Vector2.FromArray([moveOffsetX, moveOffsetY]));\n        // const scrollXY = activeViewport ? scene.getScrollXY(activeViewport) : { x: 0, y: 0 };\n        const scrollXY = scene.getViewportScrollXY(this._activeViewport);\n\n        const { scaleX, scaleY } = scene.getAncestorScale();\n\n        const moveActualSelection = this._skeleton.getCellIndexByOffset(\n            moveOffsetX,\n            moveOffsetY,\n            scaleX,\n            scaleY,\n            scrollXY\n        );\n\n        const { row, column } = moveActualSelection;\n\n        const moveRelativeCoords = scene.getCoordRelativeToViewport(Vector2.FromArray([moveOffsetX, moveOffsetY]));\n\n        const maxRow = this._skeleton.getRowCount() - 1;\n\n        const maxColumn = this._skeleton.getColumnCount() - 1;\n\n        let startRow = this._relativeSelectionPositionRow;\n\n        let startColumn = this._relativeSelectionPositionColumn;\n\n        let endRow = this._relativeSelectionPositionRow + this._relativeSelectionRowLength;\n\n        let endColumn = this._relativeSelectionPositionColumn + this._relativeSelectionColumnLength;\n\n        let isLighten = false;\n\n        let isRowDropping = true;\n\n        if ((column < startColumn || column > endColumn) && row >= startRow && row <= endRow) {\n            const rulerValue = this._fillRuler(\n                column,\n                startColumn,\n                endColumn,\n                this._relativeSelectionColumnLength,\n                maxColumn\n            );\n\n            startColumn = rulerValue.startRowOrColumn;\n\n            endColumn = rulerValue.endRowOrColumn;\n\n            isLighten = rulerValue.isLighten;\n\n            isRowDropping = false;\n        } else if ((row < startRow || row > endRow) && column >= startColumn && column <= endColumn) {\n            const rulerValue = this._fillRuler(row, startRow, endRow, this._relativeSelectionRowLength, maxRow);\n\n            startRow = rulerValue.startRowOrColumn;\n\n            endRow = rulerValue.endRowOrColumn;\n\n            isLighten = rulerValue.isLighten;\n        } else if (\n            Math.abs(this._startOffsetX - moveRelativeCoords.x - scrollXY.x) / 2 >\n            Math.abs(this._startOffsetY - moveRelativeCoords.y - scrollXY.y)\n        ) {\n            const rulerValue = this._fillRuler(\n                column,\n                startColumn,\n                endColumn,\n                this._relativeSelectionColumnLength,\n                maxColumn\n            );\n\n            startColumn = rulerValue.startRowOrColumn;\n\n            endColumn = rulerValue.endRowOrColumn;\n\n            isLighten = rulerValue.isLighten;\n\n            isRowDropping = false;\n        } else {\n            const rulerValue = this._fillRuler(row, startRow, endRow, this._relativeSelectionRowLength, maxRow);\n\n            startRow = rulerValue.startRowOrColumn;\n\n            endRow = rulerValue.endRowOrColumn;\n\n            isLighten = rulerValue.isLighten;\n        }\n\n        const startCell = this._skeleton.getNoMergeCellWithCoordByIndex(startRow, startColumn);\n        const endCell = this._skeleton.getNoMergeCellWithCoordByIndex(endRow, endColumn);\n\n        const startY = startCell?.startY || 0;\n        const endY = endCell?.endY || 0;\n        const startX = startCell?.startX || 0;\n        const endX = endCell?.endX || 0;\n\n        if (isLighten) {\n            this._controlHandler((o, index) => {\n                const newColor = new ColorKit(this._fillControlColors[index])\n                    .lighten(SELECTION_CONTROL_DELETING_LIGHTEN)\n                    .toRgbString();\n                o.setProps({\n                    fill: newColor,\n                });\n            });\n        } else {\n            this._controlHandler((o, index) => {\n                o.setProps({\n                    fill: this._fillControlColors[index],\n                });\n            });\n        }\n\n        const SELECTION_CONTROL_BORDER_BUFFER_WIDTH_SCALE = SELECTION_CONTROL_BORDER_BUFFER_WIDTH / this._getScale();\n\n        if ((startRow === endRow && isRowDropping === true) || (startColumn === endColumn && isRowDropping === false)) {\n            this._helperSelection?.hide();\n        } else {\n            this._helperSelection?.transformByState({\n                left: startX - SELECTION_CONTROL_BORDER_BUFFER_WIDTH_SCALE / 2,\n                top: startY - SELECTION_CONTROL_BORDER_BUFFER_WIDTH_SCALE / 2,\n                width: endX - startX,\n                height: endY - startY,\n            });\n\n            this._helperSelection?.show();\n        }\n\n        this._targetSelection = {\n            startY,\n            endY,\n            startX,\n            endX,\n            startRow,\n            endRow,\n            startColumn,\n            endColumn,\n        };\n\n        this._control.selectionFilling$.next(this._targetSelection);\n    }\n\n    private _autoFillForPointerdown(evt: IMouseEvent | IPointerEvent) {\n        const { offsetX: evtOffsetX, offsetY: evtOffsetY } = evt;\n\n        const scene = this._scene;\n\n        const relativeCoords = scene.getCoordRelativeToViewport(Vector2.FromArray([evtOffsetX, evtOffsetY]));\n\n        const { x: newEvtOffsetX, y: newEvtOffsetY } = relativeCoords;\n\n        this._startOffsetX = newEvtOffsetX;\n\n        this._startOffsetY = newEvtOffsetY;\n\n        const {\n            startRow: originStartRow,\n            startColumn: originStartColumn,\n            endRow: originEndRow,\n            endColumn: originEndColumn,\n        } = this._control.model;\n\n        this._isInMergeState = this._hasMergeInRange(originStartRow, originStartColumn, originEndRow, originEndColumn);\n\n        this._relativeSelectionPositionRow = originStartRow;\n\n        this._relativeSelectionPositionColumn = originStartColumn;\n\n        this._relativeSelectionRowLength = originEndRow - originStartRow;\n\n        this._relativeSelectionColumnLength = originEndColumn - originStartColumn;\n\n        const style = this._control.currentStyle;\n        let stroke = style?.stroke;\n        let strokeWidth = style?.strokeWidth;\n        const defaultStyle = genNormalSelectionStyle(this._themeService);\n        if (stroke == null) {\n            stroke = defaultStyle.stroke;\n        }\n\n        if (strokeWidth == null) {\n            strokeWidth = defaultStyle.strokeWidth;\n        }\n\n        const scale = this._getScale();\n\n        strokeWidth /= scale;\n\n        const SELECTION_CONTROL_BORDER_BUFFER_WIDTH_SCALE = SELECTION_CONTROL_BORDER_BUFFER_WIDTH / scale;\n\n        const darkenColor = new ColorKit(stroke).darken(2).toRgbString();\n\n        if (this.isHelperSelection) {\n            this._helperSelection = new Rect(HELPER_SELECTION_TEMP_NAME, {\n                stroke: darkenColor,\n                strokeWidth: strokeWidth + SELECTION_CONTROL_BORDER_BUFFER_WIDTH_SCALE / 2,\n            });\n            scene.addObject(this._helperSelection);\n        }\n\n        this._activeViewport = scene.getActiveViewportByCoord(Vector2.FromArray([evtOffsetX, evtOffsetY]))!;\n\n        const viewportMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n\n        const scrollTimer = ScrollTimer.create(\n            scene,\n            this._activeViewport.viewportKey === SHEET_VIEWPORT_KEY.VIEW_MAIN ? ScrollTimerType.ALL : ScrollTimerType.NONE\n        );\n\n        scrollTimer.startScroll(newEvtOffsetX, newEvtOffsetY, viewportMain);\n\n        this._scrollTimer = scrollTimer;\n\n        scene.disableObjectsEvent();\n\n        this._controlHandler((o) => {\n            this._fillControlColors.push(o.fill as string);\n        });\n\n        // Controls the border of the expanding selection area\n        this._scenePointerMoveSub = scene.onPointerMove$.subscribeEvent((moveEvt: IPointerEvent | IMouseEvent) => {\n            const { offsetX: moveOffsetX, offsetY: moveOffsetY } = moveEvt;\n            const currentViewport = scene.getActiveViewportByCoord(Vector2.FromArray([moveOffsetX, moveOffsetY]));\n\n            const permissionCheck = this._injector.get(ISheetSelectionRenderService).interceptor.fetchThroughInterceptors(RANGE_FILL_PERMISSION_CHECK)(false, { x: evt.offsetX, y: evt.offsetY, skeleton: this._skeleton, scene: this._scene });\n\n            if (!permissionCheck) {\n                return;\n            }\n\n            const { x: newMoveOffsetX, y: newMoveOffsetY } = scene.getCoordRelativeToViewport(\n                Vector2.FromArray([moveOffsetX, moveOffsetY])\n            );\n\n            this._autoFillMoving(newMoveOffsetX, newMoveOffsetY);\n\n            scene.setCursor(CURSOR_TYPE.CROSSHAIR);\n\n            const newSelection = this._targetSelection;\n\n            if (viewportMain && currentViewport && this._activeViewport?.viewportKey !== currentViewport?.viewportKey) {\n                let movingRange: IRangeWithCoord;\n                if (newSelection.startRow !== originStartRow) {\n                    scrollTimer.scrollTimerType = ScrollTimerType.Y;\n                    movingRange = {\n                        ...newSelection,\n                        endRow: newSelection.startRow,\n                    };\n                } else if (newSelection.endRow !== originEndRow) {\n                    scrollTimer.scrollTimerType = ScrollTimerType.Y;\n                    movingRange = {\n                        ...newSelection,\n                        startRow: newSelection.endRow,\n                    };\n                } else if (newSelection.startColumn !== originStartColumn) {\n                    scrollTimer.scrollTimerType = ScrollTimerType.X;\n                    movingRange = {\n                        ...newSelection,\n                        endColumn: newSelection.startColumn,\n                    };\n                } else {\n                    scrollTimer.scrollTimerType = ScrollTimerType.X;\n                    movingRange = {\n                        ...newSelection,\n                        startColumn: newSelection.endColumn,\n                    };\n                }\n\n                if (this._isSelectionInViewport(movingRange, currentViewport)) {\n                    viewportMain.scrollToBarPos({\n                        x: scrollTimer.scrollTimerType === ScrollTimerType.X ? 0 : undefined,\n                        y: scrollTimer.scrollTimerType === ScrollTimerType.Y ? 0 : undefined,\n                    });\n                    this._activeViewport = currentViewport;\n                }\n            }\n\n            scrollTimer.scrolling(newMoveOffsetX, newMoveOffsetY, () => {\n                this._autoFillMoving(newMoveOffsetX, newMoveOffsetY);\n            });\n        });\n\n        this._scenePointerUpSub = scene.onPointerUp$.subscribeEvent(() => {\n            this._helperSelection?.dispose();\n            const scene = this._scene;\n            scene.resetCursor();\n            this._clearObserverEvent();\n            scene.enableObjectsEvent();\n            this._scrollTimer?.dispose();\n            this._control.refreshSelectionFilled(this._targetSelection);\n            this._isInMergeState = false;\n            this._controlHandler((o, index) => {\n                o.setProps({\n                    fill: this._fillControlColors[index],\n                });\n            });\n            this._fillControlColors = [];\n        });\n    }\n\n    private _hasMergeInRange(startRow: number, startColumn: number, endRow: number, endColumn: number) {\n        return this._skeleton.worksheet.getMergedCellRange(startRow, startColumn, endRow, endColumn).length > 0;\n    }\n\n    /**\n     * Make sure startRow < endRow and startColumn < endColumn\n     *\n     * @param startRow\n     * @param startColumn\n     * @param endRow\n     * @param endColumn\n     * @returns {IRange} range\n     */\n    private _swapPositions(startRow: number, startColumn: number, endRow: number, endColumn: number): IRange {\n        const finalStartRow = Math.min(startRow, endRow);\n        const finalStartColumn = Math.min(startColumn, endColumn);\n        const finalEndRow = Math.max(startRow, endRow);\n        const finalEndColumn = Math.max(startColumn, endColumn);\n        return {\n            startRow: finalStartRow,\n            startColumn: finalStartColumn,\n            endRow: finalEndRow,\n            endColumn: finalEndColumn,\n        };\n    }\n\n    private _controlHandler(func: (o: Rect, index: number) => void) {\n        const {\n            leftControl,\n            rightControl,\n            topControl,\n            bottomControl,\n            backgroundControlTop,\n            backgroundControlMiddleLeft,\n            backgroundControlMiddleRight,\n            backgroundControlBottom,\n            fillControl,\n        } = this._control;\n        const objects = [\n            leftControl,\n            rightControl,\n            topControl,\n            bottomControl,\n            backgroundControlTop,\n            backgroundControlMiddleLeft,\n            backgroundControlMiddleRight,\n            backgroundControlBottom,\n            fillControl,\n        ];\n\n        for (let i = 0, len = objects.length; i < len; i++) {\n            const object = objects[i];\n            func(object, i);\n        }\n    }\n\n    private _fillRuler(\n        rowOrColumn: number,\n        startRowOrColumn: number,\n        endRowOrColumn: number,\n        rowOrColumnLength: number,\n        maxRowOrColumn: number\n    ) {\n        let isLighten = false;\n        if (rowOrColumn < startRowOrColumn) {\n            if (this._isInMergeState && rowOrColumn < startRowOrColumn) {\n                const current = startRowOrColumn - rowOrColumn;\n                const rangeRowCount = rowOrColumnLength + 1;\n                const step = Math.ceil(current / rangeRowCount);\n\n                let newStartRow = startRowOrColumn - step * rangeRowCount;\n\n                if (newStartRow < 0) {\n                    newStartRow = startRowOrColumn - (step - 1) * rangeRowCount;\n                }\n\n                startRowOrColumn = newStartRow;\n            } else {\n                startRowOrColumn = rowOrColumn;\n            }\n        } else if (rowOrColumn >= startRowOrColumn && rowOrColumn <= endRowOrColumn) {\n            isLighten = true;\n            if (!this._isInMergeState) {\n                endRowOrColumn = rowOrColumn;\n            }\n        } else {\n            if (this._isInMergeState && rowOrColumn > endRowOrColumn) {\n                const current = rowOrColumn - endRowOrColumn;\n                const rangeRowCount = rowOrColumnLength + 1;\n                const step = Math.ceil(current / rangeRowCount);\n\n                let newEndRow = endRowOrColumn + step * rangeRowCount;\n\n                if (newEndRow > maxRowOrColumn) {\n                    newEndRow = endRowOrColumn + (step - 1) * rangeRowCount;\n                }\n\n                endRowOrColumn = newEndRow;\n            } else {\n                endRowOrColumn = rowOrColumn;\n            }\n        }\n\n        return {\n            rowOrColumn,\n            startRowOrColumn,\n            endRowOrColumn,\n            isLighten,\n        };\n    }\n\n    private _getScale() {\n        const { scaleX, scaleY } = this._scene.getAncestorScale();\n        return Math.max(scaleX, scaleY);\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellWithCoord, IRangeWithCoord, Nullable, ThemeService } from '@univerjs/core';\nimport type { IObjectFullState, IRectProps, Scene, SpreadsheetSkeleton } from '@univerjs/engine-render';\nimport type { ISelectionStyle, ISelectionWidgetConfig, ISelectionWithCoord } from '@univerjs/sheets';\nimport type { ISelectionShapeExtensionOption } from './selection-shape-extension';\nimport { ColorKit, Disposable, RANGE_TYPE, toDisposable } from '@univerjs/core';\nimport { cancelRequestFrame, DashedRect, FIX_ONE_PIXEL_BLUR_OFFSET, Group, Rect, requestNewFrame, TRANSFORM_CHANGE_OBSERVABLE_TYPE } from '@univerjs/engine-render';\nimport {\n    SELECTION_CONTROL_BORDER_BUFFER_COLOR,\n    SELECTION_CONTROL_BORDER_BUFFER_WIDTH,\n} from '@univerjs/sheets';\n\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport { SHEET_COMPONENT_HEADER_SELECTION_LAYER_INDEX, SHEET_COMPONENT_SELECTION_LAYER_INDEX } from '../../common/keys';\nimport { genNormalSelectionStyle } from './const';\nimport { SelectionRenderModel } from './selection-render-model';\nimport { SelectionShapeExtension } from './selection-shape-extension';\n\nexport enum SELECTION_MANAGER_KEY {\n    Selection = '__SpreadsheetSelectionShape__',\n    top = '__SpreadsheetSelectionTopControl__',\n    bottom = '__SpreadsheetSelectionBottomControl__',\n    left = '__SpreadsheetSelectionShapeLeftControl__',\n    right = '__SpreadsheetSelectionShapeRightControl__',\n    backgroundTop = '__SpreadsheetSelectionBackgroundControlTop__',\n    backgroundMiddleLeft = '__SpreadsheetSelectionBackgroundControlMiddleLeft__',\n    backgroundMiddleRight = '__SpreadsheetSelectionBackgroundControlMiddleRight__',\n    backgroundBottom = '__SpreadsheetSelectionBackgroundControlBottom__',\n    fill = '__SpreadsheetSelectionFillControl__',\n\n    // fillTopLeft & fillBottomRight are used for mobile selection\n    fillTopLeft = '__SpreadsheetSelectionFillControlTopLeft__',\n    fillBottomRight = '__SpreadsheetSelectionFillControlBottomRight__',\n    fillTopLeftInner = '__SpreadsheetSelectionFillControlTopLeftInner__',\n    fillBottomRightInner = '__SpreadsheetSelectionFillControlBottomRightInner__',\n\n    lineMain = '__SpreadsheetDragLineMainControl__',\n    lineContent = '__SpreadsheetDragLineContentControl__',\n    line = '__SpreadsheetDragLineControl__',\n\n    dash = '__SpreadsheetDragDashControl__',\n\n    rowHeaderBackground = '__SpreadSheetSelectionRowHeaderBackground__',\n    rowHeaderBorder = '__SpreadSheetSelectionRowHeaderBorder__',\n    rowHeaderGroup = '__SpreadSheetSelectionRowHeaderGroup__',\n    columnHeaderBackground = '__SpreadSheetSelectionColumnHeaderBackground__',\n    columnHeaderBorder = '__SpreadSheetSelectionColumnHeaderBorder__',\n    columnHeaderGroup = '__SpreadSheetSelectionColumnHeaderGroup__',\n\n    topLeftWidget = '__SpreadSheetSelectionTopLeftWidget__',\n    topCenterWidget = '__SpreadSheetSelectionTopCenterWidget__',\n    topRightWidget = '__SpreadSheetSelectionTopRightWidget__',\n    middleLeftWidget = '__SpreadSheetSelectionMiddleLeftWidget__',\n    middleRightWidget = '__SpreadSheetSelectionMiddleRightWidget__',\n    bottomLeftWidget = '__SpreadSheetSelectionBottomLeftWidget__',\n    bottomCenterWidget = '__SpreadSheetSelectionBottomCenterWidget__',\n    bottomRightWidget = '__SpreadSheetSelectionBottomRightWidget__',\n}\n\nconst SELECTION_TITLE_HIGHLIGHT_ALPHA = 0.3;\n\n/**\n * The main selection canvas component, includes leftControl,rightControl,topControl,bottomControl,backgroundControlTop,backgroundControlMiddleLeft,backgroundControlMiddleRight,backgroundControlBottom,fillControl\n */\nexport class SelectionControl extends Disposable {\n    private _isHelperSelection: boolean = true;\n\n    /**\n     * For ref selections, there is no auto fill.\n     */\n    protected _enableAutoFill: boolean = true;\n    /**\n     * Only normal selections with primary cell has auto fill.\n     * This works for multiple normal selections. Only last selection has primary cell and auto fill.\n     */\n    private _showAutoFill: boolean = false;\n\n    /**\n     * If rowHeader & col Header would be highlighted with selection.\n     */\n    protected _highlightHeader: boolean = true;\n\n    protected _selectionRenderModel!: SelectionRenderModel;\n\n    private _leftBorder!: Rect;\n    private _rightBorder!: Rect;\n    private _topBorder!: Rect;\n    private _bottomBorder!: Rect;\n    private _backgroundControlTop!: Rect;\n    private _backgroundControlBottom!: Rect;\n    private _backgroundControlMiddleLeft!: Rect;\n    private _backgroundControlMiddleRight!: Rect;\n    private _autoFillControl: Rect;\n    private _selectionShapeGroup!: Group;\n    private _rowHeaderBackground!: Rect;\n    private _rowHeaderBorder!: Rect;\n    private _rowHeaderGroup!: Group;\n    private _columnHeaderBackground!: Rect;\n    private _columnHeaderBorder!: Rect;\n    private _columnHeaderGroup!: Group;\n    private _dashedRect!: Rect;\n\n    // for ref selection\n    private _topLeftWidget!: Rect;\n    private _topCenterWidget!: Rect;\n    private _topRightWidget!: Rect;\n    private _middleLeftWidget!: Rect;\n    private _middleRightWidget!: Rect;\n    private _bottomLeftWidget!: Rect;\n    private _bottomCenterWidget!: Rect;\n    private _bottomRightWidget!: Rect;\n\n    // why three style prop? what's diff between _selectionStyle & _currentStyle?\n    // protected _selectionStyle: Nullable<ISelectionStyle>;\n    private _defaultStyle!: ISelectionStyle;\n    private _currentStyle: ISelectionStyle;\n    protected _rowHeaderWidth: number = 0;\n    protected _columnHeaderHeight: number = 0;\n\n    protected _widgetRects: Rect[] = [];\n    protected _controlExtension: Nullable<SelectionShapeExtension>;\n\n    private _dispose$ = new BehaviorSubject<SelectionControl>(this);\n    readonly dispose$ = this._dispose$.asObservable();\n\n    /**\n     * eventSource: selectionShapeExtension selectionMoving$.next,\n     * Observer: prompt.controller\n     */\n    readonly selectionMoving$ = new Subject<IRangeWithCoord>();\n    readonly selectionMoveEnd$ = new Subject<IRangeWithCoord>();\n    readonly selectionScaling$ = new Subject<IRangeWithCoord>();\n    readonly selectionScaled$ = new Subject<Nullable<IRangeWithCoord>>();\n    readonly selectionFilling$ = new Subject<Nullable<IRangeWithCoord>>();\n\n    private readonly _selectionFilled$ = new Subject<Nullable<IRangeWithCoord>>();\n    readonly selectionFilled$ = this._selectionFilled$.asObservable();\n\n    constructor(\n        protected _scene: Scene,\n        protected _zIndex: number,\n        protected readonly _themeService: ThemeService,\n        options?: {\n            highlightHeader?: boolean;\n            enableAutoFill?: boolean;\n            rowHeaderWidth: number;\n            columnHeaderHeight: number;\n            rangeType?: RANGE_TYPE;\n        }\n    ) {\n        super();\n        this._enableAutoFill = options?.enableAutoFill ?? true;\n        this._highlightHeader = options?.highlightHeader ?? true;\n        this._rowHeaderWidth = options?.rowHeaderWidth ?? 0;\n        this._columnHeaderHeight = options?.columnHeaderHeight ?? 0;\n        this._initializeSheetBody();\n        this._initialHeader();\n    }\n\n    private _initializeSheetBody(): void {\n        this._defaultStyle = genNormalSelectionStyle(this._themeService);\n        this._currentStyle = genNormalSelectionStyle(this._themeService);\n\n        this._selectionRenderModel = new SelectionRenderModel();\n        const zIndex = this._zIndex;\n        this._leftBorder = new Rect(SELECTION_MANAGER_KEY.left + zIndex, {\n            zIndex,\n        });\n\n        this._rightBorder = new Rect(SELECTION_MANAGER_KEY.right + zIndex, {\n            zIndex,\n        });\n\n        this._topBorder = new Rect(SELECTION_MANAGER_KEY.top + zIndex, {\n            zIndex,\n        });\n\n        this._bottomBorder = new Rect(SELECTION_MANAGER_KEY.bottom + zIndex, {\n            zIndex,\n        });\n\n        this._backgroundControlTop = new Rect(SELECTION_MANAGER_KEY.backgroundTop + zIndex, {\n            zIndex: zIndex - 1,\n            evented: false,\n        });\n\n        this._backgroundControlBottom = new Rect(SELECTION_MANAGER_KEY.backgroundBottom + zIndex, {\n            zIndex: zIndex - 1,\n            evented: false,\n        });\n\n        this._backgroundControlMiddleLeft = new Rect(SELECTION_MANAGER_KEY.backgroundMiddleLeft + zIndex, {\n            zIndex: zIndex - 1,\n            evented: false,\n        });\n        this._backgroundControlMiddleRight = new Rect(SELECTION_MANAGER_KEY.backgroundMiddleRight + zIndex, {\n            zIndex: zIndex - 1,\n            evented: false,\n        });\n\n        // size of fillControl is set in _updateControlStyleAndLayout(), because control size(visual size) stays same when zoom change.\n        // The size of control is not a const value, so it was handled by _updateWidgets() & _updateControlStyleAndLayout()\n        this._autoFillControl = new Rect(SELECTION_MANAGER_KEY.fill + zIndex, {\n            zIndex: zIndex + 1,\n        });\n        this._autoFillControl.hide();\n\n        // That weird, new Dashed rect should called when strokeDash. not every selectionControl need dashedRect.\n        // strokeDash === null || strokeDash === undefined ---> _dashRect.hide()\n        this._dashedRect = new DashedRect(SELECTION_MANAGER_KEY.dash + zIndex, {\n            zIndex: zIndex + 2,\n            evented: false,\n            stroke: '#fff',\n        });\n\n        const shapes = [\n            this._autoFillControl,\n            this._leftBorder,\n            this._rightBorder,\n            this._topBorder,\n            this._bottomBorder,\n            this._backgroundControlTop,\n            this._backgroundControlMiddleLeft,\n            this._backgroundControlMiddleRight,\n            this._backgroundControlBottom,\n            this._dashedRect,\n        ];\n\n        this._widgetRects = this._initialWidget();\n        this._selectionShapeGroup = new Group(SELECTION_MANAGER_KEY.Selection + zIndex, ...shapes, ...this._widgetRects);\n        this._selectionShapeGroup.hide();\n        this._selectionShapeGroup.evented = false;\n        this._selectionShapeGroup.zIndex = zIndex;\n\n        const scene = this.getScene();\n        scene.addObject(this._selectionShapeGroup, SHEET_COMPONENT_SELECTION_LAYER_INDEX);\n\n        this.disposeWithMe(\n            toDisposable(\n                scene.onTransformChange$.subscribeEvent((state) => {\n                    if (state.type !== TRANSFORM_CHANGE_OBSERVABLE_TYPE.scale) {\n                        return;\n                    }\n\n                    this._updateLayoutOfSelectionControl(this._currentStyle);\n                    this._updateControlCoord();\n                })\n            )\n        );\n    }\n\n    private _initialHeader(): void {\n        const zIndex = this._zIndex;\n        this._rowHeaderBackground = new Rect(SELECTION_MANAGER_KEY.rowHeaderBackground + zIndex, {\n            zIndex: zIndex - 1,\n            evented: false,\n        });\n\n        this._rowHeaderBorder = new Rect(SELECTION_MANAGER_KEY.rowHeaderBorder + zIndex, {\n            zIndex: zIndex - 1,\n            evented: false,\n        });\n\n        this._rowHeaderGroup = new Group(\n            SELECTION_MANAGER_KEY.rowHeaderGroup + zIndex,\n            this._rowHeaderBackground,\n            this._rowHeaderBorder\n        );\n\n        this._rowHeaderGroup.hide();\n        this._rowHeaderGroup.evented = false;\n        this._rowHeaderGroup.zIndex = zIndex;\n\n        this._columnHeaderBackground = new Rect(SELECTION_MANAGER_KEY.columnHeaderBackground + zIndex, {\n            zIndex: zIndex - 1,\n            evented: false,\n        });\n\n        this._columnHeaderBorder = new Rect(SELECTION_MANAGER_KEY.columnHeaderBorder + zIndex, {\n            zIndex: zIndex - 1,\n            evented: false,\n        });\n\n        this._columnHeaderGroup = new Group(\n            SELECTION_MANAGER_KEY.columnHeaderGroup + zIndex,\n            this._columnHeaderBackground,\n            this._columnHeaderBorder\n        );\n\n        this._columnHeaderGroup.hide();\n        this._columnHeaderGroup.evented = false;\n        this._columnHeaderGroup.zIndex = zIndex;\n\n        const scene = this.getScene();\n        scene.addObjects([this._rowHeaderGroup, this._columnHeaderGroup], SHEET_COMPONENT_HEADER_SELECTION_LAYER_INDEX);\n    }\n\n    private _initialWidget(): Rect[] {\n        const zIndex = this._zIndex;\n        this._topLeftWidget = new Rect(SELECTION_MANAGER_KEY.topLeftWidget + zIndex, {\n            zIndex: zIndex + 1,\n        });\n\n        this._topCenterWidget = new Rect(SELECTION_MANAGER_KEY.topCenterWidget + zIndex, {\n            zIndex: zIndex + 1,\n        });\n\n        this._topRightWidget = new Rect(SELECTION_MANAGER_KEY.topRightWidget + zIndex, {\n            zIndex: zIndex + 1,\n        });\n\n        this._middleLeftWidget = new Rect(SELECTION_MANAGER_KEY.middleLeftWidget + zIndex, {\n            zIndex: zIndex + 1,\n        });\n\n        this._middleRightWidget = new Rect(SELECTION_MANAGER_KEY.middleRightWidget + zIndex, {\n            zIndex: zIndex + 1,\n        });\n\n        this._bottomLeftWidget = new Rect(SELECTION_MANAGER_KEY.bottomLeftWidget + zIndex, {\n            zIndex: zIndex + 1,\n        });\n\n        this._bottomCenterWidget = new Rect(SELECTION_MANAGER_KEY.bottomCenterWidget + zIndex, {\n            zIndex: zIndex + 1,\n        });\n\n        this._bottomRightWidget = new Rect(SELECTION_MANAGER_KEY.bottomRightWidget + zIndex, {\n            zIndex: zIndex + 1,\n        });\n\n        return [\n            this._topLeftWidget,\n            this._topCenterWidget,\n            this._topRightWidget,\n            this._middleLeftWidget,\n            this._middleRightWidget,\n            this._bottomLeftWidget,\n            this._bottomCenterWidget,\n            this._bottomRightWidget,\n        ];\n    }\n\n    get zIndex(): number {\n        return this._zIndex;\n    }\n\n    get leftControl(): Rect {\n        return this._leftBorder;\n    }\n\n    get rightControl(): Rect {\n        return this._rightBorder;\n    }\n\n    get topControl(): Rect {\n        return this._topBorder;\n    }\n\n    get bottomControl(): Rect {\n        return this._bottomBorder;\n    }\n\n    get fillControl(): Rect {\n        return this._autoFillControl;\n    }\n\n    get backgroundControlTop(): Rect {\n        return this._backgroundControlTop;\n    }\n\n    get backgroundControlBottom(): Rect {\n        return this._backgroundControlBottom;\n    }\n\n    get backgroundControlMiddleLeft(): Rect {\n        return this._backgroundControlMiddleLeft;\n    }\n\n    get backgroundControlMiddleRight(): Rect {\n        return this._backgroundControlMiddleRight;\n    }\n\n    get selectionShape(): Group {\n        return this._selectionShapeGroup;\n    }\n\n    get columnHeaderGroup(): Group {\n        return this._columnHeaderGroup;\n    }\n\n    get rowHeaderGroup(): Group {\n        return this._rowHeaderGroup;\n    }\n\n    get selectionShapeGroup(): Group {\n        return this._selectionShapeGroup;\n    }\n\n    // That's so bad! _selectionModel is protected! But I don't want to expose it to the outside world\n    get model(): SelectionRenderModel {\n        return this._selectionRenderModel;\n    }\n\n    get topLeftWidget(): Rect {\n        return this._topLeftWidget;\n    }\n\n    get topCenterWidget(): Rect {\n        return this._topCenterWidget;\n    }\n\n    get topRightWidget(): Rect {\n        return this._topRightWidget;\n    }\n\n    get middleLeftWidget(): Rect {\n        return this._middleLeftWidget;\n    }\n\n    get middleRightWidget(): Rect {\n        return this._middleRightWidget;\n    }\n\n    get bottomLeftWidget(): Rect {\n        return this._bottomLeftWidget;\n    }\n\n    get bottomCenterWidget(): Rect {\n        return this._bottomCenterWidget;\n    }\n\n    get bottomRightWidget(): Rect {\n        return this._bottomRightWidget;\n    }\n\n    get themeService(): ThemeService {\n        return this._themeService;\n    }\n\n    get selectionModel(): SelectionRenderModel {\n        return this._selectionRenderModel;\n    }\n\n    set selectionModel(model: SelectionRenderModel) {\n        this._selectionRenderModel = model;\n    }\n\n    // get defaultStyle(): ISelectionStyle {\n    //     return this._defaultStyle;\n    // }\n\n    // set defaultStyle(style: ISelectionStyle) {\n    //     this._defaultStyle = style;\n    // }\n\n    get currentStyle(): ISelectionStyle {\n        return this._currentStyle;\n    }\n\n    set currentStyle(style: ISelectionStyle) {\n        this._currentStyle = style;\n    }\n\n    get dashedRect(): Rect {\n        return this._dashedRect;\n    }\n\n    get isHelperSelection(): boolean {\n        return this._isHelperSelection;\n    }\n\n    get rowHeaderWidth(): number {\n        return this._rowHeaderWidth;\n    }\n\n    set rowHeaderWidth(width: number) {\n        this._rowHeaderWidth = width;\n    }\n\n    get columnHeaderHeight(): number {\n        return this._columnHeaderHeight;\n    }\n\n    set columnHeaderHeight(height: number) {\n        this._columnHeaderHeight = height;\n    }\n\n    setControlExtension(options: ISelectionShapeExtensionOption) {\n        this._controlExtension = new SelectionShapeExtension(this, options);\n    }\n\n    setEvent(state: boolean): void {\n        this.leftControl.evented = state;\n        this.rightControl.evented = state;\n        this.topControl.evented = state;\n        this.bottomControl.evented = state;\n    }\n\n    refreshSelectionFilled(val: IRangeWithCoord): void {\n        this._selectionFilled$.next(val);\n    }\n\n    /**\n     * Update Control Style And Position of SelectionControl\n     * @param selectionStyle\n     */\n    protected _updateLayoutOfSelectionControl(selectionStyle?: Nullable<Partial<ISelectionStyle>>): void {\n        if (selectionStyle) {\n            this.currentStyle = Object.assign({}, this._defaultStyle, selectionStyle);\n        }\n        const currentStyle = this.currentStyle as Required<ISelectionStyle>;\n\n        const {\n            stroke,\n            widgets,\n            autofillStroke: AutofillStroke,\n            strokeDash,\n            isAnimationDash,\n        } = currentStyle;\n        let autofillSize = currentStyle.autofillSize;\n        let strokeWidth = currentStyle.strokeWidth;\n        let autofillStrokeWidth = currentStyle.autofillStrokeWidth;\n        const scale = this._getScale();\n        const leftAdjustWidth = (strokeWidth + SELECTION_CONTROL_BORDER_BUFFER_WIDTH) / 2 / scale;\n        strokeWidth /= scale;\n        autofillSize /= scale;\n        autofillStrokeWidth /= scale < 1 ? 1 : scale;\n        // const selectBorderOffsetFix = SELECTION_BORDER_OFFSET_FIX / scale;\n        const borderBuffer = SELECTION_CONTROL_BORDER_BUFFER_WIDTH / scale;\n        const fixOnePixelBlurOffset = FIX_ONE_PIXEL_BLUR_OFFSET / scale;\n\n        // startX startY shares same coordinate with viewport.(include row & col header)\n        const { startX, startY, endX, endY } = this._selectionRenderModel;\n        this.leftControl.transformByState({\n            height: endY - startY,\n            left: -leftAdjustWidth + fixOnePixelBlurOffset,\n            width: strokeWidth,\n            strokeWidth: borderBuffer,\n            top: -borderBuffer / 2 + fixOnePixelBlurOffset,\n        });\n\n        this.leftControl.setProps({\n            fill: stroke,\n            stroke: SELECTION_CONTROL_BORDER_BUFFER_COLOR,\n        });\n\n        this.rightControl.transformByState({\n            height: endY - startY,\n            left: endX - startX - leftAdjustWidth + fixOnePixelBlurOffset,\n            width: strokeWidth,\n            strokeWidth: borderBuffer,\n            top: -borderBuffer / 2 + fixOnePixelBlurOffset,\n        });\n\n        this.rightControl.setProps({\n            fill: stroke,\n            stroke: SELECTION_CONTROL_BORDER_BUFFER_COLOR,\n        });\n\n        this.topControl.transformByState({\n            width: endX - startX + strokeWidth,\n            top: -leftAdjustWidth + fixOnePixelBlurOffset,\n            left: -leftAdjustWidth + fixOnePixelBlurOffset,\n            height: strokeWidth,\n            strokeWidth: borderBuffer,\n        });\n\n        this.topControl.setProps({\n            fill: stroke,\n            stroke: SELECTION_CONTROL_BORDER_BUFFER_COLOR,\n        });\n\n        this.bottomControl.transformByState({\n            width: endX - startX + strokeWidth,\n            top: endY - startY - leftAdjustWidth + fixOnePixelBlurOffset,\n            height: strokeWidth,\n            left: -leftAdjustWidth + fixOnePixelBlurOffset,\n            strokeWidth: borderBuffer,\n        });\n\n        this.bottomControl.setProps({\n            fill: stroke,\n            stroke: SELECTION_CONTROL_BORDER_BUFFER_COLOR,\n        });\n\n        if (strokeDash === null || strokeDash === undefined) {\n            this.dashedRect.hide();\n            this._stopAntLineAnimation();\n        } else {\n            const dashRectBorderWidth = currentStyle.strokeWidth * 2 / scale;\n            this.dashedRect.transformByState({\n                height: endY - startY,\n                width: endX - startX,\n                strokeWidth: dashRectBorderWidth,\n                left: -dashRectBorderWidth / 2 + fixOnePixelBlurOffset,\n                top: -dashRectBorderWidth / 2 + fixOnePixelBlurOffset,\n            });\n\n            this.dashedRect.setProps({\n                strokeDashArray: [0, strokeDash / scale],\n            });\n\n            this._stopAntLineAnimation();\n\n            if (isAnimationDash !== false) {\n                this._startAntLineAnimation();\n            }\n\n            this.dashedRect.show();\n        }\n        this._showAutoFill = this._showAutoFill && this._enableAutoFill;\n        if (this._showAutoFill && !this._hasWidgets(widgets)) {\n            const fillProps: IRectProps = {\n                fill: stroke,\n                stroke: AutofillStroke,\n                strokeScaleEnabled: false,\n            };\n            const sizeState: IObjectFullState = {\n                width: autofillSize - autofillStrokeWidth,\n                height: autofillSize - autofillStrokeWidth,\n                left: endX - startX - autofillSize / 2 + autofillStrokeWidth / 2 - fixOnePixelBlurOffset,\n                top: endY - startY - autofillSize / 2 + autofillStrokeWidth / 2 - fixOnePixelBlurOffset,\n                strokeWidth: autofillStrokeWidth,\n            };\n            this._autoFillControl.setProps(fillProps);\n            this._autoFillControl.transformByState(sizeState);\n            this._autoFillControl.show();\n        } else {\n            this._autoFillControl.hide();\n        }\n\n        this._updateBackgroundControl(currentStyle);\n        this._updateHeaderBackground(currentStyle);\n        this._updateWidgets(currentStyle);\n    }\n\n    /**\n     * update selection control coordination by curr selection model\n     */\n    protected _updateControlCoord(): void {\n        const { startX, startY } = this._selectionRenderModel;\n        this.selectionShapeGroup.show();\n        this.selectionShapeGroup.translate(startX, startY);\n        this.selectionShapeGroup.makeDirtyNoDebounce(true);\n    }\n\n    updateStyle(style: Partial<ISelectionStyle>): void {\n        this._updateLayoutOfSelectionControl(style);\n        this._updateControlCoord();\n    }\n\n    /**\n     * Update range and primary range.\n     *\n     * highlight cell would update if primaryWithCoord has value.\n     * highlight cell would be cleared if primaryWithCoord is null.\n     * highlight would keep prev value if primaryWithCoord is undefined.\n     * @param rangeWithCoord\n     * @param primaryWithCoord\n     */\n    updateRange(rangeWithCoord: IRangeWithCoord, primaryWithCoord: Nullable<ICellWithCoord>): void {\n        this._selectionRenderModel.setValue(rangeWithCoord, primaryWithCoord);\n        this._showAutoFill = primaryWithCoord !== null;\n        this._updateLayoutOfSelectionControl();\n        this._updateControlCoord();\n    }\n\n    /**\n     * Update range and primary range and style.\n     * @param selectionWthCoord\n     */\n    updateRangeBySelectionWithCoord(selectionWthCoord: ISelectionWithCoord, sk?: SpreadsheetSkeleton) {\n        if (sk) {\n            // do not get header size from workbook, that is default value.\n            // if row is over one million, row header width would be bigger than default value.\n            this._rowHeaderWidth = sk.rowHeaderWidth;\n            this._columnHeaderHeight = sk.columnHeaderHeight;\n        }\n        this._selectionRenderModel.setValue(selectionWthCoord.rangeWithCoord, selectionWthCoord.primaryWithCoord);\n        // if primaryWithCoord is undefined, that means keeps the previous value.\n        this._showAutoFill = selectionWthCoord.primaryWithCoord !== null;\n        this._updateLayoutOfSelectionControl(selectionWthCoord.style);\n        this._updateControlCoord();\n    }\n\n    /**\n     * Update selection model with new range & primary cell(aka: highlight/current), also update row/col selection size & style.\n     *\n     * @deprecated  use `updateRangeBySelectionWithCoord` and `updateStyle` to do same thing.\n     *\n     * @param newSelectionRange\n     * @param rowHeaderWidth\n     * @param columnHeaderHeight\n     * @param style\n     * @param primaryCell primary cell\n     */\n    update(\n        newSelectionRange: IRangeWithCoord,\n        rowHeaderWidth: number = 0,\n        columnHeaderHeight: number = 0,\n        style?: Nullable<ISelectionStyle>,\n        primaryCell?: Nullable<ICellWithCoord>\n    ): void {\n        this._rowHeaderWidth = rowHeaderWidth;\n        this._columnHeaderHeight = columnHeaderHeight;\n        this.updateRangeBySelectionWithCoord({\n            rangeWithCoord: newSelectionRange,\n            primaryWithCoord: primaryCell,\n            style,\n        });\n        if (style) {\n            this.updateStyle(style);\n        }\n    }\n\n    /**\n     * Update primary range.\n     * highlight cell would update if primary cell has value.\n     * highlight cell would be cleared if primary cell is null.\n     * highlight would keep prev value if primary cell is undefined.\n     *\n     * @param primaryCell model.current (aka: highlight)\n     */\n    // @TODO lumixraku there are 3 concepts for same thing, primary and current and highlight\n    // highlight is best. primary sometimes means the actual cell(actual means ignore merge)\n    updateCurrCell(primaryCell: Nullable<ICellWithCoord>): void {\n        // in multiple selection shape, only shape with highlight has auto fill.\n        this._showAutoFill = primaryCell !== null;\n        this._selectionRenderModel.setCurrentCell(primaryCell);\n    }\n\n    clearHighlight(): void {\n        // in multiple selection shape, only shape with highlight has auto fill.\n        this._showAutoFill = false;\n        this._selectionRenderModel.clearCurrentCell();\n        this._updateLayoutOfSelectionControl(this._currentStyle);\n    }\n\n    getScene(): Scene {\n        return this._scene;\n    }\n\n    // eslint-disable-next-line complexity\n    override dispose(): void {\n        this._leftBorder?.dispose();\n        this._rightBorder?.dispose();\n        this._topBorder?.dispose();\n        this._bottomBorder?.dispose();\n        this._backgroundControlTop?.dispose();\n        this._backgroundControlMiddleLeft?.dispose();\n        this._backgroundControlMiddleRight?.dispose();\n        this._backgroundControlBottom?.dispose();\n        this._autoFillControl.dispose();\n        this._selectionShapeGroup?.dispose();\n\n        this._rowHeaderBackground?.dispose();\n        this._rowHeaderBorder?.dispose();\n        this._rowHeaderGroup?.dispose();\n        this._rowHeaderBackground?.dispose();\n        this._columnHeaderBackground?.dispose();\n        this._columnHeaderBorder?.dispose();\n        this._columnHeaderGroup?.dispose();\n\n        this._topLeftWidget?.dispose();\n        this._topCenterWidget?.dispose();\n        this._topRightWidget?.dispose();\n        this._middleLeftWidget?.dispose();\n        this._middleRightWidget?.dispose();\n        this._bottomLeftWidget?.dispose();\n        this._bottomCenterWidget?.dispose();\n        this._bottomRightWidget?.dispose();\n\n        this._controlExtension?.dispose();\n\n        super.dispose();\n\n        this._dispose$.next(this);\n        this._dispose$.complete();\n    }\n\n    /**\n     * Get the cell information of the current selection, considering the case of merging cells\n     */\n    getCurrentCellInfo(): Nullable<IRangeWithCoord> {\n        const currentCell = this.model.currentCell;\n\n        if (currentCell) {\n            let currentRangeData: IRangeWithCoord;\n\n            if (currentCell.isMerged) {\n                const mergeInfo = currentCell.mergeInfo;\n\n                currentRangeData = {\n                    startRow: mergeInfo.startRow,\n                    endRow: mergeInfo.endRow,\n                    startColumn: mergeInfo.startColumn,\n                    endColumn: mergeInfo.endColumn,\n                    startX: mergeInfo.startX,\n                    endX: mergeInfo.endX,\n                    startY: mergeInfo.startY,\n                    endY: mergeInfo.endY,\n                };\n            } else {\n                const { actualRow, actualColumn, startX, endX, startY, endY } = currentCell;\n                currentRangeData = {\n                    startRow: actualRow,\n                    endRow: actualRow,\n                    startColumn: actualColumn,\n                    endColumn: actualColumn,\n                    startX,\n                    endX,\n                    startY,\n                    endY,\n                };\n            }\n\n            return currentRangeData;\n        }\n    }\n\n    getValue(): ISelectionWithCoord {\n        return {\n            ...this._selectionRenderModel.getValue(),\n            style: this._currentStyle,\n        };\n    }\n\n    getRange(): IRangeWithCoord {\n        return this._selectionRenderModel.getValue().rangeWithCoord;\n    }\n\n    enableHelperSelection(): void {\n        this._isHelperSelection = true;\n    }\n\n    disableHelperSelection(): void {\n        this._isHelperSelection = false;\n    }\n\n    private _updateHeaderBackground(style: ISelectionStyle): void {\n        const { startX, startY, endX, endY, rangeType } = this._selectionRenderModel;\n        const defaultStyle = this._currentStyle;\n        const scale = this._getScale();\n\n        const {\n            stroke,\n            rowHeaderFill = defaultStyle.rowHeaderFill!,\n            rowHeaderStroke = defaultStyle.rowHeaderStroke!,\n            columnHeaderFill = defaultStyle.columnHeaderFill!,\n            columnHeaderStroke = defaultStyle.columnHeaderStroke!,\n        } = style;\n\n        let {\n            rowHeaderStrokeWidth = defaultStyle.rowHeaderStrokeWidth!,\n\n            columnHeaderStrokeWidth = defaultStyle.columnHeaderStrokeWidth!,\n        } = style;\n\n        rowHeaderStrokeWidth /= scale;\n        columnHeaderStrokeWidth /= scale;\n        const rowHeaderWidth = this._rowHeaderWidth;\n        const columnHeaderHeight = this._columnHeaderHeight;\n\n        if (this._highlightHeader && columnHeaderHeight > 0) {\n            let highlightTitleColor = columnHeaderFill;\n            if (rangeType === RANGE_TYPE.COLUMN) {\n                highlightTitleColor = new ColorKit(stroke).setAlpha(SELECTION_TITLE_HIGHLIGHT_ALPHA).toString();\n            }\n            this._columnHeaderBackground.setProps({\n                fill: highlightTitleColor,\n            });\n            this._columnHeaderBackground.resize(endX - startX, columnHeaderHeight);\n\n            this._columnHeaderBorder.setProps({\n                fill: columnHeaderStroke,\n            });\n            this._columnHeaderBorder.transformByState({\n                width: endX - startX,\n                height: columnHeaderStrokeWidth,\n                top: columnHeaderHeight - columnHeaderStrokeWidth + 1 / scale, // + 1 / scale: Avoid appearing thicker due to the adjacency of the first row cells.\n            });\n\n            this._columnHeaderGroup.show();\n            this._columnHeaderGroup.translate(startX, 0);\n        } else {\n            this._columnHeaderGroup.hide();\n        }\n\n        this._columnHeaderGroup.makeDirty(true);\n\n        if (this._highlightHeader && rowHeaderWidth > 0) {\n            let highlightTitleColor = rowHeaderFill;\n            if (rangeType === RANGE_TYPE.ROW) {\n                highlightTitleColor = new ColorKit(stroke).setAlpha(SELECTION_TITLE_HIGHLIGHT_ALPHA).toString();\n            }\n            this._rowHeaderBackground.setProps({\n                fill: highlightTitleColor,\n            });\n            this._rowHeaderBackground.resize(rowHeaderWidth, endY - startY);\n\n            this._rowHeaderBorder.setProps({\n                fill: rowHeaderStroke,\n            });\n            this._rowHeaderBorder.transformByState({\n                width: rowHeaderStrokeWidth,\n                height: endY - startY,\n                left: rowHeaderWidth - rowHeaderStrokeWidth + 1 / scale,\n            });\n\n            this._rowHeaderGroup.show();\n            this._rowHeaderGroup.translate(0, startY);\n        } else {\n            this._rowHeaderGroup.hide();\n        }\n\n        this._rowHeaderGroup.makeDirty(true);\n    }\n\n    private _updateBackgroundControl(style: ISelectionStyle): void {\n        const { startX, startY, endX, endY } = this._selectionRenderModel;\n\n        const scale = this._getScale();\n        const { fill = style.fill! } = style;\n        let { strokeWidth } = style;\n        strokeWidth /= scale;\n        const highlightSelection = this._selectionRenderModel.highlightToSelection();\n\n        if (!highlightSelection) {\n            this._backgroundControlTop.resize(endX - startX, endY - startY);\n            this._backgroundControlTop.setProps({ fill });\n            this._backgroundControlBottom.resize(0, 0);\n            this._backgroundControlMiddleLeft.resize(0, 0);\n            this._backgroundControlMiddleRight.resize(0, 0);\n            return;\n        }\n\n        const { startX: h_startX, startY: h_startY, endX: h_endX, endY: h_endY } = highlightSelection;\n        const strokeOffset = strokeWidth / 2;\n\n        const topConfig = {\n            left: -strokeOffset,\n            top: -strokeOffset,\n            width: endX - startX + strokeOffset * 2,\n            height: h_startY - startY + strokeOffset,\n        };\n        if (topConfig.height < 0) {\n            topConfig.width = 0;\n            topConfig.height = 0;\n        }\n        this._backgroundControlTop.transformByState(topConfig);\n\n        const middleLeftConfig = {\n            left: -strokeOffset,\n            top: h_startY - startY,\n            width: h_startX - startX + strokeOffset,\n            height: h_endY - h_startY,\n        };\n        if (middleLeftConfig.width < 0) {\n            middleLeftConfig.width = 0;\n            middleLeftConfig.height = 0;\n        }\n        this._backgroundControlMiddleLeft.transformByState(middleLeftConfig);\n\n        const middleRightConfig = {\n            left: h_endX - startX - strokeOffset,\n            top: h_startY - startY,\n            width: endX - h_endX + strokeOffset * 2,\n            height: h_endY - h_startY,\n        };\n        if (middleRightConfig.width < 0) {\n            middleRightConfig.width = 0;\n            middleRightConfig.height = 0;\n        }\n        this._backgroundControlMiddleRight.transformByState(middleRightConfig);\n\n        const middleBottomConfig = {\n            left: -strokeOffset,\n            top: h_endY - startY,\n            width: endX - startX + strokeOffset * 2,\n            height: endY - h_endY + strokeOffset,\n        };\n        if (middleBottomConfig.height < 0) {\n            middleBottomConfig.width = 0;\n            middleBottomConfig.height = 0;\n        }\n        this._backgroundControlBottom.transformByState(middleBottomConfig);\n\n        this._backgroundControlTop.setProps({ fill });\n        this._backgroundControlMiddleLeft.setProps({ fill });\n        this._backgroundControlMiddleRight.setProps({ fill });\n        this._backgroundControlBottom.setProps({ fill });\n    }\n\n    private _updateWidgets(style: Required<ISelectionStyle>): void {\n        const { startX, startY, endX, endY } = this._selectionRenderModel;\n\n        const { stroke = style.stroke!, widgets = style.widgets!, widgetStroke = style.widgetStroke! } = style;\n        const scale = this._getScale();\n        let { widgetSize, widgetStrokeWidth } = style;\n\n        widgetSize /= scale;\n        widgetStrokeWidth /= scale;\n\n        const position = { left: -widgetSize / 2 + widgetStrokeWidth / 2, center: (endX - startX) / 2 - widgetSize / 2 + widgetStrokeWidth / 2, right: endX - startX - widgetSize / 2 + widgetStrokeWidth / 2, top: -widgetSize / 2, middle: (endY - startY) / 2 - widgetSize / 2, bottom: endY - startY - widgetSize / 2 + widgetStrokeWidth / 2 };\n        const size = widgetSize - widgetStrokeWidth;\n\n        this._widgetRects.forEach((widget) => {\n            widget.setProps({ fill: stroke, stroke: widgetStroke });\n        });\n\n        if (widgets.tl === true) {\n            this._topLeftWidget.transformByState({ height: size, width: size, left: position.left, top: position.top, strokeWidth: widgetStrokeWidth });\n            this._topLeftWidget.show();\n        } else {\n            this._topLeftWidget.hide();\n        }\n\n        if (widgets.tc === true) {\n            this._topCenterWidget.transformByState({ height: size, width: size, left: position.center, top: position.top, strokeWidth: widgetStrokeWidth });\n            this._topCenterWidget.show();\n        } else {\n            this._topCenterWidget.hide();\n        }\n\n        if (widgets.tr === true) {\n            this._topRightWidget.transformByState({ height: size, width: size, left: position.right, top: position.top, strokeWidth: widgetStrokeWidth });\n            this._topRightWidget.show();\n        } else {\n            this._topRightWidget.hide();\n        }\n\n        if (widgets.ml === true) {\n            this._middleLeftWidget.transformByState({ height: size, width: size, left: position.left, top: position.middle, strokeWidth: widgetStrokeWidth });\n            this._middleLeftWidget.show();\n        } else {\n            this._middleLeftWidget.hide();\n        }\n\n        if (widgets.mr === true) {\n            this._middleRightWidget.transformByState({ height: size, width: size, left: position.right, top: position.middle, strokeWidth: widgetStrokeWidth });\n            this._middleRightWidget.show();\n        } else {\n            this._middleRightWidget.hide();\n        }\n\n        if (widgets.bl === true) {\n            this._bottomLeftWidget.transformByState({ height: size, width: size, left: position.left, top: position.bottom, strokeWidth: widgetStrokeWidth });\n            this._bottomLeftWidget.show();\n        } else {\n            this._bottomLeftWidget.hide();\n        }\n\n        if (widgets.bc === true) {\n            this._bottomCenterWidget.transformByState({ height: size, width: size, left: position.center, top: position.bottom, strokeWidth: widgetStrokeWidth });\n            this._bottomCenterWidget.show();\n        } else {\n            this._bottomCenterWidget.hide();\n        }\n\n        if (widgets.br === true) {\n            this._bottomRightWidget.transformByState({ height: size, width: size, left: position.right, top: position.bottom, strokeWidth: widgetStrokeWidth });\n            this._bottomRightWidget.show();\n        } else {\n            this._bottomRightWidget.hide();\n        }\n    }\n\n    protected _hasWidgets(widgets: ISelectionWidgetConfig): boolean {\n        if (widgets == null) {\n            return false;\n        }\n\n        const keys = Object.keys(widgets);\n\n        if (keys.length === 0) {\n            return false;\n        }\n\n        for (const key of keys) {\n            if (widgets[key as keyof ISelectionWidgetConfig] === true) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    private _getScale(): number {\n        const { scaleX, scaleY } = this._scene.getAncestorScale();\n        return Math.max(scaleX, scaleY);\n    }\n\n    private _antLineOffset = 0;\n    private _antRequestNewFrame: number = -1;\n\n    private _stopAntLineAnimation(): void {\n        this._antLineOffset = 0;\n        cancelRequestFrame(this._antRequestNewFrame);\n    }\n\n    private _startAntLineAnimation(): void {\n        const scale = this._getScale();\n        this._antLineOffset += 0.6 / scale;\n        if (this._antLineOffset > 160 / scale) {\n            this._antLineOffset = 0;\n        }\n        this.dashedRect.setProps({\n            strokeDashOffset: -this._antLineOffset,\n        });\n        this._antRequestNewFrame = requestNewFrame(() => {\n            this._startAntLineAnimation();\n        });\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Tools } from '@univerjs/core';\nimport type { Engine, UniverRenderingContext } from '@univerjs/engine-render';\nimport { Layer } from '@univerjs/engine-render';\n\nexport class SelectionLayer extends Layer {\n    override render(ctx?: UniverRenderingContext, isMaxLayer = false) {\n        const startTime = Tools.now();\n        super.render(ctx, isMaxLayer);\n        this._afterRender(startTime);\n        return this;\n    }\n\n    _afterRender(startTime: number) {\n        const engine = this.scene.getEngine() as Engine;\n        engine.renderFrameTimeMetric$.next(['selectionLayer', Tools.now() - startTime]);\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type {\n    ICellInfo,\n    ICellWithCoord,\n    IContextService,\n    IDisposable,\n    IFreeze,\n    IInterceptor,\n    Injector,\n    IRange,\n    IRangeWithCoord,\n    IStyleSheet,\n    Nullable,\n} from '@univerjs/core';\nimport type { IMouseEvent, IPointerEvent, IRenderModule, Scene, SpreadsheetSkeleton, Viewport } from '@univerjs/engine-render';\nimport type { ISelectionStyle, ISelectionWithCoord, ISelectionWithStyle } from '@univerjs/sheets';\nimport type { IShortcutService } from '@univerjs/ui';\nimport type { Observable, Subscription } from 'rxjs';\nimport type { SheetSkeletonManagerService } from '../sheet-skeleton-manager.service';\nimport {\n    convertCellToRange,\n    createIdentifier,\n    Disposable,\n    InterceptorManager,\n    RANGE_TYPE,\n    ThemeService,\n} from '@univerjs/core';\n\nimport { ScrollTimer, ScrollTimerType, SHEET_VIEWPORT_KEY, Vector2 } from '@univerjs/engine-render';\nimport { REF_SELECTIONS_ENABLED, SELECTIONS_ENABLED } from '@univerjs/sheets';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport { SHEET_COMPONENT_SELECTION_LAYER_INDEX } from '../../common/keys';\nimport { genNormalSelectionStyle, RANGE_FILL_PERMISSION_CHECK, RANGE_MOVE_PERMISSION_CHECK } from './const';\nimport { SelectionControl } from './selection-control';\nimport { SelectionLayer } from './selection-layer';\nimport { attachPrimaryWithCoord, attachSelectionWithCoord } from './util';\n\nexport interface IControlFillConfig {\n    oldRange: IRange;\n    newRange: IRange;\n}\n\nexport interface ISheetSelectionRenderService {\n    readonly selectionMoveEnd$: Observable<ISelectionWithCoord[]>;\n    readonly controlFillConfig$: Observable<IControlFillConfig | null>;\n    readonly selectionMoving$: Observable<ISelectionWithCoord[]>;\n    readonly selectionMoveStart$: Observable<ISelectionWithCoord[]>;\n\n    get selectionMoving(): boolean;\n\n    interceptor: InterceptorManager<{\n        RANGE_MOVE_PERMISSION_CHECK: IInterceptor<boolean, null>;\n        RANGE_FILL_PERMISSION_CHECK: IInterceptor<boolean, { x: number; y: number; skeleton: SpreadsheetSkeleton; scene: Scene }>;\n    }>;\n\n    /** @deprecated This should not be provided by the selection render service. */\n    getViewPort(): Viewport; // AutoFill\n\n    getSkeleton(): SpreadsheetSkeleton;\n\n    getSelectionControls(): SelectionControl[];\n\n    // The following methods are used to get range locations in a worksheet. Though `attachRangeWithCoord` should not happens here.\n    // And `attachPrimaryWithCoord` is redundant.\n\n    /** @deprecated Use the function `attachSelectionWithCoord` instead. */\n    attachSelectionWithCoord(selectionWithStyle: ISelectionWithStyle): ISelectionWithCoord;\n    /** @deprecated Use the function `attachPrimaryWithCoord` instead`. */\n    attachPrimaryWithCoord(primary: Nullable<Partial<ICellInfo>>): Nullable<ICellWithCoord>;\n\n    /**\n     * @deprecated Please use `getCellWithCoordByOffset` instead.\n     */\n    getSelectionCellByPosition(x: number, y: number): ICellWithCoord;\n\n    getCellWithCoordByOffset(x: number, y: number, skeleton?: SpreadsheetSkeleton): Nullable<ICellWithCoord>; // drawing\n\n    setSingleSelectionEnabled(enabled: boolean): void;\n\n    refreshSelectionMoveEnd(): void;\n\n    resetSelectionsByModelData(selectionsWithStyleList: readonly ISelectionWithStyle[]): void;\n}\n\nexport const ISheetSelectionRenderService = createIdentifier<ISheetSelectionRenderService>('univer.sheet.selection-render-service');\n\n/**\n * The basic implementation of selection rendering logics. It is designed to be reused for different purposes.\n */\nexport class BaseSelectionRenderService extends Disposable implements ISheetSelectionRenderService, IRenderModule {\n    private _downObserver: Nullable<Subscription>;\n    protected _scenePointerMoveSub: Nullable<Subscription>;\n    protected _scenePointerUpSub: Nullable<Subscription>;\n\n    private _controlFillConfig$: BehaviorSubject<IControlFillConfig | null> =\n        new BehaviorSubject<IControlFillConfig | null>(null);\n\n    readonly controlFillConfig$ = this._controlFillConfig$.asObservable();\n\n    protected _selectionControls: SelectionControl[] = []; // sheetID:Controls\n\n    protected _startRangeWhenPointerDown: IRangeWithCoord = {\n        startY: 0,\n        endY: 0,\n        startX: 0,\n        endX: 0,\n        startRow: -1,\n        endRow: -1,\n        startColumn: -1,\n        endColumn: -1,\n    };\n\n    protected _activeControlIndex = -1;\n\n    /**\n     * the posX of viewport when the pointer down\n     */\n    protected _startViewportPosX: number = 0;\n\n    /**\n     * the posY of viewport when the pointer down\n     */\n    protected _startViewportPosY: number = 0;\n\n    protected _scrollTimer!: ScrollTimer;\n\n    private _cancelDownSubscription: Nullable<Subscription>;\n    private _cancelUpSubscription: Nullable<Subscription>;\n\n    protected _skeleton!: SpreadsheetSkeleton;\n\n    /**\n     * From renderContext.\n     */\n    protected _scene!: Scene;\n\n    // The type of selector determines the type of data range and the highlighting style of the title bar, now it always true. In future, this could be configurable by user.\n    protected _highlightHeader: boolean = true;\n\n    // protected _shouldDetectMergedCells: boolean = true;\n    protected _rangeType: RANGE_TYPE = RANGE_TYPE.NORMAL;\n\n    // The style of the selection area, including dashed lines, color, thickness, autofill, other points for modifying the range of the selection area, title highlighting, and so on, can all be customized.\n    protected _selectionStyle!: ISelectionStyle;\n\n    // #region ref range selection\n    // we put the properties here for simplicity\n    // Used in the formula selection feature, a new selection string is added by drawing a box with the mouse.\n    protected _remainLastEnabled: boolean = false;\n    protected _skipLastEnabled: boolean = false;\n    protected _singleSelectionEnabled: boolean = false;\n    // #endregion\n\n    /**\n     * Mainly emit by pointerup in spreadsheet. (pointerup is handled in _onPointerdown)\n     */\n    protected readonly _selectionMoveEnd$ = new BehaviorSubject<ISelectionWithCoord[]>([]);\n    /**\n     * Pointerup in spreadsheet\n     */\n    readonly selectionMoveEnd$ = this._selectionMoveEnd$.asObservable();\n    /**\n     * Mainly emit by pointermove in spreadsheet\n     */\n    protected readonly _selectionMoving$ = new Subject<ISelectionWithCoord[]>();\n    /**\n     * Pointermove in spreadsheet\n     */\n    readonly selectionMoving$ = this._selectionMoving$.asObservable();\n    protected readonly _selectionMoveStart$ = new Subject<ISelectionWithCoord[]>();\n    readonly selectionMoveStart$ = this._selectionMoveStart$.asObservable();\n\n    private _selectionMoving = false;\n    protected _selectionTheme: ThemeService;\n    get selectionMoving(): boolean {\n        return this._selectionMoving;\n    }\n\n    protected _activeViewport: Nullable<Viewport>;\n\n    readonly interceptor = new InterceptorManager({ RANGE_MOVE_PERMISSION_CHECK, RANGE_FILL_PERMISSION_CHECK });\n\n    protected _escapeShortcutDisposable: Nullable<IDisposable> = null;\n\n    constructor(\n        protected readonly _injector: Injector,\n        protected readonly _themeService: ThemeService,\n        // WTF: why shortcutService is injected here?\n        protected readonly _shortcutService: IShortcutService,\n        protected readonly _sheetSkeletonManagerService: SheetSkeletonManagerService,\n        protected readonly contextService: IContextService\n\n    ) {\n        super();\n        // this._resetSelectionStyle();\n        this._initSelectionThemeFromThemeService();\n        this._initMoving();\n    }\n\n    /**\n     * If true, the selector will respond to the range of merged cells and automatically extend the selected range. If false, it will ignore the merged cells.\n     */\n    private get _shouldDetectMergedCells(): boolean {\n        return this._rangeType === RANGE_TYPE.NORMAL;\n    }\n\n    private _initMoving(): void {\n        this.disposeWithMe(this._selectionMoving$.subscribe(() => {\n            this._selectionMoving = true;\n        }));\n\n        this.disposeWithMe(this._selectionMoveEnd$.subscribe(() => {\n            this._selectionMoving = false;\n        }));\n    }\n\n    protected _setSelectionStyle(style: ISelectionStyle): void {\n        this._selectionStyle = style;\n    }\n\n    /**\n     * Reset this._selectionStyle to default normal selection style\n     */\n    // protected _resetSelectionStyle(): void {\n    //     this._setSelectionStyle(genNormalSelectionStyle(this._themeService));\n    // }\n\n    /** @deprecated This should not be provided by the selection render service. */\n    getViewPort(): Viewport {\n        return this._activeViewport!;\n    }\n\n    setSingleSelectionEnabled(enabled: boolean = false): void {\n        this._singleSelectionEnabled = enabled;\n    }\n\n    newSelectionControl(scene: Scene, skeleton: SpreadsheetSkeleton, selection: ISelectionWithStyle): SelectionControl {\n        const zIndex = this.getSelectionControls().length;\n        const { rowHeaderWidth, columnHeaderHeight } = skeleton;\n        const control = new SelectionControl(scene, zIndex, this._selectionTheme, {\n            highlightHeader: this._highlightHeader,\n            rowHeaderWidth,\n            columnHeaderHeight,\n        });\n        this._selectionControls.push(control);\n        const selectionWithCoord = attachSelectionWithCoord(selection, skeleton);\n        control.updateRangeBySelectionWithCoord(selectionWithCoord, skeleton);\n        control.setControlExtension({\n            skeleton,\n            scene,\n            themeService: this._selectionTheme,\n            injector: this._injector,\n            selectionHooks: {\n                selectionMoveEnd: (): void => {\n                    this._selectionMoveEnd$.next(this.getSelectionDataWithStyle());\n                },\n            },\n        });\n\n        return control;\n    }\n\n    /**\n     * Update the corresponding selectionControl based on selectionsData from WorkbookSelectionModel\n     * selectionData[i] --> selectionControls[i]\n     * @param selectionsWithStyleList {ISelectionWithStyle[]} selectionsData from WorkbookSelectionModel\n     */\n    resetSelectionsByModelData(selectionsWithStyleList: readonly ISelectionWithStyle[]): void {\n        const allSelectionControls = this.getSelectionControls();\n        const skeleton = this._skeleton;\n        if (!allSelectionControls || !skeleton) {\n            return;\n        }\n\n        for (let i = 0, len = selectionsWithStyleList.length; i < len; i++) {\n            const selectionWithStyle = selectionsWithStyleList[i];\n            const selectionWithCoord = attachSelectionWithCoord(selectionWithStyle, this._skeleton);\n            const control = allSelectionControls[i];\n\n            if (control) {\n                control.updateRangeBySelectionWithCoord(selectionWithCoord, skeleton);\n            } else {\n                if (this.isSelectionEnabled()) {\n                    this.newSelectionControl(this._scene!, skeleton, selectionWithStyle);\n                }\n            }\n        }\n        if (selectionsWithStyleList.length < allSelectionControls.length) {\n            const controlsToDestroy = allSelectionControls.splice(selectionsWithStyleList.length);\n            controlsToDestroy.forEach((control) => control.dispose());\n        }\n    }\n\n    refreshSelectionMoveStart(): void {\n        this._selectionMoveStart$.next(this.getSelectionDataWithStyle());\n    }\n\n    refreshSelectionMoveEnd(): void {\n        this._selectionMoveEnd$.next(this.getSelectionDataWithStyle());\n    }\n\n    _initSelectionThemeFromThemeService() {\n        const currTheme = this._themeService.getCurrentTheme();\n        this._selectionTheme = new ThemeService();\n        this._selectionTheme.setTheme(currTheme);\n    }\n\n    setSelectionTheme(prop: IStyleSheet) {\n        this._selectionTheme.setTheme(prop);\n    }\n\n    protected _changeRuntime(skeleton: SpreadsheetSkeleton, scene: Scene, viewport?: Viewport): void {\n        this._skeleton = skeleton;\n        this._scene = scene;\n        this._activeViewport = viewport || scene?.getViewports()[0];\n\n        if (!scene.findLayerByZIndex(SHEET_COMPONENT_SELECTION_LAYER_INDEX)) {\n            scene.addLayer(new SelectionLayer(scene, [], SHEET_COMPONENT_SELECTION_LAYER_INDEX));\n        }\n    }\n\n    getSkeleton(): SpreadsheetSkeleton {\n        return this._skeleton;\n    }\n\n    /**\n     * Generate selectionData from this._selectionControls.model .\n     * @returns {ISelectionWithCoord[]} {range, primary, style}[]\n     */\n    getSelectionDataWithStyle(): ISelectionWithCoord[] {\n        const selectionControls = this._selectionControls;\n        const [unitId, sheetId] = this._skeleton.getLocation();\n        return selectionControls.map((control) => {\n            const v = control.getValue();\n            v.rangeWithCoord.sheetId = sheetId;\n            v.rangeWithCoord.unitId = unitId;\n            return v;\n        });\n    }\n\n    /**\n     * @TODO lumixraku DO NOT expose private props.\n     */\n    getSelectionControls(): SelectionControl[] {\n        return this._selectionControls;\n    }\n\n    /**\n     * Add a selection in spreadsheet, create a new SelectionControl and then update this control by range derives from selection.\n     * @param {ISelectionWithCoord} selectionWithStyle\n     */\n    protected _addSelectionControlByModelData(selectionWithStyle: ISelectionWithStyle): SelectionControl {\n        const skeleton = this._skeleton;\n        const style = selectionWithStyle.style ?? genNormalSelectionStyle(this._selectionTheme);\n        const scene = this._scene;\n\n        selectionWithStyle.style = style;\n        const control = this.newSelectionControl(scene, skeleton, selectionWithStyle);\n        return control;\n    }\n\n    protected _clearAllSelectionControls(): void {\n        const allSelectionControls = this._selectionControls;\n        for (const control of allSelectionControls) {\n            control.dispose();\n        }\n\n        this._selectionControls.length = 0; // clear currentSelectionControls\n    }\n\n    protected _getFreeze(): Nullable<IFreeze> {\n        const freeze = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton.getWorksheetConfig().freeze;\n        return freeze;\n    }\n\n    protected _getViewportByCell(row?: number, column?: number): Nullable<Viewport> {\n        if (row === undefined || column === undefined) {\n            return null;\n        }\n        const freeze = this._getFreeze();\n        if (!freeze || (freeze.startRow <= 0 && freeze.startColumn <= 0)) {\n            return this._scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n        }\n\n        if (row > freeze.startRow && column > freeze.startColumn) {\n            return this._scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n        }\n\n        if (row <= freeze.startRow && column <= freeze.startColumn) {\n            return this._scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP);\n        }\n\n        if (row <= freeze.startRow && column > freeze.startColumn) {\n            return this._scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP);\n        }\n\n        if (row > freeze.startRow && column <= freeze.startColumn) {\n            return this._scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT);\n        }\n    }\n\n    /**\n     * Returns the selected range in the active sheet, or null if there is no active range. If multiple ranges are selected this method returns only the last selected range.\n     */\n    getActiveRange(): Nullable<IRange> {\n        const controls = this.getSelectionControls();\n        const model = controls && controls[controls.length - 1].model;\n        return (\n            model && {\n                startRow: model.startRow,\n                startColumn: model.startColumn,\n                endRow: model.endRow,\n                endColumn: model.endColumn,\n            }\n        );\n    }\n\n    setActiveSelectionIndex(index: number) {\n        this._activeControlIndex = index;\n    }\n\n    resetActiveSelectionIndex(): void {\n        this._activeControlIndex = -1;\n    }\n\n    /**\n     * get active(actually last) selection control\n     * @returns T extends SelectionControl\n     */\n    getActiveSelectionControl<T extends SelectionControl = SelectionControl>(): Nullable<T> {\n        const controls = this.getSelectionControls();\n        if (controls) {\n            if (this._activeControlIndex < 0) {\n                return controls[controls.length - 1] as T;\n            }\n\n            return controls[this._activeControlIndex] as T;\n        }\n    }\n\n    endSelection(): void {\n        this._clearUpdatingListeners();\n        this._selectionMoveEnd$.next(this.getSelectionDataWithStyle());\n\n        // when selection mouse up, enable the short cut service\n        this._escapeShortcutDisposable?.dispose();\n        this._escapeShortcutDisposable = null;\n    }\n\n    /**\n     * Clear existed selections by workbookSelections.selectionMoveEnd$\n     */\n    protected _reset(): void {\n        this._clearAllSelectionControls();\n        this._downObserver?.unsubscribe();\n        this._downObserver = null;\n    }\n\n    /**\n     * Init pointer move listener in each pointer down, unbind in each pointer up.\n     * Both cell selections and row-column selections are supported by this method.\n     * @param viewportMain\n     * @param activeSelectionControl\n     * @param rangeType\n     * @param scrollTimerType\n     * @param moveStartPosX\n     * @param moveStartPosY\n     */\n    protected _setupPointerMoveListener(\n        viewportMain: Nullable<Viewport>,\n        activeSelectionControl: SelectionControl,\n        rangeType: RANGE_TYPE,\n        scrollTimerType: ScrollTimerType = ScrollTimerType.ALL,\n        moveStartPosX: number,\n        moveStartPosY: number\n    ): void {\n        let xCrossTime = 0;\n        let yCrossTime = 0;\n        let lastX = moveStartPosX;\n        let lastY = moveStartPosY;\n        this._scrollTimer = ScrollTimer.create(this._scene, scrollTimerType);\n        this._scrollTimer.startScroll(viewportMain?.left ?? 0, viewportMain?.top ?? 0, viewportMain);\n\n        const scene = this._scene;\n        const startViewport = scene.getActiveViewportByCoord(Vector2.FromArray([moveStartPosX, moveStartPosY]));\n\n        // #region onPointerMove$\n        // eslint-disable-next-line complexity\n        this._scenePointerMoveSub = scene.onPointerMove$.subscribeEvent((moveEvt: IPointerEvent | IMouseEvent) => {\n            const { offsetX: moveOffsetX, offsetY: moveOffsetY } = moveEvt;\n\n            const { x: newMoveOffsetX, y: newMoveOffsetY } = scene.getCoordRelativeToViewport(Vector2.FromArray([moveOffsetX, moveOffsetY]));\n\n            this._movingHandler(newMoveOffsetX, newMoveOffsetY, activeSelectionControl, rangeType);\n\n            let scrollOffsetX = newMoveOffsetX;\n            let scrollOffsetY = newMoveOffsetY;\n\n            //#region selection cross freezing line\n            const currentSelection = this.getActiveSelectionControl();\n            const freeze = this._getFreeze();\n\n            const selection = currentSelection?.model;\n            const endViewport =\n                scene.getActiveViewportByCoord(Vector2.FromArray([moveOffsetX, moveOffsetY])) ??\n                this._getViewportByCell(selection?.endRow, selection?.endColumn);\n\n            // find viewports that can be crossed by selection.\n            const isCrossableViewports = () => {\n                if (!startViewport || !endViewport || !viewportMain) {\n                    return false;\n                }\n                const crossableViewports = [SHEET_VIEWPORT_KEY.VIEW_MAIN, SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP, SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP, SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT] as string[];\n                return crossableViewports.includes(startViewport.viewportKey) && crossableViewports.includes(endViewport.viewportKey);\n            };\n            if (isCrossableViewports()) {\n                if (!startViewport || !endViewport || !viewportMain) {\n                    return false;\n                }\n\n                const isCrossingX =\n                    (lastX < viewportMain.left && newMoveOffsetX > viewportMain.left) ||\n                    (lastX > viewportMain.left && newMoveOffsetX < viewportMain.left);\n                const isCrossingY =\n                    (lastY < viewportMain.top && newMoveOffsetY > viewportMain.top) ||\n                    (lastY > viewportMain.top && newMoveOffsetY < viewportMain.top);\n                if (isCrossingX) {\n                    xCrossTime += 1;\n                }\n\n                if (isCrossingY) {\n                    yCrossTime += 1;\n                }\n\n                const startKey = startViewport.viewportKey;\n                const endKey = endViewport.viewportKey;\n\n                if (startKey === SHEET_VIEWPORT_KEY.VIEW_ROW_TOP) {\n                    if (moveOffsetY < viewportMain.top && (selection?.endRow ?? 0) < (freeze?.startRow ?? 0)) {\n                        scrollOffsetY = viewportMain.top;\n                    } else if (isCrossingY && yCrossTime % 2 === 1) {\n                        viewportMain.scrollToViewportPos({\n                            viewportScrollY: 0,\n                        });\n                    }\n                } else if (startKey === SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT) {\n                    if (moveOffsetX < viewportMain.left && (selection?.endColumn ?? 0) < (freeze?.startColumn ?? 0)) {\n                        scrollOffsetX = viewportMain.left;\n                    } else if (isCrossingX && xCrossTime % 2 === 1) {\n                        viewportMain.scrollToViewportPos({\n                            viewportScrollX: 0,\n                        });\n                    }\n                } else if (startKey === endKey) {\n                    let disableX = false;\n                    let disableY = false;\n                    if (startKey === SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP) {\n                        disableX = true;\n                        disableY = true;\n                    } else if (startKey === SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP) {\n                        disableY = true;\n                    } else if (startKey === SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT) {\n                        disableX = true;\n                    }\n\n                    if ((selection?.endRow ?? 0) > (freeze?.startRow ?? 0)) {\n                        disableY = false;\n                    }\n\n                    if ((selection?.endColumn ?? 0) > (freeze?.startColumn ?? 0)) {\n                        disableX = false;\n                    }\n                    if (disableX) {\n                        scrollOffsetX = viewportMain.left;\n                    }\n\n                    if (disableY) {\n                        scrollOffsetY = viewportMain.top;\n                    }\n                } else {\n                    const startXY = {\n                        x: startViewport.scrollX,\n                        y: startViewport.scrollY,\n                    };\n                    const endXY = {\n                        x: endViewport.scrollX,\n                        y: endViewport.scrollY,\n                    };\n                    const shouldResetX = startXY.x !== endXY.x && isCrossingX && xCrossTime % 2 === 1;\n                    const shouldResetY = startXY.y !== endXY.y && isCrossingY && yCrossTime % 2 === 1;\n\n                    if (shouldResetX || shouldResetY) {\n                        viewportMain.scrollToBarPos({\n                            x: shouldResetX ? startXY.x : undefined,\n                            y: shouldResetY ? startXY.y : undefined,\n                        });\n\n                        if (!shouldResetX) {\n                            scrollOffsetX = viewportMain.left;\n                        }\n\n                        if (!shouldResetY) {\n                            scrollOffsetY = viewportMain.top;\n                        }\n                    }\n\n                    if (\n                        (startKey === SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP && endKey === SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT) ||\n                        (endKey === SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP && startKey === SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT)\n                    ) {\n                        scrollOffsetX = viewportMain.left;\n                    }\n\n                    if (\n                        (startKey === SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP && endKey === SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP) ||\n                        (endKey === SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP && startKey === SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP)\n                    ) {\n                        scrollOffsetY = viewportMain.top;\n                    }\n                }\n\n                lastX = newMoveOffsetX;\n                lastY = newMoveOffsetY;\n            }\n            //#endregion\n\n            //#region auto scrolling\n            this._scrollTimer.scrolling(scrollOffsetX, scrollOffsetY, () => {\n                this._movingHandler(newMoveOffsetX, newMoveOffsetY, activeSelectionControl, rangeType);\n            });\n            //#endregion\n        });\n        // #endregion\n    }\n\n    /** @deprecated Use the function `attachSelectionWithCoord` instead`. */\n    attachSelectionWithCoord(selectionWithStyle: ISelectionWithStyle): ISelectionWithCoord {\n        return attachSelectionWithCoord(selectionWithStyle, this._skeleton);\n    }\n\n    /** @deprecated Use the function `attachPrimaryWithCoord` instead`. */\n    attachPrimaryWithCoord(primary: ICellInfo): ICellWithCoord {\n        return attachPrimaryWithCoord(this._skeleton, primary) as unknown as ICellWithCoord;\n    }\n\n    /**\n     * @deprecated Please use `getCellWithCoordByOffset` instead.\n     */\n    getSelectionCellByPosition(x: number, y: number): ICellWithCoord {\n        return this.getCellWithCoordByOffset(x, y);\n    }\n\n    getCellWithCoordByOffset(x: number, y: number, skeletonParam?: SpreadsheetSkeleton): ICellWithCoord {\n        const scene = this._scene;\n        const skeleton = skeletonParam ?? this._skeleton;\n        const scrollXY = scene.getViewportScrollXY(scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN)!);\n        const { scaleX, scaleY } = scene.getAncestorScale();\n\n        return skeleton.getCellWithCoordByOffset(x, y, scaleX, scaleY, scrollXY);\n    }\n\n    /**\n     * When mousedown and mouseup need to go to the coordination and undo stack, when mousemove does not need to go to the coordination and undo stack\n     */\n\n    protected _movingHandler(\n        offsetX: number,\n        offsetY: number,\n        activeSelectionControl: Nullable<SelectionControl>,\n        rangeType: RANGE_TYPE\n    ): void {\n        const skeleton = this._skeleton;\n        const scene = this._scene;\n        const [unitId, sheetId] = skeleton.getLocation();\n\n        const currSelectionRange: IRange = {\n            startRow: activeSelectionControl?.model.startRow ?? -1,\n            endRow: activeSelectionControl?.model.endRow ?? -1,\n            startColumn: activeSelectionControl?.model.startColumn ?? -1,\n            endColumn: activeSelectionControl?.model.endColumn ?? -1,\n            unitId,\n            sheetId,\n        };\n\n        const viewportMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN)!;\n        const targetViewport = this._getViewportByCell(currSelectionRange.endRow, currSelectionRange.endColumn) ?? viewportMain;\n\n        const scrollXY = scene.getScrollXYInfoByViewport(\n            Vector2.FromArray([this._startViewportPosX, this._startViewportPosY]),\n            targetViewport\n        );\n\n        const { scaleX, scaleY } = scene.getAncestorScale();\n\n        if (rangeType === RANGE_TYPE.ROW) {\n            // eslint-disable-next-line no-param-reassign\n            offsetX = Number.POSITIVE_INFINITY;\n        } else if (rangeType === RANGE_TYPE.COLUMN) {\n            // eslint-disable-next-line no-param-reassign\n            offsetY = Number.POSITIVE_INFINITY;\n        }\n\n        const currCell = this._skeleton.getCellByOffset(offsetX, offsetY, scaleX, scaleY, scrollXY);\n        if (!currCell) {\n            return;\n        }\n\n        let newSelectionRange: IRange = {\n            startRow: Math.min(currCell.startRow, this._startRangeWhenPointerDown.startRow),\n            startColumn: Math.min(currCell.startColumn, this._startRangeWhenPointerDown.startColumn),\n            endRow: Math.max(currCell.endRow, this._startRangeWhenPointerDown.endRow),\n            endColumn: Math.max(currCell.endColumn, this._startRangeWhenPointerDown.endColumn),\n        };\n\n        if (this._shouldDetectMergedCells) {\n            newSelectionRange = skeleton.expandRangeByMerge(newSelectionRange);\n        }\n        const newSelection: ISelectionWithStyle = { range: newSelectionRange, primary: undefined, style: null };\n        const newSelectionRangeWithCoord = attachSelectionWithCoord(newSelection, skeleton);\n        newSelectionRangeWithCoord.rangeWithCoord.unitId = unitId;\n        newSelectionRangeWithCoord.rangeWithCoord.sheetId = sheetId;\n        newSelectionRangeWithCoord.rangeWithCoord.rangeType = rangeType;\n        // const startCellXY = skeleton.getNoMergeCellPositionByIndex(newSelectionRange.startRow, newSelectionRange.startColumn);\n        // const endCellXY = skeleton.getNoMergeCellPositionByIndex(newSelectionRange.endRow, newSelectionRange.endColumn);\n\n        // Only notify when the selection changes\n        const rangeChanged =\n            currSelectionRange.startRow !== newSelectionRange.startRow ||\n            currSelectionRange.startColumn !== newSelectionRange.startColumn ||\n            currSelectionRange.endRow !== newSelectionRange.endRow ||\n            currSelectionRange.endColumn !== newSelectionRange.endColumn;\n        if (activeSelectionControl != null && rangeChanged) {\n            activeSelectionControl.updateRangeBySelectionWithCoord(newSelectionRangeWithCoord);\n            this._selectionMoving$.next(this.getSelectionDataWithStyle());\n        }\n    }\n\n    protected _clearUpdatingListeners(): void {\n        const scene = this._scene;\n        scene.enableObjectsEvent();\n\n        this._scenePointerMoveSub?.unsubscribe();\n        this._scenePointerMoveSub = null;\n        this._scenePointerUpSub?.unsubscribe();\n        this._scenePointerUpSub = null;\n        this._cancelDownSubscription?.unsubscribe();\n        this._cancelDownSubscription = null;\n        this._cancelUpSubscription?.unsubscribe();\n        this._cancelUpSubscription = null;\n        this._scrollTimer?.dispose();\n    }\n\n    protected _addEndingListeners(): void {\n        const scene = this._scene!;\n        const mainScene = scene.getEngine()?.activeScene;\n        if (!mainScene || mainScene === scene) {\n            return;\n        }\n\n        this._cancelDownSubscription?.unsubscribe();\n        this._cancelDownSubscription = null;\n        this._cancelUpSubscription?.unsubscribe();\n        this._cancelUpSubscription = null;\n\n        this._cancelDownSubscription = mainScene.onPointerDown$.subscribeEvent(() => this._clearUpdatingListeners());\n        this._cancelUpSubscription = mainScene.onPointerUp$.subscribeEvent(() => this._clearUpdatingListeners());\n    }\n\n    /**\n     * Get visible selection range & coord by offset on viewport. Nearly same as skeleton.getCellWithCoordByOffset\n     * Returning selection is only one cell. primary and range are same cell.\n     *\n     * visible selection range means getCellWithCoordByOffset needs first matched row/col in rowHeightAccumulation & colWidthAccumulation.\n     * Original name: _getCellRangeByCursorPosition\n     *\n     * @param offsetX position X in viewport.\n     * @param offsetY\n     * @param scaleX\n     * @param scaleY\n     * @param scrollXY\n     * @returns {Nullable<ISelectionWithCoord>} selection range with coord.\n     */\n    protected _getSelectionWithCoordByOffset(\n        offsetX: number,\n        offsetY: number,\n        scaleX: number,\n        scaleY: number,\n        scrollXY: { x: number; y: number }\n    ): Nullable<ISelectionWithCoord> {\n        const skeleton = this._skeleton;\n        if (skeleton == null) return null;\n\n        //#region normal selection\n        if (this._shouldDetectMergedCells) {\n            const primaryWithCoord = skeleton?.getCellWithCoordByOffset(\n                offsetX,\n                offsetY,\n                scaleX,\n                scaleY,\n                scrollXY,\n                { firstMatch: true } // for visible\n            );\n\n            if (!primaryWithCoord) return;\n\n            const rangeWithCoord = convertCellToRange(primaryWithCoord);\n            return {\n                primaryWithCoord,\n                rangeWithCoord,\n            };\n        }\n        //#endregion\n\n        //@region other range type\n        const { row, column } = skeleton.getCellIndexByOffset(offsetX, offsetY, scaleX, scaleY, scrollXY);\n        const startCell = skeleton.getNoMergeCellWithCoordByIndex(row, column);\n        const { startX, startY, endX, endY } = startCell;\n\n        const rangeWithCoord: IRangeWithCoord = {\n            startY,\n            endY,\n            startX,\n            endX,\n            startRow: row,\n            endRow: row,\n            startColumn: column,\n            endColumn: column,\n        };\n\n        const primaryWithCoord: Nullable<ICellWithCoord> = {\n            mergeInfo: rangeWithCoord,\n            actualRow: row,\n            actualColumn: column,\n            isMerged: false,\n            isMergedMainCell: false,\n            startY,\n            endY,\n            startX,\n            endX,\n        };\n\n        return {\n            primaryWithCoord,\n            rangeWithCoord,\n        };\n        //#endregion\n    }\n\n    protected _checkClearPreviousControls(evt: IPointerEvent | IMouseEvent): void {\n        const curControls = this.getSelectionControls();\n        if (curControls.length === 0) return;\n\n        // In addition to pressing the ctrl or shift key, we must clear the previous selection.\n        if (\n            (!evt.ctrlKey && !evt.shiftKey && !this._remainLastEnabled) ||\n            (this._singleSelectionEnabled && !evt.shiftKey)\n        ) {\n            this._clearAllSelectionControls();\n        }\n    }\n\n    protected _makeSelectionByTwoCells(\n        currentCell: ICellWithCoord,\n        startSelectionRange: IRangeWithCoord,\n        skeleton: SpreadsheetSkeleton,\n        rangeType: RANGE_TYPE,\n        activeControl: SelectionControl\n    ): void {\n        const { actualRow, actualColumn, mergeInfo: actualMergeInfo } = currentCell;\n        this._startRangeWhenPointerDown = { ...currentCell.mergeInfo };\n\n        // Get the maximum range selected based on the two cells selected with Shift key.\n        const newStartRow = Math.min(actualRow, startSelectionRange.startRow, actualMergeInfo.startRow);\n        const newEndRow = Math.max(actualRow, startSelectionRange.endRow, actualMergeInfo.endRow);\n        const newStartColumn = Math.min(actualColumn, startSelectionRange.startColumn, actualMergeInfo.startColumn);\n        const newEndColumn = Math.max(actualColumn, startSelectionRange.endColumn, actualMergeInfo.endColumn);\n\n        /**\n         * Calculate whether there are merged cells within the range. If there are, recursively expand the selection again.\n         */\n        const range = skeleton.expandRangeByMerge({\n            startRow: newStartRow,\n            startColumn: newStartColumn,\n            endRow: newEndRow,\n            endColumn: newEndColumn,\n        });\n        const selectionWithStyle = {\n            range,\n            primary: null,\n            style: null,\n        };\n        const selectionWithCoord = attachSelectionWithCoord(selectionWithStyle, skeleton);\n        activeControl.updateRangeBySelectionWithCoord(selectionWithCoord);\n        // const startCell = skeleton.getNoMergeCellPositionByIndex(range.startRow, range.startColumn);\n        // const endCell = skeleton.getNoMergeCellPositionByIndex(range.endRow, range.endColumn);\n        // const newSelectionRange = {\n        //     startColumn: range.startColumn,\n        //     startRow: range.startRow,\n        //     endColumn: range.endColumn,\n        //     endRow: range.endRow,\n\n        //     startY: startCell.startY,\n        //     endY: endCell.endY,\n        //     startX: startCell.startX,\n        //     endX: endCell.endX,\n\n        //     rangeType,\n        // };\n\n        /**\n         * When expanding the selection with the Shift key,\n         * the original highlighted cell should remain unchanged.\n         * If the highlighted cell is a merged cell, the selection needs to be expanded.\n         */\n        // const activeCell = skeleton.getCellWithCoordByIndex(actualRow, actualColumn);\n\n        // activeControl.updateRange(newSelectionRange, currentCell);\n    }\n\n    isSelectionEnabled(): boolean {\n        return this.contextService.getContextValue(SELECTIONS_ENABLED);\n    }\n\n    isSelectionDisabled(): boolean {\n        return this.contextService.getContextValue(SELECTIONS_ENABLED) === false;\n    }\n\n    inRefSelectionMode(): boolean {\n        return this.contextService.getContextValue(REF_SELECTIONS_ENABLED);\n    }\n}\n\nexport function selectionDataForSelectAll(skeleton: SpreadsheetSkeleton): ISelectionWithStyle {\n    return {\n        range: {\n            startRow: 0,\n            startColumn: 0,\n            endRow: skeleton.getRowCount() - 1,\n            endColumn: skeleton.getColumnCount() - 1,\n            rangeType: RANGE_TYPE.ALL,\n        },\n        primary: getTopLeftSelectionOfCurrSheet(skeleton)!.primary,\n        style: null,\n    };\n}\n\nexport function getTopLeftSelectionOfCurrSheet(skeleton: SpreadsheetSkeleton): ISelectionWithStyle {\n    return genSelectionByRange(skeleton, {\n        startRow: 0,\n        startColumn: 0,\n        endRow: 0,\n        endColumn: 0,\n    });\n}\n\n/**\n * @deprecated use `getTopLeftSelectionOfCurrSheet` instead\n */\nconst getTopLeftSelection = getTopLeftSelectionOfCurrSheet;\nexport { getTopLeftSelection };\n\nexport function genSelectionByRange(skeleton: SpreadsheetSkeleton, range: IRange): ISelectionWithStyle {\n    const topLeftCell = skeleton.worksheet.getCellInfoInMergeData(range.startRow, range.startColumn);\n    const bottomRightCell = skeleton.worksheet.getCellInfoInMergeData(range.endRow, range.endColumn);\n    const rs = {\n        range: {\n            startRow: topLeftCell.startRow,\n            startColumn: topLeftCell.startColumn,\n            endRow: bottomRightCell.endRow,\n            endColumn: bottomRightCell.endColumn,\n            rangeType: RANGE_TYPE.NORMAL,\n        },\n        primary: {\n            actualRow: topLeftCell.startRow,\n            actualColumn: topLeftCell.startColumn,\n            startRow: topLeftCell.startRow,\n            startColumn: topLeftCell.startColumn,\n            endRow: topLeftCell.endRow,\n            endColumn: topLeftCell.endColumn,\n            isMerged: topLeftCell.isMerged,\n            isMergedMainCell: topLeftCell.isMergedMainCell,\n        },\n        style: null,\n    };\n    return rs;\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IRange, IRangeWithCoord, Nullable, Workbook, Worksheet } from '@univerjs/core';\nimport type { IRender, IRenderContext, IRenderModule, Scene } from '@univerjs/engine-render';\nimport { Disposable, Inject, Injector } from '@univerjs/core';\nimport { SHEET_VIEWPORT_KEY, SpreadsheetSkeleton } from '@univerjs/engine-render';\nimport { SheetSkeletonService, SheetsSelectionsService } from '@univerjs/sheets';\nimport { BehaviorSubject } from 'rxjs';\nimport { SetColumnHeaderHeightCommand, SetRowHeaderWidthCommand } from '../commands/commands/headersize-changed.command';\nimport { ISheetSelectionRenderService } from './selection/base-selection-render.service';\nimport { attachRangeWithCoord } from './selection/util';\n\n // Why need this SkParam? what is Param used for? Could unitId & sheetId & dirty in skeleton itself ?\nexport interface ISheetSkeletonManagerParam {\n    unitId: string;\n    sheetId: string;\n    skeleton: SpreadsheetSkeleton;\n    dirty: boolean;\n    commandId?: string;\n}\n\nexport interface ISheetSkeletonManagerSearch {\n    sheetId: string;\n    commandId?: string; // WTF: why?\n}\n\n/**\n * SheetSkeletonManagerService is registered in a render unit\n */\nexport class SheetSkeletonManagerService extends Disposable implements IRenderModule {\n    private _sheetId: string = '';\n\n    // @TODO lumixraku, why need this?  How about put dirty & sheetId & unitId in skeleton itself?\n    private _sheetSkeletonParamStore: Map<string, ISheetSkeletonManagerParam> = new Map();\n\n    private readonly _currentSkeleton$ = new BehaviorSubject<Nullable<ISheetSkeletonManagerParam>>(null);\n    readonly currentSkeleton$ = this._currentSkeleton$.asObservable();\n\n    /**\n     * CurrentSkeletonBefore for pre-triggered logic during registration\n     */\n    private readonly _currentSkeletonBefore$ = new BehaviorSubject<Nullable<ISheetSkeletonManagerParam>>(null);\n    readonly currentSkeletonBefore$ = this._currentSkeletonBefore$.asObservable();\n\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(Injector) private readonly _injector: Injector,\n        @Inject(SheetSkeletonService) private readonly _sheetSkService: SheetSkeletonService\n    ) {\n        // empty\n        super();\n\n        this.disposeWithMe(() => {\n            this._currentSkeletonBefore$.complete();\n            this._currentSkeleton$.complete();\n\n            this._sheetSkeletonParamStore.forEach((sk) => this.disposeSkeleton(sk.sheetId));\n            this._sheetSkeletonParamStore.clear();\n        });\n\n        this._initRemoveSheet();\n    }\n\n    private _initRemoveSheet() {\n        this.disposeWithMe(this._context.unit.sheetDisposed$.subscribe((sheet) => {\n            this.disposeSkeleton(sheet.getSheetId());\n        }));\n    }\n\n    getCurrentSkeleton(): Nullable<SpreadsheetSkeleton> {\n        return this.getCurrentParam()?.skeleton;\n    }\n\n    /**\n     * @deprecated use `getCurrentSkeleton` instead.\n     */\n    getCurrent(): Nullable<ISheetSkeletonManagerParam> {\n        return this.getCurrentParam();\n    }\n\n    /**\n     * get ISheetSkeletonManagerParam from _currentSkeletonSearchParam\n     * @returns\n     */\n    getCurrentParam(): Nullable<ISheetSkeletonManagerParam> {\n        return this._getSkeletonParam(this._sheetId);\n    }\n\n    /**\n     * Get skeleton by sheetId\n     * @param sheetId\n     */\n    getSkeleton(sheetId: string): Nullable<SpreadsheetSkeleton> {\n        return this._getSkeleton(sheetId);\n    }\n\n    /**\n     * Get SkeletonParam by sheetId\n     * @param sheetId\n     */\n    getSkeletonParam(sheetId: string): Nullable<ISheetSkeletonManagerParam> {\n        return this._getSkeletonParam(sheetId);\n    }\n\n    /**\n     * @deprecated use `getSkeleton` instead.\n     */\n    getWorksheetSkeleton(sheetId: string): Nullable<ISheetSkeletonManagerParam> {\n        return this.getSkeletonParam(sheetId);\n    }\n\n    // why ?? what does unitId for ??? no need unitId, this service is registered in render unit already.\n    getUnitSkeleton(unitId: string, sheetId: string): Nullable<ISheetSkeletonManagerParam> {\n        const param = this._getSkeletonParam(sheetId);\n        if (param != null) {\n            // unitId is never read?\n            param.unitId = unitId;\n        }\n        return param;\n    }\n\n    /**\n     * Command in COMMAND_LISTENER_SKELETON_CHANGE would cause setCurrent, see @packages/sheets-ui/src/controllers/render-controllers/sheet.render-controller.ts\n     * @param searchParam\n     */\n    setCurrent(searchParam: ISheetSkeletonManagerSearch): Nullable<ISheetSkeletonManagerParam> {\n        this._setCurrent(searchParam.sheetId);\n    }\n\n    setSkeletonParam(sheetId: string, skp: ISheetSkeletonManagerParam) {\n        this._sheetSkService.setSkeleton(skp.unitId, sheetId, skp.skeleton);\n        this._sheetSkeletonParamStore.set(sheetId, skp);\n    }\n\n    private _setCurrent(sheetId: string): Nullable<ISheetSkeletonManagerParam> {\n        this._sheetId = sheetId;\n        const skParam = this._getSkeletonParam(sheetId);\n        const unitId = this._context.unitId;\n        if (skParam != null) {\n            this.reCalculate(skParam);\n        } else {\n            const workbook = this._context.unit;\n            const worksheet = workbook.getSheetBySheetId(sheetId);\n            if (worksheet == null) {\n                return;\n            }\n\n            const scene = this._context.scene;\n            const skeleton = this._buildSkeleton(worksheet, scene);\n            this.setSkeletonParam(sheetId, {\n                unitId,\n                sheetId,\n                skeleton,\n                dirty: false,\n            });\n        }\n\n        const sheetSkeletonManagerParam = this._getSkeletonParam(sheetId);\n        this._currentSkeletonBefore$.next(sheetSkeletonManagerParam);\n        this._currentSkeleton$.next(sheetSkeletonManagerParam);\n    }\n\n    // @TODO why need this function? How about caller get skeleton and call sk.calculate()?\n    reCalculate(param?: Nullable<ISheetSkeletonManagerParam>) {\n        if (!param) {\n            param = this.getCurrentParam();\n        }\n        if (param == null) {\n            return;\n        }\n        if (param.dirty) {\n            param.skeleton.makeDirty(true);\n            param.dirty = false;\n        }\n        param.skeleton.calculate();\n    }\n\n    /**\n     * Make param dirty, if param is dirty, then the skeleton will be makeDirty in _reCalculate()\n     * @param searchParm\n     * @param state\n     */\n    makeDirty(searchParm: ISheetSkeletonManagerSearch, state: boolean = true) {\n        const param = this._getSkeletonParam(searchParm.sheetId);\n        if (param == null) {\n            return;\n        }\n        param.dirty = state;\n    }\n\n    /**\n     * @deprecated Use function `ensureSkeleton` instead.\n     * @param searchParam\n     */\n    getOrCreateSkeleton(searchParam: ISheetSkeletonManagerSearch) {\n        return this.ensureSkeleton(searchParam.sheetId);\n    }\n\n    ensureSkeleton(sheetId: string) {\n        const skeleton = this._getSkeletonParam(sheetId);\n        if (skeleton) {\n            return skeleton.skeleton;\n        }\n\n        const workbook = this._context.unit;\n        const worksheet = workbook.getSheetBySheetId(sheetId);\n        if (!worksheet) {\n            return;\n        }\n\n        const newSkeleton = this._buildSkeleton(worksheet);\n        this.setSkeletonParam(sheetId, {\n            unitId: this._context.unitId,\n            sheetId,\n            skeleton: newSkeleton,\n            dirty: false,\n        });\n\n        return newSkeleton;\n    }\n\n    disposeSkeleton(sheetId: string) {\n        const skParam = this.getSkeletonParam(sheetId);\n        if (skParam) {\n            skParam.skeleton.dispose();\n            this._sheetSkeletonParamStore.delete(sheetId);\n            this._sheetSkService.deleteSkeleton(skParam.unitId, sheetId);\n        }\n    }\n\n    /** @deprecated Use function `attachRangeWithCoord` instead.  */\n    attachRangeWithCoord(range: IRange): Nullable<IRangeWithCoord> {\n        const skeleton = this.getCurrentSkeleton();\n        if (!skeleton) return null;\n\n        return attachRangeWithCoord(skeleton, range);\n    }\n\n    private _getSkeletonParam(sheetId: string): Nullable<ISheetSkeletonManagerParam> {\n        const item = this._sheetSkeletonParamStore.get(sheetId);\n        return item;\n    }\n\n    private _getSkeleton(sheetId: string): Nullable<SpreadsheetSkeleton> {\n        const param = this._getSkeletonParam(sheetId);\n        return param ? param.skeleton : null;\n    }\n\n    private _buildSkeleton(worksheet: Worksheet, _scene?: Nullable<Scene>) {\n        const spreadsheetSkeleton = this._injector.createInstance(\n            SpreadsheetSkeleton,\n            worksheet,\n            this._context.unit.getStyles()\n        );\n\n        return spreadsheetSkeleton;\n    }\n\n    setColumnHeaderSize(render: Nullable<IRender>, sheetId: string, size: number) {\n        if (!render) return;\n        const skeleton = this.getWorksheetSkeleton(sheetId)?.skeleton;\n        if (!skeleton) return;\n\n        skeleton.columnHeaderHeight = size;\n        render.scene.getViewports()[0].top = size;\n        render.scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_COLUMN_RIGHT)!.setViewportSize({\n            height: size,\n        });\n        render.scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT)!.setViewportSize({\n            height: size,\n        });\n        render.scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_ROW_BOTTOM)!.setViewportSize({\n            top: size,\n        });\n        render.scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_ROW_TOP)!.setViewportSize({\n            top: size,\n        });\n        render.scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP)!.setViewportSize({\n            height: size,\n        });\n        const selectionService = render?.with(SheetsSelectionsService);\n        const selectionRenderService = render?.with(ISheetSelectionRenderService);\n        const currSelections = selectionService.getCurrentSelections();\n        selectionRenderService.resetSelectionsByModelData(currSelections);\n\n        const sheetSkeletonManagerParam = this.getUnitSkeleton(render.unitId, sheetId);\n        if (sheetSkeletonManagerParam) {\n            sheetSkeletonManagerParam.commandId = SetColumnHeaderHeightCommand.id;\n            this._currentSkeleton$.next(sheetSkeletonManagerParam);\n        }\n    }\n\n    setRowHeaderSize(render: Nullable<IRender>, sheetId: string, size: number) {\n        const skeleton = this.getWorksheetSkeleton(sheetId)?.skeleton;\n        if (!render) return;\n        if (!skeleton) return;\n        skeleton.rowHeaderWidth = size;\n        const originWidth = render.scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP)!.width || 46;\n        const deltaX = size - originWidth;\n\n        const originLeftOfViewMain = render.scene.getViewports()[0].left;\n        render.scene.getViewports()[0].left = originLeftOfViewMain + deltaX;\n\n        render.scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_ROW_BOTTOM)!.setViewportSize({\n            width: size,\n        });\n        render.scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_ROW_TOP)!.setViewportSize({\n            width: size,\n        });\n        render.scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT)!.setViewportSize({\n            left: size,\n        });\n        const prevLeft = render.scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_COLUMN_RIGHT)!.left || 0;\n        render.scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_COLUMN_RIGHT)!.setViewportSize({\n            left: prevLeft + deltaX,\n        });\n        render.scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP)!.setViewportSize({\n            width: size,\n        });\n        const selectionService = render?.with(SheetsSelectionsService);\n        const selectionRenderService = render?.with(ISheetSelectionRenderService);\n        const currSelections = selectionService.getCurrentSelections();\n        selectionRenderService.resetSelectionsByModelData(currSelections);\n\n        const sheetSkeletonManagerParam = this.getCurrent();\n        if (sheetSkeletonManagerParam) {\n            sheetSkeletonManagerParam.commandId = SetRowHeaderWidthCommand.id;\n            this._currentSkeleton$.next(sheetSkeletonManagerParam);\n        }\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { DependencyOverride } from '@univerjs/core';\nimport type { MenuConfig } from '@univerjs/ui';\n\nexport const SHEETS_UI_PLUGIN_CONFIG_KEY = 'sheets-ui.config';\n\nexport const configSymbol = Symbol(SHEETS_UI_PLUGIN_CONFIG_KEY);\n\nexport interface IUniverSheetsUIConfig {\n    menu?: MenuConfig;\n    disableAutoFocus?: true;\n    override?: DependencyOverride;\n    customComponents?: Set<string>;\n    /**\n     * The maximum count of rows triggering auto height. This is used to avoid performance issue.\n     * @default 1000\n     */\n    maxAutoHeightCount?: number;\n\n    /**\n     * Whether to show the formula bar.\n     */\n    formulaBar?: boolean;\n\n    statusBarStatistic?: boolean;\n\n    clipboardConfig?: {\n        hidePasteOptions?: boolean;\n    };\n\n}\n\nexport const defaultPluginConfig: IUniverSheetsUIConfig = {\n    formulaBar: true,\n    statusBarStatistic: true,\n    maxAutoHeightCount: 1000,\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IRange, Workbook } from '@univerjs/core';\nimport type { RenderManagerService } from '@univerjs/engine-render';\nimport type {\n    IMoveRangeCommandParams,\n    IReorderRangeMutationParams,\n    ISetRangeValuesRangeMutationParams,\n    ISetStyleCommandParams,\n    ISetWorksheetRowAutoHeightMutationParams,\n    ISetWorksheetRowIsAutoHeightMutationParams,\n} from '@univerjs/sheets';\nimport type { IUniverSheetsUIConfig } from './config.schema';\nimport { Disposable, IConfigService, Inject, IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport {\n    getSheetCommandTarget,\n    MoveRangeCommand,\n    ReorderRangeCommand,\n    SetRangeValuesCommand,\n    SetStyleCommand,\n    SetWorksheetRowAutoHeightMutation,\n    SetWorksheetRowAutoHeightMutationFactory,\n    SetWorksheetRowIsAutoHeightCommand,\n    SheetInterceptorService,\n    SheetsSelectionsService,\n} from '@univerjs/sheets';\nimport { SheetSkeletonManagerService } from '../services/sheet-skeleton-manager.service';\nimport { SHEETS_UI_PLUGIN_CONFIG_KEY } from './config.schema';\n\nexport const AFFECT_LAYOUT_STYLES = ['ff', 'fs', 'tr', 'tb'];\n\nexport class AutoHeightController extends Disposable {\n    constructor(\n        @IRenderManagerService private readonly _renderManagerService: RenderManagerService,\n        @Inject(SheetInterceptorService) private readonly _sheetInterceptorService: SheetInterceptorService,\n        @Inject(SheetsSelectionsService) private readonly _selectionManagerService: SheetsSelectionsService,\n        @Inject(IUniverInstanceService) private readonly _univerInstanceService: IUniverInstanceService,\n        @IConfigService private readonly _configService: IConfigService\n    ) {\n        super();\n        this._initialize();\n    }\n\n    private _getRangesScope(ranges: IRange[]): number {\n        let start: number | undefined;\n        let end: number | undefined;\n        for (const { startRow, endRow } of ranges) {\n            start = start === undefined ? startRow : Math.min(start, startRow);\n            end = end === undefined ? endRow : Math.max(end, endRow);\n        }\n        return (end as number) - (start as number) + 1;\n    }\n\n    getUndoRedoParamsOfAutoHeight(ranges: IRange[], subUnitIdParam?: string): { redos: any[]; undos: any[] } {\n        const { _univerInstanceService: univerInstanceService, _configService: configService } = this;\n        const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n\n        // Better NOT use `getActiveWorksheet` method, because users may manipulate another worksheet in active sheet.\n        const unitId = workbook.getUnitId();\n        let worksheet = workbook.getActiveSheet();\n        let subUnitId = worksheet.getSheetId();\n        if (subUnitIdParam) {\n            const target = getSheetCommandTarget(univerInstanceService, { unitId, subUnitId: subUnitIdParam });\n            if (target) {\n                worksheet = target.worksheet;\n                subUnitId = worksheet.getSheetId();\n            }\n        }\n        const sheetSkeletonService = this._renderManagerService.getRenderById(unitId)!.with<SheetSkeletonManagerService>(SheetSkeletonManagerService);\n\n        // Better NOT use `getCurrentParam` method, because users may manipulate another worksheet in active sheet.\n        // const { skeleton } = sheetSkeletonService.getCurrentParam()!;\n        const skeleton = sheetSkeletonService.ensureSkeleton(subUnitId);\n        if (!skeleton) {\n            return {\n                redos: [],\n                undos: [],\n            };\n        };\n\n        const config = configService.getConfig<IUniverSheetsUIConfig>(SHEETS_UI_PLUGIN_CONFIG_KEY);\n        let rangeList = ranges;\n        if (!Array.isArray(ranges)) {\n            // TODO: @weird94 after we resolve the performance issue of auto hight, we can remove this code.\n            // The code \"const params = command.params as ISetRangeValuesRangeMutationParams;\" of _initialize() method may make IRange as IRange[]. so need adjust here.\n            if (ranges && (ranges as IRange).startRow !== undefined && (ranges as IRange).startRow !== undefined) {\n                rangeList = [ranges];\n            } else {\n                rangeList = [];\n            }\n        }\n        const count = this._getRangesScope(rangeList);\n        const maxLimit = config?.maxAutoHeightCount ?? 1000;\n        if (maxLimit < count) {\n            return {\n                redos: [],\n                undos: [],\n            };\n        }\n\n        const rowsAutoHeightInfo = skeleton.calculateAutoHeightInRange(ranges);\n\n        const redoParams: ISetWorksheetRowAutoHeightMutationParams = {\n            subUnitId,\n            unitId,\n            rowsAutoHeightInfo,\n        };\n        const undoParams: ISetWorksheetRowAutoHeightMutationParams = SetWorksheetRowAutoHeightMutationFactory(redoParams, worksheet);\n        return {\n            undos: [\n                {\n                    id: SetWorksheetRowAutoHeightMutation.id,\n                    params: undoParams,\n                },\n            ],\n            redos: [\n                {\n                    id: SetWorksheetRowAutoHeightMutation.id,\n                    params: redoParams,\n                },\n            ],\n        };\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    private _initialize() {\n        const { _sheetInterceptorService: sheetInterceptorService, _selectionManagerService: selectionManagerService } =\n            this;\n        // for intercept'SetRangeValuesCommand' command.\n        this.disposeWithMe(sheetInterceptorService.interceptCommand({\n            getMutations: (command) => {\n                if (command.id === SetRangeValuesCommand.id) {\n                    const params = command.params as ISetRangeValuesRangeMutationParams;\n                    return this.getUndoRedoParamsOfAutoHeight(params.range, params.subUnitId);\n                }\n\n                return {\n                    redos: [],\n                    undos: [],\n                };\n            },\n        }));\n\n        // for intercept 'sheet.command.set-row-is-auto-height' command.\n        this.disposeWithMe(sheetInterceptorService.interceptCommand({\n            getMutations: (command: { id: string; params: ISetWorksheetRowIsAutoHeightMutationParams }) => {\n                if (command.id !== SetWorksheetRowIsAutoHeightCommand.id) {\n                    return {\n                        redos: [],\n                        undos: [],\n                    };\n                }\n\n                return this.getUndoRedoParamsOfAutoHeight(command.params.ranges, command.params.subUnitId);\n            },\n        }));\n\n        // for intercept set style command.\n        this.disposeWithMe(sheetInterceptorService.interceptCommand({\n            getMutations: (command: { id: string; params: ISetStyleCommandParams<number> }) => {\n                if (command.id !== SetStyleCommand.id) {\n                    return {\n                        redos: [],\n                        undos: [],\n                    };\n                }\n\n                // TODO: @jocs, All styles that affect the size of the cell,\n                // I don't know if the enumeration is complete, to be added in the future.\n\n                if (!AFFECT_LAYOUT_STYLES.includes(command.params?.style.type)) {\n                    return {\n                        redos: [],\n                        undos: [],\n                    };\n                }\n\n                const selections = selectionManagerService.getCurrentSelections()?.map((s) => s.range);\n\n                if (!selections?.length) {\n                    return {\n                        redos: [],\n                        undos: [],\n                    };\n                }\n\n                return this.getUndoRedoParamsOfAutoHeight(selections, command.params.subUnitId);\n            },\n        }));\n\n        this.disposeWithMe(sheetInterceptorService.interceptAfterCommand({\n            getMutations: (command) => {\n                if (command.id === MoveRangeCommand.id) {\n                    const params = command.params as IMoveRangeCommandParams;\n                    return this.getUndoRedoParamsOfAutoHeight([params.fromRange, params.toRange]);\n                }\n\n                if (command.id === ReorderRangeCommand.id) {\n                    const params = command.params as IReorderRangeMutationParams;\n                    return this.getUndoRedoParamsOfAutoHeight([params.range]);\n                }\n\n                return {\n                    redos: [],\n                    undos: [],\n                };\n            },\n        }));\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellData, IObjectMatrixPrimitiveType, IRange } from '@univerjs/core';\nimport { ObjectMatrix } from '@univerjs/core';\n\nexport interface IDiscreteRange {\n    rows: number[];\n    cols: number[];\n}\n\nexport function discreteRangeToRange(discreteRange: IDiscreteRange): IRange {\n    const { rows, cols } = discreteRange;\n    return {\n        startRow: rows[0],\n        endRow: rows[rows.length - 1],\n        startColumn: cols[0],\n        endColumn: cols[cols.length - 1],\n    };\n}\n\nexport function virtualizeDiscreteRanges(ranges: IDiscreteRange[]): {\n    ranges: IRange[];\n    mapFunc: (row: number, col: number) => { row: number; col: number };\n} {\n    let totalRows: number[] = [];\n    let totalCols: number[] = [];\n    const totalRanges: IRange[] = [];\n\n    ranges.forEach((r) => {\n        // Do not use destructuring, otherwise Maximum call stack size exceeded will occur\n        totalRows = totalRows.concat(r.rows);\n        totalCols = totalCols.concat(r.cols);\n    });\n\n    totalRows = Array.from(new Set(totalRows)).sort((a, b) => a - b);\n    totalCols = Array.from(new Set(totalCols)).sort((a, b) => a - b);\n\n    ranges.forEach((r) => {\n        totalRanges.push({\n            startRow: totalRows.findIndex((row) => row === r.rows[0]),\n            endRow: totalRows.findIndex((row) => row === r.rows[r.rows.length - 1]),\n            startColumn: totalCols.findIndex((col) => col === r.cols[0]),\n            endColumn: totalCols.findIndex((col) => col === r.cols[r.cols.length - 1]),\n        });\n    });\n\n    return {\n        ranges: totalRanges,\n        mapFunc: (row, col) => (\n            {\n                row: totalRows[row],\n                col: totalCols[col],\n            }\n        ),\n    };\n}\n\nexport function generateNullCellValueRowCol(range: IDiscreteRange[]): IObjectMatrixPrimitiveType<ICellData> {\n    const cellValue = new ObjectMatrix<ICellData>();\n    range.forEach((r) => {\n        const { rows, cols } = r;\n        rows.forEach((i) => {\n            cols.forEach((j) => {\n                cellValue.setValue(i, j, {\n                    v: null,\n                    p: null,\n                    f: null,\n                    si: null,\n                    custom: null,\n                });\n            });\n        });\n    });\n\n    return cellValue.getData();\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellData, IRange, Nullable } from '@univerjs/core';\nimport { CellValueType, Direction, isFormulaId, isFormulaString, Tools } from '@univerjs/core';\n\nexport const chnNumChar = { \u96F6: 0, \u4E00: 1, \u4E8C: 2, \u4E09: 3, \u56DB: 4, \u4E94: 5, \u516D: 6, \u4E03: 7, \u516B: 8, \u4E5D: 9 };\nexport const chnNumChar2 = ['\u96F6', '\u4E00', '\u4E8C', '\u4E09', '\u56DB', '\u4E94', '\u516D', '\u4E03', '\u516B', '\u4E5D'];\nexport const chnUnitSection = ['', '\u4E07', '\u4EBF', '\u4E07\u4EBF', '\u4EBF\u4EBF'];\nexport const chnUnitChar = ['', '\u5341', '\u767E', '\u5343'];\n\nexport interface ICopyDataInType {\n    data: Array<Nullable<ICellData>>;\n    index: ICopyDataInTypeIndexInfo;\n}\n\nexport type ICopyDataInTypeIndexInfo = number[];\n\nexport const chnNameValue = {\n    \u5341: { value: 10, secUnit: false },\n    \u767E: { value: 100, secUnit: false },\n    \u5343: { value: 1000, secUnit: false },\n    \u4E07: { value: 10000, secUnit: true },\n    \u4EBF: { value: 100000000, secUnit: true },\n};\n\nexport function chineseToNumber(chnStr?: Nullable<string>) {\n    if (!chnStr) {\n        return 0;\n    }\n    let rtn = 0;\n    let section = 0;\n    let number = 0;\n    let secUnit = false;\n    const str = chnStr.split('');\n\n    for (let i = 0; i < str.length; i++) {\n        const num = chnNumChar[str[i] as keyof typeof chnNumChar];\n\n        if (typeof num !== 'undefined') {\n            number = num;\n\n            if (i === str.length - 1) {\n                section += number;\n            }\n        } else {\n            const obj = chnNameValue[str[i] as keyof typeof chnNameValue];\n            const unit = obj.value;\n            secUnit = obj.secUnit;\n\n            if (secUnit) {\n                section = (section + number) * unit;\n                rtn += section;\n                section = 0;\n            } else {\n                section += number * unit;\n            }\n\n            number = 0;\n        }\n    }\n\n    return rtn + section;\n}\n\nexport function sectionToChinese(section: number) {\n    let strIns = '';\n    let chnStr = '';\n    let unitPos = 0;\n    let zero = true;\n\n    while (section > 0) {\n        const v = section % 10;\n\n        if (v === 0) {\n            if (!zero) {\n                zero = true;\n                chnStr = chnNumChar2[v] + chnStr;\n            }\n        } else {\n            zero = false;\n            strIns = chnNumChar2[v];\n            strIns += chnUnitChar[unitPos];\n            chnStr = strIns + chnStr;\n        }\n\n        unitPos++;\n        section = Math.floor(section / 10);\n    }\n\n    return chnStr;\n}\n\nexport function numberToChinese(num: number) {\n    let unitPos = 0;\n    let strIns = '';\n    let chnStr = '';\n    let needZero = false;\n\n    if (num === 0) {\n        return chnNumChar2[0];\n    }\n    while (num > 0) {\n        const section = num % 10000;\n\n        if (needZero) {\n            chnStr = chnNumChar2[0] + chnStr;\n        }\n\n        strIns = sectionToChinese(section);\n        strIns += section !== 0 ? chnUnitSection[unitPos] : chnUnitSection[0];\n        chnStr = strIns + chnStr;\n        needZero = section < 1000 && section > 0;\n        num = Math.floor(num / 10000);\n        unitPos++;\n    }\n\n    return chnStr;\n}\n\nexport function isChnNumber(txt?: string) {\n    if (!txt) {\n        return false;\n    }\n    let isChnNumber = true;\n\n    if (txt) {\n        if (txt.length === 1) {\n            if (txt === '\u65E5' || txt in chnNumChar) {\n                isChnNumber = true;\n            } else {\n                isChnNumber = false;\n            }\n        } else {\n            const str = txt.split('');\n            for (let i = 0; i < str.length; i++) {\n                if (!(str[i] in chnNumChar || str[i] in chnNameValue)) {\n                    isChnNumber = false;\n                    break;\n                }\n            }\n        }\n    }\n    return isChnNumber;\n}\n\nexport function matchExtendNumber(txt?: string) {\n    if (!txt) {\n        return {\n            isExtendNumber: false,\n        };\n    }\n    const reg = /0|([1-9]+[0-9]*)/g;\n    const isExtendNumber = reg.test(txt);\n\n    if (isExtendNumber) {\n        const match = txt.match(reg);\n        if (match && match.length > 0) {\n            const matchTxt = match[match.length - 1];\n            const matchIndex = txt.lastIndexOf(matchTxt);\n            const beforeTxt = txt.substr(0, matchIndex);\n            const afterTxt = txt.substr(matchIndex + matchTxt.length);\n\n            return {\n                isExtendNumber: true,\n                matchTxt: Number(matchTxt),\n                beforeTxt,\n                afterTxt,\n            };\n        }\n        return {\n            isExtendNumber: false,\n        };\n    }\n\n    return {\n        isExtendNumber,\n    };\n}\n\nexport function isChnWeek1(txt: string) {\n    let isChnWeek1;\n    if (txt.length === 1) {\n        if (txt === '\u65E5' || chineseToNumber(txt) < 7) {\n            isChnWeek1 = true;\n        } else {\n            isChnWeek1 = false;\n        }\n    } else {\n        isChnWeek1 = false;\n    }\n\n    return isChnWeek1;\n}\n\nexport function isChnWeek2(txt: string) {\n    let isChnWeek2;\n    if (txt.length === 2) {\n        if (\n            txt === '\u5468\u4E00' ||\n            txt === '\u5468\u4E8C' ||\n            txt === '\u5468\u4E09' ||\n            txt === '\u5468\u56DB' ||\n            txt === '\u5468\u4E94' ||\n            txt === '\u5468\u516D' ||\n            txt === '\u5468\u65E5'\n        ) {\n            isChnWeek2 = true;\n        } else {\n            isChnWeek2 = false;\n        }\n    } else {\n        isChnWeek2 = false;\n    }\n\n    return isChnWeek2;\n}\n\nexport function isChnWeek3(txt: string) {\n    let isChnWeek3;\n    if (txt.length === 3) {\n        if (\n            txt === '\u661F\u671F\u4E00' ||\n            txt === '\u661F\u671F\u4E8C' ||\n            txt === '\u661F\u671F\u4E09' ||\n            txt === '\u661F\u671F\u56DB' ||\n            txt === '\u661F\u671F\u4E94' ||\n            txt === '\u661F\u671F\u516D' ||\n            txt === '\u661F\u671F\u65E5'\n        ) {\n            isChnWeek3 = true;\n        } else {\n            isChnWeek3 = false;\n        }\n    } else {\n        isChnWeek3 = false;\n    }\n\n    return isChnWeek3;\n}\n\nexport function getLenS(indexArr: any[], rsd: number) {\n    let s = 0;\n\n    for (let j = 0; j < indexArr.length; j++) {\n        if (indexArr[j] < rsd) {\n            s++;\n        } else {\n            break;\n        }\n    }\n\n    return s;\n}\n\n/**\n * equal diff\n * @param arr\n * @returns\n */\nexport function isEqualDiff(arr: number[]) {\n    let diff = true;\n    const step = arr[1] - arr[0];\n\n    for (let i = 1; i < arr.length; i++) {\n        if (arr[i] - arr[i - 1] !== step) {\n            diff = false;\n            break;\n        }\n    }\n\n    return diff;\n}\n\nexport function getDataIndex(csLen: number, asLen: number, indexArr: number[]) {\n    const obj: ICopyDataInTypeIndexInfo = [];\n\n    const num = Math.floor(asLen / csLen);\n    const rsd = asLen % csLen;\n\n    let sum = 0;\n    if (num > 0) {\n        for (let i = 0; i < num; i++) {\n            for (let j = 0; j < indexArr.length; j++) {\n                obj[indexArr[j] + i * csLen] = sum;\n                sum++;\n            }\n        }\n        for (let a = 0; a < indexArr.length; a++) {\n            if (indexArr[a] < rsd) {\n                obj[indexArr[a] + csLen * num] = sum;\n                sum++;\n            } else {\n                break;\n            }\n        }\n    } else {\n        for (let a = 0; a < indexArr.length; a++) {\n            if (indexArr[a] < rsd) {\n                obj[indexArr[a]] = sum;\n                sum++;\n            } else {\n                break;\n            }\n        }\n    }\n\n    return obj;\n}\n\nexport function fillCopy(data: Array<Nullable<ICellData>>, len: number) {\n    const applyData = [];\n\n    for (let i = 1; i <= len; i++) {\n        const index = (i - 1) % data.length;\n        const d = Tools.deepClone(data[index]);\n\n        removeCellCustom(d);\n\n        applyData.push({\n            v: null,\n            s: null,\n            p: null,\n            f: null,\n            si: null,\n            t: null,\n            ...d,\n        });\n    }\n\n    return applyData;\n}\n\nexport function fillCopyStyles(data: Array<Nullable<ICellData>>, len: number) {\n    const applyData = [];\n    for (let i = 1; i <= len; i++) {\n        const index = (i - 1) % data.length;\n        const d = { s: data[index]?.s };\n\n        applyData.push(d);\n    }\n\n    return applyData;\n}\n\nexport function isEqualRatio(arr: number[]) {\n    let ratio = true;\n    const step = arr[1] / arr[0];\n\n    for (let i = 1; i < arr.length; i++) {\n        if (arr[i] / arr[i - 1] !== step) {\n            ratio = false;\n            break;\n        }\n    }\n\n    return ratio;\n}\n\nexport function getXArr(len: number) {\n    const xArr = [];\n\n    for (let i = 1; i <= len; i++) {\n        xArr.push(i);\n    }\n\n    return xArr;\n}\n\nexport function fillSeries(data: Array<Nullable<ICellData>>, len: number, direction: Direction) {\n    const applyData = [];\n\n    const dataNumArr = [];\n    for (let j = 0; j < data.length; j++) {\n        dataNumArr.push(Number(data[j]?.v));\n    }\n\n    if (data.length > 2 && isEqualRatio(dataNumArr)) {\n        for (let i = 1; i <= len; i++) {\n            const index = (i - 1) % data.length;\n            const d = Tools.deepClone(data[index]);\n\n            removeCellCustom(d);\n\n            const num = Number(data[data.length - 1]?.v) * (Number(data[1]?.v) / Number(data[0]?.v)) ** i;\n\n            if (d) {\n                if (needsUpdateCellValue(d)) {\n                    d.v = num;\n                }\n                applyData.push(d);\n            }\n        }\n    } else {\n        const xArr = getXArr(data.length);\n        for (let i = 1; i <= len; i++) {\n            const index = (i - 1) % data.length;\n            const d = Tools.deepClone(data[index]);\n\n            removeCellCustom(d);\n\n            const forward = direction === Direction.DOWN || direction === Direction.RIGHT;\n            const y = forecast(data.length + i, dataNumArr, xArr, forward);\n\n            if (d) {\n                if (needsUpdateCellValue(d)) {\n                    d.v = y;\n                }\n                applyData.push(d);\n            }\n        }\n    }\n\n    return applyData;\n}\n\nexport function forecast(x: number, yArr: number[], xArr: number[], forward = true) {\n    function getAverage(arr: number[]) {\n        let sum = 0;\n\n        for (let i = 0; i < arr.length; i++) {\n            sum += arr[i];\n        }\n\n        return sum / arr.length;\n    }\n\n    const ax = getAverage(xArr);\n    const ay = getAverage(yArr);\n\n    let sum_d = 0;\n    let sum_n = 0;\n    for (let j = 0; j < xArr.length; j++) {\n        sum_d += (xArr[j] - ax) * (yArr[j] - ay);\n        sum_n += (xArr[j] - ax) * (xArr[j] - ax);\n    }\n\n    let b;\n    if (sum_n === 0) {\n        b = forward ? 1 : -1;\n    } else {\n        b = sum_d / sum_n;\n    }\n\n    const a = ay - b * ax;\n\n    return Math.round((a + b * x) * 100000) / 100000;\n}\n\nexport function fillExtendNumber(data: Array<Nullable<ICellData>>, len: number, step: number) {\n    const applyData = [];\n    const reg = /0|([1-9]+[0-9]*)/g;\n\n    for (let i = 1; i <= len; i++) {\n        const index = (i - 1) % data.length;\n        const d = Tools.deepClone(data[index]);\n\n        removeCellCustom(d);\n\n        const last = `${data[data.length - 1]?.v}`;\n        const match = last?.match(reg);\n        const lastTxt = match?.[match.length - 1];\n\n        const num = Math.abs(Number(lastTxt) + step * i);\n        if (!last || !lastTxt) continue;\n        const lastIndex = last.lastIndexOf(lastTxt);\n        const valueTxt = last.substr(0, lastIndex) + num.toString() + last.substr(lastIndex + lastTxt.length);\n\n        if (d) {\n            d.v = valueTxt;\n\n            applyData.push(d);\n        }\n    }\n\n    return applyData;\n}\nexport function fillOnlyFormat(data: Array<Nullable<ICellData>>, len: number) {\n    const applyData = [];\n\n    for (let i = 1; i <= len; i++) {\n        const index = (i - 1) % data.length;\n        const d = Tools.deepClone(data[index]);\n\n        removeCellCustom(d);\n\n        if (d) {\n            delete d.v;\n\n            applyData.push(d);\n        }\n    }\n\n    return applyData;\n}\n\n// weektype: 0-\u65E5 1-\u5468 2-\u661F\u671F\nexport function fillChnWeek(data: Array<Nullable<ICellData>>, len: number, step: number, weekType: number = 0) {\n    const keywordMap = [\n        ['\u65E5', '\u4E00', '\u4E8C', '\u4E09', '\u56DB', '\u4E94', '\u516D'],\n        ['\u5468\u65E5', '\u5468\u4E00', '\u5468\u4E8C', '\u5468\u4E09', '\u5468\u56DB', '\u5468\u4E94', '\u5468\u516D'],\n        ['\u661F\u671F\u65E5', '\u661F\u671F\u4E00', '\u661F\u671F\u4E8C', '\u661F\u671F\u4E09', '\u661F\u671F\u56DB', '\u661F\u671F\u4E94', '\u661F\u671F\u516D'],\n    ];\n    if (weekType >= keywordMap.length) return [];\n    const keyword = keywordMap[weekType];\n    const applyData = [];\n\n    for (let i = 1; i <= len; i++) {\n        const index = (i - 1) % data.length;\n        const d = Tools.deepClone(data[index]);\n\n        removeCellCustom(d);\n\n        let num = 0;\n        if (data[data.length - 1]?.v === keyword[0]) {\n            num = 7 + step * i;\n        } else {\n            const last = `${data[data.length - 1]?.v}`;\n            if (last) {\n                const txt = last.substr(last.length - 1, 1);\n                num = chineseToNumber(txt) + step * i;\n            }\n        }\n\n        if (num < 0) {\n            num = Math.ceil(Math.abs(num) / 7) * 7 + num;\n        }\n\n        const rsd = num % 7;\n        if (d) {\n            d.v = keyword[rsd];\n\n            applyData.push(d);\n        }\n    }\n\n    return applyData;\n}\n\nexport function fillChnNumber(data: Array<Nullable<ICellData>>, len: number, step: number) {\n    const applyData = [];\n\n    for (let i = 1; i <= len; i++) {\n        const index = (i - 1) % data.length;\n        const d = Tools.deepClone(data[index]);\n\n        removeCellCustom(d);\n\n        const formattedValue = `${data[data.length - 1]?.v}`;\n        const num = chineseToNumber(formattedValue) + step * i;\n        let txt;\n        if (num <= 0) {\n            txt = '\u96F6';\n        } else {\n            txt = numberToChinese(num);\n        }\n\n        if (d) {\n            d.v = txt;\n            applyData.push(d);\n        }\n    }\n\n    return applyData;\n}\n\nconst LOOP_SERIES: { [key: string]: string[] } = {\n    enWeek1: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n    enWeek2: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],\n    enMonth1: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n    enMonth2: [\n        'January',\n        'February',\n        'March',\n        'April',\n        'May',\n        'June',\n        'July',\n        'August',\n        'September',\n        'October',\n        'November',\n        'December',\n    ],\n    chnMonth1: ['\u4E00\u6708', '\u4E8C\u6708', '\u4E09\u6708', '\u56DB\u6708', '\u4E94\u6708', '\u516D\u6708', '\u4E03\u6708', '\u516B\u6708', '\u4E5D\u6708', '\u5341\u6708', '\u5341\u4E00\u6708', '\u5341\u4E8C\u6708'],\n    chnMonth2: ['\u6B63\u6708', '\u4E8C\u6708', '\u4E09\u6708', '\u56DB\u6708', '\u4E94\u6708', '\u516D\u6708', '\u4E03\u6708', '\u516B\u6708', '\u4E5D\u6708', '\u5341\u6708', '\u5341\u4E00\u6708', '\u814A\u6708'],\n    chHour1: ['\u5B50', '\u4E11', '\u5BC5', '\u536F', '\u8FB0', '\u5DF3', '\u5348', '\u672A', '\u7533', '\u9149', '\u620C', '\u4EA5'],\n    chHour2: ['\u5B50\u65F6', '\u4E11\u65F6', '\u5BC5\u65F6', '\u536F\u65F6', '\u8FB0\u65F6', '\u5DF3\u65F6', '\u5348\u65F6', '\u672A\u65F6', '\u7533\u65F6', '\u9149\u65F6', '\u620C\u65F6', '\u4EA5\u65F6'],\n    chYear1: ['\u7532', '\u4E59', '\u4E19', '\u4E01', '\u620A', '\u5DF1', '\u5E9A', '\u8F9B', '\u58EC', '\u7678'],\n    chSeason1: ['\u6625', '\u590F', '\u79CB', '\u51AC'],\n    chSeason2: ['\u6625\u5B63', '\u590F\u5B63', '\u79CB\u5B63', '\u51AC\u5B63'],\n};\n\nexport function isLoopSeries(txt: string) {\n    let isLoopSeries = false;\n    Object.keys(LOOP_SERIES).forEach((key) => {\n        if (LOOP_SERIES[key].includes(txt)) {\n            isLoopSeries = true;\n        }\n    });\n    return isLoopSeries;\n}\n\nexport function getLoopSeriesInfo(txt: string) {\n    let name = '';\n    const series: string[] = [];\n    Object.keys(LOOP_SERIES).forEach((key) => {\n        if (LOOP_SERIES[key].includes(txt)) {\n            name = key;\n            series.push(...LOOP_SERIES[key]);\n        }\n    });\n    return { name, series };\n}\n\nexport function fillLoopSeries(data: Array<Nullable<ICellData>>, len: number, step: number, series: string[]) {\n    const seriesLen = series.length;\n    const applyData = [];\n\n    for (let i = 1; i <= len; i++) {\n        const index = (i - 1) % data.length;\n        const d = Tools.deepClone(data[index]);\n\n        removeCellCustom(d);\n\n        const last = `${data[data.length - 1]?.v}`;\n        let num = series.indexOf(last) + step * i;\n\n        if (num < 0) {\n            num += Math.abs(step) * seriesLen;\n        }\n        const rsd = num % seriesLen;\n        if (d) {\n            d.v = series[rsd];\n\n            applyData.push(d);\n        }\n    }\n\n    return applyData;\n}\n\nexport function getAutoFillRepeatRange(sourceRange: IRange, targetRange: IRange) {\n    const repeats: Array<{\n        repeatStartCell: { col: number; row: number };\n        relativeRange: IRange;\n    }> = [];\n    let direction: Direction;\n    if (targetRange.startRow < sourceRange.startRow) {\n        direction = Direction.UP;\n    } else if (targetRange.endRow > sourceRange.endRow) {\n        direction = Direction.DOWN;\n    } else if (targetRange.startColumn < sourceRange.startColumn) {\n        direction = Direction.LEFT;\n    } else if (targetRange.endColumn > sourceRange.endColumn) {\n        direction = Direction.RIGHT;\n    } else {\n        return [];\n    }\n    // according to direction, calculate every repeat range.\n    // repeatStartCell is the start cell of each repeat range, relativeRange is the relative range of each repeat range\n    if (direction === Direction.DOWN || direction === Direction.UP) {\n        const sourceLength = sourceRange.endRow - sourceRange.startRow + 1;\n        const targetLength = targetRange.endRow - targetRange.startRow + 1;\n        const mod = Math.floor(targetLength / sourceLength);\n        const rest = targetLength % sourceLength;\n        const relativeRange = {\n            startRow: 0,\n            startColumn: 0,\n            endRow: sourceRange.endRow - sourceRange.startRow,\n            endColumn: sourceRange.endColumn - sourceRange.startColumn,\n        };\n        if (direction === Direction.DOWN) {\n            for (let i = 0; i < mod; i++) {\n                repeats.push({\n                    repeatStartCell: {\n                        row: sourceRange.startRow + (i + 1) * sourceLength,\n                        col: sourceRange.startColumn,\n                    },\n                    relativeRange,\n                });\n            }\n            if (rest > 0) {\n                repeats.push({\n                    repeatStartCell: {\n                        row: sourceRange.startRow + (mod + 1) * sourceLength,\n                        col: sourceRange.startColumn,\n                    },\n                    relativeRange: {\n                        startRow: 0,\n                        startColumn: 0,\n                        endRow: rest - 1,\n                        endColumn: sourceRange.endColumn - sourceRange.startColumn,\n                    },\n                });\n            }\n        } else {\n            for (let i = 0; i < mod; i++) {\n                repeats.push({\n                    repeatStartCell: {\n                        row: sourceRange.startRow - (i + 1) * sourceLength,\n                        col: sourceRange.startColumn,\n                    },\n                    relativeRange,\n                });\n            }\n            if (rest > 0) {\n                repeats.push({\n                    repeatStartCell: {\n                        row: sourceRange.startRow - (mod + 1) * sourceLength,\n                        col: sourceRange.startColumn,\n                    },\n                    relativeRange: {\n                        startRow: sourceLength - rest,\n                        endRow: sourceLength - 1,\n                        startColumn: 0,\n                        endColumn: sourceRange.endColumn - sourceRange.startColumn,\n                    },\n                });\n            }\n        }\n    }\n    if (direction === Direction.RIGHT || direction === Direction.LEFT) {\n        const sourceLength = sourceRange.endColumn - sourceRange.startColumn + 1;\n        const targetLength = targetRange.endColumn - targetRange.startColumn + 1;\n        const mod = Math.floor(targetLength / sourceLength);\n        const rest = targetLength % sourceLength;\n        const relativeRange = {\n            startRow: 0,\n            startColumn: 0,\n            endRow: sourceRange.endRow - sourceRange.startRow,\n            endColumn: sourceRange.endColumn - sourceRange.startColumn,\n        };\n        if (direction === Direction.RIGHT) {\n            for (let i = 0; i < mod; i++) {\n                repeats.push({\n                    repeatStartCell: {\n                        row: sourceRange.startRow,\n                        col: sourceRange.startColumn + (i + 1) * sourceLength,\n                    },\n                    relativeRange,\n                });\n            }\n            if (rest > 0) {\n                repeats.push({\n                    repeatStartCell: {\n                        row: sourceRange.startRow,\n                        col: sourceRange.startColumn + (mod + 1) * sourceLength,\n                    },\n                    relativeRange: {\n                        startRow: 0,\n                        startColumn: 0,\n                        endRow: sourceRange.endRow - sourceRange.startRow,\n                        endColumn: rest - 1,\n                    },\n                });\n            }\n        } else {\n            for (let i = 0; i < mod; i++) {\n                repeats.push({\n                    repeatStartCell: {\n                        row: sourceRange.startRow,\n                        col: sourceRange.startColumn - (i + 1) * sourceLength,\n                    },\n                    relativeRange,\n                });\n            }\n            if (rest > 0) {\n                repeats.push({\n                    repeatStartCell: {\n                        row: sourceRange.startRow,\n                        col: sourceRange.startColumn - (mod + 1) * sourceLength,\n                    },\n                    relativeRange: {\n                        startRow: 0,\n                        startColumn: sourceLength - rest,\n                        endRow: sourceRange.endRow - sourceRange.startRow,\n                        endColumn: sourceLength - 1,\n                    },\n                });\n            }\n        }\n    }\n\n    return repeats;\n}\n\n/**\n * Formulas or Boolean values do not need to update cell.v\n * @param cell\n * @returns\n */\nexport function needsUpdateCellValue(cell: ICellData) {\n    if (isFormulaString(cell.f) || isFormulaId(cell.si)) {\n        return false;\n    }\n\n    if (cell.t === CellValueType.BOOLEAN) {\n        return false;\n    }\n\n    return true;\n}\n\n/**\n * Remove cell.custom\n * @param cell\n */\nexport function removeCellCustom(cell: Nullable<ICellData>) {\n    if (cell && 'custom' in cell) {\n        delete cell.custom;\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CellValueType, Direction, IUniverInstanceService, numfmt } from '@univerjs/core';\nimport type { Workbook } from '@univerjs/core';\n\nimport {\n    chineseToNumber,\n    fillChnNumber,\n    fillChnWeek,\n    fillCopy,\n    fillExtendNumber,\n    fillLoopSeries,\n    fillSeries,\n    getLoopSeriesInfo,\n    isChnNumber,\n    isChnWeek2,\n    isChnWeek3,\n    isEqualDiff,\n    isLoopSeries,\n    matchExtendNumber,\n} from './tools';\nimport { APPLY_TYPE, DATA_TYPE } from './type';\nimport type { IAutoFillRule } from './type';\n\nexport const dateRule: IAutoFillRule = {\n    type: DATA_TYPE.DATE,\n    priority: 1100,\n    match: (cellData, accessor) => {\n        if (cellData?.f || cellData?.si) {\n            return false;\n        }\n\n        if ((typeof cellData?.v === 'number' || cellData?.t === CellValueType.NUMBER)\n            && cellData.s) {\n            if (typeof cellData.s === 'string') {\n                const workbook = accessor.get(IUniverInstanceService).getFocusedUnit() as Workbook;\n                const style = workbook.getStyles().get(cellData.s);\n                const pattern = style?.n?.pattern;\n                if (pattern) {\n                    return numfmt.getInfo(pattern).isDate;\n                }\n            } else if (cellData.s.n && numfmt.getInfo(cellData.s.n.pattern).isDate) {\n                return true;\n            }\n        }\n        return false;\n    },\n    isContinue: (prev, cur) => {\n        if (prev.type === DATA_TYPE.DATE) {\n            return true;\n        }\n        return false;\n    },\n    applyFunctions: {\n        [APPLY_TYPE.SERIES]: (dataWithIndex, len, direction) => {\n            const { data } = dataWithIndex;\n            if (direction === Direction.LEFT || direction === Direction.UP) {\n                data.reverse();\n                return fillSeries(data, len, direction).reverse();\n            }\n            return fillSeries(data, len, direction);\n        },\n    },\n};\n\nexport const numberRule: IAutoFillRule = {\n    type: DATA_TYPE.NUMBER,\n    priority: 1000,\n    match: (cellData) => typeof cellData?.v === 'number' || cellData?.t === CellValueType.NUMBER,\n    isContinue: (prev, cur) => {\n        if (prev.type === DATA_TYPE.NUMBER) {\n            return true;\n        }\n        return false;\n    },\n    applyFunctions: {\n        [APPLY_TYPE.SERIES]: (dataWithIndex, len, direction) => {\n            const { data } = dataWithIndex;\n            if (direction === Direction.LEFT || direction === Direction.UP) {\n                data.reverse();\n                return fillSeries(data, len, direction).reverse();\n            }\n            return fillSeries(data, len, direction);\n        },\n    },\n};\n\nexport const otherRule: IAutoFillRule = {\n    type: DATA_TYPE.OTHER,\n    priority: 0,\n    match: () => true,\n    isContinue: (prev, cur) => {\n        if (prev.type === DATA_TYPE.OTHER) {\n            return true;\n        }\n        return false;\n    },\n};\n\nexport const extendNumberRule: IAutoFillRule = {\n    type: DATA_TYPE.EXTEND_NUMBER,\n    priority: 900,\n    match: (cellData) => matchExtendNumber(`${cellData?.v}` || '').isExtendNumber,\n    isContinue: (prev, cur) => {\n        if (prev.type === DATA_TYPE.EXTEND_NUMBER) {\n            const { beforeTxt, afterTxt } = matchExtendNumber(`${prev.cellData?.v}` || '');\n            const { beforeTxt: curBeforeTxt, afterTxt: curAfterTxt } = matchExtendNumber(`${cur?.v}` || '');\n            if (beforeTxt === curBeforeTxt && afterTxt === curAfterTxt) {\n                return true;\n            }\n        }\n        return false;\n    },\n    applyFunctions: {\n        [APPLY_TYPE.SERIES]: (dataWithIndex, len, direction) => {\n            const { data } = dataWithIndex;\n            const isReverse = direction === Direction.UP || direction === Direction.LEFT;\n\n            let step;\n            if (data.length === 1) {\n                step = isReverse ? -1 : 1;\n                return reverseIfNeed(fillExtendNumber(data, len, step), isReverse);\n            }\n            const dataNumArr = [];\n\n            for (let i = 0; i < data.length; i++) {\n                const txt = `${data[i]?.v}`;\n                txt && dataNumArr.push(Number(matchExtendNumber(txt).matchTxt));\n            }\n\n            if (isReverse) {\n                data.reverse();\n                dataNumArr.reverse();\n            }\n\n            if (isEqualDiff(dataNumArr)) {\n                step = dataNumArr[1] - dataNumArr[0];\n                return reverseIfNeed(fillExtendNumber(data, len, step), isReverse);\n            }\n            return fillCopy(data, len);\n        },\n    },\n};\n\nexport const chnNumberRule: IAutoFillRule = {\n    type: DATA_TYPE.CHN_NUMBER,\n    priority: 830,\n    match: (cellData) => {\n        if (isChnNumber(`${cellData?.v}` || '')) {\n            return true;\n        }\n        return false;\n    },\n    isContinue: (prev, cur) => {\n        if (prev.type === DATA_TYPE.CHN_NUMBER) {\n            return true;\n        }\n        return false;\n    },\n    applyFunctions: {\n        [APPLY_TYPE.SERIES]: (dataWithIndex, len, direction) => {\n            const { data } = dataWithIndex;\n\n            const isReverse = direction === Direction.LEFT || direction === Direction.UP;\n            if (data.length === 1) {\n                const formattedValue = `${data[0]?.v}`;\n                let step;\n                if (!isReverse) {\n                    step = 1;\n                } else {\n                    step = -1;\n                }\n                if (formattedValue && (formattedValue === '\u65E5' || chineseToNumber(formattedValue) < 7)) {\n                    return reverseIfNeed(fillChnWeek(data, len, step), isReverse);\n                }\n\n                return reverseIfNeed(fillChnNumber(data, len, step), isReverse);\n            }\n            let hasWeek = false;\n            for (let i = 0; i < data.length; i++) {\n                const formattedValue = data[i]?.v;\n\n                if (formattedValue === '\u65E5') {\n                    hasWeek = true;\n                    break;\n                }\n            }\n\n            const dataNumArr = [];\n            let weekIndex = 0;\n            for (let i = 0; i < data.length; i++) {\n                const formattedValue = `${data[i]?.v}`;\n                if (formattedValue === '\u65E5') {\n                    if (i === 0) {\n                        dataNumArr.push(0);\n                    } else {\n                        weekIndex++;\n                        dataNumArr.push(weekIndex * 7);\n                    }\n                } else if (hasWeek && chineseToNumber(formattedValue) > 0 && chineseToNumber(formattedValue) < 7) {\n                    dataNumArr.push(chineseToNumber(formattedValue) + weekIndex * 7);\n                } else {\n                    dataNumArr.push(chineseToNumber(formattedValue));\n                }\n            }\n\n            if (isReverse) {\n                data.reverse();\n                dataNumArr.reverse();\n            }\n\n            if (isEqualDiff(dataNumArr)) {\n                if (\n                    hasWeek ||\n                    (dataNumArr[dataNumArr.length - 1] < 6 && dataNumArr[0] > 0) ||\n                    (dataNumArr[0] < 6 && dataNumArr[dataNumArr.length - 1] > 0)\n                ) {\n                    // Fill with sequence of Monday~Sunday\n                    const step = dataNumArr[1] - dataNumArr[0];\n                    return reverseIfNeed(fillChnWeek(data, len, step), isReverse);\n                }\n                // Fill with sequence of Chinese lowercase numbers\n                const step = dataNumArr[1] - dataNumArr[0];\n                return reverseIfNeed(fillChnNumber(data, len, step), isReverse);\n            }\n            // Not an arithmetic progression, copy data\n            return fillCopy(data, len);\n        },\n    },\n};\n\nexport const chnWeek2Rule: IAutoFillRule = {\n    type: DATA_TYPE.CHN_WEEK2,\n    priority: 820,\n    match: (cellData) => {\n        if (isChnWeek2(`${cellData?.v}` || '')) {\n            return true;\n        }\n        return false;\n    },\n    isContinue: (prev, cur) => prev.type === DATA_TYPE.CHN_WEEK2,\n    applyFunctions: {\n        [APPLY_TYPE.SERIES]: (dataWithIndex, len, direction) => {\n            const { data } = dataWithIndex;\n\n            const isReverse = direction === Direction.LEFT || direction === Direction.UP;\n            if (data.length === 1) {\n                let step;\n                if (!isReverse) {\n                    step = 1;\n                } else {\n                    step = -1;\n                }\n\n                return reverseIfNeed(fillChnWeek(data, len, step, 1), isReverse);\n            }\n            const dataNumArr = [];\n            let weekIndex = 0;\n\n            for (let i = 0; i < data.length; i++) {\n                const formattedValue = `${data[i]?.v}`;\n                const lastTxt = formattedValue?.substr(formattedValue.length - 1, 1);\n                if (formattedValue === '\u5468\u65E5') {\n                    if (i === 0) {\n                        dataNumArr.push(0);\n                    } else {\n                        weekIndex++;\n                        dataNumArr.push(weekIndex * 7);\n                    }\n                } else {\n                    dataNumArr.push(chineseToNumber(lastTxt) + weekIndex * 7);\n                }\n            }\n\n            if (isReverse) {\n                data.reverse();\n                dataNumArr.reverse();\n            }\n\n            if (isEqualDiff(dataNumArr)) {\n                const step = dataNumArr[1] - dataNumArr[0];\n                return reverseIfNeed(fillChnWeek(data, len, step, 1), isReverse);\n            }\n            return fillCopy(data, len);\n        },\n    },\n};\n\nexport const chnWeek3Rule: IAutoFillRule = {\n    type: DATA_TYPE.CHN_WEEK3,\n    priority: 810,\n    match: (cellData) => isChnWeek3(`${cellData?.v}` || ''),\n    isContinue: (prev, cur) => prev.type === DATA_TYPE.CHN_WEEK3,\n    applyFunctions: {\n        [APPLY_TYPE.SERIES]: (dataWithIndex, len, direction) => {\n            const { data } = dataWithIndex;\n\n            const isReverse = direction === Direction.LEFT || direction === Direction.UP;\n            if (data.length === 1) {\n                let step;\n                if (!isReverse) {\n                    step = 1;\n                } else {\n                    step = -1;\n                }\n\n                return reverseIfNeed(fillChnWeek(data, len, step, 2), isReverse);\n            }\n            const dataNumArr = [];\n            let weekIndex = 0;\n\n            for (let i = 0; i < data.length; i++) {\n                const formattedValue = `${data[i]?.v}`;\n                if (formattedValue) {\n                    const lastTxt = formattedValue.substr(formattedValue.length - 1, 1);\n                    if (formattedValue === '\u661F\u671F\u65E5') {\n                        if (i === 0) {\n                            dataNumArr.push(0);\n                        } else {\n                            weekIndex++;\n                            dataNumArr.push(weekIndex * 7);\n                        }\n                    } else {\n                        dataNumArr.push(chineseToNumber(lastTxt) + weekIndex * 7);\n                    }\n                }\n            }\n\n            if (isReverse) {\n                data.reverse();\n                dataNumArr.reverse();\n            }\n\n            if (isEqualDiff(dataNumArr)) {\n                const step = dataNumArr[1] - dataNumArr[0];\n                return reverseIfNeed(fillChnWeek(data, len, step, 2), isReverse);\n            }\n            return fillCopy(data, len);\n        },\n    },\n};\n\nexport const loopSeriesRule: IAutoFillRule = {\n    type: DATA_TYPE.LOOP_SERIES,\n    priority: 800,\n    match: (cellData) => isLoopSeries(`${cellData?.v}` || ''),\n    isContinue: (prev, cur) => {\n        if (prev.type === DATA_TYPE.LOOP_SERIES) {\n            return getLoopSeriesInfo(`${prev.cellData?.v}` || '').name === getLoopSeriesInfo(`${cur?.v}` || '').name;\n        }\n        return false;\n    },\n    applyFunctions: {\n        [APPLY_TYPE.SERIES]: (dataWithIndex, len, direction) => {\n            const { data } = dataWithIndex;\n            const isReverse = direction === Direction.LEFT || direction === Direction.UP;\n            const { series } = getLoopSeriesInfo(`${data[0]?.v}` || '');\n            if (data.length === 1) {\n                let step;\n                if (!isReverse) {\n                    step = 1;\n                } else {\n                    step = -1;\n                }\n\n                return reverseIfNeed(fillLoopSeries(data, len, step, series), isReverse);\n            }\n            const dataNumArr = [];\n            let cycleIndex = 0;\n            for (let i = 0; i < data.length; i++) {\n                const formattedValue = `${data[i]?.v}`;\n                if (formattedValue) {\n                    if (formattedValue === series[0]) {\n                        if (i === 0) {\n                            dataNumArr.push(0);\n                        } else {\n                            cycleIndex++;\n                            dataNumArr.push(cycleIndex * series.length);\n                        }\n                    } else {\n                        dataNumArr.push(series.indexOf(formattedValue) + cycleIndex * 7);\n                    }\n                }\n            }\n\n            if (isReverse) {\n                data.reverse();\n                dataNumArr.reverse();\n            }\n\n            if (isEqualDiff(dataNumArr)) {\n                const step = dataNumArr[1] - dataNumArr[0];\n                return reverseIfNeed(fillLoopSeries(data, len, step, series), isReverse);\n            }\n            return fillCopy(data, len);\n        },\n    },\n};\n\nexport function reverseIfNeed<T>(data: T[], reverse: boolean): T[] {\n    return reverse ? data.reverse() : data;\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, IDisposable, IMutationInfo, IRange, Nullable, Workbook } from '@univerjs/core';\nimport type { RenderManagerService } from '@univerjs/engine-render';\nimport type { ISetRangeValuesMutationParams, ISetWorksheetRowAutoHeightMutationParams } from '@univerjs/sheets';\nimport type { Observable } from 'rxjs';\nimport type { IAutoFillLocation, IAutoFillRule, ISheetAutoFillHook } from './type';\nimport { createIdentifier, Direction, Disposable, ICommandService, Inject, Injector, IUndoRedoService, IUniverInstanceService, ObjectMatrix, RANGE_TYPE, Rectangle, toDisposable, UniverInstanceType } from '@univerjs/core';\n\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport { rangeToDiscreteRange, SetRangeValuesMutation, SetSelectionsOperation, SetWorksheetRowAutoHeightMutation, SetWorksheetRowAutoHeightMutationFactory, SheetsSelectionsService } from '@univerjs/sheets';\nimport { BehaviorSubject } from 'rxjs';\nimport { AutoClearContentCommand } from '../../commands/commands/auto-fill.command';\nimport { AFFECT_LAYOUT_STYLES } from '../../controllers/auto-height.controller';\nimport { discreteRangeToRange } from '../../controllers/utils/range-tools';\nimport { SheetSkeletonManagerService } from '../sheet-skeleton-manager.service';\nimport {\n    chnNumberRule,\n    chnWeek2Rule,\n    chnWeek3Rule,\n    dateRule,\n    extendNumberRule,\n    loopSeriesRule,\n    numberRule,\n    otherRule,\n} from './rules';\nimport { APPLY_TYPE, AutoFillHookType } from './type';\n\nexport interface IAutoFillService {\n    applyType$: Observable<APPLY_TYPE>;\n    applyType: APPLY_TYPE;\n\n    direction: Direction;\n\n    menu$: Observable<IApplyMenuItem[]>;\n    menu: IApplyMenuItem[];\n\n    showMenu$: Observable<boolean>;\n    setShowMenu: (show: boolean) => void;\n\n    setDisableApplyType: (type: APPLY_TYPE, disable: boolean) => void;\n\n    getRules(): IAutoFillRule[];\n    isFillingStyle(): boolean;\n\n    autoFillLocation$: Observable<Nullable<IAutoFillLocation>>;\n    autoFillLocation: Nullable<IAutoFillLocation>;\n\n    setFillingStyle(isFillingStyle: boolean): void;\n    registerRule(rule: IAutoFillRule): void;\n\n    getAllHooks(): ISheetAutoFillHook[];\n    getActiveHooks(): ISheetAutoFillHook[];\n    addHook(hook: ISheetAutoFillHook): IDisposable;\n    fillData(applyType: APPLY_TYPE): boolean;\n\n    triggerAutoFill(unitId: string, subUnitId: string, source: IRange, target: IRange): Promise<boolean>;\n}\n\nexport interface IApplyMenuItem {\n    label: string;\n    value: APPLY_TYPE;\n    disable: boolean;\n}\n\nexport class AutoFillService extends Disposable implements IAutoFillService {\n    private _rules: IAutoFillRule[] = [];\n    private _hooks: ISheetAutoFillHook[] = [];\n    private readonly _applyType$: BehaviorSubject<APPLY_TYPE> = new BehaviorSubject<APPLY_TYPE>(APPLY_TYPE.SERIES);\n    private _isFillingStyle: boolean = true;\n\n    private _prevUndos: IMutationInfo[] = [];\n\n    private readonly _autoFillLocation$: BehaviorSubject<Nullable<IAutoFillLocation>> = new BehaviorSubject<\n        Nullable<IAutoFillLocation>\n    >(null);\n\n    readonly autoFillLocation$ = this._autoFillLocation$.asObservable();\n\n    private readonly _showMenu$: BehaviorSubject<boolean> = new BehaviorSubject<boolean>(false);\n    readonly showMenu$ = this._showMenu$.asObservable();\n\n    private _direction: Direction = Direction.DOWN;\n    readonly applyType$ = this._applyType$.asObservable();\n\n    private readonly _menu$: BehaviorSubject<IApplyMenuItem[]> = new BehaviorSubject<IApplyMenuItem[]>([\n        {\n            label: 'autoFill.copy',\n            value: APPLY_TYPE.COPY,\n            disable: false,\n        },\n        {\n            label: 'autoFill.series',\n            value: APPLY_TYPE.SERIES,\n            disable: false,\n        },\n        {\n            label: 'autoFill.formatOnly',\n            value: APPLY_TYPE.ONLY_FORMAT,\n            disable: false,\n        },\n        {\n            label: 'autoFill.noFormat',\n            value: APPLY_TYPE.NO_FORMAT,\n            disable: false,\n        },\n    ]);\n\n    readonly menu$ = this._menu$.asObservable();\n    constructor(\n        @ICommandService private _commandService: ICommandService,\n        @IUndoRedoService private _undoRedoService: IUndoRedoService,\n        @IRenderManagerService private readonly _renderManagerService: RenderManagerService,\n        @Inject(IUniverInstanceService) private _univerInstanceService: IUniverInstanceService,\n        @Inject(SheetsSelectionsService) private _selectionManagerService: SheetsSelectionsService,\n        @Inject(Injector) private readonly _injector: Injector\n    ) {\n        super();\n        this._init();\n    }\n\n    private _init() {\n        this._rules = [\n            dateRule,\n            numberRule,\n            extendNumberRule,\n            chnNumberRule,\n            chnWeek2Rule,\n            chnWeek3Rule,\n            loopSeriesRule,\n            otherRule,\n        ].sort((a, b) => b.priority - a.priority);\n        this._isFillingStyle = true;\n    }\n\n    private _getOneByPriority(items: ISheetAutoFillHook[]) {\n        if (items.length <= 0) {\n            return [];\n        }\n        const maxPriority = items.reduce((maxItem, currentItem) => {\n            return (currentItem.priority || 0) > (maxItem.priority || 0) ? currentItem : maxItem;\n        }, items[0]);\n        return [maxPriority];\n    }\n\n    // a cache to undo commands of last apply-type\n    private _initPrevUndo() {\n        this._prevUndos = [];\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    async triggerAutoFill(unitId: string, subUnitId: string, source: IRange, selection: IRange) {\n        // if source range === dest range, do nothing;\n        if (\n            source.startColumn === selection.startColumn &&\n                source.startRow === selection.startRow &&\n                source.endColumn === selection.endColumn &&\n                source.endRow === selection.endRow\n        ) {\n            return false;\n        }\n        // situation 1: drag to smaller range, horizontally.\n        if (selection.endColumn < source.endColumn && selection.endColumn > source.startColumn) {\n            return this._commandService.executeCommand(AutoClearContentCommand.id, {\n                clearRange: {\n                    startRow: selection.startRow,\n                    endRow: selection.endRow,\n                    startColumn: selection.endColumn + 1,\n                    endColumn: source.endColumn,\n                },\n                selectionRange: selection,\n            });\n        }\n        // situation 2: drag to smaller range, vertically.\n        if (selection.endRow < source.endRow && selection.endRow > source.startRow) {\n            return this._commandService.executeCommand(AutoClearContentCommand.id, {\n                clearRange: {\n                    startRow: selection.endRow + 1,\n                    endRow: source.endRow,\n                    startColumn: selection.startColumn,\n                    endColumn: selection.endColumn,\n                },\n                selectionRange: selection,\n            });\n        }\n        // situation 3: drag to larger range, expand to fill\n\n        // save ranges\n        const target = {\n            startRow: selection.startRow,\n            endRow: selection.endRow,\n            startColumn: selection.startColumn,\n            endColumn: selection.endColumn,\n        };\n        let direction: Nullable<Direction> = null;\n        if (selection.startRow < source.startRow) {\n            direction = Direction.UP;\n            target.endRow = source.startRow - 1;\n        } else if (selection.endRow > source.endRow) {\n            direction = Direction.DOWN;\n            target.startRow = source.endRow + 1;\n        } else if (selection.startColumn < source.startColumn) {\n            direction = Direction.LEFT;\n            target.endColumn = source.startColumn - 1;\n        } else if (selection.endColumn > source.endColumn) {\n            direction = Direction.RIGHT;\n            target.startColumn = source.endColumn + 1;\n        } else {\n            return false;\n        }\n\n        this.direction = direction;\n\n        const autoFillSource = this._injector.invoke((accessor: IAccessor) => rangeToDiscreteRange(source, accessor));\n        const autoFillTarget = this._injector.invoke((accessor: IAccessor) => rangeToDiscreteRange(target, accessor));\n\n        if (!autoFillSource || !autoFillTarget) {\n            return false;\n        }\n        this.autoFillLocation = {\n            source: autoFillSource,\n            target: autoFillTarget,\n            unitId,\n            subUnitId,\n        };\n\n        const preferTypes: APPLY_TYPE[] = [];\n        const activeHooks = this.getActiveHooks();\n        activeHooks.forEach((hook) => {\n            const type = hook?.onBeforeFillData?.({ source: autoFillSource, target: autoFillTarget, unitId, subUnitId }, direction!);\n            if (type) {\n                preferTypes.unshift(type);\n            }\n        });\n\n        this._initPrevUndo();\n        // set apply type will trigger fillData\n        for (let i = 0; i < preferTypes.length; i++) {\n            const menuItem = this.menu.find((m) => m.value === preferTypes[i]);\n            if (menuItem && !menuItem.disable) {\n                return this.fillData(preferTypes[i]);\n            }\n        }\n        // if no hook return apply type, use first available apply type\n        const first = this.menu.find((m) => m.disable === false)?.value;\n        if (first) {\n            return this.fillData(first);\n        }\n\n        return false;\n    }\n\n    addHook(hook: ISheetAutoFillHook) {\n        if (this._hooks.find((h) => h.id === hook.id)) {\n            throw new Error(`Add hook failed, hook id '${hook.id}' already exist!`);\n        }\n        if (hook.priority === undefined) {\n            hook.priority = 0;\n        }\n\n        if (hook.type === undefined) {\n            hook.type = AutoFillHookType.Append;\n        }\n        this._hooks.push(hook);\n        return toDisposable(() => {\n            const index = this._hooks.findIndex((item) => item === hook);\n            if (index > -1) {\n                this._hooks.splice(index, 1);\n            }\n        });\n    }\n\n    registerRule(rule: IAutoFillRule) {\n        // if rule.type is used, console error\n        if (this._rules.find((r) => r.type === rule.type)) {\n            throw new Error(`Registry rule failed, type '${rule.type}' already exist!`);\n        }\n        // insert rules according to the rule.priority, the higher priority will be inserted at the beginning of the array\n        const index = this._rules.findIndex((r) => r.priority < rule.priority);\n        this._rules.splice(index === -1 ? this._rules.length : index, 0, rule);\n    }\n\n    getRules() {\n        return this._rules;\n    }\n\n    getAllHooks() {\n        return this._hooks;\n    }\n\n    getActiveHooks() {\n        const { source, target, unitId, subUnitId } = this.autoFillLocation || {};\n        if (!source || !target || !unitId || !subUnitId) {\n            return [];\n        }\n        const enabledHooks = this._hooks.filter(\n            (h) => !h.disable?.({ source, target, unitId, subUnitId }, this._direction, this.applyType) === true\n        );\n        const onlyHooks = enabledHooks.filter((h) => h.type === AutoFillHookType.Only);\n        if (onlyHooks.length > 0) {\n            return this._getOneByPriority(onlyHooks);\n        }\n\n        const defaultHooks = this._getOneByPriority(enabledHooks.filter((h) => h.type === AutoFillHookType.Default));\n\n        const appendHooks = enabledHooks.filter((h) => h.type === AutoFillHookType.Append) || [];\n\n        return [...defaultHooks, ...appendHooks];\n    }\n\n    get applyType() {\n        return this._applyType$.getValue();\n    }\n\n    set applyType(type: APPLY_TYPE) {\n        this._applyType$.next(type);\n    }\n\n    get menu() {\n        return this._menu$.getValue();\n    }\n\n    get direction() {\n        return this._direction;\n    }\n\n    set direction(direction: Direction) {\n        this._direction = direction;\n    }\n\n    isFillingStyle(): boolean {\n        return this._isFillingStyle;\n    }\n\n    setFillingStyle(isFillingStyle: boolean) {\n        this._isFillingStyle = isFillingStyle;\n    }\n\n    get autoFillLocation() {\n        return this._autoFillLocation$.getValue();\n    }\n\n    set autoFillLocation(location: Nullable<IAutoFillLocation>) {\n        this._autoFillLocation$.next(location);\n    }\n\n    setDisableApplyType(type: APPLY_TYPE, disable: boolean) {\n        this._menu$.next(\n            this._menu$.getValue().map((item) => {\n                if (item.value === type) {\n                    return {\n                        ...item,\n                        disable,\n                    };\n                }\n                return item;\n            })\n        );\n    }\n\n    setShowMenu(show: boolean) {\n        this._showMenu$.next(show);\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    fillData(applyType: APPLY_TYPE) {\n        this.applyType = applyType;\n        const { source, target, unitId = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!.getUnitId(), subUnitId = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!.getActiveSheet()?.getSheetId() } = this.autoFillLocation || {};\n\n        if (!source || !target || !unitId || !subUnitId) {\n            return false;\n        }\n\n        const direction = this.direction;\n\n        if (this._prevUndos.length > 0) {\n            this._prevUndos.forEach((undo) => {\n                this._commandService.syncExecuteCommand(undo.id, undo.params);\n            });\n        }\n        this._prevUndos = [];\n\n        const selection = Rectangle.union(discreteRangeToRange(source), discreteRangeToRange(target));\n        const activeHooks = this.getActiveHooks();\n        const workbook = this._univerInstanceService.getUnit<Workbook>(unitId, UniverInstanceType.UNIVER_SHEET)!;\n\n        this._commandService.syncExecuteCommand(SetSelectionsOperation.id, {\n            selections: [\n                {\n                    primary: { ...(this._selectionManagerService.getCurrentLastSelection()?.primary ?? selection) },\n                    range: {\n                        ...selection,\n                        rangeType: RANGE_TYPE.NORMAL,\n                    },\n                },\n            ],\n            unitId,\n            subUnitId,\n        });\n\n        const undos: IMutationInfo[] = [];\n        const redos: IMutationInfo[] = [];\n        activeHooks.forEach((hook) => {\n            const { undos: hookUndos, redos: hookRedos } =\n                hook.onFillData?.({ source, target, unitId, subUnitId }, direction, applyType) || {};\n            if (hookUndos) {\n                undos.push(...hookUndos);\n            }\n            if (hookRedos) {\n                redos.push(...hookRedos);\n            }\n        });\n        const result = redos.every((m) => this._commandService.syncExecuteCommand(m.id, m.params));\n\n        // deal with auto-height\n        const autoHeightRanges: IRange[] = [];\n        if (applyType !== APPLY_TYPE.NO_FORMAT) {\n            redos.forEach((m) => {\n                if (m.id === SetRangeValuesMutation.id) {\n                    const { cellValue } = m.params as ISetRangeValuesMutationParams;\n                    const matrix = new ObjectMatrix(cellValue);\n                    matrix.forValue((row, col, value) => {\n                        const style = Object.keys(workbook.getStyles().get(value?.s) || {});\n                        if (value?.p || (style.length && AFFECT_LAYOUT_STYLES.some((s) => style.includes(s)))) {\n                            autoHeightRanges.push({ startRow: row, endRow: row, startColumn: col, endColumn: col });\n                        }\n                    });\n                }\n            });\n        }\n\n        const autoHeightUndoRedos = this._getAutoHeightUndoRedos(unitId, subUnitId, autoHeightRanges);\n        const autoHeightResult = autoHeightUndoRedos.redos.every((m) => this._commandService.syncExecuteCommand(m.id, m.params));\n        if (autoHeightResult) {\n            undos.push(...autoHeightUndoRedos.undos);\n            redos.push(...autoHeightUndoRedos.redos);\n        }\n        if (result) {\n            this._prevUndos = undos;\n            // add to undo redo services\n            this._undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: undos,\n                redoMutations: redos,\n            });\n        }\n        activeHooks.forEach((hook) => {\n            hook.onAfterFillData?.({ source, target, unitId, subUnitId }, direction, applyType);\n        });\n        this.setShowMenu(true);\n        return true;\n    }\n\n    private _getAutoHeightUndoRedos(unitId: string, subUnitId: string, ranges: IRange[]) {\n        const sheetSkeletonService = this._renderManagerService.getRenderById(unitId)?.with(SheetSkeletonManagerService);\n        const skeleton = sheetSkeletonService?.getCurrentParam()?.skeleton;\n        if (!skeleton) return { redos: [], undos: [] };\n\n        const rowsAutoHeightInfo = skeleton.calculateAutoHeightInRange(ranges);\n        const redoParams: ISetWorksheetRowAutoHeightMutationParams = { subUnitId, unitId, rowsAutoHeightInfo };\n        const worksheet = skeleton.worksheet;\n        const undoParams = SetWorksheetRowAutoHeightMutationFactory(redoParams, worksheet);\n        return {\n            undos: [{ id: SetWorksheetRowAutoHeightMutation.id, params: undoParams }],\n            redos: [{ id: SetWorksheetRowAutoHeightMutation.id, params: redoParams }],\n        };\n    }\n}\n\nexport const IAutoFillService = createIdentifier<IAutoFillService>('univer.auto-fill-service');\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand, IRange } from '@univerjs/core';\nimport type { ISetRangeValuesMutationParams, ISetSelectionsOperationParams } from '@univerjs/sheets';\nimport { CommandType, ICommandService, IUndoRedoService, IUniverInstanceService, sequenceExecute } from '@univerjs/core';\nimport { generateNullCellValue, getSheetCommandTarget, SetRangeValuesMutation, SetRangeValuesUndoMutationFactory, SetSelectionsOperation, SheetInterceptorService } from '@univerjs/sheets';\n\nimport { IAutoFillService } from '../../services/auto-fill/auto-fill.service';\n\nexport interface IAutoFillCommandParams {\n    sourceRange: IRange;\n    targetRange: IRange;\n}\n\nexport const AutoFillCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.auto-fill',\n\n    handler: async (accessor: IAccessor, params: IAutoFillCommandParams) => {\n        const autoFillService = accessor.get(IAutoFillService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const { sourceRange, targetRange } = params;\n\n        const commandTarget = getSheetCommandTarget(univerInstanceService);\n        if (!commandTarget) return false;\n\n        const { subUnitId, unitId } = commandTarget;\n        return autoFillService.triggerAutoFill(unitId, subUnitId, sourceRange, targetRange);\n    },\n};\n\nexport interface IAutoClearContentCommand {\n    clearRange: IRange;\n    selectionRange: IRange;\n}\n\nexport const AutoClearContentCommand: ICommand = {\n    id: 'sheet.command.auto-clear-content',\n    type: CommandType.COMMAND,\n    handler: async (accessor: IAccessor, params: IAutoClearContentCommand) => {\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const commandService = accessor.get(ICommandService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { unitId, subUnitId } = target;\n        const { clearRange, selectionRange } = params;\n\n        const clearMutationParams: ISetRangeValuesMutationParams = {\n            subUnitId,\n            unitId,\n            cellValue: generateNullCellValue([clearRange]),\n        };\n        const undoClearMutationParams: ISetRangeValuesMutationParams = SetRangeValuesUndoMutationFactory(\n            accessor,\n            clearMutationParams\n        );\n        const { startColumn, startRow } = selectionRange;\n        const param: ISetSelectionsOperationParams = {\n            selections: [\n                {\n                    primary: {\n                        startColumn,\n                        startRow,\n                        endColumn: startColumn,\n                        endRow: startRow,\n                        actualRow: startRow,\n                        actualColumn: startColumn,\n                        isMerged: false,\n                        isMergedMainCell: false,\n                    },\n                    range: {\n                        ...selectionRange,\n                    },\n                },\n            ],\n            unitId,\n            subUnitId,\n        };\n        commandService.executeCommand(SetSelectionsOperation.id, param);\n\n        const result = commandService.syncExecuteCommand(SetRangeValuesMutation.id, clearMutationParams);\n        if (result) {\n            const afterInterceptors = sheetInterceptorService.afterCommandExecute({\n                id: SetRangeValuesMutation.id,\n                params: clearMutationParams,\n            });\n\n            sequenceExecute(afterInterceptors.redos, commandService);\n            undoRedoService.pushUndoRedo({\n                // If there are multiple mutations that form an encapsulated project, they must be encapsulated in the same undo redo element.\n                // Hooks can be used to hook the code of external controllers to add new actions.\n                unitID: unitId,\n                undoMutations: [{ id: SetRangeValuesMutation.id, params: undoClearMutationParams }, ...afterInterceptors.undos],\n                redoMutations: [{ id: SetRangeValuesMutation.id, params: clearMutationParams }, ...afterInterceptors.redos],\n            });\n\n            return true;\n        }\n\n        return false;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommand, IRange } from '@univerjs/core';\nimport { CommandType, ICommandService, IUniverInstanceService, LocaleService, Rectangle } from '@univerjs/core';\nimport { DeleteRangeMoveLeftCommand, getSheetCommandTarget, SheetsSelectionsService } from '@univerjs/sheets';\nimport { IConfirmService } from '@univerjs/ui';\n\nexport const DeleteRangeMoveLeftConfirmCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.delete-range-move-left-confirm',\n    handler: async (accessor) => {\n        const confirmService = accessor.get(IConfirmService);\n        const commandService = accessor.get(ICommandService);\n        const localeService = accessor.get(LocaleService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const selection = selectionManagerService.getCurrentSelections();\n        if (!selection) {\n            return false;\n        }\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet } = target;\n        let range = selection[0].range;\n        if (!range) {\n            return false;\n        }\n\n        range = { ...range, endColumn: worksheet.getColumnCount() - 1 };\n\n        const getRowLength = (range: IRange) => range.endRow - range.startRow;\n        const mergeData = worksheet.getMergeData().find((mergeRange) => {\n            const interSectedRange = Rectangle.getIntersects(mergeRange, range);\n            return interSectedRange ? getRowLength(mergeRange) > getRowLength(interSectedRange) : false;\n        });\n\n        if (!mergeData) {\n            return commandService.executeCommand(DeleteRangeMoveLeftCommand.id);\n        }\n\n        const result = await confirmService.confirm({\n            id: DeleteRangeMoveLeftConfirmCommand.id,\n            title: { title: localeService.t('merge.confirm.waring') },\n            children: { title: localeService.t('merge.confirm.dismantleMergeCellWaring') },\n            cancelText: localeService.t('button.cancel'),\n            confirmText: localeService.t('button.confirm'),\n        });\n        if (result) {\n            return commandService.executeCommand(DeleteRangeMoveLeftCommand.id);\n        }\n        return true;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommand, IRange } from '@univerjs/core';\nimport { CommandType, ICommandService, IUniverInstanceService, LocaleService, Rectangle } from '@univerjs/core';\nimport { DeleteRangeMoveUpCommand, getSheetCommandTarget, SheetsSelectionsService } from '@univerjs/sheets';\nimport { IConfirmService } from '@univerjs/ui';\n\nexport const DeleteRangeMoveUpConfirmCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.delete-range-move-up-confirm',\n    handler: async (accessor) => {\n        const confirmService = accessor.get(IConfirmService);\n        const commandService = accessor.get(ICommandService);\n        const localeService = accessor.get(LocaleService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const selection = selectionManagerService.getCurrentSelections();\n        if (!selection) return false;\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet } = target;\n        let range = selection[0].range;\n        if (!range) return false;\n\n        range = { ...range, endRow: worksheet.getRowCount() - 1 };\n\n        for (let i = range.startRow; i <= range.endRow; i++) {\n            if (worksheet.getRowFiltered(i)) {\n                const result = await confirmService.confirm({\n                    id: DeleteRangeMoveUpConfirmCommand.id,\n                    title: { title: localeService.t('filter.confirm.error') },\n                    children: { title: localeService.t('filter.confirm.notAllowedToInsertRange') },\n                    confirmText: localeService.t('button.confirm'),\n                });\n                if (result) {\n                    return false;\n                }\n            }\n        }\n\n        const getColLength = (range: IRange) => range.endColumn - range.startColumn;\n        const mergeData = worksheet.getMergeData().find((mergeRange) => {\n            const interSectedRange = Rectangle.getIntersects(mergeRange, range);\n            return interSectedRange ? getColLength(mergeRange) > getColLength(interSectedRange) : false;\n        });\n\n        if (!mergeData) {\n            return commandService.executeCommand(DeleteRangeMoveUpCommand.id);\n        }\n\n        const result = await confirmService.confirm({\n            id: DeleteRangeMoveUpConfirmCommand.id,\n            title: { title: localeService.t('merge.confirm.waring') },\n            children: { title: localeService.t('merge.confirm.dismantleMergeCellWaring') },\n            cancelText: localeService.t('button.cancel'),\n            confirmText: localeService.t('button.confirm'),\n        });\n        if (result) {\n            return commandService.executeCommand(DeleteRangeMoveUpCommand.id);\n        }\n        return true;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand } from '@univerjs/core';\nimport { CommandType, ICommandService, IUniverInstanceService, LocaleService } from '@univerjs/core';\nimport { getSheetCommandTarget, SetColHiddenCommand, SetRowHiddenCommand, SheetsSelectionsService } from '@univerjs/sheets';\nimport { IConfirmService } from '@univerjs/ui';\n\nimport { isAllColumnsCovered, isAllRowsCovered } from './utils/selection-utils';\n\nexport const HideRowConfirmCommand: ICommand = {\n    id: 'sheet.command.hide-row-confirm',\n    type: CommandType.COMMAND,\n    handler: async (accessor: IAccessor) => {\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n\n        const ranges = selectionManagerService.getCurrentSelections()?.map((s) => s.range);\n        if (!ranges?.length) return false;\n\n        const commandService = accessor.get(ICommandService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet } = target;\n        const allRowRanges = worksheet.getVisibleRows();\n\n        if (isAllRowsCovered(allRowRanges, ranges)) {\n            const confirmService = accessor.get(IConfirmService);\n            const localeService = accessor.get(LocaleService);\n\n            await confirmService.confirm({\n                id: 'sheet.confirm.hide-row',\n                title: {\n                    title: localeService.t('info.problem'),\n                },\n                children: { title: localeService.t('rightClick.hideAllRowsAlert') },\n                cancelText: localeService.t('button.cancel'),\n                confirmText: localeService.t('button.confirm'),\n            });\n\n            return false;\n        }\n\n        await commandService.executeCommand(SetRowHiddenCommand.id);\n        return true;\n    },\n};\n\nexport const HideColConfirmCommand: ICommand = {\n    id: 'sheet.command.hide-col-confirm',\n    type: CommandType.COMMAND,\n    handler: async (accessor: IAccessor) => {\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n\n        const ranges = selectionManagerService.getCurrentSelections()?.map((s) => s.range);\n        if (!ranges?.length) {\n            return false;\n        }\n\n        const commandService = accessor.get(ICommandService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet } = target;\n        const allColumnRanges = worksheet.getVisibleCols();\n\n        if (isAllColumnsCovered(allColumnRanges, ranges)) {\n            const confirmService = accessor.get(IConfirmService);\n            const localeService = accessor.get(LocaleService);\n\n            await confirmService.confirm({\n                id: 'sheet.confirm.hide-col',\n                title: {\n                    title: localeService.t('info.problem'),\n                },\n                children: { title: localeService.t('rightClick.hideAllColumnsAlert') },\n                cancelText: localeService.t('button.cancel'),\n                confirmText: localeService.t('button.confirm'),\n            });\n\n            return false;\n        }\n\n        await commandService.executeCommand(SetColHiddenCommand.id);\n        return true;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommand } from '@univerjs/core';\nimport { CommandType, EDITOR_ACTIVATED, ICommandService, IContextService, ThemeService } from '@univerjs/core';\nimport { SetInlineFormatBoldCommand, SetInlineFormatFontFamilyCommand, SetInlineFormatFontSizeCommand, SetInlineFormatItalicCommand, SetInlineFormatStrikethroughCommand, SetInlineFormatSubscriptCommand, SetInlineFormatSuperscriptCommand, SetInlineFormatTextColorCommand, SetInlineFormatUnderlineCommand } from '@univerjs/docs-ui';\nimport {\n    SetBoldCommand,\n    SetFontFamilyCommand,\n    SetFontSizeCommand,\n    SetItalicCommand,\n    SetStrikeThroughCommand,\n    SetTextColorCommand,\n    SetUnderlineCommand,\n} from '@univerjs/sheets';\n\n/**\n * It is used to set the bold style of selections or one cell, need to distinguish between\n *  **selection state** and **edit state**. If you are in the selective state,\n *  you need to set the style on the cell and the style on the rich text(p textRuns) at the same time,\n *  and if it is only in edit state, then you only need to set the style of the rich text(p textRuns)\n */\nexport const SetRangeBoldCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.set-range-bold',\n    handler: async (accessor) => {\n        const commandService = accessor.get(ICommandService);\n        const contextService = accessor.get(IContextService);\n        const isCellEditorFocus = contextService.getContextValue(EDITOR_ACTIVATED);\n\n        if (isCellEditorFocus) {\n            return commandService.executeCommand(SetInlineFormatBoldCommand.id);\n        }\n\n        return commandService.executeCommand(SetBoldCommand.id);\n    },\n};\n\nexport const SetRangeItalicCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.set-range-italic',\n    handler: async (accessor) => {\n        const commandService = accessor.get(ICommandService);\n        const contextService = accessor.get(IContextService);\n        const isCellEditorFocus = contextService.getContextValue(EDITOR_ACTIVATED);\n\n        if (isCellEditorFocus) {\n            return commandService.executeCommand(SetInlineFormatItalicCommand.id);\n        }\n\n        return commandService.executeCommand(SetItalicCommand.id);\n    },\n};\n\nexport const SetRangeUnderlineCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.set-range-underline',\n    handler: async (accessor) => {\n        const commandService = accessor.get(ICommandService);\n        const contextService = accessor.get(IContextService);\n        const isCellEditorFocus = contextService.getContextValue(EDITOR_ACTIVATED);\n\n        if (isCellEditorFocus) {\n            return commandService.executeCommand(SetInlineFormatUnderlineCommand.id);\n        }\n\n        return commandService.executeCommand(SetUnderlineCommand.id);\n    },\n};\n\nexport const SetRangeStrickThroughCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.set-range-stroke',\n    handler: async (accessor) => {\n        const commandService = accessor.get(ICommandService);\n        const contextService = accessor.get(IContextService);\n        const isCellEditorFocus = contextService.getContextValue(EDITOR_ACTIVATED);\n\n        if (isCellEditorFocus) {\n            return commandService.executeCommand(SetInlineFormatStrikethroughCommand.id);\n        }\n\n        return commandService.executeCommand(SetStrikeThroughCommand.id);\n    },\n};\n\nexport const SetRangeSubscriptCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.set-range-subscript',\n    handler: async (accessor) => {\n        const commandService = accessor.get(ICommandService);\n        const contextService = accessor.get(IContextService);\n        const isCellEditorFocus = contextService.getContextValue(EDITOR_ACTIVATED);\n\n        if (isCellEditorFocus) {\n            return commandService.executeCommand(SetInlineFormatSubscriptCommand.id);\n        }\n\n        return false;\n    },\n};\n\nexport const SetRangeSuperscriptCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.set-range-superscript',\n    handler: async (accessor) => {\n        const commandService = accessor.get(ICommandService);\n        const contextService = accessor.get(IContextService);\n        const isCellEditorFocus = contextService.getContextValue(EDITOR_ACTIVATED);\n\n        if (isCellEditorFocus) {\n            return commandService.executeCommand(SetInlineFormatSuperscriptCommand.id);\n        }\n\n        return false;\n    },\n};\n\nexport const SetRangeFontSizeCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.set-range-fontsize',\n    handler: async (accessor, params) => {\n        const commandService = accessor.get(ICommandService);\n        const contextService = accessor.get(IContextService);\n        const isCellEditorFocus = contextService.getContextValue(EDITOR_ACTIVATED);\n\n        if (isCellEditorFocus) {\n            return commandService.executeCommand(SetInlineFormatFontSizeCommand.id, params);\n        }\n\n        return commandService.executeCommand(SetFontSizeCommand.id, params);\n    },\n};\n\nexport const SetRangeFontFamilyCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.set-range-font-family',\n    handler: async (accessor, params) => {\n        const commandService = accessor.get(ICommandService);\n        const contextService = accessor.get(IContextService);\n        const isCellEditorFocus = contextService.getContextValue(EDITOR_ACTIVATED);\n\n        if (isCellEditorFocus) {\n            return commandService.executeCommand(SetInlineFormatFontFamilyCommand.id, params);\n        }\n\n        return commandService.executeCommand(SetFontFamilyCommand.id, params);\n    },\n};\n\nexport const SetRangeTextColorCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.set-range-text-color',\n    handler: async (accessor, params) => {\n        const commandService = accessor.get(ICommandService);\n        const contextService = accessor.get(IContextService);\n        const isCellEditorFocus = contextService.getContextValue(EDITOR_ACTIVATED);\n\n        if (isCellEditorFocus) {\n            return commandService.executeCommand(SetInlineFormatTextColorCommand.id, params);\n        }\n\n        return commandService.executeCommand(SetTextColorCommand.id, params);\n    },\n};\n\nexport const ResetRangeTextColorCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.reset-range-text-color',\n    handler: async (accessor) => {\n        const commandService = accessor.get(ICommandService);\n        const contextService = accessor.get(IContextService);\n        const isCellEditorFocus = contextService.getContextValue(EDITOR_ACTIVATED);\n        const themeService = accessor.get(ThemeService);\n\n        if (isCellEditorFocus) {\n            return commandService.executeCommand(SetInlineFormatTextColorCommand.id, { value: null });\n        }\n\n        return commandService.executeCommand(SetTextColorCommand.id, { value: themeService.getCurrentTheme().textColor });\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommand, IRange } from '@univerjs/core';\nimport { CommandType, ICommandService, IUniverInstanceService, LocaleService, Rectangle } from '@univerjs/core';\nimport { getSheetCommandTarget, InsertRangeMoveDownCommand, SheetsSelectionsService } from '@univerjs/sheets';\nimport { IConfirmService } from '@univerjs/ui';\n\nexport const InsertRangeMoveDownConfirmCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.insert-range-move-down-confirm',\n    handler: async (accessor) => {\n        const confirmService = accessor.get(IConfirmService);\n        const commandService = accessor.get(ICommandService);\n        const localeService = accessor.get(LocaleService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const selection = selectionManagerService.getCurrentSelections();\n        if (!selection) {\n            return false;\n        }\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet } = target;\n        let range = selection[0].range;\n\n        if (!range) {\n            return false;\n        }\n        range = { ...range, endRow: worksheet.getRowCount() - 1 };\n\n        for (let i = range.startRow; i <= range.endRow; i++) {\n            if (worksheet.getRowFiltered(i)) {\n                const result = await confirmService.confirm({\n                    id: InsertRangeMoveDownConfirmCommand.id,\n                    title: { title: localeService.t('filter.confirm.error') },\n                    children: { title: localeService.t('filter.confirm.notAllowedToInsertRange') },\n                    confirmText: localeService.t('button.confirm'),\n                });\n                if (result) {\n                    return false;\n                }\n            }\n        }\n\n        const getColLength = (range: IRange) => range.endColumn - range.startColumn;\n        const mergeData = worksheet.getMergeData().find((mergeRange) => {\n            const interSectedRange = Rectangle.getIntersects(mergeRange, range);\n            return interSectedRange ? getColLength(mergeRange) > getColLength(interSectedRange) : false;\n        });\n\n        if (!mergeData) {\n            return commandService.executeCommand(InsertRangeMoveDownCommand.id);\n        }\n\n        const result = await confirmService.confirm({\n            id: InsertRangeMoveDownConfirmCommand.id,\n            title: { title: localeService.t('merge.confirm.waring') },\n            children: { title: localeService.t('merge.confirm.dismantleMergeCellWaring') },\n            cancelText: localeService.t('button.cancel'),\n            confirmText: localeService.t('button.confirm'),\n        });\n        if (result) {\n            return commandService.executeCommand(InsertRangeMoveDownCommand.id);\n        }\n        return true;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommand, IRange } from '@univerjs/core';\nimport { CommandType, ICommandService, IUniverInstanceService, LocaleService, Rectangle } from '@univerjs/core';\nimport { getSheetCommandTarget, InsertRangeMoveRightCommand, SheetsSelectionsService } from '@univerjs/sheets';\nimport { IConfirmService } from '@univerjs/ui';\n\nexport const InsertRangeMoveRightConfirmCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.insert-range-move-right-confirm',\n    handler: async (accessor) => {\n        const confirmService = accessor.get(IConfirmService);\n        const commandService = accessor.get(ICommandService);\n        const localeService = accessor.get(LocaleService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const selection = selectionManagerService.getCurrentSelections();\n        if (!selection) {\n            return false;\n        }\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet } = target;\n\n        let range = selection[0].range;\n\n        if (!range) {\n            return false;\n        }\n        range = { ...range, endColumn: worksheet.getColumnCount() - 1 };\n\n        const getRowLength = (range: IRange) => range.endRow - range.startRow;\n\n        const mergeData = worksheet.getMergeData().find((mergeRange) => {\n            const interSectedRange = Rectangle.getIntersects(mergeRange, range);\n            return interSectedRange ? getRowLength(mergeRange) > getRowLength(interSectedRange) : false;\n        });\n\n        if (!mergeData) {\n            return commandService.executeCommand(InsertRangeMoveRightCommand.id);\n        }\n\n        const result = await confirmService.confirm({\n            id: InsertRangeMoveRightConfirmCommand.id,\n            title: { title: localeService.t('merge.confirm.waring') },\n            children: { title: localeService.t('merge.confirm.dismantleMergeCellWaring') },\n            cancelText: localeService.t('button.cancel'),\n            confirmText: localeService.t('button.confirm'),\n        });\n        if (result) {\n            return commandService.executeCommand(InsertRangeMoveRightCommand.id);\n        }\n        return true;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UnitAction } from '@univerjs/protocol';\n\nexport const UNIVER_SHEET_PERMISSION_PLUGIN_NAME = 'UNIVER_SHEET_PERMISSION_PLUGIN';\nexport const UNIVER_SHEET_PERMISSION_PANEL = 'UNIVER_SHEET_PERMISSION_PANEL';\nexport const UNIVER_SHEET_PERMISSION_USER_PART = 'UNIVER_SHEET_PERMISSION_USER_PART';\nexport const UNIVER_SHEET_PERMISSION_BACKGROUND = 'UNIVER_SHEET_PERMISSION_BACKGROUND';\nexport const UNIVER_SHEET_PERMISSION_PANEL_FOOTER = 'UNIVER_SHEET_PERMISSION_PANEL_FOOTER';\nexport const UNIVER_SHEET_PERMISSION_USER_DIALOG = 'UNIVER_SHEET_PERMISSION_USER_DIALOG';\nexport const UNIVER_SHEET_PERMISSION_DIALOG = 'UNIVER_SHEET_PERMISSION_DIALOG';\nexport const UNIVER_SHEET_PERMISSION_USER_DIALOG_ID = 'UNIVER_SHEET_PERMISSION_USER_DIALOG_ID';\nexport const UNIVER_SHEET_PERMISSION_DIALOG_ID = 'UNIVER_SHEET_PERMISSION_DIALOG_ID';\n\nexport const subUnitPermissionTypeMap: Partial<Record<UnitAction, string>> = {\n    [UnitAction.Copy]: 'Copy',\n    [UnitAction.SetCellStyle]: 'SetCellStyle',\n    [UnitAction.SetCellValue]: 'SetCellValue',\n    [UnitAction.SetRowStyle]: 'SetRowStyle',\n    [UnitAction.SetColumnStyle]: 'SetColumnStyle',\n    [UnitAction.InsertRow]: 'InsertRow',\n    [UnitAction.InsertColumn]: 'InsertColumn',\n    [UnitAction.InsertHyperlink]: 'InsertHyperlink',\n    [UnitAction.DeleteRow]: 'DeleteRow',\n    [UnitAction.DeleteColumn]: 'DeleteColumn',\n    [UnitAction.Sort]: 'Sort',\n    [UnitAction.Filter]: 'Filter',\n    [UnitAction.PivotTable]: 'PivotTable',\n    [UnitAction.EditExtraObject]: 'EditExtraObject',\n};\n\nexport const defaultWorksheetUnitActionList: UnitAction[] = [\n    UnitAction.Copy,\n    UnitAction.SetCellStyle,\n    UnitAction.SetCellValue,\n    UnitAction.SetRowStyle,\n    UnitAction.SetColumnStyle,\n    UnitAction.InsertRow,\n    UnitAction.InsertColumn,\n    UnitAction.InsertHyperlink,\n    UnitAction.DeleteRow,\n    UnitAction.DeleteColumn,\n    UnitAction.Sort,\n    UnitAction.Filter,\n    UnitAction.PivotTable,\n    UnitAction.EditExtraObject,\n    UnitAction.View,\n];\n\nexport const permissionMenuIconKey = 'sheet-permission-menu-icon';\nexport const permissionDeleteIconKey = 'sheet-permission-delete-icon';\nexport const permissionEditIconKey = 'sheet-permission-edit-icon';\nexport const permissionCheckIconKey = 'sheet-permission-check-icon';\nexport const permissionLockIconKey = 'sheet-permission-lock-icon';\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IRange } from '@univerjs/core';\nimport { EditStateEnum, type IRangeProtectionRule, type IWorksheetProtectionRule, UnitObject, ViewStateEnum } from '@univerjs/sheets';\n\nexport const DEFAULT_RANGE_RULE: IRangeProtectionRule = {\n    unitId: '',\n    subUnitId: '',\n    permissionId: '',\n    unitType: UnitObject.SelectRange,\n    id: '',\n    ranges: [],\n    viewState: ViewStateEnum.OthersCanView,\n    editState: EditStateEnum.OnlyMe,\n};\n\nexport type IPermissionPanelRule = (IRangeProtectionRule | IWorksheetProtectionRule) & { ranges: IRange[]; id: string };\n\nexport class SheetPermissionPanelModel {\n    private _rule: IPermissionPanelRule = DEFAULT_RANGE_RULE;\n\n    private _visible = false;\n\n    setVisible(v: boolean) {\n        this._visible = v;\n    }\n\n    getVisible() {\n        return this._visible;\n    }\n\n    reset() {\n        this.setVisible(false);\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICollaborator } from '@univerjs/protocol';\nimport { BehaviorSubject } from 'rxjs';\n\nexport class SheetPermissionUserManagerService {\n    private _userList: ICollaborator[] = [];\n    private _userList$ = new BehaviorSubject<ICollaborator[]>(this._userList);\n    userList$ = this._userList$.asObservable();\n\n    private _oldCollaboratorList: ICollaborator[] = [];\n\n    private _selectUserList: ICollaborator[] = [];\n    private _selectUserList$ = new BehaviorSubject<ICollaborator[]>(this._selectUserList);\n    selectUserList$ = this._selectUserList$.asObservable();\n\n    get userList() {\n        return this._userList;\n    }\n\n    // Set all editable users of this unit\n    setCanEditUserList(userList: ICollaborator[]) {\n        this._userList = userList;\n        this._userList$.next(userList);\n    }\n\n    reset() {\n        this._userList = [];\n        this._oldCollaboratorList = [];\n        this._selectUserList = [];\n        this._selectUserList$.next([]);\n    }\n\n    get oldCollaboratorList() {\n        return this._oldCollaboratorList;\n    }\n\n    setOldCollaboratorList(userList: ICollaborator[]) {\n        this._oldCollaboratorList = userList;\n    }\n\n    get selectUserList() {\n        return this._selectUserList;\n    }\n\n    // The results of the user dialog selection panel should be rendered in the permission panel\n    setSelectUserList(userList: ICollaborator[]) {\n        this._selectUserList = userList;\n        this._selectUserList$.next(userList);\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommand } from '@univerjs/core';\nimport type { IPermissionPanelRule } from '../../services/permission/sheet-permission-panel.model';\nimport { CommandType } from '@univerjs/core';\nimport { ISidebarService } from '@univerjs/ui';\nimport { UNIVER_SHEET_PERMISSION_PANEL } from '../../consts/permission';\nimport { SheetPermissionPanelModel } from '../../services/permission/sheet-permission-panel.model';\nimport { SheetPermissionUserManagerService } from '../../services/permission/sheet-permission-user-list.service';\n\nexport interface IPermissionOpenPanelParam {\n    fromSheetBar?: boolean;\n    showDetail?: boolean;\n    rule?: IPermissionPanelRule;\n    oldRule?: IPermissionPanelRule;\n}\n\nexport const SheetPermissionOpenPanelOperation: ICommand<IPermissionOpenPanelParam> = {\n    type: CommandType.OPERATION,\n    id: 'sheet-permission.operation.openPanel',\n    async handler(accessor, _params = {}) {\n        const sidebarService = accessor.get(ISidebarService);\n        const sheetPermissionPanelModel = accessor.get(SheetPermissionPanelModel);\n        const sheetPermissionUserManagerService = accessor.get(SheetPermissionUserManagerService);\n\n        const { showDetail = true, fromSheetBar = false, rule, oldRule } = _params;\n\n        const sidebarProps = {\n            header: { title: 'permission.panel.title' },\n            children: {\n                label: UNIVER_SHEET_PERMISSION_PANEL,\n                showDetail,\n                fromSheetBar,\n                rule,\n                oldRule,\n            },\n            width: 330,\n            onClose: () => {\n                sheetPermissionPanelModel.reset();\n                sheetPermissionUserManagerService.reset();\n            },\n        };\n\n        sheetPermissionPanelModel.setVisible(true);\n        sidebarService.open(sidebarProps);\n\n        return true;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommand, Workbook } from '@univerjs/core';\nimport type { IRangeProtectionRule } from '@univerjs/sheets';\nimport { CommandType, ICommandService, IUndoRedoService, IUniverInstanceService, Rectangle, Tools, UniverInstanceType } from '@univerjs/core';\nimport { AddRangeProtectionMutation, DeleteRangeProtectionMutation, DeleteWorksheetProtectionCommand, RangeProtectionRuleModel, SheetsSelectionsService, WorksheetProtectionRuleModel } from '@univerjs/sheets';\nimport { SheetPermissionOpenPanelOperation } from '../operations/sheet-permission-open-panel.operation';\n\nexport interface IAddRangeProtectionParams {\n    permissionId: string;\n    rule: IRangeProtectionRule;\n}\n\nexport type ISetRangeProtectionParams = IAddRangeProtectionParams;\n\nexport interface IDeleteRangeProtectionParams {\n    unitId: string;\n    subUnitId: string;\n    rule: IRangeProtectionRule;\n}\n\nexport const AddRangeProtectionFromToolbarCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.add-range-protection-from-toolbar',\n    async handler(accessor) {\n        const commandService = accessor.get(ICommandService);\n        await commandService.executeCommand(SheetPermissionOpenPanelOperation.id, { showDetail: true });\n        return true;\n    },\n};\n\nexport const AddRangeProtectionFromContextMenuCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.add-range-protection-from-context-menu',\n    async handler(accessor) {\n        const commandService = accessor.get(ICommandService);\n        await commandService.executeCommand(SheetPermissionOpenPanelOperation.id, { showDetail: true });\n        return true;\n    },\n};\n\nexport const ViewSheetPermissionFromContextMenuCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.view-sheet-permission-from-context-menu',\n    async handler(accessor) {\n        const commandService = accessor.get(ICommandService);\n        await commandService.executeCommand(SheetPermissionOpenPanelOperation.id, { showDetail: false });\n        return true;\n    },\n};\n\nexport const AddRangeProtectionFromSheetBarCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.add-range-protection-from-sheet-bar',\n    async handler(accessor) {\n        const commandService = accessor.get(ICommandService);\n        await commandService.executeCommand(SheetPermissionOpenPanelOperation.id, { fromSheetBar: true, showDetail: true });\n        return true;\n    },\n};\n\nexport const ViewSheetPermissionFromSheetBarCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.view-sheet-permission-from-sheet-bar',\n    async handler(accessor) {\n        const commandService = accessor.get(ICommandService);\n        await commandService.executeCommand(SheetPermissionOpenPanelOperation.id, { showDetail: false });\n        return true;\n    },\n};\n\nexport const DeleteRangeProtectionFromContextMenuCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.delete-range-protection-from-context-menu',\n    async handler(accessor) {\n        const commandService = accessor.get(ICommandService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const worksheetRuleModel = accessor.get(WorksheetProtectionRuleModel);\n\n        const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n        const worksheet = workbook.getActiveSheet()!;\n        const unitId = workbook.getUnitId();\n        const subUnitId = worksheet.getSheetId();\n        const worksheetRule = worksheetRuleModel.getRule(unitId, subUnitId);\n\n        if (worksheetRule?.permissionId) {\n            return commandService.executeCommand(DeleteWorksheetProtectionCommand.id, { unitId, subUnitId, rule: worksheetRule });\n        } else {\n            const selectRange = selectionManagerService.getCurrentLastSelection()?.range;\n            if (!selectRange) {\n                return false;\n            }\n            const sheetPermissionRuleModal = accessor.get(RangeProtectionRuleModel);\n\n            const subRuleList = sheetPermissionRuleModal.getSubunitRuleList(unitId, subUnitId);\n            const rule = subRuleList.find((item) => {\n                return item.ranges.some((range) => Rectangle.intersects(range, selectRange));\n            });\n\n            if (rule) {\n                const redoMutationParam = {\n                    unitId,\n                    subUnitId,\n                    ruleIds: [rule.id],\n                };\n                const result = await commandService.executeCommand(DeleteRangeProtectionMutation.id, redoMutationParam);\n                if (result) {\n                    undoRedoService.pushUndoRedo({\n                        unitID: unitId,\n                        redoMutations: [{ id: DeleteRangeProtectionMutation.id, params: redoMutationParam }],\n                        undoMutations: [{ id: AddRangeProtectionMutation.id, params: { unitId, subUnitId, rules: [rule] } }],\n                    });\n                }\n                return true;\n            } else {\n                return false;\n            }\n        }\n    },\n\n};\n\nexport const SetRangeProtectionFromContextMenuCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.set-range-protection-from-context-menu',\n    async handler(accessor) {\n        const commandService = accessor.get(ICommandService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const worksheetRuleModel = accessor.get(WorksheetProtectionRuleModel);\n        const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n        const worksheet = workbook.getActiveSheet()!;\n        const unitId = workbook.getUnitId();\n        const subUnitId = worksheet.getSheetId();\n        const worksheetRule = worksheetRuleModel.getRule(unitId, subUnitId);\n        if (worksheetRule?.permissionId) {\n            const oldRule = {\n                ...worksheetRule,\n                unitId,\n                subUnitId,\n                ranges: [],\n            };\n            await commandService.executeCommand(SheetPermissionOpenPanelOperation.id, { showDetail: true, rule: Tools.deepClone(oldRule), oldRule: Tools.deepClone(oldRule) });\n            return true;\n        } else {\n            const selectRange = selectionManagerService.getCurrentLastSelection()?.range;\n            if (!selectRange) {\n                return false;\n            }\n            const sheetPermissionRuleModal = accessor.get(RangeProtectionRuleModel);\n            const subRuleList = sheetPermissionRuleModal.getSubunitRuleList(unitId, subUnitId);\n            const rule = subRuleList.find((item) => {\n                return item?.ranges?.some((range) => Rectangle.intersects(range, selectRange));\n            });\n\n            if (rule) {\n                const oldRule = {\n                    ...rule,\n                    unitId,\n                    subUnitId,\n                };\n                await commandService.executeCommand(SheetPermissionOpenPanelOperation.id, { showDetail: true, rule: Tools.deepClone(oldRule), oldRule: Tools.deepClone(oldRule) });\n                return true;\n            } else {\n                return false;\n            }\n        }\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand } from '@univerjs/core';\nimport type { APPLY_TYPE } from '../../services/auto-fill/type';\n\nimport { CommandType } from '@univerjs/core';\nimport { IAutoFillService } from '../../services/auto-fill/auto-fill.service';\n\ninterface IRefillCommandParams {\n    type: APPLY_TYPE;\n}\n\nexport const RefillCommand: ICommand = {\n    id: 'sheet.command.refill',\n    type: CommandType.COMMAND,\n    handler: async (accessor: IAccessor, params: IRefillCommandParams) => {\n        const autoFillService = accessor.get(IAutoFillService);\n        return autoFillService.fillData(params.type);\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand } from '@univerjs/core';\nimport { CommandType, ICommandService, IUniverInstanceService, LocaleService } from '@univerjs/core';\nimport type { IRemoveRowColCommandParams } from '@univerjs/sheets';\nimport { getSheetCommandTarget, RemoveColCommand, RemoveRowCommand, SheetsSelectionsService } from '@univerjs/sheets';\nimport { IConfirmService } from '@univerjs/ui';\n\nimport { isAllColumnsCovered, isAllRowsCovered } from './utils/selection-utils';\n\nexport const RemoveRowConfirmCommand: ICommand = {\n    id: 'sheet.command.remove-row-confirm',\n    type: CommandType.COMMAND,\n    handler: async (accessor: IAccessor, params?: IRemoveRowColCommandParams) => {\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n\n        let range = params?.range;\n        if (!range) {\n            range = selectionManagerService.getCurrentLastSelection()?.range;\n        }\n        if (!range) {\n            return false;\n        }\n\n        const commandService = accessor.get(ICommandService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet } = target;\n        const allRowRanges = worksheet.getVisibleRows();\n\n        if (isAllRowsCovered(allRowRanges, [range])) {\n            const confirmService = accessor.get(IConfirmService);\n            const localeService = accessor.get(LocaleService);\n\n            await confirmService.confirm({\n                id: 'sheet.confirm.remove-row',\n                title: {\n                    title: localeService.t('info.problem'),\n                },\n                children: { title: localeService.t('rightClick.deleteAllRowsAlert') },\n                cancelText: localeService.t('button.cancel'),\n                confirmText: localeService.t('button.confirm'),\n            });\n\n            return false;\n        }\n\n        await commandService.executeCommand(RemoveRowCommand.id, { range });\n        return true;\n    },\n};\n\nexport const RemoveColConfirmCommand: ICommand = {\n    id: 'sheet.command.remove-col-confirm',\n    type: CommandType.COMMAND,\n    handler: async (accessor: IAccessor, params?: IRemoveRowColCommandParams) => {\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n\n        let range = params?.range;\n        if (!range) {\n            range = selectionManagerService.getCurrentLastSelection()?.range;\n        }\n        if (!range) {\n            return false;\n        }\n\n        const commandService = accessor.get(ICommandService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet } = target;\n        const allColumnRanges = worksheet.getVisibleCols();\n\n        if (isAllColumnsCovered(allColumnRanges, [range])) {\n            const confirmService = accessor.get(IConfirmService);\n            const localeService = accessor.get(LocaleService);\n\n            await confirmService.confirm({\n                id: 'sheet.confirm.remove-col',\n                title: {\n                    title: localeService.t('info.problem'),\n                },\n                children: { title: localeService.t('rightClick.deleteAllColumnsAlert') },\n                cancelText: localeService.t('button.cancel'),\n                confirmText: localeService.t('button.confirm'),\n            });\n\n            return false;\n        }\n\n        await commandService.executeCommand(RemoveColCommand.id, { range });\n        return true;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand } from '@univerjs/core';\nimport { CommandType, ICommandService, LocaleService } from '@univerjs/core';\nimport { RemoveSheetCommand } from '@univerjs/sheets';\nimport { IConfirmService } from '@univerjs/ui';\n\ninterface IRemoveSheetConfirmCommandParams {\n    subUnitId: string;\n}\n\nexport const RemoveSheetConfirmCommand: ICommand = {\n    id: 'sheet.command.remove-sheet-confirm',\n    type: CommandType.COMMAND,\n    handler: async (accessor: IAccessor, params: IRemoveSheetConfirmCommandParams) => {\n        const { subUnitId } = params;\n        const confirmService = accessor.get(IConfirmService);\n        const commandService = accessor.get(ICommandService);\n        const localeService = accessor.get(LocaleService);\n        const result = await confirmService.confirm({\n            id: 'sheet.confirm.remove-sheet',\n            title: {\n                title: localeService.t('sheetConfig.deleteSheet'),\n            },\n            children: { title: localeService.t('sheetConfig.deleteSheetContent') },\n            cancelText: localeService.t('button.cancel'),\n            confirmText: localeService.t('button.confirm'),\n        });\n\n        if (result) {\n            await commandService.executeCommand(RemoveSheetCommand.id, { subUnitId });\n            return true;\n        }\n\n        return false;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport type { RenderUnit } from '@univerjs/engine-render';\nimport type { ISelectionWithStyle } from '@univerjs/sheets';\nimport { createIdentifier, Disposable, Inject, IUniverInstanceService, ThemeService, Tools, UniverInstanceType } from '@univerjs/core';\nimport { IRenderManagerService } from '@univerjs/engine-render';\n\nimport { SELECTION_SHAPE_DEPTH } from '../selection/const';\nimport { SelectionControl } from '../selection/selection-control';\nimport { attachSelectionWithCoord } from '../selection/util';\nimport { SheetSkeletonManagerService } from '../sheet-skeleton-manager.service';\n\nexport interface IMarkSelectionService {\n    addShape(selection: ISelectionWithStyle, exits?: string[], zIndex?: number): string | null;\n    addShapeWithNoFresh(selection: ISelectionWithStyle, exits?: string[], zIndex?: number): string | null;\n    removeShape(id: string): void;\n    removeAllShapes(): void;\n    refreshShapes(): void;\n    getShapeMap(): Map<string, IMarkSelectionInfo>;\n}\n\ninterface IMarkSelectionInfo {\n    unitId: string;\n    subUnitId: string;\n    selection: ISelectionWithStyle;\n    zIndex: number;\n    control: SelectionControl | null;\n    exits: string[];\n}\n\nconst DEFAULT_Z_INDEX = SELECTION_SHAPE_DEPTH.MARK_SELECTION; ;\nexport const IMarkSelectionService = createIdentifier<IMarkSelectionService>('univer.mark-selection-service');\n\n/**\n * For copy and cut selection.\n * also for selection when hover on conditional format items in the cf panel on the right.\n * NOT FOR hovering on panel in data validation.\n */\nexport class MarkSelectionService extends Disposable implements IMarkSelectionService {\n    private _shapeMap: Map<string, IMarkSelectionInfo> = new Map();\n\n    constructor(\n        @IUniverInstanceService private readonly _currentService: IUniverInstanceService,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService,\n        @Inject(ThemeService) private readonly _themeService: ThemeService\n    ) {\n        super();\n    }\n\n    addShape(selection: ISelectionWithStyle, exits: string[] = [], zIndex: number = DEFAULT_Z_INDEX): string | null {\n        const workbook = this._currentService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n        const subUnitId = workbook.getActiveSheet()?.getSheetId();\n        if (!subUnitId) return null;\n        const id = Tools.generateRandomId();\n\n        const markSelectionInfo: IMarkSelectionInfo = {\n            selection,\n            subUnitId,\n            unitId: workbook.getUnitId(),\n            zIndex,\n            control: null,\n            exits,\n        };\n        this._shapeMap.set(id, markSelectionInfo);\n\n        this.refreshShapes();\n        return id;\n    }\n\n    addShapeWithNoFresh(selection: ISelectionWithStyle, exits: string[] = [], zIndex: number = DEFAULT_Z_INDEX): string | null {\n        const workbook = this._currentService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n        const subUnitId = workbook.getActiveSheet()?.getSheetId();\n        if (!subUnitId) return null;\n        const id = Tools.generateRandomId();\n        this._shapeMap.set(id, {\n            selection,\n            subUnitId,\n            unitId: workbook.getUnitId(),\n            zIndex,\n            control: null,\n            exits,\n        });\n\n        return id;\n    }\n\n    refreshShapes(): void {\n        const currentSheet = this._currentService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        if (!currentSheet) return;\n\n        const currentUnitId = currentSheet.getUnitId();\n        const currentSubUnitId = currentSheet.getActiveSheet()?.getSheetId();\n        this._shapeMap.forEach((shape) => {\n            const { unitId, subUnitId, selection, control: oldControl, zIndex } = shape;\n            oldControl?.dispose();\n\n            if (unitId !== currentUnitId || subUnitId !== currentSubUnitId) {\n                return;\n            }\n\n            const renderUnit = this._renderManagerService.getRenderById(unitId) as RenderUnit;\n            if (!renderUnit) return;\n\n            const skeleton = renderUnit.with(SheetSkeletonManagerService).getCurrentSkeleton();\n            if (!skeleton) return;\n\n            const { scene } = renderUnit;\n            const { rowHeaderWidth, columnHeaderHeight } = skeleton;\n            const control = new SelectionControl(scene, zIndex, this._themeService, {\n                enableAutoFill: false,\n                highlightHeader: false,\n                rowHeaderWidth,\n                columnHeaderHeight,\n            });\n            const selectionWithCoord = attachSelectionWithCoord(selection, skeleton);\n            control.updateRangeBySelectionWithCoord(selectionWithCoord);\n            shape.control = control;\n        });\n    }\n\n    getShapeMap(): Map<string, IMarkSelectionInfo> {\n        return this._shapeMap;\n    }\n\n    removeShape(id: string): void {\n        const shapeInfo = this._shapeMap.get(id);\n        if (!shapeInfo) return;\n        const { control } = shapeInfo;\n        control?.dispose();\n        this._shapeMap.delete(id);\n    }\n\n    removeAllShapes(): void {\n        for (const shape of this._shapeMap.values()) {\n            const { control } = shape;\n            control?.dispose();\n        }\n        this._shapeMap.clear();\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ThemeService } from '@univerjs/core';\nimport type { ISelectionStyle } from '@univerjs/sheets';\n\nexport function createCopyPasteSelectionStyle(\n    themeService: ThemeService\n): Partial<ISelectionStyle> {\n    return {\n        strokeWidth: 1.5,\n        stroke: themeService.getCurrentTheme().primaryColor,\n        fill: 'rgba(178, 178, 178, 0.10)',\n        widgets: {},\n        strokeDash: 8,\n    };\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IMutationInfo, IRange, IStyleData } from '@univerjs/core';\nimport { createIdentifier, Disposable, ICommandService, ILogService, Inject, IUndoRedoService, ObjectMatrix, ThemeService } from '@univerjs/core';\nimport { SetRangeValuesMutation, SheetsSelectionsService } from '@univerjs/sheets';\nimport type { Observable } from 'rxjs';\nimport { BehaviorSubject } from 'rxjs';\n\nimport { IMarkSelectionService } from '../mark-selection/mark-selection.service';\nimport { createCopyPasteSelectionStyle } from '../utils/selection-util';\n\nexport interface IFormatPainterService {\n    status$: Observable<FormatPainterStatus>;\n    addHook(hooks: IFormatPainterHook): void;\n    getHooks(): IFormatPainterHook[];\n    setStatus(status: FormatPainterStatus): void;\n    getStatus(): FormatPainterStatus;\n    setSelectionFormat(format: ISelectionFormatInfo): void;\n    getSelectionFormat(): ISelectionFormatInfo;\n    applyFormatPainter(unitId: string, subUnitId: string, range: IRange): boolean;\n}\n\nexport interface ISelectionFormatInfo {\n    styles: ObjectMatrix<IStyleData>;\n    merges: IRange[];\n}\n\nexport interface IFormatPainterHook {\n    id: string;\n    isDefaultHook?: boolean;\n    priority?: number;\n    onStatusChange?(status: FormatPainterStatus): void;\n    onApply?(\n        unitId: string,\n        subUnitId: string,\n        range: IRange,\n        format: ISelectionFormatInfo): {\n        undos: IMutationInfo[];\n        redos: IMutationInfo[];\n    };\n    onBeforeApply?(ctx: IFormatPainterBeforeApplyHookParams): boolean;\n}\nexport enum FormatPainterStatus {\n    OFF,\n    ONCE,\n    INFINITE,\n}\nexport interface IFormatPainterBeforeApplyHookParams {\n    unitId: string;\n    subUnitId: string;\n    range: IRange;\n    redoMutationsInfo: IMutationInfo[];\n    undoMutationsInfo: IMutationInfo[];\n    format: ISelectionFormatInfo;\n}\n\nexport const IFormatPainterService = createIdentifier<IFormatPainterService>('univer.format-painter-service');\n\nexport class FormatPainterService extends Disposable implements IFormatPainterService {\n    readonly status$: Observable<FormatPainterStatus>;\n    private _selectionFormat: ISelectionFormatInfo;\n    private _markId: string | null = null;\n    private readonly _status$: BehaviorSubject<FormatPainterStatus>;\n    private _defaultHook: IFormatPainterHook | null = null;\n    private _extendHooks: IFormatPainterHook[] = [];\n\n    constructor(\n        @Inject(SheetsSelectionsService) private readonly _selectionManagerService: SheetsSelectionsService,\n        @Inject(ThemeService) private readonly _themeService: ThemeService,\n        @IMarkSelectionService private readonly _markSelectionService: IMarkSelectionService,\n        @ILogService private readonly _logService: ILogService,\n        @ICommandService private readonly _commandService: ICommandService,\n        @IUndoRedoService private readonly _undoRedoService: IUndoRedoService\n    ) {\n        super();\n\n        this._status$ = new BehaviorSubject<FormatPainterStatus>(FormatPainterStatus.OFF);\n        this.status$ = this._status$.asObservable();\n        this._selectionFormat = { styles: new ObjectMatrix<IStyleData>(), merges: [] };\n    }\n\n    addHook(hook: IFormatPainterHook): void {\n        if (hook.isDefaultHook && (hook.priority ?? 0) > (this._defaultHook?.priority ?? -1)) {\n            this._defaultHook = hook;\n        } else {\n            this._extendHooks.push(hook);\n            this._extendHooks.sort((a, b) => (a.priority || 0) - (b.priority || 0));\n        }\n    }\n\n    getHooks(): IFormatPainterHook[] {\n        return this._defaultHook ? [this._defaultHook, ...this._extendHooks] : this._extendHooks;\n    }\n\n    setStatus(status: FormatPainterStatus): void {\n        this._updateRangeMark(status);\n        this._status$.next(status);\n        const hooks = this.getHooks();\n        hooks.forEach((hook) => {\n            if (hook.onStatusChange !== undefined) {\n                hook.onStatusChange(status);\n            }\n        });\n    }\n\n    getStatus(): FormatPainterStatus {\n        return this._status$.getValue();\n    }\n\n    setSelectionFormat(format: ISelectionFormatInfo): void {\n        this._selectionFormat = format;\n    }\n\n    getSelectionFormat(): ISelectionFormatInfo {\n        return this._selectionFormat;\n    }\n\n    applyFormatPainter(unitId: string, subUnitId: string, range: IRange): boolean {\n        const hooks = this.getHooks();\n        const redoMutationsInfo: IMutationInfo[] = [];\n        const undoMutationsInfo: IMutationInfo[] = [];\n        hooks.forEach((h) => {\n            if (h.onApply !== undefined) {\n                const applyReturn = h.onApply(\n                    unitId,\n                    subUnitId,\n                    range,\n                    this._selectionFormat\n                );\n                if (applyReturn) {\n                    redoMutationsInfo.push(...applyReturn.redos);\n                    undoMutationsInfo.push(...applyReturn.undos);\n                }\n            }\n        });\n\n        for (const beforeHook of hooks) {\n            if (beforeHook.onBeforeApply !== undefined) {\n                // check before apply hook\uFF0C it can cancel the apply action\n                const result = beforeHook.onBeforeApply({\n                    unitId,\n                    subUnitId,\n                    range,\n                    redoMutationsInfo,\n                    format: this._selectionFormat,\n                    undoMutationsInfo,\n                });\n\n                if (!result) {\n                    return false;\n                }\n            }\n        }\n\n        this._logService.log('[FormatPainterService]', 'apply mutations', {\n            undoMutationsInfo,\n            redoMutationsInfo,\n        });\n\n        const result = redoMutationsInfo.every((m) => this._commandService.executeCommand(m.id, m.params));\n        if (result) {\n            // add to undo redo services\n            this._undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: undoMutationsInfo,\n                redoMutations: redoMutationsInfo,\n            });\n        }\n\n        return result;\n    }\n\n    private _updateRangeMark(status: FormatPainterStatus): void {\n        this._markSelectionService.removeAllShapes();\n\n        if (status !== FormatPainterStatus.OFF) {\n            const selection = this._selectionManagerService.getCurrentLastSelection();\n            if (selection) {\n                const style = createCopyPasteSelectionStyle(this._themeService);\n                if (status === FormatPainterStatus.INFINITE) {\n                    this._markId = this._markSelectionService.addShape({ ...selection, style });\n                } else {\n                    this._markId = this._markSelectionService.addShape({ ...selection, style }, [\n                        SetRangeValuesMutation.id,\n                    ]);\n                }\n            }\n        }\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IOperation } from '@univerjs/core';\nimport { CommandType } from '@univerjs/core';\n\nimport type { FormatPainterStatus } from '../../services/format-painter/format-painter.service';\nimport { IFormatPainterService } from '../../services/format-painter/format-painter.service';\n\nexport interface ISetFormatPainterOperationParams {\n    status: FormatPainterStatus;\n}\nexport const SetFormatPainterOperation: IOperation<ISetFormatPainterOperationParams> = {\n    id: 'sheet.operation.set-format-painter',\n    type: CommandType.OPERATION,\n    handler: (accessor, params) => {\n        if (!params) {\n            return false;\n        }\n\n        const formatPainterService = accessor.get(IFormatPainterService);\n        formatPainterService.setStatus(params.status);\n        return true;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand, IRange } from '@univerjs/core';\nimport {\n    CommandType,\n    ICommandService,\n} from '@univerjs/core';\n\nimport { FormatPainterStatus, IFormatPainterService } from '../../services/format-painter/format-painter.service';\nimport { SetFormatPainterOperation } from '../operations/set-format-painter.operation';\n\nexport interface ISetFormatPainterCommandParams {\n    status: FormatPainterStatus;\n}\n\nexport const SetInfiniteFormatPainterCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.set-infinite-format-painter',\n    handler: async (accessor: IAccessor) => {\n        const formatPainterService = accessor.get(IFormatPainterService);\n        const status = formatPainterService.getStatus();\n        let newStatus: FormatPainterStatus;\n        if (status !== FormatPainterStatus.OFF) {\n            newStatus = FormatPainterStatus.OFF;\n        } else {\n            newStatus = FormatPainterStatus.INFINITE;\n        }\n        const commandService = accessor.get(ICommandService);\n\n        return commandService.executeCommand(SetFormatPainterOperation.id, { status: newStatus });\n    },\n};\n\nexport const SetOnceFormatPainterCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.set-once-format-painter',\n    handler: async (accessor: IAccessor) => {\n        const formatPainterService = accessor.get(IFormatPainterService);\n        const status = formatPainterService.getStatus();\n        let newStatus: FormatPainterStatus;\n        if (status !== FormatPainterStatus.OFF) {\n            newStatus = FormatPainterStatus.OFF;\n        } else {\n            newStatus = FormatPainterStatus.ONCE;\n        }\n        const commandService = accessor.get(ICommandService);\n        return commandService.executeCommand(SetFormatPainterOperation.id, { status: newStatus });\n    },\n};\n\nexport interface IApplyFormatPainterCommandParams {\n    subUnitId: string;\n    unitId: string;\n    range: IRange;\n}\n\nexport const ApplyFormatPainterCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.apply-format-painter',\n    handler: async (accessor: IAccessor, params: IApplyFormatPainterCommandParams) => {\n        const formatPainterService = accessor.get(IFormatPainterService);\n        return formatPainterService.applyFormatPainter(params.unitId, params.subUnitId, params.range);\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Nullable, Workbook } from '@univerjs/core';\nimport type { IRenderContext, IRenderModule } from '@univerjs/engine-render';\nimport { Inject } from '@univerjs/core';\nimport { BehaviorSubject } from 'rxjs';\nimport { SheetSkeletonManagerService } from './sheet-skeleton-manager.service';\n\nexport interface IScrollState {\n    /**\n     * offsetX from startRow, coordinate same as viewport, not scrollbar\n     */\n    offsetX: number;\n    /**\n     * offsetY from startColumn, coordinate same as viewport, not scrollbar\n     */\n    offsetY: number;\n    /**\n     * Current start row in viewportMain in canvas, NOT the first row of visible area of current viewport after freeze.\n     * e.g. If no freeze, it's the same as startRow in current viewport.\n     * If freeze, this value is smaller than the first row of visible area.  Just pretend that viewMainTop does not exist.\n     *\n     * e.g. If row 1 ~ 2 is frozen, the first row if viewMain is 3, but sheetViewStartRow still 0.\n     */\n    sheetViewStartRow: number;\n    /**\n     * Current start column in viewportMain in canvas, NOT the first column of visible area of current viewport after freeze.\n     * e.g. If no freeze, it's the same as startColumn in current viewport.\n     * If freeze, this value is smaller than the first column of visible area.  Just pretend that viewMainLeft does not exist.\n     *\n     * e.g. If column A ~ C is frozen, the first column of viewMain is D, but sheetViewStartColumn still 0.\n     */\n    sheetViewStartColumn: number;\n}\n\nexport interface IViewportScrollState extends IScrollState {\n    /** scroll value in scrollbar */\n    scrollX: number;\n    /** scroll value in scrollbar */\n    scrollY: number;\n    /** scroll value on viewport */\n    viewportScrollX: number;\n    /** scroll value on viewport */\n    viewportScrollY: number;\n}\n\nexport interface IScrollStateSearchParam {\n    unitId: string;\n    sheetId: string;\n}\n\nexport interface IScrollStateWithSearchParam extends IScrollStateSearchParam, IScrollState { }\n\nexport type IScrollStateMap = Map<string, Map<string, IScrollState>>;\n\n/**\n * This service manages and sets the virtual scrolling of the canvas content area.\n * It triggers service changes through SetScrollOperation.\n *\n * ScrollController subscribes to the changes in service data to refresh the view scrolling.\n */\nexport class SheetScrollManagerService implements IRenderModule {\n    /**\n     * a map holds all scroll info for each sheet(valid value)\n     */\n    private readonly _scrollStateMap: IScrollStateMap = new Map();\n    /**\n     * a subject for current sheet scrollInfo, no limit by viewport.\n     */\n    private readonly _rawScrollInfo$ = new BehaviorSubject<Nullable<IScrollState>>(null);\n    /**\n     * a subject for current sheet scrollInfo ( events, ex wheel event and point events add deltaXY to rawScrollInfo$)\n     */\n    readonly rawScrollInfo$ = this._rawScrollInfo$.asObservable();\n    /**\n     * a subject for current valid scrollInfo, viewport@_scrollCore would limit rawScrollInfo$ exclude negative value or over max value.\n     * use this subject not rawScrollInfo$ when get scrolling state of viewport.\n     * The value of this subject is the same as the value of onScrollAfter$\n     *\n     */\n    readonly validViewportScrollInfo$ = new BehaviorSubject<Nullable<IViewportScrollState>>(null);\n    /**\n     * a subject for current valid scrollInfo, viewport@_scrollCore would limit rawScrollInfo$ exclude negative value or over max value.\n     * use this subject not rawScrollInfo$ when get scrolling state of viewport.\n     */\n\n    private _searchParamForScroll: Nullable<IScrollStateSearchParam> = null;\n\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(SheetSkeletonManagerService) private readonly _sheetSkeletonManagerService: SheetSkeletonManagerService\n    ) {\n        // empty\n    }\n\n    dispose(): void {\n        this._rawScrollInfo$.complete();\n    }\n\n    calcViewportScrollFromRowColOffset(scrollInfo: Nullable<IViewportScrollState>) {\n        if (!scrollInfo) {\n            return {\n                viewportScrollX: 0,\n                viewportScrollY: 0,\n            };\n        }\n\n        let { sheetViewStartColumn, sheetViewStartRow, offsetX, offsetY } = scrollInfo;\n        sheetViewStartRow = sheetViewStartRow || 0;\n        offsetY = offsetY || 0;\n\n        const skeleton = this._sheetSkeletonManagerService.getCurrentSkeleton();\n        const rowAcc = skeleton?.rowHeightAccumulation[sheetViewStartRow - 1] || 0;\n        const colAcc = skeleton?.columnWidthAccumulation[sheetViewStartColumn - 1] || 0;\n        const viewportScrollX = colAcc + offsetX;\n        const viewportScrollY = rowAcc + offsetY;\n\n        return {\n            viewportScrollX,\n            viewportScrollY,\n        };\n    }\n\n    setSearchParam(param: IScrollStateSearchParam) {\n        this._searchParamForScroll = param;\n    }\n\n    getScrollStateByParam(param: IScrollStateSearchParam): Readonly<Nullable<IScrollState>> {\n        return this._getCurrentScroll(param);\n    }\n\n    getCurrentScrollState(): Readonly<IScrollState> {\n        return this._getCurrentScroll(this._searchParamForScroll);\n    }\n\n    setValidScrollState(param: IScrollStateWithSearchParam) {\n        this._setScrollState(param);\n    }\n\n    /**\n     * emit raw scrollInfo by SetScrollOperation, call by ScrollCommand.id.\n     * raw scrollInfo means not handled by limit scroll method.\n     * @param param\n     */\n    emitRawScrollParam(param: IScrollStateWithSearchParam) {\n        this._emitRawScroll(param);\n    }\n\n    /**\n     * Set _scrollStateMap\n     * @param scroll\n     */\n    setValidScrollStateToCurrSheet(scroll: IViewportScrollState) {\n        if (this._searchParamForScroll == null) {\n            return;\n        }\n\n        this._setScrollState({\n            ...this._searchParamForScroll,\n            ...scroll,\n        });\n\n        const sheetId = this._searchParamForScroll.sheetId;\n        const sheetSkeleton = this._sheetSkeletonManagerService.getSkeleton(sheetId);\n        if (sheetSkeleton) {\n            sheetSkeleton.setScroll(scroll.viewportScrollX, scroll.viewportScrollY);\n        }\n    }\n\n    clear(): void {\n        if (this._searchParamForScroll == null) {\n            return;\n        }\n        this._clearByParamAndNotify(this._searchParamForScroll);\n    }\n\n    /**\n     * scroll\n     * @param scrollInfo\n     */\n    private _setScrollState(scrollInfo: IScrollStateWithSearchParam): void {\n        const { unitId, sheetId, sheetViewStartColumn, sheetViewStartRow, offsetX, offsetY } = scrollInfo;\n\n        if (!this._scrollStateMap.has(unitId)) {\n            this._scrollStateMap.set(unitId, new Map());\n        }\n\n        const worksheetScrollInfoMap = this._scrollStateMap.get(unitId)!;\n        const newScrollInfo: IScrollState = {\n            sheetViewStartRow,\n            sheetViewStartColumn,\n            offsetX,\n            offsetY,\n        };\n        worksheetScrollInfoMap.set(sheetId, newScrollInfo);\n    }\n\n    private _clearByParamAndNotify(param: IScrollStateSearchParam): void {\n        this._setScrollState({\n            ...param,\n            sheetViewStartRow: 0,\n            sheetViewStartColumn: 0,\n            offsetX: 0,\n            offsetY: 0,\n        });\n\n        this._emitRawScroll({\n            sheetViewStartRow: 0,\n            sheetViewStartColumn: 0,\n            offsetX: 0,\n            offsetY: 0,\n        });\n    }\n\n    private _getCurrentScroll(param: Nullable<IScrollStateSearchParam>): IScrollState {\n        const emptyState = {\n            sheetViewStartRow: 0,\n            sheetViewStartColumn: 0,\n            offsetX: 0,\n            offsetY: 0,\n        };\n        if (param == null) {\n            return emptyState;\n        }\n        const { unitId, sheetId } = param;\n        const currScrollState = this._scrollStateMap.get(unitId)?.get(sheetId);\n        return currScrollState || emptyState;\n    }\n\n    private _emitRawScroll(param: IScrollState): void {\n        this._rawScrollInfo$.next(param);\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommand } from '@univerjs/core';\nimport type { ISetFrozenMutationParams } from '@univerjs/sheets';\nimport { CommandType, ICommandService, IUndoRedoService, IUniverInstanceService, RANGE_TYPE } from '@univerjs/core';\nimport { IRenderManagerService } from '@univerjs/engine-render';\n\nimport { getSheetCommandTarget, SetFrozenMutation, SetFrozenMutationFactory, SheetsSelectionsService } from '@univerjs/sheets';\nimport { SheetScrollManagerService } from '../../services/scroll-manager.service';\n\nexport enum SetSelectionFrozenType {\n    RowColumn = 0,\n    Row = 1,\n    Column = 2,\n}\n\nexport interface ISetSelectionFrozenCommandParams {\n    type?: SetSelectionFrozenType;\n}\n\nexport const SetSelectionFrozenCommand: ICommand<ISetSelectionFrozenCommandParams> = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.set-selection-frozen',\n    handler: async (accessor, params) => {\n        const { type } = params || {};\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { unitId, subUnitId } = target;\n        const commandService = accessor.get(ICommandService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const selections = selectionManagerService.getCurrentSelections();\n        if (!selections) {\n            return false;\n        }\n        const currentSelection = selections[selections?.length - 1];\n        const { range } = currentSelection;\n\n        const renderManagerSrv = accessor.get(IRenderManagerService);\n        const scrollManagerService = renderManagerSrv.getRenderById(unitId)!.with(SheetScrollManagerService);\n\n        const { sheetViewStartRow = 0, sheetViewStartColumn = 0 } = scrollManagerService.getCurrentScrollState() || {};\n        let startRow;\n        let startColumn;\n        let freezedRowCount;\n        let freezedColCount;\n        const { startRow: selectRow, startColumn: selectColumn, rangeType } = range;\n        // Frozen to Row\n        if (rangeType === RANGE_TYPE.ROW || type === SetSelectionFrozenType.Row) {\n            startRow = selectRow;\n            freezedRowCount = selectRow - sheetViewStartRow;\n            startColumn = -1;\n            freezedColCount = 0;\n            // Frozen to Column\n        } else if (rangeType === RANGE_TYPE.COLUMN || type === SetSelectionFrozenType.Column) {\n            startRow = -1;\n            freezedRowCount = 0;\n            startColumn = selectColumn;\n            freezedColCount = selectColumn - sheetViewStartColumn;\n            // Frozen to Range\n        } else if (rangeType === RANGE_TYPE.NORMAL) {\n            startRow = selectRow;\n            freezedRowCount = selectRow - sheetViewStartRow;\n            startColumn = selectColumn;\n            freezedColCount = selectColumn - sheetViewStartColumn;\n            // Unexpected value\n        } else {\n            return false;\n        }\n        const redoMutationParams: ISetFrozenMutationParams = {\n            unitId,\n            subUnitId,\n            startRow,\n            startColumn,\n            xSplit: startColumn > 0 ? Math.max(1, freezedColCount) : freezedColCount,\n            ySplit: startRow > 0 ? Math.max(1, freezedRowCount) : freezedRowCount,\n        };\n        const undoMutationParams: ISetFrozenMutationParams = SetFrozenMutationFactory(accessor, redoMutationParams);\n\n        const result = commandService.syncExecuteCommand(SetFrozenMutation.id, redoMutationParams);\n        if (result) {\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: [{ id: SetFrozenMutation.id, params: undoMutationParams }],\n                redoMutations: [{ id: SetFrozenMutation.id, params: redoMutationParams }],\n            });\n            return true;\n        }\n        return true;\n    },\n};\n\nexport const SetRowFrozenCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.set-row-frozen',\n    handler: async (accessor) => {\n        const commandService = accessor.get(ICommandService);\n        commandService.executeCommand(SetSelectionFrozenCommand.id, {\n            type: SetSelectionFrozenType.Row,\n        });\n\n        return true;\n    },\n};\n\nexport const SetColumnFrozenCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.set-col-frozen',\n    handler: async (accessor) => {\n        const commandService = accessor.get(ICommandService);\n        commandService.executeCommand(SetSelectionFrozenCommand.id, {\n            type: SetSelectionFrozenType.Column,\n        });\n\n        return true;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IRange } from '@univerjs/core';\nimport { Disposable } from '@univerjs/core';\n\nexport class SelectAllService extends Disposable {\n    rangesStack: IRange[] = [];\n    selectedRangeWorksheet: string = '';\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IDisposable, ISelection, ITextRangeParam, Nullable } from '@univerjs/core';\nimport type { KeyCode } from '@univerjs/ui';\nimport { Inject, IUniverInstanceService, LocaleService } from '@univerjs/core';\n\nexport interface IShortcutExperienceSearch {\n    unitId: string;\n    sheetId: string;\n    keycode: KeyCode;\n}\n\nexport interface IShortcutExperienceParam extends IShortcutExperienceSearch {\n    selection?: ISelection;\n    textSelection?: ITextRangeParam;\n}\n\n/**\n * This service is prepared for shortcut experience optimization,\n * including the combined use of enter and tab, the highlighting experience of formulas in the editor, and so on.\n *\n */\nexport class ShortcutExperienceService implements IDisposable {\n    private _current: Nullable<IShortcutExperienceSearch> = null;\n\n    private _shortcutParam: IShortcutExperienceParam[] = [];\n\n    constructor(\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService,\n        @Inject(LocaleService) private readonly _localeService: LocaleService\n    ) {\n        // empty\n    }\n\n    dispose(): void {\n        this._shortcutParam = [];\n    }\n\n    getCurrentBySearch(searchParm: Nullable<IShortcutExperienceSearch>): Nullable<IShortcutExperienceParam> {\n        return this._getCurrentBySearch(searchParm);\n    }\n\n    getCurrent(): Nullable<IShortcutExperienceParam> {\n        return this._getCurrentBySearch(this._current);\n    }\n\n    addOrUpdate(insertParam: IShortcutExperienceParam): Nullable<IShortcutExperienceParam> {\n        const param = this._getCurrentBySearch({\n            unitId: insertParam.unitId,\n            sheetId: insertParam.sheetId,\n            keycode: insertParam.keycode,\n        });\n\n        if (param != null) {\n            const index = this._shortcutParam.indexOf(param);\n            this._shortcutParam.splice(index, 1);\n        }\n\n        this._shortcutParam.push(insertParam);\n\n        return param;\n    }\n\n    remove(searchParm: Nullable<IShortcutExperienceSearch>): Nullable<IShortcutExperienceParam> {\n        if (searchParm == null) {\n            return;\n        }\n        const param = this._getCurrentBySearch(searchParm);\n        if (param == null) {\n            return;\n        }\n        const index = this._shortcutParam.indexOf(param);\n        return this._shortcutParam.splice(index, 1)[0];\n    }\n\n    private _getCurrentBySearch(searchParm: Nullable<IShortcutExperienceSearch>): Nullable<IShortcutExperienceParam> {\n        if (searchParm == null) {\n            return;\n        }\n        const item = this._shortcutParam.find(\n            (param) =>\n                param.unitId === searchParm.unitId &&\n                param.sheetId === searchParm.sheetId &&\n                param.keycode === searchParm.keycode\n        );\n\n        return item;\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommand, IRange } from '@univerjs/core';\nimport type {\n    ISetSelectionsOperationParams,\n} from '@univerjs/sheets';\nimport { CommandType, Direction, ICommandService, IUniverInstanceService, RANGE_TYPE, Rectangle, Tools } from '@univerjs/core';\n\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport {\n    expandToContinuousRange,\n    getCellAtRowCol,\n    getSelectionsService,\n    getSheetCommandTarget,\n    SelectionMoveType,\n    SetSelectionsOperation,\n} from '@univerjs/sheets';\nimport { KeyCode } from '@univerjs/ui';\nimport { SelectAllService } from '../../services/select-all/select-all.service';\nimport { ISheetSelectionRenderService } from '../../services/selection/base-selection-render.service';\nimport { ShortcutExperienceService } from '../../services/shortcut-experience.service';\nimport {\n    checkIfShrink,\n    expandToNextCell,\n    expandToNextGapRange,\n    expandToWholeSheet,\n    findNextGapRange,\n    findNextRange,\n    getStartRange,\n    shrinkToNextCell,\n    shrinkToNextGapRange,\n} from './utils/selection-utils';\n\n// TODO@DR-UNIVER: moveStepPage and moveStepEnd implement\n\nexport enum JumpOver {\n    moveStopeOne,\n    moveGap,\n    moveStepPage,\n    moveStepEnd,\n}\n\nexport interface IMoveSelectionCommandParams {\n    direction: Direction;\n    jumpOver?: JumpOver;\n    nextStep?: number;\n    extra?: string;\n    fromCurrentSelection?: boolean;\n}\n\nexport interface IMoveSelectionEnterAndTabCommandParams {\n    direction: Direction;\n    keycode: KeyCode;\n    extra?: string;\n    fromCurrentSelection?: boolean;\n}\n\n/**\n * Move selection (Mainly by keyboard arrow keys, For Tab and Enter key, check @MoveSelectionEnterAndTabCommand)\n */\nexport const MoveSelectionCommand: ICommand<IMoveSelectionCommandParams> = {\n    id: 'sheet.command.move-selection',\n    type: CommandType.COMMAND,\n    handler: (accessor, params) => {\n        if (!params) {\n            return false;\n        }\n\n        const target = getSheetCommandTarget(accessor.get(IUniverInstanceService));\n        if (!target) return false;\n\n        const { workbook, worksheet } = target;\n        const selection = getSelectionsService(accessor, params.fromCurrentSelection).getCurrentLastSelection();\n        if (!selection) {\n            return false;\n        }\n\n        const { direction, jumpOver, extra } = params;\n        const { range, primary } = selection;\n        const startRange = getStartRange(range, primary, direction);\n\n        // the start range is from the primary selection range\n        const next =\n            jumpOver === JumpOver.moveGap\n                ? findNextGapRange(startRange, direction, worksheet)\n                : findNextRange(startRange, direction, worksheet);\n        const destRange = getCellAtRowCol(next.startRow, next.startColumn, worksheet);\n\n        if (Rectangle.equals(destRange, startRange)) {\n            return false;\n        }\n        const unitId = workbook.getUnitId();\n        // If there are changes to the selection, clear the start position saved by the tab.\n        // This function works in conjunction with the enter and tab shortcuts.\n        accessor.get(ShortcutExperienceService).remove({\n            unitId,\n            sheetId: worksheet.getSheetId(),\n            keycode: KeyCode.TAB,\n        });\n\n        const selections = [\n            {\n                range: Rectangle.clone(destRange),\n                primary: {\n                    startRow: destRange.startRow,\n                    startColumn: destRange.startColumn,\n                    endRow: destRange.endRow,\n                    endColumn: destRange.endColumn,\n                    actualRow: next.startRow,\n                    actualColumn: next.startColumn,\n                    isMerged: destRange.isMerged,\n                    isMergedMainCell:\n                        destRange.startRow === next.startRow && destRange.startColumn === next.startColumn,\n                },\n            },\n        ];\n        const rs = accessor.get(ICommandService).executeCommand(SetSelectionsOperation.id, {\n            unitId: workbook.getUnitId(),\n            subUnitId: worksheet.getSheetId(),\n            selections,\n            type: SelectionMoveType.MOVE_END,\n            extra,\n            reveal: true,\n        } as ISetSelectionsOperationParams);\n        return rs;\n    },\n};\n\n/**\n * Move selection for enter and tab.\n */\nexport const MoveSelectionEnterAndTabCommand: ICommand<IMoveSelectionEnterAndTabCommandParams> = {\n    id: 'sheet.command.move-selection-enter-tab',\n    type: CommandType.COMMAND,\n    // eslint-disable-next-line max-lines-per-function, complexity\n    handler: (accessor, params) => {\n        if (!params) {\n            return false;\n        }\n\n        const target = getSheetCommandTarget(accessor.get(IUniverInstanceService));\n        if (!target) return false;\n\n        const { workbook, worksheet } = target;\n        const selectionsService = getSelectionsService(accessor);\n        const { direction, keycode } = params;\n        const isReverse = direction === Direction.LEFT || direction === Direction.UP;\n\n        const selections = selectionsService.getCurrentSelections().concat();\n        const currentSelectionIndex = selections.findIndex((s) => s.primary);\n        const selection = selections[currentSelectionIndex];\n        if (!selection) {\n            return false;\n        }\n        // for shift tab or shift enter, the direction should be reversed. so we need find the previous selection.\n        const delta = isReverse ? -1 : 1;\n        const nextSelection = currentSelectionIndex + delta !== selections.length ? selections[currentSelectionIndex + delta] : selections[0];\n        const nextSelectionIndex = selections.findIndex((s) => s === nextSelection);\n\n        const unitId = workbook.getUnitId();\n        const sheetId = worksheet.getSheetId();\n        if (!selection) {\n            return false;\n        }\n\n        const { range } = selection;\n        const primary = selection.primary!;\n        let startRange = getStartRange(range, primary, direction);\n        const shortcutExperienceService = accessor.get(ShortcutExperienceService);\n\n        const shortcutExperienceParam = shortcutExperienceService.getCurrentBySearch({\n            unitId,\n            sheetId,\n            keycode: KeyCode.TAB,\n        });\n\n        let resultRange;\n\n        const { startRow, endRow, startColumn, endColumn } = range;\n\n        // for the last cell in the selection, the next cell should be the next selection's start cell.\n        const isLastCell = isReverse ? primary.startRow === startRow && primary.startColumn === startColumn : primary.endRow === endRow && primary.endColumn === endColumn;\n        // not single cell should be handled by the move-selection active cell\n        if (!Rectangle.equals(range, primary)) {\n            // Handle the situation of moving the active cell within the selection area.\n            shortcutExperienceService.remove({\n                unitId,\n                sheetId,\n                keycode: KeyCode.TAB,\n            });\n\n            const newPrimary = Tools.deepClone(primary);\n\n            const next = isLastCell\n                ? nextSelection.range :\n                findNextRange(\n                    {\n                        startRow: newPrimary.startRow,\n                        startColumn: newPrimary.startColumn,\n                        endRow: newPrimary.endRow,\n                        endColumn: newPrimary.endColumn,\n                    },\n                    direction,\n                    worksheet,\n                    {\n                        startRow,\n                        endRow,\n                        startColumn,\n                        endColumn,\n                    }\n                );\n\n            const useLeftTopAsDest = isLastCell && isReverse;\n            const destRange = useLeftTopAsDest ? getCellAtRowCol(next.endRow, next.endColumn, worksheet) : getCellAtRowCol(next.startRow, next.startColumn, worksheet);\n\n            resultRange = {\n                range: isLastCell ? nextSelection.range : Rectangle.clone(range),\n                primary: {\n                    startRow: destRange.startRow,\n                    startColumn: destRange.startColumn,\n                    endRow: destRange.endRow,\n                    endColumn: destRange.endColumn,\n                    actualRow: useLeftTopAsDest ? destRange.startRow : next.startRow,\n                    actualColumn: useLeftTopAsDest ? destRange.startColumn : next.startColumn,\n                    isMerged: destRange.isMerged,\n                    isMergedMainCell:\n                        destRange.startRow === next.startRow && destRange.startColumn === next.startColumn,\n                },\n                style: isLastCell ? nextSelection.style : selection.style,\n            };\n        } else {\n            // Handle the regular situation of moving the selection area.\n            if (keycode === KeyCode.TAB) {\n                if (shortcutExperienceParam == null) {\n                    shortcutExperienceService.addOrUpdate({\n                        unitId,\n                        sheetId,\n                        keycode: KeyCode.TAB,\n                        selection,\n                    });\n                }\n            } else {\n                const selectionRemain = shortcutExperienceParam?.selection;\n\n                if (selectionRemain != null) {\n                    const { range, primary } = selectionRemain;\n                    startRange = getStartRange(range, primary, direction);\n                }\n\n                shortcutExperienceService.remove({\n                    unitId,\n                    sheetId,\n                    keycode: KeyCode.TAB,\n                });\n            }\n\n            // the start range is from the primary selection range\n            const next = findNextRange(startRange, direction, worksheet);\n            const destRange = getCellAtRowCol(next.startRow, next.startColumn, worksheet);\n\n            if (Rectangle.equals(destRange, startRange)) {\n                return false;\n            }\n\n            resultRange = {\n                range: Rectangle.clone(destRange),\n                primary: {\n                    startRow: destRange.startRow,\n                    startColumn: destRange.startColumn,\n                    endRow: destRange.endRow,\n                    endColumn: destRange.endColumn,\n                    actualRow: next.startRow,\n                    actualColumn: next.startColumn,\n                    isMerged: destRange.isMerged,\n                    isMergedMainCell:\n                        destRange.startRow === next.startRow && destRange.startColumn === next.startColumn,\n                },\n            };\n        }\n\n        if (isLastCell) {\n            selections[currentSelectionIndex].primary = null;\n            selections[nextSelectionIndex] = resultRange;\n            selectionsService.setSelections(unitId, sheetId, [], SelectionMoveType.MOVE_END);\n        } else {\n            selections[currentSelectionIndex] = resultRange;\n        }\n\n        const rs = accessor.get(ICommandService).executeCommand(SetSelectionsOperation.id, {\n            unitId,\n            subUnitId: sheetId,\n            type: SelectionMoveType.MOVE_END,\n            selections,\n            reveal: true,\n            extra: params.extra,\n        });\n        const renderManagerService = accessor.get(IRenderManagerService);\n        const selectionService = renderManagerService.getRenderById(unitId)?.with(ISheetSelectionRenderService);\n        selectionService?.refreshSelectionMoveEnd();\n        return rs;\n    },\n};\n\nexport interface IExpandSelectionCommandParams {\n    direction: Direction;\n    jumpOver?: JumpOver;\n    nextStep?: number;\n    extra?: string;\n}\n\n// Though the command's name is \"expand-selection\", it actually does not expand but shrink the selection.\n// That depends on the position of currentCell and the whole selection.\nexport const ExpandSelectionCommand: ICommand<IExpandSelectionCommandParams> = {\n    id: 'sheet.command.expand-selection',\n    type: CommandType.COMMAND,\n    handler: (accessor, params) => {\n        if (!params) return false;\n\n        const target = getSheetCommandTarget(accessor.get(IUniverInstanceService));\n        if (!target) return false;\n\n        const { worksheet, unitId, subUnitId } = target;\n\n        const selection = getSelectionsService(accessor).getCurrentLastSelection();\n        if (!selection) return false;\n\n        const { range: startRange, primary } = selection;\n        const { jumpOver, direction, extra } = params;\n\n        const isShrink = checkIfShrink(selection, direction, worksheet);\n        const destRange = !isShrink\n            ? jumpOver === JumpOver.moveGap\n                ? expandToNextGapRange(startRange, direction, worksheet)\n                : expandToNextCell(startRange, direction, worksheet)\n            : jumpOver === JumpOver.moveGap\n                ? shrinkToNextGapRange(\n                    startRange,\n                    { ...Rectangle.clone(primary), rangeType: RANGE_TYPE.NORMAL },\n                    direction,\n                    worksheet\n                )\n                : shrinkToNextCell(startRange, direction, worksheet);\n        destRange.rangeType = selection.range.rangeType;\n\n        if (Rectangle.equals(destRange, startRange)) {\n            return false;\n        }\n\n        return accessor.get(ICommandService).syncExecuteCommand(SetSelectionsOperation.id, {\n            unitId,\n            subUnitId,\n            type: SelectionMoveType.MOVE_END,\n            selections: [\n                {\n                    range: destRange,\n                    primary, // this remains unchanged\n                },\n            ],\n            extra,\n            reveal: true,\n        });\n    },\n};\n\nexport interface ISelectAllCommandParams {\n    expandToGapFirst?: boolean;\n    loop?: boolean;\n}\n\n/**\n * This command expand selection to all neighbor ranges. If there are no neighbor ranges. Select the whole sheet.\n */\nexport const SelectAllCommand: ICommand<ISelectAllCommandParams> = {\n    id: 'sheet.command.select-all',\n    type: CommandType.COMMAND,\n    handler: async (accessor, params = { expandToGapFirst: true, loop: false }) => {\n        const target = getSheetCommandTarget(accessor.get(IUniverInstanceService));\n        if (!target) return false;\n        const selection = getSelectionsService(accessor).getCurrentLastSelection();\n        if (!selection) return false;\n\n        const selectAllService = accessor.get(SelectAllService);\n\n        const { worksheet, unitId, subUnitId } = target;\n        const id = `${unitId}|${subUnitId}`;\n        if (id !== selectAllService.selectedRangeWorksheet) {\n            selectAllService.rangesStack = [];\n            selectAllService.selectedRangeWorksheet = id;\n        }\n\n        const maxRow = worksheet.getMaxRows();\n        const maxCol = worksheet.getMaxColumns();\n        const { expandToGapFirst, loop } = params;\n        const { range, primary } = selection;\n        const isWholeSheetSelected =\n            range.endColumn === maxCol - 1 &&\n            range.endRow === maxRow - 1 &&\n            range.startRow === 0 &&\n            range.startColumn === 0;\n\n        if (!selectAllService.rangesStack.some((s) => Rectangle.equals(s, range))) {\n            selectAllService.rangesStack = [];\n            selectAllService.rangesStack.push(range);\n        }\n\n        let destRange: IRange;\n\n        // determined what kind of adjustment it should get\n        if (isWholeSheetSelected) {\n            if (loop) {\n                const currentSelectionIndex = selectAllService.rangesStack.findIndex((s) => Rectangle.equals(s, range));\n                if (currentSelectionIndex !== selectAllService.rangesStack.length - 1) {\n                    return false;\n                }\n\n                destRange = selectAllService.rangesStack[0];\n            } else {\n                return false;\n            }\n        } else if (expandToGapFirst) {\n            destRange = expandToContinuousRange(range, { left: true, right: true, up: true, down: true }, worksheet);\n            if (Rectangle.equals(destRange, range)) {\n                // already to gaps\n                destRange = expandToWholeSheet(worksheet);\n            }\n        } else {\n            destRange = expandToWholeSheet(worksheet);\n        }\n\n        if (!selectAllService.rangesStack.some((s) => Rectangle.equals(s, destRange))) {\n            selectAllService.rangesStack.push(destRange);\n        }\n\n        return accessor.get(ICommandService).executeCommand(SetSelectionsOperation.id, {\n            unitId,\n            subUnitId,\n            reveal: true,\n            selections: [\n                {\n                    range: destRange,\n                    primary, // this remains unchanged\n                },\n            ],\n        });\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IUniverInstanceService, Nullable } from '@univerjs/core';\nimport type {\n    Engine,\n    IRenderContext,\n    IRenderManagerService,\n    Rect,\n    Scene,\n    Spreadsheet,\n    SpreadsheetColumnHeader,\n    SpreadsheetHeader,\n    SpreadsheetSkeleton,\n    Viewport,\n} from '@univerjs/engine-render';\nimport { UniverInstanceType, Workbook } from '@univerjs/core';\nimport { SHEET_VIEWPORT_KEY, Vector2 } from '@univerjs/engine-render';\n\nimport { SHEET_VIEW_KEY } from '../../common/keys';\n\nexport interface ISheetObjectParam {\n    spreadsheet: Spreadsheet;\n    spreadsheetRowHeader: SpreadsheetHeader;\n    spreadsheetColumnHeader: SpreadsheetColumnHeader;\n    /**\n     * sheet corner: a rect which placed on the intersection of rowHeader & columnHeader\n     */\n    spreadsheetLeftTopPlaceholder: Rect;\n    scene: Scene;\n    engine: Engine;\n}\n\nfunction isRenderManagerService(renderManagerService: IRenderManagerService | IRenderContext): renderManagerService is IRenderManagerService {\n    return typeof (renderManagerService as IRenderContext).isMainScene === 'undefined';\n}\n\n/**\n * Get render objects of a spreadsheet.\n */\nexport function getSheetObject(\n    univerInstanceService: IUniverInstanceService | Workbook,\n    renderManagerService: IRenderManagerService | IRenderContext\n): Nullable<ISheetObjectParam> {\n    const workbook = univerInstanceService instanceof Workbook\n        ? univerInstanceService\n        : univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    if (!workbook) return null;\n\n    const unitId = workbook.getUnitId();\n\n    let components, mainComponent, scene, engine;\n    if (isRenderManagerService(renderManagerService)) {\n        const currentRender = renderManagerService.getRenderById(unitId);\n        if (currentRender == null) return null;\n        components = currentRender.components;\n        components = currentRender.components;\n        mainComponent = currentRender.mainComponent;\n        scene = currentRender.scene;\n        engine = currentRender.engine;\n    } else {\n        components = renderManagerService.components;\n        mainComponent = renderManagerService.mainComponent;\n        scene = renderManagerService.scene;\n        engine = renderManagerService.engine;\n    }\n\n    if (!components || !mainComponent) return null;\n\n    const spreadsheet = mainComponent as Spreadsheet;\n    const spreadsheetRowHeader = components.get(SHEET_VIEW_KEY.ROW) as SpreadsheetHeader;\n    const spreadsheetColumnHeader = components.get(SHEET_VIEW_KEY.COLUMN) as SpreadsheetColumnHeader;\n    const spreadsheetLeftTopPlaceholder = components.get(SHEET_VIEW_KEY.LEFT_TOP) as Rect;\n\n    return {\n        spreadsheet,\n        spreadsheetRowHeader,\n        spreadsheetColumnHeader,\n        spreadsheetLeftTopPlaceholder,\n        scene,\n        engine,\n    };\n}\n\nexport function getCoordByCell(row: number, col: number, scene: Scene, skeleton: SpreadsheetSkeleton) {\n    const { startX, startY, endX, endY } = skeleton.getCellWithCoordByIndex(row, col);\n    return { startX, startY, endX, endY };\n}\n\nexport function getCoordByOffset(\n    evtOffsetX: number,\n    evtOffsetY: number,\n    scene: Scene,\n    skeleton: SpreadsheetSkeleton,\n    viewport?: Viewport,\n    closeFirst?: boolean\n) {\n    const relativeCoords = scene.getCoordRelativeToViewport(Vector2.FromArray([evtOffsetX, evtOffsetY]));\n\n    const { x: newEvtOffsetX, y: newEvtOffsetY } = relativeCoords;\n\n    const scrollXY = scene.getScrollXYInfoByViewport(relativeCoords, viewport);\n\n    const { scaleX, scaleY } = scene.getAncestorScale();\n\n    const moveActualSelection = skeleton.getCellIndexByOffset(\n        newEvtOffsetX,\n        newEvtOffsetY,\n        scaleX,\n        scaleY,\n        scrollXY,\n        { closeFirst }\n    );\n\n    const { row, column } = moveActualSelection;\n\n    const startCell = skeleton.getNoMergeCellWithCoordByIndex(row, column);\n\n    const { startX, startY, endX, endY } = startCell;\n\n    return {\n        startX,\n        startY,\n        endX,\n        endY,\n        row,\n        column,\n    };\n}\n\nexport function getTransformCoord(evtOffsetX: number, evtOffsetY: number, scene: Scene, skeleton: SpreadsheetSkeleton) {\n    const relativeCoords = scene.getCoordRelativeToViewport(Vector2.FromArray([evtOffsetX, evtOffsetY]));\n\n    const viewMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n\n    const scrollXY = scene.getScrollXYInfoByViewport(relativeCoords, viewMain);\n    const { scaleX, scaleY } = scene.getAncestorScale();\n\n    const { x: scrollX, y: scrollY } = scrollXY;\n\n    const offsetX = evtOffsetX / scaleX + scrollX;\n\n    const offsetY = evtOffsetY / scaleY + scrollY;\n\n    return { x: offsetX, y: offsetY };\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IFreeze, IRange, IWorksheetData, Nullable, Workbook } from '@univerjs/core';\nimport type { IRenderContext, IRenderModule, IScrollObserverParam, IWheelEvent } from '@univerjs/engine-render';\nimport type { IScrollToCellOperationParams, ISetSelectionsOperationParams, SheetsSelectionsService } from '@univerjs/sheets';\nimport type { IScrollCommandParams } from '../../commands/commands/set-scroll.command';\nimport type { IExpandSelectionCommandParams } from '../../commands/commands/set-selection.command';\nimport type { IScrollState, IScrollStateSearchParam, IViewportScrollState } from '../../services/scroll-manager.service';\n\nimport type { ISheetSkeletonManagerParam } from '../../services/sheet-skeleton-manager.service';\nimport {\n    Direction,\n    Disposable,\n    FOCUSING_SHEET,\n    ICommandService,\n    IContextService,\n    Inject,\n    Injector,\n    RANGE_TYPE,\n    toDisposable,\n    Tools,\n} from '@univerjs/core';\nimport { IRenderManagerService, RENDER_CLASS_TYPE, SHEET_VIEWPORT_KEY } from '@univerjs/engine-render';\nimport { getSelectionsService, ScrollToCellOperation, SetSelectionsOperation } from '@univerjs/sheets';\nimport { ScrollCommand, SetScrollRelativeCommand } from '../../commands/commands/set-scroll.command';\nimport { ExpandSelectionCommand, MoveSelectionCommand, MoveSelectionEnterAndTabCommand } from '../../commands/commands/set-selection.command';\nimport { SheetScrollManagerService } from '../../services/scroll-manager.service';\nimport { SheetSkeletonManagerService } from '../../services/sheet-skeleton-manager.service';\nimport { getSheetObject } from '../utils/component-tools';\n\nconst SHEET_NAVIGATION_COMMANDS = [MoveSelectionCommand.id, MoveSelectionEnterAndTabCommand.id];\n\nconst MOUSE_WHEEL_SPEED_SMOOTHING_FACTOR = 3;\n/**\n * This controller handles scroll logic in sheet interaction.\n */\nexport class SheetsScrollRenderController extends Disposable implements IRenderModule {\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(Injector) private readonly _injector: Injector,\n        @Inject(SheetSkeletonManagerService) private readonly _sheetSkeletonManagerService: SheetSkeletonManagerService,\n        @IContextService private readonly _contextService: IContextService,\n        @ICommandService private readonly _commandService: ICommandService,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService,\n        @Inject(SheetScrollManagerService) private readonly _scrollManagerService: SheetScrollManagerService\n    ) {\n        super();\n\n        this._initCommandListener();\n        this._wheelEventListener();\n        this._scrollBarEventListener();\n        this._initSkeletonListener();\n    }\n\n    private _wheelEventListener() {\n        const { scene } = this._context;\n        if (!scene) return;\n\n        const viewMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n        if (!viewMain) return;\n\n        this.disposeWithMe(\n            scene.onMouseWheel$.subscribeEvent((evt: IWheelEvent, state) => {\n                if (evt.ctrlKey || !this._contextService.getContextValue(FOCUSING_SHEET)) {\n                    return;\n                }\n\n                let offsetX = 0;\n                let offsetY = 0;\n\n                // what????\n                // const scrollNum = Math.abs(evt.deltaX);\n                // offsetX = evt.deltaX > 0 ? scrollNum : -scrollNum;\n                offsetX = evt.deltaX;\n\n                // with shift, scrollY will be scrollX\n                if (evt.shiftKey) {\n                    // mac is weird, when using track pad, scroll vertical with shift key, should get delta value from deltaY.\n                    // but when using with mousewheel, scroll with shift key, only deltaX has value.\n                    offsetX = (evt.deltaY || evt.deltaX) * MOUSE_WHEEL_SPEED_SMOOTHING_FACTOR;\n                } else {\n                    offsetY = evt.deltaY;\n                }\n                this._commandService.executeCommand(SetScrollRelativeCommand.id, { offsetX, offsetY });\n                this._context.scene.makeDirty(true);\n\n                // add offset on scroll position to check whether scrolling is reaching limit\n                const isLimitedStore = viewMain.limitedScroll(viewMain.scrollX + offsetX, viewMain.scrollY + offsetY);\n\n                // if viewport still have space to scroll, prevent default event. (DO NOT move canvas element)\n                // if scrolling is reaching limit, let scrolling event do the default behavior.\n                if (isLimitedStore && !isLimitedStore.isLimitedX && !isLimitedStore.isLimitedY) {\n                    evt.preventDefault();\n                    if (scene.getParent().classType === RENDER_CLASS_TYPE.SCENE_VIEWER) {\n                        state.stopPropagation();\n                    }\n                }\n\n                if (viewMain.isWheelPreventDefaultX && viewMain.isWheelPreventDefaultY) {\n                    evt.preventDefault();\n                }\n            })\n        );\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    private _scrollBarEventListener() {\n        const { scene } = this._context;\n        if (scene == null) return;\n\n        const viewportMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n        if (!viewportMain) return;\n\n        //#region scrollInfo$ subscriber ---> viewport.scrollTo\n        this.disposeWithMe(\n            toDisposable(\n                this._scrollManagerService.rawScrollInfo$.subscribe((rawScrollInfo: Nullable<IScrollState>) => {\n                    const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n                    if (!skeleton) return;\n\n                    if (rawScrollInfo == null) {\n                        viewportMain.scrollToViewportPos({\n                            viewportScrollX: 0,\n                            viewportScrollY: 0,\n                        });\n                        return;\n                    }\n\n                    // prev scrolling state from rawScrollInfo$\n                    const { sheetViewStartRow, sheetViewStartColumn, offsetX, offsetY } = rawScrollInfo;\n\n                    const { startX, startY } = skeleton.getCellWithCoordByIndex(\n                        sheetViewStartRow,\n                        sheetViewStartColumn,\n                        false\n                    );\n\n                    const viewportScrollX = startX + offsetX;\n                    const viewportScrollY = startY + offsetY;\n\n                    viewportMain.scrollToViewportPos({ viewportScrollX, viewportScrollY });\n                })\n            )\n        );\n        //#endregion\n\n        //#region viewport.onScrollAfter$ --> setScrollInfoToCurrSheet & validViewportScrollInfo$\n        this.disposeWithMe(\n            // set scrollInfo, the event is triggered in viewport@_scrollToScrollbarPos\n            viewportMain.onScrollAfter$.subscribeEvent((scrollAfterParam: IScrollObserverParam) => {\n                const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n                if (skeleton == null || scrollAfterParam.isTrigger === false) {\n                    return;\n                }\n\n                const sheetObject = this._getSheetObject();\n                if (skeleton == null || sheetObject == null) {\n                    return;\n                }\n\n                //#region set scrollInfo with validScrollValue\n                const { viewportScrollX, viewportScrollY, scrollX, scrollY } = scrollAfterParam;\n\n                // according to the actual scroll position, the most suitable row, column and offset combination is recalculated.\n                const { row, column, rowOffset, columnOffset } = skeleton.getOffsetRelativeToRowCol(\n                    viewportScrollX,\n                    viewportScrollY\n                );\n\n                const scrollInfo: IViewportScrollState = {\n                    sheetViewStartRow: row,\n                    sheetViewStartColumn: column,\n                    offsetX: columnOffset,\n                    offsetY: rowOffset,\n                    viewportScrollX,\n                    viewportScrollY,\n                    scrollX,\n                    scrollY,\n                };\n                this._scrollManagerService.setValidScrollStateToCurrSheet(scrollInfo);\n                //#endregion\n\n                this._scrollManagerService.validViewportScrollInfo$.next({\n                    ...scrollInfo,\n                    viewportScrollX,\n                    viewportScrollY,\n                    scrollX,\n                    scrollY,\n                });\n                // snapshot is diff by diff users!\n                // this._scrollManagerService.setScrollInfoToSnapshot({ ...lastestScrollInfo, viewportScrollX, viewportScrollY });\n            })\n        );\n        //#endregion\n\n        //#region scroll by bar\n        this.disposeWithMe(\n            // get scrollByBar event from viewport and exec ScrollCommand.id.\n            viewportMain.onScrollByBar$.subscribeEvent((param) => {\n                const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n                if (skeleton == null || param.isTrigger === false) {\n                    return;\n                }\n\n                const sheetObject = this._getSheetObject();\n                if (skeleton == null || sheetObject == null) {\n                    return;\n                }\n                const { viewportScrollX = 0, viewportScrollY = 0 } = param;\n\n                const freeze = this._getFreeze();\n\n                const { row, column, rowOffset, columnOffset } = skeleton.getOffsetRelativeToRowCol(\n                    viewportScrollX,\n                    viewportScrollY\n                );\n\n                // NOT same as SetScrollRelativeCommand. that was exec in sheetRenderController\n                // const freeze = this._getFreeze();\n                this._commandService.executeCommand(ScrollCommand.id, {\n                    sheetViewStartRow: row,\n                    sheetViewStartColumn: column,\n                    offsetX: columnOffset,\n                    offsetY: rowOffset,\n                });\n            })\n        );\n        //#endregion\n    }\n\n    private _initSkeletonListener() {\n        this.disposeWithMe(toDisposable(\n            this._sheetSkeletonManagerService.currentSkeletonBefore$.subscribe((param) => {\n                if (param == null) {\n                    return;\n                }\n                const scrollParam = { unitId: param.unitId, sheetId: param.sheetId } as IScrollStateSearchParam;\n                this._scrollManagerService.setSearchParam(scrollParam);\n                const sheetObject = this._getSheetObject();\n                if (!sheetObject) return;\n                const currScrollInfo = this._scrollManagerService.getScrollStateByParam(scrollParam);\n                const { viewportScrollX, viewportScrollY } = this._scrollManagerService.calcViewportScrollFromRowColOffset(currScrollInfo as unknown as Nullable<IViewportScrollState>);\n\n                if (currScrollInfo) {\n                    this._updateViewportScroll(viewportScrollX, viewportScrollY);\n                }\n            })\n        ));\n    }\n\n    _updateViewportScroll(viewportScrollX: number = 0, viewportScrollY: number = 0) {\n        const sheetObject = this._getSheetObject();\n        if (!sheetObject) return;\n        const scene = sheetObject.scene;\n        const viewportMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n        const viewColRight = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_COLUMN_RIGHT);\n        const viewRowBottom = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_ROW_BOTTOM);\n        const viewportMainLeft = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT);\n        const viewportMainTop = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP);\n        if (viewportMain) {\n            viewportMain.viewportScrollX = viewportScrollX;\n            viewportMain.viewportScrollY = viewportScrollY;\n        }\n        if (viewRowBottom) {\n            viewRowBottom.viewportScrollY = viewportScrollY;\n        }\n        if (viewColRight) {\n            viewColRight.viewportScrollX = viewportScrollX;\n        }\n        if (viewportMainLeft) {\n            viewportMainLeft.viewportScrollY = viewportScrollY;\n        }\n        if (viewportMainTop) {\n            viewportMainTop.viewportScrollX = viewportScrollX;\n        }\n    }\n\n    scrollToRange(range: IRange, forceTop?: boolean, forceLeft?: boolean): boolean {\n        let { endRow, endColumn, startColumn, startRow } = range;\n        const bounding = this._getViewportBounding();\n        if (range.rangeType === RANGE_TYPE.ROW) {\n            startColumn = 0;\n            endColumn = 0;\n        } else if (range.rangeType === RANGE_TYPE.COLUMN) {\n            startRow = 0;\n            endRow = 0;\n        }\n\n        if (bounding && !forceTop && !forceLeft) {\n            const row = bounding.startRow > endRow ? startRow : endRow;\n            const col = bounding.startColumn > endColumn ? startColumn : endColumn;\n            return this._scrollToCell(row, col);\n        } else {\n            return this._scrollToCell(startRow, startColumn, forceTop, forceLeft);\n        }\n    }\n\n    /**\n     * Scroll spreadsheet(viewMain) to cell position. Based on the limitations of viewport and the number of rows and columns, you can only scroll to the maximum scrollable range.\n     *\n     * if column A ~ B is frozen. set second param to 0 would make viewMain start at column C.\n     * set second param to 2 would make viewMain start at column E.\n     * @param {number} row - Cell row\n     * @param {number} column - Cell column\n     * @returns {boolean} - true if scroll is successful\n     */\n    scrollToCell(row: number, column: number) {\n        const worksheet = this._context.unit.getActiveSheet();\n        const {\n            ySplit: freezeYSplit,\n            xSplit: freezeXSplit,\n        } = worksheet.getFreeze();\n        return this._commandService.syncExecuteCommand(ScrollCommand.id, {\n            sheetViewStartRow: row - freezeYSplit,\n            sheetViewStartColumn: column - freezeXSplit,\n            offsetX: 0,\n            offsetY: 0,\n        });\n    }\n\n    private _initCommandListener(): void {\n        this.disposeWithMe(this._commandService.onCommandExecuted((command) => {\n            switch (command.id) {\n                case SetSelectionsOperation.id:\n                    {\n                        const p = command.params as ISetSelectionsOperationParams;\n                        if (p.unitId === this._context.unitId && p.reveal) {\n                            this._scrollToSelection();\n                        }\n                    }\n                    break;\n\n                case ScrollToCellOperation.id:\n                    {\n                        const p = command.params as IScrollToCellOperationParams;\n                        if (p.unitId === this._context.unitId) {\n                            const rangeParam = p.range;\n                            this.scrollToRange(rangeParam);\n                        }\n                    }\n                    break;\n\n                case ExpandSelectionCommand.id:\n                    {\n                        const expandParam = command.params as IExpandSelectionCommandParams;\n                        this._scrollToSelectionForExpand(expandParam);\n                    }\n                    break;\n\n                default:\n                    break;\n            }\n        }));\n    }\n\n    private _scrollToSelectionForExpand(param: IExpandSelectionCommandParams) {\n        setTimeout(() => {\n            const selection = this._getSelectionsService().getCurrentLastSelection();\n            if (selection == null) {\n                return;\n            }\n\n            const { startRow, startColumn, endRow, endColumn } = selection.range;\n\n            const bounds = this._getViewportBounding();\n            if (bounds == null) {\n                return;\n            }\n\n            const { startRow: viewportStartRow, startColumn: viewportStartColumn, endRow: viewportEndRow, endColumn: viewportEndColumn } = bounds;\n\n            let row = 0;\n            let column = 0;\n\n            if (startRow > viewportStartRow) {\n                row = endRow;\n            } else if (endRow < viewportEndRow) {\n                row = startRow;\n            } else {\n                row = viewportStartRow;\n            }\n\n            if (startColumn > viewportStartColumn) {\n                column = endColumn;\n            } else if (endColumn < viewportEndColumn) {\n                column = startColumn;\n            } else {\n                column = viewportStartColumn;\n            }\n\n            if (param.direction === Direction.DOWN) {\n                row = endRow;\n            } else if (param.direction === Direction.UP) {\n                row = startRow;\n            } else if (param.direction === Direction.RIGHT) {\n                column = endColumn;\n            } else if (param.direction === Direction.LEFT) {\n                column = startColumn;\n            }\n\n            this._scrollToCell(row, column);\n        }, 0);\n    }\n\n    private _getFreeze(): Nullable<IFreeze> {\n        const snapshot: IWorksheetData | undefined = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton.getWorksheetConfig();\n        if (snapshot == null) {\n            return;\n        }\n\n        return snapshot.freeze;\n    }\n\n    private _updateSceneSize(param: ISheetSkeletonManagerParam) {\n        if (param == null) {\n            return;\n        }\n\n        const { unitId } = this._context;\n        const { skeleton } = param;\n        const scene = this._renderManagerService.getRenderById(unitId)?.scene;\n\n        if (skeleton == null || scene == null) {\n            return;\n        }\n\n        const { rowTotalHeight, columnTotalWidth, rowHeaderWidthAndMarginLeft, columnHeaderHeightAndMarginTop } =\n            skeleton;\n        const workbook = this._context.unit;\n        const worksheet = workbook.getActiveSheet();\n        if (!worksheet) return;\n\n        // @TODO lumixraku why handle zoom in scroll.render-controller ???\n        // const zoomRatio = worksheet.getZoomRatio() || 1;\n        // scene?.setScaleValueOnly(zoomRatio, zoomRatio);\n        scene?.transformByState({\n            width: rowHeaderWidthAndMarginLeft + columnTotalWidth,\n            height: columnHeaderHeightAndMarginTop + rowTotalHeight,\n        });\n    }\n\n    private _getSheetObject() {\n        return getSheetObject(this._context.unit, this._context);\n    }\n\n    private _scrollToSelectionByDirection(range: IRange) {\n        const bounds = this._getViewportBounding();\n        if (bounds == null) {\n            return false;\n        }\n        const {\n            startRow: viewportStartRow,\n            startColumn: viewportStartColumn,\n            endRow: viewportEndRow,\n            endColumn: viewportEndColumn,\n        } = bounds;\n\n        let row = 0;\n        let column = 0;\n\n        const { startRow, startColumn, endRow, endColumn } = range;\n\n        if (startRow >= viewportStartRow) {\n            row = endRow;\n        }\n\n        if (endRow <= viewportEndRow) {\n            row = startRow;\n        }\n\n        if (startColumn >= viewportStartColumn) {\n            column = endColumn;\n        }\n\n        if (endColumn <= viewportEndColumn) {\n            column = startColumn;\n        }\n\n        this._scrollToCell(row, column);\n    }\n\n    private _scrollToSelection(targetIsActualRowAndColumn = true) {\n        const selection = this._getSelectionsService().getCurrentLastSelection();\n        if (!selection) return;\n\n        const { startRow, startColumn, actualRow, actualColumn } = selection.primary ?? selection.range;\n        const selectionStartRow = targetIsActualRowAndColumn ? actualRow ?? startRow : startRow;\n        const selectionStartColumn = targetIsActualRowAndColumn ? actualColumn ?? startColumn : startColumn;\n\n        this._scrollToCell(selectionStartRow, selectionStartColumn);\n    }\n\n    private _getSelectionsService(): SheetsSelectionsService {\n        return getSelectionsService(this._injector);\n    }\n\n    private _getViewportBounding() {\n        const scene = this._getSheetObject()?.scene;\n        if (scene == null) {\n            return;\n        }\n\n        const viewport = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n        if (viewport == null) {\n            return;\n        }\n\n        const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n        if (skeleton == null) {\n            return;\n        }\n\n        const vpInfo = viewport.calcViewportInfo();\n        return skeleton.getRangeByViewBound(vpInfo.viewBound);\n    }\n\n    // For arrow key to active cell cause scrolling.\n    // eslint-disable-next-line max-lines-per-function, complexity\n    private _scrollToCell(row: number, column: number, forceTop = false, forceLeft = false) {\n        const { rowHeightAccumulation, columnWidthAccumulation } = this._sheetSkeletonManagerService.getCurrentSkeleton() ?? {};\n\n        if (rowHeightAccumulation == null || columnWidthAccumulation == null) return false;\n\n        const scene = this._getSheetObject()?.scene;\n        if (scene == null) return false;\n\n        const viewport = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n        if (viewport == null) return false;\n\n        const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n        if (skeleton == null) return false;\n\n        const worksheet = this._context.unit.getActiveSheet();\n        if (!worksheet) return false;\n\n        row = Tools.clamp(row, 0, rowHeightAccumulation.length - 1);\n        column = Tools.clamp(column, 0, columnWidthAccumulation.length - 1);\n\n        const {\n            startColumn: scrollableStartCol,\n            startRow: scrollableStartRow,\n            ySplit: freezedRowCount,\n            xSplit: freezedColCount,\n        } = worksheet.getFreeze();\n\n        const bounds = this._getViewportBounding();\n        if (bounds == null) return false;\n\n        const {\n            startRow: viewMainStartRow,\n            startColumn: viewMainStartColumn,\n            endRow: viewMainEndRow,\n            endColumn: viewMainEndColumn,\n        } = bounds;\n\n        // why undefined?\n        let startSheetViewRow: number | undefined;\n        let startSheetViewColumn: number | undefined;\n\n        // vertical overflow only happens when the selection's row is in not the freeze area\n        // row >= scrollableStartRow means row is in scrollable area.\n        if (row >= scrollableStartRow && column >= scrollableStartCol - freezedRowCount) {\n            // top overflow: to row above first row in curr viewMain.\n            if (row <= viewMainStartRow) {\n                startSheetViewRow = row;\n                forceTop = true;\n            }\n\n            // bottom overflow: to row below last row.\n            if (row >= viewMainEndRow) {\n                const minRowAccumulation = rowHeightAccumulation[row] - viewport.height!;\n                for (let r = viewMainStartRow; r <= row; r++) {\n                    startSheetViewRow = r + 1;\n                    if (rowHeightAccumulation[r] >= minRowAccumulation) {\n                        break;\n                    }\n                }\n            }\n        }\n        // why need row >= scrollableStartRow - freezedRowCount ?? we are handling column here, why need row?\n        // column >= scrollableStartCol means column is in scrollable area.\n        if (column >= scrollableStartCol && row >= scrollableStartRow - freezedRowCount) {\n            // left overflow\n            if (column <= viewMainStartColumn) {\n                startSheetViewColumn = column;\n                forceLeft = true;\n            }\n\n            // right overflow\n            if (column >= viewMainEndColumn) {\n                const minColumnAccumulation = columnWidthAccumulation[column] - viewport.width!;\n                for (let c = viewMainStartColumn; c <= column; c++) {\n                    startSheetViewColumn = c + 1;\n                    if (columnWidthAccumulation[c] >= minColumnAccumulation) {\n                        break;\n                    }\n                }\n            }\n        }\n\n        if (startSheetViewRow === undefined && startSheetViewColumn === undefined) return false;\n\n        let { offsetX, offsetY, sheetViewStartRow: preSheetViewStartRow, sheetViewStartColumn: preSheetViewStartColumn } = this._scrollManagerService.getCurrentScrollState() || {};\n\n        // startSheetViewRow is undefined means not top overflow or bottom overflow.\n        // means keep current scroll state.\n        startSheetViewRow = startSheetViewRow ? Math.min(startSheetViewRow, row) : preSheetViewStartRow + freezedRowCount; ;\n        startSheetViewColumn = startSheetViewColumn ? Math.min(startSheetViewColumn, column) : preSheetViewStartColumn + freezedColCount;\n\n        if (forceLeft) {\n            offsetX = 0;\n            startSheetViewColumn = column;\n            // for hidden columns\n            const hiddenColumns = skeleton.getHiddenColumnsInRange({ startColumn: startSheetViewColumn - freezedColCount, endColumn: startSheetViewColumn });\n            startSheetViewColumn = startSheetViewColumn - hiddenColumns.length;\n        }\n\n        if (forceTop) {\n            offsetY = 0;\n            startSheetViewRow = row;\n            // for hidden rows, consider hidden rows above the viewport visible area(not in scrollable area)\n            const hiddenRows = skeleton.getHiddenRowsInRange({ startRow: startSheetViewRow - freezedRowCount, endRow: startSheetViewRow });\n            startSheetViewRow = startSheetViewRow - hiddenRows.length;\n        }\n\n        return this._commandService.syncExecuteCommand(ScrollCommand.id, {\n            // sheetViewStartRow & offsetX should never be undefined, it's rendering, there should always be a value!\n\n            // sheetViewStartRow: forceTop ? Math.max(0, row - freezeYSplit) : ((startSheetViewRow ?? 0) - freezeYSplit),\n            // sheetViewStartColumn: forceLeft ? Math.max(0, column - freezeXSplit) : ((startSheetViewColumn ?? 0) - freezeXSplit),\n            // offsetX: startSheetViewColumn === undefined ? offsetX : 0,\n            // offsetY: startSheetViewRow === undefined ? offsetY : 0,\n\n            sheetViewStartRow: Math.max(0, startSheetViewRow - freezedRowCount),\n            sheetViewStartColumn: Math.max(0, startSheetViewColumn - freezedColCount),\n            offsetX,\n            offsetY,\n        } as IScrollCommandParams);\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IOperation } from '@univerjs/core';\nimport type { IScrollStateWithSearchParam } from '../../services/scroll-manager.service';\n\nimport { CommandType } from '@univerjs/core';\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport { SheetScrollManagerService } from '../../services/scroll-manager.service';\n\nexport const SetScrollOperation: IOperation<IScrollStateWithSearchParam> = {\n    id: 'sheet.operation.set-scroll',\n    type: CommandType.OPERATION,\n\n    handler: (accessor, params: IScrollStateWithSearchParam) => {\n        if (!params) {\n            return false;\n        }\n\n        // freeze is handled by set-scroll.command.ts\n        const { unitId, sheetId, offsetX, offsetY, sheetViewStartColumn, sheetViewStartRow } = params;\n        const renderManagerService = accessor.get(IRenderManagerService);\n        const scrollManagerService = renderManagerService.getRenderById(unitId)!.with(SheetScrollManagerService);\n        // const currentService = accessor.get(IUniverInstanceService);\n        // const workbook = currentService.getUniverSheetInstance(unitId);\n        // const worksheet = workbook!.getSheetBySheetId(sheetId);\n        // const { xSplit, ySplit } = worksheet!.getConfig().freeze;\n\n        scrollManagerService.emitRawScrollParam({\n            unitId,\n            sheetId,\n            offsetX,\n            offsetY,\n            sheetViewStartRow,\n            sheetViewStartColumn,\n        });\n\n        return true;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommand, IRange, Nullable } from '@univerjs/core';\nimport type { IScrollState } from '../../services/scroll-manager.service';\n\nimport { CommandType, ICommandService, IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport { getSheetCommandTarget } from '@univerjs/sheets';\nimport { SheetsScrollRenderController } from '../../controllers/render-controllers/scroll.render-controller';\nimport { SheetScrollManagerService } from '../../services/scroll-manager.service';\nimport { SetScrollOperation } from '../operations/scroll.operation';\n\nexport interface ISetScrollRelativeCommandParams {\n    offsetX?: number;\n    offsetY?: number;\n}\n\nexport interface IScrollCommandParams {\n    offsetX?: number;\n    offsetY?: number;\n    /**\n     * The index of row in spreadsheet.\n     * e.g. if row start 10 at current viewport after freeze, and scroll value is zero, startRow is 0.\n     * e.g. if scrolled about 2 rows, now top is 12, then sheetViewStartRow is 2.\n     */\n    sheetViewStartRow?: number;\n\n    /**\n     * Not the index of col in spreadsheet, but index of first column in current viewport.\n     * e.g. if col start C at current viewport after freeze, and scroll value is zero, startColumn is 0.\n     * e.g. if scrolled about 2 columns, now left is E, then sheetViewStartColumn is 2.\n     */\n    sheetViewStartColumn?: number;\n}\n\n/**\n * This command is used to manage the scroll by relative offset\n * Usually triggered by wheel event.\n * NOT same as ScrollCommand, which is usually triggered by scrollbar.\n */\nexport const SetScrollRelativeCommand: ICommand<ISetScrollRelativeCommandParams> = {\n    id: 'sheet.command.set-scroll-relative',\n    type: CommandType.COMMAND,\n    // offsetXY derived from mouse wheel event\n    // this._commandService.executeCommand(SetScrollRelativeCommand.id, { offsetY });\n    handler: async (accessor, params: ISetScrollRelativeCommandParams) => {\n        const commandService = accessor.get(ICommandService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const renderManagerSrv = accessor.get(IRenderManagerService);\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { unitId, subUnitId } = target;\n        const scrollManagerService = renderManagerSrv.getRenderById(unitId)!.with(SheetScrollManagerService);\n        const currentScroll = scrollManagerService.getCurrentScrollState();\n        const { offsetX = 0, offsetY = 0 } = params || {};\n        const {\n            sheetViewStartRow = 0,\n            sheetViewStartColumn = 0,\n            offsetX: currentOffsetX = 0,\n            offsetY: currentOffsetY = 0,\n        } = currentScroll || {};\n        // the receiver is scroll.operation.ts\n        // const { xSplit, ySplit } = target.worksheet.getConfig().freeze;\n\n        return commandService.executeCommand(SetScrollOperation.id, {\n            unitId,\n            sheetId: subUnitId,\n\n            // why + ySplit? receiver - ySplit in scroll.operation.ts\n            // sheetViewStartRow: sheetViewStartRow + ySplit,\n            // sheetViewStartColumn: sheetViewStartColumn + xSplit,\n            sheetViewStartRow,\n            sheetViewStartColumn,\n            offsetX: currentOffsetX + offsetX, // currentOffsetX + offsetX may be negative or over max\n            offsetY: currentOffsetY + offsetY,\n        });\n    },\n};\n\n/**\n * This command is used to manage the scroll position of the current view by specifying the cell index of the top left cell\n * Usually triggered by dragging scroll bar and click scroll track or moving selection range.\n * NOT same as SetScrollRelativeCommand which usually trigger by wheelevent.\n */\nexport const ScrollCommand: ICommand<IScrollCommandParams> = {\n    id: 'sheet.command.scroll-view',\n    type: CommandType.COMMAND,\n    handler: (accessor, params) => {\n        if (!params) {\n            return false;\n        }\n\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const renderManagerSrv = accessor.get(IRenderManagerService);\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { workbook, worksheet, unitId } = target;\n        const scrollManagerService = renderManagerSrv.getRenderById(unitId)!.with(SheetScrollManagerService);\n        const currentScroll: Readonly<Nullable<IScrollState>> = scrollManagerService.getCurrentScrollState();\n\n        if (!worksheet) {\n            return false;\n        }\n\n        const { sheetViewStartRow, sheetViewStartColumn, offsetX, offsetY } = params;\n        const {\n            sheetViewStartColumn: currentColumn,\n            sheetViewStartRow: currentRow,\n            offsetX: currentOffsetX,\n            offsetY: currentOffsetY,\n        } = currentScroll || {};\n        const { xSplit, ySplit } = target.worksheet.getConfig().freeze;\n        const commandService = accessor.get(ICommandService);\n\n        return commandService.syncExecuteCommand(SetScrollOperation.id, {\n            unitId: workbook.getUnitId(),\n            sheetId: worksheet.getSheetId(),\n            // why + ySplit? receiver - ySplit in scroll.operation.ts\n            // sheetViewStartRow: sheetViewStartRow + ySplit,\n            // sheetViewStartColumn: sheetViewStartColumn + xSplit,\n            sheetViewStartRow: sheetViewStartRow ?? (currentRow ?? 0 + ySplit),\n            sheetViewStartColumn: sheetViewStartColumn ?? (currentColumn ?? 0 + xSplit),\n            offsetX: offsetX ?? currentOffsetX,\n            offsetY: offsetY ?? currentOffsetY,\n        });\n    },\n};\n\nexport interface IScrollToCellCommandParams {\n    range: IRange;\n    forceTop?: boolean;\n    forceLeft?: boolean;\n}\n\n/**\n * The command is used to scroll to the specific cell if the target cell is not in the viewport.\n */\nexport const ScrollToCellCommand: ICommand<IScrollToCellCommandParams> = {\n    id: 'sheet.command.scroll-to-cell',\n    type: CommandType.COMMAND,\n    handler: (accessor, params) => {\n        const instanceService = accessor.get(IUniverInstanceService);\n        const renderManagerService = accessor.get(IRenderManagerService);\n        const scrollController = renderManagerService\n            .getRenderById(instanceService.getCurrentUnitForType(UniverInstanceType.UNIVER_SHEET)!.getUnitId())!\n            .with(SheetsScrollRenderController);\n        return scrollController.scrollToRange(params!.range, params!.forceTop, params!.forceLeft);\n    },\n};\n\n/**\n * This command is reset the scroll position of the current view to 0, 0\n */\nexport const ResetScrollCommand: ICommand = {\n    id: 'sheet.command.scroll-view-reset',\n    type: CommandType.COMMAND,\n    handler: async (accessor) => {\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { subUnitId, unitId } = target;\n        const commandService = accessor.get(ICommandService);\n        return commandService.executeCommand(SetScrollOperation.id, {\n            unitId,\n            sheetId: subUnitId,\n            sheetViewStartRow: 0,\n            sheetViewStartColumn: 0,\n        });\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IColAutoWidthInfo, IObjectArrayPrimitiveType, Nullable, Worksheet } from '@univerjs/core';\nimport type { RenderManagerService } from '@univerjs/engine-render';\nimport type {\n    ISetWorksheetColWidthMutationParams,\n} from '@univerjs/sheets';\nimport type { ISetWorksheetColIsAutoWidthCommandParams } from '../commands/commands/set-worksheet-auto-col-width.command';\nimport { Disposable, Inject, IUniverInstanceService } from '@univerjs/core';\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport {\n    getSheetCommandTarget,\n    SetWorksheetColWidthMutation,\n} from '@univerjs/sheets';\nimport { SheetSkeletonManagerService } from '../services/sheet-skeleton-manager.service';\n\nexport const AFFECT_LAYOUT_STYLES = ['ff', 'fs', 'tr', 'tb'];\n\nexport const createAutoColWidthUndoMutationsByRedos = (\n    params: ISetWorksheetColWidthMutationParams,\n    worksheet: Worksheet\n): ISetWorksheetColWidthMutationParams => {\n    const { unitId, subUnitId, ranges } = params;\n    const colWidthObj: IObjectArrayPrimitiveType<Nullable<number>> = {};\n    const manager = worksheet.getColumnManager();\n\n    for (let i = 0; i < ranges.length; i++) {\n        const range = ranges[i];\n        for (let j = range.startColumn; j < range.endColumn + 1; j++) {\n            const col = manager.getColumnOrCreate(j);\n            colWidthObj[j] = col.w;\n        }\n    }\n\n    return {\n        unitId,\n        subUnitId,\n        ranges,\n        colWidth: colWidthObj,\n    };\n};\n\nexport class AutoWidthController extends Disposable {\n    constructor(\n        @IRenderManagerService private readonly _renderManagerService: RenderManagerService,\n        @Inject(IUniverInstanceService) private readonly _univerInstanceService: IUniverInstanceService\n    ) {\n        super();\n    }\n\n    getUndoRedoParamsOfColWidth(params: Required<ISetWorksheetColIsAutoWidthCommandParams>) {\n        const defaultValue = { redos: [], undos: [] };\n        const { _univerInstanceService: univerInstanceService } = this;\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return defaultValue;\n\n        const { unitId, subUnitId, worksheet } = target;\n        const sheetSkeletonService = this._renderManagerService.getRenderById(unitId)!.with<SheetSkeletonManagerService>(SheetSkeletonManagerService);\n\n        if (!sheetSkeletonService.getCurrentParam()) return defaultValue;\n\n        const { skeleton } = sheetSkeletonService.getCurrentParam()!;\n        const colsAutoWidthInfo: IColAutoWidthInfo[] = skeleton.calculateAutoWidthInRange(params.ranges);\n\n        const colWidthObject: IObjectArrayPrimitiveType<Nullable<number>> = {};\n        for (const { col, width } of colsAutoWidthInfo) {\n            colWidthObject[col] = width;\n        }\n        const redoParams: ISetWorksheetColWidthMutationParams = {\n            subUnitId,\n            unitId,\n            ranges: params.ranges,\n            colWidth: colWidthObject,\n        };\n        const undoParams: ISetWorksheetColWidthMutationParams = createAutoColWidthUndoMutationsByRedos(redoParams, worksheet);\n        return {\n            undos: [\n                {\n                    id: SetWorksheetColWidthMutation.id,\n                    params: undoParams,\n                },\n            ],\n            redos: [\n                {\n                    id: SetWorksheetColWidthMutation.id,\n                    params: redoParams,\n                },\n            ],\n        };\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand, IRange } from '@univerjs/core';\n\nimport {\n    CommandType,\n    ICommandService,\n    IUndoRedoService,\n    IUniverInstanceService,\n    sequenceExecute,\n} from '@univerjs/core';\nimport {\n    getSheetCommandTarget,\n    SheetsSelectionsService,\n} from '@univerjs/sheets';\nimport { AutoWidthController } from '../../controllers/auto-width.controller';\n\nexport interface ISetWorksheetColIsAutoWidthCommandParams {\n    unitId?: string;\n    subUnitId?: string;\n    ranges?: IRange[]; // For Facade API\n}\n\nexport const SetWorksheetColAutoWidthCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.set-col-auto-width',\n    handler: (accessor: IAccessor, params?: ISetWorksheetColIsAutoWidthCommandParams) => {\n        const commandService = accessor.get(ICommandService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n        const selectionManagerService = accessor.get(SheetsSelectionsService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const target = getSheetCommandTarget(univerInstanceService, params);\n        if (!target) return false;\n\n        const { unitId, subUnitId } = target;\n\n        let ranges = [];\n        if (params?.ranges) {\n            ranges = [...params.ranges];\n        } else {\n            const selections = selectionManagerService.getCurrentSelections();\n            for (let i = 0; i < selections.length; i++) {\n                ranges.push(selections[i].range);\n            }\n        }\n\n        if (!ranges?.length) {\n            return false;\n        }\n\n        const redoMutationParams: Required<ISetWorksheetColIsAutoWidthCommandParams> = {\n            unitId,\n            subUnitId,\n            ranges,\n        };\n\n        // undos redos comes from auto-width.controller\n        const { redos, undos } = accessor.get(AutoWidthController).getUndoRedoParamsOfColWidth(redoMutationParams);\n\n        const result = sequenceExecute([...redos], commandService);\n        if (result.result) {\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: [...undos],\n                redoMutations: [...redos],\n            });\n\n            return true;\n        }\n\n        return false;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IDisposable, IPosition, ISelectionCell, Nullable, Workbook } from '@univerjs/core';\nimport type { Engine, IDocumentLayoutObject, Scene } from '@univerjs/engine-render';\nimport type { SheetsSelectionsService } from '@univerjs/sheets';\nimport type { KeyCode } from '@univerjs/ui';\nimport type { Observable } from 'rxjs';\nimport {\n    CellValueType,\n    convertCellToRange,\n    createIdentifier,\n    Disposable,\n    DOCS_NORMAL_EDITOR_UNIT_ID_KEY,\n    EDITOR_ACTIVATED,\n    FOCUSING_EDITOR_STANDALONE,\n    IContextService,\n    Inject,\n    IUniverInstanceService,\n    ThemeService,\n    toDisposable,\n    UniverInstanceType,\n} from '@univerjs/core';\nimport { getCanvasOffsetByEngine, IEditorService } from '@univerjs/docs-ui';\nimport { convertTextRotation, convertTransformToOffsetX, convertTransformToOffsetY, DeviceInputEventType, IRenderManagerService } from '@univerjs/engine-render';\nimport { BEFORE_CELL_EDIT, IRefSelectionsService, SheetInterceptorService } from '@univerjs/sheets';\nimport { BehaviorSubject, map, switchMap } from 'rxjs';\nimport { ISheetSelectionRenderService } from './selection/base-selection-render.service';\nimport { attachPrimaryWithCoord } from './selection/util';\nimport { SheetSkeletonManagerService } from './sheet-skeleton-manager.service';\n\nexport interface IEditorBridgeServiceVisibleParam {\n    visible: boolean;\n    eventType: DeviceInputEventType;\n    unitId: string;\n    keycode?: KeyCode;\n}\n\nexport interface ICurrentEditCellParam {\n    scene: Scene;\n    engine: Engine;\n    unitId: string;\n    sheetId: string;\n    primary: ISelectionCell;\n}\n\nexport interface ICellEditorState {\n    unitId: string;\n    sheetId: string;\n    row: number;\n    column: number;\n    documentLayoutObject: IDocumentLayoutObject;\n    editorUnitId: string;\n    isInArrayFormulaRange?: Nullable<boolean>;\n}\n\nexport interface ICellEditorLayout {\n    position: IPosition;\n    canvasOffset: { left: number; top: number };\n    scaleX: number;\n    scaleY: number;\n}\n\nexport interface IEditorBridgeServiceParam extends ICellEditorState, ICellEditorLayout {\n\n}\n\nexport interface IEditorBridgeService {\n    currentEditCellState$: Observable<Nullable<ICellEditorState>>;\n    currentEditCellLayout$: Observable<Nullable<ICellEditorLayout>>;\n    currentEditCell$: Observable<Nullable<IEditorBridgeServiceParam>>;\n    visible$: Observable<IEditorBridgeServiceVisibleParam>;\n    forceKeepVisible$: Observable<boolean>;\n\n    dispose(): void;\n    refreshEditCellState(): void;\n    refreshEditCellPosition(resetSizeOnly?: boolean): void;\n    setEditCell(param: ICurrentEditCellParam): void;\n    getEditCellState(): Readonly<Nullable<IEditorBridgeServiceParam>>;\n    getEditCellLayout(): Readonly<Nullable<ICellEditorLayout>>;\n    getEditLocation(): Readonly<Nullable<ICellEditorState>>;\n    updateEditLocation(row: number, col: number): void;\n    // Gets the DocumentDataModel of the latest table cell based on the latest cell contents\n    getLatestEditCellState(): Readonly<Nullable<IEditorBridgeServiceParam>>;\n    /**\n     * @deprecated do not use it directly, use command SetCellEditVisibleOperation as instead.\n     */\n    changeVisible(param: IEditorBridgeServiceVisibleParam): void;\n    changeEditorDirty(dirtyStatus: boolean): void;\n    getEditorDirty(): boolean;\n    isVisible(): IEditorBridgeServiceVisibleParam;\n    enableForceKeepVisible(): void;\n    disableForceKeepVisible(): void;\n    isForceKeepVisible(): boolean;\n    getCurrentEditorId(): Nullable<string>;\n}\n\nexport class EditorBridgeService extends Disposable implements IEditorBridgeService, IDisposable {\n    private _editorUnitId: string = DOCS_NORMAL_EDITOR_UNIT_ID_KEY;\n    private _editorIsDirty: boolean = false;\n\n    private _isDisabled: boolean = false;\n    private _visible: IEditorBridgeServiceVisibleParam = {\n        visible: false,\n        eventType: DeviceInputEventType.Dblclick,\n        unitId: '',\n    };\n\n    private _currentEditCell: Nullable<ICurrentEditCellParam> = null;\n    private _currentEditCellState: Nullable<ICellEditorState> = null;\n    private _currentEditCellLayout: Nullable<ICellEditorLayout> = null;\n\n    // TODO: @weird94 this should split into to subjects, documentDataModel & position\n    private readonly _currentEditCellState$ = new BehaviorSubject<Nullable<ICellEditorState>>(null);\n    readonly currentEditCellState$ = this._currentEditCellState$.asObservable();\n\n    private readonly _currentEditCellLayout$ = new BehaviorSubject<Nullable<ICellEditorLayout>>(null);\n    readonly currentEditCellLayout$ = this._currentEditCellLayout$.asObservable();\n\n    readonly currentEditCell$ = this._currentEditCellState$.pipe(\n        switchMap((editCellState) => this._currentEditCellLayout$.pipe(map((layout) => (editCellState && layout ? { ...editCellState, ...layout } : null))))\n    );\n\n    private readonly _visible$ = new BehaviorSubject<IEditorBridgeServiceVisibleParam>(this._visible);\n    readonly visible$ = this._visible$.asObservable();\n\n    private readonly _afterVisible$ = new BehaviorSubject<IEditorBridgeServiceVisibleParam>(this._visible);\n    readonly afterVisible$ = this._afterVisible$.asObservable();\n\n    private readonly _forceKeepVisible$ = new BehaviorSubject(false);\n    readonly forceKeepVisible$ = this._forceKeepVisible$.asObservable();\n\n    constructor(\n        @Inject(SheetInterceptorService) private readonly _sheetInterceptorService: SheetInterceptorService,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService,\n        @Inject(ThemeService) private readonly _themeService: ThemeService,\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService,\n        @IEditorService private readonly _editorService: IEditorService,\n        @IRefSelectionsService private readonly _refSelectionsService: SheetsSelectionsService,\n        @IContextService private readonly _contextService: IContextService\n    ) {\n        super();\n\n        this.disposeWithMe(toDisposable(() => {\n            this._currentEditCellState$.complete();\n            this._currentEditCell = null;\n        }));\n\n        this._univerInstanceService.getTypeOfUnitDisposed$(UniverInstanceType.UNIVER_SHEET).subscribe((unit) => {\n            if (unit.getUnitId() === this._currentEditCellState?.unitId) {\n                this._clearCurrentEditCellState();\n            }\n        });\n    }\n\n    refreshEditCellState() {\n        const editCellState = this.getLatestEditCellState();\n        if (!editCellState) {\n            this._currentEditCellState = null;\n            this._currentEditCellLayout = null;\n            this._currentEditCellState$.next(null);\n            this._currentEditCellLayout$.next(null);\n            return;\n        }\n        const { position, scaleX, scaleY, canvasOffset, ...rest } = editCellState;\n        this._currentEditCellState = rest;\n        this._currentEditCellLayout = { position, scaleX, scaleY, canvasOffset };\n        this._currentEditCellState$.next(this._currentEditCellState);\n        this._currentEditCellLayout$.next(this._currentEditCellLayout);\n    }\n\n    refreshEditCellPosition(resetSizeOnly?: boolean) {\n        const currentEditCell = this._currentEditCell;\n        if (currentEditCell == null) {\n            return;\n        }\n\n        const currentSheet = this._univerInstanceService.getCurrentUnitForType(UniverInstanceType.UNIVER_SHEET);\n        if (!currentSheet) return;\n\n        const ru = this._renderManagerService.getRenderUnitById(currentSheet.getUnitId());\n        if (!ru) return;\n\n        const skeleton = ru.with(SheetSkeletonManagerService).getSkeletonParam(currentEditCell.sheetId)?.skeleton;\n        const selectionRenderService = ru.with(ISheetSelectionRenderService);\n        if (!skeleton) return;\n        if (!this._currentEditCellState) return;\n\n        const { primary, unitId, sheetId, scene, engine } = currentEditCell;\n        const primaryWithCoord = attachPrimaryWithCoord(skeleton, primary);\n        if (primaryWithCoord == null) {\n            return;\n        }\n\n        const actualRangeWithCoord = convertCellToRange(primaryWithCoord);\n        const canvasOffset = getCanvasOffsetByEngine(engine);\n\n        let { startX, startY, endX, endY } = actualRangeWithCoord;\n\n        const { scaleX, scaleY } = scene.getAncestorScale();\n\n        const scrollXY = scene.getViewportScrollXY(selectionRenderService.getViewPort());\n        startX = convertTransformToOffsetX(startX, scaleX, scrollXY);\n        startY = convertTransformToOffsetY(startY, scaleY, scrollXY);\n        endX = convertTransformToOffsetX(endX, scaleX, scrollXY);\n        endY = convertTransformToOffsetY(endY, scaleY, scrollXY);\n\n        if (resetSizeOnly && this._currentEditCellLayout) {\n            endX = endX - startX + this._currentEditCellLayout.position.startX;\n            endY = endY - startY + this._currentEditCellLayout.position.startY;\n            startX = this._currentEditCellLayout.position.startX;\n            startY = this._currentEditCellLayout.position.startY;\n        }\n\n        this._currentEditCellLayout = {\n            position: {\n                startX,\n                startY,\n                endX,\n                endY,\n            },\n            canvasOffset,\n            scaleX,\n            scaleY,\n        };\n        this._currentEditCellLayout$.next(this._currentEditCellLayout);\n    }\n\n    setEditCell(param: ICurrentEditCellParam) {\n        this._currentEditCell = param;\n\n        /**\n         * If there is no editor currently focused, then default to selecting the sheet editor to prevent the editorService from using the previously selected editor object.\n         * todo: wzhudev: In boundless mode, it is necessary to switch to the corresponding editorId based on the host's unitId.\n         */\n        if (!this._editorService.getFocusEditor()) {\n            this._editorService.focus(DOCS_NORMAL_EDITOR_UNIT_ID_KEY);\n            /**\n             * Fix: When the sheet loads for the first time, copying and pasting triggers the editor, and the edits are ineffective.\n             */\n            this._contextService.setContextValue(EDITOR_ACTIVATED, false);\n            this._contextService.setContextValue(FOCUSING_EDITOR_STANDALONE, false);\n        }\n\n        const editCellState = this.getLatestEditCellState();\n        if (!editCellState) {\n            this._currentEditCellState = editCellState;\n            this._currentEditCellLayout = editCellState;\n            this._currentEditCellState$.next(editCellState);\n            this._currentEditCellLayout$.next(editCellState);\n            return;\n        }\n\n        const { position, canvasOffset, scaleX, scaleY, ...rest } = editCellState;\n        this._currentEditCellState = rest;\n        this._currentEditCellLayout = { position, canvasOffset, scaleX, scaleY };\n        this._currentEditCellState$.next(this._currentEditCellState);\n        this._currentEditCellLayout$.next(this._currentEditCellLayout);\n    }\n\n    private _clearCurrentEditCellState() {\n        this._currentEditCellState = null;\n        this._currentEditCellState$.next(null);\n        this._currentEditCellLayout = null;\n        this._currentEditCellLayout$.next(null);\n    }\n\n    getEditCellState(): Readonly<Nullable<IEditorBridgeServiceParam>> {\n        if (this._currentEditCellState == null || this._currentEditCellLayout == null) {\n            return null;\n        }\n\n        return { ...this._currentEditCellState, ...this._currentEditCellLayout };\n    }\n\n    getEditCellLayout(): Readonly<Nullable<ICellEditorLayout>> {\n        return this._currentEditCellLayout;\n    }\n\n    getEditLocation(): Readonly<Nullable<ICellEditorState>> {\n        return this._currentEditCellState;\n    }\n\n    updateEditLocation(row: number, column: number) {\n        if (this._currentEditCellState) {\n            this._currentEditCellState = {\n                ...this._currentEditCellState,\n                row,\n                column,\n            };\n        }\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    getLatestEditCellState() {\n        const currentEditCell = this._currentEditCell;\n        if (currentEditCell == null) return;\n\n        const workbook = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        if (!workbook) return;\n\n        const ru = this._renderManagerService.getRenderUnitById(workbook.getUnitId());\n        if (!ru) return;\n\n        const skeleton = ru.with(SheetSkeletonManagerService).getCurrentSkeleton();\n        const selectionRenderService = ru.with(ISheetSelectionRenderService);\n        if (!skeleton) return;\n\n        const { primary, unitId, sheetId, scene, engine } = currentEditCell;\n        const { startRow, startColumn } = primary;\n        const primaryWithCoord = attachPrimaryWithCoord(skeleton, primary);\n        if (primaryWithCoord == null) return;\n\n        const actualRangeWithCoord = convertCellToRange(primaryWithCoord);\n        const canvasOffset = getCanvasOffsetByEngine(engine);\n\n        let { startX, startY, endX, endY } = actualRangeWithCoord;\n\n        const { scaleX, scaleY } = scene.getAncestorScale();\n\n        const scrollXY = scene.getViewportScrollXY(selectionRenderService.getViewPort());\n        startX = convertTransformToOffsetX(startX, scaleX, scrollXY);\n        startY = convertTransformToOffsetY(startY, scaleY, scrollXY);\n        endX = convertTransformToOffsetX(endX, scaleX, scrollXY);\n        endY = convertTransformToOffsetY(endY, scaleY, scrollXY);\n\n        const worksheet = workbook.getActiveSheet();\n        if (!worksheet) return;\n\n        const location = {\n            workbook,\n            worksheet,\n            unitId: workbook.getUnitId(),\n            subUnitId: worksheet.getSheetId(),\n            row: startRow,\n            col: startColumn,\n            origin: worksheet.getCellRaw(startRow, startColumn),\n        };\n\n        let documentLayoutObject: Nullable<IDocumentLayoutObject>;\n        const cell = this._sheetInterceptorService.writeCellInterceptor.fetchThroughInterceptors(BEFORE_CELL_EDIT)(\n            worksheet.getCell(startRow, startColumn),\n            location\n        );\n\n        documentLayoutObject = cell && skeleton.getCellDocumentModelWithFormula(cell);\n\n        // Rewrite the cellValueType to STRING to avoid render the value on the right side when number type.\n        const renderConfig = documentLayoutObject?.documentModel?.documentStyle.renderConfig;\n        if (renderConfig != null) {\n            renderConfig.cellValueType = CellValueType.STRING;\n        }\n\n        if (!documentLayoutObject || documentLayoutObject.documentModel == null) {\n            const blankModel = skeleton.getBlankCellDocumentModel(cell);\n\n            if (documentLayoutObject != null) {\n                const { verticalAlign, horizontalAlign, wrapStrategy, textRotation, fill } = documentLayoutObject;\n                const { centerAngle, vertexAngle } = convertTextRotation(textRotation);\n                blankModel.documentModel!.documentStyle.renderConfig = {\n                    ...renderConfig,\n                    verticalAlign,\n                    horizontalAlign,\n                    wrapStrategy,\n                    background: { rgb: fill },\n                    centerAngle,\n                    vertexAngle,\n                };\n            }\n            documentLayoutObject = blankModel;\n        }\n        // background of canvas is set to transparent, so if no bgcolor sepcified in curr cell, set it to white.\n        documentLayoutObject.fill = documentLayoutObject.fill || '#fff';\n        documentLayoutObject.documentModel?.setZoomRatio(Math.max(scaleX, scaleY));\n\n        if (cell?.isInArrayFormulaRange === true) {\n            const body = documentLayoutObject.documentModel?.getBody();\n            if (body) {\n                body.textRuns = [\n                    {\n                        st: 0,\n                        ed: body.dataStream.length - 2,\n                        ts: {\n                            cl: {\n                                rgb: this._themeService.getCurrentTheme().textColorSecondary,\n                            },\n                        },\n                    },\n                ];\n            }\n        }\n\n        return {\n            position: {\n                startX,\n                startY,\n                endX,\n                endY,\n            },\n            scaleX,\n            scaleY,\n            canvasOffset,\n            row: startRow,\n            column: startColumn,\n            unitId,\n            sheetId,\n            documentLayoutObject,\n            editorUnitId: this._editorUnitId,\n            isInArrayFormulaRange: cell?.isInArrayFormulaRange,\n        };\n    }\n\n    getCurrentEditorId() {\n        return this._editorUnitId;\n    }\n\n    changeVisible(param: IEditorBridgeServiceVisibleParam) {\n        this._visible = param;\n\n        // Reset the dirty status when the editor is visible.\n        if (param.visible) {\n            this._editorIsDirty = false;\n        }\n\n        this._visible$.next(this._visible);\n        this._afterVisible$.next(this._visible);\n    }\n\n    isVisible() {\n        return this._visible;\n    }\n\n    enableForceKeepVisible(): void {\n        this._forceKeepVisible$.next(true);\n    }\n\n    disableForceKeepVisible(): void {\n        this._forceKeepVisible$.next(false);\n    }\n\n    isForceKeepVisible(): boolean {\n        return this._forceKeepVisible$.getValue();\n    }\n\n    changeEditorDirty(dirtyStatus: boolean) {\n        this._editorIsDirty = dirtyStatus;\n    }\n\n    getEditorDirty() {\n        return this._editorIsDirty;\n    }\n}\n\nexport const IEditorBridgeService = createIdentifier<EditorBridgeService>('univer.sheet-editor-bridge.service');\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport type { IRenderContext, IRenderModule, IWheelEvent } from '@univerjs/engine-render';\nimport { Disposable, DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY, FOCUSING_SHEET, ICommandService, IContextService, Inject, Optional } from '@univerjs/core';\nimport { SetZoomRatioCommand } from '../../commands/commands/set-zoom-ratio.command';\nimport { IEditorBridgeService } from '../../services/editor-bridge.service';\nimport { SheetSkeletonManagerService } from '../../services/sheet-skeleton-manager.service';\nimport { getSheetObject } from '../utils/component-tools';\n\n/**\n * Zoom render controller, registered in a render module.\n */\nexport class SheetsZoomRenderController extends Disposable implements IRenderModule {\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(SheetSkeletonManagerService) private readonly _sheetSkeletonManagerService: SheetSkeletonManagerService,\n        @ICommandService private readonly _commandService: ICommandService,\n        @IContextService private readonly _contextService: IContextService,\n        @Optional(IEditorBridgeService) private readonly _editorBridgeService?: IEditorBridgeService\n    ) {\n        super();\n\n        this._initSkeletonListener();\n        this._initZoomEventListener();\n    }\n\n    updateZoom(worksheetId: string, zoomRatio: number): boolean {\n        const worksheet = this._context.unit.getSheetBySheetId(worksheetId);\n        if (!worksheet) return false;\n\n        worksheet.getConfig().zoomRatio = zoomRatio;\n        if (worksheet === this._context.unit.getActiveSheet()) {\n            this._updateViewZoom(zoomRatio);\n        }\n\n        return true;\n    }\n\n    private _initZoomEventListener() {\n        const scene = this._getSheetObject().scene;\n\n        this.disposeWithMe(\n            // hold ctrl & mousewheel ---> zoom\n            scene.onMouseWheel$.subscribeEvent((e: IWheelEvent) => {\n                if (!e.ctrlKey || !this._contextService.getContextValue(FOCUSING_SHEET)) {\n                    return;\n                }\n\n                if (this._editorBridgeService) {\n                    const state = this._editorBridgeService.isVisible();\n                    if ((state.unitId === this._context.unitId || state.unitId === DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY) && state.visible) {\n                        return;\n                    }\n                }\n\n                const deltaFactor = Math.abs(e.deltaX);\n                let ratioDelta = deltaFactor < 40 ? 0.2 : deltaFactor < 80 ? 0.4 : 0.2;\n                ratioDelta *= e.deltaY > 0 ? -1 : 1;\n                if (scene.scaleX < 1) {\n                    ratioDelta /= 2;\n                }\n\n                const workbook = this._context.unit;\n                const sheet = workbook.getActiveSheet();\n                if (!sheet) return;\n\n                const currentRatio = sheet.getZoomRatio();\n                let nextRatio = +Number.parseFloat(`${currentRatio + ratioDelta}`).toFixed(1);\n                nextRatio = nextRatio >= 4 ? 4 : nextRatio <= 0.1 ? 0.1 : nextRatio;\n\n                this._commandService.executeCommand(SetZoomRatioCommand.id, {\n                    zoomRatio: Math.round(nextRatio * 10) / 10,\n                    unitId: workbook.getUnitId(),\n                    subUnitId: sheet.getSheetId(),\n                });\n\n                e.preventDefault();\n            })\n        );\n    }\n\n    private _zoom: number;\n    private _initSkeletonListener() {\n        this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((param) => {\n            if (param == null) {\n                return;\n            }\n\n            const workbook = this._context.unit;\n            const worksheet = workbook.getActiveSheet();\n            if (!worksheet) return;\n\n            const zoomRatio = worksheet.getZoomRatio() || 1;\n            if (this._zoom !== zoomRatio) {\n                this._updateViewZoom(zoomRatio);\n            }\n            this._zoom = zoomRatio;\n        }));\n    }\n\n    /**\n     * Triggered when zoom and switch sheet.\n     * @param zoomRatio\n     */\n    private _updateViewZoom(zoomRatio: number) {\n        const sheetObject = this._getSheetObject();\n        sheetObject?.scene.scale(zoomRatio, zoomRatio);\n        // sheetObject?.scene.transformByState({ scaleX: zoomRatio, scaleY: zoomRatio });\n        sheetObject?.spreadsheet.makeForceDirty();\n    }\n\n    private _getSheetObject() {\n        return getSheetObject(this._context.unit, this._context)!;\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommandType } from '@univerjs/core';\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport type { IOperation } from '@univerjs/core';\nimport { SheetsZoomRenderController } from '../../controllers/render-controllers/zoom.render-controller';\n\nexport interface ISetZoomRatioOperationParams {\n    zoomRatio: number;\n    unitId: string;\n    subUnitId: string;\n}\n\nexport const SetZoomRatioOperation: IOperation<ISetZoomRatioOperationParams> = {\n    id: 'sheet.operation.set-zoom-ratio',\n    type: CommandType.OPERATION,\n    handler: (accessor, params: ISetZoomRatioOperationParams) => {\n        const renderManagerService = accessor.get(IRenderManagerService);\n        const renderUnit = renderManagerService.getRenderById(params.unitId);\n        if (!renderUnit) return false;\n\n        return renderUnit.with(SheetsZoomRenderController).updateZoom(params.subUnitId, params.zoomRatio);\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommand } from '@univerjs/core';\nimport { CommandType, DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY, ICommandService, IUniverInstanceService } from '@univerjs/core';\n\nimport { getSheetCommandTarget } from '@univerjs/sheets';\nimport { SHEET_ZOOM_RANGE } from '../../common/keys';\nimport { IEditorBridgeService } from '../../services/editor-bridge.service';\nimport { SetZoomRatioOperation } from '../operations/set-zoom-ratio.operation';\n\nexport interface ISetZoomRatioCommandParams {\n    zoomRatio: number;\n    unitId: string;\n    subUnitId: string;\n}\nexport interface IChangeZoomRatioCommandParams {\n    reset?: boolean;\n    delta: number;\n}\n\n/**\n * Zoom\n */\n\nexport const ChangeZoomRatioCommand: ICommand<IChangeZoomRatioCommandParams> = {\n    id: 'sheet.command.change-zoom-ratio',\n    type: CommandType.COMMAND,\n    handler: (accessor, params) => {\n        if (!params) {\n            return false;\n        }\n\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { worksheet, subUnitId, unitId } = target;\n        const { delta, reset } = params;\n\n        let zoom = reset ? 100 : Math.round((worksheet.getConfig().zoomRatio + delta) * 100);\n        zoom = Math.max(SHEET_ZOOM_RANGE[0], zoom);\n        zoom = Math.min(SHEET_ZOOM_RANGE[1], zoom);\n\n        const zoomRatio = zoom / 100;\n        const editorBridgeService = accessor.get(IEditorBridgeService);\n        const state = editorBridgeService.isVisible();\n        if ((state.unitId === unitId || state.unitId === DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY) && state.visible) return false;\n\n        return accessor.get(ICommandService).executeCommand(SetZoomRatioOperation.id, {\n            unitId,\n            subUnitId,\n            zoomRatio,\n        });\n    },\n};\n\nexport const SetZoomRatioCommand: ICommand<ISetZoomRatioCommandParams> = {\n    id: 'sheet.command.set-zoom-ratio',\n    type: CommandType.COMMAND,\n    handler: (accessor, params) => {\n        if (!params) {\n            return false;\n        }\n\n        const { unitId, subUnitId, zoomRatio } = params;\n        const editorBridgeService = accessor.get(IEditorBridgeService);\n        const state = editorBridgeService.isVisible();\n        if ((state.unitId === unitId || state.unitId === DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY) && state.visible) return false;\n\n        return accessor.get(ICommandService).executeCommand(SetZoomRatioOperation.id, {\n            unitId,\n            subUnitId,\n            zoomRatio,\n        });\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createIdentifier, Disposable, toDisposable } from '@univerjs/core';\nimport type { IDisposable } from '@univerjs/core';\nimport type { Observable } from 'rxjs';\nimport { Subject } from 'rxjs';\n\nimport type { IScrollState } from '../../views/sheet-bar/sheet-bar-tabs/utils/slide-tab-bar';\n\nexport interface ISheetBarMenuHandler {\n    handleSheetBarMenu(): void;\n}\n\nexport interface ISheetBarService {\n    renameId$: Observable<string>;\n    removeId$: Observable<string>;\n    scroll$: Observable<IScrollState>;\n    scrollX$: Observable<number>;\n    addSheet$: Observable<number>;\n    setRenameId(id: string): void;\n    setRemoveId(id: string): void;\n    setScroll(state: IScrollState): void;\n    setScrollX(x: number): void;\n    setAddSheet(index: number): void;\n    triggerSheetBarMenu(): void;\n    registerSheetBarMenuHandler(handler: ISheetBarMenuHandler): IDisposable;\n}\n\nexport const ISheetBarService = createIdentifier<ISheetBarService>('univer.sheetbar-service');\n\nexport class SheetBarService extends Disposable implements ISheetBarService {\n    readonly renameId$: Observable<string>;\n    readonly removeId$: Observable<string>;\n    readonly scroll$: Observable<IScrollState>;\n    readonly scrollX$: Observable<number>;\n    readonly addSheet$: Observable<number>;\n\n    private readonly _renameId$: Subject<string>;\n    private readonly _removeId$: Subject<string>;\n    private readonly _scroll$: Subject<IScrollState>;\n    private readonly _scrollX$: Subject<number>;\n    private readonly _addSheet$: Subject<number>;\n\n    private _currentHandler: ISheetBarMenuHandler | null = null;\n\n    constructor() {\n        super();\n\n        this._renameId$ = new Subject();\n        this.renameId$ = this._renameId$.asObservable();\n\n        this._removeId$ = new Subject();\n        this.removeId$ = this._removeId$.asObservable();\n\n        this._scroll$ = new Subject();\n        this.scroll$ = this._scroll$.asObservable();\n\n        this._scrollX$ = new Subject();\n        this.scrollX$ = this._scrollX$.asObservable();\n\n        this._addSheet$ = new Subject();\n        this.addSheet$ = this._addSheet$.asObservable();\n    }\n\n    setRenameId(renameId: string): void {\n        this._renameId$.next(renameId);\n    }\n\n    setRemoveId(removeId: string): void {\n        this._removeId$.next(removeId);\n    }\n\n    setScroll(state: IScrollState): void {\n        this._scroll$.next(state);\n    }\n\n    setScrollX(x: number): void {\n        this._scrollX$.next(x);\n    }\n\n    setAddSheet(index: number): void {\n        this._addSheet$.next(index);\n    }\n\n    triggerSheetBarMenu(): void {\n        this._currentHandler?.handleSheetBarMenu();\n    }\n\n    registerSheetBarMenuHandler(handler: ISheetBarMenuHandler): IDisposable {\n        if (this._currentHandler) {\n            throw new Error('There is already a context menu handler!');\n        }\n\n        this._currentHandler = handler;\n\n        return toDisposable(() => {\n            this._currentHandler = null;\n        });\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand } from '@univerjs/core';\nimport { CommandType } from '@univerjs/core';\n\nimport { ISheetBarService } from '../../services/sheet-bar/sheet-bar.service';\n\nexport const ShowMenuListCommand: ICommand = {\n    id: 'ui-sheet.command.show-menu-list',\n    type: CommandType.OPERATION,\n    handler: async (accessor: IAccessor) => {\n        const sheetBarService = accessor.get(ISheetBarService);\n        sheetBarService.triggerSheetBarMenu();\n\n        return true;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommand, Workbook } from '@univerjs/core';\n\nimport { CommandType, ICommandService, IUndoRedoService, IUniverInstanceService } from '@univerjs/core';\n\nimport { UniverType } from '@univerjs/protocol';\nimport { AddWorksheetProtectionCommand, DeleteWorksheetProtectionCommand, WorksheetProtectionRuleModel } from '@univerjs/sheets';\n\nexport const DeleteWorksheetProtectionFormSheetBarCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.delete-worksheet-protection-from-sheet-bar',\n    async handler(accessor, params) {\n        if (!params) {\n            return false;\n        }\n        const commandService = accessor.get(ICommandService);\n        const undoRedoService = accessor.get(IUndoRedoService);\n\n        const worksheetProtectionRuleModel = accessor.get(WorksheetProtectionRuleModel);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverType.UNIVER_SHEET)!;\n        const worksheet = workbook?.getActiveSheet();\n        const unitId = workbook.getUnitId();\n\n        if (!worksheet) {\n            return false;\n        }\n\n        const subUnitId = worksheet.getSheetId();\n\n        const rule = worksheetProtectionRuleModel.getRule(unitId, subUnitId);\n\n        const result = await commandService.executeCommand(DeleteWorksheetProtectionCommand.id, {\n            unitId,\n            subUnitId,\n        });\n\n        if (result) {\n            const redoMutations = [{ id: DeleteWorksheetProtectionCommand.id, params: { unitId, subUnitId } }];\n            const undoMutations = [{ id: AddWorksheetProtectionCommand.id, params: { unitId, rule } }];\n            undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                redoMutations,\n                undoMutations,\n            });\n        }\n\n        return true;\n    },\n};\n\nexport const ChangeSheetProtectionFromSheetBarCommand: ICommand = {\n    type: CommandType.COMMAND,\n    id: 'sheet.command.change-sheet-protection-from-sheet-bar',\n    async handler(accessor) {\n        const commandService = accessor.get(ICommandService);\n        await commandService.executeCommand('sheet-permission.operation.openDialog');\n        return true;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IOperation } from '@univerjs/core';\nimport type { ICurrentEditCellParam } from '../../services/editor-bridge.service';\n\nimport { CommandType } from '@univerjs/core';\nimport { IEditorBridgeService } from '../../services/editor-bridge.service';\n\nexport const SetActivateCellEditOperation: IOperation<ICurrentEditCellParam> = {\n    id: 'sheet.operation.set-activate-cell-edit',\n    type: CommandType.OPERATION,\n    handler: (accessor, params) => {\n        const editorBridgeService = accessor.get(IEditorBridgeService);\n        editorBridgeService.setEditCell(params);\n        return true;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IOperation, Workbook } from '@univerjs/core';\nimport type { IEditorBridgeServiceVisibleParam } from '../../services/editor-bridge.service';\n\nimport { CommandType, ICommandService, IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport { IEditorBridgeService } from '../../services/editor-bridge.service';\n\nexport const SetCellEditVisibleOperation: IOperation<IEditorBridgeServiceVisibleParam> = {\n    id: 'sheet.operation.set-cell-edit-visible',\n    type: CommandType.OPERATION,\n    handler: (accessor, params) => {\n        if (!params) {\n            return false;\n        }\n        const { unitId } = params;\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        if (!workbook) {\n            return false;\n        }\n        const editorBridgeService = accessor.get(IEditorBridgeService);\n        editorBridgeService.changeVisible({\n            ...params,\n            unitId: unitId ?? workbook.getUnitId(),\n        });\n\n        return true;\n    },\n};\n\nexport const SetCellEditVisibleWithF2Operation: IOperation<IEditorBridgeServiceVisibleParam> = {\n    id: 'sheet.operation.set-cell-edit-visible-f2',\n    type: CommandType.OPERATION,\n    handler: (accessor, params) => {\n        const commandService = accessor.get(ICommandService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        if (!workbook) {\n            return false;\n        }\n        commandService.syncExecuteCommand(SetCellEditVisibleOperation.id, {\n            ...params,\n            unitId: workbook.getUnitId(),\n        });\n\n        return true;\n    },\n};\n\n// FIXME: should not use operation as an event\n\n/**\n * When the editor is not clicked to change the cursor,\n * the arrow keys will exit editing and move the cell.\n *\n * @deprecated Should not use operation as an event.\n */\nexport const SetCellEditVisibleArrowOperation: IOperation<IEditorBridgeServiceVisibleParam> = {\n    id: 'sheet.operation.set-cell-edit-visible-arrow',\n    type: CommandType.OPERATION,\n    handler: () => true,\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand } from '@univerjs/core';\nimport { CommandType } from '@univerjs/core';\n\nimport { ISheetBarService } from '../../services/sheet-bar/sheet-bar.service';\n\ninterface IRenameSheetOperationParams {\n    subUnitId: string;\n}\n\nexport const RenameSheetOperation: ICommand = {\n    id: 'sheet.operation.rename-sheet',\n    type: CommandType.OPERATION,\n    handler: async (accessor: IAccessor, params?: IRenameSheetOperationParams) => {\n        const sheetBarService = accessor.get(ISheetBarService);\n        if (params) {\n            sheetBarService.setRenameId(params.subUnitId);\n        }\n        return true;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IScrollToCellCommandParams } from '../commands/set-scroll.command';\nimport { CommandType, type ICommand, IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport { SheetsScrollRenderController } from '../../controllers/render-controllers/scroll.render-controller';\n\nexport const ScrollToRangeOperation: ICommand<IScrollToCellCommandParams> = {\n    id: 'sheet.operation.scroll-to-range',\n    type: CommandType.OPERATION,\n    handler: (accessor, params) => {\n        if (!params) {\n            return false;\n        }\n        const instanceService = accessor.get(IUniverInstanceService);\n        const renderManagerService = accessor.get(IRenderManagerService);\n        const scrollController = renderManagerService\n            .getRenderById(instanceService.getCurrentUnitForType(UniverInstanceType.UNIVER_SHEET)!.getUnitId())!\n            .with(SheetsScrollRenderController);\n\n        return scrollController.scrollToRange(params.range, params.forceTop, params.forceLeft);\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommand } from '@univerjs/core';\nimport { CommandType } from '@univerjs/core';\nimport { IDialogService } from '@univerjs/ui';\nimport { UNIVER_SHEET_PERMISSION_DIALOG, UNIVER_SHEET_PERMISSION_DIALOG_ID } from '../../consts/permission';\n\nexport const SheetPermissionOpenDialogOperation: ICommand = {\n    type: CommandType.OPERATION,\n    id: 'sheet-permission.operation.openDialog',\n    async handler(accessor, _params) {\n        const dialogService = accessor.get(IDialogService);\n\n        dialogService.close('DESKTOP_FIND_REPLACE_DIALOG');\n\n        dialogService.open({\n            id: UNIVER_SHEET_PERMISSION_DIALOG_ID,\n            title: { title: 'permission.dialog.allowedPermissionType' },\n            children: { label: UNIVER_SHEET_PERMISSION_DIALOG },\n            width: 393,\n            destroyOnClose: true,\n            onClose: () => dialogService.close(UNIVER_SHEET_PERMISSION_DIALOG_ID),\n        });\n        return true;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const DEFINED_NAME_CONTAINER = 'DefinedNameContainer';\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand } from '@univerjs/core';\nimport { CommandType, IUniverInstanceService, LocaleService } from '@univerjs/core';\nimport { IEditorService } from '@univerjs/docs-ui';\nimport { getSheetCommandTarget } from '@univerjs/sheets';\nimport { ISidebarService } from '@univerjs/ui';\nimport { DEFINED_NAME_CONTAINER } from '../../views/defined-name/component-name';\n\nexport interface IUIComponentCommandParams {\n    value: string;\n}\n\nexport const SidebarDefinedNameOperation: ICommand = {\n    id: 'sidebar.operation.defined-name',\n    type: CommandType.COMMAND,\n    handler: async (accessor: IAccessor, params: IUIComponentCommandParams) => {\n        const sidebarService = accessor.get(ISidebarService);\n        const editorService = accessor.get(IEditorService);\n        const localeService = accessor.get(LocaleService);\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n\n        const target = getSheetCommandTarget(univerInstanceService);\n        if (!target) return false;\n\n        const { unitId } = target;\n        switch (params.value) {\n            case 'open':\n                sidebarService.open({\n                    id: DEFINED_NAME_CONTAINER,\n                    header: { title: localeService.t('definedName.featureTitle') },\n                    children: { label: DEFINED_NAME_CONTAINER },\n                    onClose: () => {\n                    },\n                    width: 333,\n                });\n                break;\n\n            case 'close':\n            default:\n                sidebarService.close();\n                break;\n        }\n        return true;\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nexport const BorderDashDot = () => (\n    <svg width=\"120\" height=\"2\" viewBox=\"0 0 120 2\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M0.98999 1.08218H-0.0100098V0.0821838H0.98999V1.08218Z\" fill=\"black\" />\n        <path d=\"M5.78992 1.08218H2.78992V0.0821838H5.78992V1.08218Z\" fill=\"black\" />\n        <path d=\"M7.58984 1.08218H8.58984V0.0821838H7.58984V1.08218Z\" fill=\"black\" />\n        <path d=\"M14.9152 1.08218H13.9152V0.0821838H14.9152V1.08218Z\" fill=\"black\" />\n        <path d=\"M16.7151 1.08218H19.7151V0.0821838H16.7151V1.08218Z\" fill=\"black\" />\n        <path d=\"M22.515 1.08218H21.515V0.0821838H22.515V1.08218Z\" fill=\"black\" />\n        <path d=\"M27.8405 1.08218H28.8405V0.0821838H27.8405V1.08218Z\" fill=\"black\" />\n        <path d=\"M33.6404 1.08218H30.6404V0.0821838H33.6404V1.08218Z\" fill=\"black\" />\n        <path d=\"M35.4403 1.08218H36.4403V0.0821838H35.4403V1.08218Z\" fill=\"black\" />\n        <path d=\"M42.7657 1.08218H41.7657V0.0821838H42.7657V1.08218Z\" fill=\"black\" />\n        <path d=\"M44.5657 1.08218H47.5657V0.0821838H44.5657V1.08218Z\" fill=\"black\" />\n        <path d=\"M50.3656 1.08218H49.3656V0.0821838H50.3656V1.08218Z\" fill=\"black\" />\n        <path d=\"M55.691 1.08218H56.691V0.0821838H55.691V1.08218Z\" fill=\"black\" />\n        <path d=\"M61.491 1.08218H58.491V0.0821838H61.491V1.08218Z\" fill=\"black\" />\n        <path d=\"M63.2909 1.08218H64.2909V0.0821838H63.2909V1.08218Z\" fill=\"black\" />\n        <path d=\"M70.6163 1.08218H69.6163V0.0821838H70.6163V1.08218Z\" fill=\"black\" />\n        <path d=\"M72.4163 1.08218H75.4163V0.0821838H72.4163V1.08218Z\" fill=\"black\" />\n        <path d=\"M78.2162 1.08218H77.2162V0.0821838H78.2162V1.08218Z\" fill=\"black\" />\n        <path d=\"M83.5416 1.08218H84.5416V0.0821838H83.5416V1.08218Z\" fill=\"black\" />\n        <path d=\"M89.3416 1.08218H86.3416V0.0821838H89.3416V1.08218Z\" fill=\"black\" />\n        <path d=\"M91.1415 1.08218H92.1415V0.0821838H91.1415V1.08218Z\" fill=\"black\" />\n        <path d=\"M98.4669 1.08218H97.4669V0.0821838H98.4669V1.08218Z\" fill=\"black\" />\n        <path d=\"M100.267 1.08218H103.267V0.0821838H100.267V1.08218Z\" fill=\"black\" />\n        <path d=\"M106.067 1.08218H105.067V0.0821838H106.067V1.08218Z\" fill=\"black\" />\n        <path d=\"M111.392 1.08218H112.392V0.0821838H111.392V1.08218Z\" fill=\"black\" />\n        <path d=\"M117.192 1.08218H114.192V0.0821838H117.192V1.08218Z\" fill=\"black\" />\n        <path d=\"M118.992 1.08218H119.992V0.0821838H118.992V1.08218Z\" fill=\"black\" />\n    </svg>\n);\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nexport const BorderDashDotDot = () => (\n    <svg width=\"120\" height=\"2\" viewBox=\"0 0 120 2\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M-0.0100098 1.15771H0.98999V0.157715H-0.0100098V1.15771Z\" fill=\"black\" />\n        <path d=\"M2.78992 1.15771H5.78992V0.157715H2.78992V1.15771Z\" fill=\"black\" />\n        <path d=\"M8.58984 1.15771H7.58984V0.157715H8.58984V1.15771Z\" fill=\"black\" />\n        <path d=\"M10.3899 1.15771H11.3899V0.157715H10.3899V1.15771Z\" fill=\"black\" />\n        <path d=\"M19.0903 1.15771H18.0903V0.157715H19.0903V1.15771Z\" fill=\"black\" />\n        <path d=\"M20.8903 1.15771H23.8903V0.157715H20.8903V1.15771Z\" fill=\"black\" />\n        <path d=\"M26.6902 1.15771H25.6902V0.157715H26.6902V1.15771Z\" fill=\"black\" />\n        <path d=\"M28.4902 1.15771H29.4902V0.157715H28.4902V1.15771Z\" fill=\"black\" />\n        <path d=\"M37.1907 1.15771H36.1907V0.157715H37.1907V1.15771Z\" fill=\"black\" />\n        <path d=\"M38.9906 1.15771H41.9906V0.157715H38.9906V1.15771Z\" fill=\"black\" />\n        <path d=\"M44.7905 1.15771H43.7905V0.157715H44.7905V1.15771Z\" fill=\"black\" />\n        <path d=\"M46.5906 1.15771H47.5906V0.157715H46.5906V1.15771Z\" fill=\"black\" />\n        <path d=\"M55.291 1.15771H54.291V0.157715H55.291V1.15771Z\" fill=\"black\" />\n        <path d=\"M57.0909 1.15771H60.0909V0.157715H57.0909V1.15771Z\" fill=\"black\" />\n        <path d=\"M62.8909 1.15771H61.8909V0.157715H62.8909V1.15771Z\" fill=\"black\" />\n        <path d=\"M64.6909 1.15771H65.6909V0.157715H64.6909V1.15771Z\" fill=\"black\" />\n        <path d=\"M73.3914 1.15771H72.3914V0.157715H73.3914V1.15771Z\" fill=\"black\" />\n        <path d=\"M75.1913 1.15771H78.1913V0.157715H75.1913V1.15771Z\" fill=\"black\" />\n        <path d=\"M80.9912 1.15771H79.9912V0.157715H80.9912V1.15771Z\" fill=\"black\" />\n        <path d=\"M82.7913 1.15771H83.7913V0.157715H82.7913V1.15771Z\" fill=\"black\" />\n        <path d=\"M91.4917 1.15771H90.4917V0.157715H91.4917V1.15771Z\" fill=\"black\" />\n        <path d=\"M93.2916 1.15771H96.2916V0.157715H93.2916V1.15771Z\" fill=\"black\" />\n        <path d=\"M99.0916 1.15771H98.0916V0.157715H99.0916V1.15771Z\" fill=\"black\" />\n        <path d=\"M100.892 1.15771H101.892V0.157715H100.892V1.15771Z\" fill=\"black\" />\n        <path d=\"M109.592 1.15771H108.592V0.157715H109.592V1.15771Z\" fill=\"black\" />\n        <path d=\"M111.392 1.15771H114.392V0.157715H111.392V1.15771Z\" fill=\"black\" />\n        <path d=\"M117.192 1.15771H116.192V0.157715H117.192V1.15771Z\" fill=\"black\" />\n        <path d=\"M118.992 1.15771H119.992V0.157715H118.992V1.15771Z\" fill=\"black\" />\n    </svg>\n);\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nexport const BorderDashed = () => (\n    <svg width=\"120\" height=\"2\" viewBox=\"0 0 120 2\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M-0.00842285 1.22449H2.99158V0.224487H-0.00842285V1.22449Z\" fill=\"black\" />\n        <path d=\"M6.14941 1.22449H9.14941V0.224487H6.14941V1.22449Z\" fill=\"black\" />\n        <path d=\"M15.3073 1.22449H12.3073V0.224487H15.3073V1.22449Z\" fill=\"black\" />\n        <path d=\"M18.4651 1.22449H21.4651V0.224487H18.4651V1.22449Z\" fill=\"black\" />\n        <path d=\"M27.6229 1.22449H24.6229V0.224487H27.6229V1.22449Z\" fill=\"black\" />\n        <path d=\"M30.7808 1.22449H33.7808V0.224487H30.7808V1.22449Z\" fill=\"black\" />\n        <path d=\"M39.9386 1.22449H36.9386V0.224487H39.9386V1.22449Z\" fill=\"black\" />\n        <path d=\"M43.0964 1.22449H46.0964V0.224487H43.0964V1.22449Z\" fill=\"black\" />\n        <path d=\"M52.2543 1.22449H49.2543V0.224487H52.2543V1.22449Z\" fill=\"black\" />\n        <path d=\"M55.4121 1.22449H58.4121V0.224487H55.4121V1.22449Z\" fill=\"black\" />\n        <path d=\"M64.5699 1.22449H61.5699V0.224487H64.5699V1.22449Z\" fill=\"black\" />\n        <path d=\"M67.7278 1.22449H70.7278V0.224487H67.7278V1.22449Z\" fill=\"black\" />\n        <path d=\"M76.8856 1.22449H73.8856V0.224487H76.8856V1.22449Z\" fill=\"black\" />\n        <path d=\"M80.0435 1.22449H83.0435V0.224487H80.0435V1.22449Z\" fill=\"black\" />\n        <path d=\"M89.2013 1.22449H86.2013V0.224487H89.2013V1.22449Z\" fill=\"black\" />\n        <path d=\"M92.3591 1.22449H95.3591V0.224487H92.3591V1.22449Z\" fill=\"black\" />\n        <path d=\"M101.517 1.22449H98.517V0.224487H101.517V1.22449Z\" fill=\"black\" />\n        <path d=\"M104.675 1.22449H107.675V0.224487H104.675V1.22449Z\" fill=\"black\" />\n        <path d=\"M113.833 1.22449H110.833V0.224487H113.833V1.22449Z\" fill=\"black\" />\n        <path d=\"M116.99 1.22449H119.99V0.224487H116.99V1.22449Z\" fill=\"black\" />\n    </svg>\n);\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nexport const BorderHair = () => (\n    <svg width=\"120\" height=\"2\" viewBox=\"0 0 120 2\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M-0.00976562 1.65707H0.990234V0.657074H-0.00976562V1.65707Z\" fill=\"black\" />\n        <path d=\"M2.32361 1.65707H3.32361V0.657074H2.32361V1.65707Z\" fill=\"black\" />\n        <path d=\"M5.65698 1.65707H4.65698V0.657074H5.65698V1.65707Z\" fill=\"black\" />\n        <path d=\"M6.99036 1.65707H7.99036V0.657074H6.99036V1.65707Z\" fill=\"black\" />\n        <path d=\"M10.3237 1.65707H9.32373V0.657074H10.3237V1.65707Z\" fill=\"black\" />\n        <path d=\"M11.6571 1.65707H12.6571V0.657074H11.6571V1.65707Z\" fill=\"black\" />\n        <path d=\"M14.9905 1.65707H13.9905V0.657074H14.9905V1.65707Z\" fill=\"black\" />\n        <path d=\"M16.3239 1.65707H17.3239V0.657074H16.3239V1.65707Z\" fill=\"black\" />\n        <path d=\"M19.6572 1.65707H18.6572V0.657074H19.6572V1.65707Z\" fill=\"black\" />\n        <path d=\"M20.9906 1.65707H21.9906V0.657074H20.9906V1.65707Z\" fill=\"black\" />\n        <path d=\"M24.324 1.65707H23.324V0.657074H24.324V1.65707Z\" fill=\"black\" />\n        <path d=\"M25.6573 1.65707H26.6573V0.657074H25.6573V1.65707Z\" fill=\"black\" />\n        <path d=\"M28.9907 1.65707H27.9907V0.657074H28.9907V1.65707Z\" fill=\"black\" />\n        <path d=\"M30.3241 1.65707H31.3241V0.657074H30.3241V1.65707Z\" fill=\"black\" />\n        <path d=\"M33.6575 1.65707H32.6575V0.657074H33.6575V1.65707Z\" fill=\"black\" />\n        <path d=\"M34.9908 1.65707H35.9908V0.657074H34.9908V1.65707Z\" fill=\"black\" />\n        <path d=\"M38.3242 1.65707H37.3242V0.657074H38.3242V1.65707Z\" fill=\"black\" />\n        <path d=\"M39.6576 1.65707H40.6576V0.657074H39.6576V1.65707Z\" fill=\"black\" />\n        <path d=\"M42.991 1.65707H41.991V0.657074H42.991V1.65707Z\" fill=\"black\" />\n        <path d=\"M44.3243 1.65707H45.3243V0.657074H44.3243V1.65707Z\" fill=\"black\" />\n        <path d=\"M47.6577 1.65707H46.6577V0.657074H47.6577V1.65707Z\" fill=\"black\" />\n        <path d=\"M48.9911 1.65707H49.9911V0.657074H48.9911V1.65707Z\" fill=\"black\" />\n        <path d=\"M52.3245 1.65707H51.3245V0.657074H52.3245V1.65707Z\" fill=\"black\" />\n        <path d=\"M53.6578 1.65707H54.6578V0.657074H53.6578V1.65707Z\" fill=\"black\" />\n        <path d=\"M56.9912 1.65707H55.9912V0.657074H56.9912V1.65707Z\" fill=\"black\" />\n        <path d=\"M58.3246 1.65707H59.3246V0.657074H58.3246V1.65707Z\" fill=\"black\" />\n        <path d=\"M61.658 1.65707H60.658V0.657074H61.658V1.65707Z\" fill=\"black\" />\n        <path d=\"M62.9913 1.65707H63.9913V0.657074H62.9913V1.65707Z\" fill=\"black\" />\n        <path d=\"M66.3247 1.65707H65.3247V0.657074H66.3247V1.65707Z\" fill=\"black\" />\n        <path d=\"M67.6581 1.65707H68.6581V0.657074H67.6581V1.65707Z\" fill=\"black\" />\n        <path d=\"M70.9915 1.65707H69.9915V0.657074H70.9915V1.65707Z\" fill=\"black\" />\n        <path d=\"M72.3248 1.65707H73.3248V0.657074H72.3248V1.65707Z\" fill=\"black\" />\n        <path d=\"M75.6582 1.65707H74.6582V0.657074H75.6582V1.65707Z\" fill=\"black\" />\n        <path d=\"M76.9916 1.65707H77.9916V0.657074H76.9916V1.65707Z\" fill=\"black\" />\n        <path d=\"M80.325 1.65707H79.325V0.657074H80.325V1.65707Z\" fill=\"black\" />\n        <path d=\"M81.6583 1.65707H82.6583V0.657074H81.6583V1.65707Z\" fill=\"black\" />\n        <path d=\"M84.9917 1.65707H83.9917V0.657074H84.9917V1.65707Z\" fill=\"black\" />\n        <path d=\"M86.3251 1.65707H87.3251V0.657074H86.3251V1.65707Z\" fill=\"black\" />\n        <path d=\"M89.6584 1.65707H88.6584V0.657074H89.6584V1.65707Z\" fill=\"black\" />\n        <path d=\"M90.9918 1.65707H91.9918V0.657074H90.9918V1.65707Z\" fill=\"black\" />\n        <path d=\"M94.3252 1.65707H93.3252V0.657074H94.3252V1.65707Z\" fill=\"black\" />\n        <path d=\"M95.6586 1.65707H96.6586V0.657074H95.6586V1.65707Z\" fill=\"black\" />\n        <path d=\"M98.9919 1.65707H97.9919V0.657074H98.9919V1.65707Z\" fill=\"black\" />\n        <path d=\"M100.325 1.65707H101.325V0.657074H100.325V1.65707Z\" fill=\"black\" />\n        <path d=\"M103.659 1.65707H102.659V0.657074H103.659V1.65707Z\" fill=\"black\" />\n        <path d=\"M104.992 1.65707H105.992V0.657074H104.992V1.65707Z\" fill=\"black\" />\n        <path d=\"M108.325 1.65707H107.325V0.657074H108.325V1.65707Z\" fill=\"black\" />\n        <path d=\"M109.659 1.65707H110.659V0.657074H109.659V1.65707Z\" fill=\"black\" />\n        <path d=\"M112.992 1.65707H111.992V0.657074H112.992V1.65707Z\" fill=\"black\" />\n        <path d=\"M114.325 1.65707H115.325V0.657074H114.325V1.65707Z\" fill=\"black\" />\n        <path d=\"M117.659 1.65707H116.659V0.657074H117.659V1.65707Z\" fill=\"black\" />\n        <path d=\"M118.992 1.65707H119.992V0.657074H118.992V1.65707Z\" fill=\"black\" />\n    </svg>\n);\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nexport const BorderMedium = () => (\n    <svg width=\"120\" height=\"3\" viewBox=\"0 0 120 3\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path\n            fillRule=\"evenodd\"\n            clipRule=\"evenodd\"\n            d=\"M119.991 2.42035H-0.0090332V0.420349H119.991V2.42035Z\"\n            fill=\"black\"\n        />\n    </svg>\n);\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nexport const BorderMediumDashDot = () => (\n    <svg width=\"120\" height=\"3\" viewBox=\"0 0 120 3\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M-0.0100098 2.47614H1.98999V0.476135H-0.0100098V2.47614Z\" fill=\"black\" />\n        <path d=\"M3.99014 2.47614H9.99014V0.476135H3.99014V2.47614Z\" fill=\"black\" />\n        <path d=\"M13.9901 2.47614H11.9901V0.476135H13.9901V2.47614Z\" fill=\"black\" />\n        <path d=\"M21.1904 2.47614H23.1904V0.476135H21.1904V2.47614Z\" fill=\"black\" />\n        <path d=\"M31.1906 2.47614H25.1906V0.476135H31.1906V2.47614Z\" fill=\"black\" />\n        <path d=\"M33.1906 2.47614H35.1906V0.476135H33.1906V2.47614Z\" fill=\"black\" />\n        <path d=\"M44.3909 2.47614H42.3909V0.476135H44.3909V2.47614Z\" fill=\"black\" />\n        <path d=\"M46.391 2.47614H52.391V0.476135H46.391V2.47614Z\" fill=\"black\" />\n        <path d=\"M56.391 2.47614H54.391V0.476135H56.391V2.47614Z\" fill=\"black\" />\n        <path d=\"M63.5913 2.47614H65.5913V0.476135H63.5913V2.47614Z\" fill=\"black\" />\n        <path d=\"M73.5915 2.47614H67.5915V0.476135H73.5915V2.47614Z\" fill=\"black\" />\n        <path d=\"M75.5915 2.47614H77.5915V0.476135H75.5915V2.47614Z\" fill=\"black\" />\n        <path d=\"M86.7917 2.47614H84.7917V0.476135H86.7917V2.47614Z\" fill=\"black\" />\n        <path d=\"M88.7919 2.47614H94.7919V0.476135H88.7919V2.47614Z\" fill=\"black\" />\n        <path d=\"M98.7919 2.47614H96.7919V0.476135H98.7919V2.47614Z\" fill=\"black\" />\n        <path d=\"M105.992 2.47614H107.992V0.476135H105.992V2.47614Z\" fill=\"black\" />\n        <path d=\"M115.992 2.47614H109.992V0.476135H115.992V2.47614Z\" fill=\"black\" />\n        <path d=\"M117.992 2.47614H119.992V0.476135H117.992V2.47614Z\" fill=\"black\" />\n    </svg>\n);\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nexport const BorderMediumDashDotDot = () => (\n    <svg width=\"120\" height=\"2\" viewBox=\"0 0 120 2\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M-0.0100098 2.00415H1.98999V0.00415039H-0.0100098V2.00415Z\" fill=\"black\" />\n        <path d=\"M3.99014 2.00415H9.99014V0.00415039H3.99014V2.00415Z\" fill=\"black\" />\n        <path d=\"M13.9901 2.00415H11.9901V0.00415039H13.9901V2.00415Z\" fill=\"black\" />\n        <path d=\"M15.9901 2.00415H17.9901V0.00415039H15.9901V2.00415Z\" fill=\"black\" />\n        <path d=\"M27.4905 2.00415H25.4905V0.00415039H27.4905V2.00415Z\" fill=\"black\" />\n        <path d=\"M29.4906 2.00415H35.4906V0.00415039H29.4906V2.00415Z\" fill=\"black\" />\n        <path d=\"M39.4906 2.00415H37.4906V0.00415039H39.4906V2.00415Z\" fill=\"black\" />\n        <path d=\"M41.4906 2.00415H43.4906V0.00415039H41.4906V2.00415Z\" fill=\"black\" />\n        <path d=\"M52.991 2.00415H50.991V0.00415039H52.991V2.00415Z\" fill=\"black\" />\n        <path d=\"M54.9911 2.00415H60.9911V0.00415039H54.9911V2.00415Z\" fill=\"black\" />\n        <path d=\"M64.9911 2.00415H62.9911V0.00415039H64.9911V2.00415Z\" fill=\"black\" />\n        <path d=\"M66.9911 2.00415H68.9911V0.00415039H66.9911V2.00415Z\" fill=\"black\" />\n        <path d=\"M78.4915 2.00415H76.4915V0.00415039H78.4915V2.00415Z\" fill=\"black\" />\n        <path d=\"M80.4916 2.00415H86.4916V0.00415039H80.4916V2.00415Z\" fill=\"black\" />\n        <path d=\"M90.4916 2.00415H88.4916V0.00415039H90.4916V2.00415Z\" fill=\"black\" />\n        <path d=\"M92.4916 2.00415H94.4916V0.00415039H92.4916V2.00415Z\" fill=\"black\" />\n        <path d=\"M103.992 2.00415H101.992V0.00415039H103.992V2.00415Z\" fill=\"black\" />\n        <path d=\"M105.992 2.00415H111.992V0.00415039H105.992V2.00415Z\" fill=\"black\" />\n        <path d=\"M115.992 2.00415H113.992V0.00415039H115.992V2.00415Z\" fill=\"black\" />\n        <path d=\"M117.992 2.00415H119.992V0.00415039H117.992V2.00415Z\" fill=\"black\" />\n    </svg>\n);\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nexport const BorderMediumDashed = () => (\n    <svg width=\"118\" height=\"3\" viewBox=\"0 0 118 3\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M-0.00854492 2.94815H1.99146V0.948151H-0.00854492V2.94815Z\" fill=\"black\" />\n        <path d=\"M6.09668 2.94815H8.09668V0.948151H6.09668V2.94815Z\" fill=\"black\" />\n        <path d=\"M14.2019 2.94815H12.2019V0.948151H14.2019V2.94815Z\" fill=\"black\" />\n        <path d=\"M18.3071 2.94815H20.3071V0.948151H18.3071V2.94815Z\" fill=\"black\" />\n        <path d=\"M26.4124 2.94815H24.4124V0.948151H26.4124V2.94815Z\" fill=\"black\" />\n        <path d=\"M30.5176 2.94815H32.5176V0.948151H30.5176V2.94815Z\" fill=\"black\" />\n        <path d=\"M38.6228 2.94815H36.6228V0.948151H38.6228V2.94815Z\" fill=\"black\" />\n        <path d=\"M42.728 2.94815H44.728V0.948151H42.728V2.94815Z\" fill=\"black\" />\n        <path d=\"M50.8333 2.94815H48.8333V0.948151H50.8333V2.94815Z\" fill=\"black\" />\n        <path d=\"M54.9385 2.94815H56.9385V0.948151H54.9385V2.94815Z\" fill=\"black\" />\n        <path d=\"M63.0437 2.94815H61.0437V0.948151H63.0437V2.94815Z\" fill=\"black\" />\n        <path d=\"M67.1489 2.94815H69.1489V0.948151H67.1489V2.94815Z\" fill=\"black\" />\n        <path d=\"M75.2542 2.94815H73.2542V0.948151H75.2542V2.94815Z\" fill=\"black\" />\n        <path d=\"M79.3594 2.94815H81.3594V0.948151H79.3594V2.94815Z\" fill=\"black\" />\n        <path d=\"M87.4645 2.94815H85.4645V0.948151H87.4645V2.94815Z\" fill=\"black\" />\n        <path d=\"M91.5697 2.94815H93.5697V0.948151H91.5697V2.94815Z\" fill=\"black\" />\n        <path d=\"M99.6749 2.94815H97.6749V0.948151H99.6749V2.94815Z\" fill=\"black\" />\n        <path d=\"M103.78 2.94815H105.78V0.948151H103.78V2.94815Z\" fill=\"black\" />\n        <path d=\"M111.885 2.94815H109.885V0.948151H111.885V2.94815Z\" fill=\"black\" />\n        <path d=\"M115.991 2.94815H117.991V0.948151H115.991V2.94815Z\" fill=\"black\" />\n    </svg>\n);\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nexport const BorderThick = () => (\n    <svg width=\"120\" height=\"4\" viewBox=\"0 0 120 4\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path\n            fillRule=\"evenodd\"\n            clipRule=\"evenodd\"\n            d=\"M119.991 3.86215H-0.0090332V0.862152H119.991V3.86215Z\"\n            fill=\"black\"\n        />\n    </svg>\n);\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nexport const BorderThin = () => (\n    <svg width=\"120\" height=\"2\" viewBox=\"0 0 120 2\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path\n            fillRule=\"evenodd\"\n            clipRule=\"evenodd\"\n            d=\"M119.991 1.15668H-0.0090332V0.156677H119.991V1.15668Z\"\n            fill=\"black\"\n        />\n    </svg>\n);\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BorderStyleTypes } from '@univerjs/core';\nimport React from 'react';\n\nimport { BorderDashDot } from './icons/BorderDashDot';\nimport { BorderDashDotDot } from './icons/BorderDashDotDot';\nimport { BorderDashed } from './icons/BorderDashed';\nimport { BorderHair } from './icons/BorderHair';\nimport { BorderMedium } from './icons/BorderMedium';\nimport { BorderMediumDashDot } from './icons/BorderMediumDashDot';\nimport { BorderMediumDashDotDot } from './icons/BorderMediumDashDotDot';\nimport { BorderMediumDashed } from './icons/BorderMediumDashed';\nimport { BorderThick } from './icons/BorderThick';\nimport { BorderThin } from './icons/BorderThin';\n\ninterface IBorderLineProps {\n    type: BorderStyleTypes;\n}\n\nexport function BorderLine(props: IBorderLineProps) {\n    const { type = BorderStyleTypes.THIN } = props;\n\n    switch (type) {\n        case BorderStyleTypes.DASH_DOT:\n            return <BorderDashDot />;\n        case BorderStyleTypes.DASH_DOT_DOT:\n            return <BorderDashDotDot />;\n        case BorderStyleTypes.DASHED:\n            return <BorderDashed />;\n        case BorderStyleTypes.HAIR:\n            return <BorderHair />;\n        case BorderStyleTypes.MEDIUM:\n            return <BorderMedium />;\n        case BorderStyleTypes.MEDIUM_DASH_DOT:\n            return <BorderMediumDashDot />;\n        case BorderStyleTypes.MEDIUM_DASH_DOT_DOT:\n            return <BorderMediumDashDotDot />;\n        case BorderStyleTypes.MEDIUM_DASHED:\n            return <BorderMediumDashed />;\n        case BorderStyleTypes.THICK:\n            return <BorderThick />;\n        case BorderStyleTypes.THIN:\n            return <BorderThin />;\n        default:\n            return <BorderThin />;\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const COMPONENT_PREFIX = 'UI_PLUGIN_SHEETS';\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IBorderInfo } from '@univerjs/sheets';\nimport type { ICustomComponentProps } from '@univerjs/ui';\nimport { COMPONENT_PREFIX } from '../const';\n\nexport const BORDER_PANEL_COMPONENT = `${COMPONENT_PREFIX}_BORDER_PANEL_COMPONENT`;\n\nexport interface IBorderPanelProps extends ICustomComponentProps<IBorderInfo> {}\n\nexport const BORDER_LINE_CHILDREN = [\n    {\n        label: 'borderLine.borderTop',\n        icon: 'UpBorder',\n        value: 'top',\n    },\n    {\n        label: 'borderLine.borderBottom',\n        icon: 'DownBorder',\n        value: 'bottom',\n    },\n    {\n        label: 'borderLine.borderLeft',\n        icon: 'LeftBorder',\n        value: 'left',\n    },\n    {\n        label: 'borderLine.borderRight',\n        icon: 'RightBorder',\n        value: 'right',\n    },\n    {\n        label: 'borderLine.borderNone',\n        icon: 'NoBorderSingle',\n        value: 'none',\n    },\n    {\n        label: 'borderLine.borderAll',\n        icon: 'AllBorderSingle',\n        value: 'all',\n    },\n    {\n        label: 'borderLine.borderOutside',\n        icon: 'OuterBorder',\n        value: 'outside',\n    },\n    {\n        label: 'borderLine.borderInside',\n        icon: 'InnerBorder',\n        value: 'inside',\n    },\n    {\n        label: 'borderLine.borderHorizontal',\n        icon: 'HorizontalBorder',\n        value: 'horizontal',\n    },\n    {\n        label: 'borderLine.borderVertical',\n        icon: 'VerticalBorder',\n        value: 'vertical',\n    },\n\n    {\n        label: 'borderLine.borderTlbr',\n        icon: 'BackSlashSingle',\n        value: 'tlbr',\n    },\n    {\n        label: 'borderLine.borderTlbcTlmr',\n        icon: 'LeftDoubleDiagonalSingle',\n        value: 'tlbc_tlmr',\n    },\n    {\n        label: 'borderLine.borderTlbrTlbcTlmr',\n        icon: 'LeftTridiagonalSingle',\n        value: 'tlbr_tlbc_tlmr',\n    },\n    {\n        label: 'borderLine.borderBlTr',\n        icon: 'SlashSingle',\n        value: 'bltr',\n    },\n    {\n        label: 'borderLine.borderMltrBctr',\n        icon: 'RightDoubleDiagonalSingle',\n        value: 'mltr_bctr',\n    },\n];\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IBorderInfo } from '@univerjs/sheets';\nimport type { IBorderPanelProps } from './interface';\nimport { BorderStyleTypes } from '@univerjs/core';\nimport { clsx, ColorPicker, Dropdown, Separator } from '@univerjs/design';\nimport { MoreDownSingle, PaintBucket } from '@univerjs/icons';\nimport { BorderStyleManagerService } from '@univerjs/sheets';\nimport { ComponentManager, useDependency } from '@univerjs/ui';\nimport { BorderLine } from './border-line/BorderLine';\nimport { BORDER_LINE_CHILDREN } from './interface';\n\nconst BORDER_SIZE_CHILDREN = [\n    {\n        label: BorderStyleTypes.THIN,\n        value: BorderStyleTypes.THIN,\n    },\n    {\n        label: BorderStyleTypes.HAIR,\n        value: BorderStyleTypes.HAIR,\n    },\n    {\n        label: BorderStyleTypes.DOTTED,\n        value: BorderStyleTypes.DOTTED,\n    },\n    {\n        label: BorderStyleTypes.DASHED,\n        value: BorderStyleTypes.DASHED,\n    },\n    {\n        label: BorderStyleTypes.DASH_DOT,\n        value: BorderStyleTypes.DASH_DOT,\n    },\n    {\n        label: BorderStyleTypes.DASH_DOT_DOT,\n        value: BorderStyleTypes.DASH_DOT_DOT,\n    },\n    {\n        label: BorderStyleTypes.MEDIUM,\n        value: BorderStyleTypes.MEDIUM,\n    },\n    {\n        label: BorderStyleTypes.MEDIUM_DASHED,\n        value: BorderStyleTypes.MEDIUM_DASHED,\n    },\n    {\n        label: BorderStyleTypes.MEDIUM_DASH_DOT,\n        value: BorderStyleTypes.MEDIUM_DASH_DOT,\n    },\n    {\n        label: BorderStyleTypes.MEDIUM_DASH_DOT_DOT,\n        value: BorderStyleTypes.MEDIUM_DASH_DOT_DOT,\n    },\n    {\n        label: BorderStyleTypes.THICK,\n        value: BorderStyleTypes.THICK,\n    },\n];\n\nexport function BorderPanel(props: IBorderPanelProps) {\n    const componentManager = useDependency(ComponentManager);\n    const borderStyleManagerService = useDependency(BorderStyleManagerService);\n\n    const { onChange, value } = props;\n\n    function handleClick(v: string | number, type: keyof IBorderInfo) {\n        onChange?.({\n            ...value,\n            [type]: v,\n        });\n    }\n\n    function renderIcon(icon: string) {\n        const Icon = componentManager.get(icon);\n\n        return Icon && <Icon extend={{ colorChannel1: '#2c53f1' }} />;\n    }\n\n    return (\n        <section className=\"univer-box-border univer-grid univer-gap-2 univer-p-1.5\">\n            <div className=\"univer-box-border univer-grid univer-grid-cols-5 univer-gap-2\">\n                {BORDER_LINE_CHILDREN.map((item) => (\n                    <a\n                        key={item.value}\n                        className={clsx(`\n                          univer-flex univer-size-6 univer-cursor-pointer univer-items-center univer-justify-center\n                          univer-justify-self-center univer-rounded\n                          hover:univer-bg-gray-100\n                        `, {\n                            'univer-bg-gray-200': borderStyleManagerService.getBorderInfo().type === item.value,\n                        })}\n                        onClick={(e) => {\n                            e.stopPropagation();\n                            handleClick(item.value, 'type');\n                        }}\n                    >\n                        {renderIcon(item.icon)}\n                    </a>\n                ))}\n            </div>\n\n            <Separator />\n\n            <div className=\"univer-flex univer-items-center univer-gap-2\">\n                <div>\n                    <Dropdown\n                        overlay={(\n                            <div className=\"univer-rounded-lg univer-p-4\">\n                                <ColorPicker onChange={(value) => handleClick(value, 'color')} />\n                            </div>\n                        )}\n                    >\n                        <button\n                            className={`\n                              univer-flex univer-cursor-pointer univer-items-center univer-gap-2 univer-rounded\n                              univer-border-none univer-bg-transparent univer-p-1\n                              hover:univer-bg-gray-100\n                            `}\n                            type=\"button\"\n                        >\n                            <PaintBucket extend={{ colorChannel1: value?.color ?? 'rgb(var(--primary-color))' }} />\n                            <MoreDownSingle className=\"univer-text-gray-400\" />\n                        </button>\n                    </Dropdown>\n                </div>\n\n                <div>\n                    <Dropdown\n                        overlay={(\n                            <section className=\"univer-rounded-lg univer-p-1.5\">\n                                <ul className=\"univer-m-0 univer-grid univer-list-none univer-gap-1 univer-p-0\">\n                                    {BORDER_SIZE_CHILDREN.map((item) => (\n                                        <li\n                                            key={item.value}\n                                            className={`\n                                              univer-flex univer-cursor-pointer univer-items-center\n                                              univer-justify-center univer-rounded univer-px-1 univer-py-2\n                                              hover:univer-bg-gray-100\n                                            `}\n                                            onClick={() => handleClick(item.value, 'style')}\n                                        >\n                                            <BorderLine type={item.value} />\n                                        </li>\n                                    ))}\n                                </ul>\n                            </section>\n                        )}\n                    >\n                        <button\n                            className={`\n                              univer-flex univer-cursor-pointer univer-items-center univer-gap-2 univer-rounded\n                              univer-border-none univer-bg-transparent univer-p-1\n                              hover:univer-bg-gray-100\n                            `}\n                            type=\"button\"\n                        >\n                            <BorderLine type={BorderStyleTypes.THIN} />\n                            <MoreDownSingle className=\"univer-text-gray-400\" />\n                        </button>\n                    </Dropdown>\n                </div>\n            </div>\n        </section>\n    );\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { COMPONENT_PREFIX } from '../const';\n\nexport const COLOR_PICKER_COMPONENT = `${COMPONENT_PREFIX}_COLOR_PICKER_COMPONENT`;\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { COMPONENT_PREFIX } from '../const';\n\nexport const FONT_FAMILY_COMPONENT = `${COMPONENT_PREFIX}_FONT_FAMILY_COMPONENT`;\n\nexport const FONT_FAMILY_ITEM_COMPONENT = `${COMPONENT_PREFIX}_FONT_FAMILY_ITEM_COMPONENT`;\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { COMPONENT_PREFIX } from '../const';\n\nexport const FONT_SIZE_COMPONENT = `${COMPONENT_PREFIX}_FONT_SIZE_COMPONENT`;\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICustomComponentProps } from '@univerjs/ui';\n\nimport { COMPONENT_PREFIX } from '../const';\n\nexport const MENU_ITEM_INPUT_COMPONENT = `${COMPONENT_PREFIX}_MENU_ITEM_INPUT_COMPONENT`;\n\nexport interface IMenuItemInputProps extends ICustomComponentProps<string> {\n    prefix: string;\n    suffix: string;\n    min?: number;\n    max?: number;\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IMenuItemInputProps } from './interface';\nimport { LocaleService } from '@univerjs/core';\nimport { InputNumber } from '@univerjs/design';\nimport { IContextMenuService, useDependency } from '@univerjs/ui';\n\nimport React, { useEffect, useState } from 'react';\nimport styles from './index.module.less';\n\nexport const MenuItemInput = (props: IMenuItemInputProps) => {\n    const { prefix, suffix, value, onChange, min = Number.MIN_SAFE_INTEGER, max = Number.MAX_SAFE_INTEGER } = props;\n\n    const localeService = useDependency(LocaleService);\n    const contextMenuService = useDependency(IContextMenuService);\n    const [inputValue, setInputValue] = useState<string>(); // Initialized to an empty string\n\n    const handleChange = (value: number | null) => {\n        setInputValue(value?.toString());\n        onChange(value?.toString() ?? '');\n    };\n\n    useEffect(() => {\n        if (!contextMenuService.visible) {\n            setInputValue(value);\n        }\n    }, [contextMenuService.visible]);\n\n    useEffect(() => {\n        setInputValue(value);\n    }, [value]);\n\n    function handleKeyDown(e: React.KeyboardEvent<HTMLInputElement>) {\n        if (e.key === 'Backspace') {\n            e.stopPropagation();\n        }\n    }\n\n    return (\n        <div className={styles.sheetsUiContextMenuInput}>\n            {localeService.t(prefix)}\n            <span className={styles.sheetsUiContextMenuInputContainer} onClick={(e) => e.stopPropagation()}>\n                <InputNumber\n                    className={styles.sheetsUiContextMenuInputNumber}\n                    value={Number(inputValue)}\n                    precision={0}\n                    onKeyDown={handleKeyDown}\n                    onChange={handleChange}\n                    min={min}\n                    max={max}\n                />\n            </span>\n            {localeService.t(suffix)}\n        </div>\n    );\n};\n", "export default {\n  \"sheetsUiContextMenuInput\": \"univer-sheets-ui-context-menu-input\",\n  \"sheetsUiContextMenuInputContainer\": \"univer-sheets-ui-context-menu-input-container\",\n  \"sheetsUiContextMenuInputNumber\": \"univer-sheets-ui-context-menu-input-number\"\n};import \"ni:sha-256;TnE1IB_ffEo_CSj6rDERNxTHSYxqdznUtJ1qwtLeeCQ\";", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Nullable, Workbook } from '@univerjs/core';\n\nimport type { IDefinedNamesServiceParam, ISetDefinedNameMutationParam } from '@univerjs/engine-formula';\nimport { ICommandService, IUniverInstanceService, LocaleService, Tools, UniverInstanceType } from '@univerjs/core';\nimport { clsx, Confirm, Tooltip } from '@univerjs/design';\nimport { IDefinedNamesService, serializeRangeWithSheet } from '@univerjs/engine-formula';\nimport { CheckMarkSingle, DeleteSingle, IncreaseSingle } from '@univerjs/icons';\nimport { InsertDefinedNameCommand, RemoveDefinedNameCommand, SCOPE_WORKBOOK_VALUE_DEFINED_NAME, SetDefinedNameCommand, SetWorksheetShowCommand, SheetsSelectionsService } from '@univerjs/sheets';\nimport { useDependency } from '@univerjs/ui';\nimport { useEffect, useState } from 'react';\nimport { DefinedNameInput } from './DefinedNameInput';\nimport styles from './index.module.less';\n\nexport const DefinedNameContainer = () => {\n    const commandService = useDependency(ICommandService);\n    const univerInstanceService = useDependency(IUniverInstanceService);\n    const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n    const localeService = useDependency(LocaleService);\n    const definedNamesService = useDependency(IDefinedNamesService);\n    const selectionManagerService = useDependency(SheetsSelectionsService);\n\n    if (workbook == null) {\n        return;\n    }\n\n    const unitId = workbook.getUnitId();\n\n    const getDefinedNameMap = () => {\n        const definedNameMap = definedNamesService.getDefinedNameMap(unitId);\n        if (definedNameMap) {\n            return Array.from(Object.values(definedNameMap));\n        }\n        return [];\n    };\n\n    const [editState, setEditState] = useState(false);\n    const [definedNames, setDefinedNames] = useState<IDefinedNamesServiceParam[]>(getDefinedNameMap());\n    const [editorKey, setEditorKey] = useState<Nullable<string>>(null);\n    const [deleteConformKey, setDeleteConformKey] = useState<Nullable<string>>();\n\n    useEffect(() => {\n        const definedNamesSubscription = definedNamesService.update$.subscribe(() => {\n            setDefinedNames(getDefinedNameMap());\n        });\n\n        return () => {\n            definedNamesSubscription.unsubscribe();\n        };\n    }, []);\n\n    const insertConfirm = (param: IDefinedNamesServiceParam) => {\n        const { name, formulaOrRefString, comment, localSheetId, hidden } = param;\n\n        let id = param.id;\n        if (id == null || id.length === 0) {\n            id = Tools.generateRandomId(10);\n            commandService.executeCommand(InsertDefinedNameCommand.id, { id, unitId, name, formulaOrRefString, comment, localSheetId, hidden });\n        } else {\n            const newDefinedName: ISetDefinedNameMutationParam = { id, unitId, name, formulaOrRefString, comment, localSheetId, hidden };\n            commandService.executeCommand(SetDefinedNameCommand.id, newDefinedName);\n        }\n        setEditState(false);\n        setEditorKey(null);\n    };\n\n    const deleteDefinedName = (id: string) => {\n        setDeleteConformKey(id);\n    };\n\n    function handleDeleteClose() {\n        setDeleteConformKey(null);\n    }\n\n    function handleDeleteConfirm(id: string) {\n        const item = definedNamesService.getValueById(unitId, id);\n        commandService.executeCommand(RemoveDefinedNameCommand.id, { ...item, unitId });\n        setDeleteConformKey(null);\n    }\n\n    const focusDefinedName = async (definedName: IDefinedNamesServiceParam) => {\n        // The worksheet may be hidden, so we need to show it first\n        const { formulaOrRefString, id } = definedName;\n        const worksheet = definedNamesService.getWorksheetByRef(unitId, formulaOrRefString);\n        if (!worksheet) {\n            return;\n        }\n\n        const isHidden = worksheet.isSheetHidden();\n        if (isHidden) {\n            await commandService.executeCommand(SetWorksheetShowCommand.id, { unitId, subUnitId: worksheet.getSheetId() });\n        }\n\n        definedNamesService.focusRange(unitId, id);\n    };\n\n    const getInsertDefinedName = () => {\n        const count = definedNames.length + 1;\n        const name = localeService.t('definedName.defaultName') + count;\n        if (definedNamesService.getValueByName(unitId, name) == null) {\n            return name;\n        }\n\n        let i = count + 1;\n        while (true) {\n            const newName = localeService.t('definedName.defaultName') + i;\n            if (definedNamesService.getValueByName(unitId, newName) == null) {\n                return newName;\n            }\n            i++;\n        }\n    };\n\n    const getInertFormulaOrRefString = () => {\n        const sheetName = workbook.getActiveSheet()?.getName();\n        if (!sheetName) {\n            return '';\n        }\n\n        const selections = selectionManagerService.getCurrentSelections();\n        if (selections == null) {\n            return '';\n        }\n\n        const formulaOrRefs = selections.map((selection) => {\n            return serializeRangeWithSheet(sheetName, selection.range);\n        });\n\n        return formulaOrRefs.join(',');\n    };\n\n    const closeInput = () => {\n        setEditState(false);\n        setEditorKey(null);\n    };\n\n    const openInsertCloseKeyEditor = () => {\n        setEditState(true);\n        setEditorKey(null);\n    };\n\n    const closeInsertOpenKeyEditor = (id: string) => {\n        setEditState(false);\n        setEditorKey(id);\n    };\n\n    const getSheetNameBySheetId = (sheetId: string) => {\n        const sheet = workbook.getSheetBySheetId(sheetId);\n        if (sheet == null) {\n            return '';\n        }\n\n        return sheet.getName();\n    };\n\n    return (\n        <div className={styles.definedNameContainer}>\n            <div className={styles.definedNameContainerScroll}>\n                <div key=\"insertDefinedName\">\n                    <div onClick={openInsertCloseKeyEditor} className={styles.definedNameContainerAddButton} style={{ display: editState ? 'none' : 'flex' }}>\n                        <IncreaseSingle />\n                        <span className={styles.definedNameContainerAddButtonText}>{localeService.t('definedName.addButton')}</span>\n                    </div>\n                    {editState && <DefinedNameInput confirm={insertConfirm} cancel={closeInput} state={editState} inputId=\"insertDefinedName\" name={getInsertDefinedName()} formulaOrRefString={getInertFormulaOrRefString()} />}\n                </div>\n\n                {definedNames.map((definedName, index) => {\n                    return (\n                        <div key={index}>\n                            <div onClick={() => { focusDefinedName(definedName); }} className={styles.definedNameContainerItem} style={{ display: definedName.id === editorKey ? 'none' : 'flex' }}>\n                                <div title={definedName.comment}>\n                                    <div className={styles.definedNameContainerItemName}>\n                                        {definedName.name}\n                                        <span className={styles.definedNameContainerItemNameForSheet}>\n                                            {(definedName.localSheetId === SCOPE_WORKBOOK_VALUE_DEFINED_NAME || definedName.localSheetId == null) ? '' : getSheetNameBySheetId(definedName.localSheetId)}\n                                        </span>\n                                    </div>\n                                    <div className={styles.definedNameContainerItemFormulaOrRefString}>{definedName.formulaOrRefString}</div>\n                                </div>\n                                <Tooltip title={localeService.t('definedName.updateButton')} placement=\"top\">\n                                    <div className={clsx(styles.definedNameContainerItemUpdate, styles.definedNameContainerItemShow)} onClick={() => { closeInsertOpenKeyEditor(definedName.id); }}>\n                                        <CheckMarkSingle />\n                                    </div>\n                                </Tooltip>\n                                <Tooltip title={localeService.t('definedName.deleteButton')} placement=\"top\">\n                                    <div className={clsx(styles.definedNameContainerItemDelete, styles.definedNameContainerItemShow)} onClick={() => { deleteDefinedName(definedName.id); }}>\n                                        <DeleteSingle />\n                                    </div>\n                                </Tooltip>\n                            </div>\n\n                            <Confirm\n                                visible={deleteConformKey === definedName.id}\n                                onClose={handleDeleteClose}\n                                onConfirm={() => { handleDeleteConfirm(definedName.id); }}\n                            >\n                                {localeService.t('definedName.deleteConfirmText')}\n                            </Confirm>\n\n                            {definedName.id === editorKey && (\n                                <DefinedNameInput\n                                    confirm={insertConfirm}\n                                    cancel={closeInput}\n                                    state={definedName.id === editorKey}\n                                    id={definedName.id}\n                                    inputId={definedName.id + index}\n                                    name={definedName.name}\n                                    formulaOrRefString={definedName.formulaOrRefString}\n                                    comment={definedName.comment}\n                                    localSheetId={definedName.localSheetId}\n                                />\n                            )}\n\n                        </div>\n                    );\n                })}\n            </div>\n        </div>\n    );\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Nullable, Workbook } from '@univerjs/core';\nimport type { IDefinedNamesServiceParam } from '@univerjs/engine-formula';\nimport type { IRangeSelectorProps } from '../../basics/editor/range';\nimport { AbsoluteRefType, IUniverInstanceService, LocaleService, Tools, UniverInstanceType } from '@univerjs/core';\nimport { Button, Input, Radio, RadioGroup, Select } from '@univerjs/design';\nimport { IDefinedNamesService, IFunctionService, isReferenceStrings, isReferenceStringWithEffectiveColumn, LexerTreeBuilder, operatorToken } from '@univerjs/engine-formula';\nimport { hasCJKText } from '@univerjs/engine-render';\nimport { ErrorSingle } from '@univerjs/icons';\nimport { SCOPE_WORKBOOK_VALUE_DEFINED_NAME } from '@univerjs/sheets';\nimport { ComponentManager, useDependency, useSidebarClick } from '@univerjs/ui';\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { EMBEDDING_FORMULA_EDITOR_COMPONENT_KEY, RANGE_SELECTOR_COMPONENT_KEY } from '../../common/keys';\nimport styles from './index.module.less';\n\nexport interface IDefinedNameInputProps extends Omit<IDefinedNamesServiceParam, 'id'> {\n    inputId: string;\n    type?: string;\n    state: boolean;\n    confirm?: (param: IDefinedNamesServiceParam) => void;\n    cancel?: () => void;\n    id?: string;\n}\n\nconst widthStyle: React.CSSProperties = {\n    width: '100%',\n};\n\nexport const DefinedNameInput = (props: IDefinedNameInputProps) => {\n    const {\n        inputId,\n        state = false,\n        type = 'range',\n        confirm,\n        cancel,\n        name,\n        formulaOrRefString,\n        comment = '',\n        localSheetId = SCOPE_WORKBOOK_VALUE_DEFINED_NAME,\n        hidden = false, // \u662F\u5426\u5BF9\u7528\u6237\u9690\u85CF\uFF0C\u4E0Eexcel\u517C\u5BB9\uFF0C\u6682\u65F6\u7528\u4E0D\u4E0A\u3002\n        id,\n\n    } = props;\n    const univerInstanceService = useDependency(IUniverInstanceService);\n    const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n    const localeService = useDependency(LocaleService);\n    const definedNamesService = useDependency(IDefinedNamesService);\n    const functionService = useDependency(IFunctionService);\n    const lexerTreeBuilder = useDependency(LexerTreeBuilder);\n    const componentManager = useDependency(ComponentManager);\n\n    const RangeSelector: React.ComponentType<IRangeSelectorProps> = useMemo(() => componentManager.get(RANGE_SELECTOR_COMPONENT_KEY), []) as any;\n    const FormulaEditor = useMemo(() => componentManager.get(EMBEDDING_FORMULA_EDITOR_COMPONENT_KEY), []);\n    if (workbook == null) {\n        return;\n    }\n\n    const unitId = useMemo(() => workbook.getUnitId(), []);\n\n    const subUnitId = useMemo(() => workbook.getActiveSheet().getSheetId(), []);\n\n    const [nameValue, setNameValue] = useState(name);\n\n    const [formulaOrRefStringValue, setFormulaOrRefStringValue] = useState(formulaOrRefString);\n\n    const [commentValue, setCommentValue] = useState(comment);\n\n    const [localSheetIdValue, setLocalSheetIdValue] = useState(localSheetId);\n\n    const [validString, setValidString] = useState('');\n\n    const [typeValue, setTypeValue] = useState(type);\n\n    const [validFormulaOrRange, setValidFormulaOrRange] = useState(true);\n\n    const options = [{\n        label: localeService.t('definedName.scopeWorkbook'),\n        value: SCOPE_WORKBOOK_VALUE_DEFINED_NAME,\n    }];\n\n    const isFormula = (token: string) => {\n        return !isReferenceStrings(token);\n    };\n\n    useEffect(() => {\n        setValidFormulaOrRange(true);\n        setNameValue(name);\n        setCommentValue(comment);\n        setLocalSheetIdValue(localSheetId);\n        let formulaOrRefStringCache = formulaOrRefString;\n        if (formulaOrRefString.substring(0, 1) === operatorToken.EQUALS) {\n            setTypeValue('formula');\n        } else if (isFormula(formulaOrRefString)) {\n            setTypeValue('formula');\n            formulaOrRefStringCache = operatorToken.EQUALS + formulaOrRefString;\n        } else {\n            setTypeValue('range');\n        }\n\n        setFormulaOrRefStringValue(formulaOrRefStringCache);\n\n        setValidString('');\n    }, [state]);\n\n    workbook.getSheetOrders().forEach((sheetId) => {\n        const sheet = workbook.getSheetBySheetId(sheetId);\n        options.push({\n            label: sheet?.getName() || '',\n            value: sheetId,\n        });\n    });\n\n    const rangeSelectorChange = (rangesText: string) => {\n        setFormulaOrRefStringValue(rangesText);\n    };\n\n    const formulaEditorChange = (value: Nullable<string>) => {\n        setFormulaOrRefStringValue(value || '');\n    };\n\n    const confirmChange = () => {\n        if (nameValue.length === 0) {\n            setValidString(localeService.t('definedName.nameEmpty'));\n            return;\n        }\n\n        if (definedNamesService.getValueByName(unitId, nameValue) != null && (id == null || id.length === 0)) {\n            setValidString(localeService.t('definedName.nameDuplicate'));\n            return;\n        }\n\n        if (!Tools.isValidParameter(nameValue) || isReferenceStringWithEffectiveColumn(nameValue) || (!Tools.isStartValidPosition(nameValue) && !hasCJKText(nameValue.substring(0, 1)))) {\n            setValidString(localeService.t('definedName.nameInvalid'));\n            return;\n        }\n\n        const sheetNames = workbook.getSheetOrders().map((sheetId) => {\n            return workbook.getSheetBySheetId(sheetId)?.getName() || '';\n        });\n\n        if (sheetNames.includes(nameValue)) {\n            setValidString(localeService.t('definedName.nameSheetConflict'));\n            return;\n        }\n\n        if (formulaOrRefStringValue.length === 0) {\n            setValidString(localeService.t('definedName.formulaOrRefStringEmpty'));\n            return;\n        }\n\n        if (!validFormulaOrRange) {\n            setValidString(localeService.t('definedName.formulaOrRefStringInvalid'));\n            return;\n        }\n\n        if (functionService.hasExecutor(nameValue.toUpperCase())) {\n            setValidString(localeService.t('definedName.nameConflict'));\n            return;\n        }\n\n        const currentSheetName = workbook.getActiveSheet().getName();\n        confirm && confirm({\n            id: id || '',\n            name: nameValue,\n            formulaOrRefString: lexerTreeBuilder.convertRefersToAbsolute(formulaOrRefStringValue, AbsoluteRefType.ALL, AbsoluteRefType.ALL, currentSheetName),\n            comment: commentValue,\n            localSheetId: localSheetIdValue,\n        });\n    };\n\n    const typeValueChange = (value: string | number | boolean) => {\n        const type = value as string;\n        if (type === 'formula') {\n            if (formulaOrRefString[0] === operatorToken.EQUALS) {\n                setFormulaOrRefStringValue(formulaOrRefString);\n            } else {\n                setFormulaOrRefStringValue(`${operatorToken.EQUALS}`);\n            }\n        } else {\n            if (formulaOrRefString[0] === operatorToken.EQUALS) {\n                setFormulaOrRefStringValue('');\n            } else {\n                setFormulaOrRefStringValue(formulaOrRefString);\n            }\n        }\n        setTypeValue(type);\n    };\n\n    const formulaEditorActionsRef = useRef<any>({});\n    const [isFocusFormulaEditor, isFocusFormulaEditorSet] = useState(false);\n\n    useSidebarClick((e: MouseEvent) => {\n        const handleOutClick = formulaEditorActionsRef.current?.handleOutClick;\n        handleOutClick && handleOutClick(e, () => isFocusFormulaEditorSet(false));\n    });\n\n    return (\n        <div className={styles.definedNameInput} style={{ display: state ? 'block' : 'none' }}>\n            <div>\n                <Input placeholder={localeService.t('definedName.inputNamePlaceholder')} value={nameValue} allowClear onChange={setNameValue} affixWrapperStyle={widthStyle} />\n            </div>\n            <div>\n                <RadioGroup value={typeValue} onChange={typeValueChange}>\n                    <Radio value=\"range\">{localeService.t('definedName.ratioRange')}</Radio>\n                    <Radio value=\"formula\">{localeService.t('definedName.ratioFormula')}</Radio>\n                </RadioGroup>\n            </div>\n            {typeValue === 'range'\n                ? (\n                    RangeSelector && (\n                        <RangeSelector\n                            unitId={unitId}\n                            subUnitId={subUnitId}\n                            initialValue={formulaOrRefStringValue}\n                            onChange={(_, text) => rangeSelectorChange(text)}\n\n                            supportAcrossSheet\n                        />\n                    )\n                )\n                : (FormulaEditor && (\n                    <FormulaEditor\n                        initValue={formulaOrRefStringValue as any}\n                        unitId={unitId}\n                        subUnitId={subUnitId}\n                        isFocus={isFocusFormulaEditor}\n                        isSupportAcrossSheet\n                        onChange={(v = '') => {\n                            const formula = v || '';\n                            formulaEditorChange(formula);\n                        }}\n                        onVerify={(res: boolean) => {\n                            setValidFormulaOrRange(res);\n                        }}\n\n                        onFocus={() => isFocusFormulaEditorSet(true)}\n                        actions={formulaEditorActionsRef.current}\n                    />\n                ))}\n            <div>\n                <Select style={widthStyle} value={localSheetIdValue} options={options} onChange={setLocalSheetIdValue} />\n            </div>\n            <div>\n                <Input affixWrapperStyle={widthStyle} placeholder={localeService.t('definedName.inputCommentPlaceholder')} value={commentValue} onChange={setCommentValue} />\n            </div>\n            <div style={{ display: validString.length === 0 ? 'none' : 'flex' }} className={styles.definedNameInputValidation}>\n                <span>\n                    {validString}\n                </span>\n                <ErrorSingle />\n            </div>\n            <div>\n                <Button\n                    onClick={() => {\n                        cancel && cancel();\n                    }}\n                >\n                    {localeService.t('definedName.cancel')}\n                </Button>\n                <Button\n                    style={{ marginLeft: 15 }}\n                    type=\"primary\"\n                    onClick={confirmChange}\n                >\n                    {localeService.t('definedName.confirm')}\n                </Button>\n            </div>\n        </div>\n    );\n};\n", "export default {\n  \"definedNameOverlay\": \"univer-defined-name-overlay\",\n  \"definedNameOverlayContainer\": \"univer-defined-name-overlay-container\",\n  \"definedNameOverlayItem\": \"univer-defined-name-overlay-item\",\n  \"definedNameOverlayItemName\": \"univer-defined-name-overlay-item-name\",\n  \"definedNameOverlayItemNameForSheet\": \"univer-defined-name-overlay-item-name-for-sheet\",\n  \"definedNameOverlayItemFormula\": \"univer-defined-name-overlay-item-formula\",\n  \"definedNameOverlayManager\": \"univer-defined-name-overlay-manager\",\n  \"definedNameOverlayManagerTitle\": \"univer-defined-name-overlay-manager-title\",\n  \"definedNameOverlayManagerContent\": \"univer-defined-name-overlay-manager-content\",\n  \"definedNameContainer\": \"univer-defined-name-container\",\n  \"definedNameContainerScroll\": \"univer-defined-name-container-scroll\",\n  \"definedNameContainerAddButton\": \"univer-defined-name-container-addButton\",\n  \"definedNameContainerAddButtonText\": \"univer-defined-name-container-addButton-text\",\n  \"definedNameContainerItem\": \"univer-defined-name-container-item\",\n  \"definedNameContainerItemName\": \"univer-defined-name-container-item-name\",\n  \"definedNameContainerItemNameForSheet\": \"univer-defined-name-container-item-name-for-sheet\",\n  \"definedNameContainerItemFormulaOrRefString\": \"univer-defined-name-container-item-formula-or-refString\",\n  \"definedNameContainerItemUpdate\": \"univer-defined-name-container-item-update\",\n  \"definedNameContainerItemDelete\": \"univer-defined-name-container-item-delete\",\n  \"definedNameContainerItemShow\": \"univer-defined-name-container-item-show\",\n  \"definedNameInput\": \"univer-defined-name-input\",\n  \"definedNameInputFormulaSelectorTextWrap\": \"univer-defined-name-input-formula-selector-text-wrap\",\n  \"definedNameInputTextEditorContainer\": \"univer-defined-name-input-text-editor-container\",\n  \"definedNameInputValidation\": \"univer-defined-name-input-validation\",\n  \"definedNameInputDisable\": \"univer-defined-name-input-disable\"\n};import \"ni:sha-256;WlwVBuaBLbi6niul2fnF1rSoScaxne-FIXiG_PpsMP8\";", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport { IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport { ContextMenuPosition, IMenuManagerService, ToolbarItem, useDependency, useObservable } from '@univerjs/ui';\nimport { useMemo } from 'react';\nimport { useActiveWorkbook } from '../../components/hook';\nimport { AutoFillPopupMenu } from '../auto-fill-popup-menu/AutoFillPopupMenu';\nimport { CountBar } from '../count-bar/CountBar';\nimport { EditorContainer } from '../editor-container/EditorContainer';\nimport { FormulaBar } from '../formula-bar/FormulaBar';\nimport { SheetBar } from '../sheet-bar/SheetBar';\nimport { StatusBar } from '../status-bar/StatusBar';\n\nexport const SHEET_FOOTER_BAR_HEIGHT = 36;\n\nexport function RenderSheetFooter() {\n    const menuManagerService = useDependency(IMenuManagerService);\n\n    const workbook = useActiveWorkbook();\n    if (!workbook) return null;\n\n    const footerMenus = menuManagerService.getMenuByPositionKey(ContextMenuPosition.FOOTER_MENU);\n\n    return (\n        <section\n            className={`\n              univer-box-border univer-flex univer-items-center univer-justify-between univer-bg-white univer-px-5\n              univer-text-gray-900\n              dark:univer-bg-gray-900 dark:univer-text-gray-200\n            `}\n            style={{\n                height: SHEET_FOOTER_BAR_HEIGHT,\n            }}\n            data-range-selector\n        >\n            <SheetBar />\n            <StatusBar />\n\n            {footerMenus.length && (\n                <div className=\"univer-mr-2 univer-flex univer-gap-2\">\n                    {footerMenus.map((item) => item.children?.map((child) => (\n                        child?.item && (\n                            <ToolbarItem\n                                key={child.key}\n                                {...child.item}\n                            />\n                        )\n                    )))}\n                </div>\n            )}\n\n            <CountBar />\n        </section>\n    );\n}\n\nexport function RenderSheetHeader() {\n    const hasWorkbook = useHasWorkbook();\n    if (!hasWorkbook) return null;\n\n    return (\n        <FormulaBar />\n    );\n}\n\n/**\n * @deprecated We should not write into this component anymore.\n */\nexport function RenderSheetContent() {\n    const hasWorkbook = useHasWorkbook();\n    if (!hasWorkbook) return null;\n\n    return (\n        <>\n            <EditorContainer />\n            <AutoFillPopupMenu />\n        </>\n    );\n}\n\nfunction useHasWorkbook(): boolean {\n    const univerInstanceService = useDependency(IUniverInstanceService);\n    const workbook = useObservable(() => univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET), null, false, []);\n    const hasWorkbook = !!workbook;\n    return useMemo(\n        () => univerInstanceService.getAllUnitsForType(UniverInstanceType.UNIVER_SHEET).length > 0,\n\n        [univerInstanceService, hasWorkbook]\n    );\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport { IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport { useDependency, useObservable } from '@univerjs/ui';\nimport { useMemo } from 'react';\nimport { map, merge, of, startWith } from 'rxjs';\nimport { SheetSkeletonManagerService } from '../services/sheet-skeleton-manager.service';\n\nexport function useActiveWorkbook(): Workbook | null {\n    const univerInstanceService = useDependency(IUniverInstanceService);\n    const workbook = useObservable(() => univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET), undefined, undefined, []);\n    return workbook ?? null;\n}\n\nexport function useActiveWorksheet(workbook?: Workbook | null) {\n    const worksheet = useObservable(() => workbook?.activeSheet$ ?? of(null), undefined, undefined, [workbook]);\n    return worksheet;\n}\n\nexport function useWorkbooks(): Workbook[] {\n    const univerInstanceService = useDependency(IUniverInstanceService);\n    return useObservable(() => {\n        return merge([\n            univerInstanceService.getTypeOfUnitAdded$(UniverInstanceType.UNIVER_SHEET),\n            univerInstanceService.getTypeOfUnitDisposed$(UniverInstanceType.UNIVER_SHEET),\n        ]).pipe(\n            map(() => univerInstanceService.getAllUnitsForType<Workbook>(UniverInstanceType.UNIVER_SHEET)),\n            startWith(univerInstanceService.getAllUnitsForType<Workbook>(UniverInstanceType.UNIVER_SHEET))\n        );\n    }, [], undefined, [univerInstanceService]);\n}\n\nexport function useSheetSkeleton() {\n    const renderManagerService = useDependency(IRenderManagerService);\n    const workbook = useActiveWorkbook();\n\n    const { sheetSkeletonManagerService } = useMemo(() => {\n        if (workbook) {\n            const ru = renderManagerService.getRenderById(workbook.getUnitId());\n            return {\n                sheetSkeletonManagerService: ru?.with(SheetSkeletonManagerService),\n            };\n        }\n\n        return { sheetSkeletonManagerService: null };\n    }, [workbook, renderManagerService]);\n\n    return sheetSkeletonManagerService;\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommandInfo, IExecutionOptions } from '@univerjs/core';\nimport { ICommandService, IUniverInstanceService, LocaleService, toDisposable } from '@univerjs/core';\nimport { clsx, DropdownMenu } from '@univerjs/design';\nimport { convertTransformToOffsetX, convertTransformToOffsetY, IRenderManagerService } from '@univerjs/engine-render';\nimport { Autofill, MoreDownSingle } from '@univerjs/icons';\nimport { useDependency } from '@univerjs/ui';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { RefillCommand } from '../../commands/commands/refill.command';\nimport { SetScrollOperation } from '../../commands/operations/scroll.operation';\nimport { useActiveWorkbook } from '../../components/hook';\nimport { getSheetObject } from '../../controllers/utils/component-tools';\nimport { IAutoFillService } from '../../services/auto-fill/auto-fill.service';\nimport { APPLY_TYPE } from '../../services/auto-fill/type';\nimport { ISheetSelectionRenderService } from '../../services/selection/base-selection-render.service';\nimport { SheetSkeletonManagerService } from '../../services/sheet-skeleton-manager.service';\n\nexport interface IAnchorPoint {\n    row: number;\n    col: number;\n}\n\nexport interface IAutoFillPopupMenuItem {\n    label: string;\n    value: APPLY_TYPE;\n    index: number;\n    disable: boolean;\n}\n\nconst useUpdate = () => {\n    const [, setState] = useState({});\n    return useCallback(() => setState((prevState) => !prevState), []);\n};\n\nexport const AutoFillPopupMenu: React.FC<{}> = () => {\n    const commandService = useDependency(ICommandService);\n    const univerInstanceService = useDependency(IUniverInstanceService);\n    const renderManagerService = useDependency(IRenderManagerService);\n    const autoFillService = useDependency(IAutoFillService);\n    const localeService = useDependency(LocaleService);\n    const [menu, setMenu] = useState<IAutoFillPopupMenuItem[]>([]);\n    const [visible, setVisible] = useState(false);\n    const [anchor, setAnchor] = useState<IAnchorPoint>({ row: -1, col: -1 });\n    const [selected, setSelected] = useState<APPLY_TYPE>(APPLY_TYPE.SERIES);\n    const [isHovered, setHovered] = useState(false);\n    const workbook = useActiveWorkbook();\n    const { sheetSkeletonManagerService, selectionRenderService } = useMemo(() => {\n        if (workbook) {\n            const ru = renderManagerService.getRenderById(workbook.getUnitId());\n            return {\n                sheetSkeletonManagerService: ru?.with(SheetSkeletonManagerService),\n                selectionRenderService: ru?.with(ISheetSelectionRenderService),\n            };\n        }\n\n        return { sheetSkeletonManagerService: null, selectionRenderService: null };\n    }, [workbook, renderManagerService]);\n\n    const handleMouseEnter = () => {\n        setHovered(true);\n    };\n\n    const handleMouseLeave = () => {\n        setHovered(false);\n    };\n    const forceUpdate = useUpdate();\n\n    useEffect(() => {\n        const disposable = commandService.onCommandExecuted((command: ICommandInfo, options?: IExecutionOptions) => {\n            if (command.id === SetScrollOperation.id) {\n                forceUpdate();\n            }\n        });\n        return disposable.dispose;\n    }, [forceUpdate, commandService]);\n\n    useEffect(() => {\n        const disposable = sheetSkeletonManagerService && toDisposable(\n            sheetSkeletonManagerService.currentSkeleton$.subscribe((skeleton) => {\n                if (skeleton) {\n                    forceUpdate();\n                }\n            })\n        );\n        return disposable?.dispose;\n    }, [sheetSkeletonManagerService, forceUpdate]);\n\n    useEffect(() => {\n        const disposable = toDisposable(\n            autoFillService.menu$.subscribe((menu) => {\n                setMenu(menu.map((i) => ({ ...i, index: menu.indexOf(i) })));\n            })\n        );\n        return disposable.dispose;\n    }, [autoFillService]);\n\n    useEffect(() => {\n        const disposable = toDisposable(\n            autoFillService.showMenu$.subscribe((show) => {\n                const { source, target } = autoFillService.autoFillLocation || { source: null, target: null };\n                if (show && source && target) {\n                    const lastRow = Math.max(source.rows[source.rows.length - 1], target.rows[target.rows.length - 1]);\n                    const lastCol = Math.max(source.cols[source.cols.length - 1], target.cols[target.cols.length - 1]);\n                    setAnchor({ row: lastRow, col: lastCol });\n                } else {\n                    setAnchor({ row: -1, col: -1 });\n                }\n            })\n        );\n        return disposable.dispose;\n    }, [autoFillService]);\n\n    useEffect(() => {\n        const disposable = toDisposable(\n            autoFillService.applyType$.subscribe((type) => {\n                setSelected(type);\n            })\n        );\n        return disposable.dispose;\n    }, [autoFillService]);\n\n    useEffect(() => {\n        function handleClose() {\n            setVisible(false);\n        }\n\n        document.addEventListener('wheel', handleClose);\n\n        return () => {\n            document.removeEventListener('wheel', handleClose);\n        };\n    }, [visible]);\n\n    if (anchor.col < 0 || anchor.row < 0) {\n        return null;\n    }\n\n    const sheetObject = getSheetObject(univerInstanceService, renderManagerService);\n    if (!sheetObject || !selectionRenderService) return null;\n\n    const { scene } = sheetObject;\n    const skeleton = sheetSkeletonManagerService?.getCurrentSkeleton();\n    const viewport = selectionRenderService.getViewPort();\n    const scaleX = scene?.scaleX;\n    const scaleY = scene?.scaleY;\n    const scrollXY = scene?.getViewportScrollXY(viewport);\n    if (!scaleX || !scene || !scaleX || !scaleY || !scrollXY) return null;\n    const x = skeleton?.getNoMergeCellWithCoordByIndex(anchor.row, anchor.col).endX || 0;\n    const y = skeleton?.getNoMergeCellWithCoordByIndex(anchor.row, anchor.col).endY || 0;\n    const relativeX = convertTransformToOffsetX(x, scaleX, scrollXY);\n    const relativeY = convertTransformToOffsetY(y, scaleY, scrollXY);\n\n    if (relativeX == null || relativeY == null) return null;\n    const onVisibleChange = (visible: boolean) => {\n        setVisible(visible);\n    };\n\n    const handleClick = (item: IAutoFillPopupMenuItem) => {\n        commandService.executeCommand(RefillCommand.id, { type: item.value });\n        setVisible(false);\n    };\n\n    const showMore = visible || isHovered;\n\n    const availableMenu = menu.filter((item) => !item.disable);\n\n    return (\n        <div className=\"univer-absolute univer-inset-0 univer-z-10 univer-size-0\">\n            <div\n                style={{ left: `${relativeX + 2}px`, top: `${relativeY + 2}px`, position: 'absolute' }}\n                onMouseEnter={handleMouseEnter}\n                onMouseLeave={handleMouseLeave}\n            >\n                <DropdownMenu\n                    align=\"start\"\n                    items={availableMenu.map((item) => ({\n                        type: 'radio',\n                        value: selected,\n                        options: [{ label: localeService.t(item.label), value: item.value }],\n                        onSelect: () => handleClick(item),\n                    }))}\n                    open={visible}\n                    onOpenChange={onVisibleChange}\n                >\n                    <div\n                        className={clsx(`\n                          univer-flex univer-items-center univer-gap-2 univer-rounded univer-border univer-border-solid\n                          univer-border-gray-200 univer-p-1\n                          hover:univer-bg-gray-100\n                        `, {\n                            'univer-bg-gray-100': visible,\n                            'univer-bg-white': !visible,\n                        })}\n                    >\n                        <Autofill\n                            style={{ color: '#35322B' }}\n                            extend={{ colorChannel1: 'rgb(var(--green-700, #409f11))' }}\n                        />\n                        {showMore && <MoreDownSingle className=\"univer-text-[10px] univer-text-gray-400\" />}\n                    </div>\n                </DropdownMenu>\n            </div>\n        </div>\n    );\n};\n", "export default {\n  \"countBar\": \"univer-count-bar\"\n};import \"ni:sha-256;PDi5nyhpfURECIznW1_wUk118nT2BQLjc96um93Q_iE\";", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport {\n    DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,\n    ICommandService,\n    IUniverInstanceService,\n    UniverInstanceType,\n} from '@univerjs/core';\nimport { SetWorksheetActiveOperation } from '@univerjs/sheets';\nimport { Slider, useDependency, useObservable } from '@univerjs/ui';\nimport { useCallback, useEffect, useState } from 'react';\n\nimport { SetZoomRatioCommand } from '../../commands/commands/set-zoom-ratio.command';\nimport { SetZoomRatioOperation } from '../../commands/operations/set-zoom-ratio.operation';\nimport { SHEET_ZOOM_RANGE } from '../../common/keys';\nimport { useActiveWorkbook } from '../../components/hook';\nimport { IEditorBridgeService } from '../../services/editor-bridge.service';\n\nconst ZOOM_MAP = [50, 75, 100, 125, 150, 175, 200, 400];\n\nexport function ZoomSlider() {\n    const commandService = useDependency(ICommandService);\n    const univerInstanceService = useDependency(IUniverInstanceService);\n    const workbook = useActiveWorkbook();\n    const editorBridgeService = useDependency(IEditorBridgeService);\n    const visible = useObservable(editorBridgeService.visible$);\n\n    const getCurrentZoom = useCallback(() => {\n        if (!workbook) return 100;\n\n        const worksheet = workbook.getActiveSheet();\n        const currentZoom = (worksheet && (worksheet.getZoomRatio() * 100)) || 100;\n        return Math.round(currentZoom);\n    }, [workbook]);\n\n    const [zoom, setZoom] = useState(() => getCurrentZoom());\n\n    useEffect(() => {\n        setZoom(getCurrentZoom());\n\n        const disposable = commandService.onCommandExecuted((commandInfo) => {\n            if (commandInfo.id === SetZoomRatioOperation.id || commandInfo.id === SetWorksheetActiveOperation.id) {\n                const currentZoom = getCurrentZoom();\n                setZoom(currentZoom);\n            }\n        });\n\n        return disposable.dispose;\n    }, [commandService, getCurrentZoom]);\n\n    function handleChange(value: number) {\n        setZoom(value);\n        const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n        const worksheet = workbook?.getActiveSheet();\n        if (worksheet == null) {\n            return;\n        }\n\n        const zoomRatio = value / 100;\n\n        commandService.executeCommand(SetZoomRatioCommand.id, {\n            unitId: workbook.getUnitId(),\n            subUnitId: worksheet.getSheetId(),\n            zoomRatio,\n        });\n    }\n\n    const disabled = visible?.visible && (visible.unitId === workbook?.getUnitId() || visible.unitId === DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY);\n\n    return (\n        <Slider\n            disabled={disabled}\n            min={SHEET_ZOOM_RANGE[0]}\n            value={zoom}\n            shortcuts={ZOOM_MAP}\n            onChange={handleChange}\n        />\n    );\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport styles from './index.module.less';\nimport { ZoomSlider } from './ZoomSlider';\n\ninterface ICountBarProps {\n    changeRatio?: (ratio: string) => void;\n    onChange?: (value: string) => void;\n}\n\nexport function CountBar(props: ICountBarProps) {\n    return (\n        <section className={styles.countBar}>\n            <ZoomSlider />\n        </section>\n    );\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { KeyCode } from '@univerjs/ui';\nimport { DOCS_NORMAL_EDITOR_UNIT_ID_KEY, ICommandService, IContextService } from '@univerjs/core';\nimport { IEditorService } from '@univerjs/docs-ui';\nimport { DeviceInputEventType } from '@univerjs/engine-render';\nimport { ComponentManager, DISABLE_AUTO_FOCUS_KEY, MetaKeys, useDependency, useEvent, useObservable, useSidebarClick } from '@univerjs/ui';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { SetCellEditVisibleArrowOperation, SetCellEditVisibleOperation } from '../../commands/operations/cell-edit.operation';\n\nimport { EMBEDDING_FORMULA_EDITOR_COMPONENT_KEY } from '../../common/keys';\nimport { IEditorBridgeService } from '../../services/editor-bridge.service';\nimport { ICellEditorManagerService } from '../../services/editor/cell-editor-manager.service';\nimport { useKeyEventConfig } from './hooks';\nimport styles from './index.module.less';\n\ninterface ICellIEditorProps { }\n\nconst HIDDEN_EDITOR_POSITION = -1000;\n\nconst EDITOR_DEFAULT_POSITION = {\n    width: 0,\n    height: 0,\n    top: HIDDEN_EDITOR_POSITION,\n    left: HIDDEN_EDITOR_POSITION,\n};\n\n/**\n * Cell editor container.\n * @returns\n */\nexport const EditorContainer: React.FC<ICellIEditorProps> = () => {\n    const [state, setState] = useState({\n        ...EDITOR_DEFAULT_POSITION,\n    });\n    const cellEditorManagerService = useDependency(ICellEditorManagerService);\n    const editorService = useDependency(IEditorService);\n    const contextService = useDependency(IContextService);\n    const componentManager = useDependency(ComponentManager);\n    const editorBridgeService = useDependency(IEditorBridgeService);\n    const visible = useObservable(editorBridgeService.visible$);\n    const commandService = useDependency(ICommandService);\n    const isRefSelecting = useRef<0 | 1 | 2>(0);\n    const disableAutoFocus = useObservable(\n        () => contextService.subscribeContextValue$(DISABLE_AUTO_FOCUS_KEY),\n        false,\n        undefined,\n        [contextService, DISABLE_AUTO_FOCUS_KEY]\n    );\n    const FormulaEditor = componentManager.get(EMBEDDING_FORMULA_EDITOR_COMPONENT_KEY);\n    const editState = editorBridgeService.getEditLocation();\n\n    useEffect(() => {\n        const sub = cellEditorManagerService.state$.subscribe((param) => {\n            if (param == null) {\n                return;\n            }\n\n            const {\n                startX = HIDDEN_EDITOR_POSITION,\n                startY = HIDDEN_EDITOR_POSITION,\n                endX = 0,\n                endY = 0,\n                show = false,\n            } = param;\n\n            if (!show) {\n                setState({\n                    ...EDITOR_DEFAULT_POSITION,\n                });\n            } else {\n                setState({\n                    width: endX - startX,\n                    height: endY - startY,\n                    left: startX,\n                    top: startY,\n                });\n\n                const editor = editorService.getEditor(DOCS_NORMAL_EDITOR_UNIT_ID_KEY);\n\n                if (editor == null) {\n                    return;\n                }\n\n                const { left, top, width, height } = editor.getBoundingClientRect();\n\n                cellEditorManagerService.setRect({ left, top, width, height });\n            }\n        });\n        return () => {\n            sub.unsubscribe();\n        };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []); // Empty dependency array means this effect runs once on mount and clean up on unmount\n\n    useEffect(() => {\n        if (!disableAutoFocus) {\n            cellEditorManagerService.setFocus(true);\n        }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [disableAutoFocus, state]);\n\n    const handleClickSideBar = useEvent(() => {\n        if (editorBridgeService.isVisible().visible) {\n            commandService.executeCommand(SetCellEditVisibleOperation.id, {\n                visible: false,\n                eventType: DeviceInputEventType.PointerUp,\n                unitId: editState?.unitId,\n            });\n        }\n    });\n\n    useSidebarClick(handleClickSideBar);\n\n    const keyCodeConfig = useKeyEventConfig(isRefSelecting, editState?.unitId!);\n\n    const onMoveInEditor = useEvent((keycode: KeyCode, metaKey: MetaKeys) => {\n        commandService.executeCommand(SetCellEditVisibleArrowOperation.id, {\n            keycode,\n            visible: false,\n            eventType: DeviceInputEventType.Keyboard,\n            isShift: metaKey === MetaKeys.SHIFT || metaKey === (MetaKeys.CTRL_COMMAND | MetaKeys.SHIFT),\n            unitId: editState?.unitId,\n        });\n    });\n\n    return (\n        <div\n            className={styles.editorContainer}\n            style={{\n                left: state.left,\n                top: state.top,\n                width: state.width,\n                height: state.height,\n            }}\n        >\n            {FormulaEditor && (\n                <FormulaEditor\n                    editorId={DOCS_NORMAL_EDITOR_UNIT_ID_KEY}\n                    className={styles.editorInput}\n                    initValue=\"\"\n                    onChange={() => {}}\n                    isFocus={visible?.visible}\n                    unitId={editState?.unitId}\n                    subUnitId={editState?.sheetId}\n                    keyboradEventConfig={keyCodeConfig}\n                    onMoveInEditor={onMoveInEditor}\n                    isSupportAcrossSheet\n                    resetSelectionOnBlur={false}\n                    isSingle={false}\n                    autoScrollbar={false}\n                    onFormulaSelectingChange={(isSelecting: 0 | 1 | 2) => {\n                        isRefSelecting.current = isSelecting;\n                        if (isSelecting) {\n                            editorBridgeService.enableForceKeepVisible();\n                        } else {\n                            editorBridgeService.disableForceKeepVisible();\n                        }\n                    }}\n                    disableSelectionOnClick\n                    disableContextMenu={false}\n                />\n            )}\n        </div>\n    );\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IDisposable, IPosition, Nullable } from '@univerjs/core';\nimport type { Observable } from 'rxjs';\nimport { createIdentifier } from '@univerjs/core';\nimport { BehaviorSubject } from 'rxjs';\n\nexport interface ICellEditorManagerParam extends Partial<IPosition> {\n    show: boolean;\n}\n\nexport interface ICellEditorBoundingClientRect {\n    left: number;\n    top: number;\n    width: number;\n    height: number;\n}\n\nexport interface ICellEditorManagerService {\n    state$: Observable<Nullable<ICellEditorManagerParam>>;\n    rect$: Observable<Nullable<ICellEditorBoundingClientRect>>;\n    focus$: Observable<boolean>;\n    dispose(): void;\n    setState(param: ICellEditorManagerParam): void;\n    getState(): Readonly<Nullable<ICellEditorManagerParam>>;\n    setRect(param: ICellEditorBoundingClientRect): void;\n    getRect(): Readonly<Nullable<ICellEditorBoundingClientRect>>;\n    setFocus(param: boolean): void;\n}\n\nexport class CellEditorManagerService implements ICellEditorManagerService, IDisposable {\n    private _state: Nullable<ICellEditorManagerParam> = null;\n\n    private _rect: Nullable<ICellEditorBoundingClientRect> = null;\n\n    private readonly _state$ = new BehaviorSubject<Nullable<ICellEditorManagerParam>>(null);\n\n    readonly state$ = this._state$.asObservable();\n\n    private readonly _rect$ = new BehaviorSubject<Nullable<ICellEditorBoundingClientRect>>(null);\n\n    readonly rect$ = this._rect$.asObservable();\n\n    private _focus: boolean = false;\n    private readonly _focus$ = new BehaviorSubject<boolean>(this._focus);\n    readonly focus$ = this._focus$.asObservable();\n\n    dispose(): void {\n        this._state$.complete();\n        this._state = null;\n        this._rect$.complete();\n        this._rect = null;\n    }\n\n    setState(param: ICellEditorManagerParam): void {\n        this._state = param;\n\n        this._refresh(param);\n    }\n\n    getRect(): Readonly<Nullable<ICellEditorBoundingClientRect>> {\n        return this._rect;\n    }\n\n    setRect(param: ICellEditorBoundingClientRect) {\n        this._rect = param;\n        this._rect$.next(param);\n    }\n\n    getState(): Readonly<Nullable<ICellEditorManagerParam>> {\n        return this._state;\n    }\n\n    setFocus(param: boolean = false) {\n        this._focus = param;\n        this._focus$.next(param);\n    }\n\n    private _refresh(param: ICellEditorManagerParam): void {\n        this._state$.next(param);\n    }\n}\n\nexport const ICellEditorManagerService = createIdentifier<CellEditorManagerService>(\n    'univer.sheet-cell-editor-manager.service'\n);\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ICommandService } from '@univerjs/core';\nimport { DocSelectionRenderService } from '@univerjs/docs-ui';\nimport { DeviceInputEventType, IRenderManagerService } from '@univerjs/engine-render';\nimport { KeyCode, useDependency, useObservable } from '@univerjs/ui';\nimport { useMemo } from 'react';\nimport { SetCellEditVisibleOperation } from '../../commands/operations/cell-edit.operation';\nimport { IEditorBridgeService } from '../../services/editor-bridge.service';\n\nexport function useKeyEventConfig(isRefSelecting: React.MutableRefObject<0 | 1 | 2>, unitId: string) {\n    const editorBridgeService = useDependency(IEditorBridgeService);\n    const commandService = useDependency(ICommandService);\n\n    const keyCodeConfig = useMemo(() => ({\n        keyCodes: [\n            { keyCode: KeyCode.ENTER },\n            { keyCode: KeyCode.ESC },\n            { keyCode: KeyCode.TAB },\n        ],\n        handler: (keycode: KeyCode) => {\n            if (keycode === KeyCode.ENTER || keycode === KeyCode.ESC || keycode === KeyCode.TAB) {\n                editorBridgeService.disableForceKeepVisible();\n                commandService.executeCommand(SetCellEditVisibleOperation.id, {\n                    visible: false,\n                    eventType: DeviceInputEventType.Keyboard,\n                    keycode,\n                    unitId: unitId!,\n                });\n            }\n        },\n    }), [commandService, editorBridgeService, unitId]);\n\n    return keyCodeConfig;\n}\n\nexport function useIsFocusing(editorId: string) {\n    const renderManagerService = useDependency(IRenderManagerService);\n    const docSelectionRenderService = renderManagerService.getRenderById(editorId)?.with(DocSelectionRenderService);\n    useObservable(docSelectionRenderService?.onBlur$);\n    useObservable(docSelectionRenderService?.onFocus$);\n\n    return docSelectionRenderService?.isFocusing;\n}\n", "export default {\n  \"editorContainer\": \"univer-editor-container\",\n  \"editorInput\": \"univer-editor-input\",\n  \"sheetEmbeddingFormulaEditorWrap\": \"univer-sheet-embedding-formula-editor-wrap\"\n};import \"ni:sha-256;HhmSk5hvJSCJe9vei1VkCfHKjhjKTJNx9z0LLXfEXpI\";", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport type { IEditorBridgeServiceVisibleParam } from '../../services/editor-bridge.service';\nimport { DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY, FOCUSING_FX_BAR_EDITOR, ICommandService, IContextService, IPermissionService, IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport { clsx } from '@univerjs/design';\nimport { IEditorService } from '@univerjs/docs-ui';\nimport { DeviceInputEventType } from '@univerjs/engine-render';\nimport { CheckMarkSingle, CloseSingle, DropdownSingle, FxSingle } from '@univerjs/icons';\nimport { RangeProtectionCache, RangeProtectionRuleModel, SheetsSelectionsService, UnitAction, WorksheetEditPermission, WorksheetProtectionRuleModel, WorksheetViewPermission } from '@univerjs/sheets';\nimport { ComponentContainer, ComponentManager, KeyCode, useComponentsOfPart, useDependency, useObservable } from '@univerjs/ui';\nimport React, { useEffect, useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport { EMPTY, merge, of, switchMap } from 'rxjs';\nimport { SetCellEditVisibleOperation } from '../../commands/operations/cell-edit.operation';\nimport { EMBEDDING_FORMULA_EDITOR_COMPONENT_KEY } from '../../common/keys';\nimport { useActiveWorkbook } from '../../components/hook';\nimport { SheetsUIPart } from '../../consts/ui-name';\nimport { IEditorBridgeService } from '../../services/editor-bridge.service';\nimport { IFormulaEditorManagerService } from '../../services/editor/formula-editor-manager.service';\nimport { DefinedName } from '../defined-name/DefinedName';\nimport { useKeyEventConfig } from '../editor-container/hooks';\nimport styles from './index.module.less';\n\nenum ArrowDirection {\n    Down,\n    Up,\n}\n\ninterface IProps {\n    className?: string;\n}\n\nexport function FormulaBar(props: IProps) {\n    const { className } = props;\n\n    const [iconStyle, setIconStyle] = useState<string>(styles.formulaGrey);\n    const [arrowDirection, setArrowDirection] = useState<ArrowDirection>(ArrowDirection.Down);\n\n    const formulaEditorManagerService = useDependency(IFormulaEditorManagerService);\n    const editorBridgeService = useDependency(IEditorBridgeService);\n    const worksheetProtectionRuleModel = useDependency(WorksheetProtectionRuleModel);\n    const rangeProtectionRuleModel = useDependency(RangeProtectionRuleModel);\n    const univerInstanceService = useDependency(IUniverInstanceService);\n    const selectionManager = useDependency(SheetsSelectionsService);\n    const permissionService = useDependency(IPermissionService);\n    const rangeProtectionCache = useDependency(RangeProtectionCache);\n    const commandService = useDependency(ICommandService);\n    const [disableInfo, setDisableInfo] = useState<{ editDisable: boolean; viewDisable: boolean }>({\n        editDisable: false,\n        viewDisable: false,\n    });\n    const [imageDisable, setImageDisable] = useState<boolean>(false);\n    const currentWorkbook = useActiveWorkbook();\n    const componentManager = useDependency(ComponentManager);\n    const workbook = useObservable(() => univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET), undefined, undefined, [])!;\n    const isRefSelecting = useRef<0 | 1 | 2>(0);\n    const editState = useObservable(editorBridgeService.currentEditCellState$);\n    const keyCodeConfig = useKeyEventConfig(isRefSelecting, editState?.unitId ?? '');\n    const FormulaEditor = componentManager.get(EMBEDDING_FORMULA_EDITOR_COMPONENT_KEY);\n    const formulaAuxUIParts = useComponentsOfPart(SheetsUIPart.FORMULA_AUX);\n    const contextService = useDependency(IContextService);\n    useObservable(useMemo(() => contextService.subscribeContextValue$(FOCUSING_FX_BAR_EDITOR), [contextService]));\n    const isFocusFxBar = contextService.getContextValue(FOCUSING_FX_BAR_EDITOR);\n    const ref = useRef<HTMLDivElement>(null);\n    const editorService = useDependency(IEditorService);\n\n    useLayoutEffect(() => {\n        const subscription = workbook.activeSheet$.pipe(\n            switchMap((worksheet) => {\n                if (!worksheet) {\n                    return EMPTY;\n                }\n                return merge(\n                    worksheetProtectionRuleModel.ruleChange$,\n                    rangeProtectionRuleModel.ruleChange$,\n                    selectionManager.selectionMoveEnd$,\n                    selectionManager.selectionSet$\n                ).pipe(\n                    switchMap(() => {\n                        const unitId = workbook.getUnitId();\n                        const subUnitId = worksheet.getSheetId();\n                        const range = selectionManager.getCurrentLastSelection()?.range;\n                        if (!range) return EMPTY;\n                        const primary = selectionManager.getCurrentLastSelection()?.primary;\n                        if (!primary) {\n                            return of(null);\n                        }\n\n                        return of({\n                            unitId,\n                            subUnitId,\n                            primary,\n                        });\n                    })\n                );\n            })\n        ).subscribe((cellInfo) => {\n            if (cellInfo) {\n                const { unitId, subUnitId, primary } = cellInfo;\n                if (worksheetProtectionRuleModel.getRule(unitId, subUnitId)) {\n                    const editDisable = !(permissionService.getPermissionPoint(new WorksheetEditPermission(unitId, subUnitId).id)?.value ?? true);\n                    const viewDisable = !(permissionService.getPermissionPoint(new WorksheetViewPermission(unitId, subUnitId).id)?.value ?? true);\n                    setDisableInfo({\n                        viewDisable,\n                        editDisable,\n                    });\n                    return;\n                }\n                const { actualRow, actualColumn } = primary;\n                const cellInfoWithPermission = rangeProtectionCache.getCellInfo(unitId, subUnitId, actualRow, actualColumn);\n                setDisableInfo({\n                    editDisable: !(cellInfoWithPermission?.[UnitAction.Edit] ?? true),\n                    viewDisable: !(cellInfoWithPermission?.[UnitAction.View] ?? true),\n                });\n            } else {\n                setDisableInfo({\n                    viewDisable: false,\n                    editDisable: false,\n                });\n            }\n        });\n\n        return () => {\n            subscription.unsubscribe();\n        };\n    }, [workbook]);\n\n    useEffect(() => {\n        const subscription = editorBridgeService.visible$.subscribe((visibleInfo) => {\n            setIconStyle(visibleInfo.visible ? styles.formulaActive : styles.formulaGrey);\n        });\n\n        return () => subscription.unsubscribe();\n    }, [editorBridgeService.visible$]);\n\n    useEffect(() => {\n        const subscription = editorBridgeService.currentEditCellState$.subscribe((state) => {\n            if (state?.documentLayoutObject.documentModel?.getBody()?.customBlocks?.length) {\n                setImageDisable(true);\n            } else {\n                setImageDisable(false);\n            }\n        });\n\n        return () => subscription.unsubscribe();\n    }, [editorBridgeService.currentEditCellState$]);\n\n    useEffect(() => {\n        const handleResize = () => {\n            if (!ref.current) return;\n\n            const editorRect = ref.current.getBoundingClientRect();\n            formulaEditorManagerService.setPosition(editorRect);\n        };\n\n        if (ref.current) {\n            handleResize();\n            const a = new ResizeObserver(handleResize);\n\n            a.observe(ref.current);\n            return () => a.disconnect();\n        }\n    }, [formulaEditorManagerService]);\n\n    function handleArrowClick() {\n        setArrowDirection(arrowDirection === ArrowDirection.Down ? ArrowDirection.Up : ArrowDirection.Down);\n\n        const ANIMATION_DURATION = 150;\n        setTimeout(() => {\n            formulaEditorManagerService.handleFoldBtnClick(arrowDirection === ArrowDirection.Up);\n        }, ANIMATION_DURATION);\n    }\n\n    // Handle click the \"\u00D7\" button.\n    function handleCloseBtnClick() {\n        const visibleState = editorBridgeService.isVisible();\n        if (visibleState.visible) {\n            commandService.executeCommand(SetCellEditVisibleOperation.id, {\n                visible: false,\n                eventType: DeviceInputEventType.Keyboard,\n                keycode: KeyCode.ESC,\n                unitId: currentWorkbook?.getUnitId() ?? '',\n            });\n        }\n    }\n\n    // Handle click the \"\u221A\" button.\n    function handleConfirmBtnClick() {\n        const visibleState = editorBridgeService.isVisible();\n        if (visibleState.visible) {\n            commandService.executeCommand(SetCellEditVisibleOperation.id, {\n                visible: false,\n                eventType: DeviceInputEventType.PointerDown,\n                unitId: currentWorkbook?.getUnitId() ?? '',\n            });\n        }\n    }\n\n    function handlerFxBtnClick() {\n        formulaEditorManagerService.handleFxBtnClick(true);\n    }\n\n    // TODO Is there a need to disable an editor here?\n    const { viewDisable, editDisable } = disableInfo;\n    const disabled = editDisable || imageDisable;\n    const shouldSkipFocus = useRef(false);\n\n    const handlePointerDown = () => {\n        try {\n            // When clicking on the formula bar, the cell editor also needs to enter the edit state\n            const visibleState = editorBridgeService.isVisible();\n            if (visibleState.visible === false) {\n                commandService.syncExecuteCommand(\n                    SetCellEditVisibleOperation.id,\n                    {\n                        visible: true,\n                        eventType: DeviceInputEventType.PointerDown,\n                        unitId: currentWorkbook?.getUnitId() ?? '',\n                    } as IEditorBridgeServiceVisibleParam\n                );\n                // undoRedoService.clearUndoRedo(DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY);\n            }\n\n            // Open the normal editor first, and then we mark formula editor as activated.\n            contextService.setContextValue(FOCUSING_FX_BAR_EDITOR, true);\n        } catch (e) {\n            shouldSkipFocus.current = true;\n            throw e;\n        }\n    };\n\n    const handlePointerUp = (e: React.PointerEvent<HTMLDivElement>) => {\n        if (shouldSkipFocus.current) {\n            setTimeout(() => {\n                editorService.blur(true);\n            }, 30);\n        }\n        shouldSkipFocus.current = false;\n    };\n\n    const isCellImage = (editState?.documentLayoutObject.documentModel?.getDrawingsOrder()?.length ?? 0) > 0;\n    const hideEditor = isCellImage || viewDisable;\n\n    return (\n        <div\n            className={clsx(styles.formulaBox, className)}\n            style={{\n                height: ArrowDirection.Down === arrowDirection ? '28px' : '82px',\n                pointerEvents: editDisable ? 'none' : 'auto',\n            }}\n        >\n            <div className={styles.nameRanges}>\n                <DefinedName disable={editDisable} />\n            </div>\n\n            <div className={styles.formulaBar}>\n                <div className={clsx(styles.formulaIcon, { [styles.formulaIconDisable]: disabled })}>\n                    <div className={styles.formulaIconWrapper}>\n                        <span\n                            className={clsx(styles.iconContainer, styles.iconContainerError, iconStyle)}\n                            onClick={handleCloseBtnClick}\n                        >\n                            <CloseSingle />\n                        </span>\n\n                        <span\n                            className={clsx(styles.iconContainer, styles.iconContainerSuccess, iconStyle)}\n                            onClick={handleConfirmBtnClick}\n                        >\n                            <CheckMarkSingle />\n                        </span>\n\n                        <span className={clsx(styles.iconContainer, styles.iconContainerFx)} onClick={handlerFxBtnClick}>\n                            <FxSingle />\n                        </span>\n                    </div>\n                </div>\n\n                <div className={styles.formulaContainer}>\n                    <div\n                        className={styles.formulaInput}\n                        onPointerDown={handlePointerDown}\n                        onPointerUp={handlePointerUp}\n                        ref={ref}\n                        style={{ pointerEvents: hideEditor ? 'none' : 'auto' }}\n                    >\n                        {FormulaEditor && (\n                            <FormulaEditor\n                                disableSelectionOnClick\n                                editorId={DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY}\n                                initValue=\"\"\n                                onChange={() => { }}\n                                isFocus={isFocusFxBar}\n                                className={styles.formulaContent}\n                                unitId={editState?.unitId}\n                                subUnitId={editState?.sheetId}\n                                isSupportAcrossSheet\n                                resetSelectionOnBlur={false}\n                                isSingle={false}\n                                keyboradEventConfig={keyCodeConfig}\n                                onFormulaSelectingChange={(isSelecting: 0 | 1 | 2) => {\n                                    isRefSelecting.current = isSelecting;\n                                    if (isSelecting) {\n                                        editorBridgeService.enableForceKeepVisible();\n                                    } else {\n                                        editorBridgeService.disableForceKeepVisible();\n                                    }\n                                }}\n                                autoScrollbar={false}\n                                disableContextMenu={false}\n                            />\n                        )}\n                        {hideEditor ? <div className={styles.formulaInputMask} /> : null}\n                    </div>\n                    <div className={clsx(styles.arrowContainer, { [styles.arrowContainerDisable]: editDisable })} onClick={handleArrowClick}>\n                        {arrowDirection === ArrowDirection.Down\n                            ? (\n                                <DropdownSingle />\n                            )\n                            : (\n                                <DropdownSingle style={{ transform: 'rotateZ(180deg)' }} />\n                            )}\n                    </div>\n                </div>\n            </div>\n\n            <ComponentContainer key=\"formula-aux\" components={formulaAuxUIParts} />\n        </div>\n    );\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IDisposable, Nullable } from '@univerjs/core';\nimport { createIdentifier } from '@univerjs/core';\nimport type { Observable } from 'rxjs';\nimport { BehaviorSubject, Subject } from 'rxjs';\n\nexport interface IFormulaEditorManagerService {\n    position$: Observable<Nullable<DOMRect>>;\n    focus$: Observable<boolean>;\n    fxBtnClick$: Observable<boolean>;\n    foldBtnStatus$: Observable<boolean>;\n    dispose(): void;\n    setPosition(param: DOMRect): void;\n    getPosition(): Readonly<Nullable<DOMRect>>;\n    setFocus(param: boolean): void;\n}\n\nexport class FormulaEditorManagerService implements IDisposable {\n    private _position: Nullable<DOMRect> = null;\n\n    private readonly _position$ = new BehaviorSubject<Nullable<DOMRect>>(null);\n    readonly position$ = this._position$.asObservable();\n\n    private _focus: boolean = false;\n\n    private readonly _focus$ = new BehaviorSubject<boolean>(this._focus);\n    readonly focus$ = this._focus$.asObservable();\n\n    private readonly _fxBtnClick$ = new Subject<boolean>();\n    readonly fxBtnClick$ = this._fxBtnClick$.asObservable();\n\n    private readonly _foldBtnStatus$ = new Subject<boolean>();\n    readonly foldBtnStatus$ = this._foldBtnStatus$.asObservable();\n\n    dispose(): void {\n        this._position$.complete();\n        this._focus$.complete();\n        this._position = null;\n        this._focus = false;\n    }\n\n    setPosition(param: DOMRect) {\n        this._position = param;\n\n        this._refresh(param);\n    }\n\n    getPosition(): Readonly<Nullable<DOMRect>> {\n        return this._position;\n    }\n\n    setFocus(param: boolean = false) {\n        this._focus = param;\n        this._focus$.next(param);\n    }\n\n    handleFxBtnClick(params: boolean) {\n        this._fxBtnClick$.next(params);\n    }\n\n    handleFoldBtnClick(params: boolean) {\n        this._foldBtnStatus$.next(params);\n    }\n\n    private _refresh(param: DOMRect): void {\n        this._position$.next(param);\n    }\n}\n\nexport const IFormulaEditorManagerService = createIdentifier<FormulaEditorManagerService>(\n    'univer.sheet-formula-editor-manager.service'\n);\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { clsx, Dropdown } from '@univerjs/design';\nimport { IDefinedNamesService } from '@univerjs/engine-formula';\nimport { MoreDownSingle } from '@univerjs/icons';\nimport { useDependency } from '@univerjs/ui';\nimport { useEffect, useState } from 'react';\nimport { DefinedNameOverlay } from './DefinedNameOverlay';\nimport styles from './index.module.less';\n\nexport function DefinedName({ disable }: { disable: boolean }) {\n    const [rangeString, setRangeString] = useState('');\n    const definedNamesService = useDependency(IDefinedNamesService);\n\n    useEffect(() => {\n        const subscription = definedNamesService.currentRange$.subscribe(() => {\n            setRangeString(definedNamesService.getCurrentRangeForString());\n        });\n\n        return () => {\n            subscription.unsubscribe();\n        };\n    }, []); // Empty dependency array means this effect runs once on mount and clean up on unmount\n\n    // TODO: @DR-Univer: Should be implemented\n    function handleChangeSelection() {\n\n    }\n\n    return (\n        <div\n            className={`\n              univer-relative univer-box-border univer-flex univer-h-full univer-w-24 univer-border-r-gray-200\n              univer-py-1.5 univer-transition-all\n            `}\n        >\n            <input\n                className={clsx(`\n                  univer-box-border univer-h-full univer-w-full univer-appearance-none univer-border-0 univer-border-r\n                  univer-border-r-gray-200 univer-px-1.5\n                  focus:univer-outline-none\n                `, {\n                    [styles.defineNameInputDisable]: disable,\n                })}\n                type=\"text\"\n                value={rangeString}\n                onChange={handleChangeSelection}\n            />\n\n            <Dropdown\n                overlay={(\n                    <div className=\"univer-z-[1001]\">\n                        <DefinedNameOverlay />\n                    </div>\n                )}\n            >\n                <a\n                    className={clsx(`\n                      univer-absolute univer-right-0 univer-top-0 univer-flex univer-h-full univer-cursor-pointer\n                      univer-items-center univer-justify-center univer-px-1 univer-transition-colors univer-duration-200\n                      hover:univer-bg-gray-100\n                    `, {\n                        'univer-cursor-not-allowed univer-text-gray-300 hover:univer-bg-transparent': disable,\n                    })}\n                >\n                    <MoreDownSingle />\n                </a>\n            </Dropdown>\n        </div>\n    );\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\n\nimport type { IDefinedNamesServiceParam } from '@univerjs/engine-formula';\nimport { ICommandService, IUniverInstanceService, LocaleService, UniverInstanceType } from '@univerjs/core';\nimport { IDefinedNamesService } from '@univerjs/engine-formula';\nimport { SetWorksheetShowCommand } from '@univerjs/sheets';\nimport { ISidebarService, useDependency } from '@univerjs/ui';\nimport React, { useEffect, useState } from 'react';\nimport { SidebarDefinedNameOperation } from '../../commands/operations/sidebar-defined-name.operation';\nimport { DEFINED_NAME_CONTAINER } from './component-name';\n\nexport interface IDefinedNameOverlayProps {\n\n}\n\nexport function DefinedNameOverlay(props: IDefinedNameOverlayProps) {\n    const commandService = useDependency(ICommandService);\n    const localeService = useDependency(LocaleService);\n    const definedNamesService = useDependency(IDefinedNamesService);\n    const univerInstanceService = useDependency(IUniverInstanceService);\n    const sidebarService = useDependency(ISidebarService);\n\n    const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n    const unitId = workbook.getUnitId();\n\n    const getDefinedNameMap = () => {\n        const definedNameMap = definedNamesService.getDefinedNameMap(unitId);\n        if (definedNameMap) {\n            return Array.from(Object.values(definedNameMap));\n        }\n        return [];\n    };\n\n    const [definedNames, setDefinedNames] = useState<IDefinedNamesServiceParam[]>(getDefinedNameMap());\n\n    useEffect(() => {\n        const definedNamesSubscription = definedNamesService.update$.subscribe(() => {\n            setDefinedNames(getDefinedNameMap());\n        });\n\n        return () => {\n            definedNamesSubscription.unsubscribe();\n        };\n    }, []); // Empty dependency array means this effect runs once on mount and clean up on unmount\n\n    // When closing the panel, clear the react cache\n    useEffect(() => {\n        const d = sidebarService.sidebarOptions$.subscribe((info) => {\n            if (info.id === DEFINED_NAME_CONTAINER) {\n                if (!info.visible) {\n                    setTimeout(() => {\n                        sidebarService.sidebarOptions$.next({ visible: false });\n                    });\n                }\n            }\n        });\n        return () => {\n            d.unsubscribe();\n        };\n    }, []);\n\n    const openSlider = () => {\n        commandService.executeCommand(SidebarDefinedNameOperation.id, { value: 'open' });\n    };\n\n    const focusDefinedName = async (definedName: IDefinedNamesServiceParam) => {\n        // The worksheet may be hidden, so we need to show it first\n        const { formulaOrRefString, id } = definedName;\n        const worksheet = definedNamesService.getWorksheetByRef(unitId, formulaOrRefString);\n        if (!worksheet) {\n            return;\n        }\n\n        const isHidden = worksheet.isSheetHidden();\n        if (isHidden) {\n            await commandService.executeCommand(SetWorksheetShowCommand.id, { unitId, subUnitId: worksheet.getSheetId() });\n        }\n\n        definedNamesService.focusRange(unitId, id);\n    };\n\n    return (\n        <div className=\"univer-w-[300px]\">\n            <ul\n                className={`\n                  univer-m-0 univer-max-h-[360px] univer-list-none univer-overflow-y-auto univer-p-0\n                  univer-scrollbar-thin univer-scrollbar-track-transparent univer-scrollbar-thumb-gray-300\n                  univer-scrollbar-w-[4px]\n                `}\n            >\n                {definedNames.map((definedName, index) => {\n                    return (\n                        <li\n                            key={index}\n                            className={`\n                              univer-cursor-pointer univer-px-2 univer-transition-colors univer-duration-200\n                              dark:hover:univer-bg-gray-600\n                              hover:univer-bg-gray-100\n                            `}\n                            onClick={() => { focusDefinedName(definedName); }}\n                        >\n                            <div\n                                className={`\n                                  univer-flex univer-items-center univer-justify-between univer-gap-2 univer-border-0\n                                  univer-border-b univer-border-solid univer-border-gray-200 univer-py-1\n                                `}\n                            >\n                                <div\n                                    className={`\n                                      univer-w-[50%] univer-flex-shrink-0 univer-overflow-hidden univer-text-ellipsis\n                                      univer-whitespace-nowrap univer-text-sm univer-text-gray-600\n                                    `}\n                                    title={definedName.name}\n                                >\n                                    {definedName.name}\n                                </div>\n                                <div\n                                    className={`\n                                      univer-w-[50%] univer-flex-shrink-0 univer-overflow-hidden univer-text-ellipsis\n                                      univer-whitespace-nowrap univer-text-xs univer-text-gray-400\n                                    `}\n                                    title={definedName.formulaOrRefString}\n                                >\n                                    {definedName.formulaOrRefString}\n                                </div>\n                            </div>\n                        </li>\n                    );\n                })}\n            </ul>\n\n            <div\n                className={`\n                  univer-cursor-pointer univer-p-2 univer-transition-colors univer-duration-200\n                  dark:hover:univer-bg-gray-600\n                  hover:univer-bg-gray-100\n                `}\n                onClick={openSlider}\n            >\n                <div className=\"univer-mb-2 univer-text-sm univer-font-semibold univer-text-gray-600\">\n                    {localeService.t('definedName.managerTitle')}\n                </div>\n                <div className=\"univer-text-xs univer-text-gray-400\">\n                    {localeService.t('definedName.managerDescription')}\n                </div>\n            </div>\n        </div>\n    );\n}\n", "export default {\n  \"formulaBox\": \"univer-formula-box\",\n  \"nameRanges\": \"univer-name-ranges\",\n  \"formulaBar\": \"univer-formula-bar\",\n  \"formulaIcon\": \"univer-formula-icon\",\n  \"formulaIconDisable\": \"univer-formula-icon-disable\",\n  \"formulaIconWrapper\": \"univer-formula-icon-wrapper\",\n  \"iconContainer\": \"univer-icon-container\",\n  \"iconContainerSuccess\": \"univer-icon-container-success\",\n  \"formulaActive\": \"univer-formula-active\",\n  \"iconContainerError\": \"univer-icon-container-error\",\n  \"iconContainerFx\": \"univer-icon-container-fx\",\n  \"formulaInput\": \"univer-formula-input\",\n  \"formulaInputMask\": \"univer-formula-input-mask\",\n  \"formulaContainer\": \"univer-formula-container\",\n  \"sheetEmbeddingFormulaEditorWrap\": \"univer-sheet-embedding-formula-editor-wrap\",\n  \"formulaContent\": \"univer-formula-content\",\n  \"arrowContainer\": \"univer-arrow-container\",\n  \"arrowContainerDisable\": \"univer-arrow-container-disable\"\n};import \"ni:sha-256;bvXaNlZtN06t8JcN5T2Nm8fPGtQw7n_RvFN0SaMdBz8\";", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IScrollState } from './sheet-bar-tabs/utils/slide-tab-bar';\nimport { ICommandService, IPermissionService } from '@univerjs/core';\nimport { clsx } from '@univerjs/design';\nimport { IncreaseSingle, MoreSingle } from '@univerjs/icons';\nimport { InsertSheetCommand, WorkbookCreateSheetPermission, WorkbookEditablePermission } from '@univerjs/sheets';\n\nimport { useDependency, useObservable } from '@univerjs/ui';\nimport React, { useEffect, useState } from 'react';\nimport { useActiveWorkbook } from '../../components/hook';\nimport { ISheetBarService } from '../../services/sheet-bar/sheet-bar.service';\nimport styles from './index.module.less';\nimport { SheetBarButton } from './sheet-bar-button/SheetBarButton';\nimport { SheetBarMenu } from './sheet-bar-menu/SheetBarMenu';\nimport { SheetBarTabs } from './sheet-bar-tabs/SheetBarTabs';\n\nconst SCROLL_WIDTH = 100;\n\nexport const SheetBar = () => {\n    const [leftScrollState, setLeftScrollState] = useState(true);\n    const [rightScrollState, setRightScrollState] = useState(true);\n\n    const commandService = useDependency(ICommandService);\n    const sheetBarService = useDependency(ISheetBarService);\n    const permissionService = useDependency(IPermissionService);\n\n    const workbook = useActiveWorkbook()!;\n    const unitId = workbook.getUnitId();\n\n    const workbookEditablePermission = useObservable(permissionService.getPermissionPoint$(new WorkbookEditablePermission(unitId)?.id));\n    const workbookCreateSheetPermission = useObservable(permissionService.getPermissionPoint$(new WorkbookCreateSheetPermission(unitId)?.id));\n\n    useEffect(() => {\n        const subscription = sheetBarService.scroll$.subscribe((state: IScrollState) => {\n            updateScrollButtonState(state);\n        });\n\n        return () => {\n            subscription.unsubscribe();\n        };\n    }, []);\n\n    const updateScrollButtonState = (state: IScrollState) => {\n        const { leftEnd, rightEnd } = state;\n        setLeftScrollState(leftEnd);\n        setRightScrollState(rightEnd);\n    };\n\n    // Complete the _addSheet, handleScrollLeft, and handleScrollRight functions\n    const addSheet = () => {\n        commandService.executeCommand(InsertSheetCommand.id);\n        setTimeout(() => {\n            sheetBarService.setAddSheet(0);\n        }, 0);\n    };\n\n    const handleScrollLeft = () => {\n        sheetBarService.setScrollX(-SCROLL_WIDTH);\n    };\n\n    const handleScrollRight = () => {\n        sheetBarService.setScrollX(SCROLL_WIDTH);\n    };\n\n    return (\n        <div className={clsx(styles.sheetBar, 'univer-relative univer-flex univer-h-full univer-flex-1')}>\n            <div className={styles.sheetBarOptions}>\n                {/* Add sheet button */}\n                <SheetBarButton onClick={addSheet} disabled={!(workbookCreateSheetPermission?.value && workbookEditablePermission?.value)}>\n                    <IncreaseSingle />\n                </SheetBarButton>\n                {/* All sheets button */}\n                <SheetBarMenu />\n            </div>\n\n            {/* All sheets tabs */}\n            <SheetBarTabs />\n\n            {/* Scroll arrows */}\n            {(!leftScrollState || !rightScrollState) && (\n                <div\n                    className={`\n                      ${styles.sheetBarOptions}\n                      ${styles.sheetBarOptionsDivider}\n                    `}\n                >\n                    <SheetBarButton disabled={leftScrollState} onClick={handleScrollLeft}>\n                        <MoreSingle style={{ transform: 'rotateZ(180deg)' }} />\n                    </SheetBarButton>\n                    <SheetBarButton disabled={rightScrollState} onClick={handleScrollRight}>\n                        <MoreSingle />\n                    </SheetBarButton>\n                </div>\n            )}\n        </div>\n    );\n};\n", "export default {\n  \"sheetBar\": \"univer-sheet-bar\",\n  \"sheetBarOptions\": \"univer-sheet-bar-options\",\n  \"sheetBarOptionsDivider\": \"univer-sheet-bar-options-divider\"\n};import \"ni:sha-256;Rvrywh0_A-KL9McWrbCrTzpgZYq07J8_-ULZ7-mri8o\";", "export default {\n  \"sheetBarBtn\": \"univer-sheet-bar-btn\"\n};import \"ni:sha-256;8T6a1UwcM9Vdx0pVn3eH-PMp3Zup3Z9HPJ9C6ithPrg\";", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport styles from './index.module.less';\n\nexport interface IBaseSheetBarButtonProps {\n    children?: React.ReactNode;\n\n    /** Semantic DOM class */\n    className?: string;\n\n    /** Semantic DOM style */\n    style?: React.CSSProperties;\n\n    /**\n     * Disabled state of button\n     * @default false\n     */\n    disabled?: boolean;\n\n    /** Set the handler to handle `click` event */\n    onClick?: (event: React.MouseEvent<HTMLButtonElement>) => void;\n}\n\n/**\n * Button Component\n */\nexport function SheetBarButton(props: IBaseSheetBarButtonProps) {\n    const { children, className, style, disabled = false, onClick, ...restProps } = props;\n\n    const handleClick = (e: React.MouseEvent<HTMLButtonElement>) => {\n        if (disabled) {\n            e.preventDefault();\n            return;\n        }\n\n        onClick && onClick(e);\n    };\n\n    return (\n        <button\n            type=\"button\"\n            className={styles.sheetBarBtn}\n            style={style}\n            disabled={disabled}\n            onClick={handleClick}\n            {...restProps}\n        >\n            {children}\n        </button>\n    );\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommandInfo, Workbook } from '@univerjs/core';\nimport type { IDropdownProps } from '@univerjs/design';\nimport { BooleanNumber, DisposableCollection, ICommandService, IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport { clsx, DropdownMenu } from '@univerjs/design';\nimport { CheckMarkSingle, ConvertSingle, EyelashSingle } from '@univerjs/icons';\nimport {\n    InsertSheetMutation,\n    RemoveSheetMutation,\n    SetWorksheetActivateCommand,\n    SetWorksheetActiveOperation,\n    SetWorksheetHideMutation,\n    SetWorksheetNameMutation,\n    SetWorksheetOrderMutation,\n    SetWorksheetShowCommand,\n    WorksheetProtectionRuleModel,\n} from '@univerjs/sheets';\nimport { useDependency, useObservable } from '@univerjs/ui';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\n\nimport { ISheetBarService } from '../../../services/sheet-bar/sheet-bar.service';\nimport { SheetBarButton } from '../sheet-bar-button/SheetBarButton';\n\nexport interface ISheetBarMenuItem {\n    label?: React.ReactNode;\n    hidden?: boolean;\n    selected?: boolean;\n    index?: string;\n    sheetId?: string;\n}\n\nexport function SheetBarMenu() {\n    const [menu, setMenu] = useState<ISheetBarMenuItem[]>([]);\n    const [visible, setVisible] = useState(false);\n\n    const univerInstanceService = useDependency(IUniverInstanceService);\n    const commandService = useDependency(ICommandService);\n    const sheetBarService = useDependency(ISheetBarService);\n    const worksheetProtectionRuleModel = useDependency(WorksheetProtectionRuleModel);\n    const workbook = useObservable(() => univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET), null, false, []);\n\n    const handleClick = (item: ISheetBarMenuItem) => {\n        const { sheetId } = item;\n        if (!sheetId || !workbook) return;\n\n        if (item.hidden) {\n            commandService.executeCommand(SetWorksheetShowCommand.id, {\n                unitId: workbook.getUnitId(),\n                subUnitId: sheetId,\n                value: sheetId,\n            });\n        } else if (!item.selected) {\n            commandService.executeCommand(SetWorksheetActivateCommand.id, {\n                unitId: workbook.getUnitId(),\n                subUnitId: sheetId,\n            });\n        }\n\n        setVisible(false);\n    };\n\n    const statusInit = useCallback(() => {\n        if (!workbook) return;\n\n        const sheets = workbook.getSheets();\n        const activeSheet = workbook.getActiveSheet();\n        const worksheetMenuItems = sheets.map((sheet, index) => {\n            return {\n                label: sheet.getName(),\n                index: `${index}`,\n                sheetId: sheet.getSheetId(),\n                hidden: sheet.isSheetHidden() === BooleanNumber.TRUE,\n                selected: activeSheet === sheet,\n            };\n        });\n\n        setMenu(worksheetMenuItems);\n    }, [workbook, worksheetProtectionRuleModel]);\n\n    const setupStatusUpdate = useCallback(() =>\n        commandService.onCommandExecuted((commandInfo: ICommandInfo) => {\n            switch (commandInfo.id) {\n                case SetWorksheetHideMutation.id:\n                case RemoveSheetMutation.id:\n                case SetWorksheetNameMutation.id:\n                case InsertSheetMutation.id:\n                case SetWorksheetOrderMutation.id:\n                case SetWorksheetActiveOperation.id:\n                    statusInit();\n                    break;\n                default:\n                    break;\n            }\n        }), [commandService, statusInit]);\n\n    function handleSheetBarMenu() {\n        setVisible(true);\n    }\n\n    const onVisibleChange = (visible: boolean) => {\n        setVisible(visible);\n    };\n\n    useEffect(() => {\n        statusInit();\n\n        const disposables = new DisposableCollection();\n        disposables.add(setupStatusUpdate());\n        disposables.add(sheetBarService.registerSheetBarMenuHandler({ handleSheetBarMenu }));\n\n        return () => disposables.dispose();\n    }, [setupStatusUpdate, sheetBarService, statusInit, workbook]);\n\n    const items: IDropdownProps['items'] = useMemo(() => menu.map((item) => ({\n        type: 'item',\n        children: (\n            <div className=\"univer-relative univer-box-border univer-pl-6\">\n                {(item.selected || item.hidden) && (\n                    <span className=\"univer-absolute univer-left-1 univer-top-0.5\">\n                        {item.selected && <CheckMarkSingle className=\"univer-size-4 univer-text-primary-600\" />}\n                        {item.hidden && <EyelashSingle className=\"univer-size-4 univer-text-gray-400\" />}\n                    </span>\n                )}\n\n                <span\n                    className={clsx({\n                        'univer-text-primary-600': item.selected,\n                    })}\n                >\n                    {item.label}\n                </span>\n            </div>\n        ),\n        onSelect: () => {\n            handleClick(item);\n        },\n    })), [menu]);\n\n    return (\n        <DropdownMenu\n            align=\"start\"\n            items={items}\n            open={visible}\n            onOpenChange={onVisibleChange}\n        >\n            <div>\n                <SheetBarButton>\n                    <ConvertSingle />\n                </SheetBarButton>\n            </div>\n        </DropdownMenu>\n    );\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommandInfo } from '@univerjs/core';\nimport type { IUniverUIConfig } from '@univerjs/ui';\nimport type { IBaseSheetBarProps } from './SheetBarItem';\nimport type { IScrollState } from './utils/slide-tab-bar';\nimport { ICommandService, IConfigService, IPermissionService, LocaleService, nameCharacterCheck, Quantity } from '@univerjs/core';\nimport { DropdownLegacy } from '@univerjs/design';\nimport { LockSingle } from '@univerjs/icons';\n\nimport {\n    InsertSheetMutation,\n    RangeProtectionRuleModel,\n    RemoveSheetMutation,\n    SetTabColorMutation,\n    SetWorksheetActiveOperation,\n    SetWorksheetHideMutation,\n    SetWorksheetNameCommand,\n    SetWorksheetNameMutation,\n    SetWorksheetOrderCommand,\n    SetWorksheetOrderMutation,\n    WorkbookManageCollaboratorPermission,\n    WorkbookRenameSheetPermission,\n    WorksheetProtectionRuleModel,\n} from '@univerjs/sheets';\nimport { ContextMenuPosition, IConfirmService, UI_PLUGIN_CONFIG_KEY, UIMenu, useDependency, useObservable } from '@univerjs/ui';\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { merge } from 'rxjs';\nimport { useActiveWorkbook } from '../../../components/hook';\nimport { IEditorBridgeService } from '../../../services/editor-bridge.service';\nimport { ISheetBarService } from '../../../services/sheet-bar/sheet-bar.service';\nimport styles from './index.module.less';\nimport { SheetBarItem } from './SheetBarItem';\nimport { SlideTabBar } from './utils/slide-tab-bar';\n\nexport function SheetBarTabs() {\n    const [sheetList, setSheetList] = useState<IBaseSheetBarProps[]>([]);\n    const [activeKey, setActiveKey] = useState('');\n    const [boxShadow, setBoxShadow] = useState('');\n    const [visible, setVisible] = useState(false);\n    const [offset, setOffset] = useState([0, 0]);\n    const slideTabBarRef = useRef<{ slideTabBar: SlideTabBar | null }>({ slideTabBar: null });\n    const slideTabBarContainerRef = useRef<HTMLDivElement>(null);\n\n    const commandService = useDependency(ICommandService);\n    const sheetBarService = useDependency(ISheetBarService);\n    const localeService = useDependency(LocaleService);\n    const confirmService = useDependency(IConfirmService);\n    const configService = useDependency(IConfigService);\n    const editorBridgeService = useDependency(IEditorBridgeService, Quantity.OPTIONAL);\n    const worksheetProtectionRuleModel = useDependency(WorksheetProtectionRuleModel);\n    const rangeProtectionRuleModel = useDependency(RangeProtectionRuleModel);\n    const resetOrder = useObservable(worksheetProtectionRuleModel.resetOrder$);\n\n    const workbook = useActiveWorkbook()!;\n    const permissionService = useDependency(IPermissionService);\n\n    const updateSheetItems = useCallback(() => {\n        const currentSubUnitId = workbook.getActiveSheet()?.getSheetId() || '';\n        setActiveKey(currentSubUnitId);\n\n        const sheets = workbook.getSheets();\n        const activeSheet = workbook.getActiveSheet();\n        const sheetListItems = sheets\n            .filter((sheet) => !sheet.isSheetHidden())\n            .map((sheet, index) => {\n                const worksheetRule = worksheetProtectionRuleModel.getRule(workbook.getUnitId(), sheet.getSheetId());\n                const hasSelectionRule = rangeProtectionRuleModel.getSubunitRuleList(workbook.getUnitId(), sheet.getSheetId()).length > 0;\n                const hasProtect = worksheetRule?.permissionId || hasSelectionRule;\n                const name = hasProtect\n                    ? (\n                        <>\n                            <LockSingle />\n                            <span>{sheet.getName()}</span>\n                        </>\n                    )\n                    : <span>{sheet.getName()}</span>;\n\n                return {\n                    sheetId: sheet.getSheetId(),\n                    label: name,\n                    index,\n                    selected: activeSheet === sheet,\n                    color: sheet.getTabColor() ?? undefined,\n                };\n            });\n\n        setSheetList(sheetListItems);\n        setActiveKey(currentSubUnitId);\n    }, [rangeProtectionRuleModel, workbook, worksheetProtectionRuleModel]);\n\n    useEffect(() => {\n        updateSheetItems();\n        const { slideTabBar, disconnectResizeObserver } = setupSlideTabBarInit();\n        const disposable = setupStatusUpdate();\n        const subscribeList = [\n            setupSubscribeScroll(),\n            setupSubscribeScrollX(),\n            setupSubscribeRenameId(),\n            // When adding a sheet, it no longer slides, which has been uniformly handled in setupSlideTabBarUpdate\n        ];\n\n        return () => {\n            disposable.dispose();\n            slideTabBar.destroy();\n            subscribeList.forEach((subscribe) => subscribe.unsubscribe());\n            disconnectResizeObserver && disconnectResizeObserver();\n        };\n    }, [resetOrder, workbook]);\n\n    useEffect(() => {\n        if (sheetList.length > 0) {\n            setupSlideTabBarUpdate();\n        }\n    }, [sheetList]);\n\n    useEffect(() => {\n        const subscription = merge(\n            worksheetProtectionRuleModel.ruleChange$,\n            rangeProtectionRuleModel.ruleChange$\n        ).subscribe(() => {\n            updateSheetItems();\n        });\n\n        return () => {\n            subscription.unsubscribe();\n        };\n    }, [worksheetProtectionRuleModel, updateSheetItems]);\n\n    const setupSlideTabBarInit = () => {\n        const slideTabBar = new SlideTabBar({\n            slideTabBarClassName: styles.slideTabBar,\n            slideTabBarItemActiveClassName: styles.slideTabActive,\n            slideTabBarItemClassName: styles.slideTabItem,\n            slideTabBarSpanEditClassName: styles.slideTabDivEdit,\n            slideTabBarItemAutoSort: true,\n            slideTabBarContainer: slideTabBarContainerRef.current,\n            currentIndex: 0,\n            onChangeName: (subUnitId: string, worksheetName: string) => {\n                commandService.executeCommand(SetWorksheetNameCommand.id, {\n                    subUnitId,\n                    name: worksheetName,\n                });\n            },\n            onSlideEnd: async (event: Event, order: number) => {\n                const res = await commandService.executeCommand(SetWorksheetOrderCommand.id, { order });\n            },\n            onChangeTab: (event: MouseEvent, subUnitId: string) => {\n                // Do not use SetWorksheetActivateCommand, otherwise the sheet will not be switched before the menu pops up, resulting in incorrect menu position.\n                commandService\n                    .executeCommand(SetWorksheetActiveOperation.id, {\n                        subUnitId,\n                        unitId: workbook.getUnitId(),\n                    })\n                    .then(() => {\n                        // right click to show menu\n                        if (event.button === 2) {\n                            onVisibleChange(true);\n                        }\n                    });\n            },\n            onScroll: (state: IScrollState) => {\n                sheetBarService.setScroll(state);\n            },\n            onNameCheckAlert: (text: string) => {\n                return nameEmptyCheck(text) || sheetNameSpecCharCheck(text) || nameRepeatCheck(text);\n            },\n            onNameChangeCheck: () => {\n                const unitId = workbook.getUnitId();\n                const worksheet = workbook?.getActiveSheet();\n                if (!worksheet) {\n                    throw new Error('No active sheet found');\n                }\n\n                const subUnitId = worksheet.getSheetId();\n                const worksheetRule = worksheetProtectionRuleModel.getRule(unitId, subUnitId);\n                const selectionRule = rangeProtectionRuleModel.getSubunitRuleList(unitId, subUnitId).length > 0;\n                if (worksheetRule || selectionRule) {\n                    return permissionService.getPermissionPoint(new WorkbookManageCollaboratorPermission(unitId).id)?.value ?? false;\n                } else {\n                    return permissionService.getPermissionPoint(new WorkbookRenameSheetPermission(unitId).id)?.value ?? false;\n                }\n            },\n        });\n\n        slideTabBarRef.current.slideTabBar = slideTabBar;\n\n        // FIXME@Dushusir: First time asynchronous rendering will cause flickering problems\n        const disconnectResizeObserver = resizeInit(slideTabBar);\n\n        return { slideTabBar, disconnectResizeObserver };\n    };\n\n    const config = configService.getConfig<IUniverUIConfig>(UI_PLUGIN_CONFIG_KEY);\n    const showContextMenu = config?.contextMenu ?? true;\n\n    // TODO@Dushusir: the following callback functions should be wrapped by `useCallback`.\n\n    const nameEmptyCheck = (name: string) => {\n        if (name.trim() === '') {\n            const id = 'sheetNameEmptyAlert';\n            confirmService.open({\n                id,\n                title: { title: localeService.t('sheetConfig.sheetNameErrorTitle') },\n                children: { title: localeService.t('sheetConfig.sheetNameCannotIsEmptyError') },\n                cancelText: localeService.t('button.cancel'),\n                confirmText: localeService.t('button.confirm'),\n                onClose() {\n                    focusTabEditor();\n                    confirmService.close(id);\n                },\n                onConfirm() {\n                    focusTabEditor();\n                    confirmService.close(id);\n                },\n            });\n\n            return true;\n        }\n        return false;\n    };\n\n    const sheetNameSpecCharCheck = (name: string) => {\n        if (!nameCharacterCheck(name)) {\n            const id = 'sheetNameSpecCharAlert';\n            confirmService.open({\n                id,\n                title: { title: localeService.t('sheetConfig.sheetNameErrorTitle') },\n                children: { title: localeService.t('sheetConfig.sheetNameSpecCharError') },\n                cancelText: localeService.t('button.cancel'),\n                confirmText: localeService.t('button.confirm'),\n                onClose() {\n                    focusTabEditor();\n                    confirmService.close(id);\n                },\n                onConfirm() {\n                    focusTabEditor();\n                    confirmService.close(id);\n                },\n            });\n\n            return true;\n        }\n        return false;\n    };\n\n    const nameRepeatCheck = (name: string) => {\n        const worksheet = workbook.getActiveSheet();\n        const currenSheetName = worksheet?.getName();\n        // TODO@Dushusir: no need trigger save\n        if (currenSheetName === name) return false;\n\n        const checked = workbook.checkSheetName(name);\n\n        if (checked) {\n            const id = 'sheetNameRepeatAlert';\n            confirmService.open({\n                id,\n                title: { title: localeService.t('sheetConfig.sheetNameErrorTitle') },\n                children: { title: localeService.t('sheetConfig.sheetNameAlreadyExistsError') },\n                cancelText: localeService.t('button.cancel'),\n                confirmText: localeService.t('button.confirm'),\n                onClose() {\n                    confirmService.close(id);\n                    focusTabEditor();\n                },\n                onConfirm() {\n                    confirmService.close(id);\n                    focusTabEditor();\n                },\n            });\n        }\n\n        return checked;\n    };\n\n    const focusTabEditor = () => {\n        // FIXME@Dushusir: too strongly coupled\n        // selectionRenderService.endSelection();\n\n        // There is an asynchronous operation in endSelection, which will trigger blur immediately after focus, so it must be wrapped with setTimeout.\n        setTimeout(() => {\n            const activeSlideTab = slideTabBarRef.current.slideTabBar?.getActiveItem();\n            if (activeSlideTab) {\n                activeSlideTab.focus();\n                activeSlideTab.selectAll();\n            }\n        }, 0);\n    };\n\n    const setTabEditor = () => {\n        slideTabBarRef.current.slideTabBar?.getActiveItem()?.setEditor();\n    };\n\n    const setupSlideTabBarUpdate = () => {\n        const currentIndex = sheetList.findIndex((item) => item.selected);\n        slideTabBarRef.current.slideTabBar?.update(currentIndex);\n    };\n\n    const setupStatusUpdate = () =>\n        commandService.onCommandExecuted((commandInfo: ICommandInfo) => {\n            switch (commandInfo.id) {\n                case SetTabColorMutation.id:\n                case SetWorksheetHideMutation.id:\n                case RemoveSheetMutation.id:\n                case SetWorksheetNameMutation.id:\n                case InsertSheetMutation.id:\n                case SetWorksheetOrderMutation.id:\n                case SetWorksheetActiveOperation.id:\n                    updateSheetItems();\n                    break;\n                default:\n                    break;\n            }\n        });\n\n    const setupSubscribeScroll = () =>\n        sheetBarService.scroll$.subscribe((state: IScrollState) => {\n            updateScrollButtonState(state);\n        });\n\n    const setupSubscribeScrollX = () =>\n        sheetBarService.scrollX$.subscribe((x: number) => {\n            slideTabBarRef.current.slideTabBar?.flipPage(x);\n        });\n\n    const setupSubscribeRenameId = () =>\n        sheetBarService.renameId$.subscribe(() => {\n            setTabEditor();\n        });\n\n    const updateScrollButtonState = (state: IScrollState) => {\n        const { leftEnd, rightEnd } = state;\n        // box-shadow: inset 10px 0px 10px -10px rgba(0, 0, 0, 0.2), inset -10px 0px 10px -10px rgba(0, 0, 0, 0.2);\n        let boxShadow = '';\n        if (leftEnd && rightEnd) {\n            boxShadow = '';\n        } else if (leftEnd && !rightEnd) {\n            boxShadow = 'inset -10px 0px 10px -10px rgba(0, 0, 0, 0.2)';\n        } else if (!leftEnd && rightEnd) {\n            boxShadow = 'inset 10px 0px 10px -10px rgba(0, 0, 0, 0.2)';\n        } else if (!leftEnd && !rightEnd) {\n            boxShadow = 'inset 10px 0px 10px -10px rgba(0, 0, 0, 0.2), inset -10px 0px 10px -10px rgba(0, 0, 0, 0.2)';\n        }\n\n        setBoxShadow(boxShadow);\n    };\n\n    const buttonScroll = (slideTabBar: SlideTabBar) => {\n        // If the active sheet needs to display the statistics column, it will trigger a resize, which will cover the activeTabItem. You need to slide a little distance to display the active tab.\n        const scrollX = slideTabBar.calculateActiveTabItemScrollX();\n        if (scrollX) {\n            const scrollBar = slideTabBar.getScrollbar();\n            scrollBar.scrollX(scrollBar.getScrollX() + scrollX);\n        }\n\n        sheetBarService.setScroll({\n            leftEnd: slideTabBar.isLeftEnd(),\n            rightEnd: slideTabBar.isRightEnd(),\n        });\n    };\n\n    const resizeInit = (slideTabBar: SlideTabBar) => {\n        // Target element\n        const slideTabBarContainer = slideTabBarContainerRef.current?.querySelector(`.${styles.slideTabBar}`);\n        if (!slideTabBarContainer) return;\n\n        // Create a ResizeObserver\n        const observer = new ResizeObserver(() => {\n            buttonScroll(slideTabBar);\n        });\n\n        // Start the observer\n        observer.observe(slideTabBarContainer);\n\n        // Return the cleanup function that disconnects the observer\n        return () => observer.disconnect();\n    };\n\n    const onVisibleChange = (visible: boolean) => {\n        if (!showContextMenu) return;\n\n        if (editorBridgeService?.isForceKeepVisible()) {\n            return;\n        }\n\n        if (visible) {\n            const { left: containerLeft } = slideTabBarContainerRef.current?.getBoundingClientRect() ?? {};\n            // current active tab position\n            const { left: activeTabLeft } =\n                slideTabBarRef.current.slideTabBar?.getActiveItem()?.getSlideTabItem().getBoundingClientRect() ?? {};\n\n            if (containerLeft !== undefined && activeTabLeft !== undefined) {\n                setOffset([activeTabLeft - containerLeft, 0]);\n            }\n        }\n        setVisible(visible);\n    };\n\n    return (\n        <DropdownLegacy\n            className={styles.slideTabItemDropdown}\n            visible={visible}\n            align={{ offset }}\n            trigger={['contextMenu']}\n            overlay={(\n                <UIMenu\n                    menuType={ContextMenuPosition.FOOTER_TABS}\n                    onOptionSelect={(params) => {\n                        const { label: id, value, commandId } = params;\n                        commandService.executeCommand(commandId ?? id as string, { value, subUnitId: activeKey });\n                        setVisible(false);\n                    }}\n                />\n            )}\n            onVisibleChange={onVisibleChange}\n        >\n            <div\n                className={styles.slideTabBarContainer}\n                ref={slideTabBarContainerRef}\n                onDragStart={(e) => e.preventDefault()}\n                onContextMenu={(e) => e.preventDefault()}\n            >\n                <div className={styles.slideTabBar} style={{ boxShadow }}>\n                    {sheetList.map((item) => (\n                        <SheetBarItem {...item} key={item.sheetId} selected={activeKey === item.sheetId} />\n                    ))}\n                </div>\n            </div>\n        </DropdownLegacy>\n    );\n}\n", "export default {\n  \"slideTabBarContainer\": \"univer-slide-tab-bar-container\",\n  \"slideTabBar\": \"univer-slide-tab-bar\",\n  \"slideTabItem\": \"univer-slide-tab-item\",\n  \"slideTabActive\": \"univer-slide-tab-active\",\n  \"slideTabDiv\": \"univer-slide-tab-div\",\n  \"slideTabDivEdit\": \"univer-slide-tab-div-edit\",\n  \"slideTabItemDropdown\": \"univer-slide-tab-item-dropdown\"\n};import \"ni:sha-256;_76_ayHO7pg50Mqw-3QB2QOC01FlI1zQm-GaYnw2zGw\";", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { BooleanNumber } from '@univerjs/core';\nimport { ColorKit, ThemeService } from '@univerjs/core';\nimport { useDependency } from '@univerjs/ui';\nimport React, { useEffect, useState } from 'react';\n\nimport styles from './index.module.less';\n\nexport interface IBaseSheetBarProps {\n    label?: React.ReactNode;\n    children?: any[];\n    index?: number;\n    color?: string;\n    sheetId?: string;\n    style?: React.CSSProperties;\n    hidden?: BooleanNumber;\n    selected?: boolean;\n}\n\nexport function SheetBarItem(props: IBaseSheetBarProps) {\n    const { sheetId, label, color, selected } = props;\n\n    const [currentSelected, setCurrentSelected] = useState(selected);\n\n    const themeService = useDependency(ThemeService);\n\n    useEffect(() => {\n        // TODO: update too many times?\n        setCurrentSelected(selected);\n    }, [selected]);\n\n    const getTextColor = (color: string) => {\n        const theme = themeService.getCurrentTheme();\n        const darkTextColor = theme.textColor;\n        const lightTextColor = theme.colorWhite;\n        return new ColorKit(color).isDark() ? lightTextColor : darkTextColor;\n    };\n\n    return (\n        <div\n            key={sheetId}\n            data-id={sheetId}\n            className={currentSelected\n                ? `\n                  ${styles.slideTabActive}\n                  ${styles.slideTabItem}\n                `\n                : styles.slideTabItem}\n            style={{\n                backgroundColor: !currentSelected && color ? color : '',\n                color: !currentSelected && color ? getTextColor(color) : '',\n                boxShadow:\n                    currentSelected && color ? `0px 0px 8px rgba(0, 0, 0, 0.08), inset 0px -2px 0px 0px ${color}` : '',\n            }}\n        >\n            <div className={styles.slideTabDiv}>{label}</div>\n        </div>\n    );\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst Tween: Record<string, Function> = {\n    easeOutStrong(t: number, b: number, c: number, d: number): number {\n        return -c * ((t = t / d - 1) * t * t * t - 1) + b;\n    },\n    backOut(t: number, b: number, c: number, d: number, s: number): number {\n        if (typeof s === 'undefined') {\n            s = 0.7;\n        }\n        return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;\n    },\n};\n\nexport interface AnimateConfig {\n    loop: boolean;\n    begin: number;\n    end: number;\n    duration: number;\n    delay: number;\n    type: string;\n    receive: (v: number) => void;\n    success: (v: number) => void;\n    cancel: (v: number) => void;\n    complete: (v: number) => void;\n}\n\nconst CONFIG: AnimateConfig = {\n    loop: false,\n    begin: 0,\n    end: 0,\n    duration: 300,\n    delay: 0,\n    type: 'easeOutStrong',\n    receive(v) {\n        /*noop*/\n    },\n    success(v) {\n        /*noop*/\n    },\n    cancel(v) {\n        /*noop*/\n    },\n    complete(v) {\n        /*noop*/\n    },\n};\n\nexport enum AnimateStatus {\n    Request,\n    Cancel,\n}\n\nexport class Animate {\n    protected _config: AnimateConfig;\n\n    protected _status: AnimateStatus = AnimateStatus.Request;\n\n    protected _start: number = 0;\n\n    protected _handle: number = 0;\n\n    protected _delayHandle: NodeJS.Timeout | number | null = null;\n\n    constructor(config: Partial<AnimateConfig>) {\n        this._config = {\n            ...CONFIG,\n            ...config,\n        };\n        if (this._config.loop) {\n            this._config.complete = () => {\n                /*noop*/\n            };\n            this._config.success = () => {\n                this.request();\n            };\n        }\n    }\n\n    static success(...animates: Animate[]): Promise<void> {\n        let successNumber = 0;\n        return new Promise<void>((resolve) => {\n            for (let i = 0; i < animates.length; i++) {\n                const animate = animates[i];\n                const config = animate._config;\n                const success = config.success;\n                const loop = config.loop;\n                if (loop) {\n                    continue;\n                }\n                config.success = (v) => {\n                    successNumber++;\n                    if (success) {\n                        success.call(animate, v);\n                    }\n                    if (successNumber === animates.length) {\n                        resolve();\n                    }\n                };\n            }\n        });\n    }\n\n    request(): void {\n        if (this._config.delay === 0) {\n            this._status = AnimateStatus.Request;\n            this._start = Date.now();\n            this._fakeHandle();\n        } else {\n            this._delayHandle && clearTimeout(this._delayHandle);\n            this._delayHandle = setTimeout(() => {\n                this._status = AnimateStatus.Request;\n                this._start = Date.now();\n                this._fakeHandle();\n            }, this._config.delay);\n        }\n    }\n\n    cancel(): void {\n        this._status = AnimateStatus.Cancel;\n        this._delayHandle && clearTimeout(this._delayHandle);\n        cancelAnimationFrame(this._handle);\n    }\n\n    protected _fakeHandle(): void {\n        let times = Date.now() - this._start;\n        times = times >= this._config.duration ? this._config.duration : times;\n\n        const val = Tween[this._config.type](\n            times,\n            this._config.begin,\n            this._config.end - this._config.begin,\n            this._config.duration,\n            0.7\n        );\n        const fix = val.toFixed(2);\n\n        this._config.receive(fix);\n\n        if (this._status === AnimateStatus.Cancel) {\n            this._config.cancel(fix);\n            this._config.complete(fix);\n            return;\n        }\n\n        if (times === this._config.duration) {\n            this._config.success(fix);\n            this._config.complete(fix);\n            return;\n        }\n\n        this._handle = requestAnimationFrame(() => {\n            this._fakeHandle();\n        });\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Animate } from './animate';\n\nexport interface IScrollState {\n    leftEnd: boolean;\n    rightEnd: boolean;\n}\nexport interface SlideTabBarConfig {\n    slideTabBarClassName: string;\n    slideTabBarItemActiveClassName: string;\n    slideTabBarItemClassName: string;\n    slideTabBarSpanEditClassName: string;\n    slideTabBarContainer: HTMLDivElement | null;\n    slideTabBarItemAutoSort: boolean;\n    currentIndex: number;\n    onSlideEnd: (event: MouseEvent, compareIndex: number) => void;\n    onChangeName: (id: string, name: string) => void;\n    onChangeTab: (event: MouseEvent, id: string) => void;\n    onScroll: (state: IScrollState) => void;\n    onNameCheckAlert: (text: string) => boolean;\n    onNameChangeCheck: () => boolean;\n}\n\nexport interface SlideTabItemAnimate {\n    translateX: (x: number) => void;\n    cancel: () => void;\n}\n\nexport class SlideTabItem {\n    _slideTabItem: HTMLElement;\n\n    _animate: Animate | null;\n\n    _midline: number = 0;\n\n    _translateX: number;\n\n    _scrollbar: SlideScrollbar;\n\n    _slideTabBar: SlideTabBar;\n\n    _editMode: boolean;\n\n    _placeholder: HTMLElement | null;\n\n    constructor(slideTabItem: HTMLElement, slideTabBar: SlideTabBar) {\n        this._slideTabItem = slideTabItem;\n        this._animate = null;\n        this._translateX = 0;\n        this._editMode = false;\n        this._slideTabBar = slideTabBar;\n        this._placeholder = null;\n        this._scrollbar = slideTabBar.getScrollbar();\n        this.update();\n    }\n\n    static midline(item: SlideTabItem) {\n        return item.getBoundingRect().x + item.getBoundingRect().width / 2;\n    }\n\n    static leftLine(item: SlideTabItem) {\n        return item.getBoundingRect().x;\n    }\n\n    static rightLine(item: SlideTabItem) {\n        return item.getBoundingRect().x + item.getBoundingRect().width;\n    }\n\n    static make(nodeList: NodeList, slideTabBar: SlideTabBar): SlideTabItem[] {\n        const result: SlideTabItem[] = [];\n        nodeList.forEach((item) => result.push(new SlideTabItem(item as HTMLElement, slideTabBar)));\n        return result;\n    }\n\n    getSlideTabItem(): HTMLElement {\n        return this._slideTabItem;\n    }\n\n    getEditor() {\n        return this._slideTabItem.querySelector('span');\n    }\n\n    focus() {\n        this.getEditor()?.focus();\n    }\n\n    selectAll() {\n        const input = this.getEditor();\n        input && SlideTabBar.keepSelectAll(input);\n    }\n\n    isEditMode(): boolean {\n        return this._editMode;\n    }\n\n    classList(): DOMTokenList {\n        return this._slideTabItem.classList;\n    }\n\n    translateX(x: number) {\n        this._translateX = x;\n        this._slideTabItem.style.transform = `translateX(${x}px)`;\n        return this.getTranslateXDirection();\n    }\n\n    setEditor(callback?: (event: FocusEvent) => void): void {\n        if (!this._slideTabBar.getConfig().onNameChangeCheck()) {\n            return;\n        }\n        let compositionFlag = true;\n        if (this._editMode === false) {\n            const input = this._slideTabItem.querySelector('span');\n\n            const blurAction = (focusEvent: FocusEvent) => {\n                if (this.nameCheck()) return;\n\n                this._editMode = false;\n\n                if (input) {\n                    input.removeAttribute('contentEditable');\n                    input.removeEventListener('focusout', blurAction);\n                    input.removeEventListener('compositionstart', compositionstartAction);\n                    input.removeEventListener('compositionend', compositionendAction);\n                    input.removeEventListener('input', inputAction);\n                    input.removeEventListener('keydown', keydownAction);\n                    input.classList.remove(this._slideTabBar.getConfig().slideTabBarSpanEditClassName);\n                }\n\n                // Event must be removed before updateItems\n                this._slideTabBar.removeListener();\n                this._slideTabBar.updateItems();\n                if (this._slideTabBar.getConfig().onChangeName) {\n                    const text = input?.innerText || '';\n                    const id = this.getId();\n                    this._slideTabBar.getConfig().onChangeName(id, text);\n                }\n\n                if (callback) {\n                    callback(focusEvent);\n                }\n            };\n\n            let keydownAction = (e: KeyboardEvent) => {\n                if (!input) return;\n                e.stopPropagation();\n\n                if (e.key === 'Enter') {\n                    input.blur();\n                }\n            };\n\n            const compositionstartAction = (e: CompositionEvent) => {\n                compositionFlag = false;\n            };\n\n            const compositionendAction = (e: CompositionEvent) => {\n                compositionFlag = true;\n            };\n\n            const inputAction = (e: Event) => {\n                if (!input) return;\n                const maxLength = 31;\n\n                setTimeout(() => {\n                    if (compositionFlag) {\n                        const text = input.innerText;\n                        if (text.length > maxLength) {\n                            input.innerText = text.substring(0, maxLength);\n                            SlideTabBar.keepLastIndex(input);\n                        }\n                    }\n                }, 0);\n            };\n\n            if (input) {\n                input.setAttribute('contentEditable', 'true');\n                input.addEventListener('focusout', blurAction);\n                input.addEventListener('compositionstart', compositionstartAction);\n                input.addEventListener('compositionend', compositionendAction);\n                input.addEventListener('input', inputAction);\n                input.addEventListener('keydown', keydownAction);\n                input.classList.add(this._slideTabBar.getConfig().slideTabBarSpanEditClassName);\n                this._editMode = true;\n                SlideTabBar.keepSelectAll(input);\n            }\n        }\n    }\n\n    nameCheck() {\n        const input = this._slideTabItem.querySelector('span');\n        if (!input) return false;\n\n        const text = input.innerText;\n        const checkAlert = this._slideTabBar.getConfig().onNameCheckAlert(text);\n        return checkAlert;\n    }\n\n    animate(): SlideTabItemAnimate {\n        return {\n            translateX: (x: number) => {\n                if (this._translateX !== x) {\n                    if (this._animate) {\n                        this._animate.cancel();\n                        this._animate = null;\n                    }\n                    this._animate = new Animate({\n                        begin: this._translateX,\n                        end: x,\n                        receive: (val: number) => {\n                            this._slideTabItem.style.transform = `translateX(${val}px)`;\n                        },\n                    });\n                    this._translateX = x;\n                    this._animate.request();\n                }\n            },\n            cancel: () => {\n                if (this._animate) {\n                    this._animate.cancel();\n                    this._animate = null;\n                }\n            },\n        };\n    }\n\n    after(other: SlideTabItem) {\n        this._slideTabItem.after(other._slideTabItem || other);\n    }\n\n    update() {\n        this._midline = SlideTabItem.midline(this);\n    }\n\n    disableFixed() {\n        if (this._placeholder) {\n            const primeval = this._slideTabBar.primeval();\n\n            // change to set unset\n            this._slideTabItem.style.removeProperty('position');\n            this._slideTabItem.style.removeProperty('left');\n            this._slideTabItem.style.removeProperty('top');\n            this._slideTabItem.style.removeProperty('width');\n            this._slideTabItem.style.removeProperty('height');\n            this._slideTabItem.style.removeProperty('background');\n            this._slideTabItem.style.removeProperty('padding');\n            this._slideTabItem.style.removeProperty('box-sizing');\n            this._slideTabItem.style.removeProperty('font-size');\n            this._slideTabItem.style.removeProperty('font-family');\n            this._slideTabItem.style.removeProperty('font-weight');\n            this._slideTabItem.style.removeProperty('color');\n            this._slideTabItem.style.removeProperty('border-radius');\n\n            this._placeholder.after(this._slideTabItem);\n            primeval.removeChild(this._placeholder);\n            this._placeholder = null;\n        }\n    }\n\n    enableFixed() {\n        const placeholder = document.createElement('div');\n        const boundingRect = this.getBoundingRect();\n        const computedStyles = getComputedStyle(this._slideTabItem);\n        const innerSpan = this._slideTabItem.querySelector('span');\n\n        this._placeholder = placeholder;\n        this._placeholder.style.width = `${boundingRect.width}px`;\n        this._placeholder.style.height = `${boundingRect.height}px`;\n        this._placeholder.style.flexShrink = '0';\n        this._placeholder.style.margin = computedStyles.margin;\n\n        this._slideTabItem.style.background = computedStyles.background;\n        if (innerSpan) {\n            const innerPadding = getComputedStyle(innerSpan).padding;\n            this._slideTabItem.style.padding = innerPadding;\n        }\n        this._slideTabItem.style.boxSizing = computedStyles.boxSizing;\n        this._slideTabItem.style.fontSize = computedStyles.fontSize;\n        this._slideTabItem.style.fontFamily = computedStyles.fontFamily;\n        this._slideTabItem.style.fontWeight = computedStyles.fontWeight;\n        this._slideTabItem.style.color = computedStyles.color;\n        this._slideTabItem.style.borderRadius = computedStyles.borderRadius;\n\n        this._slideTabItem.style.left = `${boundingRect.x - this.getScrollbar().getScrollX()}px`;\n        this._slideTabItem.style.top = `${boundingRect.y}px`;\n        this._slideTabItem.style.width = `${boundingRect.width}px`;\n        this._slideTabItem.style.height = `${boundingRect.height}px`;\n        this._slideTabItem.style.position = 'fixed';\n\n        this._slideTabItem.after(placeholder);\n        document.body.appendChild(this._slideTabItem);\n    }\n\n    addEventListener<K extends keyof HTMLElementEventMap>(\n        type: K,\n        action: (this: HTMLElement, ev: HTMLElementEventMap[K]) => any,\n        options?: boolean | AddEventListenerOptions\n    ) {\n        this._slideTabItem.addEventListener(type, action, options);\n    }\n\n    removeEventListener<K extends keyof HTMLElementEventMap>(\n        type: K,\n        action: (this: HTMLElement, ev: HTMLElementEventMap[K]) => any,\n        options?: boolean | AddEventListenerOptions\n    ) {\n        this._slideTabItem.removeEventListener(type, action, options);\n    }\n\n    getScrollbar() {\n        return this._scrollbar;\n    }\n\n    getMidLine() {\n        return this._midline;\n    }\n\n    getBoundingRect() {\n        const boundingClientRect = this._slideTabItem.getBoundingClientRect();\n        boundingClientRect.x += this._scrollbar.getScrollX();\n        return boundingClientRect;\n    }\n\n    getWidth() {\n        return this.getBoundingRect().width;\n    }\n\n    getTranslateXDirection() {\n        const midline = SlideTabItem.midline(this);\n        return midline > this._midline ? 1 : midline < this._midline ? -1 : 0;\n    }\n\n    equals(other: SlideTabItem | null) {\n        return other && other._slideTabItem === this._slideTabItem;\n    }\n\n    getId(): string {\n        return this._slideTabItem.dataset.id || '';\n    }\n}\n\nexport class SlideScrollbar {\n    protected _slideTabBar: SlideTabBar;\n\n    protected _scrollX: number;\n\n    constructor(slideTabBar: SlideTabBar) {\n        const primeval = slideTabBar.primeval();\n        this._scrollX = primeval.scrollLeft;\n        this._slideTabBar = slideTabBar;\n    }\n\n    scrollX(x: number) {\n        const primeval = this._slideTabBar.primeval();\n        primeval.scrollLeft = x;\n        this._scrollX = primeval.scrollLeft;\n    }\n\n    scrollRight() {\n        const primeval = this._slideTabBar.primeval();\n        primeval.scrollLeft = primeval.scrollWidth;\n        this._scrollX = primeval.scrollLeft;\n    }\n\n    getScrollX(): number {\n        return this._scrollX;\n    }\n}\n\nexport class SlideTabBar {\n    /** Time in milliseconds to wait to raise long press events if button is still pressed */\n    static LongPressDelay = 500; // in milliseconds\n\n    /** Time in milliseconds with two consecutive clicks will be considered as a double click */\n    static DoubleClickDelay = 300; // in milliseconds\n\n    protected _activeTabItemIndex: number = 0;\n\n    protected _slideTabBar: HTMLElement;\n\n    protected _slideTabItems: SlideTabItem[] = [];\n\n    protected _config: SlideTabBarConfig;\n\n    protected _downActionX: number = 0;\n\n    protected _moveActionX: number = 0;\n\n    protected _compareIndex: number = 0;\n\n    protected _activeTabItem: SlideTabItem | null = null;\n\n    protected _moveAction: (e: MouseEvent) => void;\n\n    protected _upAction: (e: MouseEvent) => void;\n\n    protected _downAction: (e: MouseEvent) => void;\n\n    protected _wheelAction: (e: WheelEvent) => void;\n\n    protected _scrollIncremental: number = 0;\n\n    protected _compareDirection: number = 0;\n\n    protected _autoScrollTime: number | null = null;\n\n    protected _slideScrollbar: SlideScrollbar;\n\n    protected _longPressTimer: NodeJS.Timeout | number | null = null;\n\n    /**\n     * left border line\n     */\n    protected _leftBoundingLine: number = 0;\n\n    /**\n     * right border line\n     */\n    protected _rightBoundingLine: number = 0;\n\n    /**\n     * The distance required to move to the left border\n     */\n    protected _leftMoveX: number = 0;\n\n    /**\n     * The distance required to move to the right border\n     */\n    protected _rightMoveX: number = 0;\n\n    // eslint-disable-next-line max-lines-per-function\n    constructor(config: Partial<SlideTabBarConfig>) {\n        if (config.slideTabBarContainer == null) {\n            throw new Error('not found slide-tab-bar root element');\n        }\n\n        const slideTabBar = config.slideTabBarContainer.querySelector(\n            `.${config.slideTabBarClassName ?? 'slide-tab-bar'}`\n        );\n        if (slideTabBar == null) {\n            throw new Error('not found slide-tab-bar');\n        }\n\n        this._slideTabBar = slideTabBar as HTMLElement;\n        this._slideScrollbar = new SlideScrollbar(this);\n        this._config = config as SlideTabBarConfig;\n\n        this._initConfig();\n\n        let lastPageX = 0;\n        let lastPageY = 0;\n        let lastTime = 0;\n        // eslint-disable-next-line max-lines-per-function\n        this._downAction = (downEvent: MouseEvent) => {\n            // Waiting for the rename of the previous TAB\n            if (this._activeTabItem?.isEditMode()) {\n                return;\n            }\n\n            // Clear timer\n            if (this._longPressTimer) {\n                clearTimeout(this._longPressTimer);\n                this._longPressTimer = null;\n            }\n\n            const slideItemId = (downEvent.target as HTMLElement)\n                ?.closest(`.${config.slideTabBarItemClassName}`)\n                ?.getAttribute('data-id');\n            const slideItemIndex = this._slideTabItems.findIndex((item) => item.getId() === slideItemId);\n\n            if (slideItemId == null || slideItemIndex === -1) return;\n\n            // switch tab\n            if (this._activeTabItemIndex !== slideItemIndex) {\n                this._activeTabItem?.removeEventListener('pointermove', this._moveAction);\n                this._activeTabItem?.removeEventListener('pointerup', this._upAction);\n                this.removeListener();\n                this._config.onChangeTab(downEvent, slideItemId);\n                return;\n            }\n\n            this._compareIndex = slideItemIndex;\n            this._downActionX = downEvent.pageX;\n            this._moveActionX = 0;\n            this._scrollIncremental = 0;\n            this._activeTabItem = this._slideTabItems[slideItemIndex];\n            if (!this._activeTabItem) {\n                console.error('Not found active slide-tab-item in sheet bar');\n                return;\n            }\n\n            const activeSlideItemElement = this._activeTabItem.getSlideTabItem();\n            activeSlideItemElement?.setPointerCapture((downEvent as PointerEvent).pointerId);\n            this._activeTabItem?.addEventListener('pointerup', this._upAction);\n\n            const { x, width } = this._activeTabItem.getBoundingRect();\n            const { x: containerX, width: containerWidth } = this.getBoundingRect();\n            const scrollX = this._slideScrollbar.getScrollX();\n            this._leftBoundingLine = this._downActionX - (x - scrollX);\n            this._rightBoundingLine = x - scrollX + width - this._downActionX;\n            this._leftMoveX = x - containerX - scrollX;\n            this._rightMoveX = containerX + containerWidth - (x + width) + scrollX;\n\n            if (downEvent.button === 2 || this._hasEditItem()) {\n                return;\n            }\n\n            const { pageX, pageY } = downEvent;\n            const current = Date.now();\n            const diffTime = current - lastTime <= SlideTabBar.DoubleClickDelay;\n            const diffPageX = Math.abs(pageX - lastPageX) < 10;\n            const diffPageY = Math.abs(pageY - lastPageY) < 10;\n\n            // double click\n            if (diffTime && diffPageX && diffPageY) {\n                // user editor\n                this._activeTabItem.setEditor();\n            }\n\n            lastPageX = pageX;\n            lastPageY = pageY;\n            lastTime = current;\n\n            // Set a timer to delay dragging for 300 milliseconds\n            this._longPressTimer = setTimeout(() => {\n                if (!activeSlideItemElement || this._activeTabItem?.isEditMode()) return;\n\n                this._activeTabItem?.enableFixed();\n                this._startAutoScroll();\n                // Set the mouse cursor to drag\n                activeSlideItemElement.setPointerCapture((downEvent as PointerEvent).pointerId);\n                activeSlideItemElement.style.cursor = 'move';\n                this._activeTabItem?.addEventListener('pointermove', this._moveAction);\n            }, SlideTabBar.LongPressDelay);\n        };\n\n        this._upAction = (upEvent: MouseEvent) => {\n            if (this._activeTabItem?.isEditMode()) {\n                return;\n            }\n\n            // Clear timer\n            if (this._longPressTimer) {\n                clearTimeout(this._longPressTimer);\n                this._longPressTimer = null;\n            }\n\n            if (!this._activeTabItem) return;\n\n            // When blurring after editing the table name, _activeTabItemIndex and _compareIndex may not be equal, causing slideEnd to be triggered\n            const isFromScroll = this._autoScrollTime !== null;\n\n            this._closeAutoScroll();\n            this._activeTabItem.disableFixed();\n            // this._sortedItems();\n            this.updateItems();\n\n            // Restore the mouse cursor\n            const activeSlideItemElement = this._activeTabItem?.getSlideTabItem();\n            if (!activeSlideItemElement) return;\n\n            activeSlideItemElement.style.cursor = '';\n            activeSlideItemElement.releasePointerCapture((upEvent as PointerEvent).pointerId);\n\n            this._activeTabItem?.removeEventListener('pointermove', this._moveAction);\n            this._activeTabItem?.removeEventListener('pointerup', this._upAction);\n            if (this._config.onSlideEnd && this._activeTabItemIndex !== this._compareIndex && isFromScroll) {\n                this.removeListener();\n                this._config.onSlideEnd(upEvent, this._compareIndex || 0);\n            }\n\n            this._scrollIncremental = 0;\n            this._downActionX = 0;\n            this._moveActionX = 0;\n            this._compareIndex = 0;\n        };\n\n        this._moveAction = (moveEvent) => {\n            if (this._activeTabItem) {\n                this._moveActionX = moveEvent.pageX - this._downActionX;\n                if (this._moveActionX <= -this._leftMoveX) {\n                    this._moveActionX = -this._leftMoveX;\n                } else if (this._moveActionX >= this._rightMoveX) {\n                    this._moveActionX = this._rightMoveX;\n                }\n                this._scrollIncremental = 0;\n                this._scrollLeft(moveEvent);\n                this._scrollRight(moveEvent);\n            }\n        };\n\n        this._wheelAction = (wheelEvent: WheelEvent) => {\n            this.setScroll(wheelEvent.deltaY);\n        };\n\n        this.addListener();\n    }\n\n    static checkedSkipSlide(event: MouseEvent): boolean {\n        let parent: HTMLElement | null = event.target as HTMLElement;\n        while (parent != null && parent !== document.body) {\n            if (parent.getAttribute('data-slide-skip')) {\n                return true;\n            }\n            parent = parent.parentElement;\n        }\n        return false;\n    }\n\n    static keepLastIndex(inputHtml: HTMLElement) {\n        setTimeout(() => {\n            const range = window.getSelection();\n            if (range) {\n                range.selectAllChildren(inputHtml);\n                range.collapseToEnd();\n            }\n        });\n    }\n\n    static keepSelectAll(inputHtml: HTMLElement) {\n        setTimeout(() => {\n            const selection = window.getSelection();\n            if (!selection) return;\n\n            const range = document.createRange();\n            range.selectNodeContents(inputHtml);\n\n            selection.removeAllRanges();\n            selection.addRange(range);\n        });\n    }\n\n    /**\n     * The current instance is persistent, but some parameters need to be updated after refreshing\n     * @param currentIndex\n     */\n    update(currentIndex: number) {\n        this._config.currentIndex = currentIndex;\n        this._initConfig();\n        this.removeListener();\n        this.addListener();\n        this.scrollToItem(currentIndex);\n    }\n\n    primeval(): HTMLElement {\n        return this._slideTabBar;\n    }\n\n    updateItems(): void {\n        for (let i = 0; i < this._slideTabItems.length; i++) {\n            this._slideTabItems[i].animate().cancel();\n            this._slideTabItems[i].translateX(0);\n            this._slideTabItems[i].update();\n        }\n    }\n\n    getScrollbar(): SlideScrollbar {\n        return this._slideScrollbar;\n    }\n\n    getConfig(): SlideTabBarConfig {\n        return this._config;\n    }\n\n    getBoundingRect(): DOMRect {\n        return this._slideTabBar.getBoundingClientRect();\n    }\n\n    getSlideTabItems(): SlideTabItem[] {\n        return this._slideTabItems;\n    }\n\n    getActiveItem() {\n        return this._activeTabItem;\n    }\n\n    isLeftEnd(): boolean {\n        return this._slideTabBar.scrollLeft === 0;\n    }\n\n    isRightEnd(): boolean {\n        const parent = this._slideTabBar.parentElement;\n        if (!parent) return false;\n        return this._slideTabBar.scrollWidth - parent.clientWidth === this._slideTabBar.scrollLeft;\n    }\n\n    addListener() {\n        this._slideTabBar.addEventListener('wheel', this._wheelAction);\n        this._slideTabItems.forEach((item) => {\n            item.addEventListener('pointerdown', this._downAction);\n        });\n    }\n\n    removeListener(): void {\n        this._slideTabBar.removeEventListener('wheel', this._wheelAction);\n        this._slideTabItems.forEach((item) => {\n            item.removeEventListener('pointerdown', this._downAction);\n        });\n    }\n\n    setScroll(x: number) {\n        this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX() + x);\n        if (x > 0) {\n            const left = this.calculateLeftScrollX();\n            this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX() + left);\n        } else if (x < 0) {\n            const right = this.calculateRightScrollX();\n            this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX() + right);\n        }\n\n        this._config.onScroll({\n            leftEnd: this.isLeftEnd(),\n            rightEnd: this.isRightEnd(),\n        });\n    }\n\n    flipPage(x: number) {\n        if (x > 0) {\n            const left = this.calculateLeftScrollX(true);\n            this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX() + left);\n        } else if (x < 0) {\n            const right = this.calculateRightScrollX(true);\n            this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX() + right);\n        }\n\n        this._config.onScroll({\n            leftEnd: this.isLeftEnd(),\n            rightEnd: this.isRightEnd(),\n        });\n    }\n\n    scrollToItem(index?: number): void {\n        index = index ?? this._config.currentIndex;\n        // Check index validity\n        if (index < 0 || index >= this._slideTabItems.length) {\n            console.error('Index out of bounds');\n            return;\n        }\n\n        const right = this.calculateTabItemScrollX(index);\n        this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX() + right);\n\n        // Trigger a scroll event\n        this._config.onScroll({\n            leftEnd: this.isLeftEnd(),\n            rightEnd: this.isRightEnd(),\n        });\n    }\n\n    calculateLeftScrollX(shouldFlipPage?: boolean): number {\n        let scrollX = 0;\n        const padding = 4;\n        this._slideTabItems.some((item) => {\n            const containerRect = this._slideTabBar.getBoundingClientRect();\n            const containerPosition = containerRect.left + containerRect.width;\n            const itemReact = item.getSlideTabItem().getBoundingClientRect();\n            const itemLeft = itemReact.left;\n            const itemWidth = itemReact.width;\n            if (itemLeft < containerPosition && itemLeft + itemWidth + padding * 2 > containerPosition) {\n                scrollX = shouldFlipPage\n                    ? itemLeft - containerRect.left - padding\n                    : itemLeft + itemWidth - containerPosition + padding;\n\n                return true;\n            }\n            return false;\n        });\n\n        return scrollX;\n    }\n\n    calculateRightScrollX(shouldFlipPage?: boolean): number {\n        let scrollX = 0;\n        const padding = 4;\n        this._slideTabItems.some((item) => {\n            const containerRect = this._slideTabBar.getBoundingClientRect();\n            const containerPosition = containerRect.left;\n            const itemReact = item.getSlideTabItem().getBoundingClientRect();\n            const itemLeft = itemReact.left;\n            const itemWidth = itemReact.width;\n            if (itemLeft - padding * 2 < containerPosition && itemLeft + itemWidth > containerPosition) {\n                scrollX = shouldFlipPage\n                    ? itemLeft + itemWidth - containerRect.left - containerRect.width + padding\n                    : itemLeft - containerPosition - padding;\n\n                return true;\n            }\n            return false;\n        });\n\n        return scrollX;\n    }\n\n    calculateTabItemScrollX(index: number): number {\n        let scrollX = 0;\n        const padding = 4;\n\n        const containerRect = this._slideTabBar.getBoundingClientRect();\n        const containerLeftPosition = containerRect.left;\n        const containerRightPosition = containerRect.left + containerRect.width;\n\n        const itemReact = this._slideTabItems[index].getSlideTabItem().getBoundingClientRect();\n        const itemLeft = itemReact.left;\n        const itemWidth = itemReact.width;\n\n        // Left side or part of left side\n        if (itemLeft - padding * 2 < containerLeftPosition) {\n            scrollX = itemLeft - containerLeftPosition - padding;\n        }\n\n        // Right side or part of right side\n        if (itemLeft + itemWidth + padding * 2 > containerRightPosition) {\n            scrollX = itemLeft + itemWidth - containerRightPosition + padding;\n        }\n\n        return scrollX;\n    }\n\n    calculateActiveTabItemScrollX(): number {\n        let scrollX = 0;\n        const padding = 4;\n\n        const containerRect = this._slideTabBar.getBoundingClientRect();\n        const containerLeftPosition = containerRect.left;\n        const containerRightPosition = containerRect.left + containerRect.width;\n\n        const itemReact = this._activeTabItem?.getSlideTabItem().getBoundingClientRect();\n        if (!itemReact) return 0;\n\n        const itemLeft = itemReact.left;\n        const itemWidth = itemReact.width;\n\n        // Part of left side\n        if (itemLeft - padding * 2 < containerLeftPosition && itemLeft + itemWidth > containerLeftPosition) {\n            scrollX = itemLeft - containerLeftPosition - padding;\n        }\n\n        // Part of right side\n        if (itemLeft < containerRightPosition && itemLeft + itemWidth + padding * 2 > containerRightPosition) {\n            scrollX = itemLeft + itemWidth - containerRightPosition + padding;\n        }\n\n        return scrollX;\n    }\n\n    destroy() {\n        this.removeListener();\n\n        this._downActionX = 0;\n        this._moveActionX = 0;\n        this._compareDirection = 0;\n        this._compareIndex = 0;\n        this._slideTabItems = [];\n        this._activeTabItem = null;\n\n        // TODO@Dushusir: If set to null, the types in other places need to be judged\n        // this._slideTabBar = null;\n        // this._slideScrollbar = null;\n        // this._config = null;\n        // this._downAction = null;\n        // this._upAction = null;\n        // this._moveAction = null;\n        // this._wheelAction = null;\n    }\n\n    protected _hasEditItem(): boolean {\n        for (let index = 0; index < this._slideTabItems.length; index++) {\n            const element = this._slideTabItems[index];\n            if (element.isEditMode()) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    protected _autoScrollFrame(): void {\n        if (this._activeTabItem) {\n            this._compareDirection = this._activeTabItem.translateX(this._moveActionX);\n            switch (this._compareDirection) {\n                case 1: {\n                    this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX() + this._scrollIncremental);\n                    this._compareRight();\n                    break;\n                }\n                case 0: {\n                    this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX() + this._scrollIncremental);\n                    this._compareIndex = this._activeTabItemIndex;\n                    break;\n                }\n                case -1: {\n                    this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX() + this._scrollIncremental);\n                    this._compareLeft();\n                    break;\n                }\n            }\n        }\n        this._autoScrollTime = requestAnimationFrame(() => {\n            this._autoScrollFrame();\n        });\n    }\n\n    protected _startAutoScroll(): void {\n        if (this._autoScrollTime == null) {\n            this._autoScrollFrame();\n        }\n    }\n\n    protected _closeAutoScroll(): void {\n        if (this._autoScrollTime) {\n            cancelAnimationFrame(this._autoScrollTime);\n        }\n        this._autoScrollTime = null;\n    }\n\n    protected _scrollLeft(event: MouseEvent): void {\n        const boundingRect = this.getBoundingRect();\n        const x = event.pageX - boundingRect.x;\n        if (x < this._leftBoundingLine) {\n            this._scrollIncremental = -Math.min(Math.abs(x - this._leftBoundingLine) * 0.1, 50);\n        }\n    }\n\n    protected _scrollRight(event: MouseEvent): void {\n        const boundingRect = this.getBoundingRect();\n        const x = event.pageX - boundingRect.x;\n        if (x > boundingRect.width - this._rightBoundingLine) {\n            this._scrollIncremental = Math.min(Math.abs(x - (boundingRect.width - this._rightBoundingLine)) * 0.1, 50);\n        }\n    }\n\n    protected _sortedItems(): void {\n        if (this._activeTabItem != null && this._activeTabItemIndex != null && this._compareIndex != null) {\n            // data array list sort\n            this._slideTabItems.splice(this._activeTabItemIndex, 1);\n            this._slideTabItems.splice(this._compareIndex, 0, this._activeTabItem);\n\n            // dom list sort\n            if (this._config.slideTabBarItemAutoSort) {\n                for (let i = 0; i < this._slideTabItems.length; i++) {\n                    const item = this._slideTabItems[i];\n                    const next = this._slideTabItems[i + 1];\n                    if (next) {\n                        item.after(next);\n                    }\n                }\n            }\n        }\n    }\n\n    protected _compareLeft(): void {\n        if (this._activeTabItem && this._activeTabItemIndex) {\n            const splice = this._slideTabItems.findIndex((item) => item.equals(this._activeTabItem));\n            const length = this._slideTabItems.length;\n            const collect = [];\n\n            // collect compare item\n            for (let i = 0; i < splice; i++) {\n                if (i >= splice) {\n                    break;\n                }\n                collect.push(this._slideTabItems[i]);\n            }\n\n            // reset right\n            for (let i = splice + 1; i < length; i++) {\n                this._slideTabItems[i].animate().translateX(0);\n            }\n\n            // diff item midline\n            let notFound = true;\n            for (let i = collect.length - 1; i >= 0; i--) {\n                const item = collect[i];\n                // Left side border reaches the midline\n                if (SlideTabItem.leftLine(this._activeTabItem) < item.getMidLine()) {\n                    item.animate().translateX(this._activeTabItem.getWidth());\n                    this._compareIndex = i;\n                    notFound = false;\n                } else {\n                    item.animate().translateX(0);\n                    if (notFound) {\n                        this._compareIndex = this._activeTabItemIndex;\n                    }\n                }\n            }\n        }\n    }\n\n    protected _compareRight(): void {\n        if (this._activeTabItem) {\n            const splice = this._slideTabItems.findIndex((item) => item.equals(this._activeTabItem));\n            const length = this._slideTabItems.length;\n            const collect = [];\n\n            // collect compare item\n            for (let i = splice + 1; i < length; i++) {\n                collect.push(this._slideTabItems[i]);\n            }\n\n            // reset left\n            for (let i = 0; i < splice; i++) {\n                this._slideTabItems[i].animate().translateX(0);\n            }\n\n            // diff item midline\n            let notFound = true;\n            for (let i = 0; i < collect.length; i++) {\n                const item = collect[i];\n                // Right side border reaches the midline\n                if (SlideTabItem.rightLine(this._activeTabItem) > item.getMidLine()) {\n                    item.animate().translateX(-this._activeTabItem.getWidth());\n                    this._compareIndex = splice + i + 1;\n                    notFound = false;\n                } else {\n                    item.animate().translateX(0);\n                    if (notFound) {\n                        this._compareIndex = this._activeTabItemIndex;\n                    }\n                }\n            }\n        }\n    }\n\n    protected _initConfig(): void {\n        const slideTabItems = this._slideTabBar.querySelectorAll(\n            `.${this._config.slideTabBarItemClassName ?? 'slide-tab-item'}`\n        );\n\n        this._downActionX = 0;\n        this._moveActionX = 0;\n        this._compareDirection = 0;\n        this._compareIndex = 0;\n\n        this._slideTabItems = SlideTabItem.make(slideTabItems, this);\n        this._activeTabItemIndex = this._config.currentIndex;\n        this._activeTabItem = this._slideTabItems[this._activeTabItemIndex];\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Nullable } from '@univerjs/core';\nimport type { IUniverSheetsUIConfig } from '../../controllers/config.schema';\nimport type { IStatusBarServiceStatus, StatusBarService } from '../../services/status-bar.service';\nimport type { IStatisticItem } from './CopyableStatisticItem';\nimport { debounce, IConfigService } from '@univerjs/core';\nimport { clsx } from '@univerjs/design';\nimport { useDependency } from '@univerjs/ui';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { SHEETS_UI_PLUGIN_CONFIG_KEY } from '../../controllers/config.schema';\nimport { IStatusBarService } from '../../services/status-bar.service';\nimport { CopyableStatisticItem } from './CopyableStatisticItem';\nimport styles from './index.module.less';\n\nconst SINGLE_MODE_WIDTH = 800;\nconst ROW_COUNT_THRESHOLD = 3;\n\nexport const StatusBar = () => {\n    const configService = useDependency(IConfigService);\n    const showStatistic = configService.getConfig<IUniverSheetsUIConfig>(SHEETS_UI_PLUGIN_CONFIG_KEY)?.statusBarStatistic ?? true;\n\n    const [isSingle, setIsSingle] = useState(window.innerWidth < SINGLE_MODE_WIDTH);\n\n    const statusBarService = useDependency(IStatusBarService);\n    // items is six functions: MAX MIN ALL ...\n    const items = statusBarService.getFunctions().map((item, index) => ({\n        name: item.func,\n        value: 0,\n        show: true,\n        disable: false,\n        pattern: null,\n    }));\n\n    const useStatistics = (\n        initialItems: IStatisticItem[],\n        statusBarService: StatusBarService,\n        isSingle: boolean,\n        showStatistic: boolean\n    ) => {\n        const [statistics, setStatistics] = useState<IStatisticItem[]>(initialItems);\n        const [show, setShow] = useState(true);\n\n        const filteredStatistics = useMemo(() =>\n            statistics.filter((item) => item.show && !item.disable), [statistics]);\n\n        const firstItem = useMemo(() =>\n            filteredStatistics.find((item) => item.show && !item.disable), [filteredStatistics]);\n\n        const showList = useMemo(() =>\n            isSingle && firstItem ? [firstItem] : filteredStatistics, [isSingle, firstItem, filteredStatistics]);\n\n        const updateStatistics = useCallback((state: Nullable<IStatusBarServiceStatus>) => {\n            const items = state?.values;\n            if (!items?.length) {\n                setShow(false);\n                return;\n            }\n\n            setShow(true);\n            setStatistics((prevStats) =>\n                prevStats.map((stat) => ({\n                    ...stat,\n                    value: items.find((i) => i.func === stat.name)?.value ?? stat.value,\n                    disable: !items.some((i) => i.func === stat.name),\n                    pattern: state?.pattern ?? null,\n                }))\n            );\n        }, []);\n\n        useEffect(() => {\n            if (!showStatistic) return;\n\n            const subscription = statusBarService.state$.subscribe(updateStatistics);\n\n            return () => subscription.unsubscribe();\n        }, [showStatistic, statusBarService, updateStatistics]);\n\n        return {\n            statistics,\n            showList,\n            show,\n        };\n    };\n\n    const { showList, show } = useStatistics(\n        items,\n        statusBarService,\n        isSingle,\n        showStatistic\n    );\n    const handleResize = debounce(() => {\n        const newSingleState = window.innerWidth < SINGLE_MODE_WIDTH;\n        if (isSingle !== newSingleState) {\n            setIsSingle(newSingleState);\n        }\n    }, 100);\n\n    useEffect(() => {\n        window.addEventListener('resize', handleResize);\n\n        return () => {\n            window.removeEventListener('resize', handleResize);\n        };\n    }, [isSingle]);\n\n    const useStatisticLayout = (\n        showList: IStatisticItem[],\n        rowCountThreshold: number,\n        CopyableStatisticItem: React.ComponentType<IStatisticItem>\n    ) => {\n        if (!showStatistic) return null;\n        const renderContent = React.useMemo(() => {\n            if (showList.length > rowCountThreshold) {\n                const doubleLineList = showList.reduce<IStatisticItem[][]>((acc, _, index) => {\n                    if (index % 2 === 0) {\n                        acc.push(showList.slice(index, index + 2));\n                    }\n                    return acc;\n                }, []);\n\n                return (\n                    <>\n                        {doubleLineList.map((item, index) => (\n                            <div\n                                key={`stat-col-${index}`}\n                                className={styles.statisticListColumn}\n                            >\n                                {item[0] && (\n                                    <CopyableStatisticItem\n                                        key={item[0].name}\n                                        {...item[0]}\n                                    />\n                                )}\n                                {item[1] && (\n                                    <CopyableStatisticItem\n                                        key={item[1].name}\n                                        {...item[1]}\n                                    />\n                                )}\n                            </div>\n                        ))}\n                    </>\n                );\n            }\n\n            return (\n                <>\n                    {showList.map((item) => (\n                        <CopyableStatisticItem\n                            key={item.name}\n                            {...item}\n                        />\n                    ))}\n                </>\n            );\n        }, [showList, rowCountThreshold, CopyableStatisticItem]);\n\n        return renderContent;\n    };\n\n    const renderContent = useStatisticLayout(showList, ROW_COUNT_THRESHOLD, CopyableStatisticItem);\n\n    return (\n        show && (\n            <div\n                className={clsx(styles.statusBar, {\n                    [styles.singleMode]: isSingle,\n                })}\n            >\n                <div className=\"univer-flex\">{renderContent}</div>\n                <div className={styles.statusBarDiv} />\n            </div>\n        )\n    );\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IDisposable, Nullable } from '@univerjs/core';\nimport type { IFunctionNames } from '@univerjs/engine-formula';\nimport { FUNCTION_NAMES_MATH, FUNCTION_NAMES_STATISTICAL } from '@univerjs/engine-formula';\nimport { createIdentifier } from '@univerjs/core';\nimport type { Observable } from 'rxjs';\nimport { BehaviorSubject } from 'rxjs';\n\nexport interface IStatusBarService {\n    state$: Observable<Nullable<IStatusBarServiceStatus>>;\n    dispose(): void;\n    setState(param: IStatusBarServiceStatus | null): void;\n    getState(): Readonly<Nullable<IStatusBarServiceStatus>>;\n    getFunctions(): Readonly<IStatusBarFunction[]>;\n}\n\nexport interface IStatusBarServiceStatus {\n    values: Array<{\n        func: IFunctionNames;\n        value: number;\n    }>;\n    pattern: Nullable<string>;\n}\n\nexport interface IStatusBarFunction {\n    func: IFunctionNames;\n    filter?: (status: IStatusBarServiceStatus) => boolean;\n}\n\nexport class StatusBarService implements IStatusBarService, IDisposable {\n    private readonly _functions: IStatusBarFunction[] = [\n        {\n            func: FUNCTION_NAMES_STATISTICAL.MAX,\n            filter: (status: IStatusBarServiceStatus) =>\n                (status.values.find((item) => item.func === FUNCTION_NAMES_STATISTICAL.COUNTA)?.value ?? 0) > 1 &&\n                (status.values.find((item) => item.func === FUNCTION_NAMES_STATISTICAL.COUNT)?.value ?? 0) > 0,\n        },\n        {\n            func: FUNCTION_NAMES_STATISTICAL.MIN,\n            filter: (status: IStatusBarServiceStatus) =>\n                (status.values.find((item) => item.func === FUNCTION_NAMES_STATISTICAL.COUNTA)?.value ?? 0) > 1 &&\n                (status.values.find((item) => item.func === FUNCTION_NAMES_STATISTICAL.COUNT)?.value ?? 0) > 0,\n        },\n        {\n            func: FUNCTION_NAMES_MATH.SUM,\n            filter: (status: IStatusBarServiceStatus) =>\n                (status.values.find((item) => item.func === FUNCTION_NAMES_STATISTICAL.COUNTA)?.value ?? 0) > 1 &&\n                (status.values.find((item) => item.func === FUNCTION_NAMES_STATISTICAL.COUNT)?.value ?? 0) > 0,\n        },\n        {\n            func: FUNCTION_NAMES_STATISTICAL.COUNTA,\n            filter: (status: IStatusBarServiceStatus) =>\n                (status.values.find((item) => item.func === FUNCTION_NAMES_STATISTICAL.COUNTA)?.value ?? 0) > 1,\n        },\n        {\n            func: FUNCTION_NAMES_STATISTICAL.COUNT,\n            filter: (status: IStatusBarServiceStatus) =>\n                (status.values.find((item) => item.func === FUNCTION_NAMES_STATISTICAL.COUNTA)?.value ?? 0) > 1 &&\n                (status.values.find((item) => item.func === FUNCTION_NAMES_STATISTICAL.COUNT)?.value ?? 0) > 0,\n        },\n\n        {\n            func: FUNCTION_NAMES_STATISTICAL.AVERAGE,\n            filter: (status: IStatusBarServiceStatus) =>\n                (status.values.find((item) => item.func === FUNCTION_NAMES_STATISTICAL.COUNTA)?.value ?? 0) > 1 &&\n                (status.values.find((item) => item.func === FUNCTION_NAMES_STATISTICAL.COUNT)?.value ?? 0) > 0,\n        },\n    ];\n\n    private readonly _state$ = new BehaviorSubject<Nullable<IStatusBarServiceStatus>>(null);\n    readonly state$ = this._state$.asObservable();\n\n    dispose(): void {\n        this._state$.complete();\n    }\n\n    setState(param: IStatusBarServiceStatus | null) {\n        const newState: IStatusBarServiceStatus = {\n            values: [],\n            pattern: null,\n        };\n        // handle the filter.\n        param?.values.forEach((item) => {\n            const func = this._functions.find((func) => func.func === item.func);\n            if (func && (func.filter === undefined || func.filter(param))) {\n                newState.values.push(item);\n            }\n        });\n        newState.pattern = param?.pattern ?? null;\n        this._state$.next(newState);\n    }\n\n    getState(): Readonly<Nullable<IStatusBarServiceStatus>> {\n        return this._state$.getValue();\n    }\n\n    getFunctions(): Readonly<IStatusBarFunction[]> {\n        return this._functions;\n    }\n\n    addFunctions(functions: IStatusBarFunction[]) {\n        this._functions.push(...functions);\n    }\n}\n\nexport const IStatusBarService = createIdentifier<StatusBarService>('univer.sheet-status-bar.service');\n", "export default {\n  \"statusBar\": \"univer-status-bar\",\n  \"singleMode\": \"univer-single-mode\",\n  \"statusBarDiv\": \"univer-status-bar-div\",\n  \"statisticListColumn\": \"univer-statistic-list-column\",\n  \"statisticItem\": \"univer-statistic-item\",\n  \"statisticPicker\": \"univer-statistic-picker\",\n  \"statisticPickerItem\": \"univer-statistic-picker-item\",\n  \"statisticMore\": \"univer-statistic-more\"\n};import \"ni:sha-256;2CqjQsa_1geAwKfIRBN7hDzGvW-EEwdqofFZvSI4WRw\";", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IFunctionNames } from '@univerjs/engine-formula';\nimport { LocaleService, numfmt } from '@univerjs/core';\nimport { MessageType, Tooltip } from '@univerjs/design';\nimport { FUNCTION_NAMES_MATH, FUNCTION_NAMES_STATISTICAL, FUNCTION_NAMES_TEXT } from '@univerjs/engine-formula';\nimport { IClipboardInterfaceService, IMessageService, useDependency } from '@univerjs/ui';\nimport React from 'react';\n\nimport styles from './index.module.less';\n\nexport interface IStatisticItem {\n    name: IFunctionNames;\n    value: number;\n    show: boolean;\n    disable: boolean;\n    pattern: string | null;\n}\n\nconst allowPatternFunctions: IFunctionNames[] = [\n    FUNCTION_NAMES_MATH.SUM,\n    FUNCTION_NAMES_STATISTICAL.AVERAGE,\n    FUNCTION_NAMES_STATISTICAL.MIN,\n    FUNCTION_NAMES_STATISTICAL.MAX,\n];\n\nexport const functionDisplayNames: FunctionNameMap = {\n    [FUNCTION_NAMES_MATH.SUM]: 'statusbar.sum',\n    [FUNCTION_NAMES_STATISTICAL.AVERAGE]: 'statusbar.average',\n    [FUNCTION_NAMES_STATISTICAL.MIN]: 'statusbar.min',\n    [FUNCTION_NAMES_STATISTICAL.MAX]: 'statusbar.max',\n    [FUNCTION_NAMES_STATISTICAL.COUNT]: 'statusbar.count',\n    [FUNCTION_NAMES_STATISTICAL.COUNTA]: 'statusbar.countA',\n    [FUNCTION_NAMES_TEXT.CONCATENATE]: 'concatenate',\n};\ninterface FunctionNameMap {\n    [key: string]: string;\n}\n\nexport const CopyableStatisticItem: React.FC<IStatisticItem> = (item: IStatisticItem) => {\n    const localeService = useDependency(LocaleService);\n    const messageService = useDependency(IMessageService);\n    const clipboardService = useDependency(IClipboardInterfaceService);\n\n    const formateValue = formatNumber(item);\n\n    const copyToClipboard = async () => {\n        await clipboardService.writeText(item.value.toString());\n        messageService.show({\n            type: MessageType.Success,\n            content: localeService.t('statusbar.copied'),\n        });\n    };\n    return (\n        <Tooltip title={localeService.t('statusbar.clickToCopy')} placement=\"top\">\n            <div key={item.name} className={styles.statisticItem} onClick={copyToClipboard}>\n                <span>\n                    {`${localeService.t(\n                        functionDisplayNames?.[item.name as string] || (item.name as string)\n                    )}: ${formateValue}`}\n                </span>\n            </div>\n        </Tooltip>\n    );\n};\n\nexport function formatNumber(item: IStatisticItem) {\n    const { pattern, value: num } = item;\n    if (typeof num !== 'number') {\n        return 0;\n    }\n\n    if (num >= 1e8) {\n        return num.toExponential(2);\n    }\n\n    if (pattern && allowPatternFunctions.includes(item.name)) {\n        return numfmt.format(pattern, num, { throws: false });\n    }\n\n    return num.toLocaleString();\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IContextService } from '@univerjs/core';\nimport {\n    EDITOR_ACTIVATED,\n    FOCUSING_COMMON_DRAWINGS,\n    FOCUSING_EDITOR_INPUT_FORMULA,\n    FOCUSING_EDITOR_STANDALONE,\n    FOCUSING_FX_BAR_EDITOR,\n    FOCUSING_SHEET,\n    FOCUSING_UNIVER_EDITOR,\n} from '@univerjs/core';\n\nexport function whenSheetFocused(contextService: IContextService) {\n    return contextService.getContextValue(FOCUSING_SHEET);\n}\n\n/**\n * Requires the currently focused unit to be Workbook and the sheet editor is focused but not activated.\n * @param contextService\n * @returns If the sheet editor is focused but not activated.\n */\nexport function whenSheetEditorFocused(contextService: IContextService): boolean {\n    return (\n        contextService.getContextValue(FOCUSING_SHEET) &&\n        contextService.getContextValue(FOCUSING_UNIVER_EDITOR) &&\n        !contextService.getContextValue(EDITOR_ACTIVATED) &&\n        !contextService.getContextValue(FOCUSING_COMMON_DRAWINGS)\n    );\n}\n\nexport function whenSheetEditorFocusedAndFxNotFocused(contextService: IContextService): boolean {\n    return (\n        contextService.getContextValue(FOCUSING_SHEET) &&\n        contextService.getContextValue(FOCUSING_UNIVER_EDITOR) &&\n        !contextService.getContextValue(EDITOR_ACTIVATED) &&\n        !contextService.getContextValue(FOCUSING_FX_BAR_EDITOR) &&\n        !contextService.getContextValue(FOCUSING_COMMON_DRAWINGS)\n    );\n}\n\n/**\n * Requires the currently focused unit to be Workbook and the sheet editor is activated.\n * @param contextService\n * @returns If the sheet editor is activated.\n */\nexport function whenSheetEditorActivated(contextService: IContextService) {\n    return (\n        contextService.getContextValue(FOCUSING_SHEET) &&\n        contextService.getContextValue(FOCUSING_UNIVER_EDITOR) &&\n        contextService.getContextValue(EDITOR_ACTIVATED)\n    );\n}\n\nexport function whenEditorActivated(contextService: IContextService) {\n    return contextService.getContextValue(FOCUSING_UNIVER_EDITOR) && contextService.getContextValue(EDITOR_ACTIVATED);\n}\n\n/**\n * Requires the currently focused editor is a formula editor.\n * @param contextService\n * @returns If the formula editor is focused.\n */\nexport function whenFormulaEditorFocused(contextService: IContextService) {\n    return (\n        contextService.getContextValue(FOCUSING_FX_BAR_EDITOR) &&\n        contextService.getContextValue(FOCUSING_UNIVER_EDITOR)\n    );\n}\n\n/**\n * Requires the currently focused editor is a formula editor, and it is activated.\n * @param contextService\n * @returns If the formula editor is activated.\n */\nexport function whenFormulaEditorActivated(contextService: IContextService) {\n    return (\n        contextService.getContextValue(FOCUSING_SHEET) &&\n        contextService.getContextValue(EDITOR_ACTIVATED) &&\n        contextService.getContextValue(FOCUSING_EDITOR_INPUT_FORMULA) &&\n        contextService.getContextValue(FOCUSING_UNIVER_EDITOR)\n    );\n}\n\n/**\n * Requires the currently focused editor is not a formula editor, and it is activated.\n * @param contextService\n * @returns If the editor is activated and the editor is not the formula editor.\n */\nexport function whenEditorDidNotInputFormulaActivated(contextService: IContextService) {\n    return (\n        contextService.getContextValue(FOCUSING_SHEET) &&\n        contextService.getContextValue(FOCUSING_UNIVER_EDITOR) &&\n        contextService.getContextValue(EDITOR_ACTIVATED) &&\n        !contextService.getContextValue(FOCUSING_EDITOR_INPUT_FORMULA) &&\n        !contextService.getContextValue(FOCUSING_EDITOR_STANDALONE)\n    );\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Nullable, ObjectMatrix } from '@univerjs/core';\nimport type { IDiscreteRange } from '../../controllers/utils/range-tools';\n\nimport type { COPY_TYPE, ICellDataWithSpanInfo } from './type';\nimport { LRUMap, Tools } from '@univerjs/core';\n\nconst COPY_CONTENT_CACHE_LIMIT = 10;\nconst ID_LENGTH = 6;\n\nexport interface ICopyContentCacheData {\n    subUnitId: string;\n    unitId: string;\n    range: IDiscreteRange;\n    copyType: COPY_TYPE;\n    matrix: Nullable<ObjectMatrix<ICellDataWithSpanInfo>>;\n}\n\nexport function genId() {\n    return Tools.generateRandomId(ID_LENGTH);\n}\n\nexport function extractId(html: string) {\n    const match = html.match(/data-copy-id=\"([^\\s]+)\"/);\n\n    if (match && match[1]) {\n        return match[1];\n    }\n\n    return null;\n}\n\nexport class CopyContentCache {\n    private _cache = new LRUMap<string, ICopyContentCacheData>(COPY_CONTENT_CACHE_LIMIT);\n\n    set(id: string, clipboardData: ICopyContentCacheData) {\n        this._cache.set(id, clipboardData);\n    }\n\n    get(id: string) {\n        return this._cache.get(id);\n    }\n\n    del(id: string) {\n        this._cache.delete(id);\n    }\n\n    clear() {\n        this._cache.clear();\n    }\n\n    clearWithUnitId(unitId: string) {\n        this._cache.forEach((value, key) => {\n            if (value.unitId === unitId) {\n                this._cache.delete(key);\n            }\n        });\n    }\n}\n\nexport const copyContentCache = new CopyContentCache();\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ITextStyle } from '@univerjs/core';\nimport { BaselineOffset, BooleanNumber, ColorKit } from '@univerjs/core';\nimport { DEFAULT_BACKGROUND_COLOR_RGB, DEFAULT_BACKGROUND_COLOR_RGBA } from '@univerjs/ui';\n\nexport function extractNodeStyle(node: HTMLElement, predefinedStyles?: Record<string, string>): ITextStyle {\n    const styles = predefinedStyles ?? node.style;\n    const docStyles: ITextStyle = {};\n    const tagName = node.tagName.toLowerCase();\n\n    switch (tagName) {\n        case 'b':\n        case 'em':\n        case 'strong': {\n            docStyles.bl = BooleanNumber.TRUE;\n            break;\n        }\n\n        case 's': {\n            docStyles.st = {\n                s: BooleanNumber.TRUE,\n            };\n            break;\n        }\n\n        case 'u': {\n            docStyles.ul = {\n                s: BooleanNumber.TRUE,\n            };\n            break;\n        }\n\n        case 'i': {\n            docStyles.it = BooleanNumber.TRUE;\n            break;\n        }\n\n        case 'sub':\n        case 'sup': {\n            docStyles.va = tagName === 'sup' ? BaselineOffset.SUPERSCRIPT : BaselineOffset.SUBSCRIPT;\n            break;\n        }\n    }\n\n    parseStyleByProperty(styles, docStyles);\n    return docStyles;\n}\n\nfunction parseStyleByProperty(styles: CSSStyleDeclaration | Record<string, string>, docStyles: ITextStyle) {\n    if (styles instanceof CSSStyleDeclaration) {\n        for (let i = 0; i < styles.length; i++) {\n            const cssRule = styles[i];\n            const cssValue = styles.getPropertyValue(cssRule);\n            handleStyle(cssRule, cssValue, docStyles);\n        }\n    } else {\n        for (const cssRule in styles) {\n            const cssValue = styles[cssRule];\n            handleStyle(cssRule, cssValue, docStyles);\n        }\n    }\n}\n\n// eslint-disable-next-line complexity\nfunction handleStyle(cssRule: string, cssValue: string, docStyles: ITextStyle) {\n    switch (cssRule) {\n        case 'font-family':\n            docStyles.ff = cssValue;\n            break;\n        case 'font-size': {\n            const fontSize = Number.parseInt(cssValue);\n            if (!Number.isNaN(fontSize)) {\n                if (cssValue.endsWith('pt')) {\n                    docStyles.fs = fontSize;\n                } else if (cssValue.endsWith('px')) {\n                    docStyles.fs = fontSize * 0.75;\n                }\n            }\n            break;\n        }\n        case 'font-style':\n            if (cssValue === 'italic') {\n                docStyles.it = BooleanNumber.TRUE;\n            }\n            break;\n        case 'font-weight': {\n            const MIDDLE_FONT_WEIGHT = 400;\n            if (Number(cssValue) > MIDDLE_FONT_WEIGHT || cssValue === 'bold') {\n                docStyles.bl = BooleanNumber.TRUE;\n            }\n            break;\n        }\n        case 'text-decoration': {\n            if (/underline/.test(cssValue)) {\n                docStyles.ul = { s: BooleanNumber.TRUE };\n            } else if (/overline/.test(cssValue)) {\n                docStyles.ol = { s: BooleanNumber.TRUE };\n            } else if (/line-through/.test(cssValue)) {\n                docStyles.st = { s: BooleanNumber.TRUE };\n            }\n            break;\n        }\n        case 'color': {\n            try {\n                const color = new ColorKit(cssValue);\n\n                if (color.isValid) {\n                    docStyles.cl = {\n                        rgb: color.toRgbString(),\n                    };\n                }\n            // eslint-disable-next-line unused-imports/no-unused-vars\n            } catch (_e) {\n                // ignore\n            }\n            break;\n        }\n        case 'background-color': {\n            const color = new ColorKit(cssValue);\n            const bgColor = color.isValid ? color.toRgbString() : '';\n            if (bgColor !== DEFAULT_BACKGROUND_COLOR_RGB && bgColor !== DEFAULT_BACKGROUND_COLOR_RGBA) {\n                docStyles.bg = { rgb: bgColor };\n            }\n            break;\n        }\n        default:\n            break;\n    }\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IParagraph, IParagraphStyle, ITextRun, Nullable } from '@univerjs/core';\nimport type { ICellDataWithSpanInfo } from '../type';\nimport { DataStreamTreeTokenType, Tools } from '@univerjs/core';\nimport { ptToPixel } from '@univerjs/engine-render';\n\nexport default function parseToDom(rawHtml: string) {\n    const template = document.createElement('body');\n    template.innerHTML = rawHtml;\n    return template;\n}\n\n// TODO: @JOCS, Complete other missing attributes that exist in IParagraphStyle\nexport function getParagraphStyle(el: HTMLElement): Nullable<IParagraphStyle> {\n    const styles = el.style;\n\n    const paragraphStyle: IParagraphStyle = {};\n\n    for (let i = 0; i < styles.length; i++) {\n        const cssRule = styles[i];\n        const cssValue = styles.getPropertyValue(cssRule);\n\n        switch (cssRule) {\n            case 'margin-top': {\n                const marginTopValue = Number.parseInt(cssValue);\n                paragraphStyle.spaceAbove = { v: /pt/.test(cssValue) ? ptToPixel(marginTopValue) : marginTopValue };\n                break;\n            }\n\n            case 'margin-bottom': {\n                const marginBottomValue = Number.parseInt(cssValue);\n                paragraphStyle.spaceBelow = { v: /pt/.test(cssValue) ? ptToPixel(marginBottomValue) : marginBottomValue };\n\n                break;\n            }\n\n            case 'line-height': {\n                const lineHeightValue = Number.parseFloat(cssValue);\n                paragraphStyle.lineSpacing = lineHeightValue;\n\n                break;\n            }\n\n            default: {\n                // console.log(`Unhandled css rule ${cssRule} in getParagraphStyle`);\n                break;\n            }\n        }\n    }\n\n    return Object.getOwnPropertyNames(paragraphStyle).length ? paragraphStyle : null;\n}\n\nexport function generateParagraphs(dataStream: string, prevParagraph?: IParagraph): IParagraph[] {\n    const paragraphs: IParagraph[] = [];\n\n    for (let i = 0, len = dataStream.length; i < len; i++) {\n        const char = dataStream[i];\n\n        if (char !== DataStreamTreeTokenType.PARAGRAPH) {\n            continue;\n        }\n\n        paragraphs.push({\n            startIndex: i,\n        });\n    }\n\n    if (prevParagraph) {\n        for (const paragraph of paragraphs) {\n            if (prevParagraph.bullet) {\n                paragraph.bullet = Tools.deepClone(prevParagraph.bullet);\n            }\n\n            if (prevParagraph.paragraphStyle) {\n                paragraph.paragraphStyle = Tools.deepClone(prevParagraph.paragraphStyle);\n            }\n        }\n    }\n\n    return paragraphs;\n}\n\nexport function convertToCellStyle(cell: ICellDataWithSpanInfo, dataStream: string, textRuns: ITextRun[] | undefined) {\n    const dataStreamLength = dataStream.length;\n    const textRunsLength = textRuns?.length ?? 0;\n    const canConvertToCellStyle = textRunsLength === 1 && textRuns![0].st === 0 && textRuns![0].ed === dataStreamLength;\n\n    if (cell.p) {\n        if (canConvertToCellStyle && cell.p.body?.textRuns?.length) {\n            cell.p.body.textRuns = [];\n            return {\n                ...cell,\n                s: textRuns![0].ts,\n            };\n        } else {\n            return cell;\n        }\n    } else {\n        if (canConvertToCellStyle) {\n            return {\n                ...cell,\n                s: textRuns![0].ts,\n            };\n        } else {\n            return cell;\n        }\n    }\n\n    return cell;\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable complexity */\n\nimport type { ICustomRange, IDocumentBody, IDocumentData, ITextRun, ITextStyle, Nullable } from '@univerjs/core';\nimport type { SpreadsheetSkeleton } from '@univerjs/engine-render';\nimport type { ISheetSkeletonManagerParam } from '../../sheet-skeleton-manager.service';\n\nimport type {\n    ICellDataWithSpanInfo,\n    IClipboardPropertyItem,\n    IParsedCellValueByClipboard,\n    IUniverSheetCopyDataModel,\n} from '../type';\nimport type { IAfterProcessRule, IPastePlugin } from './paste-plugins/type';\nimport { CustomRangeType, DEFAULT_WORKSHEET_ROW_HEIGHT, generateRandomId, ObjectMatrix, skipParseTagNames } from '@univerjs/core';\nimport { handleStringToStyle, textTrim } from '@univerjs/ui';\nimport { extractNodeStyle } from './parse-node-style';\nimport parseToDom, { convertToCellStyle, generateParagraphs } from './utils';\n\nexport interface IStyleRule {\n    filter: string | string[] | ((node: HTMLElement) => boolean);\n    getStyle(node: HTMLElement): ITextStyle;\n}\n\nexport interface IParsedTablesInfo {\n    index: number;\n}\n\nconst sheetStyleRules: string[] =\n    [\n        // Rich Text Style Rules,\n        'color',\n        'background',\n        'font-size',\n        'text-align',\n        'vertical-align',\n        'font-weight',\n        'font-style',\n        'font-family',\n        'text-decoration',\n        'white-space',\n        'word-wrap',\n        // Border Style Rules,\n        'border-left',\n        'border-right',\n        'border-top',\n        'border-bottom',\n        // Custom Style Rules, '--' needs to be used as a prefix.\n        '--data-rotate',\n    ];\n\nfunction matchFilter(node: HTMLElement, filter: IStyleRule['filter']) {\n    const tagName = node.tagName.toLowerCase();\n\n    if (typeof filter === 'string') {\n        return tagName === filter;\n    }\n\n    if (Array.isArray(filter)) {\n        return filter.some((name) => name === tagName);\n    }\n\n    return filter(node);\n}\n\ninterface IHtmlToUSMServiceProps {\n    getCurrentSkeleton: () => Nullable<ISheetSkeletonManagerParam>;\n}\n\nexport class HtmlToUSMService {\n    private static _pluginList: IPastePlugin[] = [];\n\n    static use(plugin: IPastePlugin) {\n        if (this._pluginList.includes(plugin)) {\n            throw new Error(`Univer paste plugin ${plugin.name} already added`);\n        }\n\n        this._pluginList.push(plugin);\n    }\n\n    private _styleMap = new Map<string, CSSStyleDeclaration>();\n\n    private _styleCache: Map<ChildNode, ITextStyle> = new Map();\n\n    private _styleRules: IStyleRule[] = [];\n\n    private _afterProcessRules: IAfterProcessRule[] = [];\n\n    private _dom: HTMLElement | null = null;\n\n    private _getCurrentSkeleton: () => Nullable<ISheetSkeletonManagerParam>;\n\n    constructor(props: IHtmlToUSMServiceProps) {\n        this._getCurrentSkeleton = props.getCurrentSkeleton;\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    convert(html: string): IUniverSheetCopyDataModel {\n        const pastePlugin = HtmlToUSMService._pluginList.find((plugin) => plugin.checkPasteType(html));\n        if (pastePlugin) {\n            this._styleRules = [...pastePlugin.stylesRules];\n            this._afterProcessRules = [...pastePlugin.afterProcessRules];\n        }\n        const valueMatrix = new ObjectMatrix<ICellDataWithSpanInfo>();\n        this._dom = parseToDom(html);\n        // Convert stylesheets to map\n        const style = this._dom.querySelector('style');\n        if (style) {\n            const shadowHost = document.createElement('div');\n            const shadowRoot = shadowHost.attachShadow({ mode: 'open' });\n            document.body.appendChild(shadowHost);\n            shadowRoot.appendChild(style);\n            for (const rule of style.sheet!.cssRules) {\n                const cssRule = rule as CSSStyleRule;\n                const selectorText = cssRule.selectorText;\n                const style = cssRule.style;\n                this._styleMap.set(selectorText, style);\n            }\n            style.remove();\n            shadowHost.remove();\n        }\n        const newDocBody: IDocumentBody = {\n            dataStream: '',\n            textRuns: [],\n        };\n\n        const rowProperties: IClipboardPropertyItem[] = [];\n        const colProperties: IClipboardPropertyItem[] = [];\n        // pick tables\n        const tableStrings = html.match(/<table\\b[^>]*>([\\s\\S]*?)<\\/table>/gi);\n        const tables: IParsedTablesInfo[] = [];\n        this.process(null, this._dom.childNodes!, newDocBody, tables);\n        const { paragraphs, dataStream, textRuns, payloads, customRanges } = newDocBody;\n        // use paragraph to split rows\n        if (paragraphs) {\n            const starts = paragraphs.map((p) => p.startIndex + 1);\n            starts.unshift(0);\n            for (let i = 0; i < starts.length; i++) {\n                let cellDataStream;\n                if (i === starts.length - 1) {\n                    cellDataStream = `${dataStream.substring(starts[i])}\\r\\n`;\n                    if (cellDataStream === '\\r\\n') {\n                        continue;\n                    }\n                } else {\n                    cellDataStream = `${dataStream.substring(starts[i], starts[i + 1] - 1)}\\r\\n`;\n                }\n                const cellTextRuns: ITextRun[] = [];\n                textRuns?.forEach((t) => {\n                    if (t.st >= starts[i] && t.ed <= starts[i + 1]) {\n                        cellTextRuns.push({\n                            st: t.st - starts[i],\n                            ed: t.ed - starts[i],\n                            ts: t.ts,\n                        });\n                    }\n                });\n                const cellCustomRanges: ICustomRange[] = [];\n                customRanges?.forEach((c) => {\n                    if (c.startIndex >= starts[i] && c.endIndex <= starts[i + 1]) {\n                        cellCustomRanges.push({\n                            ...c,\n                            startIndex: c.startIndex - starts[i],\n                            endIndex: c.endIndex - starts[i],\n                        });\n                    }\n                });\n                // set rich format\n                const p = this._generateDocumentDataModelSnapshot({\n                    body: {\n                        dataStream: cellDataStream,\n                        textRuns: cellTextRuns,\n                        paragraphs: generateParagraphs(cellDataStream),\n                        customRanges: cellCustomRanges,\n                    },\n                });\n                const isEmptyMatrix = Object.keys(valueMatrix.getMatrix()).length === 0;\n                valueMatrix.setValue(isEmptyMatrix ? 0 : valueMatrix.getLength(), 0, {\n                    v: cellDataStream,\n                    p,\n                });\n                rowProperties.push({}); // TODO@yuhongz\n            }\n        } else {\n            if (dataStream) {\n                const singleDataStream = `${dataStream}\\r\\n`;\n                const singleDocBody: IDocumentBody = {\n                    dataStream: singleDataStream,\n                    textRuns,\n                    paragraphs: generateParagraphs(singleDataStream),\n                    payloads,\n                    customRanges,\n                };\n\n                if (!customRanges?.length) {\n                    valueMatrix.setValue(0, 0, convertToCellStyle({ v: dataStream }, dataStream, textRuns));\n                } else {\n                    const p = this._generateDocumentDataModelSnapshot({\n                        body: singleDocBody,\n                    });\n                    valueMatrix.setValue(0, 0, convertToCellStyle({ v: dataStream, p }, dataStream, textRuns));\n                }\n\n                rowProperties.push({}); // TODO@yuhongz\n            }\n        }\n        if (tableStrings) {\n            tableStrings.forEach((t, index) => {\n                const curRow = valueMatrix.getDataRange().endRow + 1;\n                const { cellMatrix, rowProperties: tableRowProp, colProperties: tableColProp } = this._parseTable(t!, index);\n                if (cellMatrix) {\n                    cellMatrix.forValue((row, col, value) => {\n                        valueMatrix.setValue(curRow + row, col, value);\n                    });\n                }\n                if (tableColProp) {\n                    colProperties.push(...tableColProp);\n                }\n                rowProperties.push(...tableRowProp);\n            });\n        }\n        this.dispose();\n        return {\n            rowProperties,\n            colProperties,\n            cellMatrix: valueMatrix,\n        };\n    }\n\n    private _getStyleBySelectorText(selectorText: string, cssText: string) {\n        const css = this._styleMap.get(selectorText)?.getPropertyValue(cssText);\n        if (!css) {\n            return '';\n        }\n        return css;\n    }\n\n    private _getStyle(node: HTMLElement, styleStr: string) {\n        const recordStyle: Record<string, string> = turnToStyleObject(styleStr);\n        const style = node.style;\n        // style represents inline styles with the highest priority, followed by selectorText which corresponds to stylesheet rules, and recordStyle pertains to inherited styles with the lowest priority.\n        let newStyleStr = '';\n        for (let l = 0; l < sheetStyleRules.length; l++) {\n            const key = sheetStyleRules[l];\n\n            // retrieve multiple sources for a node and compile them into a cohesive new style string.\n            if (key === 'background') {\n                let value = '';\n                node.classList.forEach((className) => {\n                    value = this._getStyleBySelectorText(`.${className}`, 'background-color') || this._getStyleBySelectorText(`.${className}`, key);\n                });\n                const bgColor = style.getPropertyValue('background-color') || value ||\n                    this._getStyleBySelectorText(`#${node.id}`, 'background-color') || this._getStyleBySelectorText(`#${node.id}`, key) ||\n                    this._getStyleBySelectorText(node.nodeName.toLowerCase(), key) || this._getStyleBySelectorText(node.nodeName, 'background-color') || recordStyle['background-color'] || '';\n                bgColor && (newStyleStr += `background:${bgColor};`);\n                continue;\n            }\n            if (key === 'text-decoration') {\n                let value = '';\n                node.classList.forEach((className) => {\n                    value = this._getStyleBySelectorText(`.${className}`, 'text-decoration-line') || this._getStyleBySelectorText(`.${className}`, key);\n                });\n                const textDecoration = style.getPropertyValue('text-decoration-line') || style.getPropertyValue('text-decoration') || value ||\n                    this._getStyleBySelectorText(`#${node.id}`, 'text-decoration-line') || this._getStyleBySelectorText(`#${node.id}`, key) ||\n                    this._getStyleBySelectorText(node.nodeName.toLowerCase(), key) || this._getStyleBySelectorText(node.nodeName, 'text-decoration-line') || recordStyle['text-decoration-line'] || '';\n                textDecoration && (newStyleStr += `text-decoration:${textDecoration};`);\n                continue;\n            }\n\n            let value = '';\n            node.classList.forEach((className) => {\n                value = this._getStyleBySelectorText(`.${className}`, key);\n            });\n\n            value =\n                style.getPropertyValue(key) ||\n                this._getStyleBySelectorText(`#${node.id}`, key) ||\n                value ||\n                this._getStyleBySelectorText(node.nodeName.toLowerCase(), key) ||\n                recordStyle[key] ||\n                '';\n            value && (newStyleStr += `${key}:${value};`);\n        }\n        return newStyleStr;\n    }\n\n    private _parseTable(html: string, tableElIndex: number) {\n        const valueMatrix = new ObjectMatrix<ICellDataWithSpanInfo>();\n        const colProperties = parseColGroup(html) ?? [];\n        const { rowProperties = [] } = parseTableRows(html);\n        const parsedCellMatrix = this._parseTableByHtml(this._dom!, tableElIndex, this._getCurrentSkeleton()?.skeleton);\n        parsedCellMatrix &&\n            parsedCellMatrix.forValue((row, col, value) => {\n                let style = handleStringToStyle(undefined, value.style);\n                if (value?.richTextParma?.p?.body?.textRuns?.length) {\n                    const textLen = value?.richTextParma?.v?.length;\n                    for (let i = 0; i < value?.richTextParma?.p?.body?.textRuns?.length; i++) {\n                        const textRunItem = value?.richTextParma?.p?.body?.textRuns[i];\n                        if (textRunItem.st === 0 && textRunItem.ed === textLen) {\n                            style = { ...textRunItem.ts, ...style };\n                            value?.richTextParma?.p?.body?.textRuns.splice(i, 1);\n                            i--;\n                        }\n                    }\n                    if (value?.richTextParma?.p?.body?.textRuns?.length === 0) {\n                        value.content = value?.richTextParma?.v;\n                        delete value.richTextParma;\n                    }\n                }\n\n                const cellValue = value?.richTextParma?.p?.body?.textRuns\n                    ? {\n                        v: value.richTextParma.v,\n                        p: value.richTextParma.p,\n                        s: style,\n                        rowSpan: value.rowSpan,\n                        colSpan: value.colSpan,\n                    }\n                    : {\n                        v: value.content,\n                        s: style,\n                        rowSpan: value.rowSpan,\n                        colSpan: value.colSpan,\n                    };\n                valueMatrix.setValue(row, col, cellValue);\n            });\n        return {\n            rowProperties,\n            colProperties,\n            cellMatrix: valueMatrix,\n        };\n    }\n\n    private _parseTableByHtml(htmlElement: HTMLElement, tableElIndex: number, skeleton?: SpreadsheetSkeleton) {\n        const cellMatrix = new ObjectMatrix<IParsedCellValueByClipboard>();\n        const tableEle = htmlElement.querySelectorAll('table')[tableElIndex];\n        if (!tableEle) {\n            return cellMatrix;\n        }\n        // user agent stylesheet can be provided here\n        const tableStyle = this._getStyle(tableEle, '');\n        const rows = tableEle?.querySelectorAll('tr');\n\n        for (let rowIndex = 0; rowIndex < rows.length; rowIndex++) {\n            const row = rows[rowIndex];\n            const rowStyle = this._getStyle(row, tableStyle);\n            const cells = row.querySelectorAll('td, th');\n            let colSetValueIndex = 0;\n            for (let colIndex = 0; colIndex < cells.length;) {\n                const cell = cells[colIndex];\n                let cellStyle = '';\n                const rowSpan = Number(cell.getAttribute('rowSpan')) || 1;\n                const colSpan = Number(cell.getAttribute('colSpan')) || 1;\n\n                cellStyle = this._getStyle(cell as HTMLElement, rowStyle);\n\n                // If the cell above has a border-bottom and its value is not 'none',\n                // remove the border-top of the current cell.\n                // If the cell to the left has a border-right and its value is not 'none',\n                // remove the border-left of the current cell.\n                // Check and remove borders based on adjacent merged cells\n                if (rowIndex > 0) {\n                    const cellValueAbove = cellMatrix.getValue(rowIndex - 1, colSetValueIndex);\n                    if (cellValueAbove?.style?.includes('border-bottom') && cellStyle.includes('border-top')) {\n                        const borderBottom = extractStyleProperty(cellValueAbove.style!, 'border-bottom');\n                        if (borderBottom && textTrim(borderBottom.substr(borderBottom.indexOf(':') + 1)) !== 'none') {\n                            cellStyle = cellStyle.replace(/border-top:[^;]+;/, '');\n                        }\n                    }\n                }\n\n                if (colIndex > 0) {\n                    const cellValueLeft = cellMatrix.getValue(rowIndex, colSetValueIndex - 1);\n                    if (cellValueLeft?.style?.includes('border-right') && cellStyle.includes('border-left')) {\n                        const borderRight = extractStyleProperty(cellValueLeft.style!, 'border-right');\n                        if (borderRight && textTrim(borderRight.substr(borderRight.indexOf(':') + 1)) !== 'none') {\n                            cellStyle = cellStyle.replace(/border-left:[^;]+;/, '');\n                        }\n                    }\n                }\n\n                // Determine whether it is rich text based on whether there are html tags\n                const { cellText, cellRichStyle } = this._getCellTextAndRichText(cell, cellStyle, skeleton);\n\n                const cellValue = {\n                    rowSpan,\n                    colSpan,\n                    content: cellText,\n                    style: cellStyle,\n                    richTextParma: {\n                        p: cellRichStyle,\n                        v: cellText,\n                    },\n                };\n\n                if (cellMatrix.getValue(rowIndex, colSetValueIndex)) {\n                    colSetValueIndex += 1;\n                    continue;\n                } else {\n                    // Clone the style of merged cells to each individual cell; switch to cloning only border styles if there are issues later.\n                    if ((rowSpan > 1 || colSpan > 1)) {\n                        setMergedCellStyle(cellMatrix, cellStyle, cellValue, { colSpan, rowSpan, rowIndex, colIndex, colSetValueIndex });\n                    } else {\n                        cellMatrix.setValue(rowIndex, colSetValueIndex, cellValue);\n                    }\n                    colSetValueIndex += colSpan;\n                    colIndex++;\n                }\n            }\n        }\n        return cellMatrix;\n    }\n\n    private _parseCellHtml(parent: Nullable<ChildNode>, nodes: NodeListOf<ChildNode>, doc: IDocumentBody, styleCache: Map<ChildNode, ITextStyle> = new Map(), styleStr: string) {\n        for (const node of nodes) {\n            if (node.nodeType === Node.TEXT_NODE) {\n                const text = node.nodeValue?.replace(/[\\r\\n]/g, '');\n                let style;\n\n                if (parent && styleCache.has(parent)) {\n                    style = styleCache.get(parent);\n                }\n\n                doc.dataStream += text;\n\n                if (style && Object.getOwnPropertyNames(style).length) {\n                    doc.textRuns!.push({\n                        st: doc.dataStream.length - text!.length,\n                        ed: doc.dataStream.length,\n                        ts: style,\n                    });\n                }\n            } else if (node.nodeType === Node.COMMENT_NODE || node.nodeName === 'STYLE') {\n                continue;\n            } else if (node.nodeName.toLowerCase() === 'br') {\n                if (!doc.paragraphs) {\n                    doc.paragraphs = [];\n                }\n                doc.paragraphs.push({ startIndex: doc.dataStream.length });\n                doc.dataStream += '\\r';\n            } else if (node.nodeType === Node.ELEMENT_NODE) {\n                const currentNodeStyle = this._getStyle(node as HTMLElement, styleStr);\n                const parentStyles = parent ? styleCache.get(parent) : {};\n                const predefinedStyles = turnToStyleObject(currentNodeStyle);\n                const nodeStyles = extractNodeStyle(node as HTMLElement, predefinedStyles);\n\n                styleCache.set(node, { ...parentStyles, ...nodeStyles });\n                const { childNodes } = node;\n                this._parseCellHtml(node, childNodes, doc, styleCache, currentNodeStyle);\n            }\n        }\n    }\n\n    private _getCellTextAndRichText(cell: Element, styleStr: string, skeleton?: SpreadsheetSkeleton) {\n        let cellText = '';\n        let cellRichStyle;\n        const isRichText = /<[^>]+>/.test(cell.innerHTML);\n        if (isRichText && skeleton) {\n            const newDocBody: IDocumentBody = {\n                dataStream: '',\n                textRuns: [],\n            };\n            // Rich text parsing method, refer to the doc\n            this._parseCellHtml(null, cell.childNodes, newDocBody, undefined, styleStr);\n            const documentModel = skeleton.getBlankCellDocumentModel()?.documentModel;\n            const p = documentModel?.getSnapshot();\n            const singleDataStream = `${newDocBody.dataStream}\\r\\n`;\n            const documentData = {\n                ...p,\n                ...{\n                    body: {\n                        dataStream: singleDataStream,\n                        textRuns: newDocBody.textRuns,\n                        paragraphs: generateParagraphs(singleDataStream),\n                    },\n                },\n            };\n            documentModel?.reset(documentData);\n            cellRichStyle = documentModel?.getSnapshot();\n            cellText = newDocBody.dataStream;\n        } else {\n            cellText = decodeHTMLEntities(cell.innerHTML.replace(/[\\r\\n]/g, ''));\n        }\n        return {\n            cellText,\n            cellRichStyle,\n        };\n    }\n\n    private _generateDocumentDataModelSnapshot(snapshot: Partial<IDocumentData>) {\n        const currentSkeleton = this._getCurrentSkeleton();\n        if (currentSkeleton == null) {\n            return null;\n        }\n        const { skeleton } = currentSkeleton;\n        const documentModel = skeleton.getBlankCellDocumentModel()?.documentModel;\n        const p = documentModel?.getSnapshot();\n        const documentData = { ...p, ...snapshot };\n        documentModel?.reset(documentData);\n        return documentModel?.getSnapshot();\n    }\n\n    private process(\n        parent: Nullable<ChildNode>,\n        nodes: NodeListOf<ChildNode>,\n        doc: IDocumentBody,\n        tables: IParsedTablesInfo[]\n    ) {\n        for (const node of nodes) {\n            if (node.nodeName.toLowerCase() === 'table') {\n                tables.push({\n                    index: doc?.paragraphs?.length || 0,\n                });\n            } else if (node.nodeType === Node.TEXT_NODE) {\n                if (node.nodeValue?.trim() === '') {\n                    continue;\n                }\n\n                // TODO: @JOCS, More characters need to be replaced, like `\\b`\n                const text = node.nodeValue?.replace(/[\\r\\n]/g, '');\n                let style;\n\n                if (parent && this._styleCache.has(parent)) {\n                    style = this._styleCache.get(parent);\n                }\n                const newDoc: IDocumentBody = {\n                    dataStream: '',\n                    textRuns: [],\n                };\n\n                doc.dataStream += text;\n                newDoc.dataStream += text;\n                if (style && Object.getOwnPropertyNames(style).length) {\n                    doc.textRuns!.push({\n                        st: doc.dataStream.length - text!.length,\n                        ed: doc.dataStream.length,\n                        ts: style,\n                    });\n                    newDoc.textRuns!.push({\n                        st: doc.dataStream.length - text!.length,\n                        ed: doc.dataStream.length,\n                        ts: style,\n                    });\n                }\n            } else if (skipParseTagNames.includes(node.nodeName.toLowerCase())) {\n                continue;\n            } else if (node.nodeName.toLowerCase() === 'br') {\n                if (!doc.paragraphs) {\n                    doc.paragraphs = [];\n                }\n                doc.paragraphs.push({ startIndex: doc.dataStream.length });\n                doc.dataStream += '\\r';\n            } else if (node.nodeType === Node.ELEMENT_NODE) {\n                if (node.nodeName === 'STYLE') {\n                    continue;\n                }\n                const element = node as HTMLElement;\n                const linkStart = this._processBeforeLink(element, { body: doc });\n                const parentStyles = parent ? this._styleCache.get(parent) : {};\n                const styleRule = this._styleRules.find(({ filter }) => matchFilter(node as HTMLElement, filter));\n                const nodeStyles = styleRule\n                    ? styleRule.getStyle(node as HTMLElement)\n                    : extractNodeStyle(node as HTMLElement);\n\n                this._styleCache.set(node, { ...parentStyles, ...nodeStyles });\n\n                const { childNodes } = node;\n\n                this.process(node, childNodes, doc, tables);\n\n                const afterProcessRule = this._afterProcessRules.find(({ filter }) =>\n                    matchFilter(node as HTMLElement, filter)\n                );\n\n                if (afterProcessRule) {\n                    afterProcessRule.handler(doc, node as HTMLElement);\n                }\n                this._processAfterLink(element, { body: doc }, linkStart);\n            }\n        }\n    }\n\n    private _processBeforeLink(node: HTMLElement, doc: Partial<IDocumentData>) {\n        const body = doc.body!;\n        return body.dataStream.length;\n    }\n\n    private _processAfterLink(node: HTMLElement, doc: Partial<IDocumentData>, start: number) {\n        const body = doc.body!;\n        const element = node as HTMLElement;\n\n        if (element.tagName.toUpperCase() === 'A') {\n            body.customRanges = body.customRanges ?? [];\n            body.customRanges.push({\n                startIndex: start,\n                endIndex: body.dataStream.length - 1,\n                rangeId: element.dataset.rangeid ?? generateRandomId(),\n                rangeType: CustomRangeType.HYPERLINK,\n                properties: { url: (element as HTMLAnchorElement).href },\n            });\n        }\n    }\n\n    dispose() {\n        this._dom = null;\n        this._styleCache.clear();\n        this._styleMap.clear();\n    }\n}\n\n/**\n * This function parses <tr> elements in the table. So it would return several things.\n * @param html raw content\n * @returns\n */\nexport function parseTableRows(html: string): {\n    rowProperties: IClipboardPropertyItem[];\n    rowCount: number;\n} {\n    const ROWS_REGEX = /<tr([\\s\\S]*?)>([\\s\\S]*?)<\\/tr>/gi;\n    const rowMatches = html.matchAll(ROWS_REGEX);\n    if (!rowMatches) {\n        return {\n            rowProperties: [],\n            rowCount: 0,\n        };\n    }\n\n    const rowMatchesAsArray = Array.from(rowMatches);\n    const rowProperties = rowMatchesAsArray.map((rowMatch) => parseProperties(rowMatch[1])).map((properties) => {\n        if (!properties.height) {\n            const style = properties.style;\n            const match = style && style.match(/height\\s*:\\s*(\\d+(\\.\\d+)?)px/);\n            properties.height = `${match ? Number.parseInt(match[1], 10) : DEFAULT_WORKSHEET_ROW_HEIGHT}`;\n        }\n        return properties;\n    });\n\n    return {\n        rowProperties,\n        rowCount: rowProperties.length,\n    };\n}\n\nfunction turnToStyleObject(styleStr: string) {\n    const styleObj: Record<string, string> = {};\n    const styleArr = styleStr.split(';');\n    styleArr.forEach((style) => {\n        const [key, value] = style.split(':');\n        styleObj[key] = value;\n    });\n    return styleObj;\n}\n\nfunction parseProperties(propertyStr: string): IClipboardPropertyItem {\n    if (!propertyStr) {\n        return {};\n    }\n\n    const property: IClipboardPropertyItem = {};\n    const PROPERTY_REGEX = /([\\w-]+)\\s*=\\s*(?:(['\"])([^'\"]*)\\2|(\\S+))/g;\n\n    let match;\n\n    while ((match = PROPERTY_REGEX.exec(propertyStr)) !== null) {\n        const [, attributeName, , attributeValue1, attributeValue2] = match;\n        const attributeValue = attributeValue1 !== undefined ? attributeValue1 : attributeValue2;\n        property[attributeName] = attributeValue;\n    }\n\n    return property;\n}\n\n/**\n * Parse columns and their properties from colgroup element.\n *\n * @param raw content\n * @returns cols and their properties\n */\nfunction parseColGroup(raw: string): IClipboardPropertyItem[] | null {\n    const COLGROUP_TAG_REGEX = /<colgroup([\\s\\S]*?)>(.*?)<\\/colgroup>/;\n    const colgroupMatch = raw.match(COLGROUP_TAG_REGEX);\n\n    const COL_TAG_REGEX = /<col([\\s\\S]*?)>/g;\n    let colMatches;\n    if (colgroupMatch?.[2]) {\n        colMatches = colgroupMatch[2].matchAll(COL_TAG_REGEX);\n    } else {\n        colMatches = raw.matchAll(COL_TAG_REGEX);\n    }\n\n    if (!colMatches) {\n        return null;\n    }\n\n    const colPropertiesWithSpan = Array.from(colMatches).map((colMatch) => parseProperties(colMatch[1]));\n\n    const colProperties: IClipboardPropertyItem[] = [];\n    colPropertiesWithSpan.forEach((propertiesWithSpan) => {\n        const span = Number(propertiesWithSpan.span);\n        if (span) {\n            for (let i = 0; i < span; i++) {\n                const propertiesWithoutSpan = { ...propertiesWithSpan };\n                delete propertiesWithoutSpan.span;\n                colProperties.push(propertiesWithoutSpan);\n            }\n        } else {\n            colProperties.push(propertiesWithSpan);\n        }\n    });\n\n    return colProperties;\n}\n\nfunction childNodeToHTML(node: ChildNode) {\n    const serializer = new XMLSerializer();\n    const htmlString = serializer.serializeToString(node);\n    return htmlString;\n}\n\nfunction decodeHTMLEntities(input: string): string {\n    const entities: { [key: string]: string } = {\n        '&lt;': '<',\n        '&gt;': '>',\n        '&amp;': '&',\n        '&quot;': '\"',\n        '&#39;': '\\'',\n        '&nbsp;': ' ',\n    };\n\n    return input.replace(/&lt;|&gt;|&amp;|&quot;|&#39;|&nbsp;|<br>/g, (match) => entities[match]);\n}\n\nfunction extractStyleProperty(styleString?: string, propertyName?: string) {\n    if (!styleString || !propertyName) return null;\n    const regex = new RegExp(`(${propertyName}\\\\s*:\\\\s*[^;]+);`, 'i');\n    const match = styleString.match(regex);\n    if (match) {\n        return match[1];\n    }\n    return null;\n}\n\nfunction setMergedCellStyle(\n    cellMatrix: ObjectMatrix<IParsedCellValueByClipboard>,\n    cellStyle: string,\n    cellValue: {\n        content: string;\n        style: string;\n        richTextParma: {\n            p?: IDocumentData;\n            v: string;\n        };\n        rowSpan?: number;\n        colSpan?: number;\n    },\n    indexParams: {\n        colSpan: number;\n        rowSpan: number;\n        rowIndex: number;\n        colIndex: number;\n        colSetValueIndex: number;\n    }\n) {\n    const { rowSpan, colSpan, rowIndex, colSetValueIndex } = indexParams;\n\n    for (let i = rowIndex; i < rowIndex + rowSpan; i++) {\n        for (let j = colSetValueIndex; j < colSetValueIndex + colSpan; j++) {\n            // Set the value of the top-left cell with cellValue and style\n            if (i === rowIndex && j === colSetValueIndex) {\n                cellMatrix.setValue(i, j, { ...cellValue, style: cellStyle });\n            } else {\n                // Set the style for all other cells\n                cellMatrix.setValue(i, j, { style: cellStyle });\n            }\n        }\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPastePlugin } from './type';\n\nimport { BooleanNumber } from '@univerjs/core';\nimport { extractNodeStyle as getInlineStyle } from '../parse-node-style';\n\nexport const LarkPastePlugin: IPastePlugin = {\n    name: 'univer-doc-paste-plugin-lark',\n    checkPasteType(html: string) {\n        return /lark-record-clipboard/i.test(html);\n    },\n    // TODO: @JOCS, support inline code copy from lark.\n    stylesRules: [\n        {\n            filter: ['s'],\n            getStyle(node) {\n                const inlineStyle = getInlineStyle(node);\n\n                return {\n                    st: {\n                        s: BooleanNumber.TRUE,\n                    },\n                    ...inlineStyle,\n                };\n            },\n        },\n    ],\n\n    afterProcessRules: [\n        {\n            filter(el: HTMLElement) {\n                return el.tagName === 'DIV' && /ace-line/i.test(el.className);\n            },\n            handler(doc) {\n                if (doc.paragraphs == null) {\n                    doc.paragraphs = [];\n                }\n\n                doc.paragraphs.push({\n                    startIndex: doc.dataStream.length,\n                });\n                doc.dataStream += '\\r';\n            },\n        },\n    ],\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IParagraph } from '@univerjs/core';\nimport type { IPastePlugin } from './type';\nimport { getParagraphStyle } from '../utils';\n\nexport const UniverPastePlugin: IPastePlugin = {\n    name: 'univer-doc-paste-plugin-univer',\n    checkPasteType(html: string) {\n        return /UniverNormal/i.test(html);\n    },\n\n    stylesRules: [],\n\n    afterProcessRules: [\n        {\n            filter(el: HTMLElement) {\n                return el.tagName === 'P' && /UniverNormal/i.test(el.className);\n            },\n            handler(doc, el) {\n                if (doc.paragraphs == null) {\n                    doc.paragraphs = [];\n                }\n\n                const paragraph: IParagraph = {\n                    startIndex: doc.dataStream.length,\n                };\n\n                const paragraphStyle = getParagraphStyle(el);\n\n                if (paragraphStyle) {\n                    paragraph.paragraphStyle = paragraphStyle;\n                }\n\n                doc.paragraphs.push(paragraph);\n                doc.dataStream += '\\r';\n            },\n        },\n    ],\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IParagraph } from '@univerjs/core';\nimport type { IPastePlugin } from './type';\nimport { BooleanNumber } from '@univerjs/core';\nimport { extractNodeStyle as getInlineStyle } from '../parse-node-style';\nimport { getParagraphStyle } from '../utils';\n\nexport const WordPastePlugin: IPastePlugin = {\n    name: 'univer-doc-paste-plugin-word',\n    checkPasteType(html: string) {\n        return /word|mso/i.test(html);\n    },\n\n    stylesRules: [\n        {\n            filter: ['b'],\n            getStyle(node) {\n                const inlineStyle = getInlineStyle(node);\n\n                return { bl: BooleanNumber.TRUE, ...inlineStyle };\n            },\n        },\n    ],\n\n    afterProcessRules: [\n        {\n            filter(el: HTMLElement) {\n                return el.tagName === 'P' && /mso/i.test(el.className);\n            },\n            handler(doc, el) {\n                if (doc.paragraphs == null) {\n                    doc.paragraphs = [];\n                }\n\n                const paragraph: IParagraph = {\n                    startIndex: doc.dataStream.length,\n                };\n\n                const paragraphStyle = getParagraphStyle(el);\n\n                if (paragraphStyle) {\n                    paragraph.paragraphStyle = paragraphStyle;\n                }\n\n                doc.paragraphs.push(paragraph);\n                doc.dataStream += '\\r';\n            },\n        },\n    ],\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellData, ObjectMatrix } from '@univerjs/core';\n\nimport type { IDiscreteRange } from '../../../controllers/utils/range-tools';\nimport type { ICellDataWithSpanInfo, IClipboardPropertyItem, ISheetClipboardHook } from '../type';\n\n/**\n *\n * @param row index of the copied row\n * @param cols\n * @param hooks\n * @returns\n */\nfunction getRowContent(\n    row: number,\n    cols: number[],\n    hooks: ISheetClipboardHook[],\n    matrix: ObjectMatrix<ICellDataWithSpanInfo>,\n    mergeSet: Set<string>\n) {\n    const properties = hooks.map((hook) => hook.onCopyRow?.(row)).filter((v) => !!v) as IClipboardPropertyItem[];\n    const mergedProperties = mergeProperties(properties);\n    const str = zipClipboardPropertyItemToString(mergedProperties);\n    const tds = cols\n        .map((col) => {\n            if (!mergeSet.has(`${row}-${col}`)) {\n                const v = matrix.getValue(row, col);\n                if (v?.rowSpan && v?.colSpan) {\n                    for (let i = row; i < row + v.rowSpan; i++) {\n                        for (let j = col; j < col + v.colSpan; j++) {\n                            mergeSet.add(`${i}-${j}`);\n                        }\n                    }\n                }\n                return getTDContent(row, col, hooks, matrix);\n            }\n            return null;\n        })\n        .filter((v) => !!v)\n        .join('');\n\n    return `<tr${str}>${tds}</tr>`;\n}\n\n/**\n * Get content of a single td element.\n * @param row index of the copied cell\n * @param col index of the copied cell\n * @returns\n */\nfunction getTDContent(\n    row: number,\n    col: number,\n    hooks: ISheetClipboardHook[],\n    matrix: ObjectMatrix<ICellDataWithSpanInfo>\n) {\n    const v = matrix.getValue(row, col);\n    const properties = hooks\n        .map((hook) => hook.onCopyCellStyle?.(row, col, v?.rowSpan, v?.colSpan))\n        .filter((v) => !!v) as IClipboardPropertyItem[];\n    const mergedProperties = mergeProperties(properties);\n    const str = zipClipboardPropertyItemToString(mergedProperties);\n    const content = hooks.reduce((acc, hook) => acc || hook.onCopyCellContent?.(row, col) || '', '');\n    return `<td${str}>${content}</td>`;\n}\n\nfunction getColStyle(cols: number[], hooks: ISheetClipboardHook[]) {\n    const str = cols\n        .map((col) => {\n            const properties = hooks\n                .map((hook) => hook.onCopyColumn?.(col))\n                .filter((v) => !!v) as IClipboardPropertyItem[];\n            const mergedProperties = mergeProperties(properties);\n            const str = zipClipboardPropertyItemToString(mergedProperties);\n            return `<col ${str} />`;\n        })\n        .join('');\n\n    return `<colgroup>${str}</colgroup>`;\n}\n\nfunction mergeProperties(properties: IClipboardPropertyItem[]): IClipboardPropertyItem {\n    return properties.reduce((acc, cur) => {\n        const keys = Object.keys(cur);\n        keys.forEach((key) => {\n            if (!acc[key]) {\n                acc[key] = cur[key];\n            } else {\n                acc[key] += `;${cur[key]}`;\n            }\n        });\n        return acc;\n    }, {});\n}\n\nfunction zipClipboardPropertyItemToString(item: IClipboardPropertyItem) {\n    return Object.keys(item).reduce((acc, cur) => `${acc} ${cur}=\"${item[cur]}\"`, '');\n}\n\nexport class USMToHtmlService {\n    convert(\n        matrix: ObjectMatrix<\n            ICellData & {\n                rowSpan?: number | undefined;\n                colSpan?: number | undefined;\n            }\n        >,\n        range: IDiscreteRange,\n        hooks: ISheetClipboardHook[]\n    ): string {\n        const { cols, rows } = range;\n        if (!cols.length) {\n            return '';\n        }\n        const colStyles = getColStyle(cols, hooks);\n        // row styles and table contents\n        const rowContents: string[] = [];\n        const mergeSet = new Set<string>();\n        rows.forEach((row) => {\n            rowContents.push(getRowContent(row, cols, hooks, matrix, mergeSet));\n        });\n\n        const html = `<google-sheets-html-origin><table xmlns=\"http://www.w3.org/1999/xhtml\" cellspacing=\"0\" cellpadding=\"0\" dir=\"ltr\" style=\"table-layout:fixed;font-size:10pt;font-family:Arial;width:0px;border-collapse:collapse;border:none\">${colStyles}\n<tbody>${rowContents.join('')}</tbody></table>`;\n        return html;\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellData, IMutationInfo, IObjectMatrixPrimitiveType, IRange, Nullable } from '@univerjs/core';\nimport type { ISetRangeValuesMutationParams } from '@univerjs/sheets';\nimport type { IDiscreteRange } from '../../controllers/utils/range-tools';\nimport { ObjectMatrix } from '@univerjs/core';\nimport { SetRangeValuesMutation } from '@univerjs/sheets';\n\n/**\n *\n *\n * @param {IRange} sourceRange\n * @param {IRange} targetRange\n * @param {boolean} [isStrictMode] if is true,the remainder of the row and column must all be 0 to be repeated\n * @return {*}\n */\nexport const getRepeatRange = (sourceRange: IRange, targetRange: IRange, isStrictMode = false) => {\n    const getRowLength = (range: IRange) => range.endRow - range.startRow + 1;\n    const getColLength = (range: IRange) => range.endColumn - range.startColumn + 1;\n    const rowMod = getRowLength(targetRange) % getRowLength(sourceRange);\n    const colMod = getColLength(targetRange) % getColLength(sourceRange);\n    const repeatRelativeRange: IRange = {\n        startRow: 0,\n        endRow: getRowLength(sourceRange) - 1,\n        startColumn: 0,\n        endColumn: getColLength(sourceRange) - 1,\n    };\n    const repeatRow = Math.floor(getRowLength(targetRange) / getRowLength(sourceRange));\n    const repeatCol = Math.floor(getColLength(targetRange) / getColLength(sourceRange));\n    const repeatList: Array<{ startRange: IRange; repeatRelativeRange: IRange }> = [];\n    if (!rowMod && !colMod) {\n        for (let countRow = 1; countRow <= repeatRow; countRow++) {\n            for (let countCol = 1; countCol <= repeatCol; countCol++) {\n                const row = getRowLength(sourceRange) * (countRow - 1);\n                const col = getColLength(sourceRange) * (countCol - 1);\n                const startRange: IRange = {\n                    startRow: row + targetRange.startRow,\n                    endRow: row + targetRange.startRow,\n                    startColumn: col + targetRange.startColumn,\n                    endColumn: col + targetRange.startColumn,\n                };\n\n                repeatList.push({ repeatRelativeRange, startRange });\n            }\n        }\n    } else if (!rowMod && colMod && !isStrictMode) {\n        for (let countRow = 1; countRow <= repeatRow; countRow++) {\n            const row = getRowLength(sourceRange) * (countRow - 1);\n            const col = 0;\n            const startRange: IRange = {\n                startRow: row + targetRange.startRow,\n                endRow: row + targetRange.startRow,\n                startColumn: col + targetRange.startColumn,\n                endColumn: col + targetRange.startColumn,\n            };\n\n            repeatList.push({ repeatRelativeRange, startRange });\n        }\n    } else if (rowMod && !colMod && !isStrictMode) {\n        for (let countCol = 1; countCol <= repeatCol; countCol++) {\n            const row = 0;\n            const col = getColLength(sourceRange) * (countCol - 1);\n            const startRange: IRange = {\n                startRow: row + targetRange.startRow,\n                endRow: row + targetRange.startRow,\n                startColumn: col + targetRange.startColumn,\n                endColumn: col + targetRange.startColumn,\n            };\n\n            repeatList.push({ repeatRelativeRange, startRange });\n        }\n    } else {\n        const startRange: IRange = {\n            startRow: targetRange.startRow,\n            endRow: targetRange.startRow,\n            startColumn: targetRange.startColumn,\n            endColumn: targetRange.startColumn,\n        };\n        repeatList.push({ startRange, repeatRelativeRange });\n    }\n    return repeatList;\n};\n\nexport function htmlIsFromExcel(html: string): boolean {\n    if (!html) {\n        return false;\n    }\n\n    const excelMarkers = [\n        // Excel class names\n        /<td[^>]*class=\".*?xl.*?\"[^>]*>/i,\n        // Excel namespace\n        /xmlns:x=\"urn:schemas-microsoft-com:office:excel\"/i,\n        // Excel ProgID\n        /ProgId=\"Excel.Sheet\"/i,\n        // Office specific namespace\n        /xmlns:o=\"urn:schemas-microsoft-com:office:office\"/i,\n        // Excel specific style markers\n        /@mso-|mso-excel/i,\n        // Excel workbook metadata\n        /<x:ExcelWorkbook>/i,\n    ];\n\n    return excelMarkers.some((marker) => marker.test(html));\n}\n\nexport function htmlContainsImage(html: string): boolean {\n    if (!html) {\n        return false;\n    }\n\n    // test the image tag is base64 image\n    const base64ImageRegex = /<img[^>]*src\\s*=\\s*[\"']data:image\\/[^;]+;base64,[^\"']*[\"'][^>]*>/i; ;\n\n    const images = (html.match(base64ImageRegex) || []);\n\n    return images.length > 0;\n}\n\nexport function mergeCellValues(...cellValues: IObjectMatrixPrimitiveType<Nullable<ICellData>>[]) {\n    if (cellValues.length === 1) {\n        return cellValues[0];\n    }\n    const newMatrix = new ObjectMatrix<IObjectMatrixPrimitiveType<Nullable<ICellData>>>();\n    cellValues.forEach((cellValue) => {\n        if (cellValue) {\n            const matrix = new ObjectMatrix(cellValue);\n            matrix.forValue((row, col, value) => {\n                newMatrix.setValue(row, col, { ...newMatrix.getValue(row, col), ...value });\n            });\n        }\n    });\n    return newMatrix.getMatrix();\n}\n\nexport function getRangeValuesMergeable(m1: IMutationInfo<ISetRangeValuesMutationParams>, m2: IMutationInfo<ISetRangeValuesMutationParams>) {\n    return m1.id === m2.id\n    && m1.params.unitId === m2.params.unitId\n    && m1.params.subUnitId === m2.params.subUnitId;\n}\n\nexport function mergeSetRangeValues(mutations: IMutationInfo[]) {\n    const newMutations: IMutationInfo[] = [];\n    for (let i = 0; i < mutations.length;) {\n        let cursor = 1;\n        if (mutations[i].id === SetRangeValuesMutation.id) {\n            const current = mutations[i] as IMutationInfo<ISetRangeValuesMutationParams>;\n            const toMerge = [current];\n            while (i + cursor < mutations.length && getRangeValuesMergeable(current, mutations[i + cursor] as IMutationInfo<ISetRangeValuesMutationParams>)) {\n                toMerge.push(mutations[i + cursor] as IMutationInfo<ISetRangeValuesMutationParams>);\n                cursor += 1;\n            }\n            const merged = mergeCellValues(...toMerge.map((m: IMutationInfo<ISetRangeValuesMutationParams>) => m.params.cellValue || {}));\n            newMutations.push({\n                ...current,\n                params: {\n                    ...current.params,\n                    cellValue: merged,\n                },\n            });\n        } else {\n            newMutations.push(mutations[i]);\n        }\n        i += cursor;\n    }\n    return newMutations;\n}\n\nexport function rangeIntersectWithDiscreteRange(range: IRange, discrete: IDiscreteRange) {\n    const { startRow, endRow, startColumn, endColumn } = range;\n    for (let i = startRow; i <= endRow; i++) {\n        for (let j = startColumn; j <= endColumn; j++) {\n            if (discrete.rows.includes(i) && discrete.cols.includes(j)) {\n                return true;\n            }\n        }\n    }\n}\n\nexport function discreteRangeContainsRange(discrete: IDiscreteRange, range: IRange) {\n    const { startRow, endRow, startColumn, endColumn } = range;\n    for (let i = startRow; i <= endRow; i++) {\n        if (!discrete.rows.includes(i)) {\n            return false;\n        }\n    }\n    for (let j = startColumn; j <= endColumn; j++) {\n        if (!discrete.cols.includes(j)) {\n            return false;\n        }\n    }\n    return true;\n}\n\nexport function convertTextToTable(text: string): string {\n    const rows = text.trim().split('\\n');\n\n    let html = '<table>';\n\n    rows.forEach((row) => {\n        const columns = row.split('\\t');\n        html += '<tr>';\n        columns.forEach((column) => {\n            html += `<td>${column}</td>`;\n        });\n        html += '</tr>';\n    });\n\n    html += '</table>';\n\n    return html;\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type {\n    ICellData,\n    ICellDataWithSpanAndDisplay,\n    IDisposable,\n    IMutationInfo,\n    IRange,\n    Nullable,\n    Workbook,\n    Worksheet,\n} from '@univerjs/core';\nimport type { ISetSelectionsOperationParams } from '@univerjs/sheets';\nimport type { Observable } from 'rxjs';\nimport type { IDiscreteRange } from '../../controllers/utils/range-tools';\nimport type {\n    ICellDataWithSpanInfo,\n    IClipboardPropertyItem,\n    IPasteHookKeyType,\n    IPasteHookValueType,\n    IPasteOptionCache,\n    IPasteTarget,\n    ISheetClipboardHook,\n    ISheetDiscreteRangeLocation,\n    IUniverSheetCopyDataModel,\n} from './type';\nimport {\n    CellModeEnum,\n    createIdentifier,\n    Disposable,\n    ErrorService,\n    extractPureTextFromCell,\n    ICommandService,\n    ILogService,\n    Inject,\n    Injector,\n    isNotNullOrUndefined,\n    IUndoRedoService,\n    IUniverInstanceService,\n    LocaleService,\n    ObjectMatrix,\n    sequenceExecute,\n    ThemeService,\n    toDisposable,\n    Tools,\n    UniverInstanceType,\n} from '@univerjs/core';\nimport { IRenderManagerService, withCurrentTypeOfRenderer } from '@univerjs/engine-render';\n\nimport {\n    getPrimaryForRange,\n    rangeToDiscreteRange,\n    SetSelectionsOperation,\n    SetWorksheetActiveOperation,\n\n    SheetsSelectionsService,\n} from '@univerjs/sheets';\nimport { FILE__BMP_CLIPBOARD_MIME_TYPE, FILE__JPEG_CLIPBOARD_MIME_TYPE, FILE__WEBP_CLIPBOARD_MIME_TYPE, FILE_PNG_CLIPBOARD_MIME_TYPE, HTML_CLIPBOARD_MIME_TYPE, IClipboardInterfaceService, imageMimeTypeSet, INotificationService, IPlatformService, PLAIN_TEXT_CLIPBOARD_MIME_TYPE } from '@univerjs/ui';\n\nimport { BehaviorSubject } from 'rxjs';\nimport { virtualizeDiscreteRanges } from '../../controllers/utils/range-tools';\nimport { IMarkSelectionService } from '../mark-selection/mark-selection.service';\nimport { SheetSkeletonManagerService } from '../sheet-skeleton-manager.service';\nimport { createCopyPasteSelectionStyle } from '../utils/selection-util';\n\nimport { CopyContentCache, extractId, genId } from './copy-content-cache';\nimport { HtmlToUSMService } from './html-to-usm/converter';\nimport { LarkPastePlugin } from './html-to-usm/paste-plugins/plugin-lark';\nimport { UniverPastePlugin } from './html-to-usm/paste-plugins/plugin-univer';\nimport { WordPastePlugin } from './html-to-usm/paste-plugins/plugin-word';\nimport { COPY_TYPE } from './type';\nimport { USMToHtmlService } from './usm-to-html/convertor';\nimport { convertTextToTable, discreteRangeContainsRange, htmlContainsImage, htmlIsFromExcel, mergeSetRangeValues, rangeIntersectWithDiscreteRange } from './utils';\n\nexport const PREDEFINED_HOOK_NAME = {\n    DEFAULT_COPY: 'default-copy',\n    DEFAULT_PASTE: 'default-paste',\n    SPECIAL_PASTE_VALUE: 'special-paste-value',\n    SPECIAL_PASTE_FORMAT: 'special-paste-format',\n    SPECIAL_PASTE_COL_WIDTH: 'special-paste-col-width',\n    SPECIAL_PASTE_BESIDES_BORDER: 'special-paste-besides-border',\n    SPECIAL_PASTE_FORMULA: 'special-paste-formula',\n} as const;\n\nconst IMAGE_MIME_TO_EXTENSION = {\n    [FILE_PNG_CLIPBOARD_MIME_TYPE]: 'png',\n    [FILE__JPEG_CLIPBOARD_MIME_TYPE]: 'jpg',\n    [FILE__WEBP_CLIPBOARD_MIME_TYPE]: 'webp',\n    [FILE__BMP_CLIPBOARD_MIME_TYPE]: 'bmp',\n} as const;\n\ninterface ICopyContent {\n    copyId: string;\n    plain: string;\n    html: string;\n    matrixFragment: ObjectMatrix<ICellDataWithSpanAndDisplay>;\n    discreteRange: IDiscreteRange;\n}\n\n/**\n * This service provide hooks for sheet features to supplement content or modify behavior of clipboard.\n */\n\nHtmlToUSMService.use(WordPastePlugin);\nHtmlToUSMService.use(LarkPastePlugin);\nHtmlToUSMService.use(UniverPastePlugin);\n\nexport interface ISheetClipboardService {\n    showMenu$: Observable<boolean>;\n    setShowMenu: (show: boolean) => void;\n    getPasteMenuVisible: () => boolean;\n\n    pasteOptionsCache$: Observable<IPasteOptionCache | null>;\n    getPasteOptionsCache: () => IPasteOptionCache | null;\n    updatePasteOptionsCache(cache: IPasteOptionCache | null): void;\n\n    copy(): Promise<boolean>;\n    cut(): Promise<boolean>;\n    paste(item: ClipboardItem, pasteType?: string): Promise<boolean>; // get content from a ClipboardItem and paste it.\n    legacyPaste(html?: string, text?: string, files?: File[]): Promise<boolean>; // paste a HTML string or plain text directly.\n\n    rePasteWithPasteType(type: IPasteHookKeyType): boolean;\n    disposePasteOptionsCache(): void;\n\n    generateCopyContent(workbookId: string, worksheetId: string, range: IRange): Nullable<ICopyContent>;\n    copyContentCache(): CopyContentCache; // return the cache content for inner copy/cut/paste.\n    addClipboardHook(hook: ISheetClipboardHook): IDisposable; // add a hook to the clipboard service\n    getClipboardHooks(): ISheetClipboardHook[]; // get all hooks\n\n    removeMarkSelection(): void;\n}\n\nexport const ISheetClipboardService = createIdentifier<ISheetClipboardService>('sheet.clipboard-service');\n\nexport class SheetClipboardService extends Disposable implements ISheetClipboardService {\n    private _clipboardHooks: ISheetClipboardHook[] = [];\n\n    private readonly _clipboardHooks$ = new BehaviorSubject<ISheetClipboardHook[]>([]);\n    readonly clipboardHooks$ = this._clipboardHooks$.asObservable();\n\n    private _htmlToUSM: HtmlToUSMService;\n    private _usmToHtml: USMToHtmlService;\n\n    private _copyContentCache: CopyContentCache;\n    private _copyMarkId: string | null = null;\n\n    // Record the parsed matrix and row and column attributes\n    private _pasteOptionsCache$ = new BehaviorSubject<IPasteOptionCache | null>(null);\n    readonly pasteOptionsCache$ = this._pasteOptionsCache$.asObservable();\n\n    //Control the visibility of the Paste Options menu\n    private readonly _showMenu$ = new BehaviorSubject(false);\n    readonly showMenu$ = this._showMenu$.asObservable();\n\n    constructor(\n        @ILogService private readonly _logService: ILogService,\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService,\n        @Inject(SheetsSelectionsService) private readonly _selectionManagerService: SheetsSelectionsService,\n        @IClipboardInterfaceService private readonly _clipboardInterfaceService: IClipboardInterfaceService,\n        @IUndoRedoService private readonly _undoRedoService: IUndoRedoService,\n        @ICommandService private readonly _commandService: ICommandService,\n        @IMarkSelectionService private readonly _markSelectionService: IMarkSelectionService,\n        @INotificationService private readonly _notificationService: INotificationService,\n        @IPlatformService private readonly _platformService: IPlatformService,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService,\n        @Inject(ThemeService) private readonly _themeService: ThemeService,\n        @Inject(LocaleService) private readonly _localeService: LocaleService,\n        @Inject(ErrorService) private readonly _errorService: ErrorService,\n        @Inject(Injector) private readonly _injector: Injector\n    ) {\n        super();\n\n        this._htmlToUSM = new HtmlToUSMService({\n            getCurrentSkeleton: () => withCurrentTypeOfRenderer(\n                UniverInstanceType.UNIVER_SHEET,\n                SheetSkeletonManagerService,\n                this._univerInstanceService,\n                this._renderManagerService\n            )?.getCurrentParam(),\n        });\n\n        this._usmToHtml = new USMToHtmlService();\n        this._copyContentCache = new CopyContentCache();\n\n        this.disposeWithMe(this._htmlToUSM);\n        this._initUnitDisposed();\n    }\n\n    setShowMenu(show: boolean) {\n        this._showMenu$.next(show);\n    }\n\n    getPasteMenuVisible() {\n        return this._showMenu$.getValue();\n    }\n\n    getPasteOptionsCache() {\n        return this._pasteOptionsCache$.getValue();\n    }\n\n    copyContentCache(): CopyContentCache {\n        return this._copyContentCache;\n    }\n\n    generateCopyContent(workbookId: string, worksheetId: string, range: IRange, copyType: COPY_TYPE = COPY_TYPE.COPY): Nullable<ICopyContent> {\n        const hooks = this._clipboardHooks;\n        hooks.forEach((h) => h.onBeforeCopy?.(workbookId, worksheetId, range, copyType));\n        const copyContent = this._generateCopyContent(workbookId, worksheetId, range, this._clipboardHooks);\n        hooks.forEach((h) => h.onAfterCopy?.());\n\n        return copyContent;\n    }\n\n    async copy(copyType = COPY_TYPE.COPY): Promise<boolean> {\n        const selection = this._selectionManagerService.getCurrentLastSelection();\n        if (!selection) {\n            return false; // maybe we should notify user that there is no selection\n        }\n\n        const workbook = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n        const worksheet = workbook.getActiveSheet();\n        if (!worksheet) {\n            return false;\n        }\n        const workbookId = workbook.getUnitId();\n        const worksheetId = worksheet.getSheetId();\n\n        const copyContent = this.generateCopyContent(workbookId, worksheetId, selection.range);\n\n        if (!copyContent) {\n            return false;\n        }\n\n        // 2. extract copy content for both internal and external\n        const { html, plain, matrixFragment, copyId, discreteRange } = copyContent;\n\n        // 3. cache the copy content for internal paste\n        this._copyContentCache.set(copyId, {\n            unitId: workbook.getUnitId(),\n            subUnitId: worksheet.getSheetId(),\n            range: discreteRange,\n            matrix: matrixFragment,\n            copyType,\n        });\n\n        // 4. write html and get plain text info the clipboard interface\n        await this._clipboardInterfaceService.write(plain, html);\n\n        // 5. mark the copy range\n        this._markSelectionService.removeAllShapes();\n\n        const style = createCopyPasteSelectionStyle(this._themeService);\n        this._copyMarkId = this._markSelectionService.addShape({ ...selection, style });\n\n        return true;\n    }\n\n    async cut(): Promise<boolean> {\n        return this.copy(COPY_TYPE.CUT);\n    }\n\n    async paste(item: ClipboardItem, pasteType = PREDEFINED_HOOK_NAME.DEFAULT_PASTE): Promise<boolean> {\n        const types = item.types;\n        const text =\n            types.indexOf(PLAIN_TEXT_CLIPBOARD_MIME_TYPE) !== -1\n                ? await item.getType(PLAIN_TEXT_CLIPBOARD_MIME_TYPE).then((blob) => blob && blob.text())\n                : '';\n        const html =\n            types.indexOf(HTML_CLIPBOARD_MIME_TYPE) !== -1\n                ? await item.getType(HTML_CLIPBOARD_MIME_TYPE).then((blob) => blob && blob.text())\n                : '';\n\n        const imageIndex = types.findIndex((type) => imageMimeTypeSet.has(type));\n\n        const shouldUseHTMLPaste = imageIndex === -1 || !htmlContainsImage(html);\n        if (html && shouldUseHTMLPaste) {\n            // Firstly see if the html content is from Excel\n            if (this._platformService.isWindows && htmlIsFromExcel(html)) {\n                this._notificationService.show({\n                    type: 'warning',\n                    title: this._localeService.t('clipboard.shortCutNotify.title'),\n                    content: this._localeService.t('clipboard.shortCutNotify.useShortCutInstead'),\n                });\n                // Pasting should not be allowed here.\n                // After the pop-up window prompts, can paste the contents of the clipboard as much as possible.\n            }\n\n            return this._pasteHTML(html, pasteType);\n        }\n\n        // clipboard item from excel may contain image, so we need to check if the clipboard item is from excel\n        if (imageIndex !== -1) {\n            const imageMimeType = types[imageIndex]!;\n            const imageBlob = await item.getType(imageMimeType);\n\n            if (imageBlob) {\n                const imageExtension = IMAGE_MIME_TO_EXTENSION[imageMimeType as keyof typeof IMAGE_MIME_TO_EXTENSION];\n                const file = new File(\n                    [imageBlob],\n                    `clipboard-image.${imageExtension}`,\n                    { type: imageMimeType }\n                );\n\n                return this._pasteFiles([file], pasteType);\n            }\n        }\n\n        if (text) {\n            return this._pastePlainText(text, pasteType);\n        }\n\n        this._logService.error('[SheetClipboardService]', 'No valid data on clipboard');\n\n        return false;\n    }\n\n    async legacyPaste(html?: string, text?: string, files?: File[]): Promise<boolean> {\n        const isFromExcel = htmlIsFromExcel(html ?? '');\n\n        if (files && !isFromExcel) {\n            return this._pasteFiles(files, PREDEFINED_HOOK_NAME.DEFAULT_PASTE);\n        } else if (html) {\n            return this._pasteHTML(html, PREDEFINED_HOOK_NAME.DEFAULT_PASTE);\n        } else if (text) {\n            // Converts text with tabs and newlines into an HTML table\n            if (/[\\n\\t]/.test(text)) {\n                return this._pasteHTML(convertTextToTable(text), PREDEFINED_HOOK_NAME.DEFAULT_PASTE);\n            } else {\n                return this._pastePlainText(text, PREDEFINED_HOOK_NAME.DEFAULT_PASTE);\n            }\n        } else {\n            return this._pasteUnrecognized();\n        }\n    }\n\n    rePasteWithPasteType(type: IPasteHookKeyType): boolean {\n        const pasteOptionsCache = this._pasteOptionsCache$.getValue();\n        if (!pasteOptionsCache) {\n            return false;\n        }\n\n        const undoRedoService = this._injector.get(IUndoRedoService);\n        const element = undoRedoService.pitchTopUndoElement();\n        if (element) {\n            const result = sequenceExecute(element.undoMutations, this._commandService);\n            if (result) {\n                undoRedoService.popUndoToRedo();\n            }\n        }\n\n        const { cellMatrix, rowProperties = [], colProperties = [], source, target } = pasteOptionsCache;\n\n        this._pasteUSM({\n            cellMatrix,\n            colProperties,\n            rowProperties,\n        }, target, PREDEFINED_HOOK_NAME[type] as IPasteHookValueType, source);\n\n        return true;\n    }\n\n    updatePasteOptionsCache(cache: IPasteOptionCache | null): void {\n        this._pasteOptionsCache$.next(cache);\n    }\n\n    addClipboardHook(hook: ISheetClipboardHook): IDisposable {\n        if (this._clipboardHooks.findIndex((h) => h.id === hook.id) !== -1) {\n            this._logService.error('[SheetClipboardService]', 'hook already exists', hook.id);\n            return { dispose: () => { /* empty */ } };\n        }\n\n        // hook added should be ordered at meaning while\n        const insertIndex = this._clipboardHooks.findIndex((existingHook) => {\n            const existingHookPriority = existingHook.priority || 0;\n            const hookPriority = hook.priority || 0;\n            return hookPriority < existingHookPriority;\n        });\n\n        this._clipboardHooks.splice(insertIndex !== -1 ? insertIndex : this._clipboardHooks.length, 0, hook);\n\n        this._notifyClipboardHook();\n        return toDisposable(() => {\n            const index = this._clipboardHooks.indexOf(hook);\n            if (index > -1) {\n                this._clipboardHooks.splice(index, 1);\n                this._notifyClipboardHook();\n            }\n        });\n    }\n\n    getClipboardHooks(): ISheetClipboardHook[] {\n        return this._clipboardHooks;\n    }\n\n    private _generateCopyContent(unitId: string, subUnitId: string, range: IRange, hooks: ISheetClipboardHook[]): Nullable<ICopyContent> {\n        const workbook = this._univerInstanceService.getUniverSheetInstance(unitId);\n        const worksheet = workbook?.getSheetBySheetId(subUnitId);\n\n        if (!workbook || !worksheet) {\n            return null;\n        }\n\n        // get filtered out rows those are filtered out by plugins (e.g. filter feature)\n        const filteredRows = hooks.reduce((acc, cur) => {\n            const rows = cur.getFilteredOutRows?.(range);\n            rows?.forEach((r) => acc.add(r));\n            return acc;\n        }, new Set<number>());\n\n        // calculate selection matrix, span cells would only - maybe warn uses that cells are too may in the future\n        const { startColumn, startRow, endColumn, endRow } = range;\n\n        const matrix = worksheet.getMatrixWithMergedCells(startRow, startColumn, endRow, endColumn, CellModeEnum.Both);\n        const matrixFragment = new ObjectMatrix<ICellDataWithSpanInfo>();\n        let rowIndex = startRow;\n\n        const plainMatrix = new ObjectMatrix<ICellDataWithSpanAndDisplay>();\n\n        const discreteRange: IDiscreteRange = { rows: [], cols: [] };\n        for (let r = startRow; r <= endRow; r++) {\n            if (filteredRows.has(r)) {\n                continue;\n            }\n            discreteRange.rows.push(r);\n            for (let c = startColumn; c <= endColumn; c++) {\n                const cellData = matrix.getValue(r, c);\n                if (cellData) {\n                    const newCellData = Tools.deepClone(cellData);\n                    plainMatrix.setValue(rowIndex - startRow, c - startColumn, {\n                        ...getEmptyCell(),\n                        ...newCellData,\n                    });\n\n                    delete newCellData.displayV;\n                    matrixFragment.setValue(rowIndex - startRow, c - startColumn, {\n                        ...getEmptyCell(),\n                        ...newCellData,\n                    });\n                } else {\n                    plainMatrix.setValue(rowIndex - startRow, c - startColumn, getEmptyCell());\n                    matrixFragment.setValue(rowIndex - startRow, c - startColumn, getEmptyCell());\n                    matrix.setValue(r, c, getEmptyCell());\n                }\n            }\n            rowIndex += 1;\n        }\n        for (let c = startColumn; c <= endColumn; c++) {\n            discreteRange.cols.push(c);\n        }\n\n        // convert matrix to html\n        let html = this._usmToHtml.convert(matrix, discreteRange, hooks);\n\n        const plain = getMatrixPlainText(plainMatrix);\n        const copyId = genId();\n        html = html.replace(/(<[a-z]+)/, (_p0, p1) => `${p1} data-copy-id=\"${copyId}\"`);\n\n        return {\n            copyId,\n            plain,\n            html,\n            matrixFragment,\n            discreteRange,\n        };\n    }\n\n    private _notifyClipboardHook() {\n        this._clipboardHooks$.next(this._clipboardHooks);\n    }\n\n    private async _executePaste(generateMutations: (hook: ISheetClipboardHook, payload: {\n        unitId: string;\n        subUnitId: string;\n        range: IDiscreteRange;\n    }) => undefined | ({ undos: IMutationInfo[]; redos: IMutationInfo[] })): Promise<boolean> {\n        const target = this._getPastingTarget();\n        if (!target.subUnitId || !target.selection) {\n            return false;\n        }\n\n        const range = this._injector.invoke((accessor) => {\n            return rangeToDiscreteRange(target.selection!.range, accessor, target.unitId, target.subUnitId);\n        });\n\n        if (!range) {\n            return false;\n        }\n\n        const { unitId, subUnitId } = target;\n        const hooks = this._clipboardHooks;\n        const enabledHooks: ISheetClipboardHook[] = [];\n        const disableCopying = hooks.some(\n            (h) => enabledHooks.push(h) && h.onBeforePaste?.({ unitId, subUnitId, range }) === false\n        );\n        if (disableCopying) {\n            enabledHooks.forEach((h) => h.onAfterPaste?.(false));\n            return false;\n        }\n\n        const redoMutationsInfo: IMutationInfo[] = [];\n        const undoMutationsInfo: IMutationInfo[] = [];\n        enabledHooks.forEach((h) => {\n            const contentReturn = generateMutations(h, {\n                unitId,\n                subUnitId,\n                range,\n            });\n\n            if (contentReturn) {\n                redoMutationsInfo.push(...contentReturn.redos);\n                undoMutationsInfo.push(...contentReturn.undos);\n            }\n        });\n        const result = redoMutationsInfo.every((m) => this._commandService.executeCommand(m.id, m.params));\n        if (result) {\n            // add to undo redo services\n            this._undoRedoService.pushUndoRedo({\n                unitID: this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!.getUnitId(),\n                undoMutations: undoMutationsInfo,\n                redoMutations: redoMutationsInfo,\n            });\n        }\n\n        return result;\n    }\n\n    private async _pasteFiles(files: File[], pasteType: IPasteHookValueType): Promise<boolean> {\n        return this._executePaste((h, payload) => {\n            return h.onPasteFiles?.(payload, files, { pasteType });\n        });\n    }\n\n    private async _pastePlainText(text: string, pasteType: IPasteHookValueType): Promise<boolean> {\n        return this._executePaste((h, payload) => {\n            return h.onPastePlainText?.(payload, text, { pasteType });\n        });\n    }\n\n    private _pasteUnrecognized() {\n        return this._executePaste((h, payload) => {\n            return h.onPasteUnrecognized?.(payload);\n        });\n    }\n\n    private async _pasteHTML(html: string, pasteType: IPasteHookValueType): Promise<boolean> {\n        const copyId = extractId(html);\n        if (copyId && this._copyContentCache.get(copyId)) {\n            return this._pasteInternal(copyId, pasteType);\n        }\n        return this._pasteExternal(html, pasteType);\n    }\n\n    private async _pasteExternal(html: string, pasteType: IPasteHookValueType): Promise<boolean> {\n        // this._logService.log('[SheetClipboardService]', 'pasting external content', html);\n\n        // steps of pasting:\n\n        // 1. get properties of the table by parsing raw html content, including col properties / row properties\n        // cell properties and cell contents.\n        const { rowProperties, colProperties, cellMatrix } = this._htmlToUSM.convert(html);\n        if (!cellMatrix) {\n            return false;\n        }\n\n        // 2. get filtered rows in the target pasting area and get the final pasting matrix\n        // we also handle transpose pasting at this step\n        // note: handle transpose before filtering\n        // matrix before adjustment -> transpose -> filtering -> matrix under adjustment\n        // TODO: not implemented yet\n\n        // 3. call hooks with cell position and properties and get mutations (both do mutations and undo mutations)\n        // we also handle 'copy value only' or 'copy style only' as this step\n        const pasteTarget = this._getPastedRange(cellMatrix);\n\n        // pastedRange.endColumn = pastedRange.startColumn + colCount;\n        // pastedRange.endRow = pastedRange.startRow + rowCount;\n\n        // If PastedRange is null, it means that the paste fails\n        if (!pasteTarget) {\n            return false;\n        }\n\n        const worksheet = this._univerInstanceService\n            .getUniverSheetInstance(pasteTarget.unitId)\n            ?.getSheetBySheetId(pasteTarget.subUnitId);\n        if (!worksheet) {\n            return false;\n        }\n\n        const mergeData = worksheet?.getMergeData();\n\n        if (mergeData.length) {\n            const pastedRangeLapWithMergedCell = mergeData.some((m) => {\n                return rangeIntersectWithDiscreteRange(m, pasteTarget.pastedRange) && !discreteRangeContainsRange(pasteTarget.pastedRange, m);\n            });\n            if (pastedRangeLapWithMergedCell) {\n                this._errorService.emit(this._localeService.t('clipboard.paste.overlappingMergedCells'));\n                return false;\n            }\n        }\n\n        // 4. execute these mutations by the one method\n        const res = this._pasteUSM(\n            {\n                rowProperties,\n                colProperties,\n                cellMatrix,\n            },\n            pasteTarget,\n            pasteType\n        );\n        return res;\n    }\n\n    // eslint-disable-next-line max-lines-per-function, complexity\n    private async _pasteInternal(copyId: string, pasteType: IPasteHookValueType): Promise<boolean> {\n        // const target = this._getPastingTarget();\n        // const { selection, unitId, subUnitId } = target;\n        const cachedData = Tools.deepClone(this._copyContentCache.get(copyId));\n        const { range, matrix: cellMatrix, unitId: copyUnitId, subUnitId: copySubUnitId } = cachedData || {};\n        if (!cellMatrix || !cachedData || !range || !copyUnitId || !copySubUnitId) {\n            return false;\n        }\n\n        if (!cellMatrix || !cachedData) {\n            return false;\n        }\n\n        const styles = this._univerInstanceService.getUniverSheetInstance(copyUnitId)?.getStyles();\n        cellMatrix.forValue((row, col, value) => {\n            if (typeof value.s === 'string') {\n                const newValue = Tools.deepClone(value);\n                newValue.s = styles?.getStyleByCell(value);\n                cellMatrix.setValue(row, col, newValue);\n            }\n\n            if (value.colSpan || value.rowSpan) {\n                for (let rStart = 0; rStart < value.rowSpan!; rStart++) {\n                    for (let cStart = 0; cStart < value.colSpan!; cStart++) {\n                        if (rStart === 0 && cStart === 0) continue;\n\n                        const r = row + rStart;\n                        const c = col + cStart;\n                        cellMatrix.setValue(r, c, { s: styles?.getStyleByCell(value) });\n                    }\n                }\n            }\n        });\n        const pasteTarget = this._getPastedRange(cellMatrix);\n        if (!pasteTarget) return false;\n\n        const pasteToWorksheet = this._univerInstanceService\n            .getUniverSheetInstance(pasteTarget.unitId)\n            ?.getSheetBySheetId(pasteTarget.subUnitId);\n        if (!pasteToWorksheet) {\n            return false;\n        }\n\n        const mergeData = pasteToWorksheet?.getMergeData();\n\n        if (mergeData) {\n            const pastedRangeLapWithMergedCell = mergeData.some((m) => {\n                return rangeIntersectWithDiscreteRange(m, pasteTarget.pastedRange) && !discreteRangeContainsRange(pasteTarget.pastedRange, m);\n            });\n            if (pastedRangeLapWithMergedCell) {\n                this._errorService.emit(this._localeService.t('clipboard.paste.overlappingMergedCells'));\n                return false;\n            }\n        }\n\n        const pasteFromWorkbook = this._univerInstanceService.getUnit<Workbook>(copyUnitId);\n        if (!pasteFromWorkbook) return false;\n        const pasteFromWorksheet = pasteFromWorkbook.getSheetBySheetId(copySubUnitId);\n        if (!pasteFromWorksheet) return false;\n\n        const colManager = pasteFromWorksheet.getColumnManager();\n        const rowManager = pasteFromWorksheet.getRowManager();\n        const defaultColumnWidth = pasteFromWorksheet.getConfig().defaultColumnWidth;\n        const defaultRowHeight = pasteFromWorksheet.getConfig().defaultRowHeight;\n\n        const colProperties: IClipboardPropertyItem[] = [];\n        const rowProperties: IClipboardPropertyItem[] = [];\n\n        range.cols.forEach((i) => {\n            const column = colManager.getColumnOrCreate(i);\n            colProperties.push({ width: `${column.w || defaultColumnWidth}` });\n        });\n\n        range.rows.forEach((j) => {\n            const row = rowManager.getRowOrCreate(j);\n            const { ah = defaultRowHeight, h = defaultRowHeight } = row;\n            const height = Math.max(ah, h);\n            rowProperties.push({ height: `${height}` });\n        });\n\n        if (cachedData.copyType === COPY_TYPE.CUT) {\n            const start = pasteTarget.pastedRange.rows[0];\n            const end = range.rows[range.rows.length - 1] - range.rows[0] + start;\n            pasteTarget.pastedRange.rows = Array.from(new Array(end + 1).keys()).slice(start);\n        }\n\n        const pasteRes = this._pasteUSM(\n            {\n                cellMatrix,\n                colProperties,\n                rowProperties,\n            }, // paste data\n            pasteTarget,\n            pasteType,\n            {\n                range, // paste source\n                unitId: cachedData.unitId,\n                subUnitId: cachedData.subUnitId,\n                copyType: cachedData.copyType,\n                copyId,\n            }\n        );\n\n        if (cachedData.copyType === COPY_TYPE.CUT) {\n            this._copyContentCache.set(copyId, { ...cachedData, matrix: null });\n            this._copyMarkId && this._markSelectionService.removeShape(this._copyMarkId);\n            this._copyMarkId = null;\n        }\n\n        return pasteRes;\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    private _pasteUSM(\n        data: IUniverSheetCopyDataModel,\n        target: IPasteTarget,\n        pasteType: IPasteHookValueType,\n        source?: ISheetDiscreteRangeLocation & { copyId: string; copyType: COPY_TYPE }\n    ): boolean {\n        const { rowProperties, colProperties, cellMatrix } = data;\n        const { unitId, subUnitId, pastedRange } = target;\n        const colCount = pastedRange.cols.length;\n        const hooks = this._clipboardHooks;\n        const enabledHooks: ISheetClipboardHook[] = [];\n        const disableCopying = hooks.some(\n            (h) => enabledHooks.push(h) && h.onBeforePaste?.({ unitId, subUnitId, range: pastedRange }) === false\n        );\n        if (disableCopying) {\n            enabledHooks.forEach((h) => h.onAfterPaste?.(false));\n            return false;\n        }\n        if (!cellMatrix) return false;\n\n        const pasteFrom = source\n            ? {\n                unitId: source.unitId,\n                subUnitId: source.subUnitId,\n                range: source.range,\n            }\n            : null;\n\n        const payload = {\n            copyType: source?.copyType || COPY_TYPE.COPY,\n            copyId: source?.copyId,\n            pasteType,\n        };\n\n        let redoMutationsInfo: IMutationInfo[] = [];\n        let undoMutationsInfo: IMutationInfo[] = [];\n\n        // if hooks are not special or default, it will be executed in any case.\n        // other hooks will be executed only when the paste type is the same as the hook name, including the default one\n        const filteredHooks: ISheetClipboardHook[] = enabledHooks.filter(\n            (h) => (!h.specialPasteInfo && h.id !== PREDEFINED_HOOK_NAME.DEFAULT_PASTE) || pasteType === h.id\n        );\n        filteredHooks.forEach((h) => {\n            if (rowProperties) {\n                const rowReturn = h.onPasteRows?.({ range: pastedRange, unitId, subUnitId }, rowProperties, {\n                    pasteType,\n                });\n                if (rowReturn) {\n                    redoMutationsInfo.push(...rowReturn.redos);\n                    undoMutationsInfo.push(...rowReturn.undos);\n                }\n            }\n\n            const colReturn = h.onPasteColumns?.(\n                { range: pastedRange, unitId, subUnitId },\n                colProperties || new Array(colCount).map(() => ({})),\n                { pasteType }\n            );\n            if (colReturn) {\n                redoMutationsInfo.push(...colReturn.redos);\n                undoMutationsInfo.push(...colReturn.undos);\n            }\n\n            const contentReturn = h.onPasteCells?.(\n                pasteFrom,\n                { range: pastedRange, unitId, subUnitId },\n                cellMatrix,\n                payload\n            );\n            if (contentReturn) {\n                redoMutationsInfo.push(...contentReturn.redos);\n                undoMutationsInfo.push(...contentReturn.undos);\n            }\n        });\n\n        // setting the selection should be done separately, regardless of the pasting type.\n        const setSelectionOperation = this._getSetSelectionOperation(unitId, subUnitId, pastedRange, cellMatrix, pasteType);\n        if (setSelectionOperation) {\n            redoMutationsInfo.push(setSelectionOperation);\n        }\n\n        redoMutationsInfo = mergeSetRangeValues(redoMutationsInfo);\n        undoMutationsInfo = mergeSetRangeValues(undoMutationsInfo);\n        undoMutationsInfo.push({ id: SetWorksheetActiveOperation.id, params: { unitId: target.unitId, subUnitId: target.subUnitId } });\n\n        this._logService.log('[SheetClipboardService]', 'pasting mutations', {\n            undoMutationsInfo,\n            redoMutationsInfo,\n        });\n\n        const result = redoMutationsInfo.every((m) => this._commandService.syncExecuteCommand(m.id, m.params));\n        if (result) {\n            // add to undo redo services\n            this._undoRedoService.pushUndoRedo({\n                unitID: unitId,\n                undoMutations: undoMutationsInfo,\n                redoMutations: redoMutationsInfo,\n            });\n\n            this.updatePasteOptionsCache({\n                target: {\n                    pastedRange,\n                    unitId,\n                    subUnitId,\n                },\n                cellMatrix,\n                rowProperties,\n                colProperties,\n                pasteType,\n                source,\n            });\n            this.setShowMenu(true);\n        }\n\n        filteredHooks.forEach((h) => h.onAfterPaste?.(result));\n        return result;\n    }\n\n    private _getSetSelectionOperation(\n        unitId: string,\n        subUnitId: string,\n        range: IDiscreteRange,\n        cellMatrix: ObjectMatrix<ICellDataWithSpanAndDisplay>,\n        pasteType?: string\n    ) {\n        const worksheet = this._univerInstanceService.getUniverSheetInstance(unitId)?.getSheetBySheetId(subUnitId);\n        if (!worksheet) {\n            return null;\n        }\n        const { rows, cols } = range;\n        const startRow = rows[0];\n        const startColumn = cols[0];\n        const endRow = rows[rows.length - 1];\n        const endColumn = cols[cols.length - 1];\n\n        const primaryCell = {\n            startRow,\n            endRow: startRow,\n            startColumn,\n            endColumn: startColumn,\n        };\n\n        const primary = getPrimaryForRange(primaryCell, worksheet);\n\n        const mainCell = cellMatrix.getValue(0, 0);\n        const rowSpan = mainCell?.rowSpan || 1;\n        const colSpan = mainCell?.colSpan || 1;\n\n        const shouldExpandPrimary = pasteType === PREDEFINED_HOOK_NAME.DEFAULT_PASTE\n            || pasteType === PREDEFINED_HOOK_NAME.SPECIAL_PASTE_BESIDES_BORDER\n            || pasteType === PREDEFINED_HOOK_NAME.SPECIAL_PASTE_FORMAT;\n\n        if (shouldExpandPrimary && (rowSpan > 1 || colSpan > 1)) {\n            const mergeRange = {\n                startRow,\n                endRow: startRow + rowSpan - 1,\n                startColumn,\n                endColumn: startColumn + colSpan - 1,\n            };\n\n            primary.startRow = mergeRange.startRow;\n            primary.endRow = mergeRange.endRow;\n            primary.startColumn = mergeRange.startColumn;\n            primary.endColumn = mergeRange.endColumn;\n\n            primary.isMerged = true;\n            primary.isMergedMainCell = true;\n        }\n\n        // selection does not require undo\n        const setSelectionsParam: ISetSelectionsOperationParams = {\n            unitId,\n            subUnitId,\n            selections: [{\n                range: {\n                    startRow,\n                    endRow,\n                    startColumn,\n                    endColumn,\n                },\n                primary,\n                style: null,\n            }],\n        };\n        return {\n            id: SetSelectionsOperation.id,\n            params: setSelectionsParam,\n        };\n    }\n\n    private _getPastingTarget() {\n        const workbook = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n        const worksheet = workbook.getActiveSheet();\n        const selection = this._selectionManagerService.getCurrentLastSelection();\n        return {\n            unitId: workbook.getUnitId(),\n            subUnitId: worksheet?.getSheetId(),\n            selection,\n        };\n    }\n\n    /**\n     * Handles copying one range to another range, obtained by the following rules\n     *\n     * [Content to be assigned] => [Target range]\n     *\n     * I. There are no merged cells in the upper left corner of the pasted area\n     *\n     * 1. 1 -> 1: 1 => 1\n     * 2. N -> 1: N => N\n     * 3. 1 -> N: N => N\n     * 4. N1 -> N2:\n     *     1) N1 <N2: If N2 is a multiple of N1 (X), N1 * X => N2; If not, N1 => N1 (refer to office excel, different from google sheet)\n     *     2) N1> N2: N1 => N1\n     *\n     * The above four cases can be combined and processed as\n     *\n     * Case 1, 1/2/4-2 merged into N1 => N1\n     * Case 2, 3/4-1 merge into N1 * X => N2 or Case 1\n     *\n     * In the end we only need to judge whether N2 is a multiple of N1\n     *\n     * II. The pasted area contains merged cells\n     *\n     * 1. If N2 is a multiple of N1,\n     *   1) If N2 === N1, paste this area directly and the range remains unchanged.\n     *   2) Otherwise, determine whether other cells are included\n     *     1] If included, tile, the range remains unchanged\n     *     2] If not included, determine whether the source data is a combined cell\n     *       1} If yes, tile, the range remains unchanged\n     *       2} If not, only the content will be pasted, the original style will be discarded, and the scope will remain unchanged.\n     *\n     * 2. If N2 is not a multiple of N1, determine whether the upper left corner cell (merged or non-merged or combined) is consistent with the size of the original data.\n     *   1) If consistent, only paste this area;\n     *   2) If inconsistent, then determine whether the pasted area contains other cells.\n     *     1] If yes, pasting is not allowed and an error will pop up;\n     *     2] If not, only the content will be pasted and the original style will be discarded.\n     *\n     * @param rowCount\n     * @param colCount\n     * @param cellMatrix\n     * @param range\n     */\n    // eslint-disable-next-line max-lines-per-function, complexity\n    private _transformPastedData(\n        rowCount: number,\n        colCount: number,\n        cellMatrix: ObjectMatrix<ICellDataWithSpanAndDisplay>\n    ): IPasteTarget | null {\n        const target = this._getPastingTarget();\n        const { selection, unitId, subUnitId } = target;\n        if (!subUnitId || !selection) {\n            return null;\n        }\n\n        const discreteRange = this._injector.invoke((accessor) => {\n            return rangeToDiscreteRange(selection.range, accessor, unitId, subUnitId);\n        });\n\n        if (!discreteRange) {\n            return null;\n        }\n\n        const { ranges: [vRange], mapFunc } = virtualizeDiscreteRanges([discreteRange]);\n        const { startRow, startColumn, endRow, endColumn } = vRange;\n\n        const destinationRows = endRow - startRow + 1;\n        const destinationColumns = endColumn - startColumn + 1;\n\n        const workbook = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        const worksheet = workbook?.getActiveSheet();\n        if (!worksheet) {\n            return null;\n        }\n\n        const mergeData = worksheet.getMergeData();\n        // get all merged cells\n        const mergedCellsInRange = mergeData.filter((rect) =>\n            discreteRange.rows.includes(rect.startRow) && discreteRange.cols.includes(rect.startColumn)\n        );\n        const mergedRange = mergedCellsInRange[0];\n\n        let mergedRangeStartRow = 0;\n        let mergedRangeStartColumn = 0;\n        let mergedRangeEndRow = 0;\n        let mergedRangeEndColumn = 0;\n        if (mergedRange) {\n            mergedRangeStartRow = mergedRange.startRow;\n            mergedRangeStartColumn = mergedRange.startColumn;\n            mergedRangeEndRow = mergedRange.endRow;\n            mergedRangeEndColumn = mergedRange.endColumn;\n        }\n\n        // judge whether N2 is a multiple of N1\n        if (destinationRows % rowCount === 0 && destinationColumns % colCount === 0) {\n            // N2 !== N1\n            if (mergedCellsInRange.length > 0 && (destinationRows !== rowCount || destinationColumns !== colCount)) {\n                // Only merged cells, not other cells\n                if (\n                    mergedRangeStartRow === discreteRange.rows[0] &&\n                    mergedRangeStartColumn === discreteRange.cols[0] &&\n                    mergedRangeEndRow === discreteRange.rows[destinationRows - 1] &&\n                    mergedRangeEndColumn === discreteRange.cols[destinationColumns - 1]\n                ) {\n                    const isMultiple = isMultipleCells(cellMatrix);\n                    if (isMultiple) {\n                        for (let r = 0; r < destinationRows; r++) {\n                            for (let c = 0; c < destinationColumns; c++) {\n                                const cell = cellMatrix.getValue(r % rowCount, c % colCount);\n                                cell && cellMatrix.setValue(r, c, cell);\n                            }\n                        }\n                    } else {\n                        cellMatrix.forValue((row, col, cell) => {\n                            cell.s = null;\n                            delete cell.colSpan;\n                            delete cell.rowSpan;\n                        });\n                    }\n                } else {\n                    for (let r = 0; r < destinationRows; r++) {\n                        for (let c = 0; c < destinationColumns; c++) {\n                            const cell = cellMatrix.getValue(r % rowCount, c % colCount);\n                            cell && cellMatrix.setValue(r, c, cell);\n                        }\n                    }\n                }\n            } else {\n                /**\n                 * Expand cellMatrix content according to the destination size\n                 * A1,B1  =>  A1,B1,C1,D1\n                 * A2,B2      A2,B2,C2,D2\n                 *            A3,B3,C3,D3\n                 *            A4,B4,C4,D4\n                 */\n                for (let r = 0; r < destinationRows; r++) {\n                    for (let c = 0; c < destinationColumns; c++) {\n                        const cell = cellMatrix.getValue(r % rowCount, c % colCount);\n                        cell && cellMatrix.setValue(r, c, cell);\n                    }\n                }\n            }\n        } else if (mergedCellsInRange.length > 0) {\n            const { row: topRow, col: leftCol } = mapFunc(startRow, startColumn);\n            const isMatch = this._topLeftCellsMatch(rowCount, colCount, {\n                topRow,\n                leftCol,\n            });\n            if (isMatch) {\n                // Expand or shrink the destination to the same size as the original range\n                const newDiscreteRange = this._expandOrShrinkRowsCols(unitId, subUnitId, discreteRange, colCount, rowCount);\n\n                discreteRange.rows = newDiscreteRange.rows;\n                discreteRange.cols = newDiscreteRange.cols;\n            } else if (endRow > mergedRange.endRow || endColumn > mergedRange.endColumn) {\n                return null;\n            } else {\n                cellMatrix.forValue((row, col, cell) => {\n                    cell.s = null;\n                    delete cell.colSpan;\n                    delete cell.rowSpan;\n                });\n            }\n        } else {\n            // Expand or shrink the destination to the same size as the original range\n            const newDiscreteRange = this._expandOrShrinkRowsCols(unitId, subUnitId, discreteRange, colCount, rowCount);\n\n            discreteRange.rows = newDiscreteRange.rows;\n            discreteRange.cols = newDiscreteRange.cols;\n        }\n\n        return {\n            pastedRange: discreteRange,\n            unitId,\n            subUnitId,\n        };\n    }\n\n    private _getPastedRange(cellMatrix: ObjectMatrix<ICellDataWithSpanAndDisplay>) {\n        const target = this._getPastingTarget();\n        const { selection, unitId, subUnitId } = target;\n        if (!subUnitId || !selection) {\n            return null;\n        }\n        const discreteRange = this._injector.invoke((accessor) => {\n            return rangeToDiscreteRange(selection.range, accessor, unitId, subUnitId);\n        });\n\n        if (!discreteRange) {\n            return null;\n        }\n        const { startColumn, endColumn, startRow, endRow } = cellMatrix.getDataRange();\n        const rowCount = endRow - startRow + 1;\n        const colCount = endColumn - startColumn + 1;\n\n        if (rowCount <= 0 || colCount <= 0) return null;\n\n        const pasteSelectionRangeRowLen = discreteRange.rows.length;\n        const pasteSelectionRangeColLen = discreteRange.cols.length;\n\n        const worksheet = this._univerInstanceService\n            .getUniverSheetInstance(unitId)\n            ?.getSheetBySheetId(subUnitId);\n        if (!worksheet) {\n            return null;\n        }\n\n        const mergeData = worksheet?.getMergeData();\n\n        if (pasteSelectionRangeRowLen % rowCount === 0 && pasteSelectionRangeColLen % colCount === 0) {\n            const hasLapWithMerge = mergeData?.some((merge) => rangeIntersectWithDiscreteRange(merge, discreteRange));\n            if (!hasLapWithMerge) {\n                for (let r = 0; r < pasteSelectionRangeRowLen; r++) {\n                    for (let c = 0; c < pasteSelectionRangeColLen; c++) {\n                        const cell = cellMatrix.getValue(r % rowCount, c % colCount);\n                        cell && cellMatrix.setValue(r, c, cell);\n                    }\n                }\n                return {\n                    pastedRange: discreteRange,\n                    unitId,\n                    subUnitId,\n                };\n            }\n        }\n        const newDiscreteRange = this._expandOrShrinkRowsCols(unitId, subUnitId, discreteRange, colCount, rowCount);\n\n        discreteRange.rows = newDiscreteRange.rows;\n        discreteRange.cols = newDiscreteRange.cols;\n\n        return {\n            pastedRange: discreteRange,\n            unitId,\n            subUnitId,\n        };\n    }\n\n    private _expandOrShrinkRowsCols(unitId: string, subUnitId: string, range: IDiscreteRange, colCount: number, rowCount: number) {\n        const { rows, cols } = range;\n        const workbook = this._univerInstanceService.getUniverSheetInstance(unitId);\n        const worksheet = workbook?.getSheetBySheetId(subUnitId);\n        let newRows: number[];\n        let newCols: number[];\n        if (rows.length >= rowCount) {\n            newRows = rows.slice(0, rowCount);\n        } else {\n            newRows = rows.slice(0);\n            let rowIndex = rows[rows.length - 1] + 1;\n            while (newRows.length < rowCount) {\n                if (!worksheet!.getRowFiltered(rowIndex)) {\n                    newRows.push(rowIndex);\n                }\n                rowIndex++;\n            }\n        }\n\n        if (cols.length >= colCount) {\n            newCols = cols.slice(0, colCount);\n        } else {\n            newCols = cols.slice(0);\n            let colIndex = cols[cols.length - 1] + 1;\n            while (newCols.length < colCount) {\n                newCols.push(colIndex);\n                colIndex++;\n            }\n        }\n\n        return {\n            rows: newRows,\n            cols: newCols,\n        };\n    }\n\n    /**\n     * Determine whether the cells starting from the upper left corner of the range (merged or non-merged or combined) are consistent with the size of the original data\n     * @param cellMatrix\n     * @param range\n     */\n    private _topLeftCellsMatch(rowCount: number, colCount: number, range: { topRow: number; leftCol: number }): boolean {\n        const workbook = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n        const worksheet = workbook?.getActiveSheet();\n        if (!worksheet) {\n            return false;\n        }\n\n        const { topRow, leftCol } = range;\n        const isRowAcross = rowAcrossMergedCell(\n            topRow + rowCount - 1,\n            leftCol,\n            leftCol + colCount - 1,\n            worksheet\n        );\n        const isColAcross = columnAcrossMergedCell(\n            leftCol + colCount - 1,\n            topRow,\n            topRow + rowCount - 1,\n            worksheet\n        );\n\n        return !isRowAcross && !isColAcross;\n    }\n\n    removeMarkSelection() {\n        if (this._copyMarkId) {\n            this._markSelectionService.removeShape(this._copyMarkId);\n            this._copyMarkId = null;\n        }\n    }\n\n    private _initUnitDisposed() {\n        this.disposeWithMe(\n            this._univerInstanceService.getTypeOfUnitDisposed$<Workbook>(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) => {\n                if (workbook) {\n                    const copyCache = this.copyContentCache();\n                    copyCache.clearWithUnitId(workbook.getUnitId());\n                }\n            })\n        );\n    }\n\n    disposePasteOptionsCache() {\n        this.setShowMenu(false);\n        this.updatePasteOptionsCache(null);\n    }\n}\n\n// #region copy generation\n\nexport function getMatrixPlainText(matrix: ObjectMatrix<ICellDataWithSpanAndDisplay>) {\n    let plain = '';\n    const matrixLength = matrix.getLength();\n    matrix.forRow((row, cols) => {\n        const arr: string[] = [];\n        cols.forEach((col) => {\n            const cell = matrix.getValue(row, col);\n            if (cell) {\n                const cellText = getCellTextForClipboard(cell);\n                arr.push(cellText);\n            }\n        });\n        plain += arr.join('\\t');\n        if (row !== matrixLength - 1) {\n            plain += '\\n';\n        }\n    });\n\n    return plain;\n}\n\nfunction getCellTextForClipboard(cell: ICellDataWithSpanAndDisplay) {\n    if (isNotNullOrUndefined(cell.displayV)) {\n        return cell.displayV;\n    }\n    return extractPureTextFromCell(cell);\n}\n\nexport const escapeSpecialCode = (cellStr: string) =>\n    cellStr\n        .replace(/&/g, '&amp;')\n        .replace(/\\uFEFF/g, '')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;');\n\nfunction rowAcrossMergedCell(row: number, startColumn: number, endColumn: number, worksheet: Worksheet): boolean {\n    return worksheet\n        .getMergeData()\n        .some(\n            (mergedCell) =>\n                mergedCell.startRow <= row &&\n                row < mergedCell.endRow &&\n                startColumn <= mergedCell.startColumn &&\n                mergedCell.startColumn <= endColumn\n        );\n}\n\nfunction columnAcrossMergedCell(col: number, startRow: number, endRow: number, worksheet: Worksheet): boolean {\n    return worksheet\n        .getMergeData()\n        .some(\n            (mergedCell) =>\n                mergedCell.startColumn <= col &&\n                col < mergedCell.endColumn &&\n                startRow <= mergedCell.startRow &&\n                mergedCell.startRow <= endRow\n        );\n}\n\n/**\n * Determine whether CellMatrix consists of multiple cells, it must consist of 2 or more cells. It can be an ordinary cell or merge cell\n * @param cellMatrix\n */\nfunction isMultipleCells(cellMatrix: ObjectMatrix<ICellDataWithSpanAndDisplay>): boolean {\n    let count = 0;\n    cellMatrix.forValue((row, col, cell) => {\n        if (cell) {\n            count++;\n        }\n\n        if (count > 1) {\n            return false;\n        }\n    });\n    return count > 1;\n}\n\n// #endregion\n\nfunction getEmptyCell(): ICellData {\n    return {\n        p: null,\n        v: null,\n        s: null,\n        f: null,\n        si: null,\n        t: null,\n    };\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, ICommand, IMultiCommand } from '@univerjs/core';\nimport { CommandType, ICommandService } from '@univerjs/core';\nimport { CopyCommand, CutCommand, IClipboardInterfaceService, PasteCommand, SheetPasteShortKeyCommandName } from '@univerjs/ui';\n\nimport { whenSheetFocused } from '../../controllers/shortcuts/utils';\nimport { ISheetClipboardService, PREDEFINED_HOOK_NAME } from '../../services/clipboard/clipboard.service';\n\nconst SHEET_CLIPBOARD_PRIORITY = 998;\n\nexport const SheetCopyCommand: IMultiCommand = {\n    id: CopyCommand.id,\n    name: 'sheet.command.copy',\n    type: CommandType.COMMAND,\n    multi: true,\n    priority: SHEET_CLIPBOARD_PRIORITY,\n    preconditions: whenSheetFocused,\n    handler: async (accessor) => {\n        const sheetClipboardService = accessor.get(ISheetClipboardService);\n        return sheetClipboardService.copy();\n    },\n};\n\nexport const SheetCutCommand: IMultiCommand = {\n    id: CutCommand.id,\n    name: 'sheet.command.cut',\n    type: CommandType.COMMAND,\n    multi: true,\n    priority: SHEET_CLIPBOARD_PRIORITY,\n    preconditions: whenSheetFocused,\n    handler: async (accessor) => {\n        const sheetClipboardService = accessor.get(ISheetClipboardService);\n        return sheetClipboardService.cut();\n    },\n};\n\nexport interface ISheetPasteParams {\n    value: string;\n}\n\nexport interface ISheetPasteByShortKeyParams {\n    htmlContent?: string;\n    textContent?: string;\n    files?: File[];\n}\n\nexport const SheetPasteCommand: IMultiCommand = {\n    id: PasteCommand.id,\n    type: CommandType.COMMAND,\n    multi: true,\n    name: 'sheet.command.paste',\n    priority: SHEET_CLIPBOARD_PRIORITY,\n    preconditions: whenSheetFocused,\n    handler: async (accessor: IAccessor, params: ISheetPasteParams) => {\n        // const messageService = accessor.get(IMessageService);\n\n        // TODO: @yuhongz: check if there is excel content in the clipboard, if so\n        // ask users to use shortcuts instead.\n\n        const clipboardInterfaceService = accessor.get(IClipboardInterfaceService);\n        const clipboardItems = await clipboardInterfaceService.read();\n        const sheetClipboardService = accessor.get(ISheetClipboardService);\n\n        if (clipboardItems.length !== 0) {\n            return sheetClipboardService.paste(clipboardItems[0], params?.value);\n        }\n\n        return false;\n    },\n};\n\nexport const SheetPasteShortKeyCommand: ICommand = {\n    id: SheetPasteShortKeyCommandName,\n    type: CommandType.COMMAND,\n    handler: async (accessor: IAccessor, params: ISheetPasteByShortKeyParams) => {\n        const clipboardService = accessor.get(ISheetClipboardService);\n        const { htmlContent, textContent, files } = params;\n        clipboardService.legacyPaste(htmlContent, textContent, files);\n\n        return true;\n    },\n};\n\nexport const SheetPasteValueCommand: ICommand = {\n    id: 'sheet.command.paste-value',\n    type: CommandType.COMMAND,\n    handler: async (accessor) => {\n        const commandService = accessor.get(ICommandService);\n        return commandService.executeCommand(SheetPasteCommand.id, { value: PREDEFINED_HOOK_NAME.SPECIAL_PASTE_VALUE });\n    },\n};\n\nexport const SheetPasteFormatCommand: ICommand = {\n    id: 'sheet.command.paste-format',\n    type: CommandType.COMMAND,\n    handler: async (accessor) => {\n        const commandService = accessor.get(ICommandService);\n        return commandService.executeCommand(SheetPasteCommand.id, {\n            value: PREDEFINED_HOOK_NAME.SPECIAL_PASTE_FORMAT,\n        });\n    },\n};\n\nexport const SheetPasteColWidthCommand: ICommand = {\n    id: 'sheet.command.paste-col-width',\n    type: CommandType.COMMAND,\n    handler: async (accessor) => {\n        const commandService = accessor.get(ICommandService);\n        return commandService.executeCommand(SheetPasteCommand.id, {\n            value: PREDEFINED_HOOK_NAME.SPECIAL_PASTE_COL_WIDTH,\n        });\n    },\n};\n\nexport const SheetPasteBesidesBorderCommand: ICommand = {\n    id: 'sheet.command.paste-besides-border',\n    type: CommandType.COMMAND,\n    handler: async (accessor) => {\n        const commandService = accessor.get(ICommandService);\n        return commandService.executeCommand(SheetPasteCommand.id, {\n            value: PREDEFINED_HOOK_NAME.SPECIAL_PASTE_BESIDES_BORDER,\n        });\n    },\n};\n\nexport const SheetOptionalPasteCommand: ICommand = {\n    id: 'sheet.command.optional-paste',\n    type: CommandType.COMMAND,\n    handler: async (accessor, { type }: { type: keyof typeof PREDEFINED_HOOK_NAME }) => {\n        const clipboardService = accessor.get(ISheetClipboardService);\n\n        return clipboardService.rePasteWithPasteType(type);\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, IPermissionTypes, IRange, Nullable, Workbook, WorkbookPermissionPointConstructor, Worksheet } from '@univerjs/core';\nimport type { Observable } from 'rxjs';\nimport { FOCUSING_COMMON_DRAWINGS, FOCUSING_FX_BAR_EDITOR, IContextService, IPermissionService, IUniverInstanceService, Rectangle, Tools, UniverInstanceType, UserManagerService } from '@univerjs/core';\nimport { IExclusiveRangeService, RangeProtectionPermissionEditPoint, RangeProtectionRuleModel, SheetsSelectionsService, WorkbookEditablePermission, WorksheetEditPermission, WorksheetProtectionRuleModel } from '@univerjs/sheets';\nimport { BehaviorSubject, combineLatest, merge, of } from 'rxjs';\nimport { debounceTime, finalize, map, startWith, switchMap } from 'rxjs/operators';\nimport { IEditorBridgeService } from '../../services/editor-bridge.service';\n\ninterface IActive {\n    workbook: Workbook;\n    worksheet: Worksheet;\n}\n\nfunction getActiveSheet$(univerInstanceService: IUniverInstanceService): Observable<Nullable<IActive>> {\n    return univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET).pipe(switchMap((workbook) =>\n        workbook\n            ? workbook.activeSheet$.pipe(map((worksheet) => {\n                if (!worksheet) return null;\n                return { workbook, worksheet };\n            }))\n            : of(null)));\n}\n\nexport function deriveStateFromActiveSheet$<T>(univerInstanceService: IUniverInstanceService, defaultValue: T, callback: (active: IActive) => Observable<T>) {\n    return getActiveSheet$(univerInstanceService).pipe(switchMap((active) => {\n        if (!active) return of(defaultValue);\n        return callback(active);\n    }));\n}\n\n/**\n * @description Get the current exclusive range disable status\n * @param accessor The accessor\n * @param {Set<string>} [disableGroupSet] The disable group set, if provided, check if the interestGroupIds contains any of the disableGroupSet, otherwise check if the interestGroupIds is not empty\n * @returns {Observable<boolean>} The current exclusive range disable status\n */\nexport function getCurrentExclusiveRangeInterest$(accessor: IAccessor, disableGroupSet?: Set<string>) {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const exclusiveRangeService = accessor.get(IExclusiveRangeService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const workbook$ = univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET);\n\n    return workbook$.pipe(\n        switchMap((workbook) => {\n            if (!workbook) {\n                return of(false);\n            }\n            return combineLatest([selectionManagerService.selectionMoveEnd$, workbook.activeSheet$]).pipe(\n                switchMap(([selections, worksheet]) => {\n                    if (!worksheet) {\n                        return of(false);\n                    }\n                    if (selections.length === 0) {\n                        return of(false);\n                    }\n\n                    const interestGroupIds = exclusiveRangeService.getInterestGroupId(selections);\n                    // if disableGroupSet is provided, check if the interestGroupIds contains any of the disableGroupSet\n                    if (disableGroupSet) {\n                        const disableGroup = interestGroupIds.filter((groupId) => disableGroupSet.has(groupId));\n                        return of(disableGroup.length > 0);\n                    } else {\n                        return of(interestGroupIds.length > 0);\n                    }\n                })\n            );\n        })\n    );\n}\n\n/**\n * Get the observable combine with exclusive range\n * @param accessor The accessor\n * @param {Observable<boolean>} observable$\n * @param {Set<string>} [disableGroupSet] The disable group set, if provided, check if the interestGroupIds contains any of the disableGroupSet, otherwise check if the interestGroupIds is not empty\n * @returns {Observable<boolean>} The observable combine with exclusive range\n */\nexport function getObservableWithExclusiveRange$(accessor: IAccessor, observable$: Observable<boolean>, disableGroupSet?: Set<string>): Observable<boolean> {\n    return combineLatest([observable$, getCurrentExclusiveRangeInterest$(accessor, disableGroupSet)]).pipe(\n        map(([observable, exclusiveRangeDisable]) => observable || exclusiveRangeDisable)\n    );\n}\n\n// eslint-disable-next-line max-lines-per-function\nexport function getCurrentRangeDisable$(accessor: IAccessor, permissionTypes: IPermissionTypes = {}, supportCellEdit = false) {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const workbook$ = univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    const userManagerService = accessor.get(UserManagerService);\n    const editorBridgeService = accessor.has(IEditorBridgeService) ? accessor.get(IEditorBridgeService) : null;\n    const contextService = accessor.get(IContextService);\n    const formulaEditorFocus$ = new BehaviorSubject<boolean>(false);\n    const editorVisible$ = editorBridgeService?.visible$ ?? of(null);\n\n    const subscription = contextService.subscribeContextValue$(FOCUSING_FX_BAR_EDITOR).subscribe((visible) => {\n        formulaEditorFocus$.next(visible);\n    });\n\n    const observable = combineLatest([userManagerService.currentUser$, workbook$, editorVisible$, formulaEditorFocus$]).pipe(\n        finalize(() => {\n            subscription.unsubscribe();\n            formulaEditorFocus$.complete();\n        }),\n        switchMap(([_, workbook, visible, formulaEditorFocus]) => {\n            if (\n                !workbook ||\n                (visible?.visible && visible.unitId === workbook.getUnitId() && !supportCellEdit) ||\n                (formulaEditorFocus && !supportCellEdit)\n            ) {\n                return of(true);\n            }\n\n            return workbook.activeSheet$.pipe(\n                switchMap((worksheet) => {\n                    if (!worksheet) {\n                        return of(true);\n                    }\n\n                    const selectionManagerService = accessor.get(SheetsSelectionsService);\n                    const rangeProtectionRuleModel = accessor.get(RangeProtectionRuleModel);\n                    const worksheetRuleModel = accessor.get(WorksheetProtectionRuleModel);\n\n                    const contextService = accessor.get(IContextService);\n                    const focusedOnDrawing$ = contextService.subscribeContextValue$(FOCUSING_COMMON_DRAWINGS).pipe(startWith(false));\n\n                    return combineLatest([selectionManagerService.selectionMoveEnd$, focusedOnDrawing$]).pipe(\n                        switchMap(([selection, focusOnDrawings]) => {\n                            if (focusOnDrawings) {\n                                return of(true);\n                            }\n\n                            const unitId = workbook.getUnitId();\n                            const subUnitId = worksheet.getSheetId();\n\n                            const permissionService = accessor.get(IPermissionService);\n\n                            const { workbookTypes = [WorkbookEditablePermission], worksheetTypes, rangeTypes } = permissionTypes;\n\n                            const permissionIds: string[] = [];\n\n                            workbookTypes?.forEach((F) => {\n                                permissionIds.push(new F(unitId).id);\n                            });\n\n                            worksheetTypes?.forEach((F) => {\n                                permissionIds.push(new F(unitId, subUnitId).id);\n                            });\n\n                            const worksheetRule = worksheetRuleModel.getRule(unitId, subUnitId);\n\n                            if (worksheetRule) {\n                                return permissionService.composePermission$(permissionIds).pipe(map((list) => {\n                                    return list.some((item) => item.value === false);\n                                }));\n                            }\n\n                            const selectionRanges = selection?.map((selection) => selection.range);\n                            const rules = rangeProtectionRuleModel.getSubunitRuleList(unitId, subUnitId).filter((rule) => {\n                                return selectionRanges?.some((range) => {\n                                    return rule.ranges.some((ruleRange) => Rectangle.intersects(range, ruleRange));\n                                });\n                            });\n\n                            rangeTypes?.forEach((F) => {\n                                rules.forEach((rule) => {\n                                    permissionIds.push(new F(unitId, subUnitId, rule.permissionId).id);\n                                });\n                            });\n\n                            return permissionService.composePermission$(permissionIds).pipe(map((list) => {\n                                return list.some((item) => item.value === false);\n                            }));\n                        })\n                    );\n                })\n            );\n        })\n    );\n\n    return observable;\n}\n\nexport function getBaseRangeMenuHidden$(accessor: IAccessor) {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const rangeProtectionRuleModel = accessor.get(RangeProtectionRuleModel);\n    const permissionService = accessor.get(IPermissionService);\n\n    return merge(selectionManagerService.selectionMoveEnd$, permissionService.permissionPointUpdate$.pipe(debounceTime(100))).pipe(\n        map(() => {\n            const range = selectionManagerService.getCurrentLastSelection()?.range;\n            if (!range) return true;\n\n            const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n            const worksheet = workbook?.getActiveSheet();\n            if (!workbook || !worksheet) {\n                return true;\n            }\n\n            const unitId = workbook.getUnitId();\n            const subUnitId = worksheet.getSheetId();\n\n            const permissionIds: string[] = [new WorkbookEditablePermission(unitId).id, new WorksheetEditPermission(unitId, subUnitId).id];\n\n            rangeProtectionRuleModel.getSubunitRuleList(unitId, subUnitId).filter((rule) => {\n                return rule.ranges.some((ruleRange) => Rectangle.intersects(range, ruleRange));\n            }).forEach((rule) => {\n                permissionIds.push(new RangeProtectionPermissionEditPoint(unitId, subUnitId, rule.permissionId).id);\n            });\n\n            return permissionService.composePermission(permissionIds).some((item) => item.value === false);\n        })\n    );\n}\n\nexport function getInsertAfterMenuHidden$(accessor: IAccessor, type: 'row' | 'col') {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const rangeProtectionRuleModel = accessor.get(RangeProtectionRuleModel);\n    const permissionService = accessor.get(IPermissionService);\n\n    return merge(selectionManagerService.selectionMoveEnd$, permissionService.permissionPointUpdate$.pipe(debounceTime(100))).pipe(\n        map(() => {\n            const range = selectionManagerService.getCurrentLastSelection()?.range;\n            if (!range) return true;\n\n            const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n            const worksheet = workbook?.getActiveSheet();\n            if (!workbook || !worksheet) {\n                return true;\n            }\n\n            const unitId = workbook.getUnitId();\n            const subUnitId = worksheet.getSheetId();\n\n            const permissionIds: string[] = [new WorkbookEditablePermission(unitId).id, new WorksheetEditPermission(unitId, subUnitId).id];\n\n            rangeProtectionRuleModel.getSubunitRuleList(unitId, subUnitId).filter((rule) => {\n                if (type === 'row') {\n                    return rule.ranges.some((ruleRange) => {\n                        return range.endRow > ruleRange.startRow && range.endRow <= ruleRange.endRow;\n                    });\n                } else {\n                    return rule.ranges.some((ruleRange) => {\n                        return range.endColumn > ruleRange.startColumn && range.endColumn <= ruleRange.endColumn;\n                    });\n                }\n            }).forEach((rule) => {\n                permissionIds.push(new RangeProtectionPermissionEditPoint(unitId, subUnitId, rule.permissionId).id);\n            });\n\n            return permissionService.composePermission(permissionIds).some((item) => item.value === false);\n        })\n    );\n}\n\nexport function getInsertBeforeMenuHidden$(accessor: IAccessor, type: 'row' | 'col') {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const rangeProtectionRuleModel = accessor.get(RangeProtectionRuleModel);\n    const permissionService = accessor.get(IPermissionService);\n\n    return merge(selectionManagerService.selectionMoveEnd$, permissionService.permissionPointUpdate$.pipe(debounceTime(100))).pipe(\n        map(() => {\n            const range = selectionManagerService.getCurrentLastSelection()?.range;\n            if (!range) return true;\n\n            const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n            const worksheet = workbook?.getActiveSheet();\n            if (!workbook || !worksheet) {\n                return true;\n            }\n\n            const unitId = workbook.getUnitId();\n            const subUnitId = worksheet.getSheetId();\n\n            const permissionIds: string[] = [new WorkbookEditablePermission(unitId).id, new WorksheetEditPermission(unitId, subUnitId).id];\n\n            rangeProtectionRuleModel.getSubunitRuleList(unitId, subUnitId).filter((rule) => {\n                if (type === 'row') {\n                    return rule.ranges.some((ruleRange) => {\n                        return range.startRow > ruleRange.startRow && range.startRow <= ruleRange.endRow;\n                    });\n                } else {\n                    return rule.ranges.some((ruleRange) => {\n                        return range.startColumn > ruleRange.startColumn && range.startColumn <= ruleRange.endColumn;\n                    });\n                }\n            }).forEach((rule) => {\n                permissionIds.push(new RangeProtectionPermissionEditPoint(unitId, subUnitId, rule.permissionId).id);\n            });\n\n            return permissionService.composePermission(permissionIds).some((item) => item.value === false);\n        })\n    );\n}\n\nexport function getDeleteMenuHidden$(accessor: IAccessor, type: 'row' | 'col') {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const rangeProtectionRuleModel = accessor.get(RangeProtectionRuleModel);\n\n    const permissionService = accessor.get(IPermissionService);\n\n    return merge(selectionManagerService.selectionMoveEnd$, permissionService.permissionPointUpdate$.pipe(debounceTime(100))).pipe(\n        map(() => {\n            const range = selectionManagerService.getCurrentLastSelection()?.range;\n            if (!range) return true;\n\n            const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n            const worksheet = workbook?.getActiveSheet();\n            if (!workbook || !worksheet) {\n                return true;\n            }\n\n            const unitId = workbook.getUnitId();\n            const subUnitId = worksheet.getSheetId();\n\n            const permissionIds: string[] = [new WorkbookEditablePermission(unitId).id, new WorksheetEditPermission(unitId, subUnitId).id];\n\n            const rowColRangeExpand = Tools.deepClone(range) as IRange;\n\n            if (type === 'row') {\n                rowColRangeExpand.startColumn = 0;\n                rowColRangeExpand.endColumn = worksheet.getColumnCount() - 1;\n            } else {\n                rowColRangeExpand.startRow = 0;\n                rowColRangeExpand.endRow = worksheet.getRowCount() - 1;\n            }\n\n            rangeProtectionRuleModel.getSubunitRuleList(unitId, subUnitId).filter((rule) => {\n                return rule.ranges.some((ruleRange) => Rectangle.intersects(rowColRangeExpand, ruleRange));\n            }).forEach((rule) => {\n                permissionIds.push(new RangeProtectionPermissionEditPoint(unitId, subUnitId, rule.permissionId).id);\n            });\n\n            return permissionService.composePermission(permissionIds).some((item) => item.value === false);\n        })\n    );\n}\n\nexport function getCellMenuHidden$(accessor: IAccessor, type: 'row' | 'col') {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const rangeProtectionRuleModel = accessor.get(RangeProtectionRuleModel);\n\n    const permissionService = accessor.get(IPermissionService);\n\n    return merge(selectionManagerService.selectionMoveEnd$, permissionService.permissionPointUpdate$.pipe(debounceTime(100))).pipe(\n        map(() => {\n            const range = selectionManagerService.getCurrentLastSelection()?.range;\n            if (!range) return true;\n\n            const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n            const worksheet = workbook?.getActiveSheet();\n            if (!workbook || !worksheet) {\n                return true;\n            }\n\n            const unitId = workbook.getUnitId();\n            const subUnitId = worksheet.getSheetId();\n\n            const permissionIds: string[] = [new WorkbookEditablePermission(unitId).id, new WorksheetEditPermission(unitId, subUnitId).id];\n\n            const rowColRangeExpand = Tools.deepClone(range) as IRange;\n            if (type === 'row') {\n                rowColRangeExpand.endRow = worksheet.getRowCount() - 1;\n            } else {\n                rowColRangeExpand.endColumn = worksheet.getColumnCount() - 1;\n            }\n\n            rangeProtectionRuleModel.getSubunitRuleList(unitId, subUnitId).filter((rule) => {\n                return rule.ranges.some((ruleRange) => Rectangle.intersects(rowColRangeExpand, ruleRange));\n            }).forEach((rule) => {\n                permissionIds.push(new RangeProtectionPermissionEditPoint(unitId, subUnitId, rule.permissionId).id);\n            });\n\n            return permissionService.composePermission(permissionIds).some((item) => item.value === false);\n        })\n    );\n}\n\nexport function getWorkbookPermissionDisable$(accessor: IAccessor, workbookPermissionTypes: WorkbookPermissionPointConstructor[]) {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const workbook$ = univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n    const worksheetRuleModel = accessor.get(WorksheetProtectionRuleModel);\n    const selectionRuleModel = accessor.get(RangeProtectionRuleModel);\n    const permissionService = accessor.get(IPermissionService);\n    const userManagerService = accessor.get(UserManagerService);\n\n    return combineLatest([userManagerService.currentUser$, workbook$]).pipe(\n        switchMap(([_user, workbook]) => {\n            if (!workbook) {\n                return of(true);\n            }\n            return workbook.activeSheet$.pipe(\n                switchMap((activeSheet) => {\n                    if (!activeSheet) {\n                        return of(true);\n                    }\n                    const unitId = workbook.getUnitId();\n                    const workbookPermissionIds: string[] = [];\n                    workbookPermissionTypes.forEach((F) => workbookPermissionIds.push(new F(unitId).id));\n                    const workbookPermission$ = permissionService.composePermission$(workbookPermissionIds).pipe(map((list) => list.every((item) => item.value === true)));\n\n                    return workbookPermission$.pipe(\n                        map((basePermission) => {\n                            if (!basePermission) {\n                                return true;\n                            }\n\n                            const subUnitId = activeSheet.getSheetId();\n                            const worksheetRule = worksheetRuleModel.getRule(unitId, subUnitId);\n                            const rangeRuleList = selectionRuleModel.getSubunitRuleList(unitId, subUnitId);\n                            if (worksheetRule || rangeRuleList.length) {\n                                return true;\n                            }\n                            return false;\n                        })\n                    );\n                })\n            );\n        })\n    );\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor } from '@univerjs/core';\nimport type { IBorderInfo } from '@univerjs/sheets';\nimport type { IMenuSelectorItem } from '@univerjs/ui';\nimport { ICommandService, UniverInstanceType } from '@univerjs/core';\nimport { BorderStyleManagerService, RangeProtectionPermissionEditPoint, SetBorderBasicCommand, WorkbookEditablePermission, WorksheetEditPermission, WorksheetSetCellStylePermission } from '@univerjs/sheets';\nimport { getMenuHiddenObservable, MenuItemType } from '@univerjs/ui';\nimport { Observable } from 'rxjs';\n\nimport { BORDER_LINE_CHILDREN, BORDER_PANEL_COMPONENT } from '../../components/border-panel/interface';\nimport { getCurrentRangeDisable$ } from './menu-util';\n\nexport function CellBorderSelectorMenuItemFactory(accessor: IAccessor): IMenuSelectorItem<IBorderInfo, IBorderInfo> {\n    const borderStyleManagerService = accessor.get(BorderStyleManagerService);\n\n    const disabled$ = getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] });\n\n    return {\n        id: SetBorderBasicCommand.id,\n        icon: new Observable<string>((subscriber) => {\n            const defaultIcon = 'AllBorderSingle';\n            const borderManager = accessor.get(BorderStyleManagerService);\n\n            const disposable = accessor.get(ICommandService).onCommandExecuted((c) => {\n                const id = c.id;\n                if (id !== SetBorderBasicCommand.id) {\n                    return;\n                }\n\n                const { type } = borderManager.getBorderInfo();\n\n                const item = BORDER_LINE_CHILDREN.find((item) => item.value === type);\n\n                const icon = item?.icon ?? defaultIcon;\n\n                subscriber.next(icon);\n            });\n\n            subscriber.next(defaultIcon);\n\n            return disposable.dispose;\n        }),\n        tooltip: 'toolbar.border.main',\n        type: MenuItemType.BUTTON_SELECTOR,\n        slot: true,\n        selections: [\n            {\n                label: {\n                    name: BORDER_PANEL_COMPONENT,\n                    hoverable: false,\n                    selectable: false,\n                },\n                value$: borderStyleManagerService.borderInfo$,\n            },\n        ],\n        value$: borderStyleManagerService.borderInfo$,\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n        disabled$,\n    };\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ClearSelectionAllCommand, ClearSelectionContentCommand, ClearSelectionFormatCommand, RangeProtectionPermissionEditPoint, WorkbookEditablePermission, WorksheetEditPermission, WorksheetSetCellStylePermission, WorksheetSetCellValuePermission } from '@univerjs/sheets';\nimport type { IMenuButtonItem, IMenuSelectorItem } from '@univerjs/ui';\nimport { getMenuHiddenObservable, MenuItemType } from '@univerjs/ui';\n\nimport type { IAccessor } from '@univerjs/core';\nimport { UniverInstanceType } from '@univerjs/core';\nimport { getCurrentRangeDisable$, getObservableWithExclusiveRange$ } from './menu-util';\n\nexport const CLEAR_SELECTION_MENU_ID = 'sheet.menu.clear-selection';\nexport function ClearSelectionMenuItemFactory(accessor: IAccessor): IMenuSelectorItem<string> {\n    return {\n        id: CLEAR_SELECTION_MENU_ID,\n        type: MenuItemType.SUBITEMS,\n        icon: 'ClearFormat',\n        title: 'rightClick.clearSelection',\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function ClearSelectionContentMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: ClearSelectionContentCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.clearContent',\n        disabled$: getObservableWithExclusiveRange$(accessor, getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellValuePermission], rangeTypes: [RangeProtectionPermissionEditPoint] })),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\nexport function ClearSelectionFormatMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: ClearSelectionFormatCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.clearFormat',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\nexport function ClearSelectionAllMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: ClearSelectionAllCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.clearAll',\n        disabled$: getObservableWithExclusiveRange$(accessor, getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellValuePermission, WorksheetSetCellStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] })),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor } from '@univerjs/core';\nimport type { IMenuButtonItem, IMenuSelectorItem } from '@univerjs/ui';\n\nimport { RangeProtectionPermissionEditPoint, WorkbookEditablePermission, WorksheetDeleteColumnPermission, WorksheetDeleteRowPermission, WorksheetEditPermission } from '@univerjs/sheets';\nimport { MenuItemType } from '@univerjs/ui';\nimport { DeleteRangeMoveLeftConfirmCommand } from '../../commands/commands/delete-range-move-left-confirm.command';\nimport { DeleteRangeMoveUpConfirmCommand } from '../../commands/commands/delete-range-move-up-confirm.command';\nimport {\n    RemoveColConfirmCommand,\n    RemoveRowConfirmCommand,\n} from '../../commands/commands/remove-row-col-confirm.command';\nimport { getBaseRangeMenuHidden$, getCellMenuHidden$, getCurrentRangeDisable$, getDeleteMenuHidden$, getObservableWithExclusiveRange$ } from './menu-util';\n\nexport const DELETE_RANGE_MENU_ID = 'sheet.menu.delete';\nexport function DeleteRangeMenuItemFactory(accessor: IAccessor): IMenuSelectorItem<string> {\n    return {\n        id: DELETE_RANGE_MENU_ID,\n        type: MenuItemType.SUBITEMS,\n        title: 'rightClick.delete',\n        icon: 'Reduce',\n        hidden$: getObservableWithExclusiveRange$(accessor, getBaseRangeMenuHidden$(accessor)),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission] }),\n    };\n}\n\nexport function RemoveColMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: RemoveColConfirmCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: 'DeleteColumn',\n        title: 'rightClick.deleteSelectedColumn',\n        hidden$: getObservableWithExclusiveRange$(accessor, getDeleteMenuHidden$(accessor, 'col')),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetDeleteColumnPermission] }),\n    };\n}\n\nexport function RemoveRowMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: RemoveRowConfirmCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: 'DeleteRow',\n        title: 'rightClick.deleteSelectedRow',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetDeleteRowPermission] }),\n        hidden$: getDeleteMenuHidden$(accessor, 'row'),\n    };\n}\n\nexport function DeleteRangeMoveLeftMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: DeleteRangeMoveLeftConfirmCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.moveLeft',\n        icon: 'DeleteCellShiftLeft',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getCellMenuHidden$(accessor, 'col'),\n    };\n}\n\nexport function DeleteRangeMoveUpMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: DeleteRangeMoveUpConfirmCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.moveUp',\n        icon: 'DeleteCellShiftUp',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getCellMenuHidden$(accessor, 'row'),\n    };\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, Workbook } from '@univerjs/core';\nimport type { IMenuButtonItem } from '@univerjs/ui';\nimport { BooleanNumber, DisposableCollection, ICommandService, IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport { SetWorksheetActiveOperation, ToggleGridlinesCommand, ToggleGridlinesMutation, WorkbookEditablePermission, WorksheetEditPermission } from '@univerjs/sheets';\nimport { MenuItemType } from '@univerjs/ui';\nimport { Observable } from 'rxjs';\nimport { getCurrentRangeDisable$ } from './menu-util';\n\nexport function ToggleGridlinesMenuFactory(accessor: IAccessor): IMenuButtonItem {\n    const commandService = accessor.get(ICommandService);\n    const instanceService = accessor.get(IUniverInstanceService);\n\n    return {\n        id: ToggleGridlinesCommand.id,\n        type: MenuItemType.BUTTON,\n        tooltip: 'toolbar.toggleGridlines',\n        icon: 'HideGridlines',\n        activated$: new Observable<boolean>((observer) => {\n            const getValue = () => {\n                const workbook = instanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n                if (workbook) return workbook.getActiveSheet().getConfig().showGridlines === BooleanNumber.TRUE;\n                return false;\n            };\n\n            const disposable = new DisposableCollection();\n            disposable.add(commandService.onCommandExecuted((c) => {\n                if (c.id === ToggleGridlinesMutation.id || c.id === SetWorksheetActiveOperation.id) {\n                    observer.next(getValue());\n                }\n            }));\n            disposable.add(instanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET).subscribe(() => {\n                observer.next(getValue());\n            }));\n\n            observer.next(getValue());\n            return () => disposable.dispose();\n        }),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission] }),\n    };\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor } from '@univerjs/core';\nimport type { IMenuButtonItem, IMenuSelectorItem } from '@univerjs/ui';\nimport { ICommandService, IUniverInstanceService } from '@univerjs/core';\nimport {\n    InsertColAfterCommand,\n    InsertColBeforeCommand,\n    InsertMultiColsLeftCommand,\n    InsertMultiRowsAboveCommand,\n    InsertMultiRowsAfterCommand,\n    InsertRowAfterCommand,\n    InsertRowBeforeCommand,\n    RangeProtectionPermissionEditPoint,\n    SetSelectionsOperation,\n    SheetsSelectionsService,\n    WorkbookEditablePermission,\n    WorksheetEditPermission,\n    WorksheetInsertColumnPermission,\n    WorksheetInsertRowPermission,\n} from '@univerjs/sheets';\n\nimport { MenuItemType } from '@univerjs/ui';\nimport { Observable } from 'rxjs';\nimport { InsertRangeMoveDownConfirmCommand } from '../../commands/commands/insert-range-move-down-confirm.command';\nimport { InsertRangeMoveRightConfirmCommand } from '../../commands/commands/insert-range-move-right-confirm.command';\nimport { MENU_ITEM_INPUT_COMPONENT } from '../../components/menu-item-input';\nimport { deriveStateFromActiveSheet$, getBaseRangeMenuHidden$, getCellMenuHidden$, getCurrentRangeDisable$, getInsertAfterMenuHidden$, getInsertBeforeMenuHidden$, getObservableWithExclusiveRange$ } from './menu-util';\n\nexport const COL_INSERT_MENU_ID = 'sheet.menu.col-insert';\nexport function ColInsertMenuItemFactory(accessor: IAccessor): IMenuSelectorItem<string> {\n    return {\n        id: COL_INSERT_MENU_ID,\n        type: MenuItemType.SUBITEMS,\n        title: 'rightClick.insert',\n        icon: 'Insert',\n        hidden$: getBaseRangeMenuHidden$(accessor),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetInsertColumnPermission] }),\n    };\n}\n\nexport const ROW_INSERT_MENU_ID = 'sheet.menu.row-insert';\nexport function RowInsertMenuItemFactory(accessor: IAccessor): IMenuSelectorItem<string> {\n    return {\n        id: ROW_INSERT_MENU_ID,\n        type: MenuItemType.SUBITEMS,\n        title: 'rightClick.insert',\n        icon: 'Insert',\n        hidden$: getBaseRangeMenuHidden$(accessor),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetInsertRowPermission, WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n    };\n}\n\nexport const CELL_INSERT_MENU_ID = 'sheet.menu.cell-insert';\nexport function CellInsertMenuItemFactory(accessor: IAccessor): IMenuSelectorItem<string> {\n    return {\n        id: CELL_INSERT_MENU_ID,\n        type: MenuItemType.SUBITEMS,\n        title: 'rightClick.insert',\n        icon: 'Insert',\n        hidden$: getObservableWithExclusiveRange$(accessor, getBaseRangeMenuHidden$(accessor)),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetInsertColumnPermission, WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n    };\n}\n\n/**\n * context menu when right click cell\n * @param accessor\n * @returns\n */\nexport function InsertRowBeforeMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: InsertRowBeforeCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.insertRowBefore',\n        icon: 'InsertRowAbove',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetInsertRowPermission, WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getInsertBeforeMenuHidden$(accessor, 'row'),\n    };\n}\n\n/**\n * context menu when right click cell\n * @param accessor\n * @returns\n */\nexport function InsertRowBeforeCellMenuItemFactory(accessor: IAccessor): IMenuButtonItem<number> {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const commandService = accessor.get(ICommandService);\n    const defaultValue = 1;\n    return {\n        id: InsertRowBeforeCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: 'InsertRowAbove',\n        label: {\n            name: MENU_ITEM_INPUT_COMPONENT,\n            props: {\n                prefix: 'rightClick.insertRowsAbove',\n                min: 1,\n                max: 1000,\n                suffix: 'rightClick.insertRowsAboveSuffix',\n            },\n        },\n        value$: deriveStateFromActiveSheet$(univerInstanceService, defaultValue, () => new Observable((subscriber) => {\n            function update() {\n                const range = selectionManagerService.getCurrentLastSelection()?.range;\n                let countSelectedRange = defaultValue;\n                if (range) {\n                    countSelectedRange = range?.endRow - range?.startRow + 1;\n                }\n\n                subscriber.next(countSelectedRange);\n            }\n\n            const disposable = commandService.onCommandExecuted((c) => {\n                const id = c.id;\n                if (id === SetSelectionsOperation.id) {\n                    return update();\n                }\n            });\n\n            update();\n            return disposable.dispose;\n        })),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetInsertRowPermission, WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getInsertBeforeMenuHidden$(accessor, 'row'),\n    };\n}\n\nexport function InsertRowAfterMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: InsertRowAfterCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.insertRow',\n        icon: 'InsertRowBelow',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetInsertRowPermission, WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getInsertAfterMenuHidden$(accessor, 'row'),\n    };\n}\n\n/**\n * context menu when right click cell\n * @param accessor\n */\nexport function InsertColLeftCellMenuItemFactory(accessor: IAccessor): IMenuButtonItem<number> {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const commandService = accessor.get(ICommandService);\n    const defaultValue = 1;\n    return {\n        id: InsertColBeforeCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: 'LeftInsertColumn',\n        label: {\n            name: MENU_ITEM_INPUT_COMPONENT,\n            props: {\n                prefix: 'rightClick.insertColsLeft',\n                min: 1,\n                max: 1000,\n                suffix: 'rightClick.insertColsLeftSuffix',\n            },\n        },\n        value$: deriveStateFromActiveSheet$(univerInstanceService, defaultValue, () => new Observable((subscriber) => {\n            function update() {\n                const range = selectionManagerService.getCurrentLastSelection()?.range;\n                let countSelectedRange = defaultValue;\n                if (range) {\n                    countSelectedRange = range?.endColumn - range?.startColumn + 1;\n                }\n\n                subscriber.next(countSelectedRange);\n            }\n\n            const disposable = commandService.onCommandExecuted((c) => {\n                const id = c.id;\n                if (id === SetSelectionsOperation.id) {\n                    return update();\n                }\n            });\n\n            update();\n            return disposable.dispose;\n        })),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetInsertColumnPermission, WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getInsertBeforeMenuHidden$(accessor, 'col'),\n    };\n}\n\nexport function InsertColBeforeMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: InsertColBeforeCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.insertColumnBefore',\n        icon: 'LeftInsertColumn',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetInsertColumnPermission, WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getInsertBeforeMenuHidden$(accessor, 'col'),\n    };\n}\n\nexport function InsertColAfterMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: InsertColAfterCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.insertColumn',\n        icon: 'RightInsertColumn',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetInsertColumnPermission, WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getInsertAfterMenuHidden$(accessor, 'col'),\n    };\n}\n\nexport function InsertRangeMoveRightMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: InsertRangeMoveRightConfirmCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.moveRight',\n        icon: 'InsertCellShiftRight',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getCellMenuHidden$(accessor, 'col'),\n    };\n}\n\n/**\n * For insert range in cell context menu\n * @param accessor\n */\nexport function InsertRangeMoveDownMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: InsertRangeMoveDownConfirmCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.moveDown',\n        icon: 'InsertCellDown',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getCellMenuHidden$(accessor, 'row'),\n    };\n}\n\n/**\n * Context menu in rowheader.\n * @param accessor\n */\nexport function InsertMultiRowsAfterHeaderMenuItemFactory(accessor: IAccessor): IMenuButtonItem<number> {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const commandService = accessor.get(ICommandService);\n    const defaultValue = 1;\n    return {\n        id: InsertMultiRowsAfterCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: 'InsertRowBelow',\n        label: {\n            name: MENU_ITEM_INPUT_COMPONENT,\n            props: {\n                prefix: 'rightClick.insertRowsAfter',\n                min: 1,\n                max: 1000,\n                suffix: 'rightClick.insertRowsAfterSuffix',\n            },\n        },\n        value$: deriveStateFromActiveSheet$(univerInstanceService, defaultValue, () => new Observable((subscriber) => {\n            function update() {\n                const range = selectionManagerService.getCurrentLastSelection()?.range;\n                let countSelectedRange = defaultValue;\n                if (range) {\n                    countSelectedRange = range?.endRow - range?.startRow + 1;\n                }\n\n                subscriber.next(countSelectedRange);\n            }\n\n            const disposable = commandService.onCommandExecuted((c) => {\n                const id = c.id;\n                if (id === SetSelectionsOperation.id) {\n                    return update();\n                }\n            });\n\n            update();\n            return disposable.dispose;\n        })),\n\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetInsertRowPermission, WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getBaseRangeMenuHidden$(accessor),\n    };\n}\n\n/**\n * Context menu in rowheader.\n * @param accessor\n */\nexport function InsertMultiRowsAboveHeaderMenuItemFactory(accessor: IAccessor): IMenuButtonItem<number> {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const commandService = accessor.get(ICommandService);\n    const defaultValue = 1;\n    return {\n        id: InsertMultiRowsAboveCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: 'InsertRowAbove',\n        label: {\n            name: MENU_ITEM_INPUT_COMPONENT,\n            props: {\n                prefix: 'rightClick.insertRowsAbove',\n                min: 1,\n                max: 1000,\n                suffix: 'rightClick.insertRowsAboveSuffix',\n            },\n        },\n        value$: deriveStateFromActiveSheet$(univerInstanceService, defaultValue, () => new Observable((subscriber) => {\n            function update() {\n                const range = selectionManagerService.getCurrentLastSelection()?.range;\n                let countSelectedRange = defaultValue;\n                if (range) {\n                    countSelectedRange = range?.endRow - range?.startRow + 1;\n                }\n\n                subscriber.next(countSelectedRange);\n            }\n\n            const disposable = commandService.onCommandExecuted((c) => {\n                const id = c.id;\n                if (id === SetSelectionsOperation.id) {\n                    return update();\n                }\n            });\n\n            update();\n            return disposable.dispose;\n        })),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetInsertRowPermission, WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getBaseRangeMenuHidden$(accessor),\n    };\n}\n\n/**\n * Context menu in rowheader.\n * @param accessor\n */\nexport function InsertMultiColsLeftHeaderMenuItemFactory(accessor: IAccessor): IMenuButtonItem<number> {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const commandService = accessor.get(ICommandService);\n    const defaultValue = 1;\n    return {\n        id: InsertMultiColsLeftCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: 'LeftInsertColumn',\n        label: {\n            name: MENU_ITEM_INPUT_COMPONENT,\n            props: {\n                prefix: 'rightClick.insertColsLeft',\n                min: 1,\n                max: 1000,\n                suffix: 'rightClick.insertColsLeftSuffix',\n            },\n        },\n        value$: deriveStateFromActiveSheet$(univerInstanceService, defaultValue, () => new Observable((subscriber) => {\n            function update() {\n                const range = selectionManagerService.getCurrentLastSelection()?.range;\n                let countSelectedRange = defaultValue;\n                if (range) {\n                    countSelectedRange = range?.endColumn - range?.startColumn + 1;\n                }\n\n                subscriber.next(countSelectedRange);\n            }\n\n            const disposable = commandService.onCommandExecuted((c) => {\n                const id = c.id;\n                if (id === SetSelectionsOperation.id) {\n                    return update();\n                }\n            });\n\n            update();\n            return disposable.dispose;\n        })),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetInsertRowPermission, WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getBaseRangeMenuHidden$(accessor),\n    };\n}\n\n/**\n * Context menu in rowheader.\n * @param accessor\n */\nexport function InsertMultiColsRightHeaderMenuItemFactory(accessor: IAccessor): IMenuButtonItem<number> {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const commandService = accessor.get(ICommandService);\n    const defaultValue = 1;\n    return {\n        id: InsertMultiRowsAboveCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: 'RightInsertColumn',\n        label: {\n            name: MENU_ITEM_INPUT_COMPONENT,\n            props: {\n                prefix: 'rightClick.insertColsRight',\n                min: 1,\n                max: 1000,\n                suffix: 'rightClick.insertColsRightSuffix',\n            },\n        },\n        value$: deriveStateFromActiveSheet$(univerInstanceService, defaultValue, () => new Observable((subscriber) => {\n            function update() {\n                const range = selectionManagerService.getCurrentLastSelection()?.range;\n                let countSelectedRange = defaultValue;\n                if (range) {\n                    countSelectedRange = range?.endColumn - range?.startColumn + 1;\n                }\n\n                subscriber.next(countSelectedRange);\n            }\n\n            const disposable = commandService.onCommandExecuted((c) => {\n                const id = c.id;\n                if (id === SetSelectionsOperation.id) {\n                    return update();\n                }\n            });\n\n            update();\n            return disposable.dispose;\n        })),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetInsertRowPermission, WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getBaseRangeMenuHidden$(accessor),\n    };\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor } from '@univerjs/core';\nimport type { IMenuButtonItem, IMenuSelectorItem } from '@univerjs/ui';\nimport {\n    BooleanNumber,\n    composeStyles,\n    DEFAULT_STYLES,\n    DOCS_NORMAL_EDITOR_UNIT_ID_KEY,\n    EDITOR_ACTIVATED,\n    FOCUSING_SHEET,\n    FontItalic,\n    FontWeight,\n    HorizontalAlign,\n    ICommandService,\n    IContextService,\n    IUniverInstanceService,\n    RANGE_TYPE,\n    ThemeService,\n    UniverInstanceType,\n    VerticalAlign,\n    WrapStrategy,\n} from '@univerjs/core';\n\nimport { DocSelectionManagerService, SetTextSelectionsOperation } from '@univerjs/docs';\nimport { SetInlineFormatCommand } from '@univerjs/docs-ui';\nimport {\n    CancelFrozenCommand,\n    RangeProtectionPermissionEditPoint,\n    RangeProtectionPermissionViewPoint,\n    ResetBackgroundColorCommand,\n    SetBackgroundColorCommand,\n    SetColHiddenMutation,\n    SetColVisibleMutation,\n    SetColWidthCommand,\n    SetHorizontalTextAlignCommand,\n    SetRangeValuesMutation,\n    SetRowHeightCommand,\n    SetRowHiddenMutation,\n    SetRowVisibleMutation,\n    SetSelectedColsVisibleCommand,\n    SetSelectedRowsVisibleCommand,\n    SetSelectionsOperation,\n    SetTextRotationCommand,\n    SetTextWrapCommand,\n    SetVerticalTextAlignCommand,\n    SetWorksheetActiveOperation,\n    SetWorksheetColWidthMutation,\n    SetWorksheetRowIsAutoHeightCommand,\n    SetWorksheetRowIsAutoHeightMutation,\n    SheetsSelectionsService,\n    WorkbookCopyPermission,\n    WorkbookEditablePermission,\n    WorksheetCopyPermission,\n    WorksheetEditPermission,\n    WorksheetSetCellStylePermission,\n    WorksheetSetCellValuePermission,\n    WorksheetSetColumnStylePermission,\n    WorksheetSetRowStylePermission,\n} from '@univerjs/sheets';\nimport {\n    CutCommand,\n    FONT_FAMILY_LIST,\n    FONT_SIZE_LIST,\n    getMenuHiddenObservable,\n    IClipboardInterfaceService,\n    MenuItemType,\n} from '@univerjs/ui';\n\nimport { combineLatestWith, map, Observable } from 'rxjs';\nimport {\n    SheetCopyCommand,\n    SheetCutCommand,\n    SheetPasteBesidesBorderCommand,\n    SheetPasteColWidthCommand,\n    SheetPasteCommand,\n    SheetPasteFormatCommand,\n    SheetPasteValueCommand,\n} from '../../commands/commands/clipboard.command';\nimport { HideColConfirmCommand, HideRowConfirmCommand } from '../../commands/commands/hide-row-col-confirm.command';\nimport {\n    ResetRangeTextColorCommand,\n    SetRangeBoldCommand,\n    SetRangeFontFamilyCommand,\n    SetRangeFontSizeCommand,\n    SetRangeItalicCommand,\n    SetRangeStrickThroughCommand,\n    SetRangeTextColorCommand,\n    SetRangeUnderlineCommand,\n} from '../../commands/commands/inline-format.command';\nimport {\n    SetInfiniteFormatPainterCommand,\n    SetOnceFormatPainterCommand,\n} from '../../commands/commands/set-format-painter.command';\nimport {\n    SetColumnFrozenCommand,\n    SetRowFrozenCommand,\n    SetSelectionFrozenCommand,\n} from '../../commands/commands/set-frozen.command';\nimport { SetWorksheetColAutoWidthCommand } from '../../commands/commands/set-worksheet-auto-col-width.command';\nimport { COLOR_PICKER_COMPONENT } from '../../components/color-picker';\nimport { FONT_FAMILY_COMPONENT, FONT_FAMILY_ITEM_COMPONENT } from '../../components/font-family';\nimport { FONT_SIZE_COMPONENT } from '../../components/font-size';\nimport { MENU_ITEM_INPUT_COMPONENT } from '../../components/menu-item-input';\nimport { FormatPainterStatus, IFormatPainterService } from '../../services/format-painter/format-painter.service';\nimport { deriveStateFromActiveSheet$, getCurrentRangeDisable$, getObservableWithExclusiveRange$ } from './menu-util';\n\nexport enum SheetMenuPosition {\n    ROW_HEADER_CONTEXT_MENU = 'ROW_HEADER_CONTEXT_MENU',\n    COL_HEADER_CONTEXT_MENU = 'COL_HEADER_CONTEXT_MENU',\n    SHEET_BAR = 'SHEET_BAR',\n    SHEET_FOOTER = 'SHEET_FOOTER',\n}\n\nexport function FormatPainterMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    const formatPainterService = accessor.get(IFormatPainterService);\n\n    return {\n        id: SetOnceFormatPainterCommand.id,\n        subId: SetInfiniteFormatPainterCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: 'BrushSingle',\n        title: 'Format Painter',\n        tooltip: 'toolbar.formatPainter',\n        activated$: new Observable<boolean>((subscriber) => {\n            let active = false;\n\n            const status$ = formatPainterService.status$.subscribe((s) => {\n                active = s !== FormatPainterStatus.OFF;\n                subscriber.next(active);\n            });\n\n            subscriber.next(active);\n\n            return () => {\n                status$.unsubscribe();\n            };\n        }),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetCopyPermission, WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }, true),\n    };\n}\n\nexport function BoldMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    const commandService = accessor.get(ICommandService);\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const contextService = accessor.get(IContextService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n\n    return {\n        id: SetRangeBoldCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: 'BoldSingle',\n        title: 'Set bold',\n        tooltip: 'toolbar.bold',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] }, true),\n        activated$: deriveStateFromActiveSheet$(univerInstanceService, false, ({ worksheet }) => new Observable<boolean>((subscriber) => {\n            const disposable = commandService.onCommandExecuted((c) => {\n                const id = c.id;\n                if (id === SetRangeValuesMutation.id || id === SetSelectionsOperation.id || id === SetWorksheetActiveOperation.id) {\n                    const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n                    let isBold = FontWeight.NORMAL;\n\n                    if (primary != null) {\n                        const range = worksheet.getRange(primary.startRow, primary.startColumn);\n                        isBold = range?.getFontWeight();\n                    }\n\n                    subscriber.next(isBold === FontWeight.BOLD);\n                }\n\n                if (\n                    (id === SetTextSelectionsOperation.id || id === SetInlineFormatCommand.id) &&\n                    contextService.getContextValue(EDITOR_ACTIVATED) &&\n                    contextService.getContextValue(FOCUSING_SHEET)\n                ) {\n                    const textRun = getFontStyleAtCursor(accessor);\n                    if (textRun == null) {\n                        return;\n                    }\n\n                    const bl = textRun.ts?.bl;\n                    subscriber.next(bl === BooleanNumber.TRUE);\n                }\n            });\n\n            const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n            if (!worksheet) {\n                subscriber.next(false);\n                return;\n            }\n\n            let isBold = FontWeight.NORMAL;\n            if (primary != null) {\n                const range = worksheet.getRange(primary.startRow, primary.startColumn);\n                isBold = range?.getFontWeight();\n            }\n            subscriber.next(isBold === FontWeight.BOLD);\n\n            return disposable.dispose;\n        })),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function ItalicMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    const commandService = accessor.get(ICommandService);\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const contextService = accessor.get(IContextService);\n\n    return {\n        id: SetRangeItalicCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: 'ItalicSingle',\n        title: 'Set italic',\n        tooltip: 'toolbar.italic',\n        disabled$: getCurrentRangeDisable$(\n            accessor,\n            {\n                workbookTypes: [WorkbookEditablePermission],\n                worksheetTypes: [WorksheetEditPermission, WorksheetSetCellStylePermission],\n                rangeTypes: [RangeProtectionPermissionEditPoint],\n            },\n            true\n        ),\n        activated$: deriveStateFromActiveSheet$(univerInstanceService, false, ({ worksheet }) => new Observable<boolean>((subscriber) => {\n            const disposable = commandService.onCommandExecuted((c) => {\n                const id = c.id;\n                if (id === SetRangeValuesMutation.id || id === SetSelectionsOperation.id || id === SetWorksheetActiveOperation.id) {\n                    const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n                    let isItalic = FontItalic.NORMAL;\n                    if (primary != null) {\n                        const range = worksheet.getRange(primary.startRow, primary.startColumn);\n                        isItalic = range?.getFontStyle();\n                    }\n\n                    subscriber.next(isItalic === FontItalic.ITALIC);\n                }\n\n                if (\n                    (id === SetTextSelectionsOperation.id || id === SetInlineFormatCommand.id) &&\n                    contextService.getContextValue(EDITOR_ACTIVATED) &&\n                    contextService.getContextValue(FOCUSING_SHEET)\n                ) {\n                    const textRun = getFontStyleAtCursor(accessor);\n                    if (textRun == null) return;\n\n                    const it = textRun.ts?.it;\n                    subscriber.next(it === BooleanNumber.TRUE);\n                }\n            });\n\n            const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n            let isItalic = FontItalic.NORMAL;\n            if (primary != null) {\n                const range = worksheet.getRange(primary.startRow, primary.startColumn);\n                isItalic = range?.getFontStyle();\n            }\n\n            subscriber.next(isItalic === FontItalic.ITALIC);\n            return disposable.dispose;\n        })),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function UnderlineMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    const commandService = accessor.get(ICommandService);\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const contextService = accessor.get(IContextService);\n\n    return {\n        id: SetRangeUnderlineCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: 'UnderlineSingle',\n        title: 'Set underline',\n        tooltip: 'toolbar.underline',\n        activated$: deriveStateFromActiveSheet$(univerInstanceService, false, ({ worksheet }) => new Observable<boolean>((subscriber) => {\n            const disposable = commandService.onCommandExecuted((c) => {\n                const id = c.id;\n                if (id === SetRangeValuesMutation.id || id === SetSelectionsOperation.id || id === SetWorksheetActiveOperation.id) {\n                    const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n                    let isUnderline;\n                    if (primary != null) {\n                        const range = worksheet.getRange(primary.startRow, primary.startColumn);\n                        isUnderline = range?.getUnderline();\n                    }\n\n                    subscriber.next(!!(isUnderline && isUnderline.s));\n                }\n\n                if (\n                    (id === SetTextSelectionsOperation.id || id === SetInlineFormatCommand.id) &&\n                    contextService.getContextValue(EDITOR_ACTIVATED) &&\n                    contextService.getContextValue(FOCUSING_SHEET)\n                ) {\n                    const textRun = getFontStyleAtCursor(accessor);\n                    if (textRun == null) return;\n\n                    const ul = textRun.ts?.ul;\n                    subscriber.next(ul?.s === BooleanNumber.TRUE);\n                }\n            });\n\n            const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n            let isUnderline;\n            if (primary != null) {\n                const range = worksheet.getRange(primary.startRow, primary.startColumn);\n                isUnderline = range?.getUnderline();\n            }\n\n            subscriber.next(!!(isUnderline && isUnderline.s));\n            return disposable.dispose;\n        })),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] }, true),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function StrikeThroughMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    const commandService = accessor.get(ICommandService);\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const contextService = accessor.get(IContextService);\n\n    return {\n        id: SetRangeStrickThroughCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: 'StrikethroughSingle',\n        title: 'Set strike through',\n        tooltip: 'toolbar.strikethrough',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] }, true),\n        activated$: deriveStateFromActiveSheet$(univerInstanceService, false, ({ worksheet }) => new Observable<boolean>((subscriber) => {\n            const disposable = commandService.onCommandExecuted((c) => {\n                const id = c.id;\n                if (id === SetRangeValuesMutation.id || id === SetSelectionsOperation.id || id === SetWorksheetActiveOperation.id) {\n                    const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n                    let st;\n                    if (primary != null) {\n                        const range = worksheet.getRange(primary.startRow, primary.startColumn);\n                        st = range?.getStrikeThrough();\n                    }\n\n                    subscriber.next(!!(st && st.s));\n                }\n\n                if (\n                    (id === SetTextSelectionsOperation.id || id === SetInlineFormatCommand.id) &&\n                    contextService.getContextValue(EDITOR_ACTIVATED) &&\n                    contextService.getContextValue(FOCUSING_SHEET)\n                ) {\n                    const textRun = getFontStyleAtCursor(accessor);\n\n                    if (textRun == null) {\n                        return;\n                    }\n\n                    const st = textRun.ts?.st;\n\n                    subscriber.next(st?.s === BooleanNumber.TRUE);\n                }\n            });\n\n            const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n            let st;\n            if (primary != null) {\n                const range = worksheet.getRange(primary.startRow, primary.startColumn);\n                st = range?.getStrikeThrough();\n            }\n\n            subscriber.next(!!(st && st.s));\n            return disposable.dispose;\n        })),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function FontFamilySelectorMenuItemFactory(accessor: IAccessor): IMenuSelectorItem<string> {\n    const commandService = accessor.get(ICommandService);\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n\n    const defaultValue = DEFAULT_STYLES.ff;\n\n    return {\n        id: SetRangeFontFamilyCommand.id,\n        tooltip: 'toolbar.font',\n        type: MenuItemType.SELECTOR,\n        label: FONT_FAMILY_COMPONENT,\n        selections: FONT_FAMILY_LIST.map((item) => ({\n            label: {\n                name: FONT_FAMILY_ITEM_COMPONENT,\n            },\n            value: item.value,\n        })),\n\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] }, true),\n        value$: deriveStateFromActiveSheet$(univerInstanceService, defaultValue, ({ worksheet }) => new Observable((subscriber) => {\n            const updateSheet = () => {\n                let ff = defaultValue;\n\n                const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n                if (primary != null) {\n                    const cell = worksheet.getCellStyle(primary.startRow, primary.startColumn);\n                    const defaultStyle = worksheet.getDefaultCellStyleInternal();\n                    const rowStyle = worksheet.getRowStyle(primary.startRow);\n                    const colStyle = worksheet.getColumnStyle(primary.startColumn);\n                    const style = composeStyles(defaultStyle, rowStyle, colStyle, cell);\n                    if (style.ff) {\n                        ff = style.ff;\n                    }\n                }\n\n                subscriber.next(ff);\n            };\n\n            const disposable = commandService.onCommandExecuted((c) => {\n                const id = c.id;\n                if (id === SetRangeValuesMutation.id || id === SetSelectionsOperation.id || id === SetWorksheetActiveOperation.id) {\n                    updateSheet();\n                }\n            });\n\n            updateSheet();\n            return disposable.dispose;\n        })),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function FontSizeSelectorMenuItemFactory(accessor: IAccessor): IMenuSelectorItem<number> {\n    const commandService = accessor.get(ICommandService);\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const contextService = accessor.get(IContextService);\n\n    const defaultValue = DEFAULT_STYLES.fs;\n    const disabled$ = getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] }, true);\n\n    return {\n        id: SetRangeFontSizeCommand.id,\n        type: MenuItemType.SELECTOR,\n        tooltip: 'toolbar.fontSize',\n        label: {\n            name: FONT_SIZE_COMPONENT,\n            props: {\n                min: 1,\n                max: 400,\n                disabled$,\n            },\n        },\n        selections: FONT_SIZE_LIST,\n        disabled$,\n        value$: deriveStateFromActiveSheet$(univerInstanceService, defaultValue, ({ worksheet }) => new Observable((subscriber) => {\n            const updateSheet = () => {\n                let fs = defaultValue;\n                const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n                if (primary != null) {\n                    const cell = worksheet.getCellStyle(primary.startRow, primary.startColumn);\n                    const defaultStyle = worksheet.getDefaultCellStyleInternal();\n                    const rowStyle = worksheet.getRowStyle(primary.startRow);\n                    const colStyle = worksheet.getColumnStyle(primary.startColumn);\n                    const style = composeStyles(defaultStyle, rowStyle, colStyle, cell);\n                    if (style.fs) {\n                        fs = style.fs;\n                    }\n                }\n                subscriber.next(fs);\n            };\n\n            const updateSheetEditor = () => {\n                const textRun = getFontStyleAtCursor(accessor);\n                if (textRun != null) {\n                    const fs = textRun.ts?.fs ?? defaultValue;\n                    subscriber.next(fs);\n                }\n            };\n\n            const disposable = commandService.onCommandExecuted((c) => {\n                const id = c.id;\n                if (id === SetRangeValuesMutation.id || id === SetSelectionsOperation.id || id === SetWorksheetActiveOperation.id) {\n                    updateSheet();\n                }\n\n                if (\n                    (id === SetTextSelectionsOperation.id || id === SetInlineFormatCommand.id) &&\n                    contextService.getContextValue(EDITOR_ACTIVATED) &&\n                    contextService.getContextValue(FOCUSING_SHEET)\n                ) {\n                    updateSheetEditor();\n                }\n            });\n\n            updateSheet();\n            return disposable.dispose;\n        })),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function ResetTextColorMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: ResetRangeTextColorCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'toolbar.resetColor',\n        icon: 'NoColor',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] }, true),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function TextColorSelectorMenuItemFactory(accessor: IAccessor): IMenuSelectorItem<string> {\n    const commandService = accessor.get(ICommandService);\n    const themeService = accessor.get(ThemeService);\n\n    return {\n        id: SetRangeTextColorCommand.id,\n        icon: 'FontColor',\n        tooltip: 'toolbar.textColor.main',\n        type: MenuItemType.BUTTON_SELECTOR,\n        selections: [\n            {\n                label: {\n                    name: COLOR_PICKER_COMPONENT,\n                    hoverable: false,\n                    selectable: false,\n                },\n            },\n        ],\n        value$: new Observable<string>((subscriber) => {\n            const defaultValue = themeService.getCurrentTheme().textColor;\n            const disposable = commandService.onCommandExecuted((c) => {\n                if (c.id === SetRangeTextColorCommand.id) {\n                    const color = (c.params as { value: string }).value;\n                    subscriber.next(color ?? defaultValue);\n                }\n            });\n\n            subscriber.next(defaultValue);\n            return disposable.dispose;\n        }),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] }, true),\n    };\n}\n\nexport function ResetBackgroundColorMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: ResetBackgroundColorCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'toolbar.resetColor',\n        icon: 'NoColor',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n    };\n}\n\nexport function BackgroundColorSelectorMenuItemFactory(accessor: IAccessor): IMenuSelectorItem<string> {\n    const commandService = accessor.get(ICommandService);\n    const themeService = accessor.get(ThemeService);\n\n    return {\n        id: SetBackgroundColorCommand.id,\n        tooltip: 'toolbar.fillColor.main',\n        type: MenuItemType.BUTTON_SELECTOR,\n        icon: 'PaintBucket',\n        selections: [\n            {\n                label: {\n                    name: COLOR_PICKER_COMPONENT,\n                    hoverable: false,\n                    selectable: false,\n                },\n            },\n        ],\n        value$: new Observable<string>((subscriber) => {\n            const defaultValue = themeService.getCurrentTheme().primaryColor;\n            const disposable = commandService.onCommandExecuted((c) => {\n                if (c.id === SetBackgroundColorCommand.id) {\n                    const color = (c.params as { value: string }).value;\n                    subscriber.next(color ?? defaultValue);\n                }\n            });\n\n            subscriber.next(defaultValue);\n            return disposable.dispose;\n        }),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n    };\n}\n\nexport const HORIZONTAL_ALIGN_CHILDREN = [\n    {\n        label: 'align.left',\n        icon: 'LeftJustifyingSingle',\n        value: HorizontalAlign.LEFT,\n    },\n    {\n        label: 'align.center',\n        icon: 'HorizontallySingle',\n        value: HorizontalAlign.CENTER,\n    },\n    {\n        label: 'align.right',\n        icon: 'RightJustifyingSingle',\n        value: HorizontalAlign.RIGHT,\n    },\n];\n\nexport function HorizontalAlignMenuItemFactory(accessor: IAccessor): IMenuSelectorItem<HorizontalAlign> {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n\n    const defaultValue = HorizontalAlign.LEFT;\n\n    return {\n        id: SetHorizontalTextAlignCommand.id,\n        icon: HORIZONTAL_ALIGN_CHILDREN[0].icon,\n        tooltip: 'toolbar.horizontalAlignMode.main',\n        type: MenuItemType.SELECTOR,\n        selections: HORIZONTAL_ALIGN_CHILDREN,\n        value$: deriveStateFromActiveSheet$(univerInstanceService, defaultValue, ({ worksheet }) => new Observable<HorizontalAlign>((subscriber) => {\n            const disposable = accessor.get(ICommandService).onCommandExecuted((c) => {\n                const id = c.id;\n                if (id !== SetHorizontalTextAlignCommand.id && id !== SetSelectionsOperation.id && id !== SetWorksheetActiveOperation.id) {\n                    return;\n                }\n\n                const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n                let ha;\n                if (primary != null) {\n                    const range = worksheet.getRange(primary.startRow, primary.startColumn);\n                    ha = range?.getHorizontalAlignment();\n                }\n\n                subscriber.next(ha ?? defaultValue);\n            });\n\n            const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n            let ha;\n            if (primary != null) {\n                const range = worksheet.getRange(primary.startRow, primary.startColumn);\n                ha = range?.getHorizontalAlignment();\n            }\n\n            subscriber.next(ha ?? defaultValue);\n\n            return disposable.dispose;\n        })),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n    };\n}\n\nexport const VERTICAL_ALIGN_CHILDREN = [\n    {\n        label: 'align.top',\n        icon: 'AlignTopSingle',\n        value: VerticalAlign.TOP,\n    },\n    {\n        label: 'align.middle',\n        icon: 'VerticalCenterSingle',\n        value: VerticalAlign.MIDDLE,\n    },\n    {\n        label: 'align.bottom',\n        icon: 'AlignBottomSingle',\n        value: VerticalAlign.BOTTOM,\n    },\n];\n\nexport function VerticalAlignMenuItemFactory(accessor: IAccessor): IMenuSelectorItem<VerticalAlign> {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n\n    const defaultValue = VerticalAlign.BOTTOM;\n\n    return {\n        id: SetVerticalTextAlignCommand.id,\n        icon: VERTICAL_ALIGN_CHILDREN[2].icon,\n        tooltip: 'toolbar.verticalAlignMode.main',\n        type: MenuItemType.SELECTOR,\n        selections: VERTICAL_ALIGN_CHILDREN,\n        value$: deriveStateFromActiveSheet$(univerInstanceService, defaultValue, ({ worksheet }) => new Observable<VerticalAlign>((subscriber) => {\n            const disposable = accessor.get(ICommandService).onCommandExecuted((c) => {\n                const id = c.id;\n                if (id !== SetVerticalTextAlignCommand.id && id !== SetSelectionsOperation.id && id !== SetWorksheetActiveOperation.id) {\n                    return;\n                }\n\n                const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n                let va;\n                if (primary != null) {\n                    const range = worksheet.getRange(primary.startRow, primary.startColumn);\n                    va = range?.getVerticalAlignment();\n                }\n\n                subscriber.next(va ?? defaultValue);\n            });\n\n            const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n            let va;\n            if (primary != null) {\n                const range = worksheet.getRange(primary.startRow, primary.startColumn);\n                va = range?.getVerticalAlignment();\n            }\n\n            subscriber.next(va ?? defaultValue);\n\n            return disposable.dispose;\n        })),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n    };\n}\n\nexport const TEXT_WRAP_CHILDREN = [\n    {\n        label: 'textWrap.overflow',\n        icon: 'OverflowSingle',\n        value: WrapStrategy.OVERFLOW,\n    },\n    {\n        label: 'textWrap.wrap',\n        icon: 'AutowrapSingle',\n        value: WrapStrategy.WRAP,\n    },\n    {\n        label: 'textWrap.clip',\n        icon: 'TruncationSingle',\n        value: WrapStrategy.CLIP,\n    },\n];\n\nexport function WrapTextMenuItemFactory(accessor: IAccessor): IMenuSelectorItem<WrapStrategy> {\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n\n    const defaultValue = WrapStrategy.OVERFLOW;\n\n    return {\n        id: SetTextWrapCommand.id,\n        tooltip: 'toolbar.textWrapMode.main',\n        icon: TEXT_WRAP_CHILDREN[0].icon,\n        type: MenuItemType.SELECTOR,\n        selections: TEXT_WRAP_CHILDREN,\n        value$: deriveStateFromActiveSheet$<WrapStrategy>(univerInstanceService, defaultValue, ({ worksheet }) => new Observable((subscriber) => {\n            const disposable = accessor.get(ICommandService).onCommandExecuted((c) => {\n                const id = c.id;\n                if (id !== SetTextWrapCommand.id && id !== SetSelectionsOperation.id && id !== SetWorksheetActiveOperation.id) {\n                    return;\n                }\n\n                const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n                let ws;\n                if (primary != null) {\n                    const range = worksheet.getRange(primary.startRow, primary.startColumn);\n                    ws = range?.getWrapStrategy();\n                }\n\n                subscriber.next(ws ?? defaultValue);\n            });\n\n            const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n            let ws;\n            if (primary != null) {\n                const range = worksheet.getRange(primary.startRow, primary.startColumn);\n                ws = range?.getWrapStrategy();\n            }\n\n            subscriber.next(ws ?? defaultValue);\n\n            return disposable.dispose;\n        })),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n    };\n}\n\nexport const TEXT_ROTATE_CHILDREN = [\n    {\n        label: 'textRotate.none',\n        icon: 'NoRotationSingle',\n        value: 0,\n    },\n    {\n        label: 'textRotate.angleUp',\n        icon: 'LeftRotationFortyFiveDegreesSingle',\n        value: -45,\n    },\n    {\n        label: 'textRotate.angleDown',\n        icon: 'RightRotationFortyFiveDegreesSingle',\n        value: 45,\n    },\n    {\n        label: 'textRotate.vertical',\n        icon: 'VerticalTextSingle',\n        value: 'v',\n    },\n    {\n        label: 'textRotate.rotationUp',\n        icon: 'LeftRotationNinetyDegreesSingle',\n        value: -90,\n    },\n    {\n        label: 'textRotate.rotationDown',\n        icon: 'RightRotationNinetyDegreesSingle',\n        value: 90,\n    },\n];\n\nexport function TextRotateMenuItemFactory(accessor: IAccessor): IMenuSelectorItem<number | string> {\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n\n    const defaultValue = 0;\n\n    return {\n        id: SetTextRotationCommand.id,\n        tooltip: 'toolbar.textRotateMode.main',\n        icon: TEXT_ROTATE_CHILDREN[0].icon,\n        type: MenuItemType.SELECTOR,\n        selections: TEXT_ROTATE_CHILDREN,\n        value$: deriveStateFromActiveSheet$(univerInstanceService, defaultValue, ({ worksheet }) => new Observable<number | string>((subscriber) => {\n            const disposable = accessor.get(ICommandService).onCommandExecuted((c) => {\n                const id = c.id;\n                if (id !== SetTextRotationCommand.id && id !== SetSelectionsOperation.id && id !== SetWorksheetActiveOperation.id) {\n                    return;\n                }\n\n                const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n                let tr;\n                if (primary != null) {\n                    const range = worksheet.getRange(primary.startRow, primary.startColumn);\n                    tr = range?.getTextRotation();\n                }\n\n                if (tr?.v === BooleanNumber.TRUE) {\n                    subscriber.next('v');\n                } else {\n                    subscriber.next((tr && tr.a) ?? defaultValue);\n                }\n            });\n\n            const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n            let tr;\n            if (primary != null) {\n                const range = worksheet.getRange(primary.startRow, primary.startColumn);\n                tr = range?.getTextRotation();\n            }\n\n            if (tr?.v === BooleanNumber.TRUE) {\n                subscriber.next('v');\n            } else {\n                subscriber.next((tr && tr.a) ?? defaultValue);\n            }\n\n            return disposable.dispose;\n        })),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n    };\n}\n\n// #region - copy cut paste\n// TODO@wzhudev: maybe we should move these menu factory to @univerjs/ui\n\nfunction menuClipboardDisabledObservable(injector: IAccessor): Observable<boolean> {\n    const clipboardDisabled$: Observable<boolean> = new Observable((subscriber) => subscriber.next(!injector.get(IClipboardInterfaceService).supportClipboard));\n    return clipboardDisabled$;\n}\n\nexport function CopyMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: SheetCopyCommand.name,\n        commandId: SheetCopyCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.copy',\n        icon: 'Copy',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookCopyPermission], worksheetTypes: [WorksheetCopyPermission], rangeTypes: [RangeProtectionPermissionViewPoint] }),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function CutMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: SheetCutCommand.name,\n        commandId: CutCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'contextMenu.cut',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], rangeTypes: [RangeProtectionPermissionEditPoint], worksheetTypes: [WorksheetCopyPermission, WorksheetEditPermission] }),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function PasteMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: SheetPasteCommand.name,\n        commandId: SheetPasteCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.paste',\n        icon: 'PasteSpecial',\n        disabled$: menuClipboardDisabledObservable(accessor).pipe(\n            combineLatestWith(getCurrentRangeDisable$(accessor, { rangeTypes: [RangeProtectionPermissionEditPoint], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellStylePermission, WorksheetSetCellValuePermission], workbookTypes: [WorkbookEditablePermission] })),\n            map(([d1, d2]) => d1 || d2)\n        ),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport const PASTE_SPECIAL_MENU_ID = 'sheet.menu.paste-special';\nexport function PasteSpacialMenuItemFactory(accessor: IAccessor): IMenuSelectorItem {\n    return {\n        id: PASTE_SPECIAL_MENU_ID,\n        type: MenuItemType.SUBITEMS,\n        icon: 'PasteSpecial',\n        title: 'rightClick.pasteSpecial',\n        hidden$: getObservableWithExclusiveRange$(accessor, getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET)),\n    };\n}\n\nexport function PasteValueMenuItemFactory(accessor: IAccessor): IMenuButtonItem<string> {\n    return {\n        id: SheetPasteValueCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.pasteValue',\n        disabled$: menuClipboardDisabledObservable(accessor).pipe(\n            combineLatestWith(getCurrentRangeDisable$(accessor, { rangeTypes: [RangeProtectionPermissionEditPoint], worksheetTypes: [WorksheetSetCellValuePermission, WorksheetEditPermission], workbookTypes: [WorkbookEditablePermission] })),\n            map(([d1, d2]) => d1 || d2)\n        ),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function PasteFormatMenuItemFactory(accessor: IAccessor): IMenuButtonItem<string> {\n    return {\n        id: SheetPasteFormatCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.pasteFormat',\n        disabled$: menuClipboardDisabledObservable(accessor).pipe(\n            combineLatestWith(getCurrentRangeDisable$(accessor, { rangeTypes: [RangeProtectionPermissionEditPoint], worksheetTypes: [WorksheetSetCellStylePermission, WorksheetEditPermission], workbookTypes: [WorkbookEditablePermission] })),\n            map(([d1, d2]) => d1 || d2)\n        ),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function PasteColWidthMenuItemFactory(accessor: IAccessor): IMenuButtonItem<string> {\n    return {\n        id: SheetPasteColWidthCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.pasteColWidth',\n        disabled$: menuClipboardDisabledObservable(accessor).pipe(\n            combineLatestWith(getCurrentRangeDisable$(accessor, { rangeTypes: [RangeProtectionPermissionEditPoint], worksheetTypes: [WorksheetSetColumnStylePermission, WorksheetEditPermission], workbookTypes: [WorkbookEditablePermission] })),\n            map(([d1, d2]) => d1 || d2)\n        ),\n    };\n}\n\nexport function PasteBesidesBorderMenuItemFactory(accessor: IAccessor): IMenuButtonItem<string> {\n    return {\n        id: SheetPasteBesidesBorderCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.pasteBesidesBorder',\n        disabled$: menuClipboardDisabledObservable(accessor).pipe(\n            combineLatestWith(getCurrentRangeDisable$(accessor, { rangeTypes: [RangeProtectionPermissionEditPoint], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellStylePermission, WorksheetSetCellValuePermission, WorksheetSetRowStylePermission, WorksheetSetColumnStylePermission], workbookTypes: [WorkbookEditablePermission] })),\n            map(([d1, d2]) => d1 || d2)\n        ),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function FitContentMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: SetWorksheetRowIsAutoHeightCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: 'AutoHeight',\n        title: 'rightClick.fitContent',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetSetRowStylePermission, WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function ColAutoWidthMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: SetWorksheetColAutoWidthCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: 'AutoWidth',\n        title: 'rightClick.fitContent',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetSetRowStylePermission, WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport const SHEET_FROZEN_MENU_ID = 'sheet.menu.sheet-frozen';\n\nexport function SheetFrozenMenuItemFactory(accessor: IAccessor): IMenuSelectorItem<string> {\n    return {\n        id: SHEET_FROZEN_MENU_ID,\n        type: MenuItemType.SUBITEMS,\n        title: 'rightClick.freeze',\n        icon: 'FreezeToSelectedSingle',\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport const SHEET_FROZEN_HEADER_MENU_ID = 'sheet.header-menu.sheet-frozen';\n\nexport function SheetFrozenHeaderMenuItemFactory(accessor: IAccessor): IMenuSelectorItem<string> {\n    return {\n        id: SHEET_FROZEN_HEADER_MENU_ID,\n        type: MenuItemType.SUBITEMS,\n        title: 'rightClick.freeze',\n        icon: 'FreezeToSelectedSingle',\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function FrozenMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: SetSelectionFrozenCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.freeze',\n        icon: 'FreezeToSelectedSingle',\n        // disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function FrozenRowMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: SetRowFrozenCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.freezeRow',\n        icon: 'FreezeRowSingle',\n        // disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function FrozenColMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: SetColumnFrozenCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.freezeCol',\n        icon: 'FreezeColumnSingle',\n        // disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function CancelFrozenMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: CancelFrozenCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.cancelFreeze',\n        icon: 'CancelFreezeSingle',\n        // disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function HideRowMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: HideRowConfirmCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: 'Hide',\n        title: 'rightClick.hideSelectedRow',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetSetRowStylePermission, WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function HideColMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: HideColConfirmCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: 'Hide',\n        title: 'rightClick.hideSelectedColumn',\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetColumnStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function ShowRowMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n\n    const commandService = accessor.get(ICommandService);\n\n    const affectedCommands = [SetSelectionsOperation, SetRowHiddenMutation, SetRowVisibleMutation].map((c) => c.id);\n\n    return {\n        id: SetSelectedRowsVisibleCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.showHideRow',\n        hidden$: deriveStateFromActiveSheet$(univerInstanceService, true, ({ worksheet }) => new Observable((subscriber) => {\n            function hasHiddenRowsInSelections(): boolean {\n                const rowRanges = selectionManagerService.getCurrentSelections()?.map((s) => s.range).filter((r) => r.rangeType === RANGE_TYPE.ROW);\n                return !!rowRanges?.some((range) => {\n                    for (let r = range.startRow; r <= range.endRow; r++) {\n                        if (!worksheet.getRowRawVisible(r)) return true; // should not take filtered out rows into account\n                    }\n\n                    return false;\n                });\n            }\n\n            const disposable = commandService.onCommandExecuted((command) => {\n                if (affectedCommands.findIndex((c) => c === command.id) !== -1) subscriber.next(!hasHiddenRowsInSelections());\n            });\n\n            // it only shows when selected area has hidden rows\n            subscriber.next(!hasHiddenRowsInSelections());\n            return () => disposable.dispose();\n        })),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetRowStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n    };\n}\n\nexport function ShowColMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const commandService = accessor.get(ICommandService);\n    const affectedCommands = [SetSelectionsOperation, SetColHiddenMutation, SetColVisibleMutation].map((c) => c.id);\n\n    return {\n        id: SetSelectedColsVisibleCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.showHideColumn',\n        hidden$: deriveStateFromActiveSheet$(univerInstanceService, true, ({ worksheet }) => new Observable((subscriber) => {\n            function hasHiddenColsInSelections(): boolean {\n                const colRanges = selectionManagerService.getCurrentSelections()?.map((s) => s.range).filter((r) => r.rangeType === RANGE_TYPE.COLUMN);\n                if (!colRanges || colRanges.length === 0) return false;\n\n                return !!colRanges.some((range) => {\n                    for (let r = range.startColumn; r <= range.endColumn; r++) {\n                        if (!worksheet.getColVisible(r)) return true;\n                    }\n\n                    return false;\n                });\n            }\n\n            const disposable = commandService.onCommandExecuted((commandInfo) => {\n                if (affectedCommands.findIndex((c) => c === commandInfo.id) !== -1) subscriber.next(!hasHiddenColsInSelections());\n            });\n\n            subscriber.next(!hasHiddenColsInSelections());\n            return () => disposable.dispose();\n        })),\n        disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetSetColumnStylePermission, WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n    };\n}\n\nexport function SetRowHeightMenuItemFactory(accessor: IAccessor): IMenuButtonItem<number> {\n    const commandService = accessor.get(ICommandService);\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n\n    const defaultValue = 0;\n\n    return {\n        id: SetRowHeightCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: 'AdjustHeight',\n        label: {\n            name: MENU_ITEM_INPUT_COMPONENT,\n            props: {\n                prefix: 'rightClick.rowHeight',\n                suffix: 'px',\n                min: 2,\n                max: 1000,\n            },\n        },\n        value$: deriveStateFromActiveSheet$(univerInstanceService, defaultValue, ({ worksheet }) => new Observable((subscriber) => {\n            function update() {\n                const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n                const rowHeight = primary ? worksheet.getRowHeight(primary.startRow) : defaultValue;\n                subscriber.next(rowHeight);\n            }\n\n            const disposable = commandService.onCommandExecuted((c) => {\n                const id = c.id;\n                if (id === SetRangeValuesMutation.id || id === SetSelectionsOperation.id || id === SetWorksheetRowIsAutoHeightMutation.id) {\n                    return update();\n                }\n            });\n\n            update();\n            return disposable.dispose;\n        })),\n        hidden$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetRowStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n    };\n}\n\nexport function SetColWidthMenuItemFactory(accessor: IAccessor): IMenuButtonItem<number> {\n    const commandService = accessor.get(ICommandService);\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n\n    const defaultValue = 0;\n\n    return {\n        id: SetColWidthCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: 'AdjustWidth',\n        label: {\n            name: MENU_ITEM_INPUT_COMPONENT,\n            props: {\n                prefix: 'rightClick.columnWidth',\n                suffix: 'px',\n                min: 2,\n                max: 1000,\n            },\n        },\n        value$: deriveStateFromActiveSheet$(univerInstanceService, defaultValue, ({ worksheet }) => new Observable((subscriber) => {\n            function update() {\n                const primary = selectionManagerService.getCurrentLastSelection()?.primary;\n                let colWidth: number = defaultValue;\n                if (primary != null) {\n                    colWidth = worksheet.getColumnWidth(primary.startColumn);\n                }\n\n                subscriber.next(colWidth);\n            }\n\n            const disposable = commandService.onCommandExecuted((c) => {\n                const id = c.id;\n                if (id === SetRangeValuesMutation.id || id === SetSelectionsOperation.id || id === SetWorksheetColWidthMutation.id) {\n                    return update();\n                }\n            });\n\n            update();\n            return disposable.dispose;\n        })),\n        hidden$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetColumnStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),\n    };\n}\n\nfunction getFontStyleAtCursor(accessor: IAccessor) {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const textSelectionService = accessor.get(DocSelectionManagerService);\n\n    const editorDataModel = univerInstanceService.getUniverDocInstance(DOCS_NORMAL_EDITOR_UNIT_ID_KEY);\n    const activeTextRange = textSelectionService.getActiveTextRange();\n\n    if (editorDataModel == null || activeTextRange == null) return null;\n\n    const textRuns = editorDataModel.getBody()?.textRuns;\n    if (textRuns == null) return;\n\n    const { startOffset } = activeTextRange;\n    const textRun = textRuns.find(({ st, ed }) => startOffset >= st && startOffset <= ed);\n    return textRun;\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, Nullable, Workbook } from '@univerjs/core';\nimport type { ISelectionWithStyle } from '@univerjs/sheets';\nimport { IUniverInstanceService, RANGE_TYPE, Rectangle, UniverInstanceType } from '@univerjs/core';\nimport { MERGE_CELL_INTERCEPTOR_CHECK, MergeCellController, RangeProtectionRuleModel, SheetsSelectionsService } from '@univerjs/sheets';\nimport { combineLatest, map, of, switchMap } from 'rxjs';\n\nexport function getSheetSelectionsDisabled$(accessor: IAccessor) {\n    const selectionManagerService = accessor.get(SheetsSelectionsService);\n    const rangeProtectionRuleModel = accessor.get(RangeProtectionRuleModel);\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const mergeCellController = accessor.get(MergeCellController);\n\n    const workbook$ = univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    return combineLatest([\n        selectionManagerService.selectionMoveEnd$,\n        workbook$.pipe(map((workbook) => workbook?.getUnitId() ?? '')),\n        workbook$.pipe(switchMap((workbook) => workbook?.activeSheet$ ?? of(null))),\n    ]).pipe(\n        map(([selection, unitId, sheet]) => {\n            if (!sheet) return false;\n            if (!selection || selection.length === 0) return false;\n            const subUnitId = sheet.getSheetId();\n\n            const selectionRanges = selection.map((sel) => sel.range);\n            const disableResByInterceptor = mergeCellController.interceptor.fetchThroughInterceptors(MERGE_CELL_INTERCEPTOR_CHECK)(false, selectionRanges);\n\n            if (disableResByInterceptor) {\n                return true;\n            }\n\n            const subUnitRuleRange = rangeProtectionRuleModel.getSubunitRuleList(unitId, subUnitId)\n                .map((rule) => rule.ranges)\n                .flat();\n\n            if (selection.length < 2) {\n                const range = selection[0].range;\n                const rangeIsOverlap = subUnitRuleRange.some((ruleRange) => {\n                    return Rectangle.intersects(ruleRange, range) && !Rectangle.contains(ruleRange, range);\n                });\n                return rangeIsOverlap;\n            }\n\n            for (let i = 0; i < selection.length; i++) {\n                for (let j = i + 1; j < selection.length; j++) {\n                    if (Rectangle.intersects(selection[i].range, selection[j].range)) {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        })\n    );\n}\n\n/**\n * Detect if this row is selected\n * @param selections\n * @param rowIndex\n * @returns boolean\n */\nexport function isThisRowSelected(\n    selections: Readonly<ISelectionWithStyle[]>,\n    rowIndex: number\n): boolean {\n    return !!matchedSelectionByRowColIndex(selections, rowIndex, RANGE_TYPE.ROW);\n}\n\n/**\n * Detect if this col is selected\n * @param selections\n * @param colIndex\n * @returns boolean\n */\nexport function isThisColSelected(\n    selections: Readonly<ISelectionWithStyle[]>,\n    colIndex: number\n): boolean {\n    return !!matchedSelectionByRowColIndex(selections, colIndex, RANGE_TYPE.COLUMN);\n}\n\n/**\n * Detect this row/col is in selections.\n * @param selections\n * @param indexOfRowCol\n * @param rowOrCol\n * @returns boolean\n */\nexport function matchedSelectionByRowColIndex(\n    selections: Readonly<ISelectionWithStyle[]>,\n    indexOfRowCol: number,\n    rowOrCol: RANGE_TYPE.ROW | RANGE_TYPE.COLUMN\n): Nullable<ISelectionWithStyle> {\n    const matchSelectionData = selections.find((sel) => {\n        const range = sel.range;\n        const { startRow: startRowOfCurrSel, endRow: endRowOfCurrSel, startColumn: startColumnOfCurrSel, endColumn: endColumnOfCurrSel, rangeType: rangeTypeOfCurrSelection } = range;\n\n        if (rangeTypeOfCurrSelection === RANGE_TYPE.ALL || rangeTypeOfCurrSelection === RANGE_TYPE.NORMAL) return false;\n\n        if (rangeTypeOfCurrSelection === rowOrCol) {\n            if (rowOrCol === RANGE_TYPE.COLUMN && startColumnOfCurrSel <= indexOfRowCol && indexOfRowCol <= endColumnOfCurrSel) {\n                return true;\n            }\n            if (rowOrCol === RANGE_TYPE.ROW && startRowOfCurrSel <= indexOfRowCol && indexOfRowCol <= endRowOfCurrSel) {\n                return true;\n            }\n        }\n        return false;\n    });\n\n    return matchSelectionData;\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UniverInstanceType } from '@univerjs/core';\nimport { RangeProtectionPermissionEditPoint, RemoveWorksheetMergeCommand, WorkbookEditablePermission, WorksheetEditPermission, WorksheetSetCellStylePermission, WorksheetSetCellValuePermission } from '@univerjs/sheets';\nimport type { IMenuButtonItem, IMenuSelectorItem } from '@univerjs/ui';\nimport { getMenuHiddenObservable, MenuItemType } from '@univerjs/ui';\nimport type { IAccessor } from '@univerjs/core';\n\nimport { combineLatestWith, map } from 'rxjs';\nimport {\n    AddWorksheetMergeAllCommand,\n    AddWorksheetMergeCommand,\n    AddWorksheetMergeHorizontalCommand,\n    AddWorksheetMergeVerticalCommand,\n} from '../../commands/commands/add-worksheet-merge.command';\nimport { getSheetSelectionsDisabled$ } from '../utils/selections-tools';\nimport { getCurrentRangeDisable$ } from './menu-util';\n\nexport function CellMergeMenuItemFactory(accessor: IAccessor): IMenuSelectorItem<string> {\n    const editDisabled$ = getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission, WorksheetSetCellValuePermission, WorksheetSetCellStylePermission], rangeTypes: [RangeProtectionPermissionEditPoint] });\n    const selectionsHasCross$ = getSheetSelectionsDisabled$(accessor);\n\n    return {\n        id: AddWorksheetMergeCommand.id,\n        icon: 'MergeAllSingle',\n        tooltip: 'toolbar.mergeCell.main',\n        type: MenuItemType.SUBITEMS,\n        // selections: [...MERGE_CHILDREN],\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n        disabled$: editDisabled$.pipe(\n            combineLatestWith(selectionsHasCross$),\n            map(([disable, hasCross]) => disable || hasCross)\n        ),\n    };\n}\n\nexport function CellMergeAllMenuItemFactory(accessor: IAccessor): IMenuButtonItem<string> {\n    return {\n        id: AddWorksheetMergeAllCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'merge.all',\n        icon: 'MergeAllSingle',\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function CellMergeVerticalMenuItemFactory(accessor: IAccessor): IMenuButtonItem<string> {\n    return {\n        id: AddWorksheetMergeVerticalCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'merge.vertical',\n        icon: 'VerticalIntegrationSingle',\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function CellMergeHorizontalMenuItemFactory(accessor: IAccessor): IMenuButtonItem<string> {\n    return {\n        id: AddWorksheetMergeHorizontalCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'merge.horizontal',\n        icon: 'HorizontalMergeSingle',\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function CellMergeCancelMenuItemFactory(accessor: IAccessor): IMenuButtonItem<string> {\n    return {\n        id: RemoveWorksheetMergeCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'merge.cancel',\n        icon: 'CancelMergeSingle',\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, Workbook } from '@univerjs/core';\nimport { FOCUSING_COMMON_DRAWINGS, FOCUSING_FX_BAR_EDITOR, IContextService, IPermissionService, IUniverInstanceService, RANGE_TYPE, Rectangle, UniverInstanceType, UserManagerService } from '@univerjs/core';\nimport { RangeProtectionCache, RangeProtectionRuleModel, SheetsSelectionsService, UnitAction, WorkbookCreateProtectPermission, WorkbookEditablePermission, WorkbookManageCollaboratorPermission, WorksheetDeleteProtectionPermission, WorksheetManageCollaboratorPermission, WorksheetProtectionRuleModel } from '@univerjs/sheets';\nimport { combineLatest, map, merge, of, startWith, switchMap } from 'rxjs';\nimport { IEditorBridgeService } from '../../services/editor-bridge.service';\n\nexport function getAddPermissionHidden$(accessor: IAccessor) {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const workbook$ = univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    const userManagerService = accessor.get(UserManagerService);\n\n    return combineLatest([workbook$, userManagerService.currentUser$]).pipe(\n        switchMap(([workbook, _]) => {\n            if (!workbook) {\n                return of(true);\n            }\n\n            return workbook.activeSheet$.pipe(\n                switchMap((worksheet) => {\n                    if (!worksheet) {\n                        return of(true);\n                    }\n                    const rangeProtectionRuleModel = accessor.get(RangeProtectionRuleModel);\n                    const worksheetRuleModel = accessor.get(WorksheetProtectionRuleModel);\n                    const selectionManagerService = accessor.get(SheetsSelectionsService);\n                    return merge(\n                        selectionManagerService.selectionMoveEnd$,\n                        rangeProtectionRuleModel.ruleChange$,\n                        worksheetRuleModel.ruleChange$\n                    ).pipe(\n                        map(() => {\n                            const unitId = workbook.getUnitId();\n                            const subUnitId = worksheet.getSheetId();\n                            const subUnitRuleList = rangeProtectionRuleModel.getSubunitRuleList(unitId, subUnitId);\n                            const selections = selectionManagerService.getCurrentSelections();\n                            const selectionsRanges = selections?.map((selection) => selection.range);\n                            const ruleRanges = subUnitRuleList.map((rule) => rule.ranges).flat();\n                            if (!selectionsRanges) {\n                                return false;\n                            }\n                            const worksheetRule = worksheetRuleModel.getRule(unitId, subUnitId);\n                            if (worksheetRule?.permissionId) {\n                                return true;\n                            }\n                            return selectionsRanges?.some((selectionRange) => {\n                                return ruleRanges.some((ruleRange) => {\n                                    return Rectangle.intersects(selectionRange, ruleRange);\n                                });\n                            });\n                        })\n                    );\n                })\n            );\n        })\n    );\n}\n\nexport function getEditPermissionHidden$(accessor: IAccessor) {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const rangeRuleModel = accessor.get(RangeProtectionRuleModel);\n\n    const workbook$ = univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    const userManagerService = accessor.get(UserManagerService);\n\n    return combineLatest([workbook$, userManagerService.currentUser$]).pipe(\n        switchMap(([workbook, _]) => {\n            if (!workbook) {\n                return of(true);\n            }\n\n            return workbook.activeSheet$.pipe(\n                switchMap((worksheet) => {\n                    if (!worksheet) {\n                        return of(true);\n                    }\n                    const rangeProtectionRuleModel = accessor.get(RangeProtectionRuleModel);\n                    const worksheetRuleModel = accessor.get(WorksheetProtectionRuleModel);\n                    const permissionService = accessor.get(IPermissionService);\n\n                    const selectionManagerService = accessor.get(SheetsSelectionsService);\n                    return merge(\n                        selectionManagerService.selectionMoveEnd$,\n                        rangeProtectionRuleModel.ruleChange$,\n                        worksheetRuleModel.ruleChange$\n                    ).pipe(\n                        map(() => {\n                            const unitId = workbook.getUnitId();\n                            const subUnitId = worksheet.getSheetId();\n                            const subUnitRuleList = rangeRuleModel.getSubunitRuleList(unitId, subUnitId);\n                            const selectionRanges = selectionManagerService.getCurrentSelections()?.map((selection) => selection.range);\n\n                            const ruleRanges = subUnitRuleList.map((rule) => rule.ranges).flat();\n                            if (!selectionRanges?.length) {\n                                return true;\n                            }\n\n                            if (selectionRanges.length > 1) {\n                                return true;\n                            }\n\n                            const selectionRange = selectionRanges[0];\n\n                            if (selectionRange?.rangeType === RANGE_TYPE.ALL || selectionRange?.rangeType === RANGE_TYPE.COLUMN || selectionRange?.rangeType === RANGE_TYPE.ROW) {\n                                return true;\n                            }\n\n                            const worksheetRule = worksheetRuleModel.getRule(unitId, subUnitId);\n                            if (worksheetRule?.permissionId) {\n                                return permissionService.getPermissionPoint(new WorksheetManageCollaboratorPermission(unitId, subUnitId).id)?.value === false;\n                            }\n\n                            const overlapRule = subUnitRuleList.filter((rule) => {\n                                return rule.ranges.some((range) => {\n                                    return Rectangle.intersects(range, selectionRange);\n                                });\n                            });\n\n                            if (overlapRule.length !== 1) {\n                                return true;\n                            }\n\n                            const { startRow, endRow, startColumn, endColumn } = selectionRange;\n                            const rangeProtectionCache = accessor.get(RangeProtectionCache);\n                            for (let i = startRow; i <= endRow; i++) {\n                                for (let j = startColumn; j <= endColumn; j++) {\n                                    const cellInfo = rangeProtectionCache.getCellInfo(unitId, subUnitId, i, j);\n                                    if (cellInfo) {\n                                        return cellInfo[UnitAction.ManageCollaborator] === false;\n                                    }\n                                }\n                            }\n                            return false;\n                        })\n                    );\n                })\n            );\n        })\n    );\n}\n\nexport function getPermissionDisableBase$(accessor: IAccessor) {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const permissionService = accessor.get(IPermissionService);\n    const workbook$ = univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    const userManagerService = accessor.get(UserManagerService);\n\n    return combineLatest([workbook$, userManagerService.currentUser$]).pipe(\n        switchMap(([workbook, _]) => {\n            if (!workbook) {\n                return of(true);\n            }\n\n            return workbook.activeSheet$.pipe(\n                switchMap((worksheet) => {\n                    if (!worksheet) {\n                        return of(true);\n                    }\n                    const unitId = workbook.getUnitId();\n                    const selectionManagerService = accessor.get(SheetsSelectionsService);\n                    const selectionProtectionRuleModel = accessor.get(RangeProtectionRuleModel);\n                    const worksheetProtectionRuleModel = accessor.get(WorksheetProtectionRuleModel);\n\n                    const permission$ = permissionService.composePermission$([new WorkbookEditablePermission(unitId).id]).pipe(map((permissions) => permissions.every((permission) => permission.value))) ?? of(false);\n                    const ruleChange$ = merge(\n                        selectionProtectionRuleModel.ruleChange$,\n                        worksheetProtectionRuleModel.ruleChange$\n                    ).pipe(\n                        startWith(null)\n                    );\n                    return combineLatest([permission$, ruleChange$, selectionManagerService.selectionMoveEnd$]).pipe(\n                        map(([permission, _, __]) => {\n                            if (!permission) {\n                                return true;\n                            }\n                            const selections = selectionManagerService.getCurrentSelections();\n                            const selectionRanges = selections?.map((selection) => selection.range);\n                            if (!selectionRanges?.length) {\n                                return false;\n                            }\n\n                            if (selectionRanges.length > 1) {\n                                return true;\n                            }\n                            return false;\n                        })\n                    );\n                })\n            );\n        })\n    );\n}\n\nexport function getAddPermissionDisableBase$(accessor: IAccessor) {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const permissionService = accessor.get(IPermissionService);\n    const workbook$ = univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    const userManagerService = accessor.get(UserManagerService);\n    const editorBridgeService = accessor.has(IEditorBridgeService) ? accessor.get(IEditorBridgeService) : null;\n    const contextService = accessor.get(IContextService);\n    const formulaEditorFocus$ = contextService.subscribeContextValue$(FOCUSING_FX_BAR_EDITOR);\n    const editorVisible$ = editorBridgeService?.visible$ ?? of(null);\n\n    return combineLatest([workbook$, userManagerService.currentUser$, editorVisible$, formulaEditorFocus$]).pipe(\n        switchMap(([workbook, _, visible, formulaEditorFocus]) => {\n            if (!workbook || (visible?.visible && visible.unitId === workbook.getUnitId()) || formulaEditorFocus) {\n                return of(true);\n            }\n\n            return workbook.activeSheet$.pipe(\n                switchMap((worksheet) => {\n                    if (!worksheet) {\n                        return of(true);\n                    }\n                    const contextService = accessor.get(IContextService);\n                    const focusingDrawing$ = contextService.subscribeContextValue$(FOCUSING_COMMON_DRAWINGS).pipe(startWith(false));\n                    const unitId = workbook.getUnitId();\n                    const subUnitId = worksheet.getSheetId();\n                    const selectionProtectionRuleModel = accessor.get(RangeProtectionRuleModel);\n                    const worksheetProtectionRuleModel = accessor.get(WorksheetProtectionRuleModel);\n                    const selectionManagerService = accessor.get(SheetsSelectionsService);\n                    const permission$ = permissionService.composePermission$([new WorkbookCreateProtectPermission(unitId).id]).pipe(map((permissions) => permissions.every((permission) => permission.value))) ?? of(false);\n                    const ruleChange$ = merge(\n                        selectionProtectionRuleModel.ruleChange$,\n                        worksheetProtectionRuleModel.ruleChange$\n                    ).pipe(\n                        startWith(null)\n                    );\n                    return combineLatest([permission$, ruleChange$, selectionManagerService.selectionMoveEnd$, focusingDrawing$]).pipe(\n                        map(([permission, _, __, focus]) => {\n                            if (!permission || focus) {\n                                return true;\n                            }\n                            const selections = selectionManagerService.getCurrentSelections();\n                            const selectionRanges = selections?.map((selection) => selection.range);\n                            if (!selectionRanges?.length) {\n                                return true;\n                            }\n\n                            const worksheetRule = worksheetProtectionRuleModel.getRule(unitId, subUnitId);\n                            if (worksheetRule?.permissionId) {\n                                return true;\n                            }\n\n                            const subunitRuleList = selectionProtectionRuleModel.getSubunitRuleList(unitId, subUnitId);\n                            const hasLap = selectionRanges?.some((selectionRange) => {\n                                return subunitRuleList.some((rule) => {\n                                    return rule.ranges.some((ruleRange) => {\n                                        return Rectangle.intersects(selectionRange, ruleRange);\n                                    });\n                                });\n                            });\n                            return hasLap;\n                        })\n                    );\n                })\n            );\n        })\n    );\n}\n\nexport function getAddPermissionFromSheetBarDisable$(accessor: IAccessor) {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const permissionService = accessor.get(IPermissionService);\n    const workbook$ = univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    const userManagerService = accessor.get(UserManagerService);\n\n    return combineLatest([workbook$, userManagerService.currentUser$]).pipe(\n        switchMap(([workbook, _]) => {\n            if (!workbook) {\n                return of(true);\n            }\n\n            return workbook.activeSheet$.pipe(\n                switchMap((worksheet) => {\n                    if (!worksheet) {\n                        return of(true);\n                    }\n                    const unitId = workbook.getUnitId();\n                    const subUnitId = worksheet.getSheetId();\n                    const selectionProtectionRuleModel = accessor.get(RangeProtectionRuleModel);\n                    const worksheetProtectionRuleModel = accessor.get(WorksheetProtectionRuleModel);\n                    const permission$ = permissionService.composePermission$([new WorkbookCreateProtectPermission(unitId).id]).pipe(map((permissions) => permissions.every((permission) => permission.value))) ?? of(false);\n                    const ruleChange$ = merge(\n                        selectionProtectionRuleModel.ruleChange$,\n                        worksheetProtectionRuleModel.ruleChange$\n                    ).pipe(\n                        startWith(null)\n                    );\n                    return combineLatest([permission$, ruleChange$]).pipe(\n                        map(([permission, _]) => {\n                            if (!permission) return true;\n                            const worksheetRule = worksheetProtectionRuleModel.getRule(unitId, subUnitId);\n                            if (worksheetRule?.permissionId) return true;\n                            const subUnitRuleList = selectionProtectionRuleModel.getSubunitRuleList(unitId, subUnitId)?.filter((item) => item?.permissionId);\n                            return subUnitRuleList.length > 0;\n                        })\n                    );\n                })\n            );\n        })\n    );\n}\n\nexport function getRemovePermissionFromSheetBarDisable$(accessor: IAccessor) {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const permissionService = accessor.get(IPermissionService);\n    const workbook$ = univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    const userManagerService = accessor.get(UserManagerService);\n\n    return combineLatest([workbook$, userManagerService.currentUser$]).pipe(\n        switchMap(([workbook, _]) => {\n            if (!workbook) {\n                return of(true);\n            }\n\n            return workbook.activeSheet$.pipe(\n                switchMap((worksheet) => {\n                    if (!worksheet) {\n                        return of(true);\n                    }\n                    const unitId = workbook.getUnitId();\n                    const subUnitId = worksheet.getSheetId();\n                    const worksheetProtectionRuleModel = accessor.get(WorksheetProtectionRuleModel);\n                    return worksheetProtectionRuleModel.ruleChange$.pipe(startWith(null)).pipe(\n                        map(() => {\n                            const rule = worksheetProtectionRuleModel.getRule(unitId, subUnitId);\n                            if (rule) {\n                                return permissionService.getPermissionPoint(new WorksheetDeleteProtectionPermission(unitId, subUnitId).id)?.value === false;\n                            }\n                            return true;\n                        })\n                    );\n                })\n            );\n        })\n    );\n}\n\nexport function getSetPermissionFromSheetBarDisable$(accessor: IAccessor) {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const permissionService = accessor.get(IPermissionService);\n    const workbook$ = univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    const userManagerService = accessor.get(UserManagerService);\n\n    return combineLatest([workbook$, userManagerService.currentUser$]).pipe(\n        switchMap(([workbook, _]) => {\n            if (!workbook) {\n                return of(true);\n            }\n\n            return workbook.activeSheet$.pipe(\n                switchMap((worksheet) => {\n                    if (!worksheet) {\n                        return of(true);\n                    }\n                    const unitId = workbook.getUnitId();\n                    const selectionProtectionRuleModel = accessor.get(RangeProtectionRuleModel);\n                    const worksheetProtectionRuleModel = accessor.get(WorksheetProtectionRuleModel);\n                    const permission$ = permissionService.composePermission$([new WorkbookCreateProtectPermission(unitId).id, new WorkbookManageCollaboratorPermission(unitId).id]).pipe(map((permissions) => permissions.every((permission) => permission.value))) ?? of(false);\n                    const worksheetRuleChange$ = worksheetProtectionRuleModel.ruleChange$.pipe(startWith(null));\n                    const selectionRuleChange$ = selectionProtectionRuleModel.ruleChange$.pipe(startWith(null));\n                    return combineLatest([permission$, worksheetRuleChange$, selectionRuleChange$]).pipe(\n                        map(([permission, _, __]) => {\n                            if (!permission) {\n                                return true;\n                            }\n                            const subUnitId = worksheet.getSheetId();\n                            const worksheetRule = worksheetProtectionRuleModel.getRule(unitId, subUnitId);\n                            const selectionRuleList = selectionProtectionRuleModel.getSubunitRuleList(unitId, subUnitId);\n                            if (worksheetRule || selectionRuleList.length) {\n                                return false;\n                            }\n                            return true;\n                        })\n                    );\n                })\n            );\n        })\n    );\n}\n\nexport function getRemovePermissionDisable$(accessor: IAccessor) {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const permissionService = accessor.get(IPermissionService);\n    const workbook$ = univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    const userManagerService = accessor.get(UserManagerService);\n\n    return combineLatest([workbook$, userManagerService.currentUser$]).pipe(\n        switchMap(([workbook, _]) => {\n            if (!workbook) {\n                return of(true);\n            }\n\n            return workbook.activeSheet$.pipe(\n                switchMap((worksheet) => {\n                    if (!worksheet) {\n                        return of(true);\n                    }\n                    const unitId = workbook.getUnitId();\n                    const subUnitId = worksheet.getSheetId();\n                    const sheetSelectionsService = accessor.get(SheetsSelectionsService);\n                    const selectionProtectionRuleModel = accessor.get(RangeProtectionRuleModel);\n                    const worksheetProtectionRuleModel = accessor.get(WorksheetProtectionRuleModel);\n\n                    const changes$ = merge(\n                        selectionProtectionRuleModel.ruleChange$,\n                        worksheetProtectionRuleModel.ruleChange$,\n                        sheetSelectionsService.selectionMoveEnd$\n                    ).pipe(startWith(null));\n                    return combineLatest([changes$]).pipe(\n                        map(([_]) => {\n                            const selections = accessor.get(SheetsSelectionsService).getCurrentSelections();\n                            const selectionRanges = selections?.map((selection) => selection.range);\n                            if (!selectionRanges?.length || selectionRanges.length > 1) {\n                                return true;\n                            }\n\n                            const selectionRange = selectionRanges[0];\n\n                            if (selectionRange?.rangeType === RANGE_TYPE.ALL || selectionRange?.rangeType === RANGE_TYPE.COLUMN || selectionRange?.rangeType === RANGE_TYPE.ROW) {\n                                return true;\n                            }\n\n                            const worksheetRule = worksheetProtectionRuleModel.getRule(unitId, subUnitId);\n                            if (worksheetRule?.permissionId) {\n                                return permissionService.getPermissionPoint(new WorksheetDeleteProtectionPermission(unitId, subUnitId).id)?.value === false;\n                            }\n\n                            const overlapRule = selectionProtectionRuleModel.getSubunitRuleList(unitId, subUnitId).filter((rule) => {\n                                return rule.ranges.some((range) => {\n                                    return Rectangle.intersects(range, selectionRange);\n                                });\n                            });\n\n                            if (overlapRule.length !== 1) {\n                                return true;\n                            }\n\n                            const { startRow, endRow, startColumn, endColumn } = selectionRange;\n                            const rangeProtectionCache = accessor.get(RangeProtectionCache);\n                            for (let i = startRow; i <= endRow; i++) {\n                                for (let j = startColumn; j <= endColumn; j++) {\n                                    const cellInfo = rangeProtectionCache.getCellInfo(unitId, subUnitId, i, j);\n                                    if (cellInfo) {\n                                        return cellInfo[UnitAction.Delete] === false;\n                                    }\n                                }\n                            }\n                            return false;\n                        })\n                    );\n                })\n            );\n        })\n    );\n}\n\nexport function getViewPermissionDisable$(accessor: IAccessor) {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const permissionService = accessor.get(IPermissionService);\n    const workbook$ = univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    const userManagerService = accessor.get(UserManagerService);\n    const editorBridgeService = accessor.has(IEditorBridgeService) ? accessor.get(IEditorBridgeService) : null;\n    const contextService = accessor.get(IContextService);\n    const formulaEditorFocus$ = contextService.subscribeContextValue$(FOCUSING_FX_BAR_EDITOR);\n    const editorVisible$ = editorBridgeService?.visible$ ?? of(null);\n\n    return combineLatest([workbook$, userManagerService.currentUser$, editorVisible$, formulaEditorFocus$]).pipe(\n        switchMap(([workbook, _, visible, formulaEditorFocus]) => {\n            if (!workbook || (visible?.visible && visible.unitId === workbook.getUnitId()) || formulaEditorFocus) {\n                return of(true);\n            }\n\n            return workbook.activeSheet$.pipe(\n                switchMap((worksheet) => {\n                    if (!worksheet) {\n                        return of(true);\n                    }\n                    const unitId = workbook.getUnitId();\n                    const permission$ = permissionService.getPermissionPoint$(new WorkbookEditablePermission(unitId).id)?.pipe(map((e) => !!e.value)) ?? of(false);\n                    return permission$.pipe(\n                        map((permission) => !permission)\n                    );\n                })\n            );\n        })\n    );\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor } from '@univerjs/core';\nimport type { IMenuButtonItem, IMenuItem, IMenuSelectorItem } from '@univerjs/ui';\nimport { UniverInstanceType } from '@univerjs/core';\n\nimport { getMenuHiddenObservable, MenuItemType } from '@univerjs/ui';\nimport { AddRangeProtectionFromContextMenuCommand, AddRangeProtectionFromSheetBarCommand, AddRangeProtectionFromToolbarCommand, DeleteRangeProtectionFromContextMenuCommand, SetRangeProtectionFromContextMenuCommand, ViewSheetPermissionFromContextMenuCommand, ViewSheetPermissionFromSheetBarCommand } from '../../commands/commands/range-protection.command';\nimport { ChangeSheetProtectionFromSheetBarCommand, DeleteWorksheetProtectionFormSheetBarCommand } from '../../commands/commands/worksheet-protection.command';\nimport { permissionLockIconKey, permissionMenuIconKey } from '../../consts/permission';\nimport { getAddPermissionDisableBase$, getAddPermissionFromSheetBarDisable$, getAddPermissionHidden$, getEditPermissionHidden$, getPermissionDisableBase$, getRemovePermissionDisable$, getRemovePermissionFromSheetBarDisable$, getSetPermissionFromSheetBarDisable$, getViewPermissionDisable$ } from './permission-menu-util';\n\nexport const SHEET_PERMISSION_CONTEXT_MENU_ID = 'sheet.contextMenu.permission';\n\nexport function sheetPermissionToolbarMenuFactory(accessor: IAccessor): IMenuItem {\n    return {\n        id: AddRangeProtectionFromToolbarCommand.id,\n        type: MenuItemType.BUTTON,\n        icon: permissionMenuIconKey,\n        tooltip: 'permission.toolbarMenu',\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n        disabled$: getAddPermissionDisableBase$(accessor),\n    };\n}\n\nexport function sheetPermissionContextMenuFactory(accessor: IAccessor): IMenuSelectorItem<string> {\n    return {\n        id: SHEET_PERMISSION_CONTEXT_MENU_ID,\n        type: MenuItemType.SUBITEMS,\n        title: 'rightClick.protectRange',\n        icon: permissionLockIconKey,\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function sheetPermissionAddProtectContextMenuFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: AddRangeProtectionFromContextMenuCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.turnOnProtectRange',\n        hidden$: getAddPermissionHidden$(accessor),\n        disabled$: getAddPermissionDisableBase$(accessor),\n    };\n}\n\nexport function sheetPermissionEditProtectContextMenuFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: SetRangeProtectionFromContextMenuCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.editProtectRange',\n        disabled$: getPermissionDisableBase$(accessor),\n        hidden$: getEditPermissionHidden$(accessor),\n    };\n}\n\nexport function sheetPermissionRemoveProtectContextMenuFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: DeleteRangeProtectionFromContextMenuCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.removeProtectRange',\n        disabled$: getRemovePermissionDisable$(accessor),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function sheetPermissionViewAllProtectRuleContextMenuFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: ViewSheetPermissionFromContextMenuCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'rightClick.viewAllProtectArea',\n        disabled$: getViewPermissionDisable$(accessor),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function sheetPermissionProtectSheetInSheetBarMenuFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: AddRangeProtectionFromSheetBarCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'sheetConfig.addProtectSheet',\n        disabled$: getAddPermissionFromSheetBarDisable$(accessor),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function sheetPermissionRemoveProtectionSheetBarMenuFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: DeleteWorksheetProtectionFormSheetBarCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'sheetConfig.removeProtectSheet',\n        disabled$: getRemovePermissionFromSheetBarDisable$(accessor),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function sheetPermissionChangeSheetPermissionSheetBarMenuFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: ChangeSheetProtectionFromSheetBarCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'sheetConfig.changeSheetPermission',\n        disabled$: getSetPermissionFromSheetBarDisable$(accessor),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function sheetPermissionViewAllProtectRuleSheetBarMenuFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: ViewSheetPermissionFromSheetBarCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'sheetConfig.viewAllProtectArea',\n        disabled$: getViewPermissionDisable$(accessor),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IAccessor, Workbook } from '@univerjs/core';\nimport type { IMenuButtonItem, IMenuSelectorItem } from '@univerjs/ui';\nimport type { Subscriber } from 'rxjs';\nimport { BooleanNumber, ICommandService, IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport {\n    CopySheetCommand,\n    InsertSheetMutation,\n    RemoveSheetMutation,\n    SetTabColorCommand,\n    SetWorksheetHideCommand,\n    SetWorksheetHideMutation,\n    SetWorksheetShowCommand,\n    WorkbookCreateSheetPermission,\n    WorkbookDeleteSheetPermission,\n    WorkbookEditablePermission,\n    WorkbookHideSheetPermission,\n    WorkbookRenameSheetPermission,\n} from '@univerjs/sheets';\nimport { getMenuHiddenObservable, MenuItemType } from '@univerjs/ui';\nimport { combineLatest, combineLatestWith, map, Observable } from 'rxjs';\n\nimport { RemoveSheetConfirmCommand } from '../../commands/commands/remove-sheet-confirm.command';\nimport { ShowMenuListCommand } from '../../commands/commands/unhide.command';\nimport { RenameSheetOperation } from '../../commands/operations/rename-sheet.operation';\nimport { COLOR_PICKER_COMPONENT } from '../../components/color-picker';\nimport { getWorkbookPermissionDisable$ } from './menu-util';\n\nexport function DeleteSheetMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const commandService = accessor.get(ICommandService);\n    const defaultDisable$ = new Observable<boolean>((subscriber) => {\n        const disposable = commandService.onCommandExecuted((c) => {\n            const id = c.id;\n            if (\n                id === RemoveSheetMutation.id ||\n                id === InsertSheetMutation.id ||\n                id === SetWorksheetHideMutation.id\n            ) {\n                disableFunction(univerInstanceService, subscriber);\n            }\n        });\n\n        // When there is only one sheet initialized, it is also necessary to disable\n        disableFunction(univerInstanceService, subscriber);\n\n        return disposable.dispose;\n    });\n    const permissionDisable$ = getWorkbookPermissionDisable$(accessor, [WorkbookEditablePermission, WorkbookDeleteSheetPermission]);\n\n    return {\n        id: RemoveSheetConfirmCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'sheetConfig.delete',\n        disabled$: combineLatest([defaultDisable$, permissionDisable$]).pipe(\n            map(([defaultDisabled, permissionDisabled]) => {\n                return defaultDisabled || permissionDisabled;\n            })\n        ),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function CopySheetMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: CopySheetCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'sheetConfig.copy',\n        disabled$: getWorkbookPermissionDisable$(accessor, [WorkbookEditablePermission, WorkbookCreateSheetPermission]),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function RenameSheetMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    return {\n        id: RenameSheetOperation.id,\n        type: MenuItemType.BUTTON,\n        title: 'sheetConfig.rename',\n        disabled$: getWorkbookPermissionDisable$(accessor, [WorkbookEditablePermission, WorkbookRenameSheetPermission]),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function ChangeColorSheetMenuItemFactory(accessor: IAccessor): IMenuSelectorItem<string> {\n    return {\n        id: SetTabColorCommand.id,\n        title: 'sheetConfig.changeColor',\n        type: MenuItemType.SELECTOR,\n        selections: [\n            {\n                label: {\n                    name: COLOR_PICKER_COMPONENT,\n                    hoverable: false,\n                },\n            },\n        ],\n        hidden$: getWorkbookPermissionDisable$(accessor, [WorkbookEditablePermission]),\n    };\n}\n\nexport function HideSheetMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const commandService = accessor.get(ICommandService);\n\n    return {\n        id: SetWorksheetHideCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'sheetConfig.hide',\n        disabled$: new Observable<boolean>((subscriber) => {\n            const disposable = commandService.onCommandExecuted((c) => {\n                const id = c.id;\n                if (\n                    id === RemoveSheetMutation.id ||\n                    id === InsertSheetMutation.id ||\n                    id === SetWorksheetHideMutation.id\n                ) {\n                    disableFunction(univerInstanceService, subscriber);\n                }\n            });\n\n            // When there is only one sheet initialized, it is also necessary to disable\n            disableFunction(univerInstanceService, subscriber);\n\n            return disposable.dispose;\n        }).pipe(\n            combineLatestWith(getWorkbookPermissionDisable$(accessor, [WorkbookEditablePermission, WorkbookHideSheetPermission])),\n            map(([defaultDisabled, permissionDisabled]) => defaultDisabled || permissionDisabled)\n        ),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function UnHideSheetMenuItemFactory(accessor: IAccessor): IMenuSelectorItem<any> {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const commandService = accessor.get(ICommandService);\n\n    const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n    const hiddenList = workbook.getHiddenWorksheets().map((s) => ({\n        label: workbook.getSheetBySheetId(s)?.getName() || '',\n        value: s,\n    }));\n\n    const defaultDisable$: Observable<boolean> = new Observable((subscriber) => {\n        const disposable = commandService.onCommandExecuted((c) => {\n            if (c.id !== SetWorksheetHideCommand.id && c.id !== SetWorksheetShowCommand.id) {\n                return;\n            }\n            const newList = workbook.getHiddenWorksheets();\n            const isEmpty = newList.length === 0;\n            subscriber.next(isEmpty);\n        });\n        subscriber.next(hiddenList.length === 0);\n        return disposable.dispose;\n    });\n    return {\n        id: SetWorksheetShowCommand.id,\n        type: MenuItemType.SELECTOR,\n        title: 'sheetConfig.unhide',\n        disabled$: defaultDisable$.pipe(\n            combineLatestWith(getWorkbookPermissionDisable$(accessor, [WorkbookEditablePermission, WorkbookHideSheetPermission])),\n            map(([defaultDisabled, permissionDisabled]) => defaultDisabled || permissionDisabled)\n        ),\n        selections: new Observable((subscriber) => {\n            const disposable = commandService.onCommandExecuted((c) => {\n                if (c.id !== SetWorksheetHideCommand.id && c.id !== SetWorksheetShowCommand.id) {\n                    return;\n                }\n                const newList = workbook.getHiddenWorksheets().map((s) => ({\n                    label: workbook.getSheetBySheetId(s)?.getName() || '',\n                    value: s,\n                }));\n                subscriber.next(newList);\n            });\n            subscriber.next(hiddenList);\n            return disposable.dispose;\n        }),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nexport function ShowMenuItemFactory(accessor: IAccessor): IMenuButtonItem {\n    const univerInstanceService = accessor.get(IUniverInstanceService);\n    const commandService = accessor.get(ICommandService);\n\n    return {\n        id: ShowMenuListCommand.id,\n        type: MenuItemType.BUTTON,\n        title: 'sheetConfig.unhide',\n        disabled$: new Observable<boolean>((subscriber) => {\n            function disableFunction() {\n                const worksheets = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!.getWorksheets();\n                    // loop through all worksheets Map to see if there is more than one sheet\n                const visibleSheets = Array.from(worksheets.values());\n\n                subscriber.next(visibleSheets.length === 1);\n            }\n            const disposable = commandService.onCommandExecuted((c) => {\n                const id = c.id;\n                if (\n                    id === RemoveSheetMutation.id ||\n                    id === InsertSheetMutation.id ||\n                    id === SetWorksheetHideMutation.id\n                ) {\n                    disableFunction();\n                }\n            });\n\n            disableFunction();\n\n            return disposable.dispose;\n        }).pipe(\n            combineLatestWith(getWorkbookPermissionDisable$(accessor, [WorkbookEditablePermission, WorkbookHideSheetPermission])),\n            map(([defaultDisabled, permissionDisabled]) => defaultDisabled || permissionDisabled)\n        ),\n        hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_SHEET),\n    };\n}\n\nfunction disableFunction(univerInstanceService: IUniverInstanceService, subscriber: Subscriber<boolean>) {\n    const worksheets = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!.getWorksheets();\n        // loop through all worksheets Map to see if there is more than one visible sheet\n    const visibleSheets = Array.from(worksheets.values()).filter(\n        (sheet) => sheet.getConfig().hidden === BooleanNumber.FALSE\n    );\n    subscriber.next(visibleSheets.length === 1);\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { MenuSchemaType } from '@univerjs/ui';\nimport {\n    AddWorksheetMergeAllCommand,\n    AddWorksheetMergeCommand,\n    AddWorksheetMergeHorizontalCommand,\n    AddWorksheetMergeVerticalCommand,\n    CancelFrozenCommand,\n    ClearSelectionAllCommand,\n    ClearSelectionContentCommand,\n    ClearSelectionFormatCommand,\n    CopySheetCommand,\n    InsertColBeforeCommand,\n    InsertMultiColsLeftCommand,\n    InsertMultiColsRightCommand,\n    InsertMultiRowsAboveCommand,\n    InsertMultiRowsAfterCommand,\n    InsertRowBeforeCommand,\n    RemoveWorksheetMergeCommand,\n    ResetBackgroundColorCommand,\n    ResetTextColorCommand,\n    SetBackgroundColorCommand,\n    SetBorderBasicCommand,\n    SetColWidthCommand,\n    SetHorizontalTextAlignCommand,\n    SetRowHeightCommand,\n    SetSelectedColsVisibleCommand,\n    SetSelectedRowsVisibleCommand,\n    SetTabColorCommand,\n    SetTextRotationCommand,\n    SetTextWrapCommand,\n    SetVerticalTextAlignCommand,\n    SetWorksheetHideCommand,\n    SetWorksheetRowIsAutoHeightCommand,\n    ToggleGridlinesCommand,\n} from '@univerjs/sheets';\nimport { ContextMenuGroup, ContextMenuPosition, RibbonStartGroup } from '@univerjs/ui';\nimport {\n    SheetCopyCommand,\n    // SheetCutCommand,\n    SheetPasteBesidesBorderCommand,\n    SheetPasteColWidthCommand,\n    SheetPasteCommand,\n    SheetPasteFormatCommand,\n    SheetPasteValueCommand,\n} from '../commands/commands/clipboard.command';\nimport { DeleteRangeMoveLeftConfirmCommand } from '../commands/commands/delete-range-move-left-confirm.command';\nimport { DeleteRangeMoveUpConfirmCommand } from '../commands/commands/delete-range-move-up-confirm.command';\nimport { HideColConfirmCommand, HideRowConfirmCommand } from '../commands/commands/hide-row-col-confirm.command';\nimport {\n    SetRangeBoldCommand,\n    SetRangeFontFamilyCommand,\n    SetRangeFontSizeCommand,\n    SetRangeItalicCommand,\n    SetRangeStrickThroughCommand,\n    SetRangeTextColorCommand,\n    SetRangeUnderlineCommand,\n} from '../commands/commands/inline-format.command';\nimport { InsertRangeMoveDownConfirmCommand } from '../commands/commands/insert-range-move-down-confirm.command';\nimport { InsertRangeMoveRightConfirmCommand } from '../commands/commands/insert-range-move-right-confirm.command';\nimport {\n    AddRangeProtectionFromContextMenuCommand,\n    AddRangeProtectionFromSheetBarCommand,\n    AddRangeProtectionFromToolbarCommand,\n    DeleteRangeProtectionFromContextMenuCommand,\n    SetRangeProtectionFromContextMenuCommand,\n    ViewSheetPermissionFromContextMenuCommand,\n    ViewSheetPermissionFromSheetBarCommand,\n} from '../commands/commands/range-protection.command';\nimport { RemoveColConfirmCommand, RemoveRowConfirmCommand } from '../commands/commands/remove-row-col-confirm.command';\nimport { RemoveSheetConfirmCommand } from '../commands/commands/remove-sheet-confirm.command';\nimport { SetOnceFormatPainterCommand } from '../commands/commands/set-format-painter.command';\nimport { SetColumnFrozenCommand, SetRowFrozenCommand, SetSelectionFrozenCommand } from '../commands/commands/set-frozen.command';\nimport { SetWorksheetColAutoWidthCommand } from '../commands/commands/set-worksheet-auto-col-width.command';\nimport { ShowMenuListCommand } from '../commands/commands/unhide.command';\nimport {\n    ChangeSheetProtectionFromSheetBarCommand,\n    DeleteWorksheetProtectionFormSheetBarCommand,\n} from '../commands/commands/worksheet-protection.command';\nimport { RenameSheetOperation } from '../commands/operations/rename-sheet.operation';\nimport { CellBorderSelectorMenuItemFactory } from './menu/border.menu';\nimport { CLEAR_SELECTION_MENU_ID, ClearSelectionAllMenuItemFactory, ClearSelectionContentMenuItemFactory, ClearSelectionFormatMenuItemFactory, ClearSelectionMenuItemFactory } from './menu/clear.menu';\nimport { DELETE_RANGE_MENU_ID, DeleteRangeMenuItemFactory, DeleteRangeMoveLeftMenuItemFactory, DeleteRangeMoveUpMenuItemFactory, RemoveColMenuItemFactory, RemoveRowMenuItemFactory } from './menu/delete.menu';\nimport { ToggleGridlinesMenuFactory } from './menu/gridlines.menu';\nimport {\n    CELL_INSERT_MENU_ID,\n    CellInsertMenuItemFactory,\n    InsertColLeftCellMenuItemFactory,\n    InsertMultiColsLeftHeaderMenuItemFactory,\n    InsertMultiColsRightHeaderMenuItemFactory,\n    InsertMultiRowsAboveHeaderMenuItemFactory,\n    InsertMultiRowsAfterHeaderMenuItemFactory,\n    InsertRangeMoveDownMenuItemFactory,\n    InsertRangeMoveRightMenuItemFactory,\n    InsertRowBeforeCellMenuItemFactory,\n} from './menu/insert.menu';\nimport {\n    BackgroundColorSelectorMenuItemFactory,\n    BoldMenuItemFactory,\n    CancelFrozenMenuItemFactory,\n    ColAutoWidthMenuItemFactory,\n    CopyMenuItemFactory,\n    // CutMenuItemFactory,\n    FitContentMenuItemFactory,\n    FontFamilySelectorMenuItemFactory,\n    FontSizeSelectorMenuItemFactory,\n    FormatPainterMenuItemFactory,\n    FrozenColMenuItemFactory,\n    FrozenMenuItemFactory,\n    FrozenRowMenuItemFactory,\n    HideColMenuItemFactory,\n    HideRowMenuItemFactory,\n    HorizontalAlignMenuItemFactory,\n    ItalicMenuItemFactory,\n    PASTE_SPECIAL_MENU_ID,\n    PasteBesidesBorderMenuItemFactory,\n    PasteColWidthMenuItemFactory,\n    // PasteColWidthMenuItemFactory,\n    PasteFormatMenuItemFactory,\n    PasteMenuItemFactory,\n    PasteSpacialMenuItemFactory,\n    PasteValueMenuItemFactory,\n    ResetBackgroundColorMenuItemFactory,\n    ResetTextColorMenuItemFactory,\n    SetColWidthMenuItemFactory,\n    SetRowHeightMenuItemFactory,\n    SHEET_FROZEN_HEADER_MENU_ID,\n    SHEET_FROZEN_MENU_ID,\n    SheetFrozenHeaderMenuItemFactory,\n    SheetFrozenMenuItemFactory,\n    ShowColMenuItemFactory,\n    ShowRowMenuItemFactory,\n    StrikeThroughMenuItemFactory,\n    TextColorSelectorMenuItemFactory,\n    TextRotateMenuItemFactory,\n    UnderlineMenuItemFactory,\n    VerticalAlignMenuItemFactory,\n    WrapTextMenuItemFactory,\n} from './menu/menu';\nimport { CellMergeAllMenuItemFactory, CellMergeCancelMenuItemFactory, CellMergeHorizontalMenuItemFactory, CellMergeMenuItemFactory, CellMergeVerticalMenuItemFactory } from './menu/merge.menu';\nimport {\n    SHEET_PERMISSION_CONTEXT_MENU_ID,\n    sheetPermissionAddProtectContextMenuFactory,\n    sheetPermissionChangeSheetPermissionSheetBarMenuFactory,\n    sheetPermissionContextMenuFactory,\n    sheetPermissionEditProtectContextMenuFactory,\n    sheetPermissionProtectSheetInSheetBarMenuFactory,\n    sheetPermissionRemoveProtectContextMenuFactory,\n    sheetPermissionRemoveProtectionSheetBarMenuFactory,\n    sheetPermissionToolbarMenuFactory,\n    sheetPermissionViewAllProtectRuleContextMenuFactory,\n    sheetPermissionViewAllProtectRuleSheetBarMenuFactory,\n} from './menu/permission.menu';\nimport {\n    ChangeColorSheetMenuItemFactory,\n    CopySheetMenuItemFactory,\n    DeleteSheetMenuItemFactory,\n    HideSheetMenuItemFactory,\n    RenameSheetMenuItemFactory,\n    ShowMenuItemFactory,\n} from './menu/sheet.menu';\n\nexport const menuSchema: MenuSchemaType = {\n    [RibbonStartGroup.FORMAT]: {\n        [SetOnceFormatPainterCommand.id]: {\n            order: 0,\n            menuItemFactory: FormatPainterMenuItemFactory,\n        },\n        [SetRangeBoldCommand.id]: {\n            order: 1,\n            menuItemFactory: BoldMenuItemFactory,\n        },\n        [SetRangeItalicCommand.id]: {\n            order: 2,\n            menuItemFactory: ItalicMenuItemFactory,\n        },\n        [SetRangeUnderlineCommand.id]: {\n            order: 3,\n            menuItemFactory: UnderlineMenuItemFactory,\n        },\n        [SetRangeStrickThroughCommand.id]: {\n            order: 4,\n            menuItemFactory: StrikeThroughMenuItemFactory,\n        },\n        [SetRangeFontFamilyCommand.id]: {\n            order: 5,\n            menuItemFactory: FontFamilySelectorMenuItemFactory,\n        },\n        [SetRangeFontSizeCommand.id]: {\n            order: 6,\n            menuItemFactory: FontSizeSelectorMenuItemFactory,\n        },\n        [SetRangeTextColorCommand.id]: {\n            order: 7,\n            menuItemFactory: TextColorSelectorMenuItemFactory,\n            [ResetTextColorCommand.id]: {\n                order: 0,\n                menuItemFactory: ResetTextColorMenuItemFactory,\n            },\n        },\n        [SetBackgroundColorCommand.id]: {\n            order: 9,\n            menuItemFactory: BackgroundColorSelectorMenuItemFactory,\n            [ResetBackgroundColorCommand.id]: {\n                order: 0,\n                menuItemFactory: ResetBackgroundColorMenuItemFactory,\n            },\n        },\n        [SetBorderBasicCommand.id]: {\n            order: 10,\n            menuItemFactory: CellBorderSelectorMenuItemFactory,\n        },\n    },\n    [RibbonStartGroup.LAYOUT]: {\n        [AddWorksheetMergeCommand.id]: {\n            order: 0,\n            menuItemFactory: CellMergeMenuItemFactory,\n            [AddWorksheetMergeAllCommand.id]: {\n                order: 0,\n                menuItemFactory: CellMergeAllMenuItemFactory,\n            },\n            [AddWorksheetMergeVerticalCommand.id]: {\n                order: 1,\n                menuItemFactory: CellMergeVerticalMenuItemFactory,\n            },\n            [AddWorksheetMergeHorizontalCommand.id]: {\n                order: 2,\n                menuItemFactory: CellMergeHorizontalMenuItemFactory,\n            },\n            [RemoveWorksheetMergeCommand.id]: {\n                order: 3,\n                menuItemFactory: CellMergeCancelMenuItemFactory,\n            },\n        },\n        [SetHorizontalTextAlignCommand.id]: {\n            order: 1,\n            menuItemFactory: HorizontalAlignMenuItemFactory,\n        },\n        [SetVerticalTextAlignCommand.id]: {\n            order: 1,\n            menuItemFactory: VerticalAlignMenuItemFactory,\n        },\n        [SetTextWrapCommand.id]: {\n            order: 2,\n            menuItemFactory: WrapTextMenuItemFactory,\n        },\n        [SetTextRotationCommand.id]: {\n            order: 3,\n            menuItemFactory: TextRotateMenuItemFactory,\n        },\n    },\n    [RibbonStartGroup.OTHERS]: {\n        [AddRangeProtectionFromToolbarCommand.id]: {\n            order: 0,\n            menuItemFactory: sheetPermissionToolbarMenuFactory,\n        },\n    },\n    [ContextMenuPosition.MAIN_AREA]: {\n        [ContextMenuGroup.FORMAT]: {\n            [SheetCopyCommand.name]: {\n                order: 0,\n                menuItemFactory: CopyMenuItemFactory,\n            },\n            // [SheetCutCommand.name]: {\n            //     order: 1,\n            //     menuItemFactory: CutMenuItemFactory,\n            // },\n            [SheetPasteCommand.name]: {\n                order: 2,\n                menuItemFactory: PasteMenuItemFactory,\n            },\n            [PASTE_SPECIAL_MENU_ID]: {\n                order: 3,\n                menuItemFactory: PasteSpacialMenuItemFactory,\n                [SheetPasteValueCommand.id]: {\n                    order: 0,\n                    menuItemFactory: PasteValueMenuItemFactory,\n                },\n                [SheetPasteFormatCommand.id]: {\n                    order: 1,\n                    menuItemFactory: PasteFormatMenuItemFactory,\n                },\n                [SheetPasteColWidthCommand.id]: {\n                    order: 2,\n                    menuItemFactory: PasteColWidthMenuItemFactory,\n                },\n                [SheetPasteBesidesBorderCommand.id]: {\n                    order: 3,\n                    menuItemFactory: PasteBesidesBorderMenuItemFactory,\n                },\n            },\n            [CLEAR_SELECTION_MENU_ID]: {\n                order: 4,\n                menuItemFactory: ClearSelectionMenuItemFactory,\n                [ClearSelectionContentCommand.id]: {\n                    order: 0,\n                    menuItemFactory: ClearSelectionContentMenuItemFactory,\n                },\n                [ClearSelectionFormatCommand.id]: {\n                    order: 1,\n                    menuItemFactory: ClearSelectionFormatMenuItemFactory,\n                },\n                [ClearSelectionAllCommand.id]: {\n                    order: 2,\n                    menuItemFactory: ClearSelectionAllMenuItemFactory,\n                },\n            },\n        },\n        [ContextMenuGroup.LAYOUT]: {\n            order: 1,\n            [CELL_INSERT_MENU_ID]: {\n                order: 0,\n                menuItemFactory: CellInsertMenuItemFactory,\n                [InsertRowBeforeCommand.id]: {\n                    order: 0,\n                    menuItemFactory: InsertRowBeforeCellMenuItemFactory,\n                },\n                [InsertColBeforeCommand.id]: {\n                    order: 1,\n                    menuItemFactory: InsertColLeftCellMenuItemFactory,\n                },\n                [InsertRangeMoveRightConfirmCommand.id]: {\n                    order: 2,\n                    menuItemFactory: InsertRangeMoveRightMenuItemFactory,\n                },\n                [InsertRangeMoveDownConfirmCommand.id]: {\n                    order: 3,\n                    menuItemFactory: InsertRangeMoveDownMenuItemFactory,\n                },\n            },\n            [DELETE_RANGE_MENU_ID]: {\n                order: 0,\n                menuItemFactory: DeleteRangeMenuItemFactory,\n                [RemoveColConfirmCommand.id]: {\n                    order: 0,\n                    menuItemFactory: RemoveColMenuItemFactory,\n                },\n                [RemoveRowConfirmCommand.id]: {\n                    order: 1,\n                    menuItemFactory: RemoveRowMenuItemFactory,\n                },\n                [DeleteRangeMoveLeftConfirmCommand.id]: {\n                    order: 2,\n                    menuItemFactory: DeleteRangeMoveLeftMenuItemFactory,\n                },\n                [DeleteRangeMoveUpConfirmCommand.id]: {\n                    order: 3,\n                    menuItemFactory: DeleteRangeMoveUpMenuItemFactory,\n                },\n            },\n            [SHEET_FROZEN_MENU_ID]: {\n                order: 2,\n                menuItemFactory: SheetFrozenMenuItemFactory,\n                [SetSelectionFrozenCommand.id]: {\n                    order: 0,\n                    menuItemFactory: FrozenMenuItemFactory,\n                },\n                [SetRowFrozenCommand.id]: {\n                    order: 1,\n                    menuItemFactory: FrozenRowMenuItemFactory,\n                },\n                [SetColumnFrozenCommand.id]: {\n                    order: 2,\n                    menuItemFactory: FrozenColMenuItemFactory,\n                },\n                [CancelFrozenCommand.id]: {\n                    order: 3,\n                    menuItemFactory: CancelFrozenMenuItemFactory,\n                },\n            },\n            [SHEET_PERMISSION_CONTEXT_MENU_ID]: {\n                order: 3,\n                menuItemFactory: sheetPermissionContextMenuFactory,\n                [AddRangeProtectionFromContextMenuCommand.id]: {\n                    order: 0,\n                    menuItemFactory: sheetPermissionAddProtectContextMenuFactory,\n                },\n                [SetRangeProtectionFromContextMenuCommand.id]: {\n                    order: 1,\n                    menuItemFactory: sheetPermissionEditProtectContextMenuFactory,\n                },\n                [DeleteRangeProtectionFromContextMenuCommand.id]: {\n                    order: 2,\n                    menuItemFactory: sheetPermissionRemoveProtectContextMenuFactory,\n                },\n                [ViewSheetPermissionFromContextMenuCommand.id]: {\n                    order: 3,\n                    menuItemFactory: sheetPermissionViewAllProtectRuleContextMenuFactory,\n                },\n            },\n        },\n        [ContextMenuGroup.DATA]: {\n            order: 2,\n        },\n        [ContextMenuGroup.OTHERS]: {\n            order: 3,\n        },\n    },\n    [ContextMenuPosition.COL_HEADER]: {\n        [ContextMenuGroup.FORMAT]: {\n            [SheetCopyCommand.name]: {\n                order: 0,\n                menuItemFactory: CopyMenuItemFactory,\n            },\n            // [SheetCutCommand.name]: {\n            //     order: 1,\n            //     menuItemFactory: CutMenuItemFactory,\n            // },\n            [SheetPasteCommand.name]: {\n                order: 2,\n                menuItemFactory: PasteMenuItemFactory,\n            },\n            [PASTE_SPECIAL_MENU_ID]: {\n                order: 3,\n                menuItemFactory: PasteSpacialMenuItemFactory,\n                [SheetPasteValueCommand.id]: {\n                    order: 0,\n                    menuItemFactory: PasteValueMenuItemFactory,\n                },\n                [SheetPasteFormatCommand.id]: {\n                    order: 1,\n                    menuItemFactory: PasteFormatMenuItemFactory,\n                },\n                [SheetPasteColWidthCommand.id]: {\n                    order: 2,\n                    menuItemFactory: PasteColWidthMenuItemFactory,\n                },\n                [SheetPasteBesidesBorderCommand.id]: {\n                    order: 3,\n                    menuItemFactory: PasteBesidesBorderMenuItemFactory,\n                },\n            },\n            [CLEAR_SELECTION_MENU_ID]: {\n                order: 4,\n                menuItemFactory: ClearSelectionMenuItemFactory,\n                [ClearSelectionContentCommand.id]: {\n                    order: 0,\n                    menuItemFactory: ClearSelectionContentMenuItemFactory,\n                },\n                [ClearSelectionFormatCommand.id]: {\n                    order: 1,\n                    menuItemFactory: ClearSelectionFormatMenuItemFactory,\n                },\n                [ClearSelectionAllCommand.id]: {\n                    order: 2,\n                    menuItemFactory: ClearSelectionAllMenuItemFactory,\n                },\n            },\n        },\n        [ContextMenuGroup.LAYOUT]: {\n            order: 1,\n            [InsertMultiColsLeftCommand.id]: {\n                order: 0,\n                menuItemFactory: InsertMultiColsLeftHeaderMenuItemFactory,\n            },\n            [InsertMultiColsRightCommand.id]: {\n                order: 0,\n                menuItemFactory: InsertMultiColsRightHeaderMenuItemFactory,\n            },\n            [HideColConfirmCommand.id]: {\n                order: 1,\n                menuItemFactory: HideColMenuItemFactory,\n            },\n            [SetSelectedColsVisibleCommand.id]: {\n                order: 2,\n                menuItemFactory: ShowColMenuItemFactory,\n            },\n            [RemoveColConfirmCommand.id]: {\n                order: 2,\n                menuItemFactory: RemoveColMenuItemFactory,\n            },\n            [SetColWidthCommand.id]: {\n                order: 3,\n                menuItemFactory: SetColWidthMenuItemFactory,\n            },\n            [SetWorksheetColAutoWidthCommand.id]: {\n                order: 4,\n                menuItemFactory: ColAutoWidthMenuItemFactory,\n            },\n            [SHEET_FROZEN_HEADER_MENU_ID]: {\n                order: 5,\n                menuItemFactory: SheetFrozenHeaderMenuItemFactory,\n                [SetSelectionFrozenCommand.id]: {\n                    order: 0,\n                    menuItemFactory: FrozenMenuItemFactory,\n                },\n                [CancelFrozenCommand.id]: {\n                    order: 3,\n                    menuItemFactory: CancelFrozenMenuItemFactory,\n                },\n            },\n            [SHEET_PERMISSION_CONTEXT_MENU_ID]: {\n                order: 6,\n                menuItemFactory: sheetPermissionContextMenuFactory,\n                [AddRangeProtectionFromContextMenuCommand.id]: {\n                    order: 0,\n                    menuItemFactory: sheetPermissionAddProtectContextMenuFactory,\n                },\n                [SetRangeProtectionFromContextMenuCommand.id]: {\n                    order: 1,\n                    menuItemFactory: sheetPermissionEditProtectContextMenuFactory,\n                },\n                [DeleteRangeProtectionFromContextMenuCommand.id]: {\n                    order: 2,\n                    menuItemFactory: sheetPermissionRemoveProtectContextMenuFactory,\n                },\n                [ViewSheetPermissionFromContextMenuCommand.id]: {\n                    order: 3,\n                    menuItemFactory: sheetPermissionViewAllProtectRuleContextMenuFactory,\n                },\n            },\n        },\n        [ContextMenuGroup.DATA]: {\n            order: 2,\n        },\n        [ContextMenuGroup.OTHERS]: {\n            order: 3,\n        },\n    },\n    [ContextMenuPosition.ROW_HEADER]: {\n        [ContextMenuGroup.FORMAT]: {\n            [SheetCopyCommand.name]: {\n                order: 0,\n                menuItemFactory: CopyMenuItemFactory,\n            },\n            // [SheetCutCommand.name]: {\n            //     order: 1,\n            //     menuItemFactory: CutMenuItemFactory,\n            // },\n            [SheetPasteCommand.name]: {\n                order: 2,\n                menuItemFactory: PasteMenuItemFactory,\n            },\n            [PASTE_SPECIAL_MENU_ID]: {\n                order: 3,\n                menuItemFactory: PasteSpacialMenuItemFactory,\n                [SheetPasteValueCommand.id]: {\n                    order: 0,\n                    menuItemFactory: PasteValueMenuItemFactory,\n                },\n                [SheetPasteFormatCommand.id]: {\n                    order: 1,\n                    menuItemFactory: PasteFormatMenuItemFactory,\n                },\n                [SheetPasteColWidthCommand.id]: {\n                    order: 2,\n                    menuItemFactory: PasteColWidthMenuItemFactory,\n                },\n                [SheetPasteBesidesBorderCommand.id]: {\n                    order: 3,\n                    menuItemFactory: PasteBesidesBorderMenuItemFactory,\n                },\n            },\n            [CLEAR_SELECTION_MENU_ID]: {\n                order: 4,\n                menuItemFactory: ClearSelectionMenuItemFactory,\n                [ClearSelectionContentCommand.id]: {\n                    order: 0,\n                    menuItemFactory: ClearSelectionContentMenuItemFactory,\n                },\n                [ClearSelectionFormatCommand.id]: {\n                    order: 1,\n                    menuItemFactory: ClearSelectionFormatMenuItemFactory,\n                },\n                [ClearSelectionAllCommand.id]: {\n                    order: 2,\n                    menuItemFactory: ClearSelectionAllMenuItemFactory,\n                },\n            },\n        },\n        [ContextMenuGroup.LAYOUT]: {\n            order: 1,\n            [InsertMultiRowsAboveCommand.id]: {\n                order: 0,\n                menuItemFactory: InsertMultiRowsAboveHeaderMenuItemFactory,\n            },\n            [InsertMultiRowsAfterCommand.id]: {\n                order: 1,\n                menuItemFactory: InsertMultiRowsAfterHeaderMenuItemFactory,\n            },\n            [RemoveRowConfirmCommand.id]: {\n                order: 1,\n                menuItemFactory: RemoveRowMenuItemFactory,\n            },\n            [HideRowConfirmCommand.id]: {\n                order: 2,\n                menuItemFactory: HideRowMenuItemFactory,\n            },\n            [SetSelectedRowsVisibleCommand.id]: {\n                order: 2,\n                menuItemFactory: ShowRowMenuItemFactory,\n            },\n            [SetRowHeightCommand.id]: {\n                order: 3,\n                menuItemFactory: SetRowHeightMenuItemFactory,\n            },\n            [SetWorksheetRowIsAutoHeightCommand.id]: {\n                order: 4,\n                menuItemFactory: FitContentMenuItemFactory,\n            },\n            [SHEET_FROZEN_HEADER_MENU_ID]: {\n                order: 5,\n                menuItemFactory: SheetFrozenHeaderMenuItemFactory,\n                [SetSelectionFrozenCommand.id]: {\n                    order: 0,\n                    menuItemFactory: FrozenMenuItemFactory,\n                },\n                [CancelFrozenCommand.id]: {\n                    order: 3,\n                    menuItemFactory: CancelFrozenMenuItemFactory,\n                },\n            },\n            [SHEET_PERMISSION_CONTEXT_MENU_ID]: {\n                order: 6,\n                menuItemFactory: sheetPermissionContextMenuFactory,\n                [AddRangeProtectionFromContextMenuCommand.id]: {\n                    order: 0,\n                    menuItemFactory: sheetPermissionAddProtectContextMenuFactory,\n                },\n                [SetRangeProtectionFromContextMenuCommand.id]: {\n                    order: 1,\n                    menuItemFactory: sheetPermissionEditProtectContextMenuFactory,\n                },\n                [DeleteRangeProtectionFromContextMenuCommand.id]: {\n                    order: 2,\n                    menuItemFactory: sheetPermissionRemoveProtectContextMenuFactory,\n                },\n                [ViewSheetPermissionFromContextMenuCommand.id]: {\n                    order: 3,\n                    menuItemFactory: sheetPermissionViewAllProtectRuleContextMenuFactory,\n                },\n            },\n        },\n        [ContextMenuGroup.DATA]: {\n            order: 2,\n        },\n        [ContextMenuGroup.OTHERS]: {\n            order: 3,\n        },\n    },\n    [ContextMenuPosition.FOOTER_TABS]: {\n        [ContextMenuGroup.OTHERS]: {\n            order: 0,\n            [RemoveSheetConfirmCommand.id]: {\n                order: 0,\n                menuItemFactory: DeleteSheetMenuItemFactory,\n            },\n            [CopySheetCommand.id]: {\n                order: 1,\n                menuItemFactory: CopySheetMenuItemFactory,\n            },\n            [RenameSheetOperation.id]: {\n                order: 2,\n                menuItemFactory: RenameSheetMenuItemFactory,\n            },\n            [SetTabColorCommand.id]: {\n                order: 3,\n                menuItemFactory: ChangeColorSheetMenuItemFactory,\n            },\n            [SetWorksheetHideCommand.id]: {\n                order: 4,\n                menuItemFactory: HideSheetMenuItemFactory,\n            },\n            // [SetWorksheetShowCommand.id]: {\n            //     order: 5,\n            //     menuItemFactory: UnHideSheetMenuItemFactory,\n            // },\n            [ShowMenuListCommand.id]: {\n                order: 6,\n                menuItemFactory: ShowMenuItemFactory,\n            },\n            [AddRangeProtectionFromSheetBarCommand.id]: {\n                order: 7,\n                menuItemFactory: sheetPermissionProtectSheetInSheetBarMenuFactory,\n            },\n            [DeleteWorksheetProtectionFormSheetBarCommand.id]: {\n                order: 8,\n                menuItemFactory: sheetPermissionRemoveProtectionSheetBarMenuFactory,\n            },\n            [ChangeSheetProtectionFromSheetBarCommand.id]: {\n                order: 9,\n                menuItemFactory: sheetPermissionChangeSheetPermissionSheetBarMenuFactory,\n            },\n            [ViewSheetPermissionFromSheetBarCommand.id]: {\n                order: 10,\n                menuItemFactory: sheetPermissionViewAllProtectRuleSheetBarMenuFactory,\n            },\n        },\n    },\n    [ContextMenuPosition.FOOTER_MENU]: {\n        [ContextMenuGroup.OTHERS]: {\n            [ToggleGridlinesCommand.id]: {\n                order: 1,\n                menuItemFactory: ToggleGridlinesMenuFactory,\n            },\n        },\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IShortcutItem } from '@univerjs/ui';\nimport { BreakLineCommand, DeleteLeftCommand } from '@univerjs/docs-ui';\n\nimport { DeviceInputEventType } from '@univerjs/engine-render';\nimport { KeyCode, MetaKeys } from '@univerjs/ui';\nimport {\n    SetCellEditVisibleArrowOperation,\n    SetCellEditVisibleOperation,\n    SetCellEditVisibleWithF2Operation,\n} from '../../commands/operations/cell-edit.operation';\nimport {\n    whenEditorActivated,\n    whenEditorDidNotInputFormulaActivated,\n    whenFormulaEditorFocused,\n    whenSheetEditorActivated,\n    whenSheetEditorFocused,\n} from './utils';\n\nexport const ARROW_SELECTION_KEYCODE_LIST = [\n    KeyCode.ARROW_DOWN,\n    KeyCode.ARROW_UP,\n    KeyCode.ARROW_LEFT,\n    KeyCode.ARROW_RIGHT,\n];\n\nexport const MOVE_SELECTION_KEYCODE_LIST = [KeyCode.ENTER, KeyCode.TAB, ...ARROW_SELECTION_KEYCODE_LIST];\n\nexport function generateArrowSelectionShortCutItem() {\n    const shortcutList: IShortcutItem[] = [];\n\n    for (const keycode of ARROW_SELECTION_KEYCODE_LIST) {\n        shortcutList.push({\n            id: SetCellEditVisibleArrowOperation.id,\n            binding: keycode,\n            preconditions: (contextService) => whenEditorDidNotInputFormulaActivated(contextService),\n            staticParameters: {\n                visible: false,\n                eventType: DeviceInputEventType.Keyboard,\n                keycode,\n                isShift: false,\n            },\n        });\n\n        shortcutList.push({\n            id: SetCellEditVisibleArrowOperation.id,\n            binding: keycode | MetaKeys.SHIFT,\n            preconditions: (contextService) => whenEditorDidNotInputFormulaActivated(contextService),\n            staticParameters: {\n                visible: false,\n                eventType: DeviceInputEventType.Keyboard,\n                keycode,\n                isShift: true,\n            },\n        });\n    }\n\n    return shortcutList;\n}\n\nexport const StartEditWithF2Shortcut: IShortcutItem = {\n    id: SetCellEditVisibleWithF2Operation.id,\n    binding: KeyCode.F2,\n    description: 'shortcut.sheet.start-editing',\n    group: '4_sheet-edit',\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        visible: true,\n        eventType: DeviceInputEventType.Keyboard,\n        keycode: KeyCode.F2,\n    },\n};\n\nexport const EditorCursorEnterShortcut: IShortcutItem = {\n    id: SetCellEditVisibleOperation.id,\n    binding: KeyCode.ENTER,\n    description: 'shortcut.sheet.toggle-editing',\n    group: '4_sheet-edit',\n    preconditions: (contextService) => whenEditorDidNotInputFormulaActivated(contextService),\n    staticParameters: {\n        visible: false,\n        eventType: DeviceInputEventType.Keyboard,\n        keycode: KeyCode.ENTER,\n    },\n};\n\nexport const EditorCursorTabShortcut: IShortcutItem = {\n    id: SetCellEditVisibleOperation.id,\n    binding: KeyCode.TAB,\n    preconditions: (contextService) => whenEditorDidNotInputFormulaActivated(contextService),\n    staticParameters: {\n        visible: false,\n        eventType: DeviceInputEventType.Keyboard,\n        keycode: KeyCode.TAB,\n    },\n};\n\nexport const EditorCursorEscShortcut: IShortcutItem = {\n    id: SetCellEditVisibleOperation.id,\n    binding: KeyCode.ESC,\n    description: 'shortcut.sheet.abort-editing',\n    group: '4_sheet-edit',\n    preconditions: (contextService) => whenEditorDidNotInputFormulaActivated(contextService),\n    staticParameters: {\n        visible: false,\n        eventType: DeviceInputEventType.Keyboard,\n        keycode: KeyCode.ESC,\n    },\n};\n\nexport const EditorBreakLineShortcut: IShortcutItem = {\n    id: BreakLineCommand.id,\n    description: 'shortcut.sheet.break-line',\n    group: '4_sheet-edit',\n    preconditions: (contextService) => whenSheetEditorActivated(contextService),\n    binding: KeyCode.ENTER | MetaKeys.ALT,\n};\n\nexport const EditorDeleteLeftShortcut: IShortcutItem = {\n    id: DeleteLeftCommand.id,\n    preconditions: (contextService) =>\n        whenEditorActivated(contextService) || whenFormulaEditorFocused(contextService),\n    binding: KeyCode.BACKSPACE,\n};\n\nexport const EditorDeleteLeftShortcutInActive: IShortcutItem = {\n    id: SetCellEditVisibleOperation.id,\n    description: 'shortcut.sheet.delete-and-start-editing',\n    group: '4_sheet-edit',\n    preconditions: (contextService) => whenSheetEditorFocused(contextService) && !whenFormulaEditorFocused(contextService),\n    binding: KeyCode.BACKSPACE,\n    staticParameters: {\n        visible: true,\n        eventType: DeviceInputEventType.Keyboard,\n        keycode: KeyCode.BACKSPACE,\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { SetColHiddenCommand, SetRowHiddenCommand } from '@univerjs/sheets';\nimport type { IShortcutItem } from '@univerjs/ui';\nimport { KeyCode, MetaKeys } from '@univerjs/ui';\n\nimport { whenSheetEditorFocused } from './utils';\n\nexport const SetRowHiddenShortcutItem: IShortcutItem = {\n    id: SetRowHiddenCommand.id,\n    // when focusing on any other input tag do not trigger this shortcut\n    preconditions: (contextService) => whenSheetEditorFocused(contextService),\n    binding: KeyCode.Digit9 | MetaKeys.CTRL_COMMAND,\n};\n\nexport const SetColHiddenShortcutItem: IShortcutItem = {\n    id: SetColHiddenCommand.id,\n    // when focusing on any other input tag do not trigger this shortcut\n    preconditions: (contextService) => whenSheetEditorFocused(contextService),\n    binding: KeyCode.Digit0 | MetaKeys.CTRL_COMMAND | MetaKeys.SHIFT,\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IShortcutItem } from '@univerjs/ui';\nimport type {\n    IExpandSelectionCommandParams,\n    IMoveSelectionCommandParams,\n    IMoveSelectionEnterAndTabCommandParams,\n    ISelectAllCommandParams,\n} from '../../commands/commands/set-selection.command';\nimport { Direction } from '@univerjs/core';\nimport { KeyCode, MetaKeys } from '@univerjs/ui';\nimport {\n    ExpandSelectionCommand,\n    JumpOver,\n    MoveSelectionCommand,\n    MoveSelectionEnterAndTabCommand,\n    SelectAllCommand,\n} from '../../commands/commands/set-selection.command';\nimport { whenSheetEditorFocused, whenSheetEditorFocusedAndFxNotFocused } from './utils';\n\nexport const MoveSelectionDownShortcutItem: IShortcutItem<IMoveSelectionCommandParams> = {\n    id: MoveSelectionCommand.id,\n    description: 'shortcut.sheet.select-below-cell',\n    group: '3_sheet-view',\n    binding: KeyCode.ARROW_DOWN,\n    priority: 100,\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        direction: Direction.DOWN,\n    },\n};\n\nexport const MoveSelectionUpShortcutItem: IShortcutItem<IMoveSelectionCommandParams> = {\n    id: MoveSelectionCommand.id,\n    description: 'shortcut.sheet.select-up-cell',\n    group: '3_sheet-view',\n    binding: KeyCode.ARROW_UP,\n    priority: 100,\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        direction: Direction.UP,\n    },\n};\n\nexport const MoveSelectionLeftShortcutItem: IShortcutItem<IMoveSelectionCommandParams> = {\n    id: MoveSelectionCommand.id,\n    description: 'shortcut.sheet.select-left-cell',\n    group: '3_sheet-view',\n    binding: KeyCode.ARROW_LEFT,\n    priority: 100,\n    preconditions: whenSheetEditorFocusedAndFxNotFocused,\n    staticParameters: {\n        direction: Direction.LEFT,\n    },\n};\n\nexport const MoveSelectionRightShortcutItem: IShortcutItem<IMoveSelectionCommandParams> = {\n    id: MoveSelectionCommand.id,\n    description: 'shortcut.sheet.select-right-cell',\n    group: '3_sheet-view',\n    binding: KeyCode.ARROW_RIGHT,\n    priority: 100,\n    preconditions: whenSheetEditorFocusedAndFxNotFocused,\n    staticParameters: {\n        direction: Direction.RIGHT,\n    },\n};\n\nexport const MoveSelectionTabShortcutItem: IShortcutItem<IMoveSelectionEnterAndTabCommandParams> = {\n    id: MoveSelectionEnterAndTabCommand.id,\n    description: 'shortcut.sheet.select-next-cell',\n    group: '3_sheet-view',\n    binding: KeyCode.TAB,\n    priority: 100,\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        direction: Direction.RIGHT,\n        keycode: KeyCode.TAB,\n    },\n};\n\nexport const MoveSelectionTabLeftShortcutItem: IShortcutItem<IMoveSelectionEnterAndTabCommandParams> = {\n    id: MoveSelectionEnterAndTabCommand.id,\n    description: 'shortcut.sheet.select-previous-cell',\n    group: '3_sheet-view',\n    binding: KeyCode.TAB | MetaKeys.SHIFT,\n    priority: 100,\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        direction: Direction.LEFT,\n        keycode: KeyCode.TAB,\n    },\n};\n\nexport const MoveSelectionEnterShortcutItem: IShortcutItem<IMoveSelectionEnterAndTabCommandParams> = {\n    id: MoveSelectionEnterAndTabCommand.id,\n    description: 'shortcut.sheet.select-below-cell',\n    group: '3_sheet-view',\n    binding: KeyCode.ENTER,\n    priority: 100,\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        direction: Direction.DOWN,\n        keycode: KeyCode.ENTER,\n    },\n};\n\nexport const MoveSelectionEnterUpShortcutItem: IShortcutItem<IMoveSelectionEnterAndTabCommandParams> = {\n    id: MoveSelectionEnterAndTabCommand.id,\n    description: 'shortcut.sheet.select-up-cell',\n    group: '3_sheet-view',\n    binding: KeyCode.ENTER | MetaKeys.SHIFT,\n    priority: 100,\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        direction: Direction.UP,\n        keycode: KeyCode.ENTER,\n    },\n};\n\n// export const MoveBackSelectionShortcutItem: IShortcutItem<IMoveSelectionCommandParams> = {\n//     id: MoveSelectionCommand.id,\n//     description: 'shortcut.sheet.select-previous-cell',\n//     group: '3_sheet-view',\n//     binding: KeyCode.TAB | MetaKeys.SHIFT,\n//     priority: 100,\n//     preconditions: whenSheetEditorFocused,\n//     staticParameters: {\n//         direction: Direction.LEFT,\n//     },\n// };\n\n// move selection to continuous end\n\nexport const MoveSelectionEndDownShortcutItem: IShortcutItem<IMoveSelectionCommandParams> = {\n    id: MoveSelectionCommand.id,\n    description: 'shortcut.sheet.select-below-value-cell',\n    group: '3_sheet-view',\n    binding: KeyCode.ARROW_DOWN | MetaKeys.CTRL_COMMAND,\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        direction: Direction.DOWN,\n        jumpOver: JumpOver.moveGap,\n    },\n};\n\nexport const MoveSelectionEndUpShortcutItem: IShortcutItem<IMoveSelectionCommandParams> = {\n    id: MoveSelectionCommand.id,\n    description: 'shortcut.sheet.select-up-value-cell',\n    group: '3_sheet-view',\n    binding: KeyCode.ARROW_UP | MetaKeys.CTRL_COMMAND,\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        direction: Direction.UP,\n        jumpOver: JumpOver.moveGap,\n    },\n};\n\nexport const MoveSelectionEndLeftShortcutItem: IShortcutItem<IMoveSelectionCommandParams> = {\n    id: MoveSelectionCommand.id,\n    description: 'shortcut.sheet.select-left-value-cell',\n    group: '3_sheet-view',\n    binding: KeyCode.ARROW_LEFT | MetaKeys.CTRL_COMMAND,\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        direction: Direction.LEFT,\n        jumpOver: JumpOver.moveGap,\n    },\n};\n\nexport const MoveSelectionEndRightShortcutItem: IShortcutItem<IMoveSelectionCommandParams> = {\n    id: MoveSelectionCommand.id,\n    description: 'shortcut.sheet.select-right-value-cell',\n    group: '3_sheet-view',\n    binding: KeyCode.ARROW_RIGHT | MetaKeys.CTRL_COMMAND,\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        direction: Direction.RIGHT,\n        jumpOver: JumpOver.moveGap,\n    },\n};\n\nexport const ExpandSelectionDownShortcutItem: IShortcutItem<IExpandSelectionCommandParams> = {\n    id: ExpandSelectionCommand.id,\n    description: 'shortcut.sheet.expand-selection-down',\n    group: '3_sheet-view',\n    binding: KeyCode.ARROW_DOWN | MetaKeys.SHIFT,\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        direction: Direction.DOWN,\n    },\n};\n\nexport const ExpandSelectionUpShortcutItem: IShortcutItem<IExpandSelectionCommandParams> = {\n    id: ExpandSelectionCommand.id,\n    description: 'shortcut.sheet.expand-selection-up',\n    group: '3_sheet-view',\n    binding: KeyCode.ARROW_UP | MetaKeys.SHIFT,\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        direction: Direction.UP,\n    },\n};\n\nexport const ExpandSelectionLeftShortcutItem: IShortcutItem<IExpandSelectionCommandParams> = {\n    id: ExpandSelectionCommand.id,\n    description: 'shortcut.sheet.expand-selection-left',\n    group: '3_sheet-view',\n    binding: KeyCode.ARROW_LEFT | MetaKeys.SHIFT,\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        direction: Direction.LEFT,\n    },\n};\n\nexport const ExpandSelectionRightShortcutItem: IShortcutItem<IExpandSelectionCommandParams> = {\n    id: ExpandSelectionCommand.id,\n    description: 'shortcut.sheet.expand-selection-right',\n    group: '3_sheet-view',\n    binding: KeyCode.ARROW_RIGHT | MetaKeys.SHIFT,\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        direction: Direction.RIGHT,\n    },\n};\n\n// continuous selection to continuous end\n\nexport const ExpandSelectionEndDownShortcutItem: IShortcutItem<IExpandSelectionCommandParams> = {\n    id: ExpandSelectionCommand.id,\n    description: 'shortcut.sheet.expand-selection-to-below-gap',\n    group: '3_sheet-view',\n    binding: KeyCode.ARROW_DOWN | MetaKeys.SHIFT | MetaKeys.CTRL_COMMAND,\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        direction: Direction.DOWN,\n        jumpOver: JumpOver.moveGap,\n    },\n};\n\nexport const ExpandSelectionEndUpShortcutItem: IShortcutItem<IExpandSelectionCommandParams> = {\n    id: ExpandSelectionCommand.id,\n    description: 'shortcut.sheet.expand-selection-to-up-gap',\n    group: '3_sheet-view',\n    binding: KeyCode.ARROW_UP | MetaKeys.SHIFT | MetaKeys.CTRL_COMMAND,\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        direction: Direction.UP,\n        jumpOver: JumpOver.moveGap,\n    },\n};\n\nexport const ExpandSelectionEndLeftShortcutItem: IShortcutItem<IExpandSelectionCommandParams> = {\n    id: ExpandSelectionCommand.id,\n    description: 'shortcut.sheet.expand-selection-to-left-gap',\n    group: '3_sheet-view',\n    binding: KeyCode.ARROW_LEFT | MetaKeys.SHIFT | MetaKeys.CTRL_COMMAND,\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        direction: Direction.LEFT,\n        jumpOver: JumpOver.moveGap,\n    },\n};\n\nexport const ExpandSelectionEndRightShortcutItem: IShortcutItem<IExpandSelectionCommandParams> = {\n    id: ExpandSelectionCommand.id,\n    description: 'shortcut.sheet.expand-selection-to-right-gap',\n    group: '3_sheet-view',\n    binding: KeyCode.ARROW_RIGHT | MetaKeys.SHIFT | MetaKeys.CTRL_COMMAND,\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        direction: Direction.RIGHT,\n        jumpOver: JumpOver.moveGap,\n    },\n};\n\nexport const SelectAllShortcutItem: IShortcutItem<ISelectAllCommandParams> = {\n    id: SelectAllCommand.id,\n    description: 'shortcut.sheet.select-all',\n    group: '3_sheet-view',\n    binding: KeyCode.A | MetaKeys.CTRL_COMMAND,\n    preconditions: whenSheetEditorFocused,\n    staticParameters: {\n        expandToGapFirst: true,\n        loop: true,\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IShortcutItem } from '@univerjs/ui';\nimport { KeyCode, MetaKeys } from '@univerjs/ui';\n\nimport {\n    SetRangeBoldCommand,\n    SetRangeItalicCommand,\n    SetRangeStrickThroughCommand,\n    SetRangeUnderlineCommand,\n} from '../../commands/commands/inline-format.command';\nimport { whenSheetEditorFocused } from './utils';\n\nexport const SetBoldShortcutItem: IShortcutItem = {\n    id: SetRangeBoldCommand.id,\n    description: 'shortcut.sheet.set-bold',\n    group: '4_sheet-edit',\n    preconditions: (contextService) => whenSheetEditorFocused(contextService),\n    binding: KeyCode.B | MetaKeys.CTRL_COMMAND,\n};\n\nexport const SetItalicShortcutItem: IShortcutItem = {\n    id: SetRangeItalicCommand.id,\n    description: 'shortcut.sheet.set-italic',\n    group: '4_sheet-edit',\n    preconditions: (contextService) => whenSheetEditorFocused(contextService),\n    binding: KeyCode.I | MetaKeys.CTRL_COMMAND,\n};\n\nexport const SetUnderlineShortcutItem: IShortcutItem = {\n    id: SetRangeUnderlineCommand.id,\n    description: 'shortcut.sheet.set-underline',\n    group: '4_sheet-edit',\n    preconditions: (contextService) => whenSheetEditorFocused(contextService),\n    binding: KeyCode.U | MetaKeys.CTRL_COMMAND,\n};\n\nexport const SetStrikeThroughShortcutItem: IShortcutItem = {\n    id: SetRangeStrickThroughCommand.id,\n    description: 'shortcut.sheet.set-strike-through',\n    group: '4_sheet-edit',\n    preconditions: (contextService) => whenSheetEditorFocused(contextService),\n    binding: KeyCode.X | MetaKeys.SHIFT | MetaKeys.CTRL_COMMAND,\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IShortcutItem } from '@univerjs/ui';\nimport { ClearSelectionContentCommand } from '@univerjs/sheets';\nimport { KeyCode } from '@univerjs/ui';\n\nimport { whenSheetEditorFocused } from './utils';\n\nexport const ClearSelectionValueShortcutItem: IShortcutItem = {\n    id: ClearSelectionContentCommand.id,\n    // when focusing on any other input tag do not trigger this shortcut\n    preconditions: (contextService) => whenSheetEditorFocused(contextService),\n    binding: KeyCode.DELETE,\n    mac: KeyCode.BACKSPACE,\n};\n\nexport const ClearSelectionValueShortcutItemMac: IShortcutItem = {\n    id: ClearSelectionContentCommand.id,\n    // when focusing on any other input tag do not trigger this shortcut\n    preconditions: (contextService) => whenSheetEditorFocused(contextService),\n    mac: KeyCode.DELETE,\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NilCommand } from '@univerjs/core';\nimport type { IShortcutItem } from '@univerjs/ui';\nimport { KeyCode, MetaKeys } from '@univerjs/ui';\n\nimport { ChangeZoomRatioCommand } from '../../commands/commands/set-zoom-ratio.command';\nimport { whenSheetEditorFocused } from './utils';\n\nexport const ZoomInShortcutItem: IShortcutItem = {\n    id: ChangeZoomRatioCommand.id,\n    description: 'shortcut.sheet.zoom-in',\n    binding: KeyCode.EQUAL | MetaKeys.CTRL_COMMAND,\n    group: '3_sheet-view',\n    preconditions: whenSheetEditorFocused,\n    priority: 1,\n    staticParameters: {\n        delta: 0.2,\n    },\n};\nexport const PreventDefaultZoomInShortcutItem: IShortcutItem = {\n    id: NilCommand.id,\n    binding: KeyCode.EQUAL | MetaKeys.CTRL_COMMAND,\n};\n\nexport const ZoomOutShortcutItem: IShortcutItem = {\n    id: ChangeZoomRatioCommand.id,\n    description: 'shortcut.sheet.zoom-out',\n    binding: KeyCode.MINUS | MetaKeys.CTRL_COMMAND,\n    group: '3_sheet-view',\n    preconditions: whenSheetEditorFocused,\n    priority: 1,\n    staticParameters: {\n        delta: -0.2,\n    },\n};\nexport const PreventDefaultZoomOutShortcutItem: IShortcutItem = {\n    id: NilCommand.id,\n    binding: KeyCode.MINUS | MetaKeys.CTRL_COMMAND,\n};\n\nexport const ResetZoomShortcutItem: IShortcutItem = {\n    id: ChangeZoomRatioCommand.id,\n    description: 'shortcut.sheet.reset-zoom',\n    binding: KeyCode.Digit0 | MetaKeys.CTRL_COMMAND,\n    preconditions: whenSheetEditorFocused,\n    group: '3_sheet-view',\n    priority: 1,\n    staticParameters: {\n        reset: true,\n    },\n};\nexport const PreventDefaultResetZoomShortcutItem: IShortcutItem = {\n    id: NilCommand.id,\n    binding: KeyCode.Digit0 | MetaKeys.CTRL_COMMAND,\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IUniverSheetsUIConfig } from './config.schema';\nimport { Disposable, ICommandService, IConfigService, Inject, Injector, IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport { DocSelectionRenderService } from '@univerjs/docs-ui';\nimport { getCurrentTypeOfRenderer, IRenderManagerService } from '@univerjs/engine-render';\n\nimport { HideGridlines } from '@univerjs/icons';\nimport {\n    SetBoldCommand,\n    SetFontFamilyCommand,\n    SetFontSizeCommand,\n    SetItalicCommand,\n    SetStrikeThroughCommand,\n    SetUnderlineCommand,\n} from '@univerjs/sheets';\nimport { BuiltInUIPart, ComponentManager, connectInjector, ILayoutService, IMenuManagerService, IShortcutService, IUIPartsService } from '@univerjs/ui';\nimport {\n    AddWorksheetMergeAllCommand,\n    AddWorksheetMergeCommand,\n    AddWorksheetMergeHorizontalCommand,\n    AddWorksheetMergeVerticalCommand,\n} from '../commands/commands/add-worksheet-merge.command';\nimport { AutoClearContentCommand, AutoFillCommand } from '../commands/commands/auto-fill.command';\nimport { DeleteRangeMoveLeftConfirmCommand } from '../commands/commands/delete-range-move-left-confirm.command';\nimport { DeleteRangeMoveUpConfirmCommand } from '../commands/commands/delete-range-move-up-confirm.command';\nimport { SetColumnHeaderHeightCommand, SetRowHeaderWidthCommand } from '../commands/commands/headersize-changed.command';\nimport { HideColConfirmCommand, HideRowConfirmCommand } from '../commands/commands/hide-row-col-confirm.command';\nimport {\n    ResetRangeTextColorCommand,\n    SetRangeBoldCommand,\n    SetRangeFontFamilyCommand,\n    SetRangeFontSizeCommand,\n    SetRangeItalicCommand,\n    SetRangeStrickThroughCommand,\n    SetRangeSubscriptCommand,\n    SetRangeSuperscriptCommand,\n    SetRangeTextColorCommand,\n    SetRangeUnderlineCommand,\n} from '../commands/commands/inline-format.command';\nimport { InsertRangeMoveDownConfirmCommand } from '../commands/commands/insert-range-move-down-confirm.command';\nimport { InsertRangeMoveRightConfirmCommand } from '../commands/commands/insert-range-move-right-confirm.command';\nimport { AddRangeProtectionFromContextMenuCommand, AddRangeProtectionFromSheetBarCommand, AddRangeProtectionFromToolbarCommand, DeleteRangeProtectionFromContextMenuCommand, SetRangeProtectionFromContextMenuCommand, ViewSheetPermissionFromContextMenuCommand, ViewSheetPermissionFromSheetBarCommand } from '../commands/commands/range-protection.command';\nimport { RefillCommand } from '../commands/commands/refill.command';\nimport { RemoveColConfirmCommand, RemoveRowConfirmCommand } from '../commands/commands/remove-row-col-confirm.command';\nimport { RemoveSheetConfirmCommand } from '../commands/commands/remove-sheet-confirm.command';\nimport {\n    ApplyFormatPainterCommand,\n    SetInfiniteFormatPainterCommand,\n    SetOnceFormatPainterCommand,\n} from '../commands/commands/set-format-painter.command';\nimport {\n    SetColumnFrozenCommand,\n    SetRowFrozenCommand,\n    SetSelectionFrozenCommand,\n} from '../commands/commands/set-frozen.command';\nimport { ScrollCommand, ScrollToCellCommand, SetScrollRelativeCommand } from '../commands/commands/set-scroll.command';\nimport {\n    ExpandSelectionCommand,\n    MoveSelectionCommand,\n    MoveSelectionEnterAndTabCommand,\n    SelectAllCommand,\n} from '../commands/commands/set-selection.command';\nimport { SetWorksheetColAutoWidthCommand } from '../commands/commands/set-worksheet-auto-col-width.command';\nimport { ChangeZoomRatioCommand, SetZoomRatioCommand } from '../commands/commands/set-zoom-ratio.command';\nimport { ShowMenuListCommand } from '../commands/commands/unhide.command';\nimport { ChangeSheetProtectionFromSheetBarCommand, DeleteWorksheetProtectionFormSheetBarCommand } from '../commands/commands/worksheet-protection.command';\nimport { SetActivateCellEditOperation } from '../commands/operations/activate-cell-edit.operation';\nimport {\n    SetCellEditVisibleArrowOperation,\n    SetCellEditVisibleOperation,\n    SetCellEditVisibleWithF2Operation,\n} from '../commands/operations/cell-edit.operation';\nimport { RenameSheetOperation } from '../commands/operations/rename-sheet.operation';\nimport { ScrollToRangeOperation } from '../commands/operations/scroll-to-range.operation';\nimport { SetScrollOperation } from '../commands/operations/scroll.operation';\nimport { SetFormatPainterOperation } from '../commands/operations/set-format-painter.operation';\nimport { SetZoomRatioOperation } from '../commands/operations/set-zoom-ratio.operation';\nimport { SheetPermissionOpenDialogOperation } from '../commands/operations/sheet-permission-open-dialog.operation';\nimport { SheetPermissionOpenPanelOperation } from '../commands/operations/sheet-permission-open-panel.operation';\nimport { SidebarDefinedNameOperation } from '../commands/operations/sidebar-defined-name.operation';\n\nimport { BorderPanel } from '../components/border-panel/BorderPanel';\nimport { BORDER_PANEL_COMPONENT } from '../components/border-panel/interface';\nimport { COLOR_PICKER_COMPONENT, ColorPicker } from '../components/color-picker';\nimport {\n    FONT_FAMILY_COMPONENT,\n    FONT_FAMILY_ITEM_COMPONENT,\n    FontFamily,\n    FontFamilyItem,\n} from '../components/font-family';\nimport { FONT_SIZE_COMPONENT, FontSize } from '../components/font-size';\nimport { MENU_ITEM_INPUT_COMPONENT, MenuItemInput } from '../components/menu-item-input';\nimport { DEFINED_NAME_CONTAINER } from '../views/defined-name/component-name';\nimport { DefinedNameContainer } from '../views/defined-name/DefinedNameContainer';\nimport { RenderSheetContent, RenderSheetFooter, RenderSheetHeader } from '../views/sheet-container/SheetContainer';\nimport { SHEETS_UI_PLUGIN_CONFIG_KEY } from './config.schema';\nimport { menuSchema } from './menu.schema';\nimport {\n    EditorBreakLineShortcut,\n    EditorCursorEnterShortcut,\n    EditorCursorEscShortcut,\n    EditorCursorTabShortcut,\n    EditorDeleteLeftShortcut,\n    EditorDeleteLeftShortcutInActive,\n    generateArrowSelectionShortCutItem,\n    StartEditWithF2Shortcut,\n} from './shortcuts/editor.shortcut';\nimport { SetColHiddenShortcutItem, SetRowHiddenShortcutItem } from './shortcuts/operation.shortcut';\nimport {\n    ExpandSelectionDownShortcutItem,\n    ExpandSelectionEndDownShortcutItem,\n    ExpandSelectionEndLeftShortcutItem,\n    ExpandSelectionEndRightShortcutItem,\n    ExpandSelectionEndUpShortcutItem,\n    ExpandSelectionLeftShortcutItem,\n    ExpandSelectionRightShortcutItem,\n    ExpandSelectionUpShortcutItem,\n    // MoveBackSelectionShortcutItem,\n    MoveSelectionDownShortcutItem,\n    MoveSelectionEndDownShortcutItem,\n    MoveSelectionEndLeftShortcutItem,\n    MoveSelectionEndRightShortcutItem,\n    MoveSelectionEndUpShortcutItem,\n    MoveSelectionEnterShortcutItem,\n    MoveSelectionEnterUpShortcutItem,\n    MoveSelectionLeftShortcutItem,\n    MoveSelectionRightShortcutItem,\n    MoveSelectionTabLeftShortcutItem,\n    MoveSelectionTabShortcutItem,\n    MoveSelectionUpShortcutItem,\n    SelectAllShortcutItem,\n} from './shortcuts/selection.shortcut';\nimport {\n    SetBoldShortcutItem,\n    SetItalicShortcutItem,\n    SetStrikeThroughShortcutItem,\n    SetUnderlineShortcutItem,\n} from './shortcuts/style.shortcut';\nimport { ClearSelectionValueShortcutItem, ClearSelectionValueShortcutItemMac } from './shortcuts/value.shortcut';\nimport {\n    PreventDefaultResetZoomShortcutItem,\n    PreventDefaultZoomInShortcutItem,\n    PreventDefaultZoomOutShortcutItem,\n    ResetZoomShortcutItem,\n    ZoomInShortcutItem,\n    ZoomOutShortcutItem,\n} from './shortcuts/view.shortcut';\n\nexport class SheetUIController extends Disposable {\n    constructor(\n        @Inject(Injector) protected readonly _injector: Injector,\n        @Inject(ComponentManager) protected readonly _componentManager: ComponentManager,\n        @ILayoutService protected readonly _layoutService: ILayoutService,\n        @ICommandService protected readonly _commandService: ICommandService,\n        @IShortcutService protected readonly _shortcutService: IShortcutService,\n        @IMenuManagerService protected readonly _menuManagerService: IMenuManagerService,\n        @IUIPartsService protected readonly _uiPartsService: IUIPartsService,\n        @IConfigService protected readonly _configService: IConfigService\n    ) {\n        super();\n\n        this._init();\n    }\n\n    private _init(): void {\n        this._initComponents();\n        this._initCommands();\n        this._initMenus();\n        this._initShortcuts();\n        this._initWorkbenchParts();\n        this._initFocusHandler();\n    }\n\n    private _initComponents(): void {\n        const componentManager = this._componentManager;\n\n        // init custom components\n        this.disposeWithMe(componentManager.register(MENU_ITEM_INPUT_COMPONENT, MenuItemInput));\n        this.disposeWithMe(componentManager.register(BORDER_PANEL_COMPONENT, BorderPanel));\n        this.disposeWithMe(componentManager.register(COLOR_PICKER_COMPONENT, ColorPicker));\n        this.disposeWithMe(componentManager.register(FONT_FAMILY_COMPONENT, FontFamily));\n        this.disposeWithMe(componentManager.register(FONT_FAMILY_ITEM_COMPONENT, FontFamilyItem));\n        this.disposeWithMe(componentManager.register(FONT_SIZE_COMPONENT, FontSize));\n        this.disposeWithMe(componentManager.register(DEFINED_NAME_CONTAINER, DefinedNameContainer));\n\n        // init icons\n        this.disposeWithMe(componentManager.register('HideGridlines', HideGridlines));\n    }\n\n    private _initCommands(): void {\n        [\n            AddWorksheetMergeAllCommand,\n            AddWorksheetMergeCommand,\n            AddWorksheetMergeHorizontalCommand,\n            AddWorksheetMergeVerticalCommand,\n            ChangeZoomRatioCommand,\n            ExpandSelectionCommand,\n            MoveSelectionCommand,\n            MoveSelectionEnterAndTabCommand,\n            RenameSheetOperation,\n            RemoveSheetConfirmCommand,\n            RemoveRowConfirmCommand,\n            RemoveColConfirmCommand,\n            HideRowConfirmCommand,\n            HideColConfirmCommand,\n            ScrollCommand,\n            ScrollToCellCommand,\n            SelectAllCommand,\n            SetActivateCellEditOperation,\n            SetBoldCommand,\n            SetCellEditVisibleArrowOperation,\n            SetCellEditVisibleOperation,\n            SetCellEditVisibleWithF2Operation,\n            SetRangeBoldCommand,\n            SetRangeItalicCommand,\n            SetRangeUnderlineCommand,\n            SetRangeStrickThroughCommand,\n            SetRangeSubscriptCommand,\n            SetRangeSuperscriptCommand,\n            SetRangeFontSizeCommand,\n            SetRangeFontFamilyCommand,\n            SetRangeTextColorCommand,\n            ResetRangeTextColorCommand,\n            SetItalicCommand,\n            SetStrikeThroughCommand,\n            SetFontFamilyCommand,\n            SetFontSizeCommand,\n            SetFormatPainterOperation,\n            SetInfiniteFormatPainterCommand,\n            SetOnceFormatPainterCommand,\n            ApplyFormatPainterCommand,\n            SetScrollOperation,\n            SetScrollRelativeCommand,\n            SetSelectionFrozenCommand,\n            SetRowFrozenCommand,\n            SetColumnFrozenCommand,\n            ScrollToRangeOperation,\n            SetUnderlineCommand,\n            SetZoomRatioCommand,\n            SetZoomRatioOperation,\n            ShowMenuListCommand,\n            RefillCommand,\n            InsertRangeMoveDownConfirmCommand,\n            DeleteRangeMoveUpConfirmCommand,\n            InsertRangeMoveRightConfirmCommand,\n            DeleteRangeMoveLeftConfirmCommand,\n            SidebarDefinedNameOperation,\n            AutoFillCommand,\n            AutoClearContentCommand,\n\n            // permission\n            SheetPermissionOpenPanelOperation,\n            SheetPermissionOpenDialogOperation,\n            AddRangeProtectionFromToolbarCommand,\n            AddRangeProtectionFromContextMenuCommand,\n            ViewSheetPermissionFromContextMenuCommand,\n            AddRangeProtectionFromSheetBarCommand,\n            ViewSheetPermissionFromSheetBarCommand,\n            ChangeSheetProtectionFromSheetBarCommand,\n            DeleteRangeProtectionFromContextMenuCommand,\n            SetRangeProtectionFromContextMenuCommand,\n            DeleteWorksheetProtectionFormSheetBarCommand,\n            SetWorksheetColAutoWidthCommand,\n            SetRowHeaderWidthCommand,\n            SetColumnHeaderHeightCommand,\n        ].forEach((c) => {\n            this.disposeWithMe(this._commandService.registerCommand(c));\n        });\n    }\n\n    private _initMenus(): void {\n        this._menuManagerService.mergeMenu(menuSchema);\n    }\n\n    private _initShortcuts(): void {\n        [\n            // selection shortcuts\n            MoveSelectionDownShortcutItem,\n            MoveSelectionUpShortcutItem,\n            MoveSelectionLeftShortcutItem,\n            MoveSelectionRightShortcutItem,\n            MoveSelectionTabShortcutItem,\n            MoveSelectionTabLeftShortcutItem,\n            MoveSelectionEnterShortcutItem,\n            MoveSelectionEnterUpShortcutItem,\n            // MoveBackSelectionShortcutItem,\n            MoveSelectionEndDownShortcutItem,\n            MoveSelectionEndUpShortcutItem,\n            MoveSelectionEndLeftShortcutItem,\n            MoveSelectionEndRightShortcutItem,\n            ExpandSelectionDownShortcutItem,\n            ExpandSelectionUpShortcutItem,\n            ExpandSelectionLeftShortcutItem,\n            ExpandSelectionRightShortcutItem,\n            ExpandSelectionEndDownShortcutItem,\n            ExpandSelectionEndUpShortcutItem,\n            ExpandSelectionEndLeftShortcutItem,\n            ExpandSelectionEndRightShortcutItem,\n            SelectAllShortcutItem,\n\n            // view shortcuts\n            ZoomInShortcutItem,\n            ZoomOutShortcutItem,\n            ResetZoomShortcutItem,\n            PreventDefaultResetZoomShortcutItem,\n            PreventDefaultZoomInShortcutItem,\n            PreventDefaultZoomOutShortcutItem,\n\n            // toggle cell style shortcuts\n            SetBoldShortcutItem,\n            SetItalicShortcutItem,\n            SetUnderlineShortcutItem,\n            SetStrikeThroughShortcutItem,\n\n            // cell content editing shortcuts\n            ClearSelectionValueShortcutItem,\n            ClearSelectionValueShortcutItemMac,\n            ...generateArrowSelectionShortCutItem(),\n            EditorCursorEnterShortcut,\n            StartEditWithF2Shortcut,\n            EditorCursorTabShortcut,\n            EditorBreakLineShortcut,\n            EditorDeleteLeftShortcut,\n            EditorDeleteLeftShortcutInActive,\n            EditorCursorEscShortcut,\n\n            // operation shortcuts\n            SetRowHiddenShortcutItem,\n            SetColHiddenShortcutItem,\n        ].forEach((item) => {\n            this.disposeWithMe(this._shortcutService.registerShortcut(item));\n        });\n    }\n\n    protected _initWorkbenchParts(): void {\n        const uiController = this._uiPartsService;\n        const injector = this._injector;\n\n        const config = this._configService.getConfig<IUniverSheetsUIConfig>(SHEETS_UI_PLUGIN_CONFIG_KEY);\n        if (config?.formulaBar !== false) {\n            this.disposeWithMe(uiController.registerComponent(BuiltInUIPart.HEADER, () => connectInjector(RenderSheetHeader, injector)));\n        }\n        this.disposeWithMe(uiController.registerComponent(BuiltInUIPart.FOOTER, () => connectInjector(RenderSheetFooter, injector)));\n        this.disposeWithMe(uiController.registerComponent(BuiltInUIPart.CONTENT, () => connectInjector(RenderSheetContent, injector)));\n    }\n\n    protected _initFocusHandler(): void {\n        this.disposeWithMe(\n            this._layoutService.registerFocusHandler(UniverInstanceType.UNIVER_SHEET, (_unitId: string) => {\n                // DEBT: `_unitId` is not used hence we cannot support Univer mode now\n                const renderManagerService = this._injector.get(IRenderManagerService);\n                const instanceService = this._injector.get(IUniverInstanceService);\n                const currentEditorRender = getCurrentTypeOfRenderer(UniverInstanceType.UNIVER_DOC, instanceService, renderManagerService);\n                const docSelectionRenderService = currentEditorRender?.with(DocSelectionRenderService);\n\n                docSelectionRenderService?.focus();\n            })\n        );\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IMutationInfo, IOperationInfo, Workbook } from '@univerjs/core';\nimport type {\n    IInsertSheetMutationParams,\n    IRemoveSheetMutationParams,\n    ISetSelectionsOperationParams,\n    ISetWorksheetActiveOperationParams,\n    ISetWorksheetHideMutationParams,\n} from '@univerjs/sheets';\nimport { Disposable, ICommandService, IUniverInstanceService } from '@univerjs/core';\nimport {\n    InsertSheetMutation,\n    RemoveSheetMutation,\n    SetSelectionsOperation,\n    SetWorksheetActiveOperation,\n    SetWorksheetHideMutation,\n} from '@univerjs/sheets';\n\n/**\n * This controller is responsible for changing the active worksheet when\n * worksheet tab related mutations executes. We cannot write this logic in\n * commands because it does not take collaborative editing into consideration.\n */\nexport class ActiveWorksheetController extends Disposable {\n    private _previousSheetIndex = -1;\n\n    constructor(\n        @ICommandService private readonly _commandService: ICommandService,\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService\n    ) {\n        super();\n\n        this.disposeWithMe(this._commandService.beforeCommandExecuted((command) => {\n            if (command.id === RemoveSheetMutation.id) {\n                return this._beforeAdjustActiveSheetOnRemoveSheet(\n                    command as IMutationInfo<IRemoveSheetMutationParams>\n                );\n            }\n        }));\n\n        this.disposeWithMe(this._commandService.onCommandExecuted((command, options) => {\n            if (command.id === RemoveSheetMutation.id) {\n                return this._adjustActiveSheetOnRemoveSheet(command as IMutationInfo<IRemoveSheetMutationParams>);\n            }\n\n            if (command.id === SetWorksheetHideMutation.id && (command.params as ISetWorksheetHideMutationParams).hidden) {\n                return this._adjustActiveSheetOnHideSheet(command as IMutationInfo<ISetWorksheetHideMutationParams>);\n            }\n\n            // It is a mutation that we comes from the collaboration peer so we should not handle them.\n            if (options?.fromCollab) return false;\n\n            // We only handle the local mutations, for\n            // * add / copy sheet\n            // * set sheet visible\n            if (command.id === InsertSheetMutation.id) {\n                return this._adjustActiveSheetOnInsertSheet(command as IMutationInfo<IInsertSheetMutationParams>);\n            }\n\n            if (command.id === SetWorksheetHideMutation.id && !(command.params as ISetWorksheetHideMutationParams).hidden) {\n                return this._adjustActiveSheetOnShowSheet(command as IMutationInfo<ISetWorksheetHideMutationParams>);\n            }\n\n            if (command.id === SetSelectionsOperation.id) {\n                return this._adjustActiveSheetOnSelection(command as IOperationInfo<ISetSelectionsOperationParams>);\n            }\n        }));\n    }\n\n    private _adjustActiveSheetOnHideSheet(mutation: IMutationInfo<ISetWorksheetHideMutationParams>) {\n        // If the active sheet is hidden, we need to change the active sheet to the next sheet.\n        const { unitId, subUnitId } = mutation.params;\n        const workbook = this._univerInstanceService.getUniverSheetInstance(unitId);\n        if (!workbook) {\n            return;\n        }\n\n        const activeSheet = workbook.getActiveSheet()?.getSheetId();\n        if (activeSheet !== subUnitId) {\n            return;\n        }\n\n        const activeIndex = workbook.getActiveSheetIndex();\n        const nextId = findTheNextUnhiddenSheet(workbook, activeIndex);\n\n        this._switchToNextSheet(unitId, nextId);\n    }\n\n    private _beforeAdjustActiveSheetOnRemoveSheet(mutation: IMutationInfo<IRemoveSheetMutationParams>) {\n        const { unitId, subUnitId } = mutation.params;\n        const workbook = this._univerInstanceService.getUniverSheetInstance(unitId);\n        if (!workbook) {\n            return;\n        }\n\n        const worksheet = workbook.getSheetBySheetId(subUnitId);\n        if (!worksheet) {\n            return;\n        }\n\n        this._previousSheetIndex = workbook.getSheetIndex(worksheet);\n    }\n\n    private _adjustActiveSheetOnRemoveSheet(mutation: IMutationInfo<IRemoveSheetMutationParams>) {\n        if (this._previousSheetIndex === -1) {\n            return;\n        }\n\n        // If the active sheet is removed, we need to change the active sheet to the previous sheet.\n        // But how to decide which one is the previous sheet? We store the deleted sheet' index\n        // in the `IRemoteSheetMutationParams` and use it to decide the previous sheet.\n\n        // If the current sheet is not the deleted one, we don't have to call _switchToNextSheet.\n        const { unitId } = mutation.params;\n        const workbook = this._univerInstanceService.getUniverSheetInstance(unitId);\n        if (!workbook) {\n            return;\n        }\n\n        // _switchToNextSheet is executed only when the current sheet is deleted.\n        const activeSheet = workbook.getActiveSheet();\n        if (activeSheet.getSheetId() === mutation.params.subUnitId) {\n            const previousIndex = this._previousSheetIndex;\n            const nextIndex = previousIndex >= 1 ? previousIndex - 1 : 0;\n            const nextId = findTheNextUnhiddenSheet(workbook, nextIndex);\n\n            this._switchToNextSheet(unitId, nextId);\n        }\n    }\n\n    private _adjustActiveSheetOnInsertSheet(mutation: IMutationInfo<IInsertSheetMutationParams>) {\n        // This is simple, just change the active sheet to the unhidden sheet.\n        const { unitId, sheet } = mutation.params;\n        this._switchToNextSheet(unitId, sheet.id);\n    }\n\n    private _adjustActiveSheetOnShowSheet(mutation: IMutationInfo<ISetWorksheetHideMutationParams>) {\n        // This is simple, just change the active sheet to the unhidden sheet.\n        const { unitId, subUnitId } = mutation.params;\n        this._switchToNextSheet(unitId, subUnitId);\n    }\n\n    private _adjustActiveSheetOnSelection(operation: IOperationInfo<ISetSelectionsOperationParams>) {\n        const { unitId, subUnitId } = operation.params;\n        if (subUnitId !== this._univerInstanceService.getUnit<Workbook>(unitId)?.getActiveSheet().getSheetId()) {\n            this._switchToNextSheet(unitId, subUnitId);\n        }\n    }\n\n    private _switchToNextSheet(unitId: string, subUnitId: string): void {\n        this._commandService.executeCommand(SetWorksheetActiveOperation.id, {\n            unitId,\n            subUnitId,\n        } as ISetWorksheetActiveOperationParams);\n    }\n}\n\nfunction findTheNextUnhiddenSheet(workbook: Workbook, startIndex: number): string {\n    const countOfSheets = workbook.getSheetSize();\n\n    // First look to 0 index, then look to the end.\n    for (let i = startIndex; i > -1; i--) {\n        const sheet = workbook.getSheetByIndex(i)!;\n        if (!sheet.getConfig().hidden) {\n            return sheet.getSheetId();\n        }\n    }\n\n    for (let i = startIndex; i < countOfSheets; i++) {\n        const sheet = workbook.getSheetByIndex(i)!;\n        if (!sheet.getConfig().hidden) {\n            return sheet.getSheetId();\n        }\n    }\n\n    throw new Error(\n        '[ActiveWorksheetController]: could not find the next unhidden sheet! Collaboration error perhaps.'\n    );\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { DrawingTypeEnum, ICommandInfo, INeedCheckDisposable, IRange, Nullable, Workbook, Worksheet } from '@univerjs/core';\nimport type { BaseObject, IBoundRectNoAngle, IRender, SpreadsheetSkeleton, Viewport } from '@univerjs/engine-render';\nimport type { ISetWorksheetRowAutoHeightMutationParams, ISheetLocationBase } from '@univerjs/sheets';\nimport type { IPopup } from '@univerjs/ui';\nimport { Disposable, DisposableCollection, ICommandService, Inject, IUniverInstanceService, toDisposable, UniverInstanceType } from '@univerjs/core';\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport { COMMAND_LISTENER_SKELETON_CHANGE, IRefSelectionsService, RefRangeService, SetFrozenMutation, SetWorksheetRowAutoHeightMutation, SheetsSelectionsService } from '@univerjs/sheets';\nimport { ICanvasPopupService } from '@univerjs/ui';\nimport { BehaviorSubject, map } from 'rxjs';\nimport { SetScrollOperation } from '../commands/operations/scroll.operation';\nimport { SetZoomRatioOperation } from '../commands/operations/set-zoom-ratio.operation';\nimport { getViewportByCell, transformBound2OffsetBound } from '../common/utils';\nimport { ISheetSelectionRenderService } from './selection/base-selection-render.service';\nimport { SheetSkeletonManagerService } from './sheet-skeleton-manager.service';\n\nexport interface ICanvasPopup extends Omit<IPopup, 'anchorRect' | 'anchorRect$' | 'unitId' | 'subUnitId' | 'canvasElement'> {\n    mask?: boolean;\n    extraProps?: Record<string, unknown>;\n    showOnSelectionMoving?: boolean;\n}\n\ninterface IPopupMenuItem {\n    label: string;\n    index: number;\n    commandId: string;\n    commandParams: ICommandInfo['params'];\n    disable: boolean;\n}\ntype getPopupMenuItemCallback = (unitId: string, subUnitId: string, drawingId: string, drawingType: DrawingTypeEnum) => IPopupMenuItem[];\n\nexport class SheetCanvasPopManagerService extends Disposable {\n    // the DrawingTypeEnum should refer from drawing package, here we just use type, so no need to import the drawing package\n    private _popupMenuFeatureMap = new Map<DrawingTypeEnum, getPopupMenuItemCallback>();\n    constructor(\n        @Inject(ICanvasPopupService) private readonly _globalPopupManagerService: ICanvasPopupService,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService,\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService,\n        @Inject(RefRangeService) private readonly _refRangeService: RefRangeService,\n        @ICommandService private readonly _commandService: ICommandService,\n        @IRefSelectionsService private readonly _refSelectionsService: ISheetSelectionRenderService,\n        @Inject(SheetsSelectionsService) private readonly _selectionManagerService: SheetsSelectionsService\n    ) {\n        super();\n\n        this._initMoving();\n    }\n\n    private _isSelectionMoving = false;\n\n    private _initMoving() {\n        this.disposeWithMe(\n            this._refSelectionsService.selectionMoving$.subscribe(() => {\n                this._isSelectionMoving = true;\n            })\n        );\n        this.disposeWithMe(\n            this._refSelectionsService.selectionMoveEnd$.subscribe(() => {\n                this._isSelectionMoving = false;\n            })\n        );\n\n        this.disposeWithMe(\n            this._selectionManagerService.selectionMoving$.subscribe(() => {\n                this._isSelectionMoving = true;\n            })\n        );\n        this.disposeWithMe(\n            this._selectionManagerService.selectionMoveEnd$.subscribe(() => {\n                this._isSelectionMoving = false;\n            })\n        );\n    }\n\n    /**\n     * Register a feature menu callback for a specific drawing type.such as image, chart, etc.\n     */\n    registerFeatureMenu(type: DrawingTypeEnum, getPopupMenuCallBack: getPopupMenuItemCallback) {\n        this._popupMenuFeatureMap.set(type, getPopupMenuCallBack);\n    }\n\n    /**\n     * Get the feature menu by drawing type, the function should be called when a drawing element need trigger popup menu, so the unitId, subUnitId, drawingId should be provided.\n     * @param {string} unitId the unit id\n     * @param {string} subUnitId the sub unit id\n     * @param {string} drawingId the drawing id\n     * @param {DrawingTypeEnum} drawingType the feature type\n     * @returns the feature menu if it exists, otherwise return undefined\n     */\n    getFeatureMenu(unitId: string, subUnitId: string, drawingId: string, drawingType: DrawingTypeEnum): Nullable<IPopupMenuItem[]> {\n        const callback = this._popupMenuFeatureMap.get(drawingType);\n        if (callback) {\n            return callback(unitId, subUnitId, drawingId, drawingType);\n        }\n    }\n\n    override dispose(): void {\n        super.dispose();\n        this._popupMenuFeatureMap.clear();\n    }\n\n    private _createHiddenRectObserver(params: { row: number; column: number; worksheet: Worksheet; skeleton: SpreadsheetSkeleton; currentRender: IRender }) {\n        const { row, column, worksheet, skeleton, currentRender } = params;\n        const calc = () => {\n            const freeze = worksheet.getFreeze();\n            const { startRow: freezeStartRow, startColumn: freezeStartColumn, xSplit, ySplit } = freeze;\n            const startRow = freezeStartRow - ySplit;\n            const startColumn = freezeStartColumn - xSplit;\n            const { rowHeightAccumulation, columnWidthAccumulation, rowHeaderWidth, columnHeaderHeight } = skeleton;\n            const canvasFreezeWidth = rowHeaderWidth + (startColumn === -1 ? 0 : (columnWidthAccumulation[startColumn + xSplit - 1] - (columnWidthAccumulation[startColumn - 1] ?? 0)));\n            const canvasFreezeHeight = columnHeaderHeight + (startRow === -1 ? 0 : (rowHeightAccumulation[startRow + ySplit - 1] - (rowHeightAccumulation[startRow] ?? 0)));\n            const canvasElement = currentRender.engine.getCanvasElement();\n            const canvasClientRect = canvasElement.getBoundingClientRect();\n\n            // We should take the scale into account when canvas is scaled by CSS.\n            const widthOfCanvas = pxToNum(canvasElement.style.width); // declared width\n            // const { top, left, width } = canvasClientRect; // real width affected by scale\n            const scaleAdjust = canvasClientRect.width / widthOfCanvas;\n            const canvasScale = currentRender.scene.getAncestorScale().scaleX;\n\n            const freezeWidth = canvasFreezeWidth * scaleAdjust * canvasScale;\n            const freezeHeight = canvasFreezeHeight * scaleAdjust * canvasScale;\n            const viewTopLeft = {\n                left: -Infinity,\n                top: -Infinity,\n                right: canvasClientRect.left + freezeWidth,\n                bottom: canvasClientRect.top + freezeHeight,\n            };\n\n            const viewTopRight = {\n                left: canvasClientRect.left + freezeWidth,\n                top: -Infinity,\n                right: Infinity,\n                bottom: canvasClientRect.top + freezeHeight,\n            };\n\n            const viewBottomLeft = {\n                left: -Infinity,\n                top: canvasClientRect.top + freezeHeight,\n                right: canvasClientRect.left + freezeWidth,\n                bottom: Infinity,\n            };\n            const position = [];\n            if (row < freezeStartRow) {\n                position.push(viewTopLeft);\n            }\n            if (column < freezeStartColumn) {\n                position.push(viewBottomLeft);\n            }\n            if (row < freezeStartRow && column < freezeStartColumn) {\n                return [];\n            } else if (row < freezeStartRow) {\n                return [viewTopLeft];\n            } else if (column < freezeStartColumn) {\n                return [viewTopLeft];\n            } else {\n                return [viewTopLeft, viewTopRight, viewBottomLeft];\n            }\n        };\n\n        const rects = calc();\n\n        const rects$ = new BehaviorSubject(rects);\n\n        const disposable = new DisposableCollection();\n\n        disposable.add(this._commandService.onCommandExecuted((commandInfo) => {\n            if (commandInfo.id === SetFrozenMutation.id) {\n                const newRects = calc();\n                rects$.next(newRects);\n            }\n        }));\n\n        return {\n            rects$,\n            disposable,\n        };\n    }\n\n    // #region attach to object\n    // Unlike _createCellPositionObserver, this bind to a certain position.\n    private _createPositionObserver(\n        bound: IBoundRectNoAngle,\n        currentRender: IRender,\n        skeleton: SpreadsheetSkeleton,\n        worksheet: Worksheet\n    ) {\n        const calc = () => {\n            const { scene } = currentRender;\n            const offsetBound = transformBound2OffsetBound(bound, scene, skeleton, worksheet);\n            const canvasElement = currentRender.engine.getCanvasElement();\n            const canvasClientRect = canvasElement.getBoundingClientRect();\n\n            // We should take the scale into account when canvas is scaled by CSS.\n            const widthOfCanvas = pxToNum(canvasElement.style.width); // declared width\n            // const { top, left, width } = canvasClientRect; // real width affected by scale\n            const scaleAdjust = canvasClientRect.width / widthOfCanvas;\n            const position = {\n                left: (offsetBound.left * scaleAdjust) + canvasClientRect.left,\n                right: (offsetBound.right * scaleAdjust) + canvasClientRect.left,\n                top: (offsetBound.top * scaleAdjust) + canvasClientRect.top,\n                bottom: (offsetBound.bottom * scaleAdjust) + canvasClientRect.top,\n            };\n\n            return position;\n        };\n\n        const position = calc();\n        const position$ = new BehaviorSubject(position);\n        const disposable = new DisposableCollection();\n\n        disposable.add(this._commandService.onCommandExecuted((commandInfo) => {\n            if (commandInfo.id === SetScrollOperation.id || commandInfo.id === SetZoomRatioOperation.id) {\n                position$.next(calc());\n            }\n        }));\n\n        return {\n            position,\n            position$,\n            disposable,\n        };\n    }\n\n    /**\n     * attach a popup to canvas object\n     * @param targetObject target canvas object\n     * @param popup popup item\n     * @returns disposable\n     */\n    attachPopupToObject(targetObject: BaseObject, popup: ICanvasPopup): INeedCheckDisposable {\n        const workbook = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n        const worksheet = workbook.getActiveSheet();\n        if (!worksheet || (this._isSelectionMoving && !popup.showOnSelectionMoving)) {\n            return {\n                dispose: () => {\n                    // empty\n                },\n                canDispose: () => true,\n            };\n        }\n\n        const unitId = workbook.getUnitId();\n        const subUnitId = worksheet.getSheetId();\n        const skeleton = this._renderManagerService.getRenderById(unitId)?.with(SheetSkeletonManagerService).ensureSkeleton(subUnitId);\n\n        const currentRender = this._renderManagerService.getRenderById(unitId);\n        if (!currentRender || !skeleton) {\n            return {\n                dispose: () => {\n                    // empty\n                },\n                canDispose: () => true,\n            };\n        }\n        const { left, top, width, height } = targetObject;\n\n        const bound: IBoundRectNoAngle = {\n            left,\n            right: left + width,\n            top,\n            bottom: top + height,\n        };\n\n        const { position, position$, disposable } = this._createPositionObserver(bound, currentRender, skeleton, worksheet);\n\n        const id = this._globalPopupManagerService.addPopup({\n            ...popup,\n            unitId,\n            subUnitId,\n            anchorRect: position,\n            anchorRect$: position$,\n            canvasElement: currentRender.engine.getCanvasElement(),\n        });\n\n        return {\n            dispose: () => {\n                this._globalPopupManagerService.removePopup(id);\n                position$.complete();\n                disposable.dispose();\n            },\n            canDispose: () => this._globalPopupManagerService.activePopupId !== id,\n        };\n    }\n    // #endregion\n\n    // #region attach to position\n    attachPopupByPosition(bound: IBoundRectNoAngle, popup: ICanvasPopup, location: ISheetLocationBase): Nullable<INeedCheckDisposable> {\n        const workbook = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n        const worksheet = workbook.getActiveSheet();\n        if (!worksheet) {\n            return null;\n        }\n\n        const unitId = workbook.getUnitId();\n        const subUnitId = worksheet.getSheetId();\n        if ((unitId !== location.unitId) || (location.subUnitId !== subUnitId)) {\n            return null;\n        }\n\n        if (this._isSelectionMoving && !popup.showOnSelectionMoving) {\n            return;\n        }\n\n        const skeleton = this._renderManagerService.getRenderById(unitId)?.with(SheetSkeletonManagerService).getOrCreateSkeleton({\n            sheetId: subUnitId,\n        });\n\n        const currentRender = this._renderManagerService.getRenderById(unitId);\n        if (!currentRender || !skeleton) {\n            return null;\n        }\n\n        const { position, position$, disposable } = this._createPositionObserver(bound, currentRender, skeleton, worksheet);\n        const { rects$, disposable: rectsObserverDisposable } = this._createHiddenRectObserver({\n            row: location.row,\n            column: location.col,\n            worksheet,\n            skeleton,\n            currentRender,\n        });\n        const id = this._globalPopupManagerService.addPopup({\n            ...popup,\n            unitId,\n            subUnitId,\n            anchorRect: position,\n            anchorRect$: position$,\n            hiddenRects$: rects$,\n            canvasElement: currentRender.engine.getCanvasElement(),\n        });\n\n        return {\n            dispose: () => {\n                this._globalPopupManagerService.removePopup(id);\n                position$.complete();\n                disposable.dispose();\n                rectsObserverDisposable.dispose();\n            },\n            canDispose: () => this._globalPopupManagerService.activePopupId !== id,\n        };\n    }\n    // #endregion\n\n    // #region attach to absolute position\n    attachPopupToAbsolutePosition(bound: IBoundRectNoAngle, popup: ICanvasPopup, _unitId?: string, _subUnitId?: string) {\n        const workbook = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n        const worksheet = workbook.getActiveSheet();\n        if (!worksheet) {\n            return null;\n        }\n\n        const unitId = workbook.getUnitId();\n        const subUnitId = worksheet.getSheetId();\n        if ((_unitId && unitId !== _unitId) || (_subUnitId && _subUnitId !== subUnitId)) {\n            return null;\n        }\n\n        const skeleton = this._renderManagerService.getRenderById(unitId)?.with(SheetSkeletonManagerService).ensureSkeleton(subUnitId);\n\n        const currentRender = this._renderManagerService.getRenderById(unitId);\n        if (!currentRender || !skeleton) {\n            return null;\n        }\n\n        if (this._isSelectionMoving && !popup.showOnSelectionMoving) {\n            return;\n        }\n\n        const position$ = new BehaviorSubject(bound);\n        const id = this._globalPopupManagerService.addPopup({\n            ...popup,\n            unitId,\n            subUnitId,\n            anchorRect: bound,\n            anchorRect$: position$.asObservable(),\n            canvasElement: currentRender.engine.getCanvasElement(),\n        });\n\n        return {\n            dispose: () => {\n                this._globalPopupManagerService.removePopup(id);\n                position$.complete();\n            },\n            canDispose: () => this._globalPopupManagerService.activePopupId !== id,\n        };\n    }\n    // #endregion\n\n    // #region attach to cell\n\n    /**\n     * Bind popup to the right part of cell at(row, col).\n     * This popup would move with the cell.\n     * @param row\n     * @param col\n     * @param popup\n     * @param _unitId\n     * @param _subUnitId\n     * @param viewport\n     * @returns\n     */\n    attachPopupToCell(row: number, col: number, popup: ICanvasPopup, _unitId?: string, _subUnitId?: string, viewport?: Viewport): Nullable<INeedCheckDisposable> {\n        const workbook = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n        const worksheet = workbook.getActiveSheet();\n        if (!worksheet) {\n            return null;\n        }\n\n        const unitId = workbook.getUnitId();\n        const subUnitId = worksheet.getSheetId();\n        if ((_unitId && unitId !== _unitId) || (_subUnitId && subUnitId !== _subUnitId)) {\n            return null;\n        }\n        const currentRender = this._renderManagerService.getRenderById(unitId);\n        const skeleton = currentRender?.with(SheetSkeletonManagerService).ensureSkeleton(subUnitId);\n        const sheetSelectionRenderService = currentRender?.with(ISheetSelectionRenderService);\n\n        if (!currentRender || !skeleton || !sheetSelectionRenderService) {\n            return null;\n        }\n\n        if (this._isSelectionMoving && (!popup.showOnSelectionMoving)) {\n            return;\n        }\n\n        const activeViewport = viewport ?? getViewportByCell(row, col, currentRender.scene, worksheet);\n        if (!activeViewport) {\n            return null;\n        }\n\n        const { position, position$, disposable: positionObserverDisposable, updateRowCol } = this._createCellPositionObserver(row, col, currentRender, skeleton, activeViewport);\n        const { rects$, disposable: rectsObserverDisposable } = this._createHiddenRectObserver({\n            row,\n            column: col,\n            worksheet,\n            skeleton,\n            currentRender,\n        });\n        const id = this._globalPopupManagerService.addPopup({\n            ...popup,\n            unitId,\n            subUnitId,\n            anchorRect: position,\n            anchorRect$: position$,\n            canvasElement: currentRender.engine.getCanvasElement(),\n            hiddenRects$: rects$,\n        });\n        const disposableCollection = new DisposableCollection();\n        disposableCollection.add(positionObserverDisposable);\n        disposableCollection.add(toDisposable(() => {\n            this._globalPopupManagerService.removePopup(id);\n            position$.complete();\n        }));\n        disposableCollection.add(rectsObserverDisposable);\n\n        // If the range changes, the popup should change with it. And if the range vanished, the popup should be removed.\n        const watchedRange: IRange = { startRow: row, endRow: row, startColumn: col, endColumn: col };\n        disposableCollection.add(this._refRangeService.watchRange(unitId, subUnitId, watchedRange, (_, after) => {\n            if (!after) {\n                disposableCollection.dispose();\n            } else {\n                updateRowCol(after.startRow, after.startColumn);\n            }\n        }));\n\n        return {\n            dispose() {\n                disposableCollection.dispose();\n            },\n            canDispose: () => this._globalPopupManagerService.activePopupId !== id,\n        };\n    }\n\n    /**\n     * attach Comp to floatDOM\n     * @param range\n     * @param popup\n     * @param _unitId\n     * @param _subUnitId\n     * @param viewport\n     * @param showOnSelectionMoving\n     * @returns\n     */\n    attachRangePopup(range: IRange, popup: ICanvasPopup, _unitId?: string, _subUnitId?: string, viewport?: Viewport, showOnSelectionMoving = false): Nullable<INeedCheckDisposable> {\n        const workbook = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n        const worksheet = workbook.getActiveSheet();\n        if (!worksheet) {\n            return null;\n        }\n\n        const unitId = workbook.getUnitId();\n        const subUnitId = worksheet.getSheetId();\n        if ((_unitId && unitId !== _unitId) || (_subUnitId && subUnitId !== _subUnitId)) {\n            return null;\n        }\n        const currentRender = this._renderManagerService.getRenderById(unitId);\n        const skeleton = currentRender?.with(SheetSkeletonManagerService).getOrCreateSkeleton({\n            sheetId: subUnitId,\n        });\n        const sheetSelectionRenderService = currentRender?.with(ISheetSelectionRenderService);\n\n        if (!currentRender || !skeleton || !sheetSelectionRenderService) {\n            return null;\n        }\n\n        if (sheetSelectionRenderService.selectionMoving && !showOnSelectionMoving) {\n            return;\n        }\n\n        const activeViewport = viewport ?? getViewportByCell(range.startRow, range.startColumn, currentRender.scene, worksheet);\n        if (!activeViewport) {\n            return null;\n        }\n\n        const { position, position$, disposable: positionObserverDisposable, updateRowCol, topLeftPos$, rightBottomPos$ } = this._createRangePositionObserver(range, currentRender, skeleton, activeViewport);\n\n        const { rects$, disposable: rectsObserverDisposable } = this._createHiddenRectObserver({\n            row: range.startRow,\n            column: range.startColumn,\n            worksheet,\n            skeleton,\n            currentRender,\n        });\n        const id = this._globalPopupManagerService.addPopup({\n            ...popup,\n            unitId,\n            subUnitId,\n            anchorRect: position,\n            anchorRect$: position$,\n            canvasElement: currentRender.engine.getCanvasElement(),\n            hiddenRects$: rects$,\n        });\n        const disposableCollection = new DisposableCollection();\n        disposableCollection.add(positionObserverDisposable);\n        disposableCollection.add(toDisposable(() => {\n            this._globalPopupManagerService.removePopup(id);\n            topLeftPos$.complete();\n            rightBottomPos$.complete();\n        }));\n        disposableCollection.add(rectsObserverDisposable);\n\n        // If the range changes, the popup should change with it. And if the range vanished, the popup should be removed.\n        const watchedRange = { ...range };\n        disposableCollection.add(this._refRangeService.watchRange(unitId, subUnitId, watchedRange, (_, after) => {\n            if (!after) {\n                disposableCollection.dispose();\n            } else {\n                updateRowCol(after.startRow, after.startColumn);\n            }\n        }));\n\n        return {\n            dispose() {\n                disposableCollection.dispose();\n            },\n            canDispose: () => this._globalPopupManagerService.activePopupId !== id,\n        };\n    }\n\n    /**\n     *\n     * @param initialRow\n     * @param initialCol\n     * @param currentRender\n     * @param skeleton\n     * @param activeViewport\n     * @returns\n     */\n    private _createCellPositionObserver(\n        initialRow: number,\n        initialCol: number,\n        currentRender: IRender,\n        skeleton: SpreadsheetSkeleton,\n        activeViewport: Viewport\n    ) {\n        let row = initialRow;\n        let col = initialCol;\n\n        const position = this._calcCellPositionByCell(row, col, currentRender, skeleton, activeViewport);\n        const position$ = new BehaviorSubject(position);\n        const updatePosition = () => position$.next(this._calcCellPositionByCell(row, col, currentRender, skeleton, activeViewport));\n\n        const disposable = new DisposableCollection();\n        disposable.add(currentRender.engine.clientRect$.subscribe(() => updatePosition()));\n        disposable.add(this._commandService.onCommandExecuted((commandInfo) => {\n            if (commandInfo.id === SetWorksheetRowAutoHeightMutation.id) {\n                const params = commandInfo.params as ISetWorksheetRowAutoHeightMutationParams;\n                if (params.rowsAutoHeightInfo.findIndex((item) => item.row === row) > -1) {\n                    updatePosition();\n                    return;\n                }\n            }\n\n            if (\n                COMMAND_LISTENER_SKELETON_CHANGE.indexOf(commandInfo.id) > -1 ||\n                commandInfo.id === SetScrollOperation.id ||\n                commandInfo.id === SetZoomRatioOperation.id\n            ) {\n                updatePosition();\n            }\n        }));\n\n        const updateRowCol = (newRow: number, newCol: number) => {\n            row = newRow;\n            col = newCol;\n\n            updatePosition();\n        };\n\n        return {\n            position$,\n            disposable,\n            position,\n            updateRowCol,\n        };\n    }\n\n    // TODO @lumixraku to a normal function, not method.\n    private _calcCellPositionByCell(\n        row: number,\n        col: number,\n        currentRender: IRender,\n        skeleton: SpreadsheetSkeleton,\n        activeViewport: Viewport\n    ): IBoundRectNoAngle {\n        const { scene, engine } = currentRender;\n\n        const primaryWithCoord = skeleton.getCellWithCoordByIndex(row, col);\n        const cellInfo = primaryWithCoord.isMergedMainCell ? primaryWithCoord.mergeInfo : primaryWithCoord;\n\n        const { scaleX, scaleY } = scene.getAncestorScale();\n        const scrollXY = {\n            x: activeViewport.viewportScrollX,\n            y: activeViewport.viewportScrollY,\n        };\n\n        const canvasElement = engine.getCanvasElement();\n        const canvasClientRect = canvasElement.getBoundingClientRect();\n\n        // We should take the scale into account when canvas is scaled by CSS.\n        const widthOfCanvas = pxToNum(canvasElement.style.width); // declared width\n        const { top, left, width } = canvasClientRect; // real width affected by scale\n        const scaleAdjust = width / widthOfCanvas;\n\n        return {\n            left: ((cellInfo.startX - scrollXY.x) * scaleAdjust * scaleX) + left,\n            right: (cellInfo.endX - scrollXY.x) * scaleAdjust * scaleX + left,\n            top: ((cellInfo.startY - scrollXY.y) * scaleAdjust * scaleY) + top,\n            bottom: ((cellInfo.endY - scrollXY.y) * scaleAdjust * scaleY) + top,\n        };\n    }\n    // #endregion\n\n    /**\n     * Unlike _createCellPositionObserver, this accept a range not a single cell.\n     * @param initialRow\n     * @param initialCol\n     * @param currentRender\n     * @param skeleton\n     * @param activeViewport\n     */\n    private _createRangePositionObserver(\n        range: IRange,\n        currentRender: IRender,\n        skeleton: SpreadsheetSkeleton,\n        activeViewport: Viewport\n    ) {\n        let { startRow, startColumn } = range;\n        const topLeftCoord = this._calcCellPositionByCell(startRow, startColumn, currentRender, skeleton, activeViewport);\n        const topLeftPos$ = new BehaviorSubject(topLeftCoord);\n        const rightBottomCoord = this._calcCellPositionByCell(range.endRow, range.endColumn, currentRender, skeleton, activeViewport);\n        const rightBottomPos$ = new BehaviorSubject(rightBottomCoord);\n\n        const updatePosition = () => {\n            const topLeftCoord = this._calcCellPositionByCell(startRow, startColumn, currentRender, skeleton, activeViewport);\n            const rightBottomCoord = this._calcCellPositionByCell(range.endRow, range.endColumn, currentRender, skeleton, activeViewport);\n\n            topLeftPos$.next(topLeftCoord);\n            rightBottomPos$.next(rightBottomCoord);\n        };\n\n        const disposable = new DisposableCollection();\n        disposable.add(currentRender.engine.clientRect$.subscribe(() => updatePosition()));\n\n        disposable.add(this._commandService.onCommandExecuted((commandInfo) => {\n            if (commandInfo.id === SetWorksheetRowAutoHeightMutation.id) {\n                const params = commandInfo.params as ISetWorksheetRowAutoHeightMutationParams;\n                if (params.rowsAutoHeightInfo.findIndex((item) => item.row === startRow) > -1) {\n                    updatePosition();\n                    return;\n                }\n            }\n\n            if (\n                COMMAND_LISTENER_SKELETON_CHANGE.indexOf(commandInfo.id) > -1 ||\n                commandInfo.id === SetScrollOperation.id ||\n                commandInfo.id === SetZoomRatioOperation.id\n            ) {\n                updatePosition();\n            }\n        }));\n\n        const updateRowCol = (newRow: number, newCol: number) => {\n            startRow = newRow;\n            startColumn = newCol;\n\n            updatePosition();\n        };\n        // const position$ = combineLatest(topLeftPos$, rightBottomPos$);\n        const position$ = topLeftPos$.pipe(\n            map((topLeft) => {\n                const rightBottomCoord = this._calcCellPositionByCell(range.endRow, range.endColumn, currentRender, skeleton, activeViewport);\n                return {\n                    top: topLeft.top,\n                    left: topLeft.left,\n                    right: rightBottomCoord.right,\n                    bottom: rightBottomCoord.bottom,\n                };\n            })\n        );\n        const position: IBoundRectNoAngle = {\n            top: topLeftCoord.top,\n            left: topLeftCoord.left,\n            right: rightBottomCoord.right,\n            bottom: rightBottomCoord.bottom,\n        };\n        return {\n            position$,\n            position,\n            updateRowCol,\n            topLeftPos$,\n            rightBottomPos$,\n            disposable,\n        };\n    }\n}\n\nfunction pxToNum(width: string): number {\n    return Number.parseInt(width.replace('px', ''));\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IDisposable } from '@univerjs/core';\nimport type { ISheetLocationBase } from '@univerjs/sheets';\nimport { Disposable, Inject } from '@univerjs/core';\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport { Subject } from 'rxjs';\nimport { CELL_ALERT_KEY } from '../views/cell-alert';\nimport { SheetCanvasPopManagerService } from './canvas-pop-manager.service';\n\nexport enum CellAlertType {\n    INFO,\n    WARNING,\n    ERROR,\n}\n\nexport interface ICellAlert {\n    type: CellAlertType;\n    title: React.ReactNode;\n    message: React.ReactNode;\n    location: ISheetLocationBase;\n    width: number;\n    height: number;\n    key: string;\n}\n\nexport class CellAlertManagerService extends Disposable {\n    private _currentAlert$ = new Subject<[string, { alert: ICellAlert; dispose: IDisposable }][]>();\n    private _currentAlert: Map<string, { alert: ICellAlert; dispose: IDisposable }> = new Map();\n\n    get currentAlert() {\n        return this._currentAlert;\n    }\n\n    currentAlert$ = this._currentAlert$.asObservable();\n\n    constructor(\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService,\n        @Inject(SheetCanvasPopManagerService) private readonly _canvasPopManagerService: SheetCanvasPopManagerService\n    ) {\n        super();\n\n        this.disposeWithMe(() => {\n            this._currentAlert$.complete();\n        });\n    }\n\n    showAlert(alert: ICellAlert) {\n        let lastPopup = this._currentAlert.get(alert.key);\n        if (lastPopup) {\n            lastPopup.dispose.dispose();\n        };\n        if (lastPopup) {\n            lastPopup.dispose.dispose();\n        } else {\n            lastPopup = {\n                alert,\n                dispose: {\n                    dispose() {\n                        // empty\n                    },\n                },\n            };\n            this._currentAlert.set(alert.key, lastPopup);\n        }\n\n        const { location } = alert;\n        const { row, col, unitId } = location;\n\n        const currentRender = this._renderManagerService.getRenderById(unitId);\n        if (!currentRender) {\n            return;\n        }\n\n        const disposable = this._canvasPopManagerService.attachPopupToCell(row, col, {\n            componentKey: CELL_ALERT_KEY,\n            direction: 'horizontal',\n            offset: [2, 0],\n            extraProps: {\n                alert,\n            },\n        });\n        if (disposable) {\n            lastPopup.dispose = disposable;\n        }\n\n        this._currentAlert$.next(Array.from(this._currentAlert.entries()));\n    }\n\n    removeAlert(key: string) {\n        const lastPopup = this._currentAlert.get(key);\n        if (lastPopup) {\n            this._currentAlert.delete(key);\n            lastPopup?.dispose.dispose();\n            this._currentAlert$.next(Array.from(this._currentAlert.entries()));\n        }\n    }\n\n    clearAlert() {\n        this._currentAlert.forEach((alert) => {\n            alert.dispose.dispose();\n        });\n\n        this._currentAlert.clear();\n        this._currentAlert$.next(Array.from(this._currentAlert.entries()));\n    }\n}\n", "export default {\n  \"cellAlert\": \"univer-cell-alert\",\n  \"cellAlertTitle\": \"univer-cell-alert-title\",\n  \"cellAlertIcon\": \"univer-cell-alert-icon\",\n  \"cellAlertIconError\": \"univer-cell-alert-icon-error\",\n  \"cellAlertIconInfo\": \"univer-cell-alert-icon-info\",\n  \"cellAlertIconWarning\": \"univer-cell-alert-icon-warning\",\n  \"cellAlertContent\": \"univer-cell-alert-content\"\n};import \"ni:sha-256;OBJYItRgHGluL09WW_iuQYjRRYPI4QkI5AQXvF_2q9c\";", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICanvasPopup } from '../../services/canvas-pop-manager.service';\nimport type { ICellAlert } from '../../services/cell-alert-manager.service';\nimport { clsx } from '@univerjs/design';\nimport { ErrorSingle, WarningSingle } from '@univerjs/icons';\nimport { CellAlertType } from '../../services/cell-alert-manager.service';\nimport styles from './index.module.less';\n\n/**\n *\n * @param root0\n * @param root0.popup\n */\nexport function CellAlert({ popup }: { popup: ICanvasPopup }) {\n    const alert = popup.extraProps?.alert;\n\n    if (!alert) {\n        return null;\n    }\n    const { type, title, message } = alert as ICellAlert;\n\n    const iconMap = {\n        [CellAlertType.ERROR]: <ErrorSingle className={clsx(styles.cellAlertIcon, styles.cellAlertIconError)} />,\n        [CellAlertType.INFO]: <WarningSingle className={clsx(styles.cellAlertIcon, styles.cellAlertIconInfo)} />,\n        [CellAlertType.WARNING]: <WarningSingle className={clsx(styles.cellAlertIcon, styles.cellAlertIconWarning)} />,\n    };\n\n    return (\n        <div className={styles.cellAlert}>\n            <div className={styles.cellAlertTitle}>\n                {type ? iconMap[type] : null}\n                {title}\n            </div>\n            <div className={styles.cellAlertContent}>{message}</div>\n        </div>\n    );\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport { CellAlert } from './CellAlertPopup';\n\nconst CELL_ALERT_KEY = 'univer.sheet.cell-alert';\n\nexport {\n    CELL_ALERT_KEY,\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport type { IRenderContext, IRenderModule } from '@univerjs/engine-render';\nimport { Disposable, Inject } from '@univerjs/core';\nimport { ComponentManager } from '@univerjs/ui';\nimport { CELL_ALERT_KEY } from '../views/cell-alert';\nimport { CellAlert } from '../views/cell-alert/CellAlertPopup';\n\n// FIXME@weird94: this should not be render module\n\nexport class CellAlertRenderController extends Disposable implements IRenderModule {\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(ComponentManager) private _componentManager: ComponentManager\n    ) {\n        super();\n        this._initComponent();\n    }\n\n    private _initComponent() {\n        this._componentManager.register(CELL_ALERT_KEY, CellAlert);\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellCustomRender, ICellDataForSheetInterceptor, ICellRenderContext, Nullable, Workbook } from '@univerjs/core';\nimport type { IMouseEvent, IPointerEvent, IRenderContext, IRenderModule, RenderManagerService, Spreadsheet } from '@univerjs/engine-render';\nimport type { ICellPermission } from '@univerjs/sheets';\nimport type { ISheetSkeletonManagerParam } from '../services/sheet-skeleton-manager.service';\nimport { Disposable, DisposableCollection, fromEventSubject, Inject, IPermissionService, sortRules } from '@univerjs/core';\nimport { IRenderManagerService, Vector2 } from '@univerjs/engine-render';\nimport { UnitAction, WorkbookEditablePermission, WorksheetEditPermission } from '@univerjs/sheets';\nimport { throttleTime } from 'rxjs';\nimport { SheetSkeletonManagerService } from '../services/sheet-skeleton-manager.service';\n\nexport class CellCustomRenderController extends Disposable implements IRenderModule {\n    private _enterActiveRender: Nullable<{\n        render: ICellCustomRender;\n        cellContext: ICellRenderContext;\n    }>;\n\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(SheetSkeletonManagerService) private readonly _sheetSkeletonManagerService: SheetSkeletonManagerService,\n        @IRenderManagerService private readonly _renderManagerService: RenderManagerService,\n        @IPermissionService private readonly _permissionService: IPermissionService\n    ) {\n        super();\n        this._initEventBinding();\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    private _initEventBinding() {\n        const disposableCollection = new DisposableCollection();\n\n        const workbook = this._context.unit;\n        // eslint-disable-next-line max-lines-per-function\n        const handleSkeletonChange = (skeletonParam: Nullable<ISheetSkeletonManagerParam>) => {\n            disposableCollection.dispose();\n            if (!skeletonParam) {\n                return;\n            }\n\n            const unitId = this._context.unitId;\n            const { skeleton } = skeletonParam;\n            const currentRender = this._renderManagerService.getRenderById(unitId);\n            if (currentRender && currentRender.mainComponent) {\n                const spreadsheet = currentRender.mainComponent as Spreadsheet;\n                // eslint-disable-next-line max-lines-per-function\n                const getActiveRender = (evt: IPointerEvent | IMouseEvent) => {\n                    const { offsetX, offsetY } = evt;\n                    const scene = currentRender.scene;\n                    const worksheet = workbook.getActiveSheet();\n\n                    if (!worksheet) {\n                        return;\n                    }\n\n                    const activeViewport = scene.getActiveViewportByCoord(\n                        Vector2.FromArray([offsetX, offsetY])\n                    );\n\n                    if (!activeViewport) {\n                        return;\n                    }\n\n                    const { scaleX, scaleY } = scene.getAncestorScale();\n\n                    const scrollXY = {\n                        x: activeViewport.viewportScrollX,\n                        y: activeViewport.viewportScrollY,\n                    };\n\n                    const cellPos = skeleton.getCellIndexByOffset(offsetX, offsetY, scaleX, scaleY, scrollXY);\n\n                    // const mergeCell = skeleton.mergeData.find((range) => {\n                    //     const { startColumn, startRow, endColumn, endRow } = range;\n                    //     return cellPos.row >= startRow && cellPos.column >= startColumn && cellPos.row <= endRow && cellPos.column <= endColumn;\n                    // });\n                    const mergeCell = skeleton.worksheet.getMergedCell(cellPos.row, cellPos.column);\n\n                    const cellIndex = {\n                        actualRow: mergeCell ? mergeCell.startRow : cellPos.row,\n                        actualCol: mergeCell ? mergeCell.startColumn : cellPos.column,\n                        mergeCell,\n                        row: cellPos.row,\n                        col: cellPos.column,\n                    };\n\n                    if (!cellIndex || !skeleton) {\n                        return;\n                    }\n\n                    const cellData = worksheet.getCell(cellIndex.actualRow, cellIndex.actualCol);\n                    if (!cellData) {\n                        return;\n                    }\n\n                    const renders = cellData.customRender;\n\n                    if (!renders?.length) {\n                        return;\n                    }\n                    const row = cellIndex.actualRow;\n                    const col = cellIndex.actualCol;\n                    const sortedRenders = renders.sort(sortRules);\n                    const subUnitId = worksheet.getSheetId();\n\n                    const info: ICellRenderContext = {\n                        data: cellData,\n                        style: skeleton.getStyles().getStyleByCell(cellData),\n                        primaryWithCoord: skeleton.getCellWithCoordByIndex(cellIndex.actualRow, cellIndex.actualCol),\n                        unitId,\n                        subUnitId,\n                        row,\n                        col,\n                        workbook,\n                        worksheet,\n                    };\n\n                    const position = {\n                        x: scrollXY.x + (offsetX / scaleX),\n                        y: scrollXY.y + (offsetY / scaleY),\n                    };\n\n                    const activeRender = sortedRenders.find((render) => render.isHit?.(position, info));\n                    if (!activeRender) {\n                        return;\n                    }\n                    return [activeRender, info] as const;\n                };\n\n                const disposable = spreadsheet.onPointerDown$.subscribeEvent((evt) => {\n                    const activeRenderInfo = getActiveRender(evt);\n                    if (activeRenderInfo) {\n                        const [activeRender, cellContext] = activeRenderInfo;\n                        const { row, col, worksheet, unitId, subUnitId } = cellContext;\n                        const sheetEditable = this._permissionService.composePermission(\n                            [new WorkbookEditablePermission(unitId).id, new WorksheetEditPermission(unitId, subUnitId).id]\n                        )?.every((permission) => permission.value);\n\n                        if (!sheetEditable) {\n                            return false;\n                        }\n\n                        const permission = (worksheet.getCell(row, col) as (ICellDataForSheetInterceptor & { selectionProtection: ICellPermission[] }))?.selectionProtection?.[0];\n                        if (permission?.[UnitAction.Edit] === false) {\n                            return false;\n                        }\n\n                        activeRender.onPointerDown?.(cellContext, evt);\n                    }\n                });\n\n                const moveDisposable = fromEventSubject(spreadsheet.onPointerMove$).pipe(throttleTime(30)).subscribe((evt) => {\n                    const activeRenderInfo = getActiveRender(evt);\n                    if (activeRenderInfo) {\n                        const [activeRender, cellContext] = activeRenderInfo;\n                        if (this._enterActiveRender) {\n                            if (this._enterActiveRender.render !== activeRender) {\n                                this._enterActiveRender.render.onPointerLeave?.(this._enterActiveRender.cellContext, evt);\n                                this._enterActiveRender = {\n                                    render: activeRender,\n                                    cellContext,\n                                };\n                                activeRender.onPointerEnter?.(cellContext, evt);\n                            }\n                        } else {\n                            this._enterActiveRender = {\n                                render: activeRender,\n                                cellContext,\n                            };\n                            activeRender.onPointerEnter?.(cellContext, evt);\n                        }\n                    } else {\n                        if (this._enterActiveRender) {\n                            this._enterActiveRender.render.onPointerLeave?.(this._enterActiveRender.cellContext, evt);\n                            this._enterActiveRender = null;\n                        }\n                    }\n                });\n\n                disposable && disposableCollection.add(disposable);\n                moveDisposable && disposableCollection.add(moveDisposable);\n            }\n        };\n\n        this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(handleSkeletonChange));\n        handleSkeletonChange(this._sheetSkeletonManagerService.getCurrentParam());\n        this.disposeWithMe(disposableCollection);\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IDiscreteRange } from '../../controllers/utils/range-tools';\nimport type { IPasteHookKeyType } from '../../services/clipboard/type';\nimport { ICommandService, IUniverInstanceService, LocaleService } from '@univerjs/core';\nimport { clsx, Dropdown } from '@univerjs/design';\nimport { convertTransformToOffsetX, convertTransformToOffsetY, IRenderManagerService } from '@univerjs/engine-render';\nimport { CheckMarkSingle, MoreDownSingle, PasteSpecial } from '@univerjs/icons';\nimport { useDependency, useObservable } from '@univerjs/ui';\nimport { useState } from 'react';\nimport { SheetOptionalPasteCommand } from '../../commands/commands/clipboard.command';\nimport { useActiveWorkbook } from '../../components/hook';\n// import { SheetClipboardController } from '../../controllers/clipboard/clipboard.controller';\nimport { getSheetObject } from '../../controllers/utils/component-tools';\nimport { ISheetClipboardService, PREDEFINED_HOOK_NAME } from '../../services/clipboard/clipboard.service';\nimport { ISheetSelectionRenderService } from '../../services/selection/base-selection-render.service';\nimport { SheetSkeletonManagerService } from '../../services/sheet-skeleton-manager.service';\nimport styles from './index.module.less';\n\nconst DEFAULT_PADDING = 2;\n\nconst SheetPasteOptions = [\n    { value: 'DEFAULT_PASTE', label: 'rightClick.paste' },\n    { value: 'SPECIAL_PASTE_VALUE', label: 'rightClick.pasteValue' },\n    { value: 'SPECIAL_PASTE_FORMAT', label: 'rightClick.pasteFormat' },\n    { value: 'SPECIAL_PASTE_COL_WIDTH', label: 'rightClick.pasteColWidth' },\n    { value: 'SPECIAL_PASTE_BESIDES_BORDER', label: 'rightClick.pasteBesidesBorder' },\n    { value: 'SPECIAL_PASTE_FORMULA', label: 'formula.operation.pasteFormula' },\n];\n\nconst useMenuPosition = (range?: IDiscreteRange) => {\n    const univerInstanceService = useDependency(IUniverInstanceService);\n    const renderManagerService = useDependency(IRenderManagerService);\n\n    const workbook = useActiveWorkbook();\n    if (!range || !workbook) return null;\n\n    const anchor = {\n        startRow: range.rows[0],\n        startCol: range.cols[0],\n        endRow: range.rows[range.rows.length - 1],\n        endCol: range.cols[range.cols.length - 1],\n    };\n\n    if (anchor.endRow < 0 || anchor.endCol < 0) {\n        return null;\n    }\n\n    const ru = renderManagerService.getRenderById(workbook.getUnitId());\n    const sheetSkeletonManagerService = ru?.with(SheetSkeletonManagerService);\n    const selectionRenderService = ru?.with(ISheetSelectionRenderService);\n\n    const sheetObject = getSheetObject(univerInstanceService, renderManagerService);\n    if (!sheetObject || !selectionRenderService) return null;\n\n    const { scene } = sheetObject;\n    const skeleton = sheetSkeletonManagerService?.getCurrentSkeleton();\n    const viewport = selectionRenderService.getViewPort();\n    const scaleX = scene?.scaleX;\n    const scaleY = scene?.scaleY;\n    const scrollXY = scene?.getViewportScrollXY(viewport);\n    const canvas = scene.getEngine()?.getCanvas();\n    if (!scaleX || !scene || !scaleX || !scaleY || !scrollXY) return null;\n\n    const endPosition = skeleton?.getNoMergeCellPositionByIndex(anchor.endRow, anchor.endCol);\n    const endX = endPosition?.endX ?? 0;\n    const endY = endPosition?.endY ?? 0;\n\n    const positionEndX = convertTransformToOffsetX(endX, scaleX, scrollXY) ?? -9999;\n    const positionEndY = convertTransformToOffsetY(endY, scaleY, scrollXY) ?? -9999;\n\n    const canvasWidth = canvas?.getWidth();\n    const canvasHeight = canvas?.getHeight();\n\n    if (!canvasWidth || !canvasHeight) return null;\n\n    const XInSideView = positionEndX + 50 <= canvasWidth;\n    const YInSideView = positionEndY + 50 <= canvasHeight;\n\n    let positionX = positionEndX;\n    let positionY = positionEndY;\n\n    if (!XInSideView) {\n        positionX = canvasWidth - 100;\n    }\n\n    if (!YInSideView) {\n        positionY = canvasHeight - 100;\n    }\n\n    return {\n        positionX,\n        positionY,\n    };\n};\n\nexport const ClipboardPopupMenu = () => {\n    const clipboardService = useDependency(ISheetClipboardService);\n    const showMenu = useObservable(clipboardService.showMenu$, false);\n    // const clipboardController = useDependency(SheetClipboardController);\n    const pasteOptionsCache = useObservable(clipboardService.pasteOptionsCache$, null);\n    const localeService = useDependency(LocaleService);\n    const commandService = useDependency(ICommandService);\n\n    const [menuHovered, setMenuHovered] = useState(false);\n    const [menuVisible, setMenuVisible] = useState(false);\n\n    // const version = useObservable(clipboardController.refreshOptionalPaste$, Math.random());\n\n    const range = pasteOptionsCache?.target.pastedRange;\n\n    const relativePosition = useMenuPosition(range);\n\n    if (!relativePosition || !showMenu) return null;\n\n    if (relativePosition.positionX < 50 || relativePosition.positionY < 30) return null;\n\n    const iconVisible = menuHovered || menuVisible;\n\n    const handleClick = (type: string) => {\n        setMenuVisible(false);\n        commandService.executeCommand(SheetOptionalPasteCommand.id, { type });\n    };\n\n    return (\n        <div\n            className={styles.sheetPasteOptionsWrapper}\n            style={{\n                left: relativePosition.positionX + DEFAULT_PADDING,\n                top: relativePosition.positionY + DEFAULT_PADDING,\n            }}\n            onMouseEnter={() => setMenuHovered(true)}\n            onMouseLeave={() => setMenuHovered(false)}\n        >\n            <Dropdown\n                overlay={(\n                    <div\n                        className={clsx(styles.sheetPasteOptionsMenu, `\n                          univer-border univer-border-solid univer-border-gray-200 univer-opacity-100\n                        `)}\n                    >\n                        <ul>\n                            {SheetPasteOptions.map((item) => {\n                                const itemType = PREDEFINED_HOOK_NAME[item.value as IPasteHookKeyType];\n                                const selected = pasteOptionsCache?.pasteType === itemType;\n                                return (\n                                    <li\n                                        key={item.value}\n                                        className={clsx(styles.sheetPasteOptionsMenuItem, 'hover:univer-bg-neutral-100')}\n                                        onClick={() => handleClick(item.value)}\n                                    >\n                                        <span>\n                                            {selected && (\n                                                <CheckMarkSingle className={styles.sheetPasteOptionsMenuItemIcon} style={{ color: 'rgb(var(--green-700, #409f11))' }} />\n                                            )}\n                                        </span>\n                                        <div\n                                            className={clsx(styles.sheetPasteOptionsMenuItemTitle, `\n                                              univer-text-gray-700\n                                            `)}\n                                        >\n                                            {localeService.t(item.label)}\n                                        </div>\n                                    </li>\n                                );\n                            })}\n                        </ul>\n                    </div>\n                )}\n                open={menuVisible}\n                onOpenChange={setMenuVisible}\n            >\n\n                <div\n                    className={styles.sheetPasteOptionsIconWrapper}\n                    onClick={() => {\n                        setMenuVisible(!menuVisible);\n                    }}\n                >\n                    <PasteSpecial\n                        style={{ color: '#35322B' }}\n                        extend={{ colorChannel1: 'rgb(var(--green-700))' }}\n                    />\n                    {iconVisible && <MoreDownSingle />}\n                </div>\n            </Dropdown>\n        </div>\n    );\n};\n", "export default {\n  \"sheetPasteOptionsWrapper\": \"univer-sheet-paste-options-wrapper\",\n  \"sheetPasteOptionsIconWrapper\": \"univer-sheet-paste-options-icon-wrapper\",\n  \"sheetPasteOptionsMenu\": \"univer-sheet-paste-options-menu\",\n  \"sheetPasteOptionsMenuItem\": \"univer-sheet-paste-options-menu-item\",\n  \"sheetPasteOptionsMenuItemTitle\": \"univer-sheet-paste-options-menu-item-title\",\n  \"sheetPasteOptionsMenuItemIcon\": \"univer-sheet-paste-options-menu-item-icon\"\n};import \"ni:sha-256;q5M11Qp_VHm91OSVXggjxGEton8MkraR4J6b8cASO80\";", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UndoCommandId } from '@univerjs/core';\nimport { InsertColMutation, InsertRowMutation, MoveColsMutation, MoveRangeMutation, MoveRowsMutation, RemoveColMutation, RemoveRowMutation, SetRangeValuesCommand, SetSelectionsOperation, SetWorksheetColWidthMutation, SetWorksheetRowHeightMutation } from '@univerjs/sheets';\nimport { SetCellEditVisibleOperation } from '../../commands/operations/cell-edit.operation';\nimport { SetZoomRatioOperation } from '../../commands/operations/set-zoom-ratio.operation';\n\nexport const RemovePasteMenuCommands = [\n    SetCellEditVisibleOperation.id,\n    SetRangeValuesCommand.id,\n    SetZoomRatioOperation.id,\n    MoveRangeMutation.id,\n    RemoveRowMutation.id,\n    RemoveColMutation.id,\n    InsertRowMutation.id,\n    InsertColMutation.id,\n    MoveRowsMutation.id,\n    MoveColsMutation.id,\n    SetWorksheetColWidthMutation.id,\n    SetWorksheetRowHeightMutation.id,\n    SetSelectionsOperation.id,\n    UndoCommandId,\n];\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DOCS_VIEW_KEY } from '@univerjs/docs-ui';\nimport type { Nullable } from '@univerjs/core';\nimport type { DocBackground, Documents, Engine, IRenderManagerService, Scene } from '@univerjs/engine-render';\n\nexport interface IDocObjectParam {\n    document: Documents;\n    docBackground: DocBackground;\n    scene: Scene;\n    engine: Engine;\n}\n\nexport function getEditorObject(\n    unitId: Nullable<string>,\n    renderManagerService: IRenderManagerService\n): Nullable<IDocObjectParam> {\n    if (unitId == null) {\n        return;\n    }\n\n    const currentRender = renderManagerService.getRenderById(unitId);\n\n    if (currentRender == null) {\n        return;\n    }\n\n    const { mainComponent, scene, engine, components } = currentRender;\n\n    const document = mainComponent as Documents;\n    const docBackground = components.get(DOCS_VIEW_KEY.BACKGROUND) as DocBackground;\n\n    return {\n        document,\n        docBackground,\n        scene,\n        engine,\n    };\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { DocumentDataModel, IPosition, Nullable, Workbook } from '@univerjs/core';\nimport type { DocumentSkeleton, IDocumentLayoutObject, IRenderContext, IRenderModule, Scene } from '@univerjs/engine-render';\nimport { Disposable, DOCS_NORMAL_EDITOR_UNIT_ID_KEY, HorizontalAlign, Inject, IUniverInstanceService, UniverInstanceType, VerticalAlign, WrapStrategy } from '@univerjs/core';\nimport { DocSkeletonManagerService } from '@univerjs/docs';\nimport { DOCS_COMPONENT_MAIN_LAYER_INDEX, VIEWPORT_KEY } from '@univerjs/docs-ui';\nimport { convertTextRotation, fixLineWidthByScale, IRenderManagerService, Rect, ScrollBar } from '@univerjs/engine-render';\nimport { ILayoutService } from '@univerjs/ui';\nimport { getEditorObject } from '../../basics/editor/get-editor-object';\nimport { SHEET_FOOTER_BAR_HEIGHT } from '../../views/sheet-container/SheetContainer';\nimport { IEditorBridgeService } from '../editor-bridge.service';\nimport { SheetSkeletonManagerService } from '../sheet-skeleton-manager.service';\nimport { ICellEditorManagerService } from './cell-editor-manager.service';\n\nconst EDITOR_INPUT_SELF_EXTEND_GAP = 5;\n\nconst EDITOR_BORDER_SIZE = 2;\n\ninterface ICanvasOffset {\n    left: number;\n    top: number;\n}\n\nexport class SheetCellEditorResizeService extends Disposable implements IRenderModule {\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @ILayoutService private readonly _layoutService: ILayoutService,\n        @ICellEditorManagerService private readonly _cellEditorManagerService: ICellEditorManagerService,\n        @IEditorBridgeService private readonly _editorBridgeService: IEditorBridgeService,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService,\n        @Inject(SheetSkeletonManagerService) private readonly _sheetSkeletonManagerService: SheetSkeletonManagerService,\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService\n    ) {\n        super();\n    }\n\n    // eslint-disable-next-line complexity\n    fitTextSize(callback?: () => void) {\n        const param = this._editorBridgeService.getEditCellState();\n        if (!param) return;\n        const { position, documentLayoutObject, canvasOffset, scaleX, scaleY } = param;\n\n        const { startX, startY, endX, endY } = position;\n        const documentDataModel = this._univerInstanceService.getUnit<DocumentDataModel>(DOCS_NORMAL_EDITOR_UNIT_ID_KEY, UniverInstanceType.UNIVER_DOC);\n\n        if (documentDataModel == null) {\n            return;\n        }\n\n        const documentSkeleton = this._getEditorSkeleton();\n        if (!documentSkeleton) return;\n\n        const info = this._predictingSize(\n            position,\n            canvasOffset,\n            documentSkeleton,\n            documentLayoutObject,\n            scaleX,\n            scaleY\n        );\n        if (!info) return;\n        let { actualWidth, actualHeight } = info;\n        const { verticalAlign, horizontalAlign, paddingData, fill } = documentLayoutObject;\n        actualWidth = actualWidth + (paddingData.l ?? 0) + (paddingData.r ?? 0);\n        actualHeight = actualHeight + (paddingData.t ?? 0) + (paddingData.b ?? 0);\n\n        let editorWidth = endX - startX;\n        let editorHeight = endY - startY;\n        if (editorWidth < actualWidth) {\n            editorWidth = Math.ceil(actualWidth);\n        }\n\n        if (editorHeight < actualHeight) {\n            editorHeight = Math.ceil(actualHeight);\n        }\n\n        // Set the top margin under vertical alignment.\n        let offsetTop = 0;\n\n        if (verticalAlign === VerticalAlign.MIDDLE) {\n            offsetTop = (editorHeight - actualHeight) / 2 / scaleY;\n        } else if (verticalAlign === VerticalAlign.TOP) {\n            offsetTop = paddingData.t || 0;\n        } else {\n            // VerticalAlign.UNSPECIFIED follow the same rule as HorizontalAlign.BOTTOM.\n            offsetTop = (editorHeight - actualHeight) / scaleY;\n        }\n\n        let offsetLeft = 0;\n        if (horizontalAlign === HorizontalAlign.CENTER) {\n            offsetLeft = (editorWidth - actualWidth) / 2 / scaleX;\n        } else if (horizontalAlign === HorizontalAlign.RIGHT) {\n            offsetLeft = (editorWidth - actualWidth) / scaleX;\n        } else {\n            offsetLeft = paddingData.l || 0;\n        }\n\n        offsetTop = offsetTop < (paddingData.t || 0) ? paddingData.t || 0 : offsetTop;\n        offsetLeft = offsetLeft < (paddingData.l || 0) ? paddingData.l || 0 : offsetLeft;\n        documentDataModel.updateDocumentDataMargin({\n            t: offsetTop,\n            l: offsetLeft,\n        });\n\n        documentSkeleton.calculate();\n        this._editAreaProcessing(\n            editorWidth,\n            editorHeight,\n            position,\n            canvasOffset,\n            fill,\n            scaleX,\n            scaleY,\n            horizontalAlign,\n            callback\n        );\n    }\n\n    /**\n     * Mainly used to pre-calculate the width of the editor,\n     * to determine whether it needs to be automatically widened.\n     */\n    private _predictingSize(\n        actualRangeWithCoord: IPosition,\n        canvasOffset: ICanvasOffset,\n        documentSkeleton: DocumentSkeleton,\n        documentLayoutObject: IDocumentLayoutObject,\n        scaleX: number = 1,\n        scaleY: number = 1\n    ) {\n        // startX and startY are the width and height after scaling.\n        const { startX, endX } = actualRangeWithCoord;\n\n        const { textRotation, wrapStrategy, paddingData } = documentLayoutObject;\n\n        const documentDataModel = this._univerInstanceService.getUnit<DocumentDataModel>(DOCS_NORMAL_EDITOR_UNIT_ID_KEY, UniverInstanceType.UNIVER_DOC);\n\n        const { vertexAngle: angle } = convertTextRotation(textRotation);\n\n        if (wrapStrategy === WrapStrategy.WRAP && angle === 0) {\n            documentDataModel?.updateDocumentDataPageSize(endX - startX);\n            documentDataModel?.updateDocumentDataMargin({ l: paddingData.l, t: paddingData.t });\n            documentSkeleton.calculate();\n            const { actualWidth, actualHeight } = documentSkeleton.getActualSize();\n            // The skeleton obtains the original volume, which needs to be multiplied by the magnification factor.\n            return {\n                actualWidth: actualWidth * scaleX,\n                actualHeight: actualHeight * scaleY,\n            };\n        }\n\n        const maxSize = this._getEditorMaxSize(actualRangeWithCoord, canvasOffset, documentLayoutObject.horizontalAlign);\n        if (!maxSize) return;\n        documentDataModel?.updateDocumentDataPageSize(maxSize.width / scaleX);\n        documentSkeleton.calculate();\n\n        const size = documentSkeleton.getActualSize();\n\n        let editorWidth = endX - startX;\n\n        if (editorWidth < size.actualWidth * scaleX + EDITOR_INPUT_SELF_EXTEND_GAP * scaleX) {\n            editorWidth = size.actualWidth * scaleX + EDITOR_INPUT_SELF_EXTEND_GAP * scaleX;\n        }\n\n        // Scaling is handled by the renderer, so the skeleton only accepts the original width and height, which need to be divided by the magnification factor.\n        documentDataModel?.updateDocumentDataPageSize(editorWidth / scaleX);\n\n        /**\n         * Do not rely on cell layout logic, depend on the document's internal alignment logic.\n         */\n        documentDataModel?.updateDocumentRenderConfig({\n            horizontalAlign: HorizontalAlign.UNSPECIFIED,\n            cellValueType: undefined,\n        });\n\n        return {\n            actualWidth: size.actualWidth * scaleX,\n            actualHeight: size.actualHeight * scaleY,\n        };\n    }\n\n    private _getEditorMaxSize(position: IPosition, canvasOffset: ICanvasOffset, horizontalAlign: HorizontalAlign) {\n        const editorObject = this._getEditorObject();\n        if (editorObject == null) {\n            return;\n        }\n        function pxToNum(width: string): number {\n            return Number.parseInt(width.replace('px', ''));\n        }\n\n        const engine = this._context.engine;\n        const canvasElement = engine.getCanvasElement();\n        const canvasClientRect = canvasElement.getBoundingClientRect();\n\n        // We should take the scale into account when canvas is scaled by CSS.\n        const widthOfCanvas = pxToNum(canvasElement.style.width); // declared width\n        const { width } = canvasClientRect; // real width affected by scale\n        const scaleAdjust = width / widthOfCanvas;\n        const { startX, startY, endX } = position;\n        const enginWidth = this._context.engine.width;\n\n        const clientHeight =\n            document.body.clientHeight -\n            startY -\n            SHEET_FOOTER_BAR_HEIGHT -\n            canvasOffset.top -\n            EDITOR_BORDER_SIZE * 2;\n\n        let clientWidth = width - startX;\n\n        if (horizontalAlign === HorizontalAlign.CENTER) {\n            const rightGap = enginWidth - endX;\n            const leftGap = startX;\n            clientWidth = (endX - startX) + Math.min(leftGap, rightGap) * 2;\n        } else if (horizontalAlign === HorizontalAlign.RIGHT) {\n            clientWidth = endX;\n        }\n\n        return {\n            height: clientHeight,\n            width: clientWidth - EDITOR_BORDER_SIZE,\n            scaleAdjust,\n        };\n    }\n\n    /**\n     * Mainly used to calculate the volume of scenes and objects,\n     * determine whether a scrollbar appears,\n     * and calculate the editor's boundaries relative to the browser.\n     */\n    // eslint-disable-next-line max-lines-per-function\n    private _editAreaProcessing(\n        editorWidth: number,\n        editorHeight: number,\n        actualRangeWithCoord: IPosition,\n        canvasOffset: ICanvasOffset,\n        fill: Nullable<string>,\n        scaleX: number = 1,\n        scaleY: number = 1,\n        horizontalAlign: HorizontalAlign,\n        callback?: () => void\n    ) {\n        const editorObject = this._getEditorObject();\n        if (editorObject == null) {\n            return;\n        }\n\n        const engine = this._context.engine;\n        const canvasElement = engine.getCanvasElement();\n\n        // We should take the scale into account when canvas is scaled by CSS.\n        let { startX, startY } = actualRangeWithCoord;\n\n        const { document: documentComponent, scene: editorScene, engine: docEngine } = editorObject;\n        const viewportMain = editorScene.getViewport(VIEWPORT_KEY.VIEW_MAIN);\n\n        const info = this._getEditorMaxSize(actualRangeWithCoord, canvasOffset, horizontalAlign)!;\n\n        const { height: clientHeight, width: clientWidth, scaleAdjust } = info;\n\n        let physicHeight = editorHeight;\n\n        let scrollBar = viewportMain?.getScrollBar() as Nullable<ScrollBar>;\n\n        if (physicHeight > clientHeight) {\n            if (scrollBar == null) {\n                viewportMain && new ScrollBar(viewportMain, { enableHorizontal: false, barSize: 8 });\n            } else {\n                viewportMain?.resetCanvasSizeAndUpdateScroll();\n            }\n            viewportMain?.scrollToViewportPos({\n                viewportScrollY: physicHeight - clientHeight,\n            });\n\n            physicHeight = clientHeight;\n        } else {\n            scrollBar = null;\n            viewportMain?.getScrollBar()?.dispose();\n        }\n\n        editorWidth += scrollBar?.barSize || 0;\n\n        if (editorWidth > clientWidth) {\n            editorWidth = clientWidth;\n        }\n\n        this._addBackground(editorScene, editorWidth / scaleX, editorHeight / scaleY, fill);\n\n        const { scaleX: precisionScaleX, scaleY: precisionScaleY } = editorScene.getPrecisionScale();\n\n        editorScene.transformByState({\n            width: editorWidth * scaleAdjust / scaleX,\n            height: editorHeight * scaleAdjust / scaleY,\n            scaleX: scaleX * scaleAdjust,\n            scaleY: scaleY * scaleAdjust,\n        });\n\n        documentComponent.resize(editorWidth * scaleAdjust / scaleX, editorHeight * scaleAdjust / scaleY);\n\n        /**\n         * sometimes requestIdleCallback is invalid, so use setTimeout to ensure the successful execution of the resizeBySize method.\n         * resize canvas\n         * When modifying the selection area for a formula, it is necessary to add a setTimeout to ensure successful updating.\n         */\n        setTimeout(() => {\n            docEngine.resizeBySize(\n                fixLineWidthByScale(editorWidth, precisionScaleX),\n                fixLineWidthByScale(physicHeight, precisionScaleY)\n            );\n\n            callback?.();\n        }, 0);\n\n        const contentBoundingRect = this._layoutService.getContentElement().getBoundingClientRect();\n        const canvasBoundingRect = canvasElement.getBoundingClientRect();\n        startX = startX * scaleAdjust + (canvasBoundingRect.left - contentBoundingRect.left);\n        startY = startY * scaleAdjust + (canvasBoundingRect.top - contentBoundingRect.top);\n\n        const cellWidth = actualRangeWithCoord.endX - actualRangeWithCoord.startX;\n        if (horizontalAlign === HorizontalAlign.RIGHT) {\n            startX += (cellWidth - editorWidth) * scaleAdjust;\n        } else if (horizontalAlign === HorizontalAlign.CENTER) {\n            startX += (cellWidth - editorWidth * scaleAdjust) / 2;\n        }\n\n        // Update cell editor container position and size.\n        this._cellEditorManagerService.setState({\n            startX,\n            startY,\n            endX: editorWidth * scaleAdjust + startX,\n            endY: physicHeight * scaleAdjust + startY,\n            show: true,\n        });\n    }\n\n    /**\n     * Since the document does not support cell background color, an additional rect needs to be added.\n     */\n    private _addBackground(scene: Scene, editorWidth: number, editorHeight: number, fill?: Nullable<string>) {\n        const fillRectKey = '_backgroundRectHelperColor_';\n        const rect = scene.getObject(fillRectKey) as Rect;\n\n        if (rect == null && fill == null) {\n            return;\n        }\n\n        if (rect == null) {\n            scene.addObjects(\n                [\n                    new Rect(fillRectKey, {\n                        width: editorWidth,\n                        height: editorHeight,\n                        fill,\n                        evented: false,\n                    }),\n                ],\n                DOCS_COMPONENT_MAIN_LAYER_INDEX\n            );\n        } else if (fill == null) {\n            rect.dispose();\n        } else {\n            rect.setProps({\n                fill,\n            });\n\n            rect.transformByState({\n                width: editorWidth,\n                height: editorHeight,\n            });\n        }\n    }\n\n    resizeCellEditor(callback?: () => void) {\n        const state = this._cellEditorManagerService.getState();\n\n        if (!state) return;\n        if (!this._editorBridgeService.isVisible().visible) return;\n        this._editorBridgeService.refreshEditCellPosition(true);\n        const editCellState = this._editorBridgeService.getEditCellState();\n        if (!editCellState) return;\n\n        const skeleton = this._sheetSkeletonManagerService.getSkeletonParam(editCellState.sheetId)?.skeleton;\n        if (!skeleton) return;\n        const { row, column, scaleX, scaleY, position, canvasOffset, documentLayoutObject } = editCellState;\n        const { horizontalAlign } = documentLayoutObject;\n        const maxSize = this._getEditorMaxSize(position, canvasOffset, horizontalAlign);\n        if (!maxSize) return;\n        const { height: clientHeight, width: clientWidth, scaleAdjust } = maxSize;\n\n        const cell = skeleton.getCellWithCoordByIndex(row, column);\n        const height = Math.min((cell.mergeInfo.endY - cell.mergeInfo.startY) * scaleY, clientHeight) * scaleAdjust;\n        const width = Math.min((cell.mergeInfo.endX - cell.mergeInfo.startX) * scaleX, clientWidth) * scaleAdjust;\n        const currentHeight = state.endY! - state.startY!;\n        const currentWidth = state.endX! - state.startX!;\n\n        if (currentHeight !== height || currentWidth !== width) {\n            this._editorBridgeService.refreshEditCellPosition(true);\n\n            const docSkeleton = this._getEditorSkeleton();\n            if (!docSkeleton) {\n                return;\n            }\n            this.fitTextSize(callback);\n        }\n    }\n\n    private _getEditorObject() {\n        return getEditorObject(this._editorBridgeService.getCurrentEditorId(), this._renderManagerService);\n    }\n\n    private _getEditorSkeleton() {\n        return this._renderManagerService.getRenderById(DOCS_NORMAL_EDITOR_UNIT_ID_KEY)?.with(DocSkeletonManagerService).getSkeleton();\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function isForceString(str: string): boolean {\n    return str.startsWith(\"'\");\n}\n\nexport function extractStringFromForceString(str: string): string {\n    return str.slice(1);\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable antfu/consistent-list-newline */\nimport type { IFunctionService, ISequenceNode, LexerTreeBuilder } from '@univerjs/engine-formula';\nimport { LocaleType, numfmt } from '@univerjs/core';\nimport { matchToken, sequenceNodeType } from '@univerjs/engine-formula';\n\nconst fullWidthToHalfWidthMap: { [key: string]: string } = {\n    '\uFF10': '0', '\uFF11': '1', '\uFF12': '2', '\uFF13': '3', '\uFF14': '4',\n    '\uFF15': '5', '\uFF16': '6', '\uFF17': '7', '\uFF18': '8', '\uFF19': '9',\n    \uFF21: 'A', \uFF22: 'B', \uFF23: 'C', \uFF24: 'D', \uFF25: 'E',\n    \uFF26: 'F', \uFF27: 'G', \uFF28: 'H', \uFF29: 'I', \uFF2A: 'J',\n    \uFF2B: 'K', \uFF2C: 'L', \uFF2D: 'M', \uFF2E: 'N', \uFF2F: 'O',\n    \uFF30: 'P', \uFF31: 'Q', \uFF32: 'R', \uFF33: 'S', \uFF34: 'T',\n    \uFF35: 'U', \uFF36: 'V', \uFF37: 'W', \uFF38: 'X', \uFF39: 'Y',\n    \uFF3A: 'Z', \uFF41: 'a', \uFF42: 'b', \uFF43: 'c', \uFF44: 'd',\n    \uFF45: 'e', \uFF46: 'f', \uFF47: 'g', \uFF48: 'h', \uFF49: 'i',\n    \uFF4A: 'j', \uFF4B: 'k', \uFF4C: 'l', \uFF4D: 'm', \uFF4E: 'n',\n    \uFF4F: 'o', \uFF50: 'p', \uFF51: 'q', \uFF52: 'r', \uFF53: 's',\n    \uFF54: 't', \uFF55: 'u', \uFF56: 'v', \uFF57: 'w', \uFF58: 'x',\n    \uFF59: 'y', \uFF5A: 'z', '\uFF05': '%', '\uFF0D': '-', '\uFF0E': '.',\n    '\uFF1A': ':', '\uFF0F': '/', '\uFF0B': '+', '\uFF20': '@', '\uFF06': '&',\n    '\uFF0A': '*', '\uFF03': '#', '\uFF1D': '=', '\uFF1E': '>', '\uFF1C': '<',\n    '\uFF04': '$', '\uFF02': '\"', '\uFF07': \"'\", '\uFF08': '(', '\uFF09': ')', '\u3000': ' ',\n    '\uFF0C': ',', '\uFF01': '!', '\uFF1F': '?', '\uFF1B': ';', '\uFF3B': '[', '\uFF3D': ']',\n    '\uFF5B': '{', '\uFF5D': '}',\n};\n\n// Boolean conversion\nconst booleanMap: { [key: string]: string } = {\n    true: 'TRUE',\n    false: 'FALSE',\n};\n\n// TODO@Dushusir: add more locales\nexport function isCJKLocale(locale: LocaleType) {\n    return [LocaleType.ZH_CN, LocaleType.ZH_TW].includes(locale);\n}\n\n/**\n * Convert all full-width characters to half-width characters and try to parse them. If the parsing is successful, apply them. If the parsing is not successful, return them to full-width characters.\n *\n * Convert full-width characters to half-width characters\n * 1. Formula\n * 2. Boolean\n * 3. Formatted number\n *\n * Not converted\n * 1. Force string\n * 2. Chinese single and double quotation marks\n * 3. Characters between single and double quotes in formulas\n * 4. Other text that cannot be recognized as formulas, Boolean values, or numbers\n *\n * @param str\n * @param lexerTreeBuilder\n * @returns\n */\nexport function normalizeString(str: string, lexerTreeBuilder: LexerTreeBuilder, currentLocale: LocaleType, functionService: IFunctionService) {\n    let normalStr = str;\n\n    if (isCJKLocale(currentLocale)) {\n        // Check if it is a mandatory string with single quotes\n        if (str.startsWith('\uFF07') || str.startsWith(\"'\")) {\n            return `'${str.slice(1)}`;\n        }\n\n        // Handle quoted parts separately (e.g., sheet names)\n        normalStr = handleQuotedParts(normalStr);\n    }\n\n    // Check if it is a formula\n    if (normalStr.startsWith('=')) {\n        return normalizeFormulaString(str, normalStr, lexerTreeBuilder, functionService);\n    }\n\n    // Check if it is a boolean value\n    const lowerCaseStr = normalStr.toLowerCase();\n    if (booleanMap[lowerCaseStr]) {\n        return booleanMap[lowerCaseStr];\n    }\n\n    // Formatting Numbers\n    const parsedValue = numfmt.parseValue(normalStr);\n\n    return parsedValue == null ? str : normalStr;\n}\n\n// Helper function to handle sheet names with quotes\nfunction handleQuotedParts(str: string): string {\n    const sheetNamePattern = /['\"].*?['\"]/g; // Pattern to match quoted parts (sheet names)\n    const quotedParts: string[] = [];\n    const parts = str.split(sheetNamePattern);\n\n    // Save quoted parts and remove them from the string temporarily\n    str.replace(sheetNamePattern, (match) => {\n        quotedParts.push(match);\n        return ''; // Remove quoted parts for now\n    });\n\n    // Convert all full-width characters to half-width characters in non-quoted parts\n    let normalStr = parts.join('').split('').map(toHalfWidth).join('');\n\n    // Reinserting the quoted parts into the final string\n    quotedParts.forEach((part, idx) => {\n        normalStr = normalStr.slice(0, idx * 2) + part + normalStr.slice((idx + 1) * 2);\n    });\n\n    return normalStr;\n}\n\nfunction normalizeFormulaString(str: string, normalStr: string, lexerTreeBuilder: LexerTreeBuilder, functionService: IFunctionService) {\n    const nodes = lexerTreeBuilder.sequenceNodesBuilder(normalStr);\n\n    if (!nodes) return str;\n\n    let _normalStr = normalStr;\n    let totalOffset = 0; // Cumulative offset\n\n    nodes.forEach((node, index) => {\n        if (typeof node === 'object') {\n            const token = node.token;\n\n            // boolean or function name\n            if (booleanMap[token.toLowerCase()]) {\n                const startIndex = node.startIndex + totalOffset + 1;\n                const endIndex = node.endIndex + totalOffset + 2;\n\n                _normalStr = replaceString(token.toLocaleUpperCase(), _normalStr, startIndex, endIndex);\n            } else if ((node.nodeType === sequenceNodeType.FUNCTION && hasFunctionName(token, functionService, nodes, index)) || node.nodeType === sequenceNodeType.REFERENCE) {\n                const sheetNameIndex = token.indexOf('!');\n\n                if (sheetNameIndex > -1) {\n                    const refBody = token.substring(sheetNameIndex + 1);\n                    const startIndex = node.startIndex + totalOffset + (sheetNameIndex + 1) + 1;\n                    const endIndex = node.endIndex + totalOffset + 2;\n\n                    _normalStr = replaceString(refBody.toLocaleUpperCase(), _normalStr, startIndex, endIndex);\n                } else {\n                    const startIndex = node.startIndex + totalOffset + 1;\n                    const endIndex = node.endIndex + totalOffset + 2;\n\n                    _normalStr = replaceString(token.toLocaleUpperCase(), _normalStr, startIndex, endIndex);\n                }\n            } else if ((token.startsWith('\"') && token.endsWith('\"')) || (token.startsWith(\"'\") && token.endsWith(\"'\"))) {\n                const startIndex = node.startIndex + totalOffset + 2;\n                const endIndex = node.endIndex + totalOffset + 1;\n                _normalStr = replaceString(str.slice(startIndex, endIndex), _normalStr, startIndex, endIndex);\n            } else if (node.nodeType !== sequenceNodeType.ARRAY) {\n                const parsedValue = numfmt.parseValue(token);\n\n                if (parsedValue == null) {\n                    const startIndex = node.startIndex + totalOffset + 1;\n                    const endIndex = node.endIndex + totalOffset + 2;\n                    _normalStr = replaceString(str.slice(startIndex, endIndex), _normalStr, startIndex, endIndex);\n                }\n                // Entering =.07/0.1 in a cell will automatically convert to =0.07/0.1\n                // Entering =1.0+2.00 in a cell will automatically convert to =1+2\n                else if (typeof parsedValue.v === 'number' && (parsedValue.z === undefined || !numfmt.isDate(parsedValue.z))) {\n                    const v = `${parsedValue.v}`;\n                    const startIndex = node.startIndex + totalOffset + 1;\n                    const endIndex = node.endIndex + totalOffset + 2;\n                    const { processedString, offset } = processNumberStringWithSpaces(token, v);\n                    _normalStr = replaceString(processedString, _normalStr, startIndex, endIndex);\n\n                    // Update cumulative offset\n                    totalOffset += offset;\n                }\n            }\n        }\n    });\n\n    return _normalStr;\n}\n\nfunction hasFunctionName(name: string, functionService: IFunctionService, nodes: (string | ISequenceNode)[], index: number) {\n    const functionList = functionService.getDescriptions();\n\n    if (nodes[index + 1] !== matchToken.OPEN_BRACKET) {\n        return false;\n    }\n\n    return functionList.get(removeLeadingAtSymbols(name).toLocaleUpperCase()) !== undefined;\n}\n\nfunction removeLeadingAtSymbols(str: string): string {\n    const regex = /^@+/;\n    return str.replace(regex, '');\n}\n\n// Full-width character conversion function\nfunction toHalfWidth(char: string): string {\n    return fullWidthToHalfWidthMap[char] || char;\n}\n\nfunction replaceString(replacedString: string, normalStr: string, startIndex: number, endIndex: number): string {\n    return normalStr.substring(0, startIndex) + replacedString + normalStr.substring(endIndex);\n}\n\nfunction processNumberStringWithSpaces(token: string, numStr: string): { processedString: string; offset: number } {\n    // Preserve original leading and trailing spaces\n    const leadingSpaces = token.match(/^\\s*/)?.[0] || '';\n    const trailingSpaces = token.match(/\\s*$/)?.[0] || '';\n\n    // Reassemble, keeping the original spaces\n    const processedString = leadingSpaces + numStr + trailingSpaces;\n\n    // Calculating the offset\n    const offset = processedString.length - token.length;\n\n    return { processedString, offset };\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const RANGE_SELECTOR_SYMBOLS = 'range_selector';\n\nexport const isRangeSelector = (unitId: string) => {\n    return unitId.includes(RANGE_SELECTOR_SYMBOLS);\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-lines-per-function */\n\nimport type { DocumentDataModel, ICellData, ICommandInfo, IDisposable, IDocumentBody, IDocumentData, IDocumentStyle, IMutationInfo, IStyleData, Nullable, Styles, Workbook } from '@univerjs/core';\nimport type { IRichTextEditingMutationParams } from '@univerjs/docs';\nimport type { IRenderContext, IRenderModule } from '@univerjs/engine-render';\nimport type { MutationsAffectRange, WorkbookSelectionModel } from '@univerjs/sheets';\n\nimport type { IEditorBridgeServiceVisibleParam } from '../../services/editor-bridge.service';\nimport {\n    CellValueType,\n    DEFAULT_EMPTY_DOCUMENT_VALUE,\n    Direction,\n    Disposable,\n    DisposableCollection,\n    DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,\n    DOCS_NORMAL_EDITOR_UNIT_ID_KEY,\n    EDITOR_ACTIVATED,\n    FOCUSING_EDITOR_BUT_HIDDEN,\n    FOCUSING_EDITOR_INPUT_FORMULA,\n    FOCUSING_EDITOR_STANDALONE,\n    FOCUSING_FX_BAR_EDITOR,\n    generateRandomId,\n    ICommandService,\n    IContextService,\n    Inject,\n    isFormulaString,\n    IUndoRedoService,\n    IUniverInstanceService,\n    LocaleService,\n    toDisposable,\n    Tools,\n    UniverInstanceType,\n    WrapStrategy,\n} from '@univerjs/core';\nimport {\n    DocSelectionManagerService,\n    DocSkeletonManagerService,\n    RichTextEditingMutation,\n} from '@univerjs/docs';\nimport { VIEWPORT_KEY as DOC_VIEWPORT_KEY, DocSelectionRenderService, IEditorService, MoveCursorOperation, MoveSelectionOperation, ReplaceSnapshotCommand } from '@univerjs/docs-ui';\nimport { IFunctionService, LexerTreeBuilder, matchToken } from '@univerjs/engine-formula';\nimport { isTextFormat } from '@univerjs/engine-numfmt';\n\nimport {\n    convertTextRotation,\n    DeviceInputEventType,\n    IRenderManagerService,\n} from '@univerjs/engine-render';\n\nimport { adjustRangeOnMutation, COMMAND_LISTENER_SKELETON_CHANGE, InsertColMutation, InsertRowMutation, MoveColsMutation, MoveRowsMutation, REF_SELECTIONS_ENABLED, RemoveColMutation, RemoveRowMutation, SetRangeValuesCommand, SetSelectionsOperation, SetWorksheetActivateCommand, SetWorksheetActiveOperation, SheetInterceptorService, SheetsSelectionsService } from '@univerjs/sheets';\nimport { KeyCode } from '@univerjs/ui';\nimport { distinctUntilChanged, filter } from 'rxjs';\nimport { getEditorObject } from '../../basics/editor/get-editor-object';\nimport { MoveSelectionCommand, MoveSelectionEnterAndTabCommand } from '../../commands/commands/set-selection.command';\nimport { SetCellEditVisibleArrowOperation, SetCellEditVisibleOperation, SetCellEditVisibleWithF2Operation } from '../../commands/operations/cell-edit.operation';\nimport { ScrollToRangeOperation } from '../../commands/operations/scroll-to-range.operation';\nimport { IEditorBridgeService } from '../../services/editor-bridge.service';\nimport { ICellEditorManagerService } from '../../services/editor/cell-editor-manager.service';\nimport { SheetCellEditorResizeService } from '../../services/editor/cell-editor-resize.service';\nimport { MOVE_SELECTION_KEYCODE_LIST } from '../shortcuts/editor.shortcut';\nimport { extractStringFromForceString, isForceString } from '../utils/cell-tools';\nimport { normalizeString } from '../utils/char-tools';\nimport { isRangeSelector } from './utils/is-range-selector';\n\nconst HIDDEN_EDITOR_POSITION = -1000;\n\nenum CursorChange {\n    InitialState,\n    StartEditor,\n    CursorChange,\n}\n\nexport class EditingRenderController extends Disposable implements IRenderModule {\n    /**\n     * It is used to distinguish whether the user has actively moved the cursor in the editor, mainly through mouse clicks.\n     */\n    private _cursorChange: CursorChange = CursorChange.InitialState;\n\n    /** If the corresponding unit is active and prepared for editing. */\n    private _isUnitEditing = false;\n\n    private _workbookSelections: WorkbookSelectionModel;\n\n    private _d: Nullable<IDisposable>;\n    _cursorTimeout: NodeJS.Timeout;\n\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(SheetsSelectionsService) selectionManagerService: SheetsSelectionsService,\n        @IUndoRedoService private readonly _undoRedoService: IUndoRedoService,\n        @IContextService private readonly _contextService: IContextService,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService,\n        @IEditorBridgeService private readonly _editorBridgeService: IEditorBridgeService,\n        @ICellEditorManagerService private readonly _cellEditorManagerService: ICellEditorManagerService,\n        @Inject(LexerTreeBuilder) private readonly _lexerTreeBuilder: LexerTreeBuilder,\n        @IFunctionService private readonly _functionService: IFunctionService,\n        @Inject(DocSelectionManagerService) private readonly _textSelectionManagerService: DocSelectionManagerService,\n        @ICommandService private readonly _commandService: ICommandService,\n        @Inject(LocaleService) protected readonly _localService: LocaleService,\n        @IEditorService private readonly _editorService: IEditorService,\n        @Inject(SheetCellEditorResizeService) private readonly _sheetCellEditorResizeService: SheetCellEditorResizeService,\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService,\n        @Inject(SheetInterceptorService) private readonly _sheetInterceptorService: SheetInterceptorService\n    ) {\n        super();\n\n        this._workbookSelections = selectionManagerService.getWorkbookSelections(this._context.unitId);\n\n        // EditingRenderController is per unit. It should only handle keyboard events when the unit is\n        // the current of its type.\n        this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) => {\n            if (workbook?.getUnitId() === this._context.unitId) {\n                this._d = this._init();\n            } else {\n                this._disposeCurrent();\n\n                // Force ending editor when he switch to another workbook.\n                if (this._isUnitEditing) {\n                    this._handleEditorInvisible({\n                        visible: false,\n                        eventType: DeviceInputEventType.Keyboard,\n                        keycode: KeyCode.ESC,\n                        unitId: this._context.unitId,\n                    });\n\n                    this._isUnitEditing = false;\n                }\n            }\n        }));\n\n        this._initEditorVisibilityListener();\n    }\n\n    override dispose(): void {\n        super.dispose();\n\n        this._disposeCurrent();\n    }\n\n    private _disposeCurrent(): void {\n        this._d?.dispose();\n        this._d = null;\n    }\n\n    private _init(): IDisposable {\n        const d = new DisposableCollection();\n        this._subscribeToCurrentCell(d);\n        this._initialCursorSync(d);\n        this._listenEditorFocus(d);\n        this._commandExecutedListener(d);\n        this._initSkeletonListener(d);\n\n        // RenderManagerService._disposeItem will calls EditingRenderController.dispose before unitDisposed$.subscribe,so that the timer won't be cleared\n        d.add(() => {\n            clearTimeout(this._cursorTimeout);\n        });\n\n        // FIXME: this problem is the same with slide. Should be fixed when refactoring editor.\n        this._cursorTimeout = setTimeout(() => {\n            this._cursorStateListener(d);\n        }, 1000);\n\n        return d;\n    }\n\n    private _initEditorVisibilityListener(): void {\n        this.disposeWithMe(\n            this._editorBridgeService.visible$\n                .pipe(distinctUntilChanged((prev, curr) => prev.visible === curr.visible))\n                .subscribe((param) => {\n                    if ((param.unitId === DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY || param.unitId === this._context.unitId) && param.visible) {\n                        this._isUnitEditing = true;\n                        this._handleEditorVisible(param);\n                    } else if (this._isUnitEditing) {\n                        this._handleEditorInvisible(param);\n                        this._isUnitEditing = false;\n                    }\n                })\n        );\n    }\n\n    private _listenEditorFocus(d: DisposableCollection) {\n        const renderConfig = this._getEditorObject();\n        if (!renderConfig) return;\n\n        d.add(renderConfig.document.onPointerDown$.subscribeEvent(() => {\n            // fix https://github.com/dream-num/univer/issues/628, need to recalculate the cell editor size after\n            // it acquire focus.\n            if (this._isUnitEditing && this._editorBridgeService.isVisible()) {\n                const param = this._editorBridgeService.getEditCellState();\n                const editorId = this._editorBridgeService.getCurrentEditorId();\n\n                if (!param || !editorId) {\n                    return;\n                }\n\n                this._sheetCellEditorResizeService.fitTextSize();\n            }\n        }));\n    }\n\n    private _initialCursorSync(d: DisposableCollection) {\n        d.add(this._cellEditorManagerService.focus$.pipe(filter((f) => !!f)).subscribe(() => {\n            const currentDoc = this._univerInstanceService.getCurrentUnitForType(UniverInstanceType.UNIVER_DOC);\n            if (!currentDoc) return;\n\n            const docSelectionRenderManager = this._renderManagerService.getRenderById(currentDoc?.getUnitId())?.with(DocSelectionRenderService);\n            if (!docSelectionRenderManager) return;\n\n            docSelectionRenderManager.sync();\n        }));\n    }\n\n    private _initSkeletonListener(d: DisposableCollection) {\n        const commandList = new Set(COMMAND_LISTENER_SKELETON_CHANGE);\n        commandList.delete(SetWorksheetActiveOperation.id);\n\n        d.add(this._commandService.onCommandExecuted((commandInfo) => {\n            if (!commandList.has(commandInfo.id)) {\n                return;\n            }\n            switch (commandInfo.id) {\n                case MoveRowsMutation.id:\n                case MoveColsMutation.id:\n                case RemoveColMutation.id:\n                case RemoveRowMutation.id:\n                case InsertColMutation.id:\n                case InsertRowMutation.id:\n                {\n                    const editLocation = this._editorBridgeService.getEditLocation();\n                    if (!editLocation) break;\n                    const currentRange = {\n                        startRow: editLocation.row,\n                        startColumn: editLocation.column,\n                        endRow: editLocation.row,\n                        endColumn: editLocation.column,\n                    };\n                    const newRange = adjustRangeOnMutation(currentRange, commandInfo as IMutationInfo<MutationsAffectRange>);\n                    if (!newRange) break;\n                    const newRow = newRange.startRow;\n                    const newColumn = newRange.startColumn;\n                    this._editorBridgeService.updateEditLocation(newRow, newColumn);\n                    break;\n                }\n            }\n\n            this._sheetCellEditorResizeService.resizeCellEditor(() => {\n                this._textSelectionManagerService.refreshSelection({\n                    unitId: DOCS_NORMAL_EDITOR_UNIT_ID_KEY,\n                    subUnitId: DOCS_NORMAL_EDITOR_UNIT_ID_KEY,\n                });\n            });\n        }));\n    }\n\n    /**\n     * Should update current editing cell info when selection is changed.\n     * @param d DisposableCollection\n     */\n    private _subscribeToCurrentCell(d: DisposableCollection) {\n        // TODO: After the sheet dispose, recreate the sheet, the first cell edit may be unsuccessful,\n        // it should be the editor initialization late, and we need to pay attention to this problem in the future.\n        d.add(this._editorBridgeService.currentEditCellState$.subscribe((editCellState) => {\n            if (editCellState == null || this._editorBridgeService.isForceKeepVisible()) {\n                return;\n            }\n            const state = this._editorBridgeService.getEditCellState();\n            if (state == null) {\n                return;\n            }\n\n            const { position, documentLayoutObject, scaleX, editorUnitId } = state;\n\n            if (this._contextService.getContextValue(FOCUSING_EDITOR_STANDALONE)) {\n                return;\n            }\n\n            const cellDocument = this._getDocumentDataModel();\n            if (cellDocument == null) return;\n            const { startX, endX } = position;\n            const { textRotation, wrapStrategy, documentModel } = documentLayoutObject;\n            const { vertexAngle: angle } = convertTextRotation(textRotation);\n\n            if (wrapStrategy === WrapStrategy.WRAP && angle === 0) {\n                cellDocument.updateDocumentDataPageSize((endX - startX) / scaleX);\n            }\n\n            this._commandService.syncExecuteCommand(ReplaceSnapshotCommand.id, {\n                unitId: editorUnitId,\n                snapshot: (documentModel!.getSnapshot()),\n            });\n\n            this._contextService.setContextValue(FOCUSING_EDITOR_BUT_HIDDEN, true);\n            this._textSelectionManagerService.replaceDocRanges(\n                [{\n                    startOffset: 0,\n                    endOffset: 0,\n                }],\n                {\n                    unitId: DOCS_NORMAL_EDITOR_UNIT_ID_KEY,\n                    subUnitId: DOCS_NORMAL_EDITOR_UNIT_ID_KEY,\n                }\n            );\n\n            const cellSelectionRenderManager = this._renderManagerService.getRenderById(DOCS_NORMAL_EDITOR_UNIT_ID_KEY)?.with(DocSelectionRenderService);\n            const formulaSelectionRenderManager = this._renderManagerService.getRenderById(DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY)?.with(DocSelectionRenderService);\n            if (cellSelectionRenderManager?.canFocusing || formulaSelectionRenderManager?.canFocusing) {\n                this._univerInstanceService.setCurrentUnitForType(DOCS_NORMAL_EDITOR_UNIT_ID_KEY);\n                cellSelectionRenderManager?.activate(\n                    HIDDEN_EDITOR_POSITION,\n                    HIDDEN_EDITOR_POSITION,\n                    true\n                );\n            }\n        }));\n    }\n\n    /**\n     * Listen to document edits to refresh the size of the sheet editor, not for normal editor.\n     */\n    private _commandExecutedListener(d: DisposableCollection) {\n        d.add(this._commandService.onCommandExecuted((command: ICommandInfo) => {\n            if (command.id === RichTextEditingMutation.id) {\n                const params = command.params as IRichTextEditingMutationParams;\n                const { unitId: commandUnitId } = params;\n\n                // Only when the sheet it attached to is focused. Maybe we should change it to the render unit sys.\n                if (!this._isCurrentSheetFocused() || isRangeSelector(commandUnitId)) {\n                    return;\n                }\n\n                this._editorBridgeService.changeEditorDirty(true);\n\n                if (!this._editorBridgeService.isVisible().visible) {\n                    return;\n                }\n\n                if (commandUnitId === DOCS_NORMAL_EDITOR_UNIT_ID_KEY) {\n                    this._sheetCellEditorResizeService.fitTextSize();\n                }\n            }\n        }));\n\n        const closeEditorOperation = [SetCellEditVisibleArrowOperation.id];\n        d.add(this._commandService.onCommandExecuted((command: ICommandInfo) => {\n            if (closeEditorOperation.includes(command.id)) {\n                const params = command.params as IEditorBridgeServiceVisibleParam & { isShift: boolean };\n                const { keycode, isShift } = params;\n\n                /**\n                 * After the user enters the editor and actively moves the editor selection area with the mouse,\n                 * the up, down, left, and right keys can no longer switch editing cells,\n                 * but move the cursor within the editor instead.\n                 */\n                if (keycode != null &&\n                    (this._cursorChange === CursorChange.CursorChange || this._contextService.getContextValue(FOCUSING_FX_BAR_EDITOR))\n                ) {\n                    this._moveInEditor(keycode, isShift);\n                    return;\n                }\n\n                // TODO@Jocs: After we merging editor related controllers, this seems verbose.\n                // We can directly call SetRangeValues here.\n                this._commandService.syncExecuteCommand(SetCellEditVisibleOperation.id, params);\n            }\n\n            if (command.id === SetCellEditVisibleWithF2Operation.id) {\n                this._cursorChange = CursorChange.CursorChange;\n            }\n        }));\n    }\n\n    // You can double-click on the cell or input content by keyboard to put the cell into the edit state.\n    // eslint-disable-next-line complexity\n    private _handleEditorVisible(param: IEditorBridgeServiceVisibleParam) {\n        const { eventType, keycode } = param;\n        // Change `CursorChange` to changed status, when formula bar clicked.\n        this._cursorChange =\n            (eventType === DeviceInputEventType.PointerDown || eventType === DeviceInputEventType.Dblclick)\n                ? CursorChange.CursorChange\n                : CursorChange.StartEditor;\n\n        const editCellState = this._editorBridgeService.getEditLocation();\n        if (editCellState == null) {\n            return;\n        }\n\n        this._commandService.syncExecuteCommand(ScrollToRangeOperation.id, {\n            range: {\n                startRow: editCellState.row,\n                startColumn: editCellState.column,\n                endRow: editCellState.row,\n                endColumn: editCellState.column,\n            },\n        });\n\n        this._editorBridgeService.refreshEditCellPosition(false);\n        const { unitId, isInArrayFormulaRange = false } = editCellState;\n        const editorObject = this._getEditorObject();\n\n        if (editorObject == null) {\n            return;\n        }\n\n        const { document, scene } = editorObject;\n\n        this._contextService.setContextValue(EDITOR_ACTIVATED, true);\n\n        const documentDataModel = this._getDocumentDataModel();\n        const skeleton = this._getEditorSkeleton(DOCS_NORMAL_EDITOR_UNIT_ID_KEY);\n        if (!skeleton || !documentDataModel) {\n            return;\n        }\n\n        this._sheetCellEditorResizeService.fitTextSize(() => {\n            const viewMain = scene.getViewport(DOC_VIEWPORT_KEY.VIEW_MAIN);\n            viewMain?.scrollToViewportPos({\n                viewportScrollX: Number.POSITIVE_INFINITY,\n                viewportScrollY: Number.POSITIVE_INFINITY,\n            });\n        });\n\n        // f2, continue to edit\n        if (eventType === DeviceInputEventType.Keyboard && keycode === KeyCode.F2) {\n            document.makeDirty();\n            this._textSelectionManagerService.replaceDocRanges([\n                {\n                    startOffset: 0,\n                    endOffset: 0,\n                },\n            ]);\n            const endOffset = (documentDataModel.getBody()?.dataStream.length ?? 2) - 2;\n            this._textSelectionManagerService.replaceDocRanges(\n                [{\n                    startOffset: endOffset,\n                    endOffset,\n                }],\n                {\n                    unitId: DOCS_NORMAL_EDITOR_UNIT_ID_KEY,\n                    subUnitId: DOCS_NORMAL_EDITOR_UNIT_ID_KEY,\n                }\n            );\n        } else if (\n            // clear and edit\n            eventType === DeviceInputEventType.Keyboard ||\n            (eventType === DeviceInputEventType.Dblclick && isInArrayFormulaRange)\n        ) {\n            this._emptyDocumentDataModel(documentDataModel.getSnapshot().documentStyle, !!isInArrayFormulaRange);\n            document.makeDirty();\n\n            // @JOCS, Why calculate here?\n            if (keycode === KeyCode.BACKSPACE || eventType === DeviceInputEventType.Dblclick) {\n                skeleton.calculate();\n                this._editorBridgeService.changeEditorDirty(true);\n            }\n\n            this._textSelectionManagerService.replaceDocRanges(\n                [{\n                    startOffset: 0,\n                    endOffset: 0,\n                }],\n                {\n                    unitId: DOCS_NORMAL_EDITOR_UNIT_ID_KEY,\n                    subUnitId: DOCS_NORMAL_EDITOR_UNIT_ID_KEY,\n                }\n            );\n        } else if (eventType === DeviceInputEventType.Dblclick) {\n            if (this._contextService.getContextValue(FOCUSING_EDITOR_INPUT_FORMULA)) {\n                return;\n            }\n\n            const cursor = documentDataModel.getBody()!.dataStream.length - 2 || 0;\n            this._textSelectionManagerService.replaceDocRanges([\n                {\n                    startOffset: cursor,\n                    endOffset: cursor,\n                },\n            ]);\n        }\n\n        this._renderManagerService.getRenderById(unitId)?.scene.resetCursor();\n    }\n\n    private async _handleEditorInvisible(param: IEditorBridgeServiceVisibleParam) {\n        const editCellState = this._editorBridgeService.getEditCellState();\n        const documentDataModel = this._univerInstanceService.getUnit<DocumentDataModel>(DOCS_NORMAL_EDITOR_UNIT_ID_KEY);\n        const snapshot = Tools.deepClone(documentDataModel?.getSnapshot());\n        let { keycode } = param;\n        this._cursorChange = CursorChange.InitialState;\n\n        this._exitInput(param);\n\n        if (editCellState == null) {\n            return;\n        }\n\n        // If neither the formula bar editor nor the cell editor has been edited,\n        // it is considered that the content has not changed and returns directly.\n        const editorIsDirty = this._editorBridgeService.getEditorDirty();\n        if (editorIsDirty === false) {\n            keycode = KeyCode.ESC;\n        }\n\n        const workbook = this._context.unit;\n        const worksheet = workbook.getActiveSheet();\n        const workbookId = this._context.unitId;\n        const worksheetId = worksheet.getSheetId();\n\n        const { unitId, sheetId } = editCellState;\n        /**\n         * When closing the editor, switch to the current tab of the editor.\n         */\n        if (workbookId === unitId && sheetId !== worksheetId) {\n            // SetWorksheetActivateCommand handler uses Promise\n            await this._commandService.executeCommand(SetWorksheetActivateCommand.id, {\n                subUnitId: sheetId,\n                unitId,\n            });\n        }\n\n        // Reselect the current selections, when exist cell editor by press ESC.I\n        if (keycode === KeyCode.ESC) {\n            if (this._editorBridgeService.isForceKeepVisible()) {\n                this._editorBridgeService.disableForceKeepVisible();\n            }\n            const selections = this._workbookSelections.getCurrentSelections();\n            if (selections) {\n                this._contextService.setContextValue(REF_SELECTIONS_ENABLED, false);\n                this._commandService.syncExecuteCommand(SetSelectionsOperation.id, {\n                    unitId: this._context.unit.getUnitId(),\n                    subUnitId: sheetId,\n                    selections,\n                });\n            }\n\n            return;\n        }\n\n        if (snapshot) {\n            const res = await this._submitCellData(snapshot);\n            // if the submit was rejected, don't move selection\n            if (res === false) {\n                return;\n            }\n        }\n\n        // moveSelection need to put behind of SetRangeValuesCommand, fix https://github.com/dream-num/univer/issues/1155\n        this._moveSelection(keycode);\n    }\n\n    private _getEditorObject() {\n        return getEditorObject(this._editorBridgeService.getCurrentEditorId(), this._renderManagerService);\n    }\n\n    submitCellData(documentDataModel: DocumentDataModel) {\n        return this._submitCellData(documentDataModel.getSnapshot());\n    }\n\n    private async _submitCellData(snapshot: IDocumentData) {\n        const editCellState = this._editorBridgeService.getEditCellState();\n        if (editCellState == null) {\n            return true;\n        }\n\n        const { unitId, sheetId, row, column } = editCellState;\n\n        const workbook = this._context.unit;\n        let worksheet = workbook.getActiveSheet();\n\n        // If the target cell does not exist, there is no need to execute setRangeValue\n        const setRangeValueTargetSheet = workbook.getSheetBySheetId(sheetId);\n        if (!setRangeValueTargetSheet) {\n            return true;\n        }\n\n        worksheet = workbook.getActiveSheet();\n\n        // If cross-sheet operation, switch current sheet first, then const cellData\n        // This should moved to after cell editor\n        const cellData: Nullable<ICellData> = getCellDataByInput(\n            { ...(worksheet.getCellRaw(row, column) || {}) },\n            snapshot,\n            this._lexerTreeBuilder,\n            this._localService,\n            this._functionService,\n            workbook.getStyles()\n        );\n\n        if (!cellData) {\n            return true;\n        }\n\n        const finalCell = this._sheetInterceptorService.onWriteCell(workbook, worksheet, row, column, cellData);\n        if (finalCell === worksheet.getCellRaw(row, column)) {\n            return true;\n        }\n\n        const redoUndoId = generateRandomId(6);\n        const res = this._commandService.syncExecuteCommand(SetRangeValuesCommand.id, {\n            subUnitId: sheetId,\n            unitId,\n            range: {\n                startRow: row,\n                startColumn: column,\n                endRow: row,\n                endColumn: column,\n            },\n            value: cellData,\n            redoUndoId,\n        });\n\n        if (res) {\n            const isValid = await this._sheetInterceptorService.onValidateCell(workbook, worksheet, row, column);\n            if (isValid === false) {\n                this._undoRedoService.rollback(redoUndoId, unitId);\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    private _exitInput(param: IEditorBridgeServiceVisibleParam) {\n        this._contextService.setContextValue(FOCUSING_EDITOR_INPUT_FORMULA, false);\n        this._contextService.setContextValue(EDITOR_ACTIVATED, false);\n        this._contextService.setContextValue(FOCUSING_EDITOR_BUT_HIDDEN, false);\n        this._contextService.setContextValue(FOCUSING_FX_BAR_EDITOR, false);\n        this._cellEditorManagerService.setState({\n            show: param.visible,\n        });\n        const editorObject = this._getEditorObject();\n        editorObject?.scene.getViewport(DOC_VIEWPORT_KEY.VIEW_MAIN)?.scrollToViewportPos({\n            viewportScrollX: 0,\n            viewportScrollY: 0,\n        });\n        const editorUnitId = this._editorBridgeService.getCurrentEditorId();\n        if (editorUnitId == null || !this._editorService.isSheetEditor(editorUnitId)) {\n            return;\n        }\n        this._undoRedoService.clearUndoRedo(editorUnitId);\n        this._undoRedoService.clearUndoRedo(DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY);\n    }\n\n    private _moveSelection(keycode?: KeyCode) {\n        if (keycode == null || !MOVE_SELECTION_KEYCODE_LIST.includes(keycode)) {\n            return;\n        }\n\n        let direction = Direction.LEFT;\n\n        switch (keycode) {\n            case KeyCode.ENTER:\n                direction = Direction.DOWN;\n                break;\n            case KeyCode.TAB:\n                direction = Direction.RIGHT;\n                break;\n            case KeyCode.ARROW_DOWN:\n                direction = Direction.DOWN;\n                break;\n            case KeyCode.ARROW_UP:\n                direction = Direction.UP;\n                break;\n            case KeyCode.ARROW_LEFT:\n                direction = Direction.LEFT;\n                break;\n            case KeyCode.ARROW_RIGHT:\n                direction = Direction.RIGHT;\n                break;\n        }\n\n        if (keycode === KeyCode.ENTER || keycode === KeyCode.TAB) {\n            this._commandService.executeCommand(MoveSelectionEnterAndTabCommand.id, {\n                keycode,\n                direction,\n            });\n        } else {\n            this._commandService.executeCommand(MoveSelectionCommand.id, {\n                direction,\n            });\n        }\n    }\n\n    /**\n     * The user's operations follow the sequence of opening the editor and then moving the cursor.\n     * The logic here predicts the user's first cursor movement behavior based on this rule\n     */\n    private _cursorStateListener(d: DisposableCollection) {\n        const editorObject = this._getEditorObject();\n        if (!editorObject?.document) return;\n        const { document: documentComponent } = editorObject;\n\n        d.add(toDisposable(documentComponent.onPointerDown$.subscribeEvent(() => {\n            if (this._cursorChange === CursorChange.StartEditor) {\n                this._cursorChange = CursorChange.CursorChange;\n            }\n        })));\n    }\n\n    // TODO: @JOCS, is it necessary to move these commands MoveSelectionOperation\\MoveCursorOperation to shortcut? and use multi-commands?\n    private _moveInEditor(keycode: KeyCode, isShift: boolean) {\n        let direction = Direction.LEFT;\n        if (keycode === KeyCode.ARROW_DOWN) {\n            direction = Direction.DOWN;\n        } else if (keycode === KeyCode.ARROW_UP) {\n            direction = Direction.UP;\n        } else if (keycode === KeyCode.ARROW_RIGHT) {\n            direction = Direction.RIGHT;\n        }\n\n        if (isShift) {\n            this._commandService.executeCommand(MoveSelectionOperation.id, {\n                direction,\n            });\n        } else {\n            this._commandService.executeCommand(MoveCursorOperation.id, {\n                direction,\n            });\n        }\n    }\n\n    private _getDocumentDataModel() {\n        return this._univerInstanceService.getUnit<DocumentDataModel>(DOCS_NORMAL_EDITOR_UNIT_ID_KEY, UniverInstanceType.UNIVER_DOC);\n    }\n\n    // WTF: this is should not exist at all. It is because all editor instances reuse the singleton\n    // \"DocSelectionManagerService\" and other modules. Which will be refactored soon in August, 2024.\n    private _isCurrentSheetFocused(): boolean {\n        return this._univerInstanceService.getFocusedUnit()?.getUnitId() === this._context.unitId;\n    }\n\n    private _getEditorSkeleton(editorId: string) {\n        return this._renderManagerService.getRenderById(editorId)?.with(DocSkeletonManagerService).getSkeleton();\n    }\n\n    private _getEditorViewModel(editorId: string) {\n        return this._renderManagerService.getRenderById(editorId)?.with(DocSkeletonManagerService).getViewModel();\n    }\n\n    private _emptyDocumentDataModel(documentStyle: IDocumentStyle, removeStyle: boolean) {\n        const empty = (documentDataModel: DocumentDataModel, resetDocumentStyle?: boolean) => {\n            const snapshot = Tools.deepClone(documentDataModel.getSnapshot());\n            const documentViewModel = this._getEditorViewModel(documentDataModel.getUnitId());\n            if (documentViewModel == null) {\n                return;\n            }\n\n            emptyBody(snapshot.body!, removeStyle);\n            if (resetDocumentStyle) {\n                snapshot.documentStyle = documentStyle;\n            }\n            snapshot.drawings = {};\n            snapshot.drawingsOrder = [];\n            documentDataModel.reset(snapshot);\n            documentViewModel.reset(documentDataModel);\n        };\n\n        const documentDataModel = this._getDocumentDataModel();\n        documentDataModel && empty(documentDataModel, true);\n\n        const formulaDocument = this._univerInstanceService.getUnit<DocumentDataModel>(DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY, UniverInstanceType.UNIVER_DOC);\n        formulaDocument && empty(formulaDocument);\n    }\n}\n\n// eslint-disable-next-line complexity\nexport function getCellDataByInput(\n    cellData: ICellData,\n    snapshot: Nullable<IDocumentData>,\n    lexerTreeBuilder: LexerTreeBuilder,\n    localeService: LocaleService,\n    functionService: IFunctionService,\n    styles: Styles\n) {\n    if (snapshot?.body == null) {\n        return null;\n    }\n    const { body } = snapshot;\n    cellData.t = undefined;\n\n    const data = body.dataStream;\n    const lastString = data.substring(data.length - 2, data.length);\n    let newDataStream = lastString === DEFAULT_EMPTY_DOCUMENT_VALUE ? data.substring(0, data.length - 2) : data;\n\n    const currentLocale = localeService.getCurrentLocale();\n    newDataStream = normalizeString(newDataStream, lexerTreeBuilder, currentLocale, functionService);\n\n    if (snapshot.drawingsOrder?.length) {\n        cellData.v = '';\n        cellData.f = null;\n        cellData.si = null;\n        cellData.p = snapshot;\n        cellData.t = CellValueType.STRING;\n    }\n    // Text format ('@' or '@@@') has the highest priority\n    else if (cellData.s && isTextFormat(styles?.get(cellData.s)?.n?.pattern)) {\n        // If the style is text format ('@'or  '@@@'), the data should be set as a string.\n        cellData.v = newDataStream;\n        cellData.f = null;\n        cellData.si = null;\n        cellData.p = null;\n        cellData.t = CellValueType.STRING;\n\n        // Text format supports rich text\n        if (isRichText(body) && body.dataStream !== '\\r\\n') {\n            cellData.p = snapshot;\n        }\n\n        // If the style length in textRun.ts is equal to the content length, it should be set as the cell style\n        const style = getCellStyleBySnapshot(snapshot);\n        if (style) {\n            cellData.s = style;\n        }\n    } else if (isFormulaString(newDataStream)) {\n        if (cellData.f === newDataStream) {\n            return null;\n        }\n\n        const bracketCount = lexerTreeBuilder.checkIfAddBracket(newDataStream);\n        for (let i = 0; i < bracketCount; i++) {\n            newDataStream += matchToken.CLOSE_BRACKET;\n        }\n\n        cellData.f = newDataStream;\n        cellData.si = null; // Disassociate from the original formula\n        cellData.v = null;\n        cellData.p = null;\n    } else if (isForceString(newDataStream)) {\n        const v = extractStringFromForceString(newDataStream);\n        cellData.v = v;\n        cellData.f = null;\n        cellData.si = null;\n        cellData.p = null;\n        cellData.t = CellValueType.FORCE_STRING;\n    } else if (isRichText(body)) {\n        if (body.dataStream === '\\r\\n') {\n            cellData.v = '';\n            cellData.f = null;\n            cellData.si = null;\n            cellData.p = null;\n        } else {\n            cellData.p = snapshot;\n            cellData.v = null;\n            cellData.f = null;\n            cellData.si = null;\n        }\n    } else {\n        // If the data is empty, the data is set to null.\n        if (newDataStream === '' && cellData.v == null && cellData.p == null) {\n            return null;\n        }\n        cellData.v = newDataStream;\n        cellData.f = null;\n        cellData.si = null;\n        cellData.p = null;\n        // If the style length in textRun.ts is equal to the content length, it should be set as the cell style\n        const style = getCellStyleBySnapshot(snapshot);\n        if (style) {\n            cellData.s = style;\n        }\n    }\n\n    return cellData;\n}\n\nexport function isRichText(body: IDocumentBody): boolean {\n    const { textRuns = [], paragraphs = [], customRanges, customBlocks = [] } = body;\n\n    const bodyNoLineBreak = body.dataStream.replace(/(\\r\\n)+$/, '');\n\n    // Some styles are unique to rich text. When this style appears, we consider the value to be rich text.\n    const richTextStyle = ['va'];\n\n    return (\n        // This is because after editing, an inexplicable second paragraph style will appear \\r\\n\n        textRuns.filter((ts) => ts.st < bodyNoLineBreak.length).some((textRun) => {\n            const hasRichTextStyle = Boolean(textRun.ts && Object.keys(textRun.ts).some((property) => {\n                return richTextStyle.includes(property);\n            }));\n            return hasRichTextStyle || (Object.keys(textRun.ts ?? {}).length && (textRun.ed - textRun.st < bodyNoLineBreak.length));\n        }) ||\n        paragraphs.some((paragraph) => paragraph.bullet) ||\n        paragraphs.length >= 2 ||\n        Boolean(customRanges?.length) ||\n        customBlocks.length > 0\n    );\n}\n\nexport function getCellStyleBySnapshot(snapshot: IDocumentData): Nullable<IStyleData> {\n    const { body } = snapshot;\n    if (!body) return null;\n    const { textRuns = [] } = body;\n\n    let style = {};\n    const bodyNoLineBreak = body.dataStream.replace('\\r\\n', '');\n    textRuns.forEach((textRun) => {\n        const { st, ed, ts } = textRun;\n        if (ed - st >= bodyNoLineBreak.length) {\n            style = { ...style, ...ts };\n        }\n    });\n    if (Object.keys(style).length) {\n        return style;\n    }\n    return null;\n}\n\nfunction emptyBody(body: IDocumentBody, removeStyle = false) {\n    body.dataStream = DEFAULT_EMPTY_DOCUMENT_VALUE;\n\n    if (body.textRuns != null) {\n        if (body.textRuns.length === 1 && !removeStyle) {\n            body.textRuns[0].st = 0;\n            body.textRuns[0].ed = 1;\n        } else {\n            body.textRuns = undefined;\n        }\n    }\n\n    if (body.paragraphs != null) {\n        body.paragraphs = [\n            {\n                startIndex: 0,\n            },\n        ];\n    }\n\n    if (body.sectionBreaks != null) {\n        body.sectionBreaks = undefined;\n    }\n\n    if (body.tables != null) {\n        body.tables = undefined;\n    }\n\n    if (body.customRanges != null) {\n        body.customRanges = undefined;\n    }\n\n    if (body.customBlocks != null) {\n        body.customBlocks = undefined;\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-lines-per-function */\n\nimport type { IAccessor, IBorderData, ICellData, ICustomRange, IDocumentBody, IMutationInfo, IParagraph, IRange, IStyleData, Nullable } from '@univerjs/core';\nimport type {\n    IAddWorksheetMergeMutationParams,\n    IMoveRangeMutationParams,\n    IRemoveWorksheetMergeMutationParams,\n    ISetRangeValuesMutationParams,\n    ISetSelectionsOperationParams,\n} from '@univerjs/sheets';\nimport type { ICellDataWithSpanInfo, ICopyPastePayload, ISheetDiscreteRangeLocation } from '../../services/clipboard/type';\nimport { cellToRange, CustomRangeType, DEFAULT_STYLES, generateRandomId, IUniverInstanceService, numfmt, ObjectMatrix, Range, Rectangle, Tools } from '@univerjs/core';\n\nimport { DEFAULT_PADDING_DATA } from '@univerjs/engine-render';\nimport {\n    AddMergeUndoMutationFactory,\n    AddWorksheetMergeMutation,\n    getAddMergeMutationRangeByType,\n    MoveRangeCommand,\n    MoveRangeMutation,\n    RemoveMergeUndoMutationFactory,\n    RemoveWorksheetMergeMutation,\n    SelectionMoveType,\n    SetRangeValuesMutation,\n    SetRangeValuesUndoMutationFactory,\n    SetSelectionsOperation,\n    SheetInterceptorService,\n} from '@univerjs/sheets';\nimport { COPY_TYPE } from '../../services/clipboard/type';\nimport { isRichText } from '../editor/editing.render-controller';\nimport { discreteRangeToRange, type IDiscreteRange, virtualizeDiscreteRanges } from '../utils/range-tools';\n\n// if special paste need append mutations instead of replace the default, it can use this function to generate default mutations.\n/**\n *\n * @param pasteFrom\n * @param pasteTo\n * @param data\n * @param payload\n * @param accessor\n */\nexport function getDefaultOnPasteCellMutations(\n    pasteFrom: ISheetDiscreteRangeLocation,\n    pasteTo: ISheetDiscreteRangeLocation,\n    data: ObjectMatrix<ICellDataWithSpanInfo>,\n    payload: ICopyPastePayload,\n    accessor: IAccessor\n) {\n    const redoMutationsInfo: IMutationInfo[] = [];\n    const undoMutationsInfo: IMutationInfo[] = [];\n    if (payload.copyType === COPY_TYPE.CUT) {\n        const { undos, redos } = getMoveRangeMutations(pasteFrom, pasteTo, accessor);\n        redoMutationsInfo.push(...redos);\n        undoMutationsInfo.push(...undos);\n    } else {\n        // clear style\n        const { undos: clearStyleUndos, redos: clearStyleRedos } = getClearCellStyleMutations(pasteTo, data, accessor);\n        redoMutationsInfo.push(...clearStyleRedos);\n        undoMutationsInfo.push(...clearStyleUndos);\n\n        // clear value\n        const { undos: clearValueUndos, redos: clearValueRedos } = getClearCellValueMutations(pasteTo, data, accessor);\n        redoMutationsInfo.push(...clearValueRedos);\n        undoMutationsInfo.push(...clearValueUndos);\n\n        // set values\n        const { undos: setValuesUndos, redos: setValuesRedos } = getSetCellValueMutations(pasteTo, pasteFrom, data, accessor);\n        redoMutationsInfo.push(...setValuesRedos);\n        undoMutationsInfo.push(...setValuesUndos);\n\n        // set styles\n        const { undos: setStyleUndos, redos: setStyleRedos } = getSetCellStyleMutations(pasteTo, data, accessor, true);\n        redoMutationsInfo.push(...setStyleRedos);\n        undoMutationsInfo.push(...setStyleUndos);\n\n        // Do not process the custom attribute here, users can extend the paste event by themselves\n\n        // clear and add merge\n        const { undos: clearMergeUndos, redos: clearMergeRedos } = getClearAndSetMergeMutations(\n            pasteTo,\n            data,\n            accessor\n        );\n        redoMutationsInfo.push(...clearMergeRedos);\n        undoMutationsInfo.push(...clearMergeUndos);\n    }\n    return {\n        undos: undoMutationsInfo,\n        redos: redoMutationsInfo,\n    };\n}\n\n/**\n *\n * @param from\n * @param from.unitId\n * @param from.subUnitId\n * @param from.range\n * @param to\n * @param to.unitId\n * @param to.subUnitId\n * @param to.range\n * @param accessor\n */\nexport function getMoveRangeMutations(\n    from: {\n        unitId: string;\n        subUnitId: string;\n        range?: IDiscreteRange;\n    },\n    to: {\n        unitId: string;\n        subUnitId: string;\n        range?: IDiscreteRange;\n    },\n    accessor: IAccessor\n) {\n    let redos: IMutationInfo[] = [];\n    let undos: IMutationInfo[] = [];\n    const { range: fromDiscreteRange, subUnitId: fromSubUnitId, unitId } = from;\n    const { range: toDiscreteRange, subUnitId: toSubUnitId } = to;\n    const toRange = toDiscreteRange ? discreteRangeToRange(toDiscreteRange) : null;\n    const fromRange = fromDiscreteRange ? discreteRangeToRange(fromDiscreteRange) : null;\n\n    if (fromRange && toRange) {\n        const univerInstanceService = accessor.get(IUniverInstanceService);\n        const sheetInterceptorService = accessor.get(SheetInterceptorService);\n        const workbook = univerInstanceService.getUniverSheetInstance(unitId);\n        const fromWorksheet = workbook?.getSheetBySheetId(fromSubUnitId);\n        const toWorksheet = workbook?.getSheetBySheetId(toSubUnitId);\n        if (fromWorksheet && toWorksheet) {\n            const fromCellValue = new ObjectMatrix<Nullable<ICellData>>();\n            const newFromCellValue = new ObjectMatrix<Nullable<ICellData>>();\n            const fromCellMatrix = fromWorksheet.getCellMatrix();\n            const toCellMatrix = toWorksheet.getCellMatrix();\n\n            Range.foreach(fromRange, (row, col) => {\n                fromCellValue.setValue(row, col, Tools.deepClone(fromCellMatrix.getValue(row, col)));\n                newFromCellValue.setValue(row, col, null);\n            });\n            const toCellValue = new ObjectMatrix<Nullable<ICellData>>();\n\n            Range.foreach(toRange, (row, col) => {\n                toCellValue.setValue(row, col, Tools.deepClone(toCellMatrix.getValue(row, col)));\n            });\n\n            const newToCellValue = new ObjectMatrix<Nullable<ICellData>>();\n\n            Range.foreach(fromRange, (row, col) => {\n                const cellRange = cellToRange(row, col);\n                const relativeRange = Rectangle.getRelativeRange(cellRange, fromRange);\n                const range = Rectangle.getPositionRange(relativeRange, toRange);\n                newToCellValue.setValue(range.startRow, range.startColumn, fromCellMatrix.getValue(row, col));\n            });\n\n            const doMoveRangeMutation: IMoveRangeMutationParams = {\n                fromRange,\n                toRange,\n                from: {\n                    value: newFromCellValue.getMatrix(),\n                    subUnitId: fromSubUnitId,\n                },\n                to: {\n                    value: newToCellValue.getMatrix(),\n                    subUnitId: toSubUnitId,\n                },\n                unitId,\n            };\n            const undoMoveRangeMutation: IMoveRangeMutationParams = {\n                fromRange: toRange,\n                toRange: fromRange,\n                from: {\n                    value: fromCellValue.getMatrix(),\n                    subUnitId: fromSubUnitId,\n                },\n                to: {\n                    value: toCellValue.getMatrix(),\n                    subUnitId: toSubUnitId,\n                },\n                unitId,\n            };\n            const interceptorCommands = sheetInterceptorService.onCommandExecute({\n                id: MoveRangeCommand.id,\n                params: { toRange, fromRange },\n            });\n\n            // handle merge mutations\n            const fromMergeData = fromWorksheet.getMergeData();\n            const toMergeData = toWorksheet.getMergeData();\n            const fromMergeRanges = fromMergeData.filter((item) => Rectangle.intersects(item, fromRange));\n            const toMergeRanges = toMergeData.filter((item) => Rectangle.intersects(item, toRange));\n\n            const willMoveToMergeRanges = fromMergeRanges\n                .map((mergeRange) => Rectangle.getRelativeRange(mergeRange, fromRange))\n                .map((relativeRange) => Rectangle.getPositionRange(relativeRange, toRange));\n\n            const addMergeCellRanges = getAddMergeMutationRangeByType(willMoveToMergeRanges);\n\n            const mergeRedos: Array<{\n                id: string;\n                params: IAddWorksheetMergeMutationParams | IRemoveWorksheetMergeMutationParams;\n            }> = [\n                {\n                    id: RemoveWorksheetMergeMutation.id,\n                    params: {\n                        unitId,\n                        subUnitId: fromSubUnitId,\n                        ranges: fromMergeRanges,\n                    },\n                },\n                {\n                    id: RemoveWorksheetMergeMutation.id,\n                    params: {\n                        unitId,\n                        subUnitId: fromSubUnitId,\n                        ranges: toMergeRanges,\n                    },\n                },\n                {\n                    id: AddWorksheetMergeMutation.id,\n                    params: {\n                        unitId,\n                        subUnitId: toSubUnitId,\n                        ranges: addMergeCellRanges,\n                    },\n                },\n            ];\n            const mergeUndos: Array<{\n                id: string;\n                params: IAddWorksheetMergeMutationParams | IRemoveWorksheetMergeMutationParams;\n            }> = [\n                {\n                    id: RemoveWorksheetMergeMutation.id,\n                    params: {\n                        unitId,\n                        subUnitId: toSubUnitId,\n                        ranges: addMergeCellRanges,\n                    },\n                },\n                {\n                    id: AddWorksheetMergeMutation.id,\n                    params: {\n                        unitId,\n                        subUnitId: toSubUnitId,\n                        ranges: toMergeRanges,\n                    },\n                },\n                {\n                    id: AddWorksheetMergeMutation.id,\n                    params: {\n                        unitId,\n                        subUnitId: fromSubUnitId,\n                        ranges: fromMergeRanges,\n                    },\n                },\n            ];\n            // +++++++++++++++++++++\n\n            redos = [\n                { id: MoveRangeMutation.id, params: doMoveRangeMutation },\n                ...interceptorCommands.redos,\n                ...mergeRedos,\n                {\n                    id: SetSelectionsOperation.id,\n                    params: {\n                        unitId,\n                        subUnitId: toSubUnitId,\n                        selections: [{ range: toRange }],\n                        type: SelectionMoveType.MOVE_END,\n                    } as ISetSelectionsOperationParams,\n                },\n            ];\n            undos = [\n                { id: MoveRangeMutation.id, params: undoMoveRangeMutation },\n                ...interceptorCommands.undos,\n                ...mergeUndos,\n                {\n                    id: SetSelectionsOperation.id,\n                    params: {\n                        unitId,\n                        subUnitId: fromSubUnitId,\n                        type: SelectionMoveType.MOVE_END,\n                        selections: [{ range: fromRange }],\n                    },\n                },\n            ];\n        }\n    }\n\n    return {\n        undos,\n        redos,\n    };\n}\n\n/**\n *\n * @param pasteTo\n * @param pasteFrom\n * @param matrix\n * @param accessor\n */\nexport function getSetCellValueMutations(\n    pasteTo: ISheetDiscreteRangeLocation,\n    pasteFrom: Nullable<ISheetDiscreteRangeLocation>,\n    matrix: ObjectMatrix<ICellDataWithSpanInfo>,\n    accessor: IAccessor\n) {\n    const { unitId, subUnitId, range } = pasteTo;\n    const redoMutationsInfo: IMutationInfo[] = [];\n    const undoMutationsInfo: IMutationInfo[] = [];\n    const { mapFunc } = virtualizeDiscreteRanges([range]);\n    const valueMatrix = new ObjectMatrix<ICellData>();\n\n    matrix.forValue((row, col, value) => {\n        let originNumberValue;\n        if (!value.p && value.v && !pasteFrom) {\n            const content = String(value.v);\n            const numfmtValue = numfmt.parseValue(content);\n            if (numfmtValue?.v !== undefined && typeof numfmtValue.v === 'number') {\n                originNumberValue = numfmtValue.v;\n            }\n        }\n        const { row: realRow, col: realCol } = mapFunc(row, col);\n\n        if (value.p?.body && isRichText(value.p.body)) {\n            const newValue = Tools.deepClone({ p: value.p, v: originNumberValue ?? value.v });\n            valueMatrix.setValue(realRow, realCol, newValue);\n        } else {\n            valueMatrix.setValue(realRow, realCol, Tools.deepClone({ v: originNumberValue ?? value.v, t: value.t }));\n        }\n    });\n    // set cell value and style\n    const setValuesMutation: ISetRangeValuesMutationParams = {\n        unitId,\n        subUnitId,\n        cellValue: Tools.deepClone(valueMatrix.getMatrix()),\n    };\n\n    redoMutationsInfo.push({\n        id: SetRangeValuesMutation.id,\n        params: setValuesMutation,\n    });\n\n    // undo\n    const undoSetValuesMutation: ISetRangeValuesMutationParams = SetRangeValuesUndoMutationFactory(\n        accessor,\n        setValuesMutation\n    );\n\n    undoMutationsInfo.push({\n        id: SetRangeValuesMutation.id,\n        params: undoSetValuesMutation,\n    });\n    return {\n        undos: undoMutationsInfo,\n        redos: redoMutationsInfo,\n    };\n}\n\n/**\n *\n * @param pasteTo\n * @param matrix\n * @param accessor\n * @param withRichFormat\n */\nexport function getSetCellStyleMutations(\n    pasteTo: ISheetDiscreteRangeLocation,\n    matrix: ObjectMatrix<ICellDataWithSpanInfo>,\n    accessor: IAccessor,\n    withRichFormat = false\n) {\n    const redoMutationsInfo: IMutationInfo[] = [];\n    const undoMutationsInfo: IMutationInfo[] = [];\n    const { unitId, subUnitId, range } = pasteTo;\n    const valueMatrix = new ObjectMatrix<ICellData>();\n\n    const { mapFunc } = virtualizeDiscreteRanges([range]);\n\n    matrix.forValue((row, col, value) => {\n        const newValue: ICellData = {\n            s: Object.assign({}, {\n                ...DEFAULT_STYLES,\n                pd: DEFAULT_PADDING_DATA,\n                bg: null,\n                cl: null,\n            }, value.s),\n        };\n\n        // Here I don't know why when setting the border, an empty object is also assigned to the adjacent cells without borders.\n        // This is the fundamental cause of the problem. This should be unreasonable, so I bypassed this problem first.\n        const cellBd = (newValue.s as IStyleData).bd as IBorderData;\n        if (cellBd) {\n            const isValid = Object.keys(cellBd).length > 0;\n            if (!isValid) {\n                (newValue.s as IStyleData)!.bd = {\n                    b: null,\n                    l: null,\n                    r: null,\n                    t: null,\n                };\n            }\n        }\n\n        const content = String(value.v);\n        const numfmtValue = numfmt.parseValue(content);\n        if (numfmtValue?.z) {\n            if (!newValue.s) {\n                newValue.s = {};\n            }\n            if (typeof newValue.s === 'object') {\n                if (!newValue.s?.n) {\n                    newValue.s.n = { pattern: numfmtValue.z };\n                } else {\n                    newValue.s.n.pattern = numfmtValue.z;\n                }\n            }\n        }\n        const { row: actualRow, col: actualCol } = mapFunc(row, col);\n        valueMatrix.setValue(actualRow, actualCol, newValue);\n    });\n    // set cell style\n    const setValuesMutation: ISetRangeValuesMutationParams = {\n        unitId,\n        subUnitId,\n        cellValue: Tools.deepClone(valueMatrix.getMatrix()),\n    };\n\n    redoMutationsInfo.push({\n        id: SetRangeValuesMutation.id,\n        params: setValuesMutation,\n    });\n\n    // undo\n    const undoSetValuesMutation: ISetRangeValuesMutationParams = SetRangeValuesUndoMutationFactory(\n        accessor,\n        setValuesMutation\n    );\n\n    undoMutationsInfo.push({\n        id: SetRangeValuesMutation.id,\n        params: undoSetValuesMutation,\n    });\n    return {\n        undos: undoMutationsInfo,\n        redos: redoMutationsInfo,\n    };\n}\n\n/**\n *\n * @param pasteTo\n * @param matrix\n * @param accessor\n */\nexport function getClearCellStyleMutations(\n    pasteTo: ISheetDiscreteRangeLocation,\n    matrix: ObjectMatrix<ICellDataWithSpanInfo>,\n    accessor: IAccessor\n) {\n    const redoMutationsInfo: IMutationInfo[] = [];\n    const undoMutationsInfo: IMutationInfo[] = [];\n    const clearStyleMatrix = new ObjectMatrix<ICellData>();\n    const { unitId, subUnitId, range } = pasteTo;\n    const { mapFunc } = virtualizeDiscreteRanges([range]);\n\n    matrix.forEach((rowIndex, row) => {\n        Object.keys(row).forEach((colIndexStr) => {\n            const colIndex = Number(colIndexStr);\n            const { row: actualRow, col: actualCol } = mapFunc(rowIndex, colIndex);\n            clearStyleMatrix.setValue(actualRow, actualCol, { s: null });\n        });\n    });\n    // clear style\n    if (clearStyleMatrix.getLength() > 0) {\n        const clearMutation: ISetRangeValuesMutationParams = {\n            subUnitId,\n            unitId,\n            cellValue: Tools.deepClone(clearStyleMatrix.getMatrix()),\n        };\n        redoMutationsInfo.push({\n            id: SetRangeValuesMutation.id,\n            params: clearMutation,\n        });\n\n        // undo\n        const undoClearMutation: ISetRangeValuesMutationParams = SetRangeValuesUndoMutationFactory(\n            accessor,\n            clearMutation\n        );\n\n        undoMutationsInfo.push({\n            id: SetRangeValuesMutation.id,\n            params: undoClearMutation,\n        });\n    }\n\n    return { undos: undoMutationsInfo, redos: redoMutationsInfo };\n}\n\n/**\n *\n * @param pasteTo\n * @param matrix\n * @param accessor\n */\nexport function getClearCellValueMutations(\n    pasteTo: ISheetDiscreteRangeLocation,\n    matrix: ObjectMatrix<ICellDataWithSpanInfo>,\n    accessor: IAccessor\n) {\n    const redoMutationsInfo: IMutationInfo[] = [];\n    const undoMutationsInfo: IMutationInfo[] = [];\n    const clearValueMatrix = new ObjectMatrix<ICellData>();\n    const { unitId, subUnitId, range } = pasteTo;\n    const { mapFunc } = virtualizeDiscreteRanges([range]);\n\n    matrix.forValue((row, col, _value) => {\n        const { row: actualRow, col: actualCol } = mapFunc(row, col);\n        clearValueMatrix.setValue(actualRow, actualCol, { v: null, p: null });\n    });\n    if (clearValueMatrix.getLength() > 0) {\n        const clearMutation: ISetRangeValuesMutationParams = {\n            subUnitId,\n            unitId,\n            cellValue: Tools.deepClone(clearValueMatrix.getMatrix()),\n        };\n        redoMutationsInfo.push({\n            id: SetRangeValuesMutation.id,\n            params: clearMutation,\n        });\n\n        // undo\n        const undoClearMutation: ISetRangeValuesMutationParams = SetRangeValuesUndoMutationFactory(\n            accessor,\n            clearMutation\n        );\n\n        undoMutationsInfo.push({\n            id: SetRangeValuesMutation.id,\n            params: undoClearMutation,\n        });\n    }\n\n    return { undos: undoMutationsInfo, redos: redoMutationsInfo };\n}\n\n/**\n *\n * @param pasteTo\n * @param matrix\n * @param accessor\n */\nexport function getClearAndSetMergeMutations(\n    pasteTo: ISheetDiscreteRangeLocation,\n    matrix: ObjectMatrix<ICellDataWithSpanInfo>,\n    accessor: IAccessor\n) {\n    const redoMutationsInfo: IMutationInfo[] = [];\n    const undoMutationsInfo: IMutationInfo[] = [];\n    const { unitId, subUnitId, range } = pasteTo;\n    const { startColumn, startRow, endColumn, endRow } = discreteRangeToRange(range);\n    const hasMerge = false;\n    const mergeRangeData: IRange[] = [];\n\n    matrix.forValue((row, col, value) => {\n        if (value.rowSpan && value.rowSpan > 1) {\n            const colSpan = value.colSpan || 1;\n            const mergeRange = {\n                startRow: startRow + row,\n                endRow: startRow + row + value.rowSpan - 1,\n                startColumn: startColumn + col,\n                endColumn: startColumn + col + colSpan - 1,\n            };\n            mergeRangeData.push(mergeRange);\n        } else if (value.colSpan && value.colSpan > 1) {\n            const rowSpan = value.rowSpan || 1;\n            const mergeRange = {\n                startRow: startRow + row,\n                endRow: startRow + row + rowSpan - 1,\n                startColumn: startColumn + col,\n                endColumn: startColumn + col + value.colSpan - 1,\n            };\n            mergeRangeData.push(mergeRange);\n        }\n    });\n\n    // clear merge\n    // remove current range's all merged Cell\n    // get all merged cells\n    const currentService = accessor.get(IUniverInstanceService) as IUniverInstanceService;\n    const workbook = currentService.getUniverSheetInstance(unitId);\n    const worksheet = workbook?.getSheetBySheetId(subUnitId);\n    if (workbook && worksheet) {\n        const mergeData = worksheet.getMergeData();\n        const mergedCellsInRange = mergeData.filter((rect) =>\n            Rectangle.intersects({ startRow, startColumn, endRow, endColumn }, rect)\n        );\n\n        const removeMergeMutationParams: IRemoveWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges: mergedCellsInRange,\n        };\n        redoMutationsInfo.push({\n            id: RemoveWorksheetMergeMutation.id,\n            params: removeMergeMutationParams,\n        });\n\n        const undoRemoveMergeMutationParams: IAddWorksheetMergeMutationParams = RemoveMergeUndoMutationFactory(\n            accessor,\n            removeMergeMutationParams\n        );\n\n        undoMutationsInfo.push({\n            id: AddWorksheetMergeMutation.id,\n            params: undoRemoveMergeMutationParams,\n        });\n    }\n\n    // set merged cell info\n    const addMergeMutationParams: IAddWorksheetMergeMutationParams = {\n        unitId,\n        subUnitId,\n        ranges: mergeRangeData,\n    };\n    if (mergeRangeData.length > 0) {\n        redoMutationsInfo.push({\n            id: AddWorksheetMergeMutation.id,\n            params: addMergeMutationParams,\n        });\n    }\n\n    // undo\n    const undoAddMergeMutation: IRemoveWorksheetMergeMutationParams = AddMergeUndoMutationFactory(\n        accessor,\n        addMergeMutationParams\n    );\n\n    if (mergeRangeData.length > 0) {\n        undoMutationsInfo.push({\n            id: RemoveWorksheetMergeMutation.id,\n            params: undoAddMergeMutation,\n        });\n    }\n\n    return { undos: undoMutationsInfo, redos: redoMutationsInfo };\n}\n\n/**\n *\n * @param text\n */\nexport function generateBody(text: string): IDocumentBody {\n    if (!text.includes('\\r') && Tools.isLegalUrl(text)) {\n        const id = generateRandomId();\n        const urlText = `${text}`;\n        const range: ICustomRange = {\n            startIndex: 0,\n            endIndex: urlText.length - 1,\n            rangeId: id,\n            rangeType: CustomRangeType.HYPERLINK,\n            properties: {\n                url: text,\n            },\n        };\n\n        return {\n            dataStream: `${urlText}\\r\\n`,\n            paragraphs: [{\n                startIndex: urlText.length,\n            }],\n            customRanges: [range],\n        };\n    }\n\n    // Convert all \\n to \\r, because we use \\r to indicate paragraph break.\n    let dataStream = text.replace(/(\\r\\n|\\n)/g, '\\r');\n    if (!dataStream.endsWith('\\r\\n')) {\n        dataStream += '\\r\\n';\n    }\n    const paragraphs: IParagraph[] = [];\n\n    for (let i = 0; i < dataStream.length; i++) {\n        if (dataStream[i] === '\\r') {\n            paragraphs.push({ startIndex: i });\n        }\n    }\n\n    return {\n        dataStream,\n        paragraphs,\n        sectionBreaks: [{ startIndex: dataStream.indexOf('\\n') }],\n    };\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type {\n    ICellData,\n    ICommandInfo,\n    IDocumentData,\n    IMutationInfo,\n    IObjectArrayPrimitiveType,\n    IObjectMatrixPrimitiveType,\n    IRange,\n    IRowData,\n    Nullable,\n    Workbook,\n    Worksheet,\n} from '@univerjs/core';\nimport type {\n    IInsertColMutationParams,\n    IInsertRowMutationParams,\n    ISetRangeValuesMutationParams,\n    ISetWorksheetColWidthMutationParams,\n    ISetWorksheetRowHeightMutationParams,\n} from '@univerjs/sheets';\nimport type {\n    ICellDataWithSpanInfo,\n    IClipboardPropertyItem,\n    ICopyPastePayload,\n    ISheetClipboardHook,\n    ISheetDiscreteRangeLocation,\n} from '../../services/clipboard/type';\nimport type { IScrollStateWithSearchParam } from '../../services/scroll-manager.service';\n\nimport type { IUniverSheetsUIConfig } from '../config.schema';\n\nimport {\n    BooleanNumber,\n    convertBodyToHtml,\n    DEFAULT_WORKSHEET_COLUMN_WIDTH,\n    DEFAULT_WORKSHEET_COLUMN_WIDTH_KEY,\n    DEFAULT_WORKSHEET_ROW_HEIGHT,\n    DOCS_NORMAL_EDITOR_UNIT_ID_KEY,\n    extractPureTextFromCell,\n    handleStyleToString,\n    ICommandService,\n    IConfigService,\n    IContextService,\n    Inject,\n    Injector,\n    isFormulaString,\n    IUniverInstanceService,\n    LocaleService,\n    ObjectMatrix,\n    RxDisposable,\n    Tools,\n    UniverInstanceType,\n} from '@univerjs/core';\n\nimport { MessageType } from '@univerjs/design';\nimport { DocSelectionRenderService } from '@univerjs/docs-ui';\n\nimport { IRenderManagerService, withCurrentTypeOfRenderer } from '@univerjs/engine-render';\nimport {\n    InsertColMutation,\n    InsertRowMutation,\n    MAX_CELL_PER_SHEET_KEY,\n    MoveColsMutation,\n    MoveRangeMutation,\n    MoveRowsMutation,\n    RemoveColMutation,\n    RemoveRowMutation,\n    SetRangeValuesMutation,\n    SetRangeValuesUndoMutationFactory,\n    SetWorksheetColWidthMutation,\n    SetWorksheetRowHeightMutation,\n} from '@univerjs/sheets';\nimport { BuiltInUIPart, connectInjector, IMessageService, IUIPartsService } from '@univerjs/ui';\nimport { Subject, takeUntil } from 'rxjs';\nimport { AddWorksheetMergeCommand } from '../../commands/commands/add-worksheet-merge.command';\nimport {\n    SheetCopyCommand,\n    SheetCutCommand,\n    SheetOptionalPasteCommand,\n    SheetPasteBesidesBorderCommand,\n    SheetPasteColWidthCommand,\n    SheetPasteCommand,\n    SheetPasteFormatCommand,\n    SheetPasteShortKeyCommand,\n    SheetPasteValueCommand,\n} from '../../commands/commands/clipboard.command';\nimport { SetScrollOperation } from '../../commands/operations/scroll.operation';\nimport { ISheetClipboardService, PREDEFINED_HOOK_NAME } from '../../services/clipboard/clipboard.service';\nimport { SheetSkeletonManagerService } from '../../services/sheet-skeleton-manager.service';\nimport { ClipboardPopupMenu } from '../../views/clipboard/ClipboardPopupMenu';\nimport { SHEETS_UI_PLUGIN_CONFIG_KEY } from '../config.schema';\nimport { whenSheetEditorFocused } from '../shortcuts/utils';\nimport { RemovePasteMenuCommands } from './const';\nimport {\n    generateBody,\n    getClearAndSetMergeMutations,\n    getClearCellStyleMutations,\n    getDefaultOnPasteCellMutations,\n    getSetCellStyleMutations,\n    getSetCellValueMutations,\n} from './utils';\n\n/**\n * This controller add basic clipboard logic for basic features such as text color / BISU / row widths to the clipboard\n * service. You can create a similar clipboard controller to add logic for your own features.\n */\n\nconst shouldRemoveShapeIds = [\n    InsertColMutation.id,\n    InsertRowMutation.id,\n    RemoveColMutation.id,\n    RemoveRowMutation.id,\n    MoveRangeMutation.id,\n    MoveRowsMutation.id,\n    MoveColsMutation.id,\n];\n\nexport class SheetClipboardController extends RxDisposable {\n    private _refreshOptionalPaste$ = new Subject();\n    refreshOptionalPaste$ = this._refreshOptionalPaste$.asObservable();\n\n    constructor(\n        @Inject(Injector) private readonly _injector: Injector,\n        @IUniverInstanceService private readonly _instanceService: IUniverInstanceService,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService,\n        @ICommandService private readonly _commandService: ICommandService,\n        @IContextService private readonly _contextService: IContextService,\n        @IConfigService private readonly _configService: IConfigService,\n        @ISheetClipboardService private readonly _sheetClipboardService: ISheetClipboardService,\n        @IMessageService private readonly _messageService: IMessageService,\n        @Inject(LocaleService) private readonly _localService: LocaleService,\n        @IUIPartsService protected readonly _uiPartsService: IUIPartsService\n    ) {\n        super();\n        this._init();\n        this._initCommandListener();\n        this._initUIComponents();\n        this._pasteWithDoc();\n    }\n\n    refreshOptionalPaste() {\n        this._refreshOptionalPaste$.next(Math.random());\n    }\n\n    private _pasteWithDoc() {\n        const sheetPasteShortKeyFn = (docSelectionRenderService: DocSelectionRenderService) => {\n            docSelectionRenderService.onPaste$.pipe(takeUntil(this.dispose$)).subscribe((config) => {\n                if (!whenSheetEditorFocused(this._contextService)) {\n                    return;\n                }\n\n                // editor's value should not change and avoid triggering input event\n                config!.event.preventDefault();\n\n                const clipboardEvent = config!.event as ClipboardEvent;\n                const htmlContent = clipboardEvent.clipboardData?.getData('text/html');\n                const textContent = clipboardEvent.clipboardData?.getData('text/plain');\n                const files = this._resolveClipboardFiles(clipboardEvent.clipboardData);\n\n                this._commandService.executeCommand(SheetPasteShortKeyCommand.id, { htmlContent, textContent, files });\n            });\n        };\n\n        // docSelectionRenderService would init before clipboardService controller when creating a univer.\n        // But when creating a sheet unit again after the previous sheet unit has been disposed, clipboard controller would init before docSelectionRenderService.\n        // In this case, DocSelectionRenderService isn't ready when clipboardService controller init.\n        // So better listening to the created$ event of the renderManagerService to get the DocSelectionRenderService instance.\n        let docSelectionRenderService = this._renderManagerService.getRenderById(DOCS_NORMAL_EDITOR_UNIT_ID_KEY)?.with(DocSelectionRenderService);\n\n        if (docSelectionRenderService) {\n            sheetPasteShortKeyFn(docSelectionRenderService);\n        }\n        this._renderManagerService.created$.subscribe((renderer) => {\n            if (renderer.unitId === DOCS_NORMAL_EDITOR_UNIT_ID_KEY) {\n                docSelectionRenderService = this._renderManagerService.getRenderById(DOCS_NORMAL_EDITOR_UNIT_ID_KEY)?.with(DocSelectionRenderService);\n                if (docSelectionRenderService) {\n                    sheetPasteShortKeyFn(docSelectionRenderService);\n                }\n            }\n        });\n    }\n\n    private _resolveClipboardFiles(clipboardData: DataTransfer | null) {\n        if (!clipboardData) {\n            return;\n        }\n\n        const files = Array.from(clipboardData.items)\n            .map((item) => item.kind === 'file' ? item.getAsFile() : undefined)\n            .filter(Boolean) as File[];\n\n        return files.length > 0 ? files : undefined;\n    }\n\n    private _init(): void {\n        // register sheet clipboard commands\n        [SheetCopyCommand, SheetCutCommand, SheetPasteCommand].forEach((command) =>\n            this.disposeWithMe(this._commandService.registerMultipleCommand(command))\n        );\n\n        [\n            SheetPasteValueCommand,\n            SheetPasteFormatCommand,\n            SheetPasteColWidthCommand,\n            SheetPasteBesidesBorderCommand,\n            SheetPasteShortKeyCommand,\n            SheetOptionalPasteCommand,\n        ].forEach((command) => this.disposeWithMe(this._commandService.registerCommand(command)));\n\n        // register basic sheet clipboard hooks\n        this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._initCopyingHooks()));\n        this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._initPastingHook()));\n        const disposables = this._initSpecialPasteHooks().map((hook) =>\n            this._sheetClipboardService.addClipboardHook(hook)\n        );\n        this.disposeWithMe({ dispose: () => disposables.forEach((d) => d.dispose()) });\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    private _initCopyingHooks(): ISheetClipboardHook {\n        const self = this;\n        let currentSheet: Worksheet | null = null;\n        return {\n            id: PREDEFINED_HOOK_NAME.DEFAULT_COPY,\n            isDefaultHook: true,\n            onBeforeCopy(unitId, subUnitId) {\n                currentSheet = self._getWorksheet(unitId, subUnitId);\n            },\n            onCopyCellContent(row: number, col: number): string {\n                const cell = currentSheet!.getCell(row, col);\n                if (cell?.p?.body?.paragraphs || cell?.p?.body?.textRuns) {\n                    return convertBodyToHtml(cell.p.body);\n                }\n                const content = cell ? extractPureTextFromCell(cell) : '';\n                return content;\n            },\n            onCopyCellStyle: (row: number, col: number, rowSpan?: number, colSpan?: number) => {\n                const properties: IClipboardPropertyItem = {};\n\n                if (rowSpan || colSpan) {\n                    properties.rowspan = `${rowSpan || 1}`;\n                    properties.colspan = `${colSpan || 1}`;\n                }\n\n                // TODO@wzhudev: should deprecate Range and\n                // use worksheet.getStyle()\n                const range = currentSheet!.getRange(row, col);\n\n                const mergedCellByRowCol = currentSheet!.getMergedCell(row, col);\n\n                const textStyle = range.getTextStyle();\n\n                let style = '';\n\n                if (textStyle) {\n                    style = handleStyleToString(textStyle);\n                }\n\n                if (mergedCellByRowCol) {\n                    const endRow = mergedCellByRowCol.endRow;\n                    const endColumn = mergedCellByRowCol.endColumn;\n                    const lastRange = currentSheet!.getRange(endRow, endColumn);\n                    const lastTextStyle = lastRange.getTextStyle();\n                    if (lastTextStyle) {\n                        const lastStyle = handleStyleToString(lastTextStyle);\n                        if (style) {\n                            style += lastStyle ? `;${lastStyle}` : '';\n                        } else {\n                            style = lastStyle;\n                        }\n                    }\n                }\n\n                if (style) {\n                    properties.style = style;\n                }\n\n                return Object.keys(properties).length ? properties : null;\n            },\n            onCopyColumn(col: number) {\n                const sheet = currentSheet!;\n                const width = sheet.getColumnWidth(col);\n                return {\n                    width: `${width}`,\n                };\n            },\n            onCopyRow(row: number) {\n                const sheet = currentSheet!;\n                const height = sheet.getRowHeight(row);\n                return {\n                    style: `height: ${height}px;`,\n                };\n            },\n            onAfterCopy() {\n                currentSheet = null;\n            },\n            getFilteredOutRows(range: IRange) {\n                const { startRow, endRow } = range;\n                const worksheet = self._instanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)?.getActiveSheet();\n                const res: number[] = [];\n                if (!worksheet) {\n                    return res;\n                }\n                for (let r = startRow; r <= endRow; r++) {\n                    if (worksheet.getRowFiltered(r)) {\n                        res.push(r);\n                    }\n                }\n                return res;\n            },\n        };\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    private _initPastingHook(): ISheetClipboardHook {\n        const self = this;\n\n        let unitId: string | null = null;\n        let subUnitId: string | null = null;\n        let currentSheet: Worksheet | null = null;\n\n        return {\n            id: PREDEFINED_HOOK_NAME.DEFAULT_PASTE,\n            isDefaultHook: true,\n            onBeforePaste({ unitId: unitId_, subUnitId: subUnitId_, range }) {\n                currentSheet = self._getWorksheet(unitId_, subUnitId_);\n                unitId = unitId_;\n                subUnitId = subUnitId_;\n\n                // examine if pasting would cause number of cells to exceed the upper limit\n                // this is not implemented yet\n                const maxConfig = self._configService.getConfig<number>(MAX_CELL_PER_SHEET_KEY);\n                const endRow = range.rows[range.rows.length - 1];\n                const endColumn = range.cols[range.cols.length - 1];\n                if (maxConfig && endRow * endColumn > maxConfig) {\n                    self._messageService.show({\n                        type: MessageType.Error,\n                        content: self._localService.t('clipboard.paste.exceedMaxCells'),\n                    }); // TODO: show error info\n                    return false;\n                }\n\n                return true;\n            },\n\n            // eslint-disable-next-line max-lines-per-function\n            onPasteRows(pasteTo, rowProperties) {\n                const { range } = pasteTo;\n                const redoMutations: IMutationInfo[] = [];\n                const undoMutations: IMutationInfo[] = [];\n\n                // if the range is outside ot the worksheet's boundary, we should add rows\n                const maxRow = currentSheet!.getMaxRows();\n                const rowCount = maxRow - 1;\n                const addingRowsCount = range.rows[range.rows.length - 1] - rowCount;\n                const existingRowsCount = rowProperties.length - addingRowsCount;\n\n                const rowManager = currentSheet!.getRowManager();\n                if (addingRowsCount > 0) {\n                    const rowInfo: IObjectArrayPrimitiveType<IRowData> = {};\n                    rowProperties.slice(existingRowsCount).forEach((property, index) => {\n                        const { height: PropertyHeight } = property || {};\n                        if (PropertyHeight) {\n                            rowInfo[index] = {\n                                h: Number.parseFloat(PropertyHeight),\n                                hd: BooleanNumber.FALSE,\n                            };\n                        }\n                    });\n\n                    const addRowRange = {\n                        startColumn: range.cols[0],\n                        endColumn: range.cols[range.cols.length - 1],\n                        endRow: range.rows[range.rows.length - 1],\n                        startRow: maxRow,\n                    };\n\n                    const addRowMutation: IInsertRowMutationParams = {\n                        unitId: unitId!,\n                        subUnitId: subUnitId!,\n                        range: addRowRange,\n                        rowInfo,\n                    };\n                    redoMutations.push({\n                        id: InsertRowMutation.id,\n                        params: addRowMutation,\n                    });\n                    undoMutations.push({\n                        id: RemoveRowMutation.id,\n                        params: {\n                            unitId,\n                            subUnitId,\n                            range: addRowRange,\n                        },\n                    });\n                }\n\n                // get row height of existing rows\n                // TODO When Excel pasted, there was no width height, Do we still need to set the height?\n                const rowHeight: IObjectArrayPrimitiveType<number> = {};\n                const originRowHeight: IObjectArrayPrimitiveType<number> = {};\n                rowProperties.slice(0, existingRowsCount).forEach((property, index) => {\n                    const { height: propertyHeight } = property;\n                    if (propertyHeight) {\n                        const rowConfigBeforePaste = rowManager.getRow(range.rows[0] + index);\n                        const willSetHeight = Number.parseFloat(propertyHeight);\n                        if (rowConfigBeforePaste) {\n                            const { h = DEFAULT_WORKSHEET_ROW_HEIGHT, ah = 0 } = rowConfigBeforePaste;\n                            const nowRowHeight = Math.max(h, ah);\n                            if (willSetHeight > nowRowHeight) {\n                                rowHeight[index + range.rows[0]] = willSetHeight;\n                                originRowHeight[index + range.rows[0]] = nowRowHeight;\n                            } else {\n                                rowHeight[index + range.rows[0]] = nowRowHeight;\n                                originRowHeight[index + range.rows[0]] = nowRowHeight;\n                            }\n                        } else {\n                            rowHeight[index + range.rows[0]] = willSetHeight;\n                            originRowHeight[index + range.rows[0]] = rowManager.getRow(range.rows[0] + index)?.h ?? DEFAULT_WORKSHEET_ROW_HEIGHT;\n                        }\n                    }\n                });\n\n                // apply row properties to the existing rows\n                if (Object.keys(rowHeight).length) {\n                    const setRowPropertyMutation: ISetWorksheetRowHeightMutationParams = {\n                        unitId: unitId!,\n                        subUnitId: subUnitId!,\n                        ranges: [{\n                            startRow: range.rows[0],\n                            endRow: Math.min(range.rows[range.rows.length - 1], maxRow),\n                            startColumn: range.cols[0],\n                            endColumn: range.cols[range.cols.length - 1],\n                        }],\n                        rowHeight,\n                    };\n                    redoMutations.push({\n                        id: SetWorksheetRowHeightMutation.id,\n                        params: setRowPropertyMutation,\n                    });\n\n                    undoMutations.push({\n                        id: SetWorksheetRowHeightMutation.id,\n                        params: {\n                            ...setRowPropertyMutation,\n                            rowHeight: originRowHeight,\n                        },\n                    });\n                }\n\n                return {\n                    redos: redoMutations,\n                    undos: undoMutations,\n                };\n            },\n\n            // eslint-disable-next-line max-lines-per-function\n            onPasteColumns(pasteTo, colProperties, pasteType) {\n                const { range } = pasteTo;\n                const redoMutations: IMutationInfo[] = [];\n                const undoMutations: IMutationInfo[] = [];\n\n                // if the range is outside ot the worksheet's boundary, we should add rows\n                const maxColumn = currentSheet!.getMaxColumns();\n                const colCount = maxColumn - 1;\n                const addingColsCount = range.cols[range.cols.length - 1] - colCount;\n                const existingColsCount = colProperties.length - addingColsCount;\n\n                const defaultColumnWidth = self._configService.getConfig<number>(DEFAULT_WORKSHEET_COLUMN_WIDTH_KEY) ?? DEFAULT_WORKSHEET_COLUMN_WIDTH;\n                const pasteToCols = range.cols;\n                const startColumn = pasteToCols[0];\n\n                if (addingColsCount > 0) {\n                    const addColRange = {\n                        startRow: range.rows[0],\n                        endRow: range.rows[range.rows.length - 1],\n                        endColumn: range.cols[range.cols.length - 1],\n                        startColumn: maxColumn,\n                    };\n                    const addColMutation: IInsertColMutationParams = {\n                        unitId: unitId!,\n                        subUnitId: subUnitId!,\n                        range: addColRange,\n                        colInfo: colProperties.slice(existingColsCount).map((property, index) => ({\n                            w: property.width ? Math.max(+property.width, currentSheet!.getColumnWidth(pasteToCols[index])) : defaultColumnWidth,\n                            hd: BooleanNumber.FALSE,\n                        })),\n                    };\n                    redoMutations.push({\n                        id: InsertColMutation.id,\n                        params: addColMutation,\n                    });\n                    undoMutations.push({\n                        id: RemoveColMutation.id,\n                        params: {\n                            unitId,\n                            subUnitId,\n                            range: addColRange,\n                        },\n                    });\n                }\n\n                const targetSetColPropertyParams = {\n                    unitId: unitId!,\n                    subUnitId: subUnitId!,\n                    ranges: [{\n                        startRow: range.rows[0],\n                        endRow: range.rows[range.rows.length - 1],\n\n                        startColumn: range.cols[0],\n                        endColumn: Math.min(range.cols[range.cols.length - 1], maxColumn),\n                    }],\n                };\n\n                // apply col properties to the existing rows\n                if (colProperties.length > 0) {\n                    const setColPropertyMutation: ISetWorksheetColWidthMutationParams = {\n                        ...targetSetColPropertyParams,\n                        colWidth: colProperties\n                            .slice(0, existingColsCount)\n                            .reduce((p, c, index) => {\n                                p[index + startColumn] = c.width ? Math.max(+c.width, currentSheet!.getColumnWidth(pasteToCols[index]) ?? defaultColumnWidth) : defaultColumnWidth;\n                                return p;\n                            }, {} as IObjectArrayPrimitiveType<number>),\n                    };\n\n                    const undoSetColPropertyParams: ISetWorksheetColWidthMutationParams = {\n                        ...targetSetColPropertyParams,\n                        colWidth: colProperties\n                            .slice(0, existingColsCount)\n                            .reduce((p, c, index) => {\n                                p[index + startColumn] = currentSheet!.getColumnWidth(pasteToCols[index]) ?? defaultColumnWidth;\n                                return p;\n                            }, {} as IObjectArrayPrimitiveType<Nullable<number>>),\n                    };\n\n                    redoMutations.push({\n                        id: SetWorksheetColWidthMutation.id,\n                        params: setColPropertyMutation,\n                    });\n\n                    undoMutations.push({\n                        id: SetWorksheetColWidthMutation.id,\n                        params: undoSetColPropertyParams,\n                    });\n                }\n\n                return {\n                    redos: redoMutations,\n                    undos: undoMutations,\n                };\n            },\n\n            onPastePlainText(pasteTo: ISheetDiscreteRangeLocation, text: string, payload: ICopyPastePayload) {\n                return self._onPastePlainText(pasteTo, text, payload);\n            },\n\n            onPasteCells(\n                pasteFrom: ISheetDiscreteRangeLocation,\n                pasteTo: ISheetDiscreteRangeLocation,\n                data: ObjectMatrix<ICellDataWithSpanInfo>,\n                payload: ICopyPastePayload\n            ) {\n                return self._onPasteCells(pasteFrom, pasteTo, data, payload);\n            },\n\n            onAfterPaste(success) {\n                currentSheet = null;\n            },\n        };\n    }\n\n    private _generateDocumentDataModelSnapshot(snapshot: Partial<IDocumentData>) {\n        const currentSkeleton = withCurrentTypeOfRenderer(\n            UniverInstanceType.UNIVER_SHEET,\n            SheetSkeletonManagerService,\n            this._instanceService,\n            this._renderManagerService\n        )?.getCurrentParam();\n\n        if (currentSkeleton == null) {\n            return null;\n        }\n\n        const { skeleton } = currentSkeleton;\n        const documentModel = skeleton.getBlankCellDocumentModel()?.documentModel;\n        const p = documentModel?.getSnapshot();\n        const documentData = { ...p, ...snapshot };\n        documentModel?.reset(documentData);\n        return documentModel?.getSnapshot();\n    }\n\n    private _onPastePlainText(pasteTo: ISheetDiscreteRangeLocation, text: string, payload: ICopyPastePayload) {\n        const { range, unitId, subUnitId } = pasteTo;\n        let cellValue: IObjectMatrixPrimitiveType<ICellData>;\n        if (/\\r|\\n/.test(text) || Tools.isLegalUrl(text)) {\n            const body = generateBody(text);\n            const p = this._generateDocumentDataModelSnapshot({ body });\n            cellValue = {\n                [range.rows[0]]: {\n                    [range.cols[0]]: {\n                        p,\n                    },\n                },\n            };\n        } else {\n            if (isFormulaString(text)) {\n                cellValue = {\n                    [range.rows[0]]: {\n                        [range.cols[0]]: {\n                            f: text,\n                        },\n                    },\n                };\n            } else {\n                cellValue = {\n                    [range.rows[0]]: {\n                        [range.cols[0]]: {\n                            v: text,\n                        },\n                    },\n                };\n            }\n        }\n\n        const setRangeValuesParams: ISetRangeValuesMutationParams = {\n            unitId,\n            subUnitId,\n            cellValue,\n        };\n\n        return {\n            redos: [\n                {\n                    id: SetRangeValuesMutation.id,\n                    params: setRangeValuesParams,\n                },\n            ],\n            undos: [\n                {\n                    id: SetRangeValuesMutation.id,\n                    params: SetRangeValuesUndoMutationFactory(this._injector, setRangeValuesParams),\n                },\n            ],\n        };\n    }\n\n    private _onPasteCells(\n        pasteFrom: ISheetDiscreteRangeLocation,\n        pasteTo: ISheetDiscreteRangeLocation,\n        data: ObjectMatrix<ICellDataWithSpanInfo>,\n        payload: ICopyPastePayload\n    ): {\n            redos: IMutationInfo[];\n            undos: IMutationInfo[];\n        } {\n        return this._injector.invoke((accessor) => {\n            return getDefaultOnPasteCellMutations(pasteFrom, pasteTo, data, payload, accessor);\n        });\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    private _initSpecialPasteHooks() {\n        const self = this;\n\n        const specialPasteValueHook: ISheetClipboardHook = {\n            id: PREDEFINED_HOOK_NAME.SPECIAL_PASTE_VALUE,\n            specialPasteInfo: {\n                label: 'specialPaste.value',\n            },\n            onPasteCells: (pasteFrom, pasteTo, data) => {\n                return this._injector.invoke((accessor) => {\n                    return getSetCellValueMutations(pasteTo, pasteFrom, data, accessor);\n                });\n            },\n        };\n        const specialPasteFormatHook: ISheetClipboardHook = {\n            id: PREDEFINED_HOOK_NAME.SPECIAL_PASTE_FORMAT,\n            specialPasteInfo: {\n                label: 'specialPaste.format',\n            },\n            onPasteCells: (pasteFrom, pasteTo, matrix) => {\n                const redoMutationsInfo: IMutationInfo[] = [];\n                const undoMutationsInfo: IMutationInfo[] = [];\n\n                // clear cell style\n                const { undos: styleUndos, redos: styleRedos } = this._injector.invoke((accessor) => {\n                    return getClearCellStyleMutations(pasteTo, matrix, accessor);\n                });\n                redoMutationsInfo.push(...styleRedos);\n                undoMutationsInfo.push(...styleUndos);\n\n                // clear and set merge\n                const { undos: mergeUndos, redos: mergeRedos } = this._injector.invoke((accessor) => {\n                    return getClearAndSetMergeMutations(\n                        pasteTo,\n                        matrix,\n                        accessor\n                    );\n                });\n                redoMutationsInfo.push(...mergeRedos);\n                undoMutationsInfo.push(...mergeUndos);\n\n                const { undos: setStyleUndos, redos: setStyleRedos } = this._injector.invoke((accessor) => {\n                    return getSetCellStyleMutations(\n                        pasteTo,\n                        matrix,\n                        accessor\n                    );\n                });\n\n                redoMutationsInfo.push(...setStyleRedos);\n                undoMutationsInfo.push(...setStyleUndos);\n\n                return {\n                    undos: undoMutationsInfo,\n                    redos: redoMutationsInfo,\n                };\n            },\n        };\n\n        const specialPasteColWidthHook: ISheetClipboardHook = {\n            id: PREDEFINED_HOOK_NAME.SPECIAL_PASTE_COL_WIDTH,\n            specialPasteInfo: {\n                label: 'specialPaste.colWidth',\n            },\n            onPasteCells() {\n                return {\n                    undos: [],\n                    redos: [],\n                };\n            },\n            onPasteColumns(pasteTo, colProperties, payload) {\n                const workbook = self._instanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n                const unitId = workbook.getUnitId();\n                const subUnitId = workbook.getActiveSheet()?.getSheetId();\n\n                if (!unitId || !subUnitId) {\n                    throw new Error('Cannot find unitId or subUnitId');\n                }\n\n                const redoMutations: IMutationInfo[] = [];\n                const undoMutations: IMutationInfo[] = [];\n                const currentSheet = self._getWorksheet(unitId, subUnitId);\n\n                const { range } = pasteTo;\n                const pasteToCols = range.cols;\n                const startColumn = pasteToCols[0];\n                // if the range is outside ot the worksheet's boundary, we should add rows\n                const maxColumn = currentSheet!.getMaxColumns();\n                const addingColsCount = range.cols[range.cols.length - 1] - maxColumn;\n                const existingColsCount = colProperties.length - addingColsCount;\n                const defaultColumnWidth = self._configService.getConfig<number>(DEFAULT_WORKSHEET_COLUMN_WIDTH_KEY) ?? DEFAULT_WORKSHEET_COLUMN_WIDTH;\n\n                const setColPropertyMutation: ISetWorksheetColWidthMutationParams = {\n                    unitId: unitId!,\n                    subUnitId: subUnitId!,\n                    ranges: [{\n                        startRow: range.rows[0],\n                        endRow: Math.min(range.cols[range.cols.length - 1], maxColumn),\n                        startColumn: range.cols[0],\n                        endColumn: range.cols[range.cols.length - 1],\n                    }],\n                    colWidth: colProperties\n                        .slice(0, existingColsCount)\n                        .reduce((p, c, index) => {\n                            p[index + startColumn] = c.width ? Math.max(+c.width, currentSheet!.getColumnWidth(pasteToCols[index]) ?? defaultColumnWidth) : defaultColumnWidth;\n                            return p;\n                        }, {} as IObjectArrayPrimitiveType<number>),\n                };\n\n                const undoSetColPropertyMutation: ISetWorksheetColWidthMutationParams = {\n                    unitId: unitId!,\n                    subUnitId: subUnitId!,\n                    ranges: [{\n                        startRow: range.rows[0],\n                        endRow: Math.min(range.cols[range.cols.length - 1], maxColumn),\n                        startColumn: range.cols[0],\n                        endColumn: range.cols[range.cols.length - 1],\n                    }],\n                    colWidth: colProperties\n                        .slice(0, existingColsCount)\n                        .reduce((p, c, index) => {\n                            p[index + startColumn] = currentSheet!.getColumnWidth(pasteToCols[index]) ?? defaultColumnWidth;\n                            return p;\n                        }, {} as IObjectArrayPrimitiveType<Nullable<number>>),\n                };\n\n                redoMutations.push({\n                    id: SetWorksheetColWidthMutation.id,\n                    params: setColPropertyMutation,\n                });\n\n                undoMutations.push({\n                    id: SetWorksheetColWidthMutation.id,\n                    params: undoSetColPropertyMutation,\n                });\n\n                return {\n                    redos: redoMutations,\n                    undos: undoMutations,\n                };\n            },\n        };\n\n        const specialPasteBesidesBorder: ISheetClipboardHook = {\n            id: PREDEFINED_HOOK_NAME.SPECIAL_PASTE_BESIDES_BORDER,\n            specialPasteInfo: {\n                label: 'specialPaste.besidesBorder',\n            },\n            onPasteCells: (pasteFrom, pasteTo, matrix, payload) => {\n                const workbook = self._instanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n                const redoMutationsInfo: IMutationInfo[] = [];\n                const undoMutationsInfo: IMutationInfo[] = [];\n                const { range, unitId, subUnitId } = pasteTo;\n                const valueMatrix = new ObjectMatrix<ICellData>();\n\n                // TODO@Dushusir: undo selection\n                matrix.forValue((row, col, value) => {\n                    const style = value.s;\n                    if (typeof style === 'object') {\n                        const newValue = Tools.deepClone(value);\n                        if (newValue.s) {\n                            newValue.s = {\n                                ...style,\n                                bd: null,\n                            };\n                        }\n                        valueMatrix.setValue(range.rows[row], range.cols[col], newValue);\n                    }\n                });\n\n                // set cell value and style\n                const setValuesMutation: ISetRangeValuesMutationParams = {\n                    unitId,\n                    subUnitId,\n                    cellValue: valueMatrix.getData(),\n                };\n\n                redoMutationsInfo.push({\n                    id: SetRangeValuesMutation.id,\n                    params: setValuesMutation,\n                });\n\n                // undo\n                const undoSetValuesMutation: ISetRangeValuesMutationParams = this._injector.invoke(\n                    SetRangeValuesUndoMutationFactory,\n                    setValuesMutation\n                );\n\n                undoMutationsInfo.push({\n                    id: SetRangeValuesMutation.id,\n                    params: undoSetValuesMutation,\n                });\n\n                const { undos, redos } = this._injector.invoke((accessor) => {\n                    return getClearAndSetMergeMutations(pasteTo, matrix, accessor);\n                });\n                undoMutationsInfo.push(...undos);\n                redoMutationsInfo.push(...redos);\n\n                return {\n                    redos: redoMutationsInfo,\n                    undos: undoMutationsInfo,\n                };\n            },\n        };\n\n        return [specialPasteValueHook, specialPasteFormatHook, specialPasteColWidthHook, specialPasteBesidesBorder];\n    }\n\n    private _getWorksheet(unitId: string, subUnitId: string): Worksheet {\n        const worksheet = this._instanceService.getUniverSheetInstance(unitId)?.getSheetBySheetId(subUnitId);\n\n        if (!worksheet) {\n            throw new Error(\n                `[SheetClipboardController]: cannot find a worksheet with unitId ${unitId} and subUnitId ${subUnitId}.`\n            );\n        }\n\n        return worksheet;\n    }\n\n    private _initCommandListener() {\n        this.disposeWithMe(\n            this._commandService.onCommandExecuted((command: ICommandInfo) => {\n                if (command.id === AddWorksheetMergeCommand.id) {\n                    this._sheetClipboardService.removeMarkSelection();\n                } else if (shouldRemoveShapeIds.includes(command.id)) {\n                    this._sheetClipboardService.removeMarkSelection();\n                }\n            })\n        );\n\n        const sheetsUIConfig = this._configService.getConfig<IUniverSheetsUIConfig>(SHEETS_UI_PLUGIN_CONFIG_KEY);\n        if (sheetsUIConfig?.clipboardConfig?.hidePasteOptions) {\n            return;\n        }\n\n        this.disposeWithMe(\n            this._commandService.onCommandExecuted((command: ICommandInfo) => {\n                if (RemovePasteMenuCommands.includes(command.id)) {\n                    this._sheetClipboardService.disposePasteOptionsCache();\n                }\n            })\n        );\n\n        this.disposeWithMe(\n            this._commandService.onCommandExecuted((command: ICommandInfo) => {\n                if (command.id === SetScrollOperation.id) {\n                    if (!this._sheetClipboardService.getPasteMenuVisible()) {\n                        return;\n                    }\n                    const params = command.params as IScrollStateWithSearchParam;\n                    const scrollUnitId = params.unitId;\n                    const pasteOptionsCache = this._sheetClipboardService.getPasteOptionsCache();\n                    const menuUnitId = pasteOptionsCache?.target.unitId;\n                    if (scrollUnitId === menuUnitId) {\n                        this._refreshOptionalPaste$.next(Math.random());\n                    }\n                }\n            })\n        );\n    }\n\n    private _initUIComponents() {\n        const sheetsUIConfig = this._configService.getConfig<IUniverSheetsUIConfig>(SHEETS_UI_PLUGIN_CONFIG_KEY);\n        if (sheetsUIConfig?.clipboardConfig?.hidePasteOptions) {\n            return;\n        }\n\n        this.disposeWithMe(\n            this._uiPartsService.registerComponent(BuiltInUIPart.CONTENT, () => connectInjector(ClipboardPopupMenu, this._injector))\n        );\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Nullable, Workbook } from '@univerjs/core';\nimport type { IDragEvent } from '@univerjs/engine-render';\nimport type { IHoverCellPosition } from './hover-manager.service';\nimport { Disposable, IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport { distinctUntilChanged, Subject } from 'rxjs';\nimport { getHoverCellPosition } from '../common/utils';\nimport { SheetScrollManagerService } from './scroll-manager.service';\nimport { SheetSkeletonManagerService } from './sheet-skeleton-manager.service';\n\nexport interface IDragCellPosition extends IHoverCellPosition {\n    dataTransfer: DataTransfer;\n}\n\nexport class DragManagerService extends Disposable {\n    private _currentCell$ = new Subject<Nullable<IDragCellPosition>>();\n    currentCell$ = this._currentCell$.asObservable().pipe(distinctUntilChanged(\n        (pre, aft) => (\n            pre?.location?.unitId === aft?.location?.unitId\n            && pre?.location?.subUnitId === aft?.location?.subUnitId\n            && pre?.location?.row === aft?.location?.row\n            && pre?.location?.col === aft?.location?.col\n        )\n    ));\n\n    private _endCell$ = new Subject<Nullable<IDragCellPosition>>();\n    endCell$ = this._endCell$.asObservable();\n\n    constructor(\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService\n    ) {\n        super();\n\n        this._initCellDisposableListener();\n    }\n\n    override dispose(): void {\n        super.dispose();\n        this._currentCell$.complete();\n        this._endCell$.complete();\n    }\n\n    private _initCellDisposableListener(): void {\n        this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) => {\n            if (!workbook) {\n                this._currentCell$.next(null);\n                this._endCell$.next(null);\n            }\n        }));\n    }\n\n    private _calcActiveCell(offsetX: number, offsetY: number): Nullable<IHoverCellPosition> {\n        const workbook = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        if (!workbook) {\n            return null;\n        }\n\n        const worksheet = workbook.getActiveSheet();\n        if (!worksheet) return;\n        // const skeletonParam = this._sheetSkeletonManagerService.getCurrent();\n        const currentRender = this._renderManagerService.getRenderById(workbook.getUnitId());\n        if (!currentRender) return;\n\n        const skeletonParam = currentRender.with(SheetSkeletonManagerService).getCurrentParam();\n        const scrollManagerService = currentRender.with(SheetScrollManagerService);\n        const scrollInfo = scrollManagerService.getCurrentScrollState();\n\n        if (!skeletonParam || !scrollInfo || !currentRender) return;\n\n        return getHoverCellPosition(currentRender, workbook, worksheet, skeletonParam, offsetX, offsetY);\n    }\n\n    onDragOver(evt: IDragEvent) {\n        const { offsetX, offsetY, dataTransfer } = evt;\n        const activeCell = this._calcActiveCell(offsetX, offsetY);\n\n        if (!activeCell) {\n            this._currentCell$.next(null);\n            return;\n        }\n\n        const { location, position } = activeCell;\n\n        this._currentCell$.next({\n            location,\n            position,\n            dataTransfer,\n        });\n    }\n\n    onDrop(evt: IDragEvent) {\n        const { offsetX, offsetY, dataTransfer } = evt;\n        const activeCell = this._calcActiveCell(offsetX, offsetY);\n\n        if (!activeCell) {\n            this._endCell$.next(null);\n            return;\n        }\n\n        const { location, position } = activeCell;\n\n        this._endCell$.next({\n            location,\n            position,\n            dataTransfer,\n        });\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Nullable, Workbook } from '@univerjs/core';\nimport { Disposable, DisposableCollection, Inject } from '@univerjs/core';\nimport type { IRenderContext, IRenderModule } from '@univerjs/engine-render';\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport { DragManagerService } from '../services/drag-manager.service';\nimport { type ISheetSkeletonManagerParam, SheetSkeletonManagerService } from '../services/sheet-skeleton-manager.service';\n\nexport class DragRenderController extends Disposable implements IRenderModule, IRenderModule {\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @IRenderManagerService private _renderManagerService: IRenderManagerService,\n        @Inject(DragManagerService) private _dragManagerService: DragManagerService,\n        @Inject(SheetSkeletonManagerService) private readonly _sheetSkeletonManagerService: SheetSkeletonManagerService\n    ) {\n        super();\n\n        this._initDragEvent();\n    }\n\n    private _initDragEvent() {\n        const disposeSet = new DisposableCollection();\n        const handleSkeletonChange = (skeletonParam: Nullable<ISheetSkeletonManagerParam>) => {\n            disposeSet.dispose();\n            if (!skeletonParam) {\n                return;\n            }\n\n            const { scene } = this._context;\n            const dragOverSub = scene.onDragOver$.subscribeEvent((evt) => {\n                this._dragManagerService.onDragOver(evt);\n            });\n\n            const dropSub = scene.onDrop$.subscribeEvent((evt) => {\n                this._dragManagerService.onDrop(evt);\n            });\n\n            disposeSet.add({\n                dispose() {\n                    dragOverSub.unsubscribe();\n                    dropSub.unsubscribe();\n                },\n            });\n        };\n\n        handleSkeletonChange(this._sheetSkeletonManagerService.getCurrentParam());\n        this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((skeletonParam) => {\n            handleSkeletonChange(skeletonParam);\n        }));\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellWithCoord, ICustomRange, Injector, IParagraph, ITextRangeParam, Workbook } from '@univerjs/core';\nimport type { DocumentSkeleton, IBoundRectNoAngle, IDocumentSkeletonGlyph, IFontCacheItem } from '@univerjs/engine-render';\nimport { CustomRangeType, HorizontalAlign, IUniverInstanceService, PresetListType, UniverInstanceType, VerticalAlign } from '@univerjs/core';\nimport { DocSkeletonManagerService } from '@univerjs/docs';\nimport { DOC_VERTICAL_PADDING, getLineBounding, NodePositionConvertToCursor } from '@univerjs/docs-ui';\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport { IEditorBridgeService } from '../editor-bridge.service';\nimport { SheetSkeletonManagerService } from '../sheet-skeleton-manager.service';\n\nconst calcDocRangePositions = (range: ITextRangeParam, skeleton: DocumentSkeleton): IBoundRectNoAngle[] | undefined => {\n    const pageIndex = -1;\n    const startPosition = skeleton.findNodePositionByCharIndex(range.startOffset, true, range.segmentId, pageIndex);\n    const skeletonData = skeleton.getSkeletonData();\n    let end = range.endOffset;\n    if (range.segmentId) {\n        const root = Array.from(skeletonData?.skeFooters.get(range.segmentId)?.values() ?? [])[0] ?? Array.from(skeletonData?.skeHeaders.get(range.segmentId)?.values() ?? [])[0];\n        if (root) {\n            end = Math.min(root.ed, end);\n        }\n    }\n    const endPosition = skeleton.findNodePositionByCharIndex(end, true, range.segmentId, pageIndex);\n    if (!endPosition || !startPosition) {\n        return;\n    }\n\n    const documentOffsetConfig = {\n        docsLeft: 0,\n        docsTop: 0,\n        pageMarginLeft: 0,\n        pageMarginTop: 0,\n    };\n    const convertor = new NodePositionConvertToCursor(documentOffsetConfig as any, skeleton);\n    const { borderBoxPointGroup } = convertor.getRangePointData(startPosition, endPosition);\n    const bounds = getLineBounding(borderBoxPointGroup);\n\n    return bounds.map((rect) => ({\n        top: rect.top,\n        bottom: rect.bottom,\n        left: rect.left,\n        right: rect.right,\n    }));\n};\n\nconst calcDocGlyphPosition = (glyph: IDocumentSkeletonGlyph, skeleton: DocumentSkeleton, pageIndex = -1): IBoundRectNoAngle | undefined => {\n    const start = skeleton.findPositionByGlyph(glyph, pageIndex);\n    if (!start) {\n        return;\n    }\n\n    const startPosition = { ...start, isBack: true };\n    const documentOffsetConfig = {\n        docsLeft: 0,\n        docsTop: 0,\n        pageMarginLeft: 0,\n        pageMarginTop: 0,\n    };\n    const convertor = new NodePositionConvertToCursor(documentOffsetConfig as any, skeleton);\n    const { borderBoxPointGroup } = convertor.getRangePointData(startPosition, startPosition);\n    const bounds = getLineBounding(borderBoxPointGroup);\n    const rect = bounds[0];\n\n    return {\n        top: rect.top,\n        bottom: rect.bottom,\n        left: rect.left,\n        right: rect.right,\n    };\n};\n\nconst calcLinkPosition = (skeleton: DocumentSkeleton, range: ICustomRange, paddingLeft = 0, paddingTop = 0) => {\n    const rects = calcDocRangePositions({ startOffset: range.startIndex, endOffset: range.endIndex + 1, collapsed: false }, skeleton);\n    if (rects) {\n        return {\n            rects: rects.map((rect) => ({\n                top: rect.top + paddingTop,\n                bottom: rect.bottom + paddingTop,\n                left: rect.left + paddingLeft,\n                right: rect.right + paddingLeft,\n            })),\n            range,\n        };\n    }\n};\n\nconst calcBulletPosition = (skeleton: DocumentSkeleton, paragraph: IParagraph, paddingLeft = 0, paddingTop = 0) => {\n    const node = skeleton.findNodeByCharIndex(paragraph.startIndex);\n    const divide = node?.parent;\n    const line = divide?.parent;\n    const column = line?.parent;\n    const targetLine = column?.lines.find((l) => l.paragraphStart && l.paragraphIndex === paragraph.startIndex);\n    const bulletNode = targetLine?.divides?.[0]?.glyphGroup?.[0];\n\n    if (!bulletNode) {\n        return;\n    }\n\n    if (!bulletNode) {\n        return;\n    }\n\n    const rect = calcDocGlyphPosition(bulletNode, skeleton);\n\n    if (!rect) {\n        return;\n    }\n\n    return {\n        rect: {\n            top: rect.top + paddingTop,\n            bottom: rect.bottom + paddingTop,\n            left: rect.left + paddingLeft,\n            right: rect.right + paddingLeft,\n        },\n        segmentId: undefined,\n        segmentPageIndex: -1,\n        paragraph,\n    };\n};\n\nexport const calculateDocSkeletonRects = (docSkeleton: DocumentSkeleton, paddingLeft = 0, paddingTop = 0) => {\n    const docModel = docSkeleton.getViewModel().getDataModel();\n    const hyperLinks = docModel.getBody()?.customRanges?.filter((range) => range.rangeType === CustomRangeType.HYPERLINK) ?? [];\n    const checkLists = docModel.getBody()?.paragraphs?.filter((p) => p.bullet?.listType.indexOf(PresetListType.CHECK_LIST) === 0) ?? [];\n    const drawings = docSkeleton.getSkeletonData()?.pages[0].skeDrawings;\n    return {\n        links: hyperLinks.map((link) => calcLinkPosition(docSkeleton, link, paddingLeft, paddingTop)!).filter(Boolean),\n        checkLists: checkLists.map((list) => calcBulletPosition(docSkeleton, list, paddingLeft, paddingTop)!).filter(Boolean),\n        drawings: drawings\n            ? Array.from(drawings.keys()).map((key) => ({\n                drawingId: key,\n                rect: {\n                    top: drawings!.get(key)!.aTop,\n                    bottom: drawings!.get(key)!.aTop + drawings!.get(key)!.width,\n                    left: drawings!.get(key)!.aLeft,\n                    right: drawings!.get(key)!.aLeft + drawings!.get(key)!.height,\n                },\n            }))\n            : [],\n    };\n};\n\nexport function calcPadding(cell: ICellWithCoord, font: IFontCacheItem, isNum: boolean) {\n    const height = font.documentSkeleton?.getSkeletonData()?.pages[0].height ?? 0;\n    const width = font.documentSkeleton?.getSkeletonData()?.pages[0].width ?? 0;\n    const vt = font.verticalAlign;\n    const ht = font.horizontalAlign;\n\n    let paddingTop = 0;\n    switch (vt) {\n        case VerticalAlign.UNSPECIFIED:\n        case VerticalAlign.BOTTOM:\n            paddingTop = cell.mergeInfo.endY - cell.mergeInfo.startY - height;\n            break;\n        case VerticalAlign.MIDDLE:\n            paddingTop = (cell.mergeInfo.endY - cell.mergeInfo.startY - height) / 2;\n            break;\n        default:\n            break;\n    }\n\n    let paddingLeft = 0;\n    switch (ht) {\n        case HorizontalAlign.RIGHT:\n            paddingLeft = cell.mergeInfo.endX - cell.mergeInfo.startX - width;\n            break;\n        case HorizontalAlign.CENTER:\n            paddingLeft = (cell.mergeInfo.endX - cell.mergeInfo.startX - width) / 2;\n            break;\n        case HorizontalAlign.UNSPECIFIED:{\n            if (isNum) {\n                paddingLeft = cell.mergeInfo.endX - cell.mergeInfo.startX - width;\n            }\n            break;\n        }\n        default:\n            break;\n    }\n\n    return {\n        paddingLeft,\n        paddingTop,\n    };\n}\n\nexport const getCustomRangePosition = (injector: Injector, unitId: string, subUnitId: string, row: number, col: number, rangeId: string) => {\n    const univerInstanceService = injector.get(IUniverInstanceService);\n    const renderManagerService = injector.get(IRenderManagerService);\n    const workbook = univerInstanceService.getUnit<Workbook>(unitId, UniverInstanceType.UNIVER_SHEET);\n    if (!workbook) {\n        return null;\n    }\n\n    const worksheet = workbook.getSheetBySheetId(subUnitId);\n    if (!worksheet) {\n        return null;\n    }\n\n    const currentRender = renderManagerService.getRenderById(workbook.getUnitId());\n    const skeletonParam = currentRender?.with(SheetSkeletonManagerService).getSkeletonParam(worksheet.getSheetId());\n\n    const skeleton = skeletonParam?.skeleton;\n\n    if (!skeleton || !currentRender) return;\n\n    const font = skeleton.getFont(row, col);\n    const docSkeleton = font?.documentSkeleton;\n    if (!docSkeleton) {\n        return null;\n    }\n    const customRange = docSkeleton.getViewModel().getBody()?.customRanges?.find((range) => range.rangeId === rangeId);\n    if (!customRange) {\n        return null;\n    }\n\n    const PADDING = DOC_VERTICAL_PADDING;\n\n    const cellIndex = skeleton.getCellWithCoordByIndex(row, col);\n    let { actualColumn, actualRow } = cellIndex;\n\n    skeleton.overflowCache.forValue((r, c, range) => {\n        if (range.startRow <= actualRow && range.endRow >= actualRow && range.startColumn <= actualColumn && range.endColumn >= actualColumn) {\n            actualColumn = c;\n            actualRow = r;\n        }\n    });\n\n    const actualCell = skeleton.getCellWithCoordByIndex(actualRow, actualColumn);\n    const cellData = worksheet.getCell(actualCell.actualRow, actualCell.actualColumn);\n    const { topOffset = 0, leftOffset = 0 } = cellData?.fontRenderExtension ?? {};\n    const { paddingLeft, paddingTop } = calcPadding(actualCell, font, false);\n    const rects = calcDocRangePositions({ startOffset: customRange.startIndex, endOffset: customRange.endIndex, collapsed: false }, docSkeleton);\n\n    return {\n        rects: rects?.map((rect) => ({\n            top: rect.top + actualCell.mergeInfo.startY + paddingTop + topOffset + PADDING,\n            bottom: rect.bottom + actualCell.mergeInfo.startY + paddingTop + topOffset + PADDING,\n            left: rect.left + actualCell.mergeInfo.startX + paddingLeft + leftOffset,\n            right: rect.right + actualCell.mergeInfo.startX + paddingLeft + leftOffset,\n        })),\n        customRange,\n        label: docSkeleton.getViewModel().getBody()!.dataStream.slice(customRange.startIndex, customRange.endIndex + 1),\n    };\n};\n\nexport const getEditingCustomRangePosition = (injector: Injector, unitId: string, subUnitId: string, row: number, col: number, rangeId: string) => {\n    const editorBridgeService = injector.get(IEditorBridgeService);\n\n    const state = editorBridgeService.getEditCellState();\n    if (!state) {\n        return null;\n    }\n    const visible = editorBridgeService.isVisible();\n    if (!visible.visible) {\n        return null;\n    }\n    const { editorUnitId, unitId: editingUnitId, sheetId, row: editRow, column: editCol } = state;\n    if (unitId !== editingUnitId || subUnitId !== sheetId || editRow !== row || editCol !== col) {\n        return null;\n    }\n\n    const renderManagerService = injector.get(IRenderManagerService);\n    const renderer = renderManagerService.getRenderById(editorUnitId);\n    const sheetRenderer = renderManagerService.getRenderById(unitId);\n    if (!renderer || !sheetRenderer) {\n        return null;\n    }\n\n    const docSkeleton = renderer.with(DocSkeletonManagerService).getSkeleton();\n    const sheetSkeleton = sheetRenderer.with(SheetSkeletonManagerService).getSkeletonParam(sheetId)?.skeleton;\n\n    if (!docSkeleton || !sheetSkeleton) {\n        return null;\n    }\n\n    const customRange = docSkeleton.getViewModel().getBody()?.customRanges?.find((range) => range.rangeId === rangeId);\n    if (!customRange) {\n        return null;\n    }\n\n    const PADDING = 4;\n    const rects = calcDocRangePositions({ startOffset: customRange.startIndex, endOffset: customRange.endIndex, collapsed: false }, docSkeleton);\n    const canvasClientRect = renderer.engine.getCanvasElement().getBoundingClientRect();\n\n    return {\n        rects: rects?.map((rect) => ({\n            top: rect.top + canvasClientRect.top - PADDING,\n            bottom: rect.bottom + canvasClientRect.top + PADDING,\n            left: rect.left + canvasClientRect.left,\n            right: rect.right + canvasClientRect.left,\n        })),\n        customRange,\n        label: docSkeleton.getViewModel().getBody()!.dataStream.slice(customRange.startIndex, customRange.endIndex + 1),\n    };\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICustomRange, IParagraph, IPosition, Nullable, Workbook, Worksheet } from '@univerjs/core';\nimport type { IBoundRectNoAngle, IMouseEvent, IPointerEvent, IRender } from '@univerjs/engine-render';\nimport type { ISheetLocation, ISheetLocationBase } from '@univerjs/sheets';\nimport type { ISheetSkeletonManagerParam } from './sheet-skeleton-manager.service';\nimport { Disposable, IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport { IRenderManagerService, SHEET_VIEWPORT_KEY, Vector2 } from '@univerjs/engine-render';\nimport { BehaviorSubject, distinctUntilChanged, map, Subject } from 'rxjs';\nimport { getHoverCellPosition } from '../common/utils';\nimport { SheetScrollManagerService } from './scroll-manager.service';\nimport { SheetSkeletonManagerService } from './sheet-skeleton-manager.service';\nimport { calcPadding, calculateDocSkeletonRects } from './utils/doc-skeleton-util';\n\nexport interface IHoverCellPosition {\n    position: IPosition;\n    /**\n     * location of cell\n     */\n    location: ISheetLocationBase;\n}\n\nexport interface ICellWithEvent extends IHoverCellPosition {\n    event: IMouseEvent | IPointerEvent;\n}\n\nexport interface ICellPosWithEvent extends ISheetLocationBase {\n    event: IMouseEvent | IPointerEvent;\n}\n\nexport interface IHoverRichTextInfo extends IHoverCellPosition {\n    /**\n     * active custom range in cell, if cell is rich-text\n     */\n    customRange?: Nullable<ICustomRange>;\n    /**\n     * active bullet in cell, if cell is rich-text\n     */\n    bullet?: Nullable<IParagraph>;\n    /**\n     * rect of custom-range or bullet\n     */\n    rect?: Nullable<IBoundRectNoAngle>;\n\n    drawing?: Nullable<string>;\n}\n\nexport interface IHoverRichTextPosition extends ISheetLocationBase {\n    /**\n     * active custom range in cell, if cell is rich-text\n     */\n    customRange?: Nullable<ICustomRange>;\n    /**\n     * active bullet in cell, if cell is rich-text\n     */\n    bullet?: Nullable<IParagraph>;\n    /**\n     * rect of custom-range or bullet\n     */\n    rect?: Nullable<IBoundRectNoAngle>;\n\n    drawing?: Nullable<string>;\n\n    event?: IMouseEvent | IPointerEvent;\n}\n\nexport interface IHoverHeaderPosition {\n    unitId: string;\n    subUnitId: string;\n    index: number;\n}\n\nexport function getLocationBase(location: ISheetLocation) {\n    const { workbook, worksheet, ...locBase } = location;\n    return locBase;\n}\n\nexport class HoverManagerService extends Disposable {\n    private _currentCell$ = new BehaviorSubject<Nullable<IHoverCellPosition>>(null);\n    private _currentRichText$ = new BehaviorSubject<Nullable<IHoverRichTextInfo>>(null);\n    private _currentClickedCell$ = new Subject<IHoverRichTextInfo>();\n    private _currentDbClickedCell$ = new Subject<IHoverRichTextInfo>();\n\n    private _currentCellWithEvent$ = new Subject<Nullable<ICellWithEvent>>();\n    private _currentPointerDownCell$ = new Subject<ICellPosWithEvent>();\n    private _currentPointerUpCell$ = new Subject<ICellPosWithEvent>();\n\n    private _currentHoveredRowHeader$ = new BehaviorSubject<Nullable<IHoverHeaderPosition>>(null);\n    private _currentHoveredColHeader$ = new BehaviorSubject<Nullable<IHoverHeaderPosition>>(null);\n    private _currentRowHeaderClick$ = new Subject<IHoverHeaderPosition>();\n    private _currentColHeaderClick$ = new Subject<IHoverHeaderPosition>();\n    private _currentRowHeaderDbClick$ = new Subject<IHoverHeaderPosition>();\n    private _currentColHeaderDbClick$ = new Subject<IHoverHeaderPosition>();\n    private _currentRowHeaderPointerDown$ = new Subject<IHoverHeaderPosition>();\n    private _currentColHeaderPointerDown$ = new Subject<IHoverHeaderPosition>();\n    private _currentRowHeaderPointerUp$ = new Subject<IHoverHeaderPosition>();\n    private _currentColHeaderPointerUp$ = new Subject<IHoverHeaderPosition>();\n\n    // Notify when hovering over different cells\n    currentCell$ = this._currentCell$.asObservable().pipe(\n        distinctUntilChanged(\n            (pre, aft) => (\n                pre?.location?.unitId === aft?.location?.unitId\n                && pre?.location?.subUnitId === aft?.location?.subUnitId\n                && pre?.location?.row === aft?.location?.row\n                && pre?.location?.col === aft?.location?.col\n            )\n        )\n    );\n\n    // Notify when hovering over different cells and different custom range or bullet\n    currentRichText$ = this._currentRichText$.pipe(\n        distinctUntilChanged(\n            // eslint-disable-next-line complexity\n            (pre, aft) => (\n                pre?.location?.unitId === aft?.location?.unitId\n                && pre?.location?.subUnitId === aft?.location?.subUnitId\n                && pre?.location?.row === aft?.location?.row\n                && pre?.location?.col === aft?.location?.col\n                && pre?.customRange?.rangeId === aft?.customRange?.rangeId\n                && pre?.bullet?.startIndex === aft?.bullet?.startIndex\n                && pre?.customRange?.startIndex === aft?.customRange?.startIndex\n                && pre?.customRange?.endIndex === aft?.customRange?.endIndex\n                && pre?.drawing === aft?.drawing\n            )\n        ),\n        map((cell) => cell && {\n            unitId: cell.location.unitId,\n            subUnitId: cell.location.subUnitId,\n            row: cell.location.row,\n            col: cell.location.col,\n            customRange: cell.customRange,\n            bullet: cell.bullet,\n            rect: cell.rect,\n            drawing: cell.drawing,\n        } as IHoverRichTextPosition)\n    );\n\n    /**\n     * Nearly same as currentRichText$, but with event\n     */\n    currentCellPosWithEvent$ = this._currentCellWithEvent$.pipe(\n        distinctUntilChanged(\n\n            (pre, aft) => (\n                pre?.location?.unitId === aft?.location?.unitId\n                && pre?.location?.subUnitId === aft?.location?.subUnitId\n                && pre?.location?.row === aft?.location?.row\n                && pre?.location?.col === aft?.location?.col\n            )\n        ),\n        map((cell) => cell && {\n            unitId: cell.location.unitId,\n            subUnitId: cell.location.subUnitId,\n            row: cell.location.row,\n            col: cell.location.col,\n            event: cell.event,\n        } as ICellPosWithEvent)\n    );\n\n    // Notify when mouse position changes\n    currentPosition$ = this._currentCell$.asObservable();\n    currentClickedCell$ = this._currentClickedCell$.asObservable();\n    currentDbClickedCell$ = this._currentDbClickedCell$.asObservable();\n    currentPointerDownCell$ = this._currentPointerDownCell$.asObservable();\n    currentPointerUpCell$ = this._currentPointerUpCell$.asObservable();\n\n    currentHoveredRowHeader$ = this._currentHoveredRowHeader$.asObservable();\n    currentHoveredColHeader$ = this._currentHoveredColHeader$.asObservable();\n    currentRowHeaderClick$ = this._currentRowHeaderClick$.asObservable();\n    currentColHeaderClick$ = this._currentColHeaderClick$.asObservable();\n    currentRowHeaderDbClick$ = this._currentRowHeaderDbClick$.asObservable();\n    currentColHeaderDbClick$ = this._currentColHeaderDbClick$.asObservable();\n    currentRowHeaderPointerDown$ = this._currentRowHeaderPointerDown$.asObservable();\n    currentColHeaderPointerDown$ = this._currentColHeaderPointerDown$.asObservable();\n    currentRowHeaderPointerUp$ = this._currentRowHeaderPointerUp$.asObservable();\n    currentColHeaderPointerUp$ = this._currentColHeaderPointerUp$.asObservable();\n\n    constructor(\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService\n    ) {\n        super();\n\n        this._initCellDisposableListener();\n    }\n\n    override dispose(): void {\n        super.dispose();\n        this._currentCell$.complete();\n        this._currentClickedCell$.complete();\n        this._currentPointerDownCell$.complete();\n        this._currentPointerUpCell$.complete();\n        this._currentCellWithEvent$.complete();\n    }\n\n    private _initCellDisposableListener(): void {\n        this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) => {\n            if (!workbook) this._currentCell$.next(null);\n        }));\n\n        this.disposeWithMe(this._univerInstanceService.unitDisposed$.subscribe((unit) => {\n            if (this._currentCell$.getValue()?.location.unitId === unit.getUnitId()) {\n                this._currentCell$.next(null);\n            }\n\n            if (this._currentRichText$.getValue()?.location.unitId === unit.getUnitId()) {\n                this._currentRichText$.next(null);\n            }\n        }));\n    }\n\n    private _getCalcDeps(unitId: string) {\n        const workbook = this._univerInstanceService.getUnit<Workbook>(unitId, UniverInstanceType.UNIVER_SHEET);\n        if (!workbook) {\n            return null;\n        }\n\n        const worksheet = workbook.getActiveSheet();\n        if (!worksheet) {\n            return null;\n        }\n\n        const currentRender = this._renderManagerService.getRenderById(workbook.getUnitId());\n        if (!currentRender) return null;\n        const skeletonParam = currentRender.with(SheetSkeletonManagerService).getSkeletonParam(worksheet.getSheetId());\n        if (!skeletonParam) return null;\n\n        const scrollManagerService = currentRender.with(SheetScrollManagerService);\n        const scrollInfo = scrollManagerService?.getCurrentScrollState();\n\n        if (!scrollInfo || !currentRender) return;\n\n        return { currentRender, workbook, worksheet, skeletonParam };\n    }\n\n    // eslint-disable-next-line complexity\n    private _calcActiveCell(currentRender: IRender, workbook: Workbook, worksheet: Worksheet, skeletonParam: ISheetSkeletonManagerParam, offsetX: number, offsetY: number) {\n        const hoverPosition = getHoverCellPosition(currentRender, workbook, worksheet, skeletonParam, offsetX, offsetY);\n        const skeleton = skeletonParam.skeleton;\n        if (!hoverPosition) {\n            return null;\n        }\n\n        const { position, overflowLocation, location } = hoverPosition;\n\n        const font = skeleton.getFont(overflowLocation.row, overflowLocation.col);\n        let customRange: Nullable<{\n            rects: IBoundRectNoAngle[];\n            range: ICustomRange<Record<string, any>>;\n        }> = null;\n        let bullet: Nullable<{\n            rect: IBoundRectNoAngle;\n            paragraph: IParagraph;\n        }> = null;\n        let drawing: Nullable<{\n            rect: IBoundRectNoAngle;\n            drawingId: string;\n        }> = null;\n\n        const cell = skeleton.getCellWithCoordByIndex(overflowLocation.row, overflowLocation.col);\n        const cellData = worksheet.getCell(overflowLocation.row, overflowLocation.col);\n        const { topOffset = 0, leftOffset = 0 } = cellData?.fontRenderExtension ?? {};\n        if (font?.documentSkeleton) {\n            const { paddingLeft, paddingTop } = calcPadding(cell, font, (cellData?.v !== null && cellData?.v !== undefined) ? !Number.isNaN(+cellData.v) : false);\n            const rects = calculateDocSkeletonRects(font.documentSkeleton, paddingLeft, paddingTop);\n\n            const innerX = offsetX - position.startX - leftOffset;\n            const innerY = offsetY - position.startY - topOffset;\n            customRange = rects.links.find((link) => link.rects.some((rect) => rect.left <= innerX && innerX <= rect.right && (rect.top) <= innerY && innerY <= (rect.bottom)));\n            bullet = rects.checkLists.find((list) => list.rect.left <= innerX && innerX <= list.rect.right && (list.rect.top) <= innerY && innerY <= (list.rect.bottom));\n            drawing = rects.drawings.find((drawing) => drawing.rect.left <= innerX && innerX <= drawing.rect.right && (drawing.rect.top) <= innerY && innerY <= (drawing.rect.bottom));\n        }\n\n        const rect = customRange?.rects.pop() ?? bullet?.rect ?? drawing?.rect;\n        return {\n            location,\n            position,\n            overflowLocation,\n            customRange: customRange?.range,\n            bullet: bullet?.paragraph,\n            drawing: drawing?.drawingId,\n            rect: rect && {\n                top: rect.top + cell.mergeInfo.startY + topOffset,\n                bottom: rect.bottom + cell.mergeInfo.startY + topOffset,\n                left: rect.left + cell.mergeInfo.startX + leftOffset,\n                right: rect.right + cell.mergeInfo.startX + leftOffset,\n            },\n        };\n    }\n\n    private _calcActiveRowHeader(unitId: string, offsetX: number, offsetY: number) {\n        const deps = this._getCalcDeps(unitId);\n        if (!deps) {\n            return;\n        }\n        const { currentRender, worksheet, skeletonParam } = deps;\n        const { scaleY } = currentRender.scene.getAncestorScale();\n        const activeViewport = currentRender.scene.getViewports().find((v) => v.isHit(new Vector2(offsetX, offsetY)));\n        if (!activeViewport || (activeViewport.viewportKey !== SHEET_VIEWPORT_KEY.VIEW_ROW_TOP && activeViewport.viewportKey !== SHEET_VIEWPORT_KEY.VIEW_ROW_BOTTOM)) {\n            return;\n        }\n        const scrollXY = {\n            x: activeViewport.viewportScrollX,\n            y: activeViewport.viewportScrollY,\n        };\n\n        const index = skeletonParam.skeleton.getRowIndexByOffsetY(offsetY, scaleY, scrollXY);\n        return { unitId, index, subUnitId: worksheet.getSheetId() };\n    }\n\n    private _calcActiveColHeader(unitId: string, offsetX: number, offsetY: number) {\n        const deps = this._getCalcDeps(unitId);\n        if (!deps) {\n            return;\n        }\n        const { currentRender, worksheet, skeletonParam } = deps;\n        const { scaleX } = currentRender.scene.getAncestorScale();\n        const activeViewport = currentRender.scene.getViewports().find((v) => v.isHit(new Vector2(offsetX, offsetY)));\n        if (!activeViewport || (activeViewport.viewportKey !== SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT && activeViewport.viewportKey !== SHEET_VIEWPORT_KEY.VIEW_COLUMN_RIGHT)) {\n            return;\n        }\n        const scrollXY = {\n            x: activeViewport.viewportScrollX,\n            y: activeViewport.viewportScrollY,\n        };\n\n        const index = skeletonParam.skeleton.getColumnIndexByOffsetX(offsetX, scaleX, scrollXY);\n        return { unitId, index, subUnitId: worksheet.getSheetId() };\n    }\n\n    triggerPointerDown(unitId: string, event: IPointerEvent | IMouseEvent) {\n        const deps = this._getCalcDeps(unitId);\n        if (!deps) {\n            return;\n        }\n        const { currentRender, workbook, worksheet, skeletonParam } = deps;\n        const activeCell = this._calcActiveCell(currentRender, workbook, worksheet, skeletonParam, event.offsetX, event.offsetY);\n        if (activeCell && activeCell.location) {\n            const { unitId, subUnitId, row, col } = getLocationBase(activeCell.location);\n            this._currentPointerDownCell$.next({\n                unitId,\n                subUnitId,\n                row,\n                col,\n                event,\n            });\n        }\n    }\n\n    triggerPointerUp(unitId: string, event: IPointerEvent | IMouseEvent) {\n        const deps = this._getCalcDeps(unitId);\n        if (!deps) {\n            return;\n        }\n        const { currentRender, workbook, worksheet, skeletonParam } = deps;\n        const activeCell = this._calcActiveCell(currentRender, workbook, worksheet, skeletonParam, event.offsetX, event.offsetY);\n\n        if (activeCell) {\n            const location = getLocationBase(activeCell.location);\n            this._currentPointerUpCell$.next({\n                ...location,\n                event,\n            });\n        }\n    }\n\n    triggerMouseMove(unitId: string, event: IPointerEvent | IMouseEvent) {\n        const deps = this._getCalcDeps(unitId);\n        if (!deps) {\n            return;\n        }\n        const { currentRender, workbook, worksheet, skeletonParam } = deps;\n        const activeCell = this._calcActiveCell(currentRender, workbook, worksheet, skeletonParam, event.offsetX, event.offsetY);\n\n        this._currentCell$.next(activeCell && {\n            location: getLocationBase(activeCell.location),\n            position: activeCell.position,\n        });\n\n        this._currentRichText$.next(activeCell && {\n            ...activeCell,\n            location: getLocationBase(activeCell.overflowLocation),\n        });\n\n        this._currentCellWithEvent$.next(activeCell && {\n            ...activeCell,\n            location: getLocationBase(activeCell.location),\n            event,\n        });\n    }\n\n    /**\n     * Trigger by pointerup.\n     * @param unitId\n     * @param offsetX\n     * @param offsetY\n     */\n    triggerClick(unitId: string, offsetX: number, offsetY: number) {\n        const deps = this._getCalcDeps(unitId);\n        if (!deps) {\n            return;\n        }\n        const { currentRender, workbook, worksheet, skeletonParam } = deps;\n        const activeCell = this._calcActiveCell(currentRender, workbook, worksheet, skeletonParam, offsetX, offsetY);\n        if (activeCell) {\n            this._currentClickedCell$.next({\n                ...activeCell,\n                location: getLocationBase(activeCell.location),\n            });\n        }\n    }\n\n    triggerDbClick(unitId: string, offsetX: number, offsetY: number) {\n        const deps = this._getCalcDeps(unitId);\n        if (!deps) {\n            return;\n        }\n        const { currentRender, workbook, worksheet, skeletonParam } = deps;\n        const activeCell = this._calcActiveCell(currentRender, workbook, worksheet, skeletonParam, offsetX, offsetY);\n        if (activeCell) {\n            this._currentDbClickedCell$.next({\n                ...activeCell,\n                location: getLocationBase(activeCell.location),\n            });\n        }\n    }\n\n    triggerScroll() {\n        this._currentCell$.next(null);\n    }\n\n    triggerRowHeaderClick(unitId: string, offsetX: number, offsetY: number) {\n        const pos = this._calcActiveRowHeader(unitId, offsetX, offsetY);\n        pos && this._currentRowHeaderClick$.next(pos);\n    }\n\n    triggerColHeaderClick(unitId: string, offsetX: number, offsetY: number) {\n        const pos = this._calcActiveColHeader(unitId, offsetX, offsetY);\n        pos && this._currentColHeaderClick$.next(pos);\n    }\n\n    triggerRowHeaderDbClick(unitId: string, offsetX: number, offsetY: number) {\n        const pos = this._calcActiveRowHeader(unitId, offsetX, offsetY);\n        pos && this._currentRowHeaderDbClick$.next(pos);\n    }\n\n    triggerColHeaderDbClick(unitId: string, offsetX: number, offsetY: number) {\n        const pos = this._calcActiveColHeader(unitId, offsetX, offsetY);\n        pos && this._currentColHeaderDbClick$.next(pos);\n    }\n\n    triggerRowHeaderMouseMove(unitId: string, offsetX: number, offsetY: number) {\n        this._currentHoveredRowHeader$.next(this._calcActiveRowHeader(unitId, offsetX, offsetY));\n    }\n\n    triggerColHeaderMouseMove(unitId: string, offsetX: number, offsetY: number) {\n        this._currentHoveredColHeader$.next(this._calcActiveColHeader(unitId, offsetX, offsetY));\n    }\n\n    triggerRowHeaderPoniterDown(unitId: string, offsetX: number, offsetY: number) {\n        const pos = this._calcActiveRowHeader(unitId, offsetX, offsetY);\n        pos && this._currentRowHeaderPointerDown$.next(pos);\n    }\n\n    triggerColHeaderPoniterDown(unitId: string, offsetX: number, offsetY: number) {\n        const pos = this._calcActiveColHeader(unitId, offsetX, offsetY);\n        pos && this._currentColHeaderPointerDown$.next(pos);\n    }\n\n    triggerRowHeaderPoniterUp(unitId: string, offsetX: number, offsetY: number) {\n        const pos = this._calcActiveRowHeader(unitId, offsetX, offsetY);\n        pos && this._currentRowHeaderPointerUp$.next(pos);\n    }\n\n    triggerColHeaderPoniterUp(unitId: string, offsetX: number, offsetY: number) {\n        const pos = this._calcActiveColHeader(unitId, offsetX, offsetY);\n        pos && this._currentColHeaderPointerUp$.next(pos);\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport type { IRenderContext, IRenderModule } from '@univerjs/engine-render';\nimport { CellValueType, Disposable, Inject, isRealNum, LocaleService } from '@univerjs/core';\nimport { IZenZoneService } from '@univerjs/ui';\nimport { CellAlertManagerService, CellAlertType } from '../services/cell-alert-manager.service';\nimport { HoverManagerService } from '../services/hover-manager.service';\n\nconst ALERT_KEY = 'SHEET_FORCE_STRING_ALERT';\n\nexport class ForceStringAlertRenderController extends Disposable implements IRenderModule {\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(HoverManagerService) private readonly _hoverManagerService: HoverManagerService,\n        @Inject(CellAlertManagerService) private readonly _cellAlertManagerService: CellAlertManagerService,\n        @Inject(LocaleService) private readonly _localeService: LocaleService,\n        @IZenZoneService private readonly _zenZoneService: IZenZoneService\n    ) {\n        super();\n        this._init();\n    }\n\n    private _init() {\n        this._initCellAlertPopup();\n        this._initZenService();\n    }\n\n    private _initCellAlertPopup() {\n        this.disposeWithMe(this._hoverManagerService.currentCell$.subscribe((cellPos) => {\n            if (cellPos) {\n                const workbook = this._context.unit;\n                const worksheet = workbook.getActiveSheet();\n\n                if (!worksheet) return;\n\n                const cellData = worksheet.getCell(cellPos.location.row, cellPos.location.col);\n\n                if (cellData?.t === CellValueType.FORCE_STRING && cellData.v && isRealNum(cellData.v)) {\n                    const currentAlert = this._cellAlertManagerService.currentAlert.get(ALERT_KEY);\n                    const currentLoc = currentAlert?.alert?.location;\n                    if (\n                        currentLoc &&\n                        currentLoc.row === cellPos.location.row &&\n                        currentLoc.col === cellPos.location.col &&\n                        currentLoc.subUnitId === cellPos.location.subUnitId &&\n                        currentLoc.unitId === cellPos.location.unitId\n                    ) {\n                        return;\n                    }\n\n                    this._cellAlertManagerService.showAlert({\n                        type: CellAlertType.ERROR,\n                        title: this._localeService.t('info.error'),\n                        message: this._localeService.t('info.forceStringInfo'),\n                        location: cellPos.location,\n                        width: 200,\n                        height: 74,\n                        key: ALERT_KEY,\n                    });\n                    return;\n                }\n            }\n\n            this._hideAlert();\n        }));\n    }\n\n    private _initZenService() {\n        this.disposeWithMe(this._zenZoneService.visible$.subscribe((visible) => {\n            if (visible) {\n                this._hideAlert();\n            }\n        }));\n    }\n\n    private _hideAlert() {\n        this._cellAlertManagerService.removeAlert(ALERT_KEY);\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport type { IRenderContext, IRenderModule } from '@univerjs/engine-render';\nimport { CellValueType, Inject, InterceptorEffectEnum, isRealNum, RxDisposable } from '@univerjs/core';\nimport { INTERCEPTOR_POINT, SheetInterceptorService } from '@univerjs/sheets';\nimport { SheetSkeletonManagerService } from '../services/sheet-skeleton-manager.service';\n\nexport class ForceStringRenderController extends RxDisposable implements IRenderModule {\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(SheetSkeletonManagerService) private readonly _sheetSkeletonManagerService: SheetSkeletonManagerService,\n        @Inject(SheetInterceptorService) private readonly _sheetInterceptorService: SheetInterceptorService\n    ) {\n        super();\n\n        this._initViewModelIntercept();\n    }\n\n    private _initViewModelIntercept() {\n        const FORCE_STRING_MARK = {\n            tl: {\n                size: 6,\n                color: '#409f11',\n            },\n        };\n\n        this.disposeWithMe(\n            this._sheetInterceptorService.intercept(\n                INTERCEPTOR_POINT.CELL_CONTENT,\n                {\n                    priority: 10,\n                    effect: InterceptorEffectEnum.Style,\n                    handler: (cell, pos, next) => {\n                        const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n                        if (!skeleton) {\n                            return next(cell);\n                        }\n\n                        const cellRaw = pos.worksheet.getCellRaw(pos.row, pos.col);\n\n                        if (!cellRaw || cellRaw.v === null || cellRaw.v === undefined) {\n                            return next(cell);\n                        }\n\n                        if (cell?.t === CellValueType.FORCE_STRING && isRealNum(cellRaw.v)) {\n                            return next({\n                                ...cell,\n                                markers: {\n                                    ...cell?.markers,\n                                    ...FORCE_STRING_MARK,\n                                },\n                            });\n                        }\n\n                        return next(cell);\n                    },\n                }\n            )\n        );\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Nullable, Workbook } from '@univerjs/core';\nimport type { IRenderContext, IRenderModule } from '@univerjs/engine-render';\nimport type { ISheetSkeletonManagerParam } from '../services/sheet-skeleton-manager.service';\nimport { Disposable, DisposableCollection, fromEventSubject, Inject } from '@univerjs/core';\nimport { SHEET_VIEW_KEY } from '../common/keys';\nimport { HoverManagerService } from '../services/hover-manager.service';\nimport { SheetScrollManagerService } from '../services/scroll-manager.service';\nimport { SheetSkeletonManagerService } from '../services/sheet-skeleton-manager.service';\n\nexport class HoverRenderController extends Disposable implements IRenderModule {\n    private _active = false;\n\n    get active() {\n        return this._active;\n    }\n\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(HoverManagerService) private _hoverManagerService: HoverManagerService,\n        @Inject(SheetSkeletonManagerService) private _sheetSkeletonManagerService: SheetSkeletonManagerService,\n        @Inject(SheetScrollManagerService) private _scrollManagerService: SheetScrollManagerService\n    ) {\n        super();\n\n        this._initPointerEvent();\n        this._initScrollEvent();\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    private _initPointerEvent() {\n        const disposeSet = new DisposableCollection();\n        const handleSkeletonChange = (skeletonParam: Nullable<ISheetSkeletonManagerParam>) => {\n            disposeSet.dispose();\n\n            if (!skeletonParam) {\n                return;\n            }\n\n            const { mainComponent, unitId, components } = this._context;\n            if (!mainComponent) {\n                return;\n            }\n\n            disposeSet.add(mainComponent.onPointerEnter$.subscribeEvent((evt) => {\n                this._active = true;\n            }));\n\n            disposeSet.add(fromEventSubject(mainComponent.onPointerMove$).subscribe((evt) => {\n                this._active = true;\n                this._hoverManagerService.triggerMouseMove(unitId, evt);\n            }));\n\n            disposeSet.add(mainComponent.onPointerDown$.subscribeEvent((evt) => {\n                this._hoverManagerService.triggerPointerDown(unitId, evt);\n            }));\n\n            disposeSet.add(mainComponent.onPointerUp$.subscribeEvent((evt) => {\n                this._hoverManagerService.triggerPointerUp(unitId, evt);\n                this._hoverManagerService.triggerClick(unitId, evt.offsetX, evt.offsetY);\n            }));\n\n            disposeSet.add(mainComponent.onDblclick$.subscribeEvent((evt) => {\n                this._hoverManagerService.triggerDbClick(unitId, evt.offsetX, evt.offsetY);\n            }));\n\n            disposeSet.add(mainComponent.onPointerLeave$.subscribeEvent(() => {\n                this._active = false;\n            }));\n\n            const rowHeader = components.get(SHEET_VIEW_KEY.ROW);\n            const colHeader = components.get(SHEET_VIEW_KEY.COLUMN);\n            if (rowHeader) {\n                disposeSet.add(rowHeader.onPointerMove$.subscribeEvent((evt) => {\n                    this._hoverManagerService.triggerRowHeaderMouseMove(unitId, evt.offsetX, evt.offsetY);\n                }));\n\n                disposeSet.add(rowHeader.onPointerDown$.subscribeEvent((evt) => {\n                    this._hoverManagerService.triggerRowHeaderPoniterDown(unitId, evt.offsetX, evt.offsetY);\n                }));\n\n                disposeSet.add(rowHeader.onPointerUp$.subscribeEvent((evt) => {\n                    this._hoverManagerService.triggerRowHeaderPoniterUp(unitId, evt.offsetX, evt.offsetY);\n                    this._hoverManagerService.triggerRowHeaderClick(unitId, evt.offsetX, evt.offsetY);\n                }));\n\n                disposeSet.add(rowHeader.onDblclick$.subscribeEvent((evt) => {\n                    this._hoverManagerService.triggerRowHeaderDbClick(unitId, evt.offsetX, evt.offsetY);\n                }));\n            }\n\n            if (colHeader) {\n                disposeSet.add(colHeader.onPointerMove$.subscribeEvent((evt) => {\n                    this._hoverManagerService.triggerColHeaderMouseMove(unitId, evt.offsetX, evt.offsetY);\n                }));\n\n                disposeSet.add(colHeader.onPointerDown$.subscribeEvent((evt) => {\n                    this._hoverManagerService.triggerColHeaderPoniterDown(unitId, evt.offsetX, evt.offsetY);\n                }));\n\n                disposeSet.add(colHeader.onPointerUp$.subscribeEvent((evt) => {\n                    this._hoverManagerService.triggerColHeaderPoniterUp(unitId, evt.offsetX, evt.offsetY);\n                    this._hoverManagerService.triggerColHeaderClick(unitId, evt.offsetX, evt.offsetY);\n                }));\n\n                disposeSet.add(colHeader.onDblclick$.subscribeEvent((evt) => {\n                    this._hoverManagerService.triggerColHeaderDbClick(unitId, evt.offsetX, evt.offsetY);\n                }));\n            }\n        };\n\n        handleSkeletonChange(this._sheetSkeletonManagerService.getCurrentParam());\n        this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((skeletonParam) => {\n            handleSkeletonChange(skeletonParam);\n        }));\n    }\n\n    private _initScrollEvent() {\n        this.disposeWithMe(this._scrollManagerService.validViewportScrollInfo$.subscribe(() => this._hoverManagerService.triggerScroll()));\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommandInfo, Workbook } from '@univerjs/core';\nimport type { IRenderContext, IRenderModule } from '@univerjs/engine-render';\n\nimport { Disposable, ICommandService, Inject } from '@univerjs/core';\nimport { SetCellEditVisibleOperation } from '../commands/operations/cell-edit.operation';\nimport { IMarkSelectionService } from '../services/mark-selection/mark-selection.service';\nimport { SheetSkeletonManagerService } from '../services/sheet-skeleton-manager.service';\n\nexport class MarkSelectionRenderController extends Disposable implements IRenderModule {\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(IMarkSelectionService) private _markSelectionService: IMarkSelectionService,\n        @ICommandService private _commandService: ICommandService,\n        @Inject(SheetSkeletonManagerService) private _sheetSkeletonManagerService: SheetSkeletonManagerService\n    ) {\n        super();\n        this._initListeners();\n    }\n\n    private _initListeners() {\n        this._addRemoveListener();\n        this._addRefreshListener();\n    }\n\n    private _addRemoveListener() {\n        const removeCommands = [SetCellEditVisibleOperation.id];\n        this.disposeWithMe(\n            this._commandService.onCommandExecuted((command: ICommandInfo) => {\n                if (removeCommands.includes(command.id)) {\n                    this._markSelectionService.removeAllShapes();\n                } else {\n                    const shapes = this._markSelectionService.getShapeMap();\n                    shapes.forEach((shape, id) => {\n                        if (shape.exits.includes(command.id)) {\n                            this._markSelectionService.removeShape(id);\n                        }\n                    });\n                }\n            })\n        );\n    }\n\n    private _addRefreshListener() {\n        this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((skeleton) => {\n            if (skeleton) {\n                this._markSelectionService.refreshShapes();\n            }\n        }));\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommandInfo, Workbook } from '@univerjs/core';\nimport type { ISetWorksheetActiveOperationParams } from '@univerjs/sheets';\nimport type { IBaseSheetBarProps } from '../../sheet-bar/sheet-bar-tabs/SheetBarItem';\nimport { ICommandService } from '@univerjs/core';\nimport { clsx } from '@univerjs/design';\nimport {\n    InsertSheetMutation,\n    RemoveSheetMutation,\n    SetWorksheetActiveOperation,\n    SetWorksheetHideMutation,\n    SetWorksheetNameMutation,\n    SetWorksheetOrderMutation,\n} from '@univerjs/sheets';\nimport { useDependency } from '@univerjs/ui';\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport { useActiveWorkbook } from '../../../components/hook';\nimport styles from './index.module.less';\n\nexport function MobileSheetBar() {\n    const workbook = useActiveWorkbook();\n    if (!workbook) {\n        return null;\n    }\n\n    return <MobileSheetBarImpl workbook={workbook} />;\n}\n\nfunction MobileSheetBarImpl(props: { workbook: Workbook }) {\n    const { workbook } = props;\n    const [sheetList, setSheetList] = useState<IBaseSheetBarProps[]>([]);\n    const [activeKey, setActiveKey] = useState('');\n    const tabMapRef = useRef<Map<string, HTMLElement | null>>(new Map());\n\n    const commandService = useDependency(ICommandService);\n\n    const updateSheetItems = useCallback(() => {\n        const currentSubUnitId = workbook.getActiveSheet()!.getSheetId();\n        const sheets = workbook.getSheets();\n        const activeSheet = workbook.getActiveSheet();\n        const sheetListItems = sheets\n            .filter((sheet) => !sheet.isSheetHidden())\n            .map((sheet, index) => {\n                return {\n                    sheetId: sheet.getSheetId(),\n                    label: sheet.getName(),\n                    index,\n                    selected: activeSheet === sheet,\n                    color: sheet.getTabColor() ?? undefined,\n                };\n            });\n\n        setSheetList(sheetListItems);\n        setActiveKey(currentSubUnitId);\n\n        if (tabMapRef.current.has(currentSubUnitId)) {\n            const element = tabMapRef.current.get(currentSubUnitId);\n            if (element) {\n                element.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\n            }\n        }\n\n        tabMapRef.current.clear();\n    }, [workbook]);\n\n    useEffect(() => updateSheetItems(), [updateSheetItems]);\n\n    const onTabClick = useCallback((sheetId: string) => {\n        commandService.executeCommand(SetWorksheetActiveOperation.id, {\n            unitId: workbook.getUnitId(),\n            subUnitId: sheetId,\n        } as ISetWorksheetActiveOperationParams);\n    }, [commandService, workbook]);\n\n    useEffect(() => {\n        const disposable = commandService.onCommandExecuted((commandInfo: ICommandInfo) => {\n            switch (commandInfo.id) {\n                case SetWorksheetHideMutation.id:\n                case RemoveSheetMutation.id:\n                case SetWorksheetNameMutation.id:\n                case InsertSheetMutation.id:\n                case SetWorksheetOrderMutation.id:\n                case SetWorksheetActiveOperation.id:\n                    updateSheetItems();\n                    break;\n                default:\n                    break;\n            }\n        });\n\n        return () => disposable.dispose();\n    }, [commandService, updateSheetItems]);\n\n    return (\n        <div className={styles.mobileSheetBarContainer}>\n            <div className={styles.mobileSheetBarSlider}>\n                {sheetList.map((sheet) => (\n                    <div\n                        className={clsx(\n                            styles.mobileSheetBarItem,\n                            {\n                                [styles.mobileSheetBarItemActivated]: sheet.sheetId === activeKey,\n                            }\n                        )}\n                        key={sheet.sheetId}\n                        onClick={() => onTabClick(sheet.sheetId!)}\n                        ref={(element) => {\n                            tabMapRef.current.set(sheet.sheetId!, element);\n                        }}\n                    >\n                        {sheet.label}\n                    </div>\n                ))}\n            </div>\n        </div>\n    );\n}\n", "export default {\n  \"mobileSheetBarContainer\": \"univer-mobile-sheet-bar-container\",\n  \"mobileSheetBarSlider\": \"univer-mobile-sheet-bar-slider\",\n  \"mobileSheetBarItem\": \"univer-mobile-sheet-bar-item\",\n  \"mobileSheetBarItemActivated\": \"univer-mobile-sheet-bar-item-activated\"\n};import \"ni:sha-256;0KW7tPyuuPXfirZOmixM35hykQBMPKrpTsu8qY_WgQg\";", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { MenuSchemaType } from '@univerjs/ui';\nimport { ContextMenuGroup, ContextMenuPosition } from '@univerjs/ui';\nimport {\n    SheetCopyCommand,\n} from '../../commands/commands/clipboard.command';\nimport { CopyMenuItemFactory } from '../menu/menu';\n\nexport const menuSchema: MenuSchemaType = {\n    [ContextMenuPosition.MAIN_AREA]: {\n        [ContextMenuGroup.FORMAT]: {\n            [SheetCopyCommand.name]: {\n                order: 0,\n                menuItemFactory: CopyMenuItemFactory,\n            },\n        },\n        [ContextMenuGroup.DATA]: {\n            order: 2,\n        },\n        [ContextMenuGroup.OTHERS]: {\n            order: 3,\n        },\n    },\n    [ContextMenuPosition.COL_HEADER]: {\n        [ContextMenuGroup.FORMAT]: {\n            [SheetCopyCommand.name]: {\n                order: 0,\n                menuItemFactory: CopyMenuItemFactory,\n            },\n        },\n        [ContextMenuGroup.LAYOUT]: {\n            order: 1,\n        },\n        [ContextMenuGroup.DATA]: {\n            order: 2,\n        },\n        [ContextMenuGroup.OTHERS]: {\n            order: 3,\n        },\n    },\n    [ContextMenuPosition.ROW_HEADER]: {\n        [ContextMenuGroup.FORMAT]: {\n            [SheetCopyCommand.name]: {\n                order: 0,\n                menuItemFactory: CopyMenuItemFactory,\n            },\n        },\n        [ContextMenuGroup.LAYOUT]: {\n            order: 1,\n        },\n        [ContextMenuGroup.DATA]: {\n            order: 2,\n        },\n        [ContextMenuGroup.OTHERS]: {\n            order: 3,\n        },\n    },\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Disposable, ICommandService, Inject, Injector, UniverInstanceType } from '@univerjs/core';\nimport {\n    SetBoldCommand,\n    SetFontFamilyCommand,\n    SetFontSizeCommand,\n    SetItalicCommand,\n    SetStrikeThroughCommand,\n    SetUnderlineCommand,\n} from '@univerjs/sheets';\nimport { BuiltInUIPart, ComponentManager, connectInjector, ILayoutService, IMenuManagerService, IShortcutService, IUIPartsService } from '@univerjs/ui';\n\nimport {\n    AddWorksheetMergeAllCommand,\n    AddWorksheetMergeCommand,\n    AddWorksheetMergeHorizontalCommand,\n    AddWorksheetMergeVerticalCommand,\n} from '../../commands/commands/add-worksheet-merge.command';\nimport { AutoClearContentCommand, AutoFillCommand } from '../../commands/commands/auto-fill.command';\nimport { DeleteRangeMoveLeftConfirmCommand } from '../../commands/commands/delete-range-move-left-confirm.command';\nimport { DeleteRangeMoveUpConfirmCommand } from '../../commands/commands/delete-range-move-up-confirm.command';\nimport { HideColConfirmCommand, HideRowConfirmCommand } from '../../commands/commands/hide-row-col-confirm.command';\nimport {\n    SetRangeBoldCommand,\n    SetRangeFontFamilyCommand,\n    SetRangeFontSizeCommand,\n    SetRangeItalicCommand,\n    SetRangeStrickThroughCommand,\n    SetRangeSubscriptCommand,\n    SetRangeSuperscriptCommand,\n    SetRangeTextColorCommand,\n    SetRangeUnderlineCommand,\n} from '../../commands/commands/inline-format.command';\nimport { InsertRangeMoveDownConfirmCommand } from '../../commands/commands/insert-range-move-down-confirm.command';\nimport { InsertRangeMoveRightConfirmCommand } from '../../commands/commands/insert-range-move-right-confirm.command';\nimport { AddRangeProtectionFromContextMenuCommand, AddRangeProtectionFromSheetBarCommand, AddRangeProtectionFromToolbarCommand, DeleteRangeProtectionFromContextMenuCommand, SetRangeProtectionFromContextMenuCommand, ViewSheetPermissionFromContextMenuCommand, ViewSheetPermissionFromSheetBarCommand } from '../../commands/commands/range-protection.command';\nimport { RefillCommand } from '../../commands/commands/refill.command';\nimport { RemoveColConfirmCommand, RemoveRowConfirmCommand } from '../../commands/commands/remove-row-col-confirm.command';\nimport { RemoveSheetConfirmCommand } from '../../commands/commands/remove-sheet-confirm.command';\nimport {\n    ApplyFormatPainterCommand,\n    SetInfiniteFormatPainterCommand,\n    SetOnceFormatPainterCommand,\n} from '../../commands/commands/set-format-painter.command';\nimport {\n    SetColumnFrozenCommand,\n    SetRowFrozenCommand,\n    SetSelectionFrozenCommand,\n} from '../../commands/commands/set-frozen.command';\nimport { ScrollCommand, ScrollToCellCommand, SetScrollRelativeCommand } from '../../commands/commands/set-scroll.command';\nimport {\n    ExpandSelectionCommand,\n    MoveSelectionCommand,\n    MoveSelectionEnterAndTabCommand,\n    SelectAllCommand,\n} from '../../commands/commands/set-selection.command';\nimport { ChangeZoomRatioCommand, SetZoomRatioCommand } from '../../commands/commands/set-zoom-ratio.command';\nimport { ShowMenuListCommand } from '../../commands/commands/unhide.command';\nimport { ChangeSheetProtectionFromSheetBarCommand, DeleteWorksheetProtectionFormSheetBarCommand } from '../../commands/commands/worksheet-protection.command';\nimport { SetActivateCellEditOperation } from '../../commands/operations/activate-cell-edit.operation';\nimport {\n    SetCellEditVisibleArrowOperation,\n    SetCellEditVisibleOperation,\n    SetCellEditVisibleWithF2Operation,\n} from '../../commands/operations/cell-edit.operation';\nimport { RenameSheetOperation } from '../../commands/operations/rename-sheet.operation';\nimport { SetScrollOperation } from '../../commands/operations/scroll.operation';\nimport { SetFormatPainterOperation } from '../../commands/operations/set-format-painter.operation';\nimport { SetZoomRatioOperation } from '../../commands/operations/set-zoom-ratio.operation';\nimport { SheetPermissionOpenDialogOperation } from '../../commands/operations/sheet-permission-open-dialog.operation';\nimport { SheetPermissionOpenPanelOperation } from '../../commands/operations/sheet-permission-open-panel.operation';\nimport { SidebarDefinedNameOperation } from '../../commands/operations/sidebar-defined-name.operation';\nimport { BorderPanel } from '../../components/border-panel/BorderPanel';\nimport { BORDER_PANEL_COMPONENT } from '../../components/border-panel/interface';\nimport { COLOR_PICKER_COMPONENT, ColorPicker } from '../../components/color-picker';\nimport {\n    FONT_FAMILY_COMPONENT,\n    FONT_FAMILY_ITEM_COMPONENT,\n    FontFamily,\n    FontFamilyItem,\n} from '../../components/font-family';\n\nimport { FONT_SIZE_COMPONENT, FontSize } from '../../components/font-size';\nimport { MENU_ITEM_INPUT_COMPONENT, MenuItemInput } from '../../components/menu-item-input';\nimport { DEFINED_NAME_CONTAINER } from '../../views/defined-name/component-name';\nimport { DefinedNameContainer } from '../../views/defined-name/DefinedNameContainer';\n\nimport { MobileSheetBar } from '../../views/mobile/sheet-bar/MobileSheetBar';\nimport {\n    EditorBreakLineShortcut,\n    EditorCursorEnterShortcut,\n    EditorCursorEscShortcut,\n    EditorCursorTabShortcut,\n    EditorDeleteLeftShortcut,\n    EditorDeleteLeftShortcutInActive,\n    generateArrowSelectionShortCutItem,\n    StartEditWithF2Shortcut,\n} from '../shortcuts/editor.shortcut';\nimport { SetColHiddenShortcutItem, SetRowHiddenShortcutItem } from '../shortcuts/operation.shortcut';\nimport {\n    ExpandSelectionDownShortcutItem,\n    ExpandSelectionEndDownShortcutItem,\n    ExpandSelectionEndLeftShortcutItem,\n    ExpandSelectionEndRightShortcutItem,\n    ExpandSelectionEndUpShortcutItem,\n    ExpandSelectionLeftShortcutItem,\n    ExpandSelectionRightShortcutItem,\n    ExpandSelectionUpShortcutItem,\n    // MoveBackSelectionShortcutItem,\n    MoveSelectionDownShortcutItem,\n    MoveSelectionEndDownShortcutItem,\n    MoveSelectionEndLeftShortcutItem,\n    MoveSelectionEndRightShortcutItem,\n    MoveSelectionEndUpShortcutItem,\n    MoveSelectionEnterShortcutItem,\n    MoveSelectionEnterUpShortcutItem,\n    MoveSelectionLeftShortcutItem,\n    MoveSelectionRightShortcutItem,\n    MoveSelectionTabLeftShortcutItem,\n    MoveSelectionTabShortcutItem,\n    MoveSelectionUpShortcutItem,\n    SelectAllShortcutItem,\n} from '../shortcuts/selection.shortcut';\nimport {\n    SetBoldShortcutItem,\n    SetItalicShortcutItem,\n    SetStrikeThroughShortcutItem,\n    SetUnderlineShortcutItem,\n} from '../shortcuts/style.shortcut';\nimport { ClearSelectionValueShortcutItem } from '../shortcuts/value.shortcut';\nimport {\n    PreventDefaultResetZoomShortcutItem,\n    PreventDefaultZoomInShortcutItem,\n    PreventDefaultZoomOutShortcutItem,\n    ResetZoomShortcutItem,\n    ZoomInShortcutItem,\n    ZoomOutShortcutItem,\n} from '../shortcuts/view.shortcut';\nimport { menuSchema } from './menu.schema';\n\nexport class SheetUIMobileController extends Disposable {\n    constructor(\n        @Inject(Injector) private readonly _injector: Injector,\n        @Inject(ComponentManager) private readonly _componentManager: ComponentManager,\n        @ILayoutService private readonly _layoutService: ILayoutService,\n        @ICommandService private readonly _commandService: ICommandService,\n        @IShortcutService private readonly _shortcutService: IShortcutService,\n        @IMenuManagerService protected readonly _menuManagerService: IMenuManagerService,\n        @IUIPartsService private readonly _uiPartsService: IUIPartsService\n    ) {\n        super();\n\n        this._init();\n    }\n\n    private _init(): void {\n        this._initCustomComponents();\n        this._initCommands();\n        this._initMenus();\n        this._initShortcuts();\n        this._initWorkbenchParts();\n        this._initFocusHandler();\n    }\n\n    private _initCustomComponents(): void {\n        const componentManager = this._componentManager;\n        this.disposeWithMe(componentManager.register(MENU_ITEM_INPUT_COMPONENT, MenuItemInput));\n        this.disposeWithMe(componentManager.register(BORDER_PANEL_COMPONENT, BorderPanel));\n        this.disposeWithMe(componentManager.register(COLOR_PICKER_COMPONENT, ColorPicker));\n        this.disposeWithMe(componentManager.register(FONT_FAMILY_COMPONENT, FontFamily));\n        this.disposeWithMe(componentManager.register(FONT_FAMILY_ITEM_COMPONENT, FontFamilyItem));\n        this.disposeWithMe(componentManager.register(FONT_SIZE_COMPONENT, FontSize));\n        this.disposeWithMe(componentManager.register(DEFINED_NAME_CONTAINER, DefinedNameContainer));\n    }\n\n    private _initCommands(): void {\n        [\n            AddWorksheetMergeAllCommand,\n            AddWorksheetMergeCommand,\n            AddWorksheetMergeHorizontalCommand,\n            AddWorksheetMergeVerticalCommand,\n            ChangeZoomRatioCommand,\n            ExpandSelectionCommand,\n            MoveSelectionCommand,\n            MoveSelectionEnterAndTabCommand,\n            RenameSheetOperation,\n            RemoveSheetConfirmCommand,\n            RemoveRowConfirmCommand,\n            RemoveColConfirmCommand,\n            HideRowConfirmCommand,\n            HideColConfirmCommand,\n            ScrollCommand,\n            ScrollToCellCommand,\n            SelectAllCommand,\n            SetActivateCellEditOperation,\n            SetBoldCommand,\n            SetCellEditVisibleArrowOperation,\n            SetCellEditVisibleOperation,\n            SetCellEditVisibleWithF2Operation,\n            SetRangeBoldCommand,\n            SetRangeItalicCommand,\n            SetRangeUnderlineCommand,\n            SetRangeStrickThroughCommand,\n            SetRangeSubscriptCommand,\n            SetRangeSuperscriptCommand,\n            SetRangeFontSizeCommand,\n            SetRangeFontFamilyCommand,\n            SetRangeTextColorCommand,\n            SetItalicCommand,\n            SetStrikeThroughCommand,\n            SetFontFamilyCommand,\n            SetFontSizeCommand,\n            SetFormatPainterOperation,\n            SetInfiniteFormatPainterCommand,\n            SetOnceFormatPainterCommand,\n            ApplyFormatPainterCommand,\n            SetScrollOperation,\n            SetScrollRelativeCommand,\n            SetSelectionFrozenCommand,\n            SetRowFrozenCommand,\n            SetColumnFrozenCommand,\n            SetUnderlineCommand,\n            SetZoomRatioCommand,\n            SetZoomRatioOperation,\n            ShowMenuListCommand,\n            RefillCommand,\n            InsertRangeMoveDownConfirmCommand,\n            DeleteRangeMoveUpConfirmCommand,\n            InsertRangeMoveRightConfirmCommand,\n            DeleteRangeMoveLeftConfirmCommand,\n            SidebarDefinedNameOperation,\n            AutoFillCommand,\n            AutoClearContentCommand,\n\n            // permission\n            SheetPermissionOpenPanelOperation,\n            SheetPermissionOpenDialogOperation,\n            AddRangeProtectionFromToolbarCommand,\n            AddRangeProtectionFromContextMenuCommand,\n            ViewSheetPermissionFromContextMenuCommand,\n            AddRangeProtectionFromSheetBarCommand,\n            ViewSheetPermissionFromSheetBarCommand,\n            ChangeSheetProtectionFromSheetBarCommand,\n            DeleteRangeProtectionFromContextMenuCommand,\n            SetRangeProtectionFromContextMenuCommand,\n            DeleteWorksheetProtectionFormSheetBarCommand,\n        ].forEach((c) => {\n            this.disposeWithMe(this._commandService.registerCommand(c));\n        });\n    }\n\n    private _initMenus(): void {\n        this._menuManagerService.mergeMenu(menuSchema);\n    }\n\n    private _initShortcuts(): void {\n        [\n            // selection shortcuts\n            MoveSelectionDownShortcutItem,\n            MoveSelectionUpShortcutItem,\n            MoveSelectionLeftShortcutItem,\n            MoveSelectionRightShortcutItem,\n            MoveSelectionTabShortcutItem,\n            MoveSelectionTabLeftShortcutItem,\n            MoveSelectionEnterShortcutItem,\n            MoveSelectionEnterUpShortcutItem,\n            // MoveBackSelectionShortcutItem,\n            MoveSelectionEndDownShortcutItem,\n            MoveSelectionEndUpShortcutItem,\n            MoveSelectionEndLeftShortcutItem,\n            MoveSelectionEndRightShortcutItem,\n            ExpandSelectionDownShortcutItem,\n            ExpandSelectionUpShortcutItem,\n            ExpandSelectionLeftShortcutItem,\n            ExpandSelectionRightShortcutItem,\n            ExpandSelectionEndDownShortcutItem,\n            ExpandSelectionEndUpShortcutItem,\n            ExpandSelectionEndLeftShortcutItem,\n            ExpandSelectionEndRightShortcutItem,\n            SelectAllShortcutItem,\n\n            // view shortcuts\n            ZoomInShortcutItem,\n            ZoomOutShortcutItem,\n            ResetZoomShortcutItem,\n            PreventDefaultResetZoomShortcutItem,\n            PreventDefaultZoomInShortcutItem,\n            PreventDefaultZoomOutShortcutItem,\n\n            // toggle cell style shortcuts\n            SetBoldShortcutItem,\n            SetItalicShortcutItem,\n            SetUnderlineShortcutItem,\n            SetStrikeThroughShortcutItem,\n\n            // cell content editing shortcuts\n            ClearSelectionValueShortcutItem,\n            ...generateArrowSelectionShortCutItem(),\n            EditorCursorEnterShortcut,\n            StartEditWithF2Shortcut,\n            EditorCursorTabShortcut,\n            EditorBreakLineShortcut,\n            EditorDeleteLeftShortcut,\n            EditorDeleteLeftShortcutInActive,\n            EditorCursorEscShortcut,\n\n            // operation shortcuts\n            SetRowHiddenShortcutItem,\n            SetColHiddenShortcutItem,\n        ].forEach((item) => {\n            this.disposeWithMe(this._shortcutService.registerShortcut(item));\n        });\n    }\n\n    private _initWorkbenchParts(): void {\n        this._uiPartsService.registerComponent(BuiltInUIPart.HEADER, () => connectInjector(MobileSheetBar, this._injector));\n    }\n\n    private _initFocusHandler(): void {\n        this.disposeWithMe(\n            this._layoutService.registerFocusHandler(UniverInstanceType.UNIVER_SHEET, (_unitId: string) => {\n                // TODO@wzhudev: focus is different on mobile devices\n            })\n        );\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const UNIVER_SHEET_PERMISSION_ALERT_DIALOG_ID = 'UNIVER_SHEET_PERMISSION_ALERT_DIALOG_ID';\nexport const UNIVER_SHEET_PERMISSION_ALERT_DIALOG = 'UNIVER_SHEET_PERMISSION_ALERT_DIALOG';\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable complexity */\n/* eslint-disable max-lines-per-function */\n\nimport type { ICellDataForSheetInterceptor, ICommandInfo, IRange, Workbook } from '@univerjs/core';\nimport type { IMoveColsCommandParams, IMoveRangeCommandParams, IMoveRowsCommandParams, ISetRangeValuesCommandParams, ISetSpecificRowsVisibleCommandParams } from '@univerjs/sheets';\nimport type { IAutoFillCommandParams } from '../../commands/commands/auto-fill.command';\nimport type { ISheetPasteParams } from '../../commands/commands/clipboard.command';\nimport type { IEditorBridgeServiceVisibleParam } from '../../services/editor-bridge.service';\nimport { Disposable, DisposableCollection, FOCUSING_EDITOR_STANDALONE, ICommandService, IContextService, Inject, IPermissionService, IUniverInstanceService, LocaleService, Rectangle, UniverInstanceType } from '@univerjs/core';\nimport { IMEInputCommand, InsertCommand } from '@univerjs/docs-ui';\nimport { UnitAction } from '@univerjs/protocol';\nimport { getSheetCommandTarget, RangeProtectionPermissionEditPoint, RangeProtectionPermissionViewPoint, RangeProtectionRuleModel, SetBackgroundColorCommand, SheetPermissionCheckController, WorkbookCopyPermission, WorkbookEditablePermission, WorksheetCopyPermission, WorksheetEditPermission, WorksheetSetCellStylePermission, WorksheetSetCellValuePermission, WorksheetSetColumnStylePermission } from '@univerjs/sheets';\nimport { IDialogService } from '@univerjs/ui';\nimport { AutoFillCommand } from '../../commands/commands/auto-fill.command';\nimport { SheetCopyCommand, SheetCutCommand, SheetPasteColWidthCommand, SheetPasteShortKeyCommand } from '../../commands/commands/clipboard.command';\nimport { SetRangeBoldCommand, SetRangeItalicCommand, SetRangeStrickThroughCommand, SetRangeUnderlineCommand } from '../../commands/commands/inline-format.command';\nimport { ApplyFormatPainterCommand } from '../../commands/commands/set-format-painter.command';\nimport { SetCellEditVisibleOperation } from '../../commands/operations/cell-edit.operation';\nimport { IAutoFillService } from '../../services/auto-fill/auto-fill.service';\nimport { PREDEFINED_HOOK_NAME } from '../../services/clipboard/clipboard.service';\nimport { UNIVER_SHEET_PERMISSION_ALERT_DIALOG, UNIVER_SHEET_PERMISSION_ALERT_DIALOG_ID } from '../../views/permission/error-msg-dialog/interface';\n\ntype ICellPermission = Record<UnitAction, boolean> & { ruleId?: string; ranges?: IRange[] };\ntype ICheckPermissionCommandParams = IEditorBridgeServiceVisibleParam | IMoveRowsCommandParams | IMoveColsCommandParams | IMoveRangeCommandParams | ISetRangeValuesCommandParams | ISheetPasteParams | ISetSpecificRowsVisibleCommandParams | IAutoFillCommandParams;\n\nexport class SheetPermissionCheckUIController extends Disposable {\n    disposableCollection = new DisposableCollection();\n\n    constructor(\n        @ICommandService private readonly _commandService: ICommandService,\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService,\n        @IPermissionService private readonly _permissionService: IPermissionService,\n        @IDialogService private readonly _dialogService: IDialogService,\n        @Inject(RangeProtectionRuleModel) private _rangeProtectionRuleModel: RangeProtectionRuleModel,\n        @IAutoFillService private _autoFillService: IAutoFillService,\n        @Inject(LocaleService) private readonly _localeService: LocaleService,\n        @IContextService private readonly _contextService: IContextService,\n\n        @Inject(SheetPermissionCheckController) private readonly _sheetPermissionCheckController: SheetPermissionCheckController\n    ) {\n        super();\n        this._initialize();\n\n        this._initUIEvent();\n    }\n\n    private _initUIEvent() {\n        this.disposeWithMe(\n            this._sheetPermissionCheckController.triggerPermissionUIEvent$.subscribe((errorMsg) => {\n                this._haveNotPermissionHandle(errorMsg);\n            })\n        );\n    }\n\n    private _haveNotPermissionHandle(errorMsg: string) {\n        const dialogProps = {\n            id: UNIVER_SHEET_PERMISSION_ALERT_DIALOG_ID,\n            title: { title: '' },\n            children: {\n                label: UNIVER_SHEET_PERMISSION_ALERT_DIALOG,\n                errorMsg,\n            },\n            width: 320,\n            destroyOnClose: true,\n            onClose: () => this._dialogService.close(UNIVER_SHEET_PERMISSION_ALERT_DIALOG_ID),\n            className: 'sheet-permission-user-dialog',\n        };\n        if (this._permissionService.getShowComponents()) {\n            this._dialogService.open(dialogProps);\n        }\n    }\n\n    private _getPermissionCheck(id: string, params: ICheckPermissionCommandParams) {\n        let permission = true;\n        let errorMsg = '';\n\n        switch (id) {\n            case InsertCommand.id:\n            case IMEInputCommand.id:\n                if (this._contextService.getContextValue(FOCUSING_EDITOR_STANDALONE) === true) {\n                    break;\n                }\n                permission = this._sheetPermissionCheckController.permissionCheckWithoutRange({\n                    workbookTypes: [WorkbookEditablePermission],\n                    rangeTypes: [RangeProtectionPermissionEditPoint],\n                    worksheetTypes: [WorksheetSetCellValuePermission, WorksheetEditPermission],\n                });\n                errorMsg = this._localeService.t('permission.dialog.editErr');\n                break;\n            case SetCellEditVisibleOperation.id:\n                if ((params as IEditorBridgeServiceVisibleParam).visible === false) {\n                    break;\n                }\n                permission = this._sheetPermissionCheckController.permissionCheckWithoutRange({\n                    workbookTypes: [WorkbookEditablePermission],\n                    rangeTypes: [RangeProtectionPermissionEditPoint],\n                    worksheetTypes: [WorksheetSetCellValuePermission, WorksheetEditPermission],\n                });\n                errorMsg = this._localeService.t('permission.dialog.editErr');\n                break;\n            case SheetPasteColWidthCommand.id:\n                permission = this._sheetPermissionCheckController.permissionCheckWithoutRange({\n                    workbookTypes: [WorkbookEditablePermission],\n                    rangeTypes: [RangeProtectionPermissionEditPoint],\n                    worksheetTypes: [WorksheetEditPermission, WorksheetSetColumnStylePermission],\n                });\n                errorMsg = this._localeService.t('permission.dialog.pasteErr');\n                break;\n            case SheetPasteShortKeyCommand.id:\n                permission = this._permissionCheckByPaste(params as ISheetPasteParams);\n                errorMsg = this._localeService.t('permission.dialog.pasteErr');\n                break;\n            case ApplyFormatPainterCommand.id:\n                permission = this._sheetPermissionCheckController.permissionCheckWithRanges({\n                    workbookTypes: [WorkbookEditablePermission],\n                    rangeTypes: [RangeProtectionPermissionEditPoint],\n                    worksheetTypes: [WorksheetEditPermission, WorksheetSetCellValuePermission, WorksheetSetCellStylePermission],\n                });\n                errorMsg = this._localeService.t('permission.dialog.commonErr');\n                break;\n            case SetBackgroundColorCommand.id:\n            case SetRangeBoldCommand.id:\n            case SetRangeItalicCommand.id:\n            case SetRangeUnderlineCommand.id:\n            case SetRangeStrickThroughCommand.id:\n                permission = this._sheetPermissionCheckController.permissionCheckWithRanges({\n                    workbookTypes: [WorkbookEditablePermission],\n                    rangeTypes: [RangeProtectionPermissionEditPoint],\n                    worksheetTypes: [WorksheetSetCellStylePermission, WorksheetEditPermission],\n                });\n                errorMsg = this._localeService.t('permission.dialog.setStyleErr');\n                break;\n            case SheetCopyCommand.id:\n                permission = this._sheetPermissionCheckController.permissionCheckWithRanges({\n                    workbookTypes: [WorkbookCopyPermission],\n                    rangeTypes: [RangeProtectionPermissionViewPoint],\n                    worksheetTypes: [WorksheetCopyPermission],\n                });\n                errorMsg = this._localeService.t('permission.dialog.copyErr');\n                if (!this._permissionService.getPermissionPoint(new WorkbookCopyPermission(this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!.getUnitId()).id)?.value) {\n                    errorMsg = this._localeService.t('permission.dialog.workbookCopyErr');\n                }\n                break;\n            case SheetCutCommand.id:\n                permission = this._sheetPermissionCheckController.permissionCheckWithRanges({\n                    workbookTypes: [WorkbookCopyPermission, WorkbookEditablePermission],\n                    rangeTypes: [RangeProtectionPermissionViewPoint, RangeProtectionPermissionEditPoint],\n                    worksheetTypes: [WorksheetCopyPermission, WorksheetEditPermission],\n                });\n                errorMsg = this._localeService.t('permission.dialog.copyErr');\n                if (!this._permissionService.getPermissionPoint(new WorkbookCopyPermission(this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!.getUnitId()).id)?.value) {\n                    errorMsg = this._localeService.t('permission.dialog.workbookCopyErr');\n                }\n                break;\n\n            case AutoFillCommand.id:\n                permission = this._permissionCheckByAutoFillCommand(params as IAutoFillCommandParams);\n                errorMsg = this._localeService.t('permission.dialog.autoFillErr');\n                break;\n\n            default:\n                break;\n        }\n\n        if (!permission) {\n            this._sheetPermissionCheckController.blockExecuteWithoutPermission(errorMsg);\n        }\n    };\n\n    private _initialize(): void {\n        this._commandExecutedListener();\n    }\n\n    private _commandExecutedListener() {\n        this.disposeWithMe(\n            this._commandService.beforeCommandExecuted((command: ICommandInfo) => {\n                this._getPermissionCheck(command.id, command?.params as ICheckPermissionCommandParams);\n            })\n        );\n    }\n\n    private _permissionCheckByPaste(params: ISheetPasteParams) {\n        if (params.value === PREDEFINED_HOOK_NAME.SPECIAL_PASTE_VALUE || params.value === PREDEFINED_HOOK_NAME.SPECIAL_PASTE_FORMULA) {\n            return this._sheetPermissionCheckController.permissionCheckWithRanges({\n                workbookTypes: [WorkbookEditablePermission],\n                rangeTypes: [RangeProtectionPermissionEditPoint],\n                worksheetTypes: [WorksheetSetCellStylePermission, WorksheetEditPermission],\n            });\n        } else if (params.value === PREDEFINED_HOOK_NAME.SPECIAL_PASTE_FORMAT) {\n            return this._sheetPermissionCheckController.permissionCheckWithRanges({\n                workbookTypes: [WorkbookEditablePermission],\n                rangeTypes: [RangeProtectionPermissionEditPoint],\n                worksheetTypes: [WorksheetSetCellStylePermission, WorksheetEditPermission],\n            });\n        } else {\n            return this._sheetPermissionCheckController.permissionCheckWithRanges({\n                workbookTypes: [WorkbookEditablePermission],\n                rangeTypes: [RangeProtectionPermissionEditPoint],\n                worksheetTypes: [WorksheetSetCellValuePermission, WorksheetSetCellStylePermission, WorksheetEditPermission],\n            });\n        }\n    }\n\n    private _permissionCheckByAutoFillCommand(params?: IAutoFillCommandParams) {\n        if (!params) {\n            return false;\n        }\n\n        const { targetRange } = params;\n\n        const target = getSheetCommandTarget(this._univerInstanceService);\n        if (!target) {\n            return false;\n        }\n        const { worksheet, unitId, subUnitId } = target;\n\n        const permissionLapRanges = this._rangeProtectionRuleModel.getSubunitRuleList(unitId, subUnitId).reduce((p, c) => {\n            return [...p, ...c.ranges];\n        }, [] as IRange[]).filter((range) => {\n            return Rectangle.intersects(range, targetRange);\n        });\n\n        const hasNotPermission = permissionLapRanges.some((range) => {\n            for (let row = range.startRow; row <= range.endRow; row++) {\n                for (let col = range.startColumn; col <= range.endColumn; col++) {\n                    const permission = (worksheet.getCell(row, col) as (ICellDataForSheetInterceptor & { selectionProtection: ICellPermission[] }))?.selectionProtection?.[0];\n                    if (permission?.[UnitAction.Edit] === false) {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        });\n\n        return !hasNotPermission;\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommandInfo, IFreeze, IRange, IStyleSheet, IWorksheetData, Nullable, Workbook } from '@univerjs/core';\nimport type { IMouseEvent, IPointerEvent, IRenderContext, IRenderModule, Viewport } from '@univerjs/engine-render';\nimport type {\n    IInsertColCommandParams,\n    IInsertRowCommandParams,\n    IMoveColsCommandParams,\n    IMoveRowsCommandParams,\n    IRemoveRowColCommandParams,\n    ISetColHiddenMutationParams,\n    ISetFrozenMutationParams,\n    ISetRowHiddenMutationParams,\n    ISetWorksheetColWidthMutationParams,\n    ISetWorksheetRowAutoHeightMutationParams,\n    ISetWorksheetRowHeightMutationParams,\n} from '@univerjs/sheets';\nimport type { IViewportScrollState } from '../../services/scroll-manager.service';\nimport {\n    ColorKit,\n    createInterceptorKey,\n    Direction,\n    Disposable,\n    ICommandService,\n    Inject,\n    Injector,\n    InterceptorManager,\n    RANGE_TYPE,\n    ThemeService,\n    toDisposable,\n} from '@univerjs/core';\nimport { CURSOR_TYPE, Rect, SHEET_VIEWPORT_KEY, TRANSFORM_CHANGE_OBSERVABLE_TYPE, Vector2 } from '@univerjs/engine-render';\n\nimport {\n    InsertColCommand,\n    InsertRangeMoveDownCommand,\n    InsertRangeMoveRightCommand,\n    InsertRowCommand,\n    MoveColsCommand,\n    MoveRowsCommand,\n    RemoveColCommand,\n    RemoveRowCommand,\n    SetColHiddenMutation,\n    SetColVisibleMutation,\n    SetFrozenCommand,\n    SetFrozenMutation,\n    SetFrozenMutationFactory,\n    SetRowHiddenMutation,\n    SetRowVisibleMutation,\n    SetWorksheetActiveOperation,\n    SetWorksheetColWidthMutation,\n    SetWorksheetRowAutoHeightMutation,\n    SetWorksheetRowHeightMutation,\n    SheetInterceptorService,\n    SheetsSelectionsService,\n} from '@univerjs/sheets';\nimport { Subscription } from 'rxjs';\nimport { SetColumnHeaderHeightCommand, SetRowHeaderWidthCommand } from '../../commands/commands/headersize-changed.command';\nimport { ScrollCommand } from '../../commands/commands/set-scroll.command';\n\nimport { SetZoomRatioOperation } from '../../commands/operations/set-zoom-ratio.operation';\nimport { SHEET_COMPONENT_HEADER_LAYER_INDEX } from '../../common/keys';\nimport { SheetScrollManagerService } from '../../services/scroll-manager.service';\nimport { SheetSkeletonManagerService } from '../../services/sheet-skeleton-manager.service';\nimport { getCoordByOffset, getSheetObject } from '../utils/component-tools';\n\nenum FREEZE_DIRECTION_TYPE {\n    ROW,\n    COLUMN,\n}\n\nenum ResetScrollType {\n    NONE = 0,\n    X = 1,\n    Y = 2,\n    ALL = 3,\n}\n\nexport const FREEZE_ROW_MAIN_NAME = '__SpreadsheetFreezeRowMainName__';\n\nexport const FREEZE_ROW_HEADER_NAME = '__SpreadsheetFreezeRowHeaderName__';\n\nexport const FREEZE_COLUMN_MAIN_NAME = '__SpreadsheetFreezeColumnMainName__';\n\nexport const FREEZE_COLUMN_HEADER_NAME = '__SpreadsheetFreezeColumnHeaderName__';\n\nconst FREEZE_SIZE_NORMAL = 2;\n\nconst AUXILIARY_CLICK_HIDDEN_OBJECT_TRANSPARENCY = 0.01;\n\nexport const FREEZE_PERMISSION_CHECK = createInterceptorKey<boolean, null>('freezePermissionCheck');\n\nexport class HeaderFreezeRenderController extends Disposable implements IRenderModule {\n    private _rowFreezeHeaderRect: Nullable<Rect>;\n\n    private _rowFreezeMainRect: Nullable<Rect>;\n\n    private _columnFreezeHeaderRect: Nullable<Rect>;\n\n    private _columnFreezeMainRect: Nullable<Rect>;\n\n    private _freezeDownSubs: Nullable<Subscription>;\n\n    private _freezePointerEnterSubs: Nullable<Subscription>;\n\n    private _freezePointerLeaveSubs: Nullable<Subscription>;\n\n    private _scenePointerMoveSub: Nullable<Subscription>;\n\n    private _scenePointerUpSub: Nullable<Subscription>;\n\n    private _changeToRow: number = -1;\n\n    private _changeToColumn: number = -1;\n\n    private _changeToOffsetX: number = 0;\n\n    private _changeToOffsetY: number = 0;\n\n    private _activeViewport: Nullable<Viewport> = null;\n\n    private _freezeNormalHeaderColor = '';\n\n    private _freezeNormalMainColor = '';\n\n    private _freezeActiveColor = '';\n\n    private _freezeHoverColor = '';\n\n    private _lastFreeze: IFreeze | undefined = undefined;\n\n    public interceptor = new InterceptorManager({ FREEZE_PERMISSION_CHECK });\n\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(SheetSkeletonManagerService) private readonly _sheetSkeletonManagerService: SheetSkeletonManagerService,\n        // @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService,\n        @ICommandService private readonly _commandService: ICommandService,\n        // @IRenderManagerService private readonly _renderManagerService: IRenderManagerService,\n        @Inject(SheetsSelectionsService) private readonly _selectionManagerService: SheetsSelectionsService,\n        @Inject(SheetScrollManagerService) private readonly _scrollManagerService: SheetScrollManagerService,\n        @Inject(ThemeService) private readonly _themeService: ThemeService,\n        @Inject(SheetInterceptorService) private _sheetInterceptorService: SheetInterceptorService,\n        @Inject(Injector) private _injector: Injector\n    ) {\n        super();\n\n        this._initialize();\n    }\n\n    override dispose(): void {\n        super.dispose();\n    }\n\n    private _initialize() {\n        // const sheetObject = this._getSheetObject();\n        // if (sheetObject == null) {\n        //     return;\n        // }\n\n        // this._sheetObject = sheetObject;\n\n        // this._createFreeze(FREEZE_DIRECTION_TYPE.ROW);\n        // this._createFreeze(FREEZE_DIRECTION_TYPE.COLUMN);\n\n        this._skeletonListener();\n\n        this._commandExecutedListener();\n\n        this._themeChangeListener();\n\n        this._interceptorCommands();\n\n        this._bindViewportScroll();\n\n        this._zoomRefresh();\n    }\n\n    // eslint-disable-next-line max-lines-per-function, complexity\n    private _createFreeze(\n        freezeDirectionType: FREEZE_DIRECTION_TYPE = FREEZE_DIRECTION_TYPE.ROW,\n        freezeConfig?: IFreeze\n    ) {\n        const config = freezeConfig ?? this._getFreeze();\n        if (config == null) return null;\n\n        const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n\n        const { startRow: freezeRow, startColumn: freezeColumn } = config;\n        const position = this._getPositionByIndex(freezeRow, freezeColumn);\n        if (position == null || skeleton == null) return null;\n\n        const sheetObject = this._getSheetObject()!;\n        const engine = sheetObject.engine;\n        const canvasMaxWidth = engine?.width || 0;\n        const canvasMaxHeight = engine?.height || 0;\n        const scene = sheetObject.scene;\n        const { startX, startY } = position;\n        const { rowTotalHeight, columnTotalWidth, rowHeaderWidthAndMarginLeft, columnHeaderHeightAndMarginTop } = skeleton;\n\n        const contentWidth = canvasMaxWidth > columnTotalWidth + rowHeaderWidthAndMarginLeft\n            ? canvasMaxWidth\n            : columnTotalWidth + columnHeaderHeightAndMarginTop;\n\n        const contentHeight = canvasMaxHeight > rowTotalHeight + columnHeaderHeightAndMarginTop\n            ? canvasMaxHeight\n            : rowTotalHeight + columnHeaderHeightAndMarginTop;\n\n        this._changeToRow = freezeRow;\n        this._changeToColumn = freezeColumn;\n        this._changeToOffsetX = startX;\n        this._changeToOffsetY = startY;\n\n        const scale = Math.max(scene.scaleX, scene.scaleY);\n\n        let freezeSize = FREEZE_SIZE_NORMAL / Math.max(1, scale);\n\n        if (freezeDirectionType === FREEZE_DIRECTION_TYPE.ROW) {\n            if (freezeRow === -1 || freezeRow === 0) {\n                freezeSize = freezeSize * 2;\n            }\n\n            const freezeOffset = freezeSize;\n\n            this._rowFreezeHeaderRect = new Rect(FREEZE_ROW_HEADER_NAME, {\n                fill: this._freezeNormalHeaderColor,\n                width: rowHeaderWidthAndMarginLeft,\n                height: freezeSize,\n                left: 0,\n                top: startY - freezeOffset,\n                zIndex: 3,\n            });\n\n            let fill = this._freezeNormalHeaderColor;\n            if (freezeRow === -1 || freezeRow === 0) {\n                fill = this._freezeNormalMainColor;\n            }\n\n            this._rowFreezeMainRect = new Rect(FREEZE_ROW_MAIN_NAME, {\n                fill,\n                width: contentWidth * 2 / scale,\n                height: freezeSize,\n                left: rowHeaderWidthAndMarginLeft,\n                top: startY - freezeOffset,\n                zIndex: 3,\n            });\n\n            scene.addObjects([this._rowFreezeHeaderRect, this._rowFreezeMainRect], SHEET_COMPONENT_HEADER_LAYER_INDEX);\n        } else {\n            if (freezeColumn === -1 || freezeColumn === 0) {\n                freezeSize = freezeSize * 2;\n            }\n\n            const FREEZE_OFFSET = freezeSize;\n\n            this._columnFreezeHeaderRect = new Rect(FREEZE_COLUMN_HEADER_NAME, {\n                fill: this._freezeNormalHeaderColor,\n                width: freezeSize,\n                height: columnHeaderHeightAndMarginTop,\n                left: startX - FREEZE_OFFSET,\n                top: 0,\n                zIndex: 3,\n            });\n\n            let fill = this._freezeNormalHeaderColor;\n            if (freezeColumn === -1 || freezeColumn === 0) {\n                fill = this._freezeNormalMainColor;\n            }\n\n            this._columnFreezeMainRect = new Rect(FREEZE_COLUMN_MAIN_NAME, {\n                fill,\n                width: freezeSize,\n                height: contentHeight * 2 / scale,\n                left: startX - FREEZE_OFFSET,\n                top: columnHeaderHeightAndMarginTop,\n                zIndex: 3,\n            });\n\n            scene.addObjects([this._columnFreezeHeaderRect, this._columnFreezeMainRect], SHEET_COMPONENT_HEADER_LAYER_INDEX);\n        }\n\n        this._eventBinding(freezeDirectionType);\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    private _eventBinding(freezeDirectionType: FREEZE_DIRECTION_TYPE = FREEZE_DIRECTION_TYPE.ROW) {\n        let freezeObjectHeaderRect = this._rowFreezeHeaderRect;\n        let freezeObjectMainRect = this._rowFreezeMainRect;\n        if (freezeDirectionType === FREEZE_DIRECTION_TYPE.COLUMN) {\n            freezeObjectHeaderRect = this._columnFreezeHeaderRect;\n            freezeObjectMainRect = this._columnFreezeMainRect;\n        }\n\n        const sheetObject = this._getSheetObject();\n        if (sheetObject == null) {\n            return;\n        }\n\n        const { scene } = sheetObject;\n\n        this._freezePointerEnterSubs = new Subscription();\n        this._freezePointerLeaveSubs = new Subscription();\n        this._freezeDownSubs = new Subscription();\n\n        if (freezeObjectMainRect) {\n            const _freezeObjectMainRectEnterSub = freezeObjectMainRect.onPointerEnter$.subscribeEvent(() => {\n                const permissionCheck = this.interceptor.fetchThroughInterceptors(FREEZE_PERMISSION_CHECK)(true, null);\n                if (!permissionCheck) {\n                    return false;\n                }\n                freezeObjectHeaderRect?.setProps({\n                    fill: this._freezeHoverColor,\n                    zIndex: 4,\n                });\n                scene.setCursor(CURSOR_TYPE.GRAB);\n            });\n            this._freezePointerEnterSubs.add(_freezeObjectMainRectEnterSub);\n\n            const _freezeObjectMainPointerLeaveSub = freezeObjectMainRect.onPointerLeave$.subscribeEvent(() => {\n                freezeObjectHeaderRect?.setProps({\n                    fill: this._freezeNormalHeaderColor,\n                    zIndex: 3,\n                });\n                scene.resetCursor();\n            });\n\n            this._freezePointerLeaveSubs.add(_freezeObjectMainPointerLeaveSub);\n        }\n\n        if (freezeObjectHeaderRect) {\n            const _freezeObjHeaderPointerEnterSub = freezeObjectHeaderRect.onPointerEnter$.subscribeEvent(() => {\n                const permissionCheck = this.interceptor.fetchThroughInterceptors(FREEZE_PERMISSION_CHECK)(true, null);\n                if (!permissionCheck) {\n                    return false;\n                }\n                freezeObjectHeaderRect?.setProps({\n                    fill: this._freezeHoverColor,\n                    zIndex: 4,\n                });\n                scene.setCursor(CURSOR_TYPE.GRAB);\n            });\n            this._freezePointerEnterSubs.add(_freezeObjHeaderPointerEnterSub);\n\n            const _freezeObjHeaderPointerLeaveSub = freezeObjectHeaderRect.onPointerLeave$.subscribeEvent(() => {\n                freezeObjectHeaderRect?.setProps({\n                    fill: this._freezeNormalHeaderColor,\n                    zIndex: 3,\n                });\n                scene.resetCursor();\n            });\n            this._freezePointerLeaveSubs.add(_freezeObjHeaderPointerLeaveSub);\n        }\n\n        const s1 = freezeObjectHeaderRect?.onPointerDown$.subscribeEvent((evt: IPointerEvent | IMouseEvent) => {\n            this._freezeDown(evt, freezeObjectHeaderRect!, freezeObjectMainRect!, freezeDirectionType);\n        });\n        if (s1) {\n            this._freezeDownSubs.add(s1);\n        }\n\n        const s2 = freezeObjectMainRect?.onPointerDown$.subscribeEvent((evt: IPointerEvent | IMouseEvent) => {\n            this._freezeDown(evt, freezeObjectHeaderRect!, freezeObjectMainRect!, freezeDirectionType);\n        });\n        if (s2) {\n            this._freezeDownSubs.add(s2);\n        }\n        // this._freezeMoveObservers.push(\n        //     freezeObjectMainRect?.onPointerEnter$.subscribeEvent(() => {\n        //         const permissionCheck = this.interceptor.fetchThroughInterceptors(FREEZE_PERMISSION_CHECK)(null, null);\n        //         if (!permissionCheck) {\n        //             return false;\n        //         }\n        //         freezeObjectHeaderRect?.setProps({\n        //             fill: this._freezeHoverColor,\n        //             zIndex: 4,\n        //         });\n        //         scene.setCursor(CURSOR_TYPE.GRAB);\n        //     })\n        // );\n        // this._freezeLeaveObservers.push(\n        //     freezeObjectMainRect?.onPointerLeave$.subscribeEvent(() => {\n        //         freezeObjectHeaderRect?.setProps({\n        //             fill: this._freezeNormalHeaderColor,\n        //             zIndex: 3,\n        //         });\n        //         scene.resetCursor();\n        //     })\n        // );\n    }\n\n    // eslint-disable-next-line complexity\n    private _getCurrentLastVisible() {\n        const sheetObject = this._getSheetObject();\n        if (sheetObject == null) {\n            return;\n        }\n\n        const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n        if (skeleton == null) {\n            return;\n        }\n        const scene = sheetObject.scene;\n\n        const scale = Math.max(scene.scaleX, scene.scaleY);\n        const currentScroll = this._scrollManagerService.getCurrentScrollState();\n\n        const skeletonViewHeight = (sheetObject.engine.height - skeleton.columnHeaderHeight) / scale;\n        const skeletonViewWidth = (sheetObject.engine.width - skeleton.rowHeaderWidth) / scale;\n        const startRow = currentScroll?.sheetViewStartRow ?? 0;\n        const startHeight = startRow === 0\n            ? -(currentScroll?.offsetY ?? 0)\n            : skeleton.rowHeightAccumulation[startRow - 1] - (currentScroll?.offsetY ?? 0);\n\n        let lastRow = 0;\n        let hadFind = false;\n        for (let i = startRow, len = skeleton.rowHeightAccumulation.length; i < len; i++) {\n            const height = skeleton.rowHeightAccumulation[i];\n            if (height - startHeight > skeletonViewHeight) {\n                lastRow = i;\n                hadFind = true;\n                break;\n            }\n        }\n\n        // row total height smaller than canvas height\n        if (!hadFind) {\n            lastRow = skeleton.rowHeightAccumulation.length - 1;\n        }\n\n        const startColumn = currentScroll?.sheetViewStartColumn ?? 0;\n        const startWidth = startColumn === 0\n            ? -(currentScroll?.offsetX ?? 0)\n            : skeleton.columnWidthAccumulation[startColumn - 1] - (currentScroll?.offsetX ?? 0);\n\n        let lastColumn = 0;\n        let hadFindCol = false;\n        for (let i = startColumn, len = skeleton.columnWidthAccumulation.length; i < len; i++) {\n            const width = skeleton.columnWidthAccumulation[i];\n            if (width - startWidth > skeletonViewWidth) {\n                lastColumn = i;\n                hadFindCol = true;\n                break;\n            }\n        }\n\n        if (!hadFindCol) {\n            lastColumn = skeleton.columnWidthAccumulation.length - 1;\n        }\n\n        return { lastRow, lastColumn };\n    }\n\n    private _getActiveViewport(evt: IPointerEvent | IMouseEvent) {\n        const viewports = this._getSheetObject()?.scene.getViewports();\n        if (!viewports) {\n            return null;\n        }\n\n        return viewports.find((i) => i.isHit(new Vector2(evt.offsetX, evt.offsetY))) || null;\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    private _freezeDown(\n        evt: IPointerEvent | IMouseEvent,\n        freezeObjectHeaderRect: Rect,\n        freezeObjectMainRect: Rect,\n        freezeDirectionType: FREEZE_DIRECTION_TYPE = FREEZE_DIRECTION_TYPE.ROW\n    ) {\n        const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n        if (skeleton == null) {\n            return;\n        }\n\n        const sheetObject = this._getSheetObject();\n        if (sheetObject == null) {\n            return;\n        }\n\n        const permissionCheck = this.interceptor.fetchThroughInterceptors(FREEZE_PERMISSION_CHECK)(true, null);\n        if (!permissionCheck) {\n            return false;\n        }\n\n        const { scene } = sheetObject;\n\n        scene.setCursor(CURSOR_TYPE.GRABBING);\n\n        scene.disableObjectsEvent();\n\n        const last = this._getCurrentLastVisible();\n        const lastRowY = last === undefined ? Number.POSITIVE_INFINITY : skeleton.rowHeightAccumulation[last.lastRow];\n        const lastColumnX = last === undefined ? Number.POSITIVE_INFINITY : skeleton.columnWidthAccumulation[last.lastColumn - 1] + skeleton.rowHeaderWidth;\n        this._activeViewport = null;\n        const oldFreeze = this._getFreeze();\n\n        if (oldFreeze) {\n            this._changeToColumn = oldFreeze.startColumn;\n            this._changeToRow = oldFreeze.startRow;\n        }\n        this._scenePointerMoveSub = scene.onPointerMove$.subscribeEvent((moveEvt: IPointerEvent | IMouseEvent) => {\n            const activeViewport = this._getActiveViewport(moveEvt);\n\n            const { startX, startY, row, column } = getCoordByOffset(\n                moveEvt.offsetX,\n                moveEvt.offsetY,\n                scene,\n                skeleton,\n                activeViewport || undefined,\n                true\n            );\n\n            const permissionCheck = this.interceptor.fetchThroughInterceptors(FREEZE_PERMISSION_CHECK)(true, null);\n            if (!permissionCheck) {\n                return false;\n            }\n\n            scene.setCursor(CURSOR_TYPE.GRABBING);\n\n            const FREEZE_SIZE = FREEZE_SIZE_NORMAL / Math.max(scene.scaleX, scene.scaleY);\n\n            if (freezeDirectionType === FREEZE_DIRECTION_TYPE.ROW) {\n                freezeObjectHeaderRect\n                    .transformByState({\n                        top: Math.min(startY, lastRowY) - FREEZE_SIZE / 2,\n                    })\n                    ?.setProps({\n                        fill: this._freezeActiveColor,\n                    });\n                freezeObjectMainRect\n                    .transformByState({\n                        top: Math.min(startY, lastRowY) - FREEZE_SIZE / 2,\n                    })\n                    ?.setProps({\n                        fill: this._freezeNormalHeaderColor,\n                    });\n                this._changeToRow = last === undefined ? row : Math.min(row, last.lastRow);\n                this._changeToOffsetY = Math.min(startY, lastRowY);\n                this._activeViewport = activeViewport;\n            } else {\n                freezeObjectHeaderRect\n                    .transformByState({\n                        left: Math.min(startX, lastColumnX) - FREEZE_SIZE / 2,\n                    })\n                    ?.setProps({\n                        fill: this._freezeActiveColor,\n                    });\n                freezeObjectMainRect\n                    .transformByState({\n                        left: Math.min(startX, lastColumnX) - FREEZE_SIZE / 2,\n                    })\n                    ?.setProps({\n                        fill: this._freezeNormalHeaderColor,\n                    });\n\n                this._changeToColumn = last === undefined ? column : Math.min(column, last.lastColumn);\n                this._changeToOffsetX = startX;\n                this._activeViewport = activeViewport;\n            }\n\n            // this._columnMoving(newMoveOffsetX, newMoveOffsetY, matchSelectionData, initialType);\n        });\n\n        // eslint-disable-next-line max-lines-per-function, complexity\n        this._scenePointerUpSub = scene.onPointerUp$.subscribeEvent(() => {\n            scene.resetCursor();\n            scene.enableObjectsEvent();\n            this._clearObserverEvent();\n\n            const { rowHeaderWidthAndMarginLeft, columnHeaderHeightAndMarginTop } = skeleton;\n\n            if (\n                (freezeDirectionType === FREEZE_DIRECTION_TYPE.ROW &&\n                    (this._changeToRow === 0 || this._changeToRow === -1)) ||\n                (freezeDirectionType === FREEZE_DIRECTION_TYPE.COLUMN &&\n                    (this._changeToColumn === 0 || this._changeToColumn === -1))\n            ) {\n                freezeObjectHeaderRect.setProps({\n                    fill: this._freezeNormalHeaderColor,\n                });\n                freezeObjectMainRect.setProps({\n                    fill: this._freezeNormalMainColor,\n                });\n            } else {\n                freezeObjectHeaderRect?.setProps({\n                    fill: this._freezeNormalHeaderColor,\n                });\n                freezeObjectMainRect?.setProps({\n                    fill: this._freezeNormalHeaderColor,\n                });\n            }\n\n            const FREEZE_SIZE = FREEZE_SIZE_NORMAL / Math.max(scene.scaleX, scene.scaleY);\n\n            if (freezeDirectionType === FREEZE_DIRECTION_TYPE.ROW) {\n                if (this._changeToRow === 0 || this._changeToRow === -1) {\n                    freezeObjectHeaderRect.transformByState({\n                        top: columnHeaderHeightAndMarginTop - FREEZE_SIZE,\n                    });\n\n                    freezeObjectMainRect.transformByState({\n                        top: columnHeaderHeightAndMarginTop - FREEZE_SIZE,\n                    });\n                }\n\n                // alert(`moveColumnTo: ${this._changeToRow}`);\n            } else {\n                if (this._changeToColumn === 0 || this._changeToColumn === -1) {\n                    freezeObjectHeaderRect.transformByState({\n                        left: rowHeaderWidthAndMarginLeft - FREEZE_SIZE,\n                    });\n\n                    freezeObjectMainRect.transformByState({\n                        left: rowHeaderWidthAndMarginLeft - FREEZE_SIZE,\n                    });\n                }\n\n                // alert(`moveColumnTo: ${this._changeToColumn}`);\n            }\n\n            const sheetViewScroll = this._scrollManagerService.getCurrentScrollState() || {\n                sheetViewStartRow: 0,\n                sheetViewStartColumn: 0,\n            };\n\n            const { sheetViewStartRow, sheetViewStartColumn } = sheetViewScroll;\n\n            // this._updateViewport(\n            //     this._changeToRow,\n            //     this._changeToColumn,\n            //     this._changeToRow - sheetViewStartRow,\n            //     this._changeToColumn - sheetViewStartColumn\n            // );\n            if (sheetViewStartColumn == null || sheetViewStartRow == null) {\n                return;\n            }\n\n            const workbook = this._context.unit;\n            const worksheet = workbook.getActiveSheet();\n            if (!worksheet) return;\n\n            const oldFreeze = worksheet.getConfig()?.freeze;\n            let xSplit = oldFreeze?.xSplit || 0;\n            let ySplit = oldFreeze?.ySplit || 0;\n            const viewPortKey = this._activeViewport?.viewportKey;\n            if (freezeDirectionType === FREEZE_DIRECTION_TYPE.ROW) {\n                if (\n                    !viewPortKey ||\n                    viewPortKey === SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP ||\n                    viewPortKey === SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP ||\n                    viewPortKey === SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP ||\n                    viewPortKey === SHEET_VIEWPORT_KEY.VIEW_ROW_TOP\n                ) {\n                    ySplit = this._changeToRow - (oldFreeze.startRow - oldFreeze.ySplit);\n                } else {\n                    // main viewport\n                    ySplit = this._changeToRow - sheetViewStartRow;\n                }\n\n                ySplit = ySplit < 0 ? 0 : ySplit;\n            }\n            if (freezeDirectionType === FREEZE_DIRECTION_TYPE.COLUMN) {\n                if (\n                    !viewPortKey ||\n                    viewPortKey === SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP ||\n                    viewPortKey === SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP ||\n                    viewPortKey === SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT ||\n                    viewPortKey === SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT\n                ) {\n                    xSplit = this._changeToColumn - (oldFreeze.startColumn - oldFreeze.xSplit);\n                } else {\n                    xSplit = this._changeToColumn - sheetViewStartColumn;\n                }\n\n                xSplit = xSplit < 0 ? 0 : xSplit;\n            }\n\n            this._commandService.executeCommand(SetFrozenCommand.id, {\n                startRow: ySplit === 0 ? -1 : this._changeToRow,\n                startColumn: xSplit === 0 ? -1 : this._changeToColumn,\n                ySplit,\n                xSplit,\n                unitId: workbook.getUnitId(),\n                subUnitId: worksheet.getSheetId(),\n            });\n        });\n    }\n\n    private _getViewports() {\n        const sheetObject = this._getSheetObject();\n        if (sheetObject == null) {\n            return;\n        }\n        const { scene } = sheetObject;\n\n        const viewColumnLeft = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT);\n        const viewColumnRight = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_COLUMN_RIGHT);\n\n        // row header\n        const viewRowTop = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_ROW_TOP);\n        const viewRowBottom = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_ROW_BOTTOM);\n\n        const viewLeftTop = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP);\n\n        // skeleton\n        const viewMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n        const viewMainLeftTop = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP);\n        const viewMainLeft = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT);\n        const viewMainTop = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP);\n\n        if (\n            viewColumnLeft == null ||\n            viewColumnRight == null ||\n            viewRowTop == null ||\n            viewRowBottom == null ||\n            viewLeftTop == null ||\n            viewMain == null ||\n            viewMainLeftTop == null ||\n            viewMainLeft == null ||\n            viewMainTop == null\n        ) {\n            return;\n        }\n\n        return {\n            viewMain,\n            viewMainLeftTop,\n            viewMainLeft,\n            viewMainTop,\n            viewColumnLeft,\n            viewColumnRight,\n            viewRowTop,\n            viewRowBottom,\n            viewLeftTop,\n        };\n    }\n\n    private _bindViewportScroll() {\n        // column header\n        const viewports = this._getViewports();\n        if (!viewports) {\n            return;\n        }\n\n        const { viewRowBottom, viewColumnRight, viewMainLeft, viewMainTop } = viewports;\n\n        this.disposeWithMe(\n            this._scrollManagerService.validViewportScrollInfo$.subscribe((param: Nullable<IViewportScrollState>) => {\n                if (!param) return;\n\n                const { scrollX, scrollY, viewportScrollX, viewportScrollY } = param;\n\n                if (viewRowBottom.isActive) {\n                    viewRowBottom\n                        .updateScrollVal({\n                            scrollY,\n                            viewportScrollY,\n                        });\n                }\n\n                if (viewColumnRight.isActive) {\n                    viewColumnRight\n                        .updateScrollVal({\n                            scrollX,\n                            viewportScrollX,\n                        });\n                }\n                if (viewMainLeft.isActive) {\n                    viewMainLeft\n                        .updateScrollVal({\n                            scrollY,\n                            viewportScrollY,\n                        });\n                }\n\n                if (viewMainTop.isActive) {\n                    viewMainTop\n                        .updateScrollVal({\n                            scrollX,\n                            viewportScrollX,\n                        });\n                }\n            })\n        );\n    }\n\n    // eslint-disable-next-line max-lines-per-function, complexity\n    private _updateViewport(\n        row: number = -1,\n        column: number = -1,\n        ySplit: number = 0,\n        xSplit: number = 0,\n        resetScroll = ResetScrollType.ALL\n    ) {\n        const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n        if (skeleton == null) {\n            return;\n        }\n\n        const { rowHeaderWidthAndMarginLeft, columnHeaderHeightAndMarginTop } = skeleton;\n\n        const viewports = this._getViewports();\n        if (!viewports) {\n            return;\n        }\n\n        const {\n            viewMain,\n            viewMainLeftTop,\n            viewMainLeft,\n            viewMainTop,\n            viewColumnLeft,\n            viewColumnRight,\n            viewRowTop,\n            viewRowBottom,\n            viewLeftTop,\n        } = viewports;\n\n        viewColumnRight.resizeWhenFreezeChange({\n            left: rowHeaderWidthAndMarginLeft,\n            top: 0,\n            // ctx.clip by the size of viewport, and selection header border is slightly below column header\n            // I think it's a bad design, Should not clip for selection rendering in viewport,\n            height: columnHeaderHeightAndMarginTop + 1,\n            right: 0,\n        });\n\n        viewRowBottom.resizeWhenFreezeChange({\n            left: 0,\n            top: columnHeaderHeightAndMarginTop,\n            bottom: 0,\n            width: rowHeaderWidthAndMarginLeft + 1,\n        });\n\n        viewLeftTop.resizeWhenFreezeChange({\n            left: 0,\n            top: 0,\n            width: rowHeaderWidthAndMarginLeft + 1,\n            height: columnHeaderHeightAndMarginTop,\n        });\n\n        let isTopView = true;\n\n        let isLeftView = true;\n\n        viewMainLeftTop.enable();\n\n        if (row === -1 || row === 0) {\n            isTopView = false;\n        }\n\n        if (column === -1 || column === 0) {\n            isLeftView = false;\n        }\n\n        // freeze start\n        const startSheetView = skeleton.getNoMergeCellWithCoordByIndex(row - ySplit, column - xSplit, false);\n        // freeze end\n        const endSheetView = skeleton.getNoMergeCellWithCoordByIndex(row, column, false);\n\n        viewMainLeftTop.disable();\n        viewMainTop.disable();\n        viewMainLeft.disable();\n        viewRowTop.disable();\n        viewColumnLeft.disable();\n\n        viewMainLeftTop.resetPadding();\n        viewMainTop.resetPadding();\n        viewMainLeft.resetPadding();\n        viewRowTop.resetPadding();\n        viewColumnLeft.resetPadding();\n\n        // cancel freeze\n        if (isTopView === false && isLeftView === false) {\n            viewMain.resizeWhenFreezeChange({\n                left: rowHeaderWidthAndMarginLeft,\n                top: columnHeaderHeightAndMarginTop,\n                bottom: 0,\n                right: 0,\n            });\n            viewMain.resetPadding();\n            viewMainLeft.resizeWhenFreezeChange({\n                left: rowHeaderWidthAndMarginLeft,\n                top: columnHeaderHeightAndMarginTop,\n                bottom: 0,\n                width: 0,\n            });\n            viewMainTop.resizeWhenFreezeChange({\n                left: rowHeaderWidthAndMarginLeft,\n                top: columnHeaderHeightAndMarginTop,\n                height: 0,\n                right: 0,\n            });\n            viewMainLeftTop.resizeWhenFreezeChange({\n                left: rowHeaderWidthAndMarginLeft,\n                top: columnHeaderHeightAndMarginTop,\n                width: 0,\n                height: 0,\n            });\n            viewRowTop.resizeWhenFreezeChange({\n                left: 0,\n                top: columnHeaderHeightAndMarginTop,\n                width: rowHeaderWidthAndMarginLeft + 1,\n                height: 0,\n            });\n            viewColumnLeft.resizeWhenFreezeChange({\n                left: 0,\n                top: 0,\n                height: columnHeaderHeightAndMarginTop + 1,\n                width: 0,\n            });\n        } else if (isTopView === true && isLeftView === false) {\n            // freeze row\n            const topGap = endSheetView.startY - startSheetView.startY;\n            viewMain.resizeWhenFreezeChange({\n                left: rowHeaderWidthAndMarginLeft,\n                top: columnHeaderHeightAndMarginTop + topGap,\n                bottom: 0,\n                right: 0,\n            });\n            viewMain.setPadding({\n                startY: startSheetView.startY,\n                endY: endSheetView.startY,\n                startX: 0,\n                endX: 0,\n            });\n\n            if (resetScroll & ResetScrollType.Y) {\n                this._commandService.executeCommand(ScrollCommand.id, {\n                    sheetViewStartRow: 0,\n                    offsetY: 0,\n                });\n            }\n\n            viewMainTop.resizeWhenFreezeChange({\n                left: rowHeaderWidthAndMarginLeft,\n                top: columnHeaderHeightAndMarginTop,\n                height: topGap,\n                right: 0,\n            });\n            viewMainTop\n                .updateScrollVal({\n                    viewportScrollY: startSheetView.startY,\n                    rawScrollX: viewMain.scrollX,\n                    viewportScrollX: viewMain.viewportScrollX,\n                });\n            viewRowTop.resizeWhenFreezeChange({\n                left: 0,\n                top: columnHeaderHeightAndMarginTop,\n                width: rowHeaderWidthAndMarginLeft + 1,\n                height: topGap,\n            });\n            viewRowTop\n                .updateScrollVal({\n                    viewportScrollY: startSheetView.startY,\n                });\n            viewRowBottom.resizeWhenFreezeChange({\n                left: 0,\n                top: columnHeaderHeightAndMarginTop + topGap,\n                bottom: 0,\n                width: rowHeaderWidthAndMarginLeft + 1,\n            });\n\n            viewMainTop.enable();\n            viewRowTop.enable();\n        } else if (isTopView === false && isLeftView === true) {\n            // freeze column\n            const leftGap = endSheetView.startX - startSheetView.startX;\n            viewMain.resizeWhenFreezeChange({\n                left: rowHeaderWidthAndMarginLeft + leftGap,\n                top: columnHeaderHeightAndMarginTop,\n                bottom: 0,\n                right: 0,\n            });\n            viewMain.setPadding({\n                startX: startSheetView.startX,\n                endX: endSheetView.startX,\n                startY: 0,\n                endY: 0,\n            });\n\n            if (resetScroll & ResetScrollType.X) {\n                this._commandService.executeCommand(ScrollCommand.id, {\n                    sheetViewStartColumn: 0,\n                    offsetX: 0,\n                });\n            }\n\n            viewMainLeft.resizeWhenFreezeChange({\n                left: rowHeaderWidthAndMarginLeft,\n                top: columnHeaderHeightAndMarginTop,\n                width: leftGap,\n                bottom: 0,\n                right: 0,\n            });\n            viewMainLeft\n                .updateScrollVal({\n                    viewportScrollX: startSheetView.startX,\n                    rawScrollY: viewMain.scrollY,\n                    viewportScrollY: viewMain.viewportScrollY,\n                });\n            viewColumnLeft.resizeWhenFreezeChange({\n                left: rowHeaderWidthAndMarginLeft,\n                top: 0,\n                width: leftGap,\n                height: columnHeaderHeightAndMarginTop + 1,\n            });\n            viewColumnLeft\n                .updateScrollVal({\n                    viewportScrollX: startSheetView.startX,\n                });\n            viewColumnRight.resizeWhenFreezeChange({\n                left: rowHeaderWidthAndMarginLeft + leftGap,\n                top: 0,\n                height: columnHeaderHeightAndMarginTop + 1,\n                right: 0,\n            });\n\n            viewMainLeft.enable();\n            viewColumnLeft.enable();\n        } else {\n            const leftGap = endSheetView.startX - startSheetView.startX;\n            const topGap = endSheetView.startY - startSheetView.startY;\n            viewMain.resizeWhenFreezeChange({\n                left: rowHeaderWidthAndMarginLeft + leftGap,\n                top: columnHeaderHeightAndMarginTop + topGap,\n                bottom: 0,\n                right: 0,\n            });\n            viewMain.setPadding({\n                startY: startSheetView.startY,\n                endY: endSheetView.startY,\n                startX: startSheetView.startX,\n                endX: endSheetView.startX,\n            });\n\n            if (resetScroll) {\n                this._commandService.executeCommand(ScrollCommand.id, {\n                    ...(resetScroll & ResetScrollType.X\n                        ? {\n                            sheetViewStartColumn: 0,\n                            offsetX: 0,\n                        }\n                        : null),\n                    ...(resetScroll & ResetScrollType.Y\n                        ? {\n                            sheetViewStartRow: 0,\n                            offsetY: 0,\n                        }\n                        : null),\n                });\n            }\n\n            viewMainLeft.resizeWhenFreezeChange({\n                left: rowHeaderWidthAndMarginLeft,\n                top: columnHeaderHeightAndMarginTop + topGap,\n                width: leftGap,\n                bottom: 0,\n            });\n            viewMainLeft\n                .updateScrollVal({\n                    viewportScrollX: startSheetView.startX,\n                    rawScrollY: viewMain.scrollY,\n                    viewportScrollY: viewMain.viewportScrollY,\n                });\n            viewMainTop.resizeWhenFreezeChange({\n                left: rowHeaderWidthAndMarginLeft + leftGap,\n                top: columnHeaderHeightAndMarginTop,\n                height: topGap,\n                right: 0,\n            });\n            viewMainTop\n                .updateScrollVal({\n                    viewportScrollY: startSheetView.startY,\n                    rawScrollX: viewMain.scrollX,\n                    viewportScrollX: viewMain.viewportScrollX,\n                });\n            viewMainLeftTop.resizeWhenFreezeChange({\n                left: rowHeaderWidthAndMarginLeft,\n                top: columnHeaderHeightAndMarginTop,\n                width: leftGap,\n                height: topGap,\n            });\n\n            viewMainLeftTop\n                .updateScrollVal({\n                    viewportScrollX: startSheetView.startX,\n                    viewportScrollY: startSheetView.startY,\n                });\n\n            viewRowTop.resizeWhenFreezeChange({\n                left: 0,\n                top: columnHeaderHeightAndMarginTop,\n                width: rowHeaderWidthAndMarginLeft + 1,\n                height: topGap,\n            });\n\n            viewRowTop\n                .updateScrollVal({\n                    viewportScrollY: startSheetView.startY,\n                });\n\n            viewRowBottom.resizeWhenFreezeChange({\n                left: 0,\n                top: columnHeaderHeightAndMarginTop + topGap,\n                bottom: 0,\n                width: rowHeaderWidthAndMarginLeft + 1,\n            });\n\n            viewColumnLeft.resizeWhenFreezeChange({\n                left: rowHeaderWidthAndMarginLeft,\n                top: 0,\n                width: leftGap,\n                height: columnHeaderHeightAndMarginTop + 1,\n            });\n\n            viewColumnLeft\n                .updateScrollVal({\n                    viewportScrollX: startSheetView.startX,\n                });\n\n            viewColumnRight.resizeWhenFreezeChange({\n                left: rowHeaderWidthAndMarginLeft + leftGap,\n                top: 0,\n                height: columnHeaderHeightAndMarginTop + 1,\n                right: 0,\n            });\n\n            viewMainLeftTop.enable();\n            viewMainTop.enable();\n            viewMainLeft.enable();\n            viewRowTop.enable();\n            viewColumnLeft.enable();\n\n            // viewMain.disable();\n            // viewRowBottom.disable();\n        }\n    }\n\n    /**\n     * When switching sheet tabs, it is necessary to update the frozen state of the current view.\n     */\n    private _skeletonListener() {\n        this.disposeWithMe(\n            toDisposable(\n                this._sheetSkeletonManagerService.currentSkeleton$.subscribe((param) => {\n                    const allowedCommands = [\n                        SetWorksheetActiveOperation.id,\n                        InsertRangeMoveDownCommand.id,\n                        InsertRangeMoveRightCommand.id,\n                    ];\n\n                    if (allowedCommands.includes(param?.commandId || '')) {\n                        this._refreshCurrent();\n                    }\n                })\n            )\n        );\n    }\n\n    private _refreshCurrent() {\n        const workbook = this._context.unit;\n        const worksheet = workbook.getActiveSheet();\n        if (!worksheet) return;\n\n        const freeze = worksheet.getConfig().freeze;\n\n        const { startRow = -1, startColumn = -1, ySplit = 0, xSplit = 0 } = freeze;\n\n        this._refreshFreeze(startRow, startColumn, ySplit, xSplit, ResetScrollType.NONE);\n    }\n\n    private _themeChangeListener() {\n        this._themeChange(this._themeService.getCurrentTheme());\n        this.disposeWithMe(\n            this._themeService.currentTheme$.subscribe((style) => {\n                this._clearFreeze();\n                this._themeChange(style);\n                this._refreshCurrent();\n            })\n        );\n    }\n\n    private _themeChange(style: IStyleSheet) {\n        this._freezeNormalHeaderColor = style.grey400;\n\n        this._freezeNormalMainColor = new ColorKit(style.grey400)\n            .setAlpha(AUXILIARY_CLICK_HIDDEN_OBJECT_TRANSPARENCY)\n            .toRgbString();\n\n        this._freezeActiveColor = style.primaryColor;\n\n        this._freezeHoverColor = style.grey500;\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    private _interceptorCommands() {\n        this.disposeWithMe(\n            this._sheetInterceptorService.interceptCommand({\n                // eslint-disable-next-line complexity, max-lines-per-function\n                getMutations: (command) => {\n                    const empty = {\n                        redos: [],\n                        undos: [],\n                    };\n\n                    const freeze = this._getFreeze();\n\n                    if (!freeze) {\n                        return empty;\n                    }\n\n                    const createFreezeMutationAndRefresh = (newFreeze: IFreeze) => {\n                        const workbook = this._context.unit;\n                        const unitId = workbook.getUnitId();\n                        const worksheet = workbook.getActiveSheet();\n                        if (!worksheet) {\n                            return empty;\n                        }\n                        const subUnitId = worksheet.getSheetId();\n\n                        this._refreshFreeze(\n                            newFreeze.startRow,\n                            newFreeze.startColumn,\n                            newFreeze.ySplit,\n                            newFreeze.xSplit,\n                            ResetScrollType.NONE\n                        );\n\n                        const redoMutationParams = {\n                            ...newFreeze,\n                            unitId,\n                            subUnitId,\n                            resetScroll: false,\n                        };\n\n                        const undoMutationParams = SetFrozenMutationFactory(this._injector, redoMutationParams);\n\n                        return {\n                            undos: [{ id: SetFrozenMutation.id, params: undoMutationParams }],\n                            redos: [{ id: SetFrozenMutation.id, params: redoMutationParams }],\n                        };\n                    };\n\n                    if (command.id === InsertRowCommand.id) {\n                        const params = command.params as IInsertRowCommandParams;\n                        const { range, direction } = params;\n                        const insertCount = range.endRow - range.startRow + 1;\n                        if (range.startRow + 1 < freeze.startRow || (range.startRow + 1 === freeze.startRow && direction === Direction.UP)) {\n                            const newFreeze: IFreeze = {\n                                ...freeze,\n                                startRow: Math.max(1, freeze.startRow + insertCount),\n                                ySplit: Math.max(1, freeze.ySplit + insertCount),\n                            };\n\n                            return createFreezeMutationAndRefresh(newFreeze);\n                        }\n                    }\n\n                    if (command.id === InsertColCommand.id) {\n                        const params = command.params as IInsertColCommandParams;\n                        const { range, direction } = params;\n                        const insertCount = range.endColumn - range.startColumn + 1;\n                        if (range.startColumn + 1 < freeze.startColumn || (range.startColumn + 1 === freeze.startColumn && direction === Direction.LEFT)) {\n                            const newFreeze: IFreeze = {\n                                ...freeze,\n                                startColumn: Math.max(1, freeze.startColumn + insertCount),\n                                xSplit: Math.max(1, freeze.xSplit + insertCount),\n                            };\n\n                            return createFreezeMutationAndRefresh(newFreeze);\n                        }\n                    }\n\n                    if (command.id === MoveColsCommand.id) {\n                        const selections = this._selectionManagerService.getCurrentSelections();\n                        const {\n                            fromRange: { startColumn: fromCol },\n                            toRange: { startColumn: toCol },\n                        } = command.params as IMoveColsCommandParams;\n                        const filteredSelections = selections?.filter(\n                            (selection) =>\n                                selection.range.rangeType === RANGE_TYPE.COLUMN &&\n                                selection.range.startColumn <= fromCol &&\n                                fromCol <= selection.range.endColumn\n                        );\n\n                        if (!filteredSelections?.length) {\n                            return empty;\n                        }\n                        const sourceRange = filteredSelections[0].range;\n\n                        const targetRange: IRange = {\n                            ...sourceRange,\n                            startColumn: toCol,\n                            endColumn: toCol + sourceRange.endColumn - sourceRange.startColumn,\n                        };\n\n                        if (\n                            !freeze ||\n                            freeze.startColumn <= 0 ||\n                            // move out of freeze\n                            (sourceRange.startColumn >= freeze.startColumn &&\n                                targetRange.startColumn >= freeze.startColumn) ||\n                            // not move\n                            sourceRange.startColumn === targetRange.startColumn ||\n                            // move in freeze range\n                            (sourceRange.endColumn < freeze.startColumn && targetRange.startColumn < freeze.startColumn)\n                        ) {\n                            return empty;\n                        }\n\n                        const totalColCount = sourceRange.endColumn - sourceRange.startColumn + 1;\n                        const moveFreezeColCount = Math.max(\n                            Math.min(freeze.startColumn, sourceRange.endColumn + 1) - sourceRange.startColumn,\n                            0\n                        );\n\n                        let newStartColumn;\n                        let newXSplit;\n\n                        if (targetRange.startColumn >= freeze.startColumn) {\n                            newStartColumn = Math.max(freeze.startColumn - moveFreezeColCount, 1);\n                            newXSplit = Math.max(freeze.xSplit - moveFreezeColCount, 1);\n                        } else {\n                            newStartColumn = freeze.startColumn + totalColCount - moveFreezeColCount;\n                            newXSplit = freeze.xSplit + totalColCount - moveFreezeColCount;\n                        }\n\n                        const redoMutationParams = {\n                            ...freeze,\n                            startColumn: newStartColumn,\n                            xSplit: newXSplit,\n                        };\n\n                        return createFreezeMutationAndRefresh(redoMutationParams);\n                    }\n\n                    if (command.id === MoveRowsCommand.id) {\n                        const selections = this._selectionManagerService.getCurrentSelections();\n                        const {\n                            fromRange: { startRow: fromRow },\n                            toRange: { startRow: toRow },\n                        } = command.params as IMoveRowsCommandParams;\n                        const filteredSelections = selections?.filter(\n                            (selection) =>\n                                selection.range.rangeType === RANGE_TYPE.ROW &&\n                                selection.range.startRow <= fromRow &&\n                                fromRow <= selection.range.endRow\n                        );\n\n                        if (!filteredSelections?.length) {\n                            return empty;\n                        }\n                        const sourceRange = filteredSelections[0].range;\n\n                        const targetRange: IRange = {\n                            ...sourceRange,\n                            startRow: toRow,\n                            endRow: toRow + sourceRange.endRow - sourceRange.startRow,\n                        };\n\n                        if (\n                            !freeze ||\n                            freeze.startRow <= 0 ||\n                            // move out of freeze\n                            (sourceRange.startRow >= freeze.startRow && targetRange.startRow >= freeze.startRow) ||\n                            // not move\n                            sourceRange.startRow === targetRange.startRow ||\n                            // move in freeze range\n                            (sourceRange.endRow < freeze.startRow && targetRange.startRow < freeze.startRow)\n                        ) {\n                            return empty;\n                        }\n\n                        const totalColCount = sourceRange.endRow - sourceRange.startRow + 1;\n                        const moveFreezeColCount = Math.max(\n                            Math.min(freeze.startRow, sourceRange.endRow + 1) - sourceRange.startRow,\n                            0\n                        );\n\n                        let newStartRow;\n                        let newYSplit;\n\n                        if (targetRange.startRow >= freeze.startRow) {\n                            newStartRow = Math.max(freeze.startRow - moveFreezeColCount, 1);\n                            newYSplit = Math.max(freeze.ySplit - moveFreezeColCount, 1);\n                        } else {\n                            newStartRow = freeze.startRow + totalColCount - moveFreezeColCount;\n                            newYSplit = freeze.ySplit + totalColCount - moveFreezeColCount;\n                        }\n\n                        const redoMutationParams = {\n                            ...freeze,\n                            startRow: newStartRow,\n                            ySplit: newYSplit,\n                        };\n\n                        return createFreezeMutationAndRefresh(redoMutationParams);\n                    }\n\n                    if (command.id === RemoveColCommand.id || command.id === RemoveRowCommand.id) {\n                        const params = command.params as IRemoveRowColCommandParams;\n                        const range = params.range;\n\n                        if (range.rangeType === RANGE_TYPE.COLUMN && range.startColumn < freeze.startColumn) {\n                            const deleteFreezeColCount =\n                                Math.min(freeze.startColumn, range.endColumn + 1) - range.startColumn;\n\n                            const newFreeze: IFreeze = {\n                                ...freeze,\n                                startColumn: Math.max(1, freeze.startColumn - deleteFreezeColCount),\n                                xSplit: Math.max(1, freeze.xSplit - deleteFreezeColCount),\n                            };\n\n                            return createFreezeMutationAndRefresh(newFreeze);\n                        }\n\n                        if (params.range.rangeType === RANGE_TYPE.ROW && range.startRow < freeze.startRow) {\n                            const deleteFreezeRowCount = Math.min(freeze.startRow, range.endRow + 1) - range.startRow;\n\n                            const newFreeze: IFreeze = {\n                                ...freeze,\n                                startRow: Math.max(1, freeze.startRow - deleteFreezeRowCount),\n                                ySplit: Math.max(1, freeze.ySplit - deleteFreezeRowCount),\n                            };\n\n                            return createFreezeMutationAndRefresh(newFreeze);\n                        }\n                    }\n\n                    return empty;\n                },\n            })\n        );\n    }\n\n    /**\n     * Update freeze line position when some cmds cause sk change.\n     */\n    // TODO @lumixraku But there is a _zoomRefresh method? Duplicated?\n    private _commandExecutedListener() {\n        this.disposeWithMe(\n            // eslint-disable-next-line complexity\n            this._commandService.onCommandExecuted((command: ICommandInfo) => {\n                switch (command.id) {\n                    case SetFrozenMutation.id:\n                    case SetZoomRatioOperation.id:\n                        {\n                            const lastFreeze = this._lastFreeze;\n                            const workbook = this._context.unit;\n                            const worksheet = workbook.getActiveSheet();\n                            const params = command.params as ISetFrozenMutationParams;\n                            const { unitId, subUnitId } = params;\n                            if (!(unitId === workbook.getUnitId() && subUnitId === worksheet?.getSheetId())) {\n                                return;\n                            }\n\n                            const freeze = worksheet.getConfig().freeze;\n                            this._lastFreeze = freeze;\n                            if (freeze == null) {\n                                return;\n                            }\n\n                            let resetScroll = ResetScrollType.NONE;\n\n                            const { startRow = -1, startColumn = -1, ySplit = 0, xSplit = 0 } = freeze;\n                            if (!lastFreeze || lastFreeze.startRow !== startRow || lastFreeze.ySplit !== ySplit) {\n                                resetScroll |= ResetScrollType.Y;\n                            }\n                            if (!lastFreeze || lastFreeze.startColumn !== startColumn || lastFreeze.xSplit !== xSplit) {\n                                resetScroll |= ResetScrollType.X;\n                            }\n                            if (params.resetScroll === false) {\n                                resetScroll = ResetScrollType.NONE;\n                            }\n                            this._refreshFreeze(startRow, startColumn, ySplit, xSplit, resetScroll);\n                        }\n                        break;\n\n                    case SetWorksheetRowHeightMutation.id:\n                        {\n                            const freeze = this._getFreeze();\n                            const isRefresh = freeze && (command.params as ISetWorksheetRowHeightMutationParams).ranges.some((i) => i.startRow < freeze.startRow);\n                            if (command.params && isRefresh) {\n                                this._refreshCurrent();\n                            }\n                        }\n                        break;\n                    case SetWorksheetColWidthMutation.id:\n                        {\n                            const freeze = this._getFreeze();\n                            if (command.params && freeze && (command.params as ISetWorksheetColWidthMutationParams).ranges.some(\n                                (i) => i.startColumn < freeze.startColumn\n                            )) {\n                                this._refreshCurrent();\n                            }\n                        }\n                        break;\n                    case SetWorksheetRowAutoHeightMutation.id:\n                        {\n                            const params = command.params as ISetWorksheetRowAutoHeightMutationParams;\n                            const freeze = this._getFreeze();\n\n                            if (freeze && freeze.startRow > -1 && params.rowsAutoHeightInfo.some((info) => info.row < freeze.startRow)) {\n                                const subscription = this._sheetSkeletonManagerService.currentSkeleton$.subscribe(() => {\n                                    this._refreshCurrent();\n                                    setTimeout(() => {\n                                        subscription.unsubscribe();\n                                    });\n                                });\n                            }\n                        }\n                        break;\n                    case SetColHiddenMutation.id:\n                    case SetColVisibleMutation.id:\n                        {\n                            const params = command.params as ISetColHiddenMutationParams;\n                            const freeze = this._getFreeze();\n                            const ranges = params.ranges;\n                            if (freeze && freeze.startColumn > -1 && ranges.some((range) => range.startColumn < freeze.startColumn)) {\n                                this._refreshCurrent();\n                            }\n                        }\n                        break;\n                    case SetRowHiddenMutation.id:\n                    case SetRowVisibleMutation.id:\n                        {\n                            const params = command.params as ISetRowHiddenMutationParams;\n                            const freeze = this._getFreeze();\n                            const ranges = params.ranges;\n                            if (freeze && freeze.startRow > -1 && ranges.some((range) => range.startRow < freeze.startRow)) {\n                                this._refreshCurrent();\n                            }\n                        }\n                        break;\n                    case SetRowHeaderWidthCommand.id:\n                    case SetColumnHeaderHeightCommand.id:\n                        this._refreshCurrent();\n                }\n            })\n        );\n    }\n\n    private _zoomRefresh() {\n        const sheetObject = this._getSheetObject();\n        if (sheetObject == null) {\n            return;\n        }\n        const { scene } = sheetObject;\n\n        this.disposeWithMe(scene.onTransformChange$.subscribeEvent((state) => {\n            if (![TRANSFORM_CHANGE_OBSERVABLE_TYPE.scale, TRANSFORM_CHANGE_OBSERVABLE_TYPE.all].includes(state.type)) {\n                return;\n            }\n            this._refreshCurrent();\n        }));\n    }\n\n    private _clearObserverEvent() {\n        const sheetObject = this._getSheetObject();\n        if (sheetObject == null) {\n            return;\n        }\n        // const { scene } = sheetObject;\n        // scene.onPointerMove$.remove(this._moveObserver);\n        // scene.onPointerUp$.remove(this._scenePointerUpSub);\n        this._scenePointerMoveSub?.unsubscribe();\n        this._scenePointerUpSub?.unsubscribe();\n        this._scenePointerMoveSub = null;\n        this._scenePointerUpSub = null;\n    }\n\n    private _clearFreeze() {\n        this._rowFreezeHeaderRect?.dispose();\n        this._rowFreezeMainRect?.dispose();\n        this._columnFreezeHeaderRect?.dispose();\n        this._columnFreezeMainRect?.dispose();\n\n        const sheetObject = this._getSheetObject();\n        if (sheetObject == null) {\n            return;\n        }\n\n        [this._freezeDownSubs, this._freezePointerEnterSubs, this._freezePointerLeaveSubs].forEach((s) => {\n            s?.unsubscribe();\n        });\n        // TODO @lumixraku\n        this._freezeDownSubs = null;\n        this._freezePointerEnterSubs = null;\n        this._freezePointerLeaveSubs = null;\n        this._scenePointerMoveSub?.unsubscribe();\n        this._scenePointerUpSub?.unsubscribe();\n        this._scenePointerMoveSub = null;\n        this._scenePointerUpSub = null;\n    }\n\n    private _getPositionByIndex(row: number, column: number) {\n        const sheetObject = this._getSheetObject();\n        if (sheetObject == null) {\n            return;\n        }\n\n        const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n        const position = skeleton?.getNoMergeCellWithCoordByIndex(row, column);\n        if (skeleton == null) {\n            return;\n        }\n\n        if (position != null && (!isNaN(position.endX) || !isNaN(position.endY))) {\n            return position;\n        }\n        const { rowHeaderWidthAndMarginLeft, columnHeaderHeightAndMarginTop } = skeleton;\n\n        return {\n            startX: rowHeaderWidthAndMarginLeft,\n            endX: rowHeaderWidthAndMarginLeft,\n            startY: columnHeaderHeightAndMarginTop,\n            endY: columnHeaderHeightAndMarginTop,\n        };\n    }\n\n    private _getFreeze() {\n        const config: IWorksheetData | undefined = this._sheetSkeletonManagerService\n            .getCurrentParam()\n            ?.skeleton\n            .getWorksheetConfig();\n\n        if (config == null) {\n            return;\n        }\n\n        return config.freeze;\n    }\n\n    private _getSheetObject() {\n        return getSheetObject(this._context.unit, this._context);\n    }\n\n    /**\n     * Core function of _refreshCurrent\n     * @param startRow\n     * @param startColumn\n     * @param ySplit\n     * @param xSplit\n     * @param resetScroll\n     */\n    private _refreshFreeze(\n        startRow: number,\n        startColumn: number,\n        ySplit: number,\n        xSplit: number,\n        resetScroll?: ResetScrollType\n    ) {\n        const newFreeze = {\n            startRow,\n            startColumn,\n            ySplit,\n            xSplit,\n        };\n        this._clearFreeze();\n\n        this._createFreeze(FREEZE_DIRECTION_TYPE.ROW, newFreeze);\n        this._createFreeze(FREEZE_DIRECTION_TYPE.COLUMN, newFreeze);\n\n        this._updateViewport(startRow, startColumn, ySplit, xSplit, resetScroll);\n        this._getSheetObject()?.spreadsheet.makeForceDirty();\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type {\n    EventState,\n    IRange,\n    Nullable,\n    Workbook,\n} from '@univerjs/core';\nimport type { IMouseEvent, IPointerEvent, IRenderContext, IRenderModule, SpreadsheetColumnHeader, SpreadsheetHeader } from '@univerjs/engine-render';\nimport type { IMoveColsCommandParams, IMoveRowsCommandParams, ISelectionWithStyle, WorkbookSelectionModel } from '@univerjs/sheets';\nimport {\n    createInterceptorKey,\n    Disposable,\n    ICommandService,\n    Inject,\n    InterceptorManager,\n    RANGE_TYPE,\n} from '@univerjs/core';\nimport {\n    CURSOR_TYPE,\n    Rect,\n    ScrollTimer,\n    ScrollTimerType,\n    SHEET_VIEWPORT_KEY,\n    Vector2,\n} from '@univerjs/engine-render';\nimport {\n    MoveColsCommand,\n    MoveRowsCommand,\n    SheetsSelectionsService,\n} from '@univerjs/sheets';\n\nimport { Subscription } from 'rxjs';\nimport { SHEET_COMPONENT_HEADER_LAYER_INDEX, SHEET_VIEW_KEY } from '../../common/keys';\nimport { SheetSkeletonManagerService } from '../../services/sheet-skeleton-manager.service';\nimport { getCoordByOffset } from '../utils/component-tools';\nimport { matchedSelectionByRowColIndex } from '../utils/selections-tools';\n\nconst HEADER_MOVE_CONTROLLER_BACKGROUND = '__SpreadsheetHeaderMoveControllerBackground__';\nconst HEADER_MOVE_CONTROLLER_LINE = '__SpreadsheetHeaderMoveControllerShapeLine__';\nconst HEADER_MOVE_CONTROLLER_BACKGROUND_FILL = 'rgba(0, 0, 0, 0.1)';\nconst HEADER_MOVE_CONTROLLER_LINE_FILL = 'rgb(119, 119, 119)';\nconst HEADER_MOVE_CONTROLLER_LINE_SIZE = 4;\nexport const HEADER_MOVE_PERMISSION_CHECK = createInterceptorKey<boolean, IRange>('headerMovePermissionCheck');\n\nexport class HeaderMoveRenderController extends Disposable implements IRenderModule {\n    private _startOffsetX: number = Number.NEGATIVE_INFINITY;\n    private _startOffsetY: number = Number.NEGATIVE_INFINITY;\n\n    private _moveHelperBackgroundShape: Nullable<Rect>;\n    private _moveHelperLineShape: Nullable<Rect>;\n\n    private _headerPointerDownSubs: Nullable<Subscription>;\n    private _headerPointerMoveSubs: Nullable<Subscription>;\n    private _headerPointerLeaveSubs: Nullable<Subscription>;\n\n    private _dragHeaderMoveSub: Nullable<Subscription>;\n    private _scenePointerUpSub: Nullable<Subscription>;\n\n    private _scrollTimer: Nullable<ScrollTimer>;\n\n    private _changeFromColumn = -1;\n    private _changeFromRow = -1;\n    private _changeToColumn = -1;\n    private _changeToRow = -1;\n\n    public readonly interceptor = new InterceptorManager({ HEADER_MOVE_PERMISSION_CHECK });\n\n    private readonly _workbookSelections: WorkbookSelectionModel;\n\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(SheetsSelectionsService) selectionManagerService: SheetsSelectionsService,\n        @Inject(SheetSkeletonManagerService) private readonly _sheetSkeletonManagerService: SheetSkeletonManagerService,\n        @ICommandService private readonly _commandService: ICommandService\n    ) {\n        super();\n\n        this._workbookSelections = selectionManagerService.getWorkbookSelections(this._context.unitId);\n        this._init();\n    }\n\n    override dispose(): void {\n        this._moveHelperBackgroundShape?.dispose();\n        this._moveHelperLineShape?.dispose();\n\n        this._headerPointerMoveSubs?.unsubscribe();\n        this._headerPointerLeaveSubs?.unsubscribe();\n        this._headerPointerDownSubs?.unsubscribe();\n        this._headerPointerMoveSubs = null;\n        this._headerPointerLeaveSubs = null;\n        this._headerPointerDownSubs = null;\n\n        // scene.onPointerMove$.remove(this._scenePointerMoveSub);\n        // scene.onPointerUp$.remove(this._scenePointerUpSub);\n        this._dragHeaderMoveSub?.unsubscribe();\n        this._scenePointerUpSub?.unsubscribe();\n        this._dragHeaderMoveSub = null;\n        this._scenePointerUpSub = null;\n        this._scrollTimer?.dispose();\n    }\n\n    private _init() {\n        this._initialRowOrColumn(RANGE_TYPE.ROW);\n        this._initialRowOrColumn(RANGE_TYPE.COLUMN);\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    private _initialRowOrColumn(initialType: RANGE_TYPE.ROW | RANGE_TYPE.COLUMN = RANGE_TYPE.ROW) {\n        const spreadsheetColumnHeader = this._context.components.get(SHEET_VIEW_KEY.COLUMN) as SpreadsheetColumnHeader;\n        const spreadsheetRowHeader = this._context.components.get(SHEET_VIEW_KEY.ROW) as SpreadsheetHeader;\n        const scene = this._context.scene;\n        const eventBindingObject =\n            initialType === RANGE_TYPE.ROW ? spreadsheetRowHeader : spreadsheetColumnHeader;\n\n        // only style cursor style when pointer move\n        const pointerMoveHandler = (evt: IPointerEvent | IMouseEvent) => {\n            const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n            if (skeleton == null) {\n                return;\n            }\n\n            const selectionRange = this._workbookSelections.getCurrentLastSelection()?.range;\n            if (!selectionRange) return;\n\n            const permissionCheck = this.interceptor.fetchThroughInterceptors(HEADER_MOVE_PERMISSION_CHECK)(false, selectionRange);\n\n            if (!permissionCheck) {\n                return;\n            }\n\n            const currentSelections = this._workbookSelections.getCurrentSelections();\n            const { row, column } = getCoordByOffset(evt.offsetX, evt.offsetY, scene, skeleton);\n            const matchSelectionData = matchedSelectionByRowColIndex(\n                currentSelections,\n                initialType === RANGE_TYPE.ROW ? row : column,\n                initialType\n            );\n\n            if (!matchSelectionData) {\n                scene.resetCursor();\n                return;\n            }\n\n            scene.setCursor(CURSOR_TYPE.GRAB);\n        };\n\n        const pointerLeaveHandler = () => {\n            this._moveHelperBackgroundShape?.hide();\n            this._moveHelperLineShape?.hide();\n            scene.resetCursor();\n        };\n\n        // eslint-disable-next-line max-lines-per-function\n        const pointerDownHandler = (evt: IPointerEvent | IMouseEvent, state: EventState) => {\n            if (state.isStopPropagation) return;\n\n            const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n            if (skeleton == null) {\n                return;\n            }\n\n            const selectionRange = this._workbookSelections.getCurrentLastSelection()?.range;\n            if (!selectionRange) return;\n\n            const permissionCheck = this.interceptor.fetchThroughInterceptors(HEADER_MOVE_PERMISSION_CHECK)(false, selectionRange);\n            if (!permissionCheck) {\n                return;\n            }\n\n            const { offsetX: evtOffsetX, offsetY: evtOffsetY } = evt;\n\n            const relativeCoords = scene.getCoordRelativeToViewport(Vector2.FromArray([evtOffsetX, evtOffsetY]));\n\n            const { x: newEvtOffsetX, y: newEvtOffsetY } = relativeCoords;\n\n            this._startOffsetX = newEvtOffsetX;\n\n            this._startOffsetY = newEvtOffsetY;\n\n            const { row, column } = getCoordByOffset(evt.offsetX, evt.offsetY, scene, skeleton);\n\n            let scrollType: ScrollTimerType;\n\n            if (initialType === RANGE_TYPE.ROW) {\n                this._changeFromRow = row;\n                scrollType = ScrollTimerType.Y;\n            } else {\n                this._changeFromColumn = column;\n                scrollType = ScrollTimerType.X;\n            }\n\n            const currentSelections = this._workbookSelections.getCurrentSelections();\n            const matchSelectionData = matchedSelectionByRowColIndex(\n                currentSelections,\n                initialType === RANGE_TYPE.ROW ? row : column,\n                initialType\n            );\n\n            if (!matchSelectionData) {\n                return;\n            }\n            // if matchSelectionData true, then into grab header mode.\n\n            const startScrollXY = scene.getScrollXYInfoByViewport(\n                Vector2.FromArray([this._startOffsetX, this._startOffsetY])\n            );\n\n            this._newBackgroundAndLine();\n\n            scene.setCursor(CURSOR_TYPE.GRABBING);\n\n            scene.disableObjectsEvent();\n\n            let scrollTimerInitd = false;\n            let scrollTimer: ScrollTimer;\n\n            const initScrollTimer = () => {\n                if (scrollTimerInitd) {\n                    return;\n                }\n\n                scrollTimer = ScrollTimer.create(scene, scrollType);\n                this._scrollTimer = scrollTimer;\n                const mainViewport = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n                scrollTimer.startScroll(newEvtOffsetX, newEvtOffsetY, mainViewport);\n                scrollTimerInitd = true;\n            };\n\n            this._dragHeaderMoveSub = scene.onPointerMove$.subscribeEvent((moveEvt: IPointerEvent | IMouseEvent) => {\n                initScrollTimer();\n                const { offsetX: moveOffsetX, offsetY: moveOffsetY } = moveEvt;\n\n                const { x: newMoveOffsetX, y: newMoveOffsetY } = scene.getCoordRelativeToViewport(\n                    Vector2.FromArray([moveOffsetX, moveOffsetY])\n                );\n\n                // scene.setCursor(CURSOR_TYPE.GRABBING);\n\n                this._rowColumnMoving(\n                    newMoveOffsetX,\n                    newMoveOffsetY,\n                    matchSelectionData,\n                    startScrollXY,\n                    initialType\n                );\n\n                scrollTimer.scrolling(newMoveOffsetX, newMoveOffsetY, () => {\n                    this._rowColumnMoving(\n                        newMoveOffsetX,\n                        newMoveOffsetY,\n                        matchSelectionData,\n                        startScrollXY,\n                        initialType\n                    );\n                });\n            });\n\n            this._scenePointerUpSub = scene.onPointerUp$.subscribeEvent(() => {\n                this._disposeBackgroundAndLine();\n                scene.resetCursor();\n                scene.enableObjectsEvent();\n                this._clearObserverEvent();\n                this._scrollTimer?.dispose();\n\n                // when multi ranges are selected, we should only move the range that contains\n                // `changeFromRow`\n                const selections = this._workbookSelections.getCurrentSelections();\n\n                if (initialType === RANGE_TYPE.ROW) {\n                    if (this._changeFromRow !== this._changeToRow && this._changeToRow !== -1) {\n                        const filteredSelections =\n                            selections?.filter(\n                                (selection) =>\n                                    selection.range.rangeType === RANGE_TYPE.ROW &&\n                                    selection.range.startRow <= this._changeFromRow &&\n                                    this._changeFromRow <= selection.range.endRow\n                            ) || [];\n                        const range = filteredSelections[0]?.range;\n                        if (range) {\n                            this._commandService.executeCommand<IMoveRowsCommandParams>(MoveRowsCommand.id, {\n                                fromRange: range,\n                                toRange: {\n                                    ...range,\n                                    startRow: this._changeToRow,\n                                    endRow: this._changeToRow + range.endRow - range.startRow,\n                                },\n                            });\n                        }\n                    }\n\n                    // reset dragging status\n                    this._changeToRow = this._changeFromRow = -1;\n                } else {\n                    if (this._changeFromColumn !== this._changeToColumn && this._changeToColumn !== -1) {\n                        const filteredSelections =\n                            selections?.filter(\n                                (selection) =>\n                                    selection.range.rangeType === RANGE_TYPE.COLUMN &&\n                                    selection.range.startColumn <= this._changeFromColumn &&\n                                    this._changeFromColumn <= selection.range.endColumn\n                            ) || [];\n                        const range = filteredSelections[0]?.range;\n                        if (range) {\n                            this._commandService.executeCommand<IMoveColsCommandParams>(MoveColsCommand.id, {\n                                fromRange: range,\n                                toRange: {\n                                    ...range,\n                                    startColumn: this._changeToColumn,\n                                    endColumn: this._changeToColumn + range.endColumn - range.startColumn,\n                                },\n                            });\n                        }\n                    }\n\n                    this._changeToColumn = this._changeFromColumn = -1;\n                }\n            });\n        };\n        // if (initialType === HEADER_MOVE_TYPE.ROW) {\n        //     this._rowHeaderPointerMoveSub = spreadsheetRowHeader.onPointerMove$.subscribeEvent(pointerMoveHandler);\n        // } else {\n        //     this._colHeaderPointerMoveSub = spreadsheetColumnHeader.onPointerMove$.subscribeEvent(pointerMoveHandler);\n        // }\n\n        this._headerPointerMoveSubs = new Subscription();\n        this._headerPointerMoveSubs.add(eventBindingObject.onPointerMove$.subscribeEvent(pointerMoveHandler));\n\n        this._headerPointerLeaveSubs = new Subscription();\n        this._headerPointerLeaveSubs.add(eventBindingObject?.onPointerLeave$.subscribeEvent(pointerLeaveHandler));\n\n        this._headerPointerDownSubs = new Subscription();\n        this._headerPointerDownSubs.add(eventBindingObject?.onPointerDown$.subscribeEvent(pointerDownHandler));\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    private _rowColumnMoving(\n        moveOffsetX: number,\n        moveOffsetY: number,\n        matchSelectionData: ISelectionWithStyle,\n        startScrollXY: {\n            x: number;\n            y: number;\n        },\n        initialType: RANGE_TYPE.ROW | RANGE_TYPE.COLUMN\n    ) {\n        const scene = this._context.scene;\n        const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n        if (skeleton == null) {\n            return;\n        }\n\n        const { rowHeaderWidth, columnHeaderHeight, rowTotalHeight, columnTotalWidth } = skeleton;\n\n        // const scrollXY = scene.getScrollXYByRelativeCoords(Vector2.FromArray([this._startOffsetX, this._startOffsetY]));\n        const scrollXY = scene.getViewportScrollXY(scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN)!);\n        const { scaleX, scaleY } = scene.getAncestorScale();\n\n        const moveActualSelection = skeleton.getCellIndexByOffset(\n            moveOffsetX,\n            moveOffsetY,\n            scaleX,\n            scaleY,\n            scrollXY\n        );\n\n        const { row, column } = moveActualSelection;\n\n        const startCell = skeleton.getNoMergeCellWithCoordByIndex(row, column);\n\n        const { startX: cellStartX, startY: cellStartY, endX: cellEndX, endY: cellEndY } = startCell;\n\n        const selectionWithCoord = this._sheetSkeletonManagerService.attachRangeWithCoord(matchSelectionData.range);\n\n        if (selectionWithCoord == null) {\n            return;\n        }\n\n        const scale = Math.max(scaleX, scaleX);\n\n        const {\n            startX: selectedStartX,\n            endX: selectedEndX,\n            startY: selectedStartY,\n            endY: selectedEndY,\n\n            startRow: selectedStartRow,\n            startColumn: selectedStartColumn,\n            endRow: selectedEndRow,\n            endColumn: selectedEndColumn,\n        } = selectionWithCoord;\n\n        if (initialType === RANGE_TYPE.ROW) {\n            this._moveHelperBackgroundShape?.transformByState({\n                height: selectedEndY - selectedStartY,\n                width: columnTotalWidth + rowHeaderWidth,\n                left: 0,\n                top: selectedStartY + (moveOffsetY - this._startOffsetY) / scale + scrollXY.y - startScrollXY.y,\n            });\n        } else {\n            this._moveHelperBackgroundShape?.transformByState({\n                height: rowTotalHeight + columnHeaderHeight,\n                width: selectedEndX - selectedStartX,\n                left: selectedStartX + (moveOffsetX - this._startOffsetX) / scale + scrollXY.x - startScrollXY.x,\n                top: 0,\n            });\n        }\n\n        this._moveHelperBackgroundShape?.show();\n\n        const HEADER_MOVE_CONTROLLER_LINE_SIZE_SCALE = HEADER_MOVE_CONTROLLER_LINE_SIZE / scale;\n\n        if (initialType === RANGE_TYPE.ROW) {\n            let top = 0;\n            if (row <= selectedStartRow) {\n                top = cellStartY - HEADER_MOVE_CONTROLLER_LINE_SIZE_SCALE / 2;\n                this._changeToRow = row;\n            } else if (row > selectedEndRow) {\n                top = cellEndY - HEADER_MOVE_CONTROLLER_LINE_SIZE_SCALE / 2;\n                this._changeToRow = row + 1;\n            } else {\n                return;\n            }\n\n            this._moveHelperLineShape?.transformByState({\n                height: HEADER_MOVE_CONTROLLER_LINE_SIZE_SCALE,\n                width: columnTotalWidth,\n                left: rowHeaderWidth,\n                top,\n            });\n        } else {\n            let left = 0;\n            if (column <= selectedStartColumn) {\n                left = cellStartX - HEADER_MOVE_CONTROLLER_LINE_SIZE_SCALE / 2;\n                this._changeToColumn = column;\n            } else if (column > selectedEndColumn) {\n                left = cellEndX - HEADER_MOVE_CONTROLLER_LINE_SIZE_SCALE / 2;\n                this._changeToColumn = column + 1;\n            } else {\n                return;\n            }\n\n            this._moveHelperLineShape?.transformByState({\n                height: rowTotalHeight,\n                width: HEADER_MOVE_CONTROLLER_LINE_SIZE_SCALE,\n                left,\n                top: columnHeaderHeight,\n            });\n        }\n\n        this._moveHelperLineShape?.show();\n    }\n\n    private _clearObserverEvent() {\n        // const scene = this._context.scene;\n        // scene.onPointerMove$.remove(this._scenePointerMoveSub);\n        // scene.onPointerUp$.remove(this._scenePointerUpSub);\n        this._dragHeaderMoveSub?.unsubscribe();\n        this._scenePointerUpSub?.unsubscribe();\n        this._dragHeaderMoveSub = null;\n        this._scenePointerUpSub = null;\n    }\n\n    private _newBackgroundAndLine() {\n        const scene = this._context.scene;\n        this._moveHelperBackgroundShape = new Rect(HEADER_MOVE_CONTROLLER_BACKGROUND, {\n            fill: HEADER_MOVE_CONTROLLER_BACKGROUND_FILL,\n            evented: false,\n            zIndex: 100,\n        });\n\n        this._moveHelperLineShape = new Rect(HEADER_MOVE_CONTROLLER_LINE, {\n            fill: HEADER_MOVE_CONTROLLER_LINE_FILL,\n            evented: false,\n            zIndex: 100,\n        });\n        scene.addObjects(\n            [this._moveHelperBackgroundShape, this._moveHelperLineShape],\n            SHEET_COMPONENT_HEADER_LAYER_INDEX\n        );\n    }\n\n    private _disposeBackgroundAndLine() {\n        this._moveHelperBackgroundShape?.dispose();\n        this._moveHelperLineShape?.dispose();\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IShapeProps, UniverRenderingContext } from '@univerjs/engine-render';\nimport { Rect, Shape } from '@univerjs/engine-render';\n\nexport interface IHeaderMenuShapeResizeProps extends IShapeProps {\n    size?: number;\n    mode?: HEADER_RESIZE_SHAPE_TYPE;\n    color?: string;\n}\n\nexport enum HEADER_RESIZE_SHAPE_TYPE {\n    VERTICAL,\n    HORIZONTAL,\n}\n\nexport const HEADER_MENU_SHAPE_RECT_BACKGROUND_FILL = 'rgba(120, 120, 120, 0.01)';\n\nexport const HEADER_MENU_SHAPE_RECT_FILL = 'rgb(68, 71, 70)';\n\nexport const HEADER_MENU_SHAPE_SIZE = 12;\n\nexport const MAX_HEADER_MENU_SHAPE_SIZE = 44;\n\nexport const HEADER_MENU_SHAPE_THUMB_SIZE = 4;\n\nexport class HeaderMenuResizeShape<\n    T extends IHeaderMenuShapeResizeProps = IHeaderMenuShapeResizeProps\n> extends Shape<T> {\n    private _size: number = HEADER_MENU_SHAPE_SIZE;\n\n    private _color: string = HEADER_MENU_SHAPE_RECT_FILL;\n\n    private _mode: HEADER_RESIZE_SHAPE_TYPE = HEADER_RESIZE_SHAPE_TYPE.VERTICAL;\n\n    constructor(key?: string, props?: T) {\n        super(key, props);\n        this.setShapeProps(props);\n    }\n\n    get size() {\n        return this._size;\n    }\n\n    get mode() {\n        return this._mode;\n    }\n\n    get color() {\n        return this._color;\n    }\n\n    protected override _draw(ctx: UniverRenderingContext) {\n        const scene = this.getScene();\n        if (!scene) return;\n\n        const { scaleX, scaleY } = scene.getAncestorScale();\n        const scale = Math.max(scaleX, scaleY);\n        const HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE = HEADER_MENU_SHAPE_SIZE / scale;\n        const HEADER_MENU_SHAPE_THUMB_SIZE_SCALE = HEADER_MENU_SHAPE_THUMB_SIZE / scale;\n\n        let { width, height } = this;\n        let left = 0;\n        let top = 0;\n        if (this.mode === HEADER_RESIZE_SHAPE_TYPE.VERTICAL) {\n            width = HEADER_MENU_SHAPE_THUMB_SIZE_SCALE;\n            left = HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE - HEADER_MENU_SHAPE_THUMB_SIZE_SCALE;\n        } else {\n            height = HEADER_MENU_SHAPE_THUMB_SIZE_SCALE;\n            top = HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE - HEADER_MENU_SHAPE_THUMB_SIZE_SCALE;\n        }\n\n        // background\n        Rect.drawWith(ctx, {\n            width: this.width,\n            height: this.height,\n            left: 0,\n            top: 0,\n            fill: HEADER_MENU_SHAPE_RECT_BACKGROUND_FILL,\n        });\n\n        // left or top\n        Rect.drawWith(ctx, {\n            width,\n            height,\n            fill: HEADER_MENU_SHAPE_RECT_FILL,\n            radius: HEADER_MENU_SHAPE_THUMB_SIZE_SCALE,\n        });\n\n        ctx.save();\n        ctx.transform(1, 0, 0, 1, left, top);\n\n        // right or bottom\n        Rect.drawWith(ctx, {\n            width,\n            height,\n            fill: HEADER_MENU_SHAPE_RECT_FILL,\n            radius: HEADER_MENU_SHAPE_THUMB_SIZE_SCALE,\n        });\n\n        ctx.restore();\n    }\n\n    setShapeProps(props?: T) {\n        if (props?.size) {\n            this._size = props.size;\n        }\n\n        if (props?.mode) {\n            this._mode = props.mode;\n        }\n\n        if (props?.color) {\n            this._color = props.color;\n        }\n\n        if (this.mode === HEADER_RESIZE_SHAPE_TYPE.VERTICAL) {\n            this.transformByState({\n                width: HEADER_MENU_SHAPE_SIZE,\n                height: this.size,\n            });\n        } else {\n            this.transformByState({\n                width: this.size,\n                height: HEADER_MENU_SHAPE_SIZE,\n            });\n        }\n\n        return this;\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-lines-per-function */\n/* eslint-disable complexity */\n\nimport type { EventState, IRange, Nullable, Workbook } from '@univerjs/core';\nimport type { IMouseEvent, IPointerEvent, IRenderContext, IRenderModule, SpreadsheetColumnHeader, SpreadsheetHeader } from '@univerjs/engine-render';\nimport type {\n    IDeltaColumnWidthCommandParams,\n    IDeltaRowHeightCommand,\n    ISetWorksheetRowIsAutoHeightCommandParams,\n} from '@univerjs/sheets';\nimport type { ISetWorksheetColIsAutoWidthCommandParams } from '../../commands/commands/set-worksheet-auto-col-width.command';\nimport {\n    createInterceptorKey,\n    Disposable,\n    ICommandService,\n    Inject,\n    InterceptorManager,\n    RANGE_TYPE,\n} from '@univerjs/core';\nimport { CURSOR_TYPE, Rect, SHEET_VIEWPORT_KEY, Vector2 } from '@univerjs/engine-render';\n\nimport {\n    DeltaColumnWidthCommand,\n    DeltaRowHeightCommand,\n    SetWorksheetRowIsAutoHeightCommand,\n    SheetsSelectionsService,\n} from '@univerjs/sheets';\nimport { Subscription } from 'rxjs';\nimport { SetWorksheetColAutoWidthCommand } from '../../commands/commands/set-worksheet-auto-col-width.command';\nimport { SHEET_COMPONENT_HEADER_LAYER_INDEX, SHEET_VIEW_KEY } from '../../common/keys';\nimport { SheetSkeletonManagerService } from '../../services/sheet-skeleton-manager.service';\nimport {\n    HEADER_MENU_SHAPE_SIZE,\n    HEADER_MENU_SHAPE_THUMB_SIZE,\n    HEADER_RESIZE_SHAPE_TYPE,\n    HeaderMenuResizeShape,\n    MAX_HEADER_MENU_SHAPE_SIZE,\n} from '../../views/header-resize-shape';\nimport { getCoordByOffset, getTransformCoord } from '../utils/component-tools';\n\nconst HEADER_RESIZE_CONTROLLER_SHAPE_ROW = '__SpreadsheetHeaderResizeControllerShapeRow__';\n\nconst HEADER_RESIZE_CONTROLLER_SHAPE_COLUMN = '__SpreadsheetHeaderResizeControllerShapeColumn__';\n\nconst HEADER_RESIZE_CONTROLLER_SHAPE_HELPER = '__SpreadsheetHeaderResizeControllerShapeHelper__';\n\nconst HEADER_RESIZE_CONTROLLER_SHAPE_HELPER_COLOR = 'rgb(199, 199, 199)';\n\n// The minimum move offset of header resize bar, less than this value will not be triggered any actions.\nconst MINIMAL_OFFSET = 2;\n\nenum HEADER_RESIZE_TYPE {\n    ROW,\n    COLUMN,\n}\n\nexport const HEADER_RESIZE_PERMISSION_CHECK = createInterceptorKey<boolean, { row?: number; col?: number }>('headerResizePermissionCheck');\n\nexport class HeaderResizeRenderController extends Disposable implements IRenderModule {\n    private _currentRow: number = 0;\n\n    private _currentColumn: number = 0;\n\n    private _rowResizeRect: Nullable<HeaderMenuResizeShape>;\n\n    private _columnResizeRect: Nullable<HeaderMenuResizeShape>;\n\n    private _headerPointerSubs: Nullable<Subscription>;\n    // private _colHeaderPointerSubs: Array<Subscription>;\n\n    private _scenePointerMoveSub: Nullable<Subscription>;\n\n    private _scenePointerUpSub: Nullable<Subscription>;\n\n    private _resizeHelperShape: Nullable<Rect>;\n\n    private _startOffsetX: number = Number.POSITIVE_INFINITY;\n\n    private _startOffsetY: number = Number.POSITIVE_INFINITY;\n\n    public interceptor = new InterceptorManager({ HEADER_RESIZE_PERMISSION_CHECK });\n\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(SheetSkeletonManagerService) private readonly _sheetSkeletonManagerService: SheetSkeletonManagerService,\n        @Inject(SheetsSelectionsService) private readonly _selectionManagerService: SheetsSelectionsService,\n        @ICommandService private readonly _commandService: ICommandService\n    ) {\n        super();\n\n        this._init();\n    }\n\n    override dispose(): void {\n        this._rowResizeRect?.dispose();\n        this._rowResizeRect = null;\n\n        this._columnResizeRect?.dispose();\n        this._columnResizeRect = null;\n\n        this._headerPointerSubs?.unsubscribe();\n        this._headerPointerSubs = null;\n    }\n\n    private _init() {\n        const scene = this._context.scene;\n\n        this._rowResizeRect = new HeaderMenuResizeShape(HEADER_RESIZE_CONTROLLER_SHAPE_ROW, {\n            visible: false,\n            mode: HEADER_RESIZE_SHAPE_TYPE.HORIZONTAL,\n            zIndex: 100,\n        });\n\n        this._columnResizeRect = new HeaderMenuResizeShape(HEADER_RESIZE_CONTROLLER_SHAPE_COLUMN, {\n            visible: false,\n            mode: HEADER_RESIZE_SHAPE_TYPE.VERTICAL,\n            zIndex: 100,\n        });\n\n        scene.addObjects([this._rowResizeRect, this._columnResizeRect], SHEET_COMPONENT_HEADER_LAYER_INDEX);\n\n        this._initialHover(HEADER_RESIZE_TYPE.ROW);\n\n        this._initialHover(HEADER_RESIZE_TYPE.COLUMN);\n\n        this._initialHoverResize(HEADER_RESIZE_TYPE.ROW);\n\n        this._initialHoverResize(HEADER_RESIZE_TYPE.COLUMN);\n    }\n\n    private _initialHover(initialType: HEADER_RESIZE_TYPE = HEADER_RESIZE_TYPE.ROW) {\n        const spreadsheetColumnHeader = this._context.components.get(SHEET_VIEW_KEY.COLUMN) as SpreadsheetColumnHeader;\n        const spreadsheetRowHeader = this._context.components.get(SHEET_VIEW_KEY.ROW) as SpreadsheetHeader;\n        const scene = this._context.scene;\n\n        const eventBindingObject =\n            initialType === HEADER_RESIZE_TYPE.ROW ? spreadsheetRowHeader : spreadsheetColumnHeader;\n\n        // this._observers.push(\n        //     eventBindingObject?.onPointerMoveObserver.add((evt: IPointerEvent |\n        //     eventBindingObject?.onPointerLeave$.subscribeEvent()\n        // );\n        const pointerLeaveEvent = (_evt: IPointerEvent | IMouseEvent, _state: EventState) => {\n            this._rowResizeRect?.hide();\n            this._columnResizeRect?.hide();\n        };\n\n        const pointerMoveEvent = (evt: IPointerEvent | IMouseEvent, _state: EventState) => {\n            const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n            if (skeleton == null || this._rowResizeRect == null || this._columnResizeRect == null) {\n                return;\n            }\n\n            const { rowHeaderWidth, columnHeaderHeight } = skeleton;\n\n            const { startX, startY, endX, endY, row, column } = getCoordByOffset(\n                evt.offsetX,\n                evt.offsetY,\n                scene,\n                skeleton\n            );\n\n            const transformCoord = getTransformCoord(evt.offsetX, evt.offsetY, scene, skeleton);\n\n            const { scaleX, scaleY } = scene.getAncestorScale();\n\n            const scale = Math.max(scaleX, scaleY);\n\n            const HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE = HEADER_MENU_SHAPE_SIZE / scale;\n\n            if (initialType === HEADER_RESIZE_TYPE.ROW) {\n                let top = startY - HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE / 2;\n\n                if (\n                    transformCoord.y <= startY + HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE / 2 &&\n                    transformCoord.y >= startY\n                ) {\n                    this._currentRow = row - 1;\n                } else if (\n                    transformCoord.y >= endY - HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE / 2 &&\n                    transformCoord.y <= endY\n                ) {\n                    this._currentRow = row;\n                    top = endY - HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE / 2;\n                } else {\n                    this._rowResizeRect.hide();\n                    return;\n                }\n\n                if (this._currentRow === -1) {\n                    return;\n                }\n\n                const permissionCheck = this.interceptor.fetchThroughInterceptors(HEADER_RESIZE_PERMISSION_CHECK)(null, { row: this._currentRow });\n                if (!permissionCheck) {\n                    return false;\n                }\n\n                const rowSize = Math.min(MAX_HEADER_MENU_SHAPE_SIZE, rowHeaderWidth / 3);\n\n                this._rowResizeRect.transformByState({\n                    left: rowHeaderWidth / 2 - rowSize / 2,\n                    top,\n                });\n\n                this._rowResizeRect.setShapeProps({\n                    size: rowSize,\n                });\n\n                this._rowResizeRect.show();\n            } else {\n                let left = startX - HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE / 2;\n\n                if (\n                    transformCoord.x <= startX + HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE / 2 &&\n                    transformCoord.x >= startX\n                ) {\n                    this._currentColumn = column - 1;\n                } else if (\n                    transformCoord.x >= endX - HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE / 2 &&\n                    transformCoord.x <= endX\n                ) {\n                    this._currentColumn = column;\n                    left = endX - HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE / 2;\n                } else {\n                    this._columnResizeRect.hide();\n                    return;\n                }\n\n                if (this._currentColumn === -1) {\n                    return;\n                }\n\n                const permissionCheck = this.interceptor.fetchThroughInterceptors(HEADER_RESIZE_PERMISSION_CHECK)(null, { col: this._currentColumn });\n                if (!permissionCheck) {\n                    return false;\n                }\n\n                // TODO: @jocs remove magic number.\n                const columnSize = columnHeaderHeight * 0.7;\n\n                this._columnResizeRect.transformByState({\n                    left,\n                    top: columnHeaderHeight / 2 - columnSize / 2,\n                });\n                this._columnResizeRect.setShapeProps({\n                    size: columnSize,\n                });\n                this._columnResizeRect.show();\n            }\n        };\n\n        this._headerPointerSubs = new Subscription();\n        this._headerPointerSubs.add(eventBindingObject?.onPointerMove$.subscribeEvent(pointerMoveEvent));\n        this._headerPointerSubs.add(eventBindingObject?.onPointerLeave$.subscribeEvent(pointerLeaveEvent));\n    }\n\n    private _initialHoverResize(initialType: HEADER_RESIZE_TYPE = HEADER_RESIZE_TYPE.ROW) {\n        const scene = this._context.scene;\n\n        const eventBindingObject =\n            initialType === HEADER_RESIZE_TYPE.ROW ? this._rowResizeRect : this._columnResizeRect;\n\n        if (eventBindingObject == null) {\n            return;\n        }\n\n        this.disposeWithMe(\n            eventBindingObject.onPointerEnter$.subscribeEvent(() => {\n                if (eventBindingObject == null) {\n                    return;\n                }\n\n                eventBindingObject.show();\n\n                scene.setCursor(\n                    initialType === HEADER_RESIZE_TYPE.ROW ? CURSOR_TYPE.ROW_RESIZE : CURSOR_TYPE.COLUMN_RESIZE\n                );\n            })\n        );\n\n        this.disposeWithMe(\n            eventBindingObject.onPointerLeave$.subscribeEvent(() => {\n                if (eventBindingObject == null) {\n                    return;\n                }\n\n                eventBindingObject.hide();\n\n                scene.resetCursor();\n            })\n        );\n\n        this.disposeWithMe(\n            eventBindingObject.onPointerDown$.subscribeEvent((evt: IPointerEvent | IMouseEvent) => {\n                const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n                if (skeleton == null) return;\n\n                const scene = this._context.scene;\n\n                const engine = scene.getEngine();\n                const canvasMaxHeight = engine?.height || 0;\n                const canvasMaxWidth = engine?.width || 0;\n                const viewPort = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n\n                const scrollBarHorizontalHeight = (viewPort?.getScrollBar()?.horizonScrollTrack?.height || 0) + 10;\n                const scrollBarVerticalWidth = (viewPort?.getScrollBar()?.verticalScrollTrack?.width || 0) + 10;\n                const transformCoord = getTransformCoord(evt.offsetX, evt.offsetY, scene, skeleton);\n                const { scaleX, scaleY } = scene.getAncestorScale();\n\n                this._startOffsetX = transformCoord.x;\n\n                this._startOffsetY = transformCoord.y;\n\n                const currentOffsetX = skeleton.getOffsetByColumn(this._currentColumn);\n                const currentOffsetY = skeleton.getOffsetByRow(this._currentRow);\n                const cell = skeleton.getNoMergeCellWithCoordByIndex(this._currentRow, this._currentColumn);\n\n                let isStartMove = false;\n                let moveChangeX = 0;\n                let moveChangeY = 0;\n\n                const { columnTotalWidth, rowHeaderWidth, rowTotalHeight, columnHeaderHeight } = skeleton;\n\n                const shapeWidth = canvasMaxWidth > columnTotalWidth + rowHeaderWidth\n                    ? canvasMaxWidth\n                    : columnTotalWidth + rowHeaderWidth;\n\n                const shapeHeight = canvasMaxHeight > rowTotalHeight + columnHeaderHeight\n                    ? canvasMaxHeight\n                    : rowTotalHeight + columnHeaderHeight;\n\n                const scale = Math.max(scaleX, scaleY);\n\n                const HEADER_MENU_SHAPE_THUMB_SIZE_SCALE = HEADER_MENU_SHAPE_THUMB_SIZE / scale;\n\n                if (initialType === HEADER_RESIZE_TYPE.ROW) {\n                    this._resizeHelperShape = new Rect(HEADER_RESIZE_CONTROLLER_SHAPE_HELPER, {\n                        width: shapeWidth,\n                        height: HEADER_MENU_SHAPE_THUMB_SIZE_SCALE,\n                        fill: HEADER_RESIZE_CONTROLLER_SHAPE_HELPER_COLOR,\n                        left: 0,\n                        top: currentOffsetY - HEADER_MENU_SHAPE_THUMB_SIZE_SCALE / 2,\n                    });\n                } else {\n                    this._resizeHelperShape = new Rect(HEADER_RESIZE_CONTROLLER_SHAPE_HELPER, {\n                        width: HEADER_MENU_SHAPE_THUMB_SIZE_SCALE,\n                        height: shapeHeight,\n                        fill: HEADER_RESIZE_CONTROLLER_SHAPE_HELPER_COLOR,\n                        left: currentOffsetX - HEADER_MENU_SHAPE_THUMB_SIZE_SCALE / 2,\n                        top: 0,\n                    });\n                }\n\n                const rowResizeRectX = this._columnResizeRect?.left || 0;\n                const rowResizeRectY = this._rowResizeRect?.top || 0;\n                scene.addObject(this._resizeHelperShape, SHEET_COMPONENT_HEADER_LAYER_INDEX);\n                scene.disableObjectsEvent();\n\n                this._scenePointerMoveSub = scene.onPointerMove$.subscribeEvent((moveEvt: IPointerEvent | IMouseEvent) => {\n                    const relativeCoords = scene.getCoordRelativeToViewport(\n                        Vector2.FromArray([this._startOffsetX, this._startOffsetY])\n                    );\n\n                    const scrollXY = scene.getScrollXYInfoByViewport(relativeCoords, viewPort);\n\n                    const transformCoord = getTransformCoord(moveEvt.offsetX, moveEvt.offsetY, scene, skeleton);\n\n                    const { x: moveOffsetX, y: moveOffsetY } = transformCoord;\n                    const { scaleX, scaleY } = scene.getAncestorScale();\n                    const scale = Math.max(scaleX, scaleY);\n                    const HEADER_MENU_SHAPE_THUMB_SIZE_SCALE = HEADER_MENU_SHAPE_THUMB_SIZE / scale;\n\n                    moveChangeX = moveOffsetX - this._startOffsetX - HEADER_MENU_SHAPE_THUMB_SIZE_SCALE / 2;\n\n                    moveChangeY = moveOffsetY - this._startOffsetY - HEADER_MENU_SHAPE_THUMB_SIZE_SCALE / 2;\n\n                    if (\n                        Math.abs(initialType === HEADER_RESIZE_TYPE.ROW ? moveChangeY : moveChangeX) >=\n                        MINIMAL_OFFSET\n                    ) {\n                        isStartMove = true;\n                    }\n\n                    if (initialType === HEADER_RESIZE_TYPE.ROW) {\n                        if (moveChangeY > canvasMaxHeight - scrollBarHorizontalHeight + scrollXY.y - cell.startY) {\n                            moveChangeY = canvasMaxHeight - scrollBarHorizontalHeight + scrollXY.y - cell.startY;\n                        }\n\n                        if (moveChangeY < -(cell.endY - cell.startY) + 2) {\n                            moveChangeY = -(cell.endY - cell.startY) + 2;\n                        }\n\n                        if (isStartMove) {\n                            this._resizeHelperShape?.transformByState({\n                                top: currentOffsetY + moveChangeY,\n                            });\n\n                            this._rowResizeRect?.transformByState({\n                                top: rowResizeRectY + moveChangeY + HEADER_MENU_SHAPE_THUMB_SIZE_SCALE / 2,\n                            });\n\n                            this._rowResizeRect?.show();\n\n                            scene.setCursor(CURSOR_TYPE.ROW_RESIZE);\n                        }\n                    } else {\n                        if (moveChangeX > canvasMaxWidth - scrollBarVerticalWidth + scrollXY.x - cell.startX) {\n                            moveChangeX = canvasMaxWidth - scrollBarVerticalWidth + scrollXY.x - cell.startX;\n                        }\n\n                        if (moveChangeX < -(cell.endX - cell.startX) + 2) {\n                            moveChangeX = -(cell.endX - cell.startX) + 2;\n                        }\n\n                        if (isStartMove) {\n                            this._resizeHelperShape?.transformByState({\n                                left: currentOffsetX + moveChangeX,\n                            });\n\n                            this._columnResizeRect?.transformByState({\n                                left: rowResizeRectX + moveChangeX + HEADER_MENU_SHAPE_THUMB_SIZE_SCALE / 2,\n                            });\n\n                            this._columnResizeRect?.show();\n\n                            scene.setCursor(CURSOR_TYPE.COLUMN_RESIZE);\n                        }\n                    }\n                });\n\n                this._scenePointerUpSub = scene.onPointerUp$.subscribeEvent((upEvt: IPointerEvent | IMouseEvent) => {\n                    const scene = this._context.scene;\n\n                    this._clearObserverEvent();\n                    this._resizeHelperShape?.dispose();\n                    this._resizeHelperShape = null;\n\n                    scene.enableObjectsEvent();\n\n                    if (isStartMove) {\n                        scene.resetCursor();\n\n                        this._rowResizeRect?.hide();\n                        this._columnResizeRect?.hide();\n\n                        if (initialType === HEADER_RESIZE_TYPE.ROW) {\n                            this._commandService.executeCommand<IDeltaRowHeightCommand>(DeltaRowHeightCommand.id, {\n                                deltaY: moveChangeY,\n                                anchorRow: this._currentRow,\n                            });\n                        } else {\n                            this._commandService.executeCommand<IDeltaColumnWidthCommandParams>(\n                                DeltaColumnWidthCommand.id,\n                                {\n                                    deltaX: moveChangeX,\n                                    anchorCol: this._currentColumn,\n                                }\n                            );\n                        }\n                    }\n                });\n            })\n        );\n\n        this.disposeWithMe(\n            eventBindingObject.onDblclick$.subscribeEvent(() => {\n                const scene = this._context.scene;\n                scene.resetCursor();\n\n                const sk = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n                if (!sk) return;\n\n                const startRow = 0;\n                const startColumn = 0;\n                const endRow = sk.worksheet.getRowCount() - 1 || 0;\n                const endColumn = sk.worksheet.getColumnCount() - 1 || 0;\n                switch (initialType) {\n                    case HEADER_RESIZE_TYPE.COLUMN: {\n                        const curSelections = this._selectionManagerService.getCurrentSelections();\n                        const ranges: IRange[] = [];\n                        for (let i = 0; i < curSelections.length; i++) {\n                            const selection = curSelections[i];\n\n                            // if dbclick column is in selection range, then the selection range should put into auto col process.\n                            if (selection.range.rangeType === RANGE_TYPE.COLUMN && this._currentColumn <= selection.range.endColumn && this._currentColumn >= selection.range.startColumn) {\n                                ranges.push({\n                                    startColumn: selection.range.startColumn,\n                                    endColumn: selection.range.endColumn,\n                                    startRow,\n                                    endRow,\n                                });\n                            }\n                        }\n                        // if _currentColumn (dblick column) is not in selection range, then auto width currentColumn\n                        if (ranges.length === 0) {\n                            ranges.push({\n                                startColumn: this._currentColumn,\n                                endColumn: this._currentColumn,\n                                startRow,\n                                endRow,\n                            });\n                        }\n\n                        this._commandService.executeCommand<ISetWorksheetColIsAutoWidthCommandParams>(\n                            SetWorksheetColAutoWidthCommand.id,\n                            { ranges }\n                        );\n                        this._columnResizeRect?.hide();\n                        break;\n                    }\n                    case HEADER_RESIZE_TYPE.ROW:\n                        this._commandService.executeCommand<ISetWorksheetRowIsAutoHeightCommandParams>(\n                            SetWorksheetRowIsAutoHeightCommand.id,\n                            {\n                                ranges: [{\n                                    startRow: this._currentRow,\n                                    endRow: this._currentRow,\n                                    startColumn,\n                                    endColumn,\n                                }],\n                            }\n                        );\n                        this._rowResizeRect?.hide();\n                        break;\n                }\n            })\n        );\n    }\n\n    private _clearObserverEvent() {\n        // const scene = this._context.scene;\n\n        // scene.onPointerMove$.remove(this._scenePointerMoveSub);\n        // scene.onPointerUp$.remove(this._scenePointerUpSub);\n        this._scenePointerMoveSub?.unsubscribe();\n        this._scenePointerUpSub?.unsubscribe();\n        this._scenePointerMoveSub = null;\n        this._scenePointerUpSub = null;\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellDataForSheetInterceptor, IRange, Nullable, Workbook } from '@univerjs/core';\nimport type { IRenderContext, IRenderModule, Scene, SpreadsheetSkeleton } from '@univerjs/engine-render';\nimport { DisposableCollection, Inject, IPermissionService, IUniverInstanceService, Optional, RANGE_TYPE, Rectangle, RxDisposable, UniverInstanceType } from '@univerjs/core';\nimport { UnitAction } from '@univerjs/protocol';\n\nimport { getSheetCommandTarget, RangeProtectionCache, RangeProtectionRuleModel, SheetsSelectionsService, WorkbookEditablePermission, WorksheetEditPermission, WorksheetSetCellStylePermission, WorksheetSetCellValuePermission, WorksheetSetColumnStylePermission, WorksheetSetRowStylePermission } from '@univerjs/sheets';\nimport { ISheetSelectionRenderService } from '../../services/selection/base-selection-render.service';\nimport { HeaderFreezeRenderController } from '../render-controllers/freeze.render-controller';\nimport { HeaderMoveRenderController } from '../render-controllers/header-move.render-controller';\nimport { HeaderResizeRenderController } from '../render-controllers/header-resize.render-controller';\nimport { getTransformCoord } from '../utils/component-tools';\n\ntype ICellPermission = Record<UnitAction, boolean> & { ruleId?: string; ranges?: IRange[] };\n\nexport class SheetPermissionInterceptorCanvasRenderController extends RxDisposable implements IRenderModule {\n    disposableCollection = new DisposableCollection();\n\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService,\n        @IPermissionService private readonly _permissionService: IPermissionService,\n        @Inject(SheetsSelectionsService) private readonly _selectionManagerService: SheetsSelectionsService,\n        @Inject(RangeProtectionRuleModel) private _rangeProtectionRuleModel: RangeProtectionRuleModel,\n        @Inject(HeaderMoveRenderController) private _headerMoveRenderController: HeaderMoveRenderController,\n        @ISheetSelectionRenderService private _selectionRenderService: ISheetSelectionRenderService,\n        @Inject(HeaderFreezeRenderController) private _headerFreezeRenderController: HeaderFreezeRenderController,\n        @Inject(RangeProtectionCache) private _rangeProtectionCache: RangeProtectionCache,\n        @Optional(HeaderResizeRenderController) private _headerResizeRenderController?: HeaderResizeRenderController\n    ) {\n        super();\n        this._initHeaderMovePermissionInterceptor();\n        this._initHeaderResizePermissionInterceptor();\n        this._initRangeFillPermissionInterceptor();\n        this._initRangeMovePermissionInterceptor();\n    }\n\n    private _initHeaderMovePermissionInterceptor() {\n        const headerMoveInterceptor = this._headerMoveRenderController.interceptor.getInterceptPoints().HEADER_MOVE_PERMISSION_CHECK;\n        this.disposeWithMe(\n            this._headerMoveRenderController.interceptor.intercept(headerMoveInterceptor, {\n                handler: (defaultValue: Nullable<boolean>, selectionRange: IRange) => {\n                    const target = getSheetCommandTarget(this._univerInstanceService);\n                    if (!target) {\n                        return false;\n                    }\n                    const { unitId, subUnitId } = target;\n\n                    const worksheetEditPermission = this._permissionService.composePermission([new WorkbookEditablePermission(unitId).id, new WorksheetEditPermission(unitId, subUnitId).id]).every((permission) => permission.value);\n                    if (!worksheetEditPermission) {\n                        return false;\n                    }\n\n                    if (!selectionRange) {\n                        return true;\n                    }\n\n                    if (selectionRange.rangeType !== RANGE_TYPE.ROW && selectionRange.rangeType !== RANGE_TYPE.COLUMN) {\n                        return defaultValue;\n                    }\n\n                    if (selectionRange.rangeType === RANGE_TYPE.ROW) {\n                        for (let i = selectionRange.startRow; i <= selectionRange.endRow; i++) {\n                            const rowAllowed = this._rangeProtectionCache.getRowPermissionInfo(unitId, subUnitId, i, [UnitAction.Edit]);\n                            if (rowAllowed === false) {\n                                return false;\n                            }\n                        }\n                    } else {\n                        for (let i = selectionRange.startColumn; i <= selectionRange.endColumn; i++) {\n                            const colAllowed = this._rangeProtectionCache.getColPermissionInfo(unitId, subUnitId, i, [UnitAction.Edit]);\n                            if (colAllowed === false) {\n                                return false;\n                            }\n                        }\n                    }\n\n                    return true;\n                },\n            })\n        );\n    }\n\n    private _initHeaderResizePermissionInterceptor() {\n        if (!this._headerResizeRenderController) {\n            return;\n        }\n\n        this.disposeWithMe(\n            this._headerResizeRenderController.interceptor.intercept(this._headerResizeRenderController.interceptor.getInterceptPoints().HEADER_RESIZE_PERMISSION_CHECK, {\n                handler: (defaultValue: Nullable<boolean>, rangeParams: { row?: number; col?: number }) => {\n                    const target = getSheetCommandTarget(this._univerInstanceService);\n                    if (!target) {\n                        return false;\n                    }\n                    const { unitId, subUnitId } = target;\n\n                    if (rangeParams.row) {\n                        const setRowStylePermission = this._permissionService.getPermissionPoint(new WorksheetSetRowStylePermission(unitId, subUnitId).id)?.value ?? false;\n                        if (setRowStylePermission === false) {\n                            return false;\n                        }\n                    } else if (rangeParams.col) {\n                        const setColStylePermission = this._permissionService.getPermissionPoint(new WorksheetSetColumnStylePermission(unitId, subUnitId).id)?.value ?? false;\n                        if (setColStylePermission === false) {\n                            return false;\n                        }\n                    }\n\n                    return true;\n                },\n            })\n        );\n    }\n\n    private _initRangeFillPermissionInterceptor() {\n        this.disposeWithMe(\n            this._selectionRenderService.interceptor.intercept(this._selectionRenderService.interceptor.getInterceptPoints().RANGE_FILL_PERMISSION_CHECK, {\n                handler: (_: Nullable<boolean>, position: { x: number; y: number; skeleton: SpreadsheetSkeleton; scene: Scene }) => {\n                    const target = getSheetCommandTarget(this._univerInstanceService);\n                    if (!target) {\n                        return false;\n                    }\n                    const { worksheet, unitId, subUnitId } = target;\n\n                    const worksheetEditPermission = this._permissionService.composePermission([\n                        new WorkbookEditablePermission(unitId).id,\n                        new WorksheetEditPermission(unitId, subUnitId).id,\n                        new WorksheetSetCellValuePermission(unitId, subUnitId).id,\n                        new WorksheetSetCellStylePermission(unitId, subUnitId).id,\n                    ]).every((permission) => permission.value);\n                    if (!worksheetEditPermission) {\n                        return false;\n                    }\n\n                    const ranges = this._selectionManagerService.getCurrentSelections()?.map((selection) => {\n                        return selection.range;\n                    });\n\n                    const selectionRange = ranges?.find((range) => {\n                        const transformCoord = getTransformCoord(position.x, position.y, position.scene, position.skeleton);\n                        const cellPosition = position.skeleton.getCellWithCoordByIndex(range.endRow, range.endColumn);\n                        const missX = Math.abs(cellPosition.endX - transformCoord.x);\n                        const missY = Math.abs(cellPosition.endY - transformCoord.y);\n                        return missX <= 5 && missY <= 5;\n                    });\n\n                    if (!selectionRange) {\n                        return true;\n                    }\n\n                    const { startRow, endRow, startColumn, endColumn } = selectionRange;\n\n                    for (let row = startRow; row <= endRow; row++) {\n                        for (let col = startColumn; col <= endColumn; col++) {\n                            const permission = (worksheet.getCell(row, col) as (ICellDataForSheetInterceptor & { selectionProtection: ICellPermission[] }))?.selectionProtection?.[0];\n                            if (permission?.[UnitAction.Edit] === false || permission?.[UnitAction.View] === false) {\n                                return false;\n                            }\n                        }\n                    }\n                    return true;\n                },\n            })\n        );\n    }\n\n    private _initRangeMovePermissionInterceptor() {\n        this.disposeWithMe(\n            this._selectionRenderService.interceptor.intercept(this._selectionRenderService.interceptor.getInterceptPoints().RANGE_MOVE_PERMISSION_CHECK, {\n                handler: (_: Nullable<boolean>, _cellInfo: null) => {\n                    const target = getSheetCommandTarget(this._univerInstanceService);\n                    if (!target) {\n                        return false;\n                    }\n                    const { worksheet, unitId, subUnitId } = target;\n\n                    const worksheetEditPermission = this._permissionService.composePermission([new WorkbookEditablePermission(unitId).id, new WorksheetEditPermission(unitId, subUnitId).id]).every((permission) => permission.value);\n                    if (!worksheetEditPermission) {\n                        return false;\n                    }\n\n                    const ranges = this._selectionManagerService.getCurrentSelections()?.map((selection) => {\n                        return selection.range;\n                    });\n\n                    const ruleRanges = this._rangeProtectionRuleModel.getSubunitRuleList(unitId, subUnitId).reduce((p, c) => {\n                        return [...p, ...c.ranges];\n                    }, [] as IRange[]);\n\n                    const permissionLapRanges = ranges?.filter((range) => {\n                        return ruleRanges.some((ruleRange) => {\n                            return Rectangle.intersects(ruleRange, range);\n                        });\n                    });\n\n                    const haveNotPermission = permissionLapRanges?.some((range) => {\n                        const { startRow, startColumn, endRow, endColumn } = range;\n                        for (let row = startRow; row <= endRow; row++) {\n                            for (let col = startColumn; col <= endColumn; col++) {\n                                const permission = (worksheet.getCell(row, col) as (ICellDataForSheetInterceptor & { selectionProtection: ICellPermission[] }))?.selectionProtection?.[0];\n                                if (permission?.[UnitAction.Edit] === false) {\n                                    return true;\n                                }\n                            }\n                        }\n                        return false;\n                    });\n\n                    return !haveNotPermission;\n                },\n            })\n        );\n    }\n\n    private _initFreezePermissionInterceptor() {\n        this.disposeWithMe(\n            this._headerFreezeRenderController.interceptor.intercept(this._headerFreezeRenderController.interceptor.getInterceptPoints().FREEZE_PERMISSION_CHECK, {\n                handler: (_: Nullable<boolean>, __) => {\n                    const workbook = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n                    const worksheet = workbook?.getActiveSheet();\n                    if (!worksheet || !workbook) {\n                        return false;\n                    }\n                    const permission = this._permissionService.getPermissionPoint(new WorkbookEditablePermission(workbook.getUnitId()).id)?.value ?? false;\n                    return permission;\n                },\n            })\n        );\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellDataForSheetInterceptor, IRange, Workbook } from '@univerjs/core';\nimport { Disposable, DisposableCollection, Inject, IUniverInstanceService, LocaleService, UniverInstanceType } from '@univerjs/core';\nimport { UnitAction } from '@univerjs/protocol';\nimport { SheetPermissionCheckController, SheetsSelectionsService } from '@univerjs/sheets';\nimport { ISheetClipboardService } from '../../services/clipboard/clipboard.service';\nimport { virtualizeDiscreteRanges } from '../utils/range-tools';\n\ntype ICellPermission = Record<UnitAction, boolean> & { ruleId?: string; ranges?: IRange[] };\nexport const SHEET_PERMISSION_PASTE_PLUGIN = 'SHEET_PERMISSION_PASTE_PLUGIN';\n\nexport class SheetPermissionInterceptorClipboardController extends Disposable {\n    disposableCollection = new DisposableCollection();\n\n    constructor(\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService,\n        @Inject(SheetsSelectionsService) private readonly _selectionManagerService: SheetsSelectionsService,\n        @Inject(LocaleService) private readonly _localService: LocaleService,\n        @Inject(ISheetClipboardService) private _sheetClipboardService: ISheetClipboardService,\n        @Inject(SheetPermissionCheckController) private readonly _sheetPermissionCheckController: SheetPermissionCheckController\n    ) {\n        super();\n        this._initClipboardHook();\n    }\n\n    private _initClipboardHook() {\n        this.disposeWithMe(\n            this._sheetClipboardService.addClipboardHook({\n                id: SHEET_PERMISSION_PASTE_PLUGIN,\n                onBeforePaste: (pasteTo) => {\n                    const [ranges] = virtualizeDiscreteRanges([pasteTo.range]).ranges;\n                    const startRange = this._selectionManagerService.getCurrentLastSelection()?.range;\n                    if (!startRange) {\n                        return false;\n                    }\n                    const targetRange = {\n                        startRow: startRange.startRow + ranges.startRow,\n                        endRow: startRange.startRow + ranges.endRow,\n                        startColumn: startRange.startColumn + ranges.startColumn,\n                        endColumn: startRange.startColumn + ranges.endColumn,\n                    };\n\n                    const workbook = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n                    const worksheet = workbook.getActiveSheet();\n                    if (!worksheet) {\n                        return false;\n                    }\n\n                    const { startRow, endRow, startColumn, endColumn } = targetRange;\n\n                    let hasPermission = true;\n\n                    for (let row = startRow; row <= endRow; row++) {\n                        for (let col = startColumn; col <= endColumn; col++) {\n                            const permission = (worksheet.getCell(row, col) as (ICellDataForSheetInterceptor & { selectionProtection: ICellPermission[] }))?.selectionProtection?.[0];\n                            if (permission?.[UnitAction.Edit] === false) {\n                                hasPermission = false;\n                                break;\n                            }\n                        }\n                    }\n\n                    if (!hasPermission) {\n                        this._sheetPermissionCheckController.blockExecuteWithoutPermission(this._localService.t('permission.dialog.pasteErr'));\n                    }\n\n                    return hasPermission;\n                },\n            })\n        );\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { CellValue, ICellData, ICommandInfo, IRange, ISelectionCell, IStyleData, Nullable, Styles, Workbook, Worksheet } from '@univerjs/core';\nimport type { ArrayValueObject, ISheetData } from '@univerjs/engine-formula';\nimport type { ISelectionWithStyle } from '@univerjs/sheets';\nimport type { IStatusBarServiceStatus } from '../services/status-bar.service';\nimport {\n    CellValueType,\n    createInterceptorKey,\n    debounce,\n    Disposable,\n    ICommandService,\n    Inject,\n    InterceptorManager,\n    IUniverInstanceService,\n    numfmt,\n    ObjectMatrix,\n    RANGE_TYPE,\n    splitIntoGrid,\n    toDisposable,\n    UniverInstanceType,\n} from '@univerjs/core';\n\nimport {\n    FUNCTION_NAMES_MATH,\n    FUNCTION_NAMES_STATISTICAL,\n} from '@univerjs/engine-formula';\nimport {\n    INumfmtService,\n    SetRangeValuesMutation,\n    SheetsSelectionsService,\n} from '@univerjs/sheets';\nimport { IStatusBarService } from '../services/status-bar.service';\n\nexport const STATUS_BAR_PERMISSION_CORRECT = createInterceptorKey<ArrayValueObject[], ArrayValueObject[]>('statusBarPermissionCorrect');\n\nclass CalculateValueSet {\n    private _sum: number = 0;\n    private _count: number = 0;\n    private _countNumber: number = 0;\n    private _min: number = Number.POSITIVE_INFINITY;\n    private _max: number = Number.NEGATIVE_INFINITY;\n\n    add(value: Nullable<ICellData>, styles: Styles, patternInfoRecord: Record<string, any>) {\n        if (!value?.v) {\n            return;\n        }\n        const t = value?.t;\n        let { v } = value;\n\n        const updateNumberStats = (v: number) => {\n            this._sum += v;\n            this._countNumber++;\n            this._min = Math.min(this._min, v);\n            this._max = Math.max(this._max, v);\n        };\n\n        const processNumberWithStyle = (\n            style: Nullable<IStyleData>,\n            v: Nullable<CellValue>,\n            patternInfoRecord: Record<string, any>\n        ) => {\n            if (!style?.n?.pattern) {\n                return;\n            }\n\n            const { pattern } = style.n;\n            if (!patternInfoRecord[pattern]) {\n                patternInfoRecord[pattern] = numfmt.getInfo(pattern);\n            }\n\n            const formatInfo = patternInfoRecord[pattern];\n            if (formatInfo.isDate) {\n                const dateValue = v as number;\n                updateNumberStats(dateValue);\n            }\n        };\n\n        // v = '123' type = 2\n        if (typeof v === 'string' && t === CellValueType.NUMBER) {\n            const numValue = Number(v);\n            if (!Number.isNaN(numValue)) {\n                v = numValue;\n            }\n        }\n\n        if (typeof v === 'number' && t !== CellValueType.STRING) {\n            updateNumberStats(v);\n        } else if (t === CellValueType.NUMBER && value.s) {\n            const style = styles.get(value.s);\n            processNumberWithStyle(style, v, patternInfoRecord);\n        }\n        this._count++;\n    }\n\n    getResults() {\n        return {\n            sum: this._sum,\n            count: this._countNumber,\n            // the countA in formula is the count of all values\n            countA: this._count,\n            min: this._min,\n            max: this._max,\n        };\n    }\n}\nfunction calculateValues(valueSet: CalculateValueSet) {\n    const { sum, count, countA, min, max } = valueSet.getResults();\n    return [\n        {\n            func: FUNCTION_NAMES_STATISTICAL.MAX,\n            value: max,\n        },\n        {\n            func: FUNCTION_NAMES_STATISTICAL.MIN,\n            value: min,\n        },\n        {\n            func: FUNCTION_NAMES_MATH.SUM,\n            value: sum,\n        },\n        {\n            func: FUNCTION_NAMES_STATISTICAL.COUNTA,\n            value: countA,\n        },\n        {\n            func: FUNCTION_NAMES_STATISTICAL.COUNT,\n            value: count,\n        },\n        {\n            func: FUNCTION_NAMES_STATISTICAL.AVERAGE,\n            value: sum / count,\n        },\n    ];\n}\n\nexport class StatusBarController extends Disposable {\n    public interceptor = new InterceptorManager({ STATUS_BAR_PERMISSION_CORRECT });\n\n    constructor(\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService,\n        @Inject(SheetsSelectionsService) private readonly _selectionManagerService: SheetsSelectionsService,\n        @IStatusBarService private readonly _statusBarService: IStatusBarService,\n        @ICommandService private readonly _commandService: ICommandService,\n        @Inject(INumfmtService) private _numfmtService: INumfmtService\n    ) {\n        super();\n\n        this._init();\n    }\n\n    private _init(): void {\n        this._registerSelectionListener();\n    }\n\n    private _registerSelectionListener(): void {\n        const _statisticsHandler = debounce((selections: ISelectionWithStyle[]) => {\n            const primary = selections[selections.length - 1]?.primary;\n            this._calculateSelection(\n                selections.map((selection) => selection.range),\n                primary\n            );\n        }, 100);\n\n        const _statisticsMovingHandler = debounce((selections: ISelectionWithStyle[]) => {\n            const primary = selections[selections.length - 1]?.primary;\n            this._calculateSelection(\n                selections.map((selection) => selection.range),\n                primary\n            );\n        }, 500);\n\n        this.disposeWithMe(\n            toDisposable(\n                this._selectionManagerService.selectionMoving$.subscribe((selections) => {\n                    if (selections) {\n                        _statisticsMovingHandler(selections);\n                    }\n                })\n            )\n        );\n\n        this.disposeWithMe(\n            toDisposable(\n                this._selectionManagerService.selectionMoveEnd$.subscribe((selections) => {\n                    if (selections) {\n                        _statisticsHandler(selections);\n                    }\n                })\n            )\n        );\n\n        this.disposeWithMe(\n            this._commandService.onCommandExecuted((command: ICommandInfo) => {\n                if (command.id === SetRangeValuesMutation.id) {\n                    const selections = this._selectionManagerService.getCurrentSelections();\n                    if (selections) {\n                        _statisticsHandler(selections as ISelectionWithStyle[]);\n                    }\n                }\n            })\n        );\n    }\n\n    private _clearResult(): void {\n        this._statusBarService.setState(null);\n    }\n\n    getRangeStartEndInfo(range: IRange, sheet: Worksheet): IRange {\n        if (range.rangeType === RANGE_TYPE.ALL) {\n            return {\n                startRow: 0,\n                startColumn: 0,\n                endRow: sheet.getRowCount() - 1,\n                endColumn: sheet.getColumnCount() - 1,\n            };\n        }\n        if (range.rangeType === RANGE_TYPE.COLUMN) {\n            return {\n                startRow: 0,\n                startColumn: range.startColumn,\n                endRow: sheet.getRowCount() - 1,\n                endColumn: range.endColumn,\n\n            };\n        }\n        if (range.rangeType === RANGE_TYPE.ROW) {\n            return {\n                startRow: range.startRow,\n                startColumn: 0,\n                endRow: range.endRow,\n                endColumn: sheet.getColumnCount() - 1,\n            };\n        }\n        return {\n            startRow: range.startRow,\n            startColumn: range.startColumn,\n            endRow: range.endRow,\n            endColumn: range.endColumn,\n        };\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    private _calculateSelection(selections: IRange[], primary: Nullable<ISelectionCell>) {\n        const workbook = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        if (!workbook) {\n            return this._clearResult();\n        }\n        const unitId = workbook.getUnitId();\n        const sheet = workbook.getActiveSheet();\n        const sheetId = sheet?.getSheetId();\n        if (!sheetId) {\n            return this._clearResult();\n        }\n\n        const sheetData: ISheetData = {};\n\n        this._univerInstanceService\n            .getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!\n            .getSheets()\n            .forEach((sheet) => {\n                const sheetConfig = sheet.getConfig();\n                sheetData[sheet.getSheetId()] = {\n                    cellData: new ObjectMatrix(sheetConfig.cellData),\n                    rowCount: sheetConfig.rowCount,\n                    columnCount: sheetConfig.columnCount,\n                    rowData: sheetConfig.rowData,\n                    columnData: sheetConfig.columnData,\n                };\n            });\n\n        if (selections?.length) {\n            const realSelections: IRange[] = [];\n            selections.forEach((selection) => {\n                const { startRow: start, endRow: end } = selection;\n                let prev = null;\n                for (let r = start; r <= end; r++) {\n                    if (sheet.getRowVisible(r)) {\n                        if (prev === null) {\n                            prev = r;\n                        }\n                    } else {\n                        if (prev !== null) {\n                            realSelections.push({ ...selection, startRow: prev, endRow: r - 1 });\n                            prev = null;\n                        }\n                    }\n                }\n                if (prev !== null) {\n                    realSelections.push({ ...selection, startRow: prev, endRow: end });\n                }\n            });\n\n            const noDuplicate = splitIntoGrid(realSelections);\n            // const matrix = sheet.getCellMatrix();\n            const calculateValueSet = new CalculateValueSet();\n            const styles = workbook.getStyles();\n            const patternInfoRecord: Record<string, any> = {};\n\n            for (const range of noDuplicate) {\n                const { startRow, startColumn, endColumn, endRow } = this.getRangeStartEndInfo(range, sheet);\n                for (let r = startRow; r <= endRow; r++) {\n                    for (let c = startColumn; c <= endColumn; c++) {\n                        const value = sheet.getCellRaw(r, c);\n                        calculateValueSet.add(value, styles, patternInfoRecord);\n                    }\n                }\n            }\n\n            const calcResult = calculateValues(calculateValueSet);\n            if (calcResult.every((r) => r === undefined)) {\n                return;\n            }\n            let pattern = null;\n            if (primary) {\n                const { actualRow, actualColumn } = primary;\n                pattern = this._numfmtService.getValue(unitId, sheetId, actualRow, actualColumn)?.pattern;\n            }\n            const availableResult = calcResult.filter((r) => r !== undefined);\n            const newState = {\n                values: availableResult,\n                pattern,\n            };\n            this._statusBarService.setState(newState as IStatusBarServiceStatus);\n        } else {\n            this._clearResult();\n        }\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport type { IRenderContext, IRenderModule } from '@univerjs/engine-render';\nimport { DisposableCollection, Inject, IPermissionService, IUniverInstanceService, RxDisposable } from '@univerjs/core';\nimport { NullValueObject } from '@univerjs/engine-formula';\nimport { UnitAction } from '@univerjs/protocol';\nimport { getSheetCommandTarget, RangeProtectionCache, WorksheetViewPermission } from '@univerjs/sheets';\nimport { StatusBarController } from '../status-bar.controller';\n\nexport class SheetPermissionInterceptorFormulaRenderController extends RxDisposable implements IRenderModule {\n    disposableCollection = new DisposableCollection();\n\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService,\n        @IPermissionService private readonly _permissionService: IPermissionService,\n        @Inject(StatusBarController) private readonly _statusBarController: StatusBarController,\n        @Inject(RangeProtectionCache) private _rangeProtectionCache: RangeProtectionCache\n    ) {\n        super();\n        this._initStatusBarPermissionInterceptor();\n    }\n\n    private _initStatusBarPermissionInterceptor() {\n        this.disposeWithMe(\n            this._statusBarController.interceptor.intercept(this._statusBarController.interceptor.getInterceptPoints().STATUS_BAR_PERMISSION_CORRECT, {\n                priority: 100,\n                handler: (defaultValue, originValue) => {\n                    const target = getSheetCommandTarget(this._univerInstanceService);\n                    if (!target) {\n                        return defaultValue ?? [];\n                    }\n                    const { worksheet, unitId, subUnitId } = target;\n                    const sheetViewPermission = this._permissionService.getPermissionPoint(new WorksheetViewPermission(unitId, subUnitId).id)?.value;\n                    if (sheetViewPermission === false) {\n                        originValue.forEach((item) => {\n                            const itemValue = item.getArrayValue();\n                            itemValue.forEach((row, rowIndex) => {\n                                row.forEach((col, colIndex) => {\n                                    itemValue[rowIndex][colIndex] = NullValueObject.create();\n                                });\n                            });\n                        });\n                    } else {\n                        originValue.forEach((item) => {\n                            const itemValue = item.getArrayValue();\n                            const startRow = item.getCurrentRow();\n                            const startCol = item.getCurrentColumn();\n                            itemValue.forEach((row, rowIndex) => {\n                                row.forEach((col, colIndex) => {\n                                    const cellValue = worksheet.getCellRaw(rowIndex + startRow, colIndex + startCol)?.v;\n                                    if (cellValue === undefined) {\n                                        return;\n                                    }\n                                    const permission = this._rangeProtectionCache.getCellInfo(unitId, subUnitId, rowIndex + startRow, colIndex + startCol);\n                                    if (permission?.[UnitAction.View] === false) {\n                                        itemValue[rowIndex][colIndex] = NullValueObject.create();\n                                    }\n                                });\n                            });\n                        });\n                    }\n                    return originValue;\n                },\n            })\n        );\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IRange, Workbook } from '@univerjs/core';\nimport type { IPermissionPanelRule } from '../../../services/permission/sheet-permission-panel.model';\nimport { Injector, IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport { EditStateEnum, ViewStateEnum } from '@univerjs/sheets';\nimport { ComponentContainer, ISidebarService, useComponentsOfPart, useDependency } from '@univerjs/ui';\nimport React, { useEffect, useState } from 'react';\nimport { UNIVER_SHEET_PERMISSION_USER_PART } from '../../../consts/permission';\nimport { checkRangeValid, generateDefaultRule, generateRuleByUnitType } from '../util';\nimport styles from './index.module.less';\nimport { PermissionDetailFooterPart } from './PermissionDetailFooterPart';\nimport { PermissionDetailMainPart } from './PermissionDetailMainPart';\n\ninterface ISheetPermissionPanelDetailProps {\n    fromSheetBar: boolean;\n    rule?: IPermissionPanelRule;\n    oldRule?: IPermissionPanelRule;\n}\n\nexport const SheetPermissionPanelDetail = (props: ISheetPermissionPanelDetailProps) => {\n    const { fromSheetBar, rule, oldRule } = props;\n    const injector = useDependency(Injector);\n    const activeRule: IPermissionPanelRule = rule ? generateRuleByUnitType(injector, rule) : generateDefaultRule(injector, fromSheetBar);\n\n    const [ranges, setRanges] = useState<IRange[]>(activeRule.ranges);\n    const [rangesErrMsg, setRangesErrMsg] = useState<string | undefined>(() => {\n        return checkRangeValid(injector, activeRule.ranges, activeRule.permissionId, activeRule.unitId, activeRule.subUnitId);\n    });\n    const [desc, setDesc] = useState<string | undefined>(activeRule.description);\n    const [editState, setEditState] = useState<EditStateEnum>(activeRule.editState ?? EditStateEnum.OnlyMe);\n    const [viewState, setViewState] = useState<ViewStateEnum>(activeRule.viewState ?? ViewStateEnum.OthersCanView);\n    const PermissionDetailUserPart = useComponentsOfPart(UNIVER_SHEET_PERMISSION_USER_PART);\n\n    useEffect(() => {\n        const univerInstanceService = injector.get(IUniverInstanceService);\n        const sidebarService = injector.get(ISidebarService);\n        const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        if (!workbook) return;\n        const subUnitId = workbook.getActiveSheet().getSheetId();\n        const activeSheetSubscribe = workbook.activeSheet$.subscribe((sheet) => {\n            if (sheet?.getSheetId() !== subUnitId) {\n                sidebarService.close();\n            }\n        });\n        return () => {\n            activeSheetSubscribe.unsubscribe();\n        };\n    }, []);\n\n    return (\n        <div className={styles.permissionPanelDetailWrapper}>\n            <PermissionDetailMainPart\n                permissionId={activeRule.permissionId}\n                ranges={ranges}\n                onRangesChange={(v: IRange[], err?: string) => {\n                    setRanges(v);\n                    setRangesErrMsg(err);\n                }}\n                rangesErrMsg={rangesErrMsg}\n                desc={desc}\n                onDescChange={(v) => setDesc(v)}\n            />\n            <ComponentContainer\n                key=\"user-part\"\n                components={PermissionDetailUserPart}\n                sharedProps={{\n                    editState,\n                    onEditStateChange: (v: EditStateEnum) => setEditState(v),\n                    viewState,\n                    onViewStateChange: (v: ViewStateEnum) => setViewState(v),\n                    permissionId: activeRule.permissionId,\n                }}\n            />\n            <PermissionDetailFooterPart\n                permissionId={activeRule.permissionId}\n                id={activeRule.id}\n                ranges={ranges}\n                rangesErrMsg={rangesErrMsg}\n                desc={desc}\n                viewState={viewState}\n                editState={editState}\n                oldRule={oldRule}\n            />\n        </div>\n    );\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Injector, IRange, Workbook, Worksheet } from '@univerjs/core';\nimport type { IPermissionPanelRule } from '../../services/permission/sheet-permission-panel.model';\nimport { IUniverInstanceService, LocaleService, RANGE_TYPE, Rectangle, UniverInstanceType } from '@univerjs/core';\nimport { EditStateEnum, RangeProtectionRuleModel, SheetsSelectionsService, UnitObject, ViewStateEnum, WorksheetProtectionRuleModel } from '@univerjs/sheets';\n\nexport const checkRangeValid = (injector: Injector, permissionRanges: IRange[], permissionId: string, unitId: string, subUnitId: string) => {\n    const localeService = injector.get(LocaleService);\n    const worksheetRuleModel = injector.get(WorksheetProtectionRuleModel);\n    const rangeProtectionRuleModel = injector.get(RangeProtectionRuleModel);\n\n    let rangeErrorString = '';\n    if (permissionRanges.length === 0) {\n        rangeErrorString = localeService.t('permission.panel.emptyRangeError');\n    } else if (permissionRanges.length > 1) {\n        let hasLap = false;\n        for (let i = 0; i < permissionRanges.length; i++) {\n            for (let j = i + 1; j < permissionRanges.length; j++) {\n                if (Rectangle.intersects(permissionRanges[i], permissionRanges[j])) {\n                    hasLap = true;\n                    break;\n                }\n            }\n            if (hasLap) {\n                break;\n            }\n        }\n        if (hasLap) {\n            rangeErrorString = localeService.t('permission.panel.rangeOverlapError');\n        }\n    }\n    if (!rangeErrorString) {\n        const worksheetRule = worksheetRuleModel.getRule(unitId, subUnitId);\n        if (worksheetRule && !permissionId) {\n            rangeErrorString = localeService.t('permission.panel.rangeOverlapOverPermissionError');\n            return rangeErrorString;\n        }\n        const lapRule = rangeProtectionRuleModel.getSubunitRuleList(unitId, subUnitId).filter((rule) => {\n            return rule.permissionId !== permissionId;\n        }).find((rule) => {\n            return rule.ranges.some((ruleRange) => {\n                return permissionRanges.some((r) => Rectangle.intersects(ruleRange, r));\n            });\n        });\n        const lapRange = lapRule?.ranges.find((range) => {\n            return permissionRanges.some((r) => Rectangle.intersects(range, r));\n        });\n        if (lapRange) {\n            rangeErrorString = localeService.t('permission.panel.rangeOverlapOverPermissionError');\n        }\n    }\n    return rangeErrorString === '' ? undefined : rangeErrorString;\n};\n\nexport const checkRangesIsWholeSheet = (ranges: IRange[], sheet: Worksheet) => {\n    if (ranges.length !== 1) {\n        return false;\n    }\n    const range = ranges[0];\n    const rowCount = sheet.getRowCount();\n    const colCount = sheet.getColumnCount();\n\n    const { startRow, endRow, startColumn, endColumn } = range;\n\n    return startRow === 0 && startColumn === 0 && endRow === rowCount - 1 && endColumn === colCount - 1;\n};\n\nexport const generateDefaultRule = (injector: Injector, fromSheetBar: boolean) => {\n    const univerInstanceService = injector.get(IUniverInstanceService);\n    const selectionManagerService = injector.get(SheetsSelectionsService);\n    const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n    const worksheet = workbook.getActiveSheet();\n\n    let unitType = UnitObject.SelectRange;\n    let ranges = selectionManagerService.getCurrentSelections()?.map((s) => s.range) ?? [];\n\n    if (fromSheetBar) {\n        unitType = UnitObject.Worksheet;\n        ranges = [{\n            startRow: 0,\n            startColumn: 0,\n            endRow: worksheet.getRowCount() - 1,\n            endColumn: worksheet.getColumnCount() - 1,\n            rangeType: RANGE_TYPE.ALL,\n        }];\n    }\n\n    return {\n        unitId: workbook.getUnitId(),\n        subUnitId: worksheet.getSheetId(),\n        permissionId: '',\n        unitType,\n        description: '',\n        id: '',\n        ranges,\n        editState: EditStateEnum.OnlyMe,\n        viewState: ViewStateEnum.OthersCanView,\n    };\n};\n\nexport const generateRuleByUnitType = (injector: Injector, rule: IPermissionPanelRule) => {\n    const univerInstanceService = injector.get(IUniverInstanceService);\n    const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n    const worksheet = workbook.getActiveSheet();\n    const { unitType } = rule;\n\n    if (unitType === UnitObject.Worksheet) {\n        return {\n            ...rule,\n            ranges: [{\n                startRow: 0,\n                startColumn: 0,\n                endRow: worksheet.getRowCount() - 1,\n                endColumn: worksheet.getColumnCount() - 1,\n                rangeType: RANGE_TYPE.ALL,\n            }],\n        };\n    }\n\n    return rule;\n};\n", "export default {\n  \"permissionPanelDetailWrapper\": \"univer-permission-panel-detail-wrapper\",\n  \"radioGroupVertical\": \"univer-radio-group-vertical\",\n  \"sheetPermissionDesignPersonPanel\": \"univer-sheet-permission-design-person-panel\",\n  \"sheetPermissionDesignPersonPanelHeader\": \"univer-sheet-permission-design-person-panel-header\",\n  \"sheetPermissionDesignPersonPanelHeaderAdd\": \"univer-sheet-permission-design-person-panel-header-add\",\n  \"sheetPermissionDesignPersonPanelSplit\": \"univer-sheet-permission-design-person-panel-split\",\n  \"sheetPermissionDesignPersonPanelContentItem\": \"univer-sheet-permission-design-person-panel-content-item\",\n  \"sheetPermissionDesignPersonPanelContentItemName\": \"univer-sheet-permission-design-person-panel-content-item-name\",\n  \"sheetPermissionDesignPersonPanelContentItemSelect\": \"univer-sheet-permission-design-person-panel-content-item-select\",\n  \"sheetPermissionDesignPersonPanelContent\": \"univer-sheet-permission-design-person-panel-content\",\n  \"sheetPermissionUserListEmpty\": \"univer-sheet-permission-user-list-empty\",\n  \"sheetPermissionUserListEmptyText\": \"univer-sheet-permission-user-list-empty-text\",\n  \"sheetPermissionPanelTitle\": \"univer-sheet-permission-panel-title\",\n  \"sheetPermissionPanelFooter\": \"univer-sheet-permission-panel-footer\",\n  \"permissionRangeSelector\": \"univer-permission-range-selector\",\n  \"permissionRangeSelectorError\": \"univer-permission-range-selector-error\",\n  \"sheetPermissionPanelNameInputError\": \"univer-sheet-permission-panel-name-input-error\",\n  \"permissionRangeSelectorErrorText\": \"univer-permission-range-selector-error-text\",\n  \"sheetPermissionPanelNameInputErrorText\": \"univer-sheet-permission-panel-name-input-error-text\"\n};import \"ni:sha-256;jiMborZBjDd0wmFQsUOh046rQaJTiwW3egb1ONGt4U4\";", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IRange, Workbook } from '@univerjs/core';\nimport type { IRangeProtectionRule } from '@univerjs/sheets';\nimport type { IPermissionPanelRule } from '../../../services/permission/sheet-permission-panel.model';\nimport { IAuthzIoService, ICommandService, IUniverInstanceService, LocaleService, UniverInstanceType } from '@univerjs/core';\nimport { Button } from '@univerjs/design';\nimport { ObjectScope, UnitAction, UnitRole } from '@univerjs/protocol';\nimport { AddRangeProtectionCommand, AddWorksheetProtectionCommand, EditStateEnum, SetProtectionCommand, UnitObject, ViewStateEnum } from '@univerjs/sheets';\nimport { ISidebarService, useDependency } from '@univerjs/ui';\nimport { getUserListEqual } from '../../../common/utils';\nimport { UNIVER_SHEET_PERMISSION_PANEL } from '../../../consts/permission';\nimport { SheetPermissionPanelModel } from '../../../services/permission/sheet-permission-panel.model';\nimport { SheetPermissionUserManagerService } from '../../../services/permission/sheet-permission-user-list.service';\nimport { checkRangesIsWholeSheet } from '../util';\nimport styles from './index.module.less';\n\ninterface IPermissionDetailFooterPartProps {\n    permissionId: string;\n    id: string;\n    ranges: IRange[];\n    rangesErrMsg?: string;\n    desc?: string;\n    editState: EditStateEnum;\n    viewState: ViewStateEnum;\n    oldRule?: IPermissionPanelRule;\n}\n\nexport const PermissionDetailFooterPart = (props: IPermissionDetailFooterPartProps) => {\n    const { viewState, editState, permissionId, ranges, rangesErrMsg, desc, oldRule, id } = props;\n    const sheetPermissionPanelModel = useDependency(SheetPermissionPanelModel);\n    const sidebarService = useDependency(ISidebarService);\n    const authzIoService = useDependency(IAuthzIoService);\n    const localeService = useDependency(LocaleService);\n    const commandService = useDependency(ICommandService);\n    const sheetPermissionUserManagerService = useDependency(SheetPermissionUserManagerService);\n    const univerInstanceService = useDependency(IUniverInstanceService);\n\n    const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    const worksheet = workbook?.getActiveSheet();\n    if (!workbook || !worksheet) {\n        return null;\n    }\n    const unitId = workbook.getUnitId();\n    const subUnitId = worksheet.getSheetId();\n\n    return (\n        <div className={styles.sheetPermissionPanelFooter}>\n            <Button\n                type=\"primary\"\n                onClick={async () => {\n                    if (rangesErrMsg) return;\n\n                    const activeRule: IPermissionPanelRule = {\n                        unitId,\n                        subUnitId,\n                        permissionId,\n                        id,\n                        viewState,\n                        editState,\n                        unitType: UnitObject.SelectRange,\n                        ranges,\n                        description: desc,\n                    };\n\n                    const isSelectWholeSheet = checkRangesIsWholeSheet(ranges, worksheet);\n                    if (isSelectWholeSheet) {\n                        activeRule.unitType = UnitObject.Worksheet;\n                        activeRule.ranges = [];\n                    }\n\n                    let collaborators = sheetPermissionUserManagerService.selectUserList;\n                    if (activeRule.editState === EditStateEnum.OnlyMe) {\n                        collaborators = [];\n                        sheetPermissionUserManagerService.setSelectUserList([]);\n                    }\n                    const scopeObj = {\n                        read: activeRule.viewState === ViewStateEnum.OthersCanView ? ObjectScope.AllCollaborator : ObjectScope.SomeCollaborator,\n                        edit: activeRule.editState === EditStateEnum.DesignedUserCanEdit ? ObjectScope.SomeCollaborator : ObjectScope.OneSelf,\n                    };\n                    if (activeRule.editState === EditStateEnum.DesignedUserCanEdit && collaborators.length === 0) {\n                        collaborators = [];\n                        scopeObj.edit = ObjectScope.OneSelf;\n                    }\n\n                    // Editing existing permission rules\n                    if (activeRule.permissionId) {\n                        // Collaborators only need to consider people with editing permissions\n                        const isSameCollaborators = getUserListEqual(collaborators.filter((user) => user.role === UnitRole.Editor), sheetPermissionUserManagerService.oldCollaboratorList.filter((user) => user.role === UnitRole.Editor));\n                        const isSameReadStatus = oldRule?.viewState === activeRule.viewState;\n                        const isSameEditStatus = oldRule?.editState === activeRule.editState;\n                        const ruleConfigIsOrigin = activeRule.unitType === oldRule?.unitType && activeRule.description === oldRule.description && activeRule.ranges === (oldRule as IRangeProtectionRule).ranges;\n                        const collaboratorsIsChange = !isSameCollaborators || !isSameReadStatus || !isSameEditStatus;\n\n                        if (ruleConfigIsOrigin && collaboratorsIsChange) {\n                            // When only collaborators or read status change or edit status change, the update interface is called. Here is the agreement strategies = [];\n                            await authzIoService.update({\n                                objectType: activeRule.unitType,\n                                objectID: activeRule.permissionId,\n                                unitID: activeRule.unitId,\n                                share: undefined,\n                                name: '',\n                                strategies: [],\n                                scope: scopeObj,\n                                collaborators: {\n                                    collaborators,\n                                },\n                            });\n                        } else {\n                            // If the description of the permission is modified, it needs to be synchronized to other collaborators, so the create logic needs to be followed.\n                            let newPermissionId = activeRule.permissionId;\n\n                            // If the collaborator or reader information is modified, a new permissionId is required,\n                            if (collaboratorsIsChange) {\n                                if (activeRule.unitType === UnitObject.Worksheet) {\n                                    newPermissionId = await authzIoService.create({\n                                        worksheetObject: {\n                                            collaborators,\n                                            unitID: activeRule.unitId,\n                                            name: '',\n                                            strategies: [{ role: UnitRole.Editor, action: UnitAction.Edit }, { role: UnitRole.Reader, action: UnitAction.View }],\n                                            scope: scopeObj,\n                                        },\n                                        objectType: UnitObject.Worksheet,\n                                    });\n                                } else {\n                                    newPermissionId = await authzIoService.create({\n                                        selectRangeObject: {\n                                            collaborators,\n                                            unitID: activeRule.unitId,\n                                            name: '',\n                                            scope: scopeObj,\n                                        },\n                                        objectType: UnitObject.SelectRange,\n                                    });\n                                }\n                            }\n\n                            commandService.executeCommand(SetProtectionCommand.id, {\n                                rule: {\n                                    ...activeRule,\n                                    permissionId: newPermissionId,\n                                },\n                                oldRule,\n                            });\n                        }\n                    } else {\n                        //  Create new rule\n\n                        if (activeRule.unitType === UnitObject.Worksheet) {\n                            const permissionId = await authzIoService.create({\n                                worksheetObject: {\n                                    collaborators,\n                                    unitID: activeRule.unitId,\n                                    name: '',\n                                    strategies: [{ role: UnitRole.Editor, action: UnitAction.Edit }, { role: UnitRole.Reader, action: UnitAction.View }],\n                                    scope: scopeObj,\n                                },\n                                objectType: UnitObject.Worksheet,\n                            });\n                            const { ranges: _range = [], ...sheetRule } = activeRule;\n                            sheetRule.permissionId = permissionId;\n                            commandService.executeCommand(AddWorksheetProtectionCommand.id, {\n                                rule: sheetRule,\n                                unitId: activeRule.unitId,\n                            });\n                        } else if (activeRule.unitType === UnitObject.SelectRange) {\n                            const permissionId = await authzIoService.create({\n                                selectRangeObject: {\n                                    collaborators,\n                                    unitID: activeRule.unitId,\n                                    name: '',\n                                    scope: scopeObj,\n                                },\n                                objectType: UnitObject.SelectRange,\n                            });\n                            commandService.executeCommand(AddRangeProtectionCommand.id, {\n                                rule: activeRule,\n                                permissionId,\n                            });\n                        }\n                    }\n                    const sidebarProps = {\n                        header: { title: `${localeService.t('permission.panel.title')}` },\n                        children: {\n                            label: UNIVER_SHEET_PERMISSION_PANEL,\n                            showDetail: false,\n                        },\n                        width: 330,\n                    };\n                    sidebarService.open(sidebarProps);\n                }}\n            >\n                {localeService.t('permission.button.confirm')}\n            </Button>\n            <Button\n                className={styles.sheetPermissionPanelFooterCancel}\n                onClick={() => {\n                    sheetPermissionPanelModel.reset();\n                    sheetPermissionUserManagerService.reset();\n                    sidebarService.close();\n                }}\n            >\n                {localeService.t('permission.button.cancel')}\n            </Button>\n        </div>\n    );\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IRange, Workbook } from '@univerjs/core';\nimport type { IRangeSelectorProps } from '../../../basics/editor/range';\nimport { Injector, isValidRange, IUniverInstanceService, LocaleService, UniverInstanceType } from '@univerjs/core';\nimport { FormLayout, Input } from '@univerjs/design';\nimport { deserializeRangeWithSheet, serializeRange } from '@univerjs/engine-formula';\nimport { setEndForRange } from '@univerjs/sheets';\nimport { ComponentManager, useDependency } from '@univerjs/ui';\nimport React, { useMemo } from 'react';\nimport { RANGE_SELECTOR_COMPONENT_KEY } from '../../../common/keys';\nimport { checkRangeValid } from '../util';\nimport styles from './index.module.less';\n\ninterface IPermissionDetailMainPartProps {\n    permissionId: string;\n    ranges: IRange[];\n    onRangesChange: (ranges: IRange[], err?: string) => void;\n    rangesErrMsg?: string;\n    desc?: string;\n    onDescChange: (desc: string) => void;\n}\n\nexport const PermissionDetailMainPart = (props: IPermissionDetailMainPartProps) => {\n    const { ranges, onRangesChange, desc, onDescChange, rangesErrMsg, permissionId } = props;\n    const componentManager = useDependency(ComponentManager);\n    const RangeSelector: React.ComponentType<IRangeSelectorProps> = useMemo(() => componentManager.get(RANGE_SELECTOR_COMPONENT_KEY), []) as any;\n    const univerInstanceService = useDependency(IUniverInstanceService);\n    const localeService = useDependency(LocaleService);\n    const injector = useDependency(Injector);\n\n    const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    const worksheet = workbook?.getActiveSheet();\n    if (!workbook || !worksheet) {\n        return null;\n    }\n    const unitId = workbook.getUnitId();\n    const subUnitId = worksheet.getSheetId();\n\n    const handleRangeChange = (rangeText: string) => {\n        const newRange = rangeText.split(',').map(deserializeRangeWithSheet).map((item) => item.range);\n        if (newRange.some((i) => !isValidRange(i) || i.endColumn < i.startColumn || i.endRow < i.startRow)) {\n            return;\n        }\n\n        const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        const worksheet = workbook?.getActiveSheet();\n        if (!workbook || !worksheet) {\n            return;\n        }\n        const unitId = workbook.getUnitId();\n        const subUnitId = worksheet.getSheetId();\n        const transformedRange = newRange.map((range) => {\n            const rowCount = worksheet.getRowCount();\n            const colCount = worksheet.getColumnCount();\n            setEndForRange(range, rowCount, colCount);\n            return range;\n        });\n        const rangeErrorString = checkRangeValid(injector, transformedRange, permissionId, unitId, subUnitId);\n        onRangesChange(transformedRange, rangeErrorString);\n    };\n\n    return (\n        <>\n            <FormLayout\n                className={styles.sheetPermissionPanelTitle}\n                label={localeService.t('permission.panel.protectedRange')}\n                error={rangesErrMsg}\n            >\n                {RangeSelector && (\n                    <RangeSelector\n                        unitId={unitId}\n                        subUnitId={subUnitId}\n                        initialValue={ranges?.map((i) => serializeRange(i)).join(',')}\n                        onChange={(_, text) => handleRangeChange(text)}\n                    />\n                )}\n            </FormLayout>\n            <FormLayout className={styles.sheetPermissionPanelTitle} label={localeService.t('permission.panel.permissionDirection')}>\n                <Input\n                    value={desc}\n                    onChange={(v) => onDescChange(v)}\n                    placeholder={localeService.t('permission.panel.permissionDirectionPlaceholder')}\n                />\n            </FormLayout>\n        </>\n    );\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IRange, Workbook } from '@univerjs/core';\nimport type { IPermissionPoint } from '@univerjs/protocol';\nimport type { IRangeProtectionRule, IWorksheetProtectionRule } from '@univerjs/sheets';\nimport type { IPermissionPanelRule } from '../../../services/permission/sheet-permission-panel.model';\nimport { IAuthzIoService, ICommandService, IPermissionService, IUniverInstanceService, LocaleService, Tools, UniverInstanceType, UserManagerService } from '@univerjs/core';\nimport { Avatar, Button, clsx, Tooltip } from '@univerjs/design';\nimport { serializeRange } from '@univerjs/engine-formula';\nimport { DeleteSingle, WriteSingle } from '@univerjs/icons';\nimport { UnitAction, UnitObject } from '@univerjs/protocol';\nimport { baseProtectionActions, DeleteRangeProtectionCommand, DeleteWorksheetProtectionCommand, RangeProtectionRuleModel, SetWorksheetActiveOperation, WorkbookCreateProtectPermission, WorksheetProtectionRuleModel } from '@univerjs/sheets';\nimport { ISidebarService, useDependency, useObservable } from '@univerjs/ui';\nimport { useCallback, useEffect, useState } from 'react';\nimport { distinctUntilChanged, merge } from 'rxjs';\nimport { UNIVER_SHEET_PERMISSION_PANEL } from '../../../consts/permission';\nimport { useHighlightRange } from '../../../hooks/use-highlight-range';\nimport { SheetPermissionUserManagerService } from '../../../services/permission/sheet-permission-user-list.service';\nimport { panelListEmptyBase64 } from './constant';\nimport styles from './index.module.less';\n\ntype IRuleItem = IRangeProtectionRule | IWorksheetProtectionRule;\nexport const SheetPermissionPanelList = () => {\n    const [isCurrentSheet, setIsCurrentSheet] = useState(true);\n    const [forceUpdateFlag, setForceUpdateFlag] = useState(false);\n    const localeService = useDependency(LocaleService);\n    const rangeProtectionRuleModel = useDependency(RangeProtectionRuleModel);\n    const worksheetProtectionModel = useDependency(WorksheetProtectionRuleModel);\n    const univerInstanceService = useDependency(IUniverInstanceService);\n    const commandService = useDependency(ICommandService);\n    const sidebarService = useDependency(ISidebarService);\n    const authzIoService = useDependency(IAuthzIoService);\n    const permissionService = useDependency(IPermissionService);\n    const usesManagerService = useDependency(UserManagerService);\n    const currentUser = usesManagerService.getCurrentUser();\n    const [currentRuleRanges, currentRuleRangesSet] = useState<IRange[]>([]);\n    const sheetPermissionUserManagerService = useDependency(SheetPermissionUserManagerService);\n\n    const _sheetRuleRefresh = useObservable(worksheetProtectionModel.ruleRefresh$, '');\n    const _rangeRuleRefresh = useObservable(rangeProtectionRuleModel.ruleRefresh$, '');\n\n    const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n\n    if (!workbook) {\n        return null;\n    }\n\n    const unitId = workbook?.getUnitId();\n\n    const getRuleList = useCallback(async (isCurrentSheet: boolean) => {\n        const worksheet = workbook.getActiveSheet()!;\n        const unitId = workbook.getUnitId();\n        const subUnitId = worksheet.getSheetId();\n\n        const allRangePermissionId: string[] = [];\n        const allSheetPermissionId: string[] = [];\n\n        workbook.getSheets().forEach((sheet) => {\n            const sheetId = sheet.getSheetId();\n            const rules = rangeProtectionRuleModel.getSubunitRuleList(unitId, sheetId);\n            rules.forEach((rule) => {\n                if (rule.permissionId) {\n                    allRangePermissionId.push(rule.permissionId);\n                }\n            });\n            const worksheetPermissionRule = worksheetProtectionModel.getRule(unitId, sheetId);\n            if (worksheetPermissionRule?.permissionId) {\n                allSheetPermissionId.push(worksheetPermissionRule.permissionId);\n            }\n        });\n\n        const allPermissionId = [...allRangePermissionId, ...allSheetPermissionId];\n\n        const allPermissionRule = await authzIoService.list({\n            objectIDs: allPermissionId,\n            unitID: unitId,\n            actions: baseProtectionActions,\n        });\n\n        const subUnitPermissionIds = rangeProtectionRuleModel.getSubunitRuleList(unitId, subUnitId).map((item) => item.permissionId);\n        const sheetPermissionId = worksheetProtectionModel.getRule(unitId, subUnitId)?.permissionId;\n        if (sheetPermissionId) {\n            subUnitPermissionIds.push(sheetPermissionId);\n        }\n        const subUnitRuleList = allPermissionRule.filter((item) => {\n            return subUnitPermissionIds.includes(item.objectID) || item.objectID === worksheetProtectionModel.getRule(unitId, subUnitId)?.permissionId;\n        });\n\n        return isCurrentSheet ? subUnitRuleList : allPermissionRule;\n    }, []);\n\n    const [ruleList, setRuleList] = useState<IPermissionPoint[]>([]);\n\n    useEffect(() => {\n        const subscription = merge(\n            rangeProtectionRuleModel.ruleChange$,\n            worksheetProtectionModel.ruleChange$\n        ).subscribe(async () => {\n            const ruleList = await getRuleList(isCurrentSheet);\n            setRuleList(ruleList);\n        });\n        return () => {\n            subscription.unsubscribe();\n        };\n    }, [isCurrentSheet]);\n\n    useEffect(() => {\n        const subscribe = workbook.activeSheet$.pipe(\n            distinctUntilChanged((prevSheet, currSheet) => prevSheet?.getSheetId() === currSheet?.getSheetId())\n        ).subscribe(async () => {\n            const ruleList = await getRuleList(isCurrentSheet);\n            setRuleList(ruleList);\n        });\n        return () => {\n            subscribe.unsubscribe();\n        };\n    }, [isCurrentSheet]);\n\n    useEffect(() => {\n        const getRuleListByRefresh = async () => {\n            if (_sheetRuleRefresh || _rangeRuleRefresh) {\n                const ruleList = await getRuleList(true);\n                setRuleList(ruleList);\n            };\n        };\n        getRuleListByRefresh();\n    }, [_sheetRuleRefresh, _rangeRuleRefresh]);\n\n    const handleDelete = (rule: IRuleItem) => {\n        const { unitId, subUnitId, unitType } = rule;\n        let res;\n        if (unitType === UnitObject.Worksheet) {\n            res = commandService.executeCommand(DeleteWorksheetProtectionCommand.id, { unitId, subUnitId, rule });\n        } else if (unitType === UnitObject.SelectRange) {\n            res = commandService.executeCommand(DeleteRangeProtectionCommand.id, { unitId, subUnitId, rule });\n        }\n\n        if (res) {\n            setForceUpdateFlag(!forceUpdateFlag);\n            if ((rule as IRangeProtectionRule).ranges === currentRuleRanges) {\n                currentRuleRangesSet([]);\n            }\n        }\n    };\n\n    useEffect(() => {\n        sheetPermissionUserManagerService.reset();\n    }, []);\n\n    useHighlightRange(currentRuleRanges);\n\n    const allRuleMap = new Map<string, IRangeProtectionRule | IWorksheetProtectionRule>();\n    workbook.getSheets().forEach((sheet) => {\n        const sheetId = sheet.getSheetId();\n        const rangeRules = rangeProtectionRuleModel.getSubunitRuleList(unitId, sheetId);\n        rangeRules.forEach((rule) => {\n            allRuleMap.set(rule.permissionId, rule);\n        });\n\n        const sheetRule = worksheetProtectionModel.getRule(unitId, sheetId);\n        if (sheetRule) {\n            allRuleMap.set(sheetRule?.permissionId, sheetRule);\n        }\n    });\n\n    const handleEdit = (rule: IPermissionPanelRule) => {\n        if (rule.subUnitId !== workbook.getActiveSheet().getSheetId()) {\n            commandService.executeCommand(SetWorksheetActiveOperation.id, {\n                unitId: rule.unitId,\n                subUnitId: rule.subUnitId,\n            });\n        }\n\n        const sidebarProps = {\n            header: { title: 'permission.panel.title' },\n            children: {\n                label: UNIVER_SHEET_PERMISSION_PANEL,\n                showDetail: true,\n                rule: Tools.deepClone(rule),\n                oldRule: Tools.deepClone(rule),\n            },\n            width: 330,\n        };\n\n        sidebarService.open(sidebarProps);\n    };\n\n    const handleChangeHeaderType = (isCurrentSheet: boolean) => {\n        setIsCurrentSheet(isCurrentSheet);\n    };\n\n    const hasSetProtectPermission = permissionService.getPermissionPoint(new WorkbookCreateProtectPermission(unitId).id)?.value;\n\n    return (\n        <div className={styles.sheetPermissionListPanelWrapper}>\n            <div className={styles.sheetPermissionListPanelHeader}>\n                <div className={styles.sheetPermissionListPanelHeaderType} onClick={() => handleChangeHeaderType(true)}>\n                    <div className={clsx({ [styles.sheetPermissionListPanelHeaderSelect]: isCurrentSheet })}>{localeService.t('permission.panel.currentSheet')}</div>\n                    {isCurrentSheet && <div className={styles.sheetPermissionListPanelHeaderTypeBottom} />}\n                </div>\n                <div className={styles.sheetPermissionListPanelHeaderType} onClick={() => handleChangeHeaderType(false)}>\n                    <div className={clsx({ [styles.sheetPermissionListPanelHeaderSelect]: !isCurrentSheet })}>{localeService.t('permission.panel.allSheet')}</div>\n                    {!isCurrentSheet && <div className={styles.sheetPermissionListPanelHeaderTypeBottom} />}\n                </div>\n            </div>\n\n            {ruleList?.length > 0\n                ? (\n                    <div className={styles.sheetPermissionListPanelContent}>\n                        {ruleList?.map((item) => {\n                            const rule = allRuleMap.get(item.objectID);\n\n                            if (!rule) {\n                                return null;\n                            }\n\n                            const editAction = item.actions.find((action) => action.action === UnitAction.Edit);\n                            const editPermission = editAction?.allowed;\n\n                            const viewAction = item.actions.find((action) => action.action === UnitAction.View);\n                            const viewPermission = viewAction?.allowed;\n\n                            const manageCollaboratorAction = item.actions.find((action) => action.action === UnitAction.ManageCollaborator);\n                            const deleteAction = item.actions.find((action) => action.action === UnitAction.Delete);\n\n                            const hasManagerPermission = manageCollaboratorAction?.allowed || currentUser.userID === item.creator?.userID;\n                            const hasDeletePermission = deleteAction?.allowed || currentUser.userID === item.creator?.userID;\n\n                            let ruleName = '';\n\n                            const targetSheet = workbook.getSheetBySheetId(rule.subUnitId);\n                            const targetName = targetSheet?.getName();\n                            if (rule.unitType === UnitObject.SelectRange) {\n                                const ranges = (rule as IRangeProtectionRule).ranges;\n                                const rangeStr = ranges?.length\n                                    ? ranges.map((range) => {\n                                        const v = serializeRange(range);\n                                        return v === 'NaN' ? '' : v;\n                                    }).filter((r) => !!r).join(',')\n                                    : '';\n                                ruleName = `${targetName}(${rangeStr})`;\n                            } else if (rule.unitType === UnitObject.Worksheet) {\n                                ruleName = targetName || '';\n                            }\n\n                            return (\n                                <div\n                                    key={item.objectID}\n                                    className={styles.sheetPermissionListItem}\n                                    onMouseMove={() => {\n                                        const { subUnitId, unitType } = rule;\n                                        const activeSheet = workbook.getActiveSheet();\n                                        if (!activeSheet) {\n                                            return false;\n                                        }\n                                        const activeSubUnitId = activeSheet.getSheetId();\n                                        if (subUnitId !== activeSubUnitId) {\n                                            return false;\n                                        }\n                                        if (unitType === UnitObject.SelectRange) {\n                                            const ranges = (rule as IRangeProtectionRule).ranges || [];\n                                            ranges !== currentRuleRanges && currentRuleRangesSet(ranges);\n                                        } else if (unitType === UnitObject.Worksheet) {\n                                            const ranges = [{ startRow: 0, endRow: activeSheet.getRowCount() - 1, startColumn: 0, endColumn: activeSheet.getColumnCount() - 1 }];\n                                            ranges !== currentRuleRanges && currentRuleRangesSet(ranges);\n                                        }\n                                    }}\n                                    onMouseLeave={() => currentRuleRangesSet([])}\n                                >\n                                    <div className={styles.sheetPermissionListItemHeader}>\n                                        <Tooltip title={ruleName}>\n                                            <div className={styles.sheetPermissionListItemHeaderName}>{ruleName}</div>\n                                        </Tooltip>\n\n                                        {(hasManagerPermission || hasDeletePermission) && (\n                                            <div className={styles.sheetPermissionListItemHeaderOperator}>\n                                                {hasManagerPermission && (\n                                                    <Tooltip title={localeService.t('permission.panel.edit')}>\n                                                        <div className={styles.sheetPermissionListItemHeaderIcon} onClick={() => handleEdit(rule as IPermissionPanelRule)}><WriteSingle /></div>\n                                                    </Tooltip>\n                                                )}\n                                                {hasDeletePermission && (\n                                                    <Tooltip title={localeService.t('permission.panel.delete')}>\n                                                        <div className={styles.sheetPermissionListItemHeaderIcon} onClick={() => handleDelete(rule)}><DeleteSingle /></div>\n                                                    </Tooltip>\n                                                )}\n                                            </div>\n                                        )}\n                                    </div>\n                                    <div className={styles.sheetPermissionListItemSplit} />\n                                    <div className={styles.sheetPermissionListItemContent}>\n                                        <div className={styles.sheetPermissionListItemContentEdit}>\n\n                                            <Tooltip title={item.creator?.name ?? ''}>\n                                                <div>\n                                                    <Avatar src={item.creator?.avatar} style={{ marginRight: 6 }} size={24} />\n                                                </div>\n                                            </Tooltip>\n                                            <span className={styles.sheetPermissionListItemContentTitle}>{localeService.t('permission.panel.created')}</span>\n                                            <span className={styles.sheetPermissionListItemContentSub}>{editPermission ? `${localeService.t('permission.panel.iCanEdit')}` : `${localeService.t('permission.panel.iCanNotEdit')}`}</span>\n\n                                        </div>\n                                        <div className={styles.sheetPermissionListItemContentView}>\n                                            <span className={styles.sheetPermissionListItemContentTitle}>{localeService.t('permission.panel.viewPermission')}</span>\n                                            <span className={styles.sheetPermissionListItemContentSub}>{viewPermission ? `${localeService.t('permission.panel.iCanView')}` : `${localeService.t('permission.panel.iCanNotView')}`}</span>\n                                        </div>\n                                        {rule.description && (\n                                            <Tooltip title={rule.description}>\n                                                <div className={styles.sheetPermissionListItemContentDesc}>\n                                                    {rule.description}\n                                                </div>\n                                            </Tooltip>\n                                        )}\n                                    </div>\n                                </div>\n                            );\n                        })}\n                    </div>\n                )\n                : (\n                    <div className={styles.sheetPermissionListEmpty}>\n                        <img width={240} height={120} src={panelListEmptyBase64} alt=\"\" />\n                        <p className={styles.sheetPermissionListEmptyText}>{localeService.t('permission.dialog.listEmpty')}</p>\n                    </div>\n                )}\n\n            {hasSetProtectPermission && (\n                <div className={styles.sheetPermissionPanelAddWrapper}>\n                    <Button\n                        className={styles.sheetPermissionPanelAddButton}\n                        type=\"primary\"\n                        onClick={() => {\n                            const sidebarProps = {\n                                header: { title: `${localeService.t('permission.panel.title')}` },\n                                children: {\n                                    label: UNIVER_SHEET_PERMISSION_PANEL,\n                                    showDetail: true,\n                                },\n                                width: 330,\n                            };\n                            sidebarService.open(sidebarProps);\n                        }}\n                    >\n                        <div>+ </div>\n                        {localeService.t('permission.button.addNewPermission')}\n                    </Button>\n                </div>\n            )}\n        </div>\n    );\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IRange } from '@univerjs/core';\nimport { useDependency } from '@univerjs/ui';\nimport { useEffect } from 'react';\nimport { IMarkSelectionService } from '../services/mark-selection/mark-selection.service';\n\nexport const useHighlightRange = (ranges: IRange[] = []) => {\n    const markSelectionService = useDependency(IMarkSelectionService);\n    useEffect(() => {\n        const ids = ranges.map((range) => markSelectionService.addShape({\n            range,\n            style: {\n                fill: 'rgba(73, 184, 17, 0.05)',\n                strokeWidth: 1,\n                stroke: '#49B811',\n                widgets: {},\n            },\n            primary: {\n                startColumn: range.startColumn,\n                endColumn: range.endColumn,\n                startRow: range.startRow,\n                endRow: range.endRow,\n                actualRow: range.startRow,\n                actualColumn: range.startColumn,\n                isMerged: false,\n                isMergedMainCell: false,\n            },\n        }));\n        return () => {\n            ids.forEach((id) => {\n                id && markSelectionService.removeShape(id);\n            });\n        };\n    }, [ranges]);\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const panelListEmptyBase64 = 'data:image/png;base64,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';\n", "export default {\n  \"sheetPermissionListPanelWrapper\": \"univer-sheet-permission-list-panel-wrapper\",\n  \"sheetPermissionListPanelHeader\": \"univer-sheet-permission-list-panel-header\",\n  \"sheetPermissionListPanelHeaderType\": \"univer-sheet-permission-list-panel-header-type\",\n  \"sheetPermissionListPanelHeaderTypeBottom\": \"univer-sheet-permission-list-panel-header-type-bottom\",\n  \"sheetPermissionListPanelHeaderSelect\": \"univer-sheet-permission-list-panel-header-select\",\n  \"sheetPermissionListItemHeaderIcon\": \"univer-sheet-permission-list-item-header-icon\",\n  \"sheetPermissionListItem\": \"univer-sheet-permission-list-item\",\n  \"sheetPermissionListItemHeader\": \"univer-sheet-permission-list-item-header\",\n  \"sheetPermissionListItemHeaderName\": \"univer-sheet-permission-list-item-header-name\",\n  \"sheetPermissionListItemHeaderOperator\": \"univer-sheet-permission-list-item-header-operator\",\n  \"sheetPermissionListItemSplit\": \"univer-sheet-permission-list-item-split\",\n  \"sheetPermissionListItemContentEdit\": \"univer-sheet-permission-list-item-content-edit\",\n  \"sheetPermissionListItemContentView\": \"univer-sheet-permission-list-item-content-view\",\n  \"sheetPermissionListItemContentDesc\": \"univer-sheet-permission-list-item-content-desc\",\n  \"sheetPermissionListEmpty\": \"univer-sheet-permission-list-empty\",\n  \"sheetPermissionListEmptyText\": \"univer-sheet-permission-list-empty-text\",\n  \"sheetPermissionListItemContentTitle\": \"univer-sheet-permission-list-item-content-title\",\n  \"sheetPermissionListItemContentSub\": \"univer-sheet-permission-list-item-content-sub\",\n  \"sheetPermissionPanelAddWrapper\": \"univer-sheet-permission-panel-add-wrapper\",\n  \"sheetPermissionPanelAddButton\": \"univer-sheet-permission-panel-add-button\"\n};import \"ni:sha-256;Gaey-l48otCuFlLHqaGLgXneyZodWhGrNAHV8z_Gwg4\";", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IPermissionPanelRule } from '../../../services/permission/sheet-permission-panel.model';\nimport { IUniverInstanceService } from '@univerjs/core';\nimport { serializeRangeWithSheet } from '@univerjs/engine-formula';\nimport { getSheetCommandTarget, SheetsSelectionsService } from '@univerjs/sheets';\nimport { useDependency } from '@univerjs/ui';\nimport { SheetPermissionPanelModel } from '../../../services/permission/sheet-permission-panel.model';\nimport { SheetPermissionPanelDetail } from '../panel-detail/PermissionDetailPanel';\nimport { SheetPermissionPanelList } from '../panel-list';\n\ninterface ISheetPermissionPanelProps {\n    showDetail: boolean;\n    fromSheetBar: boolean;\n    rule?: IPermissionPanelRule;\n    oldRule?: IPermissionPanelRule;\n};\n\nexport const SheetPermissionPanel = ({ showDetail, fromSheetBar, rule, oldRule }: ISheetPermissionPanelProps) => {\n    const univerInstanceService = useDependency(IUniverInstanceService);\n    const sheetsSelectionsService = useDependency(SheetsSelectionsService);\n    const sheetPermissionPanelModel = useDependency(SheetPermissionPanelModel);\n\n    if (!sheetPermissionPanelModel.getVisible()) return null;\n\n    const target = getSheetCommandTarget(univerInstanceService);\n    if (!target) return null;\n    const { worksheet } = target;\n\n    const selectionRanges = sheetsSelectionsService.getCurrentSelections()?.map((selection) => selection.range);\n    const key = selectionRanges.reduce((acc, range) => acc + serializeRangeWithSheet(worksheet.getName(), range), '');\n\n    return (\n        showDetail\n            ? (\n                <SheetPermissionPanelDetail\n                    fromSheetBar={fromSheetBar}\n                    rule={rule}\n                    oldRule={oldRule}\n                    key={fromSheetBar ? 'sheet-bar' : 'normal'}\n                />\n            )\n            : <SheetPermissionPanelList key={key} />\n    );\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\n\nimport type { ICollaborator, UnitAction } from '@univerjs/protocol';\nimport { IAuthzIoService, ICommandService, IPermissionService, IUniverInstanceService, LocaleService, UniverInstanceType } from '@univerjs/core';\nimport { Button, clsx, Switch } from '@univerjs/design';\nimport { ObjectScope, UnitObject, UnitRole } from '@univerjs/protocol';\nimport { getAllWorksheetPermissionPoint, SetWorksheetPermissionPointsCommand, WorksheetProtectionPointModel } from '@univerjs/sheets';\nimport { IDialogService, useDependency } from '@univerjs/ui';\nimport { useEffect, useState } from 'react';\nimport { defaultWorksheetUnitActionList, subUnitPermissionTypeMap, UNIVER_SHEET_PERMISSION_DIALOG_ID } from '../../../consts/permission';\nimport Spin from '../spin';\nimport styles from './index.module.less';\n\ninterface IPermissionMap {\n    [key: string]: {\n        text: string;\n        allowed: boolean;\n    };\n}\n\nexport const SheetPermissionDialog = () => {\n    const localeService = useDependency(LocaleService);\n    const univerInstanceService = useDependency(IUniverInstanceService);\n    const authzIoService = useDependency(IAuthzIoService);\n    const worksheetProtectionPointRuleModel = useDependency(WorksheetProtectionPointModel);\n    const dialogService = useDependency(IDialogService);\n    const permissionService = useDependency(IPermissionService);\n    const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n    const worksheet = workbook.getActiveSheet();\n    if (!worksheet) {\n        throw new Error('No active sheet found');\n    }\n\n    const [collaborators, setCollaborators] = useState<ICollaborator[]>([]);\n    const commandService = useDependency(ICommandService);\n    const [loading, setLoading] = useState(() => {\n        const pointRule = worksheetProtectionPointRuleModel.getRule(workbook.getUnitId(), worksheet.getSheetId());\n        return !!pointRule;\n    });\n\n    const [permissionMap, setPermissionMap] = useState(() => {\n        return Object.keys(subUnitPermissionTypeMap).reduce((acc, action) => {\n            acc[action] = {\n                text: localeService.t(`permission.panel.${subUnitPermissionTypeMap[Number(action) as UnitAction]}`),\n                allowed: true,\n            };\n            return acc;\n        }, {} as IPermissionMap);\n    });\n\n    useEffect(() => {\n        const getUserList = async () => {\n            const unitId = workbook.getUnitId();\n            const collaborators = await authzIoService.listCollaborators({\n                objectID: unitId,\n                unitID: unitId,\n            });\n            setCollaborators(collaborators);\n        };\n        getUserList();\n    }, []);\n\n    useEffect(() => {\n        const getPermissionPoints = async () => {\n            const unitId = workbook.getUnitId();\n            const worksheetPointRule = worksheetProtectionPointRuleModel.getRule(unitId, worksheet.getSheetId());\n            if (!worksheetPointRule) {\n                return;\n            };\n            setLoading(true);\n            const result = await authzIoService.list({\n                unitID: workbook.getUnitId(),\n                objectIDs: [worksheetPointRule.permissionId],\n                actions: defaultWorksheetUnitActionList,\n            });\n            const actions = result[0].strategies.reduce((p, c) => {\n                if (subUnitPermissionTypeMap[c.action]) {\n                    p[c.action] = {\n                        text: localeService.t(`permission.panel.${subUnitPermissionTypeMap[c.action]}`),\n                        allowed: c.role !== UnitRole.Owner,\n                    };\n                }\n                return p;\n            }, {} as IPermissionMap);\n            setPermissionMap(actions);\n            setTimeout(() => {\n                setLoading(false);\n            }, 100);\n        };\n\n        getPermissionPoints();\n    }, []);\n\n    const handleChangeActionPermission = async () => {\n        const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n        const worksheet = workbook?.getActiveSheet();\n        if (!worksheet) {\n            throw new Error('No active sheet found');\n        }\n        const unitId = workbook.getUnitId();\n        const subUnitId = worksheet.getSheetId();\n        const pointRule = worksheetProtectionPointRuleModel.getRule(unitId, subUnitId);\n\n        const actions = Object.keys(permissionMap).map((action) => {\n            return {\n                action: Number(action) as UnitAction,\n                role: permissionMap[action].allowed ? UnitRole.Editor : UnitRole.Owner,\n            };\n        });\n\n        let permissionId = pointRule?.permissionId;\n\n        if (!permissionId) {\n            permissionId = await authzIoService.create({\n                objectType: UnitObject.Worksheet,\n                worksheetObject: {\n                    unitID: unitId,\n                    collaborators,\n                    name: '',\n                    strategies: actions,\n                    scope: {\n                        read: ObjectScope.AllCollaborator,\n                        edit: ObjectScope.AllCollaborator,\n                    },\n                },\n            });\n\n            commandService.executeCommand(SetWorksheetPermissionPointsCommand.id, {\n                rule: {\n                    permissionId,\n                    unitId,\n                    subUnitId,\n                },\n            });\n        } else {\n            authzIoService.update({\n                objectType: UnitObject.Worksheet,\n                objectID: permissionId,\n                unitID: unitId,\n                strategies: actions,\n                share: undefined,\n                name: '',\n                scope: {\n                    read: ObjectScope.AllCollaborator,\n                    edit: ObjectScope.AllCollaborator,\n                },\n                collaborators: undefined,\n            }).then(() => {\n                getAllWorksheetPermissionPoint().forEach((F) => {\n                    const instance = new F(unitId, subUnitId);\n                    const unitActionName = instance.subType;\n                    const action = actions.find((item) => item.action === unitActionName);\n                    if (action) {\n                        permissionService.updatePermissionPoint(instance.id, action.role === UnitRole.Editor);\n                    }\n                });\n            });\n        }\n    };\n\n    return (\n        <Spin loading={loading}>\n            <div className={styles.sheetPermissionDialogWrapper}>\n                <div className={styles.sheetPermissionDialogSplit} />\n                {Object.keys(permissionMap).map((action) => {\n                    const actionItem = permissionMap[action];\n                    const { text, allowed } = actionItem;\n                    return (\n                        <div key={text} className={styles.sheetPermissionDialogItem}>\n                            <div>{text}</div>\n                            <Switch\n                                defaultChecked={allowed}\n                                onChange={() => {\n                                    setPermissionMap({\n                                        ...permissionMap,\n                                        [action]: {\n                                            ...actionItem,\n                                            allowed: !allowed,\n                                        },\n                                    });\n                                }}\n                            />\n                        </div>\n                    );\n                })}\n                <div className={styles.sheetPermissionDialogSplit} />\n                <div className={styles.sheetPermissionUserDialogFooter}>\n\n                    <Button\n                        className={styles.sheetPermissionUserDialogButton}\n                        onClick={() => {\n                            dialogService.close(UNIVER_SHEET_PERMISSION_DIALOG_ID);\n                        }}\n                    >\n                        {localeService.t('permission.button.cancel')}\n                    </Button>\n                    <Button\n                        type=\"primary\"\n                        onClick={() => {\n                            handleChangeActionPermission();\n                            dialogService.close(UNIVER_SHEET_PERMISSION_DIALOG_ID);\n                        }}\n                        className={clsx(styles.sheetPermissionUserDialogFooterConfirm, styles.sheetPermissionUserDialogButton)}\n                    >\n                        {localeService.t('permission.button.confirm')}\n                    </Button>\n                </div>\n            </div>\n        </Spin>\n    );\n};\n", "export default {\n  \"spinContainer\": \"univer-spin-container\",\n  \"spinOverlay\": \"univer-spin-overlay\",\n  \"spinner\": \"univer-spinner\",\n  \"spin\": \"univer-spin\",\n  \"contentBlur\": \"univer-content-blur\"\n};import \"ni:sha-256;RlU6ox3tKMOIaJxk77I-KszCOw7dQARr_nLv1piJLT0\";", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport styles from './index.module.less';\n\ninterface ISpinProps {\n    loading: boolean;\n    children: React.ReactNode;\n}\n\nconst Spin = ({ loading, children }: ISpinProps) => {\n    return (\n        <div className={styles.spinContainer}>\n            {loading && (\n                <div className={styles.spinOverlay}>\n                    <div className={styles.spinner} />\n                </div>\n            )}\n            <div className={loading ? styles.contentBlur : ''}>\n                {children}\n            </div>\n        </div>\n    );\n};\n\nexport default Spin;\n", "export default {\n  \"sheetPermissionDialogWrapper\": \"univer-sheet-permission-dialog-wrapper\",\n  \"sheetPermissionDialogSplit\": \"univer-sheet-permission-dialog-split\",\n  \"sheetPermissionDialogItem\": \"univer-sheet-permission-dialog-item\",\n  \"sheetPermissionUserDialogFooter\": \"univer-sheet-permission-user-dialog-footer\",\n  \"sheetPermissionUserDialogFooterConfirm\": \"univer-sheet-permission-user-dialog-footer-confirm\",\n  \"sheetPermissionUserDialogButton\": \"univer-sheet-permission-user-dialog-button\"\n};import \"ni:sha-256;IqbUFuuDCGTcIbkpjNoJDsRBTPKH2bpWFKJqUay8J0I\";", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICollaborator } from '@univerjs/protocol';\nimport { LocaleService } from '@univerjs/core';\nimport { Avatar, Button, clsx, Input } from '@univerjs/design';\nimport { CheckMarkSingle } from '@univerjs/icons';\nimport { UnitRole } from '@univerjs/protocol';\nimport { IDialogService, useDependency, useObservable } from '@univerjs/ui';\nimport { useState } from 'react';\nimport { UNIVER_SHEET_PERMISSION_USER_DIALOG_ID } from '../../../consts/permission';\nimport { SheetPermissionUserManagerService } from '../../../services/permission/sheet-permission-user-list.service';\nimport { UserEmptyBase64 } from './constant';\nimport styles from './index.module.less';\n\nexport const SheetPermissionUserDialog = () => {\n    const [inputValue, setInputValue] = useState('');\n    const localeService = useDependency(LocaleService);\n    const dialogService = useDependency(IDialogService);\n    const sheetPermissionUserManagerService = useDependency(SheetPermissionUserManagerService);\n    const userList = useObservable(sheetPermissionUserManagerService.userList$, sheetPermissionUserManagerService.userList);\n    const searchUserList = userList?.filter((item) => {\n        return item.subject?.name.toLocaleLowerCase().includes(inputValue.toLocaleLowerCase()) && item.role === UnitRole.Editor;\n    }) ?? [];\n    const [selectUserInfo, setSelectUserInfo] = useState<ICollaborator[]>(sheetPermissionUserManagerService.selectUserList);\n\n    const handleChangeUser = (item: ICollaborator) => {\n        const index = selectUserInfo?.findIndex((v) => v.subject?.userID === item.subject?.userID);\n        if (index === -1) {\n            const select: ICollaborator = { ...item };\n            setSelectUserInfo([...selectUserInfo, select]);\n        } else {\n            const newSelectUserInfo = selectUserInfo.filter((v) => v.subject?.userID !== item.subject?.userID);\n            setSelectUserInfo(newSelectUserInfo);\n        }\n    };\n\n    return (\n        <div className={styles.sheetPermissionUserDialogWrapper}>\n            <div className={styles.sheetPermissionUserDialogSearch}>\n                <Input\n                    placeholder={localeService.t('permission.dialog.search')}\n                    className={styles.sheetPermissionUserDialogSearchInput}\n                    value={inputValue}\n                    onChange={(v) => setInputValue(v)}\n                />\n            </div>\n            <div className={styles.sheetPermissionUserList}>\n                {searchUserList?.length > 0\n                    ? (\n                        <>\n                            {searchUserList?.map((item) => {\n                                return (\n                                    <div key={item.subject?.userID} className={styles.sheetPermissionUserItem} onClick={() => handleChangeUser(item)}>\n                                        <Avatar src={item.subject?.avatar} size={24} />\n                                        <div className={styles.sheetPermissionUserItemName}>{item.subject?.name}</div>\n                                        {selectUserInfo?.findIndex((v) => v.subject?.userID === item.subject?.userID) !== -1 && (<div><CheckMarkSingle /></div>)}\n                                    </div>\n                                );\n                            })}\n                        </>\n                    )\n                    : (\n                        <div className={styles.sheetPermissionUserListEmpty}>\n                            <img width={240} height={120} src={UserEmptyBase64} alt=\"\" />\n                            <p className={styles.sheetPermissionUserListEmptyText}>{localeService.t('permission.dialog.userEmpty')}</p>\n                        </div>\n                    )}\n            </div>\n            <div className={styles.sheetPermissionSplit} />\n            <div className={styles.sheetPermissionUserDialogFooter}>\n\n                <Button className={styles.sheetPermissionUserDialogButton} onClick={() => dialogService.close(UNIVER_SHEET_PERMISSION_USER_DIALOG_ID)}>\n\n                    {localeService.t('permission.button.cancel')}\n                </Button>\n                <Button\n                    type=\"primary\"\n                    onClick={() => {\n                        sheetPermissionUserManagerService.setSelectUserList(selectUserInfo);\n                        dialogService.close(UNIVER_SHEET_PERMISSION_USER_DIALOG_ID);\n                    }}\n                    className={clsx(styles.sheetPermissionUserDialogFooterConfirm, styles.sheetPermissionUserDialogButton)}\n                >\n                    {localeService.t('permission.button.confirm')}\n                </Button>\n            </div>\n        </div>\n    );\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const UserEmptyBase64 = 'data:image/png;base64,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';\n", "export default {\n  \"sheetPermissionUserDialogWrapper\": \"univer-sheet-permission-user-dialog-wrapper\",\n  \"sheetPermissionUserDialogSearchInput\": \"univer-sheet-permission-user-dialog-search-input\",\n  \"sheetPermissionUserList\": \"univer-sheet-permission-user-list\",\n  \"sheetPermissionUserListEmpty\": \"univer-sheet-permission-user-list-empty\",\n  \"sheetPermissionUserListEmptyText\": \"univer-sheet-permission-user-list-empty-text\",\n  \"sheetPermissionUserItem\": \"univer-sheet-permission-user-item\",\n  \"sheetPermissionUserItemName\": \"univer-sheet-permission-user-item-name\",\n  \"sheetPermissionSplit\": \"univer-sheet-permission-split\",\n  \"sheetPermissionUserDialogFooter\": \"univer-sheet-permission-user-dialog-footer\",\n  \"sheetPermissionUserDialogFooterConfirm\": \"univer-sheet-permission-user-dialog-footer-confirm\",\n  \"sheetPermissionUserDialogButton\": \"univer-sheet-permission-user-dialog-button\"\n};import \"ni:sha-256;Il4jC43EjybWENdZ_O2xapMRKrUJzma31uzYCl74vSQ\";", "export default {\n  \"sheetPermissionAlertDialog\": \"univer-sheet-permission-alert-dialog\",\n  \"sheetPermissionAlertDialogTitle\": \"univer-sheet-permission-alert-dialog-title\",\n  \"sheetPermissionAlertDialogButton\": \"univer-sheet-permission-alert-dialog-button\"\n};import \"ni:sha-256;NLix4FoK9D3h2pVtX2vkGTWriJT0s4yqBH9KI6_NTNk\";", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { LocaleService } from '@univerjs/core';\nimport { Button } from '@univerjs/design';\nimport { IDialogService, useDependency } from '@univerjs/ui';\nimport styles from './index.module.less';\nimport { UNIVER_SHEET_PERMISSION_ALERT_DIALOG_ID } from './interface';\n\nexport const AlertDialog = ({ errorMsg }: { errorMsg: string }) => {\n    const localeService = useDependency(LocaleService);\n    const dialogService = useDependency(IDialogService);\n    return (\n        <div className={styles.sheetPermissionAlertDialog}>\n            <h1 className={styles.sheetPermissionAlertDialogTitle}>{localeService.t('permission.dialog.alert')}</h1>\n            <p>{errorMsg || localeService.t('permission.dialog.alertContent')}</p>\n            <div className={styles.sheetPermissionAlertDialogButton}>\n                <Button\n                    type=\"primary\"\n                    onClick={() => {\n                        dialogService.close(UNIVER_SHEET_PERMISSION_ALERT_DIALOG_ID);\n                    }}\n                >\n                    {localeService.t('permission.button.confirm')}\n                </Button>\n            </div>\n        </div>\n    );\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const base64 = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNCIgaGVpZ2h0PSI0IiB2aWV3Qm94PSIwIDAgNCA0IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8bWFzayBpZD0ibWFzazBfNzU5XzExMDgiIHN0eWxlPSJtYXNrLXR5cGU6YWxwaGEiIG1hc2tVbml0cz0idXNlclNwYWNlT25Vc2UiIHg9IjAiIHk9IjAiIHdpZHRoPSI0IiBoZWlnaHQ9IjQiPgo8cmVjdCB3aWR0aD0iNCIgaGVpZ2h0PSI0IiBmaWxsPSIjRDZEOEQ5Ii8+CjwvbWFzaz4KPGcgbWFzaz0idXJsKCNtYXNrMF83NTlfMTEwOCkiPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTS0zLjY0MDAyIDMuNDQxNDFMMi4wNzM5NyAtMi4yNzI1OEwyLjc4MTA4IC0xLjU2NTQ4TC0yLjkzMjkxIDQuMTQ4NTJMLTMuNjQwMDIgMy40NDE0MVoiIGZpbGw9IiNENkQ4REIiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0tMS41MTg2OCA1LjU2Mjc1TDQuMTk1MzEgLTAuMTUxMjQ1TDQuOTAyNDIgMC41NTU4NjJMLTAuODExNTc1IDYuMjY5ODZMLTEuNTE4NjggNS41NjI3NVoiIGZpbGw9IiNENkQ4REIiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0wLjYwMjY1NiA3LjY4NDAzTDYuMzE2NjUgMS45NzAwM0w3LjAyMzc2IDIuNjc3MTRMMS4zMDk3NiA4LjM5MTEzTDAuNjAyNjU2IDcuNjg0MDNaIiBmaWxsPSIjRDZEOERCIi8+CjwvZz4KPC9zdmc+';\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellDataForSheetInterceptor, IScale } from '@univerjs/core';\nimport type { SpreadsheetSkeleton, UniverRenderingContext } from '@univerjs/engine-render';\nimport type { ICellPermission } from '@univerjs/sheets';\nimport { Range } from '@univerjs/core';\nimport { SheetExtension } from '@univerjs/engine-render';\nimport { UnitAction } from '@univerjs/protocol';\nimport { base64 } from './protect-background-img';\n\nexport const RANGE_PROTECTION_CAN_VIEW_RENDER_EXTENSION_KEY = 'RANGE_PROTECTION_CAN_VIEW_RENDER_EXTENSION_KEY';\nexport const RANGE_PROTECTION_CAN_NOT_VIEW_RENDER_EXTENSION_KEY = 'RANGE_PROTECTION_CAN_NOT_VIEW_RENDER_EXTENSION_KEY';\n\nconst EXTENSION_CAN_VIEW_Z_INDEX = 25;\nconst EXTENSION_CAN_NOT_VIEW_Z_INDEX = 80;\n\nexport type IRangeProtectionRenderCellData = ICellDataForSheetInterceptor & { selectionProtection: ICellPermission[] };\n\nexport abstract class RangeProtectionRenderExtension extends SheetExtension {\n    abstract override uKey: string;\n    abstract override Z_INDEX: number;\n    protected _pattern: CanvasPattern | null = null;\n    protected _img = new Image();\n    public renderCache = new Set<string>();\n\n    constructor() {\n        super();\n        this._img.src = base64;\n    }\n\n    override clearCache(): void {\n        this.renderCache.clear();\n    }\n\n    protected abstract shouldRender(config: ICellPermission): boolean;\n\n    override draw(\n        ctx: UniverRenderingContext,\n        _parentScale: IScale,\n        spreadsheetSkeleton: SpreadsheetSkeleton\n    ) {\n        const { worksheet } = spreadsheetSkeleton;\n\n        if (!worksheet) {\n            return;\n        }\n        ctx.save();\n        if (!this._pattern) {\n            this._pattern = ctx.createPattern(this._img, 'repeat');\n        }\n        this.renderCache.clear();\n        Range.foreach(spreadsheetSkeleton.rowColumnSegment, (row, col) => {\n            if (!worksheet.getRowVisible(row) || !worksheet.getColVisible(col)) {\n                return;\n            }\n            const { selectionProtection = [] } = worksheet.getCell(row, col) as IRangeProtectionRenderCellData || {};\n            if (!this._pattern) {\n                return;\n            }\n\n            ctx.fillStyle = this._pattern;\n\n            selectionProtection.forEach((config) => {\n                if (!config.ruleId) {\n                    return;\n                }\n\n                if (this.shouldRender(config)) {\n                    if (this.renderCache.has(config.ruleId)) {\n                        return;\n                    }\n                    this.renderCache.add(config.ruleId);\n                    config.ranges!.forEach((range) => {\n                        const start = spreadsheetSkeleton.getCellWithCoordByIndex(range.startRow, range.startColumn, false);\n                        const end = spreadsheetSkeleton.getCellWithCoordByIndex(range.endRow, range.endColumn, false);\n                        ctx.fillRect(start.startX, start.startY, end.endX - start.startX, end.endY - start.startY);\n                    });\n                }\n            });\n        });\n        ctx.restore();\n    }\n}\n\nexport class RangeProtectionCanViewRenderExtension extends RangeProtectionRenderExtension {\n    override uKey = RANGE_PROTECTION_CAN_VIEW_RENDER_EXTENSION_KEY;\n    override Z_INDEX = EXTENSION_CAN_VIEW_Z_INDEX;\n\n    constructor() {\n        super();\n    }\n\n    protected override shouldRender(config: ICellPermission): boolean {\n        return config?.[UnitAction.View] !== false;\n    }\n}\n\nexport class RangeProtectionCanNotViewRenderExtension extends RangeProtectionRenderExtension {\n    override uKey = RANGE_PROTECTION_CAN_NOT_VIEW_RENDER_EXTENSION_KEY;\n    override Z_INDEX = EXTENSION_CAN_NOT_VIEW_Z_INDEX;\n\n    constructor() {\n        super();\n    }\n\n    protected override shouldRender(config: ICellPermission): boolean {\n        return config?.[UnitAction.View] === false;\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IScale } from '@univerjs/core';\nimport type { SpreadsheetSkeleton, UniverRenderingContext } from '@univerjs/engine-render';\nimport type { IWorksheetProtectionRenderCellData } from '@univerjs/sheets';\nimport { SheetExtension } from '@univerjs/engine-render';\nimport { UnitAction } from '@univerjs/protocol';\nimport { base64 } from './protect-background-img';\n\nexport const worksheetProtectionKey = 'worksheet-protection';\nconst EXTENSION_CAN_VIEW_Z_INDEX = 25;\nconst EXTENSION_CAN_NOT_VIEW_Z_INDEX = 80;\n\nexport class WorksheetProtectionRenderExtension extends SheetExtension {\n    override uKey = worksheetProtectionKey;\n\n    override Z_INDEX = EXTENSION_CAN_VIEW_Z_INDEX;\n    private _pattern: CanvasPattern | null;\n\n    private _img = new Image();\n\n    constructor() {\n        super();\n        this._img.src = base64;\n    }\n\n    override draw(\n        ctx: UniverRenderingContext,\n        _parentScale: IScale,\n        spreadsheetSkeleton: SpreadsheetSkeleton\n    ) {\n        const { worksheet } = spreadsheetSkeleton;\n\n        if (!worksheet) {\n            return false;\n        }\n\n        ctx.save();\n        if (!this._pattern) {\n            this._pattern = ctx.createPattern(this._img, 'repeat');\n        }\n        const { startRow, startColumn, endRow, endColumn } = spreadsheetSkeleton.rowColumnSegment;\n        const start = spreadsheetSkeleton.getCellWithCoordByIndex(startRow, startColumn, false);\n        const end = spreadsheetSkeleton.getCellWithCoordByIndex(endRow, endColumn, false);\n\n        const { hasWorksheetRule = false, selectionProtection = [] } = worksheet.getCell(startRow, startColumn) as IWorksheetProtectionRenderCellData || {};\n        if (!this._pattern) {\n            return;\n        }\n\n        if (selectionProtection.length > 0) {\n            const cellProtectionConfig = selectionProtection[0];\n            const viewPermission = cellProtectionConfig?.[UnitAction.View];\n            if (viewPermission) {\n                this.setZIndex(EXTENSION_CAN_VIEW_Z_INDEX);\n            } else {\n                this.setZIndex(EXTENSION_CAN_NOT_VIEW_Z_INDEX);\n            }\n        }\n\n        ctx.fillStyle = this._pattern;\n        if (hasWorksheetRule) {\n            ctx.fillRect(start.startX, start.startY, end.endX - start.startX, end.endY - start.startY);\n        }\n\n        ctx.restore();\n    }\n\n    setZIndex(zIndex: number) {\n        this.Z_INDEX = zIndex;\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport type { ICollaborator } from '@univerjs/protocol';\nimport { IAuthzIoService, IUniverInstanceService, LocaleService, UniverInstanceType, UserManagerService } from '@univerjs/core';\nimport { Avatar, FormLayout, Radio, RadioGroup, Select } from '@univerjs/design';\nimport { UnitRole } from '@univerjs/protocol';\nimport { EditStateEnum, ViewStateEnum } from '@univerjs/sheets';\nimport { IDialogService, useDependency, useObservable } from '@univerjs/ui';\nimport React, { useEffect } from 'react';\nimport { UNIVER_SHEET_PERMISSION_USER_DIALOG, UNIVER_SHEET_PERMISSION_USER_DIALOG_ID } from '../../../consts/permission';\nimport { SheetPermissionUserManagerService } from '../../../services/permission/sheet-permission-user-list.service';\nimport { UserEmptyBase64 } from '../user-dialog/constant';\nimport styles from './index.module.less';\n\ninterface IPermissionDetailUserPartProps {\n    editState: EditStateEnum;\n    onEditStateChange: (v: EditStateEnum) => void;\n    viewState: ViewStateEnum;\n    onViewStateChange: (v: ViewStateEnum) => void;\n    permissionId: string;\n}\n\nexport const PermissionDetailUserPart = (props: IPermissionDetailUserPartProps) => {\n    const { editState, onEditStateChange, viewState, onViewStateChange, permissionId } = props;\n    const localeService = useDependency(LocaleService);\n    const dialogService = useDependency(IDialogService);\n    const authzIoService = useDependency(IAuthzIoService);\n    const sheetPermissionUserManagerService = useDependency(SheetPermissionUserManagerService);\n    const userManagerService = useDependency(UserManagerService);\n    const univerInstanceService = useDependency(IUniverInstanceService);\n    const selectUserList = useObservable(sheetPermissionUserManagerService.selectUserList$, sheetPermissionUserManagerService.selectUserList);\n\n    const workbook = univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n    const worksheet = workbook?.getActiveSheet();\n    if (!workbook || !worksheet) {\n        return null;\n    }\n    const unitId = workbook.getUnitId();\n\n    const handleAddPerson = async () => {\n        const userList = await authzIoService.listCollaborators({\n            objectID: unitId,\n            unitID: unitId,\n        });\n\n        const currentUser = userManagerService.getCurrentUser();\n        sheetPermissionUserManagerService.setCanEditUserList(userList.filter((user) => user.subject?.userID !== currentUser.userID));\n        dialogService.open({\n            id: UNIVER_SHEET_PERMISSION_USER_DIALOG_ID,\n            title: { title: '' },\n            children: { label: UNIVER_SHEET_PERMISSION_USER_DIALOG },\n            width: 280,\n            destroyOnClose: true,\n            onClose: () => dialogService.close(UNIVER_SHEET_PERMISSION_USER_DIALOG_ID),\n            className: 'sheet-permission-user-dialog',\n        });\n    };\n\n    useEffect(() => {\n        const getSelectUserList = async () => {\n            const collaborators = await authzIoService.listCollaborators({\n                objectID: permissionId!,\n                unitID: unitId,\n            });\n            const selectUserList: ICollaborator[] = collaborators.filter((user) => {\n                return user.role === UnitRole.Editor;\n            });\n            if (selectUserList.length > 0) {\n                onEditStateChange(EditStateEnum.DesignedUserCanEdit);\n            }\n            sheetPermissionUserManagerService.setSelectUserList(selectUserList);\n            sheetPermissionUserManagerService.setOldCollaboratorList(selectUserList);\n        };\n        if (permissionId) {\n            getSelectUserList();\n        } else {\n            sheetPermissionUserManagerService.setSelectUserList([]);\n            sheetPermissionUserManagerService.setOldCollaboratorList([]);\n        }\n    }, []);\n\n    return (\n        <>\n            <FormLayout className={styles.sheetPermissionPanelTitle} label={localeService.t('permission.panel.editPermission')}>\n                <RadioGroup\n                    value={editState}\n                    onChange={(v) => onEditStateChange(v as EditStateEnum)}\n                    className={styles.radioGroupVertical}\n                >\n                    <Radio value={EditStateEnum.OnlyMe}>\n                        <span className={styles.text}>{localeService.t('permission.panel.onlyICanEdit')}</span>\n                    </Radio>\n                    <Radio value={EditStateEnum.DesignedUserCanEdit}>\n                        <span className={styles.text}>{localeService.t('permission.panel.designedUserCanEdit')}</span>\n                    </Radio>\n                </RadioGroup>\n            </FormLayout>\n            {editState === EditStateEnum.DesignedUserCanEdit && (\n                <div className={styles.sheetPermissionDesignPersonPanel}>\n                    <div className={styles.sheetPermissionDesignPersonPanelHeader}>\n                        <span>{localeService.t('permission.panel.designedPerson')}</span>\n                        <span className={styles.sheetPermissionDesignPersonPanelHeaderAdd} onClick={handleAddPerson}>{localeService.t('permission.panel.addPerson')}</span>\n                    </div>\n                    <div className={styles.sheetPermissionDesignPersonPanelSplit} />\n                    <div className={styles.sheetPermissionDesignPersonPanelContent}>\n                        {selectUserList?.length > 0\n                            ? selectUserList.map((item) => {\n                                return (\n                                    <div key={item.subject?.userID} className={styles.sheetPermissionDesignPersonPanelContentItem}>\n                                        <Avatar size={24} src={item.subject?.avatar} />\n                                        <span className={styles.sheetPermissionDesignPersonPanelContentItemName}>{item.subject?.name}</span>\n                                        <Select\n                                            className={styles.sheetPermissionDesignPersonPanelContentItemSelect}\n                                            value=\"edit\"\n                                            onChange={(v) => {\n                                                if (v === 'delete') {\n                                                    sheetPermissionUserManagerService.setSelectUserList(selectUserList.filter((i) => i.subject?.userID !== item.subject?.userID));\n                                                }\n                                            }}\n                                            options={[\n                                                { label: `${localeService.t('permission.panel.canEdit')}`, value: 'edit' },\n                                                { label: `${localeService.t('permission.panel.delete')}`, value: 'delete' },\n                                            ]}\n                                        />\n                                    </div>\n                                );\n                            })\n                            : (\n                                <div className={styles.sheetPermissionUserListEmpty}>\n                                    <img width={240} height={120} src={UserEmptyBase64} alt=\"\" />\n                                    <p className={styles.sheetPermissionUserListEmptyText}>{localeService.t('permission.dialog.userEmpty')}</p>\n                                </div>\n                            )}\n                    </div>\n\n                </div>\n            )}\n            <FormLayout className={styles.sheetPermissionPanelTitle} label={localeService.t('permission.panel.viewPermission')}>\n                <RadioGroup\n                    value={viewState}\n                    onChange={(v) => onViewStateChange(v as ViewStateEnum)}\n                    className={styles.radioGroupVertical}\n                >\n                    <Radio value={ViewStateEnum.OthersCanView}>\n                        <span className={styles.text}>{localeService.t('permission.panel.othersCanView')}</span>\n                    </Radio>\n                    <Radio value={ViewStateEnum.NoOneElseCanView}>\n                        <span className={styles.text}>{localeService.t('permission.panel.noOneElseCanView')}</span>\n                    </Radio>\n                </RadioGroup>\n            </FormLayout>\n        </>\n    );\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IRenderContext, IRenderModule, Spreadsheet } from '@univerjs/engine-render';\nimport type { MenuConfig } from '@univerjs/ui';\nimport type { IUniverSheetsUIConfig } from '../config.schema';\nimport { Disposable, IConfigService, Inject, Injector, IPermissionService, IUniverInstanceService } from '@univerjs/core';\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport { CheckMarkSingle, DeleteSingle, LockSingle, ProtectSingle, WriteSingle } from '@univerjs/icons';\nimport { RangeProtectionRuleModel, WorksheetProtectionRuleModel } from '@univerjs/sheets';\nimport { ComponentManager, connectInjector, IUIPartsService } from '@univerjs/ui';\nimport { merge, throttleTime } from 'rxjs';\nimport { permissionCheckIconKey, permissionDeleteIconKey, permissionEditIconKey, permissionLockIconKey, permissionMenuIconKey, UNIVER_SHEET_PERMISSION_BACKGROUND, UNIVER_SHEET_PERMISSION_DIALOG, UNIVER_SHEET_PERMISSION_PANEL, UNIVER_SHEET_PERMISSION_USER_DIALOG, UNIVER_SHEET_PERMISSION_USER_PART } from '../../consts/permission';\nimport { SheetSkeletonManagerService } from '../../services/sheet-skeleton-manager.service';\nimport { SheetPermissionDialog, SheetPermissionPanel, SheetPermissionUserDialog } from '../../views/permission';\nimport { AlertDialog } from '../../views/permission/error-msg-dialog';\nimport { UNIVER_SHEET_PERMISSION_ALERT_DIALOG } from '../../views/permission/error-msg-dialog/interface';\nimport { RANGE_PROTECTION_CAN_NOT_VIEW_RENDER_EXTENSION_KEY, RANGE_PROTECTION_CAN_VIEW_RENDER_EXTENSION_KEY, RangeProtectionCanNotViewRenderExtension, RangeProtectionCanViewRenderExtension } from '../../views/permission/extensions/range-protection.render';\nimport { worksheetProtectionKey, WorksheetProtectionRenderExtension } from '../../views/permission/extensions/worksheet-permission.render';\nimport { PermissionDetailUserPart } from '../../views/permission/panel-detail/PermissionDetailUserPart';\nimport { SHEETS_UI_PLUGIN_CONFIG_KEY } from '../config.schema';\n\nexport interface IUniverSheetsPermissionMenuConfig {\n    menu: MenuConfig;\n}\n\nexport class SheetPermissionRenderManagerController extends Disposable {\n    constructor(\n        @Inject(Injector) private _injector: Injector,\n        @Inject(ComponentManager) private _componentManager: ComponentManager,\n        @Inject(IUIPartsService) private _uiPartsService: IUIPartsService\n    ) {\n        super();\n        this._init();\n    }\n\n    private _init(): void {\n        this._initComponents();\n        this._initUiPartComponents();\n    }\n\n    private _initComponents(): void {\n        ([\n            [permissionMenuIconKey, ProtectSingle],\n            [permissionDeleteIconKey, DeleteSingle],\n            [permissionEditIconKey, WriteSingle],\n            [permissionCheckIconKey, CheckMarkSingle],\n            [permissionLockIconKey, LockSingle],\n            [UNIVER_SHEET_PERMISSION_PANEL, SheetPermissionPanel],\n            [UNIVER_SHEET_PERMISSION_USER_DIALOG, SheetPermissionUserDialog],\n            [UNIVER_SHEET_PERMISSION_DIALOG, SheetPermissionDialog],\n            [UNIVER_SHEET_PERMISSION_ALERT_DIALOG, AlertDialog],\n        ] as const).forEach(([key, component]) => {\n            this.disposeWithMe(this._componentManager.register(\n                key,\n                component\n            ));\n        });\n    }\n\n    private _initUiPartComponents(): void {\n        const configService = this._injector.get(IConfigService);\n        const config = configService.getConfig<IUniverSheetsUIConfig>(SHEETS_UI_PLUGIN_CONFIG_KEY);\n        if (!config?.customComponents?.has(UNIVER_SHEET_PERMISSION_USER_PART)) {\n            this.disposeWithMe(this._uiPartsService.registerComponent(UNIVER_SHEET_PERMISSION_USER_PART, () => connectInjector(PermissionDetailUserPart, this._injector)));\n        }\n    }\n}\n\nexport class SheetPermissionRenderController extends Disposable implements IRenderModule {\n    private _rangeProtectionCanViewRenderExtension = new RangeProtectionCanViewRenderExtension();\n    private _rangeProtectionCanNotViewRenderExtension = new RangeProtectionCanNotViewRenderExtension();\n\n    constructor(\n        private readonly _context: IRenderContext,\n        @Inject(RangeProtectionRuleModel) private _rangeProtectionRuleModel: RangeProtectionRuleModel,\n        @Inject(SheetSkeletonManagerService) private _sheetSkeletonManagerService: SheetSkeletonManagerService,\n        @IPermissionService private _permissionService: IPermissionService,\n        @IConfigService private _configService: IConfigService\n    ) {\n        super();\n\n        const config = this._configService.getConfig<IUniverSheetsUIConfig>(SHEETS_UI_PLUGIN_CONFIG_KEY);\n        if (config?.customComponents?.has(UNIVER_SHEET_PERMISSION_BACKGROUND)) {\n            return;\n        }\n        this._initRender();\n        this._initSkeleton();\n\n        this.disposeWithMe(this._rangeProtectionRuleModel.ruleChange$.subscribe((info) => {\n            if ((info.oldRule?.id && this._rangeProtectionCanViewRenderExtension.renderCache.has(info.oldRule.id)) || this._rangeProtectionCanViewRenderExtension.renderCache.has(info.rule.id)) {\n                this._rangeProtectionCanViewRenderExtension.clearCache();\n            }\n            if ((info.oldRule?.id && this._rangeProtectionCanNotViewRenderExtension.renderCache.has(info.oldRule.id)) || this._rangeProtectionCanNotViewRenderExtension.renderCache.has(info.rule.id)) {\n                this._rangeProtectionCanNotViewRenderExtension.clearCache();\n            }\n        }));\n    }\n\n    private _initRender(): void {\n        const spreadsheetRender = this._context.mainComponent as Spreadsheet;\n        if (spreadsheetRender) {\n            if (!spreadsheetRender.getExtensionByKey(RANGE_PROTECTION_CAN_VIEW_RENDER_EXTENSION_KEY)) {\n                spreadsheetRender.register(this._rangeProtectionCanViewRenderExtension);\n            }\n            if (!spreadsheetRender.getExtensionByKey(RANGE_PROTECTION_CAN_NOT_VIEW_RENDER_EXTENSION_KEY)) {\n                spreadsheetRender.register(this._rangeProtectionCanNotViewRenderExtension);\n            }\n        }\n    }\n\n    private _initSkeleton(): void {\n        const markDirtySkeleton = () => {\n            this._sheetSkeletonManagerService.reCalculate();\n            this._context.mainComponent?.makeDirty();\n        };\n\n        this.disposeWithMe(merge(\n            this._permissionService.permissionPointUpdate$.pipe(throttleTime(300, undefined, { trailing: true })),\n            this._rangeProtectionRuleModel.rangeRuleInitStateChange$,\n            this._rangeProtectionRuleModel.ruleChange$\n        ).pipe().subscribe(markDirtySkeleton));\n    }\n}\n\nexport class WorksheetProtectionRenderController extends Disposable implements IRenderModule {\n    private _worksheetProtectionRenderExtension = new WorksheetProtectionRenderExtension();\n    constructor(\n        private readonly _context: IRenderContext,\n        @Inject(IRenderManagerService) private _renderManagerService: IRenderManagerService,\n        @Inject(IUniverInstanceService) private _univerInstanceService: IUniverInstanceService,\n        @Inject(SheetSkeletonManagerService) private _sheetSkeletonManagerService: SheetSkeletonManagerService,\n        @Inject(WorksheetProtectionRuleModel) private _worksheetProtectionRuleModel: WorksheetProtectionRuleModel,\n        @Inject(IConfigService) private _configService: IConfigService\n    ) {\n        super();\n\n        const config = this._configService.getConfig<IUniverSheetsUIConfig>(SHEETS_UI_PLUGIN_CONFIG_KEY);\n        if (config?.customComponents?.has(UNIVER_SHEET_PERMISSION_BACKGROUND)) {\n            return;\n        }\n\n        this._initRender();\n        this._initSkeleton();\n    }\n\n    private _initRender() {\n        const renderId = this._context.unitId;\n        const render = renderId && this._renderManagerService.getRenderById(renderId);\n        const spreadsheetRender = render && render.mainComponent as Spreadsheet;\n        if (spreadsheetRender) {\n            if (!spreadsheetRender.getExtensionByKey(worksheetProtectionKey)) {\n                spreadsheetRender.register(this._worksheetProtectionRenderExtension);\n            }\n        }\n    }\n\n    private _initSkeleton(): void {\n        const markDirtySkeleton = () => {\n            this._sheetSkeletonManagerService.reCalculate();\n            this._context.mainComponent?.makeDirty();\n        };\n\n        this.disposeWithMe(merge(\n            this._worksheetProtectionRuleModel.worksheetRuleInitStateChange$\n        ).pipe().subscribe(markDirtySkeleton));\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport type { IRenderContext, IRenderModule } from '@univerjs/engine-render';\nimport {\n    Disposable,\n    ICommandService,\n    toDisposable,\n} from '@univerjs/core';\nimport { CURSOR_TYPE } from '@univerjs/engine-render';\n\nimport { ApplyFormatPainterCommand, SetOnceFormatPainterCommand } from '../../commands/commands/set-format-painter.command';\nimport { FormatPainterStatus, IFormatPainterService } from '../../services/format-painter/format-painter.service';\nimport { ISheetSelectionRenderService } from '../../services/selection/base-selection-render.service';\n\nexport class FormatPainterRenderController extends Disposable implements IRenderModule {\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @IFormatPainterService private readonly _formatPainterService: IFormatPainterService,\n        @ISheetSelectionRenderService private readonly _selectionRenderService: ISheetSelectionRenderService,\n        @ICommandService private readonly _commandService: ICommandService\n    ) {\n        super();\n        this._initialize();\n    }\n\n    private _initialize() {\n        this._bindFormatPainterStatus();\n        this._commandExecutedListener();\n    }\n\n    private _commandExecutedListener() {\n        this.disposeWithMe(this._selectionRenderService.selectionMoveEnd$.subscribe((selections) => {\n            if (this._formatPainterService.getStatus() !== FormatPainterStatus.OFF) {\n                const { rangeWithCoord } = selections[selections.length - 1];\n                this._commandService.executeCommand(ApplyFormatPainterCommand.id, {\n                    unitId: this._context.unitId,\n                    subUnitId: this._context.unit.getActiveSheet()?.getSheetId() || '',\n                    range: {\n                        startRow: rangeWithCoord.startRow,\n                        startColumn: rangeWithCoord.startColumn,\n                        endRow: rangeWithCoord.endRow,\n                        endColumn: rangeWithCoord.endColumn,\n                    },\n                });\n\n                    // if once, turn off the format painter\n                if (this._formatPainterService.getStatus() === FormatPainterStatus.ONCE) {\n                    this._commandService.executeCommand(SetOnceFormatPainterCommand.id);\n                }\n            }\n        })\n\n        );\n    }\n\n    private _bindFormatPainterStatus() {\n        this.disposeWithMe(\n            toDisposable(this._formatPainterService.status$.subscribe((status) => {\n                const scene = this._context.scene;\n                if (!scene) return;\n                if (status !== FormatPainterStatus.OFF) {\n                    scene.setDefaultCursor(CURSOR_TYPE.CELL);\n                } else {\n                    scene.setDefaultCursor(CURSOR_TYPE.DEFAULT);\n                }\n            }))\n        );\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport { Disposable, Inject, RANGE_TYPE, Tools } from '@univerjs/core';\nimport { type IPointerEvent, type IRenderContext, type IRenderModule, SHEET_VIEWPORT_KEY } from '@univerjs/engine-render';\nimport { type ISelectionWithStyle, SheetsSelectionsService } from '@univerjs/sheets';\nimport { ContextMenuPosition, IContextMenuService, ILayoutService } from '@univerjs/ui';\nimport { ISheetSelectionRenderService } from '../../../services/selection/base-selection-render.service';\nimport { attachSelectionWithCoord } from '../../../services/selection/util';\nimport { SheetSkeletonManagerService } from '../../../services/sheet-skeleton-manager.service';\n\n/**\n * On mobile devices, the context menu would popup when\n *\n * @ignore\n */\nexport class SheetContextMenuMobileRenderController extends Disposable implements IRenderModule {\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @ILayoutService private readonly _layoutService: ILayoutService,\n        @IContextMenuService private readonly _contextMenuService: IContextMenuService,\n        @Inject(SheetsSelectionsService) private readonly _selectionManagerService: SheetsSelectionsService,\n        @ISheetSelectionRenderService private readonly _selectionRenderService: ISheetSelectionRenderService,\n        @Inject(SheetSkeletonManagerService) private readonly _sheetSkeletonManagerService: SheetSkeletonManagerService\n    ) {\n        super();\n\n        this._init();\n    }\n\n    private _init(): void {\n        let listenToSelectionChangeEvent = false;\n        this.disposeWithMe(this._selectionManagerService.selectionMoveStart$.subscribe(() => listenToSelectionChangeEvent = true));\n        this.disposeWithMe(this._selectionManagerService.selectionMoveEnd$.subscribe((selectionWithStyleList: ISelectionWithStyle[]) => {\n            const skeleton = this._sheetSkeletonManagerService.getCurrentParam()!.skeleton;\n            if (!skeleton || !selectionWithStyleList || listenToSelectionChangeEvent === false) {\n                return;\n            }\n\n            listenToSelectionChangeEvent = false;\n\n            const selectionRangeWithStyle = selectionWithStyleList[0] as unknown as ISelectionWithStyle;\n\n            if (!selectionRangeWithStyle.primary) return;\n\n            const selectionWithCoord = attachSelectionWithCoord(selectionRangeWithStyle, skeleton);\n            const rangeType = selectionRangeWithStyle.range.rangeType;\n\n            const { scene } = this._context;\n            const viewMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n            const viewportScrollX = viewMain?.viewportScrollX || 0;\n            const viewportScrollY = viewMain?.viewportScrollY || 0;\n\n            let clientX = 0;\n            let clientY = 0;\n\n            const rowHeaderWidth = skeleton.rowHeaderWidth;\n\n            // TODO @lumixraku popup should positioned by transform not topleft.\n            // using transform & transform-origin would be easy to position popup\n            const canvasRect = this._layoutService.getContentElement().getBoundingClientRect();\n            switch (rangeType) {\n                case RANGE_TYPE.NORMAL:\n                    clientX = selectionWithCoord.rangeWithCoord.startX + canvasRect.left - viewportScrollX;\n                    clientY = selectionWithCoord.rangeWithCoord.endY + canvasRect.top - viewportScrollY;\n                    break;\n                case RANGE_TYPE.COLUMN:\n                    clientX = selectionWithCoord.rangeWithCoord.startX + canvasRect.left - viewportScrollX;\n                    // slightly lower than control point for easy to drag control point.\n                    clientY = Math.min(canvasRect.height / 2, selectionWithCoord.rangeWithCoord.endY) + 40;\n                    break;\n                case RANGE_TYPE.ROW:\n                    // slightly left than control point for easy to drag control point.\n                    clientX = (canvasRect.width - rowHeaderWidth) / 2 + 20;\n                    clientY = selectionWithCoord.rangeWithCoord.endY + canvasRect.top - viewportScrollY;\n                    break;\n                case RANGE_TYPE.ALL:\n                    clientX = selectionWithCoord.rangeWithCoord.startX + canvasRect.left;\n                    clientY = selectionWithCoord.rangeWithCoord.startY + canvasRect.top;\n                    break;\n                default:\n                    clientX = selectionWithCoord.rangeWithCoord.startX + canvasRect.left - viewportScrollX;\n                    clientY = selectionWithCoord.rangeWithCoord.endY + canvasRect.top - viewportScrollY;\n                    break;\n            }\n            // in case clientXY is not in screen area.\n            clientX = Tools.clamp(clientX, rowHeaderWidth, canvasRect.width);\n            clientY = Tools.clamp(clientY, canvasRect.top, canvasRect.height);\n\n            this._contextMenuService.triggerContextMenu({\n                clientX,\n                clientY,\n                preventDefault: () => {},\n                stopPropagation: () => {},\n            } as unknown as IPointerEvent, ContextMenuPosition.MAIN_AREA);\n        }));\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IFreeze, IRange, IWorksheetData, Nullable, Workbook } from '@univerjs/core';\nimport type { IMouseEvent, IPoint, IPointerEvent, IRenderContext, IRenderModule, IScrollObserverParam } from '@univerjs/engine-render';\nimport type { IScrollToCellOperationParams } from '@univerjs/sheets';\nimport type { IExpandSelectionCommandParams } from '../../../commands/commands/set-selection.command';\nimport type { IScrollState, IScrollStateSearchParam, IViewportScrollState } from '../../../services/scroll-manager.service';\n\nimport type { ISheetSkeletonManagerParam } from '../../../services/sheet-skeleton-manager.service';\nimport {\n    Direction,\n    Disposable,\n    ICommandService,\n    Inject,\n    IUniverInstanceService,\n    RANGE_TYPE,\n    toDisposable,\n} from '@univerjs/core';\nimport { IRenderManagerService, SHEET_VIEWPORT_KEY } from '@univerjs/engine-render';\nimport { ScrollToCellOperation, SheetsSelectionsService } from '@univerjs/sheets';\nimport { ScrollCommand, SetScrollRelativeCommand } from '../../../commands/commands/set-scroll.command';\nimport { ExpandSelectionCommand, MoveSelectionCommand, MoveSelectionEnterAndTabCommand } from '../../../commands/commands/set-selection.command';\nimport { SheetScrollManagerService } from '../../../services/scroll-manager.service';\nimport { SheetSkeletonManagerService } from '../../../services/sheet-skeleton-manager.service';\nimport { getSheetObject } from '../../utils/component-tools';\n\nconst SHEET_NAVIGATION_COMMANDS = [MoveSelectionCommand.id, MoveSelectionEnterAndTabCommand.id];\n\n/**\n * This controller handles scroll logic in sheet interaction.\n */\nexport class MobileSheetsScrollRenderController extends Disposable implements IRenderModule {\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(SheetSkeletonManagerService) private readonly _sheetSkeletonManagerService: SheetSkeletonManagerService,\n        @ICommandService private readonly _commandService: ICommandService,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService,\n        @Inject(SheetsSelectionsService) private readonly _selectionManagerService: SheetsSelectionsService,\n        @Inject(SheetScrollManagerService) private readonly _scrollManagerService: SheetScrollManagerService,\n        @IUniverInstanceService protected readonly _univerInstanceService: IUniverInstanceService\n    ) {\n        super();\n\n        this._init();\n    }\n\n    scrollToRange(range: IRange): boolean {\n        let { endRow, endColumn, startColumn, startRow } = range;\n        const bounding = this._getViewportBounding();\n        if (range.rangeType === RANGE_TYPE.ROW) {\n            startColumn = 0;\n            endColumn = 0;\n        } else if (range.rangeType === RANGE_TYPE.COLUMN) {\n            startRow = 0;\n            endRow = 0;\n        }\n\n        if (bounding) {\n            const row = bounding.startRow > endRow ? startRow : endRow;\n            const col = bounding.startColumn > endColumn ? startColumn : endColumn;\n            return this._scrollToCell(row, col);\n        } else {\n            return this._scrollToCell(startRow, startColumn);\n        }\n    }\n\n    private _init() {\n        this._initCommandListener();\n        this._initScrollEventListener();\n        this._initPointerScrollEvent();\n        this._initSkeletonListener();\n    }\n\n    private _initCommandListener(): void {\n        this.disposeWithMe(\n            this._commandService.onCommandExecuted((command) => {\n                if (SHEET_NAVIGATION_COMMANDS.includes(command.id)) {\n                    this._scrollToSelection();\n                } else if (command.id === ScrollToCellOperation.id) {\n                    const param = (command.params as IScrollToCellOperationParams).range;\n                    this.scrollToRange(param);\n                } else if (command.id === ExpandSelectionCommand.id) {\n                    const param = command.params as IExpandSelectionCommandParams;\n                    this._scrollToSelectionForExpand(param);\n                }\n            })\n        );\n    }\n\n    private _scrollToSelectionForExpand(param: IExpandSelectionCommandParams) {\n        setTimeout(() => {\n            const selection = this._selectionManagerService.getCurrentLastSelection();\n            if (selection == null) {\n                return;\n            }\n\n            const { startRow, startColumn, endRow, endColumn } = selection.range;\n\n            const bounds = this._getViewportBounding();\n            if (bounds == null) {\n                return;\n            }\n\n            const { startRow: viewportStartRow, startColumn: viewportStartColumn, endRow: viewportEndRow, endColumn: viewportEndColumn } = bounds;\n\n            let row = 0;\n            let column = 0;\n\n            if (startRow > viewportStartRow) {\n                row = endRow;\n            } else if (endRow < viewportEndRow) {\n                row = startRow;\n            } else {\n                row = viewportStartRow;\n            }\n\n            if (startColumn > viewportStartColumn) {\n                column = endColumn;\n            } else if (endColumn < viewportEndColumn) {\n                column = startColumn;\n            } else {\n                column = viewportStartColumn;\n            }\n\n            if (param.direction === Direction.DOWN) {\n                row = endRow;\n            } else if (param.direction === Direction.UP) {\n                row = startRow;\n            } else if (param.direction === Direction.RIGHT) {\n                column = endColumn;\n            } else if (param.direction === Direction.LEFT) {\n                column = startColumn;\n            }\n\n            this._scrollToCell(row, column);\n        }, 0);\n    }\n\n    private _getFreeze(): Nullable<IFreeze> {\n        const snapshot: IWorksheetData | undefined = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton.getWorksheetConfig();\n        if (snapshot == null) {\n            return;\n        }\n\n        return snapshot.freeze;\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    private _initScrollEventListener() {\n        const { scene } = this._context;\n        if (scene == null) return;\n\n        const viewportMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n        if (!viewportMain) return;\n\n        //#region scrollInfo$ subscriber ---> viewport.scrollTo\n        this.disposeWithMe(\n            toDisposable(\n                // wheel event --> set-scroll.command('sheet.operation.set-scroll') --> scroll.operation.ts -->\n                // scrollManagerService.setScrollInfoAndEmitEvent --->  scrollManagerService.setScrollInfo(raw value, may be negative) &&\n                // _notifyCurrentScrollInfo\n                this._scrollManagerService.rawScrollInfo$.subscribe((rawScrollInfo: Nullable<IScrollState>) => {\n                    if (rawScrollInfo == null) {\n                        viewportMain.scrollToViewportPos({\n                            viewportScrollX: 0,\n                            viewportScrollY: 0,\n                        });\n                        return;\n                    }\n\n                    const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n                    if (!skeleton) return;\n\n                    // data source: scroll-manager.service.ts@_scrollInfo\n                    const { sheetViewStartRow, sheetViewStartColumn, offsetX, offsetY } = rawScrollInfo;\n\n                    const { startX, startY } = skeleton.getCellWithCoordByIndex(\n                        sheetViewStartRow,\n                        sheetViewStartColumn,\n                        false\n                    );\n\n                    // viewportScrollXByEvent is not same as viewportScrollX, by event, the value may be negative, or over max\n                    const viewportScrollX = startX + offsetX;\n                    const viewportScrollY = startY + offsetY;\n\n                    // const config = viewportMain.transViewportScroll2ScrollValue(viewportScrollXByEvent, viewportScrollYByEvent);\n                    viewportMain.scrollToViewportPos({ viewportScrollX, viewportScrollY });\n                })\n            )\n        );\n        //#endregion\n\n        //#region viewport.onScrollAfter$ --> setScrollInfoToCurrSheet & validViewportScrollInfo$\n        this.disposeWithMe(\n            viewportMain.onScrollAfter$.subscribeEvent((scrollAfterParam: IScrollObserverParam) => {\n                if (!scrollAfterParam) return;\n                const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n                if (skeleton == null) return;\n                const sheetObject = this._getSheetObject();\n                if (skeleton == null || sheetObject == null) return;\n\n                const { viewportScrollX, viewportScrollY, scrollX, scrollY } = scrollAfterParam;\n\n                // according to the actual scroll position, the most suitable row, column and offset combination is recalculated.\n                const { row, column, rowOffset, columnOffset } = skeleton.getOffsetRelativeToRowCol(\n                    viewportScrollX,\n                    viewportScrollY\n                );\n\n                const scrollInfo: IViewportScrollState = {\n                    sheetViewStartRow: row,\n                    sheetViewStartColumn: column,\n                    offsetX: columnOffset,\n                    offsetY: rowOffset,\n                    viewportScrollX,\n                    viewportScrollY,\n                    scrollX,\n                    scrollY,\n                };\n                // lastestScrollInfo derived from viewportScrollX, viewportScrollY from onScrollAfter$\n                this._scrollManagerService.setValidScrollStateToCurrSheet(scrollInfo);\n                this._scrollManagerService.validViewportScrollInfo$.next({\n                    ...scrollInfo,\n                    scrollX,\n                    scrollY,\n                    viewportScrollX,\n                    viewportScrollY,\n                });\n                // snapshot is diff by diff people!\n                // this._scrollManagerService.setScrollInfoToSnapshot({ ...lastestScrollInfo, viewportScrollX, viewportScrollY });\n            })\n        );\n        //#endregion\n\n        //#region scroll by bar\n        this.disposeWithMe(\n            viewportMain.onScrollByBar$.subscribeEvent((param) => {\n                const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n                if (skeleton == null || param.isTrigger === false) {\n                    return;\n                }\n\n                const sheetObject = this._getSheetObject();\n                if (skeleton == null || sheetObject == null) {\n                    return;\n                }\n                const { viewportScrollX = 0, viewportScrollY = 0 } = param;\n\n                const freeze = this._getFreeze();\n\n                const { row, column, rowOffset, columnOffset } = skeleton.getOffsetRelativeToRowCol(\n                    viewportScrollX,\n                    viewportScrollY\n                );\n\n                this._commandService.executeCommand(ScrollCommand.id, {\n                    sheetViewStartRow: row + (freeze?.ySplit || 0),\n                    sheetViewStartColumn: column + (freeze?.xSplit || 0),\n                    offsetX: columnOffset,\n                    offsetY: rowOffset,\n                });\n            })\n        );\n        //#endregion\n    }\n\n    private _initSkeletonListener() {\n        this.disposeWithMe(toDisposable(\n            this._sheetSkeletonManagerService.currentSkeletonBefore$.subscribe((param) => {\n                if (param == null) {\n                    return;\n                }\n                const scrollParam = { unitId: param.unitId, sheetId: param.sheetId } as IScrollStateSearchParam;\n                this._scrollManagerService.setSearchParam(scrollParam);\n                const sheetObject = this._getSheetObject();\n                if (!sheetObject) return;\n                const scene = sheetObject.scene;\n                const viewportMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n                const currScrollInfo = this._scrollManagerService.getScrollStateByParam(scrollParam);\n                const { viewportScrollX, viewportScrollY } = this._scrollManagerService.calcViewportScrollFromRowColOffset(currScrollInfo as unknown as Nullable<IViewportScrollState>);\n                if (viewportMain) {\n                    if (currScrollInfo) {\n                        viewportMain.viewportScrollX = viewportScrollX;\n                        viewportMain.viewportScrollY = viewportScrollY;\n                    } else {\n                        viewportMain.viewportScrollX = 0;\n                        viewportMain.viewportScrollY = 0;\n                    }\n                    this._updateSceneSize(param as unknown as ISheetSkeletonManagerParam);\n                }\n            })\n        ));\n    }\n\n    /**\n     * for mobile\n     */\n    // eslint-disable-next-line max-lines-per-function\n    private _initPointerScrollEvent() {\n        const sheetObject = this._getSheetObject();\n        if (!sheetObject) return;\n        // const workbook = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n\n        const scrollManagerService = this._scrollManagerService;\n        const scene = sheetObject.scene;\n        const spreadsheet = sheetObject.spreadsheet;\n        const viewportMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n        const lastPointerPos: IPoint = { x: 0, y: 0 };\n        let _pointerScrolling: boolean = false;\n\n        const velocity = { x: 0, y: 0 };\n        const deceleration = 0.95;\n        let scrollInertiaAnimationID: null | number = null;\n        const pointerScrollInertia = () => {\n            if (!viewportMain) return;\n            velocity.x *= deceleration;\n            velocity.y *= deceleration;\n            lastPointerPos.x += velocity.x;\n            lastPointerPos.y += velocity.y;\n            const offsetX = velocity.x;\n            const offsetY = velocity.y;\n\n            if (offsetY !== 0 || offsetX !== 0) {\n                this._commandService.executeCommand(SetScrollRelativeCommand.id, { offsetY, offsetX });\n            }\n\n            if (Math.abs(velocity.x) > 1 || Math.abs(velocity.y) > 1) {\n                scrollInertiaAnimationID = requestAnimationFrame(pointerScrollInertia);\n            } else {\n                scrollInertiaAnimationID = null;\n            }\n        };\n\n        const cancelInertiaAnimation = () => {\n            cancelAnimationFrame(scrollInertiaAnimationID!);\n            scrollInertiaAnimationID = null;\n        };\n\n        spreadsheet.onPointerDown$.subscribeEvent((evt: IPointerEvent | IMouseEvent, state) => {\n            cancelInertiaAnimation();\n\n            if (!viewportMain) return;\n\n            lastPointerPos.x = evt.offsetX;\n            lastPointerPos.y = evt.offsetY;\n            _pointerScrolling = true;\n            state.stopPropagation();\n        });\n\n        spreadsheet.onPointerMove$.subscribeEvent((evt: IPointerEvent | IMouseEvent, state) => {\n            // cancelInertiaAnimation();\n            if (!_pointerScrolling) return;\n            if (!viewportMain) return;\n            const e = evt as IPointerEvent | IMouseEvent;\n            const deltaX = -(e.offsetX - lastPointerPos.x);\n            const deltaY = -(e.offsetY - lastPointerPos.y);\n            velocity.x = -(e.offsetX - lastPointerPos.x);\n            velocity.y = -(e.offsetY - lastPointerPos.y);\n            const offsetX = deltaX;\n            const offsetY = deltaY;\n            if (deltaX !== 0 || deltaY !== 0) {\n                if (offsetY !== 0 || offsetX !== 0) {\n                    this._commandService.executeCommand(SetScrollRelativeCommand.id, { offsetY, offsetX });\n                }\n            }\n\n            // get scrollInfo from packages/sheets-ui/src/commands/commands/set-scroll.command.ts\n            const _currentScroll = scrollManagerService.getCurrentScrollState();\n\n            lastPointerPos.x = e.offsetX;\n            lastPointerPos.y = e.offsetY;\n\n            state.stopPropagation();\n        });\n\n        spreadsheet.onPointerUp$.subscribeEvent((_evt: IPointerEvent | IMouseEvent) => {\n            _pointerScrolling = false;\n            scrollInertiaAnimationID = requestAnimationFrame(pointerScrollInertia);\n        });\n\n        // trigger by scene.input-manager@_onPointerMove because currObject has changed\n        spreadsheet.onPointerLeave$.subscribeEvent(() => {\n            _pointerScrolling = false;\n        });\n        spreadsheet.onPointerOut$.subscribeEvent(() => {\n            _pointerScrolling = false;\n        });\n        scene.onPointerOut$.subscribeEvent(() => {\n            _pointerScrolling = false;\n        });\n        scene.onPointerCancel$.subscribeEvent(() => {\n            _pointerScrolling = false;\n        });\n    }\n\n    private _updateSceneSize(param: ISheetSkeletonManagerParam) {\n        if (param == null) {\n            return;\n        }\n\n        const { unitId } = this._context;\n        const { skeleton } = param;\n        const scene = this._renderManagerService.getRenderById(unitId)?.scene;\n\n        if (skeleton == null || scene == null) {\n            return;\n        }\n\n        const { rowTotalHeight, columnTotalWidth, rowHeaderWidthAndMarginLeft, columnHeaderHeightAndMarginTop } =\n            skeleton;\n        const workbook = this._context.unit;\n        const worksheet = workbook.getActiveSheet();\n        if (!worksheet) return;\n\n        const zoomRatio = worksheet.getZoomRatio() || 1;\n        scene?.setScaleValueOnly(zoomRatio, zoomRatio);\n        scene?.transformByState({\n            width: rowHeaderWidthAndMarginLeft + columnTotalWidth,\n            height: columnHeaderHeightAndMarginTop + rowTotalHeight,\n        });\n    }\n\n    private _getSheetObject() {\n        return getSheetObject(this._context.unit, this._context);\n    }\n\n    private _scrollToSelectionByDirection(range: IRange) {\n        const bounds = this._getViewportBounding();\n        if (bounds == null) {\n            return false;\n        }\n        const {\n            startRow: viewportStartRow,\n            startColumn: viewportStartColumn,\n            endRow: viewportEndRow,\n            endColumn: viewportEndColumn,\n        } = bounds;\n\n        let row = 0;\n        let column = 0;\n\n        const { startRow, startColumn, endRow, endColumn } = range;\n\n        if (startRow >= viewportStartRow) {\n            row = endRow;\n        }\n\n        if (endRow <= viewportEndRow) {\n            row = startRow;\n        }\n\n        if (startColumn >= viewportStartColumn) {\n            column = endColumn;\n        }\n\n        if (endColumn <= viewportEndColumn) {\n            column = startColumn;\n        }\n\n        this._scrollToCell(row, column);\n    }\n\n    private _scrollToSelection(targetIsActualRowAndColumn = true) {\n        const selection = this._selectionManagerService.getCurrentLastSelection();\n        if (selection == null) {\n            return;\n        }\n\n        const { startRow, startColumn, actualRow, actualColumn } = selection.primary;\n        const selectionStartRow = targetIsActualRowAndColumn ? actualRow : startRow;\n        const selectionStartColumn = targetIsActualRowAndColumn ? actualColumn : startColumn;\n\n        this._scrollToCell(selectionStartRow, selectionStartColumn);\n    }\n\n    private _getViewportBounding() {\n        const scene = this._getSheetObject()?.scene;\n        if (scene == null) {\n            return;\n        }\n\n        const viewport = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n        if (viewport == null) {\n            return;\n        }\n\n        const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n        if (skeleton == null) {\n            return;\n        }\n\n        return skeleton.getRangeByViewport(viewport.calcViewportInfo());\n    }\n\n    // eslint-disable-next-line max-lines-per-function, complexity\n    private _scrollToCell(row: number, column: number): boolean {\n        const { rowHeightAccumulation, columnWidthAccumulation } = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton ?? {};\n\n        if (rowHeightAccumulation == null || columnWidthAccumulation == null) return false;\n\n        const scene = this._getSheetObject()?.scene;\n        if (scene == null) return false;\n\n        const viewport = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n        if (viewport == null) return false;\n\n        const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n        if (skeleton == null) return false;\n\n        const worksheet = this._context.unit.getActiveSheet();\n        if (!worksheet) return false;\n\n        const {\n            startColumn: freezeStartColumn,\n            startRow: freezeStartRow,\n            ySplit: freezeYSplit,\n            xSplit: freezeXSplit,\n        } = worksheet.getFreeze();\n\n        const bounds = this._getViewportBounding();\n        if (bounds == null) return false;\n\n        const {\n            startRow: viewportStartRow,\n            startColumn: viewportStartColumn,\n            endRow: viewportEndRow,\n            endColumn: viewportEndColumn,\n        } = bounds;\n\n        let startSheetViewRow: number | undefined;\n        let startSheetViewColumn: number | undefined;\n\n        // vertical overflow only happens when the selection's row is in not the freeze area\n        if (row >= freezeStartRow && column >= freezeStartColumn - freezeXSplit) {\n            // top overflow\n            if (row <= viewportStartRow) {\n                startSheetViewRow = row;\n            }\n\n            // bottom overflow\n            if (row >= viewportEndRow) {\n                const minRowAccumulation = rowHeightAccumulation[row] - viewport.height!;\n                for (let r = viewportStartRow; r <= row; r++) {\n                    if (rowHeightAccumulation[r] >= minRowAccumulation) {\n                        startSheetViewRow = r + 1;\n                        break;\n                    }\n                }\n            }\n        }\n        // horizontal overflow only happens when the selection's column is in not the freeze area\n        if (column >= freezeStartColumn && row >= freezeStartRow - freezeYSplit) {\n            // left overflow\n            if (column <= viewportStartColumn) {\n                startSheetViewColumn = column;\n            }\n\n            // right overflow\n            if (column >= viewportEndColumn) {\n                const minColumnAccumulation = columnWidthAccumulation[column] - viewport.width!;\n                for (let c = viewportStartColumn; c <= column; c++) {\n                    if (columnWidthAccumulation[c] >= minColumnAccumulation) {\n                        startSheetViewColumn = c + 1;\n                        break;\n                    }\n                }\n            }\n        }\n\n        if (startSheetViewRow === undefined && startSheetViewColumn === undefined) return false;\n\n        const { offsetX, offsetY } = this._scrollManagerService.getCurrentScrollState() || {};\n        return this._commandService.syncExecuteCommand(ScrollCommand.id, {\n            sheetViewStartRow: startSheetViewRow,\n            sheetViewStartColumn: startSheetViewColumn,\n            offsetX: startSheetViewColumn === undefined ? offsetX : 0,\n            offsetY: startSheetViewRow === undefined ? offsetY : 0,\n        });\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createIdentifier } from '@univerjs/core';\n\n/**\n * Univer telemetry service interface. You should implement this interface to track telemetry data.\n */\nexport interface ITelemetryService {\n    /**\n     * Enable the debug mode.\n     */\n    debug: () => void;\n    /**\n     * Initialize the telemetry service.\n     * @param token\n     * @param options\n     */\n    init: (options?: Record<string, any>) => void;\n    /**\n     * Identify the user.\n     * @param id\n     * @param params\n     * @returns\n     */\n    identify: (id: string, params?: Record<string, any>) => void;\n    /**\n     * Reset the user.\n     */\n    reset(): void;\n    /**\n     * Track the event.\n     * @param eventName\n     * @param params\n     */\n    capture: (eventName: string, params?: Record<string, any>) => void;\n    /**\n     * Start the timer.\n     * @param functionName\n     */\n    startTime: (functionName: string) => void;\n    /**\n     * End the timer.\n     * @param functionName\n     */\n    endTime: (functionName: string) => void;\n    /**\n     * Track the performance event.\n     * @param params\n     */\n    trackPerformance: (params: {\n        duration: number;\n        functionName: string;\n        [prop: string]: any;\n    }) => void;\n    /**\n     * Track the page view.\n     * @param url\n     */\n    onPageView: (url: string) => void;\n};\n\n/**\n * Univer telemetry service identifier.\n */\nexport const ITelemetryService = createIdentifier<ITelemetryService>('telemetry.service');\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IDisposable, Workbook } from '@univerjs/core';\nimport {\n    IContextService,\n    IUniverInstanceService,\n    RxDisposable,\n    toDisposable,\n    UniverInstanceType,\n} from '@univerjs/core';\nimport { IRenderManagerService, RENDER_RAW_FORMULA_KEY, Spreadsheet } from '@univerjs/engine-render';\nimport { distinctUntilChanged, takeUntil } from 'rxjs';\n\nconst SHEET_MAIN_CANVAS_ID = 'univer-sheet-main-canvas';\n\n/**\n * This controller is responsible for managing units of a specific kind (UniverSheet) to be rendered on the canvas.\n */\nexport class SheetsRenderService extends RxDisposable {\n    private _skeletonChangeMutations = new Set<string>();\n\n    constructor(\n        @IContextService private readonly _contextService: IContextService,\n        @IUniverInstanceService private readonly _instanceSrv: IUniverInstanceService,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService\n    ) {\n        super();\n\n        // It should be initialized after all other plugins are ready.\n        Promise.resolve().then(() => this._init());\n    }\n\n    /**\n     * Register a mutation id that will trigger the skeleton change.\n     *\n     * @param mutationId the id of the mutation\n     * @returns a disposable to unregister the mutation\n     */\n    registerSkeletonChangingMutations(mutationId: string): IDisposable {\n        if (this._skeletonChangeMutations.has(mutationId)) {\n            return toDisposable(() => { });\n        }\n\n        this._skeletonChangeMutations.add(mutationId);\n        return toDisposable(() => this._skeletonChangeMutations.delete(mutationId));\n    }\n\n    /**\n     * Examine if a mutation would make the skeleton to change.\n     */\n    checkMutationShouldTriggerRerender(id: string): boolean {\n        return this._skeletonChangeMutations.has(id);\n    }\n\n    private _init() {\n        this._initWorkbookListener();\n        this._initContextListener();\n    }\n\n    private _initWorkbookListener(): void {\n        this._instanceSrv.getTypeOfUnitAdded$<Workbook>(UniverInstanceType.UNIVER_SHEET)\n            .pipe(takeUntil(this.dispose$))\n            .subscribe((workbook) => this._createRenderer(workbook));\n        this._instanceSrv.getAllUnitsForType<Workbook>(UniverInstanceType.UNIVER_SHEET)\n            .forEach((workbook) => this._createRenderer(workbook));\n        this._instanceSrv.getTypeOfUnitDisposed$<Workbook>(UniverInstanceType.UNIVER_SHEET)\n            .pipe(takeUntil(this.dispose$))\n            .subscribe((workbook) => this._disposeRenderer(workbook));\n    }\n\n    private _createRenderer(workbook: Workbook): void {\n        const unitId = workbook.getUnitId();\n        this._renderManagerService.created$.subscribe((renderer) => {\n            if (renderer.unitId === unitId) {\n                renderer.engine.getCanvas().setId(`${SHEET_MAIN_CANVAS_ID}_${unitId}`);\n                renderer.engine.getCanvas().getContext().setId(`${SHEET_MAIN_CANVAS_ID}_${unitId}`);\n            }\n        });\n\n        this._renderManagerService.createRender(unitId);\n    }\n\n    private _disposeRenderer(workbook: Workbook): void {\n        const unitId = workbook.getUnitId();\n        this._renderManagerService.removeRender(unitId);\n    }\n\n    private _initContextListener(): void {\n        // If we toggle the raw formula, we need to refresh all spreadsheets.\n        this.disposeWithMe(this._contextService.subscribeContextValue$(RENDER_RAW_FORMULA_KEY)\n            .pipe(distinctUntilChanged())\n            .subscribe(() => {\n                this._renderManagerService.getRenderAll().forEach((renderer) => {\n                    if (renderer.mainComponent instanceof Spreadsheet) {\n                        (renderer.mainComponent as Spreadsheet).makeForceDirty(true);\n                    }\n                });\n            }));\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommandInfo, IRange, Nullable, Workbook, Worksheet } from '@univerjs/core';\nimport type { ISetFormulaCalculationNotificationMutation } from '@univerjs/engine-formula';\nimport type { IAfterRender$Info, IBasicFrameInfo, IExtendFrameInfo, IRenderContext, IRenderModule, ISummaryFrameInfo, ISummaryMetric, ITimeMetric, IViewportInfos, Scene } from '@univerjs/engine-render';\nimport { CommandType, ICommandService, Inject, Optional, Rectangle, RxDisposable } from '@univerjs/core';\nimport { SetFormulaCalculationNotificationMutation } from '@univerjs/engine-formula';\nimport {\n    Rect,\n    ScrollBar,\n    SHEET_EXTENSION_PREFIX,\n    SHEET_VIEWPORT_KEY,\n    Spreadsheet,\n    SpreadsheetColumnHeader,\n    SpreadsheetRowHeader,\n    Viewport,\n} from '@univerjs/engine-render';\n\nimport { COMMAND_LISTENER_SKELETON_CHANGE, COMMAND_LISTENER_VALUE_CHANGE, MoveRangeMutation, SetRangeValuesMutation } from '@univerjs/sheets';\nimport { ITelemetryService } from '@univerjs/telemetry';\nimport { Subject, withLatestFrom } from 'rxjs';\nimport {\n    SHEET_COMPONENT_HEADER_LAYER_INDEX,\n    SHEET_COMPONENT_MAIN_LAYER_INDEX,\n    SHEET_VIEW_KEY,\n} from '../../common/keys';\nimport { SheetSkeletonManagerService } from '../../services/sheet-skeleton-manager.service';\nimport { SheetsRenderService } from '../../services/sheets-render.service';\n\ninterface ISetWorksheetMutationParams {\n    unitId: string;\n    subUnitId: string;\n}\n\nexport interface ITelemetryData {\n    unitId: string;\n    sheetId: string;\n    FPS: ISummaryMetric;\n    frameTime: ISummaryMetric;\n    elapsedTimeToStart: number;\n}\n\nconst FRAME_STACK_THRESHOLD = 60;\n\nexport class SheetRenderController extends RxDisposable implements IRenderModule {\n    private _renderMetric$: Subject<ITelemetryData> = new Subject();\n    renderMetric$ = this._renderMetric$.asObservable();\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(SheetSkeletonManagerService) private readonly _sheetSkeletonManagerService: SheetSkeletonManagerService,\n        @Inject(SheetsRenderService) private readonly _sheetRenderService: SheetsRenderService,\n        @ICommandService private readonly _commandService: ICommandService,\n        @Optional(ITelemetryService) private readonly _telemetryService?: ITelemetryService\n    ) {\n        super();\n        this._addNewRender();\n        this._initRenderMetricSubscriber();\n    }\n\n    private _addNewRender() {\n        const { scene, engine, unit: workbook } = this._context;\n\n        this._addComponent(workbook);\n        this._initRerenderScheduler();\n        this._initCommandListener();\n\n        const worksheet = this._context.unit.getActiveSheet();\n        if (!worksheet) {\n            throw new Error('No active sheet found');\n        }\n\n        const sheetId = worksheet.getSheetId();\n        this._sheetSkeletonManagerService.setCurrent({ sheetId });\n\n        const frameFn = () => scene.render();\n        this.disposeWithMe(this._context.activated$.subscribe((activated) => {\n            if (activated) {\n                // TODO: we should attach the context object to the RenderContext object on scene.canvas.\n                engine.runRenderLoop(frameFn);\n            } else {\n                // Stop the render loop when the render unit is deactivated.\n                engine.stopRenderLoop(frameFn);\n            }\n        }));\n    }\n\n    private _renderFrameTimeMetric: Nullable<Record<string, number[]>> = null;\n    private _renderFrameTags: Record<string, any> = {};\n\n    private _afterRenderMetric$: Subject<IAfterRender$Info> = new Subject<IAfterRender$Info>();\n    private _initRenderMetricSubscriber() {\n        const { engine } = this._context;\n\n        engine.beginFrame$.subscribe(() => {\n            this._renderFrameTimeMetric = null;\n            this._renderFrameTags = {};\n        });\n\n        engine.endFrame$.subscribe(() => {\n            const validRenderInfo = this._renderFrameTimeMetric &&\n                Object.keys(this._renderFrameTimeMetric).filter((key) => key.startsWith(SHEET_EXTENSION_PREFIX)).length > 0;\n\n            if (validRenderInfo) {\n                this._afterRenderMetric$.next({\n                    frameTimeMetric: this._renderFrameTimeMetric,\n                    tags: this._renderFrameTags,\n                } as IAfterRender$Info);\n            }\n        });\n\n        engine.renderFrameTimeMetric$.subscribe(([key, value]: ITimeMetric) => {\n            if (!this._renderFrameTimeMetric) this._renderFrameTimeMetric = {};\n            if (!this._renderFrameTimeMetric[key]) {\n                this._renderFrameTimeMetric[key] = [];\n            }\n            this._renderFrameTimeMetric[key].push(Math.round(value * 100) / 100);\n        });\n\n        engine.renderFrameTags$.subscribe(([key, value]: [string, any]) => {\n            this._renderFrameTags[key] = value;\n        });\n\n        const frameInfoList: IExtendFrameInfo[] = [];\n        this._afterRenderMetric$.pipe(withLatestFrom(engine.endFrame$)).subscribe(([sceneRenderDetail, basicFrameTimeInfo]: [IAfterRender$Info, IBasicFrameInfo]) => {\n            frameInfoList.push({\n                ...{\n                    FPS: basicFrameTimeInfo.FPS,\n                    elapsedTime: basicFrameTimeInfo.elapsedTime,\n                    frameTime: Math.round(basicFrameTimeInfo.frameTime * 100) / 100,\n                },\n                ...sceneRenderDetail.frameTimeMetric,\n                ...sceneRenderDetail.tags,\n            });\n            if (frameInfoList.length > FRAME_STACK_THRESHOLD) {\n                this._captureRenderMetric(frameInfoList);\n                frameInfoList.length = 0;\n            }\n        });\n    }\n\n    /**\n     * Send render metric to telemetry service\n     * @param frameInfoList\n     */\n    private _captureRenderMetric(frameInfoList: IExtendFrameInfo[]) {\n        const filteredFrameInfo = frameInfoList;//.filter((info) => info.scrolling);\n        if (filteredFrameInfo.length === 0) return;\n\n        // convert data = {\n        //     a: [1, 2, 3],\n        //     b: [4, 5, 6],\n        //     c: [7, 8, 9]\n        //     d: 'xxxx',\n        //   } into this  { a: 6, b: 15, c: 24, d: 'xxxx' }\n        const sumValueForNumListFields = (data: Record<string, number[] | any>) => {\n            let totalSum = 0;\n            const numberListValueKeys = Object.entries(data)\n                .filter(([_, value]) => Array.isArray(value))\n                .map(([key]) => key as keyof typeof data);\n\n            const sums: Record<string, number> = numberListValueKeys.reduce<Record<string, number>>((acc, key) => {\n                const keySum = data[key].reduce((sum: number, num: number) => sum + num, 0);\n                acc[key] = keySum;\n                return acc;\n            }, {});\n\n            const extKeys = Object.keys(data).filter((key) => key.startsWith(SHEET_EXTENSION_PREFIX));\n            extKeys.forEach((key) => {\n                totalSum += sums[key];\n            });\n            return { ...sums, extensionTotal: totalSum };\n        };\n        const frameTimeListAfterSum: IExtendFrameInfo[] = frameInfoList.map((info) => {\n            return { ...info, ...sumValueForNumListFields(info) };\n        });\n\n        // convert [{[key]: value}] ===> { [key]: {max, min, avg} }\n        const getSummaryStats = (list: IExtendFrameInfo[]): ISummaryFrameInfo => {\n            const numberValueKeys = Object.entries(list[0])\n                .filter(([key, _]) => !['elapsedTime'].includes(key))\n                .filter(([_, value]) => typeof value === 'number')\n                .map(([key]) => key as keyof typeof list[0]);\n\n            // { [key]: value } ===> {[key]: {max, min, avg}}\n            const stats = numberValueKeys.reduce((acc: Record<string, Record<string, number>>, key) => {\n                const values = list.map((obj) => obj[key]);\n                const max = Math.max(...values);\n                const min = Math.min(...values);\n                const avg = values.reduce((sum, val) => sum + val, 0) / values.length;\n\n                acc[key] = {\n                    max: Math.round(max * 100) / 100,\n                    min: Math.round(min * 100) / 100,\n                    avg: Math.round(avg * 100) / 100,\n                };\n\n                return acc;\n            }, {});\n\n            return stats as unknown as ISummaryFrameInfo;\n        };\n        const summaryFrameStats = getSummaryStats(frameTimeListAfterSum);\n        const elapsedTimeToStart = filteredFrameInfo[filteredFrameInfo.length - 1].elapsedTime;\n        const sheetId = this._context.unit.getActiveSheet().getSheetId();\n        const unitId = this._context.unit.getUnitId();\n        const telemetryData: ITelemetryData = { sheetId, unitId, elapsedTimeToStart, ...summaryFrameStats };\n        this._renderMetric$.next(telemetryData);\n\n        this._telemetryService?.capture('sheet_render_cost', telemetryData);\n    }\n\n    private _addComponent(workbook: Workbook) {\n        const { scene, components } = this._context;\n\n        const worksheet = workbook.getActiveSheet();\n        const spreadsheet = new Spreadsheet(SHEET_VIEW_KEY.MAIN);\n        this._addViewport(worksheet);\n\n        const spreadsheetRowHeader = new SpreadsheetRowHeader(SHEET_VIEW_KEY.ROW);\n        const spreadsheetColumnHeader = new SpreadsheetColumnHeader(SHEET_VIEW_KEY.COLUMN);\n        const SpreadsheetLeftTopPlaceholder = new Rect(SHEET_VIEW_KEY.LEFT_TOP, {\n            zIndex: 2,\n            left: -1,\n            top: -1,\n            fill: 'rgb(248, 249, 250)',\n            stroke: 'rgb(217, 217, 217)',\n            strokeWidth: 1,\n        });\n\n        this._context.mainComponent = spreadsheet;\n        components.set(SHEET_VIEW_KEY.MAIN, spreadsheet);\n        components.set(SHEET_VIEW_KEY.ROW, spreadsheetRowHeader);\n        components.set(SHEET_VIEW_KEY.COLUMN, spreadsheetColumnHeader);\n        components.set(SHEET_VIEW_KEY.LEFT_TOP, SpreadsheetLeftTopPlaceholder);\n\n        scene.addObjects([spreadsheet], SHEET_COMPONENT_MAIN_LAYER_INDEX);\n        scene.addObjects(\n            [spreadsheetRowHeader, spreadsheetColumnHeader, SpreadsheetLeftTopPlaceholder],\n            SHEET_COMPONENT_HEADER_LAYER_INDEX\n        );\n\n        scene.enableLayerCache(SHEET_COMPONENT_MAIN_LAYER_INDEX, SHEET_COMPONENT_HEADER_LAYER_INDEX);\n    }\n\n    private _initViewports(scene: Scene, rowHeader: { width: number }, columnHeader: { height: number }) {\n        const bufferEdgeX = 100;\n        const bufferEdgeY = 100;\n        const viewMain = new Viewport(SHEET_VIEWPORT_KEY.VIEW_MAIN, scene, {\n            left: rowHeader.width,\n            top: columnHeader.height,\n            bottom: 0,\n            right: 0,\n            isWheelPreventDefaultX: true,\n            allowCache: true,\n            bufferEdgeX,\n            bufferEdgeY,\n        });\n        const viewMainLeftTop = new Viewport(SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP, scene, {\n            isWheelPreventDefaultX: true,\n            active: false,\n            allowCache: true,\n            bufferEdgeX: 0,\n            bufferEdgeY: 0,\n        });\n        const viewMainLeft = new Viewport(SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT, scene, {\n            isWheelPreventDefaultX: true,\n            active: false,\n            allowCache: true,\n            bufferEdgeX: 0,\n            bufferEdgeY,\n        });\n        const viewMainTop = new Viewport(SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP, scene, {\n            isWheelPreventDefaultX: true,\n            active: false,\n            allowCache: true,\n            bufferEdgeX,\n            bufferEdgeY: 0,\n        });\n        const viewRowTop = new Viewport(SHEET_VIEWPORT_KEY.VIEW_ROW_TOP, scene, {\n            active: false,\n            isWheelPreventDefaultX: true,\n        });\n        const viewRowBottom = new Viewport(SHEET_VIEWPORT_KEY.VIEW_ROW_BOTTOM, scene, {\n            left: 0,\n            top: columnHeader.height,\n            bottom: 0,\n            width: rowHeader.width + 1,\n            isWheelPreventDefaultX: true,\n        });\n        const viewColumnLeft = new Viewport(SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT, scene, {\n            active: false,\n            isWheelPreventDefaultX: true,\n        });\n        const viewColumnRight = new Viewport(SHEET_VIEWPORT_KEY.VIEW_COLUMN_RIGHT, scene, {\n            left: rowHeader.width,\n            top: 0,\n            height: columnHeader.height + 1,\n            right: 0,\n            isWheelPreventDefaultX: true,\n        });\n        const viewLeftTop = new Viewport(SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP, scene, {\n            left: 0,\n            top: 0,\n            width: rowHeader.width,\n            height: columnHeader.height,\n            isWheelPreventDefaultX: true,\n        });\n\n        return {\n            viewMain,\n            viewLeftTop,\n            viewMainLeftTop,\n            viewMainLeft,\n            viewMainTop,\n            viewColumnLeft,\n            viewRowTop,\n            viewRowBottom,\n            viewColumnRight,\n        };\n    }\n\n    /**\n     *\n     * initViewport & wheel event\n     * +-----------------+--------------------+-------------------+\n     * |  VIEW_LEFT_TOP  |  VIEW_COLUMN_LEFT  | VIEW_COLUMN_RIGHT |\n     * +-----------------+--------------------+-------------------+\n     * |  VIEW_ROW_TOP   | VIEW_MAIN_LEFT_TOP |   VIEW_MAIN_TOP   |\n     * +-----------------+--------------------+-------------------+\n     * | VIEW_ROW_BOTTOM |   VIEW_MAIN_LEFT   |     VIEW_MAIN     |\n     * +-----------------+--------------------+-------------------+\n     */\n\n    private _addViewport(worksheet: Worksheet) {\n        const scene = this._context.scene;\n        const { rowHeader, columnHeader } = worksheet.getConfig();\n        const { viewMain } = this._initViewports(scene, rowHeader, columnHeader);\n\n        const _scrollBar = new ScrollBar(viewMain);\n\n        scene.attachControl();\n        return viewMain;\n    }\n\n    private _initRerenderScheduler(): void {\n        this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((param) => {\n            if (!param) return null;\n\n            const { skeleton: spreadsheetSkeleton, sheetId } = param;\n            const workbook = this._context.unit;\n            const worksheet = workbook?.getSheetBySheetId(sheetId);\n            if (workbook == null || worksheet == null) return;\n\n            const { mainComponent, components } = this._context;\n            const spreadsheet = mainComponent as Spreadsheet;\n            const spreadsheetRowHeader = components.get(SHEET_VIEW_KEY.ROW) as SpreadsheetRowHeader;\n            const spreadsheetColumnHeader = components.get(SHEET_VIEW_KEY.COLUMN) as SpreadsheetColumnHeader;\n            const spreadsheetLeftTopPlaceholder = components.get(SHEET_VIEW_KEY.LEFT_TOP) as Rect;\n\n            const { rowHeaderWidth, columnHeaderHeight } = spreadsheetSkeleton;\n            spreadsheet?.updateSkeleton(spreadsheetSkeleton);\n            spreadsheetRowHeader?.updateSkeleton(spreadsheetSkeleton);\n            spreadsheetColumnHeader?.updateSkeleton(spreadsheetSkeleton);\n            spreadsheetLeftTopPlaceholder?.transformByState({\n                width: rowHeaderWidth,\n                height: columnHeaderHeight,\n            });\n\n            // no need to update freezelineRect, freeze render controller has handled.\n            // const rowFreezeHeaderRect = this._context.scene.getObject(FREEZE_ROW_HEADER_NAME);\n            // if (rowFreezeHeaderRect) {\n            //     rowFreezeHeaderRect.transformByState({\n            //         top: columnHeaderHeight - rowFreezeHeaderRect.height,\n            //     });\n            // }\n            // const colFreezeHeaderRect = this._context.scene.getObject(FREEZE_COLUMN_HEADER_NAME);\n            // if (colFreezeHeaderRect) {\n            //     colFreezeHeaderRect.transformByState({\n            //         height: columnHeaderHeight,\n            //     });\n            // }\n        }));\n    }\n\n    private _initCommandListener(): void {\n        this.disposeWithMe(this._commandService.onCommandExecuted((command: ICommandInfo) => {\n            const { unit: workbook } = this._context;\n            const { id: commandId } = command;\n\n            if (COMMAND_LISTENER_SKELETON_CHANGE.includes(commandId) || this._sheetRenderService.checkMutationShouldTriggerRerender(commandId)) {\n                const params = command.params;\n                const { unitId, subUnitId } = params as ISetWorksheetMutationParams;\n                // const worksheet = subUnitId ? workbook?.getSheetBySheetId(subUnitId) : workbook.getActiveSheet();\n\n                const worksheet = workbook.getActiveSheet();\n                if (!worksheet) return;\n\n                const workbookId = this._context.unitId;\n                const worksheetId = worksheet.getSheetId();\n\n                if (unitId !== workbookId || subUnitId !== worksheetId) {\n                    return;\n                }\n\n                // DO NOT judge if SetWorksheetActiveOperation is executed.\n                // issue #univer-pro/issues/2310\n                // if (commandId !== SetWorksheetActiveOperation.id) {\n                // }\n                this._sheetSkeletonManagerService.makeDirty({\n                    sheetId: worksheetId,\n                    commandId,\n                }, true);\n\n                // TODO @lumixraku\n                // This is insane !!! Tons changes would call sk.setCurrent.\n                this._sheetSkeletonManagerService.setCurrent({\n                    sheetId: worksheetId,\n                    commandId,\n                });\n            } else if (COMMAND_LISTENER_VALUE_CHANGE.includes(commandId)) {\n                this._sheetSkeletonManagerService.reCalculate();\n            }\n\n            // All mutations must be executed. Using reCalculate alone will not trigger a refresh.\n            if (command.type === CommandType.MUTATION) {\n                this._markUnitDirty(command);\n            }\n        }));\n    }\n\n    private _markUnitDirty(command: ICommandInfo) {\n        const { mainComponent: spreadsheet, scene } = this._context;\n\n        if (command.id === SetFormulaCalculationNotificationMutation.id) {\n            const params = command.params as ISetFormulaCalculationNotificationMutation;\n            if (params.stageInfo != null) {\n                return;\n            }\n        }\n\n        if (spreadsheet) {\n            spreadsheet.makeDirty(); // refresh spreadsheet\n        }\n\n        scene.makeDirty();\n        if (!command.params) return;\n\n        const cmdParams = command.params as Record<string, any>;\n        const viewports = this._spreadsheetViewports(scene);\n        if (command.id === SetRangeValuesMutation.id && cmdParams.cellValue) {\n            const dirtyRange: IRange = this._cellValueToRange(cmdParams.cellValue);\n            const dirtyBounds = this._rangeToBounds([dirtyRange]);\n            this._markViewportDirty(viewports, dirtyBounds);\n            (spreadsheet as unknown as Spreadsheet).setDirtyArea(dirtyBounds);\n        }\n\n        if (command.id === MoveRangeMutation.id && cmdParams.from && cmdParams.to) {\n            // keep the get _cellValueToRange code to ensure the code can effect as before\n            const fromRange = cmdParams.fromRange || this._cellValueToRange(cmdParams.from.value);\n            const toRange = cmdParams.toRange || this._cellValueToRange(cmdParams.to.value);\n            const dirtyBounds = this._rangeToBounds([fromRange, toRange]);\n            this._markViewportDirty(viewports, dirtyBounds);\n            (spreadsheet as unknown as Spreadsheet).setDirtyArea(dirtyBounds);\n        }\n    }\n\n    /**\n     * cellValue data structure:\n     * {[row]: { [col]: value}}\n     * @param cellValue\n     * @returns IRange\n     */\n    private _cellValueToRange(cellValue: Record<number, Record<number, object>>) {\n        // const rows = Object.keys(cellValue).map(Number);\n        const columns = [];\n\n        let minCol = 0;\n        let maxCol = 0;\n        let minRow = 0;\n        let maxRow = 0;\n        for (const [_row, columnObj] of Object.entries(cellValue)) {\n            for (const column in columnObj) {\n                columns.push(Number(column));\n                if (minCol > Number(column)) {\n                    minCol = Number(column);\n                }\n                if (maxCol < Number(column)) {\n                    maxCol = Number(column);\n                }\n            }\n            if (minRow > Number(_row)) {\n                minRow = Number(_row);\n            }\n            if (maxRow < Number(_row)) {\n                maxRow = Number(_row);\n            }\n        }\n\n        // Chrome would give 'Maximum call stack size exceeded' error when calling Math.min(...arr) if array length is over 1572864\n        const startRow = minRow; // Math.min(...rows);\n        const endRow = maxRow; // Math.max(...rows);\n        const startColumn = minCol; // Math.min(...columns);\n        const endColumn = maxCol; // Math.max(...columns);\n\n        return {\n            startRow,\n            endRow,\n            startColumn,\n            endColumn,\n        } as IRange;\n    }\n\n    private _rangeToBounds(ranges: IRange[]) {\n        const skeleton = this._sheetSkeletonManagerService.getCurrentParam()!.skeleton;\n        const { rowHeightAccumulation, columnWidthAccumulation, rowHeaderWidth, columnHeaderHeight } = skeleton;\n\n        const dirtyBounds: IViewportInfos[] = [];\n        for (const r of ranges) {\n            const { startRow, endRow, startColumn, endColumn } = r;\n            const top = startRow === 0 ? 0 : rowHeightAccumulation[startRow - 1] + columnHeaderHeight;\n            const bottom = rowHeightAccumulation[endRow] + columnHeaderHeight;\n            const left = startColumn === 0 ? 0 : columnWidthAccumulation[startColumn - 1] + rowHeaderWidth;\n            const right = columnWidthAccumulation[endColumn] + rowHeaderWidth;\n            dirtyBounds.push({ top, left, bottom, right, width: right - left, height: bottom - top });\n        }\n        return dirtyBounds;\n    }\n\n    private _markViewportDirty(viewports: Viewport[], dirtyBounds: IViewportInfos[]) {\n        const activeViewports = viewports.filter((vp) => vp.isActive && vp.cacheBound);\n        for (const vp of activeViewports) {\n            for (const b of dirtyBounds) {\n                if (Rectangle.hasIntersectionBetweenTwoRect(vp.cacheBound!, b)) {\n                    vp.markDirty(true);\n                }\n            }\n        }\n    }\n\n    private _spreadsheetViewports(scene: Scene) {\n        return scene.getViewports().filter((v) => ['viewMain', 'viewMainLeftTop', 'viewMainTop', 'viewMainLeft'].includes(v.viewportKey));\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IRange } from '@univerjs/core';\nimport { createInterceptorKey, Disposable, InterceptorManager } from '@univerjs/core';\nimport type { Scene } from '@univerjs/engine-render';\n\ninterface ISheetPos {\n    unitId: string;\n    subUnitId: string;\n}\n\nconst PRINTING_RANGE = createInterceptorKey<IRange, ISheetPos>('PRINTING_RANGE');\nconst PRINTING_COMPONENT_COLLECT = createInterceptorKey<undefined, ISheetPos & { scene: Scene }>('PRINTING_COMPONENT_COLLECT');\n\nexport class SheetPrintInterceptorService extends Disposable {\n    readonly interceptor = new InterceptorManager({\n        PRINTING_RANGE,\n        PRINTING_COMPONENT_COLLECT,\n    });\n\n    constructor() {\n        super();\n        this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_RANGE, {\n            priority: -1,\n            handler: (_value) => _value,\n        }));\n\n        this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_COMPONENT_COLLECT, {\n            priority: -1,\n            handler: (_value) => _value,\n        }));\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ThemeService } from '@univerjs/core';\nimport type { BaseObject, IRectProps, Scene } from '@univerjs/engine-render';\nimport type { ISelectionStyle } from '@univerjs/sheets';\nimport { RANGE_TYPE } from '@univerjs/core';\nimport { Rect, SHEET_VIEWPORT_KEY } from '@univerjs/engine-render';\n\nimport { SHEET_COMPONENT_SELECTION_LAYER_INDEX } from '../../common/keys';\nimport { SELECTION_MANAGER_KEY, SelectionControl } from './selection-control';\n\nexport class MobileSelectionControl extends SelectionControl {\n    /**\n     * topLeft controlPointer, it is not visible, just transparent, for handling event.\n     */\n    private _fillControlTopLeft: Rect | null;\n    /**\n     * bottomRight controlPointer, it is not visible, just transparent, for handling event.\n     */\n    private _fillControlBottomRight: Rect | null;\n\n    protected _rangeType: RANGE_TYPE = RANGE_TYPE.NORMAL;\n\n    constructor(\n        protected override _scene: Scene,\n        protected override _zIndex: number,\n        protected override readonly _themeService: ThemeService,\n        options?: {\n            highlightHeader?: boolean;\n            enableAutoFill?: boolean;\n            rowHeaderWidth: number;\n            columnHeaderHeight: number;\n            rangeType?: RANGE_TYPE;\n        }\n    ) {\n        super(_scene, _zIndex, _themeService, options);\n        this._rangeType = options?.rangeType || RANGE_TYPE.NORMAL;\n        this.initControlPoints();\n    }\n\n    initControlPoints(): void {\n        const defaultStyle = this.currentStyle;\n        const expandCornerSize = defaultStyle.expandCornerSize || 0;\n        const expandCornerInnerSize = (defaultStyle.expandCornerSize || 0) / 4;\n        const AutofillStrokeWidth = defaultStyle.autofillStrokeWidth || 0;\n        const stroke = defaultStyle.stroke!;\n        const AutofillStroke = defaultStyle.autofillStroke!;\n        const zIndex = this.zIndex;\n        // @transformControlPoint takes care of left & top\n        this._fillControlTopLeft = new Rect(SELECTION_MANAGER_KEY.fillTopLeft + zIndex, {\n            zIndex: zIndex + 2,\n            width: expandCornerSize,\n            height: expandCornerSize,\n            radius: expandCornerSize / 2,\n            visualWidth: expandCornerInnerSize,\n            visualHeight: expandCornerInnerSize,\n            strokeWidth: AutofillStrokeWidth,\n        });\n\n        this._fillControlBottomRight = new Rect(SELECTION_MANAGER_KEY.fillBottomRight + zIndex, {\n            zIndex: zIndex + 2,\n            width: expandCornerSize,\n            height: expandCornerSize,\n            radius: expandCornerSize / 2,\n            visualHeight: expandCornerInnerSize,\n            visualWidth: expandCornerInnerSize,\n            strokeWidth: AutofillStrokeWidth,\n        });\n\n        const fillProps: IRectProps = {\n            fill: stroke,\n            stroke: AutofillStroke,\n            strokeScaleEnabled: false,\n        };\n        this._fillControlTopLeft!.setProps({ ...fillProps });\n        this._fillControlBottomRight!.setProps({ ...fillProps });\n\n        // put into scene\n        const objs = [\n            this._fillControlTopLeft,\n            this._fillControlBottomRight,\n        ] as BaseObject[];\n\n        // do not use this.model.rangeType, model has not been initialized yet\n        switch (this._rangeType) {\n            case RANGE_TYPE.ROW:\n                this.rowHeaderGroup.addObjects(...objs);\n                break;\n            case RANGE_TYPE.COLUMN:\n                this.columnHeaderGroup.addObjects(...objs);\n                break;\n            case RANGE_TYPE.NORMAL:\n                this.selectionShapeGroup.addObjects(...objs);\n        }\n\n        const scene = this.getScene();\n        scene.addObjects(objs, SHEET_COMPONENT_SELECTION_LAYER_INDEX);\n    }\n\n    get fillControlTopLeft(): Rect<IRectProps> | null {\n        return this._fillControlTopLeft;\n    }\n\n    set fillControlTopLeft(value: Rect) {\n        this._fillControlTopLeft = value;\n    }\n\n    get fillControlBottomRight(): Rect<IRectProps> | null {\n        return this._fillControlBottomRight;\n    }\n\n    set fillControlBottomRight(value: Rect) {\n        this._fillControlBottomRight = value;\n    }\n\n    get rangeType(): RANGE_TYPE {\n        return this._rangeType;\n    }\n\n    set rangeType(value: RANGE_TYPE) {\n        this._rangeType = value;\n    }\n\n    override dispose(): void {\n        this._fillControlBottomRight?.dispose();\n        this._fillControlTopLeft?.dispose();\n        super.dispose();\n    }\n\n    protected override _updateLayoutOfSelectionControl(style: ISelectionStyle): void {\n        super._updateLayoutOfSelectionControl(style);\n\n        // const rangeType = this.rangeType;\n        // startX startY shares same coordinate with viewport.(include row & colheader)\n\n        const defaultStyle = this.currentStyle;\n        if (style == null) {\n            style = defaultStyle;\n        }\n\n        const {\n            widgets = defaultStyle.widgets!,\n        } = style;\n        this.currentStyle = style;\n\n        // this condition is derived from selection-shape, I do not understand.\n        if (this._enableAutoFill === true && !super._hasWidgets(widgets)) {\n            const { viewportScrollX, viewportScrollY } = this.getViewportMainScrollInfo();\n            const { endX, endY } = this.selectionModel;\n            this.transformControlPoint(viewportScrollX, viewportScrollY, endX, endY);\n\n            this.fillControlTopLeft!.show();\n            this.fillControlBottomRight!.show();\n        } else {\n            this.fillControlTopLeft?.hide();\n            this.fillControlBottomRight?.hide();\n        }\n    }\n\n    getViewportMainScrollInfo() {\n        const viewMain = this.getScene().getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n        return {\n            viewportScrollX: viewMain?.viewportScrollX || 0,\n            viewportScrollY: viewMain?.viewportScrollY || 0,\n            width: viewMain?.width || 0,\n            height: viewMain?.height || 0,\n        };\n    }\n\n    /**\n     * Mainly for row & col selection control point position. update control point position by when scrolling.\n     * @param viewportScrollX viewportScrollX\n     * @param viewportScrollY\n     * @param sheetContentWidth\n     * @param sheetContentHeight max sheet content height, for very short sheet, control pointer shoud not out of sheet\n     */\n\n    transformControlPoint(viewportScrollX: number = 0, viewportScrollY: number = 0, sheetContentWidth: number = 0, sheetContentHeight: number = 0): void {\n        const style = this.currentStyle!;\n        const rangeType = this.selectionModel.rangeType;\n        const expandCornerSize = style.expandCornerSize!;\n        const { startX, startY, endX, endY } = this.selectionModel;\n\n        const viewportSizeInfo = this.getViewportMainScrollInfo();\n        const viewportW = viewportSizeInfo.width;\n        const viewportH = viewportSizeInfo.height;\n\n        switch (rangeType) {\n            case RANGE_TYPE.NORMAL:\n                this.fillControlTopLeft!.transformByState({\n                    left: -expandCornerSize / 2,\n                    top: -expandCornerSize / 2,\n                });\n                this.fillControlBottomRight!.transformByState({\n                    left: endX - startX - expandCornerSize / 2,\n                    top: endY - startY - expandCornerSize / 2,\n                });\n                break;\n\n            case RANGE_TYPE.ROW: {\n                const left = Math.min(viewportW / 2 + viewportScrollX, sheetContentWidth);\n                const controlLeft = -expandCornerSize / 2 + left;\n                this.fillControlTopLeft!.transformByState({\n                    left: controlLeft,\n                    top: -expandCornerSize / 2,\n                });\n                this.fillControlBottomRight!.transformByState({\n                    left: controlLeft,\n                    top: -expandCornerSize / 2 + endY - startY,\n                });\n            }\n                break;\n            case RANGE_TYPE.COLUMN:\n                {\n                    const top = Math.min(+viewportH / 2 + viewportScrollY, sheetContentHeight);\n                    const controlTop = -expandCornerSize / 2 + top;\n\n                    this.fillControlTopLeft!.transformByState({\n                        left: -expandCornerSize / 2,\n                        top: controlTop,\n                    });\n                    this.fillControlBottomRight!.transformByState({\n                        left: -expandCornerSize / 2 + endX - startX,\n                        top: controlTop,\n                    });\n                }\n                break;\n            default:\n                console.error('unknown range type');\n        }\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable complexity */\n/* eslint-disable max-lines-per-function */\nimport type {\n    EventState,\n    ICellWithCoord,\n    IDisposable,\n    IRange,\n    IRangeWithCoord,\n    Nullable,\n    Workbook,\n} from '@univerjs/core';\nimport type { IMouseEvent, IPointerEvent, IRenderContext, IRenderModule, Scene, SpreadsheetSkeleton, Viewport } from '@univerjs/engine-render';\nimport type { ISelectionWithCoord, ISelectionWithStyle, ISetSelectionsOperationParams, WorkbookSelectionModel } from '@univerjs/sheets';\nimport type { ISheetObjectParam } from '../../controllers/utils/component-tools';\nimport {\n    ICommandService,\n    IContextService,\n    ILogService,\n    Inject,\n    Injector,\n    RANGE_TYPE,\n    ThemeService,\n    toDisposable,\n} from '@univerjs/core';\nimport { ScrollTimer, ScrollTimerType, SHEET_VIEWPORT_KEY, Vector2 } from '@univerjs/engine-render';\nimport { convertSelectionDataToRange, REF_SELECTIONS_ENABLED, SelectionMoveType, SetSelectionsOperation, SheetsSelectionsService } from '@univerjs/sheets';\nimport { IShortcutService } from '@univerjs/ui';\nimport { distinctUntilChanged, startWith } from 'rxjs';\nimport { getCoordByOffset, getSheetObject } from '../../controllers/utils/component-tools';\nimport { isThisColSelected, isThisRowSelected } from '../../controllers/utils/selections-tools';\nimport { SheetScrollManagerService } from '../scroll-manager.service';\nimport { SheetSkeletonManagerService } from '../sheet-skeleton-manager.service';\nimport { BaseSelectionRenderService, getTopLeftSelectionOfCurrSheet, selectionDataForSelectAll } from './base-selection-render.service';\nimport { MobileSelectionControl } from './mobile-selection-shape';\nimport { attachSelectionWithCoord } from './util';\n\nenum ExpandingControl {\n    BOTTOM_RIGHT = 'bottom-right',\n    TOP_LEFT = 'top-left',\n    LEFT = 'left',\n    RIGHT = 'right',\n    TOP = 'top',\n    BOTTOM = 'bottom',\n}\nexport class MobileSheetsSelectionRenderService extends BaseSelectionRenderService implements IRenderModule {\n    private readonly _workbookSelections: WorkbookSelectionModel;\n    private _renderDisposable: Nullable<IDisposable> = null;\n\n    _expandingSelection: boolean = false;\n\n    protected override _selectionControls: MobileSelectionControl[] = []; // sheetID:Controls\n\n    expandingControlMode: ExpandingControl = ExpandingControl.BOTTOM_RIGHT;\n\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(Injector) injector: Injector,\n        @Inject(ThemeService) themeService: ThemeService,\n        @IShortcutService shortcutService: IShortcutService,\n        @Inject(SheetsSelectionsService) selectionManagerService: SheetsSelectionsService,\n        @Inject(SheetSkeletonManagerService) sheetSkeletonManagerService: SheetSkeletonManagerService,\n        @ILogService private readonly _logService: ILogService,\n        @ICommandService private readonly _commandService: ICommandService,\n        @IContextService protected readonly _contextService: IContextService,\n        @Inject(SheetScrollManagerService) private readonly _scrollManagerService: SheetScrollManagerService\n\n    ) {\n        super(\n            injector,\n            themeService,\n            shortcutService,\n            sheetSkeletonManagerService,\n            _contextService\n        );\n        this._workbookSelections = selectionManagerService.getWorkbookSelections(this._context.unitId);\n        this._init();\n    }\n\n    private _init() {\n        const sheetObject = this._getSheetObject();\n\n        this._initEventListeners(sheetObject);\n        this._initSelectionChangeListener();\n        // this._initThemeChangeListener();\n        this._initSkeletonChangeListener();\n        this._initUserActionSyncListener();\n        this._updateControlPointWhenScrolling();\n    }\n\n    private _initSkeletonChangeListener() {\n        this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((param) => {\n            if (param == null) {\n                this._logService.error('[SelectionRenderService]: should not receive null!');\n                return;\n            }\n\n            const unitId = this._context.unitId;\n            const { sheetId, skeleton } = param;\n            const { scene } = this._context;\n            const viewportMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n            this._changeRuntime(skeleton, scene, viewportMain);\n\n            // If there is no initial selection, add one by default in the top left corner.\n            const firstSelection = this._workbookSelections.getCurrentLastSelection();\n            if (!firstSelection) {\n                this._commandService.syncExecuteCommand(SetSelectionsOperation.id, {\n                    unitId,\n                    subUnitId: sheetId,\n                    selections: [getTopLeftSelectionOfCurrSheet(skeleton)],\n                } as ISetSelectionsOperationParams);\n            }\n        }));\n    }\n\n    private _initSelectionChangeListener() {\n        // When selection completes, we need to update the selections' rendering and clear event handlers.\n        // only ref selection need this. now mobile only has normal selection.\n        // this.disposeWithMe(this._workbookSelections.selectionMoveEnd$.subscribe((ISelectionWithStyleList) => {\n        //     this._reset();\n        //     for (const selectionWithStyle of ISelectionWithStyleList) {\n        //         this._addSelectionControlByModelData(selectionWithStyle);\n        //     }\n        // }));\n    }\n\n    private _initEventListeners(sheetObject: ISheetObjectParam): void {\n        const { spreadsheetRowHeader, spreadsheetColumnHeader, spreadsheet, spreadsheetLeftTopPlaceholder } = sheetObject;\n        const { scene } = this._context;\n        this._initSpreadsheetEvent(sheetObject);\n\n        this.disposeWithMe(\n            spreadsheetRowHeader?.onPointerUp$.subscribeEvent((evt: IPointerEvent | IMouseEvent, _state: EventState) => {\n                if (this._normalSelectionDisabled()) return;\n\n                const skeleton = this._sheetSkeletonManagerService.getCurrentParam()!.skeleton;\n                const { row } = getCoordByOffset(evt.offsetX, evt.offsetY, scene, skeleton);\n                const matchSelectionData = isThisRowSelected(this._workbookSelections.getCurrentSelections(), row);\n                if (matchSelectionData) return;\n\n                this.createNewSelection(evt, (spreadsheet.zIndex || 1) + 1, RANGE_TYPE.ROW, this._getActiveViewport(evt));\n                this._selectionMoveEnd$.next(this.getSelectionDataWithStyle());\n            })\n        );\n\n        this.disposeWithMe(\n            spreadsheetColumnHeader?.onPointerUp$.subscribeEvent((evt: IPointerEvent | IMouseEvent, _state: EventState) => {\n                if (this._normalSelectionDisabled()) return;\n\n                const skeleton = this._sheetSkeletonManagerService.getCurrentParam()!.skeleton;\n                const { column } = getCoordByOffset(evt.offsetX, evt.offsetY, scene, skeleton);\n                const matchSelectionData = isThisColSelected(this._workbookSelections.getCurrentSelections(), column);\n                if (matchSelectionData) return;\n                this.createNewSelection(evt, (spreadsheet.zIndex || 1) + 1, RANGE_TYPE.COLUMN, this._getActiveViewport(evt));\n                this._selectionMoveEnd$.next(this.getSelectionDataWithStyle());\n            })\n        );\n\n        // in mobile version, create a selection when pointerup.\n        // do not use onPointerDown$, pointerDown would close popup\n        // see packages/ui/src/views/components/context-menu/ContextMenu.tsx\n        this.disposeWithMe(spreadsheetLeftTopPlaceholder?.onPointerUp$.subscribeEvent((_evt: IPointerEvent | IMouseEvent, state: EventState) => {\n            if (this._normalSelectionDisabled()) return;\n\n            this._reset(); // remove all other selections\n\n            const skeleton = this._sheetSkeletonManagerService.getCurrentParam()!.skeleton;\n            const selectionWithStyle = selectionDataForSelectAll(skeleton);\n            this._addSelectionControlByModelData(selectionWithStyle);\n            // pointerup --> create selection\n            this.refreshSelectionMoveStart();\n\n            state.stopPropagation();\n            this._selectionMoveEnd$.next(this.getSelectionDataWithStyle());\n        }));\n    }\n\n    private _initSpreadsheetEvent(sheetObject: ISheetObjectParam): void {\n        const { spreadsheet } = sheetObject;\n        let longPressTimer: ReturnType<typeof setTimeout>;\n        const longPressDuration = 500; // Longpress duration in milliseconds\n        const pointerDownPos = { x: 0, y: 0 };\n\n        const clearLongPressTimer = () => {\n            // Clear the timer if pointer is moved or released\n            clearTimeout(longPressTimer);\n        };\n\n        const createNewSelection = (evt: IPointerEvent | IMouseEvent, showContextMenu: boolean) => {\n            // TODO @lumixraku\n            this.createNewSelection(\n                evt,\n                spreadsheet.zIndex + 1,\n                RANGE_TYPE.NORMAL,\n                this._getActiveViewport(evt)\n            );\n\n            // show contextmenu when longpress and change selection area\n            // do not show contextmenu when click a cell\n            if (showContextMenu) {\n                this._selectionMoveEnd$.next(this.getSelectionDataWithStyle());\n            }\n        };\n        spreadsheet?.onPointerMove$.subscribeEvent((evt: IPointerEvent | IMouseEvent, _state) => {\n            const edge = 10;\n            if (Math.abs(evt.offsetX - pointerDownPos.x) > edge ||\n            Math.abs(evt.offsetY - pointerDownPos.y) > edge) {\n                clearLongPressTimer();\n            }\n        });\n        const spreadsheetPointerDownSub = spreadsheet?.onPointerDown$.subscribeEvent((evt: IPointerEvent | IMouseEvent, state) => {\n            pointerDownPos.x = evt.offsetX;\n            pointerDownPos.y = evt.offsetY;\n            longPressTimer = setTimeout(() => {\n                createNewSelection(evt, true);\n            }, longPressDuration);\n\n            state.stopPropagation();\n        });\n        const spreadsheetPointerUpSub = spreadsheet?.onPointerUp$.subscribeEvent((evt: IPointerEvent | IMouseEvent, state) => {\n            if (this._normalSelectionDisabled()) return;\n\n            clearTimeout(longPressTimer);\n            const edge = 10;\n            if (Math.abs(evt.offsetX - pointerDownPos.x) > edge ||\n            Math.abs(evt.offsetY - pointerDownPos.y) > edge) {\n                return;\n            }\n            createNewSelection(evt, false);\n            state.stopPropagation();\n        });\n\n        this.disposeWithMe(toDisposable(spreadsheetPointerDownSub));\n        this.disposeWithMe(toDisposable(spreadsheetPointerUpSub));\n    }\n\n    private _initUserActionSyncListener() {\n        this.disposeWithMe(this.selectionMoveStart$.subscribe((params) => this._updateSelections(params, SelectionMoveType.MOVE_START)));\n        this.disposeWithMe(this.selectionMoving$.subscribe((params) => this._updateSelections(params, SelectionMoveType.MOVING)));\n\n        this.disposeWithMe(this._contextService.subscribeContextValue$(REF_SELECTIONS_ENABLED)\n            .pipe(startWith(false), distinctUntilChanged())\n            .subscribe((disabled) => {\n                if (disabled) {\n                    this._renderDisposable?.dispose();\n                    this._renderDisposable = null;\n                    this._reset();\n                } else {\n                    this._renderDisposable = toDisposable(\n                        this.selectionMoveEnd$.subscribe((params) => this._updateSelections(params, SelectionMoveType.MOVE_END))\n                    );\n                }\n            }));\n    }\n\n    private _updateSelections(selectionDataWithStyleList: ISelectionWithCoord[], type: SelectionMoveType) {\n        const workbook = this._context.unit;\n        const unitId = workbook.getUnitId();\n        const sheetId = workbook.getActiveSheet().getSheetId();\n\n        if (selectionDataWithStyleList.length === 0) {\n            return;\n        }\n\n        this._commandService.executeCommand(SetSelectionsOperation.id, {\n            unitId,\n            subUnitId: sheetId,\n            type,\n            selections: selectionDataWithStyleList.map((selectionDataWithStyle) =>\n                convertSelectionDataToRange(selectionDataWithStyle)\n            ),\n        });\n    }\n\n    /**\n     * invoked when pointerup or long press on spreadsheet, or pointerdown on row&col\n     * then move curr selection to cell at cursor\n     * Main purpose to create a new selection, or update curr selection to a new range.\n     * @param evt\n     * @param _zIndex\n     * @param rangeType\n     * @param viewport\n     */\n    createNewSelection(\n        evt: IPointerEvent | IMouseEvent,\n        _zIndex = 0,\n        rangeType: RANGE_TYPE = RANGE_TYPE.NORMAL,\n        viewport?: Viewport\n    ) {\n        this._rangeType = rangeType;\n\n        const skeleton = this._skeleton;\n        const scene = this._scene;\n        if (!scene || !skeleton) {\n            return;\n        }\n\n        if (viewport) {\n            this._activeViewport = viewport;\n        }\n\n        const { offsetX: evtOffsetX, offsetY: evtOffsetY } = evt;\n        const relativeCoords = scene.getCoordRelativeToViewport(Vector2.FromArray([evtOffsetX, evtOffsetY]));\n\n        const { x: offsetX, y: offsetY } = relativeCoords;\n        this._startViewportPosX = offsetX;\n        this._startViewportPosY = offsetY;\n        const scrollXY = scene.getScrollXYInfoByViewport(relativeCoords);\n        const { scaleX, scaleY } = scene.getAncestorScale();\n        // const selectionCellWithCoord: Nullable<ISelectionWithCoord> = this._getSelectionWithCoordByOffset(viewportPosX, viewportPosY, scaleX, scaleY, scrollXY);\n        // if (!selectionCellWithCoord) return;\n        // const { rangeWithCoord: cursorCellRange, primaryWithCoord: primaryCursorCellRange } = cursorCellRangeInfo;\n        const selectCell = this._skeleton.getCellByOffset(offsetX, offsetY, scaleX, scaleY, scrollXY);\n        if (!selectCell) return;\n        switch (rangeType) {\n            case RANGE_TYPE.NORMAL:\n                break;\n            case RANGE_TYPE.ROW:\n                selectCell.startColumn = 0;\n                selectCell.endColumn = this._skeleton.getColumnCount() - 1;\n                break;\n            case RANGE_TYPE.COLUMN:\n                selectCell.startRow = 0;\n                selectCell.endRow = this._skeleton.getRowCount() - 1;\n                break;\n            case RANGE_TYPE.ALL:\n                selectCell.startRow = 0;\n                selectCell.startColumn = 0;\n                selectCell.endRow = this._skeleton.getRowCount() - 1;\n                selectCell.endColumn = this._skeleton.getColumnCount() - 1;\n        }\n        const selectionWithStyle: ISelectionWithStyle = { range: selectCell, primary: selectCell, style: null };\n        selectionWithStyle.range.rangeType = rangeType;\n        const selectionCellWithCoord = attachSelectionWithCoord(selectionWithStyle, this._skeleton);\n        this._startRangeWhenPointerDown = { ...selectionCellWithCoord.rangeWithCoord };\n\n        let activeSelectionControl = this.getActiveSelectionControl<MobileSelectionControl>();\n\n        const cursorRangeWidthCoord: IRangeWithCoord = { ...selectionCellWithCoord.rangeWithCoord };\n        for (const control of this.getSelectionControls()) {\n            // Click to an existing selection\n            if (control.model.isEqual(cursorRangeWidthCoord)) {\n                activeSelectionControl = control;\n                break;\n            }\n        }\n\n        // TODO merge to _checkClearPreviousControls\n        if (activeSelectionControl?.model.rangeType !== rangeType) {\n            this._clearAllSelectionControls();\n            activeSelectionControl = this.newSelectionControl(scene, skeleton, selectionWithStyle);\n        } else {\n            activeSelectionControl.updateRangeBySelectionWithCoord(selectionCellWithCoord);\n        }\n\n        this._selectionMoveStart$.next(this.getSelectionDataWithStyle());\n        this._clearUpdatingListeners();\n        // this._addEndingListeners();\n        this._expandingSelection = false;\n    }\n\n    /**\n     * Not same as PC version,\n     * new selection control for mobile do one more thing: bind event for two control points.\n     * @param scene\n     * @param rangeType\n     */\n    override newSelectionControl(scene: Scene, skeleton: SpreadsheetSkeleton, selection: ISelectionWithStyle): MobileSelectionControl {\n        const selectionControls = this.getSelectionControls();\n        const { rowHeaderWidth, columnHeaderHeight } = skeleton;\n        const rangeType = selection.range.rangeType;\n        const control = new MobileSelectionControl(scene, selectionControls.length, this._themeService, {\n            highlightHeader: this._highlightHeader,\n            rowHeaderWidth,\n            columnHeaderHeight,\n            rangeType,\n        });\n        const selectionWithCoord = attachSelectionWithCoord(selection, skeleton);\n        control.updateRangeBySelectionWithCoord(selectionWithCoord);\n        this._selectionControls.push(control);\n\n        const { expandingModeForTopLeft, expandingModeForBottomRight } = (() => {\n            switch (rangeType) {\n                case RANGE_TYPE.NORMAL:\n                    return {\n                        expandingModeForTopLeft: ExpandingControl.TOP_LEFT,\n                        expandingModeForBottomRight: ExpandingControl.BOTTOM_RIGHT,\n                    };\n                case RANGE_TYPE.ROW:\n                    return {\n                        expandingModeForTopLeft: ExpandingControl.TOP,\n                        expandingModeForBottomRight: ExpandingControl.BOTTOM,\n                    };\n                case RANGE_TYPE.COLUMN:\n                    return {\n                        expandingModeForTopLeft: ExpandingControl.LEFT,\n                        expandingModeForBottomRight: ExpandingControl.RIGHT,\n                    };\n                case RANGE_TYPE.ALL:\n                    return {\n                        expandingModeForTopLeft: ExpandingControl.TOP_LEFT,\n                        expandingModeForBottomRight: ExpandingControl.BOTTOM_RIGHT,\n                    };\n                default:\n                    return {\n                        expandingModeForTopLeft: ExpandingControl.TOP_LEFT,\n                        expandingModeForBottomRight: ExpandingControl.BOTTOM_RIGHT,\n                    };\n            }\n        })();\n\n        control.fillControlTopLeft!.onPointerDown$.subscribeEvent((evt: IPointerEvent | IMouseEvent) => {\n            this._expandingSelection = true;\n            this.expandingControlMode = expandingModeForTopLeft;\n            this._selectionMoveStart$.next(this.getSelectionDataWithStyle());\n            this._fillControlPointerDownHandler(\n                evt,\n                rangeType,\n                this._activeViewport!\n            );\n        });\n        control.fillControlBottomRight!.onPointerDown$.subscribeEvent((evt: IPointerEvent | IMouseEvent) => {\n            this._expandingSelection = true;\n            this.expandingControlMode = expandingModeForBottomRight;\n            this._selectionMoveStart$.next(this.getSelectionDataWithStyle());\n            this._fillControlPointerDownHandler(\n                evt,\n                rangeType,\n                this._activeViewport!\n            );\n        });\n        if (rangeType === RANGE_TYPE.ROW || rangeType === RANGE_TYPE.COLUMN) {\n            const viewportMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n            if (!viewportMain) return control;\n        }\n\n        return control;\n    }\n\n    // same as PC\n    private _getActiveViewport(evt: IPointerEvent | IMouseEvent) {\n        const sheetObject = this._getSheetObject();\n        return sheetObject?.scene.getActiveViewportByCoord(Vector2.FromArray([evt.offsetX, evt.offsetY]));\n    }\n\n    // same as PC\n    private _getSheetObject() {\n        return getSheetObject(this._context.unit, this._context)!;\n    }\n\n    // same as PC\n    private _normalSelectionDisabled(): boolean {\n        return this._contextService.getContextValue(REF_SELECTIONS_ENABLED);\n    }\n\n    override getSelectionControls() {\n        return this._selectionControls;\n    }\n\n    private _fillControlPointerDownHandler(\n        evt: IPointerEvent | IMouseEvent,\n        rangeType: RANGE_TYPE = RANGE_TYPE.NORMAL,\n        viewport?: Viewport,\n        scrollTimerType: ScrollTimerType = ScrollTimerType.ALL\n    ) {\n        const skeleton = this._skeleton;\n        const scene = this._scene;\n        if (!scene || !skeleton) {\n            return;\n        }\n\n        if (viewport) {\n            this._activeViewport = viewport;\n        }\n\n        const viewportMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n\n        const activeSelectionControl = this.getActiveSelectionControl<MobileSelectionControl>();\n\n        if (!activeSelectionControl) return;\n\n        this._changeCurrCellWhenControlPointerDown();\n\n        this._selectionMoveStart$.next(this.getSelectionDataWithStyle());\n\n        this._clearUpdatingListeners();\n        this._addEndingListeners();\n\n        this._scrollTimer = ScrollTimer.create(this._scene, scrollTimerType);\n        this._scrollTimer.startScroll(viewportMain?.left ?? 0, viewportMain?.top ?? 0, viewportMain);\n\n        scene.getTransformer()?.clearSelectedObjects();\n\n        // #region pointermove\n        const relativeCoords = scene.getCoordRelativeToViewport(Vector2.FromArray([evt.offsetX, evt.offsetY]));\n        this._setupPointerMoveListener(viewportMain, activeSelectionControl!, rangeType, scrollTimerType, relativeCoords.x, relativeCoords.y);\n        // #endregion\n\n        // #region pointerup\n        // when selection mouse down, disable the short cut service\n        const disposableShortcut = this._shortcutService.forceEscape();\n        this._scenePointerUpSub = scene.onPointerUp$.subscribeEvent((_evt: IPointerEvent | IMouseEvent) => {\n            this.endSelection();\n            this._expandingSelection = false;\n            this.expandingControlMode = ExpandingControl.BOTTOM_RIGHT;\n            this._selectionMoveEnd$.next(this.getSelectionDataWithStyle());\n\n            // when selection mouse up, enable the short cut service\n            disposableShortcut.dispose();\n        });\n        // #endregion\n    }\n\n    private _changeCurrCellWhenControlPointerDown(): ICellWithCoord {\n        const activeSelectionControl = this.getActiveSelectionControl<MobileSelectionControl>()!;\n        const skeleton = this._skeleton;\n\n        let currCellRange: ICellWithCoord;\n\n        const { startRow, startColumn, endRow, endColumn } = activeSelectionControl.model;\n        switch (this.expandingControlMode) {\n            case ExpandingControl.TOP_LEFT:\n                currCellRange = skeleton.getCellWithCoordByIndex(endRow, endColumn);\n                break;\n            case ExpandingControl.BOTTOM_RIGHT:\n                currCellRange =\n                        skeleton.getCellWithCoordByIndex(startRow, startColumn);\n                break;\n            case ExpandingControl.LEFT:\n                currCellRange =\n                        skeleton.getCellWithCoordByIndex(startRow, endColumn);\n                currCellRange.isMerged = false;\n                currCellRange.isMergedMainCell = false;\n                break;\n            case ExpandingControl.RIGHT:\n                currCellRange =\n                        skeleton.getCellWithCoordByIndex(startRow, startColumn);\n                currCellRange.isMerged = false;\n                currCellRange.isMergedMainCell = false;\n                break;\n            case ExpandingControl.TOP:\n                currCellRange =\n                        skeleton.getCellWithCoordByIndex(endRow, startColumn);\n                currCellRange.isMerged = false;\n                currCellRange.isMergedMainCell = false;\n                break;\n            case ExpandingControl.BOTTOM:\n                currCellRange =\n                        skeleton.getCellWithCoordByIndex(startRow, startColumn);\n                currCellRange.isMerged = false;\n                currCellRange.isMergedMainCell = false;\n                break;\n            default:\n                currCellRange =\n                        skeleton.getCellWithCoordByIndex(startRow, startColumn);\n        }\n        activeSelectionControl.updateCurrCell(currCellRange);\n        return currCellRange;\n    }\n\n    /**\n     * Not same as _moving in PC (base selection render service)\n     * The diff is\n     * In base version, new selection is determined by the cursor cell and _startRangeWhenPointerDown\n     *\n     * In Mobile version, new selection is determined by cursor cell and current of activeSelectionControl.model\n     */\n    protected override _movingHandler(\n        offsetX: number,\n        offsetY: number,\n        activeSelectionControl: MobileSelectionControl,\n        rangeType: RANGE_TYPE\n    ) {\n        this._rangeType = rangeType;\n        const skeleton = this._skeleton;\n        const scene = this._scene;\n\n        const currSelectionRange: IRange = {\n            startRow: activeSelectionControl.model.startRow,\n            endRow: activeSelectionControl.model.endRow,\n            startColumn: activeSelectionControl.model.startColumn,\n            endColumn: activeSelectionControl.model.endColumn,\n        };\n\n        const viewportMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN)!;\n\n        const targetViewport = this._getViewportByCell(currSelectionRange.endRow, currSelectionRange.endColumn) ?? viewportMain;\n\n        const scrollXY = scene.getScrollXYInfoByViewport(\n            Vector2.FromArray([this._startViewportPosX, this._startViewportPosY]),\n            targetViewport\n        );\n\n        const { scaleX, scaleY } = scene.getAncestorScale();\n\n        // const { rowHeaderWidth, columnHeaderHeight } = skeleton;\n\n        if (rangeType === RANGE_TYPE.ROW) {\n            // eslint-disable-next-line no-param-reassign\n            offsetX = Number.POSITIVE_INFINITY;\n        } else if (rangeType === RANGE_TYPE.COLUMN) {\n            // eslint-disable-next-line no-param-reassign\n            offsetY = Number.POSITIVE_INFINITY;\n        }\n\n        const cursorCellRangeInfo = this._getSelectionWithCoordByOffset(offsetX, offsetY, scaleX, scaleY, scrollXY);\n        if (!cursorCellRangeInfo) {\n            return false;\n        }\n\n        const { rangeWithCoord: cursorCellRange } = cursorCellRangeInfo;\n\n        const currCellRange = activeSelectionControl.model.currentCell;\n        const startRowOfActiveCell = currCellRange?.mergeInfo.startRow ?? -1;\n        const endRowOfActiveCell = currCellRange?.mergeInfo.endRow ?? -1;\n        const startColumnOfActiveCell = currCellRange?.mergeInfo.startColumn ?? -1;\n        const endColOfActiveCell = currCellRange?.mergeInfo.endColumn ?? -1;\n\n        let newSelectionRange: IRange = {\n            startRow: Math.min(cursorCellRange.startRow, startRowOfActiveCell),\n            startColumn: Math.min(cursorCellRange.startColumn, startColumnOfActiveCell),\n            endRow: Math.max(cursorCellRange.endRow, endRowOfActiveCell),\n            endColumn: Math.max(cursorCellRange.endColumn, endColOfActiveCell),\n        };\n\n        if (rangeType === RANGE_TYPE.NORMAL) {\n            newSelectionRange = skeleton.expandRangeByMerge(newSelectionRange);\n        } else if (rangeType === RANGE_TYPE.COLUMN) {\n            newSelectionRange = {\n                startRow: Math.min(cursorCellRange.startRow, currCellRange?.actualRow ?? -1),\n                startColumn: Math.min(cursorCellRange.startColumn, currCellRange?.actualColumn ?? -1),\n                endRow: Math.max(cursorCellRange.endRow, currCellRange?.actualRow ?? -1),\n                endColumn: Math.max(cursorCellRange.endColumn, currCellRange?.actualColumn ?? -1),\n\n            };\n        } else if (rangeType === RANGE_TYPE.ROW) {\n            newSelectionRange = {\n                startRow: Math.min(cursorCellRange.startRow, currCellRange?.actualRow ?? -1),\n                startColumn: Math.min(cursorCellRange.startColumn, currCellRange?.actualColumn ?? -1),\n                endRow: Math.max(cursorCellRange.endRow, currCellRange?.actualRow ?? -1),\n                endColumn: Math.max(cursorCellRange.endColumn, currCellRange?.actualColumn ?? -1),\n\n            };\n        }\n\n        if (!newSelectionRange) {\n            return false;\n        }\n        const newSelection: ISelectionWithStyle = { range: newSelectionRange, style: null, primary: null };\n        const newSelectionRangeWithCoord = attachSelectionWithCoord(newSelection, skeleton);\n        // newSelectionRangeWithCoord.rangeWithCoord.unitId = unitId;\n        // newSelectionRangeWithCoord.rangeWithCoord.sheetId = sheetId;\n\n        // const startCellXY = skeleton.getNoMergeCellPositionByIndex(newSelectionRange.startRow, newSelectionRange.startColumn);\n        // const endCellXY = skeleton.getNoMergeCellPositionByIndex(newSelectionRange.endRow, newSelectionRange.endColumn);\n\n        // const newSelectionRangeWithCoord: IRangeWithCoord = {\n        //     startColumn: newSelectionRange.startColumn,\n        //     startRow: newSelectionRange.startRow,\n        //     endColumn: newSelectionRange.endColumn,\n        //     endRow: newSelectionRange.endRow,\n        //     startY: startCellXY?.startY || 0,\n        //     endY: endCellXY?.endY || 0,\n        //     startX: startCellXY?.startX || 0,\n        //     endX: endCellXY?.endX || 0,\n        // };\n\n        const rangeChanged =\n            currSelectionRange.startRow !== newSelectionRange.startRow ||\n            currSelectionRange.startColumn !== newSelectionRange.startColumn ||\n            currSelectionRange.endRow !== newSelectionRange.endRow ||\n            currSelectionRange.endColumn !== newSelectionRange.endColumn;\n        if (rangeChanged) {\n            if (activeSelectionControl) {\n                activeSelectionControl.updateRangeBySelectionWithCoord(newSelectionRangeWithCoord);\n                this._selectionMoving$.next(this.getSelectionDataWithStyle());\n            }\n        }\n    }\n\n    private _updateControlPointWhenScrolling(): void {\n        const { scene } = this._context;\n        const viewportMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n        if (!viewportMain) return;\n        const sub = this._scrollManagerService.validViewportScrollInfo$.subscribe((param) => {\n            if (param == null) {\n                return;\n            }\n            const { viewportScrollX, viewportScrollY } = param!;\n\n            const activeControl = this.getActiveSelectionControl<MobileSelectionControl>();\n            if (activeControl == null) {\n                return;\n            }\n            const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n            const sheetContentHeight = skeleton?.rowTotalHeight;\n            const sheetContentWidth = skeleton?.columnTotalWidth;\n            const rangeType = activeControl.rangeType;\n            if (rangeType === RANGE_TYPE.COLUMN) {\n                activeControl.transformControlPoint(0, viewportScrollY, sheetContentWidth, sheetContentHeight);\n            } else if (rangeType === RANGE_TYPE.ROW) {\n                activeControl.transformControlPoint(viewportScrollX, 0, sheetContentWidth, sheetContentHeight);\n            }\n        });\n        this.disposeWithMe(toDisposable(sub));\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Dependency, Workbook } from '@univerjs/core';\nimport type { IUniverSheetsUIConfig } from './controllers/config.schema';\nimport { DependentOn, Inject, Injector, IUniverInstanceService, Plugin, UniverInstanceType } from '@univerjs/core';\n\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport { IRefSelectionsService, RefSelectionsService, UniverSheetsPlugin } from '@univerjs/sheets';\n\nimport { UniverMobileUIPlugin } from '@univerjs/ui';\nimport { filter } from 'rxjs/operators';\nimport { ActiveWorksheetController } from './controllers/active-worksheet/active-worksheet.controller';\nimport { AutoHeightController } from './controllers/auto-height.controller';\nimport { CellAlertRenderController } from './controllers/cell-alert.controller';\nimport { CellCustomRenderController } from './controllers/cell-custom-render.controller';\nimport { SheetClipboardController } from './controllers/clipboard/clipboard.controller';\nimport { defaultPluginConfig } from './controllers/config.schema';\n// import { SheetContextMenuRenderController } from './controllers/render-controllers/contextmenu.render-controller';\nimport { DragRenderController } from './controllers/drag-render.controller';\nimport { ForceStringAlertRenderController } from './controllers/force-string-alert-render.controller';\nimport { ForceStringRenderController } from './controllers/force-string-render.controller';\nimport { HoverRenderController } from './controllers/hover-render.controller';\nimport { MarkSelectionRenderController } from './controllers/mark-selection.controller';\nimport { SheetUIMobileController } from './controllers/mobile/mobile-sheet-ui.controller';\nimport { SheetPermissionCheckUIController } from './controllers/permission/sheet-permission-check-ui.controller';\nimport { SheetPermissionInterceptorCanvasRenderController } from './controllers/permission/sheet-permission-interceptor-canvas-render.controller';\nimport { SheetPermissionInterceptorClipboardController } from './controllers/permission/sheet-permission-interceptor-clipboard.controller';\nimport { SheetPermissionInterceptorFormulaRenderController } from './controllers/permission/sheet-permission-interceptor-formula-render.controller';\nimport { SheetPermissionRenderController, SheetPermissionRenderManagerController, WorksheetProtectionRenderController } from './controllers/permission/sheet-permission-render.controller';\nimport { FormatPainterRenderController } from './controllers/render-controllers/format-painter.render-controller';\nimport { HeaderFreezeRenderController } from './controllers/render-controllers/freeze.render-controller';\nimport { HeaderMoveRenderController } from './controllers/render-controllers/header-move.render-controller';\nimport { SheetContextMenuMobileRenderController } from './controllers/render-controllers/mobile/mobile-contextmenu.render-controller';\nimport { MobileSheetsScrollRenderController } from './controllers/render-controllers/mobile/mobile-scroll.render-controller';\nimport { SheetRenderController } from './controllers/render-controllers/sheet.render-controller';\nimport { SheetsZoomRenderController } from './controllers/render-controllers/zoom.render-controller';\nimport { StatusBarController } from './controllers/status-bar.controller';\nimport { AutoFillService, IAutoFillService } from './services/auto-fill/auto-fill.service';\nimport { SheetCanvasPopManagerService } from './services/canvas-pop-manager.service';\nimport { CellAlertManagerService } from './services/cell-alert-manager.service';\nimport { ISheetClipboardService, SheetClipboardService } from './services/clipboard/clipboard.service';\nimport { DragManagerService } from './services/drag-manager.service';\nimport { FormatPainterService, IFormatPainterService } from './services/format-painter/format-painter.service';\nimport { HoverManagerService } from './services/hover-manager.service';\nimport { IMarkSelectionService, MarkSelectionService } from './services/mark-selection/mark-selection.service';\nimport { SheetPermissionPanelModel } from './services/permission/sheet-permission-panel.model';\nimport { SheetPermissionUserManagerService } from './services/permission/sheet-permission-user-list.service';\nimport { SheetPrintInterceptorService } from './services/print-interceptor.service';\nimport { SheetScrollManagerService } from './services/scroll-manager.service';\nimport { SelectAllService } from './services/select-all/select-all.service';\nimport { ISheetSelectionRenderService } from './services/selection/base-selection-render.service';\nimport { MobileSheetsSelectionRenderService } from './services/selection/mobile-selection-render.service';\nimport { ISheetBarService, SheetBarService } from './services/sheet-bar/sheet-bar.service';\nimport { SheetSkeletonManagerService } from './services/sheet-skeleton-manager.service';\nimport { SheetsRenderService } from './services/sheets-render.service';\nimport { ShortcutExperienceService } from './services/shortcut-experience.service';\nimport { IStatusBarService, StatusBarService } from './services/status-bar.service';\n\n/**\n * @ignore\n */\n@DependentOn(UniverSheetsPlugin, UniverMobileUIPlugin)\nexport class UniverSheetsMobileUIPlugin extends Plugin {\n    static override pluginName = 'SHEET_UI_PLUGIN';\n    static override type = UniverInstanceType.UNIVER_SHEET;\n\n    constructor(\n        private readonly _config: Partial<IUniverSheetsUIConfig> = defaultPluginConfig,\n        @Inject(Injector) override readonly _injector: Injector,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService,\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService\n    ) {\n        super();\n    }\n\n    override onStarting(): void {\n        (\n            [\n                [ShortcutExperienceService],\n                [ISheetClipboardService, { useClass: SheetClipboardService }],\n                [ISheetBarService, { useClass: SheetBarService }],\n                [IFormatPainterService, { useClass: FormatPainterService }],\n                [IAutoFillService, { useClass: AutoFillService }],\n                [SheetPrintInterceptorService],\n                [ISheetSelectionRenderService, { useClass: MobileSheetsSelectionRenderService }],\n                [IStatusBarService, { useClass: StatusBarService }],\n                [IMarkSelectionService, { useClass: MarkSelectionService }],\n                [HoverManagerService],\n                [DragManagerService],\n                [SheetCanvasPopManagerService],\n                [CellAlertManagerService],\n                [SelectAllService],\n\n                [ActiveWorksheetController],\n                [AutoHeightController],\n                [SheetClipboardController],\n                [SheetsRenderService],\n                [SheetUIMobileController],\n                [StatusBarController],\n                [IRefSelectionsService, { useClass: RefSelectionsService }],\n\n                // permission\n                [SheetPermissionPanelModel],\n                [SheetPermissionUserManagerService],\n                [WorksheetProtectionRenderController],\n                [SheetPermissionInterceptorClipboardController],\n                [SheetPermissionCheckUIController],\n                [SheetPermissionRenderManagerController],\n            ] as Dependency[]\n        ).forEach((d) => this._injector.add(d));\n    }\n\n    override onReady(): void {\n        this._markSheetAsFocused();\n        this._registerRenderBasics();\n\n        this._injector.get(SheetUIMobileController);\n    }\n\n    override onRendered(): void {\n        this._registerRenderModules();\n    }\n\n    private _registerRenderBasics(): void {\n        ([\n            [SheetSkeletonManagerService],\n            [SheetRenderController],\n            [ISheetSelectionRenderService, { useClass: MobileSheetsSelectionRenderService }],\n            [SheetScrollManagerService],\n        ] as Dependency[]).forEach((renderDep) => {\n            this.disposeWithMe(this._renderManagerService.registerRenderModule(UniverInstanceType.UNIVER_SHEET, renderDep));\n        });\n    }\n\n    // We have to let render basics get bootstrapped before. Because some render controllers relies on\n    // a correct skeleton when they get loaded.\n    private _registerRenderModules(): void {\n        ([\n            // https://github.com/dream-num/univer-pro/issues/669\n            // HeaderMoveRenderController(HMRC) must be initialized before SelectionRenderController(SRC).\n            // Before HMRC expected selections remain unchanged when user clicks on the header. If we don't initialize HMRC before SRC,\n            // the selections will be changed by SRC first. Maybe we should merge row/col header related render controllers to one class.\n            [HeaderMoveRenderController],\n            [HeaderFreezeRenderController],\n            // Caution: ScrollRenderController should placed before ZoomRenderController\n            // because ZoomRenderController would change scrollInfo in currentSkeletonBefore$.\n            [MobileSheetsScrollRenderController],\n            [SheetsZoomRenderController],\n            [FormatPainterRenderController],\n            [CellAlertRenderController],\n            [ForceStringAlertRenderController],\n            [MarkSelectionRenderController],\n            [HoverRenderController],\n            [DragRenderController],\n            [ForceStringRenderController],\n            [CellCustomRenderController],\n            [SheetContextMenuMobileRenderController],\n\n            [SheetPermissionInterceptorCanvasRenderController],\n            [SheetPermissionInterceptorFormulaRenderController],\n            [SheetPermissionRenderController],\n        ] as Dependency[]).forEach((renderModule) => {\n            this.disposeWithMe(this._renderManagerService.registerRenderModule(UniverInstanceType.UNIVER_SHEET, renderModule));\n        });\n    }\n\n    private _markSheetAsFocused(): void {\n        const univerInstanceService = this._univerInstanceService;\n        this.disposeWithMe(univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET)\n            .pipe(filter((v) => !!v))\n            .subscribe((workbook) => {\n                if (this._univerInstanceService.getFocusedUnit() === workbook) return;\n                univerInstanceService.focusUnit(workbook!.getUnitId());\n            }));\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellData, ICommandInfo, IExecutionOptions, IMutationCommonParams, IMutationInfo, IRange, Nullable, UnitModel, Workbook } from '@univerjs/core';\nimport type {\n    IAddWorksheetMergeMutationParams,\n    IRemoveSheetMutationParams,\n    IRemoveWorksheetMergeMutationParams,\n    ISetRangeValuesMutationParams,\n} from '@univerjs/sheets';\nimport type {\n    APPLY_FUNCTIONS,\n    IAutoFillLocation,\n    ICopyDataInType,\n    ICopyDataPiece,\n    IRuleConfirmedData,\n    ISheetAutoFillHook,\n} from '../services/auto-fill/type';\nimport type { IDiscreteRange } from './utils/range-tools';\nimport {\n    Direction,\n    Disposable,\n    DisposableCollection,\n    ICommandService,\n    Inject,\n    Injector,\n    IUniverInstanceService,\n    ObjectMatrix,\n    Rectangle,\n    Tools,\n    UniverInstanceType,\n} from '@univerjs/core';\n\nimport { DeviceInputEventType, getCurrentTypeOfRenderer, IRenderManagerService } from '@univerjs/engine-render';\nimport {\n    AddMergeUndoMutationFactory,\n    AddWorksheetMergeMutation,\n    getAddMergeMutationRangeByType,\n    InsertColMutation,\n    InsertRowMutation,\n    MoveColsMutation,\n    MoveRangeMutation,\n    MoveRowsMutation,\n    RemoveColMutation,\n    RemoveMergeUndoMutationFactory,\n    RemoveRowMutation,\n    RemoveSheetMutation,\n    RemoveWorksheetMergeMutation,\n    SetRangeValuesCommand,\n    SetRangeValuesMutation,\n    SetRangeValuesUndoMutationFactory,\n    SetSelectionsOperation,\n    SetWorksheetActiveOperation,\n    SetWorksheetColWidthMutation,\n    SetWorksheetRowHeightMutation,\n} from '@univerjs/sheets';\nimport { AutoClearContentCommand, AutoFillCommand } from '../commands/commands/auto-fill.command';\nimport { RefillCommand } from '../commands/commands/refill.command';\nimport { SetCellEditVisibleOperation } from '../commands/operations/cell-edit.operation';\nimport { SetZoomRatioOperation } from '../commands/operations/set-zoom-ratio.operation';\nimport { IAutoFillService } from '../services/auto-fill/auto-fill.service';\nimport { otherRule } from '../services/auto-fill/rules';\nimport { fillCopy, fillCopyStyles, getDataIndex, getLenS } from '../services/auto-fill/tools';\nimport { APPLY_TYPE, AutoFillHookType, DATA_TYPE } from '../services/auto-fill/type';\nimport { IEditorBridgeService } from '../services/editor-bridge.service';\nimport { ISheetSelectionRenderService } from '../services/selection/base-selection-render.service';\nimport { SheetsRenderService } from '../services/sheets-render.service';\nimport { discreteRangeToRange, generateNullCellValueRowCol } from './utils/range-tools';\n\nexport class AutoFillController extends Disposable {\n    private _beforeApplyData: Array<Array<Nullable<ICellData>>> = [];\n    private _currentLocation: Nullable<IAutoFillLocation> = null;\n\n    private _copyData: ICopyDataPiece[] = [];\n    private _defaultHook: ISheetAutoFillHook;\n    constructor(\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService,\n        @ICommandService private readonly _commandService: ICommandService,\n        @IAutoFillService private readonly _autoFillService: IAutoFillService,\n        @IEditorBridgeService private readonly _editorBridgeService: IEditorBridgeService,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService,\n        @Inject(Injector) private readonly _injector: Injector,\n        @Inject(SheetsRenderService) private _sheetsRenderService: SheetsRenderService\n    ) {\n        super();\n        this._defaultHook = {\n            id: 'default',\n            type: AutoFillHookType.Default,\n            priority: 0,\n            onBeforeFillData: (location: IAutoFillLocation, direction: Direction) => {\n                return this._presetAndCacheData(location, direction);\n            },\n            onFillData: (location: IAutoFillLocation, direction: Direction, applyType: APPLY_TYPE) => {\n                return this._fillData(location, direction, applyType);\n            },\n        };\n        this._init();\n    }\n\n    private _init() {\n        this._initDefaultHook();\n        this._initSelectionControlFillChanged();\n        this._initQuitListener();\n        this._initSkeletonChange();\n    }\n\n    private _initSkeletonChange() {\n        this.disposeWithMe(this._sheetsRenderService.registerSkeletonChangingMutations(AutoFillCommand.id));\n    }\n\n    private _initDefaultHook() {\n        this.disposeWithMe(this._autoFillService.addHook(this._defaultHook));\n    }\n\n    private _initQuitListener() {\n        const quitCommands = [\n            SetCellEditVisibleOperation.id,\n            AutoClearContentCommand.id,\n            SetRangeValuesCommand.id,\n            SetZoomRatioOperation.id,\n            SetWorksheetActiveOperation.id,\n            MoveRangeMutation.id,\n            RemoveRowMutation.id,\n            RemoveColMutation.id,\n            InsertRowMutation.id,\n            InsertColMutation.id,\n            MoveRowsMutation.id,\n            MoveColsMutation.id,\n            SetWorksheetColWidthMutation.id,\n            SetWorksheetRowHeightMutation.id,\n            SetRangeValuesMutation.id,\n        ];\n\n        this.disposeWithMe(this._commandService.onCommandExecuted((command: ICommandInfo, options?: IExecutionOptions) => {\n            const fromCollab = options?.fromCollab;\n            const fromSync = options?.fromSync;\n            const fromFormula = options?.fromFormula;\n            if (quitCommands.includes(command.id)\n                && !fromCollab\n                && !fromSync\n                && !fromFormula\n                && (command.params as IMutationCommonParams).trigger !== AutoFillCommand.id\n                && (command.params as IMutationCommonParams).trigger !== RefillCommand.id\n            ) {\n                this._quit();\n            }\n            if (command.id === RemoveSheetMutation.id) {\n                if ((command.params as IRemoveSheetMutationParams).unitId === this._currentLocation?.unitId &&\n                    (command.params as IRemoveSheetMutationParams).subUnitId === this._currentLocation?.subUnitId) {\n                    this._quit();\n                }\n            }\n        }));\n        this.disposeWithMe(this._univerInstanceService.unitDisposed$.subscribe((unit: UnitModel) => {\n            if (unit.getUnitId() === this._currentLocation?.unitId) {\n                this._quit();\n            }\n        }));\n    }\n\n    private _quit() {\n        this._currentLocation = null;\n        this._beforeApplyData = [];\n        this._copyData = [];\n        this._autoFillService.setShowMenu(false);\n    }\n\n    private _initSelectionControlFillChanged() {\n        const disposableCollection = new DisposableCollection();\n        const updateListener = () => {\n            // Each range change requires re-listening.\n            disposableCollection.dispose();\n\n            const currentRenderer = getCurrentTypeOfRenderer(UniverInstanceType.UNIVER_SHEET, this._univerInstanceService, this._renderManagerService);\n            if (!currentRenderer) return;\n\n            const selectionRenderService = currentRenderer.with(ISheetSelectionRenderService);\n            const selectionControls = selectionRenderService.getSelectionControls();\n            selectionControls.forEach((controlSelection) => {\n                disposableCollection.add(controlSelection.selectionFilled$.subscribe((filled) => {\n                    if (\n                        filled == null ||\n                                filled.startColumn === -1 ||\n                                filled.startRow === -1 ||\n                                filled.endColumn === -1 ||\n                                filled.endRow === -1\n                    ) {\n                        return;\n                    }\n                    const source: IRange = {\n                        startColumn: controlSelection.model.startColumn,\n                        endColumn: controlSelection.model.endColumn,\n                        startRow: controlSelection.model.startRow,\n                        endRow: controlSelection.model.endRow,\n                    };\n                    const selection: IRange = {\n                        startColumn: filled.startColumn,\n                        endColumn: filled.endColumn,\n                        startRow: filled.startRow,\n                        endRow: filled.endRow,\n                    };\n\n                    this._commandService.executeCommand(AutoFillCommand.id, { sourceRange: source, targetRange: selection });\n                }));\n\n                // double click to fill range, range length will align to left or right column.\n                // fill results will be as same as drag operation\n                disposableCollection.add(controlSelection.fillControl.onDblclick$.subscribeEvent(() => {\n                    const source = {\n                        startColumn: controlSelection.model.startColumn,\n                        endColumn: controlSelection.model.endColumn,\n                        startRow: controlSelection.model.startRow,\n                        endRow: controlSelection.model.endRow,\n                    };\n                    this._handleDbClickFill(source);\n                }));\n\n                disposableCollection.add(controlSelection.fillControl.onPointerDown$.subscribeEvent(() => {\n                    const visibleState = this._editorBridgeService.isVisible();\n                    if (visibleState.visible) {\n                        this._commandService.syncExecuteCommand(\n                            SetCellEditVisibleOperation.id,\n                            {\n                                visible: false,\n                                eventType: DeviceInputEventType.PointerDown,\n                                unitId: currentRenderer.unitId,\n                            }\n                        );\n                    }\n                }));\n            });\n        };\n\n        updateListener();\n\n        // Should subscribe current current renderer change as well.\n        // TODO@yuhongz: this seems not ideal. This should be an `IRenderModule` for running with multiple renderers?\n        this.disposeWithMe(this._commandService.onCommandExecuted((command: ICommandInfo) => {\n            if (command.id === SetSelectionsOperation.id) {\n                updateListener();\n            }\n        }));\n\n        this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(UniverInstanceType.UNIVER_SHEET)\n            .subscribe(() => updateListener()));\n    }\n\n    private _handleDbClickFill(source: IRange) {\n        const selection = this._detectFillRange(source);\n        // double click only works when dest range is longer than source range\n        if (selection.endRow <= source.endRow) {\n            return;\n        }\n\n        // double click effect is the same as drag effect, but the apply area is automatically calculated (by method '_detectFillRange')\n        this._commandService.executeCommand(AutoFillCommand.id, { sourceRange: source, targetRange: selection });\n    }\n\n    private _detectFillRange(source: IRange) {\n        const { startRow, endRow, startColumn, endColumn } = source;\n        const worksheet = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)?.getActiveSheet();\n        if (!worksheet) {\n            return source;\n        }\n        const matrix = worksheet.getCellMatrix();\n        const maxRow = worksheet.getMaxRows() - 1;\n        const maxColumn = worksheet.getMaxColumns() - 1;\n        let detectEndRow = endRow;\n        // left column first, or consider right column.\n        if (startColumn > 0 && matrix.getValue(startRow, startColumn - 1)?.v != null) {\n            let cur = startRow;\n            while (matrix.getValue(cur, startColumn - 1)?.v != null && cur < maxRow) {\n                cur += 1;\n            }\n            detectEndRow = cur - 1;\n        } else if (endColumn < maxColumn && matrix.getValue(endRow, endColumn + 1)?.v != null) {\n            let cur = startRow;\n            while (matrix.getValue(cur, endColumn + 1)?.v != null && cur < maxRow) {\n                cur += 1;\n            }\n            detectEndRow = cur - 1;\n        }\n\n        for (let i = endRow + 1; i <= detectEndRow; i++) {\n            for (let j = startColumn; j <= endColumn; j++) {\n                if (matrix.getValue(i, j)?.v != null) {\n                    detectEndRow = i - 1;\n                    break;\n                }\n            }\n        }\n\n        return {\n            startColumn,\n            endColumn,\n            startRow,\n            endRow: detectEndRow,\n        };\n    }\n\n    // calc apply data according to copy data and direction\n    private _getApplyData(\n        copyDataPiece: ICopyDataPiece,\n        csLen: number,\n        asLen: number,\n        direction: Direction,\n        applyType: APPLY_TYPE,\n        hasStyle: boolean = true,\n        location: IAutoFillLocation\n    ) {\n        const applyData: Array<Nullable<ICellData>> = [];\n        const num = Math.floor(asLen / csLen);\n        const rsd = asLen % csLen;\n        const rules = this._autoFillService.getRules();\n\n        if (!hasStyle && applyType === APPLY_TYPE.ONLY_FORMAT) {\n            console.error('ERROR: only format can not be applied when hasStyle is false');\n            return [];\n        }\n\n        const applyDataInTypes: { [key: string]: any[] } = {};\n\n        rules.forEach((r) => {\n            applyDataInTypes[r.type] = [];\n        });\n\n        // calc cell data to apply\n        rules.forEach((r) => {\n            const { type, applyFunctions: customApplyFunctions = {} } = r;\n            const copyDataInType = copyDataPiece[type];\n            if (!copyDataInType) {\n                return;\n            }\n            // copyDataInType is an array of copy-squads in same types\n            // a copy-squad is an array of continuous cells that has the same type, e.g. [1, 3, 5] is a copy squad, but [1, 3, ab, 5] will be divided into two copy-squads\n            copyDataInType.forEach((copySquad) => {\n                const s = getLenS(copySquad.index, rsd);\n                const len = copySquad.index.length * num + s;\n\n                // We do not process cell.custom by default. If the user needs to process it, they can do so in the hook extension.\n                const arrData = this._applyFunctions(\n                    copySquad,\n                    len,\n                    direction,\n                    applyType,\n                    customApplyFunctions,\n                    copyDataPiece,\n                    location\n                );\n\n                const arrIndex = getDataIndex(csLen, asLen, copySquad.index);\n                applyDataInTypes[type].push({ data: arrData, index: arrIndex });\n            });\n        });\n\n        // calc index\n        for (let x = 0; x < asLen; x++) {\n            rules.forEach((r) => {\n                const { type } = r;\n                const applyDataInType = applyDataInTypes[type];\n                for (let y = 0; y < applyDataInType.length; y++) {\n                    if (x in applyDataInType[y].index) {\n                        applyData.push(applyDataInType[y].data[applyDataInType[y].index[x]]);\n                    }\n                }\n            });\n        }\n\n        return applyData;\n    }\n\n    private _applyFunctions(\n        copySquad: ICopyDataInType,\n        len: number,\n        direction: Direction,\n        applyType: APPLY_TYPE,\n        customApplyFunctions: APPLY_FUNCTIONS,\n        copyDataPiece: ICopyDataPiece,\n        location: IAutoFillLocation\n    ) {\n        const { data } = copySquad;\n        const isReverse = direction === Direction.UP || direction === Direction.LEFT;\n\n        // according to applyType, apply functions. if customApplyFunctions is provided, use it instead of default apply functions\n        if (applyType === APPLY_TYPE.COPY) {\n            const custom = customApplyFunctions?.[APPLY_TYPE.COPY];\n            if (custom) {\n                return custom(copySquad, len, direction, copyDataPiece, location);\n            }\n            isReverse && data.reverse();\n            return fillCopy(data, len);\n        }\n        if (applyType === APPLY_TYPE.SERIES) {\n            const custom = customApplyFunctions?.[APPLY_TYPE.SERIES];\n            if (custom) {\n                return custom(copySquad, len, direction, copyDataPiece);\n            }\n            isReverse && data.reverse();\n            // special rules, if not provide custom SERIES apply functions, will be applied as copy\n            if (customApplyFunctions?.[APPLY_TYPE.COPY]) {\n                return customApplyFunctions[APPLY_TYPE.COPY](copySquad, len, direction, copyDataPiece, location);\n            }\n            return fillCopy(data, len);\n        }\n        if (applyType === APPLY_TYPE.ONLY_FORMAT) {\n            const custom = customApplyFunctions?.[APPLY_TYPE.ONLY_FORMAT];\n            if (custom) {\n                return custom(copySquad, len, direction, copyDataPiece);\n            }\n            return fillCopyStyles(data, len);\n        }\n    }\n\n    private _getCopyData(source: IDiscreteRange, direction: Direction) {\n        const worksheet = this._univerInstanceService\n            .getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!\n            .getActiveSheet();\n\n        if (!worksheet) {\n            throw new Error('No active sheet found');\n        }\n\n        const currentCellDatas = worksheet.getCellMatrix();\n        const rules = this._autoFillService.getRules();\n        const copyData: ICopyDataPiece[] = [];\n        const isVertical = direction === Direction.DOWN || direction === Direction.UP;\n        let aArray: number[];\n        let bArray: number[];\n        if (isVertical) {\n            aArray = source.cols;\n            bArray = source.rows;\n        } else {\n            aArray = source.rows;\n            bArray = source.cols;\n        }\n\n        aArray.forEach((a) => {\n            // a copyDataPiece is an array of original cells in same column or row, depending on direction (horizontal or vertical)\n            const copyDataPiece = this._getEmptyCopyDataPiece();\n            const prevData: IRuleConfirmedData = {\n                type: undefined,\n                cellData: undefined,\n            };\n            bArray.forEach((b) => {\n                let data: Nullable<ICellData>;\n                if (isVertical) {\n                    data = currentCellDatas.getValue(b, a);\n                } else {\n                    data = currentCellDatas.getValue(a, b);\n                }\n                const { type, isContinue } = rules.find((r) => r.match(data, this._injector)) || otherRule;\n                if (isContinue(prevData, data)) {\n                    const typeInfo = copyDataPiece[type];\n\n                    const last = typeInfo![typeInfo!.length - 1];\n                    last.data.push(data);\n                    last.index.push(b - bArray[0]);\n                } else {\n                    const typeInfo = copyDataPiece[type];\n                    if (typeInfo) {\n                        typeInfo.push({\n                            data: [data],\n                            index: [b - bArray[0]],\n                        });\n                    } else {\n                        copyDataPiece[type] = [\n                            {\n                                data: [data],\n                                index: [b - bArray[0]],\n                            },\n                        ];\n                    }\n                }\n                prevData.type = type;\n                prevData.cellData = data;\n            });\n            copyData.push(copyDataPiece);\n        });\n        return copyData;\n    }\n\n    private _getEmptyCopyDataPiece() {\n        const copyDataPiece: ICopyDataPiece = {};\n        this._autoFillService.getRules().forEach((r) => {\n            copyDataPiece[r.type] = [];\n        });\n\n        return copyDataPiece;\n    }\n\n    private _getMergeApplyData(source: IRange, target: IRange, direction: Direction, csLen: number) {\n        const worksheet = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!.getActiveSheet();\n\n        if (!worksheet) {\n            throw new Error('No active sheet found');\n        }\n\n        const applyMergeRanges = [];\n        for (let i = source.startRow; i <= source.endRow; i++) {\n            for (let j = source.startColumn; j <= source.endColumn; j++) {\n                const { isMergedMainCell, startRow, startColumn, endRow, endColumn } = worksheet.getCellInfoInMergeData(i, j);\n                if (isMergedMainCell) {\n                    if (direction === Direction.DOWN) {\n                        let windowStartRow = startRow + csLen;\n                        let windowEndRow = endRow + csLen;\n                        while (windowEndRow <= target.endRow) {\n                            applyMergeRanges.push({\n                                startRow: windowStartRow,\n                                startColumn,\n                                endRow: windowEndRow,\n                                endColumn,\n                            });\n                            windowStartRow += csLen;\n                            windowEndRow += csLen;\n                        }\n                    } else if (direction === Direction.UP) {\n                        let windowStartRow = startRow - csLen;\n                        let windowEndRow = endRow - csLen;\n                        while (windowStartRow >= target.startRow) {\n                            applyMergeRanges.push({\n                                startRow: windowStartRow,\n                                startColumn,\n                                endRow: windowEndRow,\n                                endColumn,\n                            });\n                            windowStartRow -= csLen;\n                            windowEndRow -= csLen;\n                        }\n                    } else if (direction === Direction.RIGHT) {\n                        let windowStartColumn = startColumn + csLen;\n                        let windowEndColumn = endColumn + csLen;\n                        while (windowEndColumn <= target.endColumn) {\n                            applyMergeRanges.push({\n                                startRow,\n                                startColumn: windowStartColumn,\n                                endRow,\n                                endColumn: windowEndColumn,\n                            });\n                            windowStartColumn += csLen;\n                            windowEndColumn += csLen;\n                        }\n                    } else if (direction === Direction.LEFT) {\n                        let windowStartColumn = startColumn - csLen;\n                        let windowEndColumn = endColumn - csLen;\n                        while (windowStartColumn >= target.startColumn) {\n                            applyMergeRanges.push({\n                                startRow,\n                                startColumn: windowStartColumn,\n                                endRow,\n                                endColumn: windowEndColumn,\n                            });\n                            windowStartColumn -= csLen;\n                            windowEndColumn -= csLen;\n                        }\n                    }\n                }\n            }\n        }\n        return applyMergeRanges;\n    }\n\n    private _presetAndCacheData(location: IAutoFillLocation, direction: Direction) {\n        const { source, target } = location;\n        // cache original data of apply range\n        const worksheet = this._univerInstanceService\n            .getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!\n            .getActiveSheet();\n\n        if (!worksheet) {\n            throw new Error('No active sheet found');\n        }\n\n        const currentCellDatas = worksheet.getCellMatrix();\n        // cache the original data in currentCellDatas in apply range for later use / refill\n        const applyData: Nullable<ICellData>[][] = [];\n        target.rows.forEach((i) => {\n            const row: Nullable<ICellData>[] = [];\n            target.cols.forEach((j) => {\n                row.push(Tools.deepClone(currentCellDatas.getValue(i, j)));\n            });\n            applyData.push(row);\n        });\n        this._beforeApplyData = applyData;\n        this._copyData = this._getCopyData(source, direction);\n        this._currentLocation = location;\n        if (this._shouldDisableSeries(this._copyData)) {\n            this._autoFillService.setDisableApplyType(APPLY_TYPE.SERIES, true);\n            return APPLY_TYPE.COPY;\n        } else {\n            this._autoFillService.setDisableApplyType(APPLY_TYPE.SERIES, false);\n        }\n        return this._getPreferredApplyType(this._copyData);\n    }\n\n    // auto fill entry\n    // eslint-disable-next-line max-lines-per-function\n    private _fillData(location: IAutoFillLocation, direction: Direction, applyType: APPLY_TYPE) {\n        const undos: IMutationInfo[] = [];\n        const redos: IMutationInfo[] = [];\n\n        let hasStyle = true;\n        if (applyType === APPLY_TYPE.NO_FORMAT) {\n            hasStyle = false;\n            applyType = APPLY_TYPE.SERIES;\n        }\n\n        const { source, target, unitId, subUnitId } = location;\n\n        if (!source || !target || direction == null) {\n            return {\n                undos,\n                redos,\n            };\n        }\n\n        const sourceRange = discreteRangeToRange(source);\n        const targetRange = discreteRangeToRange(target);\n\n        const { cols: targetCols, rows: targetRows } = target;\n        const { cols: sourceCols, rows: sourceRows } = source;\n\n        const copyData = this._copyData;\n\n        let csLen;\n        if (direction === Direction.DOWN || direction === Direction.UP) {\n            csLen = sourceRows.length;\n        } else {\n            csLen = sourceCols.length;\n        }\n\n        const applyDatas: Array<Array<Nullable<ICellData>>> = [];\n\n        if (direction === Direction.DOWN || direction === Direction.UP) {\n            const asLen = targetRows.length;\n            const untransformedApplyDatas: Nullable<ICellData>[][] = [];\n            targetCols.forEach((_, i) => {\n                const copyD = copyData[i];\n\n                const applyData = this._getApplyData(copyD, csLen, asLen, direction, applyType, hasStyle, location);\n                untransformedApplyDatas.push(applyData);\n            });\n            for (let i = 0; i < untransformedApplyDatas[0].length; i++) {\n                const row: Array<Nullable<ICellData>> = [];\n                for (let j = 0; j < untransformedApplyDatas.length; j++) {\n                    row.push({\n                        s: null,\n                        ...untransformedApplyDatas[j][i],\n                    });\n                }\n                applyDatas.push(row);\n            }\n        } else {\n            const asLen = targetCols.length;\n            targetRows.forEach((_, i) => {\n                const copyD = copyData[i];\n                const applyData = this._getApplyData(copyD, csLen, asLen, direction, applyType, hasStyle, location);\n                const row: Array<Nullable<ICellData>> = [];\n                for (let j = 0; j < applyData.length; j++) {\n                    row.push({\n                        s: null,\n                        ...applyData[j],\n                    });\n                }\n                applyDatas.push(row);\n            });\n        }\n\n        // deal with styles\n        let applyMergeRanges: IRange[] = [];\n        const style = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!.getStyles();\n        if (hasStyle) {\n            applyMergeRanges = this._getMergeApplyData(sourceRange, targetRange, direction, csLen);\n            applyDatas.forEach((row) => {\n                row.forEach((cellData) => {\n                    if (cellData && style) {\n                        if (style) {\n                            cellData.s = style.getStyleByCell(cellData);\n                        }\n                    }\n                });\n            });\n        } else {\n            applyDatas.forEach((row, rowIndex) => {\n                row.forEach((cellData, colIndex) => {\n                    if (cellData && style) {\n                        cellData.s = style.getStyleByCell(this._beforeApplyData[rowIndex][colIndex]) || null;\n                    }\n                });\n            });\n        }\n\n        if (applyType === APPLY_TYPE.ONLY_FORMAT) {\n            applyDatas.forEach((row, rowIndex) => {\n                row.forEach((cellData, colIndex) => {\n                    if (cellData) {\n                        const old = this._beforeApplyData[rowIndex][colIndex] || {};\n                        cellData.f = old.f;\n                        cellData.si = old.si;\n                        cellData.t = old.t;\n                        cellData.v = old.v;\n                    }\n                });\n            });\n        }\n\n        // delete cross merge\n        if (hasStyle) {\n            const deleteMergeRanges: IRange[] = [];\n            const mergeData = this._univerInstanceService\n                .getUniverSheetInstance(unitId)\n                ?.getSheetBySheetId(subUnitId)\n                ?.getMergeData();\n            if (mergeData) {\n                mergeData.forEach((merge) => {\n                    if (Rectangle.intersects(merge, targetRange)) {\n                        deleteMergeRanges.push(merge);\n                    }\n                });\n            }\n            const removeMergeMutationParams: IRemoveWorksheetMergeMutationParams = {\n                unitId,\n                subUnitId,\n                ranges: deleteMergeRanges,\n            };\n\n            const undoRemoveMergeMutationParams: IAddWorksheetMergeMutationParams = this._injector.invoke(\n                RemoveMergeUndoMutationFactory,\n                removeMergeMutationParams\n            );\n\n            if (deleteMergeRanges.length) {\n                redos.push({ id: RemoveWorksheetMergeMutation.id, params: removeMergeMutationParams });\n                undos.unshift({ id: AddWorksheetMergeMutation.id, params: undoRemoveMergeMutationParams });\n            }\n        }\n\n        // clear range value\n        const clearMutationParams: ISetRangeValuesMutationParams = {\n            subUnitId,\n            unitId,\n            cellValue: generateNullCellValueRowCol([target]),\n        };\n\n        const undoClearMutationParams: ISetRangeValuesMutationParams = this._injector.invoke(\n            SetRangeValuesUndoMutationFactory,\n            clearMutationParams\n        );\n\n        // const intercepted = this._sheetInterceptorService.onCommandExecute({ id: ClearSelectionContentCommand.id });\n        redos.push({ id: SetRangeValuesMutation.id, params: clearMutationParams });\n        undos.unshift({ id: SetRangeValuesMutation.id, params: undoClearMutationParams });\n        // set range value\n        const cellValue = new ObjectMatrix<ICellData>();\n        targetRows.forEach((row, rowIndex) => {\n            targetCols.forEach((col, colIndex) => {\n                if (applyDatas[rowIndex][colIndex]) {\n                    cellValue.setValue(row, col, applyDatas[rowIndex][colIndex]!);\n                }\n            });\n        });\n\n        const cellValueMatrix = cellValue.getMatrix();\n        const setRangeValuesMutationParams: ISetRangeValuesMutationParams = {\n            subUnitId,\n            unitId,\n            cellValue: cellValueMatrix,\n        };\n\n        const undoSetRangeValuesMutationParams: ISetRangeValuesMutationParams = this._injector.invoke(\n            SetRangeValuesUndoMutationFactory,\n            setRangeValuesMutationParams\n        );\n\n        this._autoFillService.getActiveHooks().forEach((hook) => {\n            hook.onBeforeSubmit?.(location, direction, applyType, cellValueMatrix);\n        });\n\n        undos.unshift({ id: SetRangeValuesMutation.id, params: undoSetRangeValuesMutationParams });\n        redos.push({ id: SetRangeValuesMutation.id, params: setRangeValuesMutationParams });\n\n        // add worksheet merge\n        if (applyMergeRanges?.length) {\n            const ranges = getAddMergeMutationRangeByType(applyMergeRanges);\n\n            const addMergeMutationParams: IAddWorksheetMergeMutationParams = {\n                unitId,\n                subUnitId,\n                ranges,\n            };\n\n            const undoAddMergeMutationParams: IRemoveWorksheetMergeMutationParams = this._injector.invoke(\n                AddMergeUndoMutationFactory,\n                addMergeMutationParams\n            );\n\n            undos.unshift({ id: RemoveWorksheetMergeMutation.id, params: undoAddMergeMutationParams });\n            redos.push({ id: AddWorksheetMergeMutation.id, params: addMergeMutationParams });\n        }\n\n        return {\n            undos,\n            redos,\n        };\n    }\n\n    private _shouldDisableSeries(copyData: ICopyDataPiece[]) {\n        // only formula or other type data, disable series\n        return copyData.every((copyDataPiece) =>\n            Object.keys(copyDataPiece).every((type) => (\n                copyDataPiece[type as DATA_TYPE]?.length === 0\n                || [DATA_TYPE.OTHER, DATA_TYPE.FORMULA].includes(type as DATA_TYPE)\n            )\n            )\n        );\n    }\n\n    private _getPreferredApplyType(copyData: ICopyDataPiece[]) {\n        // if all data is number and only one cell in piece, prefer copy\n        const preferCopy = copyData.every((copyDataPiece) =>\n            Object.keys(copyDataPiece).every((type) => (\n                copyDataPiece[type as DATA_TYPE]?.length === 0\n                || (copyDataPiece[type as DATA_TYPE]?.length === 1\n                    && copyDataPiece[type as DATA_TYPE][0].data.length === 1\n                    && DATA_TYPE.NUMBER === type as DATA_TYPE)\n            )\n            )\n        );\n        return preferCopy ? APPLY_TYPE.COPY : APPLY_TYPE.SERIES;\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Disposable, ICommandService, Inject, IUniverInstanceService, UniverInstanceType } from '@univerjs/core';\nimport { CURSOR_TYPE, getCurrentTypeOfRenderer, IRenderManagerService } from '@univerjs/engine-render';\nimport { ToggleCellCheckboxCommand } from '@univerjs/sheets';\nimport { HoverManagerService } from '../services/hover-manager.service';\n\nexport class SheetCheckboxController extends Disposable {\n    private _isPointer = false;\n    constructor(\n        @Inject(HoverManagerService) private _hoverManagerService: HoverManagerService,\n        @IUniverInstanceService private _instanceService: IUniverInstanceService,\n        @ICommandService private readonly _commandService: ICommandService,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService\n    ) {\n        super();\n        this._initPointerEvent();\n        this._initHover();\n    }\n\n    private get _mainComponent() {\n        return getCurrentTypeOfRenderer(UniverInstanceType.UNIVER_SHEET, this._instanceService, this._renderManagerService)?.mainComponent;\n    }\n\n    private _initHover() {\n        this.disposeWithMe(this._hoverManagerService.currentRichText$.subscribe((richText) => {\n            if (richText?.bullet) {\n                if (!this._isPointer) {\n                    this._mainComponent?.setCursor(CURSOR_TYPE.POINTER);\n                }\n                this._isPointer = true;\n            } else {\n                if (this._isPointer) {\n                    this._mainComponent?.setCursor(CURSOR_TYPE.AUTO);\n                }\n                this._isPointer = false;\n            }\n        }));\n    }\n\n    private _initPointerEvent() {\n        this.disposeWithMe(this._hoverManagerService.currentClickedCell$.subscribe((cell) => {\n            const { location, bullet } = cell;\n            if (!bullet) {\n                return;\n            }\n            this._commandService.executeCommand(ToggleCellCheckboxCommand.id, {\n                unitId: location.unitId,\n                subUnitId: location.subUnitId,\n                row: location.row,\n                col: location.col,\n                paragraphIndex: bullet.startIndex,\n            });\n        }));\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport type { ISelectionWithStyle } from '@univerjs/sheets';\nimport { Disposable, ICommandService, Inject, IUniverInstanceService, ThemeService, UniverInstanceType } from '@univerjs/core';\nimport { deserializeRangeWithSheet, IDefinedNamesService, isReferenceStrings, operatorToken } from '@univerjs/engine-formula';\nimport { getPrimaryForRange, ScrollToCellOperation, SetWorksheetActivateCommand, SheetsSelectionsService } from '@univerjs/sheets';\nimport { filter, merge } from 'rxjs';\nimport { genNormalSelectionStyle } from '../../services/selection/const';\n\nexport class SheetsDefinedNameController extends Disposable {\n    constructor(\n        @Inject(SheetsSelectionsService) private readonly _selectionManagerService: SheetsSelectionsService,\n        @Inject(ThemeService) private readonly _themeService: ThemeService,\n        @IUniverInstanceService private readonly _instanceSrv: IUniverInstanceService,\n        @ICommandService private readonly _cmdSrv: ICommandService,\n        @IDefinedNamesService private readonly _definedNamesService: IDefinedNamesService\n    ) {\n        super();\n\n        this._init();\n    }\n\n    private _init(): void {\n        this.disposeWithMe(merge(\n            this._selectionManagerService.selectionMoveStart$,\n            this._selectionManagerService.selectionMoving$,\n            this._selectionManagerService.selectionMoveEnd$,\n            this._selectionManagerService.selectionSet$\n        )\n            .pipe(filter((params) => !!params))\n            .subscribe((params) => {\n                this._syncDefinedNameRange(params as ISelectionWithStyle[]);\n            }));\n\n        this.disposeWithMe(this._definedNamesService.focusRange$.subscribe(async (item) => {\n            if (item == null) return;\n\n            const { unitId } = item;\n            let { formulaOrRefString } = item;\n\n            if (formulaOrRefString.substring(0, 1) === operatorToken.EQUALS) {\n                formulaOrRefString = formulaOrRefString.substring(1);\n            }\n\n            const result = isReferenceStrings(formulaOrRefString);\n            if (!result) {\n                return;\n            }\n\n            const workbook = this._instanceSrv.getUnit<Workbook>(unitId)!;\n            const selections = await this._getSelections(workbook, unitId, formulaOrRefString);\n\n            this._selectionManagerService.setSelections(selections);\n\n            this._cmdSrv.executeCommand(ScrollToCellOperation.id, {\n                unitId,\n                range: selections[0].range,\n            });\n        }));\n    }\n\n    private _syncDefinedNameRange(params: ISelectionWithStyle[]) {\n        if (params.length === 0) {\n            return;\n        }\n\n        const lastSelection = params[params.length - 1];\n        const workbook = this._instanceSrv.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET);\n        const worksheet = workbook?.getActiveSheet();\n        if (!worksheet) {\n            return;\n        }\n\n        this._definedNamesService.setCurrentRange({\n            range: lastSelection.range,\n            unitId: workbook!.getUnitId(),\n            sheetId: worksheet.getSheetId(),\n        });\n    }\n\n    private async _getSelections(workbook: Workbook, unitId: string, formulaOrRefString: string) {\n        const valueArray = formulaOrRefString.split(',');\n\n        let worksheet = workbook.getActiveSheet();\n\n        if (!worksheet) {\n            return [];\n        }\n\n        const selections = [];\n\n        for (let i = 0; i < valueArray.length; i++) {\n            const refString = valueArray[i].trim();\n\n            const unitRange = deserializeRangeWithSheet(refString.trim());\n\n            // WTF@DR-Univer: side effects in get methods\n            if (i === 0) {\n                const worksheetCache = workbook.getSheetBySheetName(unitRange.sheetName);\n                if (worksheetCache && worksheet.getSheetId() !== worksheetCache.getSheetId()) {\n                    worksheet = worksheetCache;\n                    await this._cmdSrv.executeCommand(SetWorksheetActivateCommand.id, {\n                        subUnitId: worksheet.getSheetId(),\n                        unitId,\n                    });\n                }\n            }\n\n            if (worksheet.getName() !== unitRange.sheetName) {\n                continue;\n            }\n\n            let primary = null;\n            if (i === valueArray.length - 1) {\n                const range = unitRange.range;\n                const { startRow, startColumn, endRow, endColumn } = range;\n                primary = getPrimaryForRange({\n                    startRow,\n                    startColumn,\n                    endRow,\n                    endColumn,\n\n                }, worksheet);\n            }\n\n            selections.push({\n                range: unitRange.range,\n                style: genNormalSelectionStyle(this._themeService),\n                primary,\n            });\n        }\n\n        return selections;\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Nullable } from '@univerjs/core';\nimport type {\n    IRichTextEditingMutationParams,\n} from '@univerjs/docs';\nimport type { RenderComponentType } from '@univerjs/engine-render';\nimport type { IEditorBridgeServiceVisibleParam } from '../../services/editor-bridge.service';\nimport {\n    DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,\n    EDITOR_ACTIVATED,\n    FOCUSING_EDITOR_BUT_HIDDEN,\n    FOCUSING_FX_BAR_EDITOR,\n    ICommandService,\n    IContextService,\n    Inject,\n    IUndoRedoService,\n    IUniverInstanceService,\n    RxDisposable,\n    UniverInstanceType,\n} from '@univerjs/core';\nimport {\n    DocSelectionManagerService,\n    DocSkeletonManagerService,\n    RichTextEditingMutation,\n} from '@univerjs/docs';\nimport { CoverContentCommand, VIEWPORT_KEY as DOC_VIEWPORT_KEY, IEditorService } from '@univerjs/docs-ui';\nimport { DeviceInputEventType, IRenderManagerService, ScrollBar } from '@univerjs/engine-render';\nimport { combineLatest, filter, takeUntil } from 'rxjs';\nimport { getEditorObject } from '../../basics/editor/get-editor-object';\nimport { SetCellEditVisibleOperation } from '../../commands/operations/cell-edit.operation';\nimport { IEditorBridgeService } from '../../services/editor-bridge.service';\nimport { IFormulaEditorManagerService } from '../../services/editor/formula-editor-manager.service';\n\nexport class FormulaEditorController extends RxDisposable {\n    private _loadedMap = new WeakSet<RenderComponentType>();\n\n    constructor(\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService,\n        @IEditorBridgeService private readonly _editorBridgeService: IEditorBridgeService,\n        @ICommandService private readonly _commandService: ICommandService,\n        @IContextService private readonly _contextService: IContextService,\n        @IFormulaEditorManagerService private readonly _formulaEditorManagerService: IFormulaEditorManagerService,\n        @IUndoRedoService private readonly _undoRedoService: IUndoRedoService,\n        @Inject(DocSelectionManagerService) private readonly _textSelectionManagerService: DocSelectionManagerService,\n        @IEditorService private readonly _editorService: IEditorService\n    ) {\n        super();\n\n        this._initialize();\n    }\n\n    private _initialize() {\n        this._syncEditorSize();\n        this._listenFxBtnClick();\n        this._handleContentChange();\n\n        this._univerInstanceService.focused$.pipe(takeUntil(this.dispose$)).subscribe((unitId) => {\n            this._create(unitId);\n        });\n\n        this._create(DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY);\n\n        this.disposeWithMe(this._editorService.focus$.subscribe(() => {\n            const focusUnitId = this._editorService.getFocusEditor()?.getEditorId();\n            if (focusUnitId !== DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY) {\n                this._contextService.setContextValue(FOCUSING_FX_BAR_EDITOR, false);\n            } else {\n                this._contextService.setContextValue(FOCUSING_FX_BAR_EDITOR, true);\n            }\n        }));\n    }\n\n    private _handleContentChange() {\n        this.disposeWithMe(\n            this._commandService.onCommandExecuted((commandInfo) => {\n                if (commandInfo.id === RichTextEditingMutation.id) {\n                    const params = commandInfo.params as IRichTextEditingMutationParams;\n                    const { unitId } = params;\n                    if (unitId === DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY) {\n                        this.autoScroll();\n                    }\n                }\n            })\n        );\n    }\n\n    private _create(unitId: Nullable<string>) {\n        if (unitId !== DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY) {\n            return;\n        }\n\n        const formulaEditorDocObject = this._renderManagerService.getRenderById(unitId);\n        if (formulaEditorDocObject == null) {\n            return;\n        }\n\n        const { mainComponent: documentComponent } = formulaEditorDocObject;\n\n        if (documentComponent == null) {\n            return;\n        }\n\n        if (!this._loadedMap.has(documentComponent)) {\n            this._loadedMap.add(documentComponent);\n        }\n    }\n\n    private _listenFxBtnClick() {\n        this._formulaEditorManagerService.fxBtnClick$.pipe(takeUntil(this.dispose$)).subscribe(() => {\n            const isFocusButHidden =\n                this._contextService.getContextValue(FOCUSING_EDITOR_BUT_HIDDEN) &&\n                !this._contextService.getContextValue(EDITOR_ACTIVATED);\n\n            if (isFocusButHidden) {\n                this._univerInstanceService.setCurrentUnitForType(DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY);\n                this._contextService.setContextValue(FOCUSING_FX_BAR_EDITOR, true);\n\n                const currentSheet = this._univerInstanceService.getCurrentUnitForType(UniverInstanceType.UNIVER_SHEET);\n                const formulaEditorDataModel = this._univerInstanceService.getUniverDocInstance(\n                    DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY\n                );\n\n                const visibleState = this._editorBridgeService.isVisible();\n                if (visibleState.visible === false) {\n                    this._commandService.syncExecuteCommand(\n                        SetCellEditVisibleOperation.id,\n                        {\n                            visible: true,\n                            eventType: DeviceInputEventType.PointerDown,\n                            unitId: currentSheet?.getUnitId() ?? '',\n                        } as IEditorBridgeServiceVisibleParam\n                    );\n                }\n\n                const content = formulaEditorDataModel?.getBody()?.dataStream;\n\n                if (content == null) {\n                    return;\n                }\n\n                let newContent = content.startsWith('=') ? content : `=${content}`;\n\n                newContent = newContent.replace(/\\r\\n$/, '');\n\n                const textRanges = [\n                    {\n                        startOffset: newContent.length,\n                        endOffset: newContent.length,\n                    },\n                ];\n\n                const coverContentParams = {\n                    unitId: DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,\n                    body: {\n                        dataStream: newContent,\n                    },\n                    segmentId: '',\n                };\n\n                this._commandService.executeCommand(CoverContentCommand.id, coverContentParams);\n\n                this._textSelectionManagerService.replaceDocRanges(textRanges);\n            }\n        });\n    }\n\n    private _syncEditorSize() {\n        // this._univerInstanceService.\n        const addFOrmulaBar$ = this._univerInstanceService.unitAdded$.pipe(filter((unit) => unit.getUnitId() === DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY));\n        this.disposeWithMe(combineLatest([this._formulaEditorManagerService.position$, addFOrmulaBar$]).subscribe(([position]) => {\n            if (!position) return this._clearScheduledCallback();\n            const editorObject = getEditorObject(DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY, this._renderManagerService);\n            const formulaEditorDataModel = this._univerInstanceService.getUniverDocInstance(\n                DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY\n            );\n\n            if (editorObject == null || formulaEditorDataModel == null) return this._clearScheduledCallback();\n\n            const { width, height } = position;\n            if (width === 0 || height === 0) return this._clearScheduledCallback();\n\n            const { engine } = editorObject;\n            formulaEditorDataModel.updateDocumentDataPageSize(width);\n            this.autoScroll();\n            this._scheduledCallback = requestIdleCallback(() => engine.resizeBySize(width, height));\n        }));\n    }\n\n    private _scheduledCallback: number = -1;\n    private _clearScheduledCallback(): void {\n        if (this._scheduledCallback !== -1) cancelIdleCallback(this._scheduledCallback);\n        this._scheduledCallback = -1;\n    }\n\n    autoScroll() {\n        const position = this._formulaEditorManagerService.getPosition();\n\n        const skeleton = this._renderManagerService.getRenderById(DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY)?.with(DocSkeletonManagerService).getSkeleton();\n        const editorObject = this._renderManagerService.getRenderById(DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY);\n\n        const formulaEditorDataModel = this._univerInstanceService.getUniverDocInstance(\n            DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY\n        );\n\n        if (skeleton == null || position == null || editorObject == null || formulaEditorDataModel == null) {\n            return;\n        }\n\n        const { marginTop = 0, marginBottom = 0 } = formulaEditorDataModel.getSnapshot().documentStyle;\n\n        const { scene, mainComponent } = editorObject;\n\n        let { actualHeight } = skeleton.getActualSize();\n        // page actual height also need to include page margin top and margin bottom.\n        actualHeight += marginTop + marginBottom;\n\n        const { width, height } = position;\n        const viewportMain = scene.getViewport(DOC_VIEWPORT_KEY.VIEW_MAIN);\n        let scrollBar = viewportMain?.getScrollBar() as Nullable<ScrollBar>;\n\n        scene.transformByState({\n            width,\n            height: actualHeight,\n        });\n\n        mainComponent?.resize(width, actualHeight);\n\n        if (actualHeight > height) {\n            if (scrollBar == null) {\n                viewportMain && new ScrollBar(viewportMain, { enableHorizontal: false, barSize: 8 });\n            } else {\n                viewportMain?.resetCanvasSizeAndUpdateScroll();\n            }\n        } else {\n            scrollBar = null;\n            viewportMain?.scrollToViewportPos({ viewportScrollX: 0, viewportScrollY: 0 });\n            viewportMain?.getScrollBar()?.dispose();\n        }\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { DocumentDataModel, ICommandInfo, IDocumentBody, IDocumentStyle, IDrawings, IParagraph, Nullable } from '@univerjs/core';\nimport type { IRichTextEditingMutationParams } from '@univerjs/docs';\nimport type { DocumentViewModel } from '@univerjs/engine-render';\nimport type { IMoveRangeMutationParams, ISetRangeValuesMutationParams } from '@univerjs/sheets';\nimport type { ICellEditorState } from '../../services/editor-bridge.service';\nimport { BooleanNumber, Disposable, DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY, DOCS_NORMAL_EDITOR_UNIT_ID_KEY, DocumentFlavor, HorizontalAlign, ICommandService, Inject, IUniverInstanceService, Tools, UniverInstanceType, VerticalAlign, WrapStrategy } from '@univerjs/core';\nimport { DocSkeletonManagerService, RichTextEditingMutation } from '@univerjs/docs';\nimport { ReplaceSnapshotCommand } from '@univerjs/docs-ui';\nimport { DeviceInputEventType, IRenderManagerService } from '@univerjs/engine-render';\nimport { MoveRangeMutation, RangeProtectionRuleModel, SetRangeValuesMutation, WorksheetProtectionRuleModel } from '@univerjs/sheets';\nimport { IEditorBridgeService } from '../../services/editor-bridge.service';\nimport { IFormulaEditorManagerService } from '../../services/editor/formula-editor-manager.service';\nimport { FormulaEditorController } from './formula-editor.controller';\n\nconst formulaEditorStyle: IDocumentStyle = {\n    pageSize: {\n        width: Number.POSITIVE_INFINITY,\n        height: Number.POSITIVE_INFINITY,\n    },\n    documentFlavor: DocumentFlavor.UNSPECIFIED,\n    marginTop: 5,\n    marginBottom: 5,\n    marginRight: 0,\n    marginLeft: 0,\n    paragraphLineGapDefault: 0,\n    renderConfig: {\n        horizontalAlign: HorizontalAlign.UNSPECIFIED,\n        verticalAlign: VerticalAlign.TOP,\n        centerAngle: 0,\n        vertexAngle: 0,\n        wrapStrategy: WrapStrategy.WRAP,\n        isRenderStyle: BooleanNumber.FALSE,\n    },\n};\n\n/**\n * sync data between cell editor and formula editor\n */\nexport class EditorDataSyncController extends Disposable {\n    constructor(\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService,\n        @IEditorBridgeService private readonly _editorBridgeService: IEditorBridgeService,\n        @ICommandService private readonly _commandService: ICommandService,\n        @Inject(RangeProtectionRuleModel) private readonly _rangeProtectionRuleModel: RangeProtectionRuleModel,\n        @Inject(WorksheetProtectionRuleModel) private readonly _worksheetProtectionRuleModel: WorksheetProtectionRuleModel,\n        @Inject(FormulaEditorController) private readonly _formulaEditorController: FormulaEditorController,\n        @IFormulaEditorManagerService private readonly _formulaEditorManagerService: IFormulaEditorManagerService\n    ) {\n        super();\n\n        this._initialize();\n    }\n\n    private _initialize() {\n        this._syncFormulaEditorContent();\n        this._commandExecutedListener();\n    }\n\n    private _getEditorViewModel(unitId: string): Nullable<DocumentViewModel> {\n        return this._renderManagerService.getRenderById(unitId)?.with(DocSkeletonManagerService).getViewModel();\n    }\n\n    // Sync cell content to formula editor bar when sheet selection changed.\n    private _syncFormulaEditorContent() {\n        this.disposeWithMe(this._editorBridgeService.currentEditCellState$.subscribe((editCellState) => {\n            if (\n                editCellState == null\n                || this._editorBridgeService.isForceKeepVisible()\n                // If permissions are not initialized, data synchronization will not be performed.\n                || !this._rangeProtectionRuleModel.getRangeRuleInitState()\n                || !this._worksheetProtectionRuleModel.getSheetRuleInitState()\n            ) {\n                return;\n            }\n\n            this._editorSyncHandler(editCellState);\n        }));\n    }\n\n    // Sync cell content to formula editor bar when sheet selection changed or visible changed.\n    private _editorSyncHandler(param: ICellEditorState) {\n        let body = Tools.deepClone(param.documentLayoutObject.documentModel?.getBody());\n        const drawings = Tools.deepClone(param.documentLayoutObject.documentModel?.drawings);\n        const drawingsOrder = Tools.deepClone(param.documentLayoutObject.documentModel?.getDrawingsOrder());\n\n        if (\n            !body ||\n            (param.isInArrayFormulaRange === true && this._editorBridgeService.isVisible().eventType === DeviceInputEventType.Dblclick)\n        ) {\n            body = {\n                dataStream: '\\r\\n',\n                paragraphs: [\n                    {\n                        startIndex: 0,\n                    },\n                ],\n                textRuns: [],\n            };\n        }\n\n        this._syncContentAndRender(DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY, body, drawings, drawingsOrder);\n    }\n\n    private _commandExecutedListener() {\n        const INCLUDE_LIST = [DOCS_NORMAL_EDITOR_UNIT_ID_KEY, DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY];\n\n        this.disposeWithMe(\n            this._commandService.onCommandExecuted((command: ICommandInfo) => {\n                if (command.id === RichTextEditingMutation.id) {\n                    const params = command.params as IRichTextEditingMutationParams;\n                    const { unitId, trigger, isSync } = params;\n                    if (isSync || trigger === ReplaceSnapshotCommand.id) {\n                        return;\n                    }\n\n                    if (INCLUDE_LIST.includes(unitId)) {\n                        // sync cell content to formula editor bar when edit cell editor and vice verse.\n                        const editorDocDataModel = this._univerInstanceService.getUnit<DocumentDataModel>(unitId, UniverInstanceType.UNIVER_DOC);\n\n                        const syncId =\n                        unitId === DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY\n                            ? DOCS_NORMAL_EDITOR_UNIT_ID_KEY\n                            : DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY;\n\n                        this._checkAndSetRenderStyleConfig(editorDocDataModel!);\n                        this._syncActionsAndRender(syncId, params);\n                    }\n                }\n            })\n        );\n\n        // Update formula bar content when you call SetRangeValuesMutation and MoveRangeMutation.\n        const needUpdateFormulaEditorContentCommandList = [SetRangeValuesMutation.id, MoveRangeMutation.id];\n        this.disposeWithMe(\n            this._commandService.onCommandExecuted((command: ICommandInfo) => {\n                if (needUpdateFormulaEditorContentCommandList.includes(command.id)) {\n                    const editCellState = this._editorBridgeService.getLatestEditCellState();\n\n                    if (editCellState == null) {\n                        return;\n                    }\n\n                    let needUpdate = false;\n\n                    const { row, column } = editCellState;\n\n                    if (command.id === SetRangeValuesMutation.id && command.params) {\n                        const params = command.params as ISetRangeValuesMutationParams;\n                        if (params.cellValue?.[row]?.[column]) {\n                            needUpdate = true;\n                        }\n                    } else if (command.id === MoveRangeMutation.id && command.params) {\n                        const params = command.params as IMoveRangeMutationParams;\n                        if (params.to.value?.[row]?.[column]) {\n                            needUpdate = true;\n                        }\n                    }\n\n                    if (needUpdate) {\n                        const body = Tools.deepClone(editCellState.documentLayoutObject.documentModel?.getBody());\n                        const drawings = Tools.deepClone(editCellState.documentLayoutObject.documentModel?.drawings);\n                        const drawingsOrder = Tools.deepClone(editCellState.documentLayoutObject.documentModel?.getDrawingsOrder());\n\n                        if (body == null) {\n                            return;\n                        }\n                        this._syncContentAndRender(DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY, body, drawings, drawingsOrder);\n                    }\n                }\n            })\n        );\n    }\n\n    // Sync actions between cell editor and formula editor, and make `dataStream` and `paragraph` is the same.\n    private _syncActionsAndRender(\n        unitId: string,\n        parmas: IRichTextEditingMutationParams\n    ) {\n        const INCLUDE_LIST = [DOCS_NORMAL_EDITOR_UNIT_ID_KEY, DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY];\n        const currentRender = this._renderManagerService.getRenderById(unitId);\n        if (currentRender == null) {\n            return;\n        }\n\n        const skeleton = currentRender.with(DocSkeletonManagerService).getSkeleton();\n        const docDataModel = this._univerInstanceService.getUnit<DocumentDataModel>(unitId, UniverInstanceType.UNIVER_DOC);\n        const docViewModel = this._getEditorViewModel(unitId);\n\n        if (docDataModel == null || docViewModel == null) {\n            return;\n        }\n\n        this._commandService.syncExecuteCommand(RichTextEditingMutation.id, {\n            ...parmas,\n            textRanges: null,\n            isSync: true,\n            unitId,\n            syncer: parmas.unitId,\n        });\n\n        docViewModel.reset(docDataModel);\n\n        skeleton.calculate();\n\n        if (INCLUDE_LIST.includes(unitId)) {\n            currentRender.mainComponent?.makeDirty();\n        }\n    }\n\n    private _syncContentAndRender(\n        unitId: string,\n        body: IDocumentBody,\n        drawings: Nullable<IDrawings>,\n        drawingsOrder: Nullable<string[]>\n    ) {\n        if (unitId === DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY) {\n            if (body.paragraphs) {\n                body.paragraphs = this._clearParagraph(body.paragraphs);\n            }\n        }\n        const INCLUDE_LIST = [DOCS_NORMAL_EDITOR_UNIT_ID_KEY, DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY];\n\n        const skeleton = this._renderManagerService.getRenderById(unitId)?.with(DocSkeletonManagerService).getSkeleton();\n        const docDataModel = this._univerInstanceService.getUnit<DocumentDataModel>(unitId, UniverInstanceType.UNIVER_DOC);\n        const docViewModel = this._getEditorViewModel(unitId);\n\n        if (docDataModel == null || docViewModel == null || skeleton == null) {\n            return;\n        }\n\n        docDataModel.getSnapshot().body = body;\n        docDataModel.getSnapshot().drawings = drawings ?? {};\n        docDataModel.getSnapshot().drawingsOrder = drawingsOrder ?? [];\n\n        this._checkAndSetRenderStyleConfig(docDataModel);\n        docViewModel.reset(docDataModel);\n        const currentRender = this._renderManagerService.getRenderById(unitId);\n        if (currentRender == null) {\n            return;\n        }\n\n        skeleton.calculate();\n\n        if (INCLUDE_LIST.includes(unitId)) {\n            currentRender.mainComponent?.makeDirty();\n        }\n\n        if (unitId === DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY) {\n            this._formulaEditorController.autoScroll();\n        }\n    }\n\n    private _checkAndSetRenderStyleConfig(documentDataModel: DocumentDataModel) {\n        const snapshot = documentDataModel.getSnapshot();\n        const { body } = snapshot;\n\n        if (snapshot.id !== DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY) {\n            return;\n        }\n\n        snapshot.documentStyle = formulaEditorStyle;\n        let renderConfig = snapshot.documentStyle.renderConfig;\n\n        if (renderConfig == null) {\n            renderConfig = {};\n            snapshot.documentStyle.renderConfig = renderConfig;\n        }\n        const position = this._formulaEditorManagerService.getPosition();\n        if (position) {\n            const width = position.width;\n            snapshot.documentStyle.pageSize = {\n                width,\n                height: Infinity,\n            };\n        }\n        if ((body?.dataStream ?? '').startsWith('=')) {\n            renderConfig.isRenderStyle = BooleanNumber.TRUE;\n        } else {\n            renderConfig.isRenderStyle = BooleanNumber.FALSE;\n        }\n    }\n\n    private _clearParagraph(paragraphs: IParagraph[]) {\n        const newParagraphs = Tools.deepClone(paragraphs);\n        for (const paragraph of newParagraphs) {\n            if (paragraph.paragraphStyle) {\n                paragraph.paragraphStyle.horizontalAlign = HorizontalAlign.UNSPECIFIED;\n            }\n        }\n\n        return newParagraphs;\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellData, IMutationInfo, IRange, IStyleData, Workbook } from '@univerjs/core';\nimport type { IAddWorksheetMergeMutationParams, IRemoveWorksheetMergeMutationParams, ISetRangeValuesMutationParams } from '@univerjs/sheets';\nimport type { IFormatPainterHook, ISelectionFormatInfo } from '../../services/format-painter/format-painter.service';\nimport {\n    Disposable,\n    ICommandService,\n    Inject,\n    Injector,\n    IUniverInstanceService,\n    ObjectMatrix,\n    Tools,\n    UniverInstanceType,\n} from '@univerjs/core';\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport {\n    AddMergeUndoMutationFactory,\n    AddWorksheetMergeMutation,\n    getAddMergeMutationRangeByType,\n    RemoveMergeUndoMutationFactory,\n    RemoveWorksheetMergeMutation,\n    SetRangeValuesCommand,\n    SetRangeValuesMutation,\n    SetRangeValuesUndoMutationFactory,\n    SheetInterceptorService,\n    SheetsSelectionsService,\n} from '@univerjs/sheets';\nimport { checkCellContentInRanges, getClearContentMutationParamsForRanges } from '../../common/utils';\nimport { FormatPainterStatus, IFormatPainterService } from '../../services/format-painter/format-painter.service';\n\nexport class FormatPainterController extends Disposable {\n    constructor(\n        @ICommandService private readonly _commandService: ICommandService,\n        @IFormatPainterService private readonly _formatPainterService: IFormatPainterService,\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService,\n        @Inject(SheetsSelectionsService) private readonly _selectionManagerService: SheetsSelectionsService,\n        @Inject(SheetInterceptorService) private readonly _sheetInterceptorService: SheetInterceptorService,\n        @Inject(Injector) private readonly _injector: Injector\n    ) {\n        super();\n\n        this._initialize();\n    }\n\n    private _initialize() {\n        this._addDefaultHook();\n    }\n\n    private _addDefaultHook() {\n        const defaultHook: IFormatPainterHook = {\n            id: 'default-format-painter',\n            priority: 0,\n            isDefaultHook: true,\n            onStatusChange: (status: FormatPainterStatus) => {\n                if (status !== FormatPainterStatus.OFF) {\n                    const format = this._collectSelectionRangeFormat();\n                    if (format) {\n                        this._formatPainterService.setSelectionFormat(format);\n                    }\n                }\n            },\n            onApply: (unitId, subUnitId, range, format) => {\n                return this._getUndoRedoMutationInfo(unitId, subUnitId, range, format);\n            },\n        };\n        this._formatPainterService.addHook(defaultHook);\n    }\n\n    private _collectSelectionRangeFormat() {\n        const selection = this._selectionManagerService.getCurrentLastSelection();\n        const range = selection?.range;\n        if (!range) return null;\n        const { startRow, endRow, startColumn, endColumn } = range;\n        const workbook = this._univerInstanceService.getCurrentUnitForType<Workbook>(UniverInstanceType.UNIVER_SHEET)!;\n        const worksheet = workbook?.getActiveSheet();\n        if (!worksheet) return null;\n        const cellData = worksheet.getCellMatrix();\n\n        const styles = workbook.getStyles();\n        const stylesMatrix = new ObjectMatrix<IStyleData>();\n        const merges = [];\n        for (let r = startRow; r <= endRow; r++) {\n            for (let c = startColumn; c <= endColumn; c++) {\n                const cell = cellData.getValue(r, c) as ICellData;\n                stylesMatrix.setValue(r, c, styles.getStyleByCell(cell) || {});\n                const { isMergedMainCell, ...mergeInfo } = worksheet.getCellInfoInMergeData(r, c);\n                if (isMergedMainCell) {\n                    merges.push({\n                        startRow: mergeInfo.startRow,\n                        startColumn: mergeInfo.startColumn,\n                        endRow: mergeInfo.endRow,\n                        endColumn: mergeInfo.endColumn,\n                    });\n                }\n            }\n        }\n        return {\n            styles: stylesMatrix,\n            merges,\n        };\n    }\n\n    private _getUndoRedoMutationInfo(unitId: string, subUnitId: string, originRange: IRange, format: ISelectionFormatInfo) {\n        const sheetInterceptorService = this._sheetInterceptorService;\n        const univerInstanceService = this._univerInstanceService;\n\n        const { merges, styles: stylesMatrix } = format;\n        if (!stylesMatrix) return { undos: [], redos: [] };\n\n        const { startRow, startColumn, endRow, endColumn } = stylesMatrix.getDataRange();\n        const styleRowsNum = endRow - startRow + 1;\n        const styleColsNum = endColumn - startColumn + 1;\n        const range = (originRange.startRow === originRange.endRow && originRange.startColumn === originRange.endColumn)\n            ? {\n                startRow: originRange.startRow,\n                startColumn: originRange.startColumn,\n                endRow: originRange.startRow + styleRowsNum - 1,\n                endColumn: originRange.startColumn + styleColsNum - 1,\n            }\n            : originRange;\n        const styleValues: ICellData[][] = Array.from({ length: range.endRow - range.startRow + 1 }, () =>\n            Array.from({ length: range.endColumn - range.startColumn + 1 }, () => ({})));\n        const mergeRanges: IRange[] = [];\n\n        styleValues.forEach((row, rowIndex) => {\n            row.forEach((col, colIndex) => {\n                const mappedRowIndex = (rowIndex % styleRowsNum) + startRow;\n                const mappedColIndex = (colIndex % styleColsNum) + startColumn;\n                const style = stylesMatrix.getValue(mappedRowIndex, mappedColIndex);\n\n                if (style) {\n                    styleValues[rowIndex][colIndex].s = Object.keys(style).length > 0 ? style : null;\n                }\n            });\n        });\n\n        merges.forEach((merge) => {\n            const relatedRange: IRange = {\n                startRow: merge.startRow - startRow,\n                startColumn: merge.startColumn - startColumn,\n                endRow: merge.endRow - startRow,\n                endColumn: merge.endColumn - startColumn,\n            };\n            // merge will apply at least once\n            const rowRepeats = Math.max(1, Math.floor((range.endRow - range.startRow + 1) / styleRowsNum));\n            const colRepeats = Math.max(1, Math.floor((range.endColumn - range.startColumn + 1) / styleColsNum));\n            for (let i = 0; i < rowRepeats; i++) {\n                for (let j = 0; j < colRepeats; j++) {\n                    mergeRanges.push({\n                        startRow: relatedRange.startRow + i * styleRowsNum + range.startRow,\n                        startColumn: relatedRange.startColumn + j * styleColsNum + range.startColumn,\n                        endRow: relatedRange.endRow + i * styleRowsNum + range.startRow,\n                        endColumn: relatedRange.endColumn + j * styleColsNum + range.startColumn,\n                    });\n                }\n            }\n        });\n        const currentSelections = [range];\n        const clearCellValue = new ObjectMatrix<ICellData>();\n        const cellValue = new ObjectMatrix<ICellData>();\n\n        if (Tools.isArray(styleValues)) {\n            for (let i = 0; i < currentSelections.length; i++) {\n                const { startRow, startColumn, endRow, endColumn } = currentSelections[i];\n                for (let r = 0; r <= endRow - startRow; r++) {\n                    for (let c = 0; c <= endColumn - startColumn; c++) {\n                        clearCellValue.setValue(r + startRow, c + startColumn, { s: null });\n                        cellValue.setValue(r + startRow, c + startColumn, styleValues[r][c]);\n                    }\n                }\n            }\n        }\n\n        const clearStyleMutationParams: ISetRangeValuesMutationParams = {\n            subUnitId,\n            unitId,\n            cellValue: clearCellValue.getMatrix(),\n        };\n        const setRangeValuesMutationParams: ISetRangeValuesMutationParams = {\n            subUnitId,\n            unitId,\n            cellValue: cellValue.getMatrix(),\n        };\n        const undoSetRangeValuesMutationParams: ISetRangeValuesMutationParams = this._injector.invoke(\n            SetRangeValuesUndoMutationFactory,\n            clearStyleMutationParams\n        );\n\n        const { undos: interceptorUndos, redos: interceptorRedos } = sheetInterceptorService.onCommandExecute({\n            id: SetRangeValuesCommand.id,\n            params: { ...setRangeValuesMutationParams, range: currentSelections },\n        });\n\n        // handle merge\n        const ranges = getAddMergeMutationRangeByType(mergeRanges);\n\n        const mergeRedos: IMutationInfo[] = [];\n        const mergeUndos: IMutationInfo[] = [];\n\n        // First we should check if there are values in the going-to-be-merged cells.\n        const worksheet = (univerInstanceService.getUnit(unitId) as Workbook).getSheetBySheetId(subUnitId)!;\n        const willRemoveSomeCell = checkCellContentInRanges(worksheet, ranges);\n\n        // prepare redo mutations\n        const removeMergeMutationParams: IRemoveWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges,\n        };\n        const addMergeMutationParams: IAddWorksheetMergeMutationParams = {\n            unitId,\n            subUnitId,\n            ranges,\n        };\n        mergeRedos.push({ id: RemoveWorksheetMergeMutation.id, params: removeMergeMutationParams });\n        mergeRedos.push({ id: AddWorksheetMergeMutation.id, params: addMergeMutationParams });\n\n        // prepare undo mutations\n        const undoRemoveMergeMutationParams = this._injector.invoke(\n            RemoveMergeUndoMutationFactory,\n            removeMergeMutationParams\n        );\n        const undoMutationParams = this._injector.invoke(\n            AddMergeUndoMutationFactory,\n            addMergeMutationParams\n        );\n        mergeUndos.push({ id: RemoveWorksheetMergeMutation.id, params: undoMutationParams });\n        mergeUndos.push({ id: AddWorksheetMergeMutation.id, params: undoRemoveMergeMutationParams });\n\n        // add set range values mutations to undo redo mutations\n        if (willRemoveSomeCell) {\n            const data = this._injector.invoke((accessor) => getClearContentMutationParamsForRanges(accessor, unitId, worksheet, ranges));\n            mergeRedos.unshift(...data.redos);\n            mergeUndos.push(...data.undos);\n        }\n\n        return {\n            undos: [\n                { id: SetRangeValuesMutation.id, params: clearStyleMutationParams },\n                { id: SetRangeValuesMutation.id, params: undoSetRangeValuesMutationParams },\n                ...interceptorUndos,\n                ...mergeUndos,\n            ],\n            redos: [\n                { id: SetRangeValuesMutation.id, params: clearStyleMutationParams },\n                { id: SetRangeValuesMutation.id, params: setRangeValuesMutationParams },\n                ...interceptorRedos,\n                ...mergeRedos,\n            ],\n        };\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IRange, Workbook } from '@univerjs/core';\nimport type { IRenderContext, IRenderModule } from '@univerjs/engine-render';\nimport type { IMoveRangeCommandParams } from '@univerjs/sheets';\nimport {\n    Disposable,\n    DisposableCollection,\n    ICommandService,\n    Inject,\n    toDisposable,\n} from '@univerjs/core';\n\nimport { MoveRangeCommand, SheetsSelectionsService } from '@univerjs/sheets';\nimport { ISheetSelectionRenderService } from '../services/selection/base-selection-render.service';\n\nexport class MoveRangeRenderController extends Disposable implements IRenderModule {\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(ISheetSelectionRenderService) private readonly _selectionRenderService: ISheetSelectionRenderService,\n        @Inject(SheetsSelectionsService) private readonly _selectionManagerService: SheetsSelectionsService,\n        @Inject(ICommandService) private readonly _commandService: ICommandService\n    ) {\n        super();\n        this._initialize();\n    }\n\n    private _initialize = () => {\n        const disposableCollection = new DisposableCollection();\n\n        this.disposeWithMe(\n            this._selectionManagerService.selectionMoveEnd$.subscribe(() => {\n                // Each range change requires re-listening\n                disposableCollection.dispose();\n\n                const selectionControls = this._selectionRenderService.getSelectionControls();\n                selectionControls.forEach((controlSelection) => {\n                    disposableCollection.add(\n                        toDisposable(\n                            controlSelection.selectionMoveEnd$.subscribe((_toRange) => {\n                                if (!_toRange) {\n                                    return;\n                                }\n                                const _fromRange = controlSelection.model.getRange();\n                                const fromRange: IRange = {\n                                    startRow: _fromRange.startRow,\n                                    startColumn: _fromRange.startColumn,\n                                    endRow: _fromRange.endRow,\n                                    endColumn: _fromRange.endColumn,\n                                    rangeType: _fromRange.rangeType,\n                                };\n                                const toRange: IRange = {\n                                    startRow: _toRange.startRow,\n                                    startColumn: _toRange.startColumn,\n                                    endRow: _toRange.endRow,\n                                    endColumn: _toRange.endColumn,\n                                    // rangeType must equal to fromRange\n                                    rangeType: _fromRange.rangeType,\n                                };\n\n                                if (\n                                    fromRange.startRow === toRange.startRow &&\n                                    fromRange.startColumn === toRange.startColumn\n                                ) {\n                                    return;\n                                }\n\n                                if (toRange.startRow < 0 || toRange.startColumn < 0) {\n                                    return;\n                                }\n\n                                const params: IMoveRangeCommandParams = {\n                                    fromRange,\n                                    toRange,\n                                };\n                                this._commandService.executeCommand(MoveRangeCommand.id, params);\n                            })\n                        )\n                    );\n                });\n            })\n        );\n    };\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Disposable, Inject } from '@univerjs/core';\nimport { SheetPermissionInitController } from '@univerjs/sheets';\n\nexport class SheetPermissionInitUIController extends Disposable {\n    constructor(\n        @Inject(SheetPermissionInitController) private readonly _sheetPermissionInitController: SheetPermissionInitController\n    ) {\n        super();\n        this._initPermission();\n    }\n\n    private _initPermission() {\n        this._sheetPermissionInitController.initPermission();\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport type { IRenderContext, IRenderModule } from '@univerjs/engine-render';\nimport {\n    Disposable,\n    Inject,\n    toDisposable,\n} from '@univerjs/core';\nimport { ISheetClipboardService } from '../../services/clipboard/clipboard.service';\nimport { SheetSkeletonManagerService } from '../../services/sheet-skeleton-manager.service';\nimport { SheetClipboardController } from '../clipboard/clipboard.controller';\n\nexport class ClipboardRenderController extends Disposable implements IRenderModule {\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(SheetSkeletonManagerService) private readonly _sheetSkeletonManagerService: SheetSkeletonManagerService,\n        @ISheetClipboardService private readonly _sheetClipboardService: ISheetClipboardService,\n        @Inject(SheetClipboardController) private readonly _sheetClipboardController: SheetClipboardController\n    ) {\n        super();\n        this._initialize();\n    }\n\n    private _initialize() {\n        this.disposeWithMe(\n            toDisposable(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((skeleton) => {\n                if (!skeleton?.unitId) {\n                    return;\n                }\n                if (!this._sheetClipboardService.getPasteMenuVisible()) {\n                    return;\n                }\n                const pasteOptionsCache = this._sheetClipboardService.getPasteOptionsCache();\n                const menuUnitId = pasteOptionsCache?.target.unitId;\n                if (skeleton.unitId === menuUnitId) {\n                    this._sheetClipboardController.refreshOptionalPaste();\n                }\n            }))\n        );\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook } from '@univerjs/core';\nimport type { IRenderContext, IRenderModule, Spreadsheet, SpreadsheetColumnHeader, SpreadsheetHeader } from '@univerjs/engine-render';\nimport {\n    Disposable,\n    Inject,\n    RANGE_TYPE,\n} from '@univerjs/core';\nimport { SheetsSelectionsService } from '@univerjs/sheets';\nimport { ContextMenuPosition, IContextMenuService } from '@univerjs/ui';\n\nimport { SHEET_VIEW_KEY } from '../../common/keys';\nimport { ISheetSelectionRenderService } from '../../services/selection/base-selection-render.service';\nimport { attachSelectionWithCoord } from '../../services/selection/util';\n\n/**\n * This controller subscribe to context menu events in sheet rendering views and invoke context menu at a correct\n * position and with correct menu type.\n */\nexport class SheetContextMenuRenderController extends Disposable implements IRenderModule {\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @IContextMenuService private readonly _contextMenuService: IContextMenuService,\n        @Inject(SheetsSelectionsService) private readonly _selectionManagerService: SheetsSelectionsService,\n        @ISheetSelectionRenderService private readonly _selectionRenderService: ISheetSelectionRenderService\n    ) {\n        super();\n\n        this._init();\n    }\n\n    private _init(): void {\n        const spreadsheetPointerDownObserver = (this._context?.mainComponent as Spreadsheet)?.onPointerDown$;\n\n        // Content range context menu\n        const spreadsheetSubscription = spreadsheetPointerDownObserver.subscribeEvent((event) => {\n            if (event.button === 2) {\n                const selections = this._selectionManagerService.getCurrentSelections();\n                const currentSelection = selections?.[0];\n                if (!currentSelection) {\n                    return;\n                }\n                const rangeType = currentSelection.range.rangeType;\n                const skeleton = this._selectionRenderService.getSkeleton();\n                const selectionRangeWithCoord = attachSelectionWithCoord(currentSelection, skeleton);\n                const range = selectionRangeWithCoord.rangeWithCoord;\n                const isPointerInRange = () => {\n                    if (!range) {\n                        return false;\n                    }\n                    const x = event.offsetX;\n                    const y = event.offsetY;\n                    switch (rangeType) {\n                        case RANGE_TYPE.ROW:\n                            return range.startY <= y && range.endY >= y;\n                        case RANGE_TYPE.COLUMN:\n                            return range.startX <= x && range.endX >= x;\n                        default:\n                            return range.startX <= x && range.endX >= x && range.startY <= y && range.endY >= y;\n                    }\n                };\n\n                const triggerMenu = (position: string) => {\n                    this._contextMenuService.triggerContextMenu(event, position);\n                };\n                if (!isPointerInRange()) {\n                    triggerMenu(ContextMenuPosition.MAIN_AREA);\n                } else if (rangeType === RANGE_TYPE.COLUMN) {\n                    triggerMenu(ContextMenuPosition.COL_HEADER);\n                } else if (rangeType === RANGE_TYPE.ROW) {\n                    triggerMenu(ContextMenuPosition.ROW_HEADER);\n                } else {\n                    triggerMenu(ContextMenuPosition.MAIN_AREA);\n                }\n            }\n        });\n        this.disposeWithMe(spreadsheetSubscription);\n\n        // Row header context menu\n        const spreadsheetColumnHeader = this._context.components.get(SHEET_VIEW_KEY.COLUMN) as SpreadsheetColumnHeader;\n        const spreadsheetRowHeader = this._context.components.get(SHEET_VIEW_KEY.ROW) as SpreadsheetHeader;\n        const rowHeaderSub = spreadsheetRowHeader.onPointerDown$.subscribeEvent((event) => {\n            if (event.button === 2) {\n                this._contextMenuService.triggerContextMenu(event, ContextMenuPosition.ROW_HEADER);\n            }\n        });\n        this.disposeWithMe(rowHeaderSub);\n\n        // Col header context menu\n        const colHeaderPointerDownObserver = spreadsheetColumnHeader.onPointerDown$;\n        const colHeaderObserver = colHeaderPointerDownObserver.subscribeEvent((event) => {\n            if (event.button === 2) {\n                this._contextMenuService.triggerContextMenu(event, ContextMenuPosition.COL_HEADER);\n            }\n        });\n        this.disposeWithMe(colHeaderObserver);\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICommandInfo, IDisposable, IExecutionOptions, ISelectionCell, Nullable, Workbook } from '@univerjs/core';\nimport type { IEditorInputConfig } from '@univerjs/docs-ui';\nimport type { IRender, IRenderContext, IRenderModule } from '@univerjs/engine-render';\nimport type { ISelectionWithStyle, ISetRangeValuesMutationParams } from '@univerjs/sheets';\nimport type { ICurrentEditCellParam, IEditorBridgeServiceVisibleParam } from '../../services/editor-bridge.service';\nimport { DisposableCollection, DOCS_NORMAL_EDITOR_UNIT_ID_KEY, FOCUSING_FX_BAR_EDITOR, FOCUSING_SHEET, ICommandService, IContextService, Inject, IUniverInstanceService, RxDisposable, toDisposable, UniverInstanceType } from '@univerjs/core';\nimport { DocSelectionRenderService, IEditorService, IRangeSelectorService } from '@univerjs/docs-ui';\nimport { DeviceInputEventType, IRenderManagerService } from '@univerjs/engine-render';\nimport {\n    ClearSelectionFormatCommand,\n    SetRangeValuesMutation,\n    SetWorksheetActiveOperation,\n    SheetsSelectionsService,\n} from '@univerjs/sheets';\nimport { filter, merge } from 'rxjs';\nimport { SetZoomRatioCommand } from '../../commands/commands/set-zoom-ratio.command';\nimport { SetActivateCellEditOperation } from '../../commands/operations/activate-cell-edit.operation';\nimport { SetCellEditVisibleOperation } from '../../commands/operations/cell-edit.operation';\nimport { IEditorBridgeService } from '../../services/editor-bridge.service';\nimport { SheetSkeletonManagerService } from '../../services/sheet-skeleton-manager.service';\nimport { getSheetObject } from '../utils/component-tools';\n\n// TODO: wzhudev: this should be merged with Edit EditingRenderController.\n\nexport class EditorBridgeRenderController extends RxDisposable implements IRenderModule {\n    private _d: Nullable<IDisposable>;\n\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @IUniverInstanceService private readonly _instanceSrv: IUniverInstanceService,\n        @ICommandService private readonly _commandService: ICommandService,\n        @IEditorBridgeService private readonly _editorBridgeService: IEditorBridgeService,\n        // FIXME: should use WorkbookSelectionModel\n        // FIXME: should check if it is the current sheet, if it becomes the current sheet,\n        // it should update cell params, otherwise it should do nothing.\n        @Inject(SheetsSelectionsService) private readonly _selectionManagerService: SheetsSelectionsService,\n        @IRangeSelectorService private readonly _rangeSelectorService: IRangeSelectorService,\n        @IContextService private readonly _contextService: IContextService,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService,\n        @IEditorService private readonly _editorService: IEditorService,\n        @Inject(SheetSkeletonManagerService) private readonly _sheetSkeletonManagerService: SheetSkeletonManagerService\n    ) {\n        super();\n\n        this.disposeWithMe(this._instanceSrv.getCurrentTypeOfUnit$(UniverInstanceType.UNIVER_SHEET).subscribe((workbook) => {\n            if (workbook && workbook.getUnitId() === this._context.unitId) {\n                this._d = this._init();\n            } else {\n                this._disposeCurrent();\n            }\n        }));\n\n        this._initialRangeSelector();\n    }\n\n    private _init(): IDisposable {\n        const d = new DisposableCollection();\n        this._initSelectionChangeListener(d);\n        this._initEventListener(d);\n        this._commandExecutedListener(d);\n        this._initialKeyboardListener(d);\n        return d;\n    }\n\n    private _disposeCurrent(): void {\n        this._d?.dispose();\n        this._d = null;\n    }\n\n    private _initSelectionChangeListener(d: DisposableCollection) {\n        d.add(merge(\n            this._selectionManagerService.selectionMoveEnd$,\n            this._selectionManagerService.selectionSet$,\n            this._selectionManagerService.selectionMoveStart$\n        ).subscribe((params) => this._updateEditorPosition(params)));\n    }\n\n    private _updateEditorPosition(params: Nullable<ISelectionWithStyle[]>) {\n        if (this._editorBridgeService.isVisible().visible) return;\n        if (this._rangeSelectorService.selectorModalVisible) return;\n\n        const primary = params?.[params.length - 1]?.primary;\n        if (primary) {\n            const sheetObject = this._getSheetObject();\n            const { scene, engine } = sheetObject;\n            const unitId = this._context.unitId;\n            const sheetId = this._context.unit.getActiveSheet()?.getSheetId();\n            if (!sheetId) return;\n            const mergeInfo = this._sheetSkeletonManagerService.getSkeletonParam(sheetId)?.skeleton.getCellWithCoordByIndex(primary.actualRow, primary.actualColumn);\n            const newPrimary: ISelectionCell = mergeInfo\n                ? {\n                    actualRow: mergeInfo.actualRow,\n                    actualColumn: mergeInfo.actualColumn,\n                    isMerged: mergeInfo.isMerged,\n                    startRow: mergeInfo.mergeInfo.startRow,\n                    startColumn: mergeInfo.mergeInfo.startColumn,\n                    endRow: mergeInfo.mergeInfo.endRow,\n                    endColumn: mergeInfo.mergeInfo.endColumn,\n                    isMergedMainCell: mergeInfo.isMergedMainCell,\n                }\n                : primary;\n            this._commandService.executeCommand<ICurrentEditCellParam>(SetActivateCellEditOperation.id, {\n                scene,\n                engine,\n                primary: newPrimary,\n                unitId,\n                sheetId,\n            });\n        }\n    }\n\n    private _initEventListener(d: DisposableCollection) {\n        const sheetObject = this._getSheetObject();\n        const { spreadsheet, spreadsheetColumnHeader, spreadsheetLeftTopPlaceholder, spreadsheetRowHeader } = sheetObject;\n\n        d.add(spreadsheet.onDblclick$.subscribeEvent((evt) => {\n            if (evt.button === 2) {\n                return;\n            }\n\n            this._commandService.executeCommand(SetCellEditVisibleOperation.id, {\n                visible: true,\n                eventType: DeviceInputEventType.Dblclick,\n                unitId: this._context.unitId,\n            } as IEditorBridgeServiceVisibleParam);\n        }));\n\n        d.add(spreadsheet.onPointerDown$.subscribeEvent({\n            next: this._tryHideEditor.bind(this),\n            priority: -1,\n        }));\n        d.add(spreadsheetColumnHeader.onPointerDown$.subscribeEvent({\n            next: this._tryHideEditor.bind(this),\n            priority: -1,\n        }));\n        d.add(spreadsheetLeftTopPlaceholder.onPointerDown$.subscribeEvent({\n            next: this._tryHideEditor.bind(this),\n            priority: -1,\n        }));\n        d.add(spreadsheetRowHeader.onPointerDown$.subscribeEvent({\n            next: this._tryHideEditor.bind(this),\n            priority: -1,\n        }));\n    }\n\n    /**\n     * Should activate the editor when the user inputs text.\n     * @param d DisposableCollection\n     */\n    private _initialKeyboardListener(d: DisposableCollection) {\n        let disposable: Nullable<IDisposable> = null;\n        const addEvent = (render: IRender) => {\n            const docSelectionRenderService = render.with(DocSelectionRenderService);\n            if (docSelectionRenderService) {\n                disposable = toDisposable(docSelectionRenderService.onInputBefore$.subscribe((config) => {\n                    if (!this._isCurrentSheetFocused()) {\n                        return;\n                    }\n                    const isFocusFormulaEditor = this._contextService.getContextValue(FOCUSING_FX_BAR_EDITOR);\n                    const isFocusSheets = this._contextService.getContextValue(FOCUSING_SHEET);\n                    const unitId = render.unitId;\n                    if (this._editorBridgeService.isVisible().visible) return;\n                    if (unitId && isFocusSheets && !isFocusFormulaEditor) {\n                        this._showEditorByKeyboard(config);\n                    }\n                }));\n\n                d.add(disposable);\n            }\n        };\n\n        const render = this._renderManagerService.getRenderById(DOCS_NORMAL_EDITOR_UNIT_ID_KEY);\n        if (render) {\n            addEvent(render);\n        } else {\n            this.disposeWithMe(this._renderManagerService.created$.pipe(filter((render) => render.unitId === DOCS_NORMAL_EDITOR_UNIT_ID_KEY)).subscribe((render) => {\n                disposable?.dispose();\n                addEvent(render);\n            }));\n        }\n    }\n\n    private _commandExecutedListener(d: DisposableCollection) {\n        const refreshCommandSet = new Set([ClearSelectionFormatCommand.id, SetZoomRatioCommand.id]);\n        d.add(this._commandService.onCommandExecuted((command: ICommandInfo) => {\n            if (refreshCommandSet.has(command.id)) {\n                if (this._editorBridgeService.isVisible().visible) return;\n                this._editorBridgeService.refreshEditCellState();\n            }\n\n            if (command.id === SetRangeValuesMutation.id) {\n                const params = command.params as ISetRangeValuesMutationParams;\n                const { cellValue, unitId, subUnitId } = params;\n                if (!cellValue) return;\n                const editCell = this._editorBridgeService.getEditLocation();\n                if (editCell) {\n                    const { unitId: editingUnitId, sheetId: editingSheetId, row, column } = editCell;\n                    if (unitId === editingUnitId && subUnitId === editingSheetId && cellValue && cellValue[row] && Object.prototype.hasOwnProperty.call(cellValue[row], column)) {\n                        this._editorBridgeService.refreshEditCellState();\n                    }\n                }\n            }\n        }));\n\n        d.add(this._commandService.beforeCommandExecuted((command: ICommandInfo, options?: IExecutionOptions) => {\n            if (options?.fromCollab) return;\n            if (command.id === SetWorksheetActiveOperation.id) {\n                this._tryHideEditor();\n            }\n        }));\n    }\n\n    private _showEditorByKeyboard(config: Nullable<IEditorInputConfig>) {\n        const event = config?.event as InputEvent;\n        if (config == null || (!event.data && event.inputType !== 'InsertParagraph')) {\n            return;\n        }\n\n        this._commandService.syncExecuteCommand(SetCellEditVisibleOperation.id, {\n            visible: true,\n            eventType: DeviceInputEventType.Keyboard,\n            keycode: event.which,\n            unitId: this._context.unitId,\n        });\n    }\n\n    private _tryHideEditor() {\n        // In the activated state of formula editing,\n        // prohibit closing the editor according to the state to facilitate generating selection reference text.\n        if (this._editorBridgeService.isForceKeepVisible()) {\n            return;\n        }\n\n        this._hideEditor();\n    }\n\n    private _hideEditor() {\n        if (this._editorBridgeService.isVisible().visible !== true) return;\n\n        this._commandService.syncExecuteCommand(SetCellEditVisibleOperation.id, {\n            visible: false,\n            eventType: DeviceInputEventType.PointerDown,\n            unitId: this._context.unitId,\n        });\n    }\n\n    private _initialRangeSelector() {\n        this.disposeWithMe(this._selectionManagerService.selectionMoving$.subscribe(this._rangeSelector.bind(this)));\n        this.disposeWithMe(this._selectionManagerService.selectionMoveStart$.subscribe(this._rangeSelector.bind(this)));\n\n        // TODO: this method shouldn't be here. Fix in when refactor the range selector.\n\n        /**\n         * pro/issues/388\n         * When the range selector is opened,\n         * the current selection needs to be synchronized to the range selector.\n         */\n        this.disposeWithMe(\n            this._rangeSelectorService.openSelector$.subscribe(() => {\n                const { unitId, sheetId, sheetName } = this._getCurrentUnitIdAndSheetId();\n                if (!sheetId || !sheetName) return;\n\n                const selectionWithStyle = this._selectionManagerService.getCurrentSelections();\n                const ranges = selectionWithStyle?.map((value) => ({ range: value.range, unitId, sheetId, sheetName }));\n                if (ranges) {\n                    this._rangeSelectorService.selectionChange(ranges);\n                }\n            })\n        );\n    }\n\n    private _rangeSelector(selectionWithStyle: Nullable<ISelectionWithStyle[]>) {\n        if (!selectionWithStyle) {\n            return;\n        }\n\n        const { unitId, sheetId, sheetName } = this._getCurrentUnitIdAndSheetId();\n        if (!sheetId || !sheetName) return;\n\n        const ranges = selectionWithStyle.map((value: ISelectionWithStyle) => {\n            return { range: value.range, unitId, sheetId, sheetName };\n        });\n\n        this._rangeSelectorService.selectionChange(ranges);\n    }\n\n    private _getCurrentUnitIdAndSheetId() {\n        const workbook = this._context.unit;\n        const worksheet = workbook.getActiveSheet();\n        return {\n            unitId: workbook.getUnitId(),\n            sheetId: worksheet?.getSheetId(),\n            sheetName: worksheet?.getName(),\n        };\n    }\n\n    private _getSheetObject() {\n        return getSheetObject(this._context.unit, this._context)!;\n    }\n\n    private _isCurrentSheetFocused(): boolean {\n        return this._instanceSrv.getFocusedUnit()?.getUnitId() === this._context.unitId;\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IShapeProps, UniverRenderingContext } from '@univerjs/engine-render';\nimport { Rect, RegularPolygon, Shape } from '@univerjs/engine-render';\n\nexport interface IHeaderMenuShapeProps extends IShapeProps {\n    size?: number;\n    mode?: HEADER_MENU_SHAPE_TYPE;\n    iconRatio?: number;\n}\n\nexport enum HEADER_MENU_SHAPE_TYPE {\n    NORMAL,\n    HIGHLIGHT,\n}\n\nexport const HEADER_MENU_SHAPE_CIRCLE_FILL = 'rgba(0, 0, 0, 0.15)';\n\nexport const HEADER_MENU_SHAPE_TRIANGLE_FILL = 'rgb(0, 0, 0)';\n\nexport const HEADER_MENU_BACKGROUND_COLOR = 'rgb(255, 255, 255, 1)';\n\nexport class HeaderMenuShape<T extends IHeaderMenuShapeProps = IHeaderMenuShapeProps> extends Shape<T> {\n    private _size: number = 12;\n    private _iconRatio: number = 0.4;\n    private _mode: HEADER_MENU_SHAPE_TYPE = HEADER_MENU_SHAPE_TYPE.NORMAL;\n\n    constructor(key?: string, props?: T) {\n        super(key, props);\n        this.setShapeProps(props);\n    }\n\n    setShapeProps(props?: T) {\n        if (props?.size) {\n            this._size = props.size;\n        }\n\n        if (props?.mode) {\n            this._mode = props.mode;\n        }\n\n        this.transformByState({\n            width: this._size,\n            height: this._size,\n        });\n    }\n\n    protected override _draw(ctx: UniverRenderingContext) {\n        if (this._mode === HEADER_MENU_SHAPE_TYPE.HIGHLIGHT) {\n            Rect.drawWith(ctx, {\n                width: this._size,\n                height: this._size,\n                radius: this._size,\n                fill: HEADER_MENU_SHAPE_CIRCLE_FILL,\n            });\n        }\n\n        const iconSize = this._size * 0.5 * this._iconRatio;\n        const sixtyDegree = (Math.PI / 180) * 60;\n        const left = iconSize * Math.sin(sixtyDegree);\n        const top = iconSize * Math.cos(sixtyDegree);\n\n        RegularPolygon.drawWith(ctx, {\n            pointsGroup: [\n                [\n                    { x: -left + this._size / 2, y: -top + this._size / 2 },\n                    { x: left + this._size / 2, y: -top + this._size / 2 },\n                    { x: this._size / 2, y: iconSize + this._size / 2 },\n                ],\n            ],\n            // left: this.left,\n            // top: this.top,\n            fill: HEADER_MENU_SHAPE_TRIANGLE_FILL,\n        });\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Nullable, Workbook } from '@univerjs/core';\nimport type { IMouseEvent, IPointerEvent, IRenderContext, IRenderModule, SpreadsheetColumnHeader, SpreadsheetHeader } from '@univerjs/engine-render';\nimport type { ISetSelectionsOperationParams } from '@univerjs/sheets';\nimport {\n    Disposable,\n    ICommandService,\n    Inject,\n    RANGE_TYPE,\n} from '@univerjs/core';\nimport { CURSOR_TYPE, Rect } from '@univerjs/engine-render';\nimport { SetSelectionsOperation, SheetsSelectionsService } from '@univerjs/sheets';\nimport { ContextMenuPosition, IContextMenuService } from '@univerjs/ui';\nimport { Subscription } from 'rxjs';\n\nimport { SHEET_COMPONENT_HEADER_LAYER_INDEX, SHEET_VIEW_KEY } from '../../common/keys';\nimport { SheetSkeletonManagerService } from '../../services/sheet-skeleton-manager.service';\nimport { HEADER_MENU_SHAPE_TYPE, HeaderMenuShape } from '../../views/header-menu-shape';\nimport { getCoordByOffset } from '../utils/component-tools';\n\nconst HEADER_MENU_CONTROLLER_SHAPE = '__SpreadsheetHeaderMenuSHAPEControllerShape__';\n\nconst HEADER_MENU_CONTROLLER_MENU = '__SpreadsheetHeaderMenuMAINControllerShape__';\n\nconst HEADER_MENU_CONTROLLER_SHAPE_COLOR = 'rgba(0, 0, 0, 0.1)';\n\nenum HEADER_HOVER_TYPE {\n    ROW,\n    COLUMN,\n}\n\n/**\n * header highlight\n * column menu: show, hover and mousedown event\n */\nexport class HeaderMenuRenderController extends Disposable implements IRenderModule {\n    private _hoverRect: Nullable<Rect>;\n\n    private _hoverMenu: Nullable<HeaderMenuShape>;\n\n    private _currentColumn: number = Number.POSITIVE_INFINITY;\n\n    // private _rowHeaderPointerMoveSub: Subscription;\n    // private _colHeaderPointerMoveSub: Subscription;\n    // private _rowHeaderPointerLeaveSub: Subscription;\n    // private _colHeaderPointerLeaveSub: Subscription;\n    // private _rowHeaderPointerEnterSub: Subscription;\n    // private _colHeaderPointerEnterSub: Subscription;\n    private _headerPointerSubs: Nullable<Subscription>;\n    private _colHeaderPointerSubs: Nullable<Subscription>;\n\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(SheetSkeletonManagerService) private readonly _sheetSkeletonManagerService: SheetSkeletonManagerService,\n        @IContextMenuService private readonly _contextMenuService: IContextMenuService,\n        @ICommandService private readonly _commandService: ICommandService,\n        @Inject(SheetsSelectionsService) private readonly _selectionManagerService: SheetsSelectionsService\n    ) {\n        super();\n\n        this._initialize();\n    }\n\n    override dispose(): void {\n        this._hoverRect?.dispose();\n        this._hoverMenu?.dispose();\n\n        // const spreadsheetColumnHeader = this._context.components.get(SHEET_VIEW_KEY.COLUMN) as SpreadsheetColumnHeader;\n        // const spreadsheetRowHeader = this._context.components.get(SHEET_VIEW_KEY.ROW) as SpreadsheetHeader;\n\n        // [...this._headerPointerSubs, ...this._colHeaderPointerSubs].forEach((s) => {\n            // s.unsubscribe();\n            // spreadsheetRowHeader.onPointerEnterObserver.remove(observer);\n            // spreadsheetRowHeader.onPointerMoveObserver.remove(observer);\n            // spreadsheetRowHeader.onPointerLeaveObserver.remove(observer);\n            // spreadsheetColumnHeader.onPointerEnterObserver.remove(observer);\n            // spreadsheetColumnHeader.onPointerMoveObserver.remove(observer);\n            // spreadsheetColumnHeader.onPointerLeaveObserver.remove(observer);\n        // });\n        this._headerPointerSubs?.unsubscribe();\n        this._headerPointerSubs = null;\n    }\n\n    private _initialize() {\n        const scene = this._context.scene;\n\n        this._hoverRect = new Rect(HEADER_MENU_CONTROLLER_SHAPE, {\n            fill: HEADER_MENU_CONTROLLER_SHAPE_COLOR,\n            evented: false,\n        });\n\n        this._hoverMenu = new HeaderMenuShape(HEADER_MENU_CONTROLLER_MENU, { zIndex: 100, visible: false });\n\n        scene.addObjects([this._hoverRect, this._hoverMenu], SHEET_COMPONENT_HEADER_LAYER_INDEX);\n\n        this._initialHover(HEADER_HOVER_TYPE.ROW);\n\n        this._initialHover(HEADER_HOVER_TYPE.COLUMN);\n\n        this._initialHoverMenu();\n    }\n\n    // eslint-disable-next-line max-lines-per-function\n    private _initialHover(initialType: HEADER_HOVER_TYPE = HEADER_HOVER_TYPE.ROW) {\n        const spreadsheetColumnHeader = this._context.components.get(SHEET_VIEW_KEY.COLUMN) as SpreadsheetColumnHeader;\n        const spreadsheetRowHeader = this._context.components.get(SHEET_VIEW_KEY.ROW) as SpreadsheetHeader;\n\n        const eventBindingObject =\n            initialType === HEADER_HOVER_TYPE.ROW ? spreadsheetRowHeader : spreadsheetColumnHeader;\n\n        const pointerMoveHandler = (evt: IPointerEvent | IMouseEvent) => {\n            const skeleton = this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;\n            if (skeleton == null) {\n                return;\n            }\n\n            const { rowHeaderWidth, columnHeaderHeight } = skeleton;\n\n            const { startX, startY, endX, endY, column } = getCoordByOffset(\n                evt.offsetX,\n                evt.offsetY,\n                this._context.scene,\n                skeleton\n            );\n\n            if (initialType === HEADER_HOVER_TYPE.ROW) {\n                this._hoverRect?.transformByState({\n                    width: rowHeaderWidth,\n                    height: endY - startY,\n                    left: 0,\n                    top: startY,\n                });\n            } else {\n                this._currentColumn = column;\n\n                this._hoverRect?.transformByState({\n                    width: endX - startX,\n                    height: columnHeaderHeight,\n                    left: startX,\n                    top: 0,\n                });\n\n                if (this._hoverMenu == null) {\n                    return;\n                }\n\n                if (endX - startX < columnHeaderHeight * 2) {\n                    this._hoverMenu.hide();\n                    return;\n                }\n\n                const menuSize = columnHeaderHeight * 0.8;\n\n                this._hoverMenu.transformByState({\n                    left: endX - columnHeaderHeight,\n                    top: columnHeaderHeight / 2 - menuSize / 2,\n                });\n\n                this._hoverMenu.setShapeProps({ size: menuSize });\n\n                this._hoverMenu.show();\n            }\n        };\n\n        const pointerEnterHandler = () => {\n            this._hoverRect?.show();\n        };\n\n        const pointerLeaveHandler = () => {\n            this._hoverRect?.hide();\n            this._hoverMenu?.hide();\n        };\n\n        this._headerPointerSubs = new Subscription();\n        const headerPointerMoveSub = eventBindingObject.onPointerMove$.subscribeEvent(pointerMoveHandler);\n        const headerPointerEnterSub = eventBindingObject.onPointerEnter$.subscribeEvent(pointerEnterHandler);\n        const headerPointerLeaveSub = eventBindingObject.onPointerLeave$.subscribeEvent(pointerLeaveHandler);\n        this._headerPointerSubs?.add(headerPointerMoveSub);\n        this._headerPointerSubs?.add(headerPointerEnterSub);\n        this._headerPointerSubs?.add(headerPointerLeaveSub);\n        // this._observers.push(\n        //     eventBindingObject?.onPointerEnter$.subscribeEvent(() => {\n        //     })\n        // );\n        // this._observers.push(\n        // eventBindingObject?.onPointerMoveObserver.add(\n        // );\n\n        // this._observers.push(\n        // eventBindingObject?.onPointerLeave$.subscribeEvent(})\n        // );\n    }\n\n    private _initialHoverMenu() {\n        // const { scene, spreadsheet, spreadsheetColumnHeader } = sheetObject;\n        if (this._hoverMenu == null) {\n            return;\n        }\n        this._hoverMenu.onPointerEnter$.subscribeEvent(() => {\n            if (this._hoverMenu == null) {\n                return;\n            }\n\n            this._hoverMenu.setProps({\n                mode: HEADER_MENU_SHAPE_TYPE.HIGHLIGHT,\n                visible: true,\n            });\n\n            this._context.scene.setCursor(CURSOR_TYPE.POINTER);\n        });\n\n        this._hoverMenu.onPointerLeave$.subscribeEvent(() => {\n            if (this._hoverMenu == null) {\n                return;\n            }\n\n            this._hoverMenu.setProps({\n                mode: HEADER_MENU_SHAPE_TYPE.NORMAL,\n                visible: false,\n            });\n\n            this._context.scene.resetCursor();\n        });\n\n        this._hoverMenu.onPointerDown$.subscribeEvent((evt: IPointerEvent | IMouseEvent) => {\n            const currentColumn = this._currentColumn;\n            const currentSelectionDatas = this._selectionManagerService.getCurrentSelections()?.map((s) => s.range);\n            const menuInSelections: boolean = !!currentSelectionDatas\n                ?.filter((range) => range.rangeType === RANGE_TYPE.COLUMN)\n                .find((data) => {\n                    const { startColumn, endColumn } = data;\n                    if (currentColumn >= startColumn && currentColumn <= endColumn) {\n                        return true;\n                    }\n                    return false;\n                });\n\n            if (!menuInSelections) {\n                // Fix #1089\n                // Here we just change the selection here without any other operations.\n                const selection = this._getSelectionOnColumn(currentColumn);\n                this._commandService.syncExecuteCommand(SetSelectionsOperation.id, selection);\n            }\n\n            evt.stopPropagation();\n            evt.preventDefault();\n            this._contextMenuService.triggerContextMenu(evt, ContextMenuPosition.COL_HEADER);\n        });\n    }\n\n    private _getSelectionOnColumn(column: number): ISetSelectionsOperationParams {\n        const workbook = this._context.unit;\n        const worksheet = workbook.getActiveSheet();\n        if (!worksheet) {\n            throw new Error('No active worksheet');\n        }\n\n        return {\n            unitId: workbook.getUnitId(),\n            subUnitId: worksheet.getSheetId(),\n\n            selections: [\n                {\n                    range: {\n                        startRow: 0,\n                        startColumn: column,\n                        endRow: worksheet.getRowCount() - 1,\n                        endColumn: column,\n                        rangeType: RANGE_TYPE.COLUMN,\n                    },\n                    primary: {\n                        startRow: 0,\n                        startColumn: column,\n                        endRow: 0,\n                        endColumn: column,\n                        actualRow: 0,\n                        actualColumn: column,\n                        isMerged: false,\n                        isMergedMainCell: false,\n                    },\n                    style: null,\n                },\n            ],\n        };\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IShapeProps, UniverRenderingContext } from '@univerjs/engine-render';\nimport { Rect, RegularPolygon, Shape } from '@univerjs/engine-render';\n\nimport { HEADER_MENU_BACKGROUND_COLOR, HEADER_MENU_SHAPE_TRIANGLE_FILL } from './header-menu-shape';\n\nexport enum HeaderUnhideShapeType {\n    ROW,\n    COLUMN,\n}\n\nexport interface IHeaderUnhideShapeProps extends IShapeProps {\n    /** On row headers or on column headers. */\n    type: HeaderUnhideShapeType;\n    /** If the shape is hovered. If it's hovered it should have a border. */\n    hovered: boolean;\n    /** This hidden position has previous rows/cols. */\n    hasPrevious: boolean;\n    /** This hidden position has succeeding rows/cols. */\n    hasNext: boolean;\n}\n\nexport const UNHIDE_ICON_SIZE = 12;\nconst UNHIDE_ARROW_RATIO = 0.4;\n\nexport class HeaderUnhideShape<T extends IHeaderUnhideShapeProps = IHeaderUnhideShapeProps> extends Shape<T> {\n    private _size = UNHIDE_ICON_SIZE;\n    private _iconRatio = UNHIDE_ARROW_RATIO;\n    private _hovered = true;\n    private _hasPrevious = true;\n    private _hasNext = true;\n    private _unhideType!: HeaderUnhideShapeType;\n\n    constructor(key?: string, props?: T, onClick?: () => void) {\n        super(key, props);\n        if (props) {\n            this.setShapeProps(props);\n        }\n\n        this.onPointerEnter$.subscribeEvent(() => this.setShapeProps({ hovered: true }));\n        this.onPointerLeave$.subscribeEvent(() => this.setShapeProps({ hovered: false }));\n        this.onPointerDown$.subscribeEvent(() => onClick?.());\n    }\n\n    setShapeProps(props: Partial<IHeaderUnhideShapeProps>): void {\n        if (props.type !== undefined) {\n            this._unhideType = props.type;\n        }\n        if (props.hovered !== undefined) {\n            this._hovered = props.hovered;\n        }\n        if (props.hasPrevious !== undefined) {\n            this._hasPrevious = props.hasPrevious;\n        }\n        if (props.hasNext !== undefined) {\n            this._hasNext = props.hasNext;\n        }\n\n        this.transformByState({\n            width: this._size * (this._unhideType === HeaderUnhideShapeType.COLUMN ? 2 : 1),\n            height: this._size * (this._unhideType === HeaderUnhideShapeType.ROW ? 2 : 1),\n        });\n    }\n\n    protected override _draw(ctx: UniverRenderingContext): void {\n        if (this._unhideType === HeaderUnhideShapeType.ROW) {\n            this._drawOnRow(ctx);\n        } else {\n            this._drawOnCol(ctx);\n        }\n    }\n\n    private _drawOnRow(ctx: UniverRenderingContext): void {\n        if (this._hovered) {\n            if (!this._hasNext || !this._hasPrevious) {\n                Rect.drawWith(ctx, {\n                    width: this._size,\n                    height: this._size,\n                    stroke: HEADER_MENU_SHAPE_TRIANGLE_FILL,\n                    fill: HEADER_MENU_BACKGROUND_COLOR,\n                });\n            } else {\n                Rect.drawWith(ctx, {\n                    width: this._size,\n                    height: 2 * this._size,\n                    stroke: HEADER_MENU_SHAPE_TRIANGLE_FILL,\n                    fill: HEADER_MENU_BACKGROUND_COLOR,\n                });\n            }\n        }\n\n        const iconSize = this._size * 0.5 * this._iconRatio;\n        const sixtyDegree = Math.PI / 3;\n        const top = iconSize * Math.cos(sixtyDegree);\n        const left = iconSize * Math.sin(sixtyDegree);\n\n        if (this._hasPrevious) {\n            RegularPolygon.drawWith(ctx, {\n                pointsGroup: [\n                    [\n                        { x: this._size / 2, y: this._size / 2 - left },\n                        { x: this._size / 2 - left, y: this._size / 2 + top },\n                        { x: this._size / 2 + left, y: this._size / 2 + top },\n                    ],\n                ],\n                fill: HEADER_MENU_SHAPE_TRIANGLE_FILL,\n            });\n        }\n\n        if (this._hasNext) {\n            const offset = this._hasPrevious ? 3 : 1;\n            RegularPolygon.drawWith(ctx, {\n                pointsGroup: [\n                    [\n                        { x: this._size / 2, y: (this._size * offset) / 2 + left },\n                        { x: this._size / 2 - left, y: (this._size * offset) / 2 - top },\n                        { x: this._size / 2 + left, y: (this._size * offset) / 2 - top },\n                    ],\n                ],\n                fill: HEADER_MENU_SHAPE_TRIANGLE_FILL,\n            });\n        }\n    }\n\n    /**\n     *\n     * @param ctx\n     */\n    private _drawOnCol(ctx: UniverRenderingContext): void {\n        if (this._hovered) {\n            if (!this._hasNext || !this._hasPrevious) {\n                Rect.drawWith(ctx, {\n                    width: this._size,\n                    height: this._size,\n                    stroke: HEADER_MENU_SHAPE_TRIANGLE_FILL,\n                    fill: HEADER_MENU_BACKGROUND_COLOR,\n                });\n            } else {\n                Rect.drawWith(ctx, {\n                    width: 2 * this._size,\n                    height: this._size,\n                    stroke: HEADER_MENU_SHAPE_TRIANGLE_FILL,\n                    fill: HEADER_MENU_BACKGROUND_COLOR,\n                });\n            }\n        }\n\n        const iconSize = this._size * 0.5 * this._iconRatio;\n        const sixtyDegree = Math.PI / 3;\n        const top = iconSize * Math.cos(sixtyDegree);\n        const left = iconSize * Math.sin(sixtyDegree);\n\n        if (this._hasPrevious) {\n            RegularPolygon.drawWith(ctx, {\n                pointsGroup: [\n                    [\n                        { x: -top + this._size / 2, y: this._size / 2 },\n                        { x: this._size / 2 + left, y: this._size / 2 - left },\n                        { x: this._size / 2 + left, y: this._size / 2 + left },\n                    ],\n                ],\n                fill: HEADER_MENU_SHAPE_TRIANGLE_FILL,\n            });\n        }\n\n        if (this._hasNext) {\n            const offset = this._hasPrevious ? 3 : 1;\n            RegularPolygon.drawWith(ctx, {\n                pointsGroup: [\n                    [\n                        { x: top + (this._size * offset) / 2, y: this._size / 2 },\n                        { x: -left + (this._size * offset) / 2, y: this._size / 2 - left },\n                        { x: -left + (this._size * offset) / 2, y: this._size / 2 + left },\n                    ],\n                ],\n                fill: HEADER_MENU_SHAPE_TRIANGLE_FILL,\n            });\n        }\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Workbook, Worksheet } from '@univerjs/core';\nimport type { IRenderContext } from '@univerjs/engine-render';\nimport type { ISetSpecificColsVisibleCommandParams, ISetSpecificRowsVisibleCommandParams } from '@univerjs/sheets';\nimport {\n    ICommandService,\n    Inject,\n    RxDisposable,\n} from '@univerjs/core';\nimport {\n    SetSpecificColsVisibleCommand,\n    SetSpecificRowsVisibleCommand,\n} from '@univerjs/sheets';\nimport { takeUntil } from 'rxjs';\n\nimport { SHEET_COMPONENT_UNHIDE_LAYER_INDEX } from '../../common/keys';\nimport { SheetSkeletonManagerService } from '../../services/sheet-skeleton-manager.service';\nimport { HeaderUnhideShape, HeaderUnhideShapeType, UNHIDE_ICON_SIZE } from '../../views/header-unhide-shape';\nimport { getCoordByCell, getSheetObject } from '../utils/component-tools';\n\nconst HEADER_UNHIDE_CONTROLLER_SHAPE = '__SpreadsheetHeaderUnhideSHAPEControllerShape__';\n\n/**\n * This controller controls rendering of the buttons to unhide hidden rows and columns.\n */\nexport class HeaderUnhideRenderController extends RxDisposable {\n    private _shapes: { cols: HeaderUnhideShape[]; rows: HeaderUnhideShape[] } = { cols: [], rows: [] };\n    private get _workbook(): Workbook { return this._context.unit; }\n\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(SheetSkeletonManagerService) private readonly _sheetSkeletonManagerService: SheetSkeletonManagerService,\n        @ICommandService private readonly _commandService: ICommandService\n    ) {\n        super();\n\n        this._init();\n    }\n\n    override dispose(): void {\n        super.dispose();\n\n        this._clearShapes();\n    }\n\n    private _init(): void {\n        let activeSheetId: string = '';\n\n        this._context.unit.activeSheet$.pipe(takeUntil(this.dispose$)).subscribe((worksheet) => {\n            this._clearShapes();\n\n            if (!worksheet) {\n                activeSheetId = '';\n                return;\n            };\n\n            activeSheetId = worksheet.getSheetId();\n            this._update(this._workbook, worksheet);\n        });\n\n        this.disposeWithMe(\n            this._sheetSkeletonManagerService.currentSkeleton$.subscribe((param) => {\n                if (param) {\n                    const { unitId, sheetId } = param;\n                    if (unitId === this._workbook.getUnitId() && sheetId === activeSheetId) {\n                        const worksheet = this._workbook.getSheetBySheetId(sheetId);\n                        if (worksheet) {\n                            this._update(this._workbook, worksheet);\n                        }\n                    }\n                }\n            })\n        );\n    }\n\n    private _update(workbook: Workbook, worksheet: Worksheet): void {\n        const skeleton = this._sheetSkeletonManagerService.getSkeletonParam(worksheet.getSheetId())?.skeleton;\n        if (!skeleton) return;\n\n        // steps to render the unhide button for the current worksheet\n        // 1. and get hidden rows and columns\n        const hiddenRowRanges = worksheet.getHiddenRows();\n        const hiddenColRanges = worksheet.getHiddenCols();\n\n        // First just let me render a unhide button of the column header!.\n        const sheetObject = this._getSheetObject();\n\n        // NOTE: for performance consideration we should only get hidden rows & cols in the viewport\n        // 2. create shapes and add them to the scene, the position should be calculated from SheetSkeleton\n        const { scene } = sheetObject;\n        const rowCount = worksheet.getRowCount();\n        const rowShapes = hiddenRowRanges.map((range) => {\n            const { startRow, endRow } = range;\n            const position = getCoordByCell(startRow, 0, scene, skeleton);\n            const hasPrevious = startRow !== 0;\n            const hasNext = endRow !== rowCount - 1;\n            return new HeaderUnhideShape(\n                HEADER_UNHIDE_CONTROLLER_SHAPE,\n                {\n                    type: HeaderUnhideShapeType.ROW,\n                    hovered: false,\n                    hasPrevious,\n                    hasNext,\n                    top: position.startY - (hasPrevious ? UNHIDE_ICON_SIZE : 0),\n                    left: position.startX - UNHIDE_ICON_SIZE,\n                },\n                () => this._commandService.executeCommand<ISetSpecificRowsVisibleCommandParams>(\n                    SetSpecificRowsVisibleCommand.id,\n                    {\n                        unitId: workbook.getUnitId(),\n                        subUnitId: worksheet.getSheetId(),\n                        ranges: [range],\n                    }\n                )\n            );\n        });\n        const colCount = worksheet.getColumnCount();\n        const colShapes = hiddenColRanges.map((range) => {\n            const { startColumn, endColumn } = range;\n            const position = getCoordByCell(0, startColumn, scene, skeleton);\n            const hasPrevious = startColumn !== 0;\n            const hasNext = endColumn !== colCount - 1;\n            return new HeaderUnhideShape(\n                HEADER_UNHIDE_CONTROLLER_SHAPE,\n                {\n                    type: HeaderUnhideShapeType.COLUMN,\n                    hovered: false,\n                    hasPrevious,\n                    hasNext,\n                    top: 20 - UNHIDE_ICON_SIZE,\n                    left: position.startX - (hasPrevious ? UNHIDE_ICON_SIZE : 0),\n                },\n                () => this._commandService.executeCommand<ISetSpecificColsVisibleCommandParams>(\n                    SetSpecificColsVisibleCommand.id,\n                    {\n                        unitId: workbook.getUnitId(),\n                        subUnitId: worksheet.getSheetId(),\n                        ranges: [range],\n                    }\n                )\n            );\n        });\n\n        scene.addObjects(colShapes, SHEET_COMPONENT_UNHIDE_LAYER_INDEX);\n        scene.addObjects(rowShapes, SHEET_COMPONENT_UNHIDE_LAYER_INDEX);\n\n        // 3. clear the previous shapes and update the shapes\n        this._clearShapes();\n        this._shapes = { cols: colShapes, rows: rowShapes };\n    }\n\n    private _clearShapes(): void {\n        this._shapes.cols.forEach((shape) => shape.dispose());\n        this._shapes.rows.forEach((shape) => shape.dispose());\n        this._shapes = { cols: [], rows: [] };\n    }\n\n    private _getSheetObject() {\n        return getSheetObject(this._workbook, this._context)!;\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Nullable, Workbook } from '@univerjs/core';\nimport type { IRenderContext, IRenderModule } from '@univerjs/engine-render';\nimport type { ISheetSkeletonManagerParam } from '../../services/sheet-skeleton-manager.service';\nimport { Disposable, Inject } from '@univerjs/core';\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport { SheetSkeletonManagerService } from '../../services/sheet-skeleton-manager.service';\n\nexport class SheetSkeletonRenderController extends Disposable implements IRenderModule {\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(SheetSkeletonManagerService) private readonly _sheetSkeletonManagerService: SheetSkeletonManagerService,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService\n    ) {\n        super();\n\n        this.disposeWithMe(this._context.unit.sheetDisposed$.subscribe((sheet) => {\n            this._sheetSkeletonManagerService.disposeSkeleton(sheet.getSheetId());\n        }));\n\n        this._sheetSkeletonManagerService.currentSkeleton$.subscribe((param: Nullable<ISheetSkeletonManagerParam>) => {\n            this._updateSceneSize(param);\n        });\n    }\n\n    private _updateSceneSize(param: Nullable<ISheetSkeletonManagerParam>) {\n        if (param == null) {\n            return;\n        }\n\n        const { unitId } = this._context;\n        const { skeleton } = param;\n        const scene = this._renderManagerService.getRenderById(unitId)?.scene;\n\n        if (skeleton == null || scene == null) {\n            return;\n        }\n\n        const { rowTotalHeight, columnTotalWidth, rowHeaderWidthAndMarginLeft, columnHeaderHeightAndMarginTop } =\n            skeleton;\n        const workbook = this._context.unit;\n        const worksheet = workbook.getActiveSheet();\n        if (!worksheet) return;\n\n        scene?.transformByState({\n            width: rowHeaderWidthAndMarginLeft + columnTotalWidth,\n            height: columnHeaderHeightAndMarginTop + rowTotalHeight,\n        });\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { IDisposable, IRangeWithCoord, Nullable, Workbook } from '@univerjs/core';\nimport type { IMouseEvent, IPointerEvent, IRenderContext, IRenderModule, Viewport } from '@univerjs/engine-render';\nimport type { ISelectionWithCoord, ISelectionWithStyle, ISetSelectionsOperationParams, WorkbookSelectionModel } from '@univerjs/sheets';\nimport type { ISheetObjectParam } from '../../controllers/utils/component-tools';\nimport type { SelectionControl } from './selection-control';\nimport { ICommandService, IContextService, ILogService, Inject, Injector, RANGE_TYPE, Rectangle, ThemeService, toDisposable } from '@univerjs/core';\nimport { ScrollTimerType, SHEET_VIEWPORT_KEY, Vector2 } from '@univerjs/engine-render';\nimport { convertSelectionDataToRange, REF_SELECTIONS_ENABLED, SelectionMoveType, SELECTIONS_ENABLED, SetSelectionsOperation, SheetsSelectionsService } from '@univerjs/sheets';\nimport { IShortcutService } from '@univerjs/ui';\nimport { distinctUntilChanged, merge, startWith } from 'rxjs';\nimport { getCoordByOffset, getSheetObject } from '../../controllers/utils/component-tools';\n\nimport { isThisColSelected, isThisRowSelected } from '../../controllers/utils/selections-tools';\nimport { SheetSkeletonManagerService } from '../sheet-skeleton-manager.service';\nimport { BaseSelectionRenderService, getTopLeftSelectionOfCurrSheet, selectionDataForSelectAll } from './base-selection-render.service';\nimport { genNormalSelectionStyle } from './const';\nimport { attachSelectionWithCoord } from './util';\n\n/**\n * This services controls rendering of normal selections in a render unit.\n * The normal selections would also be used by Auto Fill and Copy features.\n */\nexport class SheetSelectionRenderService extends BaseSelectionRenderService implements IRenderModule {\n    private readonly _workbookSelections: WorkbookSelectionModel;\n\n    private _renderDisposable: Nullable<IDisposable> = null;\n\n    constructor(\n        private readonly _context: IRenderContext<Workbook>,\n        @Inject(Injector) injector: Injector,\n        @Inject(ThemeService) themeService: ThemeService,\n        @IShortcutService shortcutService: IShortcutService,\n        @Inject(SheetsSelectionsService) selectionManagerService: SheetsSelectionsService,\n        @Inject(SheetSkeletonManagerService) sheetSkeletonManagerService: SheetSkeletonManagerService,\n        @ILogService private readonly _logService: ILogService,\n        @ICommandService private readonly _commandService: ICommandService,\n        @IContextService protected readonly _contextService: IContextService\n    ) {\n        super(\n            injector,\n            themeService,\n            shortcutService,\n            sheetSkeletonManagerService,\n            _contextService\n        );\n\n        this._workbookSelections = selectionManagerService.getWorkbookSelections(this._context.unitId);\n        this._init();\n    }\n\n    private _init(): void {\n        const sheetObject = this._getSheetObject();\n        this._contextService.setContextValue(SELECTIONS_ENABLED, true);\n        this._initEventListeners(sheetObject);\n        this._initSelectionModelChangeListener();\n        this._initThemeChangeListener();\n        this._initSkeletonChangeListener();\n        this._initUserActionSyncListener();\n    }\n\n    private _initEventListeners(sheetObject: ISheetObjectParam): void {\n        const { spreadsheetRowHeader, spreadsheetColumnHeader, spreadsheet, spreadsheetLeftTopPlaceholder } = sheetObject;\n        const { scene } = this._context;\n\n        this.disposeWithMe(spreadsheet?.onPointerDown$.subscribeEvent((evt: IPointerEvent | IMouseEvent, state) => {\n            if (this.isSelectionDisabled()) return;\n            if (this.inRefSelectionMode()) return;\n            this._onPointerDown(evt, spreadsheet.zIndex + 1, RANGE_TYPE.NORMAL, this._getActiveViewport(evt));\n            if (evt.button !== 2) {\n                state.stopPropagation();\n            }\n        }));\n\n        this.disposeWithMe(\n            spreadsheetRowHeader?.onPointerDown$.subscribeEvent((evt: IPointerEvent | IMouseEvent, state) => {\n                if (this.isSelectionDisabled()) return;\n                if (this.inRefSelectionMode()) return;\n\n                const skeleton = this._sheetSkeletonManagerService.getCurrentParam()!.skeleton;\n                const { row } = getCoordByOffset(evt.offsetX, evt.offsetY, scene, skeleton);\n                const matchSelectionData = isThisRowSelected(this._workbookSelections.getCurrentSelections(), row);\n                if (matchSelectionData) return;\n\n                this._onPointerDown(evt, (spreadsheet.zIndex || 1) + 1, RANGE_TYPE.ROW, this._getActiveViewport(evt), ScrollTimerType.Y);\n                if (evt.button !== 2) {\n                    state.stopPropagation();\n                }\n            })\n        );\n\n        this.disposeWithMe(spreadsheetColumnHeader?.onPointerDown$.subscribeEvent((evt: IPointerEvent | IMouseEvent, state) => {\n            if (this.isSelectionDisabled()) return;\n            if (this.inRefSelectionMode()) return;\n\n            const skeleton = this._sheetSkeletonManagerService.getCurrentParam()!.skeleton;\n            const { column } = getCoordByOffset(evt.offsetX, evt.offsetY, scene, skeleton);\n\n            // We should take if this is col selection into consideration.\n\n            const matchSelectionData = isThisColSelected(this._workbookSelections.getCurrentSelections(), column);\n            if (matchSelectionData) return;\n\n            this._onPointerDown(evt, (spreadsheet.zIndex || 1) + 1, RANGE_TYPE.COLUMN, this._getActiveViewport(evt), ScrollTimerType.X);\n\n            if (evt.button !== 2) {\n                state.stopPropagation();\n            }\n        }));\n\n        this.disposeWithMe(spreadsheetLeftTopPlaceholder?.onPointerDown$.subscribeEvent((evt: IPointerEvent | IMouseEvent, state) => {\n            if (this.isSelectionDisabled()) return;\n            if (this.inRefSelectionMode()) return;\n\n            this._reset(); // remove all other selections\n\n            const skeleton = this._sheetSkeletonManagerService.getCurrentParam()!.skeleton;\n            const selectionWithStyle = selectionDataForSelectAll(skeleton);\n            this._addSelectionControlByModelData(selectionWithStyle);\n            this.refreshSelectionMoveEnd();\n\n            if (evt.button !== 2) {\n                state.stopPropagation();\n            }\n        }));\n    }\n\n    private _initThemeChangeListener(): void {\n        this.disposeWithMe(this._themeService.currentTheme$.subscribe(() => {\n            this._initSelectionThemeFromThemeService();\n            const selections = this._workbookSelections.getCurrentSelections();\n            if (!selections) return;\n            this.resetSelectionsByModelData(selections);\n        }));\n    }\n\n    /**\n     * Response for selection model changing.\n     */\n    private _initSelectionModelChangeListener(): void {\n        this.disposeWithMe(merge(\n            this._workbookSelections.selectionMoveEnd$, // triggered by keyboard(e.g. arrow key tab enter)\n            this._workbookSelections.selectionSet$ // shift + arrow key\n        ).subscribe((selectionWithStyleList) => {\n            this.resetSelectionsByModelData(selectionWithStyleList);\n        }));\n    }\n\n    disableSelection() {\n        this._contextService.setContextValue(SELECTIONS_ENABLED, false);\n    }\n\n    enableSelection() {\n        this._contextService.setContextValue(SELECTIONS_ENABLED, true);\n    }\n\n    transparentSelection() {\n        this.setSelectionTheme({\n            primaryColor: 'transparent',\n        });\n        const selectionsWithStyle = this._workbookSelections.getCurrentSelections();\n        for (let index = 0; index < selectionsWithStyle.length; index++) {\n            const selectionWithStyle = selectionsWithStyle[index];\n            selectionWithStyle.style = genNormalSelectionStyle(this._selectionTheme);\n        }\n        this.resetSelectionsByModelData(selectionsWithStyle);\n    }\n\n    showSelection() {\n        const currTheme = this._themeService.getCurrentTheme();\n        this.setSelectionTheme(currTheme);\n        const selectionsWithStyle = this._workbookSelections.getCurrentSelections();\n        for (let index = 0; index < selectionsWithStyle.length; index++) {\n            const selectionWithStyle = selectionsWithStyle[index];\n            if (selectionWithStyle.style) {\n                selectionWithStyle.style = genNormalSelectionStyle(this._selectionTheme);\n            }\n        }\n        this.resetSelectionsByModelData(selectionsWithStyle);\n    }\n\n    /**\n     * Handle events in spreadsheet. (e.g. drag and move to make a selection)\n     */\n    private _initUserActionSyncListener(): void {\n        this.disposeWithMe(this.selectionMoveStart$.subscribe((params) => this._updateSelections(params, SelectionMoveType.MOVE_START)));\n        this.disposeWithMe(this.selectionMoving$.subscribe((params) => this._updateSelections(params, SelectionMoveType.MOVING)));\n\n        this.disposeWithMe(this._contextService.subscribeContextValue$(REF_SELECTIONS_ENABLED)\n            .pipe(startWith(false), distinctUntilChanged())\n            .subscribe((enabled) => {\n                if (enabled) {\n                    // this._renderDisposable?.dispose();\n                    // this._renderDisposable = null;\n\n                    // clear curr normal selections when ref turn enabled, only view selections are cleared, selection data still exist.\n                    this._reset();\n                } else {\n                    // DO not bind again !!! or there would be two selectionMoveEnd$ after pointer up.\n                    // #univer-pro/issues/3763\n                    // this._renderDisposable = toDisposable(\n                    //     this.selectionMoveEnd$.pipe(skip(1)).subscribe((params) => {\n                    //         // this._updateSelections(params, SelectionMoveType.MOVE_END);\n                    //     })\n                    // );\n                }\n            }));\n\n        this.disposeWithMe(this._contextService.subscribeContextValue$(SELECTIONS_ENABLED)\n            .pipe(startWith(true), distinctUntilChanged())\n            .subscribe((enabled) => {\n                if (!enabled) {\n                    this._renderDisposable?.dispose();\n                    this._renderDisposable = null;\n                    this._reset();\n                } else {\n                    this._renderDisposable = toDisposable(\n                        this.selectionMoveEnd$.subscribe((params) => {\n                            this._updateSelections(params, SelectionMoveType.MOVE_END);\n                        })\n                    );\n                }\n            }));\n    }\n\n    /**\n     * Update selectionData to selectionDataModel (WorkBookSelections) by SetSelectionsOperation.\n     *\n     * Unlike baseSelectionRenderService@resetSelectionsByModelData, this method is for update WorkbookSelectionModel.\n     *\n     *\n     * @param selectionDataWithStyleList\n     * @param type\n     */\n    private _updateSelections(selectionDataWithStyleList: ISelectionWithCoord[], type: SelectionMoveType) {\n        const workbook = this._context.unit;\n        const unitId = workbook.getUnitId();\n        const sheetId = workbook.getActiveSheet().getSheetId();\n\n        if (selectionDataWithStyleList.length === 0) {\n            return;\n        }\n\n        const selectionWithStyles = selectionDataWithStyleList.map((selectionDataWithStyle) =>\n            convertSelectionDataToRange(selectionDataWithStyle)\n        );\n\n        this._commandService.executeCommand(SetSelectionsOperation.id, {\n            unitId,\n            subUnitId: sheetId,\n            type,\n            selections: selectionWithStyles,\n        });\n    }\n\n    private _initSkeletonChangeListener(): void {\n        // changing sheet is not the only way cause currentSkeleton$ emit, a lot of cmds will emit currentSkeleton$\n        // COMMAND_LISTENER_SKELETON_CHANGE ---> currentSkeleton$.next\n        // 'sheet.mutation.set-worksheet-row-auto-height' is one of COMMAND_LISTENER_SKELETON_CHANGE\n        this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((param) => {\n            if (param == null) {\n                this._logService.error('[SelectionRenderService]: should not receive null!');\n                return;\n            }\n\n            const unitId = this._context.unitId;\n            const { sheetId, skeleton } = param;\n            const { scene } = this._context;\n            const viewportMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n            const prevSheetId = this._skeleton?.worksheet?.getSheetId();\n            this._changeRuntime(skeleton, scene, viewportMain);\n\n            if (prevSheetId !== skeleton.worksheet.getSheetId()) {\n                // If there is no initial selection, add one by default in the top left corner.\n                const selections = this._workbookSelections.getCurrentSelections();\n                // WARNING: SetSelectionsOperation with type=null would clear all exists selections\n                // SetSelectionsOperation ---> selectionManager@setSelections ---> moveEnd$ ---> selectionRenderService@_reset\n                // TODO @lumixraku why use such weird a way to clear existing selection? subscribe to currentSkeleton$ is much better?\n                this._commandService.syncExecuteCommand(SetSelectionsOperation.id, {\n                    unitId,\n                    subUnitId: sheetId,\n                    selections: selections.length !== 0 ? selections : [getTopLeftSelectionOfCurrSheet(skeleton)],\n                } as ISetSelectionsOperationParams);\n            }\n\n            const currentSelections = this._workbookSelections.getCurrentSelections();\n            // for col width & row height resize\n            if (currentSelections != null) {\n                this.resetSelectionsByModelData(currentSelections);\n            }\n        }));\n    }\n\n    private _getActiveViewport(evt: IPointerEvent | IMouseEvent) {\n        const sheetObject = this._getSheetObject();\n        return sheetObject?.scene.getActiveViewportByCoord(Vector2.FromArray([evt.offsetX, evt.offsetY]));\n    }\n\n    private _getSheetObject() {\n        return getSheetObject(this._context.unit, this._context)!;\n    }\n\n    /**\n     * Handle pointer down event, bind pointermove & pointerup handler.\n     * then trigger selectionMoveStart$.\n     *\n     * @param evt\n     * @param _zIndex\n     * @param rangeType\n     * @param viewport\n     * @param scrollTimerType\n     */\n    // eslint-disable-next-line complexity, max-lines-per-function\n    protected _onPointerDown(\n        evt: IPointerEvent | IMouseEvent,\n        _zIndex = 0,\n        rangeType: RANGE_TYPE = RANGE_TYPE.NORMAL,\n        viewport: Nullable<Viewport>,\n        scrollTimerType: ScrollTimerType = ScrollTimerType.ALL\n    ): void {\n        this._rangeType = rangeType;\n\n        const skeleton = this._skeleton;\n        const scene = this._scene;\n        if (!scene || !skeleton) {\n            return;\n        }\n\n        if (viewport) {\n            this._activeViewport = viewport;\n        }\n\n        const { offsetX: evtOffsetX, offsetY: evtOffsetY } = evt;\n        const viewportMain = scene.getViewport(SHEET_VIEWPORT_KEY.VIEW_MAIN);\n        if (!viewportMain) return;\n        const relativeCoords = scene.getCoordRelativeToViewport(Vector2.FromArray([evtOffsetX, evtOffsetY]));\n\n        const { x: offsetX, y: offsetY } = relativeCoords;\n        this._startViewportPosX = offsetX;\n        this._startViewportPosY = offsetY;\n\n        const scrollXY = scene.getScrollXYInfoByViewport(relativeCoords);\n        const { scaleX, scaleY } = scene.getAncestorScale();\n\n        const selectCell = this._skeleton.getCellByOffset(offsetX, offsetY, scaleX, scaleY, scrollXY);\n        if (!selectCell) return;\n        switch (rangeType) {\n            case RANGE_TYPE.NORMAL:\n                break;\n            case RANGE_TYPE.ROW:\n                selectCell.startColumn = 0;\n                selectCell.endColumn = this._skeleton.getColumnCount() - 1;\n                selectCell.startRow = selectCell.actualRow;\n                selectCell.endRow = selectCell.actualRow;\n                break;\n            case RANGE_TYPE.COLUMN:\n                selectCell.startRow = 0;\n                selectCell.endRow = this._skeleton.getRowCount() - 1;\n                selectCell.startColumn = selectCell.actualColumn;\n                selectCell.endColumn = selectCell.actualColumn;\n                break;\n            case RANGE_TYPE.ALL:\n                selectCell.startRow = 0;\n                selectCell.startColumn = 0;\n                selectCell.endRow = this._skeleton.getRowCount() - 1;\n                selectCell.endColumn = this._skeleton.getColumnCount() - 1;\n        }\n        const selectionWithStyle: ISelectionWithStyle = { range: selectCell, primary: selectCell, style: null };\n        selectionWithStyle.range.rangeType = rangeType;\n        const selectionCellWithCoord = attachSelectionWithCoord(selectionWithStyle, this._skeleton);\n        this._startRangeWhenPointerDown = { ...selectionCellWithCoord.rangeWithCoord };\n\n        let activeSelectionControl: Nullable<SelectionControl> = this.getActiveSelectionControl();\n        const cursorRangeWidthCoord: IRangeWithCoord = { ...selectionCellWithCoord.rangeWithCoord, rangeType };\n        const curControls = this.getSelectionControls();\n        for (const control of curControls) {\n            // If right click on a selection, we should not create a new selection control.\n            // Instead, the context menu will popup.\n            if (evt.button === 2 && Rectangle.contains(control.model, cursorRangeWidthCoord)) {\n                activeSelectionControl = control;\n                return;\n            }\n        }\n\n        this._checkClearPreviousControls(evt);\n\n        const currentCell = activeSelectionControl?.model.currentCell;\n        const expandByShiftKey = evt.shiftKey && currentCell;\n        const remainLastEnable = this._remainLastEnabled &&\n            !evt.ctrlKey &&\n            !evt.shiftKey &&\n            !this._skipLastEnabled &&\n            !this._singleSelectionEnabled;\n\n        //#region update selection control\n        if (expandByShiftKey && currentCell) {\n            // Perform pointer down selection.\n            this._makeSelectionByTwoCells(\n                currentCell,\n                cursorRangeWidthCoord,\n                skeleton,\n                rangeType,\n                activeSelectionControl! // Get updated in this method\n            );\n        } else if (remainLastEnable && activeSelectionControl) {\n            // Supports the formula ref text selection feature,\n\n            activeSelectionControl.updateRangeBySelectionWithCoord(selectionCellWithCoord);// (cursorRangeWidthCoord, primaryCursorCellRange);\n        } else {\n            // In normal situation, pointerdown ---> Create new SelectionControl,\n            activeSelectionControl = this.newSelectionControl(scene, skeleton, selectionWithStyle);\n        }\n        // clear highlight except last one.\n        for (let i = 0; i < this.getSelectionControls().length - 1; i++) {\n            this.getSelectionControls()[i].clearHighlight();\n        }\n        //#endregion\n\n        scene.disableObjectsEvent();\n        this._clearUpdatingListeners();\n        this._addEndingListeners();\n        scene.getTransformer()?.clearSelectedObjects();\n\n        this._setupPointerMoveListener(viewportMain, activeSelectionControl!, rangeType, scrollTimerType, offsetX, offsetY);\n        this._escapeShortcutDisposable = this._shortcutService.forceEscape();\n\n        this._selectionMoveStart$.next(this.getSelectionDataWithStyle());\n        this._scenePointerUpSub = scene.onPointerUp$.subscribeEvent(() => {\n            this._clearUpdatingListeners();\n\n            // selection control would be disposed in _selectionMoveEnd$.\n            // SelectionRenderService@selectionMoveEnd$ exec SetSelectionsOperation\n            // SheetsSelectionsService@setSelections\n            // SelectionRenderService._workbookSelections.selectionMoveEnd$ call _reset() to clear selectionControl.\n            this._selectionMoveEnd$.next(this.getSelectionDataWithStyle());\n            this._escapeShortcutDisposable?.dispose();\n            this._escapeShortcutDisposable = null;\n        });\n\n        this._scene.getEngine()?.setCapture();\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Dependency, Workbook } from '@univerjs/core';\nimport type { IUniverUIConfig } from '@univerjs/ui';\nimport type { IUniverSheetsUIConfig } from './controllers/config.schema';\nimport { DependentOn, IConfigService, Inject, Injector, IUniverInstanceService, merge, mergeOverrideWithDependencies, Plugin, registerDependencies, touchDependencies, UniverInstanceType } from '@univerjs/core';\nimport { IRenderManagerService } from '@univerjs/engine-render';\nimport { IRefSelectionsService, RefSelectionsService, UniverSheetsPlugin } from '@univerjs/sheets';\nimport { UI_PLUGIN_CONFIG_KEY } from '@univerjs/ui';\nimport { filter } from 'rxjs/operators';\nimport { ActiveWorksheetController } from './controllers/active-worksheet/active-worksheet.controller';\nimport { AutoFillController } from './controllers/auto-fill.controller';\nimport { AutoHeightController } from './controllers/auto-height.controller';\nimport { AutoWidthController } from './controllers/auto-width.controller';\nimport { CellAlertRenderController } from './controllers/cell-alert.controller';\nimport { CellCustomRenderController } from './controllers/cell-custom-render.controller';\nimport { SheetCheckboxController } from './controllers/checkbox.controller';\nimport { SheetClipboardController } from './controllers/clipboard/clipboard.controller';\nimport { defaultPluginConfig, SHEETS_UI_PLUGIN_CONFIG_KEY } from './controllers/config.schema';\nimport { SheetsDefinedNameController } from './controllers/defined-name/defined-name.controller';\nimport { DragRenderController } from './controllers/drag-render.controller';\nimport { EditorDataSyncController } from './controllers/editor/data-sync.controller';\nimport { EditingRenderController } from './controllers/editor/editing.render-controller';\nimport { FormulaEditorController } from './controllers/editor/formula-editor.controller';\nimport { ForceStringAlertRenderController } from './controllers/force-string-alert-render.controller';\nimport { ForceStringRenderController } from './controllers/force-string-render.controller';\nimport { FormatPainterController } from './controllers/format-painter/format-painter.controller';\nimport { HoverRenderController } from './controllers/hover-render.controller';\nimport { MarkSelectionRenderController } from './controllers/mark-selection.controller';\nimport { MoveRangeRenderController } from './controllers/move-range.controller';\nimport { SheetPermissionCheckUIController } from './controllers/permission/sheet-permission-check-ui.controller';\nimport { SheetPermissionInitUIController } from './controllers/permission/sheet-permission-init-ui.controller';\nimport { SheetPermissionInterceptorCanvasRenderController } from './controllers/permission/sheet-permission-interceptor-canvas-render.controller';\nimport { SheetPermissionInterceptorClipboardController } from './controllers/permission/sheet-permission-interceptor-clipboard.controller';\nimport { SheetPermissionInterceptorFormulaRenderController } from './controllers/permission/sheet-permission-interceptor-formula-render.controller';\nimport { SheetPermissionRenderController, SheetPermissionRenderManagerController, WorksheetProtectionRenderController } from './controllers/permission/sheet-permission-render.controller';\nimport { ClipboardRenderController } from './controllers/render-controllers/clipboard.render-controller';\nimport { SheetContextMenuRenderController } from './controllers/render-controllers/contextmenu.render-controller';\nimport { EditorBridgeRenderController } from './controllers/render-controllers/editor-bridge.render-controller';\nimport { FormatPainterRenderController } from './controllers/render-controllers/format-painter.render-controller';\nimport { HeaderFreezeRenderController } from './controllers/render-controllers/freeze.render-controller';\nimport { HeaderMenuRenderController } from './controllers/render-controllers/header-menu.render-controller';\nimport { HeaderMoveRenderController } from './controllers/render-controllers/header-move.render-controller';\nimport { HeaderResizeRenderController } from './controllers/render-controllers/header-resize.render-controller';\nimport { HeaderUnhideRenderController } from './controllers/render-controllers/header-unhide.render-controller';\nimport { SheetsScrollRenderController } from './controllers/render-controllers/scroll.render-controller';\nimport { SheetRenderController } from './controllers/render-controllers/sheet.render-controller';\nimport { SheetSkeletonRenderController } from './controllers/render-controllers/skeleton.render-controller';\nimport { SheetsZoomRenderController } from './controllers/render-controllers/zoom.render-controller';\nimport { SheetUIController } from './controllers/sheet-ui.controller';\nimport { StatusBarController } from './controllers/status-bar.controller';\nimport { AutoFillService, IAutoFillService } from './services/auto-fill/auto-fill.service';\nimport { SheetCanvasPopManagerService } from './services/canvas-pop-manager.service';\nimport { CellAlertManagerService } from './services/cell-alert-manager.service';\nimport { ISheetClipboardService, SheetClipboardService } from './services/clipboard/clipboard.service';\nimport { DragManagerService } from './services/drag-manager.service';\nimport { EditorBridgeService, IEditorBridgeService } from './services/editor-bridge.service';\nimport { CellEditorManagerService, ICellEditorManagerService } from './services/editor/cell-editor-manager.service';\nimport { SheetCellEditorResizeService } from './services/editor/cell-editor-resize.service';\nimport {\n    FormulaEditorManagerService,\n    IFormulaEditorManagerService,\n} from './services/editor/formula-editor-manager.service';\nimport { FormatPainterService, IFormatPainterService } from './services/format-painter/format-painter.service';\nimport { HoverManagerService } from './services/hover-manager.service';\nimport { IMarkSelectionService, MarkSelectionService } from './services/mark-selection/mark-selection.service';\nimport { SheetPermissionPanelModel } from './services/permission/sheet-permission-panel.model';\nimport { SheetPermissionUserManagerService } from './services/permission/sheet-permission-user-list.service';\nimport { SheetPrintInterceptorService } from './services/print-interceptor.service';\nimport { SheetScrollManagerService } from './services/scroll-manager.service';\nimport { SelectAllService } from './services/select-all/select-all.service';\nimport { ISheetSelectionRenderService } from './services/selection/base-selection-render.service';\nimport { SheetSelectionRenderService } from './services/selection/selection-render.service';\nimport { ISheetBarService, SheetBarService } from './services/sheet-bar/sheet-bar.service';\nimport { SheetSkeletonManagerService } from './services/sheet-skeleton-manager.service';\nimport { SheetsRenderService } from './services/sheets-render.service';\nimport { ShortcutExperienceService } from './services/shortcut-experience.service';\nimport { IStatusBarService, StatusBarService } from './services/status-bar.service';\n\n@DependentOn(UniverSheetsPlugin)\nexport class UniverSheetsUIPlugin extends Plugin {\n    static override pluginName = 'SHEET_UI_PLUGIN';\n    static override type = UniverInstanceType.UNIVER_SHEET;\n\n    /** @ignore */\n    constructor(\n        private readonly _config: Partial<IUniverSheetsUIConfig> = defaultPluginConfig,\n        @Inject(Injector) override readonly _injector: Injector,\n        @IRenderManagerService private readonly _renderManagerService: IRenderManagerService,\n        @IConfigService private readonly _configService: IConfigService,\n        @IUniverInstanceService private readonly _univerInstanceService: IUniverInstanceService\n    ) {\n        super();\n\n        // Manage the plugin configuration.\n        const { menu, ...rest } = merge(\n            {},\n            defaultPluginConfig,\n            this._config\n        );\n\n        if (menu) {\n            this._configService.setConfig('menu', menu, { merge: true });\n        }\n\n        this._configService.setConfig(SHEETS_UI_PLUGIN_CONFIG_KEY, rest);\n    }\n\n    override onStarting(): void {\n        registerDependencies(this._injector, mergeOverrideWithDependencies([\n            [ShortcutExperienceService],\n            [IEditorBridgeService, { useClass: EditorBridgeService }],\n            [ISheetClipboardService, { useClass: SheetClipboardService }],\n            [ISheetBarService, { useClass: SheetBarService }],\n            [IFormatPainterService, { useClass: FormatPainterService }],\n            [ICellEditorManagerService, { useClass: CellEditorManagerService }],\n            [IFormulaEditorManagerService, { useClass: FormulaEditorManagerService }],\n            [IRefSelectionsService, { useClass: RefSelectionsService }],\n            [IAutoFillService, { useClass: AutoFillService }],\n            [SheetPrintInterceptorService],\n            [IStatusBarService, { useClass: StatusBarService }],\n            [IMarkSelectionService, { useClass: MarkSelectionService }],\n            [HoverManagerService],\n            [DragManagerService],\n            [SheetCanvasPopManagerService],\n            [CellAlertManagerService],\n            [SelectAllService],\n\n            // controllers\n            [ActiveWorksheetController],\n            [AutoHeightController],\n            [AutoWidthController],\n            [FormulaEditorController],\n            [SheetsRenderService],\n            [SheetUIController],\n            [StatusBarController],\n            [AutoFillController],\n            [FormatPainterController],\n            [SheetsDefinedNameController],\n            [EditorDataSyncController],\n            [SheetCheckboxController],\n\n            // permission\n            [SheetPermissionPanelModel],\n            [SheetPermissionInitUIController],\n            [SheetPermissionUserManagerService],\n            [SheetPermissionInterceptorClipboardController],\n            [SheetPermissionCheckUIController],\n            [SheetPermissionRenderManagerController],\n        ] as Dependency[], this._config.override));\n    }\n\n    override onReady(): void {\n        if (!this._config.disableAutoFocus) {\n            this._initAutoFocus();\n        }\n\n        registerDependencies(this._injector, [\n            [SheetClipboardController],\n        ]);\n\n        this._registerRenderBasics();\n\n        touchDependencies(this._injector, [\n            [SheetUIController],\n            [SheetsRenderService],\n            [ActiveWorksheetController],\n            [SheetPermissionCheckUIController],\n            [SheetPermissionInitUIController],\n        ]);\n    }\n\n    override onRendered(): void {\n        this._registerRenderModules();\n\n        touchDependencies(this._injector, [\n            [SheetPermissionRenderManagerController],\n            [SheetPermissionPanelModel],\n            [SheetClipboardController],\n            [FormulaEditorController],\n            [SheetsDefinedNameController],\n            [StatusBarController],\n            [AutoHeightController],\n            [AutoWidthController],\n            [EditorDataSyncController],\n            [SheetCheckboxController],\n        ]);\n    }\n\n    override onSteady(): void {\n        touchDependencies(this._injector, [\n            [FormatPainterController],\n            [AutoFillController],\n            [SheetPermissionInterceptorClipboardController],\n        ]);\n    }\n\n    private _registerRenderBasics(): void {\n        ([\n            [SheetSkeletonManagerService],\n            [SheetSkeletonRenderController],\n            [SheetRenderController],\n            [ISheetSelectionRenderService, { useClass: SheetSelectionRenderService }],\n        ] as Dependency[]).forEach((m) => {\n            this.disposeWithMe(this._renderManagerService.registerRenderModule(UniverInstanceType.UNIVER_SHEET, m));\n        });\n    }\n\n    // We have to let render basics get bootstrapped before. Because some render controllers relies on\n    // a correct skeleton when they get loaded.\n    private _registerRenderModules(): void {\n        const modules: Dependency[] = [\n            [HeaderMoveRenderController],\n            [HeaderUnhideRenderController],\n            [HeaderResizeRenderController],\n            // Caution: ScrollRenderController should placed before ZoomRenderController.\n            [SheetScrollManagerService],\n            [SheetsScrollRenderController],\n            [HeaderFreezeRenderController],\n            [SheetsZoomRenderController],\n            [SheetCellEditorResizeService],\n\n            [FormatPainterRenderController],\n            [ClipboardRenderController],\n            [CellAlertRenderController],\n            [ForceStringAlertRenderController],\n            [MarkSelectionRenderController],\n            [HoverRenderController],\n            [DragRenderController],\n            [ForceStringRenderController],\n            [CellCustomRenderController],\n            [SheetContextMenuRenderController],\n            [MoveRangeRenderController],\n\n            // editor\n            [EditorBridgeRenderController],\n            [EditingRenderController],\n\n            // permission\n            [SheetPermissionInterceptorCanvasRenderController],\n            [SheetPermissionInterceptorFormulaRenderController],\n            [SheetPermissionRenderController],\n            [WorksheetProtectionRenderController],\n        ];\n\n        // If the context menu is disabled, we don't need to register the context menu render controller.\n        const config = this._configService.getConfig<IUniverUIConfig>(UI_PLUGIN_CONFIG_KEY);\n        const showContextMenu = config?.contextMenu ?? true;\n        if (showContextMenu) {\n            modules.push([HeaderMenuRenderController]);\n        }\n\n        modules.forEach((m) => {\n            this.disposeWithMe(this._renderManagerService.registerRenderModule(UniverInstanceType.UNIVER_SHEET, m));\n        });\n    }\n\n    private _initAutoFocus(): void {\n        const univerInstanceService = this._univerInstanceService;\n        this.disposeWithMe(univerInstanceService.getCurrentTypeOfUnit$<Workbook>(UniverInstanceType.UNIVER_SHEET)\n            .pipe(filter((v) => !!v))\n            .subscribe((workbook) => univerInstanceService.focusUnit(workbook!.getUnitId())));\n    }\n}\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const EMBEDDING_FORMULA_EDITOR = 'embedding_formula_editor';\n\nexport const isEmbeddingFormulaEditor = (unitId: string) => {\n    return unitId.includes(EMBEDDING_FORMULA_EDITOR);\n};\n", "/**\n * Copyright 2023-present DreamNum Co., Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ICellOverGridPosition, ISheetOverGridPosition } from '@univerjs/sheets';\nimport type { ISheetSelectionRenderService } from '../selection/base-selection-render.service';\nimport type { SheetSkeletonManagerService } from '../sheet-skeleton-manager.service';\nimport { precisionTo } from '@univerjs/engine-render';\nimport { attachRangeWithCoord } from '../selection/util';\n\nexport function convertPositionSheetOverGridToAbsolute(unitId: string, subUnitId: string, sheetOverGridPosition: ISheetOverGridPosition, sheetSkeletonManagerService: SheetSkeletonManagerService) {\n    const { from, to } = sheetOverGridPosition;\n\n    const { column: fromColumn, columnOffset: fromColumnOffset, row: fromRow, rowOffset: fromRowOffset } = from;\n    const { column: toColumn, columnOffset: toColumnOffset, row: toRow, rowOffset: toRowOffset } = to;\n\n    const skeleton = sheetSkeletonManagerService.ensureSkeleton(subUnitId);\n\n    if (skeleton == null) {\n        throw new Error('No current skeleton');\n    }\n\n    const startSelectionCell = attachRangeWithCoord(skeleton, {\n        startColumn: fromColumn,\n        endColumn: fromColumn,\n        startRow: fromRow,\n        endRow: fromRow,\n    });\n\n    const endSelectionCell = attachRangeWithCoord(skeleton, {\n        startColumn: toColumn,\n        endColumn: toColumn,\n        startRow: toRow,\n        endRow: toRow,\n    });\n\n    const { startX: startSelectionX, startY: startSelectionY } = startSelectionCell;\n\n    const { startX: endSelectionX, startY: endSelectionY } = endSelectionCell;\n\n    const left = precisionTo(startSelectionX + fromColumnOffset, 1);\n    const top = precisionTo(startSelectionY + fromRowOffset, 1);\n\n    let width = precisionTo(endSelectionX + toColumnOffset - left, 1);\n    let height = precisionTo(endSelectionY + toRowOffset - top, 1);\n\n    if (startSelectionCell.startX === endSelectionCell.endX) {\n        width = 0;\n    }\n\n    if (startSelectionCell.startY === endSelectionCell.endY) {\n        height = 0;\n    }\n\n    return {\n        unitId,\n        subUnitId,\n        left,\n        top,\n        width,\n        height,\n    };\n}\n\nexport function convertPositionCellToSheetOverGrid(unitId: string, subUnitId: string, cellOverGridPosition: ICellOverGridPosition, width: number, height: number, selectionRenderService: ISheetSelectionRenderService, sheetSkeletonManagerService: SheetSkeletonManagerService) {\n    const { column: fromColumn, columnOffset: fromColumnOffset, row: fromRow, rowOffset: fromRowOffset } = cellOverGridPosition;\n\n    const skeleton = sheetSkeletonManagerService.ensureSkeleton(subUnitId);\n\n    if (skeleton == null) {\n        throw new Error('No current skeleton');\n    }\n\n    const startSelectionCell = attachRangeWithCoord(skeleton, {\n        startColumn: fromColumn,\n        endColumn: fromColumn,\n        startRow: fromRow,\n        endRow: fromRow,\n    });\n\n    const { startX: startSelectionX, startY: startSelectionY } = startSelectionCell;\n\n    const left = precisionTo(startSelectionX + fromColumnOffset, 1);\n    const top = precisionTo(startSelectionY + fromRowOffset, 1);\n\n    const endSelectionCell = selectionRenderService.getCellWithCoordByOffset(left + width, top + height, skeleton);\n\n    if (endSelectionCell == null) {\n        throw new Error('No end selection cell');\n    }\n\n    const to = {\n        column: endSelectionCell.actualColumn,\n        columnOffset: precisionTo(left + width - endSelectionCell.startX, 1),\n        row: endSelectionCell.actualRow,\n        rowOffset: precisionTo(top + height - endSelectionCell.startY, 1),\n    };\n\n    return {\n        unitId,\n        subUnitId,\n        sheetTransform: {\n            from: {\n                column: fromColumn,\n                columnOffset: fromColumnOffset,\n                row: fromRow,\n                rowOffset: fromRowOffset,\n            },\n            to,\n        },\n        transform: {\n            left,\n            top,\n            width,\n            height,\n        },\n    };\n}\n"],
  "mappings": "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",
  "names": ["a", "AddWorksheetMergeCommand", "result", "AddWorksheetMergeAllCommand", "AddWorksheetMergeVerticalCommand", "AddWorksheetMergeHorizontalCommand", "scene", "_a", "_b", "primaryWithCoord", "rangeWithCoord", "a", "isChnNumber", "isChnWeek2", "isChnWeek3", "a", "isLoopSeries", "step", "a", "_a", "range", "result", "range", "result", "range", "range", "_a", "a", "result", "range", "primary", "import_jsx_runtime", "import_jsx_runtime", "import_jsx_runtime", "import_jsx_runtime", "import_jsx_runtime", "import_jsx_runtime", "import_jsx_runtime", "import_jsx_runtime", "import_jsx_runtime", "import_jsx_runtime", "import_jsx_runtime", "value", "import_jsx_runtime", "value", "import_react", "import_react", "index_module_default", "import_jsx_runtime", "type", "index_module_default", "import_jsx_runtime", "index_module_default", "import_react", "import_react", "import_react", "import_jsx_runtime", "skeleton", "menu", "visible", "index_module_default", "import_react", "import_jsx_runtime", "workbook", "import_jsx_runtime", "index_module_default", "import_react", "import_react", "index_module_default", "import_jsx_runtime", "index_module_default", "import_react", "import_react", "import_react", "import_jsx_runtime", "import_jsx_runtime", "index_module_default", "index_module_default", "import_jsx_runtime", "index_module_default", "_a", "_b", "_c", "_d", "editDisable", "viewDisable", "a", "import_react", "index_module_default", "index_module_default", "import_jsx_runtime", "index_module_default", "import_react", "import_jsx_runtime", "visible", "import_react", "index_module_default", "import_react", "import_jsx_runtime", "color", "index_module_default", "_a", "_b", "_c", "import_jsx_runtime", "import_react", "_a", "index_module_default", "boxShadow", "visible", "import_jsx_runtime", "index_module_default", "import_react", "func", "index_module_default", "import_jsx_runtime", "index_module_default", "import_jsx_runtime", "statusBarService", "isSingle", "showStatistic", "show", "showList", "items", "_a", "_b", "CopyableStatisticItem", "renderContent", "React", "index_module_default", "import_jsx_runtime", "filter", "style", "value", "_a", "_b", "isRichText", "v", "str", "merge", "contextService", "selection", "item", "_a", "primary", "isBold", "isItalic", "isUnderline", "st", "ha", "va", "ws", "_b", "tr", "AddWorksheetMergeCommand", "AddWorksheetMergeAllCommand", "AddWorksheetMergeVerticalCommand", "AddWorksheetMergeHorizontalCommand", "_", "_a", "contextService", "disableFunction", "AddWorksheetMergeAllCommand", "AddWorksheetMergeCommand", "AddWorksheetMergeHorizontalCommand", "AddWorksheetMergeVerticalCommand", "position", "topLeftCoord", "rightBottomCoord", "index_module_default", "import_jsx_runtime", "index_module_default", "unitId", "permission", "import_react", "index_module_default", "import_jsx_runtime", "index_module_default", "document", "pxToNum", "width", "HIDDEN_EDITOR_POSITION", "HIDDEN_EDITOR_POSITION", "document", "documentDataModel", "docSelectionRenderService", "_a", "AddWorksheetMergeCommand", "_a", "rect", "drawing", "unitId", "import_react", "index_module_default", "import_jsx_runtime", "index_module_default", "menuSchema", "AddWorksheetMergeAllCommand", "AddWorksheetMergeCommand", "AddWorksheetMergeHorizontalCommand", "AddWorksheetMergeVerticalCommand", "menuSchema", "_a", "permissionCheck", "oldFreeze", "_a", "_b", "scene", "_a", "_b", "_c", "_d", "_e", "_f", "transformCoord", "scaleX", "scaleY", "scale", "HEADER_MENU_SHAPE_THUMB_SIZE_SCALE", "_a", "v", "patternInfoRecord", "sheet", "_a", "import_react", "index_module_default", "import_jsx_runtime", "index_module_default", "permissionId", "import_react", "import_jsx_runtime", "workbook", "worksheet", "unitId", "subUnitId", "index_module_default", "import_jsx_runtime", "PermissionDetailUserPart", "index_module_default", "import_react", "import_react", "index_module_default", "import_jsx_runtime", "isCurrentSheet", "_a", "unitId", "ruleList", "index_module_default", "import_jsx_runtime", "import_react", "index_module_default", "import_jsx_runtime", "index_module_default", "index_module_default", "import_jsx_runtime", "collaborators", "workbook", "worksheet", "index_module_default", "import_react", "index_module_default", "import_jsx_runtime", "_a", "index_module_default", "_b", "index_module_default", "import_jsx_runtime", "index_module_default", "EXTENSION_CAN_VIEW_Z_INDEX", "EXTENSION_CAN_NOT_VIEW_Z_INDEX", "import_react", "import_jsx_runtime", "selectUserList", "index_module_default", "_a", "_b", "_a", "SHEET_NAVIGATION_COMMANDS", "a", "merge", "_a", "merge", "startRow", "startColumn", "endRow", "endColumn", "render", "_a", "_b", "_c", "_a"]
}
