"use strict";(self.webpackChunk_univerjs_storybook=self.webpackChunk_univerjs_storybook||[]).push([[1976],{"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/docs-ui/src/components/list-type-picker/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-doc-list-type-picker {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  flex-wrap: wrap;\n  padding: var(--padding-sm);\n  width: 240px;\n  margin-bottom: -var(--margin-xs);\n}\n.univer-doc-list-type-picker-item {\n  width: 72px;\n  height: 81px;\n  border-radius: 4px;\n  border: 1px solid rgb(var(--border-color));\n  margin-bottom: var(--margin-xs);\n}\n.univer-doc-list-type-picker-item:hover {\n  border: 1px solid rgb(var(--blue-400));\n}\n.univer-doc-list-type-picker-item-active {\n  border: 1px solid rgb(var(--blue-400));\n}\n","",{version:3,sources:["webpack://./../../packages/docs-ui/src/components/list-type-picker/index.module.less"],names:[],mappings:"AAAA;EACI,aAAA;EACA,mBAAA;EACA,8BAAA;EACA,eAAA;EACA,0BAAA;EACA,YAAA;EACA,gCAAA;AACJ;AAEA;EACI,WAAA;EACA,YAAA;EACA,kBAAA;EACA,0CAAA;EACA,+BAAA;AAAJ;AAGA;EACI,sCAAA;AADJ;AAIA;EACI,sCAAA;AAFJ",sourcesContent:[".doc-list-type-picker {\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n    flex-wrap: wrap;\n    padding: var(--padding-sm);\n    width: 240px;\n    margin-bottom: -var(--margin-xs);\n}\n\n.doc-list-type-picker-item {\n    width: 72px;\n    height: 81px;\n    border-radius: 4px;\n    border: 1px solid rgb(var(--border-color));\n    margin-bottom: var(--margin-xs);\n}\n\n.doc-list-type-picker-item:hover {\n    border: 1px solid rgb(var(--blue-400));\n}\n\n.doc-list-type-picker-item-active {\n    border: 1px solid rgb(var(--blue-400));\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={docListTypePicker:"univer-doc-list-type-picker",docListTypePickerItem:"univer-doc-list-type-picker-item",docListTypePickerItemActive:"univer-doc-list-type-picker-item-active"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/docs-ui/src/views/header-footer/panel/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-panel {\n  padding-top: 20px;\n  font-size: var(--font-size-sm);\n}\n.univer-options-section {\n  margin-top: 10px;\n  padding-bottom: 10px;\n}\n.univer-options-form-item {\n  display: block;\n  margin-bottom: 5px;\n}\n.univer-options-input {\n  width: 80%;\n  margin-top: 5px;\n}\n.univer-options-margin-setting {\n  display: flex;\n}\n","",{version:3,sources:["webpack://./../../packages/docs-ui/src/views/header-footer/panel/index.module.less"],names:[],mappings:"AAAA;EACI,iBAAA;EACA,8BAAA;AACJ;AAGI;EACI,gBAAA;EACA,oBAAA;AADR;AAII;EACI,cAAA;EACA,kBAAA;AAFR;AAKI;EACI,UAAA;EACA,eAAA;AAHR;AAMI;EACI,aAAA;AAJR",sourcesContent:[".panel {\n    padding-top: 20px;\n    font-size: var(--font-size-sm);\n}\n\n.options {\n    &-section {\n        margin-top: 10px;\n        padding-bottom: 10px;\n    }\n\n    &-form-item {\n        display: block;\n        margin-bottom: 5px;\n    }\n\n    &-input {\n        width: 80%;\n        margin-top: 5px;\n    }\n\n    &-margin-setting {\n        display: flex;\n    }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={panel:"univer-panel",optionsSection:"univer-options-section",optionsFormItem:"univer-options-form-item",optionsInput:"univer-options-input",optionsMarginSetting:"univer-options-margin-setting"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/docs-ui/src/views/paragraph-setting/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-paragraph-setting-icon-list {\n  display: flex;\n  width: 100%;\n  padding: 4px;\n  align-items: center;\n  gap: 4px;\n  justify-content: space-between;\n  border: 1px solid var(---Grey-200, #e5e5e5);\n  border-radius: var(--radius-m, 6px);\n}\n.univer-paragraph-setting-icon-list-item {\n  padding: 4px 14px;\n  border-radius: 4px;\n  background: none;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n}\n.univer-paragraph-setting-icon-list-item:hover {\n  background: var(--black-6, rgba(30, 34, 43, 0.06));\n}\n.univer-paragraph-setting-icon-list-item.univer-paragraph-setting-icon-list-active {\n  background: var(--black-9, rgba(30, 34, 43, 0.09));\n}\n.univer-paragraph-setting-title {\n  margin-top: var(--margin-base);\n  font-size: 13px;\n  color: #1e222b;\n  font-weight: 500;\n}\n.univer-paragraph-setting-label {\n  font-size: 12px;\n  margin-top: var(--margin-sm);\n  color: #1e222b;\n  font-weight: 400;\n}\n.univer-paragraph-setting-mt-base {\n  margin-top: var(--margin-base);\n}\n.univer-paragraph-setting-flex-col {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.univer-paragraph-setting-space-line {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n","",{version:3,sources:["webpack://./../../packages/docs-ui/src/views/paragraph-setting/index.module.less"],names:[],mappings:"AACI;EACI,aAAA;EACA,WAAA;EACA,YAAA;EACA,mBAAA;EACA,QAAA;EACA,8BAAA;EACA,2CAAA;EACA,mCAAA;AAAR;AAEQ;EACI,iBAAA;EACA,kBAAA;EACA,gBAAA;EACA,aAAA;EACA,uBAAA;EACA,mBAAA;EACA,eAAA;AAAZ;AAEY;EACI,kDAAA;AAAhB;AAIQ;EACI,kDAAA;AAFZ;AAMI;EACI,8BAAA;EACA,eAAA;EACA,cAAA;EACA,gBAAA;AAJR;AAOI;EACI,eAAA;EACA,4BAAA;EACA,cAAA;EACA,gBAAA;AALR;AAQI;EACI,8BAAA;AANR;AASI;EACI,aAAA;EACA,8BAAA;EACA,mBAAA;AAPR;AAUI;EACI,aAAA;EACA,sBAAA;EACA,QAAA;AARR",sourcesContent:[".paragraph-setting {\n    &-icon-list {\n        display: flex;\n        width: 100%;\n        padding: 4px;\n        align-items: center;\n        gap: 4px;\n        justify-content: space-between;\n        border: 1px solid var(---Grey-200, #e5e5e5);\n        border-radius: var(--radius-m, 6px);\n\n        &-item {\n            padding: 4px 14px;\n            border-radius: 4px;\n            background: none;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            cursor: pointer;\n\n            &:hover {\n                background: var(--black-6, rgba(30, 34, 43, 0.06));\n            }\n        }\n\n        &-item&-active {\n            background: var(--black-9, rgba(30, 34, 43, 0.09));\n        }\n    }\n\n    &-title {\n        margin-top: var(--margin-base);\n        font-size: 13px;\n        color: #1e222b;\n        font-weight: 500;\n    }\n\n    &-label {\n        font-size: 12px;\n        margin-top: var(--margin-sm);\n        color: #1e222b;\n        font-weight: 400;\n    }\n\n    &-mt-base {\n        margin-top: var(--margin-base);\n    }\n\n    &-flex-col {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n    }\n\n    &-space-line {\n        display: flex;\n        flex-direction: column;\n        gap: 6px;\n    }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={paragraphSettingIconList:"univer-paragraph-setting-icon-list",paragraphSettingIconListItem:"univer-paragraph-setting-icon-list-item",paragraphSettingIconListActive:"univer-paragraph-setting-icon-list-active",paragraphSettingTitle:"univer-paragraph-setting-title",paragraphSettingLabel:"univer-paragraph-setting-label",paragraphSettingMtBase:"univer-paragraph-setting-mt-base",paragraphSettingFlexCol:"univer-paragraph-setting-flex-col",paragraphSettingSpaceLine:"univer-paragraph-setting-space-line"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../packages/docs-ui/src/basics/component-tools.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ce:()=>neoGetDocObject,qS:()=>getDocObject});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_docs_view_key__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs-ui/src/basics/docs-view-key.ts");function neoGetDocObject(renderContext){const{mainComponent,scene,engine,components}=renderContext;return{document:mainComponent,docBackground:components.get(_docs_view_key__WEBPACK_IMPORTED_MODULE_1__.C9.BACKGROUND),scene,engine}}function getDocObject(univerInstanceService,renderManagerService){const documentModel=univerInstanceService.getCurrentUnitForType(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC);if(!documentModel)return null;const unitId=documentModel.getUnitId(),currentRender=renderManagerService.getRenderById(unitId);if(null==currentRender)return;const{mainComponent,scene,engine,components}=currentRender;return{document:mainComponent,docBackground:components.get(_docs_view_key__WEBPACK_IMPORTED_MODULE_1__.C9.BACKGROUND),scene,engine}}},"../../packages/docs-ui/src/basics/docs-view-key.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C9:()=>DOCS_VIEW_KEY,S5:()=>DOCS_COMPONENT_BACKGROUND_LAYER_INDEX,_J:()=>DOCS_COMPONENT_DEFAULT_Z_INDEX,hl:()=>VIEWPORT_KEY,lN:()=>DOCS_COMPONENT_MAIN_LAYER_INDEX,th:()=>DOCS_COMPONENT_HEADER_LAYER_INDEX});var DOCS_VIEW_KEY=function(DOCS_VIEW_KEY){return DOCS_VIEW_KEY.MAIN="__Document_Render_Main__",DOCS_VIEW_KEY.BACKGROUND="__Document_Render_Background__",DOCS_VIEW_KEY}({}),VIEWPORT_KEY=function(VIEWPORT_KEY){return VIEWPORT_KEY.VIEW_MAIN="viewMain",VIEWPORT_KEY.VIEW_TOP="viewTop",VIEWPORT_KEY.VIEW_LEFT="viewLeft",VIEWPORT_KEY.VIEW_LEFT_TOP="viewLeftTop",VIEWPORT_KEY}({});const DOCS_COMPONENT_BACKGROUND_LAYER_INDEX=0,DOCS_COMPONENT_MAIN_LAYER_INDEX=2,DOCS_COMPONENT_HEADER_LAYER_INDEX=4,DOCS_COMPONENT_DEFAULT_Z_INDEX=10},"../../packages/docs-ui/src/basics/paragraph.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function getTextRunAtPosition(body,position,defaultStyle,cacheStyle,isCellEditor){const{textRuns=[],dataStream}=body,retTextRun={st:0,ed:0,ts:isCellEditor?{}:defaultStyle};if(isCellEditor&&dataStream.startsWith("="))return retTextRun;for(let i=textRuns.length-1;i>=0;i--){const textRun=textRuns[i],{st,ed}=textRun;position>st&&position<=ed&&(retTextRun.st=st,retTextRun.ed=ed,retTextRun.ts={...retTextRun.ts,...textRun.ts})}if(0===position){const textRun=textRuns?.[0];textRun&&0===textRun.st&&(retTextRun.ts={...retTextRun.ts,...textRun.ts})}return cacheStyle&&(retTextRun.ts={...retTextRun.ts,...cacheStyle}),retTextRun}function getCustomRangeAtPosition(customRanges,position,extendRange){if(extendRange){const range=customRanges.find((customRange=>position>=customRange.startIndex&&position<=customRange.endIndex+1));return range?.wholeEntity?null:range}const range=customRanges.find((customRange=>position>customRange.startIndex&&position<=customRange.endIndex));return range?.wholeEntity?null:range}function getCustomDecorationAtPosition(customDecorations,position){return customDecorations.filter((customDecoration=>position>customDecoration.startIndex&&position<=customDecoration.endIndex))}__webpack_require__.d(__webpack_exports__,{Nn:()=>getCustomRangeAtPosition,nM:()=>getTextRunAtPosition,yo:()=>getCustomDecorationAtPosition})},"../../packages/docs-ui/src/basics/selection.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{X:()=>findFirstCursorOffset});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts");function findFirstCursorOffset(snapshot){const{dataStream}=snapshot.body??{},EXCLUDE_TOKENS=[_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.TABLE_START,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.TABLE_CELL_END,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.TABLE_CELL_START,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.TABLE_END,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.TABLE_ROW_END,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.TABLE_ROW_START,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.COLUMN_BREAK,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.PAGE_BREAK,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.TAB,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.DOCS_END,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.CUSTOM_BLOCK];if("string"==typeof dataStream)for(let i=0;i<dataStream.length;i++){const char=dataStream[i];if(!EXCLUDE_TOKENS.includes(char))return i}return 0}},"../../packages/docs-ui/src/commands/commands/break-line.command.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{X:()=>generateParagraphs,Z:()=>BreakLineCommand});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs/src/index.ts"),_basics_paragraph__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../packages/docs-ui/src/basics/paragraph.ts"),_services_doc_menu_style_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/docs-ui/src/services/doc-menu-style.service.ts"),_core_editing_command__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/docs-ui/src/commands/commands/core-editing.command.ts"),_list_command__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../packages/docs-ui/src/commands/commands/list.command.ts");function generateParagraphs(dataStream,prevParagraph,borderBottom){const paragraphs=[];for(let i=0,len=dataStream.length;i<len;i++){dataStream[i]===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.PARAGRAPH&&paragraphs.push({startIndex:i})}if(prevParagraph)for(const paragraph of paragraphs)prevParagraph.bullet&&(paragraph.bullet=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.deepClone(prevParagraph.bullet)),prevParagraph.paragraphStyle&&(paragraph.paragraphStyle=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.deepClone(prevParagraph.paragraphStyle),delete paragraph.paragraphStyle.borderBottom);if(borderBottom)for(const paragraph of paragraphs)paragraph.paragraphStyle||(paragraph.paragraphStyle={}),paragraph.paragraphStyle.borderBottom=borderBottom;return paragraphs}const BreakLineCommand={id:"doc.command.break-line",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>{const docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),docMenuStyleService=accessor.get(_services_doc_menu_style_service__WEBPACK_IMPORTED_MODULE_2__._),activeTextRange=docSelectionManagerService.getActiveTextRange(),rectRanges=docSelectionManagerService.getRectRanges();if(null==activeTextRange)return!1;if(rectRanges&&rectRanges.length){const{startOffset}=activeTextRange;return docSelectionManagerService.replaceDocRanges([{startOffset,endOffset:startOffset}]),!0}const{horizontalLine}=params??{},{segmentId}=activeTextRange,docDataModel=univerInstanceService.getCurrentUnitForType(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC),body=docDataModel?.getSelfOrHeaderFooterModel(segmentId??"").getBody();if(null==docDataModel||null==body)return!1;const unitId=docDataModel.getUnitId(),{startOffset,endOffset}=activeTextRange,prevParagraph=(body.paragraphs??[]).find((p=>p.startIndex>=startOffset));if(!prevParagraph)return!1;const prevParagraphIndex=prevParagraph.startIndex,defaultTextStyle=docMenuStyleService.getDefaultStyle(),styleCache=docMenuStyleService.getStyleCache(),curTextRun=(0,_basics_paragraph__WEBPACK_IMPORTED_MODULE_5__.nM)(body,endOffset,defaultTextStyle,styleCache),insertBody={dataStream:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.PARAGRAPH,paragraphs:generateParagraphs(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.PARAGRAPH,prevParagraph,horizontalLine),textRuns:[{st:0,ed:1,ts:{...curTextRun.ts}}]},deleteRange={startOffset,endOffset,collapsed:startOffset===endOffset},result=await commandService.executeCommand(_core_editing_command__WEBPACK_IMPORTED_MODULE_3__.TX.id,{unitId,body:insertBody,range:deleteRange,segmentId});if(prevParagraph.bullet?.listType===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.yrS.CHECK_LIST_CHECKED){const params={index:prevParagraphIndex+1-(endOffset-startOffset),segmentId,textRanges:[{startOffset:startOffset+1,endOffset:startOffset+1}]},toggleCheckListResult=await commandService.executeCommand(_list_command__WEBPACK_IMPORTED_MODULE_4__.y6.id,params);return Boolean(toggleCheckListResult)&&result}return result}}},"../../packages/docs-ui/src/commands/commands/clipboard.command.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{P1:()=>DocCopyCommand,rZ:()=>DocPasteCommand,xc:()=>whenDocOrEditor,ye:()=>DocCutCommand});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/ui/src/index.ts"),_services_clipboard_clipboard_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/docs-ui/src/services/clipboard/clipboard.service.ts");function whenDocOrEditor(contextService){return contextService.getContextValue(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.y0c)||contextService.getContextValue(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.AF$)}const DocCopyCommand={id:_univerjs_ui__WEBPACK_IMPORTED_MODULE_1__.HP.id,name:"doc.command.copy",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,multi:!0,priority:999,preconditions:whenDocOrEditor,handler:async accessor=>accessor.get(_services_clipboard_clipboard_service__WEBPACK_IMPORTED_MODULE_2__.v).copy()},DocCutCommand={id:_univerjs_ui__WEBPACK_IMPORTED_MODULE_1__.AP.id,name:"doc.command.cut",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,multi:!0,priority:999,preconditions:whenDocOrEditor,handler:async accessor=>accessor.get(_services_clipboard_clipboard_service__WEBPACK_IMPORTED_MODULE_2__.v).cut()},DocPasteCommand={id:_univerjs_ui__WEBPACK_IMPORTED_MODULE_1__.Fw.id,name:"doc.command.paste",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,multi:!0,priority:999,preconditions:whenDocOrEditor,handler:async accessor=>{const docClipboardService=accessor.get(_services_clipboard_clipboard_service__WEBPACK_IMPORTED_MODULE_2__.v),clipboardInterfaceService=accessor.get(_univerjs_ui__WEBPACK_IMPORTED_MODULE_1__.O),clipboardItems=await clipboardInterfaceService.read();return 0!==clipboardItems.length&&docClipboardService.paste(clipboardItems)}}},"../../packages/docs-ui/src/commands/commands/clipboard.inner.command.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{J1:()=>InnerPasteCommand,J2:()=>CutContentCommand});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs/src/index.ts"),_basics_paragraph__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../packages/docs-ui/src/basics/paragraph.ts"),_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/docs-ui/src/commands/util.ts"),_table_table__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/docs-ui/src/commands/commands/table/table.ts");const UNITS=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__._aE,InnerPasteCommand={id:"doc.command.inner-paste",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>{const{segmentId,textRanges,doc}=params,commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),selections=docSelectionManagerService.getTextRanges(),rectRanges=docSelectionManagerService.getRectRanges(),{body,tableSource,drawings}=doc;if(!Array.isArray(selections)||0===selections.length||null==body)return!1;const docDataModel=univerInstanceService.getCurrentUniverDocInstance(),originBody=docDataModel?.getSelfOrHeaderFooterModel(segmentId).getBody();if(null==docDataModel||null==originBody)return!1;const unitId=docDataModel.getUnitId(),doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges,segmentId}},memoryCursor=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OsL;memoryCursor.reset();const textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),rawActions=[],hasTable=!!body.tables?.length,hasCustomBlock=!!body.customBlocks?.length;if(hasTable&&segmentId)return!1;if(hasTable&&function hasRangeInTable(ranges){return ranges.some((range=>{const{startNodePosition}=range;return!!startNodePosition&&startNodePosition?.path.indexOf("cells")>-1}))}(selections))return!1;if(selections.length&&rectRanges?.length)return!1;for(let i=0;i<selections.length;i++){const selection=selections[i],{startOffset,endOffset,collapsed}=selection,len=startOffset-memoryCursor.cursor,cloneBody=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.deepClone(body);if(hasTable)for(const t of cloneBody.tables){const{tableId:oldTableId}=t,tableId=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.generateRandomId(6);t.tableId=tableId;const table=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.deepClone(tableSource[oldTableId]);table.tableId=tableId;const action=jsonX.insertOp(["tableSource",tableId],table);rawActions.push(action)}if(hasCustomBlock&&drawings){const drawingLen=docDataModel.getSnapshot().drawingsOrder?.length??0;for(const block of cloneBody.customBlocks){const{blockId}=block,drawingId=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.generateRandomId(6);block.blockId=drawingId;const drawing=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.deepClone(drawings[blockId]);drawing.drawingId=drawingId;const action=jsonX.insertOp(["drawings",drawingId],drawing),orderAction=jsonX.insertOp(["drawingsOrder",drawingLen],drawingId);rawActions.push(action),rawActions.push(orderAction)}}const customRange=(0,_basics_paragraph__WEBPACK_IMPORTED_MODULE_4__.Nn)(originBody.customRanges??[],endOffset,UNITS.includes(unitId)),customDecorations=(0,_basics_paragraph__WEBPACK_IMPORTED_MODULE_4__.yo)(originBody.customDecorations??[],endOffset);if(customRange&&(cloneBody.customRanges=[{...customRange,startIndex:0,endIndex:body.dataStream.length-1}]),customDecorations.length&&(cloneBody.customDecorations=customDecorations.map((customDecoration=>({...customDecoration,startIndex:0,endIndex:body.dataStream.length-1})))),collapsed)textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len}),textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.INSERT,body:cloneBody,len:body.dataStream.length});else{const dos=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Z4q.selection.delete([selection],body,memoryCursor.cursor,cloneBody,1===selections.length);textX.push(...dos)}memoryCursor.reset(),memoryCursor.moveCursor(endOffset)}const path=(0,_util__WEBPACK_IMPORTED_MODULE_2__.J)(docDataModel,segmentId);rawActions.push(jsonX.editOp(textX.serialize(),path)),doMutation.params.actions=rawActions.reduce(((acc,cur)=>_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.compose(acc,cur)),null);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}};function adjustSelectionByTable(selection,tables){const{startOffset,endOffset}=selection,endsWithTable=tables.some((t=>t.startIndex===endOffset)),newEndOffset=Math.max(startOffset,endsWithTable?endOffset-1:endOffset);return{...selection,endOffset:newEndOffset,collapsed:startOffset===newEndOffset}}function getCutActionsFromDocRanges(textRanges,rectRanges,docDataModel,viewModel,segmentId){let rawActions=[];if(Array.isArray(textRanges)&&0!==textRanges?.length&&(rawActions=function getCutActionsFromTextRanges(selections,docDataModel,segmentId){const originBody=docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody(),textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),rawActions=[];if(null==originBody)return rawActions;const{tables=[]}=originBody,memoryCursor=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OsL;memoryCursor.reset();for(let i=0;i<selections.length;i++){const selection=adjustSelectionByTable(selections[i],tables),{startOffset,endOffset,collapsed}=selection,len=startOffset-memoryCursor.cursor;collapsed?textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len}):textX.push(..._univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Z4q.selection.delete([selection],originBody,memoryCursor.cursor,null,!1)),memoryCursor.reset(),memoryCursor.moveCursor(endOffset)}const path=(0,_util__WEBPACK_IMPORTED_MODULE_2__.J)(docDataModel,segmentId);rawActions.push(jsonX.editOp(textX.serialize(),path));const removedCustomBlockIds=function getCustomBlockIdsInSelections(body,selections){const customBlockIds=[],{customBlocks=[]}=body;for(const selection of selections){const{startOffset,endOffset}=selection;if(null!=startOffset&&null!=endOffset)for(const customBlock of customBlocks){const{startIndex}=customBlock;startIndex>=startOffset&&startIndex<endOffset&&customBlockIds.push(customBlock.blockId)}}return customBlockIds}(originBody,selections),drawings=docDataModel.getDrawings()??{},drawingOrder=docDataModel.getDrawingsOrder()??[],sortedRemovedCustomBlockIds=removedCustomBlockIds.sort(((a,b)=>drawingOrder.indexOf(a)>drawingOrder.indexOf(b)?-1:drawingOrder.indexOf(a)<drawingOrder.indexOf(b)?1:0));if(sortedRemovedCustomBlockIds.length>0)for(const blockId of sortedRemovedCustomBlockIds){const drawing=drawings[blockId],drawingIndex=drawingOrder.indexOf(blockId);if(null==drawing||drawingIndex<0)continue;const removeDrawingAction=jsonX.removeOp(["drawings",blockId],drawing),removeDrawingOrderAction=jsonX.removeOp(["drawingsOrder",drawingIndex],blockId);rawActions.push(removeDrawingAction),rawActions.push(removeDrawingOrderAction)}return rawActions.reduce(((acc,cur)=>_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.compose(acc,cur)),null)}(textRanges,docDataModel,segmentId)),Array.isArray(rectRanges)&&0!==rectRanges?.length){const actions=function getCutActionsFromRectRanges(ranges,docDataModel,viewModel,segmentId){const rawActions=[];if(null==docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody())return rawActions;const textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),memoryCursor=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OsL;memoryCursor.reset();for(const range of ranges){const{startOffset,endOffset,spanEntireRow,spanEntireTable}=range;if(null!=startOffset&&null!=endOffset)if(spanEntireTable){const actionParams=(0,_table_table__WEBPACK_IMPORTED_MODULE_3__.Co)({startOffset,endOffset,segmentId},viewModel);if(null==actionParams)continue;const{offset,len,tableId}=actionParams;offset-memoryCursor.cursor>0&&textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:offset-memoryCursor.cursor}),textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.DELETE,len});const action=jsonX.removeOp(["tableSource",tableId]);rawActions.push(action),memoryCursor.moveCursorTo(offset+len)}else if(spanEntireRow){const actionParams=(0,_table_table__WEBPACK_IMPORTED_MODULE_3__.cC)({startOffset,endOffset,segmentId},viewModel);if(null==actionParams)continue;const{offset,rowIndexes,len,tableId}=actionParams;offset-memoryCursor.cursor>0&&textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:offset-memoryCursor.cursor}),textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.DELETE,len});for(const index of rowIndexes.reverse()){const action=jsonX.removeOp(["tableSource",tableId,"tableRows",index]);rawActions.push(action)}memoryCursor.moveCursorTo(offset+len)}else{const actionParams=(0,_table_table__WEBPACK_IMPORTED_MODULE_3__.nx)({startOffset,endOffset,segmentId},viewModel);if(null==actionParams)continue;const{offsets}=actionParams;for(const offset of offsets){const{retain,delete:delLen}=offset;retain-memoryCursor.cursor>0&&textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:retain-memoryCursor.cursor}),textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.DELETE,len:delLen}),memoryCursor.moveCursorTo(retain+delLen)}}}const path=(0,_util__WEBPACK_IMPORTED_MODULE_2__.J)(docDataModel,segmentId);return rawActions.push(jsonX.editOp(textX.serialize(),path)),rawActions.reduce(((acc,cur)=>_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.compose(acc,cur)),null)}(rectRanges,docDataModel,viewModel,segmentId);rawActions=null==rawActions||0===rawActions.length?actions:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.compose(rawActions,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.transform(actions,rawActions,"right"))}return rawActions}const CutContentCommand={id:"doc.command.inner-cut",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:(accessor,params)=>{const docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),{segmentId,textRanges,selections=docSelectionManagerService.getTextRanges()}=params,rectRanges=docSelectionManagerService.getRectRanges();if(!(Array.isArray(selections)&&0!==selections.length||Array.isArray(rectRanges)&&0!==rectRanges.length))return!1;const unitId=univerInstanceService.getCurrentUniverDocInstance()?.getUnitId();if(!unitId)return!1;const docDataModel=univerInstanceService.getUniverDocInstance(unitId);if(null==docDataModel)return!1;const docSkeletonManagerService=(0,_util__WEBPACK_IMPORTED_MODULE_2__.R)(accessor,unitId);if(null==docSkeletonManagerService)return!1;const viewModel=docSkeletonManagerService.getViewModel(),doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges}};doMutation.params.actions=getCutActionsFromDocRanges(selections,rectRanges,docDataModel,viewModel,segmentId);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}}},"../../packages/docs-ui/src/commands/commands/core-editing.command.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Rj:()=>DeleteCommand,TX:()=>InsertCommand,fR:()=>UpdateCommand});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs/src/index.ts"),_types_delete_direction__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/docs-ui/src/types/delete-direction.ts"),_util__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/docs-ui/src/commands/util.ts");const InsertCommand={id:"doc.command.insert-text",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>{const commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),{range,segmentId,body,unitId,cursorOffset}=params,docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),docDataModel=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr).getUnit(unitId,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC);if(null==docDataModel)return!1;const activeRange=docSelectionManagerService.getActiveTextRange(),originBody=docDataModel.getSelfOrHeaderFooterModel(activeRange?.segmentId??"").getBody();if(null==originBody)return!1;const{startOffset,collapsed}=range,cursorMove=cursorOffset??body.dataStream.length,textRanges=[{startOffset:startOffset+cursorMove,endOffset:startOffset+cursorMove,style:activeRange?.style,collapsed}],doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges,debounce:!0}},textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance();if(collapsed)startOffset>0&&textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:startOffset}),textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.INSERT,body,len:body.dataStream.length});else{const dos=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Z4q.selection.delete([range],originBody,0,body);textX.push(...dos)}doMutation.params.textRanges=[{startOffset:startOffset+cursorMove,endOffset:startOffset+cursorMove,collapsed}];const path=(0,_util__WEBPACK_IMPORTED_MODULE_3__.J)(docDataModel,segmentId);doMutation.params.actions=jsonX.editOp(textX.serialize(),path);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}},DeleteCommand={id:"doc.command.delete-text",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>{const commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),{range,segmentId,unitId,direction,len=1}=params,docDataModel=univerInstanceService.getUnit(unitId,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC),body=docDataModel?.getSelfOrHeaderFooterModel(segmentId).getBody();if(null==docDataModel||null==body)return!1;const{startOffset}=range;let start=direction===_types_delete_direction__WEBPACK_IMPORTED_MODULE_2__.b.LEFT?startOffset-len:startOffset,end=direction===_types_delete_direction__WEBPACK_IMPORTED_MODULE_2__.b.LEFT?startOffset-1:startOffset+len-1;const customRange=body.customRanges?.find((customRange=>customRange.startIndex<=start&&customRange.endIndex>=end));customRange?.wholeEntity&&(start=customRange.startIndex,end=Math.max(end,customRange.endIndex));const doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges:[{startOffset:start,endOffset:start,collapsed:!0}],debounce:!0}},textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance();textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:start-0}),textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.DELETE,len:end-start+1});const path=(0,_util__WEBPACK_IMPORTED_MODULE_3__.J)(docDataModel,segmentId);doMutation.params.actions=jsonX.editOp(textX.serialize(),path);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}},UpdateCommand={id:"doc.command.update-text",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>{const{range,segmentId,updateBody,coverType,unitId,textRanges}=params,commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),docDataModel=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr).getCurrentUniverDocInstance();if(null==docDataModel)return!1;const doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges}},textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),{startOffset,endOffset}=range;textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:startOffset}),textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,body:updateBody,len:endOffset-startOffset,coverType});const path=(0,_util__WEBPACK_IMPORTED_MODULE_3__.J)(docDataModel,segmentId);doMutation.params.actions=jsonX.editOp(textX.serialize(),path);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}}},"../../packages/docs-ui/src/commands/commands/doc-delete.command.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{AD:()=>MergeTwoParagraphCommand,DK:()=>DeleteCustomBlockCommand,H7:()=>DeleteRightCommand,_E:()=>RemoveHorizontalLineCommand,iM:()=>DeleteLeftCommand,yl:()=>getCursorWhenDelete});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs/src/index.ts"),_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/engine-render/src/index.ts"),_types_delete_direction__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/docs-ui/src/types/delete-direction.ts"),_util__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../packages/docs-ui/src/commands/util.ts"),_clipboard_inner_command__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../packages/docs-ui/src/commands/commands/clipboard.inner.command.ts"),_core_editing_command__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../packages/docs-ui/src/commands/commands/core-editing.command.ts");const DeleteCustomBlockCommand={id:"doc.command.delete-custom-block",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>{const docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),activeRange=docSelectionManagerService.getActiveTextRange(),documentDataModel=univerInstanceService.getCurrentUniverDocInstance();if(null==activeRange||null==documentDataModel)return!1;const{direction,range,unitId,drawingId}=params,{startOffset,segmentId,style}=activeRange,cursor=direction===_types_delete_direction__WEBPACK_IMPORTED_MODULE_3__.b.LEFT?startOffset-1:startOffset,textRanges=[{startOffset:cursor,endOffset:cursor,style}],doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges,prevTextRanges:[range]}},textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),rawActions=[];startOffset>0&&textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:direction===_types_delete_direction__WEBPACK_IMPORTED_MODULE_3__.b.LEFT?startOffset-1:startOffset}),textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.DELETE,len:1});const path=(0,_util__WEBPACK_IMPORTED_MODULE_4__.J)(documentDataModel,segmentId);rawActions.push(jsonX.editOp(textX.serialize(),path));const drawing=(documentDataModel.getDrawings()??{})[drawingId],drawingIndex=documentDataModel.getDrawingsOrder().indexOf(drawingId),removeDrawingAction=jsonX.removeOp(["drawings",drawingId],drawing),removeDrawingOrderAction=jsonX.removeOp(["drawingsOrder",drawingIndex],drawingId);rawActions.push(removeDrawingAction),rawActions.push(removeDrawingOrderAction),doMutation.params.actions=rawActions.reduce(((acc,cur)=>_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.compose(acc,cur)),null);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}},MergeTwoParagraphCommand={id:"doc.command.merge-two-paragraph",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>{const docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),{direction,range}=params,activeRange=docSelectionManagerService.getActiveTextRange(),ranges=docSelectionManagerService.getTextRanges();if(null==activeRange||null==ranges)return!1;const{segmentId,style}=activeRange,docDataModel=univerInstanceService.getCurrentUnitForType(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC),originBody=docDataModel?.getSelfOrHeaderFooterModel(segmentId).getBody();if(null==docDataModel||null==originBody)return!1;const actualRange=activeRange,unitId=docDataModel.getUnitId(),{startOffset,collapsed}=actualRange;if(!collapsed)return!1;const startIndex=direction===_types_delete_direction__WEBPACK_IMPORTED_MODULE_3__.b.LEFT?startOffset:startOffset+1;let curParagraph,nextParagraph;for(const paragraph of originBody.paragraphs){if(paragraph.startIndex>=startIndex){nextParagraph=paragraph;break}curParagraph=paragraph}if(null==curParagraph||null==nextParagraph)return!1;const cursor=direction===_types_delete_direction__WEBPACK_IMPORTED_MODULE_3__.b.LEFT?startOffset-1:startOffset,textRanges=[{startOffset:cursor,endOffset:cursor,style}],doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges,prevTextRanges:[range]}},textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance();curParagraph.startIndex>0&&textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:curParagraph.startIndex}),textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.DELETE,len:1}),nextParagraph.startIndex>curParagraph.startIndex+1&&textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:nextParagraph.startIndex-curParagraph.startIndex-1}),textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:1,coverType:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.fXF.REPLACE,body:{dataStream:"",paragraphs:[{..._univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.deepClone(curParagraph),startIndex:0}]}});const path=(0,_util__WEBPACK_IMPORTED_MODULE_4__.J)(docDataModel,segmentId);doMutation.params.actions=jsonX.editOp(textX.serialize(),path);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}},RemoveHorizontalLineCommand={id:"doc.command.remove-horizontal-line",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async accessor=>{const docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),activeRange=docSelectionManagerService.getActiveTextRange(),ranges=docSelectionManagerService.getTextRanges();if(null==activeRange||null==ranges)return!1;const{segmentId,style}=activeRange,docDataModel=univerInstanceService.getCurrentUnitForType(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC),originBody=docDataModel?.getSelfOrHeaderFooterModel(segmentId).getBody();if(null==docDataModel||null==originBody)return!1;const actualRange=activeRange,unitId=docDataModel.getUnitId(),{startOffset,collapsed}=actualRange;if(!collapsed)return!1;const paragraph=originBody.paragraphs?.find((p=>p.startIndex===startOffset-1));if(null==paragraph)return!1;const textRanges=[{startOffset,endOffset:startOffset,style}],doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges}},textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance();paragraph.startIndex>0&&textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:paragraph.startIndex}),textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:1,coverType:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.fXF.REPLACE,body:{dataStream:"",paragraphs:[{..._univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.deepClone({...paragraph,paragraphStyle:{...paragraph.paragraphStyle,borderBottom:void 0}}),startIndex:0}]}});const path=(0,_util__WEBPACK_IMPORTED_MODULE_4__.J)(docDataModel,segmentId);doMutation.params.actions=jsonX.editOp(textX.serialize(),path);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}};function getCursorWhenDelete(textRanges,rectRanges){let cursor=0;if(null==textRanges||0===textRanges.length){if("number"==typeof rectRanges[0].startOffset){const rectRange=rectRanges[0],{spanEntireRow,spanEntireTable}=rectRange;cursor=spanEntireTable?rectRange.startOffset-3:spanEntireRow?rectRange.startRow>0?rectRange.startOffset-6:rectRange.startOffset:rectRanges[0].startOffset}}else if(textRanges.length>0&&rectRanges.length>0){const textRange=textRanges[0],rectRange=rectRanges[0];if(null!=textRange.startOffset&&null!=rectRange.startOffset)if(textRange.startOffset<rectRange.startOffset)cursor=textRange.startOffset;else if(textRange.startOffset>=rectRange.startOffset){const{spanEntireRow,spanEntireTable}=rectRange;spanEntireTable?cursor=rectRange.startOffset-3:spanEntireRow&&(cursor=rectRange.startOffset-6)}}return cursor}const DeleteLeftCommand={id:"doc.command.delete-left",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async accessor=>{const docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY);let result=!0;const docDataModel=univerInstanceService.getCurrentUniverDocInstance();if(null==docDataModel)return!1;const unitId=docDataModel.getUnitId(),docSkeletonManagerService=(0,_util__WEBPACK_IMPORTED_MODULE_4__.R)(accessor,unitId),activeRange=docSelectionManagerService.getActiveTextRange(),rectRanges=docSelectionManagerService.getRectRanges(),ranges=docSelectionManagerService.getTextRanges(),skeleton=docSkeletonManagerService?.getSkeleton();if(null==skeleton)return!1;if(rectRanges?.length){const cursor=getCursorWhenDelete(ranges,rectRanges),segmentId=rectRanges[0].segmentId,textRanges=[{startOffset:cursor,endOffset:cursor}];return commandService.executeCommand(_clipboard_inner_command__WEBPACK_IMPORTED_MODULE_5__.J2.id,{segmentId,textRanges})}if(null==activeRange||null==ranges)return!1;const{segmentId,style,segmentPage}=activeRange,body=docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();if(null==body)return!1;const actualRange=activeRange,{startOffset,collapsed}=actualRange,curGlyph=skeleton.findNodeByCharIndex(startOffset,segmentId,segmentPage),isBullet=(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.ZXY)(curGlyph),isIndent=(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.wr_)(curGlyph,body);let cursor=startOffset;const preGlyph=skeleton.findNodeByCharIndex(startOffset-1,segmentId,segmentPage);if((0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.Lrz)(curGlyph)&&preGlyph!==curGlyph&&(!0===isBullet||!0===isIndent)&&collapsed){const paragraph=(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.k3L)(curGlyph,body);if(null==paragraph)return!1;const paragraphIndex=paragraph?.startIndex,updateParagraph={startIndex:0},paragraphStyle=paragraph.paragraphStyle;if(!0===isBullet){const paragraphStyle=paragraph.paragraphStyle;if(paragraphStyle){updateParagraph.paragraphStyle=paragraphStyle;const{hanging}=paragraphStyle;hanging&&(updateParagraph.paragraphStyle.indentStart=hanging,updateParagraph.paragraphStyle.hanging=void 0)}}else if(!0===isIndent){const bullet=paragraph.bullet;bullet&&(updateParagraph.bullet=bullet),null!=paragraphStyle&&(updateParagraph.paragraphStyle={...paragraphStyle},delete updateParagraph.paragraphStyle.hanging,delete updateParagraph.paragraphStyle.indentStart)}const textRanges=[{startOffset:cursor,endOffset:cursor,style}];result=await commandService.executeCommand(_core_editing_command__WEBPACK_IMPORTED_MODULE_6__.fR.id,{unitId:docDataModel.getUnitId(),updateBody:{dataStream:"",paragraphs:[{...updateParagraph}]},range:{startOffset:paragraphIndex,endOffset:paragraphIndex+1},textRanges,coverType:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.fXF.REPLACE,segmentId})}else if(!0===collapsed){if(null==preGlyph)return!0;if("\r"===preGlyph.content){const paragraph=body.paragraphs?.find((p=>p.startIndex===startOffset-1));result=paragraph?.paragraphStyle?.borderBottom?await commandService.executeCommand(RemoveHorizontalLineCommand.id):await commandService.executeCommand(MergeTwoParagraphCommand.id,{direction:_types_delete_direction__WEBPACK_IMPORTED_MODULE_3__.b.LEFT,range:actualRange})}else if("\b"===preGlyph.streamType){const drawing=docDataModel.getSnapshot().drawings?.[preGlyph.drawingId??""];if(null==drawing)return!0;const customBlock=docDataModel.getBody()?.customBlocks?.find((block=>block.blockId===preGlyph.drawingId));if(drawing.layoutType===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.e9n.INLINE||customBlock?.blockType===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__._B_.CUSTOM){const unitId=docDataModel.getUnitId();result=await commandService.executeCommand(DeleteCustomBlockCommand.id,{direction:_types_delete_direction__WEBPACK_IMPORTED_MODULE_3__.b.LEFT,range:activeRange,unitId,drawingId:preGlyph.drawingId})}else{const prePreGlyph=skeleton.findNodeByCharIndex(startOffset-2);if(null==prePreGlyph)return!0;cursor-=preGlyph.count,cursor-=prePreGlyph.count;const textRanges=[{startOffset:cursor,endOffset:cursor,style}];result=await commandService.executeCommand(_core_editing_command__WEBPACK_IMPORTED_MODULE_6__.Rj.id,{unitId:docDataModel.getUnitId(),range:{...activeRange,startOffset:activeRange.startOffset-1,endOffset:activeRange.endOffset-1},segmentId,direction:_types_delete_direction__WEBPACK_IMPORTED_MODULE_3__.b.LEFT,len:prePreGlyph.count,textRanges})}}else cursor-=preGlyph.count,result=await commandService.executeCommand(_core_editing_command__WEBPACK_IMPORTED_MODULE_6__.Rj.id,{unitId:docDataModel.getUnitId(),range:actualRange,segmentId,direction:_types_delete_direction__WEBPACK_IMPORTED_MODULE_3__.b.LEFT,len:preGlyph.count})}else{const textRanges=getTextRangesWhenDelete(actualRange,[actualRange]);result=await commandService.executeCommand(_clipboard_inner_command__WEBPACK_IMPORTED_MODULE_5__.J2.id,{segmentId,textRanges,selections:[actualRange]})}return result}},DeleteRightCommand={id:"doc.command.delete-right",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async accessor=>{const docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),docDataModel=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr).getCurrentUniverDocInstance();if(!docDataModel)return!1;const docSkeletonManagerService=(0,_util__WEBPACK_IMPORTED_MODULE_4__.R)(accessor,docDataModel.getUnitId()),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),activeRange=docSelectionManagerService.getActiveTextRange(),rectRanges=docSelectionManagerService.getRectRanges(),ranges=docSelectionManagerService.getTextRanges(),skeleton=docSkeletonManagerService?.getSkeleton();if(rectRanges?.length){const cursor=getCursorWhenDelete(ranges,rectRanges),segmentId=rectRanges[0].segmentId,textRanges=[{startOffset:cursor,endOffset:cursor}];return commandService.executeCommand(_clipboard_inner_command__WEBPACK_IMPORTED_MODULE_5__.J2.id,{segmentId,textRanges})}if(null==activeRange||null==skeleton||null==ranges)return!1;const{segmentId,style,segmentPage}=activeRange,body=docDataModel?.getSelfOrHeaderFooterModel(segmentId).getBody();if(!docDataModel||!body)return!1;const actualRange=activeRange,{startOffset,endOffset,collapsed}=actualRange;if(startOffset===body.dataStream.length-2&&collapsed)return!0;let result=!1;if(!0===collapsed){const needDeleteGlyph=skeleton.findNodeByCharIndex(startOffset,segmentId,segmentPage),nextGlyph=skeleton.findNodeByCharIndex(startOffset+1);if(needDeleteGlyph.streamType===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.PARAGRAPH&&nextGlyph?.streamType===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.SECTION_BREAK)return!1;if("\r"===needDeleteGlyph.content)result=await commandService.executeCommand(MergeTwoParagraphCommand.id,{direction:_types_delete_direction__WEBPACK_IMPORTED_MODULE_3__.b.RIGHT,range:activeRange});else if("\b"===needDeleteGlyph.streamType){const drawing=docDataModel.getSnapshot().drawings?.[needDeleteGlyph.drawingId??""];if(null==drawing)return!0;if(drawing.layoutType===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.e9n.INLINE){const unitId=docDataModel.getUnitId();result=await commandService.executeCommand(DeleteCustomBlockCommand.id,{direction:_types_delete_direction__WEBPACK_IMPORTED_MODULE_3__.b.RIGHT,range:activeRange,unitId,drawingId:needDeleteGlyph.drawingId})}else{if(null==nextGlyph)return!0;const textRanges=[{startOffset:startOffset+1,endOffset:startOffset+1,style}];result=await commandService.executeCommand(_core_editing_command__WEBPACK_IMPORTED_MODULE_6__.Rj.id,{unitId:docDataModel.getUnitId(),range:{...activeRange,startOffset:startOffset+1,endOffset:endOffset+1},segmentId,direction:_types_delete_direction__WEBPACK_IMPORTED_MODULE_3__.b.RIGHT,textRanges,len:nextGlyph.count})}}else{const textRanges=[{startOffset,endOffset:startOffset,style}];result=await commandService.executeCommand(_core_editing_command__WEBPACK_IMPORTED_MODULE_6__.Rj.id,{unitId:docDataModel.getUnitId(),range:actualRange,segmentId,direction:_types_delete_direction__WEBPACK_IMPORTED_MODULE_3__.b.RIGHT,textRanges,len:needDeleteGlyph.count})}}else{const textRanges=getTextRangesWhenDelete(actualRange,[actualRange]);result=await commandService.executeCommand(_clipboard_inner_command__WEBPACK_IMPORTED_MODULE_5__.J2.id,{segmentId,textRanges,selections:[actualRange]})}return result}};function getTextRangesWhenDelete(activeRange,ranges){let cursor=activeRange.endOffset;for(const range of ranges){const{startOffset,endOffset}=range;null!=startOffset&&null!=endOffset&&(endOffset<=activeRange.endOffset&&(cursor-=endOffset-startOffset))}return[{startOffset:cursor,endOffset:cursor,style:activeRange.style}]}},"../../packages/docs-ui/src/commands/commands/doc-header-footer.command.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Q6:()=>CloseHeaderFooterCommand,WM:()=>OpenHeaderFooterPanelCommand,ay:()=>CoreHeaderFooterCommandId,jP:()=>CoreHeaderFooterCommand});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs/src/index.ts"),_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/engine-render/src/index.ts"),_basics_selection__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/docs-ui/src/basics/selection.ts"),_controllers_doc_header_footer_controller__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../packages/docs-ui/src/controllers/doc-header-footer.controller.ts"),_services_selection_doc_selection_render_service__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../packages/docs-ui/src/services/selection/doc-selection-render.service.ts"),_operations_doc_header_footer_panel_operation__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../packages/docs-ui/src/commands/operations/doc-header-footer-panel.operation.ts");function createHeaderFooterAction(segmentId,createType,documentStyle,actions){const jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),firstSegmentId=segmentId??_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.generateRandomId(6),isHeader=createType===_controllers_doc_header_footer_controller__WEBPACK_IMPORTED_MODULE_4__.l.DEFAULT_HEADER||createType===_controllers_doc_header_footer_controller__WEBPACK_IMPORTED_MODULE_4__.l.FIRST_PAGE_HEADER||createType===_controllers_doc_header_footer_controller__WEBPACK_IMPORTED_MODULE_4__.l.EVEN_PAGE_HEADER,insertAction=jsonX.insertOp([isHeader?"headers":"footers",firstSegmentId],{[isHeader?"headerId":"footerId"]:firstSegmentId,body:{dataStream:"\r\n",textRuns:[{st:0,ed:0,ts:{fs:9}}],customBlocks:[],paragraphs:[{startIndex:0,paragraphStyle:{spaceAbove:{v:0},lineSpacing:1.5,spaceBelow:{v:0}}}],sectionBreaks:[{startIndex:1}]}});actions.push(insertAction);const secondSegmentId=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.generateRandomId(6),insertPairAction=jsonX.insertOp([isHeader?"footers":"headers",secondSegmentId],{[isHeader?"footerId":"headerId"]:secondSegmentId,body:{dataStream:"\r\n",textRuns:[{st:0,ed:0,ts:{fs:9}}],customBlocks:[],paragraphs:[{startIndex:0,paragraphStyle:{spaceAbove:{v:0},lineSpacing:1.5,spaceBelow:{v:0}}}],sectionBreaks:[{startIndex:1}]}});actions.push(insertPairAction);let key="defaultHeaderId",pairKey="defaultFooterId";switch(createType){case _controllers_doc_header_footer_controller__WEBPACK_IMPORTED_MODULE_4__.l.DEFAULT_HEADER:key="defaultHeaderId",pairKey="defaultFooterId";break;case _controllers_doc_header_footer_controller__WEBPACK_IMPORTED_MODULE_4__.l.DEFAULT_FOOTER:key="defaultFooterId",pairKey="defaultHeaderId";break;case _controllers_doc_header_footer_controller__WEBPACK_IMPORTED_MODULE_4__.l.FIRST_PAGE_HEADER:key="firstPageHeaderId",pairKey="firstPageFooterId";break;case _controllers_doc_header_footer_controller__WEBPACK_IMPORTED_MODULE_4__.l.FIRST_PAGE_FOOTER:key="firstPageFooterId",pairKey="firstPageHeaderId";break;case _controllers_doc_header_footer_controller__WEBPACK_IMPORTED_MODULE_4__.l.EVEN_PAGE_HEADER:key="evenPageHeaderId",pairKey="evenPageFooterId";break;case _controllers_doc_header_footer_controller__WEBPACK_IMPORTED_MODULE_4__.l.EVEN_PAGE_FOOTER:key="evenPageFooterId",pairKey="evenPageHeaderId";break;default:throw new Error(`Unknown header footer type: ${createType}`)}for(const[k,id]of[[key,firstSegmentId],[pairKey,secondSegmentId]])if(null!=documentStyle[k]){const replaceAction=jsonX.replaceOp(["documentStyle",k],documentStyle[k],id);actions.push(replaceAction)}else{const insertAction=jsonX.insertOp(["documentStyle",k],id);actions.push(insertAction)}return actions}const CoreHeaderFooterCommandId="doc.command.core-header-footer",CoreHeaderFooterCommand={id:CoreHeaderFooterCommandId,type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>{const commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),renderManagerService=accessor.get(_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.cSx),{unitId,segmentId,createType,headerFooterProps}=params,docSkeletonManagerService=renderManagerService.getRenderById(unitId)?.with(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.EX),docDataModel=univerInstanceService.getUniverDocInstance(unitId),docViewModel=docSkeletonManagerService?.getViewModel();if(null==docDataModel||null==docViewModel)return!1;const editArea=docViewModel.getEditArea(),{documentStyle}=docDataModel.getSnapshot(),isUpdateMargin=null!=headerFooterProps?.marginFooter||null!=headerFooterProps?.marginHeader,doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges:[{startOffset:0,endOffset:0,collapsed:!0}],debounce:!0}};isUpdateMargin&&(doMutation.params.noNeedSetTextRange=!0);const jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),rawActions=[];if(null!=createType&&createHeaderFooterAction(segmentId,createType,documentStyle,rawActions),null!=headerFooterProps&&Object.keys(headerFooterProps).forEach((key=>{const value=headerFooterProps[key],oldValue=documentStyle[key];if(value===oldValue)return;let action;if(action=void 0===oldValue?jsonX.insertOp(["documentStyle",key],value):jsonX.replaceOp(["documentStyle",key],oldValue,value),rawActions.push(action),"useFirstPageHeaderFooter"!==key||value!==_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE||documentStyle.firstPageHeaderId){if("evenAndOddHeaders"===key&&value===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE&&!documentStyle.evenPageHeaderId){const headerFooterType=editArea===_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.ZCK.HEADER?_controllers_doc_header_footer_controller__WEBPACK_IMPORTED_MODULE_4__.l.EVEN_PAGE_HEADER:_controllers_doc_header_footer_controller__WEBPACK_IMPORTED_MODULE_4__.l.EVEN_PAGE_FOOTER;createHeaderFooterAction(segmentId,headerFooterType,documentStyle,rawActions)}}else{const headerFooterType=editArea===_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.ZCK.HEADER?_controllers_doc_header_footer_controller__WEBPACK_IMPORTED_MODULE_4__.l.FIRST_PAGE_HEADER:_controllers_doc_header_footer_controller__WEBPACK_IMPORTED_MODULE_4__.l.FIRST_PAGE_FOOTER;createHeaderFooterAction(segmentId,headerFooterType,documentStyle,rawActions)}})),0===rawActions.length)return!1;doMutation.params.actions=rawActions.reduce(((acc,cur)=>_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.compose(acc,cur)),null);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}},OpenHeaderFooterPanelCommand={id:"doc.command.open-header-footer-panel",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,_params)=>accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY).executeCommand(_operations_doc_header_footer_panel_operation__WEBPACK_IMPORTED_MODULE_6__.Q.id,{value:"open"})},CloseHeaderFooterCommand={id:"doc.command.close-header-footer",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>{const commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),renderManagerService=accessor.get(_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.cSx),docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),instanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),{unitId}=params,renderObject=renderManagerService.getRenderById(unitId);if(null==renderObject)return!1;const{scene}=renderObject,transformer=scene.getTransformerByCreate(),docSkeletonManagerService=renderObject.with(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.EX),docSelectionRenderService=renderObject.with(_services_selection_doc_selection_render_service__WEBPACK_IMPORTED_MODULE_5__.q),skeleton=docSkeletonManagerService?.getSkeleton(),viewModel=docSkeletonManagerService?.getViewModel();return null!=viewModel&&null!=skeleton&&(docSelectionManagerService.replaceDocRanges([]),transformer.clearSelectedObjects(),docSelectionRenderService.setSegment(""),docSelectionRenderService.setSegmentPage(-1),viewModel.setEditArea(_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.ZCK.BODY),skeleton.calculate(),renderObject.mainComponent?.makeDirty(!0),queueMicrotask((()=>{const docDataModel=instanceService.getUnit(unitId),snapshot=docDataModel?.getSnapshot();if(null==snapshot)return;const offset=(0,_basics_selection__WEBPACK_IMPORTED_MODULE_3__.X)(snapshot);docSelectionManagerService.replaceDocRanges([{startOffset:offset,endOffset:offset}])})),commandService.executeCommand(_operations_doc_header_footer_panel_operation__WEBPACK_IMPORTED_MODULE_6__.Q.id,{value:"close"}),!0)}}},"../../packages/docs-ui/src/commands/commands/doc-horizontal-line.command.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{G:()=>HorizontalLineCommand});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_break_line_command__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs-ui/src/commands/commands/break-line.command.ts");const HorizontalLineCommand={id:"doc.command.horizontal-line",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:(accessor,_params)=>accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY).executeCommand(_break_line_command__WEBPACK_IMPORTED_MODULE_1__.Z.id,{horizontalLine:{padding:5,color:{rgb:"#CDD0D8"},width:1,dashStyle:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.UwB.SOLID}})}},"../../packages/docs-ui/src/commands/commands/doc-paragraph-setting.command.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Y:()=>DocParagraphSettingCommand});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs/src/index.ts"),_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/docs-ui/src/commands/util.ts"),_list_command__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/docs-ui/src/commands/commands/list.command.ts");const DocParagraphSettingCommand={id:"doc-paragraph-setting.command",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,config)=>{const docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),docDataModel=univerInstanceService.getCurrentUnitForType(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC),docRanges=docSelectionManagerService.getDocRanges();if(!docDataModel||0===docRanges.length||!config)return!1;const segmentId=docRanges[0].segmentId,unitId=docDataModel.getUnitId(),allParagraphs=docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()?.paragraphs??[],paragraphs=(0,_list_command__WEBPACK_IMPORTED_MODULE_3__.HD)(docRanges,allParagraphs)??[],doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges:docRanges}},memoryCursor=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OsL;memoryCursor.reset();const textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance();for(const paragraph of paragraphs){const{startIndex}=paragraph;textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:startIndex-memoryCursor.cursor});const paragraphStyle={...paragraph.paragraphStyle,...config.paragraph};textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...paragraph,paragraphStyle,startIndex:0}]},coverType:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.fXF.REPLACE}),memoryCursor.moveCursorTo(startIndex+1)}const path=(0,_util__WEBPACK_IMPORTED_MODULE_2__.J)(docDataModel,segmentId);doMutation.params.actions=jsonX.editOp(textX.serialize(),path);return!!commandService.syncExecuteCommand(doMutation.id,doMutation.params)}}},"../../packages/docs-ui/src/commands/commands/inline-format.command.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ag:()=>SetInlineFormatTextBackgroundColorCommand,D6:()=>SetInlineFormatBoldCommand,EM:()=>SetInlineFormatCommand,Qo:()=>SetInlineFormatTextColorCommand,_H:()=>SetInlineFormatItalicCommand,mZ:()=>SetInlineFormatFontSizeCommand,rF:()=>SetInlineFormatStrikethroughCommand,tE:()=>ResetInlineFormatTextBackgroundColorCommand,uk:()=>SetInlineFormatUnderlineCommand,vV:()=>getStyleInTextRange,vp:()=>SetInlineFormatFontFamilyCommand,xL:()=>SetInlineFormatSubscriptCommand,yS:()=>SetInlineFormatSuperscriptCommand});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs/src/index.ts"),_services_doc_menu_style_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/docs-ui/src/services/doc-menu-style.service.ts"),_util__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/docs-ui/src/commands/util.ts");function handleInlineFormat(preCommandId,params,commandService){return commandService.executeCommand(SetInlineFormatCommand.id,{preCommandId,...params??{}})}const SetInlineFormatBoldCommand={id:"doc.command.set-inline-format-bold",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>handleInlineFormat("doc.command.set-inline-format-bold",params,accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY))},SetInlineFormatItalicCommand={id:"doc.command.set-inline-format-italic",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>handleInlineFormat("doc.command.set-inline-format-italic",params,accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY))},SetInlineFormatUnderlineCommand={id:"doc.command.set-inline-format-underline",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>handleInlineFormat("doc.command.set-inline-format-underline",params,accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY))},SetInlineFormatStrikethroughCommand={id:"doc.command.set-inline-format-strikethrough",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>handleInlineFormat("doc.command.set-inline-format-strikethrough",params,accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY))},SetInlineFormatSubscriptCommand={id:"doc.command.set-inline-format-subscript",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>handleInlineFormat("doc.command.set-inline-format-subscript",params,accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY))},SetInlineFormatSuperscriptCommand={id:"doc.command.set-inline-format-superscript",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>handleInlineFormat("doc.command.set-inline-format-superscript",params,accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY))},SetInlineFormatFontSizeCommand={id:"doc.command.set-inline-format-fontsize",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>handleInlineFormat("doc.command.set-inline-format-fontsize",params,accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY))},SetInlineFormatFontFamilyCommand={id:"doc.command.set-inline-format-font-family",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>handleInlineFormat("doc.command.set-inline-format-font-family",params,accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY))},SetInlineFormatTextColorCommand={id:"doc.command.set-inline-format-text-color",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>handleInlineFormat("doc.command.set-inline-format-text-color",params,accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY))},SetInlineFormatTextBackgroundColorCommand={id:"doc.command.set-inline-format-text-background-color",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>handleInlineFormat("doc.command.set-inline-format-text-background-color",params,accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY))},ResetInlineFormatTextBackgroundColorCommand={id:"doc.command.reset-inline-format-text-background-color",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>handleInlineFormat("doc.command.reset-inline-format-text-background-color",params,accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY))},COMMAND_ID_TO_FORMAT_KEY_MAP={[SetInlineFormatBoldCommand.id]:"bl",[SetInlineFormatItalicCommand.id]:"it",[SetInlineFormatUnderlineCommand.id]:"ul",[SetInlineFormatStrikethroughCommand.id]:"st",[SetInlineFormatFontSizeCommand.id]:"fs",[SetInlineFormatFontFamilyCommand.id]:"ff",[SetInlineFormatTextColorCommand.id]:"cl",[SetInlineFormatTextBackgroundColorCommand.id]:"bg",[ResetInlineFormatTextBackgroundColorCommand.id]:"bg",[SetInlineFormatSubscriptCommand.id]:"va",[SetInlineFormatSuperscriptCommand.id]:"va"},SetInlineFormatCommand={id:"doc.command.set-inline-format",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>{const{value,preCommandId}=params,commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),docMenuStyleService=accessor.get(_services_doc_menu_style_service__WEBPACK_IMPORTED_MODULE_2__._),docRanges=docSelectionManagerService.getDocRanges(),activeRange=docRanges.find((r=>r.isActive))??docRanges[0];if(0===docRanges.length)return!1;const{segmentId}=docRanges[0],docDataModel=univerInstanceService.getCurrentUnitForType(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC);if(null==docDataModel)return!1;const body=docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();if(null==body)return!1;const unitId=docDataModel.getUnitId();let formatValue;switch(preCommandId){case SetInlineFormatBoldCommand.id:case SetInlineFormatItalicCommand.id:case SetInlineFormatUnderlineCommand.id:case SetInlineFormatStrikethroughCommand.id:case SetInlineFormatSubscriptCommand.id:case SetInlineFormatSuperscriptCommand.id:formatValue=function getReverseFormatValueInSelection(textStyle,preCommandId){const key=COMMAND_ID_TO_FORMAT_KEY_MAP[preCommandId],reverseValue=getReverseFormatValue(textStyle,key,preCommandId);return reverseValue}(getStyleInTextRange(body,activeRange,docMenuStyleService.getDefaultStyle()),preCommandId);break;case SetInlineFormatFontSizeCommand.id:case SetInlineFormatFontFamilyCommand.id:formatValue=value;break;case SetInlineFormatTextColorCommand.id:case SetInlineFormatTextBackgroundColorCommand.id:formatValue={rgb:value};break;case ResetInlineFormatTextBackgroundColorCommand.id:formatValue={rgb:null};break;default:throw new Error(`Unknown command: ${preCommandId} in handleInlineFormat`)}const doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges:docRanges}},textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),memoryCursor=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OsL;memoryCursor.reset();for(const range of docRanges){let{startOffset,endOffset,rangeType}=range;if(null==startOffset||null==endOffset)continue;if(rangeType===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.AlE.RECT&&(startOffset-=1),startOffset===endOffset){const cacheStyle=docMenuStyleService.getStyleCache(),key=COMMAND_ID_TO_FORMAT_KEY_MAP[preCommandId];docMenuStyleService.setStyleCache({[key]:void 0!==cacheStyle?.[key]?getReverseFormatValue(cacheStyle,key,preCommandId):formatValue});continue}const body={dataStream:"",textRuns:[{st:0,ed:endOffset-startOffset,ts:{[COMMAND_ID_TO_FORMAT_KEY_MAP[preCommandId]]:formatValue}}]},len=startOffset-memoryCursor.cursor;0!==len&&textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len}),textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,body,len:endOffset-startOffset}),memoryCursor.reset(),memoryCursor.moveCursor(endOffset)}const path=(0,_util__WEBPACK_IMPORTED_MODULE_3__.J)(docDataModel,segmentId);doMutation.params.actions=jsonX.editOp(textX.serialize(),path);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}};function getReverseFormatValue(ts,key,preCommandId){return/bl|it/.test(key)?ts?.[key]===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE?_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.FALSE:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE:/ul|st/.test(key)?function isTextDecoration(value){return null!==value&&"object"==typeof value}(ts?.[key])&&(ts?.[key]).s===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE?{s:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.FALSE}:{s:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE}:/va/.test(key)?preCommandId===SetInlineFormatSubscriptCommand.id?ts?.[key]===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.DRO.SUBSCRIPT?_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.DRO.NORMAL:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.DRO.SUBSCRIPT:ts?.[key]===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.DRO.SUPERSCRIPT?_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.DRO.NORMAL:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.DRO.SUPERSCRIPT:void 0}function getStyleInTextRange(body,textRange,defaultStyle){const{startOffset,endOffset,collapsed}=textRange;if(collapsed){const textRuns=body.textRuns??[];let textRun=null;for(let i=textRuns.length-1;i>=0;i--){const curTextRun=textRuns[i];if(curTextRun.st<startOffset&&startOffset<=curTextRun.ed){textRun=curTextRun;break}}return textRun?.ts?{...defaultStyle,...textRun.ts}:defaultStyle}const{textRuns=[]}=(0,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.DyH)(body,startOffset,endOffset),style=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.deepClone(defaultStyle);style.fs=Math.max(style.fs,...textRuns.map((t=>t?.ts?.fs??style.fs))),style.ff=textRuns.find((t=>null!=t.ts?.ff))?.ts?.ff??style.ff,style.it=textRuns.length&&textRuns.every((t=>t.ts?.it===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE))?_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.FALSE,style.bl=textRuns.length&&textRuns.every((t=>t.ts?.bl===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE))?_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.FALSE,style.ul=textRuns.length&&textRuns.every((t=>t.ts?.ul?.s===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE))?textRuns[0].ts?.ul:style.ul,style.st=textRuns.length&&textRuns.every((t=>t.ts?.st?.s===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE))?textRuns[0].ts?.st:style.st,style.bg=textRuns.find((t=>null!=t.ts?.bg))?.ts?.bg??style.bg,style.cl=textRuns.find((t=>null!=t.ts?.cl))?.ts?.cl??style.cl;const vas=textRuns.filter((t=>null!=t?.ts?.va));if(vas.length>0&&vas.length===textRuns.length){const va=vas[0].ts?.va;let isSame=!0;for(let i=1;i<vas.length;i++)if(vas[i].ts?.va!==va){isSame=!1;break}isSame&&(style.va=va)}return style}},"../../packages/docs-ui/src/commands/commands/list.command.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{B1:()=>ListOperationCommand,Bm:()=>ChangeListNestingLevelType,Cz:()=>ChangeListNestingLevelCommand,HD:()=>getParagraphsInRanges,Q:()=>ChangeListTypeCommand,Sm:()=>CheckListCommand,h:()=>QuickListCommand,kx:()=>OrderListCommand,mh:()=>BulletListCommand,um:()=>getParagraphsInRange,y6:()=>ToggleCheckListCommand});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs/src/index.ts"),_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/engine-render/src/index.ts"),_util__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/docs-ui/src/commands/util.ts");const ListOperationCommand={id:"doc.command.list-operation",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:(accessor,params)=>{const docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),listType=params.listType,docDataModel=univerInstanceService.getCurrentUnitForType(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC),docRanges=docSelectionManagerService.getDocRanges()??[];if(null==docDataModel||0===docRanges.length)return!1;const segmentId=docRanges[0].segmentId,paragraphs=docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()?.paragraphs;if(null==paragraphs)return!1;const currentParagraphs=getParagraphsInRanges(docRanges,paragraphs),unitId=docDataModel.getUnitId(),doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges:docRanges,isEditing:!1}};(new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OsL).reset();const textX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Z4q.paragraph.bullet.switch({paragraphs:currentParagraphs,listType,document:docDataModel,segmentId}),jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),path=(0,_util__WEBPACK_IMPORTED_MODULE_3__.J)(docDataModel,segmentId);doMutation.params.actions=jsonX.editOp(textX.serialize(),path);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}},ChangeListTypeCommand={id:"doc.command.change-list-type",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:(accessor,params)=>{const docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),{listType}=params,docDataModel=univerInstanceService.getCurrentUnitForType(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC),activeRanges=docSelectionManagerService.getDocRanges();if(null==docDataModel||null==activeRanges||!activeRanges.length)return!1;const{segmentId}=activeRanges[0],selections=docSelectionManagerService.getDocRanges()??[],paragraphs=docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()?.paragraphs;if(null==paragraphs)return!1;const currentParagraphs=getParagraphsInRanges(selections,paragraphs),unitId=docDataModel.getUnitId(),textX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Z4q.paragraph.bullet.set({paragraphs:currentParagraphs,listType,segmentId,document:docDataModel});if(!textX)return!1;const jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges:selections,isEditing:!1}},path=(0,_util__WEBPACK_IMPORTED_MODULE_3__.J)(docDataModel,segmentId);doMutation.params.actions=jsonX.editOp(textX.serialize(),path);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}};var ChangeListNestingLevelType=function(ChangeListNestingLevelType){return ChangeListNestingLevelType[ChangeListNestingLevelType.increase=1]="increase",ChangeListNestingLevelType[ChangeListNestingLevelType.decrease=-1]="decrease",ChangeListNestingLevelType}({});const ChangeListNestingLevelCommand={id:"doc.command.change-list-nesting-level",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:(accessor,params)=>{if(!params)return!1;const{type}=params,docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),docDataModel=univerInstanceService.getCurrentUnitForType(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC),activeRange=docSelectionManagerService.getActiveTextRange();if(null==docDataModel||null==activeRange)return!1;const{segmentId}=activeRange,selections=docSelectionManagerService.getDocRanges()??[],paragraphs=docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()?.paragraphs;if(null==paragraphs)return!1;const currentParagraphs=getParagraphsInRange(activeRange,paragraphs),unitId=docDataModel.getUnitId(),jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),textX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Z4q.paragraph.bullet.changeNestLevel({paragraphs:currentParagraphs,type,segmentId,document:docDataModel}),doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges:selections,isEditing:!1}},path=(0,_util__WEBPACK_IMPORTED_MODULE_3__.J)(docDataModel,segmentId);doMutation.params.actions=jsonX.editOp(textX.serialize(),path);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}},BulletListCommand={id:"doc.command.bullet-list",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:(accessor,params)=>{const commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY);return params?.value?commandService.syncExecuteCommand(ChangeListTypeCommand.id,{listType:params.value}):commandService.syncExecuteCommand(ListOperationCommand.id,{listType:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.yrS.BULLET_LIST})}},CheckListCommand={id:"doc.command.check-list",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:(accessor,params)=>{const commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY);return params?.value?commandService.syncExecuteCommand(ChangeListTypeCommand.id,{listType:params.value}):commandService.syncExecuteCommand(ListOperationCommand.id,{listType:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.yrS.CHECK_LIST})}},ToggleCheckListCommand={id:"doc.command.toggle-check-list",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:(accessor,params)=>{if(!params)return!1;const univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),{index,segmentId,textRanges}=params,docDataModel=univerInstanceService.getCurrentUnitForType(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC);if(null==docDataModel)return!1;const paragraphs=docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()?.paragraphs;if(null==paragraphs)return!1;const unitId=docDataModel.getUnitId(),doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges:textRanges??[],segmentId,isEditing:!1}},textX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Z4q.paragraph.bullet.toggleChecklist({document:docDataModel,paragraphIndex:index,segmentId});if(!textX)return!1;const jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),path=(0,_util__WEBPACK_IMPORTED_MODULE_3__.J)(docDataModel,segmentId);doMutation.params.actions=jsonX.editOp(textX.serialize(),path);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}},OrderListCommand={id:"doc.command.order-list",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:(accessor,params)=>{const commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY);return params?.value?commandService.syncExecuteCommand(ChangeListTypeCommand.id,{listType:params.value}):commandService.syncExecuteCommand(ListOperationCommand.id,{listType:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.yrS.ORDER_LIST})}},QuickListCommand={id:"doc.command.quick-list",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler(accessor,params){if(!params)return!1;const docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),docDataModel=univerInstanceService.getCurrentUnitForType(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC),activeRange=docSelectionManagerService.getActiveTextRange();if(null==docDataModel||null==activeRange)return!1;const{segmentId}=activeRange,{listType,paragraph}=params,{paragraphStart,paragraphEnd}=paragraph,textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),{defaultTabStop=36}=docDataModel.getSnapshot().documentStyle,sectionBreaks=docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()?.sectionBreaks??[],{startIndex,paragraphStyle={}}=paragraph,{indentFirstLine,snapToGrid,indentStart}=paragraphStyle,paragraphProperties=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Kum[listType].nestingLevel[0].paragraphProperties||{},{hanging:listHanging,indentStart:listIndentStart}=paragraphProperties,bulletParagraphTextStyle=paragraphProperties.textStyle,{charSpace,gridType}=function findNearestSectionBreak(currentIndex,sectionBreaks){const sortedSectionBreaks=sectionBreaks.sort((0,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.ijg)("startIndex"));for(let i=0;i<sortedSectionBreaks.length;i++){const sectionBreak=sectionBreaks[i];if(sectionBreak.startIndex>=currentIndex)return sectionBreak}}(startIndex,sectionBreaks)||{charSpace:0,gridType:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.jJN.LINES},charSpaceApply=(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.fBx)(charSpace,defaultTabStop,gridType,snapToGrid);let listId=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.generateRandomId(6);const paragraphs=docDataModel.getBody()?.paragraphs??[],curIndex=paragraphs.findIndex((i=>i.startIndex===paragraph.startIndex)),prevParagraph=paragraphs[curIndex-1],nextParagraph=paragraphs[curIndex+1];prevParagraph&&prevParagraph.bullet&&0===prevParagraph.bullet.listType.indexOf(listType)?listId=prevParagraph.bullet.listId:nextParagraph&&nextParagraph.bullet&&0===nextParagraph.bullet.listType.indexOf(listType)&&(listId=nextParagraph.bullet.listId);const doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId:docDataModel.getUnitId(),actions:[],textRanges:[{startOffset:paragraphStart,endOffset:paragraphStart,collapsed:!0}],isEditing:!1}};textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:paragraphStart}),textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.DELETE,len:paragraphEnd-paragraphStart}),textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...paragraphStyle,textStyle:{...paragraphStyle.textStyle,...bulletParagraphTextStyle},indentFirstLine:void 0,hanging:listHanging,indentStart:{v:(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.nz8)(listIndentStart,charSpaceApply)-(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.nz8)(listHanging,charSpaceApply)+(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.nz8)(indentFirstLine,charSpaceApply)+(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.nz8)(indentStart,charSpaceApply)}},bullet:{...paragraph.bullet??{nestingLevel:0,textStyle:{fs:20}},listType,listId}}]}});const path=(0,_util__WEBPACK_IMPORTED_MODULE_3__.J)(docDataModel,segmentId);doMutation.params.actions=jsonX.editOp(textX.serialize(),path);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}};function getParagraphsInRange(activeRange,paragraphs){const{startOffset,endOffset}=activeRange,results=[];let start=-1;for(const paragraph of paragraphs){const{startIndex}=paragraph;(startOffset>start&&startOffset<=startIndex||endOffset>start&&endOffset<=startIndex||startIndex>=startOffset&&startIndex<=endOffset)&&results.push(paragraph),start=startIndex}return results}function getParagraphsInRanges(ranges,paragraphs){const results=[];for(const range of ranges){const ps=getParagraphsInRange(range,paragraphs);results.push(...ps)}return results}},"../../packages/docs-ui/src/commands/commands/paragraph-align.command.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{JV:()=>AlignJustifyCommand,L7:()=>AlignRightCommand,c5:()=>AlignLeftCommand,od:()=>AlignOperationCommand,uk:()=>AlignCenterCommand});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs/src/index.ts"),_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/docs-ui/src/commands/util.ts"),_list_command__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/docs-ui/src/commands/commands/list.command.ts");const AlignOperationCommand={id:"doc.command.align-action",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:(accessor,params)=>{const docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),{alignType}=params,docDataModel=univerInstanceService.getCurrentUniverDocInstance();if(null==docDataModel)return!1;const allRanges=docSelectionManagerService.getDocRanges();if(0===allRanges.length)return!1;const segmentId=allRanges[0].segmentId,paragraphs=docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()?.paragraphs;if(null==paragraphs)return!1;const currentParagraphs=(0,_list_command__WEBPACK_IMPORTED_MODULE_3__.HD)(allRanges,paragraphs),unitId=docDataModel.getUnitId(),isAlreadyAligned=currentParagraphs.every((paragraph=>paragraph.paragraphStyle?.horizontalAlign===alignType)),doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges:allRanges}},memoryCursor=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OsL;memoryCursor.reset();const textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance();for(const paragraph of currentParagraphs){const{startIndex}=paragraph;textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:startIndex-memoryCursor.cursor});const paragraphStyle={...paragraph.paragraphStyle,horizontalAlign:isAlreadyAligned?_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wqs.UNSPECIFIED:alignType};textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...paragraph,paragraphStyle,startIndex:0}]},coverType:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.fXF.REPLACE}),memoryCursor.moveCursorTo(startIndex+1)}const path=(0,_util__WEBPACK_IMPORTED_MODULE_2__.J)(docDataModel,segmentId);doMutation.params.actions=jsonX.editOp(textX.serialize(),path);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}},AlignLeftCommand={id:"doc.command.align-left",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:accessor=>accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY).syncExecuteCommand(AlignOperationCommand.id,{alignType:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wqs.LEFT})},AlignCenterCommand={id:"doc.command.align-center",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:accessor=>accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY).syncExecuteCommand(AlignOperationCommand.id,{alignType:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wqs.CENTER})},AlignRightCommand={id:"doc.command.align-right",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:accessor=>accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY).syncExecuteCommand(AlignOperationCommand.id,{alignType:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wqs.RIGHT})},AlignJustifyCommand={id:"doc.command.align-justify",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:accessor=>accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY).syncExecuteCommand(AlignOperationCommand.id,{alignType:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wqs.JUSTIFIED})}},"../../packages/docs-ui/src/commands/commands/replace-content.command.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{As:()=>CoverContentCommand,Z7:()=>ReplaceTextRunsCommand,cF:()=>ReplaceSelectionCommand,e6:()=>ReplaceSnapshotCommand,zv:()=>ReplaceContentCommand});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs/src/index.ts"),_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/docs-ui/src/commands/util.ts");const ReplaceSnapshotCommand={id:"doc.command-replace-snapshot",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:(accessor,params)=>{const{unitId,snapshot,textRanges,segmentId="",options}=params,univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),docDataModel=univerInstanceService.getUnit(unitId,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC),prevSnapshot=docDataModel?.getSelfOrHeaderFooterModel(segmentId).getSnapshot();if(null==docDataModel||null==prevSnapshot)return!1;const{body,tableSource,footers,headers,lists,drawings,drawingsOrder,documentStyle}=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.deepClone(snapshot),{body:prevBody,tableSource:prevTableSource,footers:prevFooters,headers:prevHeaders,lists:prevLists,drawings:prevDrawings,drawingsOrder:prevDrawingsOrder,documentStyle:prevDocumentStyle}=prevSnapshot;if(null==body||null==prevBody)return!1;if(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.diffValue(body,prevBody)&&textRanges)return docSelectionManagerService.replaceDocRanges(textRanges,{unitId,subUnitId:unitId},!1),!0;const doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges}};options&&(doMutation.params.options=options);const rawActions=[],jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance();if(!_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.diffValue(prevDocumentStyle,documentStyle)){const actions=jsonX.replaceOp(["documentStyle"],prevDocumentStyle,documentStyle);null!=actions&&rawActions.push(actions)}if(!_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.diffValue(body,prevBody)){const actions=jsonX.replaceOp(["body"],prevBody,body);null!=actions&&rawActions.push(actions)}if(!_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.diffValue(tableSource,prevTableSource)){const actions=jsonX.replaceOp(["tableSource"],prevTableSource,tableSource);null!=actions&&rawActions.push(actions)}if(!_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.diffValue(footers,prevFooters)){const actions=jsonX.replaceOp(["footers"],prevFooters,footers);null!=actions&&rawActions.push(actions)}if(!_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.diffValue(headers,prevHeaders)){const actions=jsonX.replaceOp(["headers"],prevHeaders,headers);null!=actions&&rawActions.push(actions)}if(!_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.diffValue(lists,prevLists)){const actions=jsonX.replaceOp(["lists"],prevLists,lists);null!=actions&&rawActions.push(actions)}if(!_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.diffValue(drawings,prevDrawings)){const actions=jsonX.replaceOp(["drawings"],prevDrawings,drawings);null!=actions&&rawActions.push(actions)}if(!_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.diffValue(drawingsOrder,prevDrawingsOrder)){const actions=jsonX.replaceOp(["drawingsOrder"],prevDrawingsOrder,drawingsOrder);null!=actions&&rawActions.push(actions)}doMutation.params.actions=rawActions.reduce(((acc,cur)=>_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.compose(acc,cur)),null);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}},ReplaceContentCommand={id:"doc.command-replace-content",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>{const{unitId,body,textRanges,segmentId="",options}=params,univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),docDataModel=univerInstanceService.getUnit(unitId,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC),prevBody=docDataModel?.getSelfOrHeaderFooterModel(segmentId).getSnapshot().body;if(null==docDataModel||null==prevBody)return!1;const doMutation=getMutationParams(unitId,segmentId,docDataModel,prevBody,body);if(doMutation.params.textRanges=textRanges,options&&(doMutation.params.options=options),null==doMutation.params.actions&&textRanges)return docSelectionManagerService.replaceDocRanges(textRanges,{unitId,subUnitId:unitId},!1),!0;const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}},CoverContentCommand={id:"doc.command-cover-content",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>{const{unitId,body,segmentId=""}=params,univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),undoRedoService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.$Dz),docDatModel=univerInstanceService.getUniverDocInstance(unitId),prevBody=docDatModel?.getSnapshot().body;if(null==docDatModel||null==prevBody)return!1;const doMutation=getMutationParams(unitId,segmentId,docDatModel,prevBody,body);return doMutation.params.noNeedSetTextRange=!0,doMutation.params.noHistory=!0,commandService.syncExecuteCommand(doMutation.id,doMutation.params),undoRedoService.clearUndoRedo(unitId),!0}};function getMutationParams(unitId,segmentId,docDatModel,prevBody,body){const doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges:[]}},actions=function getMutationActions(segmentId,docDatModel,prevBody,body){const textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),deleteLen=prevBody?.dataStream.length-2;deleteLen>0&&textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.DELETE,len:deleteLen}),body.dataStream.length>0&&textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.INSERT,body,len:body.dataStream.length});const path=(0,_util__WEBPACK_IMPORTED_MODULE_2__.J)(docDatModel,segmentId);return jsonX.editOp(textX.serialize(),path)}(segmentId,docDatModel,prevBody,body);return doMutation.params.actions=actions,doMutation}const ReplaceSelectionCommand={id:"doc.command.replace-selection",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler(accessor,params){if(!params)return!1;const{unitId,body:insertBody,textRanges}=params,docDataModel=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr).getUnit(unitId),docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv);if(!docDataModel)return!1;const body=docDataModel.getBody(),selection=params.selection??docSelectionManagerService.getActiveTextRange();if(!selection||!body)return!1;const doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges,debounce:!0}},textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance();return textX.push(..._univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Z4q.selection.delete([selection],body,0,insertBody)),doMutation.params.actions=jsonX.editOp(textX.serialize()),!0}},ReplaceTextRunsCommand={id:"doc.command.replace-text-runs",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:(accessor,params)=>{const{unitId,body,textRanges,segmentId="",options}=params,univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),docDataModel=univerInstanceService.getUnit(unitId,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC),prevBody=docDataModel?.getSelfOrHeaderFooterModel(segmentId).getSnapshot().body;if(null==docDataModel||null==prevBody)return!1;const textX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Z4q.selection.replaceTextRuns({doc:docDataModel,body,selection:{startOffset:0,endOffset:prevBody.dataStream.length-2,collapsed:!1}});if(!textX)return!1;const doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges,noHistory:!0}},jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),path=(0,_util__WEBPACK_IMPORTED_MODULE_2__.J)(docDataModel,segmentId);doMutation.params.actions=jsonX.editOp(textX.serialize(),path),doMutation.params.textRanges=textRanges,options&&(doMutation.params.options=options);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}}},"../../packages/docs-ui/src/commands/commands/switch-doc-mode.command.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{x:()=>SwitchDocModeCommand});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs/src/index.ts"),_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/engine-render/src/index.ts"),_services_selection_doc_selection_render_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/docs-ui/src/services/selection/doc-selection-render.service.ts");const SwitchDocModeCommand={id:"doc.command.switch-mode",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async accessor=>{const commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),renderManagerService=accessor.get(_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.cSx),docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),docDataModel=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr).getCurrentUniverDocInstance();if(null==docDataModel)return!1;const unitId=docDataModel.getUnitId(),skeleton=renderManagerService.getRenderById(unitId)?.with(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.EX).getSkeleton(),docSelectionRenderService=renderManagerService.getRenderById(unitId)?.with(_services_selection_doc_selection_render_service__WEBPACK_IMPORTED_MODULE_3__.q);if(null==skeleton||null==docSelectionRenderService)return!1;const segmentId=docSelectionRenderService?.getSegment(),segmentPage=docSelectionRenderService?.getSegmentPage(),oldDocumentFlavor=docDataModel.getSnapshot().documentStyle.documentFlavor,docRanges=docSelectionManagerService.getDocRanges(),doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges:oldDocumentFlavor===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.CQy.TRADITIONAL&&segmentId?[]:docRanges}},jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),rawActions=[];let action;if(action=void 0===oldDocumentFlavor?jsonX.insertOp(["documentStyle","documentFlavor"],_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.CQy.MODERN):oldDocumentFlavor===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.CQy.MODERN?jsonX.replaceOp(["documentStyle","documentFlavor"],oldDocumentFlavor,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.CQy.TRADITIONAL):jsonX.replaceOp(["documentStyle","documentFlavor"],oldDocumentFlavor,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.CQy.MODERN),!action)return!1;if(rawActions.push(action),oldDocumentFlavor!==_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.CQy.MODERN){const snapshot=docDataModel.getSnapshot(),{drawings={},body}=snapshot,customBlocks=body?.customBlocks??[];for(const drawingId in drawings){const drawing=drawings[drawingId],customBlock=customBlocks.find((block=>block.blockId===drawingId));if(null==customBlock)continue;const drawingPositionV=drawing.docTransform.positionV,{relativeFrom:prevRelativeFrom,posOffset:prevPosOffset}=drawingPositionV;if(prevRelativeFrom===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.egV.PARAGRAPH)continue;const{startIndex}=customBlock,glyph=skeleton.findNodeByCharIndex(startIndex,segmentId,segmentPage),line=glyph?.parent?.parent,column=line?.parent,paragraphStartLine=column?.lines.find((l=>l.paragraphIndex===line?.paragraphIndex&&l.paragraphStart)),page=column?.parent?.parent;if(null==glyph||null==line||null==paragraphStartLine||null==column||null==page)continue;let delta=0;prevRelativeFrom===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.egV.LINE?delta-=line.top:prevRelativeFrom===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.egV.PAGE&&(delta+=page.marginTop),delta+=paragraphStartLine.top;const newPositionV={...drawingPositionV,relativeFrom:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.egV.PARAGRAPH,posOffset:(prevPosOffset??0)-delta},updateDrawingAction=jsonX.replaceOp(["drawings",drawingId,"docTransform","positionV"],drawingPositionV,newPositionV);updateDrawingAction&&rawActions.push(updateDrawingAction)}}doMutation.params.actions=rawActions.reduce(((acc,cur)=>_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.compose(acc,cur)),null);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}}},"../../packages/docs-ui/src/commands/commands/table/doc-table-create.command.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>CreateDocTableCommand});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs/src/index.ts"),_basics_paragraph__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../packages/docs-ui/src/basics/paragraph.ts"),_services_doc_menu_style_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/docs-ui/src/services/doc-menu-style.service.ts"),_util__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/docs-ui/src/commands/util.ts"),_break_line_command__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../packages/docs-ui/src/commands/commands/break-line.command.ts"),_table__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../packages/docs-ui/src/commands/commands/table/table.ts");const CreateDocTableCommand={id:"doc.command.create-table",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>{const{rowCount,colCount}=params,docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),docMenuStyleService=accessor.get(_services_doc_menu_style_service__WEBPACK_IMPORTED_MODULE_2__._),activeRange=docSelectionManagerService.getActiveTextRange();if(null==activeRange)return!1;const{segmentId,segmentPage}=activeRange,docDataModel=univerInstanceService.getCurrentUniverDocInstance(),body=docDataModel?.getSelfOrHeaderFooterModel(segmentId).getBody();if(null==docDataModel||null==body)return!1;const unitId=docDataModel.getUnitId(),docSkeletonManagerService=(0,_util__WEBPACK_IMPORTED_MODULE_3__.R)(accessor,unitId),skeleton=docSkeletonManagerService?.getSkeleton();if(null==skeleton)return!1;const{startOffset}=activeRange,prevParagraph=(body.paragraphs??[]).find((p=>p.startIndex>=startOffset)),curGlyph=skeleton.findNodeByCharIndex(startOffset,segmentId,segmentPage);if(null==curGlyph)return!1;const textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),rawActions=[],cursor=startOffset+4,textRanges=[{startOffset:cursor,endOffset:cursor,collapsed:!0}],doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges}};startOffset>0&&textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:startOffset}),textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.INSERT,body:{dataStream:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.PARAGRAPH,paragraphs:(0,_break_line_command__WEBPACK_IMPORTED_MODULE_4__.X)(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.PARAGRAPH,prevParagraph)},len:1});const defaultTextStyle=docMenuStyleService.getDefaultStyle(),styleCache=docMenuStyleService.getStyleCache(),curTextRun=(0,_basics_paragraph__WEBPACK_IMPORTED_MODULE_6__.nM)(body,startOffset,defaultTextStyle,styleCache),{dataStream:tableDataStream,paragraphs:tableParagraphs,sectionBreaks}=(0,_table__WEBPACK_IMPORTED_MODULE_5__.KJ)(rowCount,colCount),page=curGlyph.parent?.parent?.parent?.parent?.parent;if(null==page)return!1;const{pageWidth,marginLeft,marginRight}=page,tableSource=(0,_table__WEBPACK_IMPORTED_MODULE_5__._h)(rowCount,colCount,pageWidth-marginLeft-marginRight);textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.INSERT,body:{dataStream:tableDataStream,paragraphs:tableParagraphs,sectionBreaks,textRuns:[{...curTextRun,st:0,ed:tableDataStream.length}],tables:[{startIndex:0,endIndex:tableDataStream.length,tableId:tableSource.tableId}]},len:tableDataStream.length});const path=(0,_util__WEBPACK_IMPORTED_MODULE_3__.J)(docDataModel,segmentId);rawActions.push(jsonX.editOp(textX.serialize(),path));const insertTableSource=jsonX.insertOp(["tableSource",tableSource.tableId],tableSource);rawActions.push(insertTableSource),doMutation.params.actions=rawActions.reduce(((acc,cur)=>_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.compose(acc,cur)),null);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}}},"../../packages/docs-ui/src/commands/commands/table/doc-table-delete.command.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ws:()=>DocTableDeleteColumnsCommand,dK:()=>DocTableDeleteTableCommand,er:()=>DocTableDeleteRowsCommand});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs/src/index.ts"),_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/docs-ui/src/commands/util.ts"),_table__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/docs-ui/src/commands/commands/table/table.ts");const DocTableDeleteRowsCommand={id:"doc.table.delete-rows",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async accessor=>{const docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),activeRectRanges=docSelectionManagerService.getRectRanges(),activeTextRange=docSelectionManagerService.getActiveTextRange(),rangeInfo=(0,_table__WEBPACK_IMPORTED_MODULE_3__.o0)(activeTextRange,activeRectRanges);if(null==rangeInfo)return!1;const{segmentId}=rangeInfo,docDataModel=univerInstanceService.getCurrentUniverDocInstance(),body=docDataModel?.getSelfOrHeaderFooterModel(segmentId).getBody();if(null==docDataModel||null==body)return!1;const docSkeletonManagerService=(0,_util__WEBPACK_IMPORTED_MODULE_2__.R)(accessor,docDataModel.getUnitId());if(null==docSkeletonManagerService)return!1;const viewModel=docSkeletonManagerService.getViewModel(),unitId=docDataModel?.getUnitId(),textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),actionParams=(0,_table__WEBPACK_IMPORTED_MODULE_3__.cC)(rangeInfo,viewModel);if(null==actionParams)return!1;const{offset,rowIndexes,len,tableId,cursor,selectWholeTable}=actionParams;if(selectWholeTable)return commandService.executeCommand(DocTableDeleteTableCommand.id);const rawActions=[],textRanges=[{startOffset:cursor,endOffset:cursor,collapsed:!0}],doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges}};offset>0&&textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:offset}),textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.DELETE,len});const path=(0,_util__WEBPACK_IMPORTED_MODULE_2__.J)(docDataModel,segmentId);rawActions.push(jsonX.editOp(textX.serialize(),path));for(const index of rowIndexes.reverse()){const action=jsonX.removeOp(["tableSource",tableId,"tableRows",index]);rawActions.push(action)}doMutation.params.actions=rawActions.reduce(((acc,cur)=>_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.compose(acc,cur)),null);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}},DocTableDeleteColumnsCommand={id:"doc.table.delete-columns",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async accessor=>{const docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),activeRectRanges=docSelectionManagerService.getRectRanges(),activeTextRange=docSelectionManagerService.getActiveTextRange(),rangeInfo=(0,_table__WEBPACK_IMPORTED_MODULE_3__.o0)(activeTextRange,activeRectRanges);if(null==rangeInfo)return!1;const{segmentId}=rangeInfo,docDataModel=univerInstanceService.getCurrentUniverDocInstance(),body=docDataModel?.getSelfOrHeaderFooterModel(segmentId).getBody();if(null==docDataModel||null==body)return!1;const docSkeletonManagerService=(0,_util__WEBPACK_IMPORTED_MODULE_2__.R)(accessor,docDataModel.getUnitId());if(null==docSkeletonManagerService)return!1;const viewModel=docSkeletonManagerService.getViewModel(),unitId=docDataModel?.getUnitId(),textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),actionParams=(0,_table__WEBPACK_IMPORTED_MODULE_3__.lL)(rangeInfo,viewModel);if(null==actionParams)return!1;const{offsets,columnIndexes,tableId,cursor,rowCount,selectWholeTable}=actionParams;if(selectWholeTable)return commandService.executeCommand(DocTableDeleteTableCommand.id);const rawActions=[],textRanges=[{startOffset:cursor,endOffset:cursor,collapsed:!0}],doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges}};for(const offset of offsets){const{retain,delete:deleteLen}=offset;retain>0&&textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:retain}),textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.DELETE,len:deleteLen})}const path=(0,_util__WEBPACK_IMPORTED_MODULE_2__.J)(docDataModel,segmentId);rawActions.push(jsonX.editOp(textX.serialize(),path)),columnIndexes.reverse();for(let i=0;i<rowCount;i++)for(const index of columnIndexes){const action=jsonX.removeOp(["tableSource",tableId,"tableRows",i,"tableCells",index]);rawActions.push(action)}for(const index of columnIndexes){const action=jsonX.removeOp(["tableSource",tableId,"tableColumns",index]);rawActions.push(action)}doMutation.params.actions=rawActions.reduce(((acc,cur)=>_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.compose(acc,cur)),null);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}},DocTableDeleteTableCommand={id:"doc.table.delete-table",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async accessor=>{const docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),activeRectRanges=docSelectionManagerService.getRectRanges(),activeTextRange=docSelectionManagerService.getActiveTextRange(),rangeInfo=(0,_table__WEBPACK_IMPORTED_MODULE_3__.o0)(activeTextRange,activeRectRanges);if(null==rangeInfo)return!1;const{segmentId}=rangeInfo,docDataModel=univerInstanceService.getCurrentUniverDocInstance(),body=docDataModel?.getSelfOrHeaderFooterModel(segmentId).getBody();if(null==docDataModel||null==body)return!1;const docSkeletonManagerService=(0,_util__WEBPACK_IMPORTED_MODULE_2__.R)(accessor,docDataModel.getUnitId());if(null==docSkeletonManagerService)return!1;const viewModel=docSkeletonManagerService.getViewModel(),unitId=docDataModel?.getUnitId(),textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),actionParams=(0,_table__WEBPACK_IMPORTED_MODULE_3__.Co)(rangeInfo,viewModel);if(null==actionParams)return!1;const{offset,len,tableId,cursor}=actionParams,rawActions=[],textRanges=[{startOffset:cursor,endOffset:cursor,collapsed:!0}],doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges}};offset>0&&textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:offset}),textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.DELETE,len});const path=(0,_util__WEBPACK_IMPORTED_MODULE_2__.J)(docDataModel,segmentId);rawActions.push(jsonX.editOp(textX.serialize(),path));const action=jsonX.removeOp(["tableSource",tableId]);rawActions.push(action),doMutation.params.actions=rawActions.reduce(((acc,cur)=>_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.compose(acc,cur)),null);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}}},"../../packages/docs-ui/src/commands/commands/table/doc-table-insert.command.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{UG:()=>DocTableInsertColumnLeftCommand,X2:()=>DocTableInsertColumnRightCommand,k1:()=>DocTableInsertRowAboveCommand,mZ:()=>DocTableInsertRowBellowCommand,tI:()=>DocTableInsertColumnCommand,vc:()=>DocTableInsertRowCommand});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs/src/index.ts"),_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/docs-ui/src/commands/util.ts"),_table__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/docs-ui/src/commands/commands/table/table.ts");const DocTableInsertRowAboveCommand={id:"doc.command.table-insert-row-above",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async accessor=>accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY).executeCommand("doc.command.table-insert-row",{position:_table__WEBPACK_IMPORTED_MODULE_3__.xP.ABOVE})},DocTableInsertRowBellowCommand={id:"doc.command.table-insert-row-bellow",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async accessor=>accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY).executeCommand("doc.command.table-insert-row",{position:_table__WEBPACK_IMPORTED_MODULE_3__.xP.BELLOW})},DocTableInsertColumnLeftCommand={id:"doc.command.table-insert-column-left",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async accessor=>accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY).executeCommand("doc.command.table-insert-column",{position:_table__WEBPACK_IMPORTED_MODULE_3__.$s.LEFT})},DocTableInsertColumnRightCommand={id:"doc.command.table-insert-column-right",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async accessor=>accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY).executeCommand("doc.command.table-insert-column",{position:_table__WEBPACK_IMPORTED_MODULE_3__.$s.RIGHT})},DocTableInsertRowCommand={id:"doc.command.table-insert-row",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>{const{position}=params,docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),activeRectRanges=docSelectionManagerService.getRectRanges(),activeTextRange=docSelectionManagerService.getActiveTextRange(),rangeInfo=(0,_table__WEBPACK_IMPORTED_MODULE_3__.o0)(activeTextRange,activeRectRanges);if(null==rangeInfo)return!1;const{segmentId}=rangeInfo,docDataModel=univerInstanceService.getCurrentUnitForType(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC),body=docDataModel?.getSelfOrHeaderFooterModel(segmentId).getBody();if(null==docDataModel||null==body)return!1;const docSkeletonManagerService=(0,_util__WEBPACK_IMPORTED_MODULE_2__.R)(accessor,docDataModel.getUnitId());if(null==docSkeletonManagerService)return!1;const viewModel=docSkeletonManagerService.getViewModel(),unitId=docDataModel?.getUnitId(),textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),actionParams=(0,_table__WEBPACK_IMPORTED_MODULE_3__.T4)(rangeInfo,position,viewModel);if(null==actionParams)return!1;const{offset,colCount,tableId,insertRowIndex}=actionParams,rawActions=[],cursor=offset+2,textRanges=[{startOffset:cursor,endOffset:cursor,collapsed:!0}],doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges}};offset>0&&textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:offset});const insertBody=(0,_table__WEBPACK_IMPORTED_MODULE_3__.Iq)(colCount);textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.INSERT,body:insertBody,len:insertBody.dataStream.length});const path=(0,_util__WEBPACK_IMPORTED_MODULE_2__.J)(docDataModel,segmentId);rawActions.push(jsonX.editOp(textX.serialize(),path));const insertRow=(0,_table__WEBPACK_IMPORTED_MODULE_3__.uy)(colCount),insertTableSource=jsonX.insertOp(["tableSource",tableId,"tableRows",insertRowIndex],insertRow);rawActions.push(insertTableSource),doMutation.params.actions=rawActions.reduce(((acc,cur)=>_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.compose(acc,cur)),null);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}},DocTableInsertColumnCommand={id:"doc.command.table-insert-column",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async(accessor,params)=>{const{position}=params,docSelectionManagerService=accessor.get(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv),univerInstanceService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),activeRectRanges=docSelectionManagerService.getRectRanges(),activeTextRange=docSelectionManagerService.getActiveTextRange(),rangeInfo=(0,_table__WEBPACK_IMPORTED_MODULE_3__.o0)(activeTextRange,activeRectRanges);if(null==rangeInfo)return!1;const{segmentId}=rangeInfo,docDataModel=univerInstanceService.getCurrentUniverDocInstance(),body=docDataModel?.getSelfOrHeaderFooterModel(segmentId).getBody();if(null==docDataModel||null==body)return!1;const docSkeletonManagerService=(0,_util__WEBPACK_IMPORTED_MODULE_2__.R)(accessor,docDataModel.getUnitId());if(null==docSkeletonManagerService)return!1;const viewModel=docSkeletonManagerService.getViewModel(),unitId=docDataModel?.getUnitId(),textX=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Uuf,jsonX=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.getInstance(),actionParams=(0,_table__WEBPACK_IMPORTED_MODULE_3__.nF)(rangeInfo,position,viewModel);if(null==actionParams)return!1;const{offsets,columnIndex,tableId,rowCount}=actionParams,rawActions=[],cursor=offsets[0]+1,textRanges=[{startOffset:cursor,endOffset:cursor,collapsed:!0}],doMutation={id:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.Bz.id,params:{unitId,actions:[],textRanges}};for(const offset of offsets){textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.RETAIN,len:offset});const insertBody=(0,_table__WEBPACK_IMPORTED_MODULE_3__.G4)();textX.push({t:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sHL.INSERT,body:insertBody,len:insertBody.dataStream.length})}const path=(0,_util__WEBPACK_IMPORTED_MODULE_2__.J)(docDataModel,segmentId);rawActions.push(jsonX.editOp(textX.serialize(),path));for(let i=0;i<rowCount;i++){const insertCell=(0,_table__WEBPACK_IMPORTED_MODULE_3__.WY)(),insertTableSource=jsonX.insertOp(["tableSource",tableId,"tableRows",i,"tableCells",columnIndex],insertCell);rawActions.push(insertTableSource)}const snapshot=docDataModel.getSnapshot(),documentStyle=snapshot.documentStyle,{marginLeft=0,marginRight=0}=documentStyle,pageWidth=(documentStyle.pageSize?.width??800)-marginLeft-marginRight,tableColumns=snapshot?.tableSource?.[tableId].tableColumns,{newColWidth,widths}=(0,_table__WEBPACK_IMPORTED_MODULE_3__.qY)(pageWidth,tableColumns,columnIndex);for(let i=0;i<widths.length;i++){const action=jsonX.replaceOp(["tableSource",tableId,"tableColumns",i,"size","width","v"],tableColumns[i].size.width.v,widths[i]);rawActions.push(action)}const insertCol=(0,_table__WEBPACK_IMPORTED_MODULE_3__.Jr)(newColWidth),insertTableColumn=jsonX.insertOp(["tableSource",tableId,"tableColumns",columnIndex],insertCol);rawActions.push(insertTableColumn),doMutation.params.actions=rawActions.reduce(((acc,cur)=>_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rRQ.compose(acc,cur)),null);const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return Boolean(result)}}},"../../packages/docs-ui/src/commands/commands/table/table.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$s:()=>INSERT_COLUMN_POSITION,Co:()=>getDeleteTableActionParams,G4:()=>getInsertColumnBody,Gn:()=>CellPosition,Iq:()=>getInsertRowBody,Jr:()=>getTableColumn,KJ:()=>genEmptyTable,T4:()=>getInsertRowActionsParams,WY:()=>getEmptyTableCell,_h:()=>genTableSource,cC:()=>getDeleteRowsActionsParams,lL:()=>getDeleteColumnsActionParams,nF:()=>getInsertColumnActionsParams,nx:()=>getDeleteRowContentActionParams,o0:()=>getRangeInfoFromRanges,qY:()=>getColumnWidths,uy:()=>getEmptyTableRow,xP:()=>INSERT_ROW_POSITION,z3:()=>getCellOffsets});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),INSERT_ROW_POSITION=function(INSERT_ROW_POSITION){return INSERT_ROW_POSITION[INSERT_ROW_POSITION.ABOVE=0]="ABOVE",INSERT_ROW_POSITION[INSERT_ROW_POSITION.BELLOW=1]="BELLOW",INSERT_ROW_POSITION}({}),INSERT_COLUMN_POSITION=function(INSERT_COLUMN_POSITION){return INSERT_COLUMN_POSITION[INSERT_COLUMN_POSITION.LEFT=0]="LEFT",INSERT_COLUMN_POSITION[INSERT_COLUMN_POSITION.RIGHT=1]="RIGHT",INSERT_COLUMN_POSITION}({});function genEmptyTable(rowCount,colCount){let dataStream=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.TABLE_START;const paragraphs=[],sectionBreaks=[];for(let i=0;i<rowCount;i++){dataStream+=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.TABLE_ROW_START;for(let j=0;j<colCount;j++)dataStream+=`${_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.TABLE_CELL_START}\r\n${_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.TABLE_CELL_END}`,paragraphs.push({startIndex:dataStream.length-3,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),sectionBreaks.push({startIndex:dataStream.length-2});dataStream+=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.TABLE_ROW_END}return dataStream+=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.TABLE_END,{dataStream,paragraphs,sectionBreaks}}function getEmptyTableCell(){return{margin:{start:{v:10},end:{v:10},top:{v:5},bottom:{v:5}}}}function getEmptyTableRow(col){const tableCell={margin:{start:{v:10},end:{v:10},top:{v:5},bottom:{v:5}}};return{tableCells:[...new Array(col).fill(null).map((()=>_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.deepClone(tableCell)))],trHeight:{val:{v:30},hRule:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.SS3.AUTO}}}function getTableColumn(width){return{size:{type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.ad1.SPECIFIED,width:{v:width}}}}function genTableSource(rowCount,colCount,pageContentWidth){const tableColumn=getTableColumn(pageContentWidth/colCount),tableRow=getEmptyTableRow(colCount);return{tableRows:[...new Array(rowCount).fill(null).map((()=>_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.deepClone(tableRow)))],tableColumns:[...new Array(colCount).fill(null).map((()=>_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.deepClone(tableColumn)))],tableId:(0,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.MZQ)(6),align:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.y0g.START,indent:{v:0},textWrap:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.eCA.NONE,position:{positionH:{relativeFrom:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.sUw.PAGE,posOffset:0},positionV:{relativeFrom:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.egV.PAGE,posOffset:0}},dist:{distB:0,distL:0,distR:0,distT:0},cellMargin:{start:{v:10},end:{v:10},top:{v:5},bottom:{v:5}},size:{type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.ad1.UNSPECIFIED,width:{v:pageContentWidth}}}}function getRangeInfoFromRanges(textRange,rectRanges){if(!textRange&&!rectRanges)return null;if(rectRanges&&rectRanges.length>0){let startOffset=Number.POSITIVE_INFINITY,endOffset=Number.NEGATIVE_INFINITY;const segmentId="";for(const rectRange of rectRanges){const{startOffset:st,endOffset:ed,segmentId:sid}=rectRange;null!=st&&null!=ed&&null!=sid&&(startOffset=Math.min(startOffset,st),endOffset=Math.max(endOffset,ed))}if(Number.isFinite(startOffset)&&Number.isFinite(endOffset))return{startOffset,endOffset,segmentId}}else if(textRange){const{startOffset,endOffset,segmentId}=textRange;return null==startOffset||null==endOffset||null==segmentId?null:{startOffset,endOffset,segmentId}}}function getInsertRowBody(col){let dataStream=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.TABLE_ROW_START;const paragraphs=[],sectionBreaks=[];for(let i=0;i<col;i++)dataStream+=`${_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.TABLE_CELL_START}\r\n${_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.TABLE_CELL_END}`,paragraphs.push({startIndex:dataStream.length-3,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),sectionBreaks.push({startIndex:dataStream.length-2});return dataStream+=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.TABLE_ROW_END,{dataStream,paragraphs,sectionBreaks}}function getInsertColumnBody(){const dataStream=`${_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.TABLE_CELL_START}\r\n${_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.TABLE_CELL_END}`,paragraphs=[],sectionBreaks=[];return paragraphs.push({startIndex:1,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),sectionBreaks.push({startIndex:2}),{dataStream,paragraphs,sectionBreaks}}function getInsertRowActionsParams(rangeInfo,position,viewModel){const{startOffset,endOffset,segmentId}=rangeInfo,vm=viewModel.getSelfOrHeaderFooterViewModel(segmentId),index=0===position?startOffset:endOffset;let tableRow=null;const tableId=viewModel.getBody()?.tables?.find((t=>index>=t.startIndex&&index<=t.endIndex))?.tableId;let rowIndex=0;for(const section of vm.getChildren()){for(const paragraph of section.children){const{children}=paragraph,table=children[0];if(table)for(const row of table.children)if(row.startIndex<=index&&index<=row.endIndex){rowIndex=table.children.indexOf(row),tableRow=row;break}if(tableRow)break}if(tableRow)break}return null==tableRow||null==tableId?null:{offset:0===position?tableRow.startIndex:tableRow.endIndex+1,colCount:tableRow.children.length,tableId,insertRowIndex:0===position?rowIndex:rowIndex+1}}function getInsertColumnActionsParams(rangeInfo,position,viewModel){const{startOffset,endOffset,segmentId}=rangeInfo,vm=viewModel.getSelfOrHeaderFooterViewModel(segmentId),index=0===position?startOffset:endOffset,tableId=viewModel.getBody()?.tables?.find((t=>index>=t.startIndex&&index<=t.endIndex))?.tableId,offsets=[];let table=null,columnIndex=-1;for(const section of vm.getChildren()){for(const paragraph of section.children){const{children}=paragraph,tableNode=children[0];if(tableNode){if(index<tableNode.startIndex||index>tableNode.endIndex)continue;table=tableNode;for(const row of tableNode.children){for(const cell of row.children){const cellIndex=row.children.indexOf(cell);if(index>=cell.startIndex&&index<=cell.endIndex){columnIndex=cellIndex;break}}if(-1!==columnIndex)break}}if(table)break}if(table)break}if(null==table||null==tableId||-1===columnIndex)return null;let cursor=0;for(const row of table.children){const cell=row.children[columnIndex],insertIndex=0===position?cell.startIndex:cell.endIndex+1;offsets.push(insertIndex-cursor),cursor=insertIndex}return{offsets,tableId,columnIndex,rowCount:table.children.length}}function getColumnWidths(pageWidth,tableColumns,insertColumnIndex){const widths=[];let newColWidth=tableColumns[insertColumnIndex].size.width.v,totalWidth=0;for(let i=0;i<tableColumns.length;i++)totalWidth+=tableColumns[i].size.width.v;totalWidth+=newColWidth;for(let i=0;i<tableColumns.length;i++)widths.push(tableColumns[i].size.width.v/totalWidth*pageWidth);return newColWidth=newColWidth/totalWidth*pageWidth,{widths,newColWidth}}function getDeleteRowsActionsParams(rangeInfo,viewModel){const{startOffset,endOffset,segmentId}=rangeInfo,vm=viewModel.getSelfOrHeaderFooterViewModel(segmentId),tableId=viewModel.getBody()?.tables?.find((t=>startOffset>=t.startIndex&&endOffset<=t.endIndex))?.tableId,rowIndexes=[];let offset=-1,len=0,cursor=-1,selectWholeTable=!1;for(const section of vm.getChildren()){for(const paragraph of section.children){const{children}=paragraph,table=children[0];if(table){if(startOffset<table.startIndex||endOffset>table.endIndex)continue;cursor=table.startIndex+3;for(const row of table.children){const rowIndex=table.children.indexOf(row),{startIndex,endIndex}=row;startOffset>=startIndex&&startOffset<=endIndex?(offset=startIndex,rowIndexes.push(rowIndex),len+=endIndex-startIndex+1):(startIndex>startOffset&&endIndex<endOffset||endOffset>=startIndex&&endOffset<=endIndex)&&(rowIndexes.push(rowIndex),len+=endIndex-startIndex+1),rowIndexes.length===table.children.length&&(selectWholeTable=!0)}}if(rowIndexes.length)break}if(rowIndexes.length)break}return null==tableId||0===rowIndexes.length?null:{tableId,rowIndexes,offset,len,cursor,selectWholeTable}}function getDeleteColumnsActionParams(rangeInfo,viewModel){const{startOffset,endOffset,segmentId}=rangeInfo,vm=viewModel.getSelfOrHeaderFooterViewModel(segmentId),tableId=viewModel.getBody()?.tables?.find((t=>startOffset>=t.startIndex&&endOffset<=t.endIndex))?.tableId,offsets=[];let table=null;const columnIndexes=[];let cursor=-1,startColumnIndex=-1,endColumnIndex=-1;for(const section of vm.getChildren()){for(const paragraph of section.children){const{children}=paragraph,tableNode=children[0];if(tableNode){if(startOffset<tableNode.startIndex||endOffset>tableNode.endIndex)continue;table=tableNode;for(const row of tableNode.children)for(const cell of row.children){const cellIndex=row.children.indexOf(cell);startOffset>=cell.startIndex&&startOffset<=cell.endIndex&&(startColumnIndex=cellIndex),endOffset>=cell.startIndex&&endOffset<=cell.endIndex&&(endColumnIndex=cellIndex)}}if(table)break}if(table)break}if(null==table||null==tableId)return null;for(let i=startColumnIndex;i<=endColumnIndex;i++)columnIndexes.push(i);let delta=0;for(const row of table.children){const startCell=row.children[startColumnIndex],endCell=row.children[endColumnIndex];offsets.push({retain:startCell.startIndex-delta,delete:endCell.endIndex-startCell.startIndex+1}),delta=endCell.endIndex+1}return cursor=table.startIndex+3,{offsets,tableId,columnIndexes,cursor,selectWholeTable:columnIndexes.length===table.children[0].children.length,rowCount:table.children.length}}function getDeleteTableActionParams(rangeInfo,viewModel){const{startOffset,endOffset,segmentId}=rangeInfo,vm=viewModel.getSelfOrHeaderFooterViewModel(segmentId),tableId=viewModel.getBody()?.tables?.find((t=>startOffset>=t.startIndex&&endOffset<=t.endIndex))?.tableId;let offset=-1,len=0,cursor=-1;for(const section of vm.getChildren()){for(const paragraph of section.children){const{children}=paragraph,table=children[0];if(table){if(startOffset<table.startIndex||endOffset>table.endIndex)continue;offset=table.startIndex,len=table.endIndex-table.startIndex+1,cursor=table.startIndex}if(table)break}if(len>0)break}return null==tableId?null:{tableId,offset,len,cursor}}function getDeleteRowContentActionParams(rangeInfo,viewModel){const{startOffset,endOffset,segmentId}=rangeInfo,vm=viewModel.getSelfOrHeaderFooterViewModel(segmentId),tableId=viewModel.getBody()?.tables?.find((t=>startOffset>=t.startIndex&&endOffset<=t.endIndex))?.tableId,offsets=[];let table=null,cursor=-1,rowIndex=-1,startColumnIndex=-1,endColumnIndex=-1;for(const section of vm.getChildren()){for(const paragraph of section.children){const{children}=paragraph,tableNode=children[0];if(tableNode){if(startOffset<tableNode.startIndex||endOffset>tableNode.endIndex)continue;table=tableNode;for(const row of tableNode.children){const rIndex=tableNode.children.indexOf(row);for(const cell of row.children){const cellIndex=row.children.indexOf(cell);startOffset>=cell.startIndex&&startOffset<=cell.endIndex&&(rowIndex=rIndex,startColumnIndex=cellIndex),endOffset>=cell.startIndex&&endOffset<=cell.endIndex&&(endColumnIndex=cellIndex)}}}if(table)break}if(table)break}if(null==table||null==tableId||-1===rowIndex)return null;const row=table.children[rowIndex];for(let i=startColumnIndex;i<=endColumnIndex;i++){const cell=row.children[i];offsets.push({retain:cell.startIndex+1,delete:cell.endIndex-cell.startIndex-3})}return cursor=table.startIndex+3,{offsets,tableId,cursor,rowCount:table.children.length}}var CellPosition=function(CellPosition){return CellPosition[CellPosition.NEXT=0]="NEXT",CellPosition[CellPosition.PREV=1]="PREV",CellPosition}({});function getCellOffsets(viewModel,range,position){const{startOffset}=range;let targetTable=null;for(const section of viewModel.getChildren()){for(const paragraph of section.children){const table=paragraph.children[0];if(table&&startOffset>table.startIndex&&startOffset<table.endIndex){targetTable=table;break}}if(targetTable)break}if(null==targetTable)return null;let cellIndex=-1,rowIndex=-1,targetRow=null;for(const row of targetTable.children){for(const cell of row.children)if(startOffset>cell.startIndex&&startOffset<cell.endIndex){cellIndex=row.children.indexOf(cell),rowIndex=targetTable.children.indexOf(row),targetRow=row;break}if(cellIndex>-1)break}if(-1===cellIndex||-1===rowIndex||null==targetRow)return null;let newCell=null;if(0===position){if(newCell=targetRow.children[cellIndex+1],!newCell){const nextRow=targetTable.children[rowIndex+1];nextRow&&(newCell=nextRow.children[0])}}else if(newCell=targetRow.children[cellIndex-1],!newCell){const prevRow=targetTable.children[rowIndex-1];prevRow&&(newCell=prevRow.children[prevRow.children.length-1])}if(newCell){const{startIndex,endIndex}=newCell;return{startOffset:startIndex+1,endOffset:endIndex-2}}}},"../../packages/docs-ui/src/commands/operations/doc-create-table.operation.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>DocCreateTableOperation});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/ui/src/index.ts"),_views_table_create_component_name__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/docs-ui/src/views/table/create/component-name.ts"),_commands_table_doc_table_create_command__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/docs-ui/src/commands/commands/table/doc-table-create.command.ts");const DocCreateTableOperation={id:"doc.operation.create-table",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.COMMAND,handler:async accessor=>{const localeService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.iH9),confirmService=accessor.get(_univerjs_ui__WEBPACK_IMPORTED_MODULE_1__.rQ),commandService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),tableCreateParams={rowCount:3,colCount:5};return await confirmService.open({id:"doc.component.create-table-confirm",children:{label:{name:_views_table_create_component_name__WEBPACK_IMPORTED_MODULE_3__.i,props:{handleRowColChange:(rowCount,colCount)=>{tableCreateParams.rowCount=rowCount,tableCreateParams.colCount=colCount},tableCreateParams}}},width:400,title:{title:localeService.t("toolbar.table.insert")},onConfirm:()=>{commandService.executeCommand(_commands_table_doc_table_create_command__WEBPACK_IMPORTED_MODULE_2__.A.id,tableCreateParams),confirmService.close("doc.component.create-table-confirm")},onClose:()=>{confirmService.close("doc.component.create-table-confirm")}}),!0}}},"../../packages/docs-ui/src/commands/operations/doc-header-footer-panel.operation.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Q:()=>SidebarDocHeaderFooterPanelOperation});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/ui/src/index.ts"),_views_header_footer_panel_component_name__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/docs-ui/src/views/header-footer/panel/component-name.ts");const SidebarDocHeaderFooterPanelOperation={id:"sidebar.operation.doc-header-footer-panel",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.OPERATION,handler:async(accessor,params)=>{const sidebarService=accessor.get(_univerjs_ui__WEBPACK_IMPORTED_MODULE_1__.Jj),localeService=accessor.get(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.iH9);if("open"===params.value)sidebarService.open({header:{title:localeService.t("headerFooter.panel")},children:{label:_views_header_footer_panel_component_name__WEBPACK_IMPORTED_MODULE_2__.O},onClose:()=>{},width:400});else sidebarService.close();return!0}}},"../../packages/docs-ui/src/commands/operations/doc-paragraph-setting-panel.operation.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{I:()=>DocParagraphSettingPanelOperation});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_controllers_doc_paragraph_setting_controller__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs-ui/src/controllers/doc-paragraph-setting.controller.ts");const DocParagraphSettingPanelOperation={id:"sidebar.operation.doc-paragraph-setting-panel",type:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.g4t.OPERATION,handler:accessor=>(accessor.get(_controllers_doc_paragraph_setting_controller__WEBPACK_IMPORTED_MODULE_1__.B).openPanel(),!0)}},"../../packages/docs-ui/src/commands/util.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{J:()=>getRichTextEditPath,R:()=>getCommandSkeleton});var _univerjs_docs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/docs/src/index.ts"),_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/engine-render/src/index.ts");function getCommandSkeleton(accessor,unitId){const renderManagerService=accessor.get(_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.cSx);return renderManagerService.getRenderById(unitId)?.with(_univerjs_docs__WEBPACK_IMPORTED_MODULE_0__.EX)}function getRichTextEditPath(docDataModel,segmentId=""){if(!segmentId)return["body"];const{headers,footers}=docDataModel.getSnapshot();if(null==headers&&null==footers)throw new Error("Document data model must have headers or footers when update by segment id");if(null!=headers?.[segmentId])return["headers",segmentId,"body"];if(null!=footers?.[segmentId])return["footers",segmentId,"body"];throw new Error("Segment id not found in headers or footers")}},"../../packages/docs-ui/src/components/color-picker/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{X:()=>COLOR_PICKER_COMPONENT,s:()=>src.sk});const COLOR_PICKER_COMPONENT=`${__webpack_require__("../../packages/docs-ui/src/components/const.ts").F}_COLOR_PICKER_COMPONENT`;var src=__webpack_require__("../../packages/design/src/index.ts")},"../../packages/docs-ui/src/components/const.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{F:()=>COMPONENT_PREFIX});const COMPONENT_PREFIX="UI_PLUGIN_DOCS"},"../../packages/docs-ui/src/components/float-toolbar/FloatToolbar.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{G:()=>FloatToolbar});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/react@19.0.0/node_modules/react/jsx-runtime.js"),_univerjs_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/ui/src/index.ts"),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/.pnpm/react@19.0.0/node_modules/react/index.js"),_commands_commands_inline_format_command__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/docs-ui/src/commands/commands/inline-format.command.ts");const DEFAULT_AVALIABLE_MENUS=[_commands_commands_inline_format_command__WEBPACK_IMPORTED_MODULE_3__.vp.id,_commands_commands_inline_format_command__WEBPACK_IMPORTED_MODULE_3__.mZ.id,_commands_commands_inline_format_command__WEBPACK_IMPORTED_MODULE_3__.D6.id,_commands_commands_inline_format_command__WEBPACK_IMPORTED_MODULE_3__._H.id,_commands_commands_inline_format_command__WEBPACK_IMPORTED_MODULE_3__.uk.id,_commands_commands_inline_format_command__WEBPACK_IMPORTED_MODULE_3__.rF.id,_commands_commands_inline_format_command__WEBPACK_IMPORTED_MODULE_3__.xL.id,_commands_commands_inline_format_command__WEBPACK_IMPORTED_MODULE_3__.yS.id,_commands_commands_inline_format_command__WEBPACK_IMPORTED_MODULE_3__.Qo.id,_commands_commands_inline_format_command__WEBPACK_IMPORTED_MODULE_3__.Ag.id];function FloatToolbar(props){const{avaliableMenus=DEFAULT_AVALIABLE_MENUS}=props,menuManagerService=(0,_univerjs_ui__WEBPACK_IMPORTED_MODULE_1__.fJ)(_univerjs_ui__WEBPACK_IMPORTED_MODULE_1__.Zi),[menus,setMenus]=(0,react__WEBPACK_IMPORTED_MODULE_2__.useState)([]);return(0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)((()=>{function getRibbon(){const flatMenus=menuManagerService.getFlatMenuByPositionKey(_univerjs_ui__WEBPACK_IMPORTED_MODULE_1__.KT.RIBBON),menus=[];for(const key of avaliableMenus){const item=flatMenus.find((item=>item.key===key));item&&menus.push(item)}setMenus(menus)}getRibbon();const subscription=menuManagerService.menuChanged$.subscribe(getRibbon);return()=>{subscription.unsubscribe()}}),[menuManagerService]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"\n              univer-box-border univer-flex univer-rounded-xl univer-border univer-border-solid univer-border-gray-200\n              univer-bg-white univer-p-2\n              univer-shadow-[0_1px_6px_-2px_rgba(30,40,77,0.08),0_2px_6px_-1px_rgba(30,40,77,0.10)]\n            ",children:menus.map((groupItem=>groupItem.item&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"univer-flex univer-flex-nowrap univer-gap-2 univer-px-2",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_univerjs_ui__WEBPACK_IMPORTED_MODULE_1__.Tm,{...groupItem.item},groupItem.key)},groupItem.key)))})}FloatToolbar.__docgenInfo={description:"",methods:[],displayName:"FloatToolbar",props:{avaliableMenus:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""}}}},"../../packages/docs-ui/src/components/font-family/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{fj:()=>FONT_FAMILY_COMPONENT,VI:()=>FONT_FAMILY_ITEM_COMPONENT,ay:()=>src.ay,vK:()=>src.vK});var components_const=__webpack_require__("../../packages/docs-ui/src/components/const.ts");const FONT_FAMILY_COMPONENT=`${components_const.F}_FONT_FAMILY_COMPONENT`,FONT_FAMILY_ITEM_COMPONENT=`${components_const.F}_FONT_FAMILY_ITEM_COMPONENT`;var src=__webpack_require__("../../packages/ui/src/index.ts")},"../../packages/docs-ui/src/components/font-size/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{K:()=>FONT_SIZE_COMPONENT,Z:()=>src.Z4});const FONT_SIZE_COMPONENT=`${__webpack_require__("../../packages/docs-ui/src/components/const.ts").F}_FONT_SIZE_COMPONENT`;var src=__webpack_require__("../../packages/ui/src/index.ts")},"../../packages/docs-ui/src/components/list-type-picker/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{n_:()=>BULLET_LIST_TYPE_COMPONENT,hT:()=>BulletListTypePicker,$t:()=>ORDER_LIST_TYPE_COMPONENT,BI:()=>OrderListTypePicker});var components_const=__webpack_require__("../../packages/docs-ui/src/components/const.ts"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@19.0.0/node_modules/react/jsx-runtime.js"),src=__webpack_require__("../../packages/core/src/index.ts"),design_src=__webpack_require__("../../packages/design/src/index.ts"),injectStylesIntoStyleTag=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),styleDomAPI=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/styleDomAPI.js"),styleDomAPI_default=__webpack_require__.n(styleDomAPI),insertBySelector=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/insertBySelector.js"),insertBySelector_default=__webpack_require__.n(insertBySelector),setAttributesWithoutAttributes=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),setAttributesWithoutAttributes_default=__webpack_require__.n(setAttributesWithoutAttributes),insertStyleElement=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/insertStyleElement.js"),insertStyleElement_default=__webpack_require__.n(insertStyleElement),styleTagTransform=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/styleTagTransform.js"),styleTagTransform_default=__webpack_require__.n(styleTagTransform),index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/docs-ui/src/components/list-type-picker/index.module.less"),options={};options.styleTagTransform=styleTagTransform_default(),options.setAttributes=setAttributesWithoutAttributes_default(),options.insert=insertBySelector_default().bind(null,"head"),options.domAPI=styleDomAPI_default(),options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(index_module.A,options);const list_type_picker_index_module=index_module.A&&index_module.A.locals?index_module.A.locals:void 0,ListTypePicker=props=>{const{value,onChange,options}=props;return(0,jsx_runtime.jsx)("div",{className:(0,design_src.$z)(list_type_picker_index_module.docListTypePicker,"univer-theme"),children:options.map((item=>(0,jsx_runtime.jsx)("img",{className:list_type_picker_index_module.docListTypePickerItem+(value===item.value?`\n                              ${list_type_picker_index_module.docListTypePickerItemActive}\n                            `:""),onClick:()=>{onChange(item.value)},src:item.img},item.value)))})},orderListOptions=[{value:src.yrS.ORDER_LIST,img:"data:image/jpeg;base64,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"},{value:src.yrS.ORDER_LIST_1,img:"data:image/jpeg;base64,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"},{value:src.yrS.ORDER_LIST_2,img:"data:image/jpeg;base64,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"},{value:src.yrS.ORDER_LIST_3,img:"data:image/jpeg;base64,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"},{value:src.yrS.ORDER_LIST_4,img:"data:image/jpeg;base64,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"},{value:src.yrS.ORDER_LIST_5,img:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAgEA2ADYAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/CABEIAPQA2AMBEQACEQEDEQH/xAAyAAEAAgMBAQAAAAAAAAAAAAAABwkGCAoFBAEBAAMBAQAAAAAAAAAAAAAAAAIDBAEF/9oADAMBAAIQAxAAAADv4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKxr669bobzVSoz11dlPmagAAAAAAAAAAOavdn6VMOjmr3Z/hOmLDoA1JAAAAAAAMuNiAAc6e2i1LPZV5orjzvLxst0qx7Ise4WAAAAAAAfaZOAD4SqvRXatnshmcfV53N+dybgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUfaqa/b4dVPn6Pa50QUYwAAAAZOTqAAAAAcuu/PXpdX1vedp2rrn9hgp5YAAAB6hnQAAAABVJorw7vNpa5bh1zyTgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADWyccN63FrkAAAAAAAAAAABqpZHBu83kqmIeMeAMhJhAAAAAAAABoNdCK5Rs6z2+mRieKAe0ScAAAAAAAACEp8gGUfj633pmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEsuUX66b2cl1al9fnlxma0AAAAAAAAAAc127P0c4tHOXto29qlofdDp/waAIkPiAAAAAAPaJOABzUbs/Svh0c2W7POsJTLDtuee0CDTzwAAAAADISYQAadWwqI0V3AZref7ZRujVLYqE7Ys9gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//EACkQAAAGAgIBAwUAAwAAAAAAAAAFBgcIFwQJAgMWAQoQFSAwQGA3OXD/2gAIAQEAAQgA/k9rc/TDX/HIqVjf8oGb3MFA8nvw9c+zVOy9gsq5QOtNDeVN5yTCMrhRE/X2u93JWbldFrdm4094eKUbN9+zV8fcscePBtdcnDh8+SKIeSKIeSKIeSKIeSKIeSKIeSKIeSKIeSKIeSKIeSKIeSKIeSKIeSKIeSKIIU7OcxVFePl/Zv5RKzbDMgRsuQ/bsfgr0sD3Sd9fb6t8tlejpq7Dl/7lr/G+uYS4l6w8HWWOH+kY0TsIB9mub95mrFeI8V4jxXiPFeI8V4jxXiPFeI8V4jxXiPFeI8V4jxXiPFeI8V4jxXiPBcjU2VZnTn4H2GZYWnRaYExzjaMNS+G5PF1uguLi8oL8EpKXxjSw8lcJFFr7vmwbNSYbU8Z9+0WjEm3KQS6AQX/CJft1s/l5M3sjg085mrm1pZQCWnIyybPi9VJ0hVBR8LJZKQqUhlgYFhrAWGsBYawFhrAWGsBYawFhrAWGsBYawCNWSkNVIW4Gf+POM3o21bSJoxIW2/qBmvaC0QPTGQ/rIZjIyxdZpx5BlxiXm5fgmxSDlviY8Msk0y6oToqhOiqE6KoToqhOiqE6KoToqhOiqE6CZviYjMsY0xPxy106RVlm+WHJzu46LIE57SOq2K5l9rpi9ORh0RHWQKNSCbb5IJRBI7+vmFIj1iZGN6ZIekBJZZE44mNHKHK/ZnS7ixYKF0rXwbzWm/bgyhgfGGQLrfCqcE5Iz7PK8S11ELXUQtdRBKuCcnh9gFeX+ltU/wBZ8/BpN5ceGqCDfPmTnRMoi3FOU+FC3H144zDYVCKhFQhPNx9BOMM2/TkqyRXJSPT3R6PG7gchULr46NeHdrcgMjtbkZi6NSI/m30fRqI0tMtnwe/j7htMdRBxeQxZR6WwkU1KFe5mZY7jWXj0+BhFdoIn7m2XkC/nRE15/wBbef6+j/Sy1Ea/TrtTqf7k/wBiT7tA/b2Mk7+2DX8Wad9frvwmRkmlnJ/fqYp9wJT6hWKan5MnS+nmOfgC3hbwt4W8LeFvC3hbwt4W8LeFvC3gnnH+vHGGU/buR49TSbO9IUnz4aQOy1Zybv5Rks5toLv5UgOzXRrE12apUtD9TqiSb5/Ju2Z9nmpnndNUKIVQohVCiFUKIVQohVCiFUKIVQohVCiFUKIVQohVCiFUKIJVvjkjPsA0y/snfCRodgsbVjG55OuEvuAchFdkbDCEcMmsgNGNCxlZKM2mrcBEE3eJQsEkoqb+C9VpjPV+zyCEnpqm0Ws6Of8ASf/EADoQAAEEAQIEAwYCCgEFAAAAAAQCAwUGAQAHCBESExSUpRWV09TV5QkhEBYXICIjJDNAYDBYWXC1t//aAAgBAQAJPwD/AFOnjbl8Q29G4EBsdw3bbFd9YVl3WuKCcRhk0OIQGYRXoFodRRogxsc5LyT8LXEysQ5OtSYn4tY0lxM+zM2t/h0M2K2+xw/Fy6RfaGdrRrEp7EeGM8S0zA4tzNBDbThbzyXBsOqncQDm2V+4eP2i1Tiuo4UfJOqpF62dgE2S5kQcMRl+ccipasuB2GLinvFmxxxchUFHS0lAFnEbMbk8LXBjuBxMbXbWD787zUqqM7h8RRNmMPKOiaLUbMLZ4qH2vzX4yRILtcHiVljZHMSO1Za6SiUr7v8Aj4derUPuHvLuOwEvn4J20RCaTLRB60JyjD5kSbS4x4RbuXPA991Q6UYMKS/ocMylF8Rm3F4XCOoSVFe19xD99JC4JcAfw4I6maWYyxKsray27gFsdaFMpw2lKUIR+IntAlCE4wlKUpgLPhKUpxywlKcYxjGMYxjGMcsfl+5PzXvQ74+p+a96HfH1PzXvQ74+p+a96HfH1PzXvQ74+p+a96HfH1PzXvQ74+p+a96HfH1PzXvQ74+p+a96HfH1PzXvQ74+p+a96HfH1PzXvQ74+p+a96HfH1PzXvQ74+peUKHc8d3GCDy32V9EcYtHW066pCulaUrT1Jz0qSlWOWcYz+7WJW4j/h88RwVn3ersC0hUsTsduJK05u5SqVKXjkwAVTY2uZew28mKTeHpwxCIiNlCGeKXZtezDFZ/WldlbukQqRyLkBMg3CpqXiMW7N0eS40EzRMweLi5LutwyYT2mtIua1IU4/8AEZ4obRu5Q67LNJakxNma1PXFdAdISplD6Rval2uUdCrW8UPJV+MibAAQQHNtFk/9xXaH/wBDaNWwmobcw8vBwCzI+ElrHLSM7YjPBxMREwkKKXIHGEKS+S5hDSWRQAzTinmRhXXE2Bi1bcboVKDu9KsI45YaZWu2IBmRjSXAZBgWRjiuw+ls2MkhRJKNMQ+BICjGDvsN6iPUJT53UR6hKfO6iPUJT53UR6hKfO6iPUJT53UR6hKfO6iPUJT53UR6hKfO6iPUJT53UR6hKfO6iPUJT53UR6hKfO6iPUJT53UR6hKfO6iPUJT53Ub2C2O52nfGHu9HdaWy5/LeKcaV1NOLT/EjPLnzxyVjGcfuR4MtDywJcZKxUmIwfGycaew4KdHyAJTbopoJorroxYhLTjBDDjjLza21qTngi2qxaUSftZEc6deSNu0meJcLwhOz5Ftd2kSAl51WEROKRiKQwloVAWBWGWWwQ4uKiwxo6NjY4ZgKPjo8JhAwYIIYyGhhAxBmmxxhh222GGG0NNIQ2hKcbYVnc4Hbq6Ru4lIGszBD7Vau0Qy+xG2SNwOSNlEiGyUQ2ytzLjeEur5t55/ltzWd09tLGsB6XqNrCyZHEFRZjR8acwttxgyPkY8xhsgKSjihDxV4z2SEYWvCq5D1CkUqAiarUarXgB4uCrlcgQWIyGhIiOFQ2MDHRseMwIIMyhLbLDSEJxyx/wCCdybvwNcBdH29jLJb+J3bVVVL3Z3yvpqYY0ij0CWRNfrZQRYj2ziMwe2DBsJIrNtkJIy0DHVuCR+IlxX8WG0NL3HoFb354eOMi8J3fYtdLt8w1EGmVa6SrWHqkY5KYh4gNMHAhS8Y7LLmMWEsIWSgZpTq4qyQsXPRi32ssPrj5gFiRCU8yrOVMuqGIby41nOctrzlGc5zj9Ml2BGPB9prwYDvR3QBXnP5jwrjqup1xav4l55c+WOScYxiX9Pi/ktS/p8X8lqX9Pi/ktS/p8X8lqX9Pi/ktS/p8X8lqX9Pi/ktS/p8X8lqX9Pi/ktSXfEf8Z3WvBgNdfaAKeb/AJjIrbqel1tCv4V458uWeac5xn/j4nt5OGfhM4GWKdCj7NcPNyTtduVvtYp7D4spbLnd2hiJ2SpbcmCek6LFAchg4SXog0cmMnzjbTL33elziV3LtdTH24o924h9x9xcy9birAIdebdOUmfmzo/9Xo+PGXHtWA8JoVm1yUMKA5k5XQ3uxRNnKK9SNrayNaNwbFH1yJLsMtTg346ECIkHmvGypQsfInIBES8SmOjZKRcbQDHmkMHBykVKBiyMZJxxTBsfIx5rCCQzgTBlujFhljOtkClDuOMPsOIdaWttaVZ0TKNkFdnuIHeEQzjsMNDo6EuhPLxzQynKupxXNWVZxyxnCcGzXmAfp2jZrzAP07Rs15gH6do2a8wD9O0bNeYB+naNmvMA/TtGzXmAfp2jZrzAP07Rs15gH6domUcIF73bQQ8ItnPfYdHX1paCZXnkh5WU9LieSsJznnjGU5/47Tv9w5cRKIUevTO8/ClunnZ+9W2KBHGBjmrSfmAsYciYBGCDQzUwyAHMkQosdESEgbHwsGPGw27m7Nl3uGqoG6XEDu1uzYb7xGWqLptvgbzCw2NzZlDi67CqsVbhy5WIqcPAx854Mf2uOa6KG6NWJ+boO3ExWZ+kkwNokq5Z4CVqsEXWAiB5oDP9U2bXZGRiJQSRFMDLaMyYgdmVDjDwYtqDqNIrcFUKrCsOkvsQ9brUWLDQcWy+a8SY81HxgQojbpZBBLiGcLfeddypav8Ab9ubXu1naCknW/8AZ7SulM/Y8CvjD5aQUsY3EXEx+Csy1lm8R8kqBrQEvMoi5NYCQCNpbTsg/uhHTRi9ubcZmUkIjMLZZiueMj5pURX3J+uTXsj2xW512vwa5aGNDNxGDoeR1f5L0eNfNouHrd3cemkSoKJSMZs1No03PwjshGuqQ2eGiQBHUQI4tKCGsKaUrGFZzomKL3F3V2zBtNtJhIxqGiXpYiRkhnFgxbK3GgmMtCtYwyhak4VhWef5/pGjHBxfC9tZDJa3s98MchfWpo1lGeS3lYT0tp5JwnGeecZVkKF8ud9R0FC+XO+o6ChfLnfUdDRjY5Xiu4sdktD2OwGQQjoU6a8jHNbKcK6m1c05VjHLOcKx/hf9H3EP/wDLLPpSUIRsfGKWtWcJSlKZiaypSlZ5YSlOMZznOc4xjGOefy1LRk7DnJcUFKw54snGlpaecHdUKcE6+KQlt9p1hzLTq8IeacbVyWhScamfCeL8P/T+zu/2+wKwN/d8cz1dXZ6/7aenq6fz5dWbD6T9z1YfSfuerD6T9z1M+L8J4j+n9ndjud8V8b+7457p6e91/wBtXV09P5c+rH+FNyFaht7tqr3tXK2GKHHLk4OPvdbka2XKx4pmcCkGAMSKyR2Sc4YcdbSh3PRnOr3d5Lbz9g1r2BN3AjHgq3fHa7bombh5CaBcFZMiwJhkacIyw06IdGPZbSxIAmhPEivbh3Lc2JEuVqu5FmujYAhXtK1Oh5IAiIiMxkOFhRmo8dxALb5SnpQiVlXX+7JLZa/1u6RVA2w29h3Zu02eXy8pkQZC0MDCBhiNESEvMShrw8ZCQcUKZLTUqWJGRgZRpTDC/wAOH8Q+O4SXncPscTjmzY7lRxW1LxyuxYSZRMaPUEjJfOXLs2stPhm0NNNPSDyQU26Mve2G5EExYqhaYlTnhZKPecdHebdYIbZMj5OMPHLiZqHkBxpSFmQT4iUEFkAiR2tluIPjW4ooGOYmLjs7wvUEm7FbdRhIwpbJO4E+hXg4Rahz4158WOEnCIpuQDVPoiMlh4J2T3+4JuJ6VDdkKhtVxOU9uoJ3DFQ2t9DNDsCiEIl5N8VkosIA+LiEzI47iq0TOuNvtMf42XSNrN/eJqW3R3phcPKaHs9T2fxV8B1kxtvDmDAJeFsl/QUwWzkUc1iIOSh18dDocHDvVZ6HXXXa07GBOV92vuBZjVwbkMtjMcuHXHZyAuMUNkJQWci5YyxnLeiinNt+E/jCJn9ngjzCjiYWgbuG3gGOr7DxXPKBY2P2yhZEppntjvT0/NSiWu9JkOuyW39v4oeKLiMtm7u4V9oU9NWoWTrEgICZWoEmfsVVqEs+7GWeX3Al3WFRDY6HrEpbTi05Q2yoGY4wccZNR3EqYkK00faqTtTFzEE7ZLJYMhJekoCpETMRGWNRRqGY42O27tconLjFXknBv0wXe8CaUH3fafb7vhn3Ge52/Z6+jr6Oro619PPl1K5c8171b7ZqverfbNV71b7ZqverfbNV71b7ZqverfbNV71b7ZqverfbNV71b7ZqverfbNV71b7ZqverfbNV71b7ZqG8J4vxH9R7R7/b7Ar5P9rwLPV1dno/uJ6erq/Pl05/cykTb6O37vGx9vsJquxC1qS3HepMbUyJM5eWxwmiBpi3SjxBDzbI4VZMKe5jjvZTp1J+3u4PF5AbT0WcDy0uJn07OmbookpMIhC3FEtGwVrpEsIrpZxgOXbdcwtwjLYlBhd8eNc2Mcf3M3Dn3OvZThNgn0Dtv2XcOQbYKDlLRENHhkqgyMORcPIHQ0aeFbLKYnb43cmd4quPDdcNad0+JG+ZcKcjGi89JFT2pizu8/U6u0C2DDEF5d9py4MYOMOzXK34SoRn6S4hLJsgaW0l18zDiWySXHkJcwkBacLwleMLwla04VzxhSsfnk2F8wd9O0bC+YO+naNhfMHfTtGwvmDvp2jYXzB307RsL5g76do2F8wd9O0bC+YO+naNhfMHfTtGwvmDvp2jYXzB307RsL5g76do2F8wd9O0TGODi+K7iB3i1vZ74ZA6OhLoTKM8lvJyrqcTyThWcc84wnP7jZwcNPPgT9Vt8KgXNm26v0Dl9davFZcLbcZRIxuSjI84ZXbRMV2VnK+++yLLPuJ/En4bE7IvRn6lO8RYu21zc4uc0bsqiXH2xHINiBRbn4VCMrsatz3bg1JEkGtXv2owxNLQS7BUwORMOs1gQ05OXa7zr7khYrpaFhYYS6ZLybmMNhjqSzEQYsXXo1bcfEhJR+I9w8VOyb+3szcfdu0S/DrFXy03O1nEnHOlyVlv1Ws074VJ8rLSDUc1INgokZaTPywow8l9z8U3h+n6mFYYUu0QQfCnt1HlzVdGkhnpqJFPZ26ZeCJkY1BIbBbTzTgzryXm3W1IwrHGZb+EwbZPcqUtt/Yqy7Ey5dQZFyrLiZgdVemIps+w0luCmh4OCsiSq1Kt3CSVIOhpEy1I/wCyf//EADsRAAEDAQYCBgcFCQAAAAAAAAECAxESAAQTITFBUWEiMkBxkbEQFGBzocHwM1JygdEjNEJwgpKisuH/2gAIAQIBAT8A9k7uzjLgmlCQVrVwSOHM/qdrY10qo9W/ZzFdaq4+9Hxif0s8wW3Q2k1BdJbPEKMCdpnI+O9mro0nES4tLjqW1KoQTSiNyREqnYxHA5HtF3yu17I1pQJ5GZHx9F5zYuat6Cmd+jTHh87XHrP+4V5jtFzIVjMExjIhJOlaQY85/KNYtgu14eGquYiDxiZ0jnMc7XxQBaZSZwGwknaogT5CeeW1rj1n/cK8xZttbqqECVQTqBkOZspJQopUIUkkEcCOzaZi3rd4ppxVREbVf3RV+cz6ELWiaFFNQpMbg7WQtTagpCilQ0IsSVEkkkkkknUk6k/yJbUw21WpIdeJgNqmlAzzOyp+Y0zNmlNXpRaUw22opUULbFMEDKQNdzmYMRGhBEEg6gx4dphN2YacDaXHHZNSxUlAGgA0nPXXIzsBc3n3XMwnDSDJCEpgkZAEAGeXDW1C1uKShJUZUYSCTE65bW0yPaG7y42jDhC0TIS4moA65ZjfPvt629UlQKUhE0oSkBAJBBNI1ME5mYnKzbzjSytBAUoEGQCDJnTvz/5YkkkkySSSeJOZPtg0jEcSioJqMVHQfqeA3MCzzeE4puoLpjpDeQDpJgiYIkwe1NJC3W0K0UtKT3EgGz6EtvOITNKVQJzMdqu/27PvUf7C16/eHfxn5W01y7ShVC0LAkoUFAcYM2U8S9jQKqwuk5iRBjuys+8X3KykJMAQOXEnU/KB7OIQpaghAlSjAA+vE7W9TM0h9jE+5XnPDTXlFlJUhRSoQpJgg/Xhxs3dlLRiKUhpsmApxUVfhG/wnazl1UhGIlaHWxqpszHeNh5bx2e6dBu8vDrIbCUngVTn+RAtJmZMzM7zxnja+dJN3e3cahXNSYz/AMvhyteXkulAbkNtoCUgiIO5gE7R4WumTd5Wr7PCKTOhUQYA2J2/qHHs926TF7QOtQFAbkJmcvDx9F66LV1bOobqI3FVPzB+hZphNGM+Shqeikddw8E8AePkM7PXguAISkNtJ6rafNR3PlzOZ7M06plYWnUZEHRQOoP1kYNsW5zWGHKtcOoYc698cqYj+GzrqnnC4vU7DQAaAd3xOZzNnLzdnQkLYWQgUpAXAA7hA2Fi5c4MMLBgwcQ5HbezDrbQcraS5UmEzGRz4gwDOZGeQ9pf/8QANREAAgEBBQUFBwMFAAAAAAAAAQIRAwASITFBE0BRYXGBkaHB0RAzYHKx8PEEIjJSYnDS4f/aAAgBAwEBPwD4TqPcWQJYmFHEn78tbXK0Xtr+7O7Au9OHbFkqBkLEQVm8OBAkx2elnrObpUFVJAvECW6ZiPvlvFX3tEc58R6eyl7ysP7h4lrfqMk+beK4IuVBjcaSORj0jtttEi9eEROflnPLPS1AGHc4bRiR0xj6m36jJPmszBBebKwIYAgyDiDu+xpzNwT2x3THh7GVWi8AYMjrYqGEMJB0sAAIGAGAH+CXFRmuglEAxYZk8BjI/OeFnD0gHDswkAq5nA89O7tsDIBGonecatR1LFVSMFMFuZPD/muNqyIi4E3icASThqbBgqKWIAhc+m8tSVjexVuKmCeufrbYpBBk3oliZbAznp2CzU1ZQpGAiMcRGFgIEDIYD4wZrqloJgTA++/lZGvqGiJ0O9OSEYjMKSOoFqbFkVjmRj371U92/wAjfQ2o+6Tp5m2e8sLyleII7xFggCbOTEETkcbU0FNboJOJOPP4cJCgkmAMzbb67N7v9UYRx4R22BDAEGQcjZqoU3QrOwzCiY62WqGN0hkbQMInp+N3rYtSTRmlhyER525acLUcDUTRWw6GfS1JCgYtBZmJJH4Gs99q+LUgP5XpHEDDHph4Hhu9XCpRbS9BOgxEefd7KOL1m0LwOyfUWeob2zpiX1Oi9ef4xOFkphSWJvOc2P0HAfeAw3d0DqVPYdQeP3pa5W/jtFjK9BvR685nnNkQIoUaeJ4my0qqyVdQWMkxMntBsFrzjUWPlH+tqiM9265WDJ55Y56efxL/AP/Z"}],OrderListTypePicker=props=>(0,jsx_runtime.jsx)(ListTypePicker,{...props,options:orderListOptions}),bulletOptions=[{value:src.yrS.BULLET_LIST,img:"data:image/jpeg;base64,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"},{value:src.yrS.BULLET_LIST_1,img:"data:image/jpeg;base64,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"},{value:src.yrS.BULLET_LIST_2,img:"data:image/jpeg;base64,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"},{value:src.yrS.BULLET_LIST_3,img:"data:image/jpeg;base64,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"},{value:src.yrS.BULLET_LIST_4,img:"data:image/jpeg;base64,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"},{value:src.yrS.BULLET_LIST_5,img:"data:image/jpeg;base64,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"}],BulletListTypePicker=props=>(0,jsx_runtime.jsx)(ListTypePicker,{...props,options:bulletOptions});ListTypePicker.__docgenInfo={description:"",methods:[],displayName:"ListTypePicker",props:{value:{required:!1,tsType:{name:"PresetListType"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: PresetListType | undefined) => void",signature:{arguments:[{type:{name:"union",raw:"PresetListType | undefined",elements:[{name:"PresetListType"},{name:"undefined"}]},name:"value"}],return:{name:"void"}}},description:""},options:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{ value: PresetListType; img: string }",signature:{properties:[{key:"value",value:{name:"PresetListType",required:!0}},{key:"img",value:{name:"string",required:!0}}]}}],raw:"{ value: PresetListType; img: string }[]"},description:""}}},OrderListTypePicker.__docgenInfo={description:"",methods:[],displayName:"OrderListTypePicker",props:{value:{required:!1,tsType:{name:"PresetListType"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: PresetListType | undefined) => void",signature:{arguments:[{type:{name:"union",raw:"PresetListType | undefined",elements:[{name:"PresetListType"},{name:"undefined"}]},name:"value"}],return:{name:"void"}}},description:""}}},BulletListTypePicker.__docgenInfo={description:"",methods:[],displayName:"BulletListTypePicker",props:{value:{required:!1,tsType:{name:"PresetListType"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: PresetListType | undefined) => void",signature:{arguments:[{type:{name:"union",raw:"PresetListType | undefined",elements:[{name:"PresetListType"},{name:"undefined"}]},name:"value"}],return:{name:"void"}}},description:""}}};const ORDER_LIST_TYPE_COMPONENT=`${components_const.F}_ORDER_LIST_TYPE_COMPONENT`,BULLET_LIST_TYPE_COMPONENT=`${components_const.F}_BULLET_LIST_TYPE_COMPONENT`},"../../packages/docs-ui/src/controllers/doc-header-footer.controller.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{d:()=>DocHeaderFooterController,l:()=>HeaderFooterType});var src=__webpack_require__("../../packages/core/src/index.ts"),docs_src=__webpack_require__("../../packages/docs/src/index.ts"),engine_render_src=__webpack_require__("../../packages/engine-render/src/index.ts"),ui_src=__webpack_require__("../../packages/ui/src/index.ts"),component_tools=__webpack_require__("../../packages/docs-ui/src/basics/component-tools.ts"),doc_header_footer_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/doc-header-footer.command.ts"),editor_manager_service=__webpack_require__("../../packages/docs-ui/src/services/editor/editor-manager.service.ts"),doc_selection_render_service=__webpack_require__("../../packages/docs-ui/src/services/selection/doc-selection-render.service.ts"),component_name=__webpack_require__("../../packages/docs-ui/src/views/header-footer/panel/component-name.ts"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@19.0.0/node_modules/react/jsx-runtime.js"),react=__webpack_require__("../../node_modules/.pnpm/react@19.0.0/node_modules/react/index.js"),design_src=__webpack_require__("../../packages/design/src/index.ts"),injectStylesIntoStyleTag=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),styleDomAPI=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/styleDomAPI.js"),styleDomAPI_default=__webpack_require__.n(styleDomAPI),insertBySelector=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/insertBySelector.js"),insertBySelector_default=__webpack_require__.n(insertBySelector),setAttributesWithoutAttributes=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),setAttributesWithoutAttributes_default=__webpack_require__.n(setAttributesWithoutAttributes),insertStyleElement=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/insertStyleElement.js"),insertStyleElement_default=__webpack_require__.n(insertStyleElement),styleTagTransform=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/styleTagTransform.js"),styleTagTransform_default=__webpack_require__.n(styleTagTransform),index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/docs-ui/src/views/header-footer/panel/index.module.less"),options={};options.styleTagTransform=styleTagTransform_default(),options.setAttributes=setAttributesWithoutAttributes_default(),options.insert=insertBySelector_default().bind(null,"head"),options.domAPI=styleDomAPI_default(),options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(index_module.A,options);const panel_index_module=index_module.A&&index_module.A.locals?index_module.A.locals:void 0;const DocHeaderFooterOptions=props=>{const localeService=(0,ui_src.fJ)(src.iH9),univerInstanceService=(0,ui_src.fJ)(src.HCr),renderManagerService=(0,ui_src.fJ)(engine_render_src.cSx),commandService=(0,ui_src.fJ)(src.wTY),layoutService=(0,ui_src.fJ)(ui_src.xQ),{unitId}=props,docSelectionRenderService=renderManagerService.getRenderById(unitId).with(doc_selection_render_service.q),[options,setOptions]=(0,react.useState)({}),handleCheckboxChange=(val,type)=>{setOptions((prev=>({...prev,[type]:val?src.OdA.TRUE:src.OdA.FALSE})));const docDataModel=univerInstanceService.getUniverDocInstance(unitId),documentStyle=docDataModel?.getSnapshot().documentStyle,docSkeletonManagerService=renderManagerService.getRenderById(unitId)?.with(docs_src.EX),viewModel=docSkeletonManagerService?.getViewModel();if(null==documentStyle||null==viewModel)return;const editArea=viewModel.getEditArea();let needCreateHeaderFooter=!1;const segmentPage=docSelectionRenderService.getSegmentPage();let needChangeSegmentId=!1;if("useFirstPageHeaderFooter"===type&&!0===val&&((editArea!==engine_render_src.ZCK.HEADER||documentStyle.firstPageHeaderId)&&(editArea!==engine_render_src.ZCK.FOOTER||documentStyle.firstPageFooterId)||(needCreateHeaderFooter=!0),needCreateHeaderFooter&&0===segmentPage&&(needChangeSegmentId=!0)),"evenAndOddHeaders"===type&&!0===val&&((editArea!==engine_render_src.ZCK.HEADER||documentStyle.evenPageHeaderId)&&(editArea!==engine_render_src.ZCK.FOOTER||documentStyle.evenPageFooterId)||(needCreateHeaderFooter=!0),needCreateHeaderFooter&&segmentPage%2==1&&(needChangeSegmentId=!0)),needCreateHeaderFooter){const SEGMENT_ID_LEN=6,segmentId=src.S0q.generateRandomId(SEGMENT_ID_LEN);needChangeSegmentId&&docSelectionRenderService.setSegment(segmentId),commandService.executeCommand(doc_header_footer_command.ay,{unitId,segmentId,headerFooterProps:{[type]:val?src.OdA.TRUE:src.OdA.FALSE}})}else{const segmentPageIndex=docSelectionRenderService.getSegmentPage(),prevSegmentId=docSelectionRenderService.getSegment(),needFocusSegmentId=function getSegmentId(documentStyle,editArea,pageIndex){const{useFirstPageHeaderFooter,evenAndOddHeaders,defaultHeaderId,defaultFooterId,firstPageHeaderId,firstPageFooterId,evenPageHeaderId,evenPageFooterId}=documentStyle;return editArea===engine_render_src.ZCK.HEADER?useFirstPageHeaderFooter===src.OdA.TRUE&&0===pageIndex?firstPageHeaderId:evenAndOddHeaders===src.OdA.TRUE&&pageIndex%2==1?evenPageHeaderId:defaultHeaderId:useFirstPageHeaderFooter===src.OdA.TRUE&&0===pageIndex?firstPageFooterId:evenAndOddHeaders===src.OdA.TRUE&&pageIndex%2==1?evenPageFooterId:defaultFooterId}({...documentStyle,[type]:val?src.OdA.TRUE:src.OdA.FALSE},editArea,segmentPageIndex);needFocusSegmentId&&needFocusSegmentId!==prevSegmentId&&docSelectionRenderService.setSegment(needFocusSegmentId),commandService.executeCommand(doc_header_footer_command.ay,{unitId,headerFooterProps:{[type]:val?src.OdA.TRUE:src.OdA.FALSE}})}layoutService.focus()},handleMarginChange=async(val,type)=>{setOptions((prev=>({...prev,[type]:val}))),await commandService.executeCommand(doc_header_footer_command.ay,{unitId,headerFooterProps:{[type]:val}}),docSelectionRenderService.removeAllRanges(),docSelectionRenderService.blur()};return(0,react.useEffect)((()=>{const docDataModel=univerInstanceService.getUniverDocInstance(unitId),documentStyle=docDataModel?.getSnapshot().documentStyle;if(documentStyle){const{marginHeader=0,marginFooter=0,useFirstPageHeaderFooter=src.OdA.FALSE,evenAndOddHeaders=src.OdA.FALSE}=documentStyle;setOptions({marginHeader,marginFooter,useFirstPageHeaderFooter,evenAndOddHeaders})}}),[unitId]),(0,jsx_runtime.jsxs)("div",{className:panel_index_module.options,children:[(0,jsx_runtime.jsxs)("div",{className:panel_index_module.optionsSection,children:[(0,jsx_runtime.jsx)("div",{className:panel_index_module.optionsFormItem,children:(0,jsx_runtime.jsx)(design_src.Sc,{checked:options.useFirstPageHeaderFooter===src.OdA.TRUE,onChange:val=>{handleCheckboxChange(val,"useFirstPageHeaderFooter")},children:localeService.t("headerFooter.firstPageCheckBox")})}),(0,jsx_runtime.jsx)("div",{className:panel_index_module.optionsFormItem,children:(0,jsx_runtime.jsx)(design_src.Sc,{checked:options.evenAndOddHeaders===src.OdA.TRUE,onChange:val=>{handleCheckboxChange(val,"evenAndOddHeaders")},children:localeService.t("headerFooter.oddEvenCheckBox")})})]}),(0,jsx_runtime.jsxs)("div",{className:(0,design_src.$z)(panel_index_module.optionsSection,panel_index_module.optionsMarginSetting),children:[(0,jsx_runtime.jsxs)("div",{className:panel_index_module.optionsMarginItem,children:[(0,jsx_runtime.jsx)("span",{children:localeService.t("headerFooter.headerTopMargin")}),(0,jsx_runtime.jsx)(design_src.YI,{min:0,max:200,precision:1,value:options.marginHeader,onChange:val=>{handleMarginChange(val,"marginHeader")},className:panel_index_module.optionsInput})]}),(0,jsx_runtime.jsxs)("div",{className:panel_index_module.optionsMarginItem,children:[(0,jsx_runtime.jsx)("span",{children:localeService.t("headerFooter.footerBottomMargin")}),(0,jsx_runtime.jsx)(design_src.YI,{min:0,max:200,precision:1,value:options.marginFooter,onChange:val=>{handleMarginChange(val,"marginFooter")},className:panel_index_module.optionsInput})]})]}),(0,jsx_runtime.jsx)("div",{className:panel_index_module.optionsSection,children:(0,jsx_runtime.jsx)(design_src.$n,{onClick:()=>{commandService.executeCommand(doc_header_footer_command.Q6.id,{unitId})},children:localeService.t("headerFooter.closeHeaderFooter")})})]})};DocHeaderFooterOptions.__docgenInfo={description:"",methods:[],displayName:"DocHeaderFooterOptions",props:{unitId:{required:!0,tsType:{name:"string"},description:""}}};const DocHeaderFooterPanel=()=>{const localeService=(0,ui_src.fJ)(src.iH9),renderManagerService=(0,ui_src.fJ)(engine_render_src.cSx),unitId=(0,ui_src.fJ)(src.HCr).getCurrentUniverDocInstance().getUnitId(),docSkeletonManagerService=renderManagerService.getRenderById(unitId)?.with(docs_src.EX),viewModel=docSkeletonManagerService.getViewModel(),[isEditHeaderFooter,setIsEditHeaderFooter]=(0,react.useState)(!0);return(0,react.useEffect)((()=>{const editArea=viewModel.getEditArea();setIsEditHeaderFooter(editArea!==engine_render_src.ZCK.BODY);const subscription=viewModel.editAreaChange$.subscribe((editArea=>{null!=editArea&&setIsEditHeaderFooter(editArea!==engine_render_src.ZCK.BODY)}));return()=>{subscription.unsubscribe()}}),[]),(0,jsx_runtime.jsx)("div",{className:panel_index_module.panel,children:isEditHeaderFooter?(0,jsx_runtime.jsx)(DocHeaderFooterOptions,{unitId}):(0,jsx_runtime.jsx)("div",{className:panel_index_module.panelDisableText,children:localeService.t("headerFooter.disableText")})})};DocHeaderFooterPanel.__docgenInfo={description:"",methods:[],displayName:"DocHeaderFooterPanel"};class TextBubbleShape extends engine_render_src.ypk{constructor(key,props){super(key,props),this.color=props?.color,this.text=props?.text}static drawWith(ctx,props){const{text,color}=props;ctx.save(),ctx.font="13px Source Han Sans CN";const textWidth=ctx.measureText(text).width;!function drawBubble(ctx,props){let{radius,width,height}=props;radius=radius??0,width=width??30,height=height??30;let bottomRight=0;bottomRight=Math.min(radius,width/2,height/2),ctx.beginPath(),ctx.moveTo(0,0),ctx.lineTo(width,0),ctx.lineTo(width,height-bottomRight),ctx.arc(width-bottomRight,height-bottomRight,bottomRight,0,Math.PI/2,!1),ctx.lineTo(0,height),ctx.lineTo(0,0),ctx.closePath(),props.fill&&(ctx.save(),ctx.fillStyle=props.fill,"evenodd"===props.fillRule?ctx.fill("evenodd"):ctx.fill(),ctx.restore())}(ctx,{height:18,width:Math.min(textWidth+12,200),radius:4,fill:color,evented:!1}),ctx.fillStyle="rgba(58, 96, 247, 1)";if(textWidth>188){let truncatedText="",currentWidth=0;for(const element of text){const charWidth=ctx.measureText(element).width;if(!(currentWidth+charWidth<=188-ctx.measureText("...").width)){truncatedText+="...";break}truncatedText+=element,currentWidth+=charWidth}ctx.fillText(truncatedText,6,14)}else ctx.fillText(text,6,14);ctx.restore()}_draw(ctx){TextBubbleShape.drawWith(ctx,this)}}function _ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function _ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}var HeaderFooterType=function(HeaderFooterType){return HeaderFooterType[HeaderFooterType.FIRST_PAGE_HEADER=0]="FIRST_PAGE_HEADER",HeaderFooterType[HeaderFooterType.FIRST_PAGE_FOOTER=1]="FIRST_PAGE_FOOTER",HeaderFooterType[HeaderFooterType.DEFAULT_HEADER=2]="DEFAULT_HEADER",HeaderFooterType[HeaderFooterType.DEFAULT_FOOTER=3]="DEFAULT_FOOTER",HeaderFooterType[HeaderFooterType.EVEN_PAGE_HEADER=4]="EVEN_PAGE_HEADER",HeaderFooterType[HeaderFooterType.EVEN_PAGE_FOOTER=5]="EVEN_PAGE_FOOTER",HeaderFooterType}({});class DocHeaderFooterController extends src.jGt{constructor(_context,_commandService,_editorService,_instanceSrv,_renderManagerService,_docSkeletonManagerService,_docSelectionRenderService,_localeService,_componentManager){super(),this._context=_context,this._commandService=_commandService,this._editorService=_editorService,this._instanceSrv=_instanceSrv,this._renderManagerService=_renderManagerService,this._docSkeletonManagerService=_docSkeletonManagerService,this._docSelectionRenderService=_docSelectionRenderService,this._localeService=_localeService,this._componentManager=_componentManager,this._loadedMap=new WeakSet,this._initialize()}_initialize(){this._init(),this._drawHeaderFooterLabel(),this._initCustomComponents(),this._listenSwitchMode()}_listenSwitchMode(){this.disposeWithMe(this._commandService.onCommandExecuted((command=>{if(docs_src.Bz.id===command.id){const docDataModel=this._context.unit,editArea=this._docSkeletonManagerService.getViewModel().getEditArea(),documentFlavor=docDataModel.getSnapshot().documentStyle.documentFlavor;editArea!==engine_render_src.ZCK.BODY&&documentFlavor===src.CQy.MODERN&&this._commandService.executeCommand(doc_header_footer_command.Q6.id,{unitId:this._context.unitId})}})))}_initCustomComponents(){this._componentManager.get(component_name.O)||this.disposeWithMe(this._componentManager.register(component_name.O,DocHeaderFooterPanel))}_init(){const{unitId}=this._context,docObject=(0,component_tools.Ce)(this._context);null!=docObject&&null!=docObject.document&&(this._loadedMap.has(docObject.document)||(this._initialMain(unitId),this._loadedMap.add(docObject.document)))}_initialMain(unitId){const docObject=(0,component_tools.Ce)(this._context),{document}=docObject;this.disposeWithMe(document.onDblclick$.subscribeEvent((async evt=>{if(this._isEditorReadOnly(unitId))return;if(!this._isTraditionalMode())return;const{offsetX,offsetY}=evt,{pageLayoutType=engine_render_src.kvx.VERTICAL,pageMarginLeft,pageMarginTop}=document.getOffsetConfig(),coord=this._getTransformCoordForDocumentOffset(offsetX,offsetY);if(null==coord)return;const viewModel=this._docSkeletonManagerService.getViewModel(),skeleton=this._docSkeletonManagerService.getSkeleton(),preEditArea=viewModel.getEditArea(),{editArea,pageNumber}=skeleton.findEditAreaByCoord(coord,pageLayoutType,pageMarginLeft,pageMarginTop);if(preEditArea===editArea)return;viewModel.setEditArea(editArea);const{createType,headerFooterId}=function checkCreateHeaderFooterType(viewModel,editArea,segmentPage){const{documentStyle}=viewModel.getDataModel().getSnapshot(),{defaultHeaderId,defaultFooterId,evenPageHeaderId,evenPageFooterId,firstPageHeaderId,firstPageFooterId,evenAndOddHeaders,useFirstPageHeaderFooter}=documentStyle;switch(editArea){case engine_render_src.ZCK.BODY:return{createType:null,headerFooterId:null};case engine_render_src.ZCK.HEADER:return useFirstPageHeaderFooter!==src.OdA.TRUE||firstPageHeaderId?evenAndOddHeaders!==src.OdA.TRUE||segmentPage%2!=0||evenPageHeaderId?defaultHeaderId?{createType:null,headerFooterId:defaultHeaderId}:{createType:2,headerFooterId:null}:{createType:4,headerFooterId:null}:{createType:0,headerFooterId:null};case engine_render_src.ZCK.FOOTER:return useFirstPageHeaderFooter!==src.OdA.TRUE||firstPageFooterId?evenAndOddHeaders!==src.OdA.TRUE||segmentPage%2!=0||evenPageFooterId?defaultFooterId?{createType:null,headerFooterId:defaultFooterId}:{createType:3,headerFooterId:null}:{createType:5,headerFooterId:null}:{createType:1,headerFooterId:null};default:throw new Error(`Invalid editArea: ${editArea}`)}}(viewModel,editArea,pageNumber);if(editArea===engine_render_src.ZCK.BODY)this._docSelectionRenderService.setSegment(""),this._docSelectionRenderService.setSegmentPage(-1),this._docSelectionRenderService.setCursorManually(offsetX,offsetY);else if(null!=createType){const SEGMENT_ID_LEN=6,segmentId=src.S0q.generateRandomId(SEGMENT_ID_LEN);this._docSelectionRenderService.setSegment(segmentId),this._docSelectionRenderService.setSegmentPage(pageNumber),await this._commandService.executeCommand(doc_header_footer_command.jP.id,{unitId,createType,segmentId})}else null!=headerFooterId&&(this._docSelectionRenderService.setSegment(headerFooterId),this._docSelectionRenderService.setSegmentPage(pageNumber),this._docSelectionRenderService.setCursorManually(offsetX,offsetY))})))}_getTransformCoordForDocumentOffset(evtOffsetX,evtOffsetY){const docObject=(0,component_tools.Ce)(this._context),{document,scene}=docObject,{documentTransform}=document.getOffsetConfig(),activeViewport=scene.getViewports()[0];if(null==activeViewport)return;const originCoord=activeViewport.transformVector2SceneCoord(engine_render_src.I9Y.FromArray([evtOffsetX,evtOffsetY]));return documentTransform.clone().invert().applyPoint(originCoord)}_drawHeaderFooterLabel(){const localeService=this._localeService;this._instanceSrv.getCurrentTypeOfUnit$(src.Zy$.UNIVER_DOC).subscribe((unit=>{if(null==unit)return;const unitId=unit.getUnitId(),currentRender=this._renderManagerService.getRenderById(unitId);if(this._editorService.isEditor(unitId)||null==this._instanceSrv.getUniverDocInstance(unitId))return;if(null==currentRender)return;const{mainComponent}=currentRender,docsComponent=mainComponent;this.disposeWithMe((0,src.saO)(docsComponent.pageRender$.subscribe((config=>{if(this._editorService.isEditor(unitId))return;if(!this._isTraditionalMode())return;const isEditBody=this._docSkeletonManagerService.getViewModel().getEditArea()===engine_render_src.ZCK.BODY,{page,pageLeft,pageTop,ctx}=config,{pageWidth,pageHeight,marginTop,marginBottom}=page;if(ctx.save(),ctx.translate(pageLeft-.5,pageTop-.5),isEditBody?(engine_render_src.rwV.drawWith(ctx,{left:0,top:0,width:pageWidth,height:marginTop,fill:"rgba(255, 255, 255, 0.5)"}),ctx.save(),ctx.translate(0,pageHeight-marginBottom),engine_render_src.rwV.drawWith(ctx,{left:0,top:0,width:pageWidth,height:marginBottom,fill:"rgba(255, 255, 255, 0.5)"}),ctx.restore()):(ctx.save(),ctx.translate(0,marginTop),engine_render_src.rwV.drawWith(ctx,{left:0,top:marginTop,width:pageWidth,height:pageHeight-marginTop-marginBottom,fill:"rgba(255, 255, 255, 0.5)"}),ctx.restore()),!isEditBody){const headerPathConfigIPathProps={dataArray:[{command:"M",points:[0,marginTop]},{command:"L",points:[pageWidth,marginTop]}],strokeWidth:1,stroke:"rgba(58, 96, 247, 1)"},footerPathConfigIPathProps={dataArray:[{command:"M",points:[0,pageHeight-marginBottom]},{command:"L",points:[pageWidth,pageHeight-marginBottom]}],strokeWidth:1,stroke:"rgba(58, 96, 247, 1)"};engine_render_src.wAk.drawWith(ctx,headerPathConfigIPathProps),engine_render_src.wAk.drawWith(ctx,footerPathConfigIPathProps),ctx.translate(0,marginTop+1),TextBubbleShape.drawWith(ctx,{text:localeService.t("headerFooter.header"),color:"rgba(58, 96, 247, 0.08)"}),ctx.translate(0,pageHeight-marginTop-marginBottom),TextBubbleShape.drawWith(ctx,{text:localeService.t("headerFooter.footer"),color:"rgba(58, 96, 247, 0.08)"})}ctx.restore()}))))}))}_isEditorReadOnly(unitId){const editor=this._editorService.getEditor(unitId);return!!editor&&editor.isReadOnly()}_isTraditionalMode(){return this._context.unit.getSnapshot().documentStyle.documentFlavor===src.CQy.TRADITIONAL}}DocHeaderFooterController=function _ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([_ts_param(1,src.wTY),_ts_param(2,editor_manager_service.I),_ts_param(3,src.HCr),_ts_param(4,engine_render_src.cSx),_ts_param(5,(0,src.y_5)(docs_src.EX)),_ts_param(6,(0,src.y_5)(doc_selection_render_service.q)),_ts_param(7,(0,src.y_5)(src.iH9)),_ts_param(8,(0,src.y_5)(ui_src.BJ)),_ts_metadata("design:type",Function),_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===src.wTY?Object:src.wTY,void 0===editor_manager_service.I?Object:editor_manager_service.I,void 0===src.HCr?Object:src.HCr,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===docs_src.EX?Object:docs_src.EX,void 0===doc_selection_render_service.q?Object:doc_selection_render_service.q,void 0===src.iH9?Object:src.iH9,void 0===ui_src.BJ?Object:ui_src.BJ])],DocHeaderFooterController)},"../../packages/docs-ui/src/controllers/doc-paragraph-setting.controller.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{B:()=>DocParagraphSettingController});var src=__webpack_require__("../../packages/core/src/index.ts"),ui_src=__webpack_require__("../../packages/ui/src/index.ts"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@19.0.0/node_modules/react/jsx-runtime.js"),docs_src=__webpack_require__("../../packages/docs/src/index.ts"),react=__webpack_require__("../../node_modules/.pnpm/react@19.0.0/node_modules/react/index.js"),doc_paragraph_setting_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/doc-paragraph-setting.command.ts"),design_src=__webpack_require__("../../packages/design/src/index.ts"),left_justifying_single=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/left-justifying-single.js"),horizontally_single=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/horizontally-single.js"),right_justifying_single=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/right-justifying-single.js"),align_text_both_single=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/align-text-both-single.js"),engine_render_src=__webpack_require__("../../packages/engine-render/src/index.ts"),BehaviorSubject=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/BehaviorSubject.js"),filter=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/filter.js"),bufferTime=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/bufferTime.js"),map=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/map.js"),list_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/list.command.ts");const useDocRanges=()=>{const docSelectionManagerService=(0,ui_src.fJ)(docs_src.pv),docParagraphSettingController=(0,ui_src.fJ)(DocParagraphSettingController),docRanges=(0,react.useMemo)((()=>docSelectionManagerService.getDocRanges()),[]);return(0,react.useEffect)((()=>{docRanges.length||docParagraphSettingController.closePanel()}),[docRanges]),docRanges};var injectStylesIntoStyleTag=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),styleDomAPI=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/styleDomAPI.js"),styleDomAPI_default=__webpack_require__.n(styleDomAPI),insertBySelector=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/insertBySelector.js"),insertBySelector_default=__webpack_require__.n(insertBySelector),setAttributesWithoutAttributes=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),setAttributesWithoutAttributes_default=__webpack_require__.n(setAttributesWithoutAttributes),insertStyleElement=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/insertStyleElement.js"),insertStyleElement_default=__webpack_require__.n(insertStyleElement),styleTagTransform=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/styleTagTransform.js"),styleTagTransform_default=__webpack_require__.n(styleTagTransform),index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/docs-ui/src/views/paragraph-setting/index.module.less"),options={};options.styleTagTransform=styleTagTransform_default(),options.setAttributes=setAttributesWithoutAttributes_default(),options.insert=insertBySelector_default().bind(null,"head"),options.domAPI=styleDomAPI_default(),options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(index_module.A,options);const paragraph_setting_index_module=index_module.A&&index_module.A.locals?index_module.A.locals:void 0,AutoFocusInputNumber=props=>{const{value,onChange,className="",min=0,max=100,step=1}=props,ref=(0,react.useRef)(null);return(0,jsx_runtime.jsx)(design_src.YI,{step,ref,min,max,value,onChange:v=>{onChange(v??0).finally((()=>{setTimeout((()=>{ref.current?.focus()}),30)}))},className})};function ParagraphSetting(){const localeService=(0,ui_src.fJ)(src.iH9),alignmentOptions=(0,react.useMemo)((()=>[{label:localeService.t("toolbar.alignLeft"),value:String(src.wqs.LEFT),icon:(0,jsx_runtime.jsx)(left_justifying_single.A,{})},{label:localeService.t("toolbar.alignCenter"),value:String(src.wqs.CENTER),icon:(0,jsx_runtime.jsx)(horizontally_single.A,{})},{label:localeService.t("toolbar.alignRight"),value:String(src.wqs.RIGHT),icon:(0,jsx_runtime.jsx)(right_justifying_single.A,{})},{label:localeService.t("toolbar.alignJustify"),value:String(src.wqs.JUSTIFIED),icon:(0,jsx_runtime.jsx)(align_text_both_single.A,{})}]),[]),currentParagraph=(()=>{const docDataModel=(0,ui_src.fJ)(src.HCr).getCurrentUnitForType(src.Zy$.UNIVER_DOC),docRanges=useDocRanges();if(!docDataModel||0===docRanges.length)return[];const segmentId=docRanges[0].segmentId,paragraphs=docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()?.paragraphs??[];return(0,list_command.HD)(docRanges,paragraphs)??[]})(),[horizontalAlignValue,horizontalAlignSet]=((paragraph,defaultValue)=>{const commandService=(0,ui_src.fJ)(src.wTY),[horizontalAlign,_horizontalAlignSet]=(0,react.useState)((()=>{const firstParagraph=paragraph[0];return firstParagraph?String(firstParagraph.paragraphStyle?.horizontalAlign??defaultValue):defaultValue}));return[horizontalAlign,v=>(_horizontalAlignSet(v),commandService.executeCommand(doc_paragraph_setting_command.Y.id,{paragraph:{horizontalAlign:Number(v)}}))]})(currentParagraph,alignmentOptions[0].value),[indentStart,indentStartSet]=(paragraph=>{const commandService=(0,ui_src.fJ)(src.wTY),[indentStart,_indentStartSet]=(0,react.useState)((()=>{const firstParagraph=paragraph[0];return firstParagraph?(0,engine_render_src.nz8)(firstParagraph.paragraphStyle?.indentStart,0):0}));return[indentStart,v=>(_indentStartSet(v),commandService.executeCommand(doc_paragraph_setting_command.Y.id,{paragraph:{indentStart:{v}}}))]})(currentParagraph),[indentEnd,indentEndSet]=(paragraph=>{const commandService=(0,ui_src.fJ)(src.wTY),[indentEnd,_indentEndSet]=(0,react.useState)((()=>{const firstParagraph=paragraph[0];return firstParagraph?(0,engine_render_src.nz8)(firstParagraph.paragraphStyle?.indentEnd,0):0}));return[indentEnd,v=>(_indentEndSet(v),commandService.executeCommand(doc_paragraph_setting_command.Y.id,{paragraph:{indentEnd:{v}}}))]})(currentParagraph),[indentFirstLine,indentFirstLineSet]=(paragraph=>{const commandService=(0,ui_src.fJ)(src.wTY),[indentFirstLine,_indentFirstLineSet]=(0,react.useState)((()=>{const firstParagraph=paragraph[0];return firstParagraph?(0,engine_render_src.nz8)(firstParagraph.paragraphStyle?.indentFirstLine,0):0}));return[indentFirstLine,v=>(_indentFirstLineSet(v),commandService.executeCommand(doc_paragraph_setting_command.Y.id,{paragraph:{indentFirstLine:{v}}}))]})(currentParagraph),[hanging,hangingSet]=(paragraph=>{const commandService=(0,ui_src.fJ)(src.wTY),[hanging,_hangingSet]=(0,react.useState)((()=>{const firstParagraph=paragraph[0];return firstParagraph?(0,engine_render_src.nz8)(firstParagraph.paragraphStyle?.hanging,0):0}));return[hanging,v=>(_hangingSet(v),commandService.executeCommand(doc_paragraph_setting_command.Y.id,{paragraph:{hanging:{v}}}))]})(currentParagraph),[spaceAbove,spaceAboveSet]=(paragraph=>{const commandService=(0,ui_src.fJ)(src.wTY),[spaceAbove,_spaceAboveSet]=(0,react.useState)((()=>{const firstParagraph=paragraph[0];return firstParagraph?(0,engine_render_src.nz8)(firstParagraph.paragraphStyle?.spaceAbove,0):0}));return[spaceAbove,v=>(_spaceAboveSet(v),commandService.executeCommand(doc_paragraph_setting_command.Y.id,{paragraph:{spaceAbove:{v}}}))]})(currentParagraph),[spaceBelow,spaceBelowSet]=(paragraph=>{const commandService=(0,ui_src.fJ)(src.wTY),[spaceBelow,_spaceBelowSet]=(0,react.useState)((()=>{const firstParagraph=paragraph[0];return firstParagraph?(0,engine_render_src.nz8)(firstParagraph.paragraphStyle?.spaceBelow,0):0}));return[spaceBelow,v=>(_spaceBelowSet(v),commandService.executeCommand(doc_paragraph_setting_command.Y.id,{paragraph:{spaceBelow:{v}}}))]})(currentParagraph),{lineSpacing:[lineSpacing,lineSpacingSet],spacingRule:[spacingRule,spacingRuleSet]}=(paragraph=>{const commandService=(0,ui_src.fJ)(src.wTY),renderManagerService=(0,ui_src.fJ)(engine_render_src.cSx),univerInstanceService=(0,ui_src.fJ)(src.HCr),skeleton=(0,react.useMemo)((()=>{const docDataModel=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_DOC);if(docDataModel)return renderManagerService.getRenderById(docDataModel?.getUnitId())?.with(docs_src.EX).getSkeleton()}),[]),stateChange$=(0,react.useMemo)((()=>new BehaviorSubject.t({})),[]),[lineSpacing,_lineSpacingSet]=(0,react.useState)((()=>{const firstParagraph=paragraph[0];return firstParagraph?firstParagraph.paragraphStyle?.lineSpacing??1:1})),lineSpacingCache=(0,react.useRef)(lineSpacing),[spacingRule,_spacingRuleSet]=(0,react.useState)((()=>{const firstParagraph=paragraph[0];return firstParagraph?firstParagraph.paragraphStyle?.spacingRule??src.Oax.AUTO:src.Oax.AUTO})),lineSpacingSet=async v=>{_lineSpacingSet(v),stateChange$.next({lineSpacing:v,spacingRule})};return(0,react.useEffect)((()=>{const dispose=stateChange$.pipe((0,filter.p)((obj=>!!Object.keys(obj).length)),(0,bufferTime.w)(16),(0,filter.p)((list=>!!list.length)),(0,map.T)((list=>list.reduce(((a,b)=>(Object.keys(b).forEach((key=>{a[key]=b[key]})),a)),{})))).subscribe((v=>commandService.executeCommand(doc_paragraph_setting_command.Y.id,{paragraph:{...v}})));return()=>dispose.unsubscribe()}),[]),{lineSpacing:[lineSpacing,lineSpacingSet],spacingRule:[spacingRule,async v=>{if(v!==spacingRule){let cache=lineSpacingCache.current;if(v===src.Oax.AT_LEAST){const glyphNode=skeleton?.findNodeByCharIndex(paragraph[0].startIndex),divideNode=glyphNode?.parent,lineNode=divideNode?.parent;void 0!==lineNode?.contentHeight&&(cache=Math.max(lineNode.contentHeight,cache))}else cache>5&&(cache=2);lineSpacingCache.current=lineSpacing,lineSpacingSet(cache),_spacingRuleSet(v),stateChange$.next({spacingRule:v})}}]}})(currentParagraph),lineSpaceConfig=(0,react.useMemo)((()=>spacingRule===src.Oax.AUTO?{min:1,max:5,step:lineSpacing<2?.5:1}:{min:1,max:100}),[spacingRule,lineSpacing]);return(0,jsx_runtime.jsxs)("div",{className:paragraph_setting_index_module.paragraphSetting,children:[(0,jsx_runtime.jsx)("div",{className:paragraph_setting_index_module.paragraphSettingTitle,children:localeService.t("doc.paragraphSetting.alignment")}),(0,jsx_runtime.jsx)("div",{className:`\n                  ${paragraph_setting_index_module.paragraphSettingIconList}\n                  ${paragraph_setting_index_module.paragraphSettingMtBase}\n                `,children:alignmentOptions.map((item=>(0,jsx_runtime.jsx)(design_src.m_,{title:item.label,placement:"bottom",children:(0,jsx_runtime.jsx)("span",{className:(0,design_src.$z)(paragraph_setting_index_module.paragraphSettingIconListItem,{[paragraph_setting_index_module.paragraphSettingIconListActive]:horizontalAlignValue===item.value}),onClick:()=>horizontalAlignSet(item.value),children:item.icon})},item.value)))}),(0,jsx_runtime.jsx)("div",{className:paragraph_setting_index_module.paragraphSettingTitle,children:localeService.t("doc.paragraphSetting.indentation")}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsxs)("div",{className:paragraph_setting_index_module.paragraphSettingFlexCol,children:[(0,jsx_runtime.jsxs)("div",{className:paragraph_setting_index_module.paragraphSettingLabel,children:[localeService.t("doc.paragraphSetting.left"),"(px)"]}),(0,jsx_runtime.jsx)(AutoFocusInputNumber,{className:paragraph_setting_index_module.paragraphSettingMtBase,value:indentStart,onChange:v=>indentStartSet(v??0)})]}),(0,jsx_runtime.jsxs)("div",{className:paragraph_setting_index_module.paragraphSettingFlexCol,children:[(0,jsx_runtime.jsxs)("div",{className:paragraph_setting_index_module.paragraphSettingLabel,children:[localeService.t("doc.paragraphSetting.right"),"(px)"]}),(0,jsx_runtime.jsx)(AutoFocusInputNumber,{className:paragraph_setting_index_module.paragraphSettingMtBase,value:indentEnd,onChange:v=>indentEndSet(v??0)})]}),(0,jsx_runtime.jsxs)("div",{className:paragraph_setting_index_module.paragraphSettingFlexCol,children:[(0,jsx_runtime.jsxs)("div",{className:paragraph_setting_index_module.paragraphSettingLabel,children:[localeService.t("doc.paragraphSetting.firstLine"),"(px)"]}),(0,jsx_runtime.jsx)(AutoFocusInputNumber,{className:paragraph_setting_index_module.paragraphSettingMtBase,value:indentFirstLine,onChange:v=>indentFirstLineSet(v??0)})]}),(0,jsx_runtime.jsxs)("div",{className:paragraph_setting_index_module.paragraphSettingFlexCol,children:[(0,jsx_runtime.jsxs)("div",{className:paragraph_setting_index_module.paragraphSettingLabel,children:[localeService.t("doc.paragraphSetting.hanging"),"(px)"]}),(0,jsx_runtime.jsx)(AutoFocusInputNumber,{className:paragraph_setting_index_module.paragraphSettingMtBase,value:hanging,onChange:v=>hangingSet(v??0)})]})]}),(0,jsx_runtime.jsx)("div",{className:paragraph_setting_index_module.paragraphSettingTitle,children:localeService.t("doc.paragraphSetting.spacing")}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsxs)("div",{className:paragraph_setting_index_module.paragraphSettingFlexCol,children:[(0,jsx_runtime.jsxs)("div",{className:paragraph_setting_index_module.paragraphSettingLabel,children:[localeService.t("doc.paragraphSetting.before"),"(px)"]}),(0,jsx_runtime.jsx)(AutoFocusInputNumber,{className:paragraph_setting_index_module.paragraphSettingMtBase,value:spaceAbove,onChange:v=>spaceAboveSet(v??0)})]}),(0,jsx_runtime.jsxs)("div",{className:paragraph_setting_index_module.paragraphSettingFlexCol,children:[(0,jsx_runtime.jsxs)("div",{className:paragraph_setting_index_module.paragraphSettingLabel,children:[localeService.t("doc.paragraphSetting.after"),"(px)"]}),(0,jsx_runtime.jsx)(AutoFocusInputNumber,{className:paragraph_setting_index_module.paragraphSettingMtBase,value:spaceBelow,onChange:v=>spaceBelowSet(v??0)})]}),(0,jsx_runtime.jsxs)("div",{className:paragraph_setting_index_module.paragraphSettingFlexCol,children:[(0,jsx_runtime.jsx)("div",{className:paragraph_setting_index_module.paragraphSettingLabel,children:localeService.t("doc.paragraphSetting.lineSpace")}),(0,jsx_runtime.jsxs)("div",{className:`\n                          ${paragraph_setting_index_module.paragraphSettingMtBase}\n                          ${paragraph_setting_index_module.paragraphSettingSpaceLine}\n                        `,style:{width:162},children:[(0,jsx_runtime.jsx)(design_src.l6,{value:`${spacingRule}`,options:[{label:localeService.t("doc.paragraphSetting.multiSpace"),value:`${src.Oax.AUTO}`},{label:localeService.t("doc.paragraphSetting.fixedValue"),value:`${src.Oax.AT_LEAST}`}],onChange:v=>spacingRuleSet(Number(v))}),(0,jsx_runtime.jsx)(AutoFocusInputNumber,{...lineSpaceConfig,value:lineSpacing,onChange:v=>lineSpacingSet(v??0)})]})]})]})]})}ParagraphSetting.__docgenInfo={description:"",methods:[],displayName:"ParagraphSetting"};function ParagraphSettingIndex(){const commandService=(0,ui_src.fJ)(src.wTY),localeService=(0,ui_src.fJ)(src.iH9),currentLocale=(0,ui_src.J2)(localeService.currentLocale$),[key,keySet]=(0,react.useState)(""),debounceReset=(0,react.useMemo)((()=>(0,src.sg1)((()=>keySet((0,src.MZQ)(4))),300)),[]),rangeRef=(0,react.useRef)([]);return(0,react.useEffect)((()=>{const dispose=commandService.onCommandExecuted((info=>{if(docs_src.Uh.id===info.id){const ranges=info.params.ranges;((oldRanges,ranges)=>ranges.length===oldRanges.length&&oldRanges.some((oldRange=>ranges.some((range=>range.startOffset===oldRange.startOffset&&range.endOffset===oldRange.endOffset)))))(ranges,rangeRef.current)||keySet((0,src.MZQ)(4)),rangeRef.current=ranges}if(docs_src.Bz.id===info.id){info.params.trigger!==doc_paragraph_setting_command.Y.id&&debounceReset()}}));return()=>dispose.dispose()}),[debounceReset]),(0,react.useEffect)((()=>{keySet((0,src.MZQ)(4))}),[currentLocale]),(0,react.useEffect)((()=>()=>debounceReset.cancel()),[debounceReset]),(0,jsx_runtime.jsx)(ParagraphSetting,{},key)}function _ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function _ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}ParagraphSettingIndex.__docgenInfo={description:"",methods:[],displayName:"ParagraphSettingIndex"};class DocParagraphSettingController extends src.jGt{constructor(_commandService,_componentManager,_sidebarService){super(),this._commandService=_commandService,this._componentManager=_componentManager,this._sidebarService=_sidebarService,this._init()}_init(){this.disposeWithMe(this._componentManager.register("doc_ui_paragraph-setting-panel",ParagraphSettingIndex))}openPanel(){const props={header:{title:"doc.slider.paragraphSetting"},id:this._id,children:{label:"doc_ui_paragraph-setting-panel"},width:300};this._sidebarService.open(props)}closePanel(){this._sidebarService.close(this._id)}}DocParagraphSettingController=function _ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([_ts_param(0,src.wTY),_ts_param(1,(0,src.y_5)(ui_src.BJ)),_ts_param(2,(0,src.y_5)(ui_src.Jj)),_ts_metadata("design:type",Function),_ts_metadata("design:paramtypes",[void 0===src.wTY?Object:src.wTY,void 0===ui_src.BJ?Object:ui_src.BJ,void 0===ui_src.Jj?Object:ui_src.Jj])],DocParagraphSettingController)},"../../packages/docs-ui/src/controllers/menu.schema.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{X:()=>menuSchema});var src=__webpack_require__("../../packages/ui/src/index.ts"),clipboard_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/clipboard.command.ts"),doc_delete_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/doc-delete.command.ts"),doc_header_footer_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/doc-header-footer.command.ts"),doc_horizontal_line_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/doc-horizontal-line.command.ts"),inline_format_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/inline-format.command.ts"),list_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/list.command.ts"),paragraph_align_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/paragraph-align.command.ts"),switch_doc_mode_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/switch-doc-mode.command.ts"),doc_table_delete_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/table/doc-table-delete.command.ts"),doc_table_insert_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/table/doc-table-insert.command.ts"),doc_create_table_operation=__webpack_require__("../../packages/docs-ui/src/commands/operations/doc-create-table.operation.ts"),doc_paragraph_setting_panel_operation=__webpack_require__("../../packages/docs-ui/src/commands/operations/doc-paragraph-setting-panel.operation.ts"),core_src=__webpack_require__("../../packages/core/src/index.ts"),docs_src=__webpack_require__("../../packages/docs/src/index.ts"),Observable=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/Observable.js"),combineLatest=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/observable/combineLatest.js");const getDisableOnCollapsedObservable=accessor=>{const docSelectionManagerService=accessor.get(docs_src.pv);return new Observable.c((subscriber=>{const observable=docSelectionManagerService.textSelection$.subscribe((()=>{docSelectionManagerService.getDocRanges().some((range=>!1===range.collapsed||range.rangeType===core_src.AlE.RECT))?subscriber.next(!1):subscriber.next(!0)}));return()=>observable.unsubscribe()}))};function notInTableSubscriber(subscriber,docSelectionManagerService,univerInstanceService){const rectRanges=docSelectionManagerService.getRectRanges(),activeRange=docSelectionManagerService.getActiveTextRange();if(rectRanges&&rectRanges.length&&function inSameTable(rectRanges){if(rectRanges.length<2)return!0;const tableIds=rectRanges.map((rectRange=>rectRange.tableId));return tableIds.every((tableId=>tableId===tableIds[0]))}(rectRanges)&&null==activeRange)subscriber.next(!1);else{if(activeRange&&(null==rectRanges||0===rectRanges.length)){const{segmentId,startOffset,endOffset}=activeRange,docDataModel=univerInstanceService.getCurrentUniverDocInstance(),tables=docDataModel?.getSelfOrHeaderFooterModel(segmentId).getBody()?.tables;if(tables&&tables.length&&tables.some((table=>{const{startIndex,endIndex}=table;return startOffset>startIndex&&startOffset<endIndex||endOffset>startIndex&&endOffset<endIndex})))return void subscriber.next(!1)}subscriber.next(!0)}}const getDisableWhenSelectionNotInTableObservable=accessor=>{const docSelectionManagerService=accessor.get(docs_src.pv),univerInstanceService=accessor.get(core_src.HCr);return new Observable.c((subscriber=>{const observable=docSelectionManagerService.textSelection$.subscribe((()=>{notInTableSubscriber(subscriber,docSelectionManagerService,univerInstanceService)}));return notInTableSubscriber(subscriber,docSelectionManagerService,univerInstanceService),()=>observable.unsubscribe()}))},TABLE_INSERT_MENU_ID="doc.menu.table-insert";const TABLE_DELETE_MENU_ID="doc.menu.table-delete";var engine_render_src=__webpack_require__("../../packages/engine-render/src/index.ts"),map=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/map.js"),util=__webpack_require__("../../packages/docs-ui/src/commands/util.ts"),color_picker=__webpack_require__("../../packages/docs-ui/src/components/color-picker/index.ts"),font_family=__webpack_require__("../../packages/docs-ui/src/components/font-family/index.ts"),font_size=__webpack_require__("../../packages/docs-ui/src/components/font-size/index.ts"),list_type_picker=__webpack_require__("../../packages/docs-ui/src/components/list-type-picker/index.ts"),doc_menu_style_service=__webpack_require__("../../packages/docs-ui/src/services/doc-menu-style.service.ts");function getInsertTableHiddenObservable(accessor){const univerInstanceService=accessor.get(core_src.HCr),renderManagerService=accessor.get(engine_render_src.cSx);return new Observable.c((subscriber=>{const subscription=univerInstanceService.focused$.subscribe((unitId=>{if(null==unitId)return subscriber.next(!0);if(univerInstanceService.getUnitType(unitId)!==core_src.Zy$.UNIVER_DOC)return subscriber.next(!0);const currentRender=renderManagerService.getRenderById(unitId);if(null==currentRender)return subscriber.next(!0);currentRender.with(docs_src.EX).getViewModel().editAreaChange$.subscribe((editArea=>{subscriber.next(editArea===engine_render_src.ZCK.HEADER||editArea===engine_render_src.ZCK.FOOTER)}))}));return()=>subscription.unsubscribe()}))}function getHeaderFooterMenuHiddenObservable(accessor){const univerInstanceService=accessor.get(core_src.HCr),commandService=accessor.get(core_src.wTY);return new Observable.c((subscriber=>{const subscription0=commandService.onCommandExecuted((command=>{if(command.id===docs_src.Bz.id){const{unitId}=command.params,docDataModel=univerInstanceService.getUnit(unitId);if(null==docDataModel)return void subscriber.next(!0);const{documentStyle}=docDataModel.getSnapshot();subscriber.next(documentStyle?.documentFlavor!==core_src.CQy.TRADITIONAL)}})),subscription=univerInstanceService.focused$.subscribe((unitId=>{if(null==unitId)return subscriber.next(!0);const docDataModel=univerInstanceService.getUniverDocInstance(unitId),documentFlavor=docDataModel?.getSnapshot().documentStyle.documentFlavor;subscriber.next(documentFlavor!==core_src.CQy.TRADITIONAL)})),docDataModel=univerInstanceService.getCurrentUniverDocInstance();if(null==docDataModel)return subscriber.next(!0);const documentFlavor=docDataModel?.getSnapshot().documentStyle.documentFlavor;return subscriber.next(documentFlavor!==core_src.CQy.TRADITIONAL),()=>{subscription0.dispose(),subscription.unsubscribe()}}))}function getTableDisabledObservable(accessor){const docSelectionManagerService=accessor.get(docs_src.pv),univerInstanceService=accessor.get(core_src.HCr);return new Observable.c((subscriber=>{const subscription=docSelectionManagerService.textSelection$.subscribe((selection=>{if(null==selection)return void subscriber.next(!0);const{textRanges}=selection;if(1!==textRanges.length)return void subscriber.next(!0);const textRange=textRanges[0],{collapsed,startNodePosition,startOffset}=textRange;if(!collapsed||null==startOffset)return void subscriber.next(!0);const docDataModel=univerInstanceService.getCurrentUniverDocInstance();if(null==docDataModel)return void subscriber.next(!0);const docSkeletonManagerService=(0,util.R)(accessor,docDataModel.getUnitId());if(null==docSkeletonManagerService)return void subscriber.next(!0);if(docSkeletonManagerService.getViewModel().getCustomRangeRaw(startOffset))subscriber.next(!0);else{if(null!=startNodePosition){const{path}=startNodePosition;if(-1!==path.indexOf("cells"))return void subscriber.next(!0)}subscriber.next(!1)}}));return()=>subscription.unsubscribe()}))}function disableMenuWhenNoDocRange(accessor){const docSelectionManagerService=accessor.get(docs_src.pv);return new Observable.c((subscriber=>{const subscription=docSelectionManagerService.textSelection$.subscribe((selection=>{if(null==selection)return void subscriber.next(!0);const{textRanges,rectRanges}=selection;0!==textRanges.length||0!==rectRanges.length?subscriber.next(!1):subscriber.next(!0)}));return()=>subscription.unsubscribe()}))}const TABLE_MENU_ID="doc.menu.table";const listValueFactory$=accessor=>new Observable.c((subscriber=>{const univerInstanceService=accessor.get(core_src.HCr),docSelectionManagerService=accessor.get(docs_src.pv);let textSubscription;const subscription=univerInstanceService.focused$.subscribe((unitId=>{if(textSubscription?.unsubscribe(),null==unitId)return;const docDataModel=univerInstanceService.getUniverDocInstance(unitId);null!=docDataModel&&(textSubscription=docSelectionManagerService.textSelection$.subscribe((()=>{const docRanges=docSelectionManagerService.getDocRanges(),range=docRanges.find((r=>r.isActive))??docRanges[0];if(range){const doc=docDataModel.getSelfOrHeaderFooterModel(range?.segmentId);let listType;if((0,list_command.um)(range,doc.getBody()?.paragraphs??[]).every((p=>(listType||(listType=p.bullet?.listType),p.bullet&&p.bullet.listType===listType))))return void subscriber.next(listType)}subscriber.next(void 0)})))}));return()=>{subscription.unsubscribe(),textSubscription?.unsubscribe()}}));function getFontStyleAtCursor(accessor){const univerInstanceService=accessor.get(core_src.HCr),textSelectionService=accessor.get(docs_src.pv),docMenuStyleService=accessor.get(doc_menu_style_service._),docDataModel=univerInstanceService.getCurrentUnitForType(core_src.Zy$.UNIVER_DOC),docRanges=textSelectionService.getDocRanges(),activeRange=docRanges.find((r=>r.isActive))??docRanges[0],defaultTextStyle=docMenuStyleService.getDefaultStyle(),cacheStyle=docMenuStyleService.getStyleCache()??{};if(null==docDataModel||null==activeRange)return{ts:{...defaultTextStyle,...cacheStyle}};const{segmentId}=activeRange,body=docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();if(null==body)return{ts:{...defaultTextStyle,...cacheStyle}};return{ts:{...(0,inline_format_command.vV)(body,activeRange,defaultTextStyle),...cacheStyle}}}function getParagraphStyleAtCursor(accessor){const univerInstanceService=accessor.get(core_src.HCr),textSelectionService=accessor.get(docs_src.pv),docDataModel=univerInstanceService.getCurrentUniverDocInstance(),docRanges=textSelectionService.getDocRanges(),activeRange=docRanges.find((r=>r.isActive))??docRanges[0];if(null==docDataModel||null==activeRange)return;const{startOffset,segmentId}=activeRange,paragraphs=docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()?.paragraphs;if(null==paragraphs)return;let prevIndex=-1;for(const paragraph of paragraphs){const{startIndex}=paragraph;if(startOffset>prevIndex&&startOffset<=startIndex)return paragraph;prevIndex=startIndex}return null}const menuSchema={[src.My.FORMAT]:{[inline_format_command.D6.id]:{order:0,menuItemFactory:function BoldMenuItemFactory(accessor){const commandService=accessor.get(core_src.wTY);return{id:inline_format_command.D6.id,type:src.xU.BUTTON,icon:"BoldSingle",title:"Set bold",tooltip:"toolbar.bold",activated$:new Observable.c((subscriber=>{const disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id===docs_src.Uh.id||id===inline_format_command.EM.id){const textRun=getFontStyleAtCursor(accessor);if(null==textRun)return void subscriber.next(!1);const bl=textRun.ts?.bl;subscriber.next(bl===core_src.OdA.TRUE)}}));return subscriber.next(!1),disposable.dispose})),disabled$:disableMenuWhenNoDocRange(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)}}},[inline_format_command._H.id]:{order:1,menuItemFactory:function ItalicMenuItemFactory(accessor){const commandService=accessor.get(core_src.wTY);return{id:inline_format_command._H.id,type:src.xU.BUTTON,icon:"ItalicSingle",title:"Set italic",tooltip:"toolbar.italic",activated$:new Observable.c((subscriber=>{const disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id===docs_src.Uh.id||id===inline_format_command.EM.id){const textRun=getFontStyleAtCursor(accessor);if(null==textRun)return void subscriber.next(!1);const it=textRun.ts?.it;subscriber.next(it===core_src.OdA.TRUE)}}));return subscriber.next(!1),disposable.dispose})),disabled$:disableMenuWhenNoDocRange(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)}}},[inline_format_command.uk.id]:{order:2,menuItemFactory:function UnderlineMenuItemFactory(accessor){const commandService=accessor.get(core_src.wTY);return{id:inline_format_command.uk.id,type:src.xU.BUTTON,icon:"UnderlineSingle",title:"Set underline",tooltip:"toolbar.underline",activated$:new Observable.c((subscriber=>{const disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id===docs_src.Uh.id||id===inline_format_command.EM.id){const textRun=getFontStyleAtCursor(accessor);if(null==textRun)return void subscriber.next(!1);const ul=textRun.ts?.ul;subscriber.next(ul?.s===core_src.OdA.TRUE)}}));return subscriber.next(!1),disposable.dispose})),disabled$:disableMenuWhenNoDocRange(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)}}},[inline_format_command.rF.id]:{order:3,menuItemFactory:function StrikeThroughMenuItemFactory(accessor){const commandService=accessor.get(core_src.wTY);return{id:inline_format_command.rF.id,type:src.xU.BUTTON,icon:"StrikethroughSingle",title:"Set strike through",tooltip:"toolbar.strikethrough",activated$:new Observable.c((subscriber=>{const disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id===docs_src.Uh.id||id===inline_format_command.EM.id){const textRun=getFontStyleAtCursor(accessor);if(null==textRun)return void subscriber.next(!1);const st=textRun.ts?.st;subscriber.next(st?.s===core_src.OdA.TRUE)}}));return subscriber.next(!1),disposable.dispose})),disabled$:disableMenuWhenNoDocRange(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)}}},[inline_format_command.xL.id]:{order:4,menuItemFactory:function SubscriptMenuItemFactory(accessor){const commandService=accessor.get(core_src.wTY);return{id:inline_format_command.xL.id,type:src.xU.BUTTON,icon:"SubscriptSingle",tooltip:"toolbar.subscript",activated$:new Observable.c((subscriber=>{const disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id===docs_src.Uh.id||id===inline_format_command.EM.id){const textRun=getFontStyleAtCursor(accessor);if(null==textRun)return void subscriber.next(!1);const va=textRun.ts?.va;subscriber.next(va===core_src.DRO.SUBSCRIPT)}}));return subscriber.next(!1),disposable.dispose})),disabled$:disableMenuWhenNoDocRange(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)}}},[inline_format_command.yS.id]:{order:5,menuItemFactory:function SuperscriptMenuItemFactory(accessor){const commandService=accessor.get(core_src.wTY);return{id:inline_format_command.yS.id,type:src.xU.BUTTON,icon:"SuperscriptSingle",tooltip:"toolbar.superscript",activated$:new Observable.c((subscriber=>{const disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id===docs_src.Uh.id||id===inline_format_command.EM.id){const textRun=getFontStyleAtCursor(accessor);if(null==textRun)return void subscriber.next(!1);const va=textRun.ts?.va;subscriber.next(va===core_src.DRO.SUPERSCRIPT)}}));return subscriber.next(!1),disposable.dispose})),disabled$:disableMenuWhenNoDocRange(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)}}},[inline_format_command.mZ.id]:{order:6,menuItemFactory:function FontSizeSelectorMenuItemFactory(accessor){const commandService=accessor.get(core_src.wTY);return{id:inline_format_command.mZ.id,type:src.xU.SELECTOR,tooltip:"toolbar.fontSize",label:{name:font_size.K,props:{min:1,max:400}},selections:src.X5,value$:new Observable.c((subscriber=>{const DEFAULT_SIZE=core_src.Hnp.fs,disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id===docs_src.Uh.id||id===inline_format_command.mZ.id){const textRun=getFontStyleAtCursor(accessor);if(null==textRun)return void subscriber.next(DEFAULT_SIZE);const fs=textRun.ts?.fs;subscriber.next(fs??DEFAULT_SIZE)}}));return subscriber.next(DEFAULT_SIZE),disposable.dispose})),disabled$:disableMenuWhenNoDocRange(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)}}},[inline_format_command.vp.id]:{order:7,menuItemFactory:function FontFamilySelectorMenuItemFactory(accessor){const commandService=accessor.get(core_src.wTY);return{id:inline_format_command.vp.id,tooltip:"toolbar.font",type:src.xU.SELECTOR,label:font_family.fj,selections:src.Mc.map((item=>({label:{name:font_family.VI},value:item.value}))),value$:new Observable.c((subscriber=>{const defaultValue=core_src.Hnp.ff,disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id===docs_src.Uh.id||id===inline_format_command.vp.id){const textRun=getFontStyleAtCursor(accessor);if(null==textRun)return void subscriber.next(defaultValue);const ff=textRun.ts?.ff;subscriber.next(ff??defaultValue)}}));return subscriber.next(defaultValue),disposable.dispose})),disabled$:disableMenuWhenNoDocRange(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)}}},[inline_format_command.Qo.id]:{order:8,menuItemFactory:function TextColorSelectorMenuItemFactory(accessor){const commandService=accessor.get(core_src.wTY),themeService=accessor.get(core_src.Fsb);return{id:inline_format_command.Qo.id,icon:"FontColor",tooltip:"toolbar.textColor.main",type:src.xU.BUTTON_SELECTOR,selections:[{label:{name:color_picker.X,hoverable:!1,selectable:!1}}],value$:new Observable.c((subscriber=>{const defaultColor=themeService.getCurrentTheme().textColor,disposable=commandService.onCommandExecuted((c=>{if(c.id===inline_format_command.Qo.id){const color=c.params.value;subscriber.next(color??defaultColor)}}));return subscriber.next(defaultColor),disposable.dispose})),disabled$:disableMenuWhenNoDocRange(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)}}},[inline_format_command.Ag.id]:{order:9,menuItemFactory:function BackgroundColorSelectorMenuItemFactory(accessor){const commandService=accessor.get(core_src.wTY),themeService=accessor.get(core_src.Fsb);return{id:inline_format_command.Ag.id,tooltip:"toolbar.fillColor.main",type:src.xU.BUTTON_SELECTOR,icon:"PaintBucket",selections:[{label:{name:color_picker.X,hoverable:!1,selectable:!1}}],value$:new Observable.c((subscriber=>{const defaultColor=themeService.getCurrentTheme().primaryColor,disposable=commandService.onCommandExecuted((c=>{if(c.id===inline_format_command.Ag.id){const color=c.params.value;subscriber.next(color??defaultColor)}}));return subscriber.next(defaultColor),disposable.dispose})),disabled$:disableMenuWhenNoDocRange(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)}},[inline_format_command.tE.id]:{order:0,menuItemFactory:function ResetBackgroundColorMenuItemFactory(accessor){return{id:inline_format_command.tE.id,type:src.xU.BUTTON,title:"toolbar.resetColor",icon:"NoColor"}}}}},[src.My.LAYOUT]:{[TABLE_MENU_ID]:{order:1,menuItemFactory:function TableMenuFactory(accessor){return{id:"doc.menu.table",type:src.xU.SUBITEMS,icon:"GridSingle",tooltip:"toolbar.table.main",disabled$:getTableDisabledObservable(accessor),hidden$:(0,combineLatest.z)((0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC,void 0,core_src.HTw),getInsertTableHiddenObservable(accessor),((one,two)=>one||two))}},[doc_create_table_operation.c.id]:{order:0,menuItemFactory:function InsertTableMenuFactory(_accessor){return{id:doc_create_table_operation.c.id,title:"toolbar.table.insert",type:src.xU.BUTTON,hidden$:(0,src.fN)(_accessor,core_src.Zy$.UNIVER_DOC)}}}},[paragraph_align_command.c5.id]:{order:2,menuItemFactory:function AlignLeftMenuItemFactory(accessor){const commandService=accessor.get(core_src.wTY);return{id:paragraph_align_command.c5.id,type:src.xU.BUTTON,icon:"LeftJustifyingSingle",tooltip:"toolbar.alignLeft",disabled$:disableMenuWhenNoDocRange(accessor),activated$:new Observable.c((subscriber=>{const disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id===docs_src.Uh.id||id===paragraph_align_command.od.id){const paragraph=getParagraphStyleAtCursor(accessor);if(null==paragraph)return;const alignType=paragraph.paragraphStyle?.horizontalAlign;subscriber.next(alignType===core_src.wqs.LEFT)}}));return subscriber.next(!1),disposable.dispose})),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC,void 0,core_src.HTw)}}},[paragraph_align_command.uk.id]:{order:3,menuItemFactory:function AlignCenterMenuItemFactory(accessor){const commandService=accessor.get(core_src.wTY);return{id:paragraph_align_command.uk.id,type:src.xU.BUTTON,icon:"HorizontallySingle",tooltip:"toolbar.alignCenter",activated$:new Observable.c((subscriber=>{const disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id===docs_src.Uh.id||id===paragraph_align_command.od.id){const paragraph=getParagraphStyleAtCursor(accessor);if(null==paragraph)return;const alignType=paragraph.paragraphStyle?.horizontalAlign;subscriber.next(alignType===core_src.wqs.CENTER)}}));return subscriber.next(!1),disposable.dispose})),disabled$:disableMenuWhenNoDocRange(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC,void 0,core_src.HTw)}}},[paragraph_align_command.L7.id]:{order:4,menuItemFactory:function AlignRightMenuItemFactory(accessor){const commandService=accessor.get(core_src.wTY);return{id:paragraph_align_command.L7.id,type:src.xU.BUTTON,icon:"RightJustifyingSingle",tooltip:"toolbar.alignRight",activated$:new Observable.c((subscriber=>{const disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id===docs_src.Uh.id||id===paragraph_align_command.od.id){const paragraph=getParagraphStyleAtCursor(accessor);if(null==paragraph)return;const alignType=paragraph.paragraphStyle?.horizontalAlign;subscriber.next(alignType===core_src.wqs.RIGHT)}}));return subscriber.next(!1),disposable.dispose})),disabled$:disableMenuWhenNoDocRange(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC,void 0,core_src.HTw)}}},[paragraph_align_command.JV.id]:{order:5,menuItemFactory:function AlignJustifyMenuItemFactory(accessor){const commandService=accessor.get(core_src.wTY);return{id:paragraph_align_command.JV.id,type:src.xU.BUTTON,icon:"AlignTextBothSingle",tooltip:"toolbar.alignJustify",activated$:new Observable.c((subscriber=>{const disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id===docs_src.Uh.id||id===paragraph_align_command.od.id){const paragraph=getParagraphStyleAtCursor(accessor);if(null==paragraph)return;const alignType=paragraph.paragraphStyle?.horizontalAlign;subscriber.next(alignType===core_src.wqs.JUSTIFIED)}}));return subscriber.next(!1),disposable.dispose})),disabled$:disableMenuWhenNoDocRange(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC,void 0,core_src.HTw)}}},[doc_horizontal_line_command.G.id]:{order:6,menuItemFactory:function HorizontalLineFactory(accessor){return{id:doc_horizontal_line_command.G.id,type:src.xU.BUTTON,icon:"ReduceSingle",tooltip:"toolbar.horizontalLine",disabled$:disableMenuWhenNoDocRange(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC,void 0,core_src.HTw)}}},[list_command.kx.id]:{order:7,menuItemFactory:function OrderListMenuItemFactory(accessor){return{id:list_command.kx.id,type:src.xU.BUTTON_SELECTOR,slot:!0,selections:[{label:{name:list_type_picker.$t,hoverable:!1,selectable:!1},value$:listValueFactory$(accessor)}],icon:"OrderSingle",tooltip:"toolbar.order",hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC),disabled$:disableMenuWhenNoDocRange(accessor),activated$:listValueFactory$(accessor).pipe((0,map.T)((v=>v&&0===v.indexOf("ORDER_LIST"))))}}},[list_command.mh.id]:{order:8,menuItemFactory:function BulletListMenuItemFactory(accessor){return{id:list_command.mh.id,type:src.xU.BUTTON_SELECTOR,slot:!0,selections:[{label:{name:list_type_picker.n_,hoverable:!1,selectable:!1},value$:listValueFactory$(accessor)}],icon:"UnorderSingle",tooltip:"toolbar.unorder",disabled$:disableMenuWhenNoDocRange(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC),activated$:listValueFactory$(accessor).pipe((0,map.T)((v=>v&&0===v.indexOf("BULLET_LIST"))))}}},[list_command.Sm.id]:{order:9,menuItemFactory:function CheckListMenuItemFactory(accessor){return{id:list_command.Sm.id,type:src.xU.BUTTON,icon:"TodoList",tooltip:"toolbar.checklist",disabled$:disableMenuWhenNoDocRange(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC),activated$:listValueFactory$(accessor).pipe((0,map.T)((v=>v&&0===v.indexOf("CHECK_LIST"))))}}},[doc_header_footer_command.WM.id]:{order:10,menuItemFactory:function HeaderFooterMenuItemFactory(accessor){return{id:doc_header_footer_command.WM.id,type:src.xU.BUTTON,icon:"HeaderFooterSingle",tooltip:"toolbar.headerFooter",hidden$:(0,combineLatest.z)((0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC,void 0,core_src.HTw),getHeaderFooterMenuHiddenObservable(accessor),((one,two)=>one||two))}}},[switch_doc_mode_command.x.id]:{order:11,menuItemFactory:function DocSwitchModeMenuItemFactory(accessor){const commandService=accessor.get(core_src.wTY),univerInstanceService=accessor.get(core_src.HCr);return{id:switch_doc_mode_command.x.id,type:src.xU.BUTTON,icon:"KeyboardSingle",tooltip:"toolbar.documentFlavor",hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC,void 0,core_src.HTw),activated$:new Observable.c((subscriber=>{const subscription=commandService.onCommandExecuted((c=>{if(c.id===docs_src.Bz.id){const instance=univerInstanceService.getCurrentUnitForType(core_src.Zy$.UNIVER_DOC);subscriber.next(instance?.getSnapshot()?.documentStyle.documentFlavor===core_src.CQy.MODERN)}})),instance=univerInstanceService.getCurrentUnitForType(core_src.Zy$.UNIVER_DOC);return subscriber.next(instance?.getSnapshot()?.documentStyle.documentFlavor===core_src.CQy.MODERN),()=>subscription.dispose()}))}}}},[src.ai.MAIN_AREA]:{[src.Q2.FORMAT]:{[clipboard_command.P1.name]:{order:0,menuItemFactory:accessor=>({id:clipboard_command.P1.name,commandId:clipboard_command.P1.id,type:src.xU.BUTTON,icon:"Copy",title:"rightClick.copy",disabled$:getDisableOnCollapsedObservable(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)})},[clipboard_command.ye.id]:{order:1,menuItemFactory:accessor=>({id:clipboard_command.ye.id,type:src.xU.BUTTON,icon:"Copy",title:"rightClick.cut",disabled$:getDisableOnCollapsedObservable(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)})},[clipboard_command.rZ.id]:{order:2,menuItemFactory:accessor=>({id:clipboard_command.rZ.id,type:src.xU.BUTTON,icon:"PasteSpecial",title:"rightClick.paste",hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)})},[doc_delete_command.iM.id]:{order:3,menuItemFactory:accessor=>({id:doc_delete_command.iM.id,type:src.xU.BUTTON,icon:"PasteSpecial",title:"rightClick.delete",disabled$:getDisableOnCollapsedObservable(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)})}},[src.Q2.LAYOUT]:{[doc_paragraph_setting_panel_operation.I.id]:{order:0,menuItemFactory:accessor=>({id:doc_paragraph_setting_panel_operation.I.id,type:src.xU.BUTTON,icon:"MenuSingle24",title:"doc.menu.paragraphSetting",hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)})},[TABLE_INSERT_MENU_ID]:{order:1,menuItemFactory:function TableInsertMenuItemFactory(accessor){return{id:"doc.menu.table-insert",type:src.xU.SUBITEMS,title:"table.insert",icon:"Insert",hidden$:(0,combineLatest.z)((0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC),getDisableWhenSelectionNotInTableObservable(accessor),((one,two)=>one||two))}},[doc_table_insert_command.k1.id]:{order:1,menuItemFactory:function InsertRowBeforeMenuItemFactory(accessor){return{id:doc_table_insert_command.k1.id,type:src.xU.BUTTON,title:"table.insertRowAbove",icon:"InsertRowAbove",disabled$:getDisableWhenSelectionNotInTableObservable(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)}}},[doc_table_insert_command.mZ.id]:{order:2,menuItemFactory:function InsertRowAfterMenuItemFactory(accessor){return{id:doc_table_insert_command.mZ.id,type:src.xU.BUTTON,title:"table.insertRowBelow",icon:"InsertRowBelow",disabled$:getDisableWhenSelectionNotInTableObservable(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)}}},[doc_table_insert_command.UG.id]:{order:3,menuItemFactory:function InsertColumnLeftMenuItemFactory(accessor){return{id:doc_table_insert_command.UG.id,type:src.xU.BUTTON,title:"table.insertColumnLeft",icon:"LeftInsertColumn",disabled$:getDisableWhenSelectionNotInTableObservable(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)}}},[doc_table_insert_command.X2.id]:{order:4,menuItemFactory:function InsertColumnRightMenuItemFactory(accessor){return{id:doc_table_insert_command.X2.id,type:src.xU.BUTTON,title:"table.insertColumnRight",icon:"RightInsertColumn",disabled$:getDisableWhenSelectionNotInTableObservable(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)}}}},[TABLE_DELETE_MENU_ID]:{order:2,menuItemFactory:function TableDeleteMenuItemFactory(accessor){return{id:"doc.menu.table-delete",type:src.xU.SUBITEMS,title:"table.delete",icon:"Reduce",hidden$:(0,combineLatest.z)((0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC),getDisableWhenSelectionNotInTableObservable(accessor),((one,two)=>one||two))}},[doc_table_delete_command.er.id]:{order:1,menuItemFactory:function DeleteRowsMenuItemFactory(accessor){return{id:doc_table_delete_command.er.id,type:src.xU.BUTTON,title:"table.deleteRows",icon:"DeleteRow",disabled$:getDisableWhenSelectionNotInTableObservable(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)}}},[doc_table_delete_command.Ws.id]:{order:2,menuItemFactory:function DeleteColumnsMenuItemFactory(accessor){return{id:doc_table_delete_command.Ws.id,type:src.xU.BUTTON,title:"table.deleteColumns",icon:"DeleteColumn",disabled$:getDisableWhenSelectionNotInTableObservable(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)}}},[doc_table_delete_command.dK.id]:{order:3,menuItemFactory:function DeleteTableMenuItemFactory(accessor){return{id:doc_table_delete_command.dK.id,type:src.xU.BUTTON,title:"table.deleteTable",icon:"GridSingle",disabled$:getDisableWhenSelectionNotInTableObservable(accessor),hidden$:(0,src.fN)(accessor,core_src.Zy$.UNIVER_DOC)}}}}}}}},"../../packages/docs-ui/src/services/clipboard/clipboard.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>DocClipboardService,v:()=>IDocClipboardService});var src=__webpack_require__("../../packages/core/src/index.ts"),docs_src=__webpack_require__("../../packages/docs/src/index.ts"),dist=__webpack_require__("../../node_modules/.pnpm/ot-json1@1.0.2/node_modules/ot-json1/dist/index.js"),Subject=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/Subject.js");class UnitDrawingService{dispose(){this._remove$.complete(),this._add$.complete(),this._update$.complete(),this._order$.complete(),this._focus$.complete(),this._featurePluginUpdate$.complete(),this._featurePluginAdd$.complete(),this._featurePluginRemove$.complete(),this._featurePluginOrderUpdate$.complete(),this.drawingManagerData={},this._oldDrawingManagerData={}}visibleNotification(visibleParams){this._visible$.next(visibleParams)}refreshTransform(updateParams){updateParams.forEach((updateParam=>{const param=this._getCurrentBySearch(updateParam);null!=param&&(param.transform=updateParam.transform,param.transforms=updateParam.transforms,param.isMultiTransform=updateParam.isMultiTransform)})),this.refreshTransformNotification(updateParams)}getDrawingDataForUnit(unitId){return this.drawingManagerData[unitId]||{}}removeDrawingDataForUnit(unitId){const subUnits=this.drawingManagerData[unitId];if(null==subUnits)return;delete this.drawingManagerData[unitId];const drawings=[];Object.keys(subUnits).forEach((subUnitId=>{const subUnit=subUnits[subUnitId];null!=subUnit?.data&&Object.keys(subUnit.data).forEach((drawingId=>{drawings.push({unitId,subUnitId,drawingId})}))})),drawings.length>0&&this.removeNotification(drawings)}registerDrawingData(unitId,data){this.drawingManagerData[unitId]=data}initializeNotification(unitId){const drawings=[],data=this.drawingManagerData[unitId];null!=data&&(Object.keys(data).forEach((subUnitId=>{this._establishDrawingMap(unitId,subUnitId);const subUnitData=data[subUnitId];Object.keys(subUnitData.data).forEach((drawingId=>{const drawing=subUnitData.data[drawingId];drawing.unitId=unitId,drawing.subUnitId=subUnitId,drawings.push(drawing)}))})),drawings.length>0&&this.addNotification(drawings))}getDrawingData(unitId,subUnitId){return this._getDrawingData(unitId,subUnitId)}setDrawingData(unitId,subUnitId,data){this.drawingManagerData[unitId][subUnitId].data=data}getBatchAddOp(insertParams){const objects=[],ops=[],invertOps=[];insertParams.forEach((insertParam=>{const{op,invertOp}=this._addByParam(insertParam);objects.push({unitId:insertParam.unitId,subUnitId:insertParam.subUnitId,drawingId:insertParam.drawingId}),ops.push(op),invertOps.push(invertOp)}));const op=ops.reduce(dist.type.compose,null),invertOp=invertOps.reduce(dist.type.compose,null),{unitId,subUnitId}=insertParams[0];return{undo:invertOp,redo:op,unitId,subUnitId,objects}}getBatchRemoveOp(removeParams){const ops=[],invertOps=[];removeParams.forEach((removeParam=>{const{op,invertOp}=this._removeByParam(removeParam);ops.unshift(op),invertOps.push(invertOp)}));const op=ops.reduce(dist.type.compose,null),invertOp=invertOps.reduce(dist.type.compose,null),{unitId,subUnitId}=removeParams[0];return{undo:invertOp,redo:op,unitId,subUnitId,objects:removeParams}}getBatchUpdateOp(updateParams){const objects=[],ops=[],invertOps=[];updateParams.forEach((updateParam=>{const{op,invertOp}=this._updateByParam(updateParam);objects.push({unitId:updateParam.unitId,subUnitId:updateParam.subUnitId,drawingId:updateParam.drawingId}),ops.push(op),invertOps.push(invertOp)}));const op=ops.reduce(dist.type.compose,null),invertOp=invertOps.reduce(dist.type.compose,null),{unitId,subUnitId}=updateParams[0];return{undo:invertOp,redo:op,unitId,subUnitId,objects}}removeNotification(removeParams){this._remove$.next(removeParams)}addNotification(insertParams){this._add$.next(insertParams)}updateNotification(updateParams){this._update$.next(updateParams)}orderNotification(orderParams){this._order$.next(orderParams)}groupUpdateNotification(groupParams){this._group$.next(groupParams)}ungroupUpdateNotification(groupParams){this._ungroup$.next(groupParams)}refreshTransformNotification(refreshParams){this._refreshTransform$.next(refreshParams)}getGroupDrawingOp(groupParams){const ops=[],{unitId,subUnitId}=groupParams[0].parent;groupParams.forEach((groupParam=>{ops.push(this._getGroupDrawingOp(groupParam))}));const op=ops.reduce(dist.type.compose,null);return{undo:dist.type.invertWithDoc(op,this.drawingManagerData),redo:op,unitId,subUnitId,objects:groupParams}}getUngroupDrawingOp(groupParams){const ops=[],{unitId,subUnitId}=groupParams[0].parent;groupParams.forEach((groupParam=>{ops.push(this._getUngroupDrawingOp(groupParam))}));const op=ops.reduce(dist.type.compose,null);return{undo:dist.type.invertWithDoc(op,this.drawingManagerData),redo:op,unitId,subUnitId,objects:groupParams}}getDrawingsByGroup(groupParam){const{unitId,subUnitId,drawingId}=groupParam;if(null==this.getDrawingByParam({unitId,subUnitId,drawingId}))return[];const drawings=this._getDrawingData(unitId,subUnitId),children=[];return Object.keys(drawings).forEach((key=>{const drawing=drawings[key];drawing.groupId===drawingId&&children.push(drawing)})),children}_getGroupDrawingOp(groupParam){const{parent,children}=groupParam,{unitId:groupUnitId,subUnitId:groupSubUnitId,drawingId:groupDrawingId}=parent,ops=[];ops.push(dist.insertOp([groupUnitId,groupSubUnitId,"data",groupDrawingId],parent));let maxChildIndex=Number.NEGATIVE_INFINITY;return children.forEach((child=>{const{unitId,subUnitId,drawingId}=child,index=this._hasDrawingOrder({unitId,subUnitId,drawingId});maxChildIndex=Math.max(maxChildIndex,index),ops.push(...this._getUpdateParamCompareOp(child,this.getDrawingByParam({unitId,subUnitId,drawingId})))})),maxChildIndex===Number.NEGATIVE_INFINITY&&(maxChildIndex=this._getDrawingOrder(groupUnitId,groupSubUnitId).length),ops.push(dist.insertOp([groupUnitId,groupSubUnitId,"order",maxChildIndex],groupDrawingId)),ops.reduce(dist.type.compose,null)}_getUngroupDrawingOp(groupParam){const{parent,children}=groupParam,{unitId:groupUnitId,subUnitId:groupSubUnitId,drawingId:groupDrawingId}=parent,ops=[];return children.forEach((child=>{const{unitId,subUnitId,drawingId}=child;ops.push(...this._getUpdateParamCompareOp(child,this.getDrawingByParam({unitId,subUnitId,drawingId})))})),ops.push(dist.removeOp([groupUnitId,groupSubUnitId,"data",groupDrawingId],!0)),ops.push(dist.removeOp([groupUnitId,groupSubUnitId,"order",this._getDrawingOrder(groupUnitId,groupSubUnitId).indexOf(groupDrawingId)],!0)),ops.reduce(dist.type.compose,null)}applyJson1(unitId,subUnitId,jsonOp){this._establishDrawingMap(unitId,subUnitId),this._oldDrawingManagerData={...this.drawingManagerData},this.drawingManagerData=dist.type.apply(this.drawingManagerData,jsonOp)}featurePluginUpdateNotification(updateParams){this._featurePluginUpdate$.next(updateParams)}featurePluginOrderUpdateNotification(drawingOrderUpdateParam){this._featurePluginOrderUpdate$.next(drawingOrderUpdateParam)}featurePluginAddNotification(insertParams){this._featurePluginAdd$.next(insertParams)}featurePluginRemoveNotification(removeParams){this._featurePluginRemove$.next(removeParams)}featurePluginGroupUpdateNotification(groupParams){this._featurePluginGroupUpdate$.next(groupParams)}featurePluginUngroupUpdateNotification(groupParams){this._featurePluginUngroupUpdate$.next(groupParams)}getDrawingByParam(param){return this._getCurrentBySearch(param)}getOldDrawingByParam(param){return this._getOldBySearch(param)}getDrawingOKey(oKey){const[unitId,subUnitId,drawingId]=oKey.split("#-#");return this._getCurrentBySearch({unitId,subUnitId,drawingId})}focusDrawing(params){if(null==params||0===params.length)return this._focusDrawings=[],void this._focus$.next([]);const drawingParams=[];params.forEach((param=>{const{unitId,subUnitId,drawingId}=param,item=this._getDrawingData(unitId,subUnitId)?.[drawingId];null!=item&&drawingParams.push(item)})),drawingParams.length>0&&(this._focusDrawings=drawingParams,this._focus$.next(drawingParams))}getFocusDrawings(){const drawingParams=[];return this._focusDrawings.forEach((param=>{const{unitId,subUnitId,drawingId}=param,item=this._getDrawingData(unitId,subUnitId)?.[drawingId];null!=item&&drawingParams.push(item)})),drawingParams}getDrawingOrder(unitId,subUnitId){return this._getDrawingOrder(unitId,subUnitId)}setDrawingOrder(unitId,subUnitId,order){this.drawingManagerData[unitId][subUnitId].order=order}orderUpdateNotification(orderParams){this._order$.next(orderParams)}getForwardDrawingsOp(orderParams){const{unitId,subUnitId,drawingIds}=orderParams,ops=[],orders=this.getDrawingOrder(unitId,subUnitId),newIds=[...drawingIds];drawingIds.forEach((drawingId=>{const index=this._hasDrawingOrder({unitId,subUnitId,drawingId});if(-1===index||index===orders.length-1)return;const op=dist.moveOp([unitId,subUnitId,"order",index],[unitId,subUnitId,"order",index+1]);ops.push(op),newIds.includes(orders[index+1])||newIds.push(orders[index+1])}));const op=ops.reduce(dist.type.compose,null);return{undo:dist.type.invertWithDoc(op,this.drawingManagerData),redo:op,unitId,subUnitId,objects:{...orderParams,drawingIds:newIds}}}getBackwardDrawingOp(orderParams){const{unitId,subUnitId,drawingIds}=orderParams,ops=[],orders=this.getDrawingOrder(unitId,subUnitId),newIds=[...drawingIds];drawingIds.forEach((drawingId=>{const index=this._hasDrawingOrder({unitId,subUnitId,drawingId});if(-1===index||0===index)return;const op=dist.moveOp([unitId,subUnitId,"order",index],[unitId,subUnitId,"order",index-1]);ops.push(op),newIds.includes(orders[index-1])||newIds.push(orders[index-1])}));const op=ops.reduce(dist.type.compose,null);return{undo:dist.type.invertWithDoc(op,this.drawingManagerData),redo:op,unitId,subUnitId,objects:{...orderParams,drawingIds:newIds}}}getFrontDrawingsOp(orderParams){const{unitId,subUnitId,drawingIds}=orderParams,orderDrawingIds=this._getOrderFromSearchParams(unitId,subUnitId,drawingIds),newIds=[...drawingIds],orders=this.getDrawingOrder(unitId,subUnitId),ops=[];orderDrawingIds.forEach((orderDrawingId=>{const{drawingId}=orderDrawingId,index=this._getDrawingCount(unitId,subUnitId)-1,op=dist.moveOp([unitId,subUnitId,"order",this._getDrawingOrder(unitId,subUnitId).indexOf(drawingId)],[unitId,subUnitId,"order",index]);ops.push(op),newIds.includes(orders[index])||newIds.push(orders[index])}));const op=ops.reduce(dist.type.compose,null);return{undo:dist.type.invertWithDoc(op,this.drawingManagerData),redo:op,unitId,subUnitId,objects:{...orderParams,drawingIds:newIds}}}getBackDrawingsOp(orderParams){const{unitId,subUnitId,drawingIds}=orderParams,orderSearchParams=this._getOrderFromSearchParams(unitId,subUnitId,drawingIds,!0),newIds=[...drawingIds],orders=this.getDrawingOrder(unitId,subUnitId),ops=[];orderSearchParams.forEach((orderSearchParam=>{const{drawingId}=orderSearchParam,op=dist.moveOp([unitId,subUnitId,"order",this._getDrawingOrder(unitId,subUnitId).indexOf(drawingId)],[unitId,subUnitId,"order",0]);ops.push(op),newIds.includes(orders[0])||newIds.push(orders[0])}));const op=ops.reduce(dist.type.compose,null);return{undo:dist.type.invertWithDoc(op,this.drawingManagerData),redo:op,unitId,subUnitId,objects:{...orderParams,drawingIds:newIds}}}_getDrawingCount(unitId,subUnitId){return this.getDrawingOrder(unitId,subUnitId).length||0}_getOrderFromSearchParams(unitId,subUnitId,drawingIds,isDesc=!1){return drawingIds.map((drawingId=>({drawingId,zIndex:this._hasDrawingOrder({unitId,subUnitId,drawingId})}))).sort(!1===isDesc?src.YRy:src.uCe)}_hasDrawingOrder(searchParam){if(null==searchParam)return-1;const{unitId,subUnitId,drawingId}=searchParam;return this._establishDrawingMap(unitId,subUnitId),this._getDrawingOrder(unitId,subUnitId).indexOf(drawingId)}_getCurrentBySearch(searchParam){if(null==searchParam)return;const{unitId,subUnitId,drawingId}=searchParam;return this.drawingManagerData[unitId]?.[subUnitId]?.data?.[drawingId]}_getOldBySearch(searchParam){if(null==searchParam)return;const{unitId,subUnitId,drawingId}=searchParam;return this._oldDrawingManagerData[unitId]?.[subUnitId]?.data?.[drawingId]}_establishDrawingMap(unitId,subUnitId,drawingId){return this.drawingManagerData[unitId]||(this.drawingManagerData[unitId]={}),this.drawingManagerData[unitId][subUnitId]||(this.drawingManagerData[unitId][subUnitId]={data:{},order:[]}),null==drawingId?null:this.drawingManagerData[unitId][subUnitId].data?.[drawingId]}_addByParam(insertParam){const{unitId,subUnitId,drawingId}=insertParam;this._establishDrawingMap(unitId,subUnitId,drawingId);const op=[dist.insertOp([unitId,subUnitId,"data",drawingId],insertParam),dist.insertOp([unitId,subUnitId,"order",this._getDrawingOrder(unitId,subUnitId).length],drawingId)].reduce(dist.type.compose,null);return{op,invertOp:dist.type.invertWithDoc(op,this.drawingManagerData)}}_removeByParam(searchParam){if(null==searchParam)return{op:[],invertOp:[]};const{unitId,subUnitId,drawingId}=searchParam;if(null==this._establishDrawingMap(unitId,subUnitId,drawingId))return{op:[],invertOp:[]};const op=[dist.removeOp([unitId,subUnitId,"data",drawingId],!0),dist.removeOp([unitId,subUnitId,"order",this._getDrawingOrder(unitId,subUnitId).indexOf(drawingId)],!0)].reduce(dist.type.compose,null);return{op,invertOp:dist.type.invertWithDoc(op,this.drawingManagerData)}}_updateByParam(updateParam){const{unitId,subUnitId,drawingId}=updateParam,object=this._establishDrawingMap(unitId,subUnitId,drawingId);if(null==object)return{op:[],invertOp:[]};const op=this._getUpdateParamCompareOp(updateParam,object).reduce(dist.type.compose,null);return{op,invertOp:dist.type.invertWithDoc(op,this.drawingManagerData)}}_getUpdateParamCompareOp(newParam,oldParam){const{unitId,subUnitId,drawingId}=newParam,ops=[];return Object.keys(newParam).forEach((key=>{const newVal=newParam[key],oldVal=oldParam[key];oldVal!==newVal&&ops.push(dist.replaceOp([unitId,subUnitId,"data",drawingId,key],oldVal,newVal))})),ops}_getDrawingData(unitId,subUnitId){return this.drawingManagerData[unitId]?.[subUnitId]?.data||{}}_getDrawingOrder(unitId,subUnitId){return this.drawingManagerData[unitId]?.[subUnitId]?.order||[]}getDrawingVisible(){return this._visible}getDrawingEditable(){return this._editable}setDrawingVisible(visible){this._visible=visible}setDrawingEditable(editable){this._editable=editable}constructor(){this.drawingManagerData={},this._oldDrawingManagerData={},this._focusDrawings=[],this._remove$=new Subject.B,this.remove$=this._remove$.asObservable(),this._add$=new Subject.B,this.add$=this._add$.asObservable(),this._update$=new Subject.B,this.update$=this._update$.asObservable(),this._order$=new Subject.B,this.order$=this._order$.asObservable(),this._group$=new Subject.B,this.group$=this._group$.asObservable(),this._ungroup$=new Subject.B,this.ungroup$=this._ungroup$.asObservable(),this._refreshTransform$=new Subject.B,this.refreshTransform$=this._refreshTransform$.asObservable(),this._visible$=new Subject.B,this.visible$=this._visible$.asObservable(),this._focus$=new Subject.B,this.focus$=this._focus$.asObservable(),this._featurePluginUpdate$=new Subject.B,this.featurePluginUpdate$=this._featurePluginUpdate$.asObservable(),this._featurePluginAdd$=new Subject.B,this.featurePluginAdd$=this._featurePluginAdd$.asObservable(),this._featurePluginRemove$=new Subject.B,this.featurePluginRemove$=this._featurePluginRemove$.asObservable(),this._featurePluginOrderUpdate$=new Subject.B,this.featurePluginOrderUpdate$=this._featurePluginOrderUpdate$.asObservable(),this._featurePluginGroupUpdate$=new Subject.B,this.featurePluginGroupUpdate$=this._featurePluginGroupUpdate$.asObservable(),this._featurePluginUngroupUpdate$=new Subject.B,this.featurePluginUngroupUpdate$=this._featurePluginUngroupUpdate$.asObservable(),this._visible=!0,this._editable=!0}}class DrawingManagerService extends UnitDrawingService{}const IDrawingManagerService=(0,src.Qmd)("univer.drawing-manager.service"),SetDrawingSelectedOperation={id:"drawing.operation.set-drawing-selected",type:src.g4t.OPERATION,handler:(accessor,params)=>{const drawingManagerService=accessor.get(IDrawingManagerService);return null!=params&&(drawingManagerService.focusDrawing(params),!0)}},defaultPluginConfig=(Symbol("drawing.config"),{}),DRAWING_IMAGE_ALLOW_IMAGE_LIST=["image/png","image/jpeg","image/jpg","image/gif","image/bmp"];class ImageIoService{setWaitCount(count){this._waitCount=count,this._change$.next(count)}getImageSourceCache(source,imageSourceType){if(imageSourceType===src.fKo.BASE64){const image=new Image;return image.src=source,image}return this._imageSourceCache.get(source)}addImageSourceCache(source,imageSourceType,imageSource){imageSourceType!==src.fKo.BASE64&&null!=imageSource&&this._imageSourceCache.set(source,imageSource)}async getImage(imageId){return Promise.resolve(imageId)}async saveImage(imageFile){return new Promise(((resolve,reject)=>{if(!DRAWING_IMAGE_ALLOW_IMAGE_LIST.includes(imageFile.type))return reject(new Error(src.DXG.ERROR_IMAGE_TYPE)),void this._decreaseWaiting();if(imageFile.size>5242880)return reject(new Error(src.DXG.ERROR_EXCEED_SIZE)),void this._decreaseWaiting();const reader=new FileReader;reader.readAsDataURL(imageFile),reader.onload=evt=>{const replaceSrc=evt.target?.result;if(null==replaceSrc)return reject(new Error(src.DXG.ERROR_IMAGE)),void this._decreaseWaiting();const imageId=src.S0q.generateRandomId(6);resolve({imageId,imageSourceType:src.fKo.BASE64,source:replaceSrc,base64Cache:replaceSrc,status:src.DXG.SUCCUSS}),this._decreaseWaiting()}}))}_decreaseWaiting(){this._waitCount-=1,this._change$.next(this._waitCount)}constructor(){this._waitCount=0,this._change$=new Subject.B,this.change$=this._change$,this._imageSourceCache=new Map}}function _ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function _ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class UniverDrawingPlugin extends src.k_1{static#_=this.pluginName="UNIVER_DRAWING_PLUGIN";constructor(_config=defaultPluginConfig,_injector,_configService,_commandService){super(),this._config=_config,this._injector=_injector,this._configService=_configService,this._commandService=_commandService;const{...rest}=(0,src.h1I)({},defaultPluginConfig,this._config);this._configService.setConfig("drawing.config",rest)}onStarting(){this._initCommands(),this._initDependencies()}_initDependencies(){const dependencies=[[src.KKc,{useClass:ImageIoService}],[IDrawingManagerService,{useClass:DrawingManagerService}]];(0,src.afw)(dependencies,this._config?.override).forEach((d=>this._injector.add(d)))}_initCommands(){[SetDrawingSelectedOperation].forEach((command=>this.disposeWithMe(this._commandService.registerCommand(command))))}}UniverDrawingPlugin=function _ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([_ts_param(1,(0,src.y_5)(src.zZn)),_ts_param(2,src.J0C),_ts_param(3,src.wTY),_ts_metadata("design:type",Function),_ts_metadata("design:paramtypes",["undefined"==typeof Partial?Object:Partial,void 0===src.zZn?Object:src.zZn,void 0===src.J0C?Object:src.J0C,void 0===src.wTY?Object:src.wTY])],UniverDrawingPlugin);var ui_src=__webpack_require__("../../packages/ui/src/index.ts"),clipboard_inner_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/clipboard.inner.command.ts"),doc_delete_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/doc-delete.command.ts");const copyContentCache=new class CopyContentCache{set(id,clipboardData){this._cache.set(id,clipboardData)}get(id){return this._cache.get(id)}clear(){this._cache.clear()}constructor(){this._cache=new src.GcK(10)}};var table_table=__webpack_require__("../../packages/docs-ui/src/commands/commands/table/table.ts"),parse_node_style=__webpack_require__("../../packages/docs-ui/src/services/clipboard/html-to-udm/parse-node-style.ts");function matchFilter(node,filter){const tagName=node.tagName.toLowerCase();return"string"==typeof filter?tagName===filter:Array.isArray(filter)?filter.some((name=>name===tagName)):filter(node)}class HtmlToUDMService{static#_=this._pluginList=[];static use(plugin){if(this._pluginList.includes(plugin))throw new Error(`Univer paste plugin ${plugin.name} already added`);this._pluginList.push(plugin)}convert(html,metaConfig={}){const pastePlugin=HtmlToUDMService._pluginList.find((plugin=>plugin.checkPasteType(html))),dom=function parseToDom(rawHtml){const html=`<x-univer id="univer-root">${rawHtml}</x-univer>`;return(new DOMParser).parseFromString(html,"text/html").querySelector("#univer-root")}(html),docData={body:{dataStream:"",paragraphs:[],sectionBreaks:[],tables:[],textRuns:[],customBlocks:[]},tableSource:{},id:metaConfig?.unitId??""};return pastePlugin&&(this._styleRules=[...pastePlugin.stylesRules],this._afterProcessRules=[...pastePlugin.afterProcessRules]),this._tableCache=[],this._styleCache.clear(),this._process(null,dom.childNodes,docData),this._styleCache.clear(),this._styleRules=[],this._afterProcessRules=[],docData}_process(parent,nodes,doc){const body=doc.body;for(const node of nodes)if(node.nodeType===Node.TEXT_NODE){if(""===node.nodeValue?.trim())continue;const text=node.nodeValue?.replace(/[\r\n]/g,"");let style;parent&&this._styleCache.has(parent)&&(style=this._styleCache.get(parent)),body.dataStream+=text,style&&Object.getOwnPropertyNames(style).length&&body.textRuns.push({st:body.dataStream.length-text.length,ed:body.dataStream.length,ts:style})}else if("IMG"===node.nodeName){const element=node,imageSourceType=element.dataset.imageSourceType,source=imageSourceType===src.fKo.UUID?element.dataset.source:element.src;if(source&&imageSourceType){const width=Number(element.dataset.width||100),height=Number(element.dataset.height||100),docTransformWidth=Number(element.dataset.docTransformWidth||width),docTransformHeight=Number(element.dataset.docTransformHeight||height),id=src.S0q.generateRandomId(6);doc.body?.customBlocks?.push({startIndex:body.dataStream.length,blockId:id}),body.dataStream+="\b",doc.drawings||(doc.drawings={}),doc.drawings[id]={drawingId:id,title:"",description:"",imageSourceType,source,transform:{width,height,left:0},docTransform:{size:{width:docTransformWidth,height:docTransformHeight},angle:0,positionH:{relativeFrom:src.sUw.PAGE,posOffset:0},positionV:{relativeFrom:src.egV.PARAGRAPH,posOffset:0}},layoutType:src.e9n.INLINE,drawingType:src.MJB.DRAWING_IMAGE,unitId:doc.id||"",subUnitId:doc.id||""}}}else{if(src.HBg.includes(node.nodeName.toLowerCase()))continue;if(node.nodeType===Node.ELEMENT_NODE){const element=node,linkStart=this._processBeforeLink(element,doc),parentStyles=parent?this._styleCache.get(parent):{},styleRule=this._styleRules.find((({filter})=>matchFilter(node,filter))),nodeStyles=styleRule?styleRule.getStyle(node):(0,parse_node_style.B)(node);this._styleCache.set(node,{...parentStyles,...nodeStyles});const{childNodes}=node;this._processBeforeTable(node,doc),this._process(node,childNodes,doc),this._processAfterTable(node,doc);const afterProcessRule=this._afterProcessRules.find((({filter})=>matchFilter(node,filter)));afterProcessRule&&afterProcessRule.handler(doc,node),this._processAfterLink(element,doc,linkStart)}}}_processBeforeTable(node,doc){const tagName=node.tagName.toUpperCase(),body=doc.body;switch(tagName){case"TABLE":{"\r"!==body.dataStream[body.dataStream.length-1]&&(body.dataStream+="\r",null==body.paragraphs&&(body.paragraphs=[]),body.paragraphs?.push({startIndex:body.dataStream.length-1}));const table=(0,table_table._h)(0,0,660);this._tableCache.push({table,startIndex:body.dataStream.length}),body.dataStream+=src.gqw.TABLE_START;break}case"TR":{const row=(0,table_table.uy)(0);this._tableCache[this._tableCache.length-1].table.tableRows.push(row),body.dataStream+=src.gqw.TABLE_ROW_START;break}case"TD":{const cell=(0,table_table.WY)(),lastTable=this._tableCache[this._tableCache.length-1].table;lastTable.tableRows[lastTable.tableRows.length-1].tableCells.push(cell),body.dataStream+=src.gqw.TABLE_CELL_START;break}}}_processAfterTable(node,doc){const tagName=node.tagName.toUpperCase(),body=doc.body;null==doc.tableSource&&(doc.tableSource={}),null==body.tables&&(body.tables=[]),null==body.sectionBreaks&&(body.sectionBreaks=[]);const{tableSource}=doc;switch(tagName){case"TABLE":{const tableCache=this._tableCache.pop(),{startIndex,table}=tableCache,colCount=table.tableRows[0].tableCells.length,tableColumn=(0,table_table.Jr)(660/colCount),tableColumns=[...new Array(colCount).fill(null).map((()=>src.S0q.deepClone(tableColumn)))];table.tableColumns=tableColumns,tableSource[table.tableId]=table,body.dataStream+=src.gqw.TABLE_END,body.tables.push({startIndex,endIndex:body.dataStream.length,tableId:table.tableId});break}case"TR":body.dataStream+=src.gqw.TABLE_ROW_END;break;case"TD":"\r"!==body.dataStream[body.dataStream.length-1]&&(body.paragraphs?.push({startIndex:body.dataStream.length}),body.dataStream+="\r"),body.sectionBreaks?.push({startIndex:body.dataStream.length}),body.dataStream+=`\n${src.gqw.TABLE_CELL_END}`}}_processBeforeLink(node,doc){return doc.body.dataStream.length}_processAfterLink(node,doc,start){const body=doc.body,element=node;"A"===element.tagName.toUpperCase()&&(body.customRanges=body.customRanges??[],body.customRanges.push({startIndex:start,endIndex:body.dataStream.length-1,rangeId:element.dataset.rangeid??(0,src.MZQ)(),rangeType:src.Bvh.HYPERLINK,properties:{url:element.href}}))}constructor(){this._tableCache=[],this._styleCache=new Map,this._styleRules=[],this._afterProcessRules=[]}}var plugin_lark=__webpack_require__("../../packages/docs-ui/src/services/clipboard/html-to-udm/paste-plugins/plugin-lark.ts"),plugin_univer=__webpack_require__("../../packages/docs-ui/src/services/clipboard/html-to-udm/paste-plugins/plugin-univer.ts"),plugin_word=__webpack_require__("../../packages/docs-ui/src/services/clipboard/html-to-udm/paste-plugins/plugin-word.ts"),engine_render_src=__webpack_require__("../../packages/engine-render/src/index.ts");function covertTextRunToHtml(dataStream,textRun){const{st:start,ed,ts={}}=textRun,{ff,fs,it,bl,ul,st,ol,bg,cl,va}=ts;let html=dataStream.slice(start,ed);const style=[];return it===src.OdA.TRUE&&(html=`<i>${html}</i>`),va===src.DRO.SUPERSCRIPT?html=`<sup>${html}</sup>`:va===src.DRO.SUBSCRIPT&&(html=`<sub>${html}</sub>`),ul?.s===src.OdA.TRUE&&(html=`<u>${html}</u>`),st?.s===src.OdA.TRUE&&(html=`<s>${html}</s>`),bl===src.OdA.TRUE&&(html=`<strong>${html}</strong>`),ff&&style.push(`font-family: ${ff}`),cl&&style.push(`color: ${cl.rgb}`),fs&&style.push(`font-size: ${fs}pt`),ol&&style.push("text-decoration: overline"),bg&&style.push(`background: ${bg.rgb}`),style.length?`<span style="${style.join("; ")};">${html}</span>`:html}function getBodyInlineSlice(body,startIndex,endIndex){const{dataStream,textRuns=[]}=body;if(startIndex===endIndex)return"";let cursorIndex=startIndex;const spanList=[];for(const textRun of textRuns){const{st,ed}=textRun;src.S0q.hasIntersectionBetweenTwoRanges(startIndex,endIndex,st,ed)&&(st>cursorIndex?(spanList.push(dataStream.slice(cursorIndex,st)),spanList.push(covertTextRunToHtml(dataStream,{...textRun,ed:Math.min(ed,endIndex)}))):spanList.push(covertTextRunToHtml(dataStream,{...textRun,st:cursorIndex,ed:Math.min(ed,endIndex)}))),cursorIndex=Math.max(startIndex,Math.min(ed,endIndex))}return cursorIndex!==endIndex&&spanList.push(dataStream.slice(cursorIndex,endIndex)),spanList.join("")}function convertBodyToHtml(doc){const body=doc.body||{},{paragraphs=[],sectionBreaks=[]}=body;let{dataStream=""}=body;dataStream.endsWith("\r\n")||(dataStream+="\r\n",paragraphs.push({startIndex:dataStream.length-2}),sectionBreaks.push({startIndex:dataStream.length-1}),body.dataStream=dataStream,body.paragraphs=paragraphs,body.sectionBreaks=sectionBreaks);const result={html:""},nodeList=(0,engine_render_src.DtO)(dataStream).sectionList;for(const node of nodeList)processNode(node,doc,result);return result.html}function processNode(node,doc,result){switch(node.nodeType){case src.L3c.SECTION_BREAK:for(const n of node.children)processNode(n,doc,result);break;case src.L3c.PARAGRAPH:{const{children,startIndex,endIndex}=node,paragraph=doc.body?.paragraphs.find((p=>p.startIndex===endIndex))??{},{paragraphStyle={}}=paragraph,{spaceAbove,spaceBelow,lineSpacing}=paragraphStyle,style=[];if(null!=spaceAbove&&("number"==typeof spaceAbove?style.push(`margin-top: ${spaceAbove}px`):style.push(`margin-top: ${spaceAbove.v}px`)),null!=spaceBelow&&("number"==typeof spaceBelow?style.push(`margin-bottom: ${spaceBelow}px`):style.push(`margin-bottom: ${spaceBelow.v}px`)),null!=lineSpacing&&style.push(`line-height: ${lineSpacing}`),result.html+=`<p class="UniverNormal" ${style.length?`style="${style.join("; ")};"`:""}>`,children.length)for(const table of children)processNode(table,doc,result);result.html+=`${function getBodySliceHtml(doc,startIndex,endIndex){const body=doc.body,drawings=doc.drawings||{},{customRanges=[],customBlocks=[]}=body||{},cloneCustomBlocks=[...customBlocks],customRangesInRange=customRanges.filter((range=>range.startIndex>=startIndex&&range.endIndex<=endIndex));let cursorIndex=startIndex,html="";const handleCustomBlock=(startIndex,endIndex)=>{let sliceHtml="",customBlockLength=0,handleCustomBlockCursorIndex=startIndex,blockItemIndex=cloneCustomBlocks.findIndex((block=>startIndex<=block.startIndex&&endIndex>=block.startIndex));if(-1===blockItemIndex)return sliceHtml=getBodyInlineSlice(body,startIndex,endIndex),{sliceHtml,customBlockLength};for(;-1!==blockItemIndex;){const blockItem=cloneCustomBlocks[blockItemIndex];cloneCustomBlocks.splice(blockItemIndex,1),sliceHtml+=getBodyInlineSlice(body,handleCustomBlockCursorIndex,blockItem.startIndex);const drawingItem=drawings[blockItem.blockId];drawingItem&&drawingItem.drawingType===src.MJB.DRAWING_IMAGE&&(sliceHtml+=`<img  ${(obj=>{let result="";return Object.keys(obj).forEach((key=>{void 0!==obj[key]&&(result+=` ${key}=${obj[key]}`)})),result})({"data-doc-transform-height":(item=drawingItem).docTransform.size.height,"data-doc-transform-width":item.docTransform.size.width,"data-width":item.transform?.width,"data-height":item.transform?.height,"data-image-source-type":item.imageSourceType,"data-source":item.imageSourceType===src.fKo.UUID?item.source:void 0,src:item.source})}></img>`,customBlockLength++),handleCustomBlockCursorIndex=blockItem.startIndex+1,blockItemIndex=cloneCustomBlocks.findIndex((block=>handleCustomBlockCursorIndex<=block.startIndex&&endIndex>=block.startIndex))}var item;return sliceHtml+=getBodyInlineSlice(body,handleCustomBlockCursorIndex,endIndex+1),{sliceHtml,customBlockLength}};customRangesInRange.forEach((range=>{const{startIndex,endIndex,rangeType,rangeId}=range,preHtml=handleCustomBlock(cursorIndex,startIndex);html+=preHtml.sliceHtml;const sliceHtml=handleCustomBlock(startIndex,endIndex+1);rangeType===src.Bvh.HYPERLINK?html+=`<a data-rangeid="${rangeId}" href="${range.properties?.url??""}">${sliceHtml.sliceHtml}</a>`:html+=sliceHtml.sliceHtml,cursorIndex=endIndex+1+(preHtml.customBlockLength+sliceHtml.customBlockLength)}));const endHtml=handleCustomBlock(cursorIndex,endIndex);return html+=endHtml.sliceHtml,html}(doc,startIndex,endIndex)}</p>`;break}case src.L3c.TABLE:{const{children}=node;result.html+='<table class="UniverTable" style="width: 100%; border-collapse: collapse;"><tbody>';for(const row of children)processNode(row,doc,result);result.html+="</tbody></table>";break}case src.L3c.TABLE_ROW:{const{children}=node;result.html+='<tr class="UniverTableRow">';for(const cell of children)processNode(cell,doc,result);result.html+="</tr>";break}case src.L3c.TABLE_CELL:{const{children}=node;result.html+='<td class="UniverTableCell">';for(const n of children)processNode(n,doc,result);result.html+="</td>";break}default:throw new Error(`Unknown node type: ${node.nodeType}`)}}class UDMToHtmlService{convert(docList){if(0===docList.length)throw new Error("The bodyList length at least to be 1");let html="";for(const doc of src.S0q.deepClone(docList))html+=convertBodyToHtml(doc);return html}}function clipboard_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function clipboard_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}function getTableSlice(body,start,end){const bodySlice=(0,src.DyH)(body,start,end+2),dataStream=src.gqw.TABLE_START+src.gqw.TABLE_ROW_START+src.gqw.TABLE_CELL_START+bodySlice.dataStream+src.gqw.TABLE_CELL_END+src.gqw.TABLE_ROW_END+src.gqw.TABLE_END;return bodySlice.dataStream=dataStream,bodySlice.textRuns?.forEach((textRun=>{const{st,ed}=textRun;textRun.st=st+3,textRun.ed=ed+3})),bodySlice.tables?.forEach((table=>{const{startIndex,endIndex}=table;table.startIndex=startIndex+3,table.endIndex=endIndex+3})),bodySlice.paragraphs?.forEach((paragraph=>{const{startIndex}=paragraph;paragraph.startIndex=startIndex+3})),bodySlice}HtmlToUDMService.use(plugin_word.A),HtmlToUDMService.use(plugin_lark.A),HtmlToUDMService.use(plugin_univer.A);const IDocClipboardService=(0,src.Qmd)("doc.clipboard-service");class DocClipboardService extends src.jGt{constructor(_univerInstanceService,_logService,_commandService,_clipboardInterfaceService,_docSelectionManagerService){super(),this._univerInstanceService=_univerInstanceService,this._logService=_logService,this._commandService=_commandService,this._clipboardInterfaceService=_clipboardInterfaceService,this._docSelectionManagerService=_docSelectionManagerService,this._clipboardHooks=[],this._htmlToUDM=new HtmlToUDMService,this._umdToHtml=new UDMToHtmlService}async copy(sliceType=src.X$V.copy){const{newSnapshotList=[],needCache=!1,snapshot}=this._getDocumentBodyInRanges(sliceType)??{};if(0===newSnapshotList.length||null==snapshot)return!1;try{const activeRange=this._docSelectionManagerService.getActiveTextRange(),isCopyInHeaderFooter=!!activeRange?.segmentId;this._setClipboardData(newSnapshotList,!isCopyInHeaderFooter&&needCache)}catch(e){return this._logService.error("[DocClipboardService] copy failed",e),!1}return!0}async cut(){return this._cut()}async paste(items){const partDocData=await this._genDocDataFromClipboardItems(items);return this._paste(partDocData)}async legacyPaste(options){let{html,text,files}=options;const currentDocInstance=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_DOC),docUnitId=currentDocInstance?.getUnitId()||"";html||text||!files.length||(html=await this._createImagePasteHtml(files));const partDocData=this._genDocDataFromHtmlAndText(html,text,docUnitId);if(docUnitId===src.Fmw){if(text){const textDocData=src.Z4q.transform.fromPlainText(text);return this._paste({body:textDocData})}partDocData.body.textRuns=[]}return this._paste(partDocData)}async _cut(){const{segmentId,endOffset:activeEndOffset,style}=this._docSelectionManagerService.getActiveTextRange()??{},textRanges=this._docSelectionManagerService.getTextRanges()??[],rectRanges=this._docSelectionManagerService.getRectRanges()??[];if(null==segmentId&&this._logService.error("[DocClipboardController] segmentId is not existed"),0===textRanges.length&&0===rectRanges.length)return!1;this.copy(src.X$V.cut);try{let cursor=0;if(rectRanges.length>0)cursor=(0,doc_delete_command.yl)(textRanges,rectRanges);else if(null!=activeEndOffset){cursor=activeEndOffset;for(const range of textRanges){const{startOffset,endOffset}=range;null!=startOffset&&null!=endOffset&&(endOffset<=activeEndOffset&&(cursor-=endOffset-startOffset))}}const newTextRanges=[{startOffset:cursor,endOffset:cursor,style}];return this._commandService.executeCommand(clipboard_inner_command.J2.id,{segmentId,textRanges:newTextRanges})}catch(_e){return this._logService.error("[DocClipboardController] cut content failed"),!1}}async _paste(docData){const{body:_body}=docData;if(null==_body)return!1;let body=(0,src.CsD)(_body);const unitId=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_DOC)?.getUnitId();if(!unitId)return!1;this._clipboardHooks.forEach((hook=>{hook.onBeforePaste&&(body=hook.onBeforePaste(body))})),body.customRanges=body.customRanges?.map(src.Z4q.customRange.copyCustomRange);const activeRange=this._docSelectionManagerService.getActiveTextRange(),{segmentId,endOffset:activeEndOffset,style}=activeRange||{},ranges=this._docSelectionManagerService.getTextRanges();if(null==segmentId&&this._logService.error("[DocClipboardController] segmentId does not exist!"),null==activeEndOffset||null==ranges)return!1;try{let cursor=activeEndOffset;for(const range of ranges){const{startOffset,endOffset}=range;null!=startOffset&&null!=endOffset&&(endOffset<=activeEndOffset&&(cursor+=body.dataStream.length-(endOffset-startOffset)))}const textRanges=[{startOffset:cursor,endOffset:cursor,style}];return this._commandService.executeCommand(clipboard_inner_command.J1.id,{doc:{...docData,body},segmentId,textRanges})}catch(_){return this._logService.error("[DocClipboardController]","clipboard is empty."),!1}}async _setClipboardData(documentList,needCache=!0){const copyId=function genId(){return src.S0q.generateRandomId(6)}(),text=(documentList.length>1?documentList.map((doc=>doc.body?.dataStream||"")).join("\n"):documentList[0].body?.dataStream||"").replaceAll(src.gqw.TABLE_START,"").replaceAll(src.gqw.TABLE_END,"").replaceAll(src.gqw.TABLE_ROW_START,"").replaceAll(src.gqw.TABLE_ROW_END,"").replaceAll(src.gqw.TABLE_CELL_START,"").replaceAll(src.gqw.TABLE_CELL_END,"").replaceAll("\r\n"," ");let html=this._umdToHtml.convert(documentList);if(1===documentList.length&&needCache){html=html.replace(/(<[a-z]+)/,((_p0,p1)=>`${p1} data-copy-id="${copyId}"`));const doc=documentList[0],cache={body:doc.body};if(doc.body?.customBlocks?.length){cache.drawings={};for(const block of doc.body.customBlocks){const{blockId}=block,drawing=doc.drawings?.[blockId];if(drawing){const id=src.S0q.generateRandomId(6);block.blockId=id,cache.drawings[id]={...src.S0q.deepClone(drawing),drawingId:id}}}}copyContentCache.set(copyId,cache)}return this._clipboardInterfaceService.write(text,html)}addClipboardHook(hook){return this._clipboardHooks.push(hook),(0,src.saO)((()=>{const index=this._clipboardHooks.indexOf(hook);index>-1&&this._clipboardHooks.splice(index,1)}))}_getDocumentBodyInRanges(sliceType){const docDataModel=this._univerInstanceService.getCurrentUniverDocInstance(),allRanges=this._docSelectionManagerService.getDocRanges(),results=[];let needCache=!0;if(null==docDataModel||0===allRanges.length)return;const segmentId=allRanges[0].segmentId,body=docDataModel?.getSelfOrHeaderFooterModel(segmentId)?.getBody(),snapshot=docDataModel.getSnapshot();if(null!=body){for(const range of allRanges){const{startOffset,endOffset,collapsed,rangeType}=range;if(collapsed||null==startOffset||null==endOffset)continue;if(rangeType===src.AlE.RECT){needCache=!1;const{spanEntireRow}=range;let bodySlice;bodySlice=getTableSlice(body,startOffset,endOffset),results.push(bodySlice);continue}const deleteRange={startOffset,endOffset,collapsed},docBody=docDataModel.getSelfOrHeaderFooterModel(segmentId).sliceBody(deleteRange.startOffset,deleteRange.endOffset,sliceType);null!=docBody&&results.push(docBody)}return{newSnapshotList:results.map((e=>({...snapshot,body:e}))),needCache,snapshot}}}async _genDocDataFromClipboardItems(items){try{let html="",text="";const files=[];for(const clipboardItem of items)for(const type of clipboardItem.types)switch(type){case ui_src.OE:text=await clipboardItem.getType(type).then((blob=>blob&&blob.text()));break;case ui_src.lZ:html=await clipboardItem.getType(type).then((blob=>blob&&blob.text()));break;case ui_src.x$:case ui_src.kR:case ui_src.C4:case ui_src.Kk:{const blob=await clipboardItem.getType(type),file=new File([blob],`pasted_image.${type.split("/")[1]}`,{type});files.push(file);break}}return html||text||!files.length||(html=await this._createImagePasteHtml(files)),this._genDocDataFromHtmlAndText(html,text)}catch(e){return Promise.reject(e)}}_genDocDataFromHtmlAndText(html,text,_unitId){if(!html){if(text){return{body:src.Z4q.transform.fromPlainText(text)}}throw new Error("[DocClipboardService] html and text cannot be both empty!")}const copyId=function extractId(html){const match=html.match(/data-copy-id="([^\s]+)"/);return match&&match[1]?match[1]:null}(html);if(copyId){const copyCache=copyContentCache.get(copyId);if(copyCache)return copyCache}if(!_unitId){const currentDocInstance=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_DOC);_unitId=currentDocInstance?.getUnitId()||""}const doc=this._htmlToUDM.convert(html,{unitId:_unitId});return copyId&&copyContentCache.set(copyId,doc),doc}async _createImagePasteHtml(files){const doc={id:"",documentStyle:{},body:{dataStream:"",customBlocks:[]},drawings:{}},onBeforePasteImage=this._clipboardHooks.find((e=>e.onBeforePasteImage))?.onBeforePasteImage??(async file=>{const reader=new FileReader;return new Promise((res=>{reader.onloadend=function(){res({source:reader.result,imageSourceType:src.fKo.BASE64})},reader.readAsDataURL(file)}))});await Promise.all(files.map((async(file,index)=>{const image=await onBeforePasteImage(file);if(!image)return Promise.resolve();const{width=100,height=100}=await(base64=>{const img=new Image;return new Promise((resolve=>{img.src="string"==typeof base64?base64:URL.createObjectURL(base64),img.onload=()=>{const width=Math.min(500,img.naturalWidth),scale=img.naturalHeight/img.naturalWidth;resolve({width,height:width*scale})}}))})(file),itemId=`paste_image_id_${index}`,body=doc.body,drawings=doc.drawings;body.dataStream+="\b",body.customBlocks?.push({startIndex:index,blockId:itemId}),drawings[itemId]={drawingId:itemId,unitId:"",subUnitId:"",imageSourceType:image.imageSourceType,title:"",source:image.source,description:"",layoutType:src.e9n.INLINE,drawingType:src.MJB.DRAWING_IMAGE,transform:{width,height,angle:0},docTransform:{angle:0,size:{width,height},positionH:{relativeFrom:src.sUw.CHARACTER,posOffset:0},positionV:{relativeFrom:src.egV.LINE,posOffset:0}}}})));return this._umdToHtml.convert([doc])}}DocClipboardService=function clipboard_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([clipboard_service_ts_param(0,src.HCr),clipboard_service_ts_param(1,src.rrK),clipboard_service_ts_param(2,src.wTY),clipboard_service_ts_param(3,ui_src.O),clipboard_service_ts_param(4,(0,src.y_5)(docs_src.pv)),clipboard_service_ts_metadata("design:type",Function),clipboard_service_ts_metadata("design:paramtypes",[void 0===src.HCr?Object:src.HCr,void 0===src.rrK?Object:src.rrK,void 0===src.wTY?Object:src.wTY,void 0===ui_src.O?Object:ui_src.O,void 0===docs_src.pv?Object:docs_src.pv])],DocClipboardService)},"../../packages/docs-ui/src/services/clipboard/html-to-udm/parse-node-style.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{B:()=>extractNodeStyle});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/engine-render/src/index.ts");function extractNodeStyle(node){const styles=node.style,docStyles={},tagName=node.tagName.toLowerCase();switch(tagName){case"b":case"em":case"strong":docStyles.bl=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE;break;case"s":docStyles.st={s:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE};break;case"u":docStyles.ul={s:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE};break;case"i":docStyles.it=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE;break;case"sub":case"sup":docStyles.va="sup"===tagName?_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.DRO.SUPERSCRIPT:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.DRO.SUBSCRIPT}for(let i=0;i<styles.length;i++){const cssRule=styles[i],cssValue=styles.getPropertyValue(cssRule);switch(cssRule){case"font-family":docStyles.ff=cssValue.replace(/^"/g,"").replace(/"$/g,"");break;case"font-size":{const fontSize=Number.parseInt(cssValue);Number.isNaN(fontSize)||(cssValue.endsWith("pt")?docStyles.fs=fontSize:cssValue.endsWith("px")&&(docStyles.fs=(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.GZn)(fontSize)));break}case"font-style":"italic"===cssValue&&(docStyles.it=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE);break;case"font-weight":{const MIDDLE_FONT_WEIGHT=400;(Number(cssValue)>MIDDLE_FONT_WEIGHT||"bold"===String(cssValue))&&(docStyles.bl=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE);break}case"text-decoration":/underline/.test(cssValue)?docStyles.ul={s:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE}:/overline/.test(cssValue)?docStyles.ol={s:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE}:/line-through/.test(cssValue)&&(docStyles.st={s:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE});break;case"color":try{const color=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.mKL(cssValue);color.isValid&&(docStyles.cl={rgb:color.toRgbString()})}catch(_e){}break;case"background-color":{const color=new _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.mKL(cssValue);color.isValid&&(docStyles.bg={rgb:color.toRgbString()});break}}}return docStyles}},"../../packages/docs-ui/src/services/clipboard/html-to-udm/paste-plugins/plugin-lark.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_parse_node_style__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs-ui/src/services/clipboard/html-to-udm/parse-node-style.ts");const __WEBPACK_DEFAULT_EXPORT__={name:"univer-doc-paste-plugin-lark",checkPasteType:html=>/lark-record-clipboard/i.test(html),stylesRules:[{filter:["s"],getStyle(node){const inlineStyle=(0,_parse_node_style__WEBPACK_IMPORTED_MODULE_1__.B)(node);return{st:{s:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE},...inlineStyle}}}],afterProcessRules:[{filter:el=>"DIV"===el.tagName&&/ace-line/i.test(el.className),handler(doc){const body=doc.body;null==body.paragraphs&&(body.paragraphs=[]),body.paragraphs.push({startIndex:body.dataStream.length}),body.dataStream+="\r"}}]}},"../../packages/docs-ui/src/services/clipboard/html-to-udm/paste-plugins/plugin-univer.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/docs-ui/src/services/clipboard/html-to-udm/utils.ts");const __WEBPACK_DEFAULT_EXPORT__={name:"univer-doc-paste-plugin-univer",checkPasteType:html=>/UniverNormal/i.test(html),stylesRules:[],afterProcessRules:[{filter:el=>"P"===el.tagName&&/UniverNormal/i.test(el.className),handler(doc,el){const body=doc.body;null==body.paragraphs&&(body.paragraphs=[]);const paragraph={startIndex:body.dataStream.length},paragraphStyle=(0,_utils__WEBPACK_IMPORTED_MODULE_0__.u)(el);paragraphStyle&&(paragraph.paragraphStyle=paragraphStyle),body.paragraphs.push(paragraph),body.dataStream+="\r"}}]}},"../../packages/docs-ui/src/services/clipboard/html-to-udm/paste-plugins/plugin-word.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_parse_node_style__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs-ui/src/services/clipboard/html-to-udm/parse-node-style.ts"),_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/docs-ui/src/services/clipboard/html-to-udm/utils.ts");const __WEBPACK_DEFAULT_EXPORT__={name:"univer-doc-paste-plugin-word",checkPasteType:html=>/word|mso/i.test(html),stylesRules:[{filter:["b"],getStyle(node){const inlineStyle=(0,_parse_node_style__WEBPACK_IMPORTED_MODULE_1__.B)(node);return{bl:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE,...inlineStyle}}}],afterProcessRules:[{filter:el=>"P"===el.tagName,handler(doc,el){const body=doc.body;null==body.paragraphs&&(body.paragraphs=[]);const paragraph={startIndex:body.dataStream.length},paragraphStyle=(0,_utils__WEBPACK_IMPORTED_MODULE_2__.u)(el);paragraphStyle&&(paragraph.paragraphStyle=paragraphStyle),body.paragraphs.push(paragraph),body.dataStream+="\r"}}]}},"../../packages/docs-ui/src/services/clipboard/html-to-udm/utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{u:()=>getParagraphStyle});var _univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/engine-render/src/index.ts");function getParagraphStyle(el){const styles=el.style,paragraphStyle={};for(let i=0;i<styles.length;i++){const cssRule=styles[i],cssValue=styles.getPropertyValue(cssRule);switch(cssRule){case"margin-top":{const marginTopValue=Number.parseInt(cssValue);paragraphStyle.spaceAbove={v:/pt/.test(cssValue)?(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__.sb9)(marginTopValue):marginTopValue};break}case"margin-bottom":{const marginBottomValue=Number.parseInt(cssValue);paragraphStyle.spaceBelow={v:/pt/.test(cssValue)?(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__.sb9)(marginBottomValue):marginBottomValue};break}case"line-height":{let lineHeightValue=Number.parseFloat(cssValue);cssValue.endsWith("%")&&(lineHeightValue/=100),paragraphStyle.lineSpacing=lineHeightValue;break}}}return Object.getOwnPropertyNames(paragraphStyle).length?paragraphStyle:null}},"../../packages/docs-ui/src/services/doc-menu-style.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{_:()=>DocMenuStyleService});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs/src/index.ts"),_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/engine-render/src/index.ts");function _ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function _ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}const DEFAULT_TEXT_STYLE={ff:"Arial",fs:11};class DocMenuStyleService extends _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.jGt{constructor(_textSelectionManagerService,_univerInstanceService,_renderManagerService){super(),this._textSelectionManagerService=_textSelectionManagerService,this._univerInstanceService=_univerInstanceService,this._renderManagerService=_renderManagerService,this._cacheStyle=null,this._init()}_init(){this._listenDocRangeChange()}_listenDocRangeChange(){this.disposeWithMe(this._textSelectionManagerService.textSelection$.subscribe((()=>{this._clearStyleCache()})))}getStyleCache(){return this._cacheStyle}getDefaultStyle(){const docDataModel=this._univerInstanceService.getCurrentUnitForType(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC);if(null==docDataModel)return{...DEFAULT_TEXT_STYLE};const unitId=docDataModel?.getUnitId(),docSkeletonManagerService=this._renderManagerService.getRenderById(unitId)?.with(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.EX),docViewModel=docSkeletonManagerService?.getViewModel();if(null==docViewModel)return{...DEFAULT_TEXT_STYLE};return docViewModel.getEditArea()===_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.ZCK.BODY?{...DEFAULT_TEXT_STYLE}:{...DEFAULT_TEXT_STYLE,fs:9}}setStyleCache(style){this._cacheStyle={...this._cacheStyle,...style}}_clearStyleCache(){this._cacheStyle=null}}DocMenuStyleService=function _ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([_ts_param(0,(0,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.y_5)(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv)),_ts_param(1,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),_ts_param(2,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.cSx),_ts_metadata("design:type",Function),_ts_metadata("design:paramtypes",[void 0===_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv?Object:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv,void 0===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr?Object:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr,void 0===_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.cSx?Object:_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.cSx])],DocMenuStyleService)},"../../packages/docs-ui/src/services/editor/editor-manager.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{I:()=>IEditorService,x:()=>EditorService});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs/src/index.ts"),_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/engine-render/src/index.ts"),rxjs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/Subject.js"),rxjs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/observable/fromEvent.js"),_editor__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/docs-ui/src/services/editor/editor.ts");function _ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function _ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}const editorFocusInElements=["univer-editor","univer-range-selector","univer-range-selector-editor","univer-render-canvas","univer-text-editor-container-placeholder"];class EditorService extends _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.jGt{constructor(_univerInstanceService,_renderManagerService,_docSelectionManagerService,_contextService,_commandService,_undoRedoService){super(),this._univerInstanceService=_univerInstanceService,this._renderManagerService=_renderManagerService,this._docSelectionManagerService=_docSelectionManagerService,this._contextService=_contextService,this._commandService=_commandService,this._undoRedoService=_undoRedoService,this._editors=new Map,this._blur$=new rxjs__WEBPACK_IMPORTED_MODULE_4__.B,this.blur$=this._blur$.asObservable(),this._focus$=new rxjs__WEBPACK_IMPORTED_MODULE_4__.B,this.focus$=this._focus$.asObservable(),this._initUniverFocusListener()}_initUniverFocusListener(){this.disposeWithMe((0,rxjs__WEBPACK_IMPORTED_MODULE_5__.R)(window,"focusin").subscribe((event=>{const target=event.target;this._blurSheetEditor(target)})))}_blurSheetEditor(target){if(editorFocusInElements.some((item=>target.classList.contains(item))))return;const focusEditor=this.getFocusEditor();focusEditor&&!0!==focusEditor.isSheetEditor()&&this.blur()}_setFocusId(id){this._focusEditorUnitId=id}getFocusId(){return this._focusEditorUnitId}getFocusEditor(){if(this._focusEditorUnitId)return this.getEditor(this._focusEditorUnitId)}isEditor(editorUnitId){return this._editors.has(editorUnitId)}isSheetEditor(editorUnitId){const editor=this._editors.get(editorUnitId);return!(!editor||!editor.isSheetEditor())}blur(force){const focusingEditor=this.getFocusEditor();force&&focusingEditor?.setSelectionRanges([]),focusingEditor?.blur(),this._contextService.setContextValue(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.AF$,!1),this._contextService.setContextValue(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.RFS,!1),this._setFocusId(null),this._blur$.next(null)}focus(editorUnitId){if(editorUnitId===this._focusEditorUnitId)return;if(this._focusEditorUnitId&&this.blur(),null==editorUnitId)return;const editor=this.getEditor(editorUnitId);if(null==editor)return;this._univerInstanceService.setCurrentUnitForType(editorUnitId);const valueCount=editor.getValue().length;this._contextService.setContextValue(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.AF$,!0),(0,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.W2S)(editorUnitId)||this._contextService.setContextValue(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.RFS,!0),editor.focus(),this._setFocusId(editorUnitId),this._focus$.next({startOffset:valueCount,endOffset:valueCount})}dispose(){this._editors.clear(),super.dispose()}getEditor(id=this._getCurrentEditorUnitId()){return this._editors.get(id)}getAllEditor(){return this._editors}register(config,container){const{initialSnapshot,canvasStyle={}}=config,editorUnitId=initialSnapshot.id;null==this._univerInstanceService.getUnit(editorUnitId,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC)&&this._univerInstanceService.createUnit(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC,initialSnapshot||this._getBlank(editorUnitId),{makeCurrent:!1});let render=this._renderManagerService.getRenderById(editorUnitId);if(null==render&&(this._renderManagerService.create(editorUnitId),render=this._renderManagerService.getRenderById(editorUnitId)),render){render.engine.setContainer(container);const editor=new _editor__WEBPACK_IMPORTED_MODULE_3__.K({...config,render,editorDom:container,canvasStyle},this._univerInstanceService,this._docSelectionManagerService,this._commandService,this._undoRedoService);this._editors.set(editorUnitId,editor),config.scrollBar||render.mainComponent?.getScene()?.getViewports()?.[0].getScrollBar()?.dispose()}return(0,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.saO)((()=>{this._unRegister(editorUnitId)}))}_unRegister(editorUnitId){const editor=this._editors.get(editorUnitId);null!=editor&&(this._renderManagerService.removeRender(editorUnitId),editor.dispose(),this._editors.delete(editorUnitId),this._univerInstanceService.disposeUnit(editorUnitId))}_getCurrentEditorUnitId(){return this._univerInstanceService.getCurrentUniverDocInstance().getUnitId()}_getBlank(id){return{id,body:{dataStream:`${_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Wd2}`,textRuns:[],paragraphs:[{startIndex:0}]},documentStyle:{renderConfig:{verticalAlign:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.G4t.TOP,horizontalAlign:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wqs.LEFT},marginLeft:3,marginTop:0,marginRight:3}}}}EditorService=function _ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([_ts_param(0,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),_ts_param(1,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.cSx),_ts_param(2,(0,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.y_5)(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv)),_ts_param(3,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.oaf),_ts_param(4,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY),_ts_param(5,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.$Dz),_ts_metadata("design:type",Function),_ts_metadata("design:paramtypes",[void 0===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr?Object:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr,void 0===_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.cSx?Object:_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.cSx,void 0===_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv?Object:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.pv,void 0===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.oaf?Object:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.oaf,void 0===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY?Object:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.wTY,void 0===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.$Dz?Object:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.$Dz])],EditorService);const IEditorService=(0,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Qmd)("univer.editor.service")},"../../packages/docs-ui/src/services/editor/editor.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{K:()=>Editor});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/ui/src/index.ts"),rxjs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/Subject.js"),rxjs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/observable/merge.js"),rxjs_operators__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/filter.js"),_commands_commands_replace_content_command__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/docs-ui/src/commands/commands/replace-content.command.ts"),_selection_doc_selection_render_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/docs-ui/src/services/selection/doc-selection-render.service.ts");class Editor extends _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.jGt{constructor(_param,_univerInstanceService,_docSelectionManagerService,_commandService,_undoRedoService){super(),this._param=_param,this._univerInstanceService=_univerInstanceService,this._docSelectionManagerService=_docSelectionManagerService,this._commandService=_commandService,this._undoRedoService=_undoRedoService,this._change$=new rxjs__WEBPACK_IMPORTED_MODULE_4__.B,this.change$=this._change$.asObservable(),this._input$=new rxjs__WEBPACK_IMPORTED_MODULE_4__.B,this.input$=this._input$.asObservable(),this._paste$=new rxjs__WEBPACK_IMPORTED_MODULE_4__.B,this.paste$=this._paste$.asObservable(),this._focus$=new rxjs__WEBPACK_IMPORTED_MODULE_4__.B,this.focus$=this._focus$.asObservable(),this._blur$=new rxjs__WEBPACK_IMPORTED_MODULE_4__.B,this.blur$=this._blur$.asObservable(),this._selectionChange$=new rxjs__WEBPACK_IMPORTED_MODULE_4__.B,this.selectionChange$=this._selectionChange$.asObservable(),this._listenSelection()}get docSelectionRenderService(){return this._param.render.with(_selection_doc_selection_render_service__WEBPACK_IMPORTED_MODULE_3__.q)}_listenSelection(){const docSelectionRenderService=this._param.render.with(_selection_doc_selection_render_service__WEBPACK_IMPORTED_MODULE_3__.q);this.disposeWithMe(docSelectionRenderService.onBlur$.subscribe((e=>{this._blur$.next(e);const data=this.getDocumentData();this._change$.next({target:this,data})}))),this.disposeWithMe(docSelectionRenderService.onFocus$.subscribe((e=>{this._focus$.next(e)}))),this.disposeWithMe(docSelectionRenderService.onPaste$.subscribe((e=>{this._paste$.next(e)}))),this.disposeWithMe((0,rxjs__WEBPACK_IMPORTED_MODULE_5__.h)(docSelectionRenderService.onInput$,docSelectionRenderService.onKeydown$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.p)((e=>{const event=e.event;return event.ctrlKey||event.metaKey?[_univerjs_ui__WEBPACK_IMPORTED_MODULE_1__.DD.X,_univerjs_ui__WEBPACK_IMPORTED_MODULE_1__.DD.V].includes(event.keyCode):[_univerjs_ui__WEBPACK_IMPORTED_MODULE_1__.DD.BACKSPACE].includes(event.keyCode)}))),docSelectionRenderService.onCompositionupdate$,docSelectionRenderService.onCompositionend$,docSelectionRenderService.onPaste$).subscribe((e=>{if(null==e)return;const{content=""}=e,data=this.getDocumentData();this._input$.next({target:this,content,data,isComposing:"compositionupdate"===e.event.type})}))),this.disposeWithMe(this._docSelectionManagerService.textSelection$.subscribe((e=>{if(null==e)return;const{unitId,subUnitId,...params}=e;unitId===this.getEditorId()&&this._selectionChange$.next(params)})))}isFocus(){const docSelectionRenderService=this._param.render.with(_selection_doc_selection_render_service__WEBPACK_IMPORTED_MODULE_3__.q);return docSelectionRenderService.isFocusing&&Boolean(docSelectionRenderService.getActiveTextRange())}focus(){const curDoc=this._univerInstanceService.getCurrentUnitForType(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC),editorUnitId=this.getEditorId();null!=curDoc&&curDoc.getUnitId()===editorUnitId||this._univerInstanceService.setCurrentUnitForType(editorUnitId);this._param.render.with(_selection_doc_selection_render_service__WEBPACK_IMPORTED_MODULE_3__.q).focus()}blur(){this._param.render.with(_selection_doc_selection_render_service__WEBPACK_IMPORTED_MODULE_3__.q).blur()}select(){const documentData=this.getDocumentData();return this.setSelectionRanges([{startOffset:0,endOffset:documentData.body?documentData.body.dataStream.length-2:0}])}setSelectionRanges(ranges,shouldFocus=!0){const editorUnitId=this.getEditorId(),params={unitId:editorUnitId,subUnitId:editorUnitId};return this._docSelectionManagerService.replaceDocRanges(ranges,params,!1,{shouldFocus})}getSelectionRanges(){const editorUnitId=this.getEditorId(),params={unitId:editorUnitId,subUnitId:editorUnitId};return this._docSelectionManagerService.getDocRanges(params)}getCursorPosition(){const selectionRanges=this.getSelectionRanges();return selectionRanges.find((range=>range.collapsed))?.startOffset??-1}getEditorId(){return this._getEditorId()}getDocumentData(){return this._getDocDataModel().getSnapshot()}getDocumentDataModel(){return this._getDocDataModel()}setDocumentData(data,textRanges){const{id}=data;this._commandService.syncExecuteCommand(_commands_commands_replace_content_command__WEBPACK_IMPORTED_MODULE_2__.e6.id,{unitId:id,snapshot:data,textRanges})}replaceText(text,resetCursor=!0){const data=this.getDocumentData();this.setDocumentData({...data,body:{dataStream:`${text}\r\n`,paragraphs:[{startIndex:0}],customRanges:[],sectionBreaks:[],tables:[],textRuns:[]}},"object"==typeof resetCursor?resetCursor:resetCursor?[{startOffset:text.length,endOffset:text.length,collapsed:!0}]:null)}clearUndoRedoHistory(){const editorUnitId=this.getEditorId();return this._undoRedoService.clearUndoRedo(editorUnitId)}dispose(){this._getDocDataModel().dispose()}get editorUnitId(){return this._param.editorUnitId}get params(){return this._param}get cancelDefaultResizeListener(){return this._param.cancelDefaultResizeListener}get render(){return this._param.render}isReadOnly(){return!0===this._param.readonly}getBoundingClientRect(){return this._param.editorDom.getBoundingClientRect()}get editorDOM(){return this._param.editorDom}isVisible(){return this._param.visible}isSheetEditor(){return(0,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.W2S)(this._getEditorId())}getValue(){const docDataModel=this._getDocDataModel();return(docDataModel.getBody()?.dataStream||"").replace(/\r\n/g,"").replace(/\n/g,"").replace(/\n/g,"")}getBody(){return this._getDocDataModel().getBody()}update(param){this._param={...this._param,...param}}updateCanvasStyle(){const docDataModel=this._getDocDataModel();if(null==docDataModel)return;const documentStyle={};this._param.canvasStyle?.fontSize&&(null==documentStyle.textStyle&&(documentStyle.textStyle={}),documentStyle.textStyle.fs=this._param.canvasStyle.fontSize),docDataModel.updateDocumentStyle(documentStyle)}_getDocDataModel(){const editorUnitId=this._getEditorId();return this._univerInstanceService.getUnit(editorUnitId,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC)}_getEditorId(){return this._param.initialSnapshot?.id||this._param.editorUnitId||""}}},"../../packages/docs-ui/src/services/selection/convert-rect-range.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{ID:()=>isInSameTableCell,Rj:()=>NodePositionConvertToRectRange,Yj:()=>isInSameTableCellData,e0:()=>compareNodePositionInTable,ug:()=>isValidRectRange});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/engine-render/src/index.ts"),_convert_text_range__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/docs-ui/src/services/selection/convert-text-range.ts");function isValidRectRange(anchorNodePosition,focusNodePosition){const{path:anchorPath}=anchorNodePosition,{path:focusPath}=focusNodePosition;if(anchorPath.length!==focusPath.length)return!1;if(-1===anchorPath.indexOf("cells"))return!1;const tableIdIndex=anchorPath.indexOf("skeTables")+1,rowIndex=anchorPath.indexOf("rows")+1,cellIndex=anchorPath.indexOf("cells")+1,{tableId:anchorTableId,sliceIndex:anchorSliceIndex}=(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.z2$)(anchorPath[tableIdIndex]),{tableId:focusTableId,sliceIndex:focusSliceIndex}=(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.z2$)(focusPath[tableIdIndex]);if(anchorTableId!==focusTableId)return!1;const anchorRowIndex=anchorPath[rowIndex],focusRowIndex=focusPath[rowIndex],anchorCellIndex=anchorPath[cellIndex],focusCellIndex=focusPath[cellIndex];return anchorRowIndex!==focusRowIndex||anchorCellIndex!==focusCellIndex||anchorSliceIndex!==focusSliceIndex}function isInSameTableCell(anchorNodePosition,focusNodePosition){const{path:anchorPath}=anchorNodePosition,{path:focusPath}=focusNodePosition;return-1!==anchorPath.indexOf("cells")&&-1!==focusPath.indexOf("cells")&&(anchorPath.length===focusPath.length&&_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.diffValue(anchorPath,focusPath))}function isInSameTableCellData(skeleton,anchorNodePosition,focusNodePosition){const{path:anchorPath}=anchorNodePosition,{path:focusPath}=focusNodePosition;if(-1===anchorPath.indexOf("cells")||-1===focusPath.indexOf("cells"))return!1;const anchorGlyph=skeleton.findGlyphByPosition(anchorNodePosition),focusGlyph=skeleton.findGlyphByPosition(focusNodePosition),anchorCellPage=anchorGlyph?.parent?.parent?.parent?.parent?.parent,focusCellPage=focusGlyph?.parent?.parent?.parent?.parent?.parent;if(null==anchorCellPage||null==focusCellPage)return!1;const anchorRow=anchorCellPage.parent,focusRow=focusCellPage.parent;return anchorRow.cells.indexOf(anchorCellPage)===focusRow.cells.indexOf(focusCellPage)&&anchorRow.index===focusRow.index}function compareNodePositionInTable(a,b){if(isInSameTableCell(a,b))return(0,_convert_text_range__WEBPACK_IMPORTED_MODULE_2__.bw)(a,b);const{path:aPath}=a,{path:bPath}=b,aTableId=aPath[aPath.length-5],bTableId=bPath[bPath.length-5];if(aTableId!==bTableId&&"string"==typeof aTableId&&"string"==typeof bTableId){return+aTableId.split("#-#")[1]<+bTableId.split("#-#")[1]}const aRowCount=aPath[aPath.length-3],bRowCount=bPath[bPath.length-3],aCellCount=aPath[aPath.length-1],bCellCount=bPath[bPath.length-1];return aRowCount<bRowCount||!(aRowCount>bRowCount)&&aCellCount<=bCellCount}function isEmptyCellPage(cell){return 0===cell.sections[0].columns[0].lines.length}function findNonEmptyCellPages(cells,startCol,endCol){let s=startCol,e=endCol,startCell=cells[s],endCell=cells[e];for(;s<e&&(isEmptyCellPage(startCell)||isEmptyCellPage(endCell));)isEmptyCellPage(startCell)?(s++,startCell=cells[s]):isEmptyCellPage(endCell)&&(e--,endCell=cells[e]);if(!isEmptyCellPage(startCell)&&!isEmptyCellPage(endCell))return[startCell,endCell]}class NodePositionConvertToRectRange{constructor(_documentOffsetConfig,_docSkeleton){this._documentOffsetConfig=_documentOffsetConfig,this._docSkeleton=_docSkeleton,this._liquid=new _univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.HXd}getRangePointData(startNodePosition,endNodePosition){const pointGroup=[],skeletonData=this._docSkeleton.getSkeletonData();if(null==skeletonData)return;const{pages}=skeletonData,{segmentPage:startSegmentPage,page:startPage,pageType}=startNodePosition,rectInfo=this._getTableRectRangeInfo(startNodePosition,endNodePosition);if(null==rectInfo)return;const{tableId,startRowIndex:startRow,startColumnIndex:startColumn,endRowIndex:endRow,endColumnIndex:endColumn}=rectInfo;this._liquid.reset();const{pageLayoutType,pageMarginLeft,pageMarginTop}=this._documentOffsetConfig,skipPageIndex=pageType===_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.eMu.BODY||pageType===_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.eMu.CELL?startPage:startSegmentPage;for(let p=0;p<skipPageIndex;p++){const page=pages[p];this._liquid.translatePage(page,pageLayoutType,pageMarginLeft,pageMarginTop)}for(let p=skipPageIndex;p<pages.length;p++){const page=pages[p];this._liquid.translatePagePadding(page);const{skeTables}=page;let table=null;for(const[id,tableSke]of skeTables.entries())id.startsWith(tableId)&&(table=tableSke);if(null==table){this._liquid.restorePagePadding(page),this._liquid.translatePage(page,pageLayoutType,pageMarginLeft,pageMarginTop);continue}this._liquid.translateSave(),this._liquid.translate(0,table.top);const{x,y}=this._liquid,{left:tableLeft}=table;for(const row of table.rows)if(row.index>=startRow&&row.index<=endRow){const cells=findNonEmptyCellPages(row.cells,startColumn,endColumn);if(null==cells)continue;const[rowStartCell,rowEndCell]=cells,position={startX:x+rowStartCell.left+tableLeft,startY:y+row.top,endX:x+rowEndCell.left+rowEndCell.pageWidth+tableLeft,endY:y+row.top+row.height};pointGroup.push((0,_convert_text_range__WEBPACK_IMPORTED_MODULE_2__.b8)(position))}this._liquid.translateRestore(),this._liquid.restorePagePadding(page),this._liquid.translatePage(page,pageLayoutType,pageMarginLeft,pageMarginTop)}return{pointGroup,startRow,startColumn,endRow,endColumn,tableId}}getNodePositionGroup(anchorNodePosition,focusNodePosition){const nodePositionGroup=[],anchorIndex=this._docSkeleton.findCharIndexByPosition(anchorNodePosition),focusIndex=this._docSkeleton.findCharIndexByPosition(focusNodePosition);if(null==anchorIndex||null==focusIndex)return;const compare=anchorIndex<focusIndex,rectInfo=this._getTableRectRangeInfo(anchorNodePosition,focusNodePosition);if(null==rectInfo)return;const{tableId,startRowIndex,startColumnIndex,endRowIndex,endColumnIndex}=rectInfo,tableNode=this._docSkeleton.getViewModel().findTableNodeById(tableId);if(null==tableNode)return;const totalColumns=tableNode.children[0].children.length;if(0===startColumnIndex&&endColumnIndex===totalColumns-1){const startCellNode=tableNode.children[startRowIndex].children[startColumnIndex],startNodePosition=this._docSkeleton.findNodePositionByCharIndex(startCellNode.startIndex+1),endCellNode=tableNode.children[endRowIndex].children[endColumnIndex],endNodePosition=this._docSkeleton.findNodePositionByCharIndex(endCellNode.endIndex-2);if(null==startNodePosition||null==endNodePosition)return;nodePositionGroup.push({anchor:compare?startNodePosition:endNodePosition,focus:compare?endNodePosition:startNodePosition})}else for(let i=startRowIndex;i<=endRowIndex;i++){const rowNode=tableNode.children[i],startCellNode=rowNode.children[startColumnIndex],endCellNode=rowNode.children[endColumnIndex],startNodePosition=this._docSkeleton.findNodePositionByCharIndex(startCellNode.startIndex+1),endNodePosition=this._docSkeleton.findNodePositionByCharIndex(endCellNode.endIndex-2);if(null==startNodePosition||null==endNodePosition)return;nodePositionGroup.push({anchor:compare?startNodePosition:endNodePosition,focus:compare?endNodePosition:startNodePosition})}return nodePositionGroup}_getTableRectRangeInfo(anchorPosition,focusPosition){const skeletonData=this._docSkeleton.getSkeletonData();if(null==skeletonData)return;const{pages}=skeletonData,{path:anchorPath}=anchorPosition,{path:focusPath}=focusPosition,anchorCell=(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.h7B)(skeletonData,anchorPath),focusCell=(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.h7B)(skeletonData,focusPath);if(null==anchorCell||null==focusCell)return;const tableId=anchorCell.segmentId,anchorRow=anchorCell.parent.index,anchorColumn=anchorCell.parent.cells.indexOf(anchorCell),focusRow=(focusCell?.parent).index,focusColumn=(focusCell?.parent).cells.indexOf(focusCell),startRowIndex=Math.min(anchorRow,focusRow),endRowIndex=Math.max(anchorRow,focusRow);return{pages,tableId,startRowIndex,startColumnIndex:Math.min(anchorColumn,focusColumn),endRowIndex,endColumnIndex:Math.max(anchorColumn,focusColumn)}}}},"../../packages/docs-ui/src/services/selection/convert-text-range.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{PD:()=>getOneTextSelectionRange,Wb:()=>NodePositionConvertToCursor,b8:()=>pushToPoints,bw:()=>compareNodePositionLogic,gL:()=>NodePositionMap,zW:()=>compareNodePosition});var _univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/engine-render/src/index.ts"),NodePositionType=function(NodePositionType){return NodePositionType[NodePositionType.page=0]="page",NodePositionType[NodePositionType.section=1]="section",NodePositionType[NodePositionType.column=2]="column",NodePositionType[NodePositionType.line=3]="line",NodePositionType[NodePositionType.divide=4]="divide",NodePositionType[NodePositionType.glyph=5]="glyph",NodePositionType}({});const NodePositionMap={page:0,section:1,column:2,line:3,divide:4,glyph:5};function compareNodePositionLogic(pos1,pos2){return!(pos1.page>pos2.page)&&(pos1.page<pos2.page||!(pos1.section>pos2.section)&&(pos1.section<pos2.section||!(pos1.column>pos2.column)&&(pos1.column<pos2.column||!(pos1.line>pos2.line)&&(pos1.line<pos2.line||!(pos1.divide>pos2.divide)&&(pos1.divide<pos2.divide||!(pos1.glyph>pos2.glyph)&&(pos1.glyph,pos2.glyph,!0))))))}function compareNodePosition(pos1,pos2){return compareNodePositionLogic(pos1,pos2)?{start:pos1,end:pos2}:{start:pos2,end:pos1}}function getOneTextSelectionRange(rangeList){const rangeCount=rangeList.length;if(0===rangeCount)return;const firstCursor=rangeList[0],lastCursor=rangeList[rangeCount-1],collapsed=1===rangeList.length&&firstCursor.collapsed;return{startOffset:firstCursor.startOffset,endOffset:lastCursor.endOffset,collapsed}}function pushToPoints(position){const{startX,startY,endX,endY}=position,points=[];return points.push({x:startX,y:startY}),points.push({x:endX,y:startY}),points.push({x:endX,y:endY}),points.push({x:startX,y:endY}),points.push({x:startX,y:startY}),points}class NodePositionConvertToCursor{constructor(_documentOffsetConfig,_docSkeleton){this._documentOffsetConfig=_documentOffsetConfig,this._docSkeleton=_docSkeleton,this._liquid=new _univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__.HXd,this._currentStartState={page:0,section:0,column:0,line:0,divide:0,glyph:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,glyph:0}}getRangePointData(startOrigin,endOrigin){const borderBoxPointGroup=[],contentBoxPointGroup=[],cursorList=[];if(null==startOrigin||null==endOrigin)return{borderBoxPointGroup,contentBoxPointGroup,cursorList};if(!this._isValidPosition(startOrigin,endOrigin))throw new Error("\n                Invalid positions in NodePositionConvertToCursor,\n                they are not in the same segment page when in header or footer.");const{start,end}=compareNodePosition(startOrigin,endOrigin);return this._selectionIterator(start,end,((start_sp,end_sp,isFirst,isLast,divide,line)=>{const{lineHeight,asc,paddingTop,marginTop,marginBottom}=line,{glyphGroup,st}=divide;if(0===glyphGroup.length)return;const{x:startX,y:startY}=this._liquid;let borderBoxPosition,contentBoxPosition;const firstGlyph=glyphGroup[start_sp],lastGlyph=glyphGroup[end_sp],preGlyph=glyphGroup[start_sp-1],firstGlyphLeft=firstGlyph?.left||0,firstGlyphWidth=firstGlyph?.width||0,lastGlyphLeft=lastGlyph?.left||0,lastGlyphWidth=lastGlyph?.width||0,isCurrentList=firstGlyph?.glyphType===_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__.tEP.LIST,{startOffset,endOffset}=function getOffsetInDivide(glyphGroup,startGlyphIndex,endGlyphIndex,st){let startOffset=st,endOffset=st;for(let i=0;i<glyphGroup.length;i++){const contentLength=glyphGroup[i].count;i<startGlyphIndex&&(startOffset+=contentLength),i<endGlyphIndex&&(endOffset+=contentLength)}return{startOffset,endOffset}}(glyphGroup,start_sp,end_sp,st),isStartBack=start.glyph!==start_sp||!isFirst||start.isBack,isEndBack=!(end.glyph!==end_sp||!isLast)&&end.isBack,collapsed=start===end,anchorGlyph=isStartBack?preGlyph??firstGlyph:firstGlyph;if(0===start_sp&&end_sp===glyphGroup.length-1)borderBoxPosition={startX:startX+firstGlyphLeft+(isCurrentList?firstGlyphWidth:0),startY,endX:startX+lastGlyphLeft+(isEndBack?0:lastGlyphWidth),endY:startY+lineHeight-marginTop-marginBottom},contentBoxPosition={startX:startX+firstGlyphLeft+(isCurrentList?firstGlyphWidth:0),startY:startY+paddingTop+asc-anchorGlyph.bBox.ba,endX:startX+lastGlyphLeft+(isEndBack?0:lastGlyphWidth),endY:startY+paddingTop+asc+anchorGlyph.bBox.bd};else{const isStartBackFin=isStartBack&&!isCurrentList;borderBoxPosition={startX:startX+firstGlyphLeft+(isStartBackFin?0:firstGlyphWidth),startY,endX:startX+lastGlyphLeft+(isEndBack?0:lastGlyphWidth),endY:startY+lineHeight-marginTop-marginBottom},contentBoxPosition={startX:startX+firstGlyphLeft+(isStartBackFin?0:firstGlyphWidth),startY:startY+paddingTop+asc-anchorGlyph.bBox.ba,endX:startX+lastGlyphLeft+(isEndBack?0:lastGlyphWidth),endY:startY+paddingTop+asc+anchorGlyph.bBox.bd}}borderBoxPointGroup.push(pushToPoints(borderBoxPosition)),contentBoxPointGroup.push(pushToPoints(contentBoxPosition)),cursorList.push({startOffset:isStartBack?startOffset:startOffset+firstGlyph.count,endOffset:isEndBack?endOffset:endOffset+lastGlyph.count,collapsed})})),{borderBoxPointGroup,contentBoxPointGroup,cursorList}}_isValidPosition(startOrigin,endOrigin){const{segmentPage:startPage,pageType:startPageType}=startOrigin,{segmentPage:endPage,pageType:endPageType}=endOrigin;return startPageType===endPageType&&(startPageType!==_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__.eMu.HEADER&&startPageType!==_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__.eMu.FOOTER||startPage===endPage)}_resetCurrentNodePositionState(){this._currentStartState={page:0,section:0,column:0,line:0,divide:0,glyph:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,glyph:0}}_setNodePositionState(type=0,start,end,current){this._currentStartState[type]=current===start?1:0,this._currentEndState[type]=current===end?2:0}_checkPreviousNodePositionState(typeIndex,isStart=!0){let resultState,index=typeIndex;for(;index>=0;){const type=NodePositionType[index];let state;if(state=isStart?this._currentStartState[type]:this._currentEndState[type],void 0===state)return;if(void 0===resultState&&(resultState=state),state!==resultState)return 0;index--}return resultState}_getSelectionRuler(typeIndex,startPosition,endPosition,nextLength,current){let start_next=0,end_next=nextLength;const type=NodePositionType[typeIndex],nextType=NodePositionType[typeIndex+1];if(null===nextType||null===type)return{start_next,end_next};const start=startPosition[type],end=endPosition[type];this._setNodePositionState(type,start,end,current);const preStartNestType=this._checkPreviousNodePositionState(typeIndex),preEndNestType=this._checkPreviousNodePositionState(typeIndex,!1);return 1===preStartNestType&&(start_next=startPosition[nextType]),2===preEndNestType&&(end_next=endPosition[nextType]),{start_next,end_next}}_selectionIterator(startPosition,endPosition,func){const skeleton=this._docSkeleton;if(!skeleton)return[];const{pageType,path}=startPosition;this._liquid.reset();const skeletonData=skeleton.getSkeletonData();if(null==skeletonData)return[];const{pages,skeHeaders,skeFooters}=skeletonData,{page:pageIndex,segmentPage}=startPosition,{page:endPageIndex,segmentPage:endSegmentPage}=endPosition;if(this._resetCurrentNodePositionState(),null==this._documentOffsetConfig)return[];const{pageLayoutType,pageMarginLeft,pageMarginTop}=this._documentOffsetConfig,skipPageIndex=pageType===_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__.eMu.BODY||pageType===_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__.eMu.CELL?pageIndex:segmentPage;for(let p=0;p<skipPageIndex;p++){const page=pages[p];this._liquid.translatePage(page,pageLayoutType,pageMarginLeft,pageMarginTop)}const endIndex=pageType===_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__.eMu.BODY||pageType===_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__.eMu.CELL?endPageIndex:endSegmentPage;for(let p=skipPageIndex;p<=endIndex;p++){const page=pages[p],{headerId,footerId,pageWidth}=page;let segmentPage=page;if(pageType===_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__.eMu.HEADER?segmentPage=skeHeaders.get(headerId)?.get(pageWidth):pageType===_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__.eMu.FOOTER?segmentPage=skeFooters.get(footerId)?.get(pageWidth):pageType===_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__.eMu.CELL&&(segmentPage=(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__.h7B)(skeletonData,path)),null==segmentPage){this._liquid.translatePage(page,pageLayoutType,pageMarginLeft,pageMarginTop);continue}const sections=segmentPage.sections,{start_next:start_s,end_next:end_s}=this._getSelectionRuler(NodePositionMap.page,startPosition,endPosition,sections.length-1,pageType===_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__.eMu.BODY||pageType===_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__.eMu.CELL?p:0);switch(this._liquid.translateSave(),pageType){case _univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__.eMu.HEADER:this._liquid.translatePagePadding({...segmentPage,marginLeft:page.marginLeft});break;case _univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__.eMu.FOOTER:{const footerTop=page.pageHeight-segmentPage.height-segmentPage.marginBottom;this._liquid.translate(page.marginLeft,footerTop);break}case _univerjs_engine_render__WEBPACK_IMPORTED_MODULE_0__.eMu.CELL:{this._liquid.translatePagePadding(page);const rowSke=segmentPage.parent,tableSke=rowSke.parent,{left:cellLeft}=segmentPage,{top:tableTop,left:tableLeft}=tableSke,{top:rowTop}=rowSke;this._liquid.translate(tableLeft+cellLeft,tableTop+rowTop),this._liquid.translatePagePadding(segmentPage);break}default:this._liquid.translatePagePadding(page)}for(let s=start_s;s<=end_s;s++){const section=sections[s],columns=section.columns,{start_next:start_c,end_next:end_c}=this._getSelectionRuler(NodePositionMap.section,startPosition,endPosition,columns.length-1,s);this._liquid.translateSection(section);for(let c=start_c;c<=end_c;c++){const column=columns[c],lines=column.lines,{start_next:start_l,end_next:end_l}=this._getSelectionRuler(NodePositionMap.column,startPosition,endPosition,lines.length-1,c);this._liquid.translateColumn(column);for(let l=start_l;l<=end_l;l++){const line=lines[l],{divides}=line,{start_next:start_d,end_next:end_d}=this._getSelectionRuler(NodePositionMap.line,startPosition,endPosition,divides.length-1,l);this._liquid.translateSave(),this._liquid.translateLine(line,!0,!1);for(let d=start_d;d<=end_d;d++){const divide=divides[d];this._liquid.translateSave(),this._liquid.translateDivide(divide);const{glyphGroup}=divide,{start_next:start_sp,end_next:end_sp}=this._getSelectionRuler(NodePositionMap.divide,startPosition,endPosition,glyphGroup.length-1,d);let isFirst=!1,isLast=!1;p===skipPageIndex&&s===start_s&&c===start_c&&l===start_l&&d===start_d&&(isFirst=!0),p===endIndex&&s===end_s&&c===end_c&&l===end_l&&d===end_d&&(isLast=!0),func&&func(start_sp,end_sp,isFirst,isLast,divide,line,column,section,segmentPage),this._liquid.translateRestore()}this._liquid.translateRestore()}}}this._liquid.translateRestore(),this._liquid.translatePage(page,pageLayoutType,pageMarginLeft,pageMarginTop)}}}},"../../packages/docs-ui/src/services/selection/doc-selection-render.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{q:()=>DocSelectionRenderService});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/docs/src/index.ts"),_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/engine-render/src/index.ts"),_univerjs_ui__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/ui/src/index.ts"),rxjs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/Subject.js"),rxjs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/BehaviorSubject.js"),rxjs__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/observable/merge.js"),rxjs__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/filter.js"),rxjs__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/takeUntil.js"),rxjs__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/observable/fromEvent.js"),_selection_utils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../packages/docs-ui/src/services/selection/selection-utils.ts"),_text_range__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../packages/docs-ui/src/services/selection/text-range.ts");function _ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function _ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class DocSelectionRenderService extends _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.hy_{get isOnPointerEvent(){return this._onPointerEvent}get isFocusing(){return this._input===document.activeElement}get canFocusing(){return this.isFocusing||document.activeElement===document.body||null===document.activeElement}constructor(_context,_layoutService,_logService,_univerInstanceService,_docSkeletonManagerService){super(),this._context=_context,this._layoutService=_layoutService,this._logService=_logService,this._univerInstanceService=_univerInstanceService,this._docSkeletonManagerService=_docSkeletonManagerService,this._onInputBefore$=new rxjs__WEBPACK_IMPORTED_MODULE_6__.B,this.onInputBefore$=this._onInputBefore$.asObservable(),this._onKeydown$=new rxjs__WEBPACK_IMPORTED_MODULE_6__.B,this.onKeydown$=this._onKeydown$.asObservable(),this._onInput$=new rxjs__WEBPACK_IMPORTED_MODULE_6__.B,this.onInput$=this._onInput$.asObservable(),this._onCompositionstart$=new rxjs__WEBPACK_IMPORTED_MODULE_7__.t(null),this.onCompositionstart$=this._onCompositionstart$.asObservable(),this._onCompositionupdate$=new rxjs__WEBPACK_IMPORTED_MODULE_7__.t(null),this.onCompositionupdate$=this._onCompositionupdate$.asObservable(),this._onCompositionend$=new rxjs__WEBPACK_IMPORTED_MODULE_7__.t(null),this.onCompositionend$=this._onCompositionend$.asObservable(),this._onSelectionStart$=new rxjs__WEBPACK_IMPORTED_MODULE_7__.t(null),this.onSelectionStart$=this._onSelectionStart$.asObservable(),this.onChangeByEvent$=(0,rxjs__WEBPACK_IMPORTED_MODULE_8__.h)(this._onInput$,this._onKeydown$.pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_9__.p)((e=>e.event.keyCode===_univerjs_ui__WEBPACK_IMPORTED_MODULE_3__.DD.BACKSPACE))),this._onCompositionend$),this._onPaste$=new rxjs__WEBPACK_IMPORTED_MODULE_6__.B,this.onPaste$=this._onPaste$.asObservable(),this._textSelectionInner$=new rxjs__WEBPACK_IMPORTED_MODULE_7__.t(null),this.textSelectionInner$=this._textSelectionInner$.asObservable(),this._onFocus$=new rxjs__WEBPACK_IMPORTED_MODULE_6__.B,this.onFocus$=this._onFocus$.asObservable(),this._onBlur$=new rxjs__WEBPACK_IMPORTED_MODULE_6__.B,this.onBlur$=this._onBlur$.asObservable(),this._onPointerDown$=new rxjs__WEBPACK_IMPORTED_MODULE_6__.B,this.onPointerDown$=this._onPointerDown$.asObservable(),this._scrollTimers=[],this._rangeList=[],this._rangeListCache=[],this._rectRangeList=[],this._rectRangeListCache=[],this._anchorNodePosition=null,this._focusNodePosition=null,this._currentSegmentId="",this._currentSegmentPage=-1,this._selectionStyle=_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.fCf,this._onPointerEvent=!1,this._viewPortObserverMap=new Map,this._isIMEInputApply=!1,this._scenePointerMoveSubs=[],this._scenePointerUpSubs=[],this._reserveRanges=!1,this._initDOM(),this._registerContainer(),this._setSystemHighlightColorToStyle(),this._listenCurrentUnitChange()}_listenCurrentUnitChange(){this._univerInstanceService.getCurrentTypeOfUnit$(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Zy$.UNIVER_DOC).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_10__.Q)(this.dispose$)).subscribe((documentModel=>{if(null==documentModel)return;documentModel.getUnitId()===this._context.unitId||this._reserveRanges||this.removeAllRanges()}))}get activeViewPort(){return this._context.scene.getViewports()[0]}setSegment(id){this._currentSegmentId=id}getSegment(){return this._currentSegmentId}setSegmentPage(pageIndex){this._currentSegmentPage=pageIndex}getSegmentPage(){return this._currentSegmentPage}setReserveRangesStatus(status){this._reserveRanges=status}_setRangeStyle(style=_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.fCf){this._selectionStyle=style}addDocRanges(ranges,isEditing=!0,options){const{_currentSegmentId:segmentId,_currentSegmentPage:segmentPage,_selectionStyle:style}=this,{scene,mainComponent}=this._context,document1=mainComponent,docSkeleton=this._docSkeletonManagerService.getSkeleton(),generalAddRange=(startOffset,endOffset)=>{const rangeList=(0,_selection_utils__WEBPACK_IMPORTED_MODULE_4__.WA)(startOffset,endOffset,scene,document1,docSkeleton,style,segmentId,segmentPage);if(null==rangeList)return;const{textRanges,rectRanges}=rangeList;for(const textRange of textRanges)this._addTextRange(textRange);this._addRectRanges(rectRanges)};for(const range of ranges){const{startOffset,endOffset,rangeType,startNodePosition,endNodePosition}=range;if(rangeType===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.AlE.RECT){const rectRange=(0,_selection_utils__WEBPACK_IMPORTED_MODULE_4__.qv)(startOffset,endOffset,scene,document1,docSkeleton,style,segmentId,segmentPage);rectRange&&this._addRectRanges([rectRange])}else if(rangeType===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.AlE.TEXT)try{let textRange=null;textRange=startNodePosition&&endNodePosition?(0,_selection_utils__WEBPACK_IMPORTED_MODULE_4__.Zj)(startNodePosition.isBack?startOffset:startOffset-1,endNodePosition.isBack?endOffset:endOffset-1,scene,document1,docSkeleton,style,segmentId,segmentPage,startNodePosition.isBack,endNodePosition.isBack):(0,_selection_utils__WEBPACK_IMPORTED_MODULE_4__.Zj)(startOffset,endOffset,scene,document1,docSkeleton,style,segmentId,segmentPage),textRange&&this._addTextRange(textRange)}catch(_e){generalAddRange(startOffset,endOffset)}else generalAddRange(startOffset,endOffset)}this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId,segmentPage,style,isEditing,options}),ranges.length&&!1!==options?.shouldFocus&&this._updateInputPosition(options?.forceFocus)}setCursorManually(evtOffsetX,evtOffsetY){const startNode=this._findNodeByCoord(evtOffsetX,evtOffsetY,{strict:!0,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),position=this._getNodePosition(startNode);null!=position?(startNode?.node.streamType===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.PARAGRAPH&&(position.isBack=!0),this._createTextRangeByAnchorPosition(position),this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage,style:this._selectionStyle,isEditing:!1})):this._removeAllRanges()}sync(){this._updateInputPosition()}activate(x,y,force=!1){this._container.style.left=`${x}px`,this._container.style.top=`${y}px`,this._container.style.zIndex="1000",(this.canFocusing||force)&&this.focus()}hasFocus(){return document.activeElement===this._input}focus(){this._input.focus()}blur(){this._input.blur()}deactivate(){this._container.style.left="0px",this._container.style.top="0px"}__handleDblClick(evt){const{offsetX:evtOffsetX,offsetY:evtOffsetY}=evt,startNode=this._findNodeByCoord(evtOffsetX,evtOffsetY,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage});if(null==startNode||null==startNode.node)return;const paragraphInfo=(0,_selection_utils__WEBPACK_IMPORTED_MODULE_4__.cb)(startNode.node);if(null==paragraphInfo)return;const{content,st,nodeIndex}=paragraphInfo;if(-1===nodeIndex)return;if(null==Intl.Segmenter)return;const segments=new Intl.Segmenter(void 0,{granularity:"word"}).segment(content);let startOffset=Number.NEGATIVE_INFINITY,endOffset=Number.NEGATIVE_INFINITY;for(const{segment,index,isWordLike}of segments)if(index<=nodeIndex&&nodeIndex<index+segment.length&&isWordLike){startOffset=index+st,endOffset=index+st+segment.length;break}if(Number.isFinite(startOffset)&&Number.isFinite(endOffset)){this.removeAllRanges();const textRanges=[{startOffset,endOffset}];this.addDocRanges(textRanges,!1,{forceFocus:!0})}}__handleTripleClick(evt){const{offsetX:evtOffsetX,offsetY:evtOffsetY}=evt,startNode=this._findNodeByCoord(evtOffsetX,evtOffsetY,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage});if(null==startNode||null==startNode.node)return;const paragraphInfo=(0,_selection_utils__WEBPACK_IMPORTED_MODULE_4__.cb)(startNode.node);if(null==paragraphInfo)return;this.removeAllRanges();const{st,ed}=paragraphInfo,textRanges=[{startOffset:st,endOffset:ed}];this.addDocRanges(textRanges,!1,{forceFocus:!0})}__onPointDown(evt){const{scene,mainComponent}=this._context,skeleton=this._docSkeletonManagerService.getSkeleton(),{offsetX:evtOffsetX,offsetY:evtOffsetY}=evt,startNode=this._findNodeByCoord(evtOffsetX,evtOffsetY,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),position=this._getNodePosition(startNode);if(null==position||null==startNode)return void this._removeAllRanges();startNode?.node.streamType===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.PARAGRAPH&&(position.isBack=!0);const docSelection=this._textSelectionInner$.value;if(startNode&&2===evt.button&&docSelection){const nodeCharIndex=skeleton.findCharIndexByPosition(position);if("number"==typeof nodeCharIndex&&docSelection.textRanges.some((textRange=>textRange.startOffset<=nodeCharIndex&&textRange.endOffset>nodeCharIndex)))return;if("number"==typeof nodeCharIndex&&docSelection.rectRanges.some((rectRange=>rectRange.startOffset<=nodeCharIndex&&rectRange.endOffset>=nodeCharIndex)))return}const{segmentId,segmentPage}=startNode;segmentId&&this._currentSegmentId&&segmentId!==this._currentSegmentId&&this.setSegment(segmentId),segmentId&&segmentPage!==this._currentSegmentPage&&this.setSegmentPage(segmentPage),this._anchorNodePosition=position,evt.shiftKey&&this._getActiveRangeInstance()?this._updateActiveRangePosition(position):evt.ctrlKey?this._removeAllCollapsedTextRanges():this._isEmpty()||this._removeAllRanges(),scene.disableObjectsEvent();const scrollTimer=_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.Vui.create(scene);this._scrollTimers.push(scrollTimer),scrollTimer.startScroll(evtOffsetX,evtOffsetY),this._onSelectionStart$.next(this._getActiveRangeInstance()?.startNodePosition),scene.getTransformer()?.clearSelectedObjects();let preMoveOffsetX=evtOffsetX,preMoveOffsetY=evtOffsetY;this._onPointerEvent=!0,this._scenePointerMoveSubs.push(scene.onPointerMove$.subscribeEvent((moveEvt=>{const{offsetX:moveOffsetX,offsetY:moveOffsetY}=moveEvt;scene.setCursor(_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.MBo.TEXT),Math.sqrt((moveOffsetX-preMoveOffsetX)**2+(moveOffsetY-preMoveOffsetY)**2)<3||(this._moving(moveOffsetX,moveOffsetY),scrollTimer.scrolling(moveOffsetX,moveOffsetY,(()=>{this._moving(moveOffsetX,moveOffsetY)})),preMoveOffsetX=moveOffsetX,preMoveOffsetY=moveOffsetY)}))),this._scenePointerUpSubs.push(scene.onPointerUp$.subscribeEvent((()=>{if([...this._scenePointerMoveSubs,...this._scenePointerUpSubs].forEach((e=>{e.unsubscribe()})),this._onPointerEvent=!1,scene.enableObjectsEvent(),this._anchorNodePosition&&!this._focusNodePosition){if(evt.ctrlKey)return void this._disposeScrollTimers();const textRange=new _text_range__WEBPACK_IMPORTED_MODULE_5__.vY(scene,mainComponent,skeleton,this._anchorNodePosition,void 0,this._selectionStyle,this._currentSegmentId,this._currentSegmentPage);this._addTextRange(textRange)}else if(this._anchorNodePosition&&this._focusNodePosition){for(const textRange of this._rangeListCache)evt.ctrlKey&&textRange.collapsed?textRange.dispose():this._addTextRange(textRange);this._addRectRanges(this._rectRangeListCache),this._rangeListCache=[],this._rectRangeListCache=[]}this._anchorNodePosition=null,this._focusNodePosition=null;const selectionInfo={textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage,style:this._selectionStyle,isEditing:!1};this._textSelectionInner$.next(selectionInfo),this._disposeScrollTimers(),this._updateInputPosition(!0)})))}removeAllRanges(){this._removeAllRanges(),this.deactivate()}getActiveTextRange(){return this._getActiveRangeInstance()}_disposeScrollTimers(){this._scrollTimers.forEach((timer=>{timer?.dispose()})),this._scrollTimers=[]}_setSystemHighlightColorToStyle(){const{r,g,b,a}=(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.B6l)(),style={strokeWidth:1.5,stroke:"rgba(0, 0, 0, 0)",strokeActive:"rgba(0, 0, 0, 1)",fill:`rgba(${r}, ${g}, ${b}, ${a??.3})`};this._setRangeStyle(style)}_getAllTextRanges(){return this._rangeList.map(_selection_utils__WEBPACK_IMPORTED_MODULE_4__.x5)}_getAllRectRanges(){return this._rectRangeList.map(_selection_utils__WEBPACK_IMPORTED_MODULE_4__.sP)}getAllTextRanges(){return this._getAllTextRanges()}getAllRectRanges(){return this._getAllRectRanges()}_getActiveRange(){const activeRange=this._rangeList.find((range=>range.isActive()));if(null==activeRange)return null;const{startOffset,endOffset}=activeRange;return null==startOffset||null==endOffset?null:(0,_selection_utils__WEBPACK_IMPORTED_MODULE_4__.x5)(activeRange)}_getActiveRangeInstance(){return this._rangeList.find((range=>range.isActive()))}dispose(){super.dispose(),this._detachEvent(),this._removeAllRanges(),this._container.remove()}_initDOM(){const{unitId}=this._context,container=document.createElement("div");container.style.position="fixed",container.style.left="0px",container.style.top="0px",container.id=`univer-doc-selection-container-${unitId}`;const inputParent=document.createElement("div"),inputDom=document.createElement("div");inputParent.appendChild(inputDom),container.appendChild(inputParent),this._container=container,this._inputParent=inputParent,this._input=inputDom,this._initInput(),this._initInputEvents(),document.body.appendChild(container)}_registerContainer(){this.disposeWithMe(this._layoutService.registerContainerElement(this._container))}_initInput(){this._inputParent.style.cssText="\n            position:absolute;\n            height:1px;\n            width:1px;\n            overflow: hidden;\n        ",this._input.contentEditable="true",this._input.classList.add("univer-editor"),this._input.id=`__editor_${this._context.unitId}`,this._input.style.cssText="\n            position: absolute;\n            overflow: hidden;\n            opacity: 1;\n            background: #000;\n            color: transparent;\n            outline: none;\n            z-index: -2;\n            caret-color: transparent;\n            white-space: pre-wrap;\n            user-select: text;\n        "}_getNodePosition(node){if(null==node)return;const{node:glyph,ratioX,segmentPage}=node,position=this._docSkeletonManagerService.getSkeleton().findPositionByGlyph(glyph,segmentPage);if(null==position)return;let isBack=ratioX<.5;return glyph.glyphType===_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.tEP.LIST&&(isBack=!0),{...position,isBack}}_interactTextRanges(textRanges){const newTextRanges=[];for(const range of this._rangeList)textRanges.some((textRange=>textRange.isIntersection(range)))?range.dispose():newTextRanges.push(range);this._rangeList=newTextRanges}_interactRectRanges(rectRanges){const newRanges=[];for(const range of this._rectRangeList)rectRanges.some((rectRange=>rectRange.isIntersection(range)))?range.dispose():newRanges.push(range);this._rectRangeList=newRanges}_removeAllRanges(){this._removeAllTextRanges(),this._removeAllRectRanges()}_removeAllCacheRanges(){this._rangeListCache.forEach((range=>{range.dispose()})),this._rectRangeListCache.forEach((range=>{range.dispose()})),this._rangeListCache=[],this._rectRangeListCache=[]}_removeAllTextRanges(){this._rangeList.forEach((range=>{range.dispose()})),this._rangeList=[]}_removeAllRectRanges(){this._rectRangeList.forEach((range=>{range.dispose()})),this._rectRangeList=[]}_removeAllCollapsedTextRanges(){for(const range of this._rangeList)range.collapsed&&range.dispose()}_deactivateAllTextRanges(){this._rangeList.forEach((range=>{range.deactivate()}))}_deactivateAllRectRanges(){this._rectRangeList.forEach((range=>{range.deactivate()}))}_addTextRangesToCache(textRanges){this._rangeListCache.push(...textRanges)}_addTextRange(textRange){this._deactivateAllTextRanges(),textRange.activate(),this._rangeList.push(textRange)}_addRectRangesToCache(rectRanges){this._rectRangeListCache.push(...rectRanges)}_addRectRanges(rectRanges){0!==rectRanges.length&&(this._deactivateAllRectRanges(),rectRanges[rectRanges.length-1].activate(),this._rectRangeList.push(...rectRanges))}_createTextRangeByAnchorPosition(position){this._removeAllRanges();const{scene,mainComponent}=this._context,skeleton=this._docSkeletonManagerService.getSkeleton(),lastRange=new _text_range__WEBPACK_IMPORTED_MODULE_5__.vY(scene,mainComponent,skeleton,position,void 0,this._selectionStyle,this._currentSegmentId,this._currentSegmentPage);this._addTextRange(lastRange)}_updateActiveRangePosition(position){const activeTextRange=this._getActiveRangeInstance();if(null==activeTextRange||null==activeTextRange.anchorNodePosition)return void this._logService.error("[DocSelectionRenderService] _updateActiveRangeFocusPosition: active range has no anchor");this._removeAllRanges(),this._anchorNodePosition=activeTextRange.anchorNodePosition,this._focusNodePosition=position;const{scene,mainComponent}=this._context,skeleton=this._docSkeletonManagerService.getSkeleton(),{_anchorNodePosition,_focusNodePosition,_selectionStyle,_currentSegmentId,_currentSegmentPage}=this;if(null==_anchorNodePosition||null==_focusNodePosition||null==mainComponent)return;const ranges=(0,_selection_utils__WEBPACK_IMPORTED_MODULE_4__.WH)(_anchorNodePosition,_focusNodePosition,scene,mainComponent,skeleton,_selectionStyle,_currentSegmentId,_currentSegmentPage);if(null==ranges)return;const{textRanges,rectRanges}=ranges;this._addTextRangesToCache(textRanges),this._addRectRangesToCache(rectRanges),this.deactivate()}_isEmpty(){return 0===this._rangeList.length&&0===this._rectRangeList.length}_getCanvasOffset(){const engine=this._context.scene?.getEngine();return(0,_selection_utils__WEBPACK_IMPORTED_MODULE_4__.F3)(engine)}_updateInputPosition(forceFocus=!1){const activeRangeInstance=this._getActiveRangeInstance(),anchor=activeRangeInstance?.getAnchor();if(!anchor||anchor&&!anchor.visible||null==this.activeViewPort)return void this.focus();const{left,top}=anchor,absoluteCoord=this.activeViewPort.getAbsoluteVector(_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.I9Y.FromArray([left,top])),{x,y}=absoluteCoord;let{left:canvasLeft,top:canvasTop}=this._getCanvasOffset();canvasLeft+=x,canvasTop+=y,this.activate(canvasLeft,canvasTop,forceFocus)}_moving(moveOffsetX,moveOffsetY){const{_currentSegmentId:segmentId,_currentSegmentPage:segmentPage}=this,focusNode=this._findNodeByCoord(moveOffsetX,moveOffsetY,{strict:!0,segmentId,segmentPage}),focusNodePosition=this._getNodePosition(focusNode);if(null==focusNodePosition||null==focusNode)return;const divide=focusNode?.node.parent,nextGlyph=divide?.glyphGroup[divide.glyphGroup.indexOf(focusNode.node)+1];focusNode?.node.streamType===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.PARAGRAPH&&nextGlyph?.streamType===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.gqw.SECTION_BREAK&&(focusNodePosition.isBack=!0),this._focusNodePosition=focusNodePosition,this._removeAllCacheRanges();const{_anchorNodePosition,_selectionStyle}=this,{scene,mainComponent}=this._context,skeleton=this._docSkeletonManagerService.getSkeleton();if(null==_anchorNodePosition||null==mainComponent)return;const ranges=(0,_selection_utils__WEBPACK_IMPORTED_MODULE_4__.WH)(_anchorNodePosition,focusNodePosition,scene,mainComponent,skeleton,_selectionStyle,segmentId,segmentPage);if(null==ranges)return;const{textRanges,rectRanges}=ranges;this._rangeList.length>0&&textRanges.length>0&&this._interactTextRanges(textRanges),this._rectRangeList.length>0&&rectRanges.length>0&&this._interactRectRanges(rectRanges),this._addTextRangesToCache(textRanges),this._addRectRangesToCache(rectRanges),this.deactivate(),this._context.scene?.getEngine()?.setCapture()}__attachScrollEvent(){const viewport=this.activeViewPort;if(!viewport)return;const{unitId}=this._context;if(this._viewPortObserverMap.has(unitId))return;const scrollBefore=viewport.onScrollAfter$.subscribeEvent((param=>{if(!param.viewport)return;const activeRangeInstance=this._getActiveRangeInstance();activeRangeInstance?.activeStatic()})),scrollStop=viewport.onScrollEnd$.subscribeEvent((param=>{const viewport=param.viewport;if(!viewport)return;const bounds=viewport.getBounding(),activeRangeInstance=this._getActiveRangeInstance(),anchor=activeRangeInstance?.getAnchor();if(anchor&&(!anchor||anchor.visible)){if(bounds){const{left,top,right,bottom}=bounds.viewBound;if(anchor.left<left||anchor.left>right||anchor.top<top||anchor.top>bottom)return void activeRangeInstance?.deactivateStatic()}this._updateInputPosition()}}));this._viewPortObserverMap.set(unitId,{scrollBefore,scrollStop})}_initInputEvents(){this.disposeWithMe((0,rxjs__WEBPACK_IMPORTED_MODULE_11__.R)(this._input,"keydown").subscribe((e=>{this._isIMEInputApply||this._eventHandle(e,(config=>{this._onKeydown$.next(config)}))}))),this.disposeWithMe((0,rxjs__WEBPACK_IMPORTED_MODULE_11__.R)(this._input,"input").subscribe((e=>{if("historyUndo"!==e.inputType&&"historyRedo"!==e.inputType)return this._rectRangeList.length>0?(e.stopPropagation(),e.preventDefault()):void(this._isIMEInputApply||this._eventHandle(e,(config=>{this._onInputBefore$.next(config),this._onInput$.next(config)})))}))),this.disposeWithMe((0,rxjs__WEBPACK_IMPORTED_MODULE_11__.R)(this._input,"compositionstart").subscribe((e=>{if(this._rectRangeList.length>0)return e.stopPropagation(),e.preventDefault();this._isIMEInputApply=!0,this._eventHandle(e,(config=>{this._onCompositionstart$.next(config)}))}))),this.disposeWithMe((0,rxjs__WEBPACK_IMPORTED_MODULE_11__.R)(this._input,"compositionend").subscribe((e=>{this._isIMEInputApply=!1,this._eventHandle(e,(config=>{this._onCompositionend$.next(config)}))}))),this.disposeWithMe((0,rxjs__WEBPACK_IMPORTED_MODULE_11__.R)(this._input,"compositionupdate").subscribe((e=>{this._eventHandle(e,(config=>{this._onInputBefore$.next(config),this._onCompositionupdate$.next(config)}))}))),this.disposeWithMe((0,rxjs__WEBPACK_IMPORTED_MODULE_11__.R)(this._input,"paste").subscribe((e=>{this._eventHandle(e,(config=>{this._onPaste$.next(config)}))}))),this.disposeWithMe((0,rxjs__WEBPACK_IMPORTED_MODULE_11__.R)(this._input,"focus").subscribe((e=>{this._eventHandle(e,(config=>{this._onFocus$.next(config)}))}))),this.disposeWithMe((0,rxjs__WEBPACK_IMPORTED_MODULE_11__.R)(this._input,"blur").subscribe((e=>{this._eventHandle(e,(config=>{this._onBlur$.next(config)}))})))}_eventHandle(e,func){const content=this._input.textContent||"";this._input.innerHTML="";func({event:e,content,activeRange:this._getActiveRange(),rangeList:this._getAllTextRanges()})}_getTransformCoordForDocumentOffset(evtOffsetX,evtOffsetY){const document1=this._context.mainComponent,{documentTransform}=document1.getOffsetConfig();if(null==this.activeViewPort||null==documentTransform)return;const originCoord=this.activeViewPort.transformVector2SceneCoord(_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.I9Y.FromArray([evtOffsetX,evtOffsetY]));return originCoord?documentTransform.clone().invert().applyPoint(originCoord):void 0}_findNodeByCoord(evtOffsetX,evtOffsetY,restrictions){const coord=this._getTransformCoordForDocumentOffset(evtOffsetX,evtOffsetY);if(null==coord)return;const document1=this._context.mainComponent,skeleton=this._docSkeletonManagerService.getSkeleton(),{pageLayoutType=_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_2__.kvx.VERTICAL,pageMarginLeft,pageMarginTop}=document1.getOffsetConfig();return skeleton.findNodeByCoord(coord,pageLayoutType,pageMarginLeft,pageMarginTop,restrictions)}_detachEvent(){this._onInputBefore$.complete(),this._onKeydown$.complete(),this._onInput$.complete(),this._onCompositionstart$.complete(),this._onCompositionupdate$.complete(),this._onCompositionend$.complete(),this._onSelectionStart$.complete(),this._textSelectionInner$.complete(),this._onPaste$.complete(),this._onFocus$.complete(),this._onBlur$.complete(),this._onPointerDown$.complete()}}DocSelectionRenderService=function _ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([_ts_param(1,_univerjs_ui__WEBPACK_IMPORTED_MODULE_3__.xQ),_ts_param(2,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rrK),_ts_param(3,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr),_ts_param(4,(0,_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.y_5)(_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.EX)),_ts_metadata("design:type",Function),_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===_univerjs_ui__WEBPACK_IMPORTED_MODULE_3__.xQ?Object:_univerjs_ui__WEBPACK_IMPORTED_MODULE_3__.xQ,void 0===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rrK?Object:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.rrK,void 0===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr?Object:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.HCr,void 0===_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.EX?Object:_univerjs_docs__WEBPACK_IMPORTED_MODULE_1__.EX])],DocSelectionRenderService)},"../../packages/docs-ui/src/services/selection/rect-range.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{K:()=>RectRange,L:()=>convertPositionsToRectRanges});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/engine-render/src/index.ts"),_convert_rect_range__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/docs-ui/src/services/selection/convert-rect-range.ts"),_text_range__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/docs-ui/src/services/selection/text-range.ts");function convertPositionsToRectRanges(scene,document,docSkeleton,anchorNodePosition,focusNodePosition,style=_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.fCf,segmentId="",segmentPage=-1){const documentOffsetConfig=document.getOffsetConfig();return(new _convert_rect_range__WEBPACK_IMPORTED_MODULE_2__.Rj(documentOffsetConfig,docSkeleton).getNodePositionGroup(anchorNodePosition,focusNodePosition)??[]).map((position=>new RectRange(scene,document,docSkeleton,position.anchor,position.focus,style,segmentId,segmentPage)))}class RectRange{constructor(_scene,_document,_docSkeleton,anchorNodePosition,focusNodePosition,style=_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.fCf,_segmentId="",_segmentPage=-1){this._scene=_scene,this._document=_document,this._docSkeleton=_docSkeleton,this.anchorNodePosition=anchorNodePosition,this.focusNodePosition=focusNodePosition,this.style=style,this._segmentId=_segmentId,this._segmentPage=_segmentPage,this.rangeType=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.AlE.RECT,this._current=!1,this.refresh()}get startOffset(){const{startNodePosition}=this;return this._docSkeleton.findCharIndexByPosition(startNodePosition)}get endOffset(){const{endNodePosition}=this;return this._docSkeleton.findCharIndexByPosition(endNodePosition)}get collapsed(){return!1}get startRow(){return this._startRow}get startColumn(){return this._startCol}get endRow(){return this._endRow}get endColumn(){return this._endCol}get tableId(){return this._tableId}get segmentId(){return this._segmentId}get segmentPage(){return this._segmentPage}get spanEntireRow(){const viewModel=this._docSkeleton.getViewModel(),table=viewModel.getSnapshot().tableSource?.[this._tableId],{_startCol,_endCol}=this;if(null==table)throw new Error("Table is not found.");const{tableColumns}=table;return 0===_startCol&&_endCol===tableColumns.length-1}get spanEntireColumn(){const viewModel=this._docSkeleton.getViewModel(),table=viewModel.getSnapshot().tableSource?.[this._tableId],{_startRow,_endRow}=this;if(null==table)throw new Error("Table is not found.");const{tableRows}=table;return 0===_startRow&&_endRow===tableRows.length-1}get spanEntireTable(){return this.spanEntireRow&&this.spanEntireColumn}get startNodePosition(){const{anchorNodePosition,focusNodePosition}=this;return(0,_convert_rect_range__WEBPACK_IMPORTED_MODULE_2__.e0)(anchorNodePosition,focusNodePosition)?anchorNodePosition:focusNodePosition}get endNodePosition(){const{anchorNodePosition,focusNodePosition}=this;return(0,_convert_rect_range__WEBPACK_IMPORTED_MODULE_2__.e0)(anchorNodePosition,focusNodePosition)?focusNodePosition:anchorNodePosition}get direction(){const{anchorNodePosition,focusNodePosition}=this;return(0,_convert_rect_range__WEBPACK_IMPORTED_MODULE_2__.e0)(anchorNodePosition,focusNodePosition)?_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Ab0.FORWARD:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Ab0.BACKWARD}isActive(){return!0===this._current}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){this._rangeShape?.dispose(),this._rangeShape=null}isIntersection(compareRange){const{startRow,startColumn,endRow,endColumn}=this,{startRow:cStartRow,startColumn:cStartColumn,endRow:cEndRow,endColumn:cEndColumn}=compareRange,rect1={left:startColumn,top:startRow,right:endColumn,bottom:endRow},rect2={left:cStartColumn,top:cStartRow,right:cEndColumn,bottom:cEndRow};return _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.M_G.hasIntersectionBetweenTwoRect(rect1,rect2)}refresh(){this._rangeShape?.hide();const{startNodePosition,endNodePosition,_document,_docSkeleton}=this,documentOffsetConfig=_document.getOffsetConfig(),{docsLeft,docsTop}=documentOffsetConfig,rectInfo=new _convert_rect_range__WEBPACK_IMPORTED_MODULE_2__.Rj(documentOffsetConfig,_docSkeleton).getRangePointData(startNodePosition,endNodePosition);if(null==rectInfo)return;const{pointGroup=[],startRow,endRow,startColumn,endColumn,tableId}=rectInfo;pointGroup?.length>0&&this._createOrUpdateRange(pointGroup,docsLeft,docsTop),this._updateTableInfo(startRow,endRow,startColumn,endColumn,tableId)}_updateTableInfo(startRow,endRow,startCol,endCol,tableId){this._startRow=startRow,this._endRow=endRow,this._startCol=startCol,this._endCol=endCol,this._tableId=tableId}_createOrUpdateRange(pointsGroup,left,top){if(this._rangeShape)return this._rangeShape.translate(left,top),this._rangeShape.updatePointGroup(pointsGroup),void this._rangeShape.show();const polygon=new _univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.Rpp("__DocTableRectRange__"+_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.generateRandomId(6),{pointsGroup,fill:this.style?.fill||(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.oUP)(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.lm0.black,.3),left,top,evented:!1,debounceParentDirty:!1});this._rangeShape=polygon,this._scene.addObject(polygon,_text_range__WEBPACK_IMPORTED_MODULE_3__.FU)}}},"../../packages/docs-ui/src/services/selection/selection-utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{F3:()=>getCanvasOffsetByEngine,WA:()=>getRangeListFromCharIndex,WH:()=>getRangeListFromSelection,Zj:()=>getTextRangeFromCharIndex,cb:()=>getParagraphInfoByGlyph,qv:()=>getRectRangeFromCharIndex,sP:()=>serializeRectRange,x5:()=>serializeTextRange});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/engine-render/src/index.ts"),_convert_rect_range__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/docs-ui/src/services/selection/convert-rect-range.ts"),_rect_range__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/docs-ui/src/services/selection/rect-range.ts"),_text_range__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../packages/docs-ui/src/services/selection/text-range.ts");function getTextRangeFromCharIndex(startOffset,endOffset,scene,document,skeleton,style,segmentId,segmentPage,startIsBack=!0,endIsBack=!0){const startNodePosition=skeleton.findNodePositionByCharIndex(startOffset,startIsBack,segmentId,segmentPage),endNodePosition=skeleton.findNodePositionByCharIndex(endOffset,endIsBack,segmentId,segmentPage);if(null!=startNodePosition&&null!=endNodePosition)return new _text_range__WEBPACK_IMPORTED_MODULE_4__.vY(scene,document,skeleton,startNodePosition,endNodePosition,style,segmentId,segmentPage)}function getRectRangeFromCharIndex(startOffset,endOffset,scene,document,skeleton,style,segmentId,segmentPage){const startNodePosition=skeleton.findNodePositionByCharIndex(startOffset,!0,segmentId,segmentPage),endNodePosition=skeleton.findNodePositionByCharIndex(endOffset,!0,segmentId,segmentPage);if(null!=startNodePosition&&null!=endNodePosition)return new _rect_range__WEBPACK_IMPORTED_MODULE_3__.K(scene,document,skeleton,startNodePosition,endNodePosition,style,segmentId,segmentPage)}function getRangeListFromCharIndex(startOffset,endOffset,scene,document,skeleton,style,segmentId,segmentPage){const startNodePosition=skeleton.findNodePositionByCharIndex(startOffset,!0,segmentId,segmentPage),endNodePosition=skeleton.findNodePositionByCharIndex(endOffset,!0,segmentId,segmentPage);if(null!=startNodePosition&&null!=endNodePosition)return getRangeListFromSelection(startNodePosition,endNodePosition,scene,document,skeleton,style,segmentId,segmentPage)}function getRangeListFromSelection(anchorPosition,focusPosition,scene,document,skeleton,style,segmentId,segmentPage){const textRanges=[],rectRanges=[],rangeParams=[scene,document,skeleton,anchorPosition,focusPosition,style,segmentId,segmentPage];if((0,_convert_rect_range__WEBPACK_IMPORTED_MODULE_2__.Yj)(skeleton,anchorPosition,focusPosition)){if((0,_convert_rect_range__WEBPACK_IMPORTED_MODULE_2__.ID)(anchorPosition,focusPosition))return textRanges.push(new _text_range__WEBPACK_IMPORTED_MODULE_4__.vY(...rangeParams)),{textRanges,rectRanges};{const ranges=(0,_rect_range__WEBPACK_IMPORTED_MODULE_3__.L)(...rangeParams);return rectRanges.push(...ranges),{textRanges,rectRanges}}}if((0,_convert_rect_range__WEBPACK_IMPORTED_MODULE_2__.ug)(anchorPosition,focusPosition)){const ranges=(0,_rect_range__WEBPACK_IMPORTED_MODULE_3__.L)(...rangeParams);return rectRanges.push(...ranges),{textRanges,rectRanges}}const viewModel=skeleton.getViewModel().getSelfOrHeaderFooterViewModel(segmentId),anchorOffset=skeleton.findCharIndexByPosition(anchorPosition),focusOffset=skeleton.findCharIndexByPosition(focusPosition);if(null==anchorOffset||null==focusOffset)return;const direction=anchorOffset<=focusOffset?_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Ab0.FORWARD:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Ab0.BACKWARD,startOffset=Math.min(anchorOffset,focusOffset),endOffset=Math.max(anchorOffset,focusOffset);let start=startOffset,end=endOffset;for(const section of viewModel.getChildren())for(const paragraph of section.children){const{startIndex,endIndex,children}=paragraph,paragraphIndex=section.children.indexOf(paragraph),nextParagraph=section.children[paragraphIndex+1],table=children[0];let endInTable=!1;if(table){const{startIndex:tableStart,endIndex:tableEnd,children}=table;let tableStartPosition=null,tableEndPosition=null;const startRow=children.find((row=>row.startIndex<=startOffset&&row.endIndex>=startOffset)),endRow=children.find((row=>row.startIndex<=endOffset&&row.endIndex>=endOffset));if(startOffset>tableStart&&startOffset<tableEnd)tableStartPosition=skeleton.findNodePositionByCharIndex(startRow.startIndex+2,!0,segmentId,segmentPage),tableEndPosition=skeleton.findNodePositionByCharIndex(tableEnd-4,!0,segmentId,segmentPage),start=tableEnd+1;else if(endOffset>tableStart&&endOffset<tableEnd)tableStartPosition=skeleton.findNodePositionByCharIndex(tableStart+3,!0,segmentId,segmentPage),tableEndPosition=skeleton.findNodePositionByCharIndex(endRow.endIndex-3,!0,segmentId,segmentPage),end=tableStart-1,endInTable=!0;else if(tableStart>startOffset&&tableEnd<endOffset){if(tableStartPosition=skeleton.findNodePositionByCharIndex(tableStart+3,!0,segmentId,segmentPage),tableEndPosition=skeleton.findNodePositionByCharIndex(tableEnd-4,!0,segmentId,segmentPage),start<=tableStart-1){const sp=skeleton.findNodePositionByCharIndex(start,!0,segmentId,segmentPage),ep=skeleton.findNodePositionByCharIndex(tableStart-1,!1,segmentId,segmentPage),ap=direction===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Ab0.FORWARD?sp:ep,fp=direction===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Ab0.FORWARD?ep:sp;textRanges.push(new _text_range__WEBPACK_IMPORTED_MODULE_4__.vY(scene,document,skeleton,ap,fp,style,segmentId,segmentPage))}start=tableEnd+1}if(tableStartPosition&&tableEndPosition){const ap=direction===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Ab0.FORWARD?tableStartPosition:tableEndPosition,fp=direction===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Ab0.FORWARD?tableEndPosition:tableStartPosition;rectRanges.push(...(0,_rect_range__WEBPACK_IMPORTED_MODULE_3__.L)(scene,document,skeleton,ap,fp,style,segmentId,segmentPage))}}if(end===endIndex+1&&!endInTable&&nextParagraph&&nextParagraph.children.length&&(end=endIndex,endInTable=!0),end>=startIndex&&end<=endIndex||endInTable){const sp=skeleton.findNodePositionByCharIndex(start,!0,segmentId,segmentPage),ep=skeleton.findNodePositionByCharIndex(end,!endInTable,segmentId,segmentPage),ap=direction===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Ab0.FORWARD?sp:ep,fp=direction===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Ab0.FORWARD?ep:sp;if(rectRanges.length&&_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.diffValue(ap,fp))continue;textRanges.push(new _text_range__WEBPACK_IMPORTED_MODULE_4__.vY(scene,document,skeleton,ap,fp,style,segmentId,segmentPage))}}return{textRanges,rectRanges}}function getCanvasOffsetByEngine(engine){const canvas=engine?.getCanvasElement();if(!canvas)return{left:0,top:0};const{top,left}=(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.xzu)(canvas);return{left,top}}function getParagraphInfoByGlyph(node){const line=node.parent?.parent,column=line?.parent;if(null==line||null==column)return;const{paragraphIndex}=line,lines=column.lines.filter((line=>line.paragraphIndex===paragraphIndex));let nodeIndex=-1,content="",hasFound=!1;for(const line of lines)for(const divide of line.divides)for(const glyph of divide.glyphGroup)hasFound||(nodeIndex+=glyph.count),glyph===node&&(hasFound=!0),content+=glyph.count>0?glyph.content:"";return{st:lines[0].st,ed:paragraphIndex,content,nodeIndex}}function serializeTextRange(textRange){const{startOffset,endOffset,collapsed,rangeType,startNodePosition,endNodePosition,direction,segmentId,segmentPage}=textRange;return{startOffset,endOffset,collapsed,rangeType,startNodePosition,endNodePosition,direction,segmentId,segmentPage,isActive:textRange.isActive()}}function serializeRectRange(rectRange){const serializedTextRange=serializeTextRange(rectRange),{startRow,startColumn,endRow,endColumn,tableId,spanEntireRow,spanEntireColumn,spanEntireTable}=rectRange;return{...serializedTextRange,startRow,startColumn,endRow,endColumn,tableId,spanEntireRow,spanEntireColumn,spanEntireTable}}},"../../packages/docs-ui/src/services/selection/text-range.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{FU:()=>TEXT_RANGE_LAYER_INDEX,e$:()=>getAnchorBounding,rb:()=>getLineBounding,vY:()=>TextRange});var _univerjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core/src/index.ts"),_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/engine-render/src/index.ts"),_convert_text_range__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/docs-ui/src/services/selection/convert-text-range.ts");const TEXT_RANGE_LAYER_INDEX=3;function getAnchorBounding(pointsGroup){const points=pointsGroup[0],startPoint=points[0],endPoint=points[2],{x:startX,y:startY}=startPoint,{x:endX,y:endY}=endPoint;return{left:startX,top:startY,width:endX-startX,height:endY-startY}}function getLineBounding(pointsGroup){return pointsGroup.map((line=>{let xMin=1/0,xMax=-1/0,yMin=1/0,yMax=-1/0;return line.forEach((point=>{xMin=Math.min(point.x,xMin),xMax=Math.max(point.x,xMax),yMax=Math.max(point.y,yMax),yMin=Math.min(point.y,yMin)})),{left:xMin,right:xMax,top:yMin,bottom:yMax}}))}class TextRange{constructor(_scene,_document,_docSkeleton,anchorNodePosition,focusNodePosition,style=_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.fCf,_segmentId="",_segmentPage=-1){this._scene=_scene,this._document=_document,this._docSkeleton=_docSkeleton,this.anchorNodePosition=anchorNodePosition,this.focusNodePosition=focusNodePosition,this.style=style,this._segmentId=_segmentId,this._segmentPage=_segmentPage,this.rangeType=_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.AlE.TEXT,this._current=!1,this._cursorList=[],this._anchorBlinkTimer=null,this._anchorBlink(),this.refresh()}_anchorBlink(){setTimeout((()=>{this._anchorShape&&this._anchorShape.visible&&this.deactivateStatic()}),500),this._anchorBlinkTimer=setInterval((()=>{this._anchorShape&&this._anchorShape.visible&&(this.activeStatic(),setTimeout((()=>{this.deactivateStatic()}),500))}),1e3)}get startOffset(){const{startOffset}=(0,_convert_text_range__WEBPACK_IMPORTED_MODULE_2__.PD)(this._cursorList)??{},body=this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();if(null==startOffset||null==body)return startOffset;const maxLength=body.dataStream.length-2;return Math.min(maxLength,startOffset)}get endOffset(){const{endOffset}=(0,_convert_text_range__WEBPACK_IMPORTED_MODULE_2__.PD)(this._cursorList)??{},body=this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();if(null==endOffset||null==body)return endOffset;const maxLength=body.dataStream.length-2;return Math.min(endOffset,maxLength)}get collapsed(){const{startOffset,endOffset}=this;return null!=startOffset&&startOffset===endOffset}get startNodePosition(){if(null==this.anchorNodePosition)return null;if(null==this.focusNodePosition)return this.anchorNodePosition;const{start}=(0,_convert_text_range__WEBPACK_IMPORTED_MODULE_2__.zW)(this.anchorNodePosition,this.focusNodePosition);return start}get endNodePosition(){if(null==this.anchorNodePosition)return this.focusNodePosition;if(null==this.focusNodePosition)return null;const{end}=(0,_convert_text_range__WEBPACK_IMPORTED_MODULE_2__.zW)(this.anchorNodePosition,this.focusNodePosition);return end}get direction(){const{collapsed,anchorNodePosition,focusNodePosition}=this;if(collapsed||null==anchorNodePosition||null==focusNodePosition)return _univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Ab0.NONE;return(0,_convert_text_range__WEBPACK_IMPORTED_MODULE_2__.bw)(anchorNodePosition,focusNodePosition)?_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Ab0.FORWARD:_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.Ab0.BACKWARD}get segmentId(){return this._segmentId}get segmentPage(){return this._segmentPage}getAbsolutePosition(){const anchor=this.anchorNodePosition,focus=this.focusNodePosition;if(this._isEmpty())return;const documentOffsetConfig=this._document.getOffsetConfig(),{docsLeft,docsTop}=documentOffsetConfig,convertor=new _convert_text_range__WEBPACK_IMPORTED_MODULE_2__.Wb(documentOffsetConfig,this._docSkeleton);if(this._isCollapsed()){const{contentBoxPointGroup,cursorList}=convertor.getRangePointData(anchor,anchor);if(this._setCursorList(cursorList),0===contentBoxPointGroup.length)return;const pos=getAnchorBounding(contentBoxPointGroup);return{...pos,left:pos.left+docsLeft,top:pos.top+docsTop}}const{borderBoxPointGroup,cursorList}=convertor.getRangePointData(anchor,focus);if(this._setCursorList(cursorList),0===borderBoxPointGroup.length)return;const pos=getAnchorBounding(borderBoxPointGroup);return{...pos,left:pos.left+docsLeft,top:pos.top+docsTop}}getAnchor(){return this._anchorShape}activeStatic(){this._anchorShape?.setProps({stroke:this.style?.strokeActive||(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.oUP)(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.lm0.black,1)})}deactivateStatic(){this._anchorShape?.setProps({stroke:this.style?.stroke||(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.oUP)(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.lm0.black,0)})}isActive(){return!0===this._current}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){this._rangeShape?.dispose(),this._rangeShape=null,this._anchorShape?.dispose(),this._anchorShape=null,this._anchorBlinkTimer&&(clearInterval(this._anchorBlinkTimer),this._anchorBlinkTimer=null)}isIntersection(compareRange){const{startOffset:activeStart,endOffset:activeEnd}=this,{startOffset:compareStart,endOffset:compareEnd}=compareRange;return null!=activeStart&&null!=activeEnd&&null!=compareStart&&null!=compareEnd&&(activeStart<=compareEnd&&activeEnd>=compareStart)}refresh(){const{_document,_docSkeleton}=this,anchor=this.anchorNodePosition,focus=this.focusNodePosition;if(this._anchorShape?.hide(),this._rangeShape?.hide(),this._isEmpty())return;const documentOffsetConfig=_document.getOffsetConfig(),{docsLeft,docsTop}=documentOffsetConfig,convertor=new _convert_text_range__WEBPACK_IMPORTED_MODULE_2__.Wb(documentOffsetConfig,_docSkeleton);if(this._isCollapsed()){const{contentBoxPointGroup,cursorList}=convertor.getRangePointData(anchor,anchor);if(this._setCursorList(cursorList),contentBoxPointGroup.length>0){const glyphAtCursor=_docSkeleton.findGlyphByPosition(anchor);this._createOrUpdateAnchor(contentBoxPointGroup,docsLeft,docsTop,glyphAtCursor)}return}const{borderBoxPointGroup,cursorList}=convertor.getRangePointData(anchor,focus);this._setCursorList(cursorList),borderBoxPointGroup.length>0&&this._createOrUpdateRange(borderBoxPointGroup,docsLeft,docsTop)}_isEmpty(){return null==this.anchorNodePosition&&null==this.focusNodePosition}_isCollapsed(){const anchor=this.anchorNodePosition,focus=this.focusNodePosition;if(null!=anchor&&null==focus)return!0;if(null==anchor||null==focus)return!1;const keys=Object.keys(_convert_text_range__WEBPACK_IMPORTED_MODULE_2__.gL);for(const key of keys){if(anchor[key]!==focus[key])return!1}return anchor.isBack===focus.isBack}_createOrUpdateRange(pointsGroup,left,top){if(this._rangeShape)return this._rangeShape.translate(left,top),this._rangeShape.updatePointGroup(pointsGroup),void this._rangeShape.show();const polygon=new _univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.Rpp("__TestSelectionRange__"+_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.generateRandomId(6),{pointsGroup,fill:this.style?.fill||(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.oUP)(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.lm0.black,.3),left,top,evented:!1,debounceParentDirty:!1});this._rangeShape=polygon,this._scene.addObject(polygon,TEXT_RANGE_LAYER_INDEX)}_createOrUpdateAnchor(pointsGroup,docsLeft,docsTop,glyph){const bounding=getAnchorBounding(pointsGroup),{left:boundingLeft}=bounding;let{top:boundingTop,height}=bounding;height<14&&(boundingTop-=14-height,height=14);let left=boundingLeft+docsLeft;const top=boundingTop+docsTop,isItalic=glyph?.ts?.it===_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.OdA.TRUE;if(isItalic&&(left+=height*Math.tan(12*Math.PI/180)/2),this._anchorShape)return this._anchorShape.transformByState({left,top,height}),this._anchorShape.show(),void(isItalic?this._anchorShape.skew(-12,0):this._anchorShape.skew(0,0));const anchor=new _univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.rwV("__TestSelectionAnchor__"+_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.S0q.generateRandomId(6),{left,top,height,strokeWidth:this.style?.strokeWidth||1.5,stroke:this.style?.strokeActive||(0,_univerjs_engine_render__WEBPACK_IMPORTED_MODULE_1__.oUP)(_univerjs_core__WEBPACK_IMPORTED_MODULE_0__.lm0.black,1),evented:!1});isItalic&&anchor.skew(-12,0),this._anchorShape=anchor,this._scene.addObject(anchor,TEXT_RANGE_LAYER_INDEX),this.activeStatic()}_setCursorList(cursorList){0!==cursorList.length&&(this._cursorList=cursorList)}}},"../../packages/docs-ui/src/types/delete-direction.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{b:()=>DeleteDirection});var DeleteDirection=function(DeleteDirection){return DeleteDirection[DeleteDirection.LEFT=0]="LEFT",DeleteDirection[DeleteDirection.RIGHT=1]="RIGHT",DeleteDirection}({})},"../../packages/docs-ui/src/views/header-footer/panel/component-name.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O:()=>COMPONENT_DOC_HEADER_FOOTER_PANEL});const COMPONENT_DOC_HEADER_FOOTER_PANEL="COMPONENT_DOC_HEADER_FOOTER_PANEL"},"../../packages/docs-ui/src/views/table/create/component-name.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{i:()=>COMPONENT_DOC_CREATE_TABLE_CONFIRM});const COMPONENT_DOC_CREATE_TABLE_CONFIRM="COMPONENT_DOC_CREATE_TABLE_CONFIRM"},"../../packages/docs/src/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Tu:()=>DocInterceptorService,pv:()=>doc_selection_manager_service_DocSelectionManagerService,EX:()=>DocSkeletonManagerService,Mx:()=>DocStateEmitService,Bz:()=>core_editing_mutation_RichTextEditingMutation,Uh:()=>SetTextSelectionsOperation});var src=__webpack_require__("../../packages/core/src/index.ts"),engine_render_src=__webpack_require__("../../packages/engine-render/src/index.ts"),Subject=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/Subject.js"),BehaviorSubject=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/BehaviorSubject.js"),takeUntil=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/takeUntil.js");const SetTextSelectionsOperation={id:"doc.operation.set-selections",type:src.g4t.OPERATION,handler:()=>!0};function _ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function _ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class doc_selection_manager_service_DocSelectionManagerService extends src.hy_{constructor(_commandService,_univerInstanceService){super(),this._commandService=_commandService,this._univerInstanceService=_univerInstanceService,this._currentSelection=null,this._textSelectionInfo=new Map,this._textSelection$=new Subject.B,this.textSelection$=this._textSelection$.asObservable(),this._refreshSelection$=new BehaviorSubject.t(null),this.refreshSelection$=this._refreshSelection$.asObservable(),this._listenCurrentUnit()}_listenCurrentUnit(){this._univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_DOC).pipe((0,takeUntil.Q)(this.dispose$)).subscribe((documentModel=>{if(null==documentModel)return;const unitId=documentModel.getUnitId();this._setCurrentSelectionNotRefresh({unitId,subUnitId:unitId})}))}__getCurrentSelection(){return this._currentSelection}getSelectionInfo(params=this._currentSelection){return this._getTextRanges(params)}refreshSelection(params=this._currentSelection){null!=params&&this._refresh(params)}__TEST_ONLY_setCurrentSelection(param){this._currentSelection=param,this._refresh(param)}getTextRanges(params=this._currentSelection){return this._getTextRanges(params)?.textRanges}getRectRanges(params=this._currentSelection){return this._getTextRanges(params)?.rectRanges}getDocRanges(params=this._currentSelection){return[...this.getTextRanges(params)??[],...this.getRectRanges(params)??[]].filter((range=>null!=range.startOffset&&null!=range.endOffset)).sort(((a,b)=>a.startOffset>b.startOffset?1:a.startOffset<b.startOffset?-1:0))}getActiveTextRange(){const selectionInfo=this._getTextRanges(this._currentSelection);if(null==selectionInfo)return;const{textRanges}=selectionInfo;return textRanges.find((textRange=>textRange.isActive))}getActiveRectRange(){const selectionInfo=this._getTextRanges(this._currentSelection);if(null==selectionInfo)return;const{rectRanges}=selectionInfo;return rectRanges.find((rectRange=>rectRange.isActive))}__TEST_ONLY_add(textRanges,isEditing=!0){null!=this._currentSelection&&this._addByParam({...this._currentSelection,textRanges,rectRanges:[],segmentId:"",segmentPage:-1,isEditing,style:engine_render_src.fCf})}replaceTextRanges(docRanges,isEditing=!0,options){return this.replaceDocRanges(docRanges,this._currentSelection,isEditing,options)}replaceDocRanges(docRanges,params=this._currentSelection,isEditing=!0,options){if(null==params)return;const{unitId,subUnitId}=params;this._refreshSelection$.next({unitId,subUnitId,docRanges,isEditing,options})}__replaceTextRangesWithNoRefresh(textSelectionInfo,search){if(null==this._currentSelection)return;const params={...textSelectionInfo,...search};this._replaceByParam(params),this._textSelection$.next(params);const{unitId,subUnitId,segmentId,style,textRanges,rectRanges,isEditing}=params,ranges=[...textRanges,...rectRanges].filter((range=>null!=range.startOffset&&null!=range.endOffset)).sort(((a,b)=>a.startOffset>b.startOffset?1:a.startOffset<b.startOffset?-1:0));this._commandService.executeCommand(SetTextSelectionsOperation.id,{unitId,subUnitId,segmentId,style,isEditing,ranges})}dispose(){this._textSelection$.complete()}_setCurrentSelectionNotRefresh(param){this._currentSelection=param}_getTextRanges(param){if(null==param)return;const{unitId,subUnitId=""}=param;return this._textSelectionInfo.get(unitId)?.get(subUnitId)}_refresh(param){const allTextSelectionInfo=this._getTextRanges(param);if(null==allTextSelectionInfo)return;const{textRanges,rectRanges}=allTextSelectionInfo,docRanges=[...textRanges,...rectRanges],{unitId,subUnitId}=param;this._refreshSelection$.next({unitId,subUnitId,docRanges,isEditing:!1})}_replaceByParam(insertParam){const{unitId,subUnitId,...selectionInsertParam}=insertParam;this._textSelectionInfo.has(unitId)||this._textSelectionInfo.set(unitId,new Map);this._textSelectionInfo.get(unitId).set(subUnitId,{...selectionInsertParam})}_addByParam(insertParam){const{unitId,subUnitId,...selectionInsertParam}=insertParam;this._textSelectionInfo.has(unitId)||this._textSelectionInfo.set(unitId,new Map);const unitTextRange=this._textSelectionInfo.get(unitId);if(unitTextRange.has(subUnitId)){unitTextRange.get(subUnitId).textRanges.push(...insertParam.textRanges)}else unitTextRange.set(subUnitId,{...selectionInsertParam})}}function doc_skeleton_manager_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function doc_skeleton_manager_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}doc_selection_manager_service_DocSelectionManagerService=function _ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([_ts_param(0,src.wTY),_ts_param(1,src.HCr),_ts_metadata("design:type",Function),_ts_metadata("design:paramtypes",[void 0===src.wTY?Object:src.wTY,void 0===src.HCr?Object:src.HCr])],doc_selection_manager_service_DocSelectionManagerService);class DocSkeletonManagerService extends src.hy_{constructor(_context,_localeService,_univerInstanceService){super(),this._context=_context,this._localeService=_localeService,this._univerInstanceService=_univerInstanceService,this._currentSkeleton$=new BehaviorSubject.t(null),this.currentSkeleton$=this._currentSkeleton$.asObservable(),this._currentSkeletonBefore$=new BehaviorSubject.t(null),this.currentSkeletonBefore$=this._currentSkeletonBefore$.asObservable(),this._currentViewModel$=new BehaviorSubject.t(null),this.currentViewModel$=this._currentViewModel$.asObservable(),this._init(),this._univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_DOC).pipe((0,takeUntil.Q)(this.dispose$)).subscribe((documentModel=>{documentModel&&documentModel.getUnitId()===this._context.unitId&&this._update(documentModel)}))}dispose(){super.dispose(),this._currentSkeletonBefore$.complete(),this._currentSkeleton$.complete()}getSkeleton(){return this._skeleton}getViewModel(){return this._docViewModel}_init(){const documentDataModel=this._context.unit;this._update(documentDataModel)}_update(documentDataModel){const unitId=this._context.unitId;if(null==documentDataModel.getBody())return;this._docViewModel&&(0,src.W2S)(unitId)?(this._docViewModel.reset(documentDataModel),this._context.unit=documentDataModel):this._docViewModel||(this._docViewModel=this._buildDocViewModel(documentDataModel)),this._skeleton||(this._skeleton=this._buildSkeleton(this._docViewModel));const skeleton=this._skeleton;skeleton.calculate(),this._currentSkeletonBefore$.next(skeleton),this._currentSkeleton$.next(skeleton),this._currentViewModel$.next(this._docViewModel)}_buildSkeleton(documentViewModel){return engine_render_src.Puq.create(documentViewModel,this._localeService)}_buildDocViewModel(documentDataModel){return new engine_render_src.GHm(documentDataModel)}}DocSkeletonManagerService=function doc_skeleton_manager_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([doc_skeleton_manager_service_ts_param(1,(0,src.y_5)(src.iH9)),doc_skeleton_manager_service_ts_param(2,src.HCr),doc_skeleton_manager_service_ts_metadata("design:type",Function),doc_skeleton_manager_service_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===src.iH9?Object:src.iH9,void 0===src.HCr?Object:src.HCr])],DocSkeletonManagerService);class DocStateEmitService extends src.hy_{constructor(){super(),this._docStateChangeParams$=new BehaviorSubject.t(null),this.docStateChangeParams$=this._docStateChangeParams$.asObservable()}emitStateChangeInfo(params){this._docStateChangeParams$.next(params)}dispose(){super.dispose(),this._docStateChangeParams$.complete()}}const core_editing_mutation_RichTextEditingMutation={id:"doc.mutation.rich-text-editing",type:src.g4t.MUTATION,handler:(accessor,params)=>{const{unitId,segmentId="",actions,textRanges,prevTextRanges,trigger,noHistory,isCompositionEnd,noNeedSetTextRange,debounce,isEditing=!0,isSync,syncer}=params,univerInstanceService=accessor.get(src.HCr),renderManagerService=accessor.get(engine_render_src.cSx),docStateEmitService=accessor.get(DocStateEmitService),documentDataModel=univerInstanceService.getUniverDocInstance(unitId),documentViewModel=renderManagerService.getRenderById(unitId)?.with(DocSkeletonManagerService).getViewModel();if(null==documentDataModel||null==documentViewModel)throw new Error(`DocumentDataModel or documentViewModel not found for unitId: ${unitId}`);const docSelectionManagerService=accessor.get(doc_selection_manager_service_DocSelectionManagerService),docRanges=docSelectionManagerService.getDocRanges()??[],disabled=!!documentDataModel.getSnapshot().disabled;if(src.rRQ.isNoop(actions)||actions&&0===actions.length||disabled)return{unitId,actions:[],textRanges:docRanges};const undoActions=src.rRQ.invertWithDoc(actions,documentDataModel.getSnapshot());documentDataModel.apply(actions),documentViewModel.reset(documentDataModel),noNeedSetTextRange||!textRanges||null==trigger||isSync||queueMicrotask((()=>{docSelectionManagerService.replaceDocRanges(textRanges,{unitId,subUnitId:unitId},isEditing,params.options)}));const changeState={commandId:"doc.mutation.rich-text-editing",unitId,segmentId,trigger,noHistory,debounce,redoState:{actions,textRanges},undoState:{actions:undoActions,textRanges:prevTextRanges??docRanges},isCompositionEnd,isSync,syncer};return docStateEmitService.emitStateChangeInfo(changeState),{unitId,actions:undoActions,textRanges:docRanges}}},DocsRenameMutation={id:"doc.mutation.rename-doc",type:src.g4t.MUTATION,handler:(accessor,params)=>{const doc=accessor.get(src.HCr).getUnit(params.unitId,src.Zy$.UNIVER_DOC);return!!doc&&(doc.setName(params.name),!0)}},defaultPluginConfig=(Symbol("docs.config"),{});function custom_range_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function custom_range_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class DocCustomRangeController extends src.jGt{constructor(_commandService,_textSelectionManagerService,_univerInstanceService){super(),this._commandService=_commandService,this._textSelectionManagerService=_textSelectionManagerService,this._univerInstanceService=_univerInstanceService,this._initSelectionChange()}_transformCustomRange(doc,selection){const{startOffset,endOffset,collapsed}=selection,customRanges=doc.getCustomRanges()?.filter((range=>!!range.wholeEntity&&(!(startOffset<=range.startIndex&&endOffset>range.endIndex)&&(collapsed?range.startIndex<startOffset&&range.endIndex>=endOffset:src.Z4q.range.isIntersects(startOffset,endOffset-1,range.startIndex,range.endIndex)))));if(customRanges?.length){let start=startOffset,end=endOffset;return customRanges.forEach((range=>{start=Math.min(range.startIndex,start),end=Math.max(range.endIndex+1,end)})),{...selection,startOffset:start,endOffset:end,collapsed:start===end}}return selection}_initSelectionChange(){this.disposeWithMe(this._commandService.onCommandExecuted((commandInfo=>{if(commandInfo.id===SetTextSelectionsOperation.id){const params=commandInfo.params,{unitId,ranges,isEditing}=params,doc=this._univerInstanceService.getUnit(unitId);if(!doc)return;const transformedRanges=ranges.map((range=>this._transformCustomRange(doc,range)));transformedRanges.some(((range,i)=>ranges[i]!==range))&&this._textSelectionManagerService.replaceTextRanges(transformedRanges,isEditing)}})))}}function doc_plugin_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function doc_plugin_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}DocCustomRangeController=function custom_range_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([custom_range_controller_ts_param(0,src.wTY),custom_range_controller_ts_param(1,(0,src.y_5)(doc_selection_manager_service_DocSelectionManagerService)),custom_range_controller_ts_param(2,src.HCr),custom_range_controller_ts_metadata("design:type",Function),custom_range_controller_ts_metadata("design:paramtypes",[void 0===src.wTY?Object:src.wTY,void 0===doc_selection_manager_service_DocSelectionManagerService?Object:doc_selection_manager_service_DocSelectionManagerService,void 0===src.HCr?Object:src.HCr])],DocCustomRangeController);class UniverDocsPlugin extends src.k_1{static#_=this.pluginName="DOCS_PLUGIN";constructor(_config=defaultPluginConfig,_injector,_configService){super(),this._config=_config,this._injector=_injector,this._configService=_configService;const{...rest}=(0,src.h1I)({},defaultPluginConfig,this._config);this._configService.setConfig("docs.config",rest)}onStarting(){this._initializeDependencies(),this._initializeCommands()}_initializeCommands(){[core_editing_mutation_RichTextEditingMutation,DocsRenameMutation,SetTextSelectionsOperation].forEach((command=>{this._injector.get(src.wTY).registerCommand(command)}))}_initializeDependencies(){[[doc_selection_manager_service_DocSelectionManagerService],[DocStateEmitService],[DocCustomRangeController]].forEach((d=>this._injector.add(d)))}onReady(){this._injector.get(DocCustomRangeController)}}UniverDocsPlugin=function doc_plugin_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([doc_plugin_ts_param(1,(0,src.y_5)(src.zZn)),doc_plugin_ts_param(2,src.J0C),doc_plugin_ts_metadata("design:type",Function),doc_plugin_ts_metadata("design:paramtypes",["undefined"==typeof Partial?Object:Partial,void 0===src.zZn?Object:src.zZn,void 0===src.J0C?Object:src.J0C])],UniverDocsPlugin);const DOC_INTERCEPTOR_POINT={CUSTOM_RANGE:(0,src.nwg)("CUSTOM_RANGE"),CUSTOM_DECORATION:(0,src.nwg)("CUSTOM_DECORATION")};function doc_interceptor_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}class DocInterceptorService extends src.jGt{constructor(_context,_docSkeletonManagerService){super(),this._context=_context,this._docSkeletonManagerService=_docSkeletonManagerService,this._interceptorsByName=new Map;const viewModel=this._docSkeletonManagerService.getViewModel(),unitId=viewModel.getDataModel().getUnitId();if(unitId===src.Fmw||unitId===src.azi)return;this.disposeWithMe(this.interceptDocumentViewModel(viewModel)),this.disposeWithMe(this.intercept(DOC_INTERCEPTOR_POINT.CUSTOM_RANGE,{priority:-1,handler:(data,pos,next)=>next(data)}));let disposableCollection=new src.VdD;viewModel.segmentViewModels$.subscribe((segmentViewModels=>{disposableCollection.dispose(),disposableCollection=new src.VdD,segmentViewModels.forEach((segmentViewModel=>{disposableCollection.add(this.interceptDocumentViewModel(segmentViewModel))}))})),this.disposeWithMe(disposableCollection)}intercept(name,interceptor){const key=name;this._interceptorsByName.has(key)||this._interceptorsByName.set(key,[]);const interceptors=this._interceptorsByName.get(key);return interceptors.push(interceptor),this._interceptorsByName.set(key,interceptors.sort(((a,b)=>(b.priority??0)-(a.priority??0)))),this.disposeWithMe((0,src.saO)((()=>(0,src.TFI)(this._interceptorsByName.get(key),interceptor))))}fetchThroughInterceptors(name){const key=name,interceptors=this._interceptorsByName.get(key);return(0,src.pF5)(interceptors||[])}interceptDocumentViewModel(viewModel){const disposableCollection=new src.VdD;return disposableCollection.add(viewModel.registerCustomRangeInterceptor({getCustomRange:index=>this.fetchThroughInterceptors(DOC_INTERCEPTOR_POINT.CUSTOM_RANGE)(viewModel.getCustomRangeRaw(index),{index,unitId:viewModel.getDataModel().getUnitId(),customRanges:viewModel.getDataModel().getCustomRanges()??[]}),getCustomDecoration:index=>this.fetchThroughInterceptors(DOC_INTERCEPTOR_POINT.CUSTOM_DECORATION)(viewModel.getCustomDecorationRaw(index),{index,unitId:viewModel.getDataModel().getUnitId(),customDecorations:viewModel.getDataModel().getCustomDecorations()??[]})})),disposableCollection}}DocInterceptorService=function doc_interceptor_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([function doc_interceptor_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}(1,(0,src.y_5)(DocSkeletonManagerService)),doc_interceptor_service_ts_metadata("design:type",Function),doc_interceptor_service_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===DocSkeletonManagerService?Object:DocSkeletonManagerService])],DocInterceptorService)}}]);