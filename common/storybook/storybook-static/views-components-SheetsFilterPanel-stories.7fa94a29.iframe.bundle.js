"use strict";(self.webpackChunk_univerjs_storybook=self.webpackChunk_univerjs_storybook||[]).push([[4867],{"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[13].use[1]!../../node_modules/.pnpm/postcss-loader@8.1.1_postcss@8.5.3_typescript@5.8.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[13].use[2]!../../packages/docs-ui/src/global.css":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,'.univer-pointer-events-none {\n    pointer-events: none\n}\n.univer-invisible {\n    visibility: hidden\n}\n.univer-fixed {\n    position: fixed\n}\n.univer-absolute {\n    position: absolute\n}\n.univer-relative {\n    position: relative\n}\n.univer-sticky {\n    position: sticky\n}\n.univer-inset-0 {\n    top: 0px;\n    right: 0px;\n    bottom: 0px;\n    left: 0px\n}\n.univer-bottom-0 {\n    bottom: 0px\n}\n.univer-left-0 {\n    left: 0px\n}\n.univer-left-1 {\n    left: 0.25rem\n}\n.univer-left-1\\.5 {\n    left: 0.375rem\n}\n.univer-left-1\\/2 {\n    left: 50%\n}\n.univer-left-2 {\n    left: 0.5rem\n}\n.univer-right-0 {\n    right: 0px\n}\n.univer-right-1\\.5 {\n    right: 0.375rem\n}\n.univer-right-2 {\n    right: 0.5rem\n}\n.univer-top-0 {\n    top: 0px\n}\n.univer-top-0\\.5 {\n    top: 0.125rem\n}\n.univer-top-1\\/2 {\n    top: 50%\n}\n.univer-top-4 {\n    top: 1rem\n}\n.univer-top-\\[-99999px\\] {\n    top: -99999px\n}\n.univer-z-10 {\n    z-index: 10\n}\n.univer-z-50 {\n    z-index: 50\n}\n.univer-z-\\[-1\\] {\n    z-index: -1\n}\n.univer-z-\\[1001\\] {\n    z-index: 1001\n}\n.univer-z-\\[100\\] {\n    z-index: 100\n}\n.univer-z-\\[1080\\] {\n    z-index: 1080\n}\n.univer-z-\\[1\\] {\n    z-index: 1\n}\n.univer-m-0 {\n    margin: 0px\n}\n.-univer-mx-1 {\n    margin-left: -0.25rem;\n    margin-right: -0.25rem\n}\n.univer-mx-auto {\n    margin-left: auto;\n    margin-right: auto\n}\n.univer-my-1 {\n    margin-top: 0.25rem;\n    margin-bottom: 0.25rem\n}\n.univer-mb-2 {\n    margin-bottom: 0.5rem\n}\n.univer-mb-4 {\n    margin-bottom: 1rem\n}\n.univer-ml-auto {\n    margin-left: auto\n}\n.univer-mr-2 {\n    margin-right: 0.5rem\n}\n.univer-box-border {\n    box-sizing: border-box\n}\n.univer-line-clamp-1 {\n    overflow: hidden;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    -webkit-line-clamp: 1\n}\n.univer-block {\n    display: block\n}\n.univer-flex {\n    display: flex\n}\n.univer-inline-flex {\n    display: inline-flex\n}\n.univer-grid {\n    display: grid\n}\n.univer-hidden {\n    display: none\n}\n.univer-size-0 {\n    width: 0px;\n    height: 0px\n}\n.univer-size-2 {\n    width: 0.5rem;\n    height: 0.5rem\n}\n.univer-size-2\\.5 {\n    width: 0.625rem;\n    height: 0.625rem\n}\n.univer-size-4 {\n    width: 1rem;\n    height: 1rem\n}\n.univer-size-5 {\n    width: 1.25rem;\n    height: 1.25rem\n}\n.univer-size-6 {\n    width: 1.5rem;\n    height: 1.5rem\n}\n.univer-size-full {\n    width: 100%;\n    height: 100%\n}\n.\\!univer-h-5 {\n    height: 1.25rem !important\n}\n.univer-h-0 {\n    height: 0px\n}\n.univer-h-0\\.5 {\n    height: 0.125rem\n}\n.univer-h-10 {\n    height: 2.5rem\n}\n.univer-h-12 {\n    height: 3rem\n}\n.univer-h-2 {\n    height: 0.5rem\n}\n.univer-h-3\\.5 {\n    height: 0.875rem\n}\n.univer-h-48 {\n    height: 12rem\n}\n.univer-h-5 {\n    height: 1.25rem\n}\n.univer-h-6 {\n    height: 1.5rem\n}\n.univer-h-7 {\n    height: 1.75rem\n}\n.univer-h-8 {\n    height: 2rem\n}\n.univer-h-\\[148px\\] {\n    height: 148px\n}\n.univer-h-full {\n    height: 100%\n}\n.univer-h-px {\n    height: 1px\n}\n.univer-max-h-\\[360px\\] {\n    max-height: 360px\n}\n.univer-max-h-\\[var\\(--radix-popper-available-height\\)\\] {\n    max-height: var(--radix-popper-available-height)\n}\n.univer-min-h-full {\n    min-height: 100%\n}\n.univer-w-0 {\n    width: 0px\n}\n.univer-w-0\\.5 {\n    width: 0.125rem\n}\n.univer-w-14 {\n    width: 3.5rem\n}\n.univer-w-24 {\n    width: 6rem\n}\n.univer-w-3\\.5 {\n    width: 0.875rem\n}\n.univer-w-32 {\n    width: 8rem\n}\n.univer-w-5 {\n    width: 1.25rem\n}\n.univer-w-72 {\n    width: 18rem\n}\n.univer-w-96 {\n    width: 24rem\n}\n.univer-w-\\[220px\\] {\n    width: 220px\n}\n.univer-w-\\[292px\\] {\n    width: 292px\n}\n.univer-w-\\[300px\\] {\n    width: 300px\n}\n.univer-w-\\[50\\%\\] {\n    width: 50%\n}\n.univer-w-\\[55px\\] {\n    width: 55px\n}\n.univer-w-auto {\n    width: auto\n}\n.univer-w-fit {\n    width: -moz-fit-content;\n    width: fit-content\n}\n.univer-w-full {\n    width: 100%\n}\n.univer-min-w-6 {\n    min-width: 1.5rem\n}\n.univer-min-w-\\[260px\\] {\n    min-width: 260px\n}\n.univer-min-w-\\[320px\\] {\n    min-width: 320px\n}\n.univer-max-w-\\[480px\\] {\n    max-width: 480px\n}\n.univer-max-w-\\[var\\(--radix-popper-available-width\\)\\] {\n    max-width: var(--radix-popper-available-width)\n}\n.univer-flex-1 {\n    flex: 1 1 0%\n}\n.univer-flex-shrink-0 {\n    flex-shrink: 0\n}\n.univer-shrink-0 {\n    flex-shrink: 0\n}\n.-univer-translate-x-1\\/2 {\n    --tw-translate-x: -50%;\n    transform: translate(-50%, var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))\n}\n.-univer-translate-y-1\\/2 {\n    --tw-translate-y: -50%;\n    transform: translate(var(--tw-translate-x), -50%) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))\n}\n.univer-translate-x-0 {\n    --tw-translate-x: 0px;\n    transform: translate(0px, var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))\n}\n.univer-translate-x-full {\n    --tw-translate-x: 100%;\n    transform: translate(100%, var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))\n}\n.univer-translate-y-1\\.5 {\n    --tw-translate-y: 0.375rem;\n    transform: translate(var(--tw-translate-x), 0.375rem) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))\n}\n.univer-translate-y-\\[calc\\(-50\\%_-_2px\\)\\] {\n    --tw-translate-y: calc(-50% - 2px);\n    transform: translate(var(--tw-translate-x), calc(-50% - 2px)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))\n}\n.univer-rotate-45 {\n    --tw-rotate: 45deg;\n    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(45deg) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))\n}\n@keyframes univer-spin {\n    to {\n        transform: rotate(360deg)\n    }\n}\n.univer-animate-spin {\n    animation: univer-spin 1s linear infinite\n}\n.univer-cursor-crosshair {\n    cursor: crosshair\n}\n.univer-cursor-default {\n    cursor: default\n}\n.univer-cursor-not-allowed {\n    cursor: not-allowed\n}\n.univer-cursor-pointer {\n    cursor: pointer\n}\n.univer-select-none {\n    -webkit-user-select: none;\n       -moz-user-select: none;\n            user-select: none\n}\n.univer-list-none {\n    list-style-type: none\n}\n.univer-appearance-none {\n    -webkit-appearance: none;\n       -moz-appearance: none;\n            appearance: none\n}\n.univer-grid-flow-col {\n    grid-auto-flow: column\n}\n.univer-grid-cols-5 {\n    grid-template-columns: repeat(5, minmax(0, 1fr))\n}\n.univer-grid-cols-8 {\n    grid-template-columns: repeat(8, minmax(0, 1fr))\n}\n.univer-grid-rows-\\[auto_1fr_auto\\] {\n    grid-template-rows: auto 1fr auto\n}\n.univer-flex-col {\n    flex-direction: column\n}\n.univer-flex-wrap {\n    flex-wrap: wrap\n}\n.univer-flex-nowrap {\n    flex-wrap: nowrap\n}\n.univer-content-center {\n    align-content: center\n}\n.univer-items-start {\n    align-items: flex-start\n}\n.univer-items-center {\n    align-items: center\n}\n.univer-justify-center {\n    justify-content: center\n}\n.univer-justify-between {\n    justify-content: space-between\n}\n.univer-justify-around {\n    justify-content: space-around\n}\n.univer-gap-1 {\n    gap: 0.25rem\n}\n.univer-gap-2 {\n    gap: 0.5rem\n}\n.univer-gap-3 {\n    gap: 0.75rem\n}\n.univer-gap-4 {\n    gap: 1rem\n}\n.univer-gap-6 {\n    gap: 1.5rem\n}\n.univer-gap-x-2 {\n    -moz-column-gap: 0.5rem;\n         column-gap: 0.5rem\n}\n.univer-gap-y-3 {\n    row-gap: 0.75rem\n}\n.univer-space-x-2 > :not([hidden]) ~ :not([hidden]) {\n    --tw-space-x-reverse: 0;\n    margin-right: calc(0.5rem * 0);\n    margin-right: calc(0.5rem * var(--tw-space-x-reverse));\n    margin-left: calc(0.5rem * (1 - 0));\n    margin-left: calc(0.5rem * (1 - var(--tw-space-x-reverse)));\n    margin-left: calc(0.5rem * calc(1 - 0));\n    margin-left: calc(0.5rem * calc(1 - var(--tw-space-x-reverse)))\n}\n.univer-space-y-4 > :not([hidden]) ~ :not([hidden]) {\n    --tw-space-y-reverse: 0;\n    margin-top: calc(1rem * (1 - 0));\n    margin-top: calc(1rem * (1 - var(--tw-space-y-reverse)));\n    margin-top: calc(1rem * calc(1 - 0));\n    margin-top: calc(1rem * calc(1 - var(--tw-space-y-reverse)));\n    margin-bottom: calc(1rem * 0);\n    margin-bottom: calc(1rem * var(--tw-space-y-reverse))\n}\n.univer-self-baseline {\n    align-self: baseline\n}\n.univer-justify-self-center {\n    justify-self: center\n}\n.univer-overflow-hidden {\n    overflow: hidden\n}\n.univer-overflow-y-auto {\n    overflow-y: auto\n}\n.univer-truncate {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap\n}\n.univer-text-ellipsis {\n    text-overflow: ellipsis\n}\n.univer-whitespace-nowrap {\n    white-space: nowrap\n}\n.univer-text-balance {\n    text-wrap: balance\n}\n.univer-rounded {\n    border-radius: 0.25rem\n}\n.univer-rounded-\\[2px\\] {\n    border-radius: 2px\n}\n.univer-rounded-full {\n    border-radius: 9999px\n}\n.univer-rounded-lg {\n    border-radius: 0.5rem\n}\n.univer-rounded-md {\n    border-radius: 0.375rem\n}\n.univer-rounded-xl {\n    border-radius: 0.75rem\n}\n.univer-rounded-l {\n    border-top-left-radius: 0.25rem;\n    border-bottom-left-radius: 0.25rem\n}\n.univer-rounded-r {\n    border-top-right-radius: 0.25rem;\n    border-bottom-right-radius: 0.25rem\n}\n.univer-border {\n    border-width: 1px\n}\n.univer-border-0 {\n    border-width: 0px\n}\n.univer-border-2 {\n    border-width: 2px\n}\n.univer-border-b {\n    border-bottom-width: 1px\n}\n.univer-border-l {\n    border-left-width: 1px\n}\n.univer-border-r {\n    border-right-width: 1px\n}\n.univer-border-solid {\n    border-style: solid\n}\n.univer-border-none {\n    border-style: none\n}\n.\\!univer-border-gray-200 {\n    --tw-border-opacity: 1 !important;\n    border-color: rgba(227, 229, 234, 1) !important;\n    border-color: rgba(227, 229, 234, var(--tw-border-opacity, 1)) !important\n}\n.univer-border-gray-100 {\n    --tw-border-opacity: 1;\n    border-color: rgba(238, 239, 241, 1);\n    border-color: rgba(238, 239, 241, var(--tw-border-opacity, 1))\n}\n.univer-border-gray-200 {\n    --tw-border-opacity: 1;\n    border-color: rgba(227, 229, 234, 1);\n    border-color: rgba(227, 229, 234, var(--tw-border-opacity, 1))\n}\n.univer-border-gray-300 {\n    --tw-border-opacity: 1;\n    border-color: rgba(205, 208, 216, 1);\n    border-color: rgba(205, 208, 216, var(--tw-border-opacity, 1))\n}\n.univer-border-transparent {\n    border-color: transparent\n}\n.univer-border-white {\n    --tw-border-opacity: 1;\n    border-color: rgba(255, 255, 255, 1);\n    border-color: rgba(255, 255, 255, var(--tw-border-opacity, 1))\n}\n.univer-border-b-gray-200 {\n    --tw-border-opacity: 1;\n    border-bottom-color: rgba(227, 229, 234, 1);\n    border-bottom-color: rgba(227, 229, 234, var(--tw-border-opacity, 1))\n}\n.univer-border-r-gray-200 {\n    --tw-border-opacity: 1;\n    border-right-color: rgba(227, 229, 234, 1);\n    border-right-color: rgba(227, 229, 234, var(--tw-border-opacity, 1))\n}\n.\\!univer-bg-gray-200 {\n    --tw-bg-opacity: 1 !important;\n    background-color: rgba(227, 229, 234, 1) !important;\n    background-color: rgba(227, 229, 234, var(--tw-bg-opacity, 1)) !important\n}\n.\\!univer-bg-primary-500 {\n    --tw-bg-opacity: 1 !important;\n    background-color: rgba(70, 106, 247, 1) !important;\n    background-color: rgba(70, 106, 247, var(--tw-bg-opacity, 1)) !important\n}\n.univer-bg-gray-100 {\n    --tw-bg-opacity: 1;\n    background-color: rgba(238, 239, 241, 1);\n    background-color: rgba(238, 239, 241, var(--tw-bg-opacity, 1))\n}\n.univer-bg-gray-200 {\n    --tw-bg-opacity: 1;\n    background-color: rgba(227, 229, 234, 1);\n    background-color: rgba(227, 229, 234, var(--tw-bg-opacity, 1))\n}\n.univer-bg-gray-300 {\n    --tw-bg-opacity: 1;\n    background-color: rgba(205, 208, 216, 1);\n    background-color: rgba(205, 208, 216, var(--tw-bg-opacity, 1))\n}\n.univer-bg-gray-50 {\n    --tw-bg-opacity: 1;\n    background-color: rgba(249, 250, 251, 1);\n    background-color: rgba(249, 250, 251, var(--tw-bg-opacity, 1))\n}\n.univer-bg-gray-700 {\n    --tw-bg-opacity: 1;\n    background-color: rgba(44, 48, 64, 1);\n    background-color: rgba(44, 48, 64, var(--tw-bg-opacity, 1))\n}\n.univer-bg-primary-500 {\n    --tw-bg-opacity: 1;\n    background-color: rgba(70, 106, 247, 1);\n    background-color: rgba(70, 106, 247, var(--tw-bg-opacity, 1))\n}\n.univer-bg-transparent {\n    background-color: transparent\n}\n.univer-bg-white {\n    --tw-bg-opacity: 1;\n    background-color: rgba(255, 255, 255, 1);\n    background-color: rgba(255, 255, 255, var(--tw-bg-opacity, 1))\n}\n.univer-fill-current {\n    fill: currentColor\n}\n.univer-fill-gray-700 {\n    fill: #2C3040\n}\n.univer-p-0 {\n    padding: 0px\n}\n.univer-p-1 {\n    padding: 0.25rem\n}\n.univer-p-1\\.5 {\n    padding: 0.375rem\n}\n.univer-p-2 {\n    padding: 0.5rem\n}\n.univer-p-4 {\n    padding: 1rem\n}\n.univer-px-1 {\n    padding-left: 0.25rem;\n    padding-right: 0.25rem\n}\n.univer-px-1\\.5 {\n    padding-left: 0.375rem;\n    padding-right: 0.375rem\n}\n.univer-px-12 {\n    padding-left: 3rem;\n    padding-right: 3rem\n}\n.univer-px-2 {\n    padding-left: 0.5rem;\n    padding-right: 0.5rem\n}\n.univer-px-3 {\n    padding-left: 0.75rem;\n    padding-right: 0.75rem\n}\n.univer-px-4 {\n    padding-left: 1rem;\n    padding-right: 1rem\n}\n.univer-px-5 {\n    padding-left: 1.25rem;\n    padding-right: 1.25rem\n}\n.univer-py-0\\.5 {\n    padding-top: 0.125rem;\n    padding-bottom: 0.125rem\n}\n.univer-py-1 {\n    padding-top: 0.25rem;\n    padding-bottom: 0.25rem\n}\n.univer-py-1\\.5 {\n    padding-top: 0.375rem;\n    padding-bottom: 0.375rem\n}\n.univer-py-2 {\n    padding-top: 0.5rem;\n    padding-bottom: 0.5rem\n}\n.univer-py-2\\.5 {\n    padding-top: 0.625rem;\n    padding-bottom: 0.625rem\n}\n.univer-py-6 {\n    padding-top: 1.5rem;\n    padding-bottom: 1.5rem\n}\n.\\!univer-pl-4 {\n    padding-left: 1rem !important\n}\n.\\!univer-pr-5 {\n    padding-right: 1.25rem !important\n}\n.univer-pb-2 {\n    padding-bottom: 0.5rem\n}\n.univer-pl-6 {\n    padding-left: 1.5rem\n}\n.univer-pl-8 {\n    padding-left: 2rem\n}\n.univer-pr-2 {\n    padding-right: 0.5rem\n}\n.univer-pr-5 {\n    padding-right: 1.25rem\n}\n.univer-pr-8 {\n    padding-right: 2rem\n}\n.univer-text-center {\n    text-align: center\n}\n.univer-text-right {\n    text-align: right\n}\n.univer-font-sans {\n    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"\n}\n.univer-text-\\[10px\\] {\n    font-size: 10px\n}\n.univer-text-\\[13px\\] {\n    font-size: 13px\n}\n.univer-text-base {\n    font-size: 1rem;\n    line-height: 1.5rem\n}\n.univer-text-lg {\n    font-size: 1.125rem;\n    line-height: 1.75rem\n}\n.univer-text-sm {\n    font-size: 0.875rem;\n    line-height: 1.25rem\n}\n.univer-text-xs {\n    font-size: 0.75rem;\n    line-height: 1rem\n}\n.univer-font-medium {\n    font-weight: 500\n}\n.univer-font-semibold {\n    font-weight: 600\n}\n.univer-uppercase {\n    text-transform: uppercase\n}\n.univer-tracking-widest {\n    letter-spacing: 0.1em\n}\n.univer-text-blue-500 {\n    --tw-text-opacity: 1;\n    color: rgba(63, 131, 248, 1);\n    color: rgba(63, 131, 248, var(--tw-text-opacity, 1))\n}\n.univer-text-cyan-700 {\n    --tw-text-opacity: 1;\n    color: rgba(14, 116, 144, 1);\n    color: rgba(14, 116, 144, var(--tw-text-opacity, 1))\n}\n.univer-text-gray-100 {\n    --tw-text-opacity: 1;\n    color: rgba(238, 239, 241, 1);\n    color: rgba(238, 239, 241, var(--tw-text-opacity, 1))\n}\n.univer-text-gray-200 {\n    --tw-text-opacity: 1;\n    color: rgba(227, 229, 234, 1);\n    color: rgba(227, 229, 234, var(--tw-text-opacity, 1))\n}\n.univer-text-gray-300 {\n    --tw-text-opacity: 1;\n    color: rgba(205, 208, 216, 1);\n    color: rgba(205, 208, 216, var(--tw-text-opacity, 1))\n}\n.univer-text-gray-400 {\n    --tw-text-opacity: 1;\n    color: rgba(151, 157, 172, 1);\n    color: rgba(151, 157, 172, var(--tw-text-opacity, 1))\n}\n.univer-text-gray-500 {\n    --tw-text-opacity: 1;\n    color: rgba(95, 101, 116, 1);\n    color: rgba(95, 101, 116, var(--tw-text-opacity, 1))\n}\n.univer-text-gray-600 {\n    --tw-text-opacity: 1;\n    color: rgba(65, 70, 87, 1);\n    color: rgba(65, 70, 87, var(--tw-text-opacity, 1))\n}\n.univer-text-gray-700 {\n    --tw-text-opacity: 1;\n    color: rgba(44, 48, 64, 1);\n    color: rgba(44, 48, 64, var(--tw-text-opacity, 1))\n}\n.univer-text-gray-800 {\n    --tw-text-opacity: 1;\n    color: rgba(24, 28, 42, 1);\n    color: rgba(24, 28, 42, var(--tw-text-opacity, 1))\n}\n.univer-text-gray-900 {\n    --tw-text-opacity: 1;\n    color: rgba(14, 17, 30, 1);\n    color: rgba(14, 17, 30, var(--tw-text-opacity, 1))\n}\n.univer-text-green-500 {\n    --tw-text-opacity: 1;\n    color: rgba(13, 164, 113, 1);\n    color: rgba(13, 164, 113, var(--tw-text-opacity, 1))\n}\n.univer-text-indigo-600 {\n    --tw-text-opacity: 1;\n    color: rgba(44, 83, 241, 1);\n    color: rgba(44, 83, 241, var(--tw-text-opacity, 1))\n}\n.univer-text-primary-600 {\n    --tw-text-opacity: 1;\n    color: rgba(44, 83, 241, 1);\n    color: rgba(44, 83, 241, var(--tw-text-opacity, 1))\n}\n.univer-text-red-500 {\n    --tw-text-opacity: 1;\n    color: rgba(240, 82, 82, 1);\n    color: rgba(240, 82, 82, var(--tw-text-opacity, 1))\n}\n.univer-text-white {\n    --tw-text-opacity: 1;\n    color: rgba(255, 255, 255, 1);\n    color: rgba(255, 255, 255, var(--tw-text-opacity, 1))\n}\n.univer-text-yellow-400 {\n    --tw-text-opacity: 1;\n    color: rgba(241, 179, 18, 1);\n    color: rgba(241, 179, 18, var(--tw-text-opacity, 1))\n}\n.univer-underline {\n    text-decoration-line: underline\n}\n.univer-opacity-100 {\n    opacity: 1\n}\n.univer-opacity-50 {\n    opacity: 0.5\n}\n.univer-opacity-60 {\n    opacity: 0.6\n}\n.univer-opacity-90 {\n    opacity: 0.9\n}\n.univer-shadow-\\[0_0_10px_0_rgba\\(0\\,0\\,0\\,0\\.1\\)\\] {\n    --tw-shadow: 0 0 10px 0 rgba(0,0,0,0.1);\n    --tw-shadow-colored: 0 0 10px 0 var(--tw-shadow-color);\n    box-shadow: 0 0 rgba(0,0,0,0), 0 0 rgba(0,0,0,0), 0 0 10px 0 rgba(0,0,0,0.1);\n    box-shadow: var(--tw-ring-offset-shadow, 0 0 rgba(0,0,0,0)), var(--tw-ring-shadow, 0 0 rgba(0,0,0,0)), var(--tw-shadow)\n}\n.univer-shadow-\\[0_1px_6px_-2px_rgba\\(30\\,40\\,77\\,0\\.08\\)\\,0_2px_6px_-1px_rgba\\(30\\,40\\,77\\,0\\.10\\)\\] {\n    --tw-shadow: 0 1px 6px -2px rgba(30,40,77,0.08),0 2px 6px -1px rgba(30,40,77,0.10);\n    --tw-shadow-colored: 0 1px 6px -2px var(--tw-shadow-color), 0 2px 6px -1px var(--tw-shadow-color);\n    box-shadow: 0 0 rgba(0,0,0,0), 0 0 rgba(0,0,0,0), 0 1px 6px -2px rgba(30,40,77,0.08),0 2px 6px -1px rgba(30,40,77,0.10);\n    box-shadow: var(--tw-ring-offset-shadow, 0 0 rgba(0,0,0,0)), var(--tw-ring-shadow, 0 0 rgba(0,0,0,0)), var(--tw-shadow)\n}\n.univer-shadow-inner {\n    --tw-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.05);\n    --tw-shadow-colored: inset 0 2px 4px 0 var(--tw-shadow-color);\n    box-shadow: 0 0 rgba(0,0,0,0), 0 0 rgba(0,0,0,0), inset 0 2px 4px 0 rgba(0, 0, 0, 0.05);\n    box-shadow: var(--tw-ring-offset-shadow, 0 0 rgba(0,0,0,0)), var(--tw-ring-shadow, 0 0 rgba(0,0,0,0)), var(--tw-shadow)\n}\n.univer-shadow-md {\n    --tw-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);\n    --tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);\n    box-shadow: 0 0 rgba(0,0,0,0), 0 0 rgba(0,0,0,0), 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);\n    box-shadow: var(--tw-ring-offset-shadow, 0 0 rgba(0,0,0,0)), var(--tw-ring-shadow, 0 0 rgba(0,0,0,0)), var(--tw-shadow)\n}\n.univer-shadow-sm {\n    --tw-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n    --tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);\n    box-shadow: 0 0 rgba(0,0,0,0), 0 0 rgba(0,0,0,0), 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n    box-shadow: var(--tw-ring-offset-shadow, 0 0 rgba(0,0,0,0)), var(--tw-ring-shadow, 0 0 rgba(0,0,0,0)), var(--tw-shadow)\n}\n.univer-outline-none {\n    outline: 2px solid transparent;\n    outline-offset: 2px\n}\n.univer-ring-2 {\n    --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);\n    --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);\n    box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), 0 0 rgba(0,0,0,0);\n    box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 rgba(0,0,0,0))\n}\n.univer-ring-\\[1\\.5px\\] {\n    --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);\n    --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1.5px + var(--tw-ring-offset-width)) var(--tw-ring-color);\n    box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), 0 0 rgba(0,0,0,0);\n    box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 rgba(0,0,0,0))\n}\n.univer-ring-primary-600 {\n    --tw-ring-opacity: 1;\n    --tw-ring-color: rgba(44, 83, 241, var(--tw-ring-opacity, 1))\n}\n.univer-ring-white {\n    --tw-ring-opacity: 1;\n    --tw-ring-color: rgba(255, 255, 255, var(--tw-ring-opacity, 1))\n}\n.univer-ring-offset-1 {\n    --tw-ring-offset-width: 1px\n}\n.univer-ring-offset-2 {\n    --tw-ring-offset-width: 2px\n}\n.univer-ring-offset-gray-600 {\n    --tw-ring-offset-color: #414657\n}\n.univer-ring-offset-white {\n    --tw-ring-offset-color: #fff\n}\n.univer-transition-all {\n    transition-property: all;\n    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n    transition-duration: 150ms\n}\n.univer-transition-colors {\n    transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;\n    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n    transition-duration: 150ms\n}\n.univer-transition-shadow {\n    transition-property: box-shadow;\n    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n    transition-duration: 150ms\n}\n.univer-transition-transform {\n    transition-property: transform;\n    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n    transition-duration: 150ms\n}\n.univer-duration-200 {\n    transition-duration: 200ms\n}\n.univer-duration-300 {\n    transition-duration: 300ms\n}\n.univer-duration-75 {\n    transition-duration: 75ms\n}\n.univer-will-change-transform {\n    will-change: transform\n}\n.univer-scrollbar-thin::-webkit-scrollbar-track {\n    background-color: var(--scrollbar-track);\n    border-radius: var(--scrollbar-track-radius)\n}\n.univer-scrollbar-thin::-webkit-scrollbar-track:hover {\n    background-color: var(--scrollbar-track-hover, var(--scrollbar-track))\n}\n.univer-scrollbar-thin::-webkit-scrollbar-track:active {\n    background-color: var(--scrollbar-track-active, var(--scrollbar-track-hover, var(--scrollbar-track)))\n}\n.univer-scrollbar-thin::-webkit-scrollbar-thumb {\n    background-color: var(--scrollbar-thumb);\n    border-radius: var(--scrollbar-thumb-radius)\n}\n.univer-scrollbar-thin::-webkit-scrollbar-thumb:hover {\n    background-color: var(--scrollbar-thumb-hover, var(--scrollbar-thumb))\n}\n.univer-scrollbar-thin::-webkit-scrollbar-thumb:active {\n    background-color: var(--scrollbar-thumb-active, var(--scrollbar-thumb-hover, var(--scrollbar-thumb)))\n}\n.univer-scrollbar-thin::-webkit-scrollbar-corner {\n    background-color: var(--scrollbar-corner);\n    border-radius: var(--scrollbar-corner-radius)\n}\n.univer-scrollbar-thin::-webkit-scrollbar-corner:hover {\n    background-color: var(--scrollbar-corner-hover, var(--scrollbar-corner))\n}\n.univer-scrollbar-thin::-webkit-scrollbar-corner:active {\n    background-color: var(--scrollbar-corner-active, var(--scrollbar-corner-hover, var(--scrollbar-corner)))\n}\n.univer-scrollbar-thin {\n    scrollbar-width: thin;\n    scrollbar-color: initial initial;\n    scrollbar-color: var(--scrollbar-thumb, initial) var(--scrollbar-track, initial)\n}\n.univer-scrollbar-thin::-webkit-scrollbar {\n    display: block;\n    width: 8px;\n    height: 8px\n}\n.univer-scrollbar-track-gray-50 {\n    --scrollbar-track: #F9FAFB !important\n}\n.univer-scrollbar-track-transparent {\n    --scrollbar-track: transparent !important\n}\n.univer-scrollbar-thumb-gray-300 {\n    --scrollbar-thumb: #CDD0D8 !important\n}\n@keyframes enter {\n    from {\n        opacity: 1;\n        opacity: var(--tw-enter-opacity, 1);\n        transform: translate3d(0, 0, 0) scale3d(1, 1, 1) rotate(0);\n        transform: translate3d(var(--tw-enter-translate-x, 0), var(--tw-enter-translate-y, 0), 0) scale3d(var(--tw-enter-scale, 1), var(--tw-enter-scale, 1), var(--tw-enter-scale, 1)) rotate(var(--tw-enter-rotate, 0))\n    }\n}\n@keyframes exit {\n    to {\n        opacity: 1;\n        opacity: var(--tw-exit-opacity, 1);\n        transform: translate3d(0, 0, 0) scale3d(1, 1, 1) rotate(0);\n        transform: translate3d(var(--tw-exit-translate-x, 0), var(--tw-exit-translate-y, 0), 0) scale3d(var(--tw-exit-scale, 1), var(--tw-exit-scale, 1), var(--tw-exit-scale, 1)) rotate(var(--tw-exit-rotate, 0))\n    }\n}\n.univer-animate-in {\n    animation-name: enter;\n    animation-duration: 150ms;\n    --tw-enter-opacity: initial;\n    --tw-enter-scale: initial;\n    --tw-enter-rotate: initial;\n    --tw-enter-translate-x: initial;\n    --tw-enter-translate-y: initial\n}\n.univer-fade-in {\n    --tw-enter-opacity: 0\n}\n.univer-fade-in-0 {\n    --tw-enter-opacity: 0\n}\n.univer-zoom-in-95 {\n    --tw-enter-scale: .95\n}\n.univer-slide-in-from-top-4 {\n    --tw-enter-translate-y: -1rem\n}\n.univer-slide-in-from-top-full {\n    --tw-enter-translate-y: -100%\n}\n.univer-duration-200 {\n    animation-duration: 200ms\n}\n.univer-duration-300 {\n    animation-duration: 300ms\n}\n.univer-duration-75 {\n    animation-duration: 75ms\n}\n.placeholder\\:univer-text-gray-400::-moz-placeholder {\n    --tw-text-opacity: 1;\n    color: rgba(151, 157, 172, 1);\n    color: rgba(151, 157, 172, var(--tw-text-opacity, 1))\n}\n.placeholder\\:univer-text-gray-400::placeholder {\n    --tw-text-opacity: 1;\n    color: rgba(151, 157, 172, 1);\n    color: rgba(151, 157, 172, var(--tw-text-opacity, 1))\n}\n.last\\:univer-border-b-0:last-child {\n    border-bottom-width: 0px\n}\n.data-\\[disabled\\]\\:univer-pointer-events-none[data-disabled] {\n    pointer-events: none\n}\n.data-\\[orientation\\=horizontal\\]\\:univer-h-px[data-orientation="horizontal"] {\n    height: 1px\n}\n.data-\\[orientation\\=vertical\\]\\:univer-h-full[data-orientation="vertical"] {\n    height: 100%\n}\n.data-\\[orientation\\=horizontal\\]\\:univer-w-full[data-orientation="horizontal"] {\n    width: 100%\n}\n.data-\\[orientation\\=vertical\\]\\:univer-w-px[data-orientation="vertical"] {\n    width: 1px\n}\n.data-\\[state\\=open\\]\\:univer-bg-gray-100[data-state="open"] {\n    --tw-bg-opacity: 1;\n    background-color: rgba(238, 239, 241, 1);\n    background-color: rgba(238, 239, 241, var(--tw-bg-opacity, 1))\n}\n.data-\\[disabled\\]\\:univer-opacity-50[data-disabled] {\n    opacity: 0.5\n}\n.data-\\[state\\=open\\]\\:univer-animate-in[data-state="open"] {\n    animation-name: enter;\n    animation-duration: 150ms;\n    --tw-enter-opacity: initial;\n    --tw-enter-scale: initial;\n    --tw-enter-rotate: initial;\n    --tw-enter-translate-x: initial;\n    --tw-enter-translate-y: initial\n}\n.data-\\[state\\=closed\\]\\:univer-animate-out[data-state="closed"] {\n    animation-name: exit;\n    animation-duration: 150ms;\n    --tw-exit-opacity: initial;\n    --tw-exit-scale: initial;\n    --tw-exit-rotate: initial;\n    --tw-exit-translate-x: initial;\n    --tw-exit-translate-y: initial\n}\n.data-\\[state\\=closed\\]\\:univer-fade-out-0[data-state="closed"] {\n    --tw-exit-opacity: 0\n}\n.data-\\[state\\=open\\]\\:univer-fade-in-0[data-state="open"] {\n    --tw-enter-opacity: 0\n}\n.data-\\[state\\=closed\\]\\:univer-zoom-out-95[data-state="closed"] {\n    --tw-exit-scale: .95\n}\n.data-\\[state\\=open\\]\\:univer-zoom-in-95[data-state="open"] {\n    --tw-enter-scale: .95\n}\n.data-\\[side\\=bottom\\]\\:univer-slide-in-from-top-2[data-side="bottom"] {\n    --tw-enter-translate-y: -0.5rem\n}\n.data-\\[side\\=left\\]\\:univer-slide-in-from-right-2[data-side="left"] {\n    --tw-enter-translate-x: 0.5rem\n}\n.data-\\[side\\=right\\]\\:univer-slide-in-from-left-2[data-side="right"] {\n    --tw-enter-translate-x: -0.5rem\n}\n.data-\\[side\\=top\\]\\:univer-slide-in-from-bottom-2[data-side="top"] {\n    --tw-enter-translate-y: 0.5rem\n}\n.hover\\:\\!univer-bg-primary-500:hover {\n    --tw-bg-opacity: 1 !important;\n    background-color: rgba(70, 106, 247, 1) !important;\n    background-color: rgba(70, 106, 247, var(--tw-bg-opacity, 1)) !important\n}\n.hover\\:univer-bg-gray-100:hover {\n    --tw-bg-opacity: 1;\n    background-color: rgba(238, 239, 241, 1);\n    background-color: rgba(238, 239, 241, var(--tw-bg-opacity, 1))\n}\n.hover\\:univer-bg-gray-200:hover {\n    --tw-bg-opacity: 1;\n    background-color: rgba(227, 229, 234, 1);\n    background-color: rgba(227, 229, 234, var(--tw-bg-opacity, 1))\n}\n.hover\\:univer-bg-gray-300:hover {\n    --tw-bg-opacity: 1;\n    background-color: rgba(205, 208, 216, 1);\n    background-color: rgba(205, 208, 216, var(--tw-bg-opacity, 1))\n}\n.hover\\:univer-bg-neutral-100:hover {\n    --tw-bg-opacity: 1;\n    background-color: rgba(245, 245, 245, 1);\n    background-color: rgba(245, 245, 245, var(--tw-bg-opacity, 1))\n}\n.hover\\:univer-bg-transparent:hover {\n    background-color: transparent\n}\n.hover\\:univer-text-gray-500:hover {\n    --tw-text-opacity: 1;\n    color: rgba(95, 101, 116, 1);\n    color: rgba(95, 101, 116, var(--tw-text-opacity, 1))\n}\n.hover\\:univer-text-gray-900:hover {\n    --tw-text-opacity: 1;\n    color: rgba(14, 17, 30, 1);\n    color: rgba(14, 17, 30, var(--tw-text-opacity, 1))\n}\n.hover\\:univer-ring-\\[1\\.5px\\]:hover {\n    --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);\n    --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1.5px + var(--tw-ring-offset-width)) var(--tw-ring-color);\n    box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), 0 0 rgba(0,0,0,0);\n    box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 rgba(0,0,0,0))\n}\n.hover\\:univer-ring-primary-600:hover {\n    --tw-ring-opacity: 1;\n    --tw-ring-color: rgba(44, 83, 241, var(--tw-ring-opacity, 1))\n}\n.hover\\:univer-ring-primary-600\\/40:hover {\n    --tw-ring-color: rgba(44, 83, 241, 0.4)\n}\n.focus\\:univer-border-blue-500:focus {\n    --tw-border-opacity: 1;\n    border-color: rgba(63, 131, 248, 1);\n    border-color: rgba(63, 131, 248, var(--tw-border-opacity, 1))\n}\n.focus\\:univer-bg-gray-100:focus {\n    --tw-bg-opacity: 1;\n    background-color: rgba(238, 239, 241, 1);\n    background-color: rgba(238, 239, 241, var(--tw-bg-opacity, 1))\n}\n.focus\\:univer-bg-white:focus {\n    --tw-bg-opacity: 1;\n    background-color: rgba(255, 255, 255, 1);\n    background-color: rgba(255, 255, 255, var(--tw-bg-opacity, 1))\n}\n.focus\\:univer-outline-none:focus {\n    outline: 2px solid transparent;\n    outline-offset: 2px\n}\n.focus\\:univer-ring-2:focus {\n    --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);\n    --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);\n    box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), 0 0 rgba(0,0,0,0);\n    box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 rgba(0,0,0,0))\n}\n.focus\\:univer-ring-blue-500\\/20:focus {\n    --tw-ring-color: rgba(63, 131, 248, 0.2)\n}\n.focus-visible\\:univer-outline-none:focus-visible {\n    outline: 2px solid transparent;\n    outline-offset: 2px\n}\n.dark\\:univer-border-gray-600:where(.univer-dark, .univer-dark *) {\n    --tw-border-opacity: 1;\n    border-color: rgba(65, 70, 87, 1);\n    border-color: rgba(65, 70, 87, var(--tw-border-opacity, 1))\n}\n.dark\\:univer-border-gray-700:where(.univer-dark, .univer-dark *) {\n    --tw-border-opacity: 1;\n    border-color: rgba(44, 48, 64, 1);\n    border-color: rgba(44, 48, 64, var(--tw-border-opacity, 1))\n}\n.dark\\:univer-bg-gray-700:where(.univer-dark, .univer-dark *) {\n    --tw-bg-opacity: 1;\n    background-color: rgba(44, 48, 64, 1);\n    background-color: rgba(44, 48, 64, var(--tw-bg-opacity, 1))\n}\n.dark\\:univer-bg-gray-900:where(.univer-dark, .univer-dark *) {\n    --tw-bg-opacity: 1;\n    background-color: rgba(14, 17, 30, 1);\n    background-color: rgba(14, 17, 30, var(--tw-bg-opacity, 1))\n}\n.dark\\:univer-text-gray-200:where(.univer-dark, .univer-dark *) {\n    --tw-text-opacity: 1;\n    color: rgba(227, 229, 234, 1);\n    color: rgba(227, 229, 234, var(--tw-text-opacity, 1))\n}\n.dark\\:univer-text-gray-400:where(.univer-dark, .univer-dark *) {\n    --tw-text-opacity: 1;\n    color: rgba(151, 157, 172, 1);\n    color: rgba(151, 157, 172, var(--tw-text-opacity, 1))\n}\n.dark\\:univer-text-primary-500:where(.univer-dark, .univer-dark *) {\n    --tw-text-opacity: 1;\n    color: rgba(70, 106, 247, 1);\n    color: rgba(70, 106, 247, var(--tw-text-opacity, 1))\n}\n.dark\\:univer-text-white:where(.univer-dark, .univer-dark *) {\n    --tw-text-opacity: 1;\n    color: rgba(255, 255, 255, 1);\n    color: rgba(255, 255, 255, var(--tw-text-opacity, 1))\n}\n.dark\\:univer-ring-primary-600:where(.univer-dark, .univer-dark *) {\n    --tw-ring-opacity: 1;\n    --tw-ring-color: rgba(44, 83, 241, var(--tw-ring-opacity, 1))\n}\n.dark\\:univer-ring-offset-gray-600:where(.univer-dark, .univer-dark *) {\n    --tw-ring-offset-color: #414657\n}\n.dark\\:hover\\:univer-bg-gray-600:hover:where(.univer-dark, .univer-dark *) {\n    --tw-bg-opacity: 1;\n    background-color: rgba(65, 70, 87, 1);\n    background-color: rgba(65, 70, 87, var(--tw-bg-opacity, 1))\n}\n.dark\\:focus\\:univer-bg-gray-600:focus:where(.univer-dark, .univer-dark *) {\n    --tw-bg-opacity: 1;\n    background-color: rgba(65, 70, 87, 1);\n    background-color: rgba(65, 70, 87, var(--tw-bg-opacity, 1))\n}\n.\\[\\&\\:disabled\\]\\:univer-cursor-not-allowed:disabled {\n    cursor: not-allowed\n}\n.\\[\\&\\:disabled\\]\\:univer-text-gray-200:disabled {\n    --tw-text-opacity: 1;\n    color: rgba(227, 229, 234, 1);\n    color: rgba(227, 229, 234, var(--tw-text-opacity, 1))\n}\n.\\[\\&\\:disabled\\]\\:hover\\:univer-bg-transparent:hover:disabled {\n    background-color: transparent\n}\n.\\[\\&\\>\\*\\]\\:univer-inline-flex>* {\n    display: inline-flex\n}\n.\\[\\&\\>\\*\\]\\:univer-h-6>* {\n    height: 1.5rem\n}\n.\\[\\&\\>\\*\\]\\:univer-items-center>* {\n    align-items: center\n}\n.\\[\\&\\>\\*\\]\\:univer-rounded>* {\n    border-radius: 0.25rem\n}\n.\\[\\&\\>\\*\\]\\:univer-px-1>* {\n    padding-left: 0.25rem;\n    padding-right: 0.25rem\n}\n.\\[\\&\\>\\*\\]\\:univer-transition-colors>* {\n    transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;\n    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n    transition-duration: 150ms\n}\n.hover\\:\\[\\&\\>\\*\\]\\:univer-bg-gray-300>*:hover {\n    --tw-bg-opacity: 1;\n    background-color: rgba(205, 208, 216, 1);\n    background-color: rgba(205, 208, 216, var(--tw-bg-opacity, 1))\n}\n.\\[\\&\\>a\\]\\:univer-cursor-pointer>a {\n    cursor: pointer\n}\n.\\[\\&\\>a\\]\\:univer-px-2>a {\n    padding-left: 0.5rem;\n    padding-right: 0.5rem\n}\n.\\[\\&\\>a\\]\\:univer-py-1>a {\n    padding-top: 0.25rem;\n    padding-bottom: 0.25rem\n}\n.\\[\\&\\>a\\]\\:univer-text-sm>a {\n    font-size: 0.875rem;\n    line-height: 1.25rem\n}\n.\\[\\&\\>input\\]\\:univer-w-11>input {\n    width: 2.75rem\n}\n.\\[\\&\\>li\\]\\:univer-border-0>li {\n    border-width: 0px\n}\n.\\[\\&\\>li\\]\\:univer-border-b>li {\n    border-bottom-width: 1px\n}\n.\\[\\&\\>li\\]\\:univer-border-solid>li {\n    border-style: solid\n}\n.\\[\\&\\>li\\]\\:univer-border-b-gray-200>li {\n    --tw-border-opacity: 1;\n    border-bottom-color: rgba(227, 229, 234, 1);\n    border-bottom-color: rgba(227, 229, 234, var(--tw-border-opacity, 1))\n}\n.\\[\\&\\>svg\\]\\:univer-relative>svg {\n    position: relative\n}\n.\\[\\&\\>svg\\]\\:univer-top-0\\.5>svg {\n    top: 0.125rem\n}\n.\\[\\&\\>svg\\]\\:univer-block>svg {\n    display: block\n}\n.\\[\\&\\>svg\\]\\:univer-size-4>svg {\n    width: 1rem;\n    height: 1rem\n}\n.\\[\\&\\>svg\\]\\:univer-shrink-0>svg {\n    flex-shrink: 0\n}\n.\\[\\&_a\\]\\:univer-flex a {\n    display: flex\n}\n.\\[\\&_a\\]\\:univer-size-6 a {\n    width: 1.5rem;\n    height: 1.5rem\n}\n.\\[\\&_a\\]\\:univer-cursor-pointer a {\n    cursor: pointer\n}\n.\\[\\&_a\\]\\:univer-items-center a {\n    align-items: center\n}\n.\\[\\&_a\\]\\:univer-justify-center a {\n    justify-content: center\n}\n.\\[\\&_a\\]\\:univer-rounded a {\n    border-radius: 0.25rem\n}\n.\\[\\&_a\\]\\:univer-p-1 a {\n    padding: 0.25rem\n}\n.\\[\\&_input\\]\\:univer-box-border input {\n    box-sizing: border-box\n}\n.\\[\\&_input\\]\\:univer-flex input {\n    display: flex\n}\n.\\[\\&_input\\]\\:univer-h-8 input {\n    height: 2rem\n}\n.\\[\\&_input\\]\\:univer-items-center input {\n    align-items: center\n}\n.\\[\\&_input\\]\\:univer-rounded input {\n    border-radius: 0.25rem\n}\n.\\[\\&_input\\]\\:univer-border input {\n    border-width: 1px\n}\n.\\[\\&_input\\]\\:univer-border-solid input {\n    border-style: solid\n}\n.\\[\\&_input\\]\\:univer-border-gray-200 input {\n    --tw-border-opacity: 1;\n    border-color: rgba(227, 229, 234, 1);\n    border-color: rgba(227, 229, 234, var(--tw-border-opacity, 1))\n}\n.\\[\\&_input\\]\\:univer-bg-transparent input {\n    background-color: transparent\n}\n.\\[\\&_input\\]\\:univer-px-1\\.5 input {\n    padding-left: 0.375rem;\n    padding-right: 0.375rem\n}\n.\\[\\&_input\\]\\:univer-text-sm input {\n    font-size: 0.875rem;\n    line-height: 1.25rem\n}\n.\\[\\&_input\\]\\:univer-text-gray-700 input {\n    --tw-text-opacity: 1;\n    color: rgba(44, 48, 64, 1);\n    color: rgba(44, 48, 64, var(--tw-text-opacity, 1))\n}\n.\\[\\&_input\\]\\:univer-outline-none input {\n    outline: 2px solid transparent;\n    outline-offset: 2px\n}\n.dark\\:\\[\\&_input\\]\\:univer-border-gray-600 input:where(.univer-dark, .univer-dark *) {\n    --tw-border-opacity: 1;\n    border-color: rgba(65, 70, 87, 1);\n    border-color: rgba(65, 70, 87, var(--tw-border-opacity, 1))\n}\n.dark\\:\\[\\&_input\\]\\:univer-text-white input:where(.univer-dark, .univer-dark *) {\n    --tw-text-opacity: 1;\n    color: rgba(255, 255, 255, 1);\n    color: rgba(255, 255, 255, var(--tw-text-opacity, 1))\n}\n.\\[\\&_svg\\]\\:univer-pointer-events-none svg {\n    pointer-events: none\n}\n.\\[\\&_svg\\]\\:univer-size-4 svg {\n    width: 1rem;\n    height: 1rem\n}\n.\\[\\&_svg\\]\\:univer-shrink-0 svg {\n    flex-shrink: 0\n}\n',"",{version:3,sources:["webpack://./../../packages/docs-ui/src/global.css"],names:[],mappings:"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",sourcesContent:["@tailwind components;\n@tailwind utilities;\n"],sourceRoot:""}]);const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[13].use[1]!../../node_modules/.pnpm/postcss-loader@8.1.1_postcss@8.5.3_typescript@5.8.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[13].use[2]!../../packages/sheets-ui/src/global.css":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,'.univer-pointer-events-none {\n    pointer-events: none\n}\n.univer-invisible {\n    visibility: hidden\n}\n.univer-fixed {\n    position: fixed\n}\n.univer-absolute {\n    position: absolute\n}\n.univer-relative {\n    position: relative\n}\n.univer-sticky {\n    position: sticky\n}\n.univer-inset-0 {\n    top: 0px;\n    right: 0px;\n    bottom: 0px;\n    left: 0px\n}\n.univer-bottom-0 {\n    bottom: 0px\n}\n.univer-left-0 {\n    left: 0px\n}\n.univer-left-1 {\n    left: 0.25rem\n}\n.univer-left-1\\.5 {\n    left: 0.375rem\n}\n.univer-left-1\\/2 {\n    left: 50%\n}\n.univer-left-2 {\n    left: 0.5rem\n}\n.univer-right-0 {\n    right: 0px\n}\n.univer-right-1\\.5 {\n    right: 0.375rem\n}\n.univer-right-2 {\n    right: 0.5rem\n}\n.univer-top-0 {\n    top: 0px\n}\n.univer-top-0\\.5 {\n    top: 0.125rem\n}\n.univer-top-1\\/2 {\n    top: 50%\n}\n.univer-top-4 {\n    top: 1rem\n}\n.univer-top-\\[-99999px\\] {\n    top: -99999px\n}\n.univer-z-10 {\n    z-index: 10\n}\n.univer-z-50 {\n    z-index: 50\n}\n.univer-z-\\[-1\\] {\n    z-index: -1\n}\n.univer-z-\\[1001\\] {\n    z-index: 1001\n}\n.univer-z-\\[100\\] {\n    z-index: 100\n}\n.univer-z-\\[1080\\] {\n    z-index: 1080\n}\n.univer-z-\\[1\\] {\n    z-index: 1\n}\n.univer-m-0 {\n    margin: 0px\n}\n.-univer-mx-1 {\n    margin-left: -0.25rem;\n    margin-right: -0.25rem\n}\n.univer-mx-auto {\n    margin-left: auto;\n    margin-right: auto\n}\n.univer-my-1 {\n    margin-top: 0.25rem;\n    margin-bottom: 0.25rem\n}\n.univer-mb-2 {\n    margin-bottom: 0.5rem\n}\n.univer-mb-4 {\n    margin-bottom: 1rem\n}\n.univer-ml-auto {\n    margin-left: auto\n}\n.univer-mr-2 {\n    margin-right: 0.5rem\n}\n.univer-box-border {\n    box-sizing: border-box\n}\n.univer-line-clamp-1 {\n    overflow: hidden;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    -webkit-line-clamp: 1\n}\n.univer-block {\n    display: block\n}\n.univer-flex {\n    display: flex\n}\n.univer-inline-flex {\n    display: inline-flex\n}\n.univer-grid {\n    display: grid\n}\n.univer-hidden {\n    display: none\n}\n.univer-size-0 {\n    width: 0px;\n    height: 0px\n}\n.univer-size-2 {\n    width: 0.5rem;\n    height: 0.5rem\n}\n.univer-size-2\\.5 {\n    width: 0.625rem;\n    height: 0.625rem\n}\n.univer-size-4 {\n    width: 1rem;\n    height: 1rem\n}\n.univer-size-5 {\n    width: 1.25rem;\n    height: 1.25rem\n}\n.univer-size-6 {\n    width: 1.5rem;\n    height: 1.5rem\n}\n.univer-size-full {\n    width: 100%;\n    height: 100%\n}\n.\\!univer-h-5 {\n    height: 1.25rem !important\n}\n.univer-h-0 {\n    height: 0px\n}\n.univer-h-0\\.5 {\n    height: 0.125rem\n}\n.univer-h-10 {\n    height: 2.5rem\n}\n.univer-h-12 {\n    height: 3rem\n}\n.univer-h-2 {\n    height: 0.5rem\n}\n.univer-h-3\\.5 {\n    height: 0.875rem\n}\n.univer-h-48 {\n    height: 12rem\n}\n.univer-h-5 {\n    height: 1.25rem\n}\n.univer-h-6 {\n    height: 1.5rem\n}\n.univer-h-7 {\n    height: 1.75rem\n}\n.univer-h-8 {\n    height: 2rem\n}\n.univer-h-\\[148px\\] {\n    height: 148px\n}\n.univer-h-full {\n    height: 100%\n}\n.univer-h-px {\n    height: 1px\n}\n.univer-max-h-\\[360px\\] {\n    max-height: 360px\n}\n.univer-max-h-\\[var\\(--radix-popper-available-height\\)\\] {\n    max-height: var(--radix-popper-available-height)\n}\n.univer-min-h-full {\n    min-height: 100%\n}\n.univer-w-0 {\n    width: 0px\n}\n.univer-w-0\\.5 {\n    width: 0.125rem\n}\n.univer-w-14 {\n    width: 3.5rem\n}\n.univer-w-24 {\n    width: 6rem\n}\n.univer-w-3\\.5 {\n    width: 0.875rem\n}\n.univer-w-32 {\n    width: 8rem\n}\n.univer-w-5 {\n    width: 1.25rem\n}\n.univer-w-72 {\n    width: 18rem\n}\n.univer-w-96 {\n    width: 24rem\n}\n.univer-w-\\[220px\\] {\n    width: 220px\n}\n.univer-w-\\[292px\\] {\n    width: 292px\n}\n.univer-w-\\[300px\\] {\n    width: 300px\n}\n.univer-w-\\[50\\%\\] {\n    width: 50%\n}\n.univer-w-\\[55px\\] {\n    width: 55px\n}\n.univer-w-auto {\n    width: auto\n}\n.univer-w-fit {\n    width: -moz-fit-content;\n    width: fit-content\n}\n.univer-w-full {\n    width: 100%\n}\n.univer-min-w-6 {\n    min-width: 1.5rem\n}\n.univer-min-w-\\[260px\\] {\n    min-width: 260px\n}\n.univer-min-w-\\[320px\\] {\n    min-width: 320px\n}\n.univer-max-w-\\[480px\\] {\n    max-width: 480px\n}\n.univer-max-w-\\[var\\(--radix-popper-available-width\\)\\] {\n    max-width: var(--radix-popper-available-width)\n}\n.univer-flex-1 {\n    flex: 1 1 0%\n}\n.univer-flex-shrink-0 {\n    flex-shrink: 0\n}\n.univer-shrink-0 {\n    flex-shrink: 0\n}\n.-univer-translate-x-1\\/2 {\n    --tw-translate-x: -50%;\n    transform: translate(-50%, var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))\n}\n.-univer-translate-y-1\\/2 {\n    --tw-translate-y: -50%;\n    transform: translate(var(--tw-translate-x), -50%) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))\n}\n.univer-translate-x-0 {\n    --tw-translate-x: 0px;\n    transform: translate(0px, var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))\n}\n.univer-translate-x-full {\n    --tw-translate-x: 100%;\n    transform: translate(100%, var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))\n}\n.univer-translate-y-1\\.5 {\n    --tw-translate-y: 0.375rem;\n    transform: translate(var(--tw-translate-x), 0.375rem) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))\n}\n.univer-translate-y-\\[calc\\(-50\\%_-_2px\\)\\] {\n    --tw-translate-y: calc(-50% - 2px);\n    transform: translate(var(--tw-translate-x), calc(-50% - 2px)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))\n}\n.univer-rotate-45 {\n    --tw-rotate: 45deg;\n    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(45deg) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))\n}\n@keyframes univer-spin {\n    to {\n        transform: rotate(360deg)\n    }\n}\n.univer-animate-spin {\n    animation: univer-spin 1s linear infinite\n}\n.univer-cursor-crosshair {\n    cursor: crosshair\n}\n.univer-cursor-default {\n    cursor: default\n}\n.univer-cursor-not-allowed {\n    cursor: not-allowed\n}\n.univer-cursor-pointer {\n    cursor: pointer\n}\n.univer-select-none {\n    -webkit-user-select: none;\n       -moz-user-select: none;\n            user-select: none\n}\n.univer-list-none {\n    list-style-type: none\n}\n.univer-appearance-none {\n    -webkit-appearance: none;\n       -moz-appearance: none;\n            appearance: none\n}\n.univer-grid-flow-col {\n    grid-auto-flow: column\n}\n.univer-grid-cols-5 {\n    grid-template-columns: repeat(5, minmax(0, 1fr))\n}\n.univer-grid-cols-8 {\n    grid-template-columns: repeat(8, minmax(0, 1fr))\n}\n.univer-grid-rows-\\[auto_1fr_auto\\] {\n    grid-template-rows: auto 1fr auto\n}\n.univer-flex-col {\n    flex-direction: column\n}\n.univer-flex-wrap {\n    flex-wrap: wrap\n}\n.univer-flex-nowrap {\n    flex-wrap: nowrap\n}\n.univer-content-center {\n    align-content: center\n}\n.univer-items-start {\n    align-items: flex-start\n}\n.univer-items-center {\n    align-items: center\n}\n.univer-justify-center {\n    justify-content: center\n}\n.univer-justify-between {\n    justify-content: space-between\n}\n.univer-justify-around {\n    justify-content: space-around\n}\n.univer-gap-1 {\n    gap: 0.25rem\n}\n.univer-gap-2 {\n    gap: 0.5rem\n}\n.univer-gap-3 {\n    gap: 0.75rem\n}\n.univer-gap-4 {\n    gap: 1rem\n}\n.univer-gap-6 {\n    gap: 1.5rem\n}\n.univer-gap-x-2 {\n    -moz-column-gap: 0.5rem;\n         column-gap: 0.5rem\n}\n.univer-gap-y-3 {\n    row-gap: 0.75rem\n}\n.univer-space-x-2 > :not([hidden]) ~ :not([hidden]) {\n    --tw-space-x-reverse: 0;\n    margin-right: calc(0.5rem * 0);\n    margin-right: calc(0.5rem * var(--tw-space-x-reverse));\n    margin-left: calc(0.5rem * (1 - 0));\n    margin-left: calc(0.5rem * (1 - var(--tw-space-x-reverse)));\n    margin-left: calc(0.5rem * calc(1 - 0));\n    margin-left: calc(0.5rem * calc(1 - var(--tw-space-x-reverse)))\n}\n.univer-space-y-4 > :not([hidden]) ~ :not([hidden]) {\n    --tw-space-y-reverse: 0;\n    margin-top: calc(1rem * (1 - 0));\n    margin-top: calc(1rem * (1 - var(--tw-space-y-reverse)));\n    margin-top: calc(1rem * calc(1 - 0));\n    margin-top: calc(1rem * calc(1 - var(--tw-space-y-reverse)));\n    margin-bottom: calc(1rem * 0);\n    margin-bottom: calc(1rem * var(--tw-space-y-reverse))\n}\n.univer-self-baseline {\n    align-self: baseline\n}\n.univer-justify-self-center {\n    justify-self: center\n}\n.univer-overflow-hidden {\n    overflow: hidden\n}\n.univer-overflow-y-auto {\n    overflow-y: auto\n}\n.univer-truncate {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap\n}\n.univer-text-ellipsis {\n    text-overflow: ellipsis\n}\n.univer-whitespace-nowrap {\n    white-space: nowrap\n}\n.univer-text-balance {\n    text-wrap: balance\n}\n.univer-rounded {\n    border-radius: 0.25rem\n}\n.univer-rounded-\\[2px\\] {\n    border-radius: 2px\n}\n.univer-rounded-full {\n    border-radius: 9999px\n}\n.univer-rounded-lg {\n    border-radius: 0.5rem\n}\n.univer-rounded-md {\n    border-radius: 0.375rem\n}\n.univer-rounded-xl {\n    border-radius: 0.75rem\n}\n.univer-rounded-l {\n    border-top-left-radius: 0.25rem;\n    border-bottom-left-radius: 0.25rem\n}\n.univer-rounded-r {\n    border-top-right-radius: 0.25rem;\n    border-bottom-right-radius: 0.25rem\n}\n.univer-border {\n    border-width: 1px\n}\n.univer-border-0 {\n    border-width: 0px\n}\n.univer-border-2 {\n    border-width: 2px\n}\n.univer-border-b {\n    border-bottom-width: 1px\n}\n.univer-border-l {\n    border-left-width: 1px\n}\n.univer-border-r {\n    border-right-width: 1px\n}\n.univer-border-solid {\n    border-style: solid\n}\n.univer-border-none {\n    border-style: none\n}\n.\\!univer-border-gray-200 {\n    --tw-border-opacity: 1 !important;\n    border-color: rgba(227, 229, 234, 1) !important;\n    border-color: rgba(227, 229, 234, var(--tw-border-opacity, 1)) !important\n}\n.univer-border-gray-100 {\n    --tw-border-opacity: 1;\n    border-color: rgba(238, 239, 241, 1);\n    border-color: rgba(238, 239, 241, var(--tw-border-opacity, 1))\n}\n.univer-border-gray-200 {\n    --tw-border-opacity: 1;\n    border-color: rgba(227, 229, 234, 1);\n    border-color: rgba(227, 229, 234, var(--tw-border-opacity, 1))\n}\n.univer-border-gray-300 {\n    --tw-border-opacity: 1;\n    border-color: rgba(205, 208, 216, 1);\n    border-color: rgba(205, 208, 216, var(--tw-border-opacity, 1))\n}\n.univer-border-transparent {\n    border-color: transparent\n}\n.univer-border-white {\n    --tw-border-opacity: 1;\n    border-color: rgba(255, 255, 255, 1);\n    border-color: rgba(255, 255, 255, var(--tw-border-opacity, 1))\n}\n.univer-border-b-gray-200 {\n    --tw-border-opacity: 1;\n    border-bottom-color: rgba(227, 229, 234, 1);\n    border-bottom-color: rgba(227, 229, 234, var(--tw-border-opacity, 1))\n}\n.univer-border-r-gray-200 {\n    --tw-border-opacity: 1;\n    border-right-color: rgba(227, 229, 234, 1);\n    border-right-color: rgba(227, 229, 234, var(--tw-border-opacity, 1))\n}\n.\\!univer-bg-gray-200 {\n    --tw-bg-opacity: 1 !important;\n    background-color: rgba(227, 229, 234, 1) !important;\n    background-color: rgba(227, 229, 234, var(--tw-bg-opacity, 1)) !important\n}\n.\\!univer-bg-primary-500 {\n    --tw-bg-opacity: 1 !important;\n    background-color: rgba(70, 106, 247, 1) !important;\n    background-color: rgba(70, 106, 247, var(--tw-bg-opacity, 1)) !important\n}\n.univer-bg-gray-100 {\n    --tw-bg-opacity: 1;\n    background-color: rgba(238, 239, 241, 1);\n    background-color: rgba(238, 239, 241, var(--tw-bg-opacity, 1))\n}\n.univer-bg-gray-200 {\n    --tw-bg-opacity: 1;\n    background-color: rgba(227, 229, 234, 1);\n    background-color: rgba(227, 229, 234, var(--tw-bg-opacity, 1))\n}\n.univer-bg-gray-300 {\n    --tw-bg-opacity: 1;\n    background-color: rgba(205, 208, 216, 1);\n    background-color: rgba(205, 208, 216, var(--tw-bg-opacity, 1))\n}\n.univer-bg-gray-50 {\n    --tw-bg-opacity: 1;\n    background-color: rgba(249, 250, 251, 1);\n    background-color: rgba(249, 250, 251, var(--tw-bg-opacity, 1))\n}\n.univer-bg-gray-700 {\n    --tw-bg-opacity: 1;\n    background-color: rgba(44, 48, 64, 1);\n    background-color: rgba(44, 48, 64, var(--tw-bg-opacity, 1))\n}\n.univer-bg-primary-500 {\n    --tw-bg-opacity: 1;\n    background-color: rgba(70, 106, 247, 1);\n    background-color: rgba(70, 106, 247, var(--tw-bg-opacity, 1))\n}\n.univer-bg-transparent {\n    background-color: transparent\n}\n.univer-bg-white {\n    --tw-bg-opacity: 1;\n    background-color: rgba(255, 255, 255, 1);\n    background-color: rgba(255, 255, 255, var(--tw-bg-opacity, 1))\n}\n.univer-fill-current {\n    fill: currentColor\n}\n.univer-fill-gray-700 {\n    fill: #2C3040\n}\n.univer-p-0 {\n    padding: 0px\n}\n.univer-p-1 {\n    padding: 0.25rem\n}\n.univer-p-1\\.5 {\n    padding: 0.375rem\n}\n.univer-p-2 {\n    padding: 0.5rem\n}\n.univer-p-4 {\n    padding: 1rem\n}\n.univer-px-1 {\n    padding-left: 0.25rem;\n    padding-right: 0.25rem\n}\n.univer-px-1\\.5 {\n    padding-left: 0.375rem;\n    padding-right: 0.375rem\n}\n.univer-px-12 {\n    padding-left: 3rem;\n    padding-right: 3rem\n}\n.univer-px-2 {\n    padding-left: 0.5rem;\n    padding-right: 0.5rem\n}\n.univer-px-3 {\n    padding-left: 0.75rem;\n    padding-right: 0.75rem\n}\n.univer-px-4 {\n    padding-left: 1rem;\n    padding-right: 1rem\n}\n.univer-px-5 {\n    padding-left: 1.25rem;\n    padding-right: 1.25rem\n}\n.univer-py-0\\.5 {\n    padding-top: 0.125rem;\n    padding-bottom: 0.125rem\n}\n.univer-py-1 {\n    padding-top: 0.25rem;\n    padding-bottom: 0.25rem\n}\n.univer-py-1\\.5 {\n    padding-top: 0.375rem;\n    padding-bottom: 0.375rem\n}\n.univer-py-2 {\n    padding-top: 0.5rem;\n    padding-bottom: 0.5rem\n}\n.univer-py-2\\.5 {\n    padding-top: 0.625rem;\n    padding-bottom: 0.625rem\n}\n.univer-py-6 {\n    padding-top: 1.5rem;\n    padding-bottom: 1.5rem\n}\n.\\!univer-pl-4 {\n    padding-left: 1rem !important\n}\n.\\!univer-pr-5 {\n    padding-right: 1.25rem !important\n}\n.univer-pb-2 {\n    padding-bottom: 0.5rem\n}\n.univer-pl-6 {\n    padding-left: 1.5rem\n}\n.univer-pl-8 {\n    padding-left: 2rem\n}\n.univer-pr-2 {\n    padding-right: 0.5rem\n}\n.univer-pr-5 {\n    padding-right: 1.25rem\n}\n.univer-pr-8 {\n    padding-right: 2rem\n}\n.univer-text-center {\n    text-align: center\n}\n.univer-text-right {\n    text-align: right\n}\n.univer-font-sans {\n    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"\n}\n.univer-text-\\[10px\\] {\n    font-size: 10px\n}\n.univer-text-\\[13px\\] {\n    font-size: 13px\n}\n.univer-text-base {\n    font-size: 1rem;\n    line-height: 1.5rem\n}\n.univer-text-lg {\n    font-size: 1.125rem;\n    line-height: 1.75rem\n}\n.univer-text-sm {\n    font-size: 0.875rem;\n    line-height: 1.25rem\n}\n.univer-text-xs {\n    font-size: 0.75rem;\n    line-height: 1rem\n}\n.univer-font-medium {\n    font-weight: 500\n}\n.univer-font-semibold {\n    font-weight: 600\n}\n.univer-uppercase {\n    text-transform: uppercase\n}\n.univer-tracking-widest {\n    letter-spacing: 0.1em\n}\n.univer-text-blue-500 {\n    --tw-text-opacity: 1;\n    color: rgba(63, 131, 248, 1);\n    color: rgba(63, 131, 248, var(--tw-text-opacity, 1))\n}\n.univer-text-cyan-700 {\n    --tw-text-opacity: 1;\n    color: rgba(14, 116, 144, 1);\n    color: rgba(14, 116, 144, var(--tw-text-opacity, 1))\n}\n.univer-text-gray-100 {\n    --tw-text-opacity: 1;\n    color: rgba(238, 239, 241, 1);\n    color: rgba(238, 239, 241, var(--tw-text-opacity, 1))\n}\n.univer-text-gray-200 {\n    --tw-text-opacity: 1;\n    color: rgba(227, 229, 234, 1);\n    color: rgba(227, 229, 234, var(--tw-text-opacity, 1))\n}\n.univer-text-gray-300 {\n    --tw-text-opacity: 1;\n    color: rgba(205, 208, 216, 1);\n    color: rgba(205, 208, 216, var(--tw-text-opacity, 1))\n}\n.univer-text-gray-400 {\n    --tw-text-opacity: 1;\n    color: rgba(151, 157, 172, 1);\n    color: rgba(151, 157, 172, var(--tw-text-opacity, 1))\n}\n.univer-text-gray-500 {\n    --tw-text-opacity: 1;\n    color: rgba(95, 101, 116, 1);\n    color: rgba(95, 101, 116, var(--tw-text-opacity, 1))\n}\n.univer-text-gray-600 {\n    --tw-text-opacity: 1;\n    color: rgba(65, 70, 87, 1);\n    color: rgba(65, 70, 87, var(--tw-text-opacity, 1))\n}\n.univer-text-gray-700 {\n    --tw-text-opacity: 1;\n    color: rgba(44, 48, 64, 1);\n    color: rgba(44, 48, 64, var(--tw-text-opacity, 1))\n}\n.univer-text-gray-800 {\n    --tw-text-opacity: 1;\n    color: rgba(24, 28, 42, 1);\n    color: rgba(24, 28, 42, var(--tw-text-opacity, 1))\n}\n.univer-text-gray-900 {\n    --tw-text-opacity: 1;\n    color: rgba(14, 17, 30, 1);\n    color: rgba(14, 17, 30, var(--tw-text-opacity, 1))\n}\n.univer-text-green-500 {\n    --tw-text-opacity: 1;\n    color: rgba(13, 164, 113, 1);\n    color: rgba(13, 164, 113, var(--tw-text-opacity, 1))\n}\n.univer-text-indigo-600 {\n    --tw-text-opacity: 1;\n    color: rgba(44, 83, 241, 1);\n    color: rgba(44, 83, 241, var(--tw-text-opacity, 1))\n}\n.univer-text-primary-600 {\n    --tw-text-opacity: 1;\n    color: rgba(44, 83, 241, 1);\n    color: rgba(44, 83, 241, var(--tw-text-opacity, 1))\n}\n.univer-text-red-500 {\n    --tw-text-opacity: 1;\n    color: rgba(240, 82, 82, 1);\n    color: rgba(240, 82, 82, var(--tw-text-opacity, 1))\n}\n.univer-text-white {\n    --tw-text-opacity: 1;\n    color: rgba(255, 255, 255, 1);\n    color: rgba(255, 255, 255, var(--tw-text-opacity, 1))\n}\n.univer-text-yellow-400 {\n    --tw-text-opacity: 1;\n    color: rgba(241, 179, 18, 1);\n    color: rgba(241, 179, 18, var(--tw-text-opacity, 1))\n}\n.univer-underline {\n    text-decoration-line: underline\n}\n.univer-opacity-100 {\n    opacity: 1\n}\n.univer-opacity-50 {\n    opacity: 0.5\n}\n.univer-opacity-60 {\n    opacity: 0.6\n}\n.univer-opacity-90 {\n    opacity: 0.9\n}\n.univer-shadow-\\[0_0_10px_0_rgba\\(0\\,0\\,0\\,0\\.1\\)\\] {\n    --tw-shadow: 0 0 10px 0 rgba(0,0,0,0.1);\n    --tw-shadow-colored: 0 0 10px 0 var(--tw-shadow-color);\n    box-shadow: 0 0 rgba(0,0,0,0), 0 0 rgba(0,0,0,0), 0 0 10px 0 rgba(0,0,0,0.1);\n    box-shadow: var(--tw-ring-offset-shadow, 0 0 rgba(0,0,0,0)), var(--tw-ring-shadow, 0 0 rgba(0,0,0,0)), var(--tw-shadow)\n}\n.univer-shadow-\\[0_1px_6px_-2px_rgba\\(30\\,40\\,77\\,0\\.08\\)\\,0_2px_6px_-1px_rgba\\(30\\,40\\,77\\,0\\.10\\)\\] {\n    --tw-shadow: 0 1px 6px -2px rgba(30,40,77,0.08),0 2px 6px -1px rgba(30,40,77,0.10);\n    --tw-shadow-colored: 0 1px 6px -2px var(--tw-shadow-color), 0 2px 6px -1px var(--tw-shadow-color);\n    box-shadow: 0 0 rgba(0,0,0,0), 0 0 rgba(0,0,0,0), 0 1px 6px -2px rgba(30,40,77,0.08),0 2px 6px -1px rgba(30,40,77,0.10);\n    box-shadow: var(--tw-ring-offset-shadow, 0 0 rgba(0,0,0,0)), var(--tw-ring-shadow, 0 0 rgba(0,0,0,0)), var(--tw-shadow)\n}\n.univer-shadow-inner {\n    --tw-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.05);\n    --tw-shadow-colored: inset 0 2px 4px 0 var(--tw-shadow-color);\n    box-shadow: 0 0 rgba(0,0,0,0), 0 0 rgba(0,0,0,0), inset 0 2px 4px 0 rgba(0, 0, 0, 0.05);\n    box-shadow: var(--tw-ring-offset-shadow, 0 0 rgba(0,0,0,0)), var(--tw-ring-shadow, 0 0 rgba(0,0,0,0)), var(--tw-shadow)\n}\n.univer-shadow-md {\n    --tw-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);\n    --tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);\n    box-shadow: 0 0 rgba(0,0,0,0), 0 0 rgba(0,0,0,0), 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);\n    box-shadow: var(--tw-ring-offset-shadow, 0 0 rgba(0,0,0,0)), var(--tw-ring-shadow, 0 0 rgba(0,0,0,0)), var(--tw-shadow)\n}\n.univer-shadow-sm {\n    --tw-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n    --tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);\n    box-shadow: 0 0 rgba(0,0,0,0), 0 0 rgba(0,0,0,0), 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n    box-shadow: var(--tw-ring-offset-shadow, 0 0 rgba(0,0,0,0)), var(--tw-ring-shadow, 0 0 rgba(0,0,0,0)), var(--tw-shadow)\n}\n.univer-outline-none {\n    outline: 2px solid transparent;\n    outline-offset: 2px\n}\n.univer-ring-2 {\n    --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);\n    --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);\n    box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), 0 0 rgba(0,0,0,0);\n    box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 rgba(0,0,0,0))\n}\n.univer-ring-\\[1\\.5px\\] {\n    --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);\n    --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1.5px + var(--tw-ring-offset-width)) var(--tw-ring-color);\n    box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), 0 0 rgba(0,0,0,0);\n    box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 rgba(0,0,0,0))\n}\n.univer-ring-primary-600 {\n    --tw-ring-opacity: 1;\n    --tw-ring-color: rgba(44, 83, 241, var(--tw-ring-opacity, 1))\n}\n.univer-ring-white {\n    --tw-ring-opacity: 1;\n    --tw-ring-color: rgba(255, 255, 255, var(--tw-ring-opacity, 1))\n}\n.univer-ring-offset-1 {\n    --tw-ring-offset-width: 1px\n}\n.univer-ring-offset-2 {\n    --tw-ring-offset-width: 2px\n}\n.univer-ring-offset-gray-600 {\n    --tw-ring-offset-color: #414657\n}\n.univer-ring-offset-white {\n    --tw-ring-offset-color: #fff\n}\n.univer-transition-all {\n    transition-property: all;\n    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n    transition-duration: 150ms\n}\n.univer-transition-colors {\n    transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;\n    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n    transition-duration: 150ms\n}\n.univer-transition-shadow {\n    transition-property: box-shadow;\n    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n    transition-duration: 150ms\n}\n.univer-transition-transform {\n    transition-property: transform;\n    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n    transition-duration: 150ms\n}\n.univer-duration-200 {\n    transition-duration: 200ms\n}\n.univer-duration-300 {\n    transition-duration: 300ms\n}\n.univer-duration-75 {\n    transition-duration: 75ms\n}\n.univer-will-change-transform {\n    will-change: transform\n}\n.univer-scrollbar-thin::-webkit-scrollbar-track {\n    background-color: var(--scrollbar-track);\n    border-radius: var(--scrollbar-track-radius)\n}\n.univer-scrollbar-thin::-webkit-scrollbar-track:hover {\n    background-color: var(--scrollbar-track-hover, var(--scrollbar-track))\n}\n.univer-scrollbar-thin::-webkit-scrollbar-track:active {\n    background-color: var(--scrollbar-track-active, var(--scrollbar-track-hover, var(--scrollbar-track)))\n}\n.univer-scrollbar-thin::-webkit-scrollbar-thumb {\n    background-color: var(--scrollbar-thumb);\n    border-radius: var(--scrollbar-thumb-radius)\n}\n.univer-scrollbar-thin::-webkit-scrollbar-thumb:hover {\n    background-color: var(--scrollbar-thumb-hover, var(--scrollbar-thumb))\n}\n.univer-scrollbar-thin::-webkit-scrollbar-thumb:active {\n    background-color: var(--scrollbar-thumb-active, var(--scrollbar-thumb-hover, var(--scrollbar-thumb)))\n}\n.univer-scrollbar-thin::-webkit-scrollbar-corner {\n    background-color: var(--scrollbar-corner);\n    border-radius: var(--scrollbar-corner-radius)\n}\n.univer-scrollbar-thin::-webkit-scrollbar-corner:hover {\n    background-color: var(--scrollbar-corner-hover, var(--scrollbar-corner))\n}\n.univer-scrollbar-thin::-webkit-scrollbar-corner:active {\n    background-color: var(--scrollbar-corner-active, var(--scrollbar-corner-hover, var(--scrollbar-corner)))\n}\n.univer-scrollbar-thin {\n    scrollbar-width: thin;\n    scrollbar-color: initial initial;\n    scrollbar-color: var(--scrollbar-thumb, initial) var(--scrollbar-track, initial)\n}\n.univer-scrollbar-thin::-webkit-scrollbar {\n    display: block;\n    width: 8px;\n    height: 8px\n}\n.univer-scrollbar-track-gray-50 {\n    --scrollbar-track: #F9FAFB !important\n}\n.univer-scrollbar-track-transparent {\n    --scrollbar-track: transparent !important\n}\n.univer-scrollbar-thumb-gray-300 {\n    --scrollbar-thumb: #CDD0D8 !important\n}\n@keyframes enter {\n    from {\n        opacity: 1;\n        opacity: var(--tw-enter-opacity, 1);\n        transform: translate3d(0, 0, 0) scale3d(1, 1, 1) rotate(0);\n        transform: translate3d(var(--tw-enter-translate-x, 0), var(--tw-enter-translate-y, 0), 0) scale3d(var(--tw-enter-scale, 1), var(--tw-enter-scale, 1), var(--tw-enter-scale, 1)) rotate(var(--tw-enter-rotate, 0))\n    }\n}\n@keyframes exit {\n    to {\n        opacity: 1;\n        opacity: var(--tw-exit-opacity, 1);\n        transform: translate3d(0, 0, 0) scale3d(1, 1, 1) rotate(0);\n        transform: translate3d(var(--tw-exit-translate-x, 0), var(--tw-exit-translate-y, 0), 0) scale3d(var(--tw-exit-scale, 1), var(--tw-exit-scale, 1), var(--tw-exit-scale, 1)) rotate(var(--tw-exit-rotate, 0))\n    }\n}\n.univer-animate-in {\n    animation-name: enter;\n    animation-duration: 150ms;\n    --tw-enter-opacity: initial;\n    --tw-enter-scale: initial;\n    --tw-enter-rotate: initial;\n    --tw-enter-translate-x: initial;\n    --tw-enter-translate-y: initial\n}\n.univer-fade-in {\n    --tw-enter-opacity: 0\n}\n.univer-fade-in-0 {\n    --tw-enter-opacity: 0\n}\n.univer-zoom-in-95 {\n    --tw-enter-scale: .95\n}\n.univer-slide-in-from-top-4 {\n    --tw-enter-translate-y: -1rem\n}\n.univer-slide-in-from-top-full {\n    --tw-enter-translate-y: -100%\n}\n.univer-duration-200 {\n    animation-duration: 200ms\n}\n.univer-duration-300 {\n    animation-duration: 300ms\n}\n.univer-duration-75 {\n    animation-duration: 75ms\n}\n.placeholder\\:univer-text-gray-400::-moz-placeholder {\n    --tw-text-opacity: 1;\n    color: rgba(151, 157, 172, 1);\n    color: rgba(151, 157, 172, var(--tw-text-opacity, 1))\n}\n.placeholder\\:univer-text-gray-400::placeholder {\n    --tw-text-opacity: 1;\n    color: rgba(151, 157, 172, 1);\n    color: rgba(151, 157, 172, var(--tw-text-opacity, 1))\n}\n.last\\:univer-border-b-0:last-child {\n    border-bottom-width: 0px\n}\n.data-\\[disabled\\]\\:univer-pointer-events-none[data-disabled] {\n    pointer-events: none\n}\n.data-\\[orientation\\=horizontal\\]\\:univer-h-px[data-orientation="horizontal"] {\n    height: 1px\n}\n.data-\\[orientation\\=vertical\\]\\:univer-h-full[data-orientation="vertical"] {\n    height: 100%\n}\n.data-\\[orientation\\=horizontal\\]\\:univer-w-full[data-orientation="horizontal"] {\n    width: 100%\n}\n.data-\\[orientation\\=vertical\\]\\:univer-w-px[data-orientation="vertical"] {\n    width: 1px\n}\n.data-\\[state\\=open\\]\\:univer-bg-gray-100[data-state="open"] {\n    --tw-bg-opacity: 1;\n    background-color: rgba(238, 239, 241, 1);\n    background-color: rgba(238, 239, 241, var(--tw-bg-opacity, 1))\n}\n.data-\\[disabled\\]\\:univer-opacity-50[data-disabled] {\n    opacity: 0.5\n}\n.data-\\[state\\=open\\]\\:univer-animate-in[data-state="open"] {\n    animation-name: enter;\n    animation-duration: 150ms;\n    --tw-enter-opacity: initial;\n    --tw-enter-scale: initial;\n    --tw-enter-rotate: initial;\n    --tw-enter-translate-x: initial;\n    --tw-enter-translate-y: initial\n}\n.data-\\[state\\=closed\\]\\:univer-animate-out[data-state="closed"] {\n    animation-name: exit;\n    animation-duration: 150ms;\n    --tw-exit-opacity: initial;\n    --tw-exit-scale: initial;\n    --tw-exit-rotate: initial;\n    --tw-exit-translate-x: initial;\n    --tw-exit-translate-y: initial\n}\n.data-\\[state\\=closed\\]\\:univer-fade-out-0[data-state="closed"] {\n    --tw-exit-opacity: 0\n}\n.data-\\[state\\=open\\]\\:univer-fade-in-0[data-state="open"] {\n    --tw-enter-opacity: 0\n}\n.data-\\[state\\=closed\\]\\:univer-zoom-out-95[data-state="closed"] {\n    --tw-exit-scale: .95\n}\n.data-\\[state\\=open\\]\\:univer-zoom-in-95[data-state="open"] {\n    --tw-enter-scale: .95\n}\n.data-\\[side\\=bottom\\]\\:univer-slide-in-from-top-2[data-side="bottom"] {\n    --tw-enter-translate-y: -0.5rem\n}\n.data-\\[side\\=left\\]\\:univer-slide-in-from-right-2[data-side="left"] {\n    --tw-enter-translate-x: 0.5rem\n}\n.data-\\[side\\=right\\]\\:univer-slide-in-from-left-2[data-side="right"] {\n    --tw-enter-translate-x: -0.5rem\n}\n.data-\\[side\\=top\\]\\:univer-slide-in-from-bottom-2[data-side="top"] {\n    --tw-enter-translate-y: 0.5rem\n}\n.hover\\:\\!univer-bg-primary-500:hover {\n    --tw-bg-opacity: 1 !important;\n    background-color: rgba(70, 106, 247, 1) !important;\n    background-color: rgba(70, 106, 247, var(--tw-bg-opacity, 1)) !important\n}\n.hover\\:univer-bg-gray-100:hover {\n    --tw-bg-opacity: 1;\n    background-color: rgba(238, 239, 241, 1);\n    background-color: rgba(238, 239, 241, var(--tw-bg-opacity, 1))\n}\n.hover\\:univer-bg-gray-200:hover {\n    --tw-bg-opacity: 1;\n    background-color: rgba(227, 229, 234, 1);\n    background-color: rgba(227, 229, 234, var(--tw-bg-opacity, 1))\n}\n.hover\\:univer-bg-gray-300:hover {\n    --tw-bg-opacity: 1;\n    background-color: rgba(205, 208, 216, 1);\n    background-color: rgba(205, 208, 216, var(--tw-bg-opacity, 1))\n}\n.hover\\:univer-bg-neutral-100:hover {\n    --tw-bg-opacity: 1;\n    background-color: rgba(245, 245, 245, 1);\n    background-color: rgba(245, 245, 245, var(--tw-bg-opacity, 1))\n}\n.hover\\:univer-bg-transparent:hover {\n    background-color: transparent\n}\n.hover\\:univer-text-gray-500:hover {\n    --tw-text-opacity: 1;\n    color: rgba(95, 101, 116, 1);\n    color: rgba(95, 101, 116, var(--tw-text-opacity, 1))\n}\n.hover\\:univer-text-gray-900:hover {\n    --tw-text-opacity: 1;\n    color: rgba(14, 17, 30, 1);\n    color: rgba(14, 17, 30, var(--tw-text-opacity, 1))\n}\n.hover\\:univer-ring-\\[1\\.5px\\]:hover {\n    --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);\n    --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1.5px + var(--tw-ring-offset-width)) var(--tw-ring-color);\n    box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), 0 0 rgba(0,0,0,0);\n    box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 rgba(0,0,0,0))\n}\n.hover\\:univer-ring-primary-600:hover {\n    --tw-ring-opacity: 1;\n    --tw-ring-color: rgba(44, 83, 241, var(--tw-ring-opacity, 1))\n}\n.hover\\:univer-ring-primary-600\\/40:hover {\n    --tw-ring-color: rgba(44, 83, 241, 0.4)\n}\n.focus\\:univer-border-blue-500:focus {\n    --tw-border-opacity: 1;\n    border-color: rgba(63, 131, 248, 1);\n    border-color: rgba(63, 131, 248, var(--tw-border-opacity, 1))\n}\n.focus\\:univer-bg-gray-100:focus {\n    --tw-bg-opacity: 1;\n    background-color: rgba(238, 239, 241, 1);\n    background-color: rgba(238, 239, 241, var(--tw-bg-opacity, 1))\n}\n.focus\\:univer-bg-white:focus {\n    --tw-bg-opacity: 1;\n    background-color: rgba(255, 255, 255, 1);\n    background-color: rgba(255, 255, 255, var(--tw-bg-opacity, 1))\n}\n.focus\\:univer-outline-none:focus {\n    outline: 2px solid transparent;\n    outline-offset: 2px\n}\n.focus\\:univer-ring-2:focus {\n    --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);\n    --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);\n    box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), 0 0 rgba(0,0,0,0);\n    box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 rgba(0,0,0,0))\n}\n.focus\\:univer-ring-blue-500\\/20:focus {\n    --tw-ring-color: rgba(63, 131, 248, 0.2)\n}\n.focus-visible\\:univer-outline-none:focus-visible {\n    outline: 2px solid transparent;\n    outline-offset: 2px\n}\n.dark\\:univer-border-gray-600:where(.univer-dark, .univer-dark *) {\n    --tw-border-opacity: 1;\n    border-color: rgba(65, 70, 87, 1);\n    border-color: rgba(65, 70, 87, var(--tw-border-opacity, 1))\n}\n.dark\\:univer-border-gray-700:where(.univer-dark, .univer-dark *) {\n    --tw-border-opacity: 1;\n    border-color: rgba(44, 48, 64, 1);\n    border-color: rgba(44, 48, 64, var(--tw-border-opacity, 1))\n}\n.dark\\:univer-bg-gray-700:where(.univer-dark, .univer-dark *) {\n    --tw-bg-opacity: 1;\n    background-color: rgba(44, 48, 64, 1);\n    background-color: rgba(44, 48, 64, var(--tw-bg-opacity, 1))\n}\n.dark\\:univer-bg-gray-900:where(.univer-dark, .univer-dark *) {\n    --tw-bg-opacity: 1;\n    background-color: rgba(14, 17, 30, 1);\n    background-color: rgba(14, 17, 30, var(--tw-bg-opacity, 1))\n}\n.dark\\:univer-text-gray-200:where(.univer-dark, .univer-dark *) {\n    --tw-text-opacity: 1;\n    color: rgba(227, 229, 234, 1);\n    color: rgba(227, 229, 234, var(--tw-text-opacity, 1))\n}\n.dark\\:univer-text-gray-400:where(.univer-dark, .univer-dark *) {\n    --tw-text-opacity: 1;\n    color: rgba(151, 157, 172, 1);\n    color: rgba(151, 157, 172, var(--tw-text-opacity, 1))\n}\n.dark\\:univer-text-primary-500:where(.univer-dark, .univer-dark *) {\n    --tw-text-opacity: 1;\n    color: rgba(70, 106, 247, 1);\n    color: rgba(70, 106, 247, var(--tw-text-opacity, 1))\n}\n.dark\\:univer-text-white:where(.univer-dark, .univer-dark *) {\n    --tw-text-opacity: 1;\n    color: rgba(255, 255, 255, 1);\n    color: rgba(255, 255, 255, var(--tw-text-opacity, 1))\n}\n.dark\\:univer-ring-primary-600:where(.univer-dark, .univer-dark *) {\n    --tw-ring-opacity: 1;\n    --tw-ring-color: rgba(44, 83, 241, var(--tw-ring-opacity, 1))\n}\n.dark\\:univer-ring-offset-gray-600:where(.univer-dark, .univer-dark *) {\n    --tw-ring-offset-color: #414657\n}\n.dark\\:hover\\:univer-bg-gray-600:hover:where(.univer-dark, .univer-dark *) {\n    --tw-bg-opacity: 1;\n    background-color: rgba(65, 70, 87, 1);\n    background-color: rgba(65, 70, 87, var(--tw-bg-opacity, 1))\n}\n.dark\\:focus\\:univer-bg-gray-600:focus:where(.univer-dark, .univer-dark *) {\n    --tw-bg-opacity: 1;\n    background-color: rgba(65, 70, 87, 1);\n    background-color: rgba(65, 70, 87, var(--tw-bg-opacity, 1))\n}\n.\\[\\&\\:disabled\\]\\:univer-cursor-not-allowed:disabled {\n    cursor: not-allowed\n}\n.\\[\\&\\:disabled\\]\\:univer-text-gray-200:disabled {\n    --tw-text-opacity: 1;\n    color: rgba(227, 229, 234, 1);\n    color: rgba(227, 229, 234, var(--tw-text-opacity, 1))\n}\n.\\[\\&\\:disabled\\]\\:hover\\:univer-bg-transparent:hover:disabled {\n    background-color: transparent\n}\n.\\[\\&\\>\\*\\]\\:univer-inline-flex>* {\n    display: inline-flex\n}\n.\\[\\&\\>\\*\\]\\:univer-h-6>* {\n    height: 1.5rem\n}\n.\\[\\&\\>\\*\\]\\:univer-items-center>* {\n    align-items: center\n}\n.\\[\\&\\>\\*\\]\\:univer-rounded>* {\n    border-radius: 0.25rem\n}\n.\\[\\&\\>\\*\\]\\:univer-px-1>* {\n    padding-left: 0.25rem;\n    padding-right: 0.25rem\n}\n.\\[\\&\\>\\*\\]\\:univer-transition-colors>* {\n    transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;\n    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n    transition-duration: 150ms\n}\n.hover\\:\\[\\&\\>\\*\\]\\:univer-bg-gray-300>*:hover {\n    --tw-bg-opacity: 1;\n    background-color: rgba(205, 208, 216, 1);\n    background-color: rgba(205, 208, 216, var(--tw-bg-opacity, 1))\n}\n.\\[\\&\\>a\\]\\:univer-cursor-pointer>a {\n    cursor: pointer\n}\n.\\[\\&\\>a\\]\\:univer-px-2>a {\n    padding-left: 0.5rem;\n    padding-right: 0.5rem\n}\n.\\[\\&\\>a\\]\\:univer-py-1>a {\n    padding-top: 0.25rem;\n    padding-bottom: 0.25rem\n}\n.\\[\\&\\>a\\]\\:univer-text-sm>a {\n    font-size: 0.875rem;\n    line-height: 1.25rem\n}\n.\\[\\&\\>input\\]\\:univer-w-11>input {\n    width: 2.75rem\n}\n.\\[\\&\\>li\\]\\:univer-border-0>li {\n    border-width: 0px\n}\n.\\[\\&\\>li\\]\\:univer-border-b>li {\n    border-bottom-width: 1px\n}\n.\\[\\&\\>li\\]\\:univer-border-solid>li {\n    border-style: solid\n}\n.\\[\\&\\>li\\]\\:univer-border-b-gray-200>li {\n    --tw-border-opacity: 1;\n    border-bottom-color: rgba(227, 229, 234, 1);\n    border-bottom-color: rgba(227, 229, 234, var(--tw-border-opacity, 1))\n}\n.\\[\\&\\>svg\\]\\:univer-relative>svg {\n    position: relative\n}\n.\\[\\&\\>svg\\]\\:univer-top-0\\.5>svg {\n    top: 0.125rem\n}\n.\\[\\&\\>svg\\]\\:univer-block>svg {\n    display: block\n}\n.\\[\\&\\>svg\\]\\:univer-size-4>svg {\n    width: 1rem;\n    height: 1rem\n}\n.\\[\\&\\>svg\\]\\:univer-shrink-0>svg {\n    flex-shrink: 0\n}\n.\\[\\&_a\\]\\:univer-flex a {\n    display: flex\n}\n.\\[\\&_a\\]\\:univer-size-6 a {\n    width: 1.5rem;\n    height: 1.5rem\n}\n.\\[\\&_a\\]\\:univer-cursor-pointer a {\n    cursor: pointer\n}\n.\\[\\&_a\\]\\:univer-items-center a {\n    align-items: center\n}\n.\\[\\&_a\\]\\:univer-justify-center a {\n    justify-content: center\n}\n.\\[\\&_a\\]\\:univer-rounded a {\n    border-radius: 0.25rem\n}\n.\\[\\&_a\\]\\:univer-p-1 a {\n    padding: 0.25rem\n}\n.\\[\\&_input\\]\\:univer-box-border input {\n    box-sizing: border-box\n}\n.\\[\\&_input\\]\\:univer-flex input {\n    display: flex\n}\n.\\[\\&_input\\]\\:univer-h-8 input {\n    height: 2rem\n}\n.\\[\\&_input\\]\\:univer-items-center input {\n    align-items: center\n}\n.\\[\\&_input\\]\\:univer-rounded input {\n    border-radius: 0.25rem\n}\n.\\[\\&_input\\]\\:univer-border input {\n    border-width: 1px\n}\n.\\[\\&_input\\]\\:univer-border-solid input {\n    border-style: solid\n}\n.\\[\\&_input\\]\\:univer-border-gray-200 input {\n    --tw-border-opacity: 1;\n    border-color: rgba(227, 229, 234, 1);\n    border-color: rgba(227, 229, 234, var(--tw-border-opacity, 1))\n}\n.\\[\\&_input\\]\\:univer-bg-transparent input {\n    background-color: transparent\n}\n.\\[\\&_input\\]\\:univer-px-1\\.5 input {\n    padding-left: 0.375rem;\n    padding-right: 0.375rem\n}\n.\\[\\&_input\\]\\:univer-text-sm input {\n    font-size: 0.875rem;\n    line-height: 1.25rem\n}\n.\\[\\&_input\\]\\:univer-text-gray-700 input {\n    --tw-text-opacity: 1;\n    color: rgba(44, 48, 64, 1);\n    color: rgba(44, 48, 64, var(--tw-text-opacity, 1))\n}\n.\\[\\&_input\\]\\:univer-outline-none input {\n    outline: 2px solid transparent;\n    outline-offset: 2px\n}\n.dark\\:\\[\\&_input\\]\\:univer-border-gray-600 input:where(.univer-dark, .univer-dark *) {\n    --tw-border-opacity: 1;\n    border-color: rgba(65, 70, 87, 1);\n    border-color: rgba(65, 70, 87, var(--tw-border-opacity, 1))\n}\n.dark\\:\\[\\&_input\\]\\:univer-text-white input:where(.univer-dark, .univer-dark *) {\n    --tw-text-opacity: 1;\n    color: rgba(255, 255, 255, 1);\n    color: rgba(255, 255, 255, var(--tw-text-opacity, 1))\n}\n.\\[\\&_svg\\]\\:univer-pointer-events-none svg {\n    pointer-events: none\n}\n.\\[\\&_svg\\]\\:univer-size-4 svg {\n    width: 1rem;\n    height: 1rem\n}\n.\\[\\&_svg\\]\\:univer-shrink-0 svg {\n    flex-shrink: 0\n}\n',"",{version:3,sources:["webpack://./../../packages/sheets-ui/src/global.css"],names:[],mappings:"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",sourcesContent:["@tailwind components;\n@tailwind utilities;\n"],sourceRoot:""}]);const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/docs-ui/src/views/count-bar/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-doc-count-bar {\n  display: flex;\n  flex: 0 0 260px;\n  justify-content: flex-end;\n}\n","",{version:3,sources:["webpack://./../../packages/docs-ui/src/views/count-bar/index.module.less"],names:[],mappings:"AAAA;EACI,aAAA;EACA,eAAA;EACA,yBAAA;AACJ",sourcesContent:[".doc-count-bar {\n    display: flex;\n    flex: 0 0 260px;\n    justify-content: flex-end;\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={docCountBar:"univer-doc-count-bar"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/docs-ui/src/views/doc-footer/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-doc-footer-container {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0 var(--padding-xl);\n}\n","",{version:3,sources:["webpack://./../../packages/docs-ui/src/views/doc-footer/index.module.less"],names:[],mappings:"AAAA;EACI,aAAA;EACA,mBAAA;EACA,mBAAA;EACA,8BAAA;EACA,4BAAA;AACJ",sourcesContent:[".doc-footer-container {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-between;\n    padding: 0 var(--padding-xl);\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={docFooterContainer:"univer-doc-footer-container"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/docs-ui/src/views/rich-text-editor/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-rich-text-editor-active {\n  border-color: rgb(var(--hyacinth-500)) !important;\n}\n.univer-rich-text-editor-wrap {\n  height: 32px;\n  padding: 6px 8px 2px 6px;\n  width: 100%;\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  gap: 8px;\n  border: 1px solid rgb(var(--border-color));\n  border-radius: var(--border-radius-base);\n  box-sizing: border-box;\n  position: relative;\n}\n.univer-rich-text-editor-wrap .univer-rich-text-editor-text {\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.univer-rich-text-editor-wrap .univer-rich-text-editor-error-wrap {\n  font-size: 12px;\n  color: rgb(var(--red-500));\n  position: absolute;\n  bottom: -18px;\n  left: 0px;\n}\n.univer-rich-text-editor-placeholder {\n  font-size: 14px;\n  color: rgb(var(--grey-500));\n  position: absolute;\n  left: 5px;\n  top: 5px;\n}\n","",{version:3,sources:["webpack://./../../packages/docs-ui/src/views/rich-text-editor/index.module.less"],names:[],mappings:"AACI;EACI,iDAAA;AAAR;AAGI;EACI,YAAA;EACA,wBAAA;EACA,WAAA;EACA,aAAA;EACA,6BAAA;EACA,mBAAA;EACA,QAAA;EACA,0CAAA;EACA,wCAAA;EACA,sBAAA;EACA,kBAAA;AADR;AAVI;EAcQ,WAAA;EACA,YAAA;EACA,kBAAA;AADZ;AAfI;EAoBQ,eAAA;EACA,0BAAA;EACA,kBAAA;EACA,aAAA;EACA,SAAA;AAFZ;AAMI;EACI,eAAA;EACA,2BAAA;EACA,kBAAA;EACA,SAAA;EACA,QAAA;AAJR",sourcesContent:[".rich-text-editor {\n    &-active {\n        border-color: rgb(var(--hyacinth-500)) !important;\n    }\n\n    &-wrap {\n        height: 32px;\n        padding: 6px 8px 2px 6px;\n        width: 100%;\n        display: flex;\n        justify-content: space-around;\n        align-items: center;\n        gap: 8px;\n        border: 1px solid rgb(var(--border-color));\n        border-radius: var(--border-radius-base);\n        box-sizing: border-box;\n        position: relative;\n\n        .rich-text-editor-text {\n            width: 100%;\n            height: 100%;\n            position: relative;\n        }\n\n        .rich-text-editor-error-wrap {\n            font-size: 12px;\n            color: rgb(var(--red-500));\n            position: absolute;\n            bottom: -18px;\n            left: 0px;\n        }\n    }\n\n    &-placeholder {\n        font-size: 14px;\n        color: rgb(var(--grey-500));\n        position: absolute;\n        left: 5px;\n        top: 5px;\n    }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={richTextEditorActive:"univer-rich-text-editor-active",richTextEditorWrap:"univer-rich-text-editor-wrap",richTextEditorText:"univer-rich-text-editor-text",richTextEditorErrorWrap:"univer-rich-text-editor-error-wrap",richTextEditorPlaceholder:"univer-rich-text-editor-placeholder"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/docs-ui/src/views/table/create/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-create {\n  padding: 20px auto;\n  display: flex;\n  align-content: center;\n  justify-content: space-between;\n}\n.univer-create-item {\n  display: flex;\n  align-items: center;\n}\n.univer-create-label {\n  margin-right: 5px;\n}\n.univer-create-input {\n  width: 110px;\n}\n","",{version:3,sources:["webpack://./../../packages/docs-ui/src/views/table/create/index.module.less"],names:[],mappings:"AAAA;EACI,kBAAA;EACA,aAAA;EACA,qBAAA;EACA,8BAAA;AACJ;AACI;EACI,aAAA;EACA,mBAAA;AACR;AAEI;EACI,iBAAA;AAAR;AAGI;EACI,YAAA;AADR",sourcesContent:[".create {\n    padding: 20px auto;\n    display: flex;\n    align-content: center;\n    justify-content: space-between;\n\n    &-item {\n        display: flex;\n        align-items: center;\n    }\n\n    &-label {\n        margin-right: 5px;\n    }\n\n    &-input {\n        width: 110px;\n    }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={create:"univer-create",createItem:"univer-create-item",createLabel:"univer-create-label",createInput:"univer-create-input"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-filter-ui/src/views/components/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-sheets-filter-panel {\n  display: flex;\n  min-width: 312px;\n  height: 432px;\n  flex-direction: column;\n  background: rgb(var(--bg-color-secondary));\n  border-radius: 10px;\n  box-sizing: border-box;\n  box-shadow: var(--box-shadow-lg);\n  padding: 16px;\n  overflow: hidden;\n}\n.univer-sheets-filter-panel-header {\n  flex-grow: 0;\n  flex-shrink: 0;\n  margin-bottom: 4px;\n}\n.univer-sheets-filter-panel-content {\n  flex-grow: 1;\n  flex-shrink: 1;\n  overflow: hidden;\n  padding-top: 8px;\n}\n.univer-sheets-filter-panel-select-all {\n  font-size: 13px;\n  margin-right: 4px;\n}\n.univer-sheets-filter-panel-select-all-count {\n  font-size: 13px;\n  color: rgb(var(--grey-400));\n}\n.univer-sheets-filter-panel-values-container {\n  display: flex;\n  height: 100%;\n  flex-direction: column;\n}\n.univer-sheets-filter-panel-values-container > .univer-input-affix-wrapper {\n  flex: 0 0 32px;\n}\n.univer-sheets-filter-panel-values-container .univer-select,\n.univer-sheets-filter-panel-values-container .univer-input-affix-wrapper,\n.univer-sheets-filter-panel-values-container .univer-radio-group {\n  width: 100%;\n}\n.univer-sheets-filter-panel-values-find {\n  height: 32px;\n  margin-bottom: 8px;\n}\n.univer-sheets-filter-panel-values-list {\n  flex-grow: 1;\n  margin-top: 8px;\n  border: 1px solid rgb(var(--grey-200));\n  box-sizing: border-box;\n  border-radius: 6px;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  padding: 6px 0 6px 8px;\n}\n.univer-sheets-filter-panel-values-list-inner-container {\n  padding-right: 8px;\n}\n.univer-sheets-filter-panel-values-virtual {\n  flex-grow: 1;\n}\n.univer-sheets-filter-panel-values-item {\n  box-sizing: border-box;\n  height: 32px;\n  padding: 2px 0;\n  width: 100%;\n}\n.univer-sheets-filter-panel-values-item-inner {\n  align-items: center;\n  padding: 0 2px 0 20px;\n  line-height: 28px;\n  box-sizing: border-box;\n  border-radius: 6px;\n  height: 28px;\n  display: flex;\n  font-size: 13px;\n}\n.univer-sheets-filter-panel-values-item-inner:hover {\n  background-color: rgb(var(--grey-50));\n}\n.univer-sheets-filter-panel-values-item-inner:hover .univer-sheets-filter-panel-values-item-count {\n  margin-right: 2px;\n}\n.univer-sheets-filter-panel-values-item-inner:hover .univer-sheets-filter-panel-values-item-exclude-button {\n  box-sizing: border-box;\n  margin-left: auto;\n  display: inline-block;\n  height: 24px;\n  font-size: 12px;\n  line-height: 12px;\n}\n.univer-sheets-filter-panel-values-item-inner:hover .univer-sheets-filter-panel-values-item-exclude-button:hover {\n  background-color: rgb(var(--hyacinth-50));\n}\n.univer-sheets-filter-panel-values-item-inner:hover .univer-sheets-filter-panel-values-item-exclude-button:active {\n  background-color: rgb(var(--hyacinth-100));\n}\n.univer-sheets-filter-panel-values-item-text {\n  display: inline-block;\n  height: 100%;\n  margin: 0 4px;\n  flex-shrink: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.univer-sheets-filter-panel-values-item-count {\n  color: rgb(var(--grey-400));\n}\n.univer-sheets-filter-panel-values-item-exclude-button {\n  display: none;\n}\n.univer-sheets-filter-panel-conditions-container {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n.univer-sheets-filter-panel-conditions-container .univer-select,\n.univer-sheets-filter-panel-conditions-container .univer-input-affix-wrapper,\n.univer-sheets-filter-panel-conditions-container .univer-radio-group {\n  width: 100%;\n  margin-bottom: 8px;\n}\n.univer-sheets-filter-panel-conditions-container-inner {\n  flex-grow: 1;\n  border-radius: 6px;\n  border: 1px solid rgb(var(--grey-200));\n  overflow: hidden;\n  padding: 8px;\n}\n.univer-sheets-filter-panel-conditions-desc {\n  margin-top: -6px;\n  color: rgb(var(--grey-500));\n  font-size: 12px;\n  line-height: 18px;\n}\n.univer-sheets-filter-panel-footer {\n  margin-top: 16px;\n  flex-grow: 0;\n  flex-shrink: 0;\n  display: inline-flex;\n  flex-wrap: nowrap;\n  overflow: hidden;\n  justify-content: space-between;\n}\n.univer-sheets-filter-panel-footer-primary-buttons {\n  display: flex;\n}\n.univer-sheets-filter-panel-footer-primary-buttons > .univer-button {\n  margin-left: 12px;\n}\n.univer-sheets-filter-panel .univer-select {\n  width: 100%;\n}\n.univer-sheets-filter-panel .univer-input {\n  width: 100%;\n}\n.univer-sheets-filter-panel .univer-form-dual-column-layout {\n  margin-bottom: 8px;\n}\n.univer-sheets-filter-tree-node {\n  padding-right: 8px;\n  max-width: 245px;\n}\n.univer-sheets-filter-tree-node .univer-sheets-filter-tree-node-filter-only {\n  display: none;\n  padding: 0 6px;\n  height: 16px;\n  background-color: rgb(var(--grey-50));\n}\n.univer-sheets-filter-tree-node:hover {\n  background-color: rgb(var(--grey-50));\n  border-radius: 6px;\n}\n.univer-sheets-filter-tree-node:hover .univer-sheets-filter-tree-node-filter-only {\n  display: inline-block;\n}\n.univer-sheets-filter-tree-node-attach {\n  height: 20px;\n  flex: 1;\n  margin-left: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  font-size: 13px;\n}\n","",{version:3,sources:["webpack://./../../packages/sheets-filter-ui/src/views/components/index.module.less"],names:[],mappings:"AAAA;EACI,aAAA;EACA,gBAAA;EACA,aAAA;EACA,sBAAA;EACA,0CAAA;EACA,mBAAA;EACA,sBAAA;EACA,gCAAA;EACA,aAAA;EACA,gBAAA;AACJ;AACI;EACI,YAAA;EACA,cAAA;EACA,kBAAA;AACR;AAEI;EACI,YAAA;EACA,cAAA;EACA,gBAAA;EACA,gBAAA;AAAR;AAGI;EACI,eAAA;EACA,iBAAA;AADR;AAGQ;EACI,eAAA;EACA,2BAAA;AADZ;AAMQ;EACI,aAAA;EACA,YAAA;EACA,sBAAA;AAJZ;AACQ;EAMQ,cAAA;AAJhB;AAFQ;;;EAYQ,WAAA;AALhB;AASQ;EACI,YAAA;EACA,kBAAA;AAPZ;AAUQ;EACI,YAAA;EACA,eAAA;EACA,sCAAA;EACA,sBAAA;EACA,kBAAA;EACA,gBAAA;EACA,aAAA;EACA,sBAAA;EAEA,sBAAA;AATZ;AAWY;EACI,kBAAA;AAThB;AAaQ;EACI,YAAA;AAXZ;AAcQ;EACI,sBAAA;EACA,YAAA;EACA,cAAA;EACA,WAAA;AAZZ;AAcY;EACI,mBAAA;EACA,qBAAA;EACA,iBAAA;EACA,sBAAA;EACA,kBAAA;EACA,YAAA;EACA,aAAA;EACA,eAAA;AAZhB;AAcgB;EACI,qCAAA;AAZpB;AAWgB;EAIQ,iBAAA;AAZxB;AAQgB;EAQQ,sBAAA;EACA,iBAAA;EACA,qBAAA;EACA,YAAA;EACA,eAAA;EACA,iBAAA;AAbxB;AAewB;EACI,yCAAA;AAb5B;AAgBwB;EACI,0CAAA;AAd5B;AAoBY;EACI,qBAAA;EACA,YAAA;EACA,aAAA;EACA,cAAA;EACA,gBAAA;EACA,uBAAA;EACA,mBAAA;AAlBhB;AAqBY;EACI,2BAAA;AAnBhB;AAsBY;EACI,aAAA;AApBhB;AA0BQ;EACI,aAAA;EACA,sBAAA;EACA,YAAA;AAxBZ;AAqBQ;;;EAQQ,WAAA;EACA,kBAAA;AAxBhB;AA2BY;EACI,YAAA;EACA,kBAAA;EACA,sCAAA;EACA,gBAAA;EACA,YAAA;AAzBhB;AA6BQ;EACI,gBAAA;EACA,2BAAA;EACA,eAAA;EACA,iBAAA;AA3BZ;AA+BI;EACI,gBAAA;EACA,YAAA;EACA,cAAA;EACA,oBAAA;EACA,iBAAA;EACA,gBAAA;EAEA,8BAAA;AA9BR;AAgCQ;EACI,aAAA;AA9BZ;AA6BQ;EAIQ,iBAAA;AA9BhB;AA1JA;EA8LQ,WAAA;AAjCR;AA7JA;EAkMQ,WAAA;AAlCR;AAhKA;EAsMQ,kBAAA;AAnCR;AAwCI;EAEI,kBAAA;EACA,gBAAA;AAvCR;AAoCI;EAMQ,aAAA;EACA,cAAA;EACA,YAAA;EACA,qCAAA;AAvCZ;AA0CQ;EACI,qCAAA;EACA,kBAAA;AAxCZ;AAsCQ;EAKQ,qBAAA;AAxChB;AA4CQ;EACI,YAAA;EACA,OAAA;EACA,gBAAA;EACA,aAAA;EACA,mBAAA;EACA,8BAAA;EACA,eAAA;AA1CZ",sourcesContent:[".sheets-filter-panel {\n    display: flex;\n    min-width: 312px;\n    height: 432px;\n    flex-direction: column;\n    background: rgb(var(--bg-color-secondary));\n    border-radius: 10px;\n    box-sizing: border-box;\n    box-shadow: var(--box-shadow-lg);\n    padding: 16px;\n    overflow: hidden;\n\n    &-header {\n        flex-grow: 0;\n        flex-shrink: 0;\n        margin-bottom: 4px;\n    }\n\n    &-content {\n        flex-grow: 1;\n        flex-shrink: 1;\n        overflow: hidden;\n        padding-top: 8px;\n    }\n\n    &-select-all {\n        font-size: 13px;\n        margin-right: 4px;\n\n        &-count {\n            font-size: 13px;\n            color: rgb(var(--grey-400));\n        }\n    }\n\n    &-values {\n        &-container {\n            display: flex;\n            height: 100%;\n            flex-direction: column;\n\n            > .input-affix-wrapper {\n                flex: 0 0 32px;\n            }\n\n            .select,\n            .input-affix-wrapper,\n            .radio-group {\n                width: 100%;\n            }\n        }\n\n        &-find {\n            height: 32px;\n            margin-bottom: 8px;\n        }\n\n        &-list {\n            flex-grow: 1;\n            margin-top: 8px;\n            border: 1px solid rgb(var(--grey-200));\n            box-sizing: border-box;\n            border-radius: 6px;\n            overflow: hidden;\n            display: flex;\n            flex-direction: column;\n\n            padding: 6px 0 6px 8px;\n\n            &-inner-container {\n                padding-right: 8px;\n            }\n        }\n\n        &-virtual {\n            flex-grow: 1;\n        }\n\n        &-item {\n            box-sizing: border-box;\n            height: 32px;\n            padding: 2px 0;\n            width: 100%;\n\n            &-inner {\n                align-items: center;\n                padding: 0 2px 0 20px;\n                line-height: 28px;\n                box-sizing: border-box;\n                border-radius: 6px;\n                height: 28px;\n                display: flex;\n                font-size: 13px;\n\n                &:hover {\n                    background-color: rgb(var(--grey-50));\n\n                    .sheets-filter-panel-values-item-count {\n                        margin-right: 2px;\n                    }\n\n                    .sheets-filter-panel-values-item-exclude-button {\n                        box-sizing: border-box;\n                        margin-left: auto;\n                        display: inline-block;\n                        height: 24px;\n                        font-size: 12px;\n                        line-height: 12px;\n\n                        &:hover {\n                            background-color: rgb(var(--hyacinth-50));\n                        }\n\n                        &:active {\n                            background-color: rgb(var(--hyacinth-100));\n                        }\n                    }\n                }\n            }\n\n            &-text {\n                display: inline-block;\n                height: 100%;\n                margin: 0 4px;\n                flex-shrink: 1;\n                overflow: hidden;\n                text-overflow: ellipsis;\n                white-space: nowrap;\n            }\n\n            &-count {\n                color: rgb(var(--grey-400));\n            }\n\n            &-exclude-button {\n                display: none;\n            }\n        }\n    }\n\n    &-conditions {\n        &-container {\n            display: flex;\n            flex-direction: column;\n            height: 100%;\n\n            .select,\n            .input-affix-wrapper,\n            .radio-group {\n                width: 100%;\n                margin-bottom: 8px;\n            }\n\n            &-inner {\n                flex-grow: 1;\n                border-radius: 6px;\n                border: 1px solid rgb(var(--grey-200));\n                overflow: hidden;\n                padding: 8px;\n            }\n        }\n\n        &-desc {\n            margin-top: -6px;\n            color: rgb(var(--grey-500));\n            font-size: 12px;\n            line-height: 18px;\n        }\n    }\n\n    &-footer {\n        margin-top: 16px;\n        flex-grow: 0;\n        flex-shrink: 0;\n        display: inline-flex;\n        flex-wrap: nowrap;\n        overflow: hidden;\n\n        justify-content: space-between;\n\n        &-primary-buttons {\n            display: flex;\n\n            > .button {\n                margin-left: 12px;\n            }\n        }\n    }\n\n    .select {\n        width: 100%;\n    }\n\n    .input {\n        width: 100%;\n    }\n\n    .form-dual-column-layout {\n        margin-bottom: 8px;\n    }\n}\n\n.sheets-filter {\n    &-tree-node {\n        // height: 28px;\n        padding-right: 8px;\n        max-width: 245px;\n\n        .sheets-filter-tree-node-filter-only {\n            display: none;\n            padding: 0 6px;\n            height: 16px;\n            background-color: rgb(var(--grey-50));\n        }\n\n        &:hover {\n            background-color: rgb(var(--grey-50));\n            border-radius: 6px;\n\n            .sheets-filter-tree-node-filter-only {\n                display: inline-block;\n            }\n        }\n\n        &-attach {\n            height: 20px;\n            flex: 1;\n            margin-left: 4px;\n            display: flex;\n            align-items: center;\n            justify-content: space-between;\n            font-size: 13px;\n        }\n    }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={sheetsFilterPanel:"univer-sheets-filter-panel",sheetsFilterPanelHeader:"univer-sheets-filter-panel-header",sheetsFilterPanelContent:"univer-sheets-filter-panel-content",sheetsFilterPanelSelectAll:"univer-sheets-filter-panel-select-all",sheetsFilterPanelSelectAllCount:"univer-sheets-filter-panel-select-all-count",sheetsFilterPanelValuesContainer:"univer-sheets-filter-panel-values-container",inputAffixWrapper:"univer-input-affix-wrapper",select:"univer-select",radioGroup:"univer-radio-group",sheetsFilterPanelValuesFind:"univer-sheets-filter-panel-values-find",sheetsFilterPanelValuesList:"univer-sheets-filter-panel-values-list",sheetsFilterPanelValuesListInnerContainer:"univer-sheets-filter-panel-values-list-inner-container",sheetsFilterPanelValuesVirtual:"univer-sheets-filter-panel-values-virtual",sheetsFilterPanelValuesItem:"univer-sheets-filter-panel-values-item",sheetsFilterPanelValuesItemInner:"univer-sheets-filter-panel-values-item-inner",sheetsFilterPanelValuesItemCount:"univer-sheets-filter-panel-values-item-count",sheetsFilterPanelValuesItemExcludeButton:"univer-sheets-filter-panel-values-item-exclude-button",sheetsFilterPanelValuesItemText:"univer-sheets-filter-panel-values-item-text",sheetsFilterPanelConditionsContainer:"univer-sheets-filter-panel-conditions-container",sheetsFilterPanelConditionsContainerInner:"univer-sheets-filter-panel-conditions-container-inner",sheetsFilterPanelConditionsDesc:"univer-sheets-filter-panel-conditions-desc",sheetsFilterPanelFooter:"univer-sheets-filter-panel-footer",sheetsFilterPanelFooterPrimaryButtons:"univer-sheets-filter-panel-footer-primary-buttons",button:"univer-button",input:"univer-input",formDualColumnLayout:"univer-form-dual-column-layout",sheetsFilterTreeNode:"univer-sheets-filter-tree-node",sheetsFilterTreeNodeFilterOnly:"univer-sheets-filter-tree-node-filter-only",sheetsFilterTreeNodeAttach:"univer-sheets-filter-tree-node-attach"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/components/menu-item-input/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-sheets-ui-context-menu-input {\n  display: flex;\n  gap: var(--margin-sm);\n  align-items: center;\n}\n.univer-sheets-ui-context-menu-input-container {\n  width: 72px;\n}\n.univer-sheets-ui-context-menu-input-number {\n  height: 24px;\n}\n","",{version:3,sources:["webpack://./../../packages/sheets-ui/src/components/menu-item-input/index.module.less"],names:[],mappings:"AAAA;EACI,aAAA;EACA,qBAAA;EACA,mBAAA;AACJ;AACI;EACI,WAAA;AACR;AAEI;EACI,YAAA;AAAR",sourcesContent:[".sheets-ui-context-menu-input {\n    display: flex;\n    gap: var(--margin-sm);\n    align-items: center;\n\n    &-container {\n        width: 72px;\n    }\n\n    &-number {\n        height: 24px;\n    }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={sheetsUiContextMenuInput:"univer-sheets-ui-context-menu-input",sheetsUiContextMenuInputContainer:"univer-sheets-ui-context-menu-input-container",sheetsUiContextMenuInputNumber:"univer-sheets-ui-context-menu-input-number"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/cell-alert/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-cell-alert {\n  box-sizing: border-box;\n  box-shadow: var(--box-shadow-base);\n  padding: var(--padding-sm) var(--padding-base);\n  border-radius: var(--border-radius-lg);\n  color: rgba(var(--color-black));\n  background: rgba(var(--color-white));\n  z-index: 100;\n  width: 156px;\n}\n.univer-cell-alert-title {\n  height: 20px;\n  font-size: var(--font-size-sm);\n  font-weight: 500;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin-bottom: 6px;\n  line-height: 20px;\n}\n.univer-cell-alert-icon {\n  margin-right: 6px;\n}\n.univer-cell-alert-icon-error {\n  color: rgba(var(--red-400));\n}\n.univer-cell-alert-icon-info {\n  color: rgba(var(--blue-500));\n}\n.univer-cell-alert-icon-warning {\n  color: rgba(var(--gold-400));\n}\n.univer-cell-alert-content {\n  font-size: var(--font-size-sm);\n}\n","",{version:3,sources:["webpack://./../../packages/sheets-ui/src/views/cell-alert/index.module.less"],names:[],mappings:"AAAA;EACI,sBAAA;EACA,kCAAA;EACA,8CAAA;EACA,sCAAA;EACA,+BAAA;EACA,oCAAA;EACA,YAAA;EACA,YAAA;AACJ;AACI;EACI,YAAA;EACA,8BAAA;EACA,gBAAA;EACA,aAAA;EACA,mBAAA;EACA,mBAAA;EACA,kBAAA;EACA,iBAAA;AACR;AAEI;EACI,iBAAA;AAAR;AAGI;EACI,2BAAA;AADR;AAII;EACI,4BAAA;AAFR;AAKI;EACI,4BAAA;AAHR;AAMI;EACI,8BAAA;AAJR",sourcesContent:[".cell-alert {\n    box-sizing: border-box;\n    box-shadow: var(--box-shadow-base);\n    padding: var(--padding-sm) var(--padding-base);\n    border-radius: var(--border-radius-lg);\n    color: rgba(var(--color-black));\n    background: rgba(var(--color-white));\n    z-index: 100;\n    width: 156px;\n\n    &-title {\n        height: 20px;\n        font-size: var(--font-size-sm);\n        font-weight: 500;\n        display: flex;\n        flex-direction: row;\n        align-items: center;\n        margin-bottom: 6px;\n        line-height: 20px;\n    }\n\n    &-icon {\n        margin-right: 6px;\n    }\n\n    &-icon-error {\n        color: rgba(var(--red-400));\n    }\n\n    &-icon-info {\n        color: rgba(var(--blue-500));\n    }\n\n    &-icon-warning {\n        color: rgba(var(--gold-400));\n    }\n\n    &-content {\n        font-size: var(--font-size-sm);\n    }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={cellAlert:"univer-cell-alert",cellAlertTitle:"univer-cell-alert-title",cellAlertIcon:"univer-cell-alert-icon",cellAlertIconError:"univer-cell-alert-icon-error",cellAlertIconInfo:"univer-cell-alert-icon-info",cellAlertIconWarning:"univer-cell-alert-icon-warning",cellAlertContent:"univer-cell-alert-content"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/clipboard/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-sheet-paste-options-wrapper {\n  position: absolute;\n  display: flex;\n  background-color: #fff;\n  z-index: 10;\n  border-radius: 4px;\n}\n.univer-sheet-paste-options-icon-wrapper {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  border: 1px solid rgb(var(--grey-200, #e5e5e5));\n  border-radius: 4px;\n  padding: 3px;\n}\n.univer-sheet-paste-options-menu {\n  border: 1px solid rgb(var(--grey-200, #e5e5e5));\n  box-shadow: var(--box-shadow-base);\n  border-radius: 4px;\n}\n.univer-sheet-paste-options-menu ul {\n  list-style-type: none;\n  padding: 0;\n  margin: 8px;\n}\n.univer-sheet-paste-options-menu-item {\n  padding: 8px 4px;\n  cursor: pointer;\n  position: relative;\n}\n.univer-sheet-paste-options-menu-item:hover {\n  background-color: rgb(var(--grey-100, #f5f5f5));\n}\n.univer-sheet-paste-options-menu-item-title {\n  font-size: 13px;\n  color: rgb(var(--black, #35322b));\n  margin-left: 20px;\n}\n.univer-sheet-paste-options-menu-item-icon {\n  position: absolute;\n}\n","",{version:3,sources:["webpack://./../../packages/sheets-ui/src/views/clipboard/index.module.less"],names:[],mappings:"AACI;EACI,kBAAA;EACA,aAAA;EACA,sBAAA;EACA,WAAA;EACA,kBAAA;AAAR;AAGI;EACI,aAAA;EACA,mBAAA;EACA,uBAAA;EACA,eAAA;EACA,+CAAA;EACA,kBAAA;EACA,YAAA;AADR;AAII;EAOI,+CAAA;EACA,kCAAA;EACA,kBAAA;AARR;AADI;EAEQ,qBAAA;EACA,UAAA;EACA,WAAA;AAEZ;AAKQ;EACI,gBAAA;EACA,eAAA;EACA,kBAAA;AAHZ;AAKY;EACI,+CAAA;AAHhB;AAMY;EACI,eAAA;EACA,iCAAA;EACA,iBAAA;AAJhB;AAOY;EACI,kBAAA;AALhB",sourcesContent:[".sheet-paste-options {\n    &-wrapper {\n        position: absolute;\n        display: flex;\n        background-color: #fff;\n        z-index: 10;\n        border-radius: 4px;\n    }\n\n    &-icon-wrapper {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        cursor: pointer;\n        border: 1px solid rgb(var(--grey-200, #e5e5e5));\n        border-radius: 4px;\n        padding: 3px;\n    }\n\n    &-menu {\n        ul {\n            list-style-type: none;\n            padding: 0;\n            margin: 8px;\n        }\n\n        border: 1px solid rgb(var(--grey-200, #e5e5e5));\n        box-shadow: var(--box-shadow-base);\n        border-radius: 4px;\n\n        &-item {\n            padding: 8px 4px;\n            cursor: pointer;\n            position: relative;\n\n            &:hover {\n                background-color: rgb(var(--grey-100, #f5f5f5));\n            }\n\n            &-title {\n                font-size: 13px;\n                color: rgb(var(--black, #35322b));\n                margin-left: 20px;\n            }\n\n            &-icon {\n                position: absolute;\n            }\n        }\n    }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={sheetPasteOptionsWrapper:"univer-sheet-paste-options-wrapper",sheetPasteOptionsIconWrapper:"univer-sheet-paste-options-icon-wrapper",sheetPasteOptionsMenu:"univer-sheet-paste-options-menu",sheetPasteOptionsMenuItem:"univer-sheet-paste-options-menu-item",sheetPasteOptionsMenuItemTitle:"univer-sheet-paste-options-menu-item-title",sheetPasteOptionsMenuItemIcon:"univer-sheet-paste-options-menu-item-icon"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/count-bar/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-count-bar {\n  display: flex;\n  flex: 0 0 260px;\n  justify-content: flex-end;\n}\n","",{version:3,sources:["webpack://./../../packages/sheets-ui/src/views/count-bar/index.module.less"],names:[],mappings:"AAAA;EACI,aAAA;EACA,eAAA;EACA,yBAAA;AACJ",sourcesContent:[".count-bar {\n    display: flex;\n    flex: 0 0 260px;\n    justify-content: flex-end;\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={countBar:"univer-count-bar"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/defined-name/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-defined-name-overlay {\n  position: relative;\n  width: 300px;\n  background-color: rgb(var(--color-white));\n}\n.univer-defined-name-overlay-container {\n  position: relative;\n  height: 100%;\n  max-height: 400px;\n  width: 100%;\n  overflow: hidden;\n  overflow-y: auto;\n  scrollbar-color: rgba(var(--scrollbar-color), 0.7) transparent;\n  scrollbar-gutter: auto;\n  scrollbar-width: thin;\n}\n.univer-defined-name-overlay-item {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: var(--padding-xs);\n  border-bottom: 1px solid rgb(var(--border-color));\n  user-select: none;\n  cursor: pointer;\n}\n.univer-defined-name-overlay-item:hover {\n  background-color: rgb(var(--grey-50));\n}\n.univer-defined-name-overlay-item-name {\n  font-size: var(--font-size-md);\n  color: rgb(var(--grey-900));\n  margin: 5px 0px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  flex: 1;\n}\n.univer-defined-name-overlay-item-name-for-sheet {\n  font-size: var(--font-size-xxs);\n  color: rgb(var(--grey-400));\n  margin-left: 5px;\n  font-weight: normal;\n}\n.univer-defined-name-overlay-item-formula {\n  font-size: var(--font-size-xs);\n  color: rgb(var(--grey-800));\n  margin: 5px 0px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  flex: 1;\n}\n.univer-defined-name-overlay-manager {\n  display: flex;\n  flex-direction: column;\n  overflow-y: auto;\n  width: 100%;\n  cursor: pointer;\n  overflow: hidden;\n  background-color: rgb(var(--color-white));\n}\n.univer-defined-name-overlay-manager:hover {\n  background-color: rgb(var(--grey-50));\n}\n.univer-defined-name-overlay-manager-title {\n  font-size: var(--font-size-xs);\n  font-weight: bold;\n  margin: var(--margin-xs);\n  margin-bottom: 0;\n  color: rgb(var(--grey-800));\n}\n.univer-defined-name-overlay-manager-content {\n  font-size: var(--font-size-xxs);\n  margin: var(--margin-xs);\n  color: rgb(var(--grey-500));\n}\n.univer-defined-name-container {\n  width: 100%;\n  position: relative;\n}\n.univer-defined-name-container-scroll {\n  width: 100%;\n  overflow: hidden;\n  overflow-y: auto;\n  position: absolute;\n}\n.univer-defined-name-container-addButton {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 40px;\n  border-top: 1px solid rgb(var(--border-color));\n  border-bottom: 1px solid rgb(var(--border-color));\n  font-size: var(--font-size-md);\n  color: rgb(var(--primary-color));\n}\n.univer-defined-name-container-addButton:hover {\n  background-color: rgb(var(--grey-50));\n  cursor: pointer;\n}\n.univer-defined-name-container-addButton-text {\n  margin-left: 5px;\n}\n.univer-defined-name-container-item {\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: var(--padding-xs);\n  border-bottom: 1px solid rgb(var(--border-color));\n  user-select: none;\n  cursor: default;\n}\n.univer-defined-name-container-item-name {\n  font-size: var(--font-size-sm);\n  font-weight: 500;\n  color: rgb(var(--color-black));\n  margin: 5px 0px;\n  max-width: 190px;\n  max-height: 100px;\n  overflow: hidden;\n}\n.univer-defined-name-container-item-name-for-sheet {\n  font-size: var(--font-size-xxs);\n  color: rgb(var(--grey-400));\n  margin-left: 5px;\n  font-weight: normal;\n}\n.univer-defined-name-container-item-formula-or-refString {\n  font-size: var(--font-size-xs);\n  color: rgb(var(--grey-500));\n  font-weight: 400;\n  margin: 5px 0px;\n  max-height: 100px;\n  text-overflow: ellipsis;\n  overflow: hidden;\n}\n.univer-defined-name-container-item-update {\n  position: absolute;\n  font-size: var(--font-size-xs);\n  color: rgb(var(--primary-color));\n  cursor: pointer;\n  padding: 4px;\n  transform: translate(0, -50%);\n  border-radius: var(--border-radius-base);\n  right: 60px;\n  top: 20px;\n}\n.univer-defined-name-container-item-update:hover {\n  background-color: rgb(var(--hyacinth-50));\n}\n.univer-defined-name-container-item-delete {\n  position: absolute;\n  font-size: var(--font-size-xs);\n  color: rgb(var(--error-color));\n  cursor: pointer;\n  padding: 4px;\n  right: 20px;\n  top: 20px;\n  transform: translate(0, -50%);\n  border-radius: var(--border-radius-base);\n}\n.univer-defined-name-container-item-delete:hover {\n  background-color: rgb(var(--hyacinth-50));\n}\n.univer-defined-name-container-item-show {\n  display: none;\n}\n.univer-defined-name-container-item:hover {\n  background-color: rgb(var(--grey-50));\n}\n.univer-defined-name-container-item:hover .univer-defined-name-container-item-show {\n  display: block;\n}\n.univer-defined-name-input {\n  display: flex;\n  align-items: center;\n  justify-content: left;\n  border-bottom: 1px solid rgb(var(--border-color));\n  padding-bottom: 5px;\n}\n.univer-defined-name-input > div {\n  margin-top: 16px;\n}\n.univer-defined-name-input-formula-selector-text-wrap {\n  margin-top: 16px;\n  height: 100%;\n  position: relative;\n  padding: 0 0 0 6px;\n  border: 1px solid rgb(var(--border-color));\n  transition: all 0.15s;\n  border-radius: var(--border-radius-base);\n}\n.univer-defined-name-input-text-editor-container {\n  position: relative;\n  width: 95%;\n  height: 30px;\n  user-select: none;\n}\n.univer-defined-name-input-validation {\n  display: flex;\n  align-items: center;\n  justify-content: left;\n  color: rgb(var(--error-color));\n  font-size: var(--font-size-xs);\n}\n.univer-defined-name-input-validation > span {\n  margin-right: 2px;\n}\n.univer-defined-name-input-disable {\n  color: rgb(var(--grey-200));\n  cursor: not-allowed;\n}\n","",{version:3,sources:["webpack://./../../packages/sheets-ui/src/views/defined-name/index.module.less"],names:[],mappings:"AACI;EACI,kBAAA;EACA,YAAA;EACA,yCAAA;AAAR;AAEQ;EACI,kBAAA;EACA,YAAA;EACA,iBAAA;EACA,WAAA;EACA,gBAAA;EACA,gBAAA;EACA,8DAAA;EACA,sBAAA;EACA,qBAAA;AAAZ;AAGQ;EACI,aAAA;EACA,mBAAA;EACA,8BAAA;EACA,0BAAA;EACA,iDAAA;EACA,iBAAA;EACA,eAAA;AADZ;AAGY;EACI,qCAAA;AADhB;AAIY;EACI,8BAAA;EACA,2BAAA;EACA,eAAA;EACA,gBAAA;EACA,uBAAA;EACA,OAAA;AAFhB;AAIgB;EACI,+BAAA;EACA,2BAAA;EACA,gBAAA;EACA,mBAAA;AAFpB;AAMY;EACI,8BAAA;EACA,2BAAA;EACA,eAAA;EACA,mBAAA;EACA,gBAAA;EACA,uBAAA;EACA,OAAA;AAJhB;AAQQ;EAEI,aAAA;EACA,sBAAA;EACA,gBAAA;EACA,WAAA;EACA,eAAA;EACA,gBAAA;EACA,yCAAA;AAPZ;AASY;EACI,qCAAA;AAPhB;AAUY;EACI,8BAAA;EACA,iBAAA;EACA,wBAAA;EACA,gBAAA;EACA,2BAAA;AARhB;AAWY;EACI,+BAAA;EACA,wBAAA;EACA,2BAAA;AAThB;AAcI;EACI,WAAA;EACA,kBAAA;AAZR;AAcQ;EACI,WAAA;EACA,gBAAA;EACA,gBAAA;EACA,kBAAA;AAZZ;AAeQ;EACI,aAAA;EACA,mBAAA;EACA,uBAAA;EACA,WAAA;EACA,YAAA;EACA,8CAAA;EACA,iDAAA;EACA,8BAAA;EAEA,gCAAA;AAdZ;AAgBY;EACI,qCAAA;EACA,eAAA;AAdhB;AAiBY;EACI,gBAAA;AAfhB;AAmBQ;EACI,kBAAA;EACA,aAAA;EACA,mBAAA;EACA,8BAAA;EACA,0BAAA;EACA,iDAAA;EACA,iBAAA;EACA,eAAA;AAjBZ;AAmBY;EACI,8BAAA;EACA,gBAAA;EACA,8BAAA;EACA,eAAA;EACA,gBAAA;EACA,iBAAA;EACA,gBAAA;AAjBhB;AAmBgB;EACI,+BAAA;EACA,2BAAA;EACA,gBAAA;EACA,mBAAA;AAjBpB;AAqBY;EACI,8BAAA;EACA,2BAAA;EACA,gBAAA;EACA,eAAA;EACA,iBAAA;EACA,uBAAA;EACA,gBAAA;AAnBhB;AAsBY;EACI,kBAAA;EACA,8BAAA;EACA,gCAAA;EACA,eAAA;EACA,YAAA;EAMA,6BAAA;EACA,wCAAA;EACA,WAAA;EACA,SAAA;AAzBhB;AAkBgB;EACI,yCAAA;AAhBpB;AAyBY;EACI,kBAAA;EACA,8BAAA;EACA,8BAAA;EACA,eAAA;EACA,YAAA;EACA,WAAA;EACA,SAAA;EACA,6BAAA;EACA,wCAAA;AAvBhB;AAyBgB;EACI,yCAAA;AAvBpB;AA2BY;EACI,aAAA;AAzBhB;AA4BY;EACI,qCAAA;AA1BhB;AAyBY;EAIQ,cAAA;AA1BpB;AAgCI;EACI,aAAA;EACA,mBAAA;EACA,qBAAA;EACA,iDAAA;EACA,mBAAA;AA9BR;AAgCQ;EAEI,gBAAA;AA/BZ;AAmCQ;EACI,gBAAA;EACA,YAAA;EACA,kBAAA;EACA,kBAAA;EACA,0CAAA;EACA,qBAAA;EACA,wCAAA;AAjCZ;AAoCQ;EACI,kBAAA;EACA,UAAA;EACA,YAAA;EACA,iBAAA;AAlCZ;AAqCQ;EACI,aAAA;EACA,mBAAA;EACA,qBAAA;EACA,8BAAA;EACA,8BAAA;AAnCZ;AAqCY;EACI,iBAAA;AAnChB;AAuCQ;EACI,2BAAA;EACA,mBAAA;AArCZ",sourcesContent:[".defined-name {\n    &-overlay {\n        position: relative;\n        width: 300px;\n        background-color: rgb(var(--color-white));\n\n        &-container {\n            position: relative;\n            height: 100%;\n            max-height: 400px;\n            width: 100%;\n            overflow: hidden;\n            overflow-y: auto;\n            scrollbar-color: rgba(var(--scrollbar-color), 0.7) transparent;\n            scrollbar-gutter: auto;\n            scrollbar-width: thin;\n        }\n\n        &-item {\n            display: flex;\n            align-items: center;\n            justify-content: space-between;\n            padding: var(--padding-xs);\n            border-bottom: 1px solid rgb(var(--border-color));\n            user-select: none;\n            cursor: pointer;\n\n            &:hover {\n                background-color: rgb(var(--grey-50));\n            }\n\n            &-name {\n                font-size: var(--font-size-md);\n                color: rgb(var(--grey-900));\n                margin: 5px 0px;\n                overflow: hidden;\n                text-overflow: ellipsis;\n                flex: 1;\n\n                &-for-sheet {\n                    font-size: var(--font-size-xxs);\n                    color: rgb(var(--grey-400));\n                    margin-left: 5px;\n                    font-weight: normal;\n                }\n            }\n\n            &-formula {\n                font-size: var(--font-size-xs);\n                color: rgb(var(--grey-800));\n                margin: 5px 0px;\n                white-space: nowrap;\n                overflow: hidden;\n                text-overflow: ellipsis;\n                flex: 1;\n            }\n        }\n\n        &-manager {\n            // position: absolute;\n            display: flex;\n            flex-direction: column;\n            overflow-y: auto;\n            width: 100%;\n            cursor: pointer;\n            overflow: hidden;\n            background-color: rgb(var(--color-white));\n\n            &:hover {\n                background-color: rgb(var(--grey-50));\n            }\n\n            &-title {\n                font-size: var(--font-size-xs);\n                font-weight: bold;\n                margin: var(--margin-xs);\n                margin-bottom: 0;\n                color: rgb(var(--grey-800));\n            }\n\n            &-content {\n                font-size: var(--font-size-xxs);\n                margin: var(--margin-xs);\n                color: rgb(var(--grey-500));\n            }\n        }\n    }\n\n    &-container {\n        width: 100%;\n        position: relative;\n\n        &-scroll {\n            width: 100%;\n            overflow: hidden;\n            overflow-y: auto;\n            position: absolute;\n        }\n\n        &-addButton {\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            width: 100%;\n            height: 40px;\n            border-top: 1px solid rgb(var(--border-color));\n            border-bottom: 1px solid rgb(var(--border-color));\n            font-size: var(--font-size-md);\n\n            color: rgb(var(--primary-color));\n\n            &:hover {\n                background-color: rgb(var(--grey-50));\n                cursor: pointer;\n            }\n\n            &-text {\n                margin-left: 5px;\n            }\n        }\n\n        &-item {\n            position: relative;\n            display: flex;\n            align-items: center;\n            justify-content: space-between;\n            padding: var(--padding-xs);\n            border-bottom: 1px solid rgb(var(--border-color));\n            user-select: none;\n            cursor: default;\n\n            &-name {\n                font-size: var(--font-size-sm);\n                font-weight: 500;\n                color: rgb(var(--color-black));\n                margin: 5px 0px;\n                max-width: 190px;\n                max-height: 100px;\n                overflow: hidden;\n\n                &-for-sheet {\n                    font-size: var(--font-size-xxs);\n                    color: rgb(var(--grey-400));\n                    margin-left: 5px;\n                    font-weight: normal;\n                }\n            }\n\n            &-formula-or-refString {\n                font-size: var(--font-size-xs);\n                color: rgb(var(--grey-500));\n                font-weight: 400;\n                margin: 5px 0px;\n                max-height: 100px;\n                text-overflow: ellipsis;\n                overflow: hidden;\n            }\n\n            &-update {\n                position: absolute;\n                font-size: var(--font-size-xs);\n                color: rgb(var(--primary-color));\n                cursor: pointer;\n                padding: 4px;\n\n                &:hover {\n                    background-color: rgb(var(--hyacinth-50));\n                }\n\n                transform: translate(0, -50%);\n                border-radius: var(--border-radius-base);\n                right: 60px;\n                top: 20px;\n            }\n\n            &-delete {\n                position: absolute;\n                font-size: var(--font-size-xs);\n                color: rgb(var(--error-color));\n                cursor: pointer;\n                padding: 4px;\n                right: 20px;\n                top: 20px;\n                transform: translate(0, -50%);\n                border-radius: var(--border-radius-base);\n\n                &:hover {\n                    background-color: rgb(var(--hyacinth-50));\n                }\n            }\n\n            &-show {\n                display: none;\n            }\n\n            &:hover {\n                background-color: rgb(var(--grey-50));\n\n                .defined-name-container-item-show {\n                    display: block;\n                }\n            }\n        }\n    }\n\n    &-input {\n        display: flex;\n        align-items: center;\n        justify-content: left;\n        border-bottom: 1px solid rgb(var(--border-color));\n        padding-bottom: 5px;\n\n        & > div {\n            // check docs-ui/src/components/editor/index.module.less .text-editor-validation-error\n            margin-top: 16px;\n        }\n\n        // univer-defined-name-input\n        &-formula-selector-text-wrap {\n            margin-top: 16px;\n            height: 100%;\n            position: relative;\n            padding: 0 0 0 6px;\n            border: 1px solid rgb(var(--border-color));\n            transition: all 0.15s;\n            border-radius: var(--border-radius-base);\n        }\n\n        &-text-editor-container {\n            position: relative;\n            width: 95%;\n            height: 30px;\n            user-select: none;\n        }\n\n        &-validation {\n            display: flex;\n            align-items: center;\n            justify-content: left;\n            color: rgb(var(--error-color));\n            font-size: var(--font-size-xs);\n\n            & > span {\n                margin-right: 2px;\n            }\n        }\n\n        &-disable {\n            color: rgb(var(--grey-200));\n            cursor: not-allowed;\n        }\n    }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={definedNameOverlay:"univer-defined-name-overlay",definedNameOverlayContainer:"univer-defined-name-overlay-container",definedNameOverlayItem:"univer-defined-name-overlay-item",definedNameOverlayItemName:"univer-defined-name-overlay-item-name",definedNameOverlayItemNameForSheet:"univer-defined-name-overlay-item-name-for-sheet",definedNameOverlayItemFormula:"univer-defined-name-overlay-item-formula",definedNameOverlayManager:"univer-defined-name-overlay-manager",definedNameOverlayManagerTitle:"univer-defined-name-overlay-manager-title",definedNameOverlayManagerContent:"univer-defined-name-overlay-manager-content",definedNameContainer:"univer-defined-name-container",definedNameContainerScroll:"univer-defined-name-container-scroll",definedNameContainerAddButton:"univer-defined-name-container-addButton",definedNameContainerAddButtonText:"univer-defined-name-container-addButton-text",definedNameContainerItem:"univer-defined-name-container-item",definedNameContainerItemName:"univer-defined-name-container-item-name",definedNameContainerItemNameForSheet:"univer-defined-name-container-item-name-for-sheet",definedNameContainerItemFormulaOrRefString:"univer-defined-name-container-item-formula-or-refString",definedNameContainerItemUpdate:"univer-defined-name-container-item-update",definedNameContainerItemDelete:"univer-defined-name-container-item-delete",definedNameContainerItemShow:"univer-defined-name-container-item-show",definedNameInput:"univer-defined-name-input",definedNameInputFormulaSelectorTextWrap:"univer-defined-name-input-formula-selector-text-wrap",definedNameInputTextEditorContainer:"univer-defined-name-input-text-editor-container",definedNameInputValidation:"univer-defined-name-input-validation",definedNameInputDisable:"univer-defined-name-input-disable"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/editor-container/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-editor-container {\n  position: absolute;\n  z-index: 10;\n  top: 200px;\n  left: 100px;\n  display: flex;\n  width: 100px;\n  height: 50px;\n  border: 1px solid rgb(var(--primary-color));\n  box-shadow: none;\n  box-sizing: content-box;\n}\n.univer-editor-container .univer-editor-input {\n  position: relative;\n  display: flex;\n  width: 100%;\n  height: 100%;\n}\n.univer-editor-container .univer-editor-input canvas {\n  position: absolute;\n}\n.univer-editor-container .univer-editor-input .univer-sheet-embedding-formula-editor-wrap {\n  height: auto;\n  border: none;\n  padding: 0;\n  border-radius: 0;\n}\n","",{version:3,sources:["webpack://./../../packages/sheets-ui/src/views/editor-container/index.module.less"],names:[],mappings:"AAAA;EACI,kBAAA;EACA,WAAA;EACA,UAAA;EACA,WAAA;EACA,aAAA;EACA,YAAA;EACA,YAAA;EAEA,2CAAA;EACA,gBAAA;EACA,uBAAA;AAAJ;AAXA;EAcQ,kBAAA;EACA,aAAA;EACA,WAAA;EACA,YAAA;AAAR;AAjBA;EAwBY,kBAAA;AAJZ;AApBA;EA4BY,YAAA;EACA,YAAA;EACA,UAAA;EACA,gBAAA;AALZ",sourcesContent:[".editor-container {\n    position: absolute;\n    z-index: 10;\n    top: 200px;\n    left: 100px;\n    display: flex;\n    width: 100px;\n    height: 50px;\n\n    border: 1px solid rgb(var(--primary-color));\n    box-shadow: none;\n    box-sizing: content-box;\n\n    .editor-input {\n        position: relative;\n        display: flex;\n        width: 100%;\n        height: 100%;\n\n        // Do not set a color, it should be transparent.\n        // create a rendering editor canvas may took 200ms, there would be a white flash if rendering have not finished.\n        // background: white;\n\n        canvas {\n            position: absolute;\n        }\n\n        .sheet-embedding-formula-editor-wrap {\n            height: auto;\n            border: none;\n            padding: 0;\n            border-radius: 0;\n        }\n    }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={editorContainer:"univer-editor-container",editorInput:"univer-editor-input",sheetEmbeddingFormulaEditorWrap:"univer-sheet-embedding-formula-editor-wrap"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/formula-bar/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-formula-box {\n  display: flex;\n  box-sizing: border-box;\n  height: 28px;\n  background: rgb(var(--bg-color-secondary));\n  border-bottom: 1px solid rgb(var(--border-color));\n  transition: height 0.15s;\n}\n.univer-formula-box .univer-name-ranges {\n  box-sizing: border-box;\n  width: 100px;\n  height: 100%;\n  position: relative;\n}\n.univer-formula-box .univer-formula-bar {\n  display: flex;\n  width: 100%;\n  height: 100%;\n}\n.univer-formula-box .univer-formula-bar .univer-formula-icon {\n  padding: 6px 0;\n}\n.univer-formula-box .univer-formula-bar .univer-formula-icon-disable {\n  color: rgb(var(--grey-200));\n  cursor: not-allowed;\n}\n.univer-formula-box .univer-formula-bar .univer-formula-icon-wrapper {\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-sizing: border-box;\n  width: 80px;\n  height: 100%;\n  font-size: var(--font-size-xs);\n  border-right: 1px solid rgb(var(--border-color));\n}\n.univer-formula-box .univer-formula-bar .univer-formula-icon-wrapper .univer-icon-container {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: var(--padding-xs);\n  font-size: var(--font-size-lg);\n  border-radius: var(--border-radius-base);\n}\n.univer-formula-box .univer-formula-bar .univer-formula-icon-wrapper .univer-icon-container-success.univer-formula-active {\n  cursor: pointer;\n  color: rgb(var(--success-color));\n}\n.univer-formula-box .univer-formula-bar .univer-formula-icon-wrapper .univer-icon-container-success.univer-formula-active:hover {\n  background-color: rgb(var(--grey-50));\n}\n.univer-formula-box .univer-formula-bar .univer-formula-icon-wrapper .univer-icon-container-error.univer-formula-active {\n  cursor: pointer;\n  color: rgb(var(--error-color));\n}\n.univer-formula-box .univer-formula-bar .univer-formula-icon-wrapper .univer-icon-container-error.univer-formula-active:hover {\n  background-color: rgb(var(--grey-50));\n}\n.univer-formula-box .univer-formula-bar .univer-formula-icon-wrapper .univer-icon-container-fx {\n  cursor: pointer;\n}\n.univer-formula-box .univer-formula-bar .univer-formula-icon-wrapper .univer-icon-container-fx:hover {\n  background-color: rgb(var(--grey-50));\n}\n.univer-formula-box .univer-formula-bar .univer-formula-input {\n  flex: 1;\n  position: relative;\n}\n.univer-formula-box .univer-formula-bar .univer-formula-input-mask {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  pointer-events: none;\n  z-index: 100;\n  background: rgb(var(--color-white));\n  cursor: not-allowed;\n}\n.univer-formula-box .univer-formula-bar .univer-formula-container {\n  overflow: hidden;\n  display: flex;\n  flex: 1;\n  width: 100%;\n  padding: 0 0 0 10px;\n}\n.univer-formula-box .univer-formula-bar .univer-formula-container .univer-sheet-embedding-formula-editor-wrap {\n  height: auto;\n  border: none;\n  padding: 0;\n  border-radius: 0;\n  height: 100%;\n}\n.univer-formula-box .univer-formula-bar .univer-formula-container .univer-formula-content {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  word-wrap: break-word;\n  outline: none;\n}\n.univer-formula-box .univer-formula-bar .univer-formula-container .univer-arrow-container {\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 20px;\n  height: 100%;\n  font-size: var(--font-size-xs);\n  color: rgb(var(--text-color-secondary));\n}\n.univer-formula-box .univer-formula-bar .univer-formula-container .univer-arrow-container-disable {\n  color: rgb(var(--grey-200));\n  cursor: not-allowed;\n}\n","",{version:3,sources:["webpack://./../../packages/sheets-ui/src/views/formula-bar/index.module.less"],names:[],mappings:"AAAA;EACI,aAAA;EAEA,sBAAA;EACA,YAAA;EAEA,0CAAA;EACA,iDAAA;EAEA,wBAAA;AAFJ;AAPA;EAYQ,sBAAA;EACA,YAAA;EACA,YAAA;EACA,kBAAA;AAFR;AAbA;EAmBQ,aAAA;EACA,WAAA;EACA,YAAA;AAHR;AAlBA;EAwBY,cAAA;AAHZ;AAKY;EACI,2BAAA;EACA,mBAAA;AAHhB;AAMY;EACI,kBAAA;EAEA,aAAA;EAEA,mBAAA;EACA,uBAAA;EAEA,sBAAA;EACA,WAAA;EACA,YAAA;EAEA,8BAAA;EAEA,gDAAA;AAThB;AALY;EAiBQ,aAAA;EACA,mBAAA;EACA,uBAAA;EAEA,0BAAA;EAEA,8BAAA;EAEA,wCAAA;AAZpB;AAewB;EACI,eAAA;EACA,gCAAA;AAb5B;AAc4B;EACI,qCAAA;AAZhC;AAkBwB;EACI,eAAA;EACA,8BAAA;AAhB5B;AAiB4B;EACI,qCAAA;AAfhC;AAoBoB;EACI,eAAA;AAlBxB;AAmBwB;EACI,qCAAA;AAjB5B;AAhEA;EAyFY,OAAA;EACA,kBAAA;AAtBZ;AApEA;EA8FY,kBAAA;EACA,MAAA;EACA,OAAA;EACA,WAAA;EACA,YAAA;EACA,oBAAA;EACA,YAAA;EACA,mCAAA;EACA,mBAAA;AAvBZ;AA/EA;EA0GY,gBAAA;EACA,aAAA;EACA,OAAA;EAEA,WAAA;EACA,mBAAA;AAzBZ;AAtFA;EAkHgB,YAAA;EACA,YAAA;EACA,UAAA;EACA,gBAAA;EACA,YAAA;AAzBhB;AA7FA;EA0HgB,kBAAA;EAEA,WAAA;EACA,YAAA;EAEA,qBAAA;EAEA,aAAA;AA7BhB;AApGA;EAqIgB,eAAA;EAEA,aAAA;EACA,mBAAA;EACA,uBAAA;EAEA,WAAA;EACA,YAAA;EAEA,8BAAA;EACA,uCAAA;AAjChB;AAmCgB;EACI,2BAAA;EACA,mBAAA;AAjCpB",sourcesContent:[".formula-box {\n    display: flex;\n\n    box-sizing: border-box;\n    height: 28px;\n\n    background: rgb(var(--bg-color-secondary));\n    border-bottom: 1px solid rgb(var(--border-color));\n\n    transition: height 0.15s;\n\n    .name-ranges {\n        box-sizing: border-box;\n        width: 100px;\n        height: 100%;\n        position: relative;\n    }\n\n    .formula-bar {\n        display: flex;\n        width: 100%;\n        height: 100%;\n\n        .formula-icon {\n            padding: 6px 0;\n\n            &-disable {\n                color: rgb(var(--grey-200));\n                cursor: not-allowed;\n            }\n\n            &-wrapper {\n                position: relative;\n\n                display: flex;\n                // gap: var(--margin-xs);\n                align-items: center;\n                justify-content: center;\n\n                box-sizing: border-box;\n                width: 80px;\n                height: 100%;\n\n                font-size: var(--font-size-xs);\n\n                border-right: 1px solid rgb(var(--border-color));\n\n                .icon-container {\n                    display: flex;\n                    align-items: center;\n                    justify-content: center;\n\n                    padding: var(--padding-xs);\n\n                    font-size: var(--font-size-lg);\n\n                    border-radius: var(--border-radius-base);\n\n                    &-success {\n                        &.formula-active {\n                            cursor: pointer;\n                            color: rgb(var(--success-color));\n                            &:hover {\n                                background-color: rgb(var(--grey-50));\n                            }\n                        }\n                    }\n\n                    &-error {\n                        &.formula-active {\n                            cursor: pointer;\n                            color: rgb(var(--error-color));\n                            &:hover {\n                                background-color: rgb(var(--grey-50));\n                            }\n                        }\n                    }\n\n                    &-fx {\n                        cursor: pointer;\n                        &:hover {\n                            background-color: rgb(var(--grey-50));\n                        }\n                    }\n                }\n            }\n        }\n\n        .formula-input {\n            flex: 1;\n            position: relative;\n        }\n\n        .formula-input-mask {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            pointer-events: none;\n            z-index: 100;\n            background: rgb(var(--color-white));\n            cursor: not-allowed;\n        }\n\n        .formula-container {\n            overflow: hidden;\n            display: flex;\n            flex: 1;\n\n            width: 100%;\n            padding: 0 0 0 10px;\n\n            .sheet-embedding-formula-editor-wrap {\n                height: auto;\n                border: none;\n                padding: 0;\n                border-radius: 0;\n                height: 100%;\n            }\n\n            .formula-content {\n                position: relative;\n\n                width: 100%;\n                height: 100%;\n\n                word-wrap: break-word;\n\n                outline: none;\n            }\n\n            .arrow-container {\n                cursor: pointer;\n\n                display: flex;\n                align-items: center;\n                justify-content: center;\n\n                width: 20px;\n                height: 100%;\n\n                font-size: var(--font-size-xs);\n                color: rgb(var(--text-color-secondary));\n\n                &-disable {\n                    color: rgb(var(--grey-200));\n                    cursor: not-allowed;\n                }\n            }\n        }\n    }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={formulaBox:"univer-formula-box",nameRanges:"univer-name-ranges",formulaBar:"univer-formula-bar",formulaIcon:"univer-formula-icon",formulaIconDisable:"univer-formula-icon-disable",formulaIconWrapper:"univer-formula-icon-wrapper",iconContainer:"univer-icon-container",iconContainerSuccess:"univer-icon-container-success",formulaActive:"univer-formula-active",iconContainerError:"univer-icon-container-error",iconContainerFx:"univer-icon-container-fx",formulaInput:"univer-formula-input",formulaInputMask:"univer-formula-input-mask",formulaContainer:"univer-formula-container",sheetEmbeddingFormulaEditorWrap:"univer-sheet-embedding-formula-editor-wrap",formulaContent:"univer-formula-content",arrowContainer:"univer-arrow-container",arrowContainerDisable:"univer-arrow-container-disable"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/mobile/sheet-bar/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-mobile-sheet-bar-container {\n  width: 100%;\n  overflow-x: scroll;\n  height: 32px;\n  background-color: rgb(var(--bg-color));\n}\n.univer-mobile-sheet-bar-slider {\n  display: flex;\n  flex-wrap: nowrap;\n  align-items: center;\n  height: 32px;\n}\n.univer-mobile-sheet-bar-item {\n  align-items: center;\n  box-sizing: border-box;\n  flex-grow: 1;\n  flex-shrink: 0;\n  flex-wrap: nowrap;\n  font-size: 12px;\n  height: 100%;\n  line-height: 28px;\n  min-width: 48px;\n  overflow: hidden;\n  padding: 2px 4px;\n  text-align: center;\n  white-space: nowrap;\n  border-right: 1px solid rgb(var(--border-color));\n  background-color: rgb(var(--bg-color));\n  text-overflow: ellipsis;\n  max-width: 120px;\n}\n.univer-mobile-sheet-bar-item.univer-mobile-sheet-bar-item-activated {\n  color: rgb(var(--primary-color));\n  background-color: rgb(var(--bg-color-secondary));\n}\n","",{version:3,sources:["webpack://./../../packages/sheets-ui/src/views/mobile/sheet-bar/index.module.less"],names:[],mappings:"AACI;EACI,WAAA;EACA,kBAAA;EACA,YAAA;EACA,sCAAA;AAAR;AAGI;EACI,aAAA;EACA,iBAAA;EACA,mBAAA;EACA,YAAA;AADR;AAII;EACI,mBAAA;EACA,sBAAA;EACA,YAAA;EACA,cAAA;EACA,iBAAA;EACA,eAAA;EACA,YAAA;EACA,iBAAA;EACA,eAAA;EACA,gBAAA;EACA,gBAAA;EACA,kBAAA;EACA,mBAAA;EACA,gDAAA;EACA,sCAAA;EACA,uBAAA;EACA,gBAAA;AAFR;AAIQ;EACI,gCAAA;EACA,gDAAA;AAFZ",sourcesContent:[".mobile-sheet-bar {\n    &-container {\n        width: 100%;\n        overflow-x: scroll;\n        height: 32px;\n        background-color: rgb(var(--bg-color));\n    }\n\n    &-slider {\n        display: flex;\n        flex-wrap: nowrap;\n        align-items: center;\n        height: 32px;\n    }\n\n    &-item {\n        align-items: center;\n        box-sizing: border-box;\n        flex-grow: 1;\n        flex-shrink: 0;\n        flex-wrap: nowrap;\n        font-size: 12px;\n        height: 100%;\n        line-height: 28px;\n        min-width: 48px;\n        overflow: hidden;\n        padding: 2px 4px;\n        text-align: center;\n        white-space: nowrap;\n        border-right: 1px solid rgb(var(--border-color));\n        background-color: rgb(var(--bg-color));\n        text-overflow: ellipsis;\n        max-width: 120px;\n\n        &.mobile-sheet-bar-item-activated {\n            color: rgb(var(--primary-color));\n            background-color: rgb(var(--bg-color-secondary));\n        }\n    }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={mobileSheetBarContainer:"univer-mobile-sheet-bar-container",mobileSheetBarSlider:"univer-mobile-sheet-bar-slider",mobileSheetBarItem:"univer-mobile-sheet-bar-item",mobileSheetBarItemActivated:"univer-mobile-sheet-bar-item-activated"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/permission/error-msg-dialog/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-sheet-permission-alert-dialog {\n  padding: var(--padding-xl) 24px;\n}\n.univer-sheet-permission-alert-dialog-title {\n  font-size: var(--font-size-lg);\n  font-weight: 500;\n  margin-bottom: var(--margin-base);\n}\n.univer-sheet-permission-alert-dialog-button {\n  margin-top: var(--margin-lg);\n  display: flex;\n  justify-content: flex-end;\n}\n.sheet-permission-user-dialog .univer-dialog-close {\n  display: none;\n}\n.sheet-permission-user-dialog .univer-dialog-header {\n  display: none;\n}\n.sheet-permission-user-dialog .univer-dialog-body {\n  padding: 0;\n}\n","",{version:3,sources:["webpack://./../../packages/sheets-ui/src/views/permission/error-msg-dialog/index.module.less"],names:[],mappings:"AAAA;EACI,+BAAA;AACJ;AACI;EACI,8BAAA;EACA,gBAAA;EACA,iCAAA;AACR;AAGA;EACI,4BAAA;EACA,aAAA;EACA,yBAAA;AADJ;AAKA;EACI,aAAA;AAHJ;AAMA;EACI,aAAA;AAJJ;AAOA;EACI,UAAA;AALJ",sourcesContent:[".sheet-permission-alert-dialog {\n    padding: var(--padding-xl) 24px;\n\n    &-title {\n        font-size: var(--font-size-lg);\n        font-weight: 500;\n        margin-bottom: var(--margin-base);\n    }\n}\n\n.sheet-permission-alert-dialog-button {\n    margin-top: var(--margin-lg);\n    display: flex;\n    justify-content: flex-end;\n}\n\n// @ybzky todo need more freedom to modify container style schemes\n:global(.sheet-permission-user-dialog .univer-dialog-close) {\n    display: none;\n}\n\n:global(.sheet-permission-user-dialog .univer-dialog-header) {\n    display: none;\n}\n\n:global(.sheet-permission-user-dialog .univer-dialog-body) {\n    padding: 0;\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={sheetPermissionAlertDialog:"univer-sheet-permission-alert-dialog",sheetPermissionAlertDialogTitle:"univer-sheet-permission-alert-dialog-title",sheetPermissionAlertDialogButton:"univer-sheet-permission-alert-dialog-button"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/permission/panel-detail/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-permission-panel-detail-wrapper {\n  margin-top: 16px;\n  height: calc(100% - 16px);\n  display: flex;\n  flex-direction: column;\n}\n.univer-radio-group-vertical {\n  display: flex;\n  flex-direction: column;\n  font-weight: 400;\n}\n.univer-sheet-permission-design-person-panel {\n  height: 270px;\n  border: 1px solid rgb(var(--grey-200));\n  border-radius: var(--border-radius-lg);\n  padding: var(--padding-base);\n  margin-bottom: var(--margin-xs);\n  display: flex;\n  flex-direction: column;\n}\n.univer-sheet-permission-design-person-panel-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.univer-sheet-permission-design-person-panel-header-add {\n  cursor: pointer;\n  color: rgb(var(--blue-500));\n}\n.univer-sheet-permission-design-person-panel-split {\n  height: 1px;\n  background-color: rgb(var(--grey-200));\n  margin: var(--margin-xs) 0;\n}\n.univer-sheet-permission-design-person-panel-content-item {\n  height: 28px;\n  line-height: 28px;\n  margin-bottom: var(--margin-sm);\n  display: flex;\n  align-items: center;\n}\n.univer-sheet-permission-design-person-panel-content-item:last-child {\n  margin-bottom: 0;\n}\n.univer-sheet-permission-design-person-panel-content-item-name {\n  width: 130px;\n  color: rgb(var(--color-black));\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  margin-left: 6px;\n}\n.univer-sheet-permission-design-person-panel-content-item-select {\n  width: 90px;\n  cursor: pointer;\n}\n.univer-sheet-permission-design-person-panel .univer-sheet-permission-design-person-panel-content-item-select.univer-select-single:not(\n                .univer-select-customize-input\n            ) .univer-select-selector {\n  border: none;\n  padding: 0;\n  color: rgb(var(--grey-900));\n}\n.univer-sheet-permission-design-person-panel .univer-sheet-permission-design-person-panel-content-item-select.univer-select-show-arrow .univer-select-arrow {\n  right: 0;\n}\n.univer-sheet-permission-design-person-panel-content {\n  flex: 1;\n}\n.univer-sheet-permission-user-list-empty {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n}\n.univer-sheet-permission-user-list-empty-text {\n  width: 240px;\n  word-wrap: break-word;\n  color: rgb(var(--grey-400));\n  font-size: 13px;\n}\n.univer-sheet-permission-panel-title {\n  font-weight: 500;\n}\n.univer-sheet-permission-panel-footer {\n  display: flex;\n  flex-direction: row-reverse;\n  padding: 20px 0;\n  margin-top: auto;\n}\n.univer-sheet-permission-panel-footer button:first-child {\n  margin-left: 8px;\n}\n.univer-permission-range-selector {\n  font-weight: 400;\n}\n.univer-permission-range-selector-error,\n.univer-sheet-permission-panel-name-input-error {\n  border: 1px solid rgb(var(--red-400));\n}\n.univer-permission-range-selector-error:hover,\n.univer-sheet-permission-panel-name-input-error:hover {\n  border: 1px solid rgb(var(--red-400));\n}\n.univer-permission-range-selector-error-text,\n.univer-sheet-permission-panel-name-input-error-text {\n  height: 20px;\n  line-height: 20px;\n  color: rgb(var(--red-400));\n  font-size: var(--font-size-xs);\n  font-weight: 400;\n}\n","",{version:3,sources:["webpack://./../../packages/sheets-ui/src/views/permission/panel-detail/index.module.less"],names:[],mappings:"AAAA;EACI,gBAAA;EACA,yBAAA;EACA,aAAA;EACA,sBAAA;AACJ;AAEA;EACI,aAAA;EACA,sBAAA;EACA,gBAAA;AAAJ;AAGA;EACI,aAAA;EACA,sCAAA;EACA,sCAAA;EACA,4BAAA;EACA,+BAAA;EACA,aAAA;EACA,sBAAA;AADJ;AAGI;EACI,aAAA;EACA,8BAAA;EACA,mBAAA;AADR;AAGQ;EACI,eAAA;EACA,2BAAA;AADZ;AAKI;EACI,WAAA;EACA,sCAAA;EACA,0BAAA;AAHR;AAOQ;EACI,YAAA;EACA,iBAAA;EACA,+BAAA;EACA,aAAA;EACA,mBAAA;AALZ;AAOY;EACI,gBAAA;AALhB;AAQY;EACI,YAAA;EACA,8BAAA;EACA,mBAAA;EACA,gBAAA;EACA,uBAAA;EACA,gBAAA;AANhB;AASY;EACI,WAAA;EACA,eAAA;AAPhB;AA1CA;;;EA4DQ,YAAA;EACA,UAAA;EACA,2BAAA;AAbR;AAjDA;EAoEQ,QAAA;AAdR;AAkBA;EACI,OAAA;AAhBJ;AAmBA;EACI,aAAA;EACA,sBAAA;EACA,mBAAA;EACA,uBAAA;EACA,YAAA;AAjBJ;AAoBA;EACI,YAAA;EACA,qBAAA;EACA,2BAAA;EACA,eAAA;AAlBJ;AAqBA;EACI,gBAAA;AAnBJ;AAsBA;EACI,aAAA;EACA,2BAAA;EACA,eAAA;EACA,gBAAA;AApBJ;AAuBQ;EACI,gBAAA;AArBZ;AA0BA;EACI,gBAAA;AAxBJ;AA2BA;;EAEI,qCAAA;AAzBJ;AA2BI;;EACI,qCAAA;AAxBR;AA2BI;;EACI,YAAA;EACA,iBAAA;EACA,0BAAA;EACA,8BAAA;EACA,gBAAA;AAxBR",sourcesContent:[".permission-panel-detail-wrapper {\n    margin-top: 16px;\n    height: calc(100% - 16px);\n    display: flex;\n    flex-direction: column;\n}\n\n.radio-group-vertical {\n    display: flex;\n    flex-direction: column;\n    font-weight: 400;\n}\n\n.sheet-permission-design-person-panel {\n    height: 270px;\n    border: 1px solid rgb(var(--grey-200));\n    border-radius: var(--border-radius-lg);\n    padding: var(--padding-base);\n    margin-bottom: var(--margin-xs);\n    display: flex;\n    flex-direction: column;\n\n    &-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n\n        &-add {\n            cursor: pointer;\n            color: rgb(var(--blue-500));\n        }\n    }\n\n    &-split {\n        height: 1px;\n        background-color: rgb(var(--grey-200));\n        margin: var(--margin-xs) 0;\n    }\n\n    &-content {\n        &-item {\n            height: 28px;\n            line-height: 28px;\n            margin-bottom: var(--margin-sm);\n            display: flex;\n            align-items: center;\n\n            &:last-child {\n                margin-bottom: 0;\n            }\n\n            &-name {\n                width: 130px;\n                color: rgb(var(--color-black));\n                white-space: nowrap;\n                overflow: hidden;\n                text-overflow: ellipsis;\n                margin-left: 6px;\n            }\n\n            &-select {\n                width: 90px;\n                cursor: pointer;\n            }\n        }\n    }\n\n    :global(\n        .univer-sheet-permission-design-person-panel-content-item-select.univer-select-single:not(\n                .univer-select-customize-input\n            )\n            .univer-select-selector\n    ) {\n        border: none;\n        padding: 0;\n        color: rgb(var(--grey-900));\n    }\n\n    :global(\n        .univer-sheet-permission-design-person-panel-content-item-select.univer-select-show-arrow .univer-select-arrow\n    ) {\n        right: 0;\n    }\n}\n\n.sheet-permission-design-person-panel-content {\n    flex: 1;\n}\n\n.sheet-permission-user-list-empty {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n}\n\n.sheet-permission-user-list-empty-text {\n    width: 240px;\n    word-wrap: break-word;\n    color: rgb(var(--grey-400));\n    font-size: 13px;\n}\n\n.sheet-permission-panel-title {\n    font-weight: 500;\n}\n\n.sheet-permission-panel-footer {\n    display: flex;\n    flex-direction: row-reverse;\n    padding: 20px 0;\n    margin-top: auto;\n\n    button {\n        &:first-child {\n            margin-left: 8px;\n        }\n    }\n}\n\n.permission-range-selector {\n    font-weight: 400;\n}\n\n.permission-range-selector-error,\n.sheet-permission-panel-name-input-error {\n    border: 1px solid rgb(var(--red-400));\n\n    &:hover {\n        border: 1px solid rgb(var(--red-400));\n    }\n\n    &-text {\n        height: 20px;\n        line-height: 20px;\n        color: rgb(var(--red-400));\n        font-size: var(--font-size-xs);\n        font-weight: 400;\n    }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={permissionPanelDetailWrapper:"univer-permission-panel-detail-wrapper",radioGroupVertical:"univer-radio-group-vertical",sheetPermissionDesignPersonPanel:"univer-sheet-permission-design-person-panel",sheetPermissionDesignPersonPanelHeader:"univer-sheet-permission-design-person-panel-header",sheetPermissionDesignPersonPanelHeaderAdd:"univer-sheet-permission-design-person-panel-header-add",sheetPermissionDesignPersonPanelSplit:"univer-sheet-permission-design-person-panel-split",sheetPermissionDesignPersonPanelContentItem:"univer-sheet-permission-design-person-panel-content-item",sheetPermissionDesignPersonPanelContentItemName:"univer-sheet-permission-design-person-panel-content-item-name",sheetPermissionDesignPersonPanelContentItemSelect:"univer-sheet-permission-design-person-panel-content-item-select",sheetPermissionDesignPersonPanelContent:"univer-sheet-permission-design-person-panel-content",sheetPermissionUserListEmpty:"univer-sheet-permission-user-list-empty",sheetPermissionUserListEmptyText:"univer-sheet-permission-user-list-empty-text",sheetPermissionPanelTitle:"univer-sheet-permission-panel-title",sheetPermissionPanelFooter:"univer-sheet-permission-panel-footer",permissionRangeSelector:"univer-permission-range-selector",permissionRangeSelectorError:"univer-permission-range-selector-error",sheetPermissionPanelNameInputError:"univer-sheet-permission-panel-name-input-error",permissionRangeSelectorErrorText:"univer-permission-range-selector-error-text",sheetPermissionPanelNameInputErrorText:"univer-sheet-permission-panel-name-input-error-text"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/permission/panel-list/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-sheet-permission-list-panel-wrapper {\n  margin-top: var(--margin-xs);\n  height: calc(100% - 8px);\n  display: flex;\n  flex-direction: column;\n}\n.univer-sheet-permission-list-panel-header {\n  display: flex;\n  padding: var(--padding-sm) 0;\n  height: 30px;\n}\n.univer-sheet-permission-list-panel-header-type {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin-right: var(--margin-lg);\n  cursor: pointer;\n}\n.univer-sheet-permission-list-panel-header-type div {\n  height: 24px;\n  line-height: 24px;\n}\n.univer-sheet-permission-list-panel-header-type-bottom {\n  height: 2px;\n  width: 24px;\n  background-color: rgb(var(--blue-500));\n  margin-top: var(--margin-xxs);\n}\n.univer-sheet-permission-list-panel-header-select {\n  color: rgb(var(--blue-500));\n  height: 24px;\n  line-height: 24px;\n  font-size: var(--font-size-lg);\n  font-weight: 500;\n}\n.univer-sheet-permission-list-item-header-icon {\n  border-radius: var(--border-radius-base);\n  height: 24px;\n  padding: 4px;\n  box-sizing: border-box;\n}\n.univer-sheet-permission-list-item-header-icon:hover {\n  background-color: rgb(var(--grey-200));\n}\n.univer-sheet-permission-list-item {\n  margin-top: var(--margin-sm);\n  border-radius: var(--border-radius-lg);\n  border: 1px solid rgb(var(--grey-200));\n  padding: var(--padding-base);\n}\n.univer-sheet-permission-list-item:hover {\n  background-color: rgb(var(--grey-50));\n}\n.univer-sheet-permission-list-item-header {\n  height: 20px;\n  line-height: 20px;\n  display: flex;\n  justify-content: space-between;\n}\n.univer-sheet-permission-list-item-header-name {\n  font-weight: 500;\n  max-width: 200px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.univer-sheet-permission-list-item-header-operator {\n  display: flex;\n  align-items: center;\n}\n.univer-sheet-permission-list-item-header-operator div {\n  margin-left: var(--margin-xs);\n}\n.univer-sheet-permission-list-item-split {\n  height: 1px;\n  background-color: rgb(var(--grey-200));\n  margin: var(--margin-xs) 0;\n}\n.univer-sheet-permission-list-item-content-edit {\n  display: flex;\n  align-items: center;\n}\n.univer-sheet-permission-list-item-content-view {\n  display: flex;\n  align-items: center;\n  margin-top: var(--margin-xs);\n}\n.univer-sheet-permission-list-item-content-desc {\n  font-size: 12px;\n  color: rgb(var(--grey-400));\n  max-width: 256px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  margin-top: var(--margin-xs);\n}\n.univer-sheet-permission-list-empty {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  flex: 1;\n}\n.univer-sheet-permission-list-empty-text {\n  width: 240px;\n  word-wrap: break-word;\n  color: rgb(var(--grey-400));\n  font-size: 13px;\n}\n.univer-sheet-permission-list-item-content-title {\n  font-size: 12px;\n  height: 16px;\n  line-height: 16px;\n  flex-grow: 1;\n  color: rgb(var(--color-black));\n}\n.univer-sheet-permission-list-item-content-sub {\n  font-size: 12px;\n  height: 16px;\n  line-height: 16px;\n  color: rgb(var(--grey-600));\n}\n.univer-sheet-permission-panel-add-wrapper {\n  padding: 20px 0;\n  margin-top: auto;\n}\n.univer-sheet-permission-panel-add-button {\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.univer-sheet-permission-panel-add-button div {\n  margin-right: 4px;\n}\n","",{version:3,sources:["webpack://./../../packages/sheets-ui/src/views/permission/panel-list/index.module.less"],names:[],mappings:"AAAA;EACI,4BAAA;EACA,wBAAA;EACA,aAAA;EACA,sBAAA;AACJ;AAEA;EACI,aAAA;EACA,4BAAA;EACA,YAAA;AAAJ;AAEI;EACI,aAAA;EACA,sBAAA;EACA,mBAAA;EACA,8BAAA;EACA,eAAA;AAAR;AALI;EAQQ,YAAA;EACA,iBAAA;AAAZ;AAGQ;EACI,WAAA;EACA,WAAA;EACA,sCAAA;EACA,6BAAA;AADZ;AAKI;EACI,2BAAA;EACA,YAAA;EACA,iBAAA;EACA,8BAAA;EACA,gBAAA;AAHR;AAOA;EACI,wCAAA;EAMA,YAAA;EACA,YAAA;EACA,sBAAA;AAVJ;AAII;EACI,sCAAA;AAFR;AAUA;EACI,4BAAA;EACA,sCAAA;EACA,sCAAA;EACA,4BAAA;AARJ;AAUI;EACI,qCAAA;AARR;AAWI;EACI,YAAA;EACA,iBAAA;EAEA,aAAA;EACA,8BAAA;AAVR;AAYQ;EACI,gBAAA;EACA,gBAAA;EACA,mBAAA;EACA,gBAAA;EACA,uBAAA;AAVZ;AAaQ;EACI,aAAA;EACA,mBAAA;AAXZ;AASQ;EAKQ,6BAAA;AAXhB;AAgBI;EACI,WAAA;EACA,sCAAA;EACA,0BAAA;AAdR;AAkBQ;EACI,aAAA;EACA,mBAAA;AAhBZ;AAmBQ;EACI,aAAA;EACA,mBAAA;EACA,4BAAA;AAjBZ;AAoBQ;EACI,eAAA;EACA,2BAAA;EACA,gBAAA;EACA,mBAAA;EACA,gBAAA;EACA,uBAAA;EACA,4BAAA;AAlBZ;AAuBA;EACI,aAAA;EACA,sBAAA;EACA,mBAAA;EACA,uBAAA;EACA,OAAA;AArBJ;AAwBA;EACI,YAAA;EACA,qBAAA;EACA,2BAAA;EACA,eAAA;AAtBJ;AAyBA;EACI,eAAA;EACA,YAAA;EACA,iBAAA;EACA,YAAA;EACA,8BAAA;AAvBJ;AA0BA;EACI,eAAA;EACA,YAAA;EACA,iBAAA;EACA,2BAAA;AAxBJ;AA2BA;EACI,eAAA;EACA,gBAAA;AAzBJ;AA4BA;EACI,WAAA;EACA,aAAA;EACA,mBAAA;EACA,uBAAA;AA1BJ;AAsBA;EAOQ,iBAAA;AA1BR",sourcesContent:[".sheet-permission-list-panel-wrapper {\n    margin-top: var(--margin-xs);\n    height: calc(100% - 8px);\n    display: flex;\n    flex-direction: column;\n}\n\n.sheet-permission-list-panel-header {\n    display: flex;\n    padding: var(--padding-sm) 0;\n    height: 30px;\n\n    &-type {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        margin-right: var(--margin-lg);\n        cursor: pointer;\n\n        div {\n            height: 24px;\n            line-height: 24px;\n        }\n\n        &-bottom {\n            height: 2px;\n            width: 24px;\n            background-color: rgb(var(--blue-500));\n            margin-top: var(--margin-xxs);\n        }\n    }\n\n    &-select {\n        color: rgb(var(--blue-500));\n        height: 24px;\n        line-height: 24px;\n        font-size: var(--font-size-lg);\n        font-weight: 500;\n    }\n}\n\n.sheet-permission-list-item-header-icon {\n    border-radius: var(--border-radius-base);\n\n    &:hover {\n        background-color: rgb(var(--grey-200));\n    }\n\n    height: 24px;\n    padding: 4px;\n    box-sizing: border-box;\n}\n\n.sheet-permission-list-item {\n    margin-top: var(--margin-sm);\n    border-radius: var(--border-radius-lg);\n    border: 1px solid rgb(var(--grey-200));\n    padding: var(--padding-base);\n\n    &:hover {\n        background-color: rgb(var(--grey-50));\n    }\n\n    &-header {\n        height: 20px;\n        line-height: 20px;\n\n        display: flex;\n        justify-content: space-between;\n\n        &-name {\n            font-weight: 500;\n            max-width: 200px;\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n        }\n\n        &-operator {\n            display: flex;\n            align-items: center;\n\n            div {\n                margin-left: var(--margin-xs);\n            }\n        }\n    }\n\n    &-split {\n        height: 1px;\n        background-color: rgb(var(--grey-200));\n        margin: var(--margin-xs) 0;\n    }\n\n    &-content {\n        &-edit {\n            display: flex;\n            align-items: center;\n        }\n\n        &-view {\n            display: flex;\n            align-items: center;\n            margin-top: var(--margin-xs);\n        }\n\n        &-desc {\n            font-size: 12px;\n            color: rgb(var(--grey-400));\n            max-width: 256px;\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            margin-top: var(--margin-xs);\n        }\n    }\n}\n\n.sheet-permission-list-empty {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    flex: 1;\n}\n\n.sheet-permission-list-empty-text {\n    width: 240px;\n    word-wrap: break-word;\n    color: rgb(var(--grey-400));\n    font-size: 13px;\n}\n\n.sheet-permission-list-item-content-title {\n    font-size: 12px;\n    height: 16px;\n    line-height: 16px;\n    flex-grow: 1;\n    color: rgb(var(--color-black));\n}\n\n.sheet-permission-list-item-content-sub {\n    font-size: 12px;\n    height: 16px;\n    line-height: 16px;\n    color: rgb(var(--grey-600));\n}\n\n.sheet-permission-panel-add-wrapper {\n    padding: 20px 0;\n    margin-top: auto;\n}\n\n.sheet-permission-panel-add-button {\n    width: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    div {\n        margin-right: 4px;\n    }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={sheetPermissionListPanelWrapper:"univer-sheet-permission-list-panel-wrapper",sheetPermissionListPanelHeader:"univer-sheet-permission-list-panel-header",sheetPermissionListPanelHeaderType:"univer-sheet-permission-list-panel-header-type",sheetPermissionListPanelHeaderTypeBottom:"univer-sheet-permission-list-panel-header-type-bottom",sheetPermissionListPanelHeaderSelect:"univer-sheet-permission-list-panel-header-select",sheetPermissionListItemHeaderIcon:"univer-sheet-permission-list-item-header-icon",sheetPermissionListItem:"univer-sheet-permission-list-item",sheetPermissionListItemHeader:"univer-sheet-permission-list-item-header",sheetPermissionListItemHeaderName:"univer-sheet-permission-list-item-header-name",sheetPermissionListItemHeaderOperator:"univer-sheet-permission-list-item-header-operator",sheetPermissionListItemSplit:"univer-sheet-permission-list-item-split",sheetPermissionListItemContentEdit:"univer-sheet-permission-list-item-content-edit",sheetPermissionListItemContentView:"univer-sheet-permission-list-item-content-view",sheetPermissionListItemContentDesc:"univer-sheet-permission-list-item-content-desc",sheetPermissionListEmpty:"univer-sheet-permission-list-empty",sheetPermissionListEmptyText:"univer-sheet-permission-list-empty-text",sheetPermissionListItemContentTitle:"univer-sheet-permission-list-item-content-title",sheetPermissionListItemContentSub:"univer-sheet-permission-list-item-content-sub",sheetPermissionPanelAddWrapper:"univer-sheet-permission-panel-add-wrapper",sheetPermissionPanelAddButton:"univer-sheet-permission-panel-add-button"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/permission/permission-dialog/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-sheet-permission-dialog-wrapper {\n  display: flex;\n  flex-direction: column;\n  padding: 2px;\n}\n.univer-sheet-permission-dialog-split {\n  height: 1px;\n  background-color: rgb(var(--grey-200));\n}\n.univer-sheet-permission-dialog-item {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  height: 20px;\n  line-height: 20px;\n  margin: 6px 0;\n}\n.univer-sheet-permission-user-dialog-footer {\n  height: 36px;\n  padding: var(--padding-xs) 0;\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  margin-top: var(--margin-xs);\n}\n.univer-sheet-permission-user-dialog-footer-confirm {\n  margin-left: var(--margin-sm);\n}\n.univer-sheet-permission-user-dialog-button {\n  height: 32px;\n  line-height: 32px;\n  padding: 0px var(--padding-base);\n}\n","",{version:3,sources:["webpack://./../../packages/sheets-ui/src/views/permission/permission-dialog/index.module.less"],names:[],mappings:"AAAA;EACI,aAAA;EACA,sBAAA;EACA,YAAA;AACJ;AAEA;EACI,WAAA;EACA,sCAAA;AAAJ;AAGA;EACI,aAAA;EACA,mBAAA;EACA,8BAAA;EACA,YAAA;EACA,iBAAA;EACA,aAAA;AADJ;AAIA;EACI,YAAA;EACA,4BAAA;EACA,aAAA;EACA,yBAAA;EACA,mBAAA;EACA,4BAAA;AAFJ;AAII;EACI,6BAAA;AAFR;AAMA;EACI,YAAA;EACA,iBAAA;EACA,gCAAA;AAJJ",sourcesContent:[".sheet-permission-dialog-wrapper {\n    display: flex;\n    flex-direction: column;\n    padding: 2px;\n}\n\n.sheet-permission-dialog-split {\n    height: 1px;\n    background-color: rgb(var(--grey-200));\n}\n\n.sheet-permission-dialog-item {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    height: 20px;\n    line-height: 20px;\n    margin: 6px 0;\n}\n\n.sheet-permission-user-dialog-footer {\n    height: 36px;\n    padding: var(--padding-xs) 0;\n    display: flex;\n    justify-content: flex-end;\n    align-items: center;\n    margin-top: var(--margin-xs);\n\n    &-confirm {\n        margin-left: var(--margin-sm);\n    }\n}\n\n.sheet-permission-user-dialog-button {\n    height: 32px;\n    line-height: 32px;\n    padding: 0px var(--padding-base);\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={sheetPermissionDialogWrapper:"univer-sheet-permission-dialog-wrapper",sheetPermissionDialogSplit:"univer-sheet-permission-dialog-split",sheetPermissionDialogItem:"univer-sheet-permission-dialog-item",sheetPermissionUserDialogFooter:"univer-sheet-permission-user-dialog-footer",sheetPermissionUserDialogFooterConfirm:"univer-sheet-permission-user-dialog-footer-confirm",sheetPermissionUserDialogButton:"univer-sheet-permission-user-dialog-button"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/permission/spin/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-spin-container {\n  position: relative;\n  width: 100%;\n  height: 100%;\n}\n.univer-spin-overlay {\n  position: absolute;\n  top: -2px;\n  left: -2px;\n  right: -2px;\n  bottom: -2px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  backdrop-filter: blur(10px);\n  background-color: rgba(255, 255, 255, 0.5);\n  z-index: 10;\n}\n.univer-spinner {\n  width: 40px;\n  height: 40px;\n  border: 4px solid #f3f3f3;\n  border-top: 4px solid #3498db;\n  border-radius: 50%;\n  animation: univer-spin 2s linear infinite;\n}\n.univer-content-blur {\n  filter: blur(2px);\n  pointer-events: none;\n}\n@keyframes univer-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n","",{version:3,sources:["webpack://./../../packages/sheets-ui/src/views/permission/spin/index.module.less"],names:[],mappings:"AAAA;EACI,kBAAA;EACA,WAAA;EACA,YAAA;AACJ;AAEA;EACI,kBAAA;EACA,SAAA;EACA,UAAA;EACA,WAAA;EACA,YAAA;EACA,aAAA;EACA,uBAAA;EACA,mBAAA;EACA,2BAAA;EACA,0CAAA;EACA,WAAA;AAAJ;AAGA;EACI,WAAA;EACA,YAAA;EACA,yBAAA;EACA,6BAAA;EACA,kBAAA;EACA,yCAAA;AADJ;AAIA;EACI,iBAAA;EACA,oBAAA;AAFJ;AAKA;EACI;IACI,uBAAA;EAHN;EAKE;IACI,yBAAA;EAHN;AACF",sourcesContent:[".spin-container {\n    position: relative;\n    width: 100%;\n    height: 100%;\n}\n\n.spin-overlay {\n    position: absolute;\n    top: -2px;\n    left: -2px;\n    right: -2px;\n    bottom: -2px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    backdrop-filter: blur(10px);\n    background-color: rgba(255, 255, 255, 0.5);\n    z-index: 10;\n}\n\n.spinner {\n    width: 40px;\n    height: 40px;\n    border: 4px solid #f3f3f3;\n    border-top: 4px solid #3498db;\n    border-radius: 50%;\n    animation: spin 2s linear infinite;\n}\n\n.content-blur {\n    filter: blur(2px);\n    pointer-events: none;\n}\n\n@keyframes spin {\n    0% {\n        transform: rotate(0deg);\n    }\n    100% {\n        transform: rotate(360deg);\n    }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={spinContainer:"univer-spin-container",spinOverlay:"univer-spin-overlay",spinner:"univer-spinner",spin:"univer-spin",contentBlur:"univer-content-blur"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/permission/user-dialog/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-sheet-permission-user-dialog-wrapper {\n  height: 329px;\n  padding: var(--padding-base);\n  box-sizing: content-box;\n}\n.univer-sheet-permission-user-dialog-search-input {\n  width: 256px;\n  height: 32px;\n}\n.univer-sheet-permission-user-list {\n  height: 240px;\n  overflow-y: auto;\n}\n.univer-sheet-permission-user-list-empty {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n}\n.univer-sheet-permission-user-list-empty-text {\n  width: 240px;\n  word-wrap: break-word;\n  color: rgb(var(--grey-400));\n  font-size: 13px;\n}\n.univer-sheet-permission-user-item {\n  display: flex;\n  align-items: center;\n  margin: var(--margin-xs) 0;\n  border-radius: 6px;\n  padding: var(--padding-xs) var(--padding-sm);\n}\n.univer-sheet-permission-user-item:hover {\n  background-color: rgb(var(--grey-50));\n}\n.univer-sheet-permission-user-item div {\n  margin-left: 6px;\n}\n.univer-sheet-permission-user-item-name {\n  width: 186px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.univer-sheet-permission-split {\n  height: 1px;\n  background-color: rgb(var(--grey-200));\n}\n.univer-sheet-permission-user-dialog-footer {\n  height: 36px;\n  padding: var(--padding-xs) 0;\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  margin-top: var(--margin-xs);\n  height: 28px;\n}\n.univer-sheet-permission-user-dialog-footer-confirm {\n  margin-left: var(--margin-sm);\n}\n.univer-sheet-permission-user-dialog-button {\n  height: 28px;\n  line-height: 28px;\n  padding: 0px var(--padding-base);\n}\n.sheet-permission-user-dialog .univer-dialog-close {\n  display: none;\n}\n.sheet-permission-user-dialog .univer-dialog-header {\n  display: none;\n}\n.sheet-permission-user-dialog .univer-dialog-body {\n  padding: 0;\n}\n","",{version:3,sources:["webpack://./../../packages/sheets-ui/src/views/permission/user-dialog/index.module.less"],names:[],mappings:"AAAA;EACI,aAAA;EACA,4BAAA;EACA,uBAAA;AACJ;AAGI;EACI,YAAA;EACA,YAAA;AADR;AAKA;EACI,aAAA;EACA,gBAAA;AAHJ;AAMA;EACI,aAAA;EACA,sBAAA;EACA,mBAAA;EACA,uBAAA;EACA,YAAA;AAJJ;AAOA;EACI,YAAA;EACA,qBAAA;EACA,2BAAA;EACA,eAAA;AALJ;AAQA;EACI,aAAA;EACA,mBAAA;EACA,0BAAA;EACA,kBAAA;EACA,4CAAA;AANJ;AAQI;EACI,qCAAA;AANR;AAFA;EAYQ,gBAAA;AAPR;AAUI;EACI,YAAA;EACA,mBAAA;EACA,gBAAA;EACA,uBAAA;AARR;AAYA;EACI,WAAA;EACA,sCAAA;AAVJ;AAaA;EACI,YAAA;EACA,4BAAA;EACA,aAAA;EACA,yBAAA;EACA,mBAAA;EACA,4BAAA;EACA,YAAA;AAXJ;AAaI;EACI,6BAAA;AAXR;AAeA;EACI,YAAA;EACA,iBAAA;EACA,gCAAA;AAbJ;AAgBA;EACI,aAAA;AAdJ;AAiBA;EACI,aAAA;AAfJ;AAkBA;EACI,UAAA;AAhBJ",sourcesContent:[".sheet-permission-user-dialog-wrapper {\n    height: 329px;\n    padding: var(--padding-base);\n    box-sizing: content-box;\n}\n\n.sheet-permission-user-dialog-search {\n    &-input {\n        width: 256px;\n        height: 32px;\n    }\n}\n\n.sheet-permission-user-list {\n    height: 240px;\n    overflow-y: auto;\n}\n\n.sheet-permission-user-list-empty {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n}\n\n.sheet-permission-user-list-empty-text {\n    width: 240px;\n    word-wrap: break-word;\n    color: rgb(var(--grey-400));\n    font-size: 13px;\n}\n\n.sheet-permission-user-item {\n    display: flex;\n    align-items: center;\n    margin: var(--margin-xs) 0;\n    border-radius: 6px;\n    padding: var(--padding-xs) var(--padding-sm);\n\n    &:hover {\n        background-color: rgb(var(--grey-50));\n    }\n\n    div {\n        margin-left: 6px;\n    }\n\n    &-name {\n        width: 186px;\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n    }\n}\n\n.sheet-permission-split {\n    height: 1px;\n    background-color: rgb(var(--grey-200));\n}\n\n.sheet-permission-user-dialog-footer {\n    height: 36px;\n    padding: var(--padding-xs) 0;\n    display: flex;\n    justify-content: flex-end;\n    align-items: center;\n    margin-top: var(--margin-xs);\n    height: 28px;\n\n    &-confirm {\n        margin-left: var(--margin-sm);\n    }\n}\n\n.sheet-permission-user-dialog-button {\n    height: 28px;\n    line-height: 28px;\n    padding: 0px var(--padding-base);\n}\n\n:global(.sheet-permission-user-dialog .univer-dialog-close) {\n    display: none;\n}\n\n:global(.sheet-permission-user-dialog .univer-dialog-header) {\n    display: none;\n}\n\n:global(.sheet-permission-user-dialog .univer-dialog-body) {\n    padding: 0;\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={sheetPermissionUserDialogWrapper:"univer-sheet-permission-user-dialog-wrapper",sheetPermissionUserDialogSearchInput:"univer-sheet-permission-user-dialog-search-input",sheetPermissionUserList:"univer-sheet-permission-user-list",sheetPermissionUserListEmpty:"univer-sheet-permission-user-list-empty",sheetPermissionUserListEmptyText:"univer-sheet-permission-user-list-empty-text",sheetPermissionUserItem:"univer-sheet-permission-user-item",sheetPermissionUserItemName:"univer-sheet-permission-user-item-name",sheetPermissionSplit:"univer-sheet-permission-split",sheetPermissionUserDialogFooter:"univer-sheet-permission-user-dialog-footer",sheetPermissionUserDialogFooterConfirm:"univer-sheet-permission-user-dialog-footer-confirm",sheetPermissionUserDialogButton:"univer-sheet-permission-user-dialog-button"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/sheet-bar/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-sheet-bar {\n  min-width: calc(100% - 260px - 332px);\n  max-width: calc(100% - 260px);\n}\n.univer-sheet-bar-options {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin: var(--margin-xxs);\n  transition: display 0.2s;\n}\n.univer-sheet-bar-options-divider::after {\n  content: '';\n  display: block;\n  width: 1px;\n  height: 16px;\n  margin: 0 var(--margin-xs);\n  background-color: rgb(var(--grey-400));\n}\n","",{version:3,sources:["webpack://./../../packages/sheets-ui/src/views/sheet-bar/index.module.less"],names:[],mappings:"AAKA;EACI,qCAAA;EACA,6BAAA;AAJJ;AAMI;EACI,aAAA;EACA,mBAAA;EACA,mBAAA;EAEA,yBAAA;EAEA,wBAAA;AANR;AAQQ;EACI,WAAA;EAEA,cAAA;EAEA,UAAA;EACA,YAAA;EACA,0BAAA;EAEA,sCAAA;AATZ",sourcesContent:["@sheet-bar-max-width: 1515px;\n@status-bar-max-width: 332px;\n@zoom-slider-width: 260px;\n@margin-right: -4px;\n\n.sheet-bar {\n    min-width: calc(100% - @zoom-slider-width - @status-bar-max-width);\n    max-width: calc(100% - @zoom-slider-width);\n\n    &-options {\n        display: flex;\n        flex-direction: row;\n        align-items: center;\n\n        margin: var(--margin-xxs);\n\n        transition: display 0.2s;\n\n        &-divider::after {\n            content: '';\n\n            display: block;\n\n            width: 1px;\n            height: 16px;\n            margin: 0 var(--margin-xs);\n\n            background-color: rgb(var(--grey-400));\n        }\n    }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={sheetBar:"univer-sheet-bar",sheetBarOptions:"univer-sheet-bar-options",sheetBarOptionsDivider:"univer-sheet-bar-options-divider"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/sheet-bar/sheet-bar-button/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-sheet-bar-btn {\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 24px;\n  height: 24px;\n  padding: 0;\n  font-size: var(--font-size-lg);\n  color: rgb(var(--text-color-secondary-darker));\n  background-color: transparent;\n  border: none;\n  border-radius: var(--border-radius-base);\n  outline: none;\n}\n.univer-sheet-bar-btn:not([disabled]):hover {\n  background-color: rgb(var(--bg-color-hover));\n}\n.univer-sheet-bar-btn[disabled] {\n  cursor: not-allowed;\n  color: rgb(var(--grey-200));\n}\n","",{version:3,sources:["webpack://./../../packages/sheets-ui/src/views/sheet-bar/sheet-bar-button/index.module.less"],names:[],mappings:"AAEA;EACI,eAAA;EAEA,aAAA;EACA,mBAAA;EACA,uBAAA;EAEA,WAAA;EACA,YAAA;EACA,UAAA;EAEA,8BAAA;EACA,8CAAA;EAEA,6BAAA;EACA,YAAA;EACA,wCAAA;EACA,aAAA;AALJ;AAOI;EACI,4CAAA;AALR;AAQI;EACI,mBAAA;EACA,2BAAA;AANR",sourcesContent:["@sheet-bar-btn-size: 24px;\n\n.sheet-bar-btn {\n    cursor: pointer;\n\n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    width: @sheet-bar-btn-size;\n    height: @sheet-bar-btn-size;\n    padding: 0;\n\n    font-size: var(--font-size-lg);\n    color: rgb(var(--text-color-secondary-darker));\n\n    background-color: transparent;\n    border: none;\n    border-radius: var(--border-radius-base);\n    outline: none;\n\n    &:not([disabled]):hover {\n        background-color: rgb(var(--bg-color-hover));\n    }\n\n    &[disabled] {\n        cursor: not-allowed;\n        color: rgb(var(--grey-200));\n    }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={sheetBarBtn:"univer-sheet-bar-btn"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/sheet-bar/sheet-bar-tabs/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-slide-tab-bar-container {\n  overflow: hidden;\n  max-width: calc(100% - 112px);\n}\n.univer-slide-tab-bar-container .univer-slide-tab-bar {\n  user-select: none;\n  overflow: hidden;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: var(--padding-xs) 6px;\n  transition: box-shadow 0.2s;\n}\n/**\nTab Item, Put outside to be compatible with drag styles\n*/\n.univer-slide-tab-item {\n  cursor: pointer;\n  user-select: none;\n  display: flex;\n  flex-direction: row;\n  flex-grow: 1;\n  align-items: center;\n  box-sizing: border-box;\n  margin: 0 var(--margin-xxs);\n  font-size: var(--font-size-xs);\n  line-height: 16px;\n  color: rgb(var(--grey-1000));\n  border-radius: var(--border-radius-base);\n}\n.univer-slide-tab-item:not(.univer-slide-tab-active):hover {\n  background-color: rgb(var(--bg-color-hover));\n}\n.univer-slide-tab-item .univer-slide-tab-div {\n  box-sizing: border-box;\n  padding: var(--padding-xs) var(--padding-sm);\n  white-space: nowrap;\n  border: 2px solid transparent;\n  border-radius: var(--border-radius-base);\n  display: flex;\n  align-items: center;\n}\n.univer-slide-tab-item .univer-slide-tab-div-edit {\n  cursor: text;\n  outline: none;\n}\n.univer-slide-tab-item .univer-slide-tab-div-edit::selection {\n  color: rgb(var(--color-white));\n  background-color: rgb(var(--primary-color));\n}\n.univer-slide-tab-active {\n  font-weight: 700;\n  color: rgb(var(--primary-color));\n  background-color: rgb(var(--bg-color-secondary));\n  box-shadow: 0px 0 8px rgba(0, 0, 0, 0.08);\n  transition: box-shadow 0.2s;\n  display: flex;\n  justify-content: center;\n}\n.univer-slide-tab-item-dropdown {\n  user-select: none;\n  min-width: auto !important;\n}\n","",{version:3,sources:["webpack://./../../packages/sheets-ui/src/views/sheet-bar/sheet-bar-tabs/index.module.less"],names:[],mappings:"AAGA;EACI,gBAAA;EACA,6BAAA;AAFJ;AAAA;EAKQ,iBAAA;EAEA,gBAAA;EACA,aAAA;EACA,mBAAA;EACA,mBAAA;EAEA,8BAAA;EAEA,2BAAA;AALR;AACA;;CAEC;AASD;EACI,eAAA;EACA,iBAAA;EAEA,aAAA;EACA,mBAAA;EACA,YAAA;EACA,mBAAA;EAEA,sBAAA;EACA,2BAAA;EAEA,8BAAA;EACA,iBAAA;EACA,4BAAA;EAEA,wCAAA;AAXJ;AAaI;EACI,4CAAA;AAXR;AARA;EAuBQ,sBAAA;EACA,4CAAA;EAEA,mBAAA;EAEA,6BAAA;EACA,wCAAA;EACA,aAAA;EACA,mBAAA;AAdR;AAgBQ;EACI,YAAA;EACA,aAAA;AAdZ;AAgBY;EACI,8BAAA;EACA,2CAAA;AAdhB;AAoBA;EACI,gBAAA;EACA,gCAAA;EAEA,gDAAA;EACA,yCAAA;EAEA,2BAAA;EACA,aAAA;EACA,uBAAA;AApBJ;AAuBA;EACI,iBAAA;EACA,0BAAA;AArBJ",sourcesContent:["@tab-shadow: 0px 0 8px rgba(0, 0, 0, 0.08);\n@padding-left-right: 6px;\n\n.slide-tab-bar-container {\n    overflow: hidden;\n    max-width: calc(100% - 112px);\n\n    .slide-tab-bar {\n        user-select: none;\n\n        overflow: hidden;\n        display: flex;\n        flex-direction: row;\n        align-items: center;\n\n        padding: var(--padding-xs) @padding-left-right;\n\n        transition: box-shadow 0.2s;\n    }\n}\n\n/**\nTab Item, Put outside to be compatible with drag styles\n*/\n.slide-tab-item {\n    cursor: pointer;\n    user-select: none;\n\n    display: flex;\n    flex-direction: row;\n    flex-grow: 1;\n    align-items: center;\n\n    box-sizing: border-box;\n    margin: 0 var(--margin-xxs);\n\n    font-size: var(--font-size-xs);\n    line-height: 16px;\n    color: rgb(var(--grey-1000));\n\n    border-radius: var(--border-radius-base);\n\n    &:not(.slide-tab-active):hover {\n        background-color: rgb(var(--bg-color-hover));\n    }\n\n    .slide-tab-div {\n        box-sizing: border-box;\n        padding: var(--padding-xs) var(--padding-sm);\n\n        white-space: nowrap;\n\n        border: 2px solid transparent;\n        border-radius: var(--border-radius-base);\n        display: flex;\n        align-items: center;\n\n        &-edit {\n            cursor: text;\n            outline: none;\n\n            &::selection {\n                color: rgb(var(--color-white));\n                background-color: rgb(var(--primary-color));\n            }\n        }\n    }\n}\n\n.slide-tab-active {\n    font-weight: 700;\n    color: rgb(var(--primary-color));\n\n    background-color: rgb(var(--bg-color-secondary));\n    box-shadow: @tab-shadow;\n\n    transition: box-shadow 0.2s;\n    display: flex;\n    justify-content: center;\n}\n\n.slide-tab-item-dropdown {\n    user-select: none;\n    min-width: auto !important;\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={slideTabBarContainer:"univer-slide-tab-bar-container",slideTabBar:"univer-slide-tab-bar",slideTabItem:"univer-slide-tab-item",slideTabActive:"univer-slide-tab-active",slideTabDiv:"univer-slide-tab-div",slideTabDivEdit:"univer-slide-tab-div-edit",slideTabItemDropdown:"univer-slide-tab-item-dropdown"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/status-bar/index.module.less":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_7_1_2_webpack_5_98_0_swc_core_1_10_18_esbuild_0_25_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".univer-status-bar {\n  display: flex;\n  align-items: center;\n  max-width: 332px;\n}\n.univer-status-bar.univer-single-mode {\n  max-width: 136px;\n}\n.univer-status-bar-div {\n  width: 1px;\n  height: 16px;\n  margin-left: 10px;\n  background: rgb(var(--grey-400, #ccc));\n}\n.univer-statistic-list-column .univer-statistic-item {\n  font-size: 12px;\n  line-height: 140%;\n  color: rgb(var(--grey-500));\n}\n.univer-statistic-item {\n  cursor: default;\n  overflow: hidden;\n  display: flex;\n  justify-content: flex-start;\n  max-width: 106px;\n  margin-right: 8px;\n  font-size: var(--font-size-xxs);\n  font-weight: 400;\n  font-style: normal;\n  line-height: 20px;\n  /* 181.818% */\n  color: rgb(var(--grey-900));\n  text-align: center;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.univer-statistic-item:hover {\n  color: rgb(var(--color-black));\n}\n.univer-statistic-picker {\n  display: grid;\n  gap: var(--margin-sm);\n  align-items: center;\n  box-sizing: border-box;\n  width: 196px;\n  padding: var(--padding-base);\n  font-size: var(--font-size-xs);\n  background-color: rgb(var(--color-white));\n  border: 1px solid rgb(var(--border-color));\n  border-radius: var(--border-radius-lg);\n  box-shadow: var(--box-shadow-lg);\n}\n.univer-statistic-picker-item {\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n}\n.univer-statistic-more {\n  transform: rotate(90deg);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 24px;\n  height: 24px;\n  font-size: 12px;\n  color: rgb(var(--grey-600, #e8e8e8));\n  border-radius: 4px;\n}\n.univer-statistic-more:hover {\n  background: rgb(var(--grey-300, #e8e8e8));\n}\n","",{version:3,sources:["webpack://./../../packages/sheets-ui/src/views/status-bar/index.module.less"],names:[],mappings:"AAEA;EACI,aAAA;EACA,mBAAA;EACA,gBAAA;AADJ;AAGI;EACI,gBAAA;AADR;AAKA;EACI,UAAA;EACA,YAAA;EACA,iBAAA;EACA,sCAAA;AAHJ;AAOI;EACI,eAAA;EACA,iBAAA;EACA,2BAAA;AALR;AAQI;EACI,eAAA;EAEA,gBAAA;EACA,aAAA;EACA,2BAAA;EAEA,gBAAA;EACA,iBAAA;EAEA,+BAAA;EACA,gBAAA;EACA,kBAAA;EACA,iBAAA;EATN,aAAa;EAUP,2BAAA;EACA,kBAAA;EACA,uBAAA;EACA,mBAAA;AARR;AAUQ;EACI,8BAAA;AARZ;AAYI;EACI,aAAA;EACA,qBAAA;EACA,mBAAA;EAEA,sBAAA;EACA,YAAA;EACA,4BAAA;EAEA,8BAAA;EAEA,yCAAA;EACA,0CAAA;EACA,sCAAA;EACA,gCAAA;AAbR;AAgBI;EACI,aAAA;EACA,mBAAA;EACA,2BAAA;AAdR;AAiBI;EACI,wBAAA;EAEA,aAAA;EACA,mBAAA;EACA,uBAAA;EAEA,WAAA;EACA,YAAA;EAEA,eAAA;EACA,oCAAA;EAEA,kBAAA;AAnBR;AAqBQ;EACI,yCAAA;AAnBZ",sourcesContent:["@statistic-menu-value-width: 55px;\n\n.status-bar {\n    display: flex;\n    align-items: center;\n    max-width: 332px;\n\n    &.single-mode {\n        max-width: 136px;\n    }\n}\n\n.status-bar-div {\n    width: 1px;\n    height: 16px;\n    margin-left: 10px;\n    background: rgb(var(--grey-400, #ccc));\n}\n\n.statistic {\n    &-list-column &-item {\n        font-size: 12px;\n        line-height: 140%;\n        color: rgb(var(--grey-500));\n    }\n\n    &-item {\n        cursor: default;\n\n        overflow: hidden;\n        display: flex;\n        justify-content: flex-start;\n\n        max-width: 106px;\n        margin-right: 8px;\n\n        font-size: var(--font-size-xxs);\n        font-weight: 400;\n        font-style: normal;\n        line-height: 20px; /* 181.818% */\n        color: rgb(var(--grey-900));\n        text-align: center;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n\n        &:hover {\n            color: rgb(var(--color-black));\n        }\n    }\n\n    &-picker {\n        display: grid;\n        gap: var(--margin-sm);\n        align-items: center;\n\n        box-sizing: border-box;\n        width: 196px;\n        padding: var(--padding-base);\n\n        font-size: var(--font-size-xs);\n\n        background-color: rgb(var(--color-white));\n        border: 1px solid rgb(var(--border-color));\n        border-radius: var(--border-radius-lg);\n        box-shadow: var(--box-shadow-lg);\n    }\n\n    &-picker-item {\n        display: flex;\n        align-items: center;\n        justify-content: flex-start;\n    }\n\n    &-more {\n        transform: rotate(90deg);\n\n        display: flex;\n        align-items: center;\n        justify-content: center;\n\n        width: 24px;\n        height: 24px;\n\n        font-size: 12px;\n        color: rgb(var(--grey-600, #e8e8e8));\n\n        border-radius: 4px;\n\n        &:hover {\n            background: rgb(var(--grey-300, #e8e8e8));\n        }\n    }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={statusBar:"univer-status-bar",singleMode:"univer-single-mode",statusBarDiv:"univer-status-bar-div",statisticListColumn:"univer-statistic-list-column",statisticItem:"univer-statistic-item",statisticPicker:"univer-statistic-picker",statisticPickerItem:"univer-statistic-picker-item",statisticMore:"univer-statistic-more"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"../../packages/sheets-filter-ui/src/views/components/SheetsFilterPanel.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{FilterWithChinese:()=>FilterWithChinese,FilterWithConditions:()=>FilterWithConditions,FilterWithValues:()=>FilterWithValues,__namedExportsOrder:()=>__namedExportsOrder,default:()=>SheetsFilterPanel_stories});var jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@19.0.0/node_modules/react/jsx-runtime.js"),src=__webpack_require__("../../packages/core/src/index.ts"),sheets_src=__webpack_require__("../../packages/sheets/src/index.ts");Symbol("sheets-filter.config");const defaultPluginConfig={},FILTER_MUTATIONS=new Set(["sheet.mutation.set-filter-range","sheet.mutation.set-filter-criteria","sheet.mutation.remove-filter","sheet.mutation.re-calc-filter"]);var BehaviorSubject=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/BehaviorSubject.js"),observable_merge=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/observable/merge.js"),filter=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/filter.js"),switchMap=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/switchMap.js"),observable_of=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/observable/of.js"),CustomFilterOperator=function(CustomFilterOperator){return CustomFilterOperator.EQUAL="equal",CustomFilterOperator.GREATER_THAN="greaterThan",CustomFilterOperator.GREATER_THAN_OR_EQUAL="greaterThanOrEqual",CustomFilterOperator.LESS_THAN="lessThan",CustomFilterOperator.LESS_THAN_OR_EQUAL="lessThanOrEqual",CustomFilterOperator.NOT_EQUALS="notEqual",CustomFilterOperator}({});const greaterThan={operator:CustomFilterOperator.GREATER_THAN,fn:(value,compare)=>!!ensureNumber(value)&&value>compare},greaterThanOrEqualTo={operator:CustomFilterOperator.GREATER_THAN_OR_EQUAL,fn:(value,compare)=>!!ensureNumber(value)&&value>=compare},lessThan={operator:CustomFilterOperator.LESS_THAN,fn:(value,compare)=>!!ensureNumber(value)&&value<compare},lessThanOrEqualTo={operator:CustomFilterOperator.LESS_THAN_OR_EQUAL,fn:(value,compare)=>!!ensureNumber(value)&&value<=compare},equals={operator:CustomFilterOperator.EQUAL,fn:(value,compare)=>!!ensureNumber(value)&&value===compare},notEquals={operator:CustomFilterOperator.NOT_EQUALS,fn:(value,compare)=>{if("string"==typeof compare){if(" "===compare)return null!=value;const ensuredString=ensureString(value);return ensuredString&&function isWildCardString(str){if("number"==typeof str)return!1;return-1!==str.indexOf("*")||-1!==str.indexOf("?")}(compare)?!createREGEXFromWildChar(compare).test(ensuredString):ensuredString!==compare}return!ensureNumber(value)||value!==compare}},CustomFilterFnRegistry=new Map([]);[greaterThan,greaterThanOrEqualTo,lessThan,lessThanOrEqualTo,equals,notEquals].forEach((fn=>{CustomFilterFnRegistry.set(fn.operator,fn)}));const textMatch={fn:(value,compare)=>{const ensured=ensureString(value);return null===ensured?""===compare:createREGEXFromWildChar(compare).test(ensured)}};function getCustomFilterFn(operator){return operator?CustomFilterFnRegistry.get(operator):textMatch}function ensureNumber(value){return"number"==typeof value}function ensureNumeric(value){return"number"==typeof value||!("string"!=typeof value||!(0,src.kf$)(value))}function ensureString(value){return"boolean"==typeof value||null==value?null:"string"==typeof value?value:value.toString()}function createREGEXFromWildChar(wildChar){const regexpStr=wildChar.replace(/[.+^${}()|[\]\\]/g,"\\$&").replaceAll("?",".").replace(/[*]/g,".$&");return new RegExp(`^${regexpStr}$`)}const EMPTY=()=>new Set;class filter_model_FilterModel extends src.jGt{get filteredOutRows(){return this._filteredOutRows$.getValue()}set filteredOutRows(rows){this._alreadyFilteredOutRows=rows,this._filteredOutRows$.next(rows)}constructor(unitId,subUnitId,_worksheet){super(),this.unitId=unitId,this.subUnitId=subUnitId,this._worksheet=_worksheet,this._filteredOutRows$=new BehaviorSubject.t(EMPTY()),this.filteredOutRows$=this._filteredOutRows$.asObservable(),this._hasCriteria$=new BehaviorSubject.t(!1),this.hasCriteria$=this._hasCriteria$.asObservable(),this._filterColumnByIndex=new Map,this._alreadyFilteredOutRows=EMPTY()}dispose(){super.dispose(),this._filteredOutRows$.complete(),this._hasCriteria$.complete()}serialize(){const result={ref:src.M_G.clone(this._range),filterColumns:this._getAllFilterColumns(!0).sort((([offset1],[offset2])=>offset1-offset2)).map((([_,filterColumn])=>filterColumn.serialize()))};return this._alreadyFilteredOutRows&&(result.cachedFilteredOut=Array.from(this._alreadyFilteredOutRows).sort()),result}static deserialize(unitId,subUnitId,worksheet,autoFilter){const filterModel=new filter_model_FilterModel(unitId,subUnitId,worksheet);return filterModel._dump(autoFilter),filterModel}_dump(autoFilter){this.setRange(autoFilter.ref),autoFilter.filterColumns?.forEach((filterColumn=>this._setCriteriaWithoutReCalc(filterColumn.colId,filterColumn))),autoFilter.cachedFilteredOut&&(this._alreadyFilteredOutRows=new Set(autoFilter.cachedFilteredOut),this._emit()),this._emitHasCriteria()}isRowFiltered(row){return this._alreadyFilteredOutRows.has(row)}getRange(){if(!this._range)throw new Error("[FilterModel] could not get range before a range is set!");return this._range}getFilteredOutRowsExceptCol(col){return this._getAllFilterColumns(!0).filter((([colOffset])=>colOffset!==col)).reduce(((acc,[,filterColumn])=>{const newResult=filterColumn.calc({getAlreadyFilteredOutRows:()=>acc});return newResult?(0,src.Qg7)(acc,newResult):acc}),new Set)}setRange(range){this._range=range,this._getAllFilterColumns(!0).forEach((([col,filterColumn])=>{filterColumn.setRangeAndColumn({startRow:range.startRow,endRow:range.endRow,startColumn:col,endColumn:col},col)}))}setCriteria(col,criteria,reCalc=!1){if(!this._range)throw new Error("[FilterModel] could not set criteria before a range is set!");if(!criteria)return this._removeCriteria(col),this._rebuildAlreadyFilteredOutRowsWithCache(),reCalc&&this._reCalcAllColumns(),this._emit(),void this._emitHasCriteria();this._setCriteriaWithoutReCalc(col,criteria),reCalc&&(this._rebuildAlreadyFilteredOutRowsWithCache(),this._reCalcWithNoCacheColumns(),this._emit(),this._emitHasCriteria())}getAllFilterColumns(){return this._getAllFilterColumns(!0)}getFilterColumn(index){return this._filterColumnByIndex.get(index)??null}reCalc(){this._reCalcAllColumns(),this._emit()}_getAllFilterColumns(withCol=!1){const columns=Array.from(this._filterColumnByIndex.entries());return withCol?columns:columns.map((([_,filterColumn])=>filterColumn))}_reCalcAllColumns(){this._alreadyFilteredOutRows=EMPTY(),this._getAllFilterColumns().forEach((filterColumn=>filterColumn.__clearCache())),this._reCalcWithNoCacheColumns()}_setCriteriaWithoutReCalc(col,criteria){const range=this._range;if(!range)throw new Error("[FilterModel] could not set criteria before a range is set!");const{startColumn,endColumn}=range;if(col>endColumn||col<startColumn)throw new Error(`[FilterModel] could not set criteria on column ${col} which is out of range!`);let filterColumn;this._filterColumnByIndex.has(col)?filterColumn=this._filterColumnByIndex.get(col):(filterColumn=new FilterColumn(this.unitId,this.subUnitId,this._worksheet,criteria,{getAlreadyFilteredOutRows:()=>this._alreadyFilteredOutRows}),filterColumn.setRangeAndColumn(range,col),this._filterColumnByIndex.set(col,filterColumn)),filterColumn.setCriteria(criteria)}_removeCriteria(col){const filterColumn=this._filterColumnByIndex.get(col);filterColumn&&(filterColumn.dispose(),this._filterColumnByIndex.delete(col))}_emit(){this._filteredOutRows$.next(this._alreadyFilteredOutRows)}_emitHasCriteria(){this._hasCriteria$.next(this._filterColumnByIndex.size>0)}_rebuildAlreadyFilteredOutRowsWithCache(){const newFilteredOutRows=this._getAllFilterColumns().filter((filterColumn=>filterColumn.hasCache())).reduce(((acc,filterColumn)=>(0,src.Qg7)(acc,filterColumn.filteredOutRows)),new Set);this._alreadyFilteredOutRows=newFilteredOutRows}_reCalcWithNoCacheColumns(){const noCacheFilteredOutRows=this._getAllFilterColumns().filter((filterColumn=>!filterColumn.hasCache()));for(const filterColumn of noCacheFilteredOutRows){const filteredRows=filterColumn.reCalc();filteredRows&&(this._alreadyFilteredOutRows=(0,src.Qg7)(this._alreadyFilteredOutRows,filteredRows))}}}class FilterColumn extends src.jGt{get filteredOutRows(){return this._filteredOutRows}constructor(unitId,subUnitId,_worksheet,_criteria,_filterColumnContext){super(),this.unitId=unitId,this.subUnitId=subUnitId,this._worksheet=_worksheet,this._criteria=_criteria,this._filterColumnContext=_filterColumnContext,this._filteredOutRows=null,this._filterFn=null,this._range=null,this._column=0,this._filterByValues=!1}dispose(){super.dispose(),this._filteredOutRows=null}__clearCache(){this._filteredOutRows=null}serialize(){if(!this._criteria)throw new Error("[FilterColumn]: could not serialize without a filter column!");return src.S0q.deepClone({...this._criteria,colId:this._column})}hasCache(){return null!==this._filteredOutRows}setRangeAndColumn(range,column){this._range=range,this._column=column}setCriteria(criteria){this._criteria=criteria,this._generateFilterFn(),this._filteredOutRows=null}getColumnData(){return src.S0q.deepClone(this._criteria)}reCalc(){return this._filteredOutRows=this.calc(this._filterColumnContext),this._filteredOutRows}calc(context){if(!this._filterFn)throw new Error("[FilterColumn] cannot calculate without a filter fn!");if(!this._range)throw new Error("[FilterColumn] cannot calculate without a range!");if("number"!=typeof this._column)throw new TypeError("[FilterColumn] cannot calculate without a column offset!");const column=this._column,iterateRange={startColumn:column,endColumn:column,startRow:this._range.startRow+1,endRow:this._range.endRow},filteredOutRows=new Set,filteredOutByOthers=context.getAlreadyFilteredOutRows();for(const range of this._worksheet.iterateByColumn(iterateRange,!1,!1)){const{row,rowSpan,col}=range;if(filteredOutByOthers.has(row)&&(!rowSpan||1===rowSpan))continue;const value=this._filterByValues?(0,src.zo$)(this._worksheet.getCell(row,col)):getFilterValueForConditionalFiltering(this._worksheet,row,col);if(!this._filterFn(value)&&(filteredOutRows.add(row),rowSpan))for(let i=1;i<rowSpan;i++)filteredOutRows.add(row+i)}return filteredOutRows}_generateFilterFn(){this._criteria&&(this._filterFn=function generateFilterFn(column){if(column.filters)return function filterByValuesFnFactory(values){const includeBlank=!!values.blank,valuesSet=new Set(values.filters);return value=>void 0===value||""===value?includeBlank:valuesSet.has("string"==typeof value?value:`${value}`)}(column.filters);if(column.customFilters)return function customFilterFnFactory(customFilters){const customFilterFns=customFilters.customFilters.map((filter=>function generateCustomFilterFn(filter){const compare=filter.val;if(filter.operator===CustomFilterOperator.NOT_EQUALS){if(!ensureNumeric(compare))return value=>notEquals.fn(value,compare)}if(function isNumericFilterFn(operator){return!!operator}(filter.operator)){if(!ensureNumeric(compare))return()=>!1;const customFilterFn=getCustomFilterFn(filter.operator),ensuredNumber=Number(compare);return value=>customFilterFn.fn(value,ensuredNumber)}const customFilterFn=getCustomFilterFn(filter.operator);return value=>customFilterFn.fn(value,compare)}(filter)));if(function isCompoundCustomFilter(filter){return 2===filter.length}(customFilterFns))return customFilters.and?function AND(filterFns){const[fn1,fn2]=filterFns;return value=>fn1(value)&&fn2(value)}(customFilterFns):function OR(filterFns){const[fn1,fn2]=filterFns;return value=>fn1(value)||fn2(value)}(customFilterFns);return customFilterFns[0]}(column.customFilters);throw new Error("[FilterModel]: other types of filters are not supported yet.")}(this._criteria),this._filterByValues=!!this._criteria.filters)}}function getFilterValueForConditionalFiltering(worksheet,row,col){const interceptedCell=worksheet.getCell(row,col);if(!interceptedCell)return null;const rawCell=worksheet.getCellRaw(row,col);return interceptedCell&&!rawCell?extractFilterValueFromCell(interceptedCell):rawCell?interceptedCell.t===src.scd.NUMBER&&"string"==typeof interceptedCell.v?rawCell.v:extractFilterValueFromCell(rawCell):null}function extractFilterValueFromCell(cell){const richTextValue=cell.p?.body?.dataStream;if(richTextValue)return richTextValue.trimEnd();const rawValue=cell.v;return"string"==typeof rawValue?cell.t===src.scd.BOOLEAN?rawValue.toUpperCase():rawValue:"number"==typeof rawValue?cell.t===src.scd.BOOLEAN?rawValue?"TRUE":"FALSE":rawValue:"boolean"==typeof rawValue?rawValue?"TRUE":"FALSE":""}function _ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function _ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class SheetsFilterService extends src.jGt{get activeFilterModel(){return this._activeFilterModel$.getValue()}constructor(_resourcesManagerService,_univerInstanceService,_commandService){super(),this._resourcesManagerService=_resourcesManagerService,this._univerInstanceService=_univerInstanceService,this._commandService=_commandService,this._filterModels=new Map,this._loadedUnitId$=new BehaviorSubject.t(null),this.loadedUnitId$=this._loadedUnitId$.asObservable(),this._errorMsg$=new BehaviorSubject.t(null),this.errorMsg$=this._errorMsg$.asObservable(),this._activeFilterModel$=new BehaviorSubject.t(null),this.activeFilterModel$=this._activeFilterModel$.asObservable(),this._initModel(),this._initActiveFilterModel()}ensureFilterModel(unitId,subUnitId){const already=this.getFilterModel(unitId,subUnitId);if(already)return already;const workbook=this._univerInstanceService.getUniverSheetInstance(unitId);if(!workbook)throw new Error(`[SheetsFilterService]: could not create "FilterModel" on a non-existing workbook ${unitId}!`);const worksheet=workbook.getSheetBySheetId(subUnitId);if(!worksheet)throw new Error(`[SheetsFilterService]: could not create "FilterModel" on a non-existing worksheet ${subUnitId}!`);const filterModel=new filter_model_FilterModel(unitId,subUnitId,worksheet);return this._cacheFilterModel(unitId,subUnitId,filterModel),filterModel}getFilterModel(unitId,subUnitId){return this._filterModels.get(unitId)?.get(subUnitId)??null}removeFilterModel(unitId,subUnitId){const already=this.getFilterModel(unitId,subUnitId);return!!already&&(already.dispose(),this._filterModels.get(unitId).delete(subUnitId),!0)}setFilterErrorMsg(content){this._errorMsg$.next(content)}_updateActiveFilterModel(){let workbook;try{if(workbook=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),!workbook)return void this._activeFilterModel$.next(null)}catch(err){return void console.error("[SheetsFilterService]: could not get active workbook!",err)}const activeSheet=workbook.getActiveSheet(!0);if(!activeSheet)return void this._activeFilterModel$.next(null);const unitId=activeSheet.getUnitId(),subUnitId=activeSheet.getSheetId(),filterModel=this.getFilterModel(unitId,subUnitId);this._activeFilterModel$.next(filterModel)}_initActiveFilterModel(){this.disposeWithMe((0,observable_merge.h)((0,src.SP9)(this._commandService.onCommandExecuted.bind(this._commandService)).pipe((0,filter.p)((([command])=>command.type===src.g4t.MUTATION&&FILTER_MUTATIONS.has(command.id)))),this._univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET).pipe((0,switchMap.n)((workbook=>workbook?.activeSheet$??(0,observable_of.of)(null))))).subscribe((()=>this._updateActiveFilterModel())))}_serializeAutoFiltersForUnit(unitId){const allFilterModels=this._filterModels.get(unitId);if(!allFilterModels)return"{}";const json={};return allFilterModels.forEach(((model,worksheetId)=>{json[worksheetId]=model.serialize()})),JSON.stringify(json)}_deserializeAutoFiltersForUnit(unitId,json){const workbook=this._univerInstanceService.getUniverSheetInstance(unitId);Object.keys(json).forEach((worksheetId=>{const autoFilter=json[worksheetId],filterModel=filter_model_FilterModel.deserialize(unitId,worksheetId,workbook.getSheetBySheetId(worksheetId),autoFilter);this._cacheFilterModel(unitId,worksheetId,filterModel)}))}_initModel(){this._resourcesManagerService.registerPluginResource({pluginName:"SHEET_FILTER_PLUGIN",businesses:[src.Zy$.UNIVER_SHEET],toJson:id=>this._serializeAutoFiltersForUnit(id),parseJson:json=>JSON.parse(json),onLoad:(unitId,value)=>{this._deserializeAutoFiltersForUnit(unitId,value),this._loadedUnitId$.next(unitId),this._updateActiveFilterModel()},onUnLoad:unitId=>{const allFilterModels=this._filterModels.get(unitId);allFilterModels&&(allFilterModels.forEach((model=>model.dispose())),this._filterModels.delete(unitId))}})}_cacheFilterModel(unitId,subUnitId,filterModel){this._filterModels.has(unitId)||this._filterModels.set(unitId,new Map),this._filterModels.get(unitId).set(subUnitId,filterModel)}}SheetsFilterService=function _ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([_ts_param(0,src.Gvw),_ts_param(1,src.HCr),_ts_param(2,src.wTY),_ts_metadata("design:type",Function),_ts_metadata("design:paramtypes",[void 0===src.Gvw?Object:src.Gvw,void 0===src.HCr?Object:src.HCr,void 0===src.wTY?Object:src.wTY])],SheetsFilterService);const SetSheetsFilterRangeMutation={id:"sheet.mutation.set-filter-range",type:src.g4t.MUTATION,handler:(accessor,params)=>{const{subUnitId,unitId,range}=params;return accessor.get(SheetsFilterService).ensureFilterModel(unitId,subUnitId).setRange(range),!0}},SetSheetsFilterCriteriaMutation={id:"sheet.mutation.set-filter-criteria",type:src.g4t.MUTATION,handler:(accessor,params)=>{const{subUnitId,unitId,criteria,col,reCalc=!0}=params,filterModel=accessor.get(SheetsFilterService).getFilterModel(unitId,subUnitId);return!!filterModel&&(filterModel.setCriteria(col,criteria,reCalc),!0)}},RemoveSheetsFilterMutation={id:"sheet.mutation.remove-filter",type:src.g4t.MUTATION,handler:(accessor,params)=>{const{unitId,subUnitId}=params;return accessor.get(SheetsFilterService).removeFilterModel(unitId,subUnitId)}},ReCalcSheetsFilterMutation={id:"sheet.mutation.re-calc-filter",type:src.g4t.MUTATION,handler:(accessor,params)=>{const{unitId,subUnitId}=params,filterModel=accessor.get(SheetsFilterService).getFilterModel(unitId,subUnitId);return!!filterModel&&(filterModel.reCalc(),!0)}};function mergeSetFilterCriteria(mutations){return function objectsShaker(target,isEqual){for(let i=0;i<target.length;i++){let cur=i;if(target[i])for(let j=i+1;j<target.length;j++)target[cur]&&target[j]&&isEqual(target[cur],target[j])&&(target[cur]=null,cur=j)}return target.filter((o=>null!==o))}(mutations,((o1,o2)=>o1.id===SetSheetsFilterCriteriaMutation.id&&o2.id===SetSheetsFilterCriteriaMutation.id&&o1.params.unitId===o2.params.unitId&&o1.params.subUnitId===o2.params.subUnitId&&o1.params.col===o2.params.col))}function sheets_filter_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function sheets_filter_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class SheetsFilterController extends src.jGt{constructor(_commandService,_sheetInterceptorService,_sheetsFilterService,_univerInstanceService,_refRangeService){super(),this._commandService=_commandService,this._sheetInterceptorService=_sheetInterceptorService,this._sheetsFilterService=_sheetsFilterService,this._univerInstanceService=_univerInstanceService,this._refRangeService=_refRangeService,this._disposableCollection=new src.VdD,this._initCommands(),this._initRowFilteredInterceptor(),this._initInterceptors(),this._commandExecutedListener(),this._initErrorHandling()}_initCommands(){[SetSheetsFilterCriteriaMutation,SetSheetsFilterRangeMutation,ReCalcSheetsFilterMutation,RemoveSheetsFilterMutation].forEach((command=>this.disposeWithMe(this._commandService.registerCommand(command))))}_initInterceptors(){this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations:command=>this._getUpdateFilter(command)})),this.disposeWithMe(this._commandService.onCommandExecuted((commandInfo=>{if(commandInfo.id===sheets_src._M5.id){const params=commandInfo.params,sheetId=params.subUnitId,unitId=params.unitId;if(!sheetId||!unitId)return;this._registerRefRange(unitId,sheetId)}if(commandInfo.id===SetSheetsFilterRangeMutation.id){const params=commandInfo.params,sheetId=params.subUnitId,unitId=params.unitId;if(!sheetId||!unitId)return;this._registerRefRange(params.unitId,params.subUnitId)}}))),this.disposeWithMe(this._sheetsFilterService.loadedUnitId$.subscribe((unitId=>{if(unitId){const workbook=this._univerInstanceService.getUniverSheetInstance(unitId),sheet=workbook?.getActiveSheet();sheet&&this._registerRefRange(unitId,sheet.getSheetId())}})))}_registerRefRange(unitId,subUnitId){this._disposableCollection.dispose();const workbook=this._univerInstanceService.getUniverSheetInstance(unitId),workSheet=workbook?.getSheetBySheetId(subUnitId);if(!workbook||!workSheet)return;const range=this._sheetsFilterService.getFilterModel(unitId,subUnitId)?.getRange(),handler=config=>{switch(config.id){case sheets_src.$h8.id:{const params=config.params,_unitId=params.unitId||unitId,_subUnitId=params.subUnitId||subUnitId;return this._handleInsertRowCommand(params,_unitId,_subUnitId)}case sheets_src.Xuv.id:{const params=config.params,_unitId=params.unitId||unitId,_subUnitId=params.subUnitId||subUnitId;return this._handleInsertColCommand(params,_unitId,_subUnitId)}case sheets_src.G7y.id:{const params=config.params;return this._handleRemoveColCommand(params,unitId,subUnitId)}case sheets_src.UJ9.id:{const params=config.params;return this._handleRemoveRowCommand(params,unitId,subUnitId)}case sheets_src.WfV.MoveColsCommandId:{const params=config.params;return this._handleMoveColsCommand(params,unitId,subUnitId)}case sheets_src.WfV.MoveRowsCommandId:{const params=config.params;return this._handleMoveRowsCommand(params,unitId,subUnitId)}case sheets_src.Kft.id:{const params=config.params;return this._handleMoveRangeCommand(params,unitId,subUnitId)}}return{redos:[],undos:[]}};range&&this._disposableCollection.add(this._refRangeService.registerRefRange(range,handler,unitId,subUnitId))}_getUpdateFilter(command){const{id}=command;switch(id){case sheets_src.J0n.id:{const params=command.params;return this._handleRemoveSheetCommand(params,params.unitId,params.subUnitId)}case sheets_src.y2Q.id:{const params=command.params,{targetSubUnitId,unitId,subUnitId}=params;return unitId&&subUnitId&&targetSubUnitId?this._handleCopySheetCommand(unitId,subUnitId,targetSubUnitId):this._handleNull()}}return{redos:[],undos:[]}}_handleInsertColCommand(config,unitId,subUnitId){const filterModel=this._sheetsFilterService.getFilterModel(unitId,subUnitId),filterRange=filterModel?.getRange()??null;if(!filterModel||!filterRange)return this._handleNull();const{startColumn,endColumn}=filterRange,{startColumn:insertStartColumn,endColumn:insertEndColumn}=config.range,count=insertEndColumn-insertStartColumn+1;if(insertEndColumn>endColumn)return this._handleNull();const redos=[],undos=[],anchor=insertStartColumn,setFilterRangeMutationParams={unitId,subUnitId,range:{...filterRange,startColumn:insertStartColumn<=startColumn?startColumn+count:startColumn,endColumn:endColumn+count}},undoSetFilterRangeMutationParams={unitId,subUnitId,range:filterRange};redos.push({id:SetSheetsFilterRangeMutation.id,params:setFilterRangeMutationParams}),undos.push({id:SetSheetsFilterRangeMutation.id,params:undoSetFilterRangeMutationParams});const effected=filterModel.getAllFilterColumns().filter((column=>column[0]>=anchor));if(0!==effected.length){const{newRange,oldRange}=this._moveCriteria(unitId,subUnitId,effected,count);redos.push(...newRange.redos,...oldRange.redos),undos.push(...newRange.undos,...oldRange.undos)}return{redos:mergeSetFilterCriteria(redos),undos:mergeSetFilterCriteria(undos)}}_handleInsertRowCommand(config,unitId,subUnitId){const filterModel=this._sheetsFilterService.getFilterModel(unitId,subUnitId),filterRange=filterModel?.getRange()??null;if(!filterModel||!filterRange)return this._handleNull();const{startRow,endRow}=filterRange,{startRow:insertStartRow,endRow:insertEndRow}=config.range,rowCount=insertEndRow-insertStartRow+1;if(insertEndRow>endRow)return this._handleNull();const redos=[],undos=[],setFilterRangeParams={unitId,subUnitId,range:{...filterRange,startRow:insertStartRow<=startRow?startRow+rowCount:startRow,endRow:endRow+rowCount}},undoSetFilterRangeMutationParams={unitId,subUnitId,range:filterRange};return redos.push({id:SetSheetsFilterRangeMutation.id,params:setFilterRangeParams}),undos.push({id:SetSheetsFilterRangeMutation.id,params:undoSetFilterRangeMutationParams}),{redos:mergeSetFilterCriteria(redos),undos:mergeSetFilterCriteria(undos)}}_handleRemoveColCommand(config,unitId,subUnitId){const filterModel=this._sheetsFilterService.getFilterModel(unitId,subUnitId),filterRange=filterModel?.getRange()??null;if(!filterModel||!filterRange)return this._handleNull();const{startColumn,endColumn}=filterRange,{startColumn:removeStartColumn,endColumn:removeEndColumn}=config.range;if(removeStartColumn>endColumn)return this._handleNull();const redos=[],undos=[],rangeRemoveCount=removeEndColumn<startColumn?0:Math.min(removeEndColumn,endColumn)-Math.max(removeStartColumn,startColumn)+1,removeCount=removeEndColumn-removeStartColumn+1,filterColumn=filterModel.getAllFilterColumns();filterColumn.forEach((column=>{const[col,filter]=column;col<=removeEndColumn&&col>=removeStartColumn&&(redos.push({id:SetSheetsFilterCriteriaMutation.id,params:{unitId,subUnitId,col,criteria:null}}),undos.push({id:SetSheetsFilterCriteriaMutation.id,params:{unitId,subUnitId,col,criteria:{...filter.serialize(),colId:col}}}))}));const shifted=filterColumn.filter((column=>{const[col,_]=column;return col>removeEndColumn}));let newRangeCriteria={undos:[],redos:[]};if(shifted.length>0){const{oldRange,newRange}=this._moveCriteria(unitId,subUnitId,shifted,-removeCount);newRangeCriteria=newRange,redos.push(...oldRange.redos),undos.unshift(...oldRange.undos)}if(rangeRemoveCount===endColumn-startColumn+1){const removeFilterRangeMutationParams={unitId,subUnitId};redos.push({id:RemoveSheetsFilterMutation.id,params:removeFilterRangeMutationParams}),undos.unshift({id:SetSheetsFilterRangeMutation.id,params:{range:filterRange,unitId,subUnitId}})}else{const newStartColumn=startColumn<=removeStartColumn?startColumn:0===rangeRemoveCount?startColumn-removeCount:removeStartColumn,newEndColumn=startColumn<=removeStartColumn?endColumn-rangeRemoveCount:endColumn-removeCount,setFilterRangeMutationParams={unitId,subUnitId,range:{...filterRange,startColumn:newStartColumn,endColumn:newEndColumn}};redos.push({id:SetSheetsFilterRangeMutation.id,params:setFilterRangeMutationParams}),undos.unshift({id:SetSheetsFilterRangeMutation.id,params:{range:filterRange,unitId,subUnitId}}),redos.push(...newRangeCriteria.redos),undos.unshift(...newRangeCriteria.undos)}return{undos,redos}}_handleRemoveRowCommand(config,unitId,subUnitId){const filterModel=this._sheetsFilterService.getFilterModel(unitId,subUnitId);if(!filterModel)return this._handleNull();const filterRange=filterModel.getRange(),{startRow,endRow}=filterRange,{startRow:removeStartRow,endRow:removeEndRow}=config.range;if(removeStartRow>endRow)return this._handleNull();if(removeEndRow<startRow)return{undos:[{id:SetSheetsFilterRangeMutation.id,params:{range:filterRange,unitId,subUnitId}}],redos:[{id:SetSheetsFilterRangeMutation.id,params:{range:{...filterRange,startRow:startRow-(removeEndRow-removeStartRow+1),endRow:endRow-(removeEndRow-removeStartRow+1)},unitId,subUnitId}}]};const redos=[],undos=[],filterColumn=filterModel.getAllFilterColumns(),filterHeaderIsRemoved=startRow<=removeEndRow&&startRow>=removeStartRow;undos.push({id:SetSheetsFilterRangeMutation.id,params:{range:filterRange,unitId,subUnitId}});const count=Math.min(removeEndRow,endRow)-Math.max(removeStartRow,startRow)+1;if(count===endRow-startRow+1||filterHeaderIsRemoved){const removeFilterRangeMutationParams={unitId,subUnitId};redos.push({id:RemoveSheetsFilterMutation.id,params:removeFilterRangeMutationParams}),filterColumn.forEach((column=>{const[offset,filter]=column,setCriteriaMutationParams={unitId,subUnitId,col:offset,criteria:{...filter.serialize(),colId:offset}};undos.push({id:SetSheetsFilterCriteriaMutation.id,params:setCriteriaMutationParams})}))}else{const worksheet=this._univerInstanceService.getUniverSheetInstance(unitId)?.getSheetBySheetId(subUnitId);if(!worksheet)return this._handleNull();const hiddenRows=[];for(let r=removeStartRow;r<=removeEndRow;r++)worksheet.getRowFiltered(r)&&hiddenRows.push(r);const afterStartRow=Math.min(startRow,removeStartRow),afterEndRow=afterStartRow+(endRow-startRow)-count+hiddenRows.length,setFilterRangeMutationParams={unitId,subUnitId,range:{...filterRange,startRow:afterStartRow,endRow:afterEndRow}};redos.push({id:SetSheetsFilterRangeMutation.id,params:setFilterRangeMutationParams})}return{undos:mergeSetFilterCriteria(undos),redos:mergeSetFilterCriteria(redos)}}_handleMoveColsCommand(config,unitId,subUnitId){const filterModel=this._sheetsFilterService.getFilterModel(unitId,subUnitId),filterRange=filterModel?.getRange()??null;if(!filterModel||!filterRange)return this._handleNull();const{startColumn,endColumn}=filterRange,{fromRange,toRange}=config;if(fromRange.endColumn<startColumn&&toRange.startColumn<=startColumn||fromRange.startColumn>endColumn&&toRange.endColumn>endColumn)return this._handleNull();const redos=[],undos=[],filterCol={};for(let col=startColumn;col<=endColumn;col++)filterCol[col]={colIndex:col,filter:filterModel.getFilterColumn(col)};(0,src.Kbr)(fromRange.startColumn,fromRange.endColumn-fromRange.startColumn+1,toRange.startColumn,filterCol);let startBorder=filterRange.startColumn,endBorder=filterRange.endColumn;startColumn>=fromRange.startColumn&&startColumn<=fromRange.endColumn&&toRange.startColumn>fromRange.startColumn&&fromRange.endColumn<endColumn&&(startBorder=fromRange.endColumn+1),endColumn>=fromRange.startColumn&&endColumn<=fromRange.endColumn&&toRange.startColumn<fromRange.startColumn&&fromRange.startColumn>startColumn&&(endBorder=fromRange.startColumn-1);const numberCols=Object.keys(filterCol).map((col=>Number(col))),newEnd=numberCols.find((col=>filterCol[col].colIndex===endBorder)),newStart=numberCols.find((col=>filterCol[col].colIndex===startBorder));if(numberCols.forEach((col=>{const{colIndex:oldColIndex,filter}=filterCol[col],newColIndex=col;if(filter){if(newColIndex>=newStart&&newColIndex<=newEnd){const setCriteriaMutationParams={unitId,subUnitId,col:newColIndex,criteria:{...filter.serialize(),colId:newColIndex}},undoSetCriteriaMutationParams={unitId,subUnitId,col:newColIndex,criteria:filterModel.getFilterColumn(newColIndex)?{...filterModel.getFilterColumn(newColIndex)?.serialize(),colId:newColIndex}:null};redos.push({id:SetSheetsFilterCriteriaMutation.id,params:setCriteriaMutationParams}),undos.push({id:SetSheetsFilterCriteriaMutation.id,params:undoSetCriteriaMutationParams})}if(!filterCol[oldColIndex]?.filter){const setCriteriaMutationParams={unitId,subUnitId,col:oldColIndex,criteria:null};redos.push({id:SetSheetsFilterCriteriaMutation.id,params:setCriteriaMutationParams}),undos.push({id:SetSheetsFilterCriteriaMutation.id,params:{unitId,subUnitId,col:oldColIndex,criteria:{...filter.serialize(),colId:oldColIndex}}})}}})),startColumn!==newStart||endColumn!==newEnd){const setFilterRangeMutationParams={unitId,subUnitId,range:{...filterRange,startColumn:newStart,endColumn:newEnd}};redos.unshift({id:SetSheetsFilterRangeMutation.id,params:setFilterRangeMutationParams}),undos.unshift({id:SetSheetsFilterRangeMutation.id,params:{range:filterRange,unitId,subUnitId}})}return{undos,redos}}_handleMoveRowsCommand(config,unitId,subUnitId){const filterModel=this._sheetsFilterService.getFilterModel(unitId,subUnitId),filterRange=filterModel?.getRange()??null;if(!filterModel||!filterRange)return this._handleNull();const{startRow,endRow}=filterRange,{fromRange,toRange}=config;if(fromRange.endRow<startRow&&toRange.startRow<=startRow||fromRange.startRow>endRow&&toRange.endRow>endRow)return this._handleNull();const redos=[],undos=[],filterRow={};for(let row=startRow;row<=endRow;row++)filterRow[row]={oldIndex:row};const startBorder=startRow;let endBorder=endRow;endRow>=fromRange.startRow&&endRow<=fromRange.endRow&&toRange.startRow<fromRange.startRow&&fromRange.startRow>startRow&&(endBorder=fromRange.startRow-1),(0,src.Kbr)(fromRange.startRow,fromRange.endRow-fromRange.startRow+1,toRange.startRow,filterRow);const numberRows=Object.keys(filterRow).map((row=>Number(row))),newEnd=numberRows.find((row=>filterRow[row].oldIndex===endBorder)),newStart=numberRows.find((row=>filterRow[row].oldIndex===startBorder));if(startRow!==newStart||endRow!==newEnd){const setFilterRangeMutationParams={unitId,subUnitId,range:{...filterRange,startRow:newStart,endRow:newEnd}};redos.push({id:SetSheetsFilterRangeMutation.id,params:setFilterRangeMutationParams},{id:ReCalcSheetsFilterMutation.id,params:{unitId,subUnitId}}),undos.push({id:SetSheetsFilterRangeMutation.id,params:{range:filterRange,unitId,subUnitId}},{id:ReCalcSheetsFilterMutation.id,params:{unitId,subUnitId}})}return{redos,undos}}_handleMoveRangeCommand(config,unitId,subUnitId){const{fromRange,toRange}=config,filterModel=this._sheetsFilterService.getFilterModel(unitId,subUnitId);if(!filterModel)return this._handleNull();const filterRange=filterModel.getRange();if(!filterRange)return this._handleNull();const redos=[],undos=[];if(src.M_G.contains(fromRange,filterRange)){const rowOffset=filterRange.startRow-fromRange.startRow,colOffset=filterRange.startColumn-fromRange.startColumn,newFilterRange={startRow:toRange.startRow+rowOffset,startColumn:toRange.startColumn+colOffset,endRow:toRange.startRow+rowOffset+(filterRange.endRow-filterRange.startRow),endColumn:toRange.startColumn+colOffset+(filterRange.endColumn-filterRange.startColumn)},removeFilter={id:RemoveSheetsFilterMutation.id,params:{unitId,subUnitId}},setNewFilterRange={id:SetSheetsFilterRangeMutation.id,params:{unitId,subUnitId,range:newFilterRange}},setOldFilterRange={id:SetSheetsFilterRangeMutation.id,params:{unitId,subUnitId,range:filterRange}};redos.push(removeFilter,setNewFilterRange),undos.push(removeFilter,setOldFilterRange);const filterColumn=filterModel.getAllFilterColumns(),moveColDelta=toRange.startColumn-fromRange.startColumn;filterColumn.forEach((column=>{const[col,criteria]=column;criteria&&(redos.push({id:SetSheetsFilterCriteriaMutation.id,params:{unitId,subUnitId,col:col+moveColDelta,criteria:{...criteria.serialize(),colId:col+moveColDelta}}}),undos.push({id:SetSheetsFilterCriteriaMutation.id,params:{unitId,subUnitId,col,criteria:{...criteria.serialize(),colId:col}}}))}))}else if(src.M_G.intersects(toRange,filterRange)){const newFilterRange={...filterRange,endRow:Math.max(filterRange.endRow,toRange.endRow)};redos.push({id:SetSheetsFilterRangeMutation.id,params:{unitId,subUnitId,range:newFilterRange}}),undos.push({id:SetSheetsFilterRangeMutation.id,params:{unitId,subUnitId,range:filterRange}})}return{redos,undos}}_handleRemoveSheetCommand(config,unitId,subUnitId){const filterModel=this._sheetsFilterService.getFilterModel(unitId,subUnitId);if(!filterModel)return this._handleNull();const filterRange=filterModel.getRange();if(!filterRange)return this._handleNull();const redos=[],undos=[];return filterModel.getAllFilterColumns().forEach((([col,filter])=>{undos.push({id:SetSheetsFilterCriteriaMutation.id,params:{unitId,subUnitId,col,criteria:{...filter.serialize(),colId:col}}})})),redos.push({id:RemoveSheetsFilterMutation.id,params:{unitId,subUnitId,range:filterRange}}),undos.unshift({id:SetSheetsFilterRangeMutation.id,params:{range:filterRange,unitId,subUnitId}}),{undos,redos}}_handleCopySheetCommand(unitId,subUnitId,targetSubUnitId){const filterModel=this._sheetsFilterService.getFilterModel(unitId,subUnitId);if(!filterModel)return this._handleNull();const filterRange=filterModel.getRange();if(!filterRange)return this._handleNull();const redos=[],preUndos=[];return filterModel.getAllFilterColumns().forEach((([col,filter])=>{redos.push({id:SetSheetsFilterCriteriaMutation.id,params:{unitId,subUnitId:targetSubUnitId,col,criteria:{...filter.serialize(),colId:col}}}),preUndos.push({id:SetSheetsFilterCriteriaMutation.id,params:{unitId,subUnitId:targetSubUnitId,col,criteria:null}})})),preUndos.push({id:RemoveSheetsFilterMutation.id,params:{unitId,subUnitId:targetSubUnitId,range:filterRange}}),redos.unshift({id:SetSheetsFilterRangeMutation.id,params:{range:filterRange,unitId,subUnitId:targetSubUnitId}}),{undos:[],redos,preUndos,preRedos:[]}}_handleNull(){return{redos:[],undos:[]}}_initRowFilteredInterceptor(){this.disposeWithMe(this._sheetInterceptorService.intercept(sheets_src.ZoP.ROW_FILTERED,{handler:(filtered,rowLocation)=>!!filtered||(this._sheetsFilterService.getFilterModel(rowLocation.unitId,rowLocation.subUnitId)?.isRowFiltered(rowLocation.row)??!1)}))}_moveCriteria(unitId,subUnitId,target,step){const defaultSetCriteriaMutationParams={unitId,subUnitId,criteria:null,col:-1},oldUndos=[],oldRedos=[],newUndos=[],newRedos=[];return target.forEach((column=>{const[offset,filter]=column;oldRedos.push({id:SetSheetsFilterCriteriaMutation.id,params:{...defaultSetCriteriaMutationParams,col:offset}}),oldUndos.push({id:SetSheetsFilterCriteriaMutation.id,params:{...defaultSetCriteriaMutationParams,col:offset,criteria:{...filter.serialize(),colId:offset}}})})),target.forEach((column=>{const[offset,filter]=column;newRedos.push({id:SetSheetsFilterCriteriaMutation.id,params:{...defaultSetCriteriaMutationParams,col:offset+step,criteria:{...filter.serialize(),colId:offset+step}}}),newUndos.push({id:SetSheetsFilterCriteriaMutation.id,params:{...defaultSetCriteriaMutationParams,col:offset+step,criteria:null}})})),{newRange:{redos:newRedos,undos:newUndos},oldRange:{redos:oldRedos,undos:oldUndos}}}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(((command,options)=>{const{unitId,subUnitId}=command.params||{},filterModel=this._sheetsFilterService.getFilterModel(unitId,subUnitId);if(!filterModel)return;const filteredOutRows=Array.from(filterModel.filteredOutRows).sort(((a,b)=>a-b)),newFilteredOutRows=[];let changed=!1;if(command.id===sheets_src.G4z.id){const{startRow,endRow}=command.params.range,filterOutInRemove=filteredOutRows.filter((row=>row>=startRow&&row<=endRow));filteredOutRows.forEach((row=>{if(row<startRow)newFilteredOutRows.push(row);else if(changed=!0,row<=endRow){const newIndex=Math.max(startRow,newFilteredOutRows.length?newFilteredOutRows[newFilteredOutRows.length-1]+1:startRow);newFilteredOutRows.push(newIndex)}else newFilteredOutRows.push(row-(endRow-startRow+1-filterOutInRemove.length))}))}if(command.id===sheets_src.bS1.id){const{startRow,endRow}=command.params.range;filteredOutRows.forEach((row=>{row>=startRow?(changed=!0,newFilteredOutRows.push(row+(endRow-startRow+1))):newFilteredOutRows.push(row)}))}if(changed&&(filterModel.filteredOutRows=new Set(newFilteredOutRows)),command.id===sheets_src.N48.id&&!options?.onlyLocal){const extendRegion=this._getExtendRegion(unitId,subUnitId);if(extendRegion){const cellValue=command.params.cellValue;if(cellValue)for(let col=extendRegion.startColumn;col<=extendRegion.endColumn;col++){const cell=cellValue?.[extendRegion.startRow]?.[col];if(cell&&this._cellHasValue(cell)){const worksheet=this._univerInstanceService.getUnit(unitId)?.getSheetBySheetId(subUnitId);if(worksheet){const extendedRange=(0,sheets_src.OqS)(extendRegion,{down:!0},worksheet),filterModel=this._sheetsFilterService.getFilterModel(unitId,subUnitId),filterRange=filterModel.getRange();filterModel.setRange({...filterRange,endRow:extendedRange.endRow}),this._registerRefRange(unitId,subUnitId)}}}}}})))}_getExtendRegion(unitId,subUnitId){const filterModel=this._sheetsFilterService.getFilterModel(unitId,subUnitId);if(!filterModel)return null;const worksheet=this._univerInstanceService.getUnit(unitId)?.getSheetBySheetId(subUnitId);if(!worksheet)return null;const filterRange=filterModel.getRange();if(!filterRange)return null;const maxRowIndex=worksheet.getRowCount()-1,rowManager=worksheet.getRowManager();for(let row=filterRange.endRow+1;row<=maxRowIndex;row++)if(rowManager.getRowRawVisible(row))return{startRow:row,endRow:row,startColumn:filterRange.startColumn,endColumn:filterRange.endColumn};return null}_initErrorHandling(){this.disposeWithMe(this._commandService.beforeCommandExecuted((command=>{const params=command.params,target=(0,sheets_src.go2)(this._univerInstanceService);if(!target)return;const{subUnitId,unitId}=target,filterModel=this._sheetsFilterService.getFilterModel(unitId,subUnitId);if(!filterModel)return;const filterRange=filterModel.getRange();if(command.id===sheets_src.wAI.id&&params.fromRange.startRow<=filterRange.startRow&&params.fromRange.endRow<filterRange.endRow&&params.fromRange.endRow>=filterRange.startRow)throw this._sheetsFilterService.setFilterErrorMsg("sheets-filter.msg.filter-header-forbidden"),new Error("[SheetsFilterController]: Cannot move header row of filter")})))}_cellHasValue(cell){const values=Object.values(cell);return 0!==values.length&&!values.every((v=>null==v))}}SheetsFilterController=function sheets_filter_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([sheets_filter_controller_ts_param(0,src.wTY),sheets_filter_controller_ts_param(1,(0,src.y_5)(sheets_src.e5R)),sheets_filter_controller_ts_param(2,(0,src.y_5)(SheetsFilterService)),sheets_filter_controller_ts_param(3,src.HCr),sheets_filter_controller_ts_param(4,(0,src.y_5)(sheets_src.u7_)),sheets_filter_controller_ts_metadata("design:type",Function),sheets_filter_controller_ts_metadata("design:paramtypes",[void 0===src.wTY?Object:src.wTY,void 0===sheets_src.e5R?Object:sheets_src.e5R,void 0===SheetsFilterService?Object:SheetsFilterService,void 0===src.HCr?Object:src.HCr,void 0===sheets_src.u7_?Object:sheets_src.u7_])],SheetsFilterController);var engine_formula_src=__webpack_require__("../../packages/engine-formula/src/index.ts");function sheet_filter_formula_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function sheet_filter_formula_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class SheetsFilterFormulaService extends src.jGt{constructor(_activeDirtyManagerService,_sheetsFilterService,_univerInstanceService){super(),this._activeDirtyManagerService=_activeDirtyManagerService,this._sheetsFilterService=_sheetsFilterService,this._univerInstanceService=_univerInstanceService,this._initFormulaDirtyRange()}_initFormulaDirtyRange(){FILTER_MUTATIONS.forEach((commandId=>{this._activeDirtyManagerService.register(commandId,{commandId,getDirtyData:commandInfo=>{const params=commandInfo.params,{unitId,subUnitId}=params;return{dirtyRanges:this._getHideRowMutation(unitId,subUnitId),clearDependencyTreeCache:{[unitId]:{[subUnitId]:"1"}}}}})}))}_getHideRowMutation(unitId,subUnitId){const range=this._sheetsFilterService.getFilterModel(unitId,subUnitId)?.getRange(),sheet=this._univerInstanceService.getUnit(unitId)?.getSheetBySheetId(subUnitId);if(null==range||null==sheet)return[];const{startRow,endRow}=range;return[{unitId,sheetId:subUnitId,range:{startRow,startColumn:0,endRow,endColumn:sheet.getColumnCount()-1}}]}}function plugin_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function plugin_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}SheetsFilterFormulaService=function sheet_filter_formula_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([sheet_filter_formula_service_ts_param(0,(0,src.y_5)(engine_formula_src.E1)),sheet_filter_formula_service_ts_param(1,(0,src.y_5)(SheetsFilterService)),sheet_filter_formula_service_ts_param(2,src.HCr),sheet_filter_formula_service_ts_metadata("design:type",Function),sheet_filter_formula_service_ts_metadata("design:paramtypes",[void 0===engine_formula_src.E1?Object:engine_formula_src.E1,void 0===SheetsFilterService?Object:SheetsFilterService,void 0===src.HCr?Object:src.HCr])],SheetsFilterFormulaService);class UniverSheetsFilterPlugin extends src.k_1{static#_=this.type=src.Zy$.UNIVER_SHEET;static#_2=this.pluginName="SHEET_FILTER_PLUGIN";constructor(_config=defaultPluginConfig,_injector,_configService){super(),this._config=_config,this._injector=_injector,this._configService=_configService;const{...rest}=(0,src.h1I)({},defaultPluginConfig,this._config);this._configService.setConfig("sheets-filter.config",rest)}onStarting(){[[SheetsFilterFormulaService],[SheetsFilterService],[SheetsFilterController]].forEach((d=>this._injector.add(d)))}onReady(){(0,src.HLP)(this._injector,[[SheetsFilterFormulaService],[SheetsFilterController]])}}UniverSheetsFilterPlugin=function plugin_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([plugin_ts_param(1,(0,src.y_5)(src.zZn)),plugin_ts_param(2,src.J0C),plugin_ts_metadata("design:type",Function),plugin_ts_metadata("design:paramtypes",["undefined"==typeof Partial?Object:Partial,void 0===src.zZn?Object:src.zZn,void 0===src.J0C?Object:src.J0C])],UniverSheetsFilterPlugin);const SetSheetFilterRangeCommand_id="sheet.command.set-filter-range",RemoveSheetFilterCommand_id=(src.g4t.COMMAND,"sheet.command.remove-sheet-filter"),SmartToggleSheetsFilterCommand=(src.g4t.COMMAND,{id:"sheet.command.smart-toggle-filter",type:src.g4t.COMMAND,handler:async accessor=>{const univerInstanceService=accessor.get(src.HCr),sheetsFilterService=accessor.get(SheetsFilterService),commandService=accessor.get(src.wTY),currentWorkbook=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),currentWorksheet=currentWorkbook?.getActiveSheet();if(!currentWorksheet||!currentWorkbook)return!1;const unitId=currentWorkbook.getUnitId(),subUnitId=currentWorksheet.getSheetId();if(sheetsFilterService.getFilterModel(unitId,subUnitId))return commandService.executeCommand(RemoveSheetFilterCommand_id,{unitId,subUnitId});const lastSelection=accessor.get(sheets_src.Fal).getCurrentLastSelection();if(!lastSelection)return!1;const startRange=lastSelection.range,targetFilterRange=(0,sheets_src.$zM)(lastSelection)?(0,sheets_src.OqS)(startRange,{left:!0,right:!0,up:!0,down:!0},currentWorksheet):startRange;return commandService.executeCommand(SetSheetFilterRangeCommand_id,{unitId,subUnitId,range:targetFilterRange})}}),SetSheetsFilterCriteriaCommand={id:"sheet.command.set-filter-criteria",type:src.g4t.COMMAND,handler:(accessor,params)=>{const sheetsFilterService=accessor.get(SheetsFilterService),commandService=accessor.get(src.wTY),undoRedoService=accessor.get(src.$Dz),{unitId,subUnitId,col,criteria}=params,filterModel=sheetsFilterService.getFilterModel(unitId,subUnitId);if(!filterModel)return!1;const range=filterModel.getRange();if(!range||col<range.startColumn||col>range.endColumn)return!1;const undoMutation=function destructFilterColumn(unitId,subUnitId,colId,filterColumn){if(!filterColumn)return{id:SetSheetsFilterCriteriaMutation.id,params:{unitId,subUnitId,col:colId,criteria:null}};const serialize=filterColumn.serialize();return{id:SetSheetsFilterCriteriaMutation.id,params:{unitId,subUnitId,col:colId,criteria:serialize}}}(unitId,subUnitId,col,filterModel.getFilterColumn(col)),redoMutation={id:SetSheetsFilterCriteriaMutation.id,params:{unitId,subUnitId,col,criteria}},result=commandService.syncExecuteCommand(redoMutation.id,redoMutation.params);return result&&undoRedoService.pushUndoRedo({unitID:unitId,undoMutations:[undoMutation],redoMutations:[redoMutation]}),result}},ClearSheetsFilterCriteriaCommand={id:"sheet.command.clear-filter-criteria",type:src.g4t.COMMAND,handler:(accessor,params)=>{const sheetsFilterService=accessor.get(SheetsFilterService),undoRedoService=accessor.get(src.$Dz),commandService=accessor.get(src.wTY),instanceSrv=accessor.get(src.HCr),commandTarget=(0,sheets_src.go2)(instanceSrv,params);if(!commandTarget)return!1;const{unitId,subUnitId}=commandTarget,filterModel=sheetsFilterService.getFilterModel(commandTarget.unitId,commandTarget.subUnitId);if(!filterModel)return!1;const autoFilter=filterModel.serialize(),undoMutations=destructFilterCriteria(unitId,subUnitId,autoFilter),redoMutations=function generateRemoveCriteriaMutations(unitId,subUnitId,autoFilter){const mutations=[];return autoFilter.filterColumns?.forEach((filterColumn=>{const removeFilterCriteriaMutation={id:SetSheetsFilterCriteriaMutation.id,params:{unitId,subUnitId,col:filterColumn.colId,criteria:null}};mutations.push(removeFilterCriteriaMutation)})),mutations}(unitId,subUnitId,autoFilter);return!!(0,src.PkI)(redoMutations,commandService).result&&(undoRedoService.pushUndoRedo({unitID:unitId,undoMutations,redoMutations}),!0)}},ReCalcSheetsFilterCommand={id:"sheet.command.re-calc-filter",type:src.g4t.COMMAND,handler:(accessor,params)=>{const sheetsFilterService=accessor.get(SheetsFilterService),commandService=accessor.get(src.wTY),instanceSrv=accessor.get(src.HCr),commandTarget=(0,sheets_src.go2)(instanceSrv,params);if(!commandTarget)return!1;const{unitId,subUnitId}=commandTarget;return!!sheetsFilterService.getFilterModel(commandTarget.unitId,commandTarget.subUnitId)&&commandService.executeCommand(ReCalcSheetsFilterMutation.id,{unitId,subUnitId})}};function destructFilterCriteria(unitId,subUnitId,autoFilter){const mutations=[];return autoFilter.filterColumns?.forEach((filterColumn=>{const setFilterCriteriaMutation={id:SetSheetsFilterCriteriaMutation.id,params:{unitId,subUnitId,col:filterColumn.colId,criteria:filterColumn}};mutations.push(setFilterCriteriaMutation)})),mutations}var injectStylesIntoStyleTag=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),styleDomAPI=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/styleDomAPI.js"),styleDomAPI_default=__webpack_require__.n(styleDomAPI),insertBySelector=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/insertBySelector.js"),insertBySelector_default=__webpack_require__.n(insertBySelector),setAttributesWithoutAttributes=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),setAttributesWithoutAttributes_default=__webpack_require__.n(setAttributesWithoutAttributes),insertStyleElement=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/insertStyleElement.js"),insertStyleElement_default=__webpack_require__.n(insertStyleElement),styleTagTransform=__webpack_require__("../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/style-loader/dist/runtime/styleTagTransform.js"),styleTagTransform_default=__webpack_require__.n(styleTagTransform),global=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[13].use[1]!../../node_modules/.pnpm/postcss-loader@8.1.1_postcss@8.5.3_typescript@5.8.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[13].use[2]!../../packages/sheets-ui/src/global.css"),options={};options.styleTagTransform=styleTagTransform_default(),options.setAttributes=setAttributesWithoutAttributes_default(),options.insert=insertBySelector_default().bind(null,"head"),options.domAPI=styleDomAPI_default(),options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(global.A,options);global.A&&global.A.locals&&global.A.locals;var docs_ui_src_global=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[13].use[1]!../../node_modules/.pnpm/postcss-loader@8.1.1_postcss@8.5.3_typescript@5.8.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[13].use[2]!../../packages/docs-ui/src/global.css"),global_options={};global_options.styleTagTransform=styleTagTransform_default(),global_options.setAttributes=setAttributesWithoutAttributes_default(),global_options.insert=insertBySelector_default().bind(null,"head"),global_options.domAPI=styleDomAPI_default(),global_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(docs_ui_src_global.A,global_options);docs_ui_src_global.A&&docs_ui_src_global.A.locals&&docs_ui_src_global.A.locals;var docs_src=__webpack_require__("../../packages/docs/src/index.ts");function doc_auto_format_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function doc_auto_format_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}function getParagraphsInRange(activeRange,paragraphs){const{startOffset,endOffset}=activeRange,results=[];let start=-1;for(let i=0;i<paragraphs.length;i++){const paragraph=paragraphs[i],prevParagraph=paragraphs[i-1],{startIndex}=paragraph;(startOffset>start&&startOffset<=startIndex||endOffset>start&&endOffset<=startIndex||startIndex>=startOffset&&startIndex<=endOffset)&&results.push({...paragraph,paragraphStart:(prevParagraph?.startIndex??-1)+1,paragraphEnd:paragraph.startIndex}),start=startIndex}return results}class DocAutoFormatService extends src.jGt{constructor(_univerInstanceService,_textSelectionManagerService){super(),this._univerInstanceService=_univerInstanceService,this._textSelectionManagerService=_textSelectionManagerService,this._matches=new Map}registerAutoFormat(match){const matchList=this._matches.get(match.id);return matchList?(matchList.push(match),matchList.sort(((a,b)=>(b.priority??0)-(a.priority??0)))):this._matches.set(match.id,[match]),(0,src.saO)((()=>{const matchList=this._matches.get(match.id);if(matchList){const index=matchList.findIndex((i=>i===match));index>=0&&matchList.splice(index,1)}}))}onAutoFormat(id,params){const autoFormats=this._matches.get(id)??[],unit=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_DOC),docRanges=this._textSelectionManagerService.getDocRanges(),selection=docRanges.find((range=>range.isActive))??docRanges[0];if(unit&&selection){const doc=unit.getSelfOrHeaderFooterModel(selection.segmentId),context={unit:doc,selection,isBody:!selection.segmentId,paragraphs:getParagraphsInRange(selection,doc.getBody()?.paragraphs??[]),customRanges:src.Z4q.customRange.getCustomRangesInterestsWithSelection(selection,doc.getBody()?.customRanges??[]),commandId:id,commandParams:params},matched=autoFormats.find((i=>i.match(context)));return matched?.getMutations(context)??[]}return[]}}DocAutoFormatService=function doc_auto_format_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([doc_auto_format_service_ts_param(0,src.HCr),doc_auto_format_service_ts_param(1,(0,src.y_5)(docs_src.pv)),doc_auto_format_service_ts_metadata("design:type",Function),doc_auto_format_service_ts_metadata("design:paramtypes",[void 0===src.HCr?Object:src.HCr,void 0===docs_src.pv?Object:docs_src.pv])],DocAutoFormatService);var component_tools=__webpack_require__("../../packages/docs-ui/src/basics/component-tools.ts");var docs_view_key=__webpack_require__("../../packages/docs-ui/src/basics/docs-view-key.ts");var engine_render_src=__webpack_require__("../../packages/engine-render/src/index.ts"),ui_src=__webpack_require__("../../packages/ui/src/index.ts"),react=__webpack_require__("../../node_modules/.pnpm/react@19.0.0/node_modules/react/index.js");var design_src=__webpack_require__("../../packages/design/src/index.ts"),editor_manager_service=__webpack_require__("../../packages/docs-ui/src/services/editor/editor-manager.service.ts"),doc_selection_render_service=__webpack_require__("../../packages/docs-ui/src/services/selection/doc-selection-render.service.ts");const MoveCursorOperation={id:"doc.operation.move-cursor",type:src.g4t.OPERATION,handler:(accessor,params)=>!!params},MoveSelectionOperation={id:"doc.operation.move-selection",type:src.g4t.OPERATION,handler:(accessor,params)=>!!params},useLeftAndRightArrow=(isNeed,selectingMode,editor,onMoveInEditor)=>{const commandService=(0,ui_src.fJ)(src.wTY),shortcutService=(0,ui_src.fJ)(ui_src.nF);(0,react.useRef)(selectingMode).current=selectingMode;const onMoveInEditorRef=(0,react.useRef)(onMoveInEditor);onMoveInEditorRef.current=onMoveInEditor,(0,react.useEffect)((()=>{if(!editor||!isNeed)return;const operationId=`sheet.formula-embedding-editor.${editor.getEditorId()}`,d=new src.VdD;d.add(commandService.registerCommand({id:operationId,type:src.g4t.OPERATION,handler(_event,params){const{keyCode}=params;((keycode,metaKey)=>{if(onMoveInEditorRef.current)return void onMoveInEditorRef.current(keycode,metaKey);let direction=src.OP3.LEFT;keycode===ui_src.DD.ARROW_DOWN?direction=src.OP3.DOWN:keycode===ui_src.DD.ARROW_UP?direction=src.OP3.UP:keycode===ui_src.DD.ARROW_RIGHT&&(direction=src.OP3.RIGHT),metaKey===ui_src.SK.SHIFT?commandService.executeCommand(MoveSelectionOperation.id,{direction}):commandService.executeCommand(MoveCursorOperation.id,{direction})})(keyCode)}}));return[{keyCode:ui_src.DD.ARROW_DOWN},{keyCode:ui_src.DD.ARROW_LEFT},{keyCode:ui_src.DD.ARROW_RIGHT},{keyCode:ui_src.DD.ARROW_UP},{keyCode:ui_src.DD.ARROW_DOWN,metaKey:ui_src.SK.SHIFT},{keyCode:ui_src.DD.ARROW_LEFT,metaKey:ui_src.SK.SHIFT},{keyCode:ui_src.DD.ARROW_RIGHT,metaKey:ui_src.SK.SHIFT},{keyCode:ui_src.DD.ARROW_UP,metaKey:ui_src.SK.SHIFT},{keyCode:ui_src.DD.ARROW_DOWN,metaKey:ui_src.SK.CTRL_COMMAND},{keyCode:ui_src.DD.ARROW_LEFT,metaKey:ui_src.SK.CTRL_COMMAND},{keyCode:ui_src.DD.ARROW_RIGHT,metaKey:ui_src.SK.CTRL_COMMAND},{keyCode:ui_src.DD.ARROW_UP,metaKey:ui_src.SK.CTRL_COMMAND},{keyCode:ui_src.DD.ARROW_DOWN,metaKey:ui_src.SK.CTRL_COMMAND|ui_src.SK.SHIFT},{keyCode:ui_src.DD.ARROW_LEFT,metaKey:ui_src.SK.CTRL_COMMAND|ui_src.SK.SHIFT},{keyCode:ui_src.DD.ARROW_RIGHT,metaKey:ui_src.SK.CTRL_COMMAND|ui_src.SK.SHIFT},{keyCode:ui_src.DD.ARROW_UP,metaKey:ui_src.SK.CTRL_COMMAND|ui_src.SK.SHIFT}].map((({keyCode,metaKey})=>({id:operationId,binding:metaKey?keyCode|metaKey:keyCode,preconditions:()=>!0,priority:900,staticParameters:{eventType:engine_render_src.bKQ.Keyboard,keyCode}}))).forEach((item=>{d.add(shortcutService.registerShortcut(item))})),()=>{d.dispose()}}),[commandService,editor,isNeed,shortcutService])};var index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/docs-ui/src/views/rich-text-editor/index.module.less"),index_module_options={};index_module_options.styleTagTransform=styleTagTransform_default(),index_module_options.setAttributes=setAttributesWithoutAttributes_default(),index_module_options.insert=insertBySelector_default().bind(null,"head"),index_module_options.domAPI=styleDomAPI_default(),index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(index_module.A,index_module_options);const rich_text_editor_index_module=index_module.A&&index_module.A.locals?index_module.A.locals:void 0;(props=>{const{className,autoFocus,onFocusChange:_onFocusChange,initialValue,onClickOutside:_onClickOutside,keyboardEventConfig,moveCursor=!0,style,isSingle,editorId:propsEditorId,onHeightChange,onChange:_onChange,defaultHeight=32,maxHeight=32,icon,editorRef}=props,editorService=(0,ui_src.fJ)(editor_manager_service.I),onFocusChange=(0,ui_src._q)(_onFocusChange),onClickOutside=(0,ui_src._q)(_onClickOutside),[height,setHeight]=(0,react.useState)(defaultHeight),formulaEditorContainerRef=react.useRef(null),editorId=(0,react.useMemo)((()=>propsEditorId??(0,src.EDB)(`RICH_TEXT_EDITOR-${(0,src.MZQ)(4)}`)),[propsEditorId]),editor=function useEditor(opts){const{editorId,initialValue,container,autoFocus:_autoFocus,isSingle}=opts,autoFocus=(0,react.useMemo)((()=>_autoFocus??!1),[]),[editor,setEditor]=(0,react.useState)(),editorService=(0,ui_src.fJ)(editor_manager_service.I);return(0,react.useLayoutEffect)((()=>{if(container.current){const initialDoc="string"==typeof initialValue?void 0:src.S0q.deepClone(initialValue),snapshot={body:{dataStream:"string"==typeof initialValue?`${initialValue}\r\n`:"\r\n",textRuns:[],customBlocks:[],customDecorations:[],customRanges:[],paragraphs:[{startIndex:0}]},...initialDoc,documentStyle:{...initialDoc?.documentStyle,pageSize:{width:isSingle?1/0:container.current.clientWidth,height:1/0}},id:editorId},dispose=editorService.register({autofocus:!0,editorUnitId:editorId,initialSnapshot:snapshot},container.current),editor=editorService.getEditor(editorId);if(setEditor(editor),autoFocus){editor.focus();const end=(snapshot.body?.dataStream.length??2)-2;editor.setSelectionRanges([{startOffset:end,endOffset:end}])}return()=>{dispose?.dispose()}}}),[]),editor}({editorId,initialValue,container:formulaEditorContainerRef,autoFocus,isSingle}),renderer=(0,ui_src.fJ)(engine_render_src.cSx).getRenderById(editorId),docSelectionRenderService=renderer?.with(doc_selection_render_service.q),selections=(0,ui_src.J2)(docSelectionRenderService?.textSelectionInner$),isFocusing=Boolean((docSelectionRenderService?.isFocusing??!1)&&selections?.textRanges.some((r=>r.collapsed))),sheetEmbeddingRef=react.useRef(null),[showPlaceholder,setShowPlaceholder]=(0,react.useState)((()=>!src.Z4q.transform.getPlainText(editor?.getDocumentData().body?.dataStream??""))),{checkScrollBar}=((editor,isSingle=!0,autoScrollbar,autoScroll)=>{const resize=(0,react.useCallback)((()=>{if(editor){const{scene,mainComponent}=editor.render,docSkeletonManagerService=editor.render.with(docs_src.EX),{width,height}=editor.getBoundingClientRect();docSkeletonManagerService.getViewModel().getDataModel().updateDocumentDataPageSize(isSingle?1/0:width,1/0),scene.transformByState({width,height}),mainComponent?.resize(width,height)}}),[editor,isSingle]),checkScrollBar=(0,react.useMemo)((()=>(0,src.sg1)((()=>{if(!autoScrollbar)return;if(!editor||!autoScrollbar)return;const skeleton=editor.render.with(docs_src.EX).getSkeleton(),{scene,mainComponent}=editor.render,viewportMain=scene.getViewport(docs_view_key.hl.VIEW_MAIN),{actualWidth,actualHeight}=skeleton.getActualSize(),{width,height}=editor.getBoundingClientRect();let scrollBar=viewportMain?.getScrollBar();const contentWidth=Math.max(actualWidth,width),contentHeight=Math.max(actualHeight,height);scene.transformByState({width:contentWidth,height:contentHeight}),mainComponent?.resize(contentWidth,contentHeight),isSingle?actualWidth>width?(null==scrollBar?viewportMain&&new engine_render_src.$H1(viewportMain,{barSize:8,enableVertical:!1,enableHorizontal:!0,minThumbSizeV:8}):viewportMain?.resetCanvasSizeAndUpdateScroll(),autoScroll&&viewportMain?.scrollToBarPos({x:1/0,y:0})):(scrollBar=null,viewportMain?.scrollToBarPos({x:0,y:0}),viewportMain?.getScrollBar()?.dispose()):actualHeight>height?(null==scrollBar?viewportMain&&(scrollBar=new engine_render_src.$H1(viewportMain,{enableHorizontal:!1,enableVertical:!0,barSize:8,minThumbSizeV:8})):viewportMain?.resetCanvasSizeAndUpdateScroll(),autoScroll&&viewportMain?.scrollToBarPos({x:0,y:1/0})):(scrollBar=null,viewportMain?.scrollToBarPos({x:0,y:0}),viewportMain?.getScrollBar()?.dispose())}),30)),[editor,autoScrollbar,isSingle,autoScroll]);return(0,react.useEffect)((()=>{if(autoScrollbar&&editor){const time=setTimeout((()=>{resize(),checkScrollBar()}),500);return()=>{clearTimeout(time)}}}),[editor,autoScrollbar,resize,checkScrollBar]),(0,react.useEffect)((()=>{if(autoScrollbar&&editor){const d=editor.input$.subscribe((()=>{checkScrollBar()}));return()=>{d.unsubscribe()}}}),[editor,autoScrollbar,checkScrollBar]),{resize,checkScrollBar}})(editor,isSingle,!0,!0);(0,react.useLayoutEffect)((()=>{editorRef&&editor&&("function"!=typeof editorRef?editorRef.current=editor:editorRef(editor))}),[editor]);const onChange=(0,ui_src._q)((data=>{const docSkeleton=renderer?.with(docs_src.EX),size=docSkeleton?.getSkeleton().getActualSize();size&&(onHeightChange?.(size.actualHeight),setHeight(Math.max(defaultHeight,Math.min(size.actualHeight+10,maxHeight)))),_onChange?.(data,(0,src.AYz)(data.body?.dataStream??"")),checkScrollBar()}));return(0,react.useEffect)((()=>{setShowPlaceholder(!src.Z4q.transform.getPlainText(editor?.getDocumentData().body?.dataStream??""));const sub=editor?.selectionChange$.subscribe((()=>{setShowPlaceholder(!src.Z4q.transform.getPlainText(editor?.getDocumentData().body?.dataStream??""))}));return()=>sub?.unsubscribe()}),[editor]),(0,ui_src.J2)(editor?.blur$),(0,ui_src.J2)(editor?.focus$),(0,react.useEffect)((()=>{const data=editor?.getDocumentData();onFocusChange?.(isFocusing,(0,src.AYz)(data?.body?.dataStream??""))}),[isFocusing,onFocusChange]),(0,react.useEffect)((()=>{const handleClickOutside=event=>{if(editorService.getFocusId()!==editorId)return;const id=event.target?.dataset?.editorid;id!==editorId&&sheetEmbeddingRef.current&&!sheetEmbeddingRef.current.contains(event.target)&&onClickOutside?.()},timer=setTimeout((()=>{document.addEventListener("click",handleClickOutside)}),100);return()=>{document.removeEventListener("click",handleClickOutside),clearTimeout(timer)}}),[editor,editorId,editorService,onClickOutside]),useLeftAndRightArrow(isFocusing&&moveCursor,!1,editor),function useKeyboardEvent(isNeed,config,editor){const commandService=(0,ui_src.fJ)(src.wTY),shortcutService=(0,ui_src.fJ)(ui_src.nF),key=(0,react.useMemo)((()=>(0,src.MZQ)(4)),[]);(0,react.useEffect)((()=>{if(!editor||!isNeed||!config)return;const operationId=`sheet.operation.editor-${editor.getEditorId()}-keyboard-${key}`,d=new src.VdD;return d.add(commandService.registerCommand({id:operationId,type:src.g4t.OPERATION,handler(_event,params){const{keyCode,metaKey}=params;config.handler(keyCode,metaKey)}})),config.keyCodes.map((keyCode=>({id:operationId,binding:keyCode.metaKey?keyCode.keyCode|keyCode.metaKey:keyCode.keyCode,preconditions:()=>!0,priority:901,staticParameters:{eventType:engine_render_src.bKQ.Keyboard,keyCode:keyCode.keyCode,metaKey:keyCode.metaKey}}))).forEach((item=>{d.add(shortcutService.registerShortcut(item))})),()=>{d.dispose()}}),[commandService,config,editor,isNeed,key,shortcutService])}(isFocusing,keyboardEventConfig,editor),function useOnChange(editor,onChange){const commandService=(0,ui_src.fJ)(src.wTY);(0,react.useEffect)((()=>{if(!editor)return;const dispose=commandService.onCommandExecuted((command=>{if(command.id===docs_src.Bz.id){if(command.params.unitId!==editor.getEditorId())return;const data=editor.getDocumentData();onChange(data,(0,src.AYz)(data.body?.dataStream??""))}}));return()=>{dispose.dispose()}}),[editor,onChange,commandService])}(editor,onChange),(0,jsx_runtime.jsx)("div",{className:(0,design_src.$z)(rich_text_editor_index_module.richTextEditor,className),style,children:(0,jsx_runtime.jsxs)("div",{className:(0,design_src.$z)(rich_text_editor_index_module.richTextEditorWrap,{[rich_text_editor_index_module.richTextEditorActive]:isFocusing}),style:{height},ref:sheetEmbeddingRef,children:[(0,jsx_runtime.jsx)("div",{className:rich_text_editor_index_module.richTextEditorText,ref:formulaEditorContainerRef,onMouseUp:()=>editor?.focus()}),icon,showPlaceholder?(0,jsx_runtime.jsx)("div",{className:rich_text_editor_index_module.richTextEditorPlaceholder,children:props.placeholder}):null]})})}).__docgenInfo={description:"",methods:[],displayName:"RichTextEditor",props:{className:{required:!1,tsType:{name:"string"},description:""},autoFocus:{required:!1,tsType:{name:"boolean"},description:""},onFocusChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(isFocus: boolean, newValue?: string) => void",signature:{arguments:[{type:{name:"boolean"},name:"isFocus"},{type:{name:"string"},name:"newValue"}],return:{name:"void"}}},description:""},initialValue:{required:!1,tsType:{name:"union",raw:"IDocumentData | string",elements:[{name:"IDocumentData"},{name:"string"}]},description:""},onClickOutside:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},keyboardEventConfig:{required:!1,tsType:{name:"IKeyboardEventConfig"},description:""},moveCursor:{required:!1,tsType:{name:"boolean"},description:""},style:{required:!1,tsType:{name:"ReactCSSProperties",raw:"React.CSSProperties"},description:""},isSingle:{required:!1,tsType:{name:"boolean"},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},editorId:{required:!1,tsType:{name:"string"},description:""},onHeightChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(height: number) => void",signature:{arguments:[{type:{name:"number"},name:"height"}],return:{name:"void"}}},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(data: IDocumentData, str: string) => void",signature:{arguments:[{type:{name:"IDocumentData"},name:"data"},{type:{name:"string"},name:"str"}],return:{name:"void"}}},description:""},maxHeight:{required:!1,tsType:{name:"number"},description:""},defaultHeight:{required:!1,tsType:{name:"number"},description:""},icon:{required:!1,tsType:{name:"ReactNode"},description:""},editorRef:{required:!1,tsType:{name:"union",raw:"React.RefObject<Editor | null> | ((editor: Editor | null) => void)",elements:[{name:"ReactRefObject",raw:"React.RefObject<Editor | null>",elements:[{name:"union",raw:"Editor | null",elements:[{name:"Editor"},{name:"null"}]}]},{name:"unknown"}]},description:""}}};var util=__webpack_require__("../../packages/docs-ui/src/commands/util.ts"),todo_list=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/todo-list.js"),doc_header_footer_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/doc-header-footer.command.ts"),doc_header_footer_panel_operation=__webpack_require__("../../packages/docs-ui/src/commands/operations/doc-header-footer-panel.operation.ts"),color_picker=__webpack_require__("../../packages/docs-ui/src/components/color-picker/index.ts"),font_family=__webpack_require__("../../packages/docs-ui/src/components/font-family/index.ts"),font_size=__webpack_require__("../../packages/docs-ui/src/components/font-size/index.ts"),list_type_picker=__webpack_require__("../../packages/docs-ui/src/components/list-type-picker/index.ts");const TabCommand={id:"doc.command.tab",type:src.g4t.COMMAND,async handler(accessor,params){const mutations=accessor.get(DocAutoFormatService).onAutoFormat(TabCommand.id,params);return(await(0,src.LPr)(mutations,accessor.get(src.wTY))).result}},AfterSpaceCommand={id:"doc.command.after-space",type:src.g4t.COMMAND,async handler(accessor){const mutations=accessor.get(DocAutoFormatService).onAutoFormat(AfterSpaceCommand.id);return(await(0,src.LPr)(mutations,accessor.get(src.wTY))).result}},EnterCommand={id:"doc.command.enter",type:src.g4t.COMMAND,async handler(accessor){const mutations=accessor.get(DocAutoFormatService).onAutoFormat(EnterCommand.id);return(await(0,src.LPr)(mutations,accessor.get(src.wTY))).result}};function whenDocAndEditorFocused(contextService){return contextService.getContextValue(src.y0c)&&contextService.getContextValue(src.l1D)&&!contextService.getContextValue(src.fiP)}const TabShortCut={id:TabCommand.id,binding:ui_src.DD.TAB,preconditions:whenDocAndEditorFocused},ShiftTabShortCut={id:TabCommand.id,binding:ui_src.DD.TAB|ui_src.SK.SHIFT,preconditions:whenDocAndEditorFocused,staticParameters:{shift:!0}};var inline_format_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/inline-format.command.ts"),list_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/list.command.ts"),paragraph_align_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/paragraph-align.command.ts");const BoldShortCut={id:inline_format_command.D6.id,binding:ui_src.DD.B|ui_src.SK.CTRL_COMMAND,preconditions:whenDocAndEditorFocused},ItalicShortCut={id:inline_format_command._H.id,binding:ui_src.DD.I|ui_src.SK.CTRL_COMMAND,preconditions:whenDocAndEditorFocused},UnderlineShortCut={id:inline_format_command.uk.id,binding:ui_src.DD.U|ui_src.SK.CTRL_COMMAND,preconditions:whenDocAndEditorFocused},StrikeThroughShortCut={id:inline_format_command.rF.id,binding:ui_src.DD.X|ui_src.SK.SHIFT|ui_src.SK.CTRL_COMMAND,preconditions:whenDocAndEditorFocused},SubscriptShortCut={id:inline_format_command.xL.id,binding:ui_src.DD.COMMA|ui_src.SK.CTRL_COMMAND,preconditions:whenDocAndEditorFocused},SuperscriptShortCut={id:inline_format_command.yS.id,binding:ui_src.DD.PERIOD|ui_src.SK.CTRL_COMMAND,preconditions:whenDocAndEditorFocused},AlignLeftShortCut={id:paragraph_align_command.c5.id,binding:ui_src.DD.L|ui_src.SK.CTRL_COMMAND|ui_src.SK.SHIFT,preconditions:whenDocAndEditorFocused},AlignRightShortCut={id:paragraph_align_command.L7.id,binding:ui_src.DD.R|ui_src.SK.CTRL_COMMAND|ui_src.SK.SHIFT,preconditions:whenDocAndEditorFocused},AlignCenterShortCut={id:paragraph_align_command.uk.id,binding:ui_src.DD.E|ui_src.SK.CTRL_COMMAND|ui_src.SK.SHIFT,preconditions:whenDocAndEditorFocused},AlignJustifyShortCut={id:paragraph_align_command.JV.id,binding:ui_src.DD.J|ui_src.SK.CTRL_COMMAND|ui_src.SK.SHIFT,preconditions:whenDocAndEditorFocused},OrderListShortCut={id:list_command.kx.id,binding:ui_src.DD.Digit7|ui_src.SK.CTRL_COMMAND|ui_src.SK.SHIFT,preconditions:whenDocAndEditorFocused},BulletListShortCut={id:list_command.mh.id,binding:ui_src.DD.Digit8|ui_src.SK.CTRL_COMMAND|ui_src.SK.SHIFT,preconditions:whenDocAndEditorFocused};var count_bar_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/docs-ui/src/views/count-bar/index.module.less"),count_bar_index_module_options={};count_bar_index_module_options.styleTagTransform=styleTagTransform_default(),count_bar_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),count_bar_index_module_options.insert=insertBySelector_default().bind(null,"head"),count_bar_index_module_options.domAPI=styleDomAPI_default(),count_bar_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(count_bar_index_module.A,count_bar_index_module_options);const views_count_bar_index_module=count_bar_index_module.A&&count_bar_index_module.A.locals?count_bar_index_module.A.locals:void 0,SetDocZoomRatioOperation={id:"doc.operation.set-zoom-ratio",type:src.g4t.OPERATION,handler:(accessor,params)=>{const documentModel=accessor.get(src.HCr).getUniverDocInstance(params.unitId);if(!documentModel)return!1;const documentData=documentModel.getSnapshot();return null==documentData.settings?documentData.settings={zoomRatio:params.zoomRatio}:documentData.settings.zoomRatio=params.zoomRatio,!0}},ZOOM_MAP=[50,80,100,130,150,170,200,400],DOC_ZOOM_RANGE=[10,400];function ZoomSlider(){const commandService=(0,ui_src.fJ)(src.wTY),univerInstanceService=(0,ui_src.fJ)(src.HCr),currentDoc$=(0,react.useMemo)((()=>univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_DOC)),[]),documentDataModel=(0,ui_src.J2)(currentDoc$),getCurrentZoom=(0,react.useCallback)((()=>{if(!documentDataModel)return 100;const currentZoom=100*(documentDataModel.getSettings()?.zoomRatio??1);return Math.round(currentZoom)}),[documentDataModel]),[zoom,setZoom]=(0,react.useState)((()=>getCurrentZoom()));return(0,react.useEffect)((()=>{setZoom(getCurrentZoom());return commandService.onCommandExecuted((commandInfo=>{if(commandInfo.id===SetDocZoomRatioOperation.id){const currentZoom=getCurrentZoom();setZoom(currentZoom)}})).dispose}),[commandService,getCurrentZoom]),(0,jsx_runtime.jsx)(ui_src.Ap,{min:DOC_ZOOM_RANGE[0],value:zoom,shortcuts:ZOOM_MAP,onChange:function handleChange(value){if(setZoom(value),null==documentDataModel)return;const zoomRatio=value/100;commandService.executeCommand(SetDocZoomRatioOperation.id,{unitId:documentDataModel.getUnitId(),zoomRatio})}})}function CountBar(props){return(0,jsx_runtime.jsx)("section",{className:views_count_bar_index_module.docCountBar,children:(0,jsx_runtime.jsx)(ZoomSlider,{})})}ZoomSlider.__docgenInfo={description:"",methods:[],displayName:"ZoomSlider"},CountBar.__docgenInfo={description:"",methods:[],displayName:"CountBar",props:{changeRatio:{required:!1,tsType:{name:"signature",type:"function",raw:"(ratio: string) => void",signature:{arguments:[{type:{name:"string"},name:"ratio"}],return:{name:"void"}}},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""}}};var doc_footer_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/docs-ui/src/views/doc-footer/index.module.less"),doc_footer_index_module_options={};doc_footer_index_module_options.styleTagTransform=styleTagTransform_default(),doc_footer_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),doc_footer_index_module_options.insert=insertBySelector_default().bind(null,"head"),doc_footer_index_module_options.domAPI=styleDomAPI_default(),doc_footer_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(doc_footer_index_module.A,doc_footer_index_module_options);const views_doc_footer_index_module=doc_footer_index_module.A&&doc_footer_index_module.A.locals?doc_footer_index_module.A.locals:void 0,DocFooter=()=>{const univerInstanceService=(0,ui_src.fJ)(src.HCr);return(0,ui_src.J2)((()=>univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET)),void 0,void 0,[])?null:(0,jsx_runtime.jsxs)("div",{className:views_doc_footer_index_module.docFooterContainer,children:[(0,jsx_runtime.jsx)("div",{}),(0,jsx_runtime.jsx)(CountBar,{})]})};DocFooter.__docgenInfo={description:"",methods:[],displayName:"DocFooter"};Symbol("docs-ui.config");const config_schema_defaultPluginConfig={layout:{docContainerConfig:{outerLeft:!1,outerRight:!1,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!1,frozenHeaderRT:!1,frozenHeaderLM:!1,frozenContent:!1,infoBar:!0,toolbar:!0},toolbarConfig:{undo:!0,redo:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0}}};var menu_schema=__webpack_require__("../../packages/docs-ui/src/controllers/menu.schema.ts");function doc_ui_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function doc_ui_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class DocUIController extends src.jGt{constructor(_injector,_componentManager,_commandService,_layoutService,_menuManagerService,_uiPartsService,_univerInstanceService,_shortcutService,_configService){super(),this._injector=_injector,this._componentManager=_componentManager,this._commandService=_commandService,this._layoutService=_layoutService,this._menuManagerService=_menuManagerService,this._uiPartsService=_uiPartsService,this._univerInstanceService=_univerInstanceService,this._shortcutService=_shortcutService,this._configService=_configService,this._init()}_initCustomComponents(){const componentManager=this._componentManager;this.disposeWithMe(componentManager.register(color_picker.X,color_picker.s)),this.disposeWithMe(componentManager.register(font_family.fj,font_family.ay)),this.disposeWithMe(componentManager.register(font_family.VI,font_family.vK)),this.disposeWithMe(componentManager.register(font_size.K,font_size.Z)),this.disposeWithMe(componentManager.register(list_type_picker.n_,list_type_picker.hT)),this.disposeWithMe(componentManager.register(list_type_picker.$t,list_type_picker.BI)),this.disposeWithMe(componentManager.register("TodoList",todo_list.A))}_initUiParts(){const config=this._configService.getConfig("docs-ui.config");config?.layout?.docContainerConfig?.footer&&this.disposeWithMe(this._uiPartsService.registerComponent(ui_src.ns.FOOTER,(()=>(0,ui_src.pK)(DocFooter,this._injector))))}_initMenus(){this._menuManagerService.mergeMenu(menu_schema.X)}_initShortCut(){[BoldShortCut,ItalicShortCut,UnderlineShortCut,StrikeThroughShortCut,SubscriptShortCut,SuperscriptShortCut,AlignCenterShortCut,AlignJustifyShortCut,AlignRightShortCut,AlignLeftShortCut,OrderListShortCut,BulletListShortCut,TabShortCut].forEach((shortcut=>{this.disposeWithMe(this._shortcutService.registerShortcut(shortcut))}))}_init(){this._initCustomComponents(),this._initMenus(),this._initFocusHandler(),this._initCommands(),this._initUiParts(),this._initShortCut()}_initCommands(){[doc_header_footer_command.jP,doc_header_footer_command.WM,doc_header_footer_panel_operation.Q].forEach((command=>this.disposeWithMe(this._commandService.registerCommand(command))))}_initFocusHandler(){this.disposeWithMe(this._layoutService.registerFocusHandler(src.Zy$.UNIVER_DOC,(unitId=>{this._injector.get(engine_render_src.cSx).getRenderById(unitId).with(doc_selection_render_service.q).focus()})))}}DocUIController=function doc_ui_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([doc_ui_controller_ts_param(0,(0,src.y_5)(src.zZn)),doc_ui_controller_ts_param(1,(0,src.y_5)(ui_src.BJ)),doc_ui_controller_ts_param(2,src.wTY),doc_ui_controller_ts_param(3,ui_src.xQ),doc_ui_controller_ts_param(4,ui_src.Zi),doc_ui_controller_ts_param(5,ui_src.fe),doc_ui_controller_ts_param(6,src.HCr),doc_ui_controller_ts_param(7,ui_src.nF),doc_ui_controller_ts_param(8,src.J0C),doc_ui_controller_ts_metadata("design:type",Function),doc_ui_controller_ts_metadata("design:paramtypes",[void 0===src.zZn?Object:src.zZn,void 0===ui_src.BJ?Object:ui_src.BJ,void 0===src.wTY?Object:src.wTY,void 0===ui_src.xQ?Object:ui_src.xQ,void 0===ui_src.Zi?Object:ui_src.Zi,void 0===ui_src.fe?Object:ui_src.fe,void 0===src.HCr?Object:src.HCr,void 0===ui_src.nF?Object:ui_src.nF,void 0===src.J0C?Object:src.J0C])],DocUIController);var takeUntil=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/takeUntil.js"),convert_text_range=__webpack_require__("../../packages/docs-ui/src/services/selection/convert-text-range.ts"),text_range=__webpack_require__("../../packages/docs-ui/src/services/selection/text-range.ts");function back_scroll_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function back_scroll_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class DocBackScrollRenderController extends src.hy_{constructor(_context,_textSelectionManagerService,_editorService,_docSkeletonManagerService){super(),this._context=_context,this._textSelectionManagerService=_textSelectionManagerService,this._editorService=_editorService,this._docSkeletonManagerService=_docSkeletonManagerService,this._init()}_init(){this._textSelectionManagerService.textSelection$.pipe((0,takeUntil.Q)(this.dispose$)).subscribe((params=>{if(null==params)return;const{isEditing,unitId}=params;unitId===this._context.unitId&&isEditing&&this._context.unitId!==src.Fmw&&this._scrollToSelection()}))}scrollToRange(range){const skeleton=this._docSkeletonManagerService.getSkeleton();if(!skeleton)return;const{startOffset}=range,anchorNodePosition=skeleton.findNodePositionByCharIndex(startOffset);anchorNodePosition&&this.scrollToNode(anchorNodePosition)}scrollToNode(startNodePosition){const{unitId,scene,mainComponent}=this._context,skeleton=this._docSkeletonManagerService.getSkeleton();if(null==mainComponent||null==skeleton)return;const documentOffsetConfig=mainComponent.getOffsetConfig(),{docsLeft,docsTop}=documentOffsetConfig,convertor=new convert_text_range.Wb(documentOffsetConfig,skeleton),{contentBoxPointGroup}=convertor.getRangePointData(startNodePosition,startNodePosition),{left:aLeft,top:aTop,height}=(0,text_range.e$)(contentBoxPointGroup),left=aLeft+docsLeft,top=aTop+docsTop,viewportMain=scene.getViewport(docs_view_key.hl.VIEW_MAIN),editor=this._editorService.getEditor(unitId);if(null==viewportMain)return;const{left:boundLeft,top:boundTop,right:boundRight,bottom:boundBottom}=viewportMain.getBounding().viewBound;let offsetY=0,offsetX=0;const delta=editor?editor.params.backScrollOffset??0:100;top<boundTop?offsetY=top-boundTop-delta:top>boundBottom-height&&(offsetY=top-boundBottom+height+delta),left<boundLeft?offsetX=left-boundLeft:left>boundRight-1.5&&(offsetX=left-boundRight+1.5);const config=viewportMain.transViewportScroll2ScrollValue(offsetX,offsetY);viewportMain.scrollByBarDeltaValue(config)}_scrollToSelection(){const activeTextRange=this._textSelectionManagerService.getActiveTextRange();if(null==activeTextRange)return;const{collapsed,startNodePosition}=activeTextRange;collapsed&&this.scrollToNode(startNodePosition)}}function doc_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function doc_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}DocBackScrollRenderController=function back_scroll_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([back_scroll_render_controller_ts_param(1,(0,src.y_5)(docs_src.pv)),back_scroll_render_controller_ts_param(2,editor_manager_service.I),back_scroll_render_controller_ts_param(3,(0,src.y_5)(docs_src.EX)),back_scroll_render_controller_ts_metadata("design:type",Function),back_scroll_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===docs_src.pv?Object:docs_src.pv,void 0===editor_manager_service.I?Object:editor_manager_service.I,void 0===docs_src.EX?Object:docs_src.EX])],DocBackScrollRenderController);class DocRenderController extends src.hy_{constructor(_context,_commandService,_docSelectionRenderService,_docSkeletonManagerService,_editorService,_renderManagerService,_univerInstanceService){super(),this._context=_context,this._commandService=_commandService,this._docSelectionRenderService=_docSelectionRenderService,this._docSkeletonManagerService=_docSkeletonManagerService,this._editorService=_editorService,this._renderManagerService=_renderManagerService,this._univerInstanceService=_univerInstanceService,this._addNewRender(),this._initRenderRefresh(),this._initCommandListener()}reRender(unitId){const docSkeletonManagerService=this._renderManagerService.getRenderById(unitId)?.with(docs_src.EX),skeleton=docSkeletonManagerService?.getSkeleton();if(!skeleton)return;if(!!skeleton.getViewModel().getDataModel().getSnapshot().disabled)return;skeleton.calculate();const editor=this._editorService.getEditor(unitId);!this._editorService.isEditor(unitId)||editor?.params.scrollBar?this._recalculateSizeBySkeleton(skeleton):this._context.mainComponent?.makeDirty()}_addNewRender(){const{scene,engine}=this._context,viewMain=new engine_render_src.LMM(docs_view_key.hl.VIEW_MAIN,scene,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});scene.attachControl(),scene.onMouseWheel$.subscribeEvent(((evt,state)=>{const currentDocUnit=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_DOC);if(currentDocUnit?.getUnitId()!==this._context.unitId)return;const e=evt;if(e.ctrlKey){const deltaFactor=Math.abs(e.deltaX);let scrollNum=deltaFactor<40?.2:deltaFactor<80?.4:.2;scrollNum*=e.deltaY>0?-1:1,scene.scaleX<1&&(scrollNum/=2),scene.scaleX+scrollNum>4?scene.scale(4,4):scene.scaleX+scrollNum<.1?scene.scale(.1,.1):e.preventDefault()}else viewMain.onMouseWheel(e,state)})),new engine_render_src.$H1(viewMain),scene.addLayer(new engine_render_src.Wdr(scene,[],docs_view_key.lN),new engine_render_src.Wdr(scene,[],docs_view_key.th)),this._addComponent();const frameFn=()=>scene.render();this.disposeWithMe(this._context.activated$.subscribe((activated=>{activated?engine.runRenderLoop(frameFn):engine.stopRenderLoop(frameFn)}))),this._docSelectionRenderService.__attachScrollEvent()}_addComponent(){const{scene,unit:documentModel,components}=this._context,config={pageMarginLeft:20,pageMarginTop:20},documents=new engine_render_src.jjM(docs_view_key.C9.MAIN,void 0,config);documents.zIndex=docs_view_key._J;const docBackground=new engine_render_src.Ltz(docs_view_key.C9.BACKGROUND,void 0,config);docBackground.zIndex=docs_view_key._J,this._context.mainComponent=documents,components.set(docs_view_key.C9.MAIN,documents),components.set(docs_view_key.C9.BACKGROUND,docBackground),scene.addObjects([documents],docs_view_key.lN),scene.addObjects([docBackground],docs_view_key.S5),null==this._editorService.getEditor(documentModel.getUnitId())&&scene.enableLayerCache(docs_view_key.lN)}_initRenderRefresh(){this._docSkeletonManagerService.currentSkeletonBefore$.pipe((0,takeUntil.Q)(this.dispose$)).subscribe((param=>{this._create(param)}))}_create(skeleton){if(!skeleton)return;const{mainComponent,components}=this._context,docsComponent=mainComponent,docBackground=components.get(docs_view_key.C9.BACKGROUND);docsComponent.changeSkeleton(skeleton),docBackground.changeSkeleton(skeleton);const{unitId}=this._context,editor=this._editorService.getEditor(unitId);!this._editorService.isEditor(unitId)||editor?.params.scrollBar?this._recalculateSizeBySkeleton(skeleton):this._context.mainComponent?.makeDirty()}_initCommandListener(){const updateCommandList=[docs_src.Bz.id];this.disposeWithMe(this._commandService.onCommandExecuted((command=>{if(updateCommandList.includes(command.id)){const params=command.params,{unitId}=params;this.reRender(unitId)}})))}_recalculateSizeBySkeleton(skeleton){const{mainComponent,scene,unitId,components}=this._context,docsComponent=mainComponent,docBackground=components.get(docs_view_key.C9.BACKGROUND),pages=skeleton.getSkeletonData()?.pages;if(null==pages)return;let width=0,height=0;const documentFlavor=this._context.unit.getSnapshot().documentStyle.documentFlavor;for(let i=0,len=pages.length;i<len;i++){const page=pages[i];let{pageWidth,pageHeight}=page;if(documentFlavor===src.CQy.MODERN){const modernPageSize=getPageSizeInModernMode(page);pageWidth=modernPageSize.pageWidth,pageHeight=modernPageSize.pageHeight}docsComponent.pageLayoutType===engine_render_src.kvx.VERTICAL?(height+=pageHeight,height+=docsComponent.pageMarginTop,i===len-1&&(height+=docsComponent.pageMarginTop),width=Math.max(width,pageWidth)):docsComponent.pageLayoutType===engine_render_src.kvx.HORIZONTAL&&(width+=pageWidth,i!==len-1&&(width+=docsComponent.pageMarginLeft),height=Math.max(height,pageHeight))}docsComponent.resize(width,height),docBackground.resize(width,height);const editor=this._editorService.getEditor(unitId);this._editorService.isEditor(unitId)&&!editor?.params.scrollBar||scene.resize(width,height)}}function getPageSizeInModernMode(page){let{pageWidth,pageHeight}=page;const{marginLeft,marginRight,marginTop,marginBottom,skeDrawings,skeTables}=page;pageWidth===Number.POSITIVE_INFINITY&&(pageWidth=page.width+marginLeft+marginRight),pageHeight===Number.POSITIVE_INFINITY&&(pageHeight=page.height+marginTop+marginBottom);for(const drawing of skeDrawings.values())pageWidth=Math.max(pageWidth,drawing.aLeft+drawing.width+marginLeft+marginRight),pageHeight=Math.max(pageHeight,drawing.aTop+drawing.height+marginTop+marginBottom);for(const table of skeTables.values())pageWidth=Math.max(pageWidth,table.left+table.width+marginLeft+marginRight),pageHeight=Math.max(pageHeight,table.top+table.height+marginTop+marginBottom);return{pageWidth,pageHeight}}DocRenderController=function doc_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([doc_render_controller_ts_param(1,src.wTY),doc_render_controller_ts_param(2,(0,src.y_5)(doc_selection_render_service.q)),doc_render_controller_ts_param(3,(0,src.y_5)(docs_src.EX)),doc_render_controller_ts_param(4,editor_manager_service.I),doc_render_controller_ts_param(5,engine_render_src.cSx),doc_render_controller_ts_param(6,src.HCr),doc_render_controller_ts_metadata("design:type",Function),doc_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===src.wTY?Object:src.wTY,void 0===doc_selection_render_service.q?Object:doc_selection_render_service.q,void 0===docs_src.EX?Object:docs_src.EX,void 0===editor_manager_service.I?Object:editor_manager_service.I,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===src.HCr?Object:src.HCr])],DocRenderController);var break_line_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/break-line.command.ts"),clipboard_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/clipboard.command.ts"),clipboard_inner_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/clipboard.inner.command.ts"),core_editing_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/core-editing.command.ts"),doc_delete_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/doc-delete.command.ts"),doc_horizontal_line_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/doc-horizontal-line.command.ts"),doc_paragraph_setting_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/doc-paragraph-setting.command.ts");const DocSelectAllCommand={id:"doc.command.select-all",type:src.g4t.COMMAND,handler:async accessor=>{const univerInstanceService=accessor.get(src.HCr),docSelectionManagerService=accessor.get(docs_src.pv),docDataModel=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_DOC),docRanges=docSelectionManagerService.getDocRanges(),activeRange=docRanges.find((range=>range.isActive))??docRanges[0];if(null==docDataModel||null==activeRange)return!1;const{segmentId}=activeRange,unitId=docDataModel.getUnitId(),body=docDataModel.getSelfOrHeaderFooterModel(segmentId).getSnapshot().body;if(null==body)return!1;const{tables=[],dataStream}=body;if("\r\n"===dataStream)return!0;const textRanges=[];let offset=0;for(const table of tables){const{startIndex,endIndex}=table;offset!==startIndex&&textRanges.push({startOffset:offset,endOffset:startIndex-1,rangeType:src.AlE.TEXT}),textRanges.push({startOffset:startIndex+3,endOffset:endIndex-5,rangeType:src.AlE.RECT}),offset=endIndex}return offset!==body.dataStream.length-2&&textRanges.push({startOffset:offset,endOffset:body.dataStream.length-2,rangeType:src.AlE.TEXT}),docSelectionManagerService.replaceDocRanges(textRanges,{unitId,subUnitId:unitId},!1),!0}};var paragraph=__webpack_require__("../../packages/docs-ui/src/basics/paragraph.ts");class DocIMEInputManagerService extends src.hy_{constructor(_context){super(),this._context=_context,this._previousActiveRange=null,this._undoMutationParamsCache=[],this._redoMutationParamsCache=[]}clearUndoRedoMutationParamsCache(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[]}getUndoRedoMutationParamsCache(){return{undoCache:this._undoMutationParamsCache,redoCache:this._redoMutationParamsCache}}setUndoRedoMutationParamsCache({undoCache=[],redoCache=[]}){this._undoMutationParamsCache=undoCache,this._redoMutationParamsCache=redoCache}getActiveRange(){return this._previousActiveRange}setActiveRange(range){this._previousActiveRange=range}pushUndoRedoMutationParams(undoParams,redoParams){this._undoMutationParamsCache.push(undoParams),this._redoMutationParamsCache.push(redoParams)}fetchComposedUndoRedoMutationParams(){if(0===this._undoMutationParamsCache.length||null==this._previousActiveRange||0===this._redoMutationParamsCache.length)return null;const{unitId}=this._undoMutationParamsCache[0],undoMutationParams={unitId,actions:this._undoMutationParamsCache.reverse().reduce(((acc,cur)=>src.rRQ.compose(acc,cur.actions)),null),textRanges:[]};return{redoMutationParams:{unitId,actions:this._redoMutationParamsCache.reduce(((acc,cur)=>src.rRQ.compose(acc,cur.actions)),null),textRanges:[]},undoMutationParams,previousActiveRange:this._previousActiveRange}}dispose(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[],this._previousActiveRange=null}}var doc_menu_style_service=__webpack_require__("../../packages/docs-ui/src/services/doc-menu-style.service.ts");const IMEInputCommand={id:"doc.command.ime-input",type:src.g4t.COMMAND,handler:async(accessor,params)=>{const{unitId,newText,oldTextLen,isCompositionEnd,isCompositionStart}=params,commandService=accessor.get(src.wTY),renderManagerService=accessor.get(engine_render_src.cSx),univerInstanceService=accessor.get(src.HCr),docMenuStyleService=accessor.get(doc_menu_style_service._),imeInputManagerService=renderManagerService.getRenderById(unitId)?.with(DocIMEInputManagerService),docDataModel=univerInstanceService.getUnit(unitId,src.Zy$.UNIVER_DOC);if(null==docDataModel||null==imeInputManagerService)return!1;const previousActiveRange=imeInputManagerService.getActiveRange();if(null==previousActiveRange)return!1;const{style,segmentId}=previousActiveRange,body=docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();if(null==body)return!1;const insertRange=previousActiveRange;Object.assign(previousActiveRange,insertRange);const{startOffset,endOffset}=previousActiveRange,len=newText.length,textRanges=[{startOffset:startOffset+len,endOffset:startOffset+len,collapsed:!0,style}],doMutation={id:docs_src.Bz.id,params:{unitId,actions:[],textRanges}},defaultTextStyle=docMenuStyleService.getDefaultStyle(),styleCache=docMenuStyleService.getStyleCache(),curCustomRange=(0,paragraph.Nn)(body.customRanges??[],startOffset+oldTextLen,src._aE.includes(unitId)),curTextRun=(0,paragraph.nM)(body,isCompositionStart?endOffset:startOffset+oldTextLen,defaultTextStyle,styleCache,src._aE.includes(unitId)),customDecorations=(0,paragraph.yo)(body.customDecorations??[],startOffset+oldTextLen),textX=new src.Uuf,jsonX=src.rRQ.getInstance();if(!previousActiveRange.collapsed&&isCompositionStart){const dos=src.Z4q.selection.delete([previousActiveRange],body,0,null,!1);textX.push(...dos),doMutation.params.textRanges=[{startOffset:startOffset+len,endOffset:startOffset+len,collapsed:!0}]}else textX.push({t:src.sHL.RETAIN,len:startOffset});oldTextLen>0&&textX.push({t:src.sHL.DELETE,len:oldTextLen}),textX.push({t:src.sHL.INSERT,body:{dataStream:newText,textRuns:curTextRun?[{...curTextRun,st:0,ed:newText.length}]:[],customRanges:curCustomRange?[{...curCustomRange,startIndex:0,endIndex:newText.length-1}]:[],customDecorations:customDecorations.map((customDecoration=>({...customDecoration,startIndex:0,endIndex:newText.length-1})))},len:newText.length});const path=(0,util.J)(docDataModel,segmentId);doMutation.params.actions=jsonX.editOp(textX.serialize(),path),doMutation.params.noHistory=!isCompositionEnd,doMutation.params.isCompositionEnd=isCompositionEnd;const result=commandService.syncExecuteCommand(doMutation.id,doMutation.params);return imeInputManagerService.pushUndoRedoMutationParams(result,doMutation.params),Boolean(result)}};var replace_content_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/replace-content.command.ts");const InsertCustomRangeCommand={id:"doc.command.insert-custom-range",type:src.g4t.COMMAND,handler:(accessor,params)=>{if(!params)return!1;const commandService=accessor.get(src.wTY),{unitId,rangeId=(0,src.MZQ)(),textRanges,properties,text}=params,replaceSelectionParams={unitId,textRanges,body:{dataStream:text,customRanges:[{startIndex:0,endIndex:text.length-1,rangeId,rangeType:src.Bvh.CUSTOM,properties}]}};return commandService.syncExecuteCommand(replace_content_command.cF.id,replaceSelectionParams)}},SetDocZoomRatioCommand={type:src.g4t.COMMAND,id:"doc.command.set-zoom-ratio",handler:async(accessor,params)=>{const commandService=accessor.get(src.wTY),undoRedoService=accessor.get(src.$Dz),univerInstanceService=accessor.get(src.HCr);let documentId=univerInstanceService.getCurrentUniverDocInstance()?.getUnitId();if(!documentId)return!1;let zoomRatio=1;params&&(documentId=params.documentId??documentId,zoomRatio=params.zoomRatio??zoomRatio);if(!univerInstanceService.getUniverDocInstance(documentId))return!1;const setZoomRatioMutationParams={zoomRatio,unitId:documentId},undoMutationParams=((accessor,params)=>{const documentModel=accessor.get(src.HCr).getUniverDocInstance(params.unitId),old=documentModel?.zoomRatio||1;return{...src.S0q.deepClone(params),zoomRatio:old}})(accessor,setZoomRatioMutationParams);return!!commandService.syncExecuteCommand(SetDocZoomRatioOperation.id,setZoomRatioMutationParams)&&(undoRedoService.pushUndoRedo({unitID:documentId,undoMutations:[{id:SetDocZoomRatioOperation.id,params:undoMutationParams}],redoMutations:[{id:SetDocZoomRatioOperation.id,params:setZoomRatioMutationParams}]}),!0)}};var switch_doc_mode_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/switch-doc-mode.command.ts"),doc_table_create_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/table/doc-table-create.command.ts"),doc_table_delete_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/table/doc-table-delete.command.ts"),doc_table_insert_command=__webpack_require__("../../packages/docs-ui/src/commands/commands/table/doc-table-insert.command.ts"),table=__webpack_require__("../../packages/docs-ui/src/commands/commands/table/table.ts");const DocTableTabCommand={id:"doc.table.tab-in-table",type:src.g4t.COMMAND,handler:async(accessor,params)=>{const{shift}=params,textSelectionManager=accessor.get(docs_src.pv),docRanges=textSelectionManager.getDocRanges(),commandService=accessor.get(src.wTY),docDataModel=accessor.get(src.HCr).getCurrentUniverDocInstance();if(!docDataModel)return!1;const activeRange=docRanges.find((range=>range.isActive))??docRanges[0],unitId=docDataModel.getUnitId(),docSkeletonManagerService=(0,util.R)(accessor,unitId),skeleton=docSkeletonManagerService?.getSkeleton(),viewModel=skeleton?.getViewModel().getSelfOrHeaderFooterViewModel(activeRange?.segmentId);if(null==viewModel)return!1;if(null==activeRange)return!1;let offsets=null;if(offsets=shift?(0,table.z3)(viewModel,activeRange,table.Gn.PREV):(0,table.z3)(viewModel,activeRange,table.Gn.NEXT),offsets){const{startOffset,endOffset}=offsets,textRanges=[{startOffset,endOffset}];return textSelectionManager.replaceDocRanges(textRanges),!0}if(!1===shift){return await commandService.executeCommand(doc_table_insert_command.vc.id,{position:table.xP.BELLOW})}return!0}};var doc_paragraph_setting_panel_operation=__webpack_require__("../../packages/docs-ui/src/commands/operations/doc-paragraph-setting-panel.operation.ts");function doc_container_ui_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function doc_container_ui_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class DocContainerUIController{constructor(_localeService,_injector,_configService){this._localeService=_localeService,this._injector=_injector,this._configService=_configService,this.getComponent=ref=>{this._docContainer=ref;if(!ref.getContentRef().current)throw new Error("container is not ready")},this.changeLocale=locale=>{this._localeService.setLocale(locale)}}getUIConfig(){return{injector:this._injector,config:this._configService.getConfig("docs-ui.config"),changeLocale:this.changeLocale,getComponent:this.getComponent}}getContentRef(){return this._docContainer.getContentRef()}UIDidMount(cb){if(this._docContainer)return cb(this._docContainer)}getDocContainer(){return this._docContainer}}function app_ui_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}DocContainerUIController=function doc_container_ui_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([doc_container_ui_controller_ts_param(0,(0,src.y_5)(src.iH9)),doc_container_ui_controller_ts_param(1,(0,src.y_5)(src.zZn)),doc_container_ui_controller_ts_param(2,src.J0C),doc_container_ui_controller_ts_metadata("design:type",Function),doc_container_ui_controller_ts_metadata("design:paramtypes",[void 0===src.iH9?Object:src.iH9,void 0===src.zZn?Object:src.zZn,void 0===src.J0C?Object:src.J0C])],DocContainerUIController);class AppUIController extends src.hy_{constructor(_injector){super(),this._injector=_injector,this._docContainerController=this._injector.createInstance(DocContainerUIController)}}AppUIController=function app_ui_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([function app_ui_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}(0,(0,src.y_5)(src.zZn)),app_ui_controller_ts_metadata("design:type",Function),app_ui_controller_ts_metadata("design:paramtypes",[void 0===src.zZn?Object:src.zZn])],AppUIController);var convert_rect_range=__webpack_require__("../../packages/docs-ui/src/services/selection/convert-rect-range.ts");function doc_auto_format_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function doc_auto_format_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class DocAutoFormatController extends src.jGt{constructor(_docAutoFormatService,_renderManagerService){super(),this._docAutoFormatService=_docAutoFormatService,this._renderManagerService=_renderManagerService,this._initListTabAutoFormat(),this._initListSpaceAutoFormat(),this._initDefaultEnterFormat(),this._initExitListAutoFormat()}_initListTabAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:TabCommand.id,match:context=>{const{selection,paragraphs,unit}=context;if(1===paragraphs.length&&selection.startOffset===paragraphs[0].paragraphStart&&paragraphs[0].bullet){const allParagraphs=unit.getBody()?.paragraphs,bulletParagraphs=allParagraphs?.filter((p=>p.bullet?.listId===paragraphs[0].bullet.listId));return 0!==bulletParagraphs?.findIndex((p=>p.startIndex===paragraphs[0].startIndex))}return!!(paragraphs.length>1&&paragraphs.some((p=>p.bullet)))},getMutations(context){const params=context.commandParams;return[{id:list_command.Cz.id,params:{type:params?.shift?list_command.Bm.decrease:list_command.Bm.increase}}]},priority:100})),this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:TabCommand.id,match:context=>{const{selection,unit}=context,{startNodePosition,endNodePosition}=selection,renderObject=this._renderManagerService.getRenderById(unit.getUnitId()),skeleton=renderObject?.with(docs_src.EX).getSkeleton();return null!=skeleton&&(!!(startNodePosition&&endNodePosition&&(0,convert_rect_range.Yj)(skeleton,startNodePosition,endNodePosition))||!!(startNodePosition&&!endNodePosition&&startNodePosition.path.indexOf("cells")>-1))},getMutations(context){const params=context.commandParams;return[{id:DocTableTabCommand.id,params:{shift:!!params?.shift}}]},priority:99}))}_initListSpaceAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:AfterSpaceCommand.id,match:context=>{const{selection,paragraphs,unit}=context;if(!selection.collapsed)return!1;if(1!==paragraphs.length)return!1;const text=unit.getBody()?.dataStream.slice(paragraphs[0].paragraphStart,paragraphs[0].paragraphEnd-1);return!(!text||!Object.keys(src.Sh8).includes(text))},getMutations(context){const{paragraphs,unit}=context,text=unit.getBody()?.dataStream.slice(paragraphs[0].paragraphStart,paragraphs[0].paragraphEnd-1);if(text&&Object.keys(src.Sh8).includes(text)){const type=src.Sh8[text];return[{id:list_command.h.id,params:{listType:type,paragraph:paragraphs[0]}}]}return[]}}))}_initExitListAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:EnterCommand.id,match:context=>{const{paragraphs}=context;return!(1!==paragraphs.length||!paragraphs[0].bullet||paragraphs[0].paragraphStart!==paragraphs[0].paragraphEnd)},getMutations:context=>{const bullet=context.paragraphs[0].bullet;return bullet?bullet.nestingLevel>0?[{id:list_command.Cz.id,params:{type:list_command.Bm.decrease}}]:[{id:list_command.B1.id,params:{listType:context.paragraphs[0].bullet.listType}}]:[]}}))}_initDefaultEnterFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:EnterCommand.id,match:()=>!0,getMutations:()=>[{id:break_line_command.Z.id}],priority:-9999}))}}DocAutoFormatController=function doc_auto_format_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([doc_auto_format_controller_ts_param(0,(0,src.y_5)(DocAutoFormatService)),doc_auto_format_controller_ts_param(1,engine_render_src.cSx),doc_auto_format_controller_ts_metadata("design:type",Function),doc_auto_format_controller_ts_metadata("design:paramtypes",[void 0===DocAutoFormatService?Object:DocAutoFormatService,void 0===engine_render_src.cSx?Object:engine_render_src.cSx])],DocAutoFormatController);var doc_header_footer_controller=__webpack_require__("../../packages/docs-ui/src/controllers/doc-header-footer.controller.ts");function findLineBeforeAndAfterTable(table){const tablePage=table?.parent;let lineBeforeTable=null,lineAfterTable=null;if(null==table||null==tablePage)return{lineBeforeTable,lineAfterTable};const{st,ed}=table,pages=tablePage.type===engine_render_src.eMu.CELL?[tablePage]:tablePage.parent.pages;return(0,engine_render_src.dwH)(pages,(l=>{l.st===ed+1?lineAfterTable=l:l.ed===st-1&&(lineBeforeTable=l)})),{lineBeforeTable,lineAfterTable}}function isEmptyCellPage(cell){return 0===cell.sections[0].columns[0].lines.length}function findBellowCell(cell){const row=cell.parent,table=row?.parent,tableId=table?.tableId;if(null==row||null==table)return;const col=row.cells.indexOf(cell);let bellowRow=table.rows[table.rows.indexOf(row)+1];if(null==bellowRow&&tableId.indexOf("#-#")){const[id,index]=tableId.split("#-#"),pages=table.parent?.parent?.pages,nextTableId=`${id}#-#${Number.parseInt(index)+1}`;if(pages)for(const page of pages){const{skeTables}=page;if(skeTables.has(nextTableId)){const nextTable=skeTables.get(nextTableId);if(nextTable?.rows.length){bellowRow=nextTable.rows.find((r=>!r.isRepeatRow));break}}}}if(null!=bellowRow){const cell=bellowRow.cells[col];return isEmptyCellPage(cell)?findBellowCell(cell):cell}}function findAboveCell(cell){const row=cell.parent,table=row?.parent;if(null==row||null==table)return;let aboveRow=table.rows[table.rows.indexOf(row)-1];const col=row.cells.indexOf(cell);if((null==aboveRow||aboveRow.isRepeatRow)&&table.tableId.indexOf("#-#")){const[id,index]=table.tableId.split("#-#"),pages=table.parent?.parent?.pages,nextTableId=`${id}#-#${Number.parseInt(index)-1}`;if(pages)for(const page of pages){const{skeTables}=page;if(skeTables.has(nextTableId)){const nextTable=skeTables.get(nextTableId);if(nextTable?.rows.length){aboveRow=nextTable.rows[nextTable.rows.length-1];break}}}}if(null!=aboveRow){const cell=aboveRow.cells[col];return isEmptyCellPage(cell)?findAboveCell(cell):cell}}function firstLineInCell(cell){return cell.sections[0].columns[0].lines[0]}function lastLineInCell(cell){const lastColumn=(0,engine_render_src.tIT)(cell);return lastColumn.lines[lastColumn.lines.length-1]}function doc_move_cursor_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function doc_move_cursor_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class DocMoveCursorController extends src.jGt{constructor(_univerInstanceService,_renderManagerService,_textSelectionManagerService,_commandService){super(),this._univerInstanceService=_univerInstanceService,this._renderManagerService=_renderManagerService,this._textSelectionManagerService=_textSelectionManagerService,this._commandService=_commandService,this._commandExecutedListener()}dispose(){super.dispose(),this._onInputSubscription?.unsubscribe()}_commandExecutedListener(){const updateCommandList=[MoveCursorOperation.id,MoveSelectionOperation.id];this.disposeWithMe(this._commandService.onCommandExecuted((command=>{if(!updateCommandList.includes(command.id))return;const param=command.params;switch(command.id){case MoveCursorOperation.id:return this._handleMoveCursor(param.direction);case MoveSelectionOperation.id:return this._handleShiftMoveSelection(param.direction);default:throw new Error("Unknown command")}})))}_handleShiftMoveSelection(direction){const activeRange=this._textSelectionManagerService.getActiveTextRange(),allRanges=this._textSelectionManagerService.getTextRanges(),docDataModel=this._univerInstanceService.getCurrentUniverDocInstance();if(null==docDataModel)return;const skeleton=this._renderManagerService.getRenderById(docDataModel.getUnitId())?.with(docs_src.EX).getSkeleton(),docObject=this._getDocObject();if(null==activeRange||null==skeleton||null==docObject)return;const{startOffset,endOffset,style,collapsed,direction:rangeDirection,segmentId,startNodePosition,endNodePosition,segmentPage}=activeRange;if(allRanges.length>1){let min=Number.POSITIVE_INFINITY,max=Number.NEGATIVE_INFINITY;for(const range of allRanges)min=Math.min(min,range.startOffset),max=Math.max(max,range.endOffset);return void this._textSelectionManagerService.replaceTextRanges([{startOffset:direction===src.OP3.LEFT||direction===src.OP3.UP?max:min,endOffset:direction===src.OP3.LEFT||direction===src.OP3.UP?min:max,style}],!1)}const anchorOffset=collapsed||rangeDirection===src.Ab0.FORWARD?startOffset:endOffset;let focusOffset=collapsed||rangeDirection===src.Ab0.FORWARD?endOffset:startOffset;const dataStreamLength=docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody().dataStream.length??Number.POSITIVE_INFINITY;if(direction===src.OP3.LEFT||direction===src.OP3.RIGHT){const preGlyph=skeleton.findNodeByCharIndex(focusOffset-1,segmentId,segmentPage),curGlyph=skeleton.findNodeByCharIndex(focusOffset,segmentId,segmentPage);focusOffset=direction===src.OP3.RIGHT?focusOffset+curGlyph.count:focusOffset-(preGlyph?.count??0),focusOffset=Math.min(dataStreamLength-2,Math.max(0,focusOffset)),this._textSelectionManagerService.replaceTextRanges([{startOffset:anchorOffset,endOffset:focusOffset,style}],!1),this._scrollToFocusNodePosition(docDataModel.getUnitId(),focusOffset)}else{const focusGlyph=skeleton.findNodeByCharIndex(focusOffset,segmentId,segmentPage),documentOffsetConfig=docObject.document.getOffsetConfig(),focusNodePosition=collapsed?startNodePosition:rangeDirection===src.Ab0.FORWARD?endNodePosition:startNodePosition,newPos=this._getTopOrBottomPosition(skeleton,focusGlyph,focusNodePosition,direction===src.OP3.DOWN,!0);if(null==newPos){const newFocusOffset=direction===src.OP3.UP?0:dataStreamLength-2;if(newFocusOffset===focusOffset)return;return void this._textSelectionManagerService.replaceTextRanges([{startOffset:anchorOffset,endOffset:newFocusOffset,style}],!1)}const newActiveRange=new convert_text_range.Wb(documentOffsetConfig,skeleton).getRangePointData(newPos,newPos).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{startOffset:anchorOffset,endOffset:newActiveRange.endOffset,style}],!1),this._scrollToFocusNodePosition(docDataModel.getUnitId(),newActiveRange.endOffset)}}_handleMoveCursor(direction){const activeRange=this._textSelectionManagerService.getActiveTextRange(),allRanges=this._textSelectionManagerService.getTextRanges(),docDataModel=this._univerInstanceService.getCurrentUniverDocInstance();if(null==docDataModel)return!1;const skeleton=this._renderManagerService.getRenderById(docDataModel.getUnitId())?.with(docs_src.EX).getSkeleton(),docObject=this._getDocObject();if(null==activeRange||null==skeleton||null==docObject||null==allRanges)return;const{startOffset,endOffset,style,collapsed,segmentId,startNodePosition,endNodePosition,segmentPage}=activeRange,body=docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();if(null==body)return;const dataStreamLength=body.dataStream.length??Number.POSITIVE_INFINITY,customRanges=docDataModel.getCustomRanges()??[];if(direction===src.OP3.LEFT||direction===src.OP3.RIGHT){let cursor;if(!activeRange.collapsed||allRanges.length>1){let min=Number.POSITIVE_INFINITY,max=Number.NEGATIVE_INFINITY;for(const range of allRanges)min=Math.min(min,range.startOffset),max=Math.max(max,range.endOffset);cursor=direction===src.OP3.LEFT?min:max}else{const preSpan=skeleton.findNodeByCharIndex(startOffset-1,segmentId,segmentPage),curSpan=skeleton.findNodeByCharIndex(startOffset,segmentId,segmentPage),nextGlyph=skeleton.findNodeByCharIndex(startOffset+1,segmentId,segmentPage);cursor=direction===src.OP3.LEFT?Math.max(0,startOffset-(preSpan?.count??1)):Math.min(dataStreamLength-2,endOffset+curSpan.count+(nextGlyph?.streamType===src.gqw.SECTION_BREAK?1:0))}const skipTokens=[src.gqw.TABLE_START,src.gqw.TABLE_END,src.gqw.TABLE_ROW_START,src.gqw.TABLE_ROW_END,src.gqw.TABLE_CELL_START,src.gqw.TABLE_CELL_END,src.gqw.SECTION_BREAK];if(direction===src.OP3.LEFT)for(;skipTokens.includes(body.dataStream[cursor]);)cursor--;else for(;skipTokens.includes(body.dataStream[cursor]);)cursor++;customRanges.filter((range=>range.wholeEntity&&range.startIndex<cursor&&range.endIndex>=cursor)).forEach((range=>{cursor=direction===src.OP3.LEFT?Math.min(range.startIndex,cursor):Math.max(range.endIndex+1,cursor)})),this._textSelectionManagerService.replaceTextRanges([{startOffset:Math.max(0,cursor),endOffset:Math.max(0,cursor),style}],!1),this._scrollToFocusNodePosition(docDataModel.getUnitId(),cursor)}else{const startNode=skeleton.findNodeByCharIndex(startOffset,segmentId,segmentPage),endNode=skeleton.findNodeByCharIndex(endOffset,segmentId,segmentPage),documentOffsetConfig=docObject.document.getOffsetConfig(),newPos=this._getTopOrBottomPosition(skeleton,direction===src.OP3.UP||collapsed?startNode:endNode,direction===src.OP3.UP||collapsed?startNodePosition:endNodePosition,direction===src.OP3.DOWN);if(null==newPos){let cursor;return cursor=collapsed?direction===src.OP3.UP?0:dataStreamLength-2:direction===src.OP3.UP?startOffset:endOffset,void this._textSelectionManagerService.replaceTextRanges([{startOffset:Math.max(0,cursor),endOffset:Math.max(0,cursor),style}],!1)}const newActiveRange=new convert_text_range.Wb(documentOffsetConfig,skeleton).getRangePointData(newPos,newPos).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{...newActiveRange,style}],!1),this._scrollToFocusNodePosition(docDataModel.getUnitId(),newActiveRange.endOffset)}}_getTopOrBottomPosition(docSkeleton,glyph,nodePosition,direction,skipCellContent=!1){if(null==glyph||null==nodePosition)return;const offsetLeft=this._getGlyphLeftOffsetInLine(glyph),line=this._getNextOrPrevLine(glyph,direction,skipCellContent);if(null==line)return;const position=this._matchPositionByLeftOffset(docSkeleton,line,offsetLeft,nodePosition);return null!=position?{...position,isBack:!0}:void 0}_getGlyphLeftOffsetInLine(glyph){const divide=glyph.parent;if(null==divide)return Number.NEGATIVE_INFINITY;const divideLeft=divide.left,{left}=glyph;return divideLeft+left}_matchPositionByLeftOffset(docSkeleton,line,offsetLeft,nodePosition){const nearestNode={distance:Number.POSITIVE_INFINITY};for(const divide of line.divides){const divideLeft=divide.left;for(const glyph of divide.glyphGroup){if(glyph.streamType===src.gqw.SECTION_BREAK)continue;const{left}=glyph,leftSide=divideLeft+left,distance=Math.abs(offsetLeft-leftSide);distance<nearestNode.distance&&(nearestNode.glyph=glyph,nearestNode.distance=distance)}}if(null==nearestNode.glyph)return;const{segmentPage}=nodePosition;return docSkeleton.findPositionByGlyph(nearestNode.glyph,segmentPage)}_getNextOrPrevLine(glyph,direction,skipCellContent=!1){const divide=glyph.parent,line=divide?.parent,column=line?.parent,section=column?.parent,page=section?.parent;if(null==divide||null==line||null==column||null==section||null==page)return;const currentLineIndex=column.lines.indexOf(line);if(-1===currentLineIndex)return;let newLine;if(page.type===engine_render_src.eMu.CELL&&skipCellContent){const nLine=findAboveOrBellowCellLine(page,direction);if(nLine)return nLine}if(!0===direction){newLine=column.lines[currentLineIndex+1];const tableAfterLine=function findTableAfterLine(line,page){const{ed}=line,{skeTables}=page;let table=null;for(const t of skeTables.values())if(t.st===ed+1){table=t;break}return table}(line,page);if(tableAfterLine){const firstLine=function firstLineInTable(table){return table.rows[0].cells[0].sections[0].columns[0].lines[0]}(tableAfterLine);firstLine&&(newLine=firstLine)}}else{newLine=column.lines[currentLineIndex-1];const tableBeforeLine=function findTableBeforeLine(line,page){const{st}=line,{skeTables}=page;let table=null;for(const t of skeTables.values())if(t.ed===st-1){table=t;break}return table}(line,page);if(tableBeforeLine){const lastLine=function lastLineInTable(table){const lastRow=table.rows[table.rows.length-1],lastCell=lastRow.cells[lastRow.cells.length-1];return(0,engine_render_src.TlS)(lastCell)}(tableBeforeLine);lastLine&&(newLine=lastLine)}}if(null!=newLine)return newLine;const currentColumnIndex=section.columns.indexOf(column);if(-1===currentColumnIndex)return;if(!0===direction)newLine=section.columns[currentColumnIndex+1]?.lines[0];else{const prevColumnLines=section.columns?.[currentColumnIndex-1]?.lines;newLine=prevColumnLines?.[prevColumnLines.length-1]}if(null!=newLine)return newLine;const currentSectionIndex=page.sections.indexOf(section);if(-1===currentSectionIndex)return;if(!0===direction)newLine=page.sections[currentSectionIndex-1]?.columns[0]?.lines[0];else{const prevColumns=page.sections?.[currentSectionIndex-1]?.columns,column=prevColumns?.[prevColumns.length-1],prevColumnLines=column?.lines;newLine=prevColumnLines?.[prevColumnLines.length-1]}if(null!=newLine)return newLine;if(page.type===engine_render_src.eMu.CELL)return findAboveOrBellowCellLine(page,direction);const skeleton=page.parent;if(null==skeleton)return;const currentPageIndex=skeleton.pages.indexOf(page);if(-1!==currentPageIndex){if(!0===direction)newLine=skeleton.pages[currentPageIndex+1]?.sections[0]?.columns[0]?.lines[0];else{const prevSections=skeleton.pages[currentPageIndex-1]?.sections;if(null==prevSections)return;const prevColumns=prevSections[prevSections.length-1]?.columns,column=prevColumns[prevColumns.length-1],prevColumnLines=column?.lines;newLine=prevColumnLines[prevColumnLines.length-1]}return null!=newLine?newLine:void 0}}_scrollToFocusNodePosition(unitId,offset){const backScrollController=this._renderManagerService.getRenderById(unitId)?.with(DocBackScrollRenderController);null!=backScrollController&&backScrollController.scrollToRange({startOffset:offset,endOffset:offset,collapsed:!0})}_getDocObject(){return(0,component_tools.qS)(this._univerInstanceService,this._renderManagerService)}}function findAboveOrBellowCellLine(page,direction){let newLine=null;if(!0===direction){const bellowCell=findBellowCell(page);if(bellowCell)newLine=firstLineInCell(bellowCell);else{const table=page.parent?.parent,{lineAfterTable}=findLineBeforeAndAfterTable(table);lineAfterTable&&(newLine=lineAfterTable)}}else{const aboveCell=findAboveCell(page);if(aboveCell)newLine=lastLineInCell(aboveCell);else{const table=page.parent?.parent,{lineBeforeTable}=findLineBeforeAndAfterTable(table);lineBeforeTable&&(newLine=lineBeforeTable)}}return newLine}DocMoveCursorController=function doc_move_cursor_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([doc_move_cursor_controller_ts_param(0,src.HCr),doc_move_cursor_controller_ts_param(1,engine_render_src.cSx),doc_move_cursor_controller_ts_param(2,(0,src.y_5)(docs_src.pv)),doc_move_cursor_controller_ts_param(3,src.wTY),doc_move_cursor_controller_ts_metadata("design:type",Function),doc_move_cursor_controller_ts_metadata("design:paramtypes",[void 0===src.HCr?Object:src.HCr,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===docs_src.pv?Object:docs_src.pv,void 0===src.wTY?Object:src.wTY])],DocMoveCursorController);var doc_paragraph_setting_controller=__webpack_require__("../../packages/docs-ui/src/controllers/doc-paragraph-setting.controller.ts"),doc_create_table_operation=__webpack_require__("../../packages/docs-ui/src/commands/operations/doc-create-table.operation.ts"),component_name=__webpack_require__("../../packages/docs-ui/src/views/table/create/component-name.ts"),create_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/docs-ui/src/views/table/create/index.module.less"),create_index_module_options={};create_index_module_options.styleTagTransform=styleTagTransform_default(),create_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),create_index_module_options.insert=insertBySelector_default().bind(null,"head"),create_index_module_options.domAPI=styleDomAPI_default(),create_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(create_index_module.A,create_index_module_options);const table_create_index_module=create_index_module.A&&create_index_module.A.locals?create_index_module.A.locals:void 0,DocCreateTableConfirm=({handleRowColChange,tableCreateParams})=>{const localeService=(0,ui_src.fJ)(src.iH9),[rowCount,setRowCount]=(0,react.useState)(3),[colCount,setColCount]=(0,react.useState)(5);function handleInputChange(rowCount,colCount){setRowCount(rowCount),setColCount(colCount),handleRowColChange(rowCount,colCount)}return(0,react.useEffect)((()=>{setRowCount(tableCreateParams.rowCount),setColCount(tableCreateParams.colCount)}),[tableCreateParams]),(0,jsx_runtime.jsxs)("div",{className:table_create_index_module.create,children:[(0,jsx_runtime.jsxs)("div",{className:table_create_index_module.createItem,children:[(0,jsx_runtime.jsx)("span",{className:table_create_index_module.createLabel,children:localeService.t("toolbar.table.rowCount")}),(0,jsx_runtime.jsx)(design_src.YI,{min:1,max:20,precision:0,value:rowCount,onChange:val=>{handleInputChange(val,colCount)},className:table_create_index_module.createInput})]}),(0,jsx_runtime.jsxs)("div",{className:table_create_index_module.createItem,children:[(0,jsx_runtime.jsx)("span",{className:table_create_index_module.createLabel,children:localeService.t("toolbar.table.colCount")}),(0,jsx_runtime.jsx)(design_src.YI,{min:1,max:20,precision:0,value:colCount,onChange:val=>{handleInputChange(rowCount,val)},className:table_create_index_module.createInput})]})]})};function doc_table_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function doc_table_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}DocCreateTableConfirm.__docgenInfo={description:"",methods:[],displayName:"DocCreateTableConfirm",props:{handleRowColChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(rowCount: number, colCount: number) => void",signature:{arguments:[{type:{name:"number"},name:"rowCount"},{type:{name:"number"},name:"colCount"}],return:{name:"void"}}},description:""},tableCreateParams:{required:!0,tsType:{name:"signature",type:"object",raw:"{\n    rowCount: number;\n    colCount: number;\n}",signature:{properties:[{key:"rowCount",value:{name:"number",required:!0}},{key:"colCount",value:{name:"number",required:!0}}]}},description:""}}};class DocTableController extends src.jGt{constructor(_commandService,_componentManager){super(),this._commandService=_commandService,this._componentManager=_componentManager,this._initialize()}_initialize(){this._init(),this._registerCommands(),this._initCustomComponents()}_registerCommands(){[doc_create_table_operation.c].forEach((command=>this.disposeWithMe(this._commandService.registerCommand(command))))}_initCustomComponents(){const componentManager=this._componentManager;this.disposeWithMe(componentManager.register(component_name.i,DocCreateTableConfirm))}_init(){}}DocTableController=function doc_table_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([doc_table_controller_ts_param(0,src.wTY),doc_table_controller_ts_param(1,(0,src.y_5)(ui_src.BJ)),doc_table_controller_ts_metadata("design:type",Function),doc_table_controller_ts_metadata("design:paramtypes",[void 0===src.wTY?Object:src.wTY,void 0===ui_src.BJ?Object:ui_src.BJ])],DocTableController);var FloatToolbar=__webpack_require__("../../packages/docs-ui/src/components/float-toolbar/FloatToolbar.tsx"),operators_map=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/map.js");function doc_popup_manager_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function doc_popup_manager_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}function transformBound2OffsetBound(originBound,scene){const topLeft=transformPosition2Offset(originBound.left,originBound.top,scene),bottomRight=transformPosition2Offset(originBound.right,originBound.bottom,scene);return{left:topLeft.x,top:topLeft.y,right:bottomRight.x,bottom:bottomRight.y}}function transformPosition2Offset(x,y,scene){const{scaleX,scaleY}=scene.getAncestorScale(),viewMain=scene.getViewport(docs_view_key.hl.VIEW_MAIN);if(!viewMain)return{x,y};const{viewportScrollX:actualScrollX,viewportScrollY:actualScrollY}=viewMain;return{x:(x-actualScrollX)*scaleX,y:(y-actualScrollY)*scaleY}}function transformOffset2Bound(offsetX,offsetY,scene){const{scaleX,scaleY}=scene.getAncestorScale(),viewMain=scene.getViewport(docs_view_key.hl.VIEW_MAIN);if(!viewMain)return{x:offsetX,y:offsetY};const{viewportScrollX:actualScrollX,viewportScrollY:actualScrollY}=viewMain;return{x:offsetX/scaleX+actualScrollX,y:offsetY/scaleY+actualScrollY}}const calcDocRangePositions=(range,currentRender)=>{const{scene,mainComponent,engine}=currentRender,skeleton=currentRender.with(docs_src.EX).getSkeleton(),startPosition=skeleton.findNodePositionByCharIndex(range.startOffset,!0,range.segmentId,range.segmentPage),endPosition=skeleton.findNodePositionByCharIndex(range.endOffset,!0,range.segmentId,range.segmentPage);if(!endPosition||!startPosition)return;const documentOffsetConfig=mainComponent.getOffsetConfig(),{docsLeft,docsTop}=documentOffsetConfig,canvasElement=engine.getCanvasElement(),canvasClientRect=canvasElement.getBoundingClientRect(),widthOfCanvas=(0,engine_render_src.klu)(canvasElement.style.width),{top,left,width}=canvasClientRect,scaleAdjust=width/widthOfCanvas,{scaleX,scaleY}=scene.getAncestorScale(),convertor=new convert_text_range.Wb(documentOffsetConfig,skeleton),{borderBoxPointGroup}=convertor.getRangePointData(startPosition,endPosition);return(0,text_range.rb)(borderBoxPointGroup).map((bound=>transformBound2OffsetBound(bound,scene))).map((i=>({left:(i.left+docsLeft*scaleX)*scaleAdjust+left,right:(i.right+docsLeft*scaleX)*scaleAdjust+left,top:(i.top+docsTop*scaleY)*scaleAdjust+top,bottom:(i.bottom+docsTop*scaleY)*scaleAdjust+top})))};class DocCanvasPopManagerService extends src.jGt{constructor(_globalPopupManagerService,_renderManagerService,_univerInstanceService,_commandService){super(),this._globalPopupManagerService=_globalPopupManagerService,this._renderManagerService=_renderManagerService,this._univerInstanceService=_univerInstanceService,this._commandService=_commandService}_createObjectPositionObserver(targetObject,currentRender){const calc=()=>{const{scene,engine}=currentRender,{left,top,width,height}=targetObject,bound={left,right:left+width,top,bottom:top+height},canvasElement=engine.getCanvasElement(),canvasClientRect=canvasElement.getBoundingClientRect(),widthOfCanvas=(0,engine_render_src.klu)(canvasElement.style.width),offsetBound=transformBound2OffsetBound(bound,scene),{top:topOffset,left:leftOffset,width:domWidth}=canvasClientRect,scaleAdjust=domWidth/widthOfCanvas;return{left:offsetBound.left*scaleAdjust+leftOffset,right:offsetBound.right*scaleAdjust+leftOffset,top:offsetBound.top*scaleAdjust+topOffset,bottom:offsetBound.bottom*scaleAdjust+topOffset}},position=calc(),position$=new BehaviorSubject.t(position),disposable=new src.VdD;disposable.add(this._commandService.onCommandExecuted((commandInfo=>{if(commandInfo.id===SetDocZoomRatioOperation.id||commandInfo.id===docs_src.Bz.id){const newPosition=calc();newPosition&&position$.next(newPosition)}})));const viewMain=currentRender.scene.getViewport(docs_view_key.hl.VIEW_MAIN);return viewMain&&disposable.add(viewMain.onScrollAfter$.subscribeEvent((()=>{position$.next(calc())}))),{position,position$,disposable}}_createRangePositionObserver(range,currentRender){const positions=calcDocRangePositions(range,currentRender)??[],positions$=new BehaviorSubject.t(positions),disposable=new src.VdD;disposable.add(this._commandService.onCommandExecuted((commandInfo=>{if(commandInfo.id===SetDocZoomRatioOperation.id||commandInfo.id===docs_src.Bz.id){if(commandInfo.params.unitId===currentRender.unitId){const position=calcDocRangePositions(range,currentRender);position&&positions$.next(position)}}})));const viewMain=currentRender.scene.getViewport(docs_view_key.hl.VIEW_MAIN);return viewMain&&disposable.add(viewMain.onScrollAfter$.subscribeEvent((()=>{const position=calcDocRangePositions(range,currentRender);position&&positions$.next(position)}))),{positions,positions$,disposable}}attachPopupToObject(targetObject,popup,unitId){const currentRender=this._renderManagerService.getRenderById(unitId);if(!currentRender)throw new Error(`Current render not found, unitId: ${unitId}`);const{position,position$,disposable}=this._createObjectPositionObserver(targetObject,currentRender),id=this._globalPopupManagerService.addPopup({...popup,unitId,subUnitId:"default",anchorRect:position,anchorRect$:position$,canvasElement:currentRender.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(id),position$.complete(),disposable.dispose()}}}attachPopupToRange(range,popup,unitId){if(!this._univerInstanceService.getUnit(unitId))throw new Error(`Document not found, unitId: ${unitId}`);const{direction="top",multipleDirection}=popup,currentRender=this._renderManagerService.getRenderById(unitId);if(!currentRender)throw new Error(`Current render not found, unitId: ${unitId}`);const{positions:bounds,positions$:bounds$,disposable}=this._createRangePositionObserver(range,currentRender),position$=bounds$.pipe((0,operators_map.T)((bounds=>direction.includes("top")?bounds[0]:bounds[bounds.length-1]))),id=this._globalPopupManagerService.addPopup({...popup,unitId,subUnitId:"default",anchorRect:direction.includes("top")?bounds[0]:bounds[bounds.length-1],anchorRect$:position$,excludeRects:bounds,excludeRects$:bounds$,direction:["top","bottom","horizontal"].some((i=>direction.includes(i)))?bounds.length>1?multipleDirection??direction:direction:"bottom",canvasElement:currentRender.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(id),bounds$.complete(),disposable.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==id}}}function float_menu_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function float_menu_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}DocCanvasPopManagerService=function doc_popup_manager_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([doc_popup_manager_service_ts_param(0,(0,src.y_5)(ui_src.F6)),doc_popup_manager_service_ts_param(1,engine_render_src.cSx),doc_popup_manager_service_ts_param(2,src.HCr),doc_popup_manager_service_ts_param(3,src.wTY),doc_popup_manager_service_ts_metadata("design:type",Function),doc_popup_manager_service_ts_metadata("design:paramtypes",[void 0===ui_src.F6?Object:ui_src.F6,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===src.HCr?Object:src.HCr,void 0===src.wTY?Object:src.wTY])],DocCanvasPopManagerService);class FloatMenuController extends src.jGt{constructor(_docSelectionManagerService,_docCanvasPopManagerService,_componentManager){super(),this._docSelectionManagerService=_docSelectionManagerService,this._docCanvasPopManagerService=_docCanvasPopManagerService,this._componentManager=_componentManager,this._floatMenu=null,this._registerFloatMenu(),this._initSelectionChange()}_registerFloatMenu(){this.disposeWithMe(this._componentManager.register("univer.doc.float-menu",FloatToolbar.G))}_initSelectionChange(){this.disposeWithMe(this._docSelectionManagerService.textSelection$.subscribe((selection=>{const{unitId,textRanges}=selection;(0,src.W2S)(unitId)?this.hideFloatMenu():textRanges.length>0&&textRanges.some((range=>!range.collapsed))?(this.hideFloatMenu(),this.showFloatMenu(unitId,textRanges.find((range=>!range.collapsed)))):this.hideFloatMenu()})))}hideFloatMenu(){this._floatMenu?.dispose(),this._floatMenu=null}showFloatMenu(unitId,range){return this._floatMenu=this._docCanvasPopManagerService.attachPopupToRange(range,{componentKey:"univer.doc.float-menu",direction:"backward"===range.direction?"top-center":"bottom-center",offset:[0,4]},unitId),(0,src.saO)((()=>this.hideFloatMenu()))}}FloatMenuController=function float_menu_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([float_menu_controller_ts_param(0,(0,src.y_5)(docs_src.pv)),float_menu_controller_ts_param(1,(0,src.y_5)(DocCanvasPopManagerService)),float_menu_controller_ts_param(2,(0,src.y_5)(ui_src.BJ)),float_menu_controller_ts_metadata("design:type",Function),float_menu_controller_ts_metadata("design:paramtypes",[void 0===docs_src.pv?Object:docs_src.pv,void 0===DocCanvasPopManagerService?Object:DocCanvasPopManagerService,void 0===ui_src.BJ?Object:ui_src.BJ])],FloatMenuController);var distinctUntilChanged=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/distinctUntilChanged.js"),Subject=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/Subject.js"),throttleTime=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/throttleTime.js"),take=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/take.js");function doc_event_manager_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}const calcDocGlyphPosition=(glyph,documents,skeleton,pageIndex=-1)=>{const start=skeleton.findPositionByGlyph(glyph,pageIndex);if(!start)return;const documentOffsetConfig=documents.getOffsetConfig(),startPosition={...start,isBack:!0},convertor=new convert_text_range.Wb(documentOffsetConfig,skeleton),{borderBoxPointGroup}=convertor.getRangePointData(startPosition,startPosition),rect=(0,text_range.rb)(borderBoxPointGroup)[0];return{top:rect.top+documentOffsetConfig.docsTop,bottom:rect.bottom+documentOffsetConfig.docsTop,left:rect.left+documentOffsetConfig.docsLeft,right:rect.left+documentOffsetConfig.docsLeft+glyph.width}};class DocEventManagerService extends src.jGt{get _skeleton(){return this._docSkeletonManagerService.getSkeleton()}get _documents(){return this._context.mainComponent}constructor(_context,_docSkeletonManagerService){super(),this._context=_context,this._docSkeletonManagerService=_docSkeletonManagerService,this._hoverCustomRanges$=new BehaviorSubject.t([]),this.hoverCustomRanges$=this._hoverCustomRanges$.pipe((0,distinctUntilChanged.F)(((pre,aft)=>pre.length===aft.length&&pre.every(((item,i)=>aft[i].range.rangeId===item.range.rangeId&&aft[i].segmentId===item.segmentId&&aft[i].segmentPageIndex===item.segmentPageIndex&&aft[i].range.startIndex===item.range.startIndex))))),this._clickCustomRanges$=new Subject.B,this.clickCustomRanges$=this._clickCustomRanges$.asObservable(),this._hoverBullet$=new Subject.B,this.hoverBullet$=this._hoverBullet$.pipe((0,distinctUntilChanged.F)(((pre,aft)=>pre?.paragraph.startIndex===aft?.paragraph.startIndex&&pre?.segmentId===aft?.segmentId&&pre?.segmentPageIndex===aft?.segmentPageIndex))),this._clickBullet$=new Subject.B,this.clickBullets$=this._clickBullet$.asObservable(),this._customRangeDirty=!0,this._bulletDirty=!0,this._customRangeBounds=[],this._bulletBounds=[],this._initResetDirty(),this._initEvents(),this._initPointer()}dispose(){this._hoverCustomRanges$.complete(),this._clickCustomRanges$.complete(),super.dispose()}_initPointer(){let preCursor=engine_render_src.MBo.TEXT;this.disposeWithMe(this.hoverCustomRanges$.subscribe((ranges=>{ranges.length?(preCursor=this._context.scene.getCursor(),this._context.scene.setCursor(engine_render_src.MBo.POINTER)):this._context.scene.setCursor(preCursor)})))}_initResetDirty(){this.disposeWithMe(this._skeleton.dirty$.subscribe((()=>{this._customRangeDirty=!0,this._bulletDirty=!0}))),this.disposeWithMe((0,src.Ldp)(this._context.engine.onTransformChange$).pipe((0,filter.p)((evt=>evt.type===engine_render_src.FAP.resize))).subscribe((()=>{this._customRangeDirty=!0,this._bulletDirty=!0})))}_initEvents(){this.disposeWithMe((0,src.Ldp)(this._context.scene.onPointerMove$).pipe((0,throttleTime.c)(30)).subscribe((evt=>{this._hoverCustomRanges$.next(this._calcActiveRanges(evt)),this._hoverBullet$.next(this._calcActiveBullet(evt))}))),this.disposeWithMe(this._context.scene.onPointerEnter$.subscribeEvent((()=>{this._hoverBullet$.next(null),this._hoverCustomRanges$.next([])})));const onPointerDown$=(0,src.Ldp)(this._context.mainComponent.onPointerDown$),onPointerUp$=(0,src.Ldp)(this._context.scene.onPointerUp$);this.disposeWithMe(onPointerDown$.pipe((0,switchMap.n)((down=>onPointerUp$.pipe((0,take.s)(1),(0,operators_map.T)((up=>({down,up})))))),(0,filter.p)((({down,up})=>down.target===up.target&&up.timeStamp-down.timeStamp<300))).subscribe((({down})=>{if(2===down.button)return;const ranges=this._calcActiveRanges(down);ranges.length&&this._clickCustomRanges$.next(ranges.pop());const bullet=this._calcActiveBullet(down);bullet&&this._clickBullet$.next(bullet)})))}_buildCustomRangeBoundsBySegment(segmentId,segmentPage=-1){const customRanges=this._context.unit.getSelfOrHeaderFooterModel(segmentId)?.getBody()?.customRanges??[],layouts=[];return customRanges.forEach((range=>{const rects=((range,documents,skeleton,pageIndex)=>{const startPosition=skeleton.findNodePositionByCharIndex(range.startOffset,!0,range.segmentId,pageIndex),skeletonData=skeleton.getSkeletonData();let end=range.endOffset;if(range.segmentId){const root=Array.from(skeletonData?.skeFooters.get(range.segmentId)?.values()??[])[0]??Array.from(skeletonData?.skeHeaders.get(range.segmentId)?.values()??[])[0];root&&(end=Math.min(root.ed,end))}const endPosition=skeleton.findNodePositionByCharIndex(end,!0,range.segmentId,pageIndex);if(!endPosition||!startPosition)return;const documentOffsetConfig=documents.getOffsetConfig(),convertor=new convert_text_range.Wb(documentOffsetConfig,skeleton),{borderBoxPointGroup}=convertor.getRangePointData(startPosition,endPosition);return(0,text_range.rb)(borderBoxPointGroup).map((rect=>({top:rect.top+documentOffsetConfig.docsTop-4,bottom:rect.bottom+documentOffsetConfig.docsTop+4,left:rect.left+documentOffsetConfig.docsLeft,right:rect.right+documentOffsetConfig.docsLeft})))})({startOffset:range.startIndex,endOffset:range.endIndex+1,collapsed:!1,segmentId},this._documents,this._skeleton,segmentPage);if(!rects)return null;layouts.push({customRange:range,rects,segmentId,segmentPageIndex:segmentPage})})),layouts}_buildCustomRangeBounds(){if(!this._customRangeDirty)return;this._customRangeDirty=!1;const customRangeBounds=[];customRangeBounds.push(...this._buildCustomRangeBoundsBySegment()),this._skeleton.getSkeletonData()?.pages.forEach(((page,pageIndex)=>{page.headerId&&customRangeBounds.push(...this._buildCustomRangeBoundsBySegment(page.headerId,pageIndex)),page.footerId&&customRangeBounds.push(...this._buildCustomRangeBoundsBySegment(page.footerId,pageIndex))})),this._customRangeBounds=customRangeBounds}_calcActiveRanges(evt){this._buildCustomRangeBounds();const{offsetX,offsetY}=evt,{x,y}=transformOffset2Bound(offsetX,offsetY,this._context.scene);return this._customRangeBounds.filter((layout=>layout.rects.some((rect=>{const{left,right,top,bottom}=rect;return x>=left&&x<=right&&y>=top&&y<=bottom})))).map((range=>({segmentId:range.segmentId,range:range.customRange,segmentPageIndex:range.segmentPageIndex,rects:range.rects})))}_buildBulletBoundsBySegment(segmentId,segmentPage=-1){const body=this._context.unit.getSelfOrHeaderFooterModel(segmentId)?.getBody(),paragraphs=(body?.paragraphs??[]).filter((p=>p.bullet&&0===p.bullet.listType.indexOf("CHECK_LIST"))),bounds=[],skeletonData=this._skeleton.getSkeletonData();if(!skeletonData)return bounds;const calc=pages=>{for(const page of pages){const sections=[...page.sections];if(page.skeTables){const tables=Array.from(page.skeTables.values());sections.push(...tables.map((i=>i.rows.map((i=>i.cells.map((i=>i.sections)))))).flat(4))}for(const selection of sections)for(const column of selection.columns)for(const line of column.lines)if(line.paragraphStart){const paragraph=paragraphs.find((p=>p.startIndex===line.paragraphIndex));if(paragraph){const targetLine=line,bulletNode=targetLine?.divides?.[0]?.glyphGroup?.[0];if(!bulletNode)continue;const rect=calcDocGlyphPosition(bulletNode,this._documents,this._skeleton,segmentPage);if(!rect)continue;bounds.push({rect,segmentId,segmentPageIndex:segmentPage,paragraph})}}}return bounds};if(segmentId){const page=skeletonData.skeFooters.get(segmentId)?.values()??skeletonData.skeHeaders.get(segmentId)?.values();return page?calc(Array.from(page)):bounds}return calc(skeletonData.pages)}_buildBulletBounds(){this._bulletDirty&&(this._bulletDirty=!1,this._bulletBounds=[],this._bulletBounds.push(...this._buildBulletBoundsBySegment()),this._skeleton.getSkeletonData()?.pages.forEach(((page,pageIndex)=>{page.headerId&&this._bulletBounds.push(...this._buildBulletBoundsBySegment(page.headerId,pageIndex)),page.footerId&&this._bulletBounds.push(...this._buildBulletBoundsBySegment(page.footerId,pageIndex))})))}_calcActiveBullet(evt){this._buildBulletBounds();const{offsetX,offsetY}=evt,{x,y}=transformOffset2Bound(offsetX,offsetY,this._context.scene);return this._bulletBounds.find((layout=>{const{left,right,top,bottom}=layout.rect;return x>=left&&x<=right&&y>=top&&y<=bottom}))}}function doc_checklist_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function doc_checklist_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}DocEventManagerService=function doc_event_manager_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([function doc_event_manager_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}(1,(0,src.y_5)(docs_src.EX)),doc_event_manager_service_ts_metadata("design:type",Function),doc_event_manager_service_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===docs_src.EX?Object:docs_src.EX])],DocEventManagerService);class DocChecklistRenderController extends src.jGt{constructor(_context,_docSkeletonManagerService,_commandService,_docEventManagerService,_textSelectionManagerService){super(),this._context=_context,this._docSkeletonManagerService=_docSkeletonManagerService,this._commandService=_commandService,this._docEventManagerService=_docEventManagerService,this._textSelectionManagerService=_textSelectionManagerService,this._initPointerDownObserver(),this._initHoverCursor()}_initPointerDownObserver(){this._docEventManagerService.clickBullets$.subscribe((paragraph=>{const textRanges=this._textSelectionManagerService.getTextRanges();this._commandService.executeCommand(list_command.y6.id,{index:paragraph.paragraph.startIndex,segmentId:paragraph.segmentId,textRanges})}))}_initHoverCursor(){this.disposeWithMe(this._docEventManagerService.hoverBullet$.subscribe((paragraph=>{paragraph?this._context.mainComponent.setCursor(engine_render_src.MBo.POINTER):this._context.mainComponent.setCursor(engine_render_src.MBo.TEXT)})))}_getTransformCoordForDocumentOffset(document,viewport,evtOffsetX,evtOffsetY){const{documentTransform}=document.getOffsetConfig(),originCoord=viewport.transformVector2SceneCoord(engine_render_src.I9Y.FromArray([evtOffsetX,evtOffsetY]));if(originCoord)return documentTransform.clone().invert().applyPoint(originCoord)}}DocChecklistRenderController=function doc_checklist_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([doc_checklist_render_controller_ts_param(1,(0,src.y_5)(docs_src.EX)),doc_checklist_render_controller_ts_param(2,src.wTY),doc_checklist_render_controller_ts_param(3,(0,src.y_5)(DocEventManagerService)),doc_checklist_render_controller_ts_param(4,(0,src.y_5)(docs_src.pv)),doc_checklist_render_controller_ts_metadata("design:type",Function),doc_checklist_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===docs_src.EX?Object:docs_src.EX,void 0===src.wTY?Object:src.wTY,void 0===DocEventManagerService?Object:DocEventManagerService,void 0===docs_src.pv?Object:docs_src.pv])],DocChecklistRenderController);var clipboard_service=__webpack_require__("../../packages/docs-ui/src/services/clipboard/clipboard.service.ts");function doc_clipboard_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function doc_clipboard_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class DocClipboardController extends src.hy_{constructor(_context,_commandService,_docClipboardService,_docSelectionRenderService,_contextService,_editorService){super(),this._context=_context,this._commandService=_commandService,this._docClipboardService=_docClipboardService,this._docSelectionRenderService=_docSelectionRenderService,this._contextService=_contextService,this._editorService=_editorService,this._init()}_init(){this._initLegacyPasteCommand()}_initLegacyPasteCommand(){this._docSelectionRenderService?.onPaste$.pipe((0,takeUntil.Q)(this.dispose$)).subscribe((config=>{if(!(0,clipboard_command.xc)(this._contextService))return;config.event.preventDefault();const clipboardEvent=config.event;let htmlContent=clipboardEvent.clipboardData?.getData(ui_src.lZ);const textContent=clipboardEvent.clipboardData?.getData(ui_src.OE),files=[...clipboardEvent.clipboardData?.items||[]].filter((item=>ui_src._F.has(item.type))).map((item=>item.getAsFile())).filter((e=>!!e));this._editorService.getEditor(this._context.unitId)&&(htmlContent??"").indexOf("</table>")>-1&&(htmlContent=""),this._docClipboardService.legacyPaste({html:htmlContent,text:textContent,files})}))}}function doc_contextmenu_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function doc_contextmenu_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}DocClipboardController=function doc_clipboard_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([doc_clipboard_controller_ts_param(1,src.wTY),doc_clipboard_controller_ts_param(2,clipboard_service.v),doc_clipboard_controller_ts_param(3,(0,src.y_5)(doc_selection_render_service.q)),doc_clipboard_controller_ts_param(4,src.oaf),doc_clipboard_controller_ts_param(5,editor_manager_service.I),doc_clipboard_controller_ts_metadata("design:type",Function),doc_clipboard_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===src.wTY?Object:src.wTY,void 0===clipboard_service.v?Object:clipboard_service.v,void 0===doc_selection_render_service.q?Object:doc_selection_render_service.q,void 0===src.oaf?Object:src.oaf,void 0===editor_manager_service.I?Object:editor_manager_service.I])],DocClipboardController);const SKIP_UNIT_IDS=[src.Wd2,src.azi,src.Fmw,src.HTw];class DocContextMenuRenderController extends src.jGt{constructor(_context,_contextMenuService,_commandService){super(),this._context=_context,this._contextMenuService=_contextMenuService,this._commandService=_commandService,SKIP_UNIT_IDS.includes(this._context.unitId)||(this._initPointerDown(),this._initEditChange())}_initPointerDown(){const documentsPointerDownObserver=this._context?.mainComponent?.onPointerDown$,documentsSubscription=documentsPointerDownObserver.subscribeEvent((event=>{2===event.button&&this._contextMenuService.triggerContextMenu(event,ui_src.ai.MAIN_AREA)}));this.disposeWithMe(documentsSubscription)}_initEditChange(){this.disposeWithMe(this._commandService.onCommandExecuted((command=>{command.id===docs_src.Bz.id&&this._contextMenuService.visible&&this._contextMenuService.hideContextMenu()})))}}DocContextMenuRenderController=function doc_contextmenu_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([doc_contextmenu_render_controller_ts_param(1,ui_src.ZL),doc_contextmenu_render_controller_ts_param(2,src.wTY),doc_contextmenu_render_controller_ts_metadata("design:type",Function),doc_contextmenu_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===ui_src.ZL?Object:ui_src.ZL,void 0===src.wTY?Object:src.wTY])],DocContextMenuRenderController);var fromEvent=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/observable/fromEvent.js");function doc_editor_bridge_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function doc_editor_bridge_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class DocEditorBridgeController extends src.jGt{constructor(_context,_univerInstanceService,_editorService,_commandService,_docSelectionRenderService,_docSkeletonManagerService,_renderManagerService){super(),this._context=_context,this._univerInstanceService=_univerInstanceService,this._editorService=_editorService,this._commandService=_commandService,this._docSelectionRenderService=_docSelectionRenderService,this._docSkeletonManagerService=_docSkeletonManagerService,this._renderManagerService=_renderManagerService,this._initialEditors=new Set,this._initialize()}_initialize(){this._editorService.getAllEditor().forEach((editor=>{const unitId=editor.getEditorId();unitId===this._context.unitId&&(this._initialEditors.has(unitId)||(this._initialEditors.add(unitId),this._resize(unitId)))})),this._commandExecutedListener(),this._initialBlur(),this._initialFocus()}_resize(unitId){if(null==unitId)return;const editor=this._editorService.getEditor(unitId);if(!0===editor?.cancelDefaultResizeListener)return;const editorDataModel=this._univerInstanceService.getUniverDocInstance(unitId);if(!editorDataModel)return;const skeleton=this._docSkeletonManagerService.getSkeleton();if(null==editor||null==editor.render||null==skeleton||null==editorDataModel)return;skeleton.calculate();const{marginTop=0,marginBottom=0,marginLeft=0,marginRight=0}=editorDataModel.getSnapshot().documentStyle,{scene,mainComponent}=editor.render;let{actualHeight,actualWidth}=skeleton.getActualSize();actualHeight+=marginTop+marginBottom,actualWidth+=marginLeft+marginRight;const{width,height}=editor.getBoundingClientRect(),contentWidth=Math.max(actualWidth,width),contentHeight=Math.max(actualHeight,height);scene.transformByState({width:contentWidth,height:contentHeight}),mainComponent?.resize(contentWidth,contentHeight)}_initialBlur(){this.disposeWithMe(this._editorService.blur$.subscribe((()=>{this._docSelectionRenderService.blur()}))),this.disposeWithMe(this._docSelectionRenderService.onBlur$.subscribe((()=>{const{unitId}=this._context,editor=this._editorService.getEditor(unitId),focusEditor=this._editorService.getFocusEditor();null==editor||editor.isSheetEditor()||focusEditor&&focusEditor.getEditorId()===unitId||unitId.includes("range_selector")||unitId.includes("embedding_formula_editor")||this._editorService.blur()})))}_initialFocus(){const focusExcepts=["univer-formula-search","univer-formula-help","formula-help-decorator","univer-formula-help-param"];this.disposeWithMe((0,fromEvent.R)(window,"mousedown").subscribe((event=>{const hasSearch=event.target.classList[0]||"";(0,src.c8_)(hasSearch,focusExcepts)&&event.stopPropagation()})));const disposableCollection=new src.VdD;this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET).subscribe((unit=>{if(disposableCollection.dispose(),!unit)return;const unitId=unit.getUnitId(),render=this._renderManagerService.getRenderById(unitId),canvasEle=render?.engine.getCanvas().getCanvasEle();if(null==canvasEle)return;const disposable=(0,fromEvent.R)(canvasEle,"mousedown").subscribe((evt=>{evt.stopPropagation()}));disposableCollection.add(disposable)}))),this.disposeWithMe((()=>disposableCollection.dispose()))}_commandExecutedListener(){const updateCommandList=[docs_src.Bz.id];this.disposeWithMe(this._commandService.onCommandExecuted((command=>{if(updateCommandList.includes(command.id)){const params=command.params,{unitId}=params;if(this._editorService.isSheetEditor(unitId)||unitId!==this._context.unitId)return;const editor=this._editorService.getEditor(unitId);editor&&!editor.params.scrollBar&&this._resize(unitId)}})))}}function doc_ime_input_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function doc_ime_input_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}DocEditorBridgeController=function doc_editor_bridge_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([doc_editor_bridge_controller_ts_param(1,src.HCr),doc_editor_bridge_controller_ts_param(2,editor_manager_service.I),doc_editor_bridge_controller_ts_param(3,src.wTY),doc_editor_bridge_controller_ts_param(4,(0,src.y_5)(doc_selection_render_service.q)),doc_editor_bridge_controller_ts_param(5,(0,src.y_5)(docs_src.EX)),doc_editor_bridge_controller_ts_param(6,engine_render_src.cSx),doc_editor_bridge_controller_ts_metadata("design:type",Function),doc_editor_bridge_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===src.HCr?Object:src.HCr,void 0===editor_manager_service.I?Object:editor_manager_service.I,void 0===src.wTY?Object:src.wTY,void 0===doc_selection_render_service.q?Object:doc_selection_render_service.q,void 0===docs_src.EX?Object:docs_src.EX,void 0===engine_render_src.cSx?Object:engine_render_src.cSx])],DocEditorBridgeController);class DocIMEInputController extends src.jGt{constructor(_context,_docSelectionRenderService,_docImeInputManagerService,_docSkeletonManagerService,_commandService){super(),this._context=_context,this._docSelectionRenderService=_docSelectionRenderService,this._docImeInputManagerService=_docImeInputManagerService,this._docSkeletonManagerService=_docSkeletonManagerService,this._commandService=_commandService,this._previousIMEContent="",this._isCompositionStart=!0,this._initialize()}dispose(){this._onStartSubscription?.unsubscribe(),this._onUpdateSubscription?.unsubscribe(),this._onEndSubscription?.unsubscribe()}_initialize(){this._initialOnCompositionstart(),this._initialOnCompositionUpdate(),this._initialOnCompositionend()}_initialOnCompositionstart(){this._onStartSubscription=this._docSelectionRenderService.onCompositionstart$.subscribe((config=>{if(null==config)return;this._resetIME();const{activeRange}=config;null!=activeRange&&this._docImeInputManagerService.setActiveRange(src.S0q.deepClone(activeRange))}))}_initialOnCompositionUpdate(){this._onUpdateSubscription=this._docSelectionRenderService.onCompositionupdate$.subscribe((config=>{this._updateContent(config,!0)}))}_initialOnCompositionend(){this._onEndSubscription=this._docSelectionRenderService.onCompositionend$.subscribe((config=>{this._updateContent(config,!1)}))}async _updateContent(config,isUpdate){if(null==config)return;const unitId=this._context.unitId,skeleton=this._docSkeletonManagerService.getSkeleton(),{event,activeRange}=config;if(null==skeleton||null==activeRange)return;const content=event.data;content===this._previousIMEContent&&isUpdate||(await this._commandService.executeCommand(IMEInputCommand.id,{unitId,newText:content,oldTextLen:this._previousIMEContent.length,isCompositionStart:this._isCompositionStart,isCompositionEnd:!isUpdate}),isUpdate?(this._isCompositionStart&&(this._isCompositionStart=!1),this._previousIMEContent=content):this._resetIME())}_resetIME(){this._previousIMEContent="",this._isCompositionStart=!0,this._docImeInputManagerService.clearUndoRedoMutationParamsCache(),this._docImeInputManagerService.setActiveRange(null)}}function doc_input_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function doc_input_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}DocIMEInputController=function doc_ime_input_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([doc_ime_input_controller_ts_param(1,(0,src.y_5)(doc_selection_render_service.q)),doc_ime_input_controller_ts_param(2,(0,src.y_5)(DocIMEInputManagerService)),doc_ime_input_controller_ts_param(3,(0,src.y_5)(docs_src.EX)),doc_ime_input_controller_ts_param(4,src.wTY),doc_ime_input_controller_ts_metadata("design:type",Function),doc_ime_input_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===doc_selection_render_service.q?Object:doc_selection_render_service.q,void 0===DocIMEInputManagerService?Object:DocIMEInputManagerService,void 0===docs_src.EX?Object:docs_src.EX,void 0===src.wTY?Object:src.wTY])],DocIMEInputController);class DocInputController extends src.jGt{constructor(_context,_docSelectionRenderService,_docSkeletonManagerService,_commandService,_docMenuStyleService){super(),this._context=_context,this._docSelectionRenderService=_docSelectionRenderService,this._docSkeletonManagerService=_docSkeletonManagerService,this._commandService=_commandService,this._docMenuStyleService=_docMenuStyleService,this._init()}dispose(){super.dispose(),this._onInputSubscription?.unsubscribe()}_init(){this._initialNormalInput()}_initialNormalInput(){this._onInputSubscription=this._docSelectionRenderService.onInput$.subscribe((async config=>{if(null==config)return;const{unitId}=this._context,{event,content="",activeRange}=config,e=event,skeleton=this._docSkeletonManagerService.getSkeleton();if(null==e.data||null==skeleton||null==activeRange)return;const{segmentId}=activeRange,originBody=this._context.unit.getSelfOrHeaderFooterModel(segmentId).getBody(),defaultTextStyle=this._docMenuStyleService.getDefaultStyle(),cacheStyle=this._docMenuStyleService.getStyleCache(),curCustomRange=(0,paragraph.Nn)(originBody?.customRanges??[],activeRange.endOffset,src._aE.includes(unitId)),curTextRun=(0,paragraph.nM)(originBody,activeRange.endOffset,defaultTextStyle,cacheStyle,src._aE.includes(unitId)),curCustomDecorations=(0,paragraph.yo)(originBody?.customDecorations??[],activeRange.endOffset);await this._commandService.executeCommand(core_editing_command.TX.id,{unitId,body:{dataStream:content,textRuns:curTextRun?[{...curTextRun,st:0,ed:content.length}]:[],customRanges:curCustomRange?[{...curCustomRange,startIndex:0,endIndex:content.length-1}]:[],customDecorations:curCustomDecorations.map((customDecoration=>({...customDecoration,startIndex:0,endIndex:content.length-1})))},range:activeRange,segmentId})," "===content&&await this._commandService.executeCommand(AfterSpaceCommand.id)}))}}DocInputController=function doc_input_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([doc_input_controller_ts_param(1,(0,src.y_5)(doc_selection_render_service.q)),doc_input_controller_ts_param(2,(0,src.y_5)(docs_src.EX)),doc_input_controller_ts_param(3,src.wTY),doc_input_controller_ts_param(4,(0,src.y_5)(doc_menu_style_service._)),doc_input_controller_ts_metadata("design:type",Function),doc_input_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===doc_selection_render_service.q?Object:doc_selection_render_service.q,void 0===docs_src.EX?Object:docs_src.EX,void 0===src.wTY?Object:src.wTY,void 0===doc_menu_style_service._?Object:doc_menu_style_service._])],DocInputController);var animationFrame=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/scheduler/animationFrame.js");class DocPageLayoutService extends src.jGt{constructor(_context){super(),this._context=_context}calculatePagePosition(){const docObject=(0,component_tools.Ce)(this._context),docDataModel=this._context.unit,zoomRatio=docDataModel.getSettings()?.zoomRatio??1,{document:docsComponent,scene,docBackground}=docObject,parent=scene?.getParent(),{width:docsWidth,height:docsHeight,pageMarginLeft,pageMarginTop}=docsComponent;if(null==parent||docsWidth===Number.POSITIVE_INFINITY||docsHeight===Number.POSITIVE_INFINITY)return;const{width:engineWidth,height:engineHeight}=parent;let docsLeft=0,docsTop=pageMarginTop,sceneWidth=0,sceneHeight=0,scrollToX=Number.POSITIVE_INFINITY;engineWidth>(docsWidth+2*pageMarginLeft)*zoomRatio?(docsLeft=engineWidth/2-docsWidth*zoomRatio/2,docsLeft/=zoomRatio,sceneWidth=(engineWidth-2*pageMarginLeft)/zoomRatio,scrollToX=0):(docsLeft=pageMarginLeft,sceneWidth=docsWidth+2*pageMarginLeft,scrollToX=(sceneWidth-engineWidth/zoomRatio)/2),sceneHeight=engineHeight>docsHeight?(engineHeight-2*pageMarginTop)/zoomRatio:docsHeight+2*pageMarginTop,scene.resize(sceneWidth,sceneHeight),engineWidth<=1&&(docsLeft=-1e4,docsTop=-1e4),docsComponent.translate(docsLeft,docsTop),docBackground.translate(docsLeft,docsTop);const viewport=scene.getViewport(docs_view_key.hl.VIEW_MAIN);return scrollToX!==Number.POSITIVE_INFINITY&&null!=viewport&&viewport.scrollToViewportPos({viewportScrollX:scrollToX}),this}}function doc_resize_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function doc_resize_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class DocResizeRenderController extends src.jGt{constructor(_context,_docPageLayoutService,_textSelectionManagerService){super(),this._context=_context,this._docPageLayoutService=_docPageLayoutService,this._textSelectionManagerService=_textSelectionManagerService;const unitId=this._context.unitId;if((0,src.W2S)(unitId)&&unitId!==src.HTw)return this;this._initResize()}_initResize(){this.disposeWithMe((0,src.Ldp)(this._context.engine.onTransformChange$).pipe((0,filter.p)((evt=>evt.type===engine_render_src.FAP.resize)),(0,throttleTime.c)(0,animationFrame.X)).subscribe((()=>{this._docPageLayoutService.calculatePagePosition(),this._textSelectionManagerService.refreshSelection()})))}}DocResizeRenderController=function doc_resize_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([doc_resize_render_controller_ts_param(1,(0,src.y_5)(DocPageLayoutService)),doc_resize_render_controller_ts_param(2,(0,src.y_5)(docs_src.pv)),doc_resize_render_controller_ts_metadata("design:type",Function),doc_resize_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===DocPageLayoutService?Object:DocPageLayoutService,void 0===docs_src.pv?Object:docs_src.pv])],DocResizeRenderController);var selection=__webpack_require__("../../packages/docs-ui/src/basics/selection.ts");function doc_selection_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function doc_selection_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class DocSelectionRenderController extends src.jGt{constructor(_context,_commandService,_editorService,_instanceSrv,_docSelectionRenderService,_docSkeletonManagerService,_docSelectionManagerService){super(),this._context=_context,this._commandService=_commandService,this._editorService=_editorService,this._instanceSrv=_instanceSrv,this._docSelectionRenderService=_docSelectionRenderService,this._docSkeletonManagerService=_docSkeletonManagerService,this._docSelectionManagerService=_docSelectionManagerService,this._loadedMap=new WeakSet,this._initialize()}_initialize(){this._init(),this._skeletonListener(),this._commandExecutedListener(),this._refreshListener(),this._syncSelection()}_init(){const{unitId}=this._context,docObject=(0,component_tools.Ce)(this._context);null!=docObject&&null!=docObject.document&&(this._loadedMap.has(docObject.document)||(this._initialMain(unitId),this._loadedMap.add(docObject.document)))}_refreshListener(){this.disposeWithMe(this._docSelectionManagerService.refreshSelection$.subscribe((params=>{if(null==params)return;const{unitId,docRanges,isEditing,options}=params;unitId===this._context.unitId&&(this._docSelectionRenderService.removeAllRanges(),this._docSelectionRenderService.addDocRanges(docRanges,isEditing,options))})))}_syncSelection(){this.disposeWithMe(this._docSelectionRenderService.textSelectionInner$.subscribe((params=>{null!=params&&this._docSelectionManagerService.__replaceTextRangesWithNoRefresh(params,{unitId:this._context.unitId,subUnitId:this._context.unitId})})))}_initialMain(unitId){const docObject=(0,component_tools.Ce)(this._context),{document,scene}=docObject;this.disposeWithMe(document.onPointerEnter$.subscribeEvent((()=>{this._isEditorReadOnly(unitId)||(document.cursor=engine_render_src.MBo.TEXT)}))),this.disposeWithMe(document.onPointerLeave$.subscribeEvent((()=>{document.cursor=engine_render_src.MBo.DEFAULT,scene.resetCursor()}))),this.disposeWithMe(document.onPointerDown$.subscribeEvent(((evt,state)=>{if(this._isEditorReadOnly(unitId))return;const docDataModel=this._instanceSrv.getCurrentUnitForType(src.Zy$.UNIVER_DOC);docDataModel?.getUnitId()!==unitId&&this._instanceSrv.setCurrentUnitForType(unitId);const skeleton=this._docSkeletonManagerService.getSkeleton(),{offsetX,offsetY}=evt,coord=this._getTransformCoordForDocumentOffset(offsetX,offsetY);if(null!=coord){const{pageLayoutType=engine_render_src.kvx.VERTICAL,pageMarginLeft,pageMarginTop}=document.getOffsetConfig(),{editArea}=skeleton.findEditAreaByCoord(coord,pageLayoutType,pageMarginLeft,pageMarginTop),viewModel=this._docSkeletonManagerService.getViewModel(),preEditArea=viewModel.getEditArea();preEditArea!==engine_render_src.ZCK.BODY&&editArea!==engine_render_src.ZCK.BODY&&editArea!==preEditArea&&viewModel.setEditArea(editArea)}if(this._docSelectionRenderService.__onPointDown(evt),this._editorService.getEditor(unitId)){this._setEditorFocus(unitId);const{offsetX,offsetY}=evt;setTimeout((()=>{unitId!==this._editorService.getFocusId()&&(this._setEditorFocus(unitId),this._docSelectionRenderService.setCursorManually(offsetX,offsetY))}),0)}2!==evt.button&&state.stopPropagation()}))),this.disposeWithMe(document.onDblclick$.subscribeEvent((evt=>{this._isEditorReadOnly(unitId)||this._docSelectionRenderService.__handleDblClick(evt)}))),this.disposeWithMe(document.onTripleClick$.subscribeEvent((evt=>{this._isEditorReadOnly(unitId)||this._docSelectionRenderService.__handleTripleClick(evt)})))}_getTransformCoordForDocumentOffset(evtOffsetX,evtOffsetY){const docObject=(0,component_tools.Ce)(this._context),{document,scene}=docObject,{documentTransform}=document.getOffsetConfig(),activeViewport=scene.getViewports()[0];if(null==activeViewport)return;const originCoord=activeViewport.transformVector2SceneCoord(engine_render_src.I9Y.FromArray([evtOffsetX,evtOffsetY]));return documentTransform.clone().invert().applyPoint(originCoord)}_isEditorReadOnly(unitId){const editor=this._editorService.getEditor(unitId);return!!editor&&editor.isReadOnly()}_setEditorFocus(unitId){this._editorService.focus(unitId)}_commandExecutedListener(){const updateCommandList=[SetDocZoomRatioOperation.id];this.disposeWithMe(this._commandService.onCommandExecuted((command=>{if(updateCommandList.includes(command.id)){const params=command.params,{unitId:documentId}=params,unitId=this._docSelectionManagerService.__getCurrentSelection()?.unitId;if(documentId!==unitId)return;this._docSelectionManagerService.refreshSelection()}})))}_skeletonListener(){this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe((skeleton=>{if(!skeleton)return;const{unitId}=this._context;if(!(0,src.W2S)(unitId)){this._docSelectionRenderService.focus();const snapshot=this._context.unit.getSnapshot(),offset=(0,selection.X)(snapshot);this._docSelectionManagerService.replaceDocRanges([{startOffset:offset,endOffset:offset}],{unitId,subUnitId:unitId},!1)}})))}}function zoom_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function zoom_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}DocSelectionRenderController=function doc_selection_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([doc_selection_render_controller_ts_param(1,src.wTY),doc_selection_render_controller_ts_param(2,editor_manager_service.I),doc_selection_render_controller_ts_param(3,src.HCr),doc_selection_render_controller_ts_param(4,(0,src.y_5)(doc_selection_render_service.q)),doc_selection_render_controller_ts_param(5,(0,src.y_5)(docs_src.EX)),doc_selection_render_controller_ts_param(6,(0,src.y_5)(docs_src.pv)),doc_selection_render_controller_ts_metadata("design:type",Function),doc_selection_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===src.wTY?Object:src.wTY,void 0===editor_manager_service.I?Object:editor_manager_service.I,void 0===src.HCr?Object:src.HCr,void 0===doc_selection_render_service.q?Object:doc_selection_render_service.q,void 0===docs_src.EX?Object:docs_src.EX,void 0===docs_src.pv?Object:docs_src.pv])],DocSelectionRenderController);class DocZoomRenderController extends src.jGt{constructor(_context,_contextService,_docSkeletonManagerService,_univerInstanceService,_commandService,_textSelectionManagerService,_editorService,_docPageLayoutService){super(),this._context=_context,this._contextService=_contextService,this._docSkeletonManagerService=_docSkeletonManagerService,this._univerInstanceService=_univerInstanceService,this._commandService=_commandService,this._textSelectionManagerService=_textSelectionManagerService,this._editorService=_editorService,this._docPageLayoutService=_docPageLayoutService,this._initSkeletonListener(),this._initCommandExecutedListener(),this._initRenderRefresher(),setTimeout((()=>this.updateViewZoom(1,!0)),20)}_initRenderRefresher(){this._docSkeletonManagerService.currentSkeleton$.subscribe((param=>{if(null==param)return;const{unitId,scene}=this._context;this._editorService.isEditor(unitId)||this.disposeWithMe(scene.onMouseWheel$.subscribeEvent((e=>{if(!e.ctrlKey||!this._contextService.getContextValue(src.y0c))return;const documentModel=this._univerInstanceService.getCurrentUniverDocInstance();if(!documentModel)return;const{documentFlavor}=documentModel.getSnapshot().documentStyle;if(documentFlavor===src.CQy.MODERN)return;const deltaFactor=Math.abs(e.deltaX);let ratioDelta=deltaFactor<40?.2:deltaFactor<80?.4:.2;ratioDelta*=e.deltaY>0?-1:1,scene.scaleX<1&&(ratioDelta/=2);const currentRatio=documentModel.zoomRatio;let nextRatio=+Number.parseFloat(`${currentRatio+ratioDelta}`).toFixed(1);nextRatio=nextRatio>=4?4:nextRatio<=.1?.1:nextRatio,this._commandService.executeCommand(SetDocZoomRatioCommand.id,{zoomRatio:nextRatio,unitId:documentModel.getUnitId()}),e.preventDefault()})))}))}_initSkeletonListener(){this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe((param=>{if(null==param)return;const documentModel=this._univerInstanceService.getCurrentUniverDocInstance();if(!documentModel)return;const zoomRatio=documentModel.zoomRatio||1;this.updateViewZoom(zoomRatio,!1)})))}_initCommandExecutedListener(){const updateCommandList=[SetDocZoomRatioOperation.id];this.disposeWithMe(this._commandService.onCommandExecuted((command=>{if(updateCommandList.includes(command.id)&&command.params.unitId===this._context.unitId){const zoomRatio=this._context.unit.zoomRatio||1;this.updateViewZoom(zoomRatio)}}))),this.disposeWithMe(this._commandService.beforeCommandExecuted((command=>{command.id===switch_doc_mode_command.x.id&&this._commandService.executeCommand(SetDocZoomRatioCommand.id,{zoomRatio:1,unitId:this._context.unitId})})))}updateViewZoom(zoomRatio,needRefreshSelection=!0){const docObject=(0,component_tools.Ce)(this._context);docObject.scene.scale(zoomRatio,zoomRatio),this._editorService.isEditor(this._context.unitId)||this._docPageLayoutService.calculatePagePosition(),needRefreshSelection&&!this._editorService.isEditor(this._context.unitId)&&this._textSelectionManagerService.refreshSelection(),docObject.scene.getTransformer()?.clearSelectedObjects()}}function doc_state_change_manager_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function doc_state_change_manager_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}DocZoomRenderController=function zoom_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([zoom_render_controller_ts_param(1,src.oaf),zoom_render_controller_ts_param(2,(0,src.y_5)(docs_src.EX)),zoom_render_controller_ts_param(3,src.HCr),zoom_render_controller_ts_param(4,src.wTY),zoom_render_controller_ts_param(5,(0,src.y_5)(docs_src.pv)),zoom_render_controller_ts_param(6,editor_manager_service.I),zoom_render_controller_ts_param(7,(0,src.y_5)(DocPageLayoutService)),zoom_render_controller_ts_metadata("design:type",Function),zoom_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===src.oaf?Object:src.oaf,void 0===docs_src.EX?Object:docs_src.EX,void 0===src.HCr?Object:src.HCr,void 0===src.wTY?Object:src.wTY,void 0===docs_src.pv?Object:docs_src.pv,void 0===editor_manager_service.I?Object:editor_manager_service.I,void 0===DocPageLayoutService?Object:DocPageLayoutService])],DocZoomRenderController);class DocStateChangeManagerService extends src.hy_{constructor(_undoRedoService,_commandService,_univerInstanceService,_docStateEmitService,_renderManagerService){super(),this._undoRedoService=_undoRedoService,this._commandService=_commandService,this._univerInstanceService=_univerInstanceService,this._docStateEmitService=_docStateEmitService,this._renderManagerService=_renderManagerService,this._docStateChange$=new BehaviorSubject.t(null),this.docStateChange$=this._docStateChange$.asObservable(),this._historyStateCache=new Map,this._changeStateCache=new Map,this._historyTimer=null,this._changeStateCacheTimer=null,this._initialize(),this._listenDocStateChange()}getStateCache(unitId){return{history:this._historyStateCache.get(unitId)??[],collaboration:this._changeStateCache.get(unitId)??[]}}setStateCache(unitId,cache){this._historyStateCache.set(unitId,cache.history),this._changeStateCache.set(unitId,cache.collaboration)}_setChangeState(changeState){this._cacheChangeState(changeState,"history"),this._cacheChangeState(changeState,"collaboration")}_initialize(){this.disposeWithMe(this._commandService.beforeCommandExecuted((command=>{if(command.id===src.dab||command.id===src.ngE){const univerDoc=this._univerInstanceService.getCurrentUniverDocInstance();if(null==univerDoc)return;const unitId=univerDoc.getUnitId();this._pushHistory(unitId),this._emitChangeState(unitId)}})))}_listenDocStateChange(){this._docStateEmitService.docStateChangeParams$.pipe((0,takeUntil.Q)(this.dispose$)).subscribe((changeStateInfo=>{if(null==changeStateInfo)return;const{isCompositionEnd,isSync,syncer,...changeState}=changeStateInfo,imeInputManagerService=this._renderManagerService.getRenderById(isSync?syncer:changeStateInfo.unitId)?.with(DocIMEInputManagerService);if(null!=imeInputManagerService){if(isCompositionEnd){const historyParams=imeInputManagerService.fetchComposedUndoRedoMutationParams();if(null==historyParams)throw new Error("historyParams is null in RichTextEditingMutation");const{undoMutationParams,redoMutationParams,previousActiveRange}=historyParams;changeState.redoState.actions=redoMutationParams.actions,changeState.undoState.actions=undoMutationParams.actions,changeState.undoState.textRanges=[previousActiveRange]}this._setChangeState(changeState)}}))}_cacheChangeState(changeState,type="history"){const{trigger,unitId,noHistory,debounce=!1}=changeState;if(noHistory||null==trigger)return;if("history"===type&&(trigger===src.ngE||trigger===src.dab))return;const stateCache="history"===type?this._historyStateCache:this._changeStateCache,cb="history"===type?this._pushHistory.bind(this):this._emitChangeState.bind(this);if(stateCache.has(unitId)){const cacheStates=stateCache.get(unitId);cacheStates?.push(changeState)}else stateCache.set(unitId,[changeState]);debounce?"history"===type?(this._historyTimer&&clearTimeout(this._historyTimer),this._historyTimer=setTimeout((()=>{cb(unitId)}),300)):(this._changeStateCacheTimer&&clearTimeout(this._changeStateCacheTimer),this._changeStateCacheTimer=setTimeout((()=>{cb(unitId)}),300)):cb(unitId)}_pushHistory(unitId){const undoRedoService=this._undoRedoService,cacheStates=this._historyStateCache.get(unitId);if(!Array.isArray(cacheStates)||0===cacheStates.length)return;const len=cacheStates.length,commandId=cacheStates[0].commandId,firstState=cacheStates[0],lastState=cacheStates[len-1],redoParams={unitId,actions:cacheStates.reduce(((acc,cur)=>src.rRQ.compose(acc,cur.redoState.actions)),null),textRanges:lastState.redoState.textRanges},undoParams={unitId,actions:cacheStates.reverse().reduce(((acc,cur)=>src.rRQ.compose(acc,cur.undoState.actions)),null),textRanges:firstState.undoState.textRanges};undoRedoService.pushUndoRedo({unitID:unitId,undoMutations:[{id:commandId,params:undoParams}],redoMutations:[{id:commandId,params:redoParams}]}),cacheStates.length=0}_emitChangeState(unitId){const cacheStates=this._changeStateCache.get(unitId);if(!Array.isArray(cacheStates)||0===cacheStates.length)return;const len=cacheStates.length,{commandId,trigger,segmentId,noHistory,debounce}=cacheStates[0],firstState=cacheStates[0],lastState=cacheStates[len-1],changeState={commandId,unitId,trigger,redoState:{unitId,actions:cacheStates.reduce(((acc,cur)=>src.rRQ.compose(acc,cur.redoState.actions)),null),textRanges:lastState.redoState.textRanges},undoState:{unitId,actions:cacheStates.reverse().reduce(((acc,cur)=>src.rRQ.compose(acc,cur.undoState.actions)),null),textRanges:firstState.undoState.textRanges},segmentId,noHistory,debounce};cacheStates.length=0,this._docStateChange$.next(changeState)}}function docs_render_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function docs_render_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}DocStateChangeManagerService=function doc_state_change_manager_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([doc_state_change_manager_service_ts_param(0,(0,src.y_5)(src.$Dz)),doc_state_change_manager_service_ts_param(1,src.wTY),doc_state_change_manager_service_ts_param(2,src.HCr),doc_state_change_manager_service_ts_param(3,(0,src.y_5)(docs_src.Mx)),doc_state_change_manager_service_ts_param(4,engine_render_src.cSx),doc_state_change_manager_service_ts_metadata("design:type",Function),doc_state_change_manager_service_ts_metadata("design:paramtypes",[void 0===src.$Dz?Object:src.$Dz,void 0===src.wTY?Object:src.wTY,void 0===src.HCr?Object:src.HCr,void 0===docs_src.Mx?Object:docs_src.Mx,void 0===engine_render_src.cSx?Object:engine_render_src.cSx])],DocStateChangeManagerService);class DocsRenderService extends src.hy_{constructor(_instanceSrv,_renderManagerService){super(),this._instanceSrv=_instanceSrv,this._renderManagerService=_renderManagerService,this._init()}_init(){this._renderManagerService.createRender$.pipe((0,takeUntil.Q)(this.dispose$)).subscribe((unitId=>this._createRenderWithId(unitId))),this._instanceSrv.getAllUnitsForType(src.Zy$.UNIVER_DOC).forEach((documentModel=>this._createRenderer(documentModel))),this._instanceSrv.getTypeOfUnitAdded$(src.Zy$.UNIVER_DOC).pipe((0,takeUntil.Q)(this.dispose$)).subscribe((doc=>this._createRenderer(doc))),this._instanceSrv.getTypeOfUnitDisposed$(src.Zy$.UNIVER_DOC).pipe((0,takeUntil.Q)(this.dispose$)).subscribe((doc=>this._disposeRenderer(doc)))}_createRenderer(doc){const unitId=doc.getUnitId(),workbookId=this._instanceSrv.getCurrentUnitForType(src.Zy$.UNIVER_DOC)?.getUnitId();this._renderManagerService.created$.subscribe((renderer=>{renderer.unitId===workbookId&&(renderer.engine.getCanvas().setId("univer-doc-main-canvas"),renderer.engine.getCanvas().getContext().setId("univer-doc-main-canvas"))})),this._renderManagerService.has(unitId)||this._createRenderWithId(unitId)}_createRenderWithId(unitId){this._renderManagerService.createRender(unitId)}_disposeRenderer(doc){const unitId=doc.getUnitId();this._renderManagerService.removeRender(unitId)}}DocsRenderService=function docs_render_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([docs_render_service_ts_param(0,src.HCr),docs_render_service_ts_param(1,engine_render_src.cSx),docs_render_service_ts_metadata("design:type",Function),docs_render_service_ts_metadata("design:paramtypes",[void 0===src.HCr?Object:src.HCr,void 0===engine_render_src.cSx?Object:engine_render_src.cSx])],DocsRenderService);class RangeSelectorService extends src.jGt{get selectorModalVisible(){return this._selectorModalVisible$.getValue()}setCurrentSelectorId(id){this._currentSelectorId=id}getCurrentSelectorId(){return this._currentSelectorId}selectionChange(range){this._currentSelectorId&&this._selectionChange$.next(range)}openSelector(){this._openSelector$.next(null)}triggerModalVisibleChange(visible){this._selectorModalVisible$.next(visible)}constructor(...args){super(...args),this._selectionChange$=new Subject.B,this.selectionChange$=this._selectionChange$.asObservable(),this._openSelector$=new Subject.B,this.openSelector$=this._openSelector$.asObservable(),this._selectorModalVisible$=new BehaviorSubject.t(!1),this.selectorModalVisible$=this._selectorModalVisible$.asObservable()}}const IRangeSelectorService=(0,src.Qmd)("univer.range-selector.service"),BreakLineShortcut={id:EnterCommand.id,preconditions:function whenDocAndEditorFocusedWithBreakLine(contextService){return contextService.getContextValue(src.y0c)&&contextService.getContextValue(src.l1D)&&!contextService.getContextValue(src.fiP)},binding:ui_src.DD.ENTER},DeleteLeftShortcut={id:doc_delete_command.iM.id,preconditions:whenDocAndEditorFocused,binding:ui_src.DD.BACKSPACE},DeleteRightShortcut={id:doc_delete_command.H7.id,preconditions:whenDocAndEditorFocused,binding:ui_src.DD.DELETE},MoveCursorUpShortcut={id:MoveCursorOperation.id,binding:ui_src.DD.ARROW_UP,preconditions:whenDocAndEditorFocused,staticParameters:{direction:src.OP3.UP}},MoveCursorDownShortcut={id:MoveCursorOperation.id,binding:ui_src.DD.ARROW_DOWN,preconditions:whenDocAndEditorFocused,staticParameters:{direction:src.OP3.DOWN}},MoveCursorLeftShortcut={id:MoveCursorOperation.id,binding:ui_src.DD.ARROW_LEFT,preconditions:whenDocAndEditorFocused,staticParameters:{direction:src.OP3.LEFT}},MoveCursorRightShortcut={id:MoveCursorOperation.id,binding:ui_src.DD.ARROW_RIGHT,preconditions:whenDocAndEditorFocused,staticParameters:{direction:src.OP3.RIGHT}},MoveSelectionUpShortcut={id:MoveSelectionOperation.id,binding:ui_src.DD.ARROW_UP|ui_src.SK.SHIFT,preconditions:whenDocAndEditorFocused,staticParameters:{direction:src.OP3.UP}},MoveSelectionDownShortcut={id:MoveSelectionOperation.id,binding:ui_src.DD.ARROW_DOWN|ui_src.SK.SHIFT,preconditions:whenDocAndEditorFocused,staticParameters:{direction:src.OP3.DOWN}},MoveSelectionLeftShortcut={id:MoveSelectionOperation.id,binding:ui_src.DD.ARROW_LEFT|ui_src.SK.SHIFT,preconditions:whenDocAndEditorFocused,staticParameters:{direction:src.OP3.LEFT}},MoveSelectionRightShortcut={id:MoveSelectionOperation.id,binding:ui_src.DD.ARROW_RIGHT|ui_src.SK.SHIFT,preconditions:whenDocAndEditorFocused,staticParameters:{direction:src.OP3.RIGHT}},SelectAllShortcut={id:DocSelectAllCommand.id,binding:ui_src.DD.A|ui_src.SK.CTRL_COMMAND,preconditions:contextService=>contextService.getContextValue(src.l1D)&&(contextService.getContextValue(src.y0c)||contextService.getContextValue(src.AF$))};function docs_ui_plugin_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function docs_ui_plugin_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class UniverDocsUIPlugin extends src.k_1{static#_=this.pluginName="DOC_UI_PLUGIN";constructor(_config=config_schema_defaultPluginConfig,_injector,_renderManagerSrv,_commandService,_logService,_configService){super(),this._config=_config,this._injector=_injector,this._renderManagerSrv=_renderManagerSrv,this._commandService=_commandService,this._logService=_logService,this._configService=_configService;const{menu,...rest}=(0,src.h1I)({},config_schema_defaultPluginConfig,this._config);menu&&this._configService.setConfig("menu",menu,{merge:!0}),this._configService.setConfig("docs-ui.config",rest),this._initDependencies(_injector),this._initializeShortcut(),this._initCommand()}onReady(){this._initRenderBasics(),this._markDocAsFocused(),(0,src.HLP)(this._injector,[[DocStateChangeManagerService],[DocsRenderService]])}onRendered(){this._initUI(),this._initRenderModules(),(0,src.HLP)(this._injector,[[DocAutoFormatController],[DocMoveCursorController],[doc_paragraph_setting_controller.B],[DocTableController],[DocUIController],[FloatMenuController]])}_initCommand(){[doc_delete_command.iM,doc_delete_command.H7,inline_format_command.D6,inline_format_command._H,inline_format_command.uk,inline_format_command.rF,inline_format_command.xL,inline_format_command.yS,inline_format_command.mZ,inline_format_command.vp,inline_format_command.Qo,inline_format_command.tE,inline_format_command.Ag,inline_format_command.EM,break_line_command.Z,core_editing_command.TX,core_editing_command.Rj,doc_delete_command.DK,core_editing_command.fR,doc_delete_command.AD,doc_delete_command._E,SetDocZoomRatioOperation,list_command.kx,list_command.mh,list_command.B1,paragraph_align_command.c5,paragraph_align_command.uk,paragraph_align_command.L7,paragraph_align_command.od,paragraph_align_command.JV,doc_horizontal_line_command.G,doc_table_create_command.A,doc_table_insert_command.vc,doc_table_insert_command.k1,doc_table_insert_command.mZ,doc_table_insert_command.tI,doc_table_insert_command.UG,doc_table_insert_command.X2,doc_table_delete_command.er,doc_table_delete_command.Ws,doc_table_delete_command.dK,doc_header_footer_command.Q6,DocTableTabCommand,TabCommand,AfterSpaceCommand,EnterCommand,list_command.Cz,list_command.Q,list_command.Sm,list_command.y6,list_command.h,IMEInputCommand,switch_doc_mode_command.x,doc_paragraph_setting_command.Y,clipboard_inner_command.J1,clipboard_inner_command.J2,replace_content_command.zv,replace_content_command.e6,replace_content_command.As,SetDocZoomRatioCommand,DocSelectAllCommand,doc_paragraph_setting_panel_operation.I,MoveCursorOperation,MoveSelectionOperation,replace_content_command.Z7,replace_content_command.cF,InsertCustomRangeCommand].forEach((e=>{this._commandService.registerCommand(e)})),[clipboard_command.P1,clipboard_command.ye,clipboard_command.rZ].forEach((command=>this.disposeWithMe(this._commandService.registerMultipleCommand(command))))}_initializeShortcut(){[MoveCursorUpShortcut,MoveCursorDownShortcut,MoveCursorRightShortcut,MoveCursorLeftShortcut,MoveSelectionUpShortcut,MoveSelectionDownShortcut,MoveSelectionLeftShortcut,MoveSelectionRightShortcut,SelectAllShortcut,DeleteLeftShortcut,DeleteRightShortcut,BreakLineShortcut,ShiftTabShortCut].forEach((shortcut=>{this._injector.get(ui_src.nF).registerShortcut(shortcut)}))}_initDependencies(injector){(0,src.afw)([[DocClipboardController],[DocEditorBridgeController],[DocUIController],[DocAutoFormatController],[DocTableController],[DocMoveCursorController],[AppUIController],[doc_paragraph_setting_controller.B],[editor_manager_service.I,{useClass:editor_manager_service.x}],[IRangeSelectorService,{useClass:RangeSelectorService}],[clipboard_service.v,{useClass:clipboard_service.S}],[DocCanvasPopManagerService],[DocsRenderService],[DocStateChangeManagerService],[DocAutoFormatService],[doc_menu_style_service._],[FloatMenuController]],this._config.override).forEach((d=>injector.add(d)))}_markDocAsFocused(){const currentService=this._injector.get(src.HCr),editorService=this._injector.get(editor_manager_service.I);try{const doc=currentService.getCurrentUnitForType(src.Zy$.UNIVER_DOC);if(!doc)return;const id=doc.getUnitId();editorService.isEditor(id)||currentService.focusUnit(doc.getUnitId())}catch(err){this._logService.warn(err)}}_initUI(){this._injector.get(AppUIController)}_initRenderBasics(){[[docs_src.EX],[doc_selection_render_service.q],[docs_src.Tu],[DocPageLayoutService],[DocIMEInputManagerService],[DocRenderController],[DocZoomRenderController]].forEach((m=>{this._renderManagerSrv.registerRenderModule(src.Zy$.UNIVER_DOC,m)}))}_initRenderModules(){[[DocEventManagerService],[DocBackScrollRenderController],[DocSelectionRenderController],[doc_header_footer_controller.d],[DocResizeRenderController],[DocContextMenuRenderController],[DocChecklistRenderController],[DocClipboardController],[DocInputController],[DocIMEInputController],[DocEditorBridgeController]].forEach((m=>{this._renderManagerSrv.registerRenderModule(src.Zy$.UNIVER_DOC,m)}))}}UniverDocsUIPlugin=function docs_ui_plugin_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([(0,src.dCC)(engine_render_src.tLc),docs_ui_plugin_ts_param(1,(0,src.y_5)(src.zZn)),docs_ui_plugin_ts_param(2,engine_render_src.cSx),docs_ui_plugin_ts_param(3,src.wTY),docs_ui_plugin_ts_param(4,src.rrK),docs_ui_plugin_ts_param(5,src.J0C),docs_ui_plugin_ts_metadata("design:type",Function),docs_ui_plugin_ts_metadata("design:paramtypes",["undefined"==typeof Partial?Object:Partial,void 0===src.zZn?Object:src.zZn,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===src.wTY?Object:src.wTY,void 0===src.rrK?Object:src.rrK,void 0===src.J0C?Object:src.J0C])],UniverDocsUIPlugin);__webpack_require__("../../packages/docs-ui/src/services/clipboard/html-to-udm/paste-plugins/plugin-lark.ts"),__webpack_require__("../../packages/docs-ui/src/services/clipboard/html-to-udm/paste-plugins/plugin-univer.ts"),__webpack_require__("../../packages/docs-ui/src/services/clipboard/html-to-udm/paste-plugins/plugin-word.ts"),__webpack_require__("../../packages/docs-ui/src/services/editor/editor.ts"),__webpack_require__("../../packages/docs-ui/src/services/selection/rect-range.ts");var selection_utils=__webpack_require__("../../packages/docs-ui/src/services/selection/selection-utils.ts");function getEditorObject(unitId,renderManagerService){if(null==unitId)return;const currentRender=renderManagerService.getRenderById(unitId);if(null==currentRender)return;const{mainComponent,scene,engine,components}=currentRender;return{document:mainComponent,docBackground:components.get(docs_view_key.C9.BACKGROUND),scene,engine}}const SHEET_ZOOM_RANGE=[10,400];var SHEET_VIEW_KEY=function(SHEET_VIEW_KEY){return SHEET_VIEW_KEY.MAIN="__SpreadsheetRender__",SHEET_VIEW_KEY.ROW="__SpreadsheetRowHeader__",SHEET_VIEW_KEY.COLUMN="__SpreadsheetColumnHeader__",SHEET_VIEW_KEY.LEFT_TOP="__SpreadsheetLeftTopPlaceholder__",SHEET_VIEW_KEY}({});const SetRowHeaderWidthCommand={id:"sheet.command.set-row-header-width",type:src.g4t.COMMAND,handler:async(accessor,params)=>{if(!params)return!1;const renderManagerSrv=accessor.get(engine_render_src.cSx);if(!renderManagerSrv)return!1;const{unitId,subUnitId,size}=params,render=renderManagerSrv.getRenderById(unitId);if(render){renderManagerSrv.getRenderById(unitId).with(sheet_skeleton_manager_service_SheetSkeletonManagerService).setRowHeaderSize(render,subUnitId,size);const{components}=render,renderComponent=components.get(SHEET_VIEW_KEY.ROW);renderComponent&&renderComponent.setCustomHeader({headerStyle:{size}})}return!0}},SetColumnHeaderHeightCommand={id:"sheet.command.set-col-header-height",type:src.g4t.COMMAND,handler:async(accessor,params)=>{if(!params)return!1;const renderManagerSrv=accessor.get(engine_render_src.cSx);if(!renderManagerSrv)return!1;const{unitId,subUnitId,size}=params,render=renderManagerSrv.getRenderById(unitId);if(render){renderManagerSrv.getRenderById(unitId).with(sheet_skeleton_manager_service_SheetSkeletonManagerService).setColumnHeaderSize(render,subUnitId,size);const{components}=render,renderComponent=components.get(SHEET_VIEW_KEY.COLUMN);renderComponent&&renderComponent.setCustomHeader({headerStyle:{size}})}return!0}},RANGE_MOVE_PERMISSION_CHECK=(0,src.nwg)("rangeMovePermissionCheck"),RANGE_FILL_PERMISSION_CHECK=(0,src.nwg)("rangeFillPermissionCheck");var SELECTION_SHAPE_DEPTH=function(SELECTION_SHAPE_DEPTH){return SELECTION_SHAPE_DEPTH[SELECTION_SHAPE_DEPTH.FORMULA_EDITOR_SHOW=100]="FORMULA_EDITOR_SHOW",SELECTION_SHAPE_DEPTH[SELECTION_SHAPE_DEPTH.MARK_SELECTION=1e4]="MARK_SELECTION",SELECTION_SHAPE_DEPTH}({});function genNormalSelectionStyle(themeService){const styleSheet=themeService.getCurrentTheme(),fill=new src.mKL(styleSheet.primaryColor).setAlpha(.07).toRgbString();return{strokeWidth:1,stroke:styleSheet.primaryColor,fill,widgets:{},widgetSize:6,widgetStrokeWidth:1,widgetStroke:styleSheet.colorWhite,autofillSize:6,autofillStrokeWidth:1,autofillStroke:styleSheet.colorWhite,rowHeaderFill:fill,rowHeaderStroke:styleSheet.primaryColor,rowHeaderStrokeWidth:1,columnHeaderFill:fill,columnHeaderStroke:styleSheet.primaryColor,columnHeaderStrokeWidth:1,expandCornerSize:40}}class SelectionRenderModel{constructor(){this._startColumn=-1,this._startRow=-1,this._endColumn=-1,this._endRow=-1,this._startX=0,this._startY=0,this._endX=0,this._endY=0,this._rangeType=src.$uV.NORMAL}get startColumn(){return this._startColumn}get startRow(){return this._startRow}get endColumn(){return this._endColumn}get endRow(){return this._endRow}get startX(){return this._startX}get startY(){return this._startY}get endX(){return this._endX}get endY(){return this._endY}get currentCell(){return this._primary}get rangeType(){return this._rangeType}isEqual(rangeWithCoord){const{startColumn,startRow,endColumn,endRow}=this,{startColumn:newStartColumn,startRow:newStartRow,endColumn:newEndColumn,endRow:newEndRow}=rangeWithCoord;return startColumn===newStartColumn&&startRow===newStartRow&&endColumn===newEndColumn&&endRow===newEndRow}highlightToSelection(){if(this._primary)return(0,src.mRw)(this._primary)}getRange(){return{startColumn:this._startColumn,startRow:this._startRow,endColumn:this._endColumn,endRow:this._endRow,startX:this._startX,startY:this._startY,endX:this._endX,endY:this._endY,rangeType:this.rangeType}}getCell(){return this._primary}getRangeType(){return this._rangeType}setRangeType(rangeType){this._rangeType=rangeType}getValue(){return{rangeWithCoord:this.getRange(),primaryWithCoord:this._primary}}setValue(newSelectionRange,currentCell){const{startColumn,startRow,endColumn,endRow,startX,startY,endX,endY,rangeType}=newSelectionRange;this._startColumn=startColumn,this._startRow=startRow,this._endColumn=endColumn,this._endRow=endRow,this._startX=startX,this._startY=startY,this._endX=endX,this._endY=endY,void 0!==rangeType&&(this._rangeType=rangeType),void 0!==currentCell&&this.setCurrentCell(currentCell)}setCurrentCell(currentCell){this._primary=currentCell}clearCurrentCell(){this._primary=null}}function util_attachRangeWithCoord(skeleton,range){const{startRow,startColumn,endRow,endColumn,rangeType}=range,_startRow=endRow<startRow?endRow:startRow,_endRow=endRow<startRow?startRow:endRow,_startColumn=endColumn<startColumn?endColumn:startColumn,_endColumn=endColumn<startColumn?startColumn:endColumn,startCell=skeleton.getNoMergeCellWithCoordByIndex(_startRow,_startColumn),endCell=skeleton.getNoMergeCellWithCoordByIndex(_endRow,_endColumn);return{startRow,startColumn,endRow,endColumn,rangeType,startY:startCell?.startY||0,endY:endCell?.endY||0,startX:startCell?.startX||0,endX:endCell?.endX||0}}function attachSelectionWithCoord(selection,skeleton){const{range,primary,style}=selection;return{rangeWithCoord:util_attachRangeWithCoord(skeleton,range),primaryWithCoord:primary?attachPrimaryWithCoord(skeleton,primary):primary,style}}function attachPrimaryWithCoord(skeleton,primary){const{actualRow,actualColumn,isMerged,isMergedMainCell,startRow,startColumn,endRow,endColumn}=primary,cellPosition=skeleton.getNoMergeCellWithCoordByIndex(actualRow,actualColumn),startCell=skeleton.getNoMergeCellWithCoordByIndex(startRow,startColumn),endCell=skeleton.getNoMergeCellWithCoordByIndex(endRow,endColumn);return{actualRow,actualColumn,isMerged,isMergedMainCell,startX:cellPosition.startX,startY:cellPosition.startY,endX:cellPosition.endX,endY:cellPosition.endY,mergeInfo:{startRow,startColumn,endRow,endColumn,startY:startCell?.startY||0,endY:endCell?.endY||0,startX:startCell?.startX||0,endX:endCell?.endX||0}}}class SelectionShapeExtension{constructor(_control,options){this._control=_control,this._startOffsetX=0,this._startOffsetY=0,this._relativeSelectionPositionRow=0,this._relativeSelectionPositionColumn=0,this._relativeSelectionRowLength=0,this._relativeSelectionColumnLength=0,this._targetSelection={startY:0,endY:0,startX:0,endX:0,startRow:-1,endRow:-1,startColumn:-1,endColumn:-1},this._isInMergeState=!1,this._fillControlColors=[],this._skeleton=options.skeleton,this._scene=options.scene,this._themeService=options.themeService,this._injector=options.injector,this._selectionHooks=options.selectionHooks,this._initialControl(),this._initialWidget(),this._initialAutoFill(),this._control.dispose$.subscribe((()=>{this.dispose()}))}get isHelperSelection(){return this._control.isHelperSelection}dispose(){this._scrollTimer?.dispose(),this._fillControlColors=[],this._clearObserverEvent(),this._helperSelection?.dispose()}_getFreeze(){const freeze=(0,engine_render_src.KMz)(src.Zy$.UNIVER_SHEET,sheet_skeleton_manager_service_SheetSkeletonManagerService,this._injector.get(src.HCr),this._injector.get(engine_render_src.cSx))?.getCurrentParam()?.skeleton.getWorksheetConfig().freeze;return freeze}_isSelectionInViewport(selection,viewport){const freeze=this._getFreeze()||{startRow:-1,startColumn:-1,xSplit:0,ySplit:0};switch(viewport.viewportKey){case engine_render_src.p3k.VIEW_MAIN:return selection.endRow>=freeze.startRow&&selection.endColumn>=freeze.startColumn;case engine_render_src.p3k.VIEW_MAIN_TOP:case engine_render_src.p3k.VIEW_COLUMN_RIGHT:return selection.endColumn>=freeze.startColumn&&selection.startRow<freeze.startRow;case engine_render_src.p3k.VIEW_MAIN_LEFT:case engine_render_src.p3k.VIEW_ROW_BOTTOM:return selection.endRow>=freeze.startRow&&selection.startColumn<freeze.startColumn;case engine_render_src.p3k.VIEW_MAIN_LEFT_TOP:case engine_render_src.p3k.VIEW_COLUMN_LEFT:case engine_render_src.p3k.VIEW_ROW_TOP:case engine_render_src.p3k.VIEW_LEFT_TOP:return selection.startRow<freeze.startRow&&selection.startColumn<freeze.startColumn}}_clearObserverEvent(){this._scenePointerMoveSub?.unsubscribe(),this._scenePointerUpSub?.unsubscribe(),this._scenePointerMoveSub=null,this._scenePointerUpSub=null}_initialControl(){const{leftControl,rightControl,topControl,bottomControl}=this._control;[leftControl,rightControl,topControl,bottomControl].forEach((control=>{control.onPointerEnter$.subscribeEvent((()=>{const permissionCheck=this._injector.get(ISheetSelectionRenderService,src.Q1r.OPTIONAL)?.interceptor.fetchThroughInterceptors(RANGE_MOVE_PERMISSION_CHECK)(!1,null);!1!==permissionCheck&&control.setCursor(engine_render_src.MBo.MOVE)})),control.onPointerLeave$.subscribeEvent((()=>{control.resetCursor()})),control.onPointerDown$.subscribeEvent(this._controlPointerDownHandler.bind(this))}))}_controlMoving(moveOffsetX,moveOffsetY){const scene=this._scene,scrollXY=scene.getScrollXYInfoByViewport(engine_render_src.I9Y.FromArray([moveOffsetX,moveOffsetY])),{scaleX,scaleY}=scene.getAncestorScale(),actualCellIndex=this._skeleton.getCellIndexByOffset(moveOffsetX,moveOffsetY,scaleX,scaleY,scrollXY),{row,column}=actualCellIndex,maxRow=this._skeleton.getRowCount()-1,maxColumn=this._skeleton.getColumnCount()-1;let startRow=Math.max(0,row+this._relativeSelectionPositionRow),endRow=startRow+this._relativeSelectionRowLength;endRow>maxRow&&(endRow=maxRow,endRow-startRow<this._relativeSelectionRowLength&&(startRow=endRow-this._relativeSelectionRowLength));let startColumn=Math.max(0,column+this._relativeSelectionPositionColumn),endColumn=startColumn+this._relativeSelectionColumnLength;endColumn>maxColumn&&(endColumn=maxColumn,endColumn-startColumn<this._relativeSelectionColumnLength&&(startColumn=endColumn-this._relativeSelectionColumnLength));const selectionWithCoord=attachSelectionWithCoord({range:{startRow,endRow,startColumn,endColumn},primary:this._skeleton.worksheet.getCellInfoInMergeData(startRow,startColumn),style:null},this._skeleton),startCell=this._skeleton.getNoMergeCellWithCoordByIndex(startRow,startColumn),endCell=this._skeleton.getNoMergeCellWithCoordByIndex(endRow,endColumn),startY=startCell?.startY||0,endY=endCell?.endY||0,startX=startCell?.startX||0,endX=endCell?.endX||0;this._helperSelection?.transformByState({left:startX,top:startY,width:endX-startX,height:endY-startY}),this._targetSelection={...selectionWithCoord.rangeWithCoord},this._control.selectionMoving$.next(selectionWithCoord.rangeWithCoord)}_controlPointerDownHandler(evt){const{offsetX:evtOffsetX,offsetY:evtOffsetY}=evt,scene=this._scene,relativeCoords=scene.getCoordRelativeToViewport(engine_render_src.I9Y.FromArray([evtOffsetX,evtOffsetY])),{x:newEvtOffsetX,y:newEvtOffsetY}=relativeCoords,scrollXY=scene.getScrollXYInfoByViewport(relativeCoords),{scaleX,scaleY}=scene.getAncestorScale(),actualSelection=this._skeleton.getCellIndexByOffset(newEvtOffsetX,newEvtOffsetY,scaleX,scaleY,scrollXY);this._startOffsetX=newEvtOffsetX,this._startOffsetY=newEvtOffsetY;const{row,column}=actualSelection,{startRow:originStartRow,startColumn:originStartColumn,endRow:originEndRow,endColumn:originEndColumn}=this._control.model;let fixRow=0,fixColumn=0;row<originStartRow?fixRow-=1:row>originEndRow&&(fixRow+=1),column<originStartColumn?fixColumn-=1:column>originEndColumn&&(fixColumn+=1),this._relativeSelectionPositionRow=originStartRow-row+fixRow,this._relativeSelectionPositionColumn=originStartColumn-column+fixColumn,this._relativeSelectionRowLength=originEndRow-originStartRow,this._relativeSelectionColumnLength=originEndColumn-originStartColumn;const style=this._control.currentStyle,scale=this._getScale();this.isHelperSelection&&(this._helperSelection=new engine_render_src.rwV("__SpreadsheetHelperSelectionTempRect",{stroke:style.stroke,strokeWidth:style.strokeWidth/scale}),scene.addObject(this._helperSelection));const viewMain=scene.getViewport(engine_render_src.p3k.VIEW_MAIN),scrollTimer=engine_render_src.Vui.create(scene);this._scrollTimer=scrollTimer,scrollTimer.startScroll(newEvtOffsetX,newEvtOffsetY,viewMain),scene.disableObjectsEvent(),this._scenePointerMoveSub=scene.onPointerMove$.subscribeEvent((moveEvt=>{const{offsetX:moveOffsetX,offsetY:moveOffsetY}=moveEvt,permissionCheck=this._injector.get(ISheetSelectionRenderService,src.Q1r.OPTIONAL)?.interceptor.fetchThroughInterceptors(RANGE_MOVE_PERMISSION_CHECK)(!1,null);if(!1===permissionCheck)return;const{x:newMoveOffsetX,y:newMoveOffsetY}=scene.getCoordRelativeToViewport(engine_render_src.I9Y.FromArray([moveOffsetX,moveOffsetY]));this._controlMoving(newMoveOffsetX,newMoveOffsetY),scene.setCursor(engine_render_src.MBo.MOVE),scrollTimer.scrolling(newMoveOffsetX,newMoveOffsetY,(()=>{this._controlMoving(newMoveOffsetX,newMoveOffsetY)}))})),this._scenePointerUpSub=scene.onPointerUp$.subscribeEvent((()=>{this._helperSelection?.dispose();const scene=this._scene;scene.resetCursor(),this._clearObserverEvent(),scene.enableObjectsEvent(),this._scrollTimer?.dispose(),this._control.selectionMoveEnd$.next(this._targetSelection),this._selectionHooks.selectionMoveEnd?.()}))}_initialWidget(){const{topLeftWidget,topCenterWidget,topRightWidget,middleLeftWidget,middleRightWidget,bottomLeftWidget,bottomCenterWidget,bottomRightWidget}=this._control,cursors=[engine_render_src.MBo.NORTH_WEST_RESIZE,engine_render_src.MBo.NORTH_RESIZE,engine_render_src.MBo.NORTH_EAST_RESIZE,engine_render_src.MBo.WEST_RESIZE,engine_render_src.MBo.EAST_RESIZE,engine_render_src.MBo.SOUTH_WEST_RESIZE,engine_render_src.MBo.SOUTH_RESIZE,engine_render_src.MBo.SOUTH_EAST_RESIZE];[topLeftWidget,topCenterWidget,topRightWidget,middleLeftWidget,middleRightWidget,bottomLeftWidget,bottomCenterWidget,bottomRightWidget].forEach(((control,index)=>{control.onPointerEnter$.subscribeEvent((()=>{control.setCursor(cursors[index])})),control.onPointerLeave$.subscribeEvent((()=>{control.resetCursor()})),control.onPointerDown$.subscribeEvent((evt=>{this._widgetPointerDownEvent(evt,cursors[index])}))}))}_widgetPointerDownEvent(evt,cursor){const scene=this._scene,{offsetX:evtOffsetX,offsetY:evtOffsetY}=evt,relativeCoords=scene.getCoordRelativeToViewport(engine_render_src.I9Y.FromArray([evtOffsetX,evtOffsetY])),{x:newEvtOffsetX,y:newEvtOffsetY}=relativeCoords;this._startOffsetX=evtOffsetX,this._startOffsetY=evtOffsetY;const{startRow:originStartRow,startColumn:originStartColumn,endRow:originEndRow,endColumn:originEndColumn}=this._control.model,startRow=Math.min(originStartRow,originEndRow),startColumn=Math.min(originStartColumn,originEndColumn),endRow=Math.max(originStartRow,originEndRow),endColumn=Math.max(originStartColumn,originEndColumn);this._relativeSelectionPositionRow=startRow,this._relativeSelectionPositionColumn=startColumn,this._relativeSelectionRowLength=endRow-startRow,this._relativeSelectionColumnLength=endColumn-startColumn,cursor===engine_render_src.MBo.NORTH_WEST_RESIZE?(this._relativeSelectionPositionRow=endRow,this._relativeSelectionPositionColumn=endColumn):cursor===engine_render_src.MBo.NORTH_RESIZE||cursor===engine_render_src.MBo.NORTH_EAST_RESIZE?this._relativeSelectionPositionRow=endRow:cursor===engine_render_src.MBo.WEST_RESIZE||cursor===engine_render_src.MBo.SOUTH_WEST_RESIZE?this._relativeSelectionPositionColumn=endColumn:cursor===engine_render_src.MBo.SOUTH_RESIZE&&(this._relativeSelectionPositionRow=startRow);const scrollTimer=engine_render_src.Vui.create(scene),viewMain=scene.getViewport(engine_render_src.p3k.VIEW_MAIN);scrollTimer.startScroll(newEvtOffsetX,newEvtOffsetY,viewMain),this._scrollTimer=scrollTimer,scene.disableObjectsEvent(),this._scenePointerMoveSub=scene.onPointerMove$.subscribeEvent((moveEvt=>{const{offsetX:moveOffsetX,offsetY:moveOffsetY}=moveEvt,{x:newMoveOffsetX,y:newMoveOffsetY}=scene.getCoordRelativeToViewport(engine_render_src.I9Y.FromArray([moveOffsetX,moveOffsetY]));this._widgetMoving(newMoveOffsetX,newMoveOffsetY,cursor),scene.setCursor(cursor),scrollTimer.scrolling(newMoveOffsetX,newMoveOffsetY,(()=>{this._widgetMoving(newMoveOffsetX,newMoveOffsetY,cursor)}))})),this._scenePointerUpSub=scene.onPointerUp$.subscribeEvent((()=>{const scene=this._scene;scene.resetCursor(),this._clearObserverEvent(),scene.enableObjectsEvent(),this._scrollTimer?.dispose(),this._control.selectionScaled$.next(this._targetSelection),this._selectionHooks.selectionMoveEnd?.()}))}_widgetMoving(moveOffsetX,moveOffsetY,cursor){const scene=this._scene,scrollXY=scene.getScrollXYInfoByViewport(engine_render_src.I9Y.FromArray([this._startOffsetX,this._startOffsetY])),{scaleX,scaleY}=scene.getAncestorScale(),moveActualSelection=this._skeleton.getCellIndexByOffset(moveOffsetX,moveOffsetY,scaleX,scaleY,scrollXY),{row,column}=moveActualSelection;let startRow=this._relativeSelectionPositionRow,startColumn=this._relativeSelectionPositionColumn,endRow=row,endColumn=column;cursor===engine_render_src.MBo.NORTH_WEST_RESIZE?(startRow=row,startColumn=column,endRow=this._relativeSelectionPositionRow,endColumn=this._relativeSelectionPositionColumn):cursor===engine_render_src.MBo.NORTH_RESIZE?(startRow=row,startColumn=this._relativeSelectionPositionColumn,endRow=this._relativeSelectionPositionRow,endColumn=this._relativeSelectionPositionColumn+this._relativeSelectionColumnLength):cursor===engine_render_src.MBo.NORTH_EAST_RESIZE?(startRow=row,startColumn=this._relativeSelectionPositionColumn,endRow=this._relativeSelectionPositionRow,endColumn=column):cursor===engine_render_src.MBo.WEST_RESIZE?(startRow=this._relativeSelectionPositionRow,startColumn=column,endRow=this._relativeSelectionPositionRow+this._relativeSelectionRowLength,endColumn=this._relativeSelectionPositionColumn):cursor===engine_render_src.MBo.EAST_RESIZE?endRow=this._relativeSelectionPositionRow+this._relativeSelectionRowLength:cursor===engine_render_src.MBo.SOUTH_WEST_RESIZE?(startRow=this._relativeSelectionPositionRow,startColumn=column,endRow=row,endColumn=this._relativeSelectionPositionColumn):cursor===engine_render_src.MBo.SOUTH_RESIZE&&(startRow=this._relativeSelectionPositionRow,startColumn=this._relativeSelectionPositionColumn,endRow=row,endColumn=this._relativeSelectionPositionColumn+this._relativeSelectionColumnLength);const selectionRangeWithCoord=attachSelectionWithCoord({range:this._swapPositions(startRow,startColumn,endRow,endColumn),primary:this._skeleton.getCellWithMergeInfoByIndex(startRow,startColumn),style:null},this._skeleton);this._targetSelection={...selectionRangeWithCoord.rangeWithCoord},this._control.updateRangeBySelectionWithCoord(selectionRangeWithCoord),this._control.selectionScaling$.next(this._targetSelection)}_initialAutoFill(){const{fillControl}=this._control;fillControl.onPointerEnter$.subscribeEvent((evt=>{this._injector.get(ISheetSelectionRenderService).interceptor.fetchThroughInterceptors(RANGE_FILL_PERMISSION_CHECK)(!1,{x:evt.offsetX,y:evt.offsetY,skeleton:this._skeleton,scene:this._scene})&&fillControl.setCursor(engine_render_src.MBo.CROSSHAIR)})),fillControl.onPointerLeave$.subscribeEvent((()=>{fillControl.resetCursor()})),fillControl.onPointerDown$.subscribeEvent(this._autoFillForPointerdown.bind(this))}_autoFillMoving(moveOffsetX,moveOffsetY){const scene=this._scene,scrollXY=scene.getViewportScrollXY(this._activeViewport),{scaleX,scaleY}=scene.getAncestorScale(),moveActualSelection=this._skeleton.getCellIndexByOffset(moveOffsetX,moveOffsetY,scaleX,scaleY,scrollXY),{row,column}=moveActualSelection,moveRelativeCoords=scene.getCoordRelativeToViewport(engine_render_src.I9Y.FromArray([moveOffsetX,moveOffsetY])),maxRow=this._skeleton.getRowCount()-1,maxColumn=this._skeleton.getColumnCount()-1;let startRow=this._relativeSelectionPositionRow,startColumn=this._relativeSelectionPositionColumn,endRow=this._relativeSelectionPositionRow+this._relativeSelectionRowLength,endColumn=this._relativeSelectionPositionColumn+this._relativeSelectionColumnLength,isLighten=!1,isRowDropping=!0;if((column<startColumn||column>endColumn)&&row>=startRow&&row<=endRow){const rulerValue=this._fillRuler(column,startColumn,endColumn,this._relativeSelectionColumnLength,maxColumn);startColumn=rulerValue.startRowOrColumn,endColumn=rulerValue.endRowOrColumn,isLighten=rulerValue.isLighten,isRowDropping=!1}else if((row<startRow||row>endRow)&&column>=startColumn&&column<=endColumn){const rulerValue=this._fillRuler(row,startRow,endRow,this._relativeSelectionRowLength,maxRow);startRow=rulerValue.startRowOrColumn,endRow=rulerValue.endRowOrColumn,isLighten=rulerValue.isLighten}else if(Math.abs(this._startOffsetX-moveRelativeCoords.x-scrollXY.x)/2>Math.abs(this._startOffsetY-moveRelativeCoords.y-scrollXY.y)){const rulerValue=this._fillRuler(column,startColumn,endColumn,this._relativeSelectionColumnLength,maxColumn);startColumn=rulerValue.startRowOrColumn,endColumn=rulerValue.endRowOrColumn,isLighten=rulerValue.isLighten,isRowDropping=!1}else{const rulerValue=this._fillRuler(row,startRow,endRow,this._relativeSelectionRowLength,maxRow);startRow=rulerValue.startRowOrColumn,endRow=rulerValue.endRowOrColumn,isLighten=rulerValue.isLighten}const startCell=this._skeleton.getNoMergeCellWithCoordByIndex(startRow,startColumn),endCell=this._skeleton.getNoMergeCellWithCoordByIndex(endRow,endColumn),startY=startCell?.startY||0,endY=endCell?.endY||0,startX=startCell?.startX||0,endX=endCell?.endX||0;isLighten?this._controlHandler(((o,index)=>{const newColor=new src.mKL(this._fillControlColors[index]).lighten(35).toRgbString();o.setProps({fill:newColor})})):this._controlHandler(((o,index)=>{o.setProps({fill:this._fillControlColors[index]})}));const SELECTION_CONTROL_BORDER_BUFFER_WIDTH_SCALE=sheets_src.ybH/this._getScale();startRow===endRow&&!0===isRowDropping||startColumn===endColumn&&!1===isRowDropping?this._helperSelection?.hide():(this._helperSelection?.transformByState({left:startX-SELECTION_CONTROL_BORDER_BUFFER_WIDTH_SCALE/2,top:startY-SELECTION_CONTROL_BORDER_BUFFER_WIDTH_SCALE/2,width:endX-startX,height:endY-startY}),this._helperSelection?.show()),this._targetSelection={startY,endY,startX,endX,startRow,endRow,startColumn,endColumn},this._control.selectionFilling$.next(this._targetSelection)}_autoFillForPointerdown(evt){const{offsetX:evtOffsetX,offsetY:evtOffsetY}=evt,scene=this._scene,relativeCoords=scene.getCoordRelativeToViewport(engine_render_src.I9Y.FromArray([evtOffsetX,evtOffsetY])),{x:newEvtOffsetX,y:newEvtOffsetY}=relativeCoords;this._startOffsetX=newEvtOffsetX,this._startOffsetY=newEvtOffsetY;const{startRow:originStartRow,startColumn:originStartColumn,endRow:originEndRow,endColumn:originEndColumn}=this._control.model;this._isInMergeState=this._hasMergeInRange(originStartRow,originStartColumn,originEndRow,originEndColumn),this._relativeSelectionPositionRow=originStartRow,this._relativeSelectionPositionColumn=originStartColumn,this._relativeSelectionRowLength=originEndRow-originStartRow,this._relativeSelectionColumnLength=originEndColumn-originStartColumn;const style=this._control.currentStyle;let stroke=style?.stroke,strokeWidth=style?.strokeWidth;const defaultStyle=genNormalSelectionStyle(this._themeService);null==stroke&&(stroke=defaultStyle.stroke),null==strokeWidth&&(strokeWidth=defaultStyle.strokeWidth);const scale=this._getScale();strokeWidth/=scale;const SELECTION_CONTROL_BORDER_BUFFER_WIDTH_SCALE=sheets_src.ybH/scale,darkenColor=new src.mKL(stroke).darken(2).toRgbString();this.isHelperSelection&&(this._helperSelection=new engine_render_src.rwV("__SpreadsheetHelperSelectionTempRect",{stroke:darkenColor,strokeWidth:strokeWidth+SELECTION_CONTROL_BORDER_BUFFER_WIDTH_SCALE/2}),scene.addObject(this._helperSelection)),this._activeViewport=scene.getActiveViewportByCoord(engine_render_src.I9Y.FromArray([evtOffsetX,evtOffsetY]));const viewportMain=scene.getViewport(engine_render_src.p3k.VIEW_MAIN),scrollTimer=engine_render_src.Vui.create(scene,this._activeViewport.viewportKey===engine_render_src.p3k.VIEW_MAIN?engine_render_src.rDM.ALL:engine_render_src.rDM.NONE);scrollTimer.startScroll(newEvtOffsetX,newEvtOffsetY,viewportMain),this._scrollTimer=scrollTimer,scene.disableObjectsEvent(),this._controlHandler((o=>{this._fillControlColors.push(o.fill)})),this._scenePointerMoveSub=scene.onPointerMove$.subscribeEvent((moveEvt=>{const{offsetX:moveOffsetX,offsetY:moveOffsetY}=moveEvt,currentViewport=scene.getActiveViewportByCoord(engine_render_src.I9Y.FromArray([moveOffsetX,moveOffsetY]));if(!this._injector.get(ISheetSelectionRenderService).interceptor.fetchThroughInterceptors(RANGE_FILL_PERMISSION_CHECK)(!1,{x:evt.offsetX,y:evt.offsetY,skeleton:this._skeleton,scene:this._scene}))return;const{x:newMoveOffsetX,y:newMoveOffsetY}=scene.getCoordRelativeToViewport(engine_render_src.I9Y.FromArray([moveOffsetX,moveOffsetY]));this._autoFillMoving(newMoveOffsetX,newMoveOffsetY),scene.setCursor(engine_render_src.MBo.CROSSHAIR);const newSelection=this._targetSelection;if(viewportMain&&currentViewport&&this._activeViewport?.viewportKey!==currentViewport?.viewportKey){let movingRange;newSelection.startRow!==originStartRow?(scrollTimer.scrollTimerType=engine_render_src.rDM.Y,movingRange={...newSelection,endRow:newSelection.startRow}):newSelection.endRow!==originEndRow?(scrollTimer.scrollTimerType=engine_render_src.rDM.Y,movingRange={...newSelection,startRow:newSelection.endRow}):newSelection.startColumn!==originStartColumn?(scrollTimer.scrollTimerType=engine_render_src.rDM.X,movingRange={...newSelection,endColumn:newSelection.startColumn}):(scrollTimer.scrollTimerType=engine_render_src.rDM.X,movingRange={...newSelection,startColumn:newSelection.endColumn}),this._isSelectionInViewport(movingRange,currentViewport)&&(viewportMain.scrollToBarPos({x:scrollTimer.scrollTimerType===engine_render_src.rDM.X?0:void 0,y:scrollTimer.scrollTimerType===engine_render_src.rDM.Y?0:void 0}),this._activeViewport=currentViewport)}scrollTimer.scrolling(newMoveOffsetX,newMoveOffsetY,(()=>{this._autoFillMoving(newMoveOffsetX,newMoveOffsetY)}))})),this._scenePointerUpSub=scene.onPointerUp$.subscribeEvent((()=>{this._helperSelection?.dispose();const scene=this._scene;scene.resetCursor(),this._clearObserverEvent(),scene.enableObjectsEvent(),this._scrollTimer?.dispose(),this._control.refreshSelectionFilled(this._targetSelection),this._isInMergeState=!1,this._controlHandler(((o,index)=>{o.setProps({fill:this._fillControlColors[index]})})),this._fillControlColors=[]}))}_hasMergeInRange(startRow,startColumn,endRow,endColumn){return this._skeleton.worksheet.getMergedCellRange(startRow,startColumn,endRow,endColumn).length>0}_swapPositions(startRow,startColumn,endRow,endColumn){return{startRow:Math.min(startRow,endRow),startColumn:Math.min(startColumn,endColumn),endRow:Math.max(startRow,endRow),endColumn:Math.max(startColumn,endColumn)}}_controlHandler(func){const{leftControl,rightControl,topControl,bottomControl,backgroundControlTop,backgroundControlMiddleLeft,backgroundControlMiddleRight,backgroundControlBottom,fillControl}=this._control,objects=[leftControl,rightControl,topControl,bottomControl,backgroundControlTop,backgroundControlMiddleLeft,backgroundControlMiddleRight,backgroundControlBottom,fillControl];for(let i=0,len=objects.length;i<len;i++){func(objects[i],i)}}_fillRuler(rowOrColumn,startRowOrColumn,endRowOrColumn,rowOrColumnLength,maxRowOrColumn){let isLighten=!1;if(rowOrColumn<startRowOrColumn)if(this._isInMergeState&&rowOrColumn<startRowOrColumn){const current=startRowOrColumn-rowOrColumn,rangeRowCount=rowOrColumnLength+1,step=Math.ceil(current/rangeRowCount);let newStartRow=startRowOrColumn-step*rangeRowCount;newStartRow<0&&(newStartRow=startRowOrColumn-(step-1)*rangeRowCount),startRowOrColumn=newStartRow}else startRowOrColumn=rowOrColumn;else if(rowOrColumn>=startRowOrColumn&&rowOrColumn<=endRowOrColumn)isLighten=!0,this._isInMergeState||(endRowOrColumn=rowOrColumn);else if(this._isInMergeState&&rowOrColumn>endRowOrColumn){const current=rowOrColumn-endRowOrColumn,rangeRowCount=rowOrColumnLength+1,step=Math.ceil(current/rangeRowCount);let newEndRow=endRowOrColumn+step*rangeRowCount;newEndRow>maxRowOrColumn&&(newEndRow=endRowOrColumn+(step-1)*rangeRowCount),endRowOrColumn=newEndRow}else endRowOrColumn=rowOrColumn;return{rowOrColumn,startRowOrColumn,endRowOrColumn,isLighten}}_getScale(){const{scaleX,scaleY}=this._scene.getAncestorScale();return Math.max(scaleX,scaleY)}}var SELECTION_MANAGER_KEY=function(SELECTION_MANAGER_KEY){return SELECTION_MANAGER_KEY.Selection="__SpreadsheetSelectionShape__",SELECTION_MANAGER_KEY.top="__SpreadsheetSelectionTopControl__",SELECTION_MANAGER_KEY.bottom="__SpreadsheetSelectionBottomControl__",SELECTION_MANAGER_KEY.left="__SpreadsheetSelectionShapeLeftControl__",SELECTION_MANAGER_KEY.right="__SpreadsheetSelectionShapeRightControl__",SELECTION_MANAGER_KEY.backgroundTop="__SpreadsheetSelectionBackgroundControlTop__",SELECTION_MANAGER_KEY.backgroundMiddleLeft="__SpreadsheetSelectionBackgroundControlMiddleLeft__",SELECTION_MANAGER_KEY.backgroundMiddleRight="__SpreadsheetSelectionBackgroundControlMiddleRight__",SELECTION_MANAGER_KEY.backgroundBottom="__SpreadsheetSelectionBackgroundControlBottom__",SELECTION_MANAGER_KEY.fill="__SpreadsheetSelectionFillControl__",SELECTION_MANAGER_KEY.fillTopLeft="__SpreadsheetSelectionFillControlTopLeft__",SELECTION_MANAGER_KEY.fillBottomRight="__SpreadsheetSelectionFillControlBottomRight__",SELECTION_MANAGER_KEY.fillTopLeftInner="__SpreadsheetSelectionFillControlTopLeftInner__",SELECTION_MANAGER_KEY.fillBottomRightInner="__SpreadsheetSelectionFillControlBottomRightInner__",SELECTION_MANAGER_KEY.lineMain="__SpreadsheetDragLineMainControl__",SELECTION_MANAGER_KEY.lineContent="__SpreadsheetDragLineContentControl__",SELECTION_MANAGER_KEY.line="__SpreadsheetDragLineControl__",SELECTION_MANAGER_KEY.dash="__SpreadsheetDragDashControl__",SELECTION_MANAGER_KEY.rowHeaderBackground="__SpreadSheetSelectionRowHeaderBackground__",SELECTION_MANAGER_KEY.rowHeaderBorder="__SpreadSheetSelectionRowHeaderBorder__",SELECTION_MANAGER_KEY.rowHeaderGroup="__SpreadSheetSelectionRowHeaderGroup__",SELECTION_MANAGER_KEY.columnHeaderBackground="__SpreadSheetSelectionColumnHeaderBackground__",SELECTION_MANAGER_KEY.columnHeaderBorder="__SpreadSheetSelectionColumnHeaderBorder__",SELECTION_MANAGER_KEY.columnHeaderGroup="__SpreadSheetSelectionColumnHeaderGroup__",SELECTION_MANAGER_KEY.topLeftWidget="__SpreadSheetSelectionTopLeftWidget__",SELECTION_MANAGER_KEY.topCenterWidget="__SpreadSheetSelectionTopCenterWidget__",SELECTION_MANAGER_KEY.topRightWidget="__SpreadSheetSelectionTopRightWidget__",SELECTION_MANAGER_KEY.middleLeftWidget="__SpreadSheetSelectionMiddleLeftWidget__",SELECTION_MANAGER_KEY.middleRightWidget="__SpreadSheetSelectionMiddleRightWidget__",SELECTION_MANAGER_KEY.bottomLeftWidget="__SpreadSheetSelectionBottomLeftWidget__",SELECTION_MANAGER_KEY.bottomCenterWidget="__SpreadSheetSelectionBottomCenterWidget__",SELECTION_MANAGER_KEY.bottomRightWidget="__SpreadSheetSelectionBottomRightWidget__",SELECTION_MANAGER_KEY}({});class SelectionControl extends src.jGt{constructor(_scene,_zIndex,_themeService,options){super(),this._scene=_scene,this._zIndex=_zIndex,this._themeService=_themeService,this._isHelperSelection=!0,this._enableAutoFill=!0,this._showAutoFill=!1,this._highlightHeader=!0,this._rowHeaderWidth=0,this._columnHeaderHeight=0,this._widgetRects=[],this._dispose$=new BehaviorSubject.t(this),this.dispose$=this._dispose$.asObservable(),this.selectionMoving$=new Subject.B,this.selectionMoveEnd$=new Subject.B,this.selectionScaling$=new Subject.B,this.selectionScaled$=new Subject.B,this.selectionFilling$=new Subject.B,this._selectionFilled$=new Subject.B,this.selectionFilled$=this._selectionFilled$.asObservable(),this._antLineOffset=0,this._antRequestNewFrame=-1,this._enableAutoFill=options?.enableAutoFill??!0,this._highlightHeader=options?.highlightHeader??!0,this._rowHeaderWidth=options?.rowHeaderWidth??0,this._columnHeaderHeight=options?.columnHeaderHeight??0,this._initializeSheetBody(),this._initialHeader()}_initializeSheetBody(){this._defaultStyle=genNormalSelectionStyle(this._themeService),this._currentStyle=genNormalSelectionStyle(this._themeService),this._selectionRenderModel=new SelectionRenderModel;const zIndex=this._zIndex;this._leftBorder=new engine_render_src.rwV("__SpreadsheetSelectionShapeLeftControl__"+zIndex,{zIndex}),this._rightBorder=new engine_render_src.rwV("__SpreadsheetSelectionShapeRightControl__"+zIndex,{zIndex}),this._topBorder=new engine_render_src.rwV("__SpreadsheetSelectionTopControl__"+zIndex,{zIndex}),this._bottomBorder=new engine_render_src.rwV("__SpreadsheetSelectionBottomControl__"+zIndex,{zIndex}),this._backgroundControlTop=new engine_render_src.rwV("__SpreadsheetSelectionBackgroundControlTop__"+zIndex,{zIndex:zIndex-1,evented:!1}),this._backgroundControlBottom=new engine_render_src.rwV("__SpreadsheetSelectionBackgroundControlBottom__"+zIndex,{zIndex:zIndex-1,evented:!1}),this._backgroundControlMiddleLeft=new engine_render_src.rwV("__SpreadsheetSelectionBackgroundControlMiddleLeft__"+zIndex,{zIndex:zIndex-1,evented:!1}),this._backgroundControlMiddleRight=new engine_render_src.rwV("__SpreadsheetSelectionBackgroundControlMiddleRight__"+zIndex,{zIndex:zIndex-1,evented:!1}),this._autoFillControl=new engine_render_src.rwV("__SpreadsheetSelectionFillControl__"+zIndex,{zIndex:zIndex+1}),this._autoFillControl.hide(),this._dashedRect=new engine_render_src.Kpr("__SpreadsheetDragDashControl__"+zIndex,{zIndex:zIndex+2,evented:!1,stroke:"#fff"});const shapes=[this._autoFillControl,this._leftBorder,this._rightBorder,this._topBorder,this._bottomBorder,this._backgroundControlTop,this._backgroundControlMiddleLeft,this._backgroundControlMiddleRight,this._backgroundControlBottom,this._dashedRect];this._widgetRects=this._initialWidget(),this._selectionShapeGroup=new engine_render_src.YJl("__SpreadsheetSelectionShape__"+zIndex,...shapes,...this._widgetRects),this._selectionShapeGroup.hide(),this._selectionShapeGroup.evented=!1,this._selectionShapeGroup.zIndex=zIndex;const scene=this.getScene();scene.addObject(this._selectionShapeGroup,1),this.disposeWithMe((0,src.saO)(scene.onTransformChange$.subscribeEvent((state=>{state.type===engine_render_src.FAP.scale&&(this._updateLayoutOfSelectionControl(this._currentStyle),this._updateControlCoord())}))))}_initialHeader(){const zIndex=this._zIndex;this._rowHeaderBackground=new engine_render_src.rwV("__SpreadSheetSelectionRowHeaderBackground__"+zIndex,{zIndex:zIndex-1,evented:!1}),this._rowHeaderBorder=new engine_render_src.rwV("__SpreadSheetSelectionRowHeaderBorder__"+zIndex,{zIndex:zIndex-1,evented:!1}),this._rowHeaderGroup=new engine_render_src.YJl("__SpreadSheetSelectionRowHeaderGroup__"+zIndex,this._rowHeaderBackground,this._rowHeaderBorder),this._rowHeaderGroup.hide(),this._rowHeaderGroup.evented=!1,this._rowHeaderGroup.zIndex=zIndex,this._columnHeaderBackground=new engine_render_src.rwV("__SpreadSheetSelectionColumnHeaderBackground__"+zIndex,{zIndex:zIndex-1,evented:!1}),this._columnHeaderBorder=new engine_render_src.rwV("__SpreadSheetSelectionColumnHeaderBorder__"+zIndex,{zIndex:zIndex-1,evented:!1}),this._columnHeaderGroup=new engine_render_src.YJl("__SpreadSheetSelectionColumnHeaderGroup__"+zIndex,this._columnHeaderBackground,this._columnHeaderBorder),this._columnHeaderGroup.hide(),this._columnHeaderGroup.evented=!1,this._columnHeaderGroup.zIndex=zIndex;this.getScene().addObjects([this._rowHeaderGroup,this._columnHeaderGroup],11)}_initialWidget(){const zIndex=this._zIndex;return this._topLeftWidget=new engine_render_src.rwV("__SpreadSheetSelectionTopLeftWidget__"+zIndex,{zIndex:zIndex+1}),this._topCenterWidget=new engine_render_src.rwV("__SpreadSheetSelectionTopCenterWidget__"+zIndex,{zIndex:zIndex+1}),this._topRightWidget=new engine_render_src.rwV("__SpreadSheetSelectionTopRightWidget__"+zIndex,{zIndex:zIndex+1}),this._middleLeftWidget=new engine_render_src.rwV("__SpreadSheetSelectionMiddleLeftWidget__"+zIndex,{zIndex:zIndex+1}),this._middleRightWidget=new engine_render_src.rwV("__SpreadSheetSelectionMiddleRightWidget__"+zIndex,{zIndex:zIndex+1}),this._bottomLeftWidget=new engine_render_src.rwV("__SpreadSheetSelectionBottomLeftWidget__"+zIndex,{zIndex:zIndex+1}),this._bottomCenterWidget=new engine_render_src.rwV("__SpreadSheetSelectionBottomCenterWidget__"+zIndex,{zIndex:zIndex+1}),this._bottomRightWidget=new engine_render_src.rwV("__SpreadSheetSelectionBottomRightWidget__"+zIndex,{zIndex:zIndex+1}),[this._topLeftWidget,this._topCenterWidget,this._topRightWidget,this._middleLeftWidget,this._middleRightWidget,this._bottomLeftWidget,this._bottomCenterWidget,this._bottomRightWidget]}get zIndex(){return this._zIndex}get leftControl(){return this._leftBorder}get rightControl(){return this._rightBorder}get topControl(){return this._topBorder}get bottomControl(){return this._bottomBorder}get fillControl(){return this._autoFillControl}get backgroundControlTop(){return this._backgroundControlTop}get backgroundControlBottom(){return this._backgroundControlBottom}get backgroundControlMiddleLeft(){return this._backgroundControlMiddleLeft}get backgroundControlMiddleRight(){return this._backgroundControlMiddleRight}get selectionShape(){return this._selectionShapeGroup}get columnHeaderGroup(){return this._columnHeaderGroup}get rowHeaderGroup(){return this._rowHeaderGroup}get selectionShapeGroup(){return this._selectionShapeGroup}get model(){return this._selectionRenderModel}get topLeftWidget(){return this._topLeftWidget}get topCenterWidget(){return this._topCenterWidget}get topRightWidget(){return this._topRightWidget}get middleLeftWidget(){return this._middleLeftWidget}get middleRightWidget(){return this._middleRightWidget}get bottomLeftWidget(){return this._bottomLeftWidget}get bottomCenterWidget(){return this._bottomCenterWidget}get bottomRightWidget(){return this._bottomRightWidget}get themeService(){return this._themeService}get selectionModel(){return this._selectionRenderModel}set selectionModel(model){this._selectionRenderModel=model}get currentStyle(){return this._currentStyle}set currentStyle(style){this._currentStyle=style}get dashedRect(){return this._dashedRect}get isHelperSelection(){return this._isHelperSelection}get rowHeaderWidth(){return this._rowHeaderWidth}set rowHeaderWidth(width){this._rowHeaderWidth=width}get columnHeaderHeight(){return this._columnHeaderHeight}set columnHeaderHeight(height){this._columnHeaderHeight=height}setControlExtension(options){this._controlExtension=new SelectionShapeExtension(this,options)}setEvent(state){this.leftControl.evented=state,this.rightControl.evented=state,this.topControl.evented=state,this.bottomControl.evented=state}refreshSelectionFilled(val){this._selectionFilled$.next(val)}_updateLayoutOfSelectionControl(selectionStyle){selectionStyle&&(this.currentStyle=Object.assign({},this._defaultStyle,selectionStyle));const currentStyle=this.currentStyle,{stroke,widgets,autofillStroke:AutofillStroke,strokeDash,isAnimationDash}=currentStyle;let autofillSize=currentStyle.autofillSize,strokeWidth=currentStyle.strokeWidth,autofillStrokeWidth=currentStyle.autofillStrokeWidth;const scale=this._getScale(),leftAdjustWidth=(strokeWidth+sheets_src.ybH)/2/scale;strokeWidth/=scale,autofillSize/=scale,autofillStrokeWidth/=scale<1?1:scale;const borderBuffer=sheets_src.ybH/scale,fixOnePixelBlurOffset=engine_render_src.e$m/scale,{startX,startY,endX,endY}=this._selectionRenderModel;if(this.leftControl.transformByState({height:endY-startY,left:-leftAdjustWidth+fixOnePixelBlurOffset,width:strokeWidth,strokeWidth:borderBuffer,top:-borderBuffer/2+fixOnePixelBlurOffset}),this.leftControl.setProps({fill:stroke,stroke:sheets_src.VwB}),this.rightControl.transformByState({height:endY-startY,left:endX-startX-leftAdjustWidth+fixOnePixelBlurOffset,width:strokeWidth,strokeWidth:borderBuffer,top:-borderBuffer/2+fixOnePixelBlurOffset}),this.rightControl.setProps({fill:stroke,stroke:sheets_src.VwB}),this.topControl.transformByState({width:endX-startX+strokeWidth,top:-leftAdjustWidth+fixOnePixelBlurOffset,left:-leftAdjustWidth+fixOnePixelBlurOffset,height:strokeWidth,strokeWidth:borderBuffer}),this.topControl.setProps({fill:stroke,stroke:sheets_src.VwB}),this.bottomControl.transformByState({width:endX-startX+strokeWidth,top:endY-startY-leftAdjustWidth+fixOnePixelBlurOffset,height:strokeWidth,left:-leftAdjustWidth+fixOnePixelBlurOffset,strokeWidth:borderBuffer}),this.bottomControl.setProps({fill:stroke,stroke:sheets_src.VwB}),null==strokeDash)this.dashedRect.hide(),this._stopAntLineAnimation();else{const dashRectBorderWidth=2*currentStyle.strokeWidth/scale;this.dashedRect.transformByState({height:endY-startY,width:endX-startX,strokeWidth:dashRectBorderWidth,left:-dashRectBorderWidth/2+fixOnePixelBlurOffset,top:-dashRectBorderWidth/2+fixOnePixelBlurOffset}),this.dashedRect.setProps({strokeDashArray:[0,strokeDash/scale]}),this._stopAntLineAnimation(),!1!==isAnimationDash&&this._startAntLineAnimation(),this.dashedRect.show()}if(this._showAutoFill=this._showAutoFill&&this._enableAutoFill,this._showAutoFill&&!this._hasWidgets(widgets)){const fillProps={fill:stroke,stroke:AutofillStroke,strokeScaleEnabled:!1},sizeState={width:autofillSize-autofillStrokeWidth,height:autofillSize-autofillStrokeWidth,left:endX-startX-autofillSize/2+autofillStrokeWidth/2-fixOnePixelBlurOffset,top:endY-startY-autofillSize/2+autofillStrokeWidth/2-fixOnePixelBlurOffset,strokeWidth:autofillStrokeWidth};this._autoFillControl.setProps(fillProps),this._autoFillControl.transformByState(sizeState),this._autoFillControl.show()}else this._autoFillControl.hide();this._updateBackgroundControl(currentStyle),this._updateHeaderBackground(currentStyle),this._updateWidgets(currentStyle)}_updateControlCoord(){const{startX,startY}=this._selectionRenderModel;this.selectionShapeGroup.show(),this.selectionShapeGroup.translate(startX,startY),this.selectionShapeGroup.makeDirtyNoDebounce(!0)}updateStyle(style){this._updateLayoutOfSelectionControl(style),this._updateControlCoord()}updateRange(rangeWithCoord,primaryWithCoord){this._selectionRenderModel.setValue(rangeWithCoord,primaryWithCoord),this._showAutoFill=null!==primaryWithCoord,this._updateLayoutOfSelectionControl(),this._updateControlCoord()}updateRangeBySelectionWithCoord(selectionWthCoord,sk){sk&&(this._rowHeaderWidth=sk.rowHeaderWidth,this._columnHeaderHeight=sk.columnHeaderHeight),this._selectionRenderModel.setValue(selectionWthCoord.rangeWithCoord,selectionWthCoord.primaryWithCoord),this._showAutoFill=null!==selectionWthCoord.primaryWithCoord,this._updateLayoutOfSelectionControl(selectionWthCoord.style),this._updateControlCoord()}update(newSelectionRange,rowHeaderWidth=0,columnHeaderHeight=0,style,primaryCell){this._rowHeaderWidth=rowHeaderWidth,this._columnHeaderHeight=columnHeaderHeight,this.updateRangeBySelectionWithCoord({rangeWithCoord:newSelectionRange,primaryWithCoord:primaryCell,style}),style&&this.updateStyle(style)}updateCurrCell(primaryCell){this._showAutoFill=null!==primaryCell,this._selectionRenderModel.setCurrentCell(primaryCell)}clearHighlight(){this._showAutoFill=!1,this._selectionRenderModel.clearCurrentCell(),this._updateLayoutOfSelectionControl(this._currentStyle)}getScene(){return this._scene}dispose(){this._leftBorder?.dispose(),this._rightBorder?.dispose(),this._topBorder?.dispose(),this._bottomBorder?.dispose(),this._backgroundControlTop?.dispose(),this._backgroundControlMiddleLeft?.dispose(),this._backgroundControlMiddleRight?.dispose(),this._backgroundControlBottom?.dispose(),this._autoFillControl.dispose(),this._selectionShapeGroup?.dispose(),this._rowHeaderBackground?.dispose(),this._rowHeaderBorder?.dispose(),this._rowHeaderGroup?.dispose(),this._rowHeaderBackground?.dispose(),this._columnHeaderBackground?.dispose(),this._columnHeaderBorder?.dispose(),this._columnHeaderGroup?.dispose(),this._topLeftWidget?.dispose(),this._topCenterWidget?.dispose(),this._topRightWidget?.dispose(),this._middleLeftWidget?.dispose(),this._middleRightWidget?.dispose(),this._bottomLeftWidget?.dispose(),this._bottomCenterWidget?.dispose(),this._bottomRightWidget?.dispose(),this._controlExtension?.dispose(),super.dispose(),this._dispose$.next(this),this._dispose$.complete()}getCurrentCellInfo(){const currentCell=this.model.currentCell;if(currentCell){let currentRangeData;if(currentCell.isMerged){const mergeInfo=currentCell.mergeInfo;currentRangeData={startRow:mergeInfo.startRow,endRow:mergeInfo.endRow,startColumn:mergeInfo.startColumn,endColumn:mergeInfo.endColumn,startX:mergeInfo.startX,endX:mergeInfo.endX,startY:mergeInfo.startY,endY:mergeInfo.endY}}else{const{actualRow,actualColumn,startX,endX,startY,endY}=currentCell;currentRangeData={startRow:actualRow,endRow:actualRow,startColumn:actualColumn,endColumn:actualColumn,startX,endX,startY,endY}}return currentRangeData}}getValue(){return{...this._selectionRenderModel.getValue(),style:this._currentStyle}}getRange(){return this._selectionRenderModel.getValue().rangeWithCoord}enableHelperSelection(){this._isHelperSelection=!0}disableHelperSelection(){this._isHelperSelection=!1}_updateHeaderBackground(style){const{startX,startY,endX,endY,rangeType}=this._selectionRenderModel,defaultStyle=this._currentStyle,scale=this._getScale(),{stroke,rowHeaderFill=defaultStyle.rowHeaderFill,rowHeaderStroke=defaultStyle.rowHeaderStroke,columnHeaderFill=defaultStyle.columnHeaderFill,columnHeaderStroke=defaultStyle.columnHeaderStroke}=style;let{rowHeaderStrokeWidth=defaultStyle.rowHeaderStrokeWidth,columnHeaderStrokeWidth=defaultStyle.columnHeaderStrokeWidth}=style;rowHeaderStrokeWidth/=scale,columnHeaderStrokeWidth/=scale;const rowHeaderWidth=this._rowHeaderWidth,columnHeaderHeight=this._columnHeaderHeight;if(this._highlightHeader&&columnHeaderHeight>0){let highlightTitleColor=columnHeaderFill;rangeType===src.$uV.COLUMN&&(highlightTitleColor=new src.mKL(stroke).setAlpha(.3).toString()),this._columnHeaderBackground.setProps({fill:highlightTitleColor}),this._columnHeaderBackground.resize(endX-startX,columnHeaderHeight),this._columnHeaderBorder.setProps({fill:columnHeaderStroke}),this._columnHeaderBorder.transformByState({width:endX-startX,height:columnHeaderStrokeWidth,top:columnHeaderHeight-columnHeaderStrokeWidth+1/scale}),this._columnHeaderGroup.show(),this._columnHeaderGroup.translate(startX,0)}else this._columnHeaderGroup.hide();if(this._columnHeaderGroup.makeDirty(!0),this._highlightHeader&&rowHeaderWidth>0){let highlightTitleColor=rowHeaderFill;rangeType===src.$uV.ROW&&(highlightTitleColor=new src.mKL(stroke).setAlpha(.3).toString()),this._rowHeaderBackground.setProps({fill:highlightTitleColor}),this._rowHeaderBackground.resize(rowHeaderWidth,endY-startY),this._rowHeaderBorder.setProps({fill:rowHeaderStroke}),this._rowHeaderBorder.transformByState({width:rowHeaderStrokeWidth,height:endY-startY,left:rowHeaderWidth-rowHeaderStrokeWidth+1/scale}),this._rowHeaderGroup.show(),this._rowHeaderGroup.translate(0,startY)}else this._rowHeaderGroup.hide();this._rowHeaderGroup.makeDirty(!0)}_updateBackgroundControl(style){const{startX,startY,endX,endY}=this._selectionRenderModel,scale=this._getScale(),{fill=style.fill}=style;let{strokeWidth}=style;strokeWidth/=scale;const highlightSelection=this._selectionRenderModel.highlightToSelection();if(!highlightSelection)return this._backgroundControlTop.resize(endX-startX,endY-startY),this._backgroundControlTop.setProps({fill}),this._backgroundControlBottom.resize(0,0),this._backgroundControlMiddleLeft.resize(0,0),void this._backgroundControlMiddleRight.resize(0,0);const{startX:h_startX,startY:h_startY,endX:h_endX,endY:h_endY}=highlightSelection,strokeOffset=strokeWidth/2,topConfig={left:-strokeOffset,top:-strokeOffset,width:endX-startX+2*strokeOffset,height:h_startY-startY+strokeOffset};topConfig.height<0&&(topConfig.width=0,topConfig.height=0),this._backgroundControlTop.transformByState(topConfig);const middleLeftConfig={left:-strokeOffset,top:h_startY-startY,width:h_startX-startX+strokeOffset,height:h_endY-h_startY};middleLeftConfig.width<0&&(middleLeftConfig.width=0,middleLeftConfig.height=0),this._backgroundControlMiddleLeft.transformByState(middleLeftConfig);const middleRightConfig={left:h_endX-startX-strokeOffset,top:h_startY-startY,width:endX-h_endX+2*strokeOffset,height:h_endY-h_startY};middleRightConfig.width<0&&(middleRightConfig.width=0,middleRightConfig.height=0),this._backgroundControlMiddleRight.transformByState(middleRightConfig);const middleBottomConfig={left:-strokeOffset,top:h_endY-startY,width:endX-startX+2*strokeOffset,height:endY-h_endY+strokeOffset};middleBottomConfig.height<0&&(middleBottomConfig.width=0,middleBottomConfig.height=0),this._backgroundControlBottom.transformByState(middleBottomConfig),this._backgroundControlTop.setProps({fill}),this._backgroundControlMiddleLeft.setProps({fill}),this._backgroundControlMiddleRight.setProps({fill}),this._backgroundControlBottom.setProps({fill})}_updateWidgets(style){const{startX,startY,endX,endY}=this._selectionRenderModel,{stroke=style.stroke,widgets=style.widgets,widgetStroke=style.widgetStroke}=style,scale=this._getScale();let{widgetSize,widgetStrokeWidth}=style;widgetSize/=scale,widgetStrokeWidth/=scale;const position={left:-widgetSize/2+widgetStrokeWidth/2,center:(endX-startX)/2-widgetSize/2+widgetStrokeWidth/2,right:endX-startX-widgetSize/2+widgetStrokeWidth/2,top:-widgetSize/2,middle:(endY-startY)/2-widgetSize/2,bottom:endY-startY-widgetSize/2+widgetStrokeWidth/2},size=widgetSize-widgetStrokeWidth;this._widgetRects.forEach((widget=>{widget.setProps({fill:stroke,stroke:widgetStroke})})),!0===widgets.tl?(this._topLeftWidget.transformByState({height:size,width:size,left:position.left,top:position.top,strokeWidth:widgetStrokeWidth}),this._topLeftWidget.show()):this._topLeftWidget.hide(),!0===widgets.tc?(this._topCenterWidget.transformByState({height:size,width:size,left:position.center,top:position.top,strokeWidth:widgetStrokeWidth}),this._topCenterWidget.show()):this._topCenterWidget.hide(),!0===widgets.tr?(this._topRightWidget.transformByState({height:size,width:size,left:position.right,top:position.top,strokeWidth:widgetStrokeWidth}),this._topRightWidget.show()):this._topRightWidget.hide(),!0===widgets.ml?(this._middleLeftWidget.transformByState({height:size,width:size,left:position.left,top:position.middle,strokeWidth:widgetStrokeWidth}),this._middleLeftWidget.show()):this._middleLeftWidget.hide(),!0===widgets.mr?(this._middleRightWidget.transformByState({height:size,width:size,left:position.right,top:position.middle,strokeWidth:widgetStrokeWidth}),this._middleRightWidget.show()):this._middleRightWidget.hide(),!0===widgets.bl?(this._bottomLeftWidget.transformByState({height:size,width:size,left:position.left,top:position.bottom,strokeWidth:widgetStrokeWidth}),this._bottomLeftWidget.show()):this._bottomLeftWidget.hide(),!0===widgets.bc?(this._bottomCenterWidget.transformByState({height:size,width:size,left:position.center,top:position.bottom,strokeWidth:widgetStrokeWidth}),this._bottomCenterWidget.show()):this._bottomCenterWidget.hide(),!0===widgets.br?(this._bottomRightWidget.transformByState({height:size,width:size,left:position.right,top:position.bottom,strokeWidth:widgetStrokeWidth}),this._bottomRightWidget.show()):this._bottomRightWidget.hide()}_hasWidgets(widgets){if(null==widgets)return!1;const keys=Object.keys(widgets);if(0===keys.length)return!1;for(const key of keys)if(!0===widgets[key])return!0;return!1}_getScale(){const{scaleX,scaleY}=this._scene.getAncestorScale();return Math.max(scaleX,scaleY)}_stopAntLineAnimation(){this._antLineOffset=0,(0,engine_render_src.tOx)(this._antRequestNewFrame)}_startAntLineAnimation(){const scale=this._getScale();this._antLineOffset+=.6/scale,this._antLineOffset>160/scale&&(this._antLineOffset=0),this.dashedRect.setProps({strokeDashOffset:-this._antLineOffset}),this._antRequestNewFrame=(0,engine_render_src.H$8)((()=>{this._startAntLineAnimation()}))}}class SelectionLayer extends engine_render_src.Wdr{render(ctx,isMaxLayer=!1){const startTime=src.S0q.now();return super.render(ctx,isMaxLayer),this._afterRender(startTime),this}_afterRender(startTime){this.scene.getEngine().renderFrameTimeMetric$.next(["selectionLayer",src.S0q.now()-startTime])}}const ISheetSelectionRenderService=(0,src.Qmd)("univer.sheet.selection-render-service");class BaseSelectionRenderService extends src.jGt{get selectionMoving(){return this._selectionMoving}constructor(_injector,_themeService,_shortcutService,_sheetSkeletonManagerService,contextService){super(),this._injector=_injector,this._themeService=_themeService,this._shortcutService=_shortcutService,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this.contextService=contextService,this._controlFillConfig$=new BehaviorSubject.t(null),this.controlFillConfig$=this._controlFillConfig$.asObservable(),this._selectionControls=[],this._startRangeWhenPointerDown={startY:0,endY:0,startX:0,endX:0,startRow:-1,endRow:-1,startColumn:-1,endColumn:-1},this._activeControlIndex=-1,this._startViewportPosX=0,this._startViewportPosY=0,this._highlightHeader=!0,this._rangeType=src.$uV.NORMAL,this._remainLastEnabled=!1,this._skipLastEnabled=!1,this._singleSelectionEnabled=!1,this._selectionMoveEnd$=new BehaviorSubject.t([]),this.selectionMoveEnd$=this._selectionMoveEnd$.asObservable(),this._selectionMoving$=new Subject.B,this.selectionMoving$=this._selectionMoving$.asObservable(),this._selectionMoveStart$=new Subject.B,this.selectionMoveStart$=this._selectionMoveStart$.asObservable(),this._selectionMoving=!1,this.interceptor=new src.vY4({RANGE_MOVE_PERMISSION_CHECK,RANGE_FILL_PERMISSION_CHECK}),this._escapeShortcutDisposable=null,this._initSelectionThemeFromThemeService(),this._initMoving()}get _shouldDetectMergedCells(){return this._rangeType===src.$uV.NORMAL}_initMoving(){this.disposeWithMe(this._selectionMoving$.subscribe((()=>{this._selectionMoving=!0}))),this.disposeWithMe(this._selectionMoveEnd$.subscribe((()=>{this._selectionMoving=!1})))}_setSelectionStyle(style){this._selectionStyle=style}getViewPort(){return this._activeViewport}setSingleSelectionEnabled(enabled=!1){this._singleSelectionEnabled=enabled}newSelectionControl(scene,skeleton,selection){const zIndex=this.getSelectionControls().length,{rowHeaderWidth,columnHeaderHeight}=skeleton,control=new SelectionControl(scene,zIndex,this._selectionTheme,{highlightHeader:this._highlightHeader,rowHeaderWidth,columnHeaderHeight});this._selectionControls.push(control);const selectionWithCoord=attachSelectionWithCoord(selection,skeleton);return control.updateRangeBySelectionWithCoord(selectionWithCoord,skeleton),control.setControlExtension({skeleton,scene,themeService:this._selectionTheme,injector:this._injector,selectionHooks:{selectionMoveEnd:()=>{this._selectionMoveEnd$.next(this.getSelectionDataWithStyle())}}}),control}resetSelectionsByModelData(selectionsWithStyleList){const allSelectionControls=this.getSelectionControls(),skeleton=this._skeleton;if(allSelectionControls&&skeleton){for(let i=0,len=selectionsWithStyleList.length;i<len;i++){const selectionWithStyle=selectionsWithStyleList[i],selectionWithCoord=attachSelectionWithCoord(selectionWithStyle,this._skeleton),control=allSelectionControls[i];control?control.updateRangeBySelectionWithCoord(selectionWithCoord,skeleton):this.isSelectionEnabled()&&this.newSelectionControl(this._scene,skeleton,selectionWithStyle)}if(selectionsWithStyleList.length<allSelectionControls.length){allSelectionControls.splice(selectionsWithStyleList.length).forEach((control=>control.dispose()))}}}refreshSelectionMoveStart(){this._selectionMoveStart$.next(this.getSelectionDataWithStyle())}refreshSelectionMoveEnd(){this._selectionMoveEnd$.next(this.getSelectionDataWithStyle())}_initSelectionThemeFromThemeService(){const currTheme=this._themeService.getCurrentTheme();this._selectionTheme=new src.Fsb,this._selectionTheme.setTheme(currTheme)}setSelectionTheme(prop){this._selectionTheme.setTheme(prop)}_changeRuntime(skeleton,scene,viewport){this._skeleton=skeleton,this._scene=scene,this._activeViewport=viewport||scene?.getViewports()[0],scene.findLayerByZIndex(1)||scene.addLayer(new SelectionLayer(scene,[],1))}getSkeleton(){return this._skeleton}getSelectionDataWithStyle(){const selectionControls=this._selectionControls,[unitId,sheetId]=this._skeleton.getLocation();return selectionControls.map((control=>{const v=control.getValue();return v.rangeWithCoord.sheetId=sheetId,v.rangeWithCoord.unitId=unitId,v}))}getSelectionControls(){return this._selectionControls}_addSelectionControlByModelData(selectionWithStyle){const skeleton=this._skeleton,style=selectionWithStyle.style??genNormalSelectionStyle(this._selectionTheme),scene=this._scene;selectionWithStyle.style=style;return this.newSelectionControl(scene,skeleton,selectionWithStyle)}_clearAllSelectionControls(){const allSelectionControls=this._selectionControls;for(const control of allSelectionControls)control.dispose();this._selectionControls.length=0}_getFreeze(){const freeze=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton.getWorksheetConfig().freeze;return freeze}_getViewportByCell(row,column){if(void 0===row||void 0===column)return null;const freeze=this._getFreeze();return!freeze||freeze.startRow<=0&&freeze.startColumn<=0||row>freeze.startRow&&column>freeze.startColumn?this._scene.getViewport(engine_render_src.p3k.VIEW_MAIN):row<=freeze.startRow&&column<=freeze.startColumn?this._scene.getViewport(engine_render_src.p3k.VIEW_MAIN_LEFT_TOP):row<=freeze.startRow&&column>freeze.startColumn?this._scene.getViewport(engine_render_src.p3k.VIEW_MAIN_TOP):row>freeze.startRow&&column<=freeze.startColumn?this._scene.getViewport(engine_render_src.p3k.VIEW_MAIN_LEFT):void 0}getActiveRange(){const controls=this.getSelectionControls(),model=controls&&controls[controls.length-1].model;return model&&{startRow:model.startRow,startColumn:model.startColumn,endRow:model.endRow,endColumn:model.endColumn}}setActiveSelectionIndex(index){this._activeControlIndex=index}resetActiveSelectionIndex(){this._activeControlIndex=-1}getActiveSelectionControl(){const controls=this.getSelectionControls();if(controls)return this._activeControlIndex<0?controls[controls.length-1]:controls[this._activeControlIndex]}endSelection(){this._clearUpdatingListeners(),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()),this._escapeShortcutDisposable?.dispose(),this._escapeShortcutDisposable=null}_reset(){this._clearAllSelectionControls(),this._downObserver?.unsubscribe(),this._downObserver=null}_setupPointerMoveListener(viewportMain,activeSelectionControl,rangeType,scrollTimerType=engine_render_src.rDM.ALL,moveStartPosX,moveStartPosY){let xCrossTime=0,yCrossTime=0,lastX=moveStartPosX,lastY=moveStartPosY;this._scrollTimer=engine_render_src.Vui.create(this._scene,scrollTimerType),this._scrollTimer.startScroll(viewportMain?.left??0,viewportMain?.top??0,viewportMain);const scene=this._scene,startViewport=scene.getActiveViewportByCoord(engine_render_src.I9Y.FromArray([moveStartPosX,moveStartPosY]));this._scenePointerMoveSub=scene.onPointerMove$.subscribeEvent((moveEvt=>{const{offsetX:moveOffsetX,offsetY:moveOffsetY}=moveEvt,{x:newMoveOffsetX,y:newMoveOffsetY}=scene.getCoordRelativeToViewport(engine_render_src.I9Y.FromArray([moveOffsetX,moveOffsetY]));this._movingHandler(newMoveOffsetX,newMoveOffsetY,activeSelectionControl,rangeType);let scrollOffsetX=newMoveOffsetX,scrollOffsetY=newMoveOffsetY;const currentSelection=this.getActiveSelectionControl(),freeze=this._getFreeze(),selection=currentSelection?.model,endViewport=scene.getActiveViewportByCoord(engine_render_src.I9Y.FromArray([moveOffsetX,moveOffsetY]))??this._getViewportByCell(selection?.endRow,selection?.endColumn);if((()=>{if(!startViewport||!endViewport||!viewportMain)return!1;const crossableViewports=[engine_render_src.p3k.VIEW_MAIN,engine_render_src.p3k.VIEW_MAIN_LEFT_TOP,engine_render_src.p3k.VIEW_MAIN_TOP,engine_render_src.p3k.VIEW_MAIN_LEFT];return crossableViewports.includes(startViewport.viewportKey)&&crossableViewports.includes(endViewport.viewportKey)})()){if(!startViewport||!endViewport||!viewportMain)return!1;const isCrossingX=lastX<viewportMain.left&&newMoveOffsetX>viewportMain.left||lastX>viewportMain.left&&newMoveOffsetX<viewportMain.left,isCrossingY=lastY<viewportMain.top&&newMoveOffsetY>viewportMain.top||lastY>viewportMain.top&&newMoveOffsetY<viewportMain.top;isCrossingX&&(xCrossTime+=1),isCrossingY&&(yCrossTime+=1);const startKey=startViewport.viewportKey,endKey=endViewport.viewportKey;if(startKey===engine_render_src.p3k.VIEW_ROW_TOP)moveOffsetY<viewportMain.top&&(selection?.endRow??0)<(freeze?.startRow??0)?scrollOffsetY=viewportMain.top:isCrossingY&&yCrossTime%2==1&&viewportMain.scrollToViewportPos({viewportScrollY:0});else if(startKey===engine_render_src.p3k.VIEW_COLUMN_LEFT)moveOffsetX<viewportMain.left&&(selection?.endColumn??0)<(freeze?.startColumn??0)?scrollOffsetX=viewportMain.left:isCrossingX&&xCrossTime%2==1&&viewportMain.scrollToViewportPos({viewportScrollX:0});else if(startKey===endKey){let disableX=!1,disableY=!1;startKey===engine_render_src.p3k.VIEW_MAIN_LEFT_TOP?(disableX=!0,disableY=!0):startKey===engine_render_src.p3k.VIEW_MAIN_TOP?disableY=!0:startKey===engine_render_src.p3k.VIEW_MAIN_LEFT&&(disableX=!0),(selection?.endRow??0)>(freeze?.startRow??0)&&(disableY=!1),(selection?.endColumn??0)>(freeze?.startColumn??0)&&(disableX=!1),disableX&&(scrollOffsetX=viewportMain.left),disableY&&(scrollOffsetY=viewportMain.top)}else{const startXY={x:startViewport.scrollX,y:startViewport.scrollY},endXY={x:endViewport.scrollX,y:endViewport.scrollY},shouldResetX=startXY.x!==endXY.x&&isCrossingX&&xCrossTime%2==1,shouldResetY=startXY.y!==endXY.y&&isCrossingY&&yCrossTime%2==1;(shouldResetX||shouldResetY)&&(viewportMain.scrollToBarPos({x:shouldResetX?startXY.x:void 0,y:shouldResetY?startXY.y:void 0}),shouldResetX||(scrollOffsetX=viewportMain.left),shouldResetY||(scrollOffsetY=viewportMain.top)),(startKey===engine_render_src.p3k.VIEW_MAIN_LEFT_TOP&&endKey===engine_render_src.p3k.VIEW_MAIN_LEFT||endKey===engine_render_src.p3k.VIEW_MAIN_LEFT_TOP&&startKey===engine_render_src.p3k.VIEW_MAIN_LEFT)&&(scrollOffsetX=viewportMain.left),(startKey===engine_render_src.p3k.VIEW_MAIN_LEFT_TOP&&endKey===engine_render_src.p3k.VIEW_MAIN_TOP||endKey===engine_render_src.p3k.VIEW_MAIN_LEFT_TOP&&startKey===engine_render_src.p3k.VIEW_MAIN_TOP)&&(scrollOffsetY=viewportMain.top)}lastX=newMoveOffsetX,lastY=newMoveOffsetY}this._scrollTimer.scrolling(scrollOffsetX,scrollOffsetY,(()=>{this._movingHandler(newMoveOffsetX,newMoveOffsetY,activeSelectionControl,rangeType)}))}))}attachSelectionWithCoord(selectionWithStyle){return attachSelectionWithCoord(selectionWithStyle,this._skeleton)}attachPrimaryWithCoord(primary){return attachPrimaryWithCoord(this._skeleton,primary)}getSelectionCellByPosition(x,y){return this.getCellWithCoordByOffset(x,y)}getCellWithCoordByOffset(x,y,skeletonParam){const scene=this._scene,skeleton=skeletonParam??this._skeleton,scrollXY=scene.getViewportScrollXY(scene.getViewport(engine_render_src.p3k.VIEW_MAIN)),{scaleX,scaleY}=scene.getAncestorScale();return skeleton.getCellWithCoordByOffset(x,y,scaleX,scaleY,scrollXY)}_movingHandler(offsetX,offsetY,activeSelectionControl,rangeType){const skeleton=this._skeleton,scene=this._scene,[unitId,sheetId]=skeleton.getLocation(),currSelectionRange={startRow:activeSelectionControl?.model.startRow??-1,endRow:activeSelectionControl?.model.endRow??-1,startColumn:activeSelectionControl?.model.startColumn??-1,endColumn:activeSelectionControl?.model.endColumn??-1,unitId,sheetId},viewportMain=scene.getViewport(engine_render_src.p3k.VIEW_MAIN),targetViewport=this._getViewportByCell(currSelectionRange.endRow,currSelectionRange.endColumn)??viewportMain,scrollXY=scene.getScrollXYInfoByViewport(engine_render_src.I9Y.FromArray([this._startViewportPosX,this._startViewportPosY]),targetViewport),{scaleX,scaleY}=scene.getAncestorScale();rangeType===src.$uV.ROW?offsetX=Number.POSITIVE_INFINITY:rangeType===src.$uV.COLUMN&&(offsetY=Number.POSITIVE_INFINITY);const currCell=this._skeleton.getCellByOffset(offsetX,offsetY,scaleX,scaleY,scrollXY);if(!currCell)return;let newSelectionRange={startRow:Math.min(currCell.startRow,this._startRangeWhenPointerDown.startRow),startColumn:Math.min(currCell.startColumn,this._startRangeWhenPointerDown.startColumn),endRow:Math.max(currCell.endRow,this._startRangeWhenPointerDown.endRow),endColumn:Math.max(currCell.endColumn,this._startRangeWhenPointerDown.endColumn)};this._shouldDetectMergedCells&&(newSelectionRange=skeleton.expandRangeByMerge(newSelectionRange));const newSelectionRangeWithCoord=attachSelectionWithCoord({range:newSelectionRange,primary:void 0,style:null},skeleton);newSelectionRangeWithCoord.rangeWithCoord.unitId=unitId,newSelectionRangeWithCoord.rangeWithCoord.sheetId=sheetId,newSelectionRangeWithCoord.rangeWithCoord.rangeType=rangeType;const rangeChanged=currSelectionRange.startRow!==newSelectionRange.startRow||currSelectionRange.startColumn!==newSelectionRange.startColumn||currSelectionRange.endRow!==newSelectionRange.endRow||currSelectionRange.endColumn!==newSelectionRange.endColumn;null!=activeSelectionControl&&rangeChanged&&(activeSelectionControl.updateRangeBySelectionWithCoord(newSelectionRangeWithCoord),this._selectionMoving$.next(this.getSelectionDataWithStyle()))}_clearUpdatingListeners(){this._scene.enableObjectsEvent(),this._scenePointerMoveSub?.unsubscribe(),this._scenePointerMoveSub=null,this._scenePointerUpSub?.unsubscribe(),this._scenePointerUpSub=null,this._cancelDownSubscription?.unsubscribe(),this._cancelDownSubscription=null,this._cancelUpSubscription?.unsubscribe(),this._cancelUpSubscription=null,this._scrollTimer?.dispose()}_addEndingListeners(){const scene=this._scene,mainScene=scene.getEngine()?.activeScene;mainScene&&mainScene!==scene&&(this._cancelDownSubscription?.unsubscribe(),this._cancelDownSubscription=null,this._cancelUpSubscription?.unsubscribe(),this._cancelUpSubscription=null,this._cancelDownSubscription=mainScene.onPointerDown$.subscribeEvent((()=>this._clearUpdatingListeners())),this._cancelUpSubscription=mainScene.onPointerUp$.subscribeEvent((()=>this._clearUpdatingListeners())))}_getSelectionWithCoordByOffset(offsetX,offsetY,scaleX,scaleY,scrollXY){const skeleton=this._skeleton;if(null==skeleton)return null;if(this._shouldDetectMergedCells){const primaryWithCoord=skeleton?.getCellWithCoordByOffset(offsetX,offsetY,scaleX,scaleY,scrollXY,{firstMatch:!0});if(!primaryWithCoord)return;return{primaryWithCoord,rangeWithCoord:(0,src.mRw)(primaryWithCoord)}}const{row,column}=skeleton.getCellIndexByOffset(offsetX,offsetY,scaleX,scaleY,scrollXY),startCell=skeleton.getNoMergeCellWithCoordByIndex(row,column),{startX,startY,endX,endY}=startCell,rangeWithCoord={startY,endY,startX,endX,startRow:row,endRow:row,startColumn:column,endColumn:column};return{primaryWithCoord:{mergeInfo:rangeWithCoord,actualRow:row,actualColumn:column,isMerged:!1,isMergedMainCell:!1,startY,endY,startX,endX},rangeWithCoord}}_checkClearPreviousControls(evt){0!==this.getSelectionControls().length&&(!evt.ctrlKey&&!evt.shiftKey&&!this._remainLastEnabled||this._singleSelectionEnabled&&!evt.shiftKey)&&this._clearAllSelectionControls()}_makeSelectionByTwoCells(currentCell,startSelectionRange,skeleton,rangeType,activeControl){const{actualRow,actualColumn,mergeInfo:actualMergeInfo}=currentCell;this._startRangeWhenPointerDown={...currentCell.mergeInfo};const newStartRow=Math.min(actualRow,startSelectionRange.startRow,actualMergeInfo.startRow),newEndRow=Math.max(actualRow,startSelectionRange.endRow,actualMergeInfo.endRow),newStartColumn=Math.min(actualColumn,startSelectionRange.startColumn,actualMergeInfo.startColumn),newEndColumn=Math.max(actualColumn,startSelectionRange.endColumn,actualMergeInfo.endColumn),selectionWithCoord=attachSelectionWithCoord({range:skeleton.expandRangeByMerge({startRow:newStartRow,startColumn:newStartColumn,endRow:newEndRow,endColumn:newEndColumn}),primary:null,style:null},skeleton);activeControl.updateRangeBySelectionWithCoord(selectionWithCoord)}isSelectionEnabled(){return this.contextService.getContextValue(sheets_src.a_m)}isSelectionDisabled(){return!1===this.contextService.getContextValue(sheets_src.a_m)}inRefSelectionMode(){return this.contextService.getContextValue(sheets_src.C5D)}}function selectionDataForSelectAll(skeleton){return{range:{startRow:0,startColumn:0,endRow:skeleton.getRowCount()-1,endColumn:skeleton.getColumnCount()-1,rangeType:src.$uV.ALL},primary:getTopLeftSelectionOfCurrSheet(skeleton).primary,style:null}}function getTopLeftSelectionOfCurrSheet(skeleton){return function genSelectionByRange(skeleton,range){const topLeftCell=skeleton.worksheet.getCellInfoInMergeData(range.startRow,range.startColumn),bottomRightCell=skeleton.worksheet.getCellInfoInMergeData(range.endRow,range.endColumn);return{range:{startRow:topLeftCell.startRow,startColumn:topLeftCell.startColumn,endRow:bottomRightCell.endRow,endColumn:bottomRightCell.endColumn,rangeType:src.$uV.NORMAL},primary:{actualRow:topLeftCell.startRow,actualColumn:topLeftCell.startColumn,startRow:topLeftCell.startRow,startColumn:topLeftCell.startColumn,endRow:topLeftCell.endRow,endColumn:topLeftCell.endColumn,isMerged:topLeftCell.isMerged,isMergedMainCell:topLeftCell.isMergedMainCell},style:null}}(skeleton,{startRow:0,startColumn:0,endRow:0,endColumn:0})}function sheet_skeleton_manager_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function sheet_skeleton_manager_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class sheet_skeleton_manager_service_SheetSkeletonManagerService extends src.jGt{constructor(_context,_injector,_sheetSkService){super(),this._context=_context,this._injector=_injector,this._sheetSkService=_sheetSkService,this._sheetId="",this._sheetSkeletonParamStore=new Map,this._currentSkeleton$=new BehaviorSubject.t(null),this.currentSkeleton$=this._currentSkeleton$.asObservable(),this._currentSkeletonBefore$=new BehaviorSubject.t(null),this.currentSkeletonBefore$=this._currentSkeletonBefore$.asObservable(),this.disposeWithMe((()=>{this._currentSkeletonBefore$.complete(),this._currentSkeleton$.complete(),this._sheetSkeletonParamStore.forEach((sk=>this.disposeSkeleton(sk.sheetId))),this._sheetSkeletonParamStore.clear()})),this._initRemoveSheet()}_initRemoveSheet(){this.disposeWithMe(this._context.unit.sheetDisposed$.subscribe((sheet=>{this.disposeSkeleton(sheet.getSheetId())})))}getCurrentSkeleton(){return this.getCurrentParam()?.skeleton}getCurrent(){return this.getCurrentParam()}getCurrentParam(){return this._getSkeletonParam(this._sheetId)}getSkeleton(sheetId){return this._getSkeleton(sheetId)}getSkeletonParam(sheetId){return this._getSkeletonParam(sheetId)}getWorksheetSkeleton(sheetId){return this.getSkeletonParam(sheetId)}getUnitSkeleton(unitId,sheetId){const param=this._getSkeletonParam(sheetId);return null!=param&&(param.unitId=unitId),param}setCurrent(searchParam){this._setCurrent(searchParam.sheetId)}setSkeletonParam(sheetId,skp){this._sheetSkService.setSkeleton(skp.unitId,sheetId,skp.skeleton),this._sheetSkeletonParamStore.set(sheetId,skp)}_setCurrent(sheetId){this._sheetId=sheetId;const skParam=this._getSkeletonParam(sheetId),unitId=this._context.unitId;if(null!=skParam)this.reCalculate(skParam);else{const worksheet=this._context.unit.getSheetBySheetId(sheetId);if(null==worksheet)return;const scene=this._context.scene,skeleton=this._buildSkeleton(worksheet,scene);this.setSkeletonParam(sheetId,{unitId,sheetId,skeleton,dirty:!1})}const sheetSkeletonManagerParam=this._getSkeletonParam(sheetId);this._currentSkeletonBefore$.next(sheetSkeletonManagerParam),this._currentSkeleton$.next(sheetSkeletonManagerParam)}reCalculate(param){param||(param=this.getCurrentParam()),null!=param&&(param.dirty&&(param.skeleton.makeDirty(!0),param.dirty=!1),param.skeleton.calculate())}makeDirty(searchParm,state=!0){const param=this._getSkeletonParam(searchParm.sheetId);null!=param&&(param.dirty=state)}getOrCreateSkeleton(searchParam){return this.ensureSkeleton(searchParam.sheetId)}ensureSkeleton(sheetId){const skeleton=this._getSkeletonParam(sheetId);if(skeleton)return skeleton.skeleton;const worksheet=this._context.unit.getSheetBySheetId(sheetId);if(!worksheet)return;const newSkeleton=this._buildSkeleton(worksheet);return this.setSkeletonParam(sheetId,{unitId:this._context.unitId,sheetId,skeleton:newSkeleton,dirty:!1}),newSkeleton}disposeSkeleton(sheetId){const skParam=this.getSkeletonParam(sheetId);skParam&&(skParam.skeleton.dispose(),this._sheetSkeletonParamStore.delete(sheetId),this._sheetSkService.deleteSkeleton(skParam.unitId,sheetId))}attachRangeWithCoord(range){const skeleton=this.getCurrentSkeleton();return skeleton?util_attachRangeWithCoord(skeleton,range):null}_getSkeletonParam(sheetId){return this._sheetSkeletonParamStore.get(sheetId)}_getSkeleton(sheetId){const param=this._getSkeletonParam(sheetId);return param?param.skeleton:null}_buildSkeleton(worksheet,_scene){return this._injector.createInstance(engine_render_src.QcA,worksheet,this._context.unit.getStyles())}setColumnHeaderSize(render,sheetId,size){if(!render)return;const skeleton=this.getWorksheetSkeleton(sheetId)?.skeleton;if(!skeleton)return;skeleton.columnHeaderHeight=size,render.scene.getViewports()[0].top=size,render.scene.getViewport(engine_render_src.p3k.VIEW_COLUMN_RIGHT).setViewportSize({height:size}),render.scene.getViewport(engine_render_src.p3k.VIEW_COLUMN_LEFT).setViewportSize({height:size}),render.scene.getViewport(engine_render_src.p3k.VIEW_ROW_BOTTOM).setViewportSize({top:size}),render.scene.getViewport(engine_render_src.p3k.VIEW_ROW_TOP).setViewportSize({top:size}),render.scene.getViewport(engine_render_src.p3k.VIEW_LEFT_TOP).setViewportSize({height:size});const selectionService=render?.with(sheets_src.Fal),selectionRenderService=render?.with(ISheetSelectionRenderService),currSelections=selectionService.getCurrentSelections();selectionRenderService.resetSelectionsByModelData(currSelections);const sheetSkeletonManagerParam=this.getUnitSkeleton(render.unitId,sheetId);sheetSkeletonManagerParam&&(sheetSkeletonManagerParam.commandId=SetColumnHeaderHeightCommand.id,this._currentSkeleton$.next(sheetSkeletonManagerParam))}setRowHeaderSize(render,sheetId,size){const skeleton=this.getWorksheetSkeleton(sheetId)?.skeleton;if(!render)return;if(!skeleton)return;skeleton.rowHeaderWidth=size;const deltaX=size-(render.scene.getViewport(engine_render_src.p3k.VIEW_LEFT_TOP).width||46),originLeftOfViewMain=render.scene.getViewports()[0].left;render.scene.getViewports()[0].left=originLeftOfViewMain+deltaX,render.scene.getViewport(engine_render_src.p3k.VIEW_ROW_BOTTOM).setViewportSize({width:size}),render.scene.getViewport(engine_render_src.p3k.VIEW_ROW_TOP).setViewportSize({width:size}),render.scene.getViewport(engine_render_src.p3k.VIEW_COLUMN_LEFT).setViewportSize({left:size});const prevLeft=render.scene.getViewport(engine_render_src.p3k.VIEW_COLUMN_RIGHT).left||0;render.scene.getViewport(engine_render_src.p3k.VIEW_COLUMN_RIGHT).setViewportSize({left:prevLeft+deltaX}),render.scene.getViewport(engine_render_src.p3k.VIEW_LEFT_TOP).setViewportSize({width:size});const selectionService=render?.with(sheets_src.Fal),selectionRenderService=render?.with(ISheetSelectionRenderService),currSelections=selectionService.getCurrentSelections();selectionRenderService.resetSelectionsByModelData(currSelections);const sheetSkeletonManagerParam=this.getCurrent();sheetSkeletonManagerParam&&(sheetSkeletonManagerParam.commandId=SetRowHeaderWidthCommand.id,this._currentSkeleton$.next(sheetSkeletonManagerParam))}}function useActiveWorkbook(){const univerInstanceService=(0,ui_src.fJ)(src.HCr);return(0,ui_src.J2)((()=>univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET)),void 0,void 0,[])??null}sheet_skeleton_manager_service_SheetSkeletonManagerService=function sheet_skeleton_manager_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([sheet_skeleton_manager_service_ts_param(1,(0,src.y_5)(src.zZn)),sheet_skeleton_manager_service_ts_param(2,(0,src.y_5)(sheets_src.QsU)),sheet_skeleton_manager_service_ts_metadata("design:type",Function),sheet_skeleton_manager_service_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===src.zZn?Object:src.zZn,void 0===sheets_src.QsU?Object:sheets_src.QsU])],sheet_skeleton_manager_service_SheetSkeletonManagerService);var SheetsUIPart=function(SheetsUIPart){return SheetsUIPart.FILTER_PANEL_EMBED_POINT="filter-panel-embed-point",SheetsUIPart.SHEETS_FOOTER="sheets-footer",SheetsUIPart.FORMULA_AUX="formula-aux",SheetsUIPart}({});Symbol("sheets-ui.config");const controllers_config_schema_defaultPluginConfig={formulaBar:!0,statusBarStatistic:!0,maxAutoHeightCount:1e3};function auto_height_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function auto_height_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}const AFFECT_LAYOUT_STYLES=["ff","fs","tr","tb"];class AutoHeightController extends src.jGt{constructor(_renderManagerService,_sheetInterceptorService,_selectionManagerService,_univerInstanceService,_configService){super(),this._renderManagerService=_renderManagerService,this._sheetInterceptorService=_sheetInterceptorService,this._selectionManagerService=_selectionManagerService,this._univerInstanceService=_univerInstanceService,this._configService=_configService,this._initialize()}_getRangesScope(ranges){let start,end;for(const{startRow,endRow}of ranges)start=void 0===start?startRow:Math.min(start,startRow),end=void 0===end?endRow:Math.max(end,endRow);return end-start+1}getUndoRedoParamsOfAutoHeight(ranges,subUnitIdParam){const{_univerInstanceService:univerInstanceService,_configService:configService}=this,workbook=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),unitId=workbook.getUnitId();let worksheet=workbook.getActiveSheet(),subUnitId=worksheet.getSheetId();if(subUnitIdParam){const target=(0,sheets_src.go2)(univerInstanceService,{unitId,subUnitId:subUnitIdParam});target&&(worksheet=target.worksheet,subUnitId=worksheet.getSheetId())}const skeleton=this._renderManagerService.getRenderById(unitId).with(sheet_skeleton_manager_service_SheetSkeletonManagerService).ensureSkeleton(subUnitId);if(!skeleton)return{redos:[],undos:[]};const config=configService.getConfig("sheets-ui.config");let rangeList=ranges;Array.isArray(ranges)||(rangeList=ranges&&void 0!==ranges.startRow&&void 0!==ranges.startRow?[ranges]:[]);const count=this._getRangesScope(rangeList);if((config?.maxAutoHeightCount??1e3)<count)return{redos:[],undos:[]};const redoParams={subUnitId,unitId,rowsAutoHeightInfo:skeleton.calculateAutoHeightInRange(ranges)},undoParams=(0,sheets_src.w45)(redoParams,worksheet);return{undos:[{id:sheets_src.wXn.id,params:undoParams}],redos:[{id:sheets_src.wXn.id,params:redoParams}]}}_initialize(){const{_sheetInterceptorService:sheetInterceptorService,_selectionManagerService:selectionManagerService}=this;this.disposeWithMe(sheetInterceptorService.interceptCommand({getMutations:command=>{if(command.id===sheets_src.NXV.id){const params=command.params;return this.getUndoRedoParamsOfAutoHeight(params.range,params.subUnitId)}return{redos:[],undos:[]}}})),this.disposeWithMe(sheetInterceptorService.interceptCommand({getMutations:command=>command.id!==sheets_src.iOM.id?{redos:[],undos:[]}:this.getUndoRedoParamsOfAutoHeight(command.params.ranges,command.params.subUnitId)})),this.disposeWithMe(sheetInterceptorService.interceptCommand({getMutations:command=>{if(command.id!==sheets_src.Fe6.id)return{redos:[],undos:[]};if(!AFFECT_LAYOUT_STYLES.includes(command.params?.style.type))return{redos:[],undos:[]};const selections=selectionManagerService.getCurrentSelections()?.map((s=>s.range));return selections?.length?this.getUndoRedoParamsOfAutoHeight(selections,command.params.subUnitId):{redos:[],undos:[]}}})),this.disposeWithMe(sheetInterceptorService.interceptAfterCommand({getMutations:command=>{if(command.id===sheets_src.Kft.id){const params=command.params;return this.getUndoRedoParamsOfAutoHeight([params.fromRange,params.toRange])}if(command.id===sheets_src.yzM.id){const params=command.params;return this.getUndoRedoParamsOfAutoHeight([params.range])}return{redos:[],undos:[]}}}))}}function discreteRangeToRange(discreteRange){const{rows,cols}=discreteRange;return{startRow:rows[0],endRow:rows[rows.length-1],startColumn:cols[0],endColumn:cols[cols.length-1]}}function virtualizeDiscreteRanges(ranges){let totalRows=[],totalCols=[];const totalRanges=[];return ranges.forEach((r=>{totalRows=totalRows.concat(r.rows),totalCols=totalCols.concat(r.cols)})),totalRows=Array.from(new Set(totalRows)).sort(((a,b)=>a-b)),totalCols=Array.from(new Set(totalCols)).sort(((a,b)=>a-b)),ranges.forEach((r=>{totalRanges.push({startRow:totalRows.findIndex((row=>row===r.rows[0])),endRow:totalRows.findIndex((row=>row===r.rows[r.rows.length-1])),startColumn:totalCols.findIndex((col=>col===r.cols[0])),endColumn:totalCols.findIndex((col=>col===r.cols[r.cols.length-1]))})})),{ranges:totalRanges,mapFunc:(row,col)=>({row:totalRows[row],col:totalCols[col]})}}function generateNullCellValueRowCol(range){const cellValue=new src.hDc;return range.forEach((r=>{const{rows,cols}=r;rows.forEach((i=>{cols.forEach((j=>{cellValue.setValue(i,j,{v:null,p:null,f:null,si:null,custom:null})}))}))})),cellValue.getData()}AutoHeightController=function auto_height_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([auto_height_controller_ts_param(0,engine_render_src.cSx),auto_height_controller_ts_param(1,(0,src.y_5)(sheets_src.e5R)),auto_height_controller_ts_param(2,(0,src.y_5)(sheets_src.Fal)),auto_height_controller_ts_param(3,(0,src.y_5)(src.HCr)),auto_height_controller_ts_param(4,src.J0C),auto_height_controller_ts_metadata("design:type",Function),auto_height_controller_ts_metadata("design:paramtypes",["undefined"==typeof RenderManagerService?Object:RenderManagerService,void 0===sheets_src.e5R?Object:sheets_src.e5R,void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===src.HCr?Object:src.HCr,void 0===src.J0C?Object:src.J0C])],AutoHeightController);const chnNumChar={零:0,一:1,二:2,三:3,四:4,五:5,六:6,七:7,八:8,九:9},chnNumChar2=["零","一","二","三","四","五","六","七","八","九"],chnUnitSection=["","万","亿","万亿","亿亿"],chnUnitChar=["","十","百","千"],chnNameValue={十:{value:10,secUnit:!1},百:{value:100,secUnit:!1},千:{value:1e3,secUnit:!1},万:{value:1e4,secUnit:!0},亿:{value:1e8,secUnit:!0}};function chineseToNumber(chnStr){if(!chnStr)return 0;let rtn=0,section=0,number=0,secUnit=!1;const str=chnStr.split("");for(let i=0;i<str.length;i++){const num=chnNumChar[str[i]];if(void 0!==num)number=num,i===str.length-1&&(section+=number);else{const obj=chnNameValue[str[i]],unit=obj.value;secUnit=obj.secUnit,secUnit?(section=(section+number)*unit,rtn+=section,section=0):section+=number*unit,number=0}}return rtn+section}function sectionToChinese(section){let strIns="",chnStr="",unitPos=0,zero=!0;for(;section>0;){const v=section%10;0===v?zero||(zero=!0,chnStr=chnNumChar2[v]+chnStr):(zero=!1,strIns=chnNumChar2[v],strIns+=chnUnitChar[unitPos],chnStr=strIns+chnStr),unitPos++,section=Math.floor(section/10)}return chnStr}function numberToChinese(num){let unitPos=0,strIns="",chnStr="",needZero=!1;if(0===num)return chnNumChar2[0];for(;num>0;){const section=num%1e4;needZero&&(chnStr=chnNumChar2[0]+chnStr),strIns=sectionToChinese(section),strIns+=0!==section?chnUnitSection[unitPos]:chnUnitSection[0],chnStr=strIns+chnStr,needZero=section<1e3&&section>0,num=Math.floor(num/1e4),unitPos++}return chnStr}function matchExtendNumber(txt){if(!txt)return{isExtendNumber:!1};const reg=/0|([1-9]+[0-9]*)/g,isExtendNumber=reg.test(txt);if(isExtendNumber){const match=txt.match(reg);if(match&&match.length>0){const matchTxt=match[match.length-1],matchIndex=txt.lastIndexOf(matchTxt),beforeTxt=txt.substr(0,matchIndex),afterTxt=txt.substr(matchIndex+matchTxt.length);return{isExtendNumber:!0,matchTxt:Number(matchTxt),beforeTxt,afterTxt}}return{isExtendNumber:!1}}return{isExtendNumber}}function isEqualDiff(arr){let diff=!0;const step=arr[1]-arr[0];for(let i=1;i<arr.length;i++)if(arr[i]-arr[i-1]!==step){diff=!1;break}return diff}function fillCopy(data,len){const applyData=[];for(let i=1;i<=len;i++){const index=(i-1)%data.length,d=src.S0q.deepClone(data[index]);removeCellCustom(d),applyData.push({v:null,s:null,p:null,f:null,si:null,t:null,...d})}return applyData}function fillSeries(data,len,direction){const applyData=[],dataNumArr=[];for(let j=0;j<data.length;j++)dataNumArr.push(Number(data[j]?.v));if(data.length>2&&function isEqualRatio(arr){let ratio=!0;const step=arr[1]/arr[0];for(let i=1;i<arr.length;i++)if(arr[i]/arr[i-1]!==step){ratio=!1;break}return ratio}(dataNumArr))for(let i=1;i<=len;i++){const index=(i-1)%data.length,d=src.S0q.deepClone(data[index]);removeCellCustom(d);const num=Number(data[data.length-1]?.v)*(Number(data[1]?.v)/Number(data[0]?.v))**i;d&&(needsUpdateCellValue(d)&&(d.v=num),applyData.push(d))}else{const xArr=function getXArr(len){const xArr=[];for(let i=1;i<=len;i++)xArr.push(i);return xArr}(data.length);for(let i=1;i<=len;i++){const index=(i-1)%data.length,d=src.S0q.deepClone(data[index]);removeCellCustom(d);const forward=direction===src.OP3.DOWN||direction===src.OP3.RIGHT,y=forecast(data.length+i,dataNumArr,xArr,forward);d&&(needsUpdateCellValue(d)&&(d.v=y),applyData.push(d))}}return applyData}function forecast(x,yArr,xArr,forward=!0){function getAverage(arr){let sum=0;for(let i=0;i<arr.length;i++)sum+=arr[i];return sum/arr.length}const ax=getAverage(xArr),ay=getAverage(yArr);let b,sum_d=0,sum_n=0;for(let j=0;j<xArr.length;j++)sum_d+=(xArr[j]-ax)*(yArr[j]-ay),sum_n+=(xArr[j]-ax)*(xArr[j]-ax);b=0===sum_n?forward?1:-1:sum_d/sum_n;const a=ay-b*ax;return Math.round(1e5*(a+b*x))/1e5}function fillExtendNumber(data,len,step){const applyData=[],reg=/0|([1-9]+[0-9]*)/g;for(let i=1;i<=len;i++){const index=(i-1)%data.length,d=src.S0q.deepClone(data[index]);removeCellCustom(d);const last=`${data[data.length-1]?.v}`,match=last?.match(reg),lastTxt=match?.[match.length-1],num=Math.abs(Number(lastTxt)+step*i);if(!last||!lastTxt)continue;const lastIndex=last.lastIndexOf(lastTxt),valueTxt=last.substr(0,lastIndex)+num.toString()+last.substr(lastIndex+lastTxt.length);d&&(d.v=valueTxt,applyData.push(d))}return applyData}function fillChnWeek(data,len,step,weekType=0){const keywordMap=[["日","一","二","三","四","五","六"],["周日","周一","周二","周三","周四","周五","周六"],["星期日","星期一","星期二","星期三","星期四","星期五","星期六"]];if(weekType>=keywordMap.length)return[];const keyword=keywordMap[weekType],applyData=[];for(let i=1;i<=len;i++){const index=(i-1)%data.length,d=src.S0q.deepClone(data[index]);removeCellCustom(d);let num=0;if(data[data.length-1]?.v===keyword[0])num=7+step*i;else{const last=`${data[data.length-1]?.v}`;if(last){num=chineseToNumber(last.substr(last.length-1,1))+step*i}}num<0&&(num=7*Math.ceil(Math.abs(num)/7)+num);const rsd=num%7;d&&(d.v=keyword[rsd],applyData.push(d))}return applyData}function fillChnNumber(data,len,step){const applyData=[];for(let i=1;i<=len;i++){const index=(i-1)%data.length,d=src.S0q.deepClone(data[index]);removeCellCustom(d);const num=chineseToNumber(`${data[data.length-1]?.v}`)+step*i;let txt;txt=num<=0?"零":numberToChinese(num),d&&(d.v=txt,applyData.push(d))}return applyData}const LOOP_SERIES={enWeek1:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],enWeek2:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],enMonth1:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],enMonth2:["January","February","March","April","May","June","July","August","September","October","November","December"],chnMonth1:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],chnMonth2:["正月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","腊月"],chHour1:["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"],chHour2:["子时","丑时","寅时","卯时","辰时","巳时","午时","未时","申时","酉时","戌时","亥时"],chYear1:["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"],chSeason1:["春","夏","秋","冬"],chSeason2:["春季","夏季","秋季","冬季"]};function getLoopSeriesInfo(txt){let name="";const series=[];return Object.keys(LOOP_SERIES).forEach((key=>{LOOP_SERIES[key].includes(txt)&&(name=key,series.push(...LOOP_SERIES[key]))})),{name,series}}function fillLoopSeries(data,len,step,series){const seriesLen=series.length,applyData=[];for(let i=1;i<=len;i++){const index=(i-1)%data.length,d=src.S0q.deepClone(data[index]);removeCellCustom(d);const last=`${data[data.length-1]?.v}`;let num=series.indexOf(last)+step*i;num<0&&(num+=Math.abs(step)*seriesLen);const rsd=num%seriesLen;d&&(d.v=series[rsd],applyData.push(d))}return applyData}function needsUpdateCellValue(cell){return!(0,src.qGs)(cell.f)&&!(0,src.wJp)(cell.si)&&cell.t!==src.scd.BOOLEAN}function removeCellCustom(cell){cell&&"custom"in cell&&delete cell.custom}var AutoFillHookType=function(AutoFillHookType){return AutoFillHookType.Append="APPEND",AutoFillHookType.Default="DEFAULT",AutoFillHookType.Only="ONLY",AutoFillHookType}({}),DATA_TYPE=function(DATA_TYPE){return DATA_TYPE.NUMBER="number",DATA_TYPE.DATE="date",DATA_TYPE.EXTEND_NUMBER="extendNumber",DATA_TYPE.CHN_NUMBER="chnNumber",DATA_TYPE.CHN_WEEK2="chnWeek2",DATA_TYPE.CHN_WEEK3="chnWeek3",DATA_TYPE.LOOP_SERIES="loopSeries",DATA_TYPE.FORMULA="formula",DATA_TYPE.OTHER="other",DATA_TYPE}({}),APPLY_TYPE=function(APPLY_TYPE){return APPLY_TYPE.COPY="COPY",APPLY_TYPE.SERIES="SERIES",APPLY_TYPE.ONLY_FORMAT="ONLY_FORMAT",APPLY_TYPE.NO_FORMAT="NO_FORMAT",APPLY_TYPE}({});const dateRule={type:DATA_TYPE.DATE,priority:1100,match:(cellData,accessor)=>{if(cellData?.f||cellData?.si)return!1;if(("number"==typeof cellData?.v||cellData?.t===src.scd.NUMBER)&&cellData.s)if("string"==typeof cellData.s){const style=accessor.get(src.HCr).getFocusedUnit().getStyles().get(cellData.s),pattern=style?.n?.pattern;if(pattern)return src.gIL.getInfo(pattern).isDate}else if(cellData.s.n&&src.gIL.getInfo(cellData.s.n.pattern).isDate)return!0;return!1},isContinue:(prev,cur)=>prev.type===DATA_TYPE.DATE,applyFunctions:{[APPLY_TYPE.SERIES]:(dataWithIndex,len,direction)=>{const{data}=dataWithIndex;return direction===src.OP3.LEFT||direction===src.OP3.UP?(data.reverse(),fillSeries(data,len,direction).reverse()):fillSeries(data,len,direction)}}},numberRule={type:DATA_TYPE.NUMBER,priority:1e3,match:cellData=>"number"==typeof cellData?.v||cellData?.t===src.scd.NUMBER,isContinue:(prev,cur)=>prev.type===DATA_TYPE.NUMBER,applyFunctions:{[APPLY_TYPE.SERIES]:(dataWithIndex,len,direction)=>{const{data}=dataWithIndex;return direction===src.OP3.LEFT||direction===src.OP3.UP?(data.reverse(),fillSeries(data,len,direction).reverse()):fillSeries(data,len,direction)}}},otherRule={type:DATA_TYPE.OTHER,priority:0,match:()=>!0,isContinue:(prev,cur)=>prev.type===DATA_TYPE.OTHER},extendNumberRule={type:DATA_TYPE.EXTEND_NUMBER,priority:900,match:cellData=>matchExtendNumber(`${cellData?.v}`||"").isExtendNumber,isContinue:(prev,cur)=>{if(prev.type===DATA_TYPE.EXTEND_NUMBER){const{beforeTxt,afterTxt}=matchExtendNumber(`${prev.cellData?.v}`||""),{beforeTxt:curBeforeTxt,afterTxt:curAfterTxt}=matchExtendNumber(`${cur?.v}`||"");if(beforeTxt===curBeforeTxt&&afterTxt===curAfterTxt)return!0}return!1},applyFunctions:{[APPLY_TYPE.SERIES]:(dataWithIndex,len,direction)=>{const{data}=dataWithIndex,isReverse=direction===src.OP3.UP||direction===src.OP3.LEFT;let step;if(1===data.length)return step=isReverse?-1:1,reverseIfNeed(fillExtendNumber(data,len,step),isReverse);const dataNumArr=[];for(let i=0;i<data.length;i++){const txt=`${data[i]?.v}`;txt&&dataNumArr.push(Number(matchExtendNumber(txt).matchTxt))}return isReverse&&(data.reverse(),dataNumArr.reverse()),isEqualDiff(dataNumArr)?(step=dataNumArr[1]-dataNumArr[0],reverseIfNeed(fillExtendNumber(data,len,step),isReverse)):fillCopy(data,len)}}},chnNumberRule={type:DATA_TYPE.CHN_NUMBER,priority:830,match:cellData=>!!function isChnNumber(txt){if(!txt)return!1;let isChnNumber=!0;if(txt)if(1===txt.length)isChnNumber="日"===txt||txt in chnNumChar;else{const str=txt.split("");for(let i=0;i<str.length;i++)if(!(str[i]in chnNumChar)&&!(str[i]in chnNameValue)){isChnNumber=!1;break}}return isChnNumber}(`${cellData?.v}`||""),isContinue:(prev,cur)=>prev.type===DATA_TYPE.CHN_NUMBER,applyFunctions:{[APPLY_TYPE.SERIES]:(dataWithIndex,len,direction)=>{const{data}=dataWithIndex,isReverse=direction===src.OP3.LEFT||direction===src.OP3.UP;if(1===data.length){const formattedValue=`${data[0]?.v}`;let step;return step=isReverse?-1:1,formattedValue&&("日"===formattedValue||chineseToNumber(formattedValue)<7)?reverseIfNeed(fillChnWeek(data,len,step),isReverse):reverseIfNeed(fillChnNumber(data,len,step),isReverse)}let hasWeek=!1;for(let i=0;i<data.length;i++){const formattedValue=data[i]?.v;if("日"===formattedValue){hasWeek=!0;break}}const dataNumArr=[];let weekIndex=0;for(let i=0;i<data.length;i++){const formattedValue=`${data[i]?.v}`;"日"===formattedValue?0===i?dataNumArr.push(0):(weekIndex++,dataNumArr.push(7*weekIndex)):hasWeek&&chineseToNumber(formattedValue)>0&&chineseToNumber(formattedValue)<7?dataNumArr.push(chineseToNumber(formattedValue)+7*weekIndex):dataNumArr.push(chineseToNumber(formattedValue))}if(isReverse&&(data.reverse(),dataNumArr.reverse()),isEqualDiff(dataNumArr)){if(hasWeek||dataNumArr[dataNumArr.length-1]<6&&dataNumArr[0]>0||dataNumArr[0]<6&&dataNumArr[dataNumArr.length-1]>0){return reverseIfNeed(fillChnWeek(data,len,dataNumArr[1]-dataNumArr[0]),isReverse)}return reverseIfNeed(fillChnNumber(data,len,dataNumArr[1]-dataNumArr[0]),isReverse)}return fillCopy(data,len)}}},chnWeek2Rule={type:DATA_TYPE.CHN_WEEK2,priority:820,match:cellData=>!!function isChnWeek2(txt){let isChnWeek2;return isChnWeek2=2===txt.length&&("周一"===txt||"周二"===txt||"周三"===txt||"周四"===txt||"周五"===txt||"周六"===txt||"周日"===txt),isChnWeek2}(`${cellData?.v}`||""),isContinue:(prev,cur)=>prev.type===DATA_TYPE.CHN_WEEK2,applyFunctions:{[APPLY_TYPE.SERIES]:(dataWithIndex,len,direction)=>{const{data}=dataWithIndex,isReverse=direction===src.OP3.LEFT||direction===src.OP3.UP;if(1===data.length){let step;return step=isReverse?-1:1,reverseIfNeed(fillChnWeek(data,len,step,1),isReverse)}const dataNumArr=[];let weekIndex=0;for(let i=0;i<data.length;i++){const formattedValue=`${data[i]?.v}`,lastTxt=formattedValue?.substr(formattedValue.length-1,1);"周日"===formattedValue?0===i?dataNumArr.push(0):(weekIndex++,dataNumArr.push(7*weekIndex)):dataNumArr.push(chineseToNumber(lastTxt)+7*weekIndex)}if(isReverse&&(data.reverse(),dataNumArr.reverse()),isEqualDiff(dataNumArr)){return reverseIfNeed(fillChnWeek(data,len,dataNumArr[1]-dataNumArr[0],1),isReverse)}return fillCopy(data,len)}}},chnWeek3Rule={type:DATA_TYPE.CHN_WEEK3,priority:810,match:cellData=>function isChnWeek3(txt){let isChnWeek3;return isChnWeek3=3===txt.length&&("星期一"===txt||"星期二"===txt||"星期三"===txt||"星期四"===txt||"星期五"===txt||"星期六"===txt||"星期日"===txt),isChnWeek3}(`${cellData?.v}`||""),isContinue:(prev,cur)=>prev.type===DATA_TYPE.CHN_WEEK3,applyFunctions:{[APPLY_TYPE.SERIES]:(dataWithIndex,len,direction)=>{const{data}=dataWithIndex,isReverse=direction===src.OP3.LEFT||direction===src.OP3.UP;if(1===data.length){let step;return step=isReverse?-1:1,reverseIfNeed(fillChnWeek(data,len,step,2),isReverse)}const dataNumArr=[];let weekIndex=0;for(let i=0;i<data.length;i++){const formattedValue=`${data[i]?.v}`;if(formattedValue){const lastTxt=formattedValue.substr(formattedValue.length-1,1);"星期日"===formattedValue?0===i?dataNumArr.push(0):(weekIndex++,dataNumArr.push(7*weekIndex)):dataNumArr.push(chineseToNumber(lastTxt)+7*weekIndex)}}if(isReverse&&(data.reverse(),dataNumArr.reverse()),isEqualDiff(dataNumArr)){return reverseIfNeed(fillChnWeek(data,len,dataNumArr[1]-dataNumArr[0],2),isReverse)}return fillCopy(data,len)}}},loopSeriesRule={type:DATA_TYPE.LOOP_SERIES,priority:800,match:cellData=>function isLoopSeries(txt){let isLoopSeries=!1;return Object.keys(LOOP_SERIES).forEach((key=>{LOOP_SERIES[key].includes(txt)&&(isLoopSeries=!0)})),isLoopSeries}(`${cellData?.v}`||""),isContinue:(prev,cur)=>prev.type===DATA_TYPE.LOOP_SERIES&&getLoopSeriesInfo(`${prev.cellData?.v}`||"").name===getLoopSeriesInfo(`${cur?.v}`||"").name,applyFunctions:{[APPLY_TYPE.SERIES]:(dataWithIndex,len,direction)=>{const{data}=dataWithIndex,isReverse=direction===src.OP3.LEFT||direction===src.OP3.UP,{series}=getLoopSeriesInfo(`${data[0]?.v}`||"");if(1===data.length){let step;return step=isReverse?-1:1,reverseIfNeed(fillLoopSeries(data,len,step,series),isReverse)}const dataNumArr=[];let cycleIndex=0;for(let i=0;i<data.length;i++){const formattedValue=`${data[i]?.v}`;formattedValue&&(formattedValue===series[0]?0===i?dataNumArr.push(0):(cycleIndex++,dataNumArr.push(cycleIndex*series.length)):dataNumArr.push(series.indexOf(formattedValue)+7*cycleIndex))}if(isReverse&&(data.reverse(),dataNumArr.reverse()),isEqualDiff(dataNumArr)){return reverseIfNeed(fillLoopSeries(data,len,dataNumArr[1]-dataNumArr[0],series),isReverse)}return fillCopy(data,len)}}};function reverseIfNeed(data,reverse){return reverse?data.reverse():data}function auto_fill_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function auto_fill_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class AutoFillService extends src.jGt{constructor(_commandService,_undoRedoService,_renderManagerService,_univerInstanceService,_selectionManagerService,_injector){super(),this._commandService=_commandService,this._undoRedoService=_undoRedoService,this._renderManagerService=_renderManagerService,this._univerInstanceService=_univerInstanceService,this._selectionManagerService=_selectionManagerService,this._injector=_injector,this._rules=[],this._hooks=[],this._applyType$=new BehaviorSubject.t(APPLY_TYPE.SERIES),this._isFillingStyle=!0,this._prevUndos=[],this._autoFillLocation$=new BehaviorSubject.t(null),this.autoFillLocation$=this._autoFillLocation$.asObservable(),this._showMenu$=new BehaviorSubject.t(!1),this.showMenu$=this._showMenu$.asObservable(),this._direction=src.OP3.DOWN,this.applyType$=this._applyType$.asObservable(),this._menu$=new BehaviorSubject.t([{label:"autoFill.copy",value:APPLY_TYPE.COPY,disable:!1},{label:"autoFill.series",value:APPLY_TYPE.SERIES,disable:!1},{label:"autoFill.formatOnly",value:APPLY_TYPE.ONLY_FORMAT,disable:!1},{label:"autoFill.noFormat",value:APPLY_TYPE.NO_FORMAT,disable:!1}]),this.menu$=this._menu$.asObservable(),this._init()}_init(){this._rules=[dateRule,numberRule,extendNumberRule,chnNumberRule,chnWeek2Rule,chnWeek3Rule,loopSeriesRule,otherRule].sort(((a,b)=>b.priority-a.priority)),this._isFillingStyle=!0}_getOneByPriority(items){if(items.length<=0)return[];return[items.reduce(((maxItem,currentItem)=>(currentItem.priority||0)>(maxItem.priority||0)?currentItem:maxItem),items[0])]}_initPrevUndo(){this._prevUndos=[]}async triggerAutoFill(unitId,subUnitId,source,selection){if(source.startColumn===selection.startColumn&&source.startRow===selection.startRow&&source.endColumn===selection.endColumn&&source.endRow===selection.endRow)return!1;if(selection.endColumn<source.endColumn&&selection.endColumn>source.startColumn)return this._commandService.executeCommand(AutoClearContentCommand.id,{clearRange:{startRow:selection.startRow,endRow:selection.endRow,startColumn:selection.endColumn+1,endColumn:source.endColumn},selectionRange:selection});if(selection.endRow<source.endRow&&selection.endRow>source.startRow)return this._commandService.executeCommand(AutoClearContentCommand.id,{clearRange:{startRow:selection.endRow+1,endRow:source.endRow,startColumn:selection.startColumn,endColumn:selection.endColumn},selectionRange:selection});const target={startRow:selection.startRow,endRow:selection.endRow,startColumn:selection.startColumn,endColumn:selection.endColumn};let direction=null;if(selection.startRow<source.startRow)direction=src.OP3.UP,target.endRow=source.startRow-1;else if(selection.endRow>source.endRow)direction=src.OP3.DOWN,target.startRow=source.endRow+1;else if(selection.startColumn<source.startColumn)direction=src.OP3.LEFT,target.endColumn=source.startColumn-1;else{if(!(selection.endColumn>source.endColumn))return!1;direction=src.OP3.RIGHT,target.startColumn=source.endColumn+1}this.direction=direction;const autoFillSource=this._injector.invoke((accessor=>(0,sheets_src.tQu)(source,accessor))),autoFillTarget=this._injector.invoke((accessor=>(0,sheets_src.tQu)(target,accessor)));if(!autoFillSource||!autoFillTarget)return!1;this.autoFillLocation={source:autoFillSource,target:autoFillTarget,unitId,subUnitId};const preferTypes=[];this.getActiveHooks().forEach((hook=>{const type=hook?.onBeforeFillData?.({source:autoFillSource,target:autoFillTarget,unitId,subUnitId},direction);type&&preferTypes.unshift(type)})),this._initPrevUndo();for(let i=0;i<preferTypes.length;i++){const menuItem=this.menu.find((m=>m.value===preferTypes[i]));if(menuItem&&!menuItem.disable)return this.fillData(preferTypes[i])}const first=this.menu.find((m=>!1===m.disable))?.value;return!!first&&this.fillData(first)}addHook(hook){if(this._hooks.find((h=>h.id===hook.id)))throw new Error(`Add hook failed, hook id '${hook.id}' already exist!`);return void 0===hook.priority&&(hook.priority=0),void 0===hook.type&&(hook.type=AutoFillHookType.Append),this._hooks.push(hook),(0,src.saO)((()=>{const index=this._hooks.findIndex((item=>item===hook));index>-1&&this._hooks.splice(index,1)}))}registerRule(rule){if(this._rules.find((r=>r.type===rule.type)))throw new Error(`Registry rule failed, type '${rule.type}' already exist!`);const index=this._rules.findIndex((r=>r.priority<rule.priority));this._rules.splice(-1===index?this._rules.length:index,0,rule)}getRules(){return this._rules}getAllHooks(){return this._hooks}getActiveHooks(){const{source,target,unitId,subUnitId}=this.autoFillLocation||{};if(!(source&&target&&unitId&&subUnitId))return[];const enabledHooks=this._hooks.filter((h=>!0==!h.disable?.({source,target,unitId,subUnitId},this._direction,this.applyType))),onlyHooks=enabledHooks.filter((h=>h.type===AutoFillHookType.Only));if(onlyHooks.length>0)return this._getOneByPriority(onlyHooks);return[...this._getOneByPriority(enabledHooks.filter((h=>h.type===AutoFillHookType.Default))),...enabledHooks.filter((h=>h.type===AutoFillHookType.Append))||[]]}get applyType(){return this._applyType$.getValue()}set applyType(type){this._applyType$.next(type)}get menu(){return this._menu$.getValue()}get direction(){return this._direction}set direction(direction){this._direction=direction}isFillingStyle(){return this._isFillingStyle}setFillingStyle(isFillingStyle){this._isFillingStyle=isFillingStyle}get autoFillLocation(){return this._autoFillLocation$.getValue()}set autoFillLocation(location){this._autoFillLocation$.next(location)}setDisableApplyType(type,disable){this._menu$.next(this._menu$.getValue().map((item=>item.value===type?{...item,disable}:item)))}setShowMenu(show){this._showMenu$.next(show)}fillData(applyType){this.applyType=applyType;const{source,target,unitId=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET).getUnitId(),subUnitId=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET).getActiveSheet()?.getSheetId()}=this.autoFillLocation||{};if(!(source&&target&&unitId&&subUnitId))return!1;const direction=this.direction;this._prevUndos.length>0&&this._prevUndos.forEach((undo=>{this._commandService.syncExecuteCommand(undo.id,undo.params)})),this._prevUndos=[];const selection=src.M_G.union(discreteRangeToRange(source),discreteRangeToRange(target)),activeHooks=this.getActiveHooks(),workbook=this._univerInstanceService.getUnit(unitId,src.Zy$.UNIVER_SHEET);this._commandService.syncExecuteCommand(sheets_src.NSB.id,{selections:[{primary:{...this._selectionManagerService.getCurrentLastSelection()?.primary??selection},range:{...selection,rangeType:src.$uV.NORMAL}}],unitId,subUnitId});const undos=[],redos=[];activeHooks.forEach((hook=>{const{undos:hookUndos,redos:hookRedos}=hook.onFillData?.({source,target,unitId,subUnitId},direction,applyType)||{};hookUndos&&undos.push(...hookUndos),hookRedos&&redos.push(...hookRedos)}));const result=redos.every((m=>this._commandService.syncExecuteCommand(m.id,m.params))),autoHeightRanges=[];applyType!==APPLY_TYPE.NO_FORMAT&&redos.forEach((m=>{if(m.id===sheets_src.N48.id){const{cellValue}=m.params;new src.hDc(cellValue).forValue(((row,col,value)=>{const style=Object.keys(workbook.getStyles().get(value?.s)||{});(value?.p||style.length&&AFFECT_LAYOUT_STYLES.some((s=>style.includes(s))))&&autoHeightRanges.push({startRow:row,endRow:row,startColumn:col,endColumn:col})}))}}));const autoHeightUndoRedos=this._getAutoHeightUndoRedos(unitId,subUnitId,autoHeightRanges);return autoHeightUndoRedos.redos.every((m=>this._commandService.syncExecuteCommand(m.id,m.params)))&&(undos.push(...autoHeightUndoRedos.undos),redos.push(...autoHeightUndoRedos.redos)),result&&(this._prevUndos=undos,this._undoRedoService.pushUndoRedo({unitID:unitId,undoMutations:undos,redoMutations:redos})),activeHooks.forEach((hook=>{hook.onAfterFillData?.({source,target,unitId,subUnitId},direction,applyType)})),this.setShowMenu(!0),!0}_getAutoHeightUndoRedos(unitId,subUnitId,ranges){const sheetSkeletonService=this._renderManagerService.getRenderById(unitId)?.with(sheet_skeleton_manager_service_SheetSkeletonManagerService),skeleton=sheetSkeletonService?.getCurrentParam()?.skeleton;if(!skeleton)return{redos:[],undos:[]};const redoParams={subUnitId,unitId,rowsAutoHeightInfo:skeleton.calculateAutoHeightInRange(ranges)},worksheet=skeleton.worksheet,undoParams=(0,sheets_src.w45)(redoParams,worksheet);return{undos:[{id:sheets_src.wXn.id,params:undoParams}],redos:[{id:sheets_src.wXn.id,params:redoParams}]}}}AutoFillService=function auto_fill_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([auto_fill_service_ts_param(0,src.wTY),auto_fill_service_ts_param(1,src.$Dz),auto_fill_service_ts_param(2,engine_render_src.cSx),auto_fill_service_ts_param(3,(0,src.y_5)(src.HCr)),auto_fill_service_ts_param(4,(0,src.y_5)(sheets_src.Fal)),auto_fill_service_ts_param(5,(0,src.y_5)(src.zZn)),auto_fill_service_ts_metadata("design:type",Function),auto_fill_service_ts_metadata("design:paramtypes",[void 0===src.wTY?Object:src.wTY,void 0===src.$Dz?Object:src.$Dz,"undefined"==typeof RenderManagerService?Object:RenderManagerService,void 0===src.HCr?Object:src.HCr,void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===src.zZn?Object:src.zZn])],AutoFillService);const IAutoFillService=(0,src.Qmd)("univer.auto-fill-service"),AutoFillCommand={type:src.g4t.COMMAND,id:"sheet.command.auto-fill",handler:async(accessor,params)=>{const autoFillService=accessor.get(IAutoFillService),univerInstanceService=accessor.get(src.HCr),{sourceRange,targetRange}=params,commandTarget=(0,sheets_src.go2)(univerInstanceService);if(!commandTarget)return!1;const{subUnitId,unitId}=commandTarget;return autoFillService.triggerAutoFill(unitId,subUnitId,sourceRange,targetRange)}},AutoClearContentCommand={id:"sheet.command.auto-clear-content",type:src.g4t.COMMAND,handler:async(accessor,params)=>{const univerInstanceService=accessor.get(src.HCr),commandService=accessor.get(src.wTY),undoRedoService=accessor.get(src.$Dz),sheetInterceptorService=accessor.get(sheets_src.e5R),target=(0,sheets_src.go2)(univerInstanceService);if(!target)return!1;const{unitId,subUnitId}=target,{clearRange,selectionRange}=params,clearMutationParams={subUnitId,unitId,cellValue:(0,sheets_src.w5F)([clearRange])},undoClearMutationParams=(0,sheets_src.hro)(accessor,clearMutationParams),{startColumn,startRow}=selectionRange,param={selections:[{primary:{startColumn,startRow,endColumn:startColumn,endRow:startRow,actualRow:startRow,actualColumn:startColumn,isMerged:!1,isMergedMainCell:!1},range:{...selectionRange}}],unitId,subUnitId};commandService.executeCommand(sheets_src.NSB.id,param);if(commandService.syncExecuteCommand(sheets_src.N48.id,clearMutationParams)){const afterInterceptors=sheetInterceptorService.afterCommandExecute({id:sheets_src.N48.id,params:clearMutationParams});return(0,src.PkI)(afterInterceptors.redos,commandService),undoRedoService.pushUndoRedo({unitID:unitId,undoMutations:[{id:sheets_src.N48.id,params:undoClearMutationParams},...afterInterceptors.undos],redoMutations:[{id:sheets_src.N48.id,params:clearMutationParams},...afterInterceptors.redos]}),!0}return!1}},RefillCommand={id:"sheet.command.refill",type:src.g4t.COMMAND,handler:async(accessor,params)=>accessor.get(IAutoFillService).fillData(params.type)};function editor_bridge_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function editor_bridge_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class EditorBridgeService extends src.jGt{constructor(_sheetInterceptorService,_renderManagerService,_themeService,_univerInstanceService,_editorService,_refSelectionsService,_contextService){super(),this._sheetInterceptorService=_sheetInterceptorService,this._renderManagerService=_renderManagerService,this._themeService=_themeService,this._univerInstanceService=_univerInstanceService,this._editorService=_editorService,this._refSelectionsService=_refSelectionsService,this._contextService=_contextService,this._editorUnitId=src.Fmw,this._editorIsDirty=!1,this._isDisabled=!1,this._visible={visible:!1,eventType:engine_render_src.bKQ.Dblclick,unitId:""},this._currentEditCell=null,this._currentEditCellState=null,this._currentEditCellLayout=null,this._currentEditCellState$=new BehaviorSubject.t(null),this.currentEditCellState$=this._currentEditCellState$.asObservable(),this._currentEditCellLayout$=new BehaviorSubject.t(null),this.currentEditCellLayout$=this._currentEditCellLayout$.asObservable(),this.currentEditCell$=this._currentEditCellState$.pipe((0,switchMap.n)((editCellState=>this._currentEditCellLayout$.pipe((0,operators_map.T)((layout=>editCellState&&layout?{...editCellState,...layout}:null)))))),this._visible$=new BehaviorSubject.t(this._visible),this.visible$=this._visible$.asObservable(),this._afterVisible$=new BehaviorSubject.t(this._visible),this.afterVisible$=this._afterVisible$.asObservable(),this._forceKeepVisible$=new BehaviorSubject.t(!1),this.forceKeepVisible$=this._forceKeepVisible$.asObservable(),this.disposeWithMe((0,src.saO)((()=>{this._currentEditCellState$.complete(),this._currentEditCell=null}))),this._univerInstanceService.getTypeOfUnitDisposed$(src.Zy$.UNIVER_SHEET).subscribe((unit=>{unit.getUnitId()===this._currentEditCellState?.unitId&&this._clearCurrentEditCellState()}))}refreshEditCellState(){const editCellState=this.getLatestEditCellState();if(!editCellState)return this._currentEditCellState=null,this._currentEditCellLayout=null,this._currentEditCellState$.next(null),void this._currentEditCellLayout$.next(null);const{position,scaleX,scaleY,canvasOffset,...rest}=editCellState;this._currentEditCellState=rest,this._currentEditCellLayout={position,scaleX,scaleY,canvasOffset},this._currentEditCellState$.next(this._currentEditCellState),this._currentEditCellLayout$.next(this._currentEditCellLayout)}refreshEditCellPosition(resetSizeOnly){const currentEditCell=this._currentEditCell;if(null==currentEditCell)return;const currentSheet=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET);if(!currentSheet)return;const ru=this._renderManagerService.getRenderUnitById(currentSheet.getUnitId());if(!ru)return;const skeleton=ru.with(sheet_skeleton_manager_service_SheetSkeletonManagerService).getSkeletonParam(currentEditCell.sheetId)?.skeleton,selectionRenderService=ru.with(ISheetSelectionRenderService);if(!skeleton)return;if(!this._currentEditCellState)return;const{primary,unitId,sheetId,scene,engine}=currentEditCell,primaryWithCoord=attachPrimaryWithCoord(skeleton,primary);if(null==primaryWithCoord)return;const actualRangeWithCoord=(0,src.mRw)(primaryWithCoord),canvasOffset=(0,selection_utils.F3)(engine);let{startX,startY,endX,endY}=actualRangeWithCoord;const{scaleX,scaleY}=scene.getAncestorScale(),scrollXY=scene.getViewportScrollXY(selectionRenderService.getViewPort());startX=(0,engine_render_src.kiU)(startX,scaleX,scrollXY),startY=(0,engine_render_src.FgB)(startY,scaleY,scrollXY),endX=(0,engine_render_src.kiU)(endX,scaleX,scrollXY),endY=(0,engine_render_src.FgB)(endY,scaleY,scrollXY),resetSizeOnly&&this._currentEditCellLayout&&(endX=endX-startX+this._currentEditCellLayout.position.startX,endY=endY-startY+this._currentEditCellLayout.position.startY,startX=this._currentEditCellLayout.position.startX,startY=this._currentEditCellLayout.position.startY),this._currentEditCellLayout={position:{startX,startY,endX,endY},canvasOffset,scaleX,scaleY},this._currentEditCellLayout$.next(this._currentEditCellLayout)}setEditCell(param){this._currentEditCell=param,this._editorService.getFocusEditor()||(this._editorService.focus(src.Fmw),this._contextService.setContextValue(src.AF$,!1),this._contextService.setContextValue(src.RFS,!1));const editCellState=this.getLatestEditCellState();if(!editCellState)return this._currentEditCellState=editCellState,this._currentEditCellLayout=editCellState,this._currentEditCellState$.next(editCellState),void this._currentEditCellLayout$.next(editCellState);const{position,canvasOffset,scaleX,scaleY,...rest}=editCellState;this._currentEditCellState=rest,this._currentEditCellLayout={position,canvasOffset,scaleX,scaleY},this._currentEditCellState$.next(this._currentEditCellState),this._currentEditCellLayout$.next(this._currentEditCellLayout)}_clearCurrentEditCellState(){this._currentEditCellState=null,this._currentEditCellState$.next(null),this._currentEditCellLayout=null,this._currentEditCellLayout$.next(null)}getEditCellState(){return null==this._currentEditCellState||null==this._currentEditCellLayout?null:{...this._currentEditCellState,...this._currentEditCellLayout}}getEditCellLayout(){return this._currentEditCellLayout}getEditLocation(){return this._currentEditCellState}updateEditLocation(row,column){this._currentEditCellState&&(this._currentEditCellState={...this._currentEditCellState,row,column})}getLatestEditCellState(){const currentEditCell=this._currentEditCell;if(null==currentEditCell)return;const workbook=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET);if(!workbook)return;const ru=this._renderManagerService.getRenderUnitById(workbook.getUnitId());if(!ru)return;const skeleton=ru.with(sheet_skeleton_manager_service_SheetSkeletonManagerService).getCurrentSkeleton(),selectionRenderService=ru.with(ISheetSelectionRenderService);if(!skeleton)return;const{primary,unitId,sheetId,scene,engine}=currentEditCell,{startRow,startColumn}=primary,primaryWithCoord=attachPrimaryWithCoord(skeleton,primary);if(null==primaryWithCoord)return;const actualRangeWithCoord=(0,src.mRw)(primaryWithCoord),canvasOffset=(0,selection_utils.F3)(engine);let{startX,startY,endX,endY}=actualRangeWithCoord;const{scaleX,scaleY}=scene.getAncestorScale(),scrollXY=scene.getViewportScrollXY(selectionRenderService.getViewPort());startX=(0,engine_render_src.kiU)(startX,scaleX,scrollXY),startY=(0,engine_render_src.FgB)(startY,scaleY,scrollXY),endX=(0,engine_render_src.kiU)(endX,scaleX,scrollXY),endY=(0,engine_render_src.FgB)(endY,scaleY,scrollXY);const worksheet=workbook.getActiveSheet();if(!worksheet)return;const location={workbook,worksheet,unitId:workbook.getUnitId(),subUnitId:worksheet.getSheetId(),row:startRow,col:startColumn,origin:worksheet.getCellRaw(startRow,startColumn)};let documentLayoutObject;const cell=this._sheetInterceptorService.writeCellInterceptor.fetchThroughInterceptors(sheets_src.Yhg)(worksheet.getCell(startRow,startColumn),location);documentLayoutObject=cell&&skeleton.getCellDocumentModelWithFormula(cell);const renderConfig=documentLayoutObject?.documentModel?.documentStyle.renderConfig;if(null!=renderConfig&&(renderConfig.cellValueType=src.scd.STRING),!documentLayoutObject||null==documentLayoutObject.documentModel){const blankModel=skeleton.getBlankCellDocumentModel(cell);if(null!=documentLayoutObject){const{verticalAlign,horizontalAlign,wrapStrategy,textRotation,fill}=documentLayoutObject,{centerAngle,vertexAngle}=(0,engine_render_src.XBM)(textRotation);blankModel.documentModel.documentStyle.renderConfig={...renderConfig,verticalAlign,horizontalAlign,wrapStrategy,background:{rgb:fill},centerAngle,vertexAngle}}documentLayoutObject=blankModel}if(documentLayoutObject.fill=documentLayoutObject.fill||"#fff",documentLayoutObject.documentModel?.setZoomRatio(Math.max(scaleX,scaleY)),!0===cell?.isInArrayFormulaRange){const body=documentLayoutObject.documentModel?.getBody();body&&(body.textRuns=[{st:0,ed:body.dataStream.length-2,ts:{cl:{rgb:this._themeService.getCurrentTheme().textColorSecondary}}}])}return{position:{startX,startY,endX,endY},scaleX,scaleY,canvasOffset,row:startRow,column:startColumn,unitId,sheetId,documentLayoutObject,editorUnitId:this._editorUnitId,isInArrayFormulaRange:cell?.isInArrayFormulaRange}}getCurrentEditorId(){return this._editorUnitId}changeVisible(param){this._visible=param,param.visible&&(this._editorIsDirty=!1),this._visible$.next(this._visible),this._afterVisible$.next(this._visible)}isVisible(){return this._visible}enableForceKeepVisible(){this._forceKeepVisible$.next(!0)}disableForceKeepVisible(){this._forceKeepVisible$.next(!1)}isForceKeepVisible(){return this._forceKeepVisible$.getValue()}changeEditorDirty(dirtyStatus){this._editorIsDirty=dirtyStatus}getEditorDirty(){return this._editorIsDirty}}EditorBridgeService=function editor_bridge_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([editor_bridge_service_ts_param(0,(0,src.y_5)(sheets_src.e5R)),editor_bridge_service_ts_param(1,engine_render_src.cSx),editor_bridge_service_ts_param(2,(0,src.y_5)(src.Fsb)),editor_bridge_service_ts_param(3,src.HCr),editor_bridge_service_ts_param(4,editor_manager_service.I),editor_bridge_service_ts_param(5,sheets_src.BcG),editor_bridge_service_ts_param(6,src.oaf),editor_bridge_service_ts_metadata("design:type",Function),editor_bridge_service_ts_metadata("design:paramtypes",[void 0===sheets_src.e5R?Object:sheets_src.e5R,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===src.Fsb?Object:src.Fsb,void 0===src.HCr?Object:src.HCr,void 0===editor_manager_service.I?Object:editor_manager_service.I,"undefined"==typeof SheetsSelectionsService?Object:SheetsSelectionsService,void 0===src.oaf?Object:src.oaf])],EditorBridgeService);const editor_bridge_service_IEditorBridgeService=(0,src.Qmd)("univer.sheet-editor-bridge.service"),SetCellEditVisibleOperation={id:"sheet.operation.set-cell-edit-visible",type:src.g4t.OPERATION,handler:(accessor,params)=>{if(!params)return!1;const{unitId}=params,workbook=accessor.get(src.HCr).getCurrentUnitForType(src.Zy$.UNIVER_SHEET);if(!workbook)return!1;return accessor.get(editor_bridge_service_IEditorBridgeService).changeVisible({...params,unitId:unitId??workbook.getUnitId()}),!0}},SetCellEditVisibleWithF2Operation={id:"sheet.operation.set-cell-edit-visible-f2",type:src.g4t.OPERATION,handler:(accessor,params)=>{const commandService=accessor.get(src.wTY),workbook=accessor.get(src.HCr).getCurrentUnitForType(src.Zy$.UNIVER_SHEET);return!!workbook&&(commandService.syncExecuteCommand(SetCellEditVisibleOperation.id,{...params,unitId:workbook.getUnitId()}),!0)}},SetCellEditVisibleArrowOperation={id:"sheet.operation.set-cell-edit-visible-arrow",type:src.g4t.OPERATION,handler:()=>!0},ChangeZoomRatioCommand={id:"sheet.command.change-zoom-ratio",type:src.g4t.COMMAND,handler:(accessor,params)=>{if(!params)return!1;const univerInstanceService=accessor.get(src.HCr),target=(0,sheets_src.go2)(univerInstanceService);if(!target)return!1;const{worksheet,subUnitId,unitId}=target,{delta,reset}=params;let zoom=reset?100:Math.round(100*(worksheet.getConfig().zoomRatio+delta));zoom=Math.max(SHEET_ZOOM_RANGE[0],zoom),zoom=Math.min(SHEET_ZOOM_RANGE[1],zoom);const zoomRatio=zoom/100,state=accessor.get(editor_bridge_service_IEditorBridgeService).isVisible();return(state.unitId!==unitId&&state.unitId!==src.azi||!state.visible)&&accessor.get(src.wTY).executeCommand(SetZoomRatioOperation.id,{unitId,subUnitId,zoomRatio})}},SetZoomRatioCommand={id:"sheet.command.set-zoom-ratio",type:src.g4t.COMMAND,handler:(accessor,params)=>{if(!params)return!1;const{unitId,subUnitId,zoomRatio}=params,state=accessor.get(editor_bridge_service_IEditorBridgeService).isVisible();return(state.unitId!==unitId&&state.unitId!==src.azi||!state.visible)&&accessor.get(src.wTY).executeCommand(SetZoomRatioOperation.id,{unitId,subUnitId,zoomRatio})}};function getSheetObject(univerInstanceService,renderManagerService){const workbook=univerInstanceService instanceof src.vxT?univerInstanceService:univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET);if(!workbook)return null;const unitId=workbook.getUnitId();let components,mainComponent,scene,engine;if(function isRenderManagerService(renderManagerService){return void 0===renderManagerService.isMainScene}(renderManagerService)){const currentRender=renderManagerService.getRenderById(unitId);if(null==currentRender)return null;components=currentRender.components,components=currentRender.components,mainComponent=currentRender.mainComponent,scene=currentRender.scene,engine=currentRender.engine}else components=renderManagerService.components,mainComponent=renderManagerService.mainComponent,scene=renderManagerService.scene,engine=renderManagerService.engine;if(!components||!mainComponent)return null;return{spreadsheet:mainComponent,spreadsheetRowHeader:components.get(SHEET_VIEW_KEY.ROW),spreadsheetColumnHeader:components.get(SHEET_VIEW_KEY.COLUMN),spreadsheetLeftTopPlaceholder:components.get(SHEET_VIEW_KEY.LEFT_TOP),scene,engine}}function getCoordByCell(row,col,scene,skeleton){const{startX,startY,endX,endY}=skeleton.getCellWithCoordByIndex(row,col);return{startX,startY,endX,endY}}function getCoordByOffset(evtOffsetX,evtOffsetY,scene,skeleton,viewport,closeFirst){const relativeCoords=scene.getCoordRelativeToViewport(engine_render_src.I9Y.FromArray([evtOffsetX,evtOffsetY])),{x:newEvtOffsetX,y:newEvtOffsetY}=relativeCoords,scrollXY=scene.getScrollXYInfoByViewport(relativeCoords,viewport),{scaleX,scaleY}=scene.getAncestorScale(),moveActualSelection=skeleton.getCellIndexByOffset(newEvtOffsetX,newEvtOffsetY,scaleX,scaleY,scrollXY,{closeFirst}),{row,column}=moveActualSelection,startCell=skeleton.getNoMergeCellWithCoordByIndex(row,column),{startX,startY,endX,endY}=startCell;return{startX,startY,endX,endY,row,column}}function getTransformCoord(evtOffsetX,evtOffsetY,scene,skeleton){const relativeCoords=scene.getCoordRelativeToViewport(engine_render_src.I9Y.FromArray([evtOffsetX,evtOffsetY])),viewMain=scene.getViewport(engine_render_src.p3k.VIEW_MAIN),scrollXY=scene.getScrollXYInfoByViewport(relativeCoords,viewMain),{scaleX,scaleY}=scene.getAncestorScale(),{x:scrollX,y:scrollY}=scrollXY;return{x:evtOffsetX/scaleX+scrollX,y:evtOffsetY/scaleY+scrollY}}function render_controllers_zoom_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function render_controllers_zoom_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class SheetsZoomRenderController extends src.jGt{constructor(_context,_sheetSkeletonManagerService,_commandService,_contextService,_editorBridgeService){super(),this._context=_context,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._commandService=_commandService,this._contextService=_contextService,this._editorBridgeService=_editorBridgeService,this._initSkeletonListener(),this._initZoomEventListener()}updateZoom(worksheetId,zoomRatio){const worksheet=this._context.unit.getSheetBySheetId(worksheetId);return!!worksheet&&(worksheet.getConfig().zoomRatio=zoomRatio,worksheet===this._context.unit.getActiveSheet()&&this._updateViewZoom(zoomRatio),!0)}_initZoomEventListener(){const scene=this._getSheetObject().scene;this.disposeWithMe(scene.onMouseWheel$.subscribeEvent((e=>{if(!e.ctrlKey||!this._contextService.getContextValue(src.xU))return;if(this._editorBridgeService){const state=this._editorBridgeService.isVisible();if((state.unitId===this._context.unitId||state.unitId===src.azi)&&state.visible)return}const deltaFactor=Math.abs(e.deltaX);let ratioDelta=deltaFactor<40?.2:deltaFactor<80?.4:.2;ratioDelta*=e.deltaY>0?-1:1,scene.scaleX<1&&(ratioDelta/=2);const workbook=this._context.unit,sheet=workbook.getActiveSheet();if(!sheet)return;const currentRatio=sheet.getZoomRatio();let nextRatio=+Number.parseFloat(`${currentRatio+ratioDelta}`).toFixed(1);nextRatio=nextRatio>=4?4:nextRatio<=.1?.1:nextRatio,this._commandService.executeCommand(SetZoomRatioCommand.id,{zoomRatio:Math.round(10*nextRatio)/10,unitId:workbook.getUnitId(),subUnitId:sheet.getSheetId()}),e.preventDefault()})))}_initSkeletonListener(){this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((param=>{if(null==param)return;const worksheet=this._context.unit.getActiveSheet();if(!worksheet)return;const zoomRatio=worksheet.getZoomRatio()||1;this._zoom!==zoomRatio&&this._updateViewZoom(zoomRatio),this._zoom=zoomRatio})))}_updateViewZoom(zoomRatio){const sheetObject=this._getSheetObject();sheetObject?.scene.scale(zoomRatio,zoomRatio),sheetObject?.spreadsheet.makeForceDirty()}_getSheetObject(){return getSheetObject(this._context.unit,this._context)}}SheetsZoomRenderController=function render_controllers_zoom_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([render_controllers_zoom_render_controller_ts_param(1,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),render_controllers_zoom_render_controller_ts_param(2,src.wTY),render_controllers_zoom_render_controller_ts_param(3,src.oaf),render_controllers_zoom_render_controller_ts_param(4,(0,src.Xx1)(editor_bridge_service_IEditorBridgeService)),render_controllers_zoom_render_controller_ts_metadata("design:type",Function),render_controllers_zoom_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService,void 0===src.wTY?Object:src.wTY,void 0===src.oaf?Object:src.oaf,void 0===editor_bridge_service_IEditorBridgeService?Object:editor_bridge_service_IEditorBridgeService])],SheetsZoomRenderController);const SetZoomRatioOperation={id:"sheet.operation.set-zoom-ratio",type:src.g4t.OPERATION,handler:(accessor,params)=>{const renderUnit=accessor.get(engine_render_src.cSx).getRenderById(params.unitId);return!!renderUnit&&renderUnit.with(SheetsZoomRenderController).updateZoom(params.subUnitId,params.zoomRatio)}};function sheets_render_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function sheets_render_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class SheetsRenderService extends src.hy_{constructor(_contextService,_instanceSrv,_renderManagerService){super(),this._contextService=_contextService,this._instanceSrv=_instanceSrv,this._renderManagerService=_renderManagerService,this._skeletonChangeMutations=new Set,Promise.resolve().then((()=>this._init()))}registerSkeletonChangingMutations(mutationId){return this._skeletonChangeMutations.has(mutationId)?(0,src.saO)((()=>{})):(this._skeletonChangeMutations.add(mutationId),(0,src.saO)((()=>this._skeletonChangeMutations.delete(mutationId))))}checkMutationShouldTriggerRerender(id){return this._skeletonChangeMutations.has(id)}_init(){this._initWorkbookListener(),this._initContextListener()}_initWorkbookListener(){this._instanceSrv.getTypeOfUnitAdded$(src.Zy$.UNIVER_SHEET).pipe((0,takeUntil.Q)(this.dispose$)).subscribe((workbook=>this._createRenderer(workbook))),this._instanceSrv.getAllUnitsForType(src.Zy$.UNIVER_SHEET).forEach((workbook=>this._createRenderer(workbook))),this._instanceSrv.getTypeOfUnitDisposed$(src.Zy$.UNIVER_SHEET).pipe((0,takeUntil.Q)(this.dispose$)).subscribe((workbook=>this._disposeRenderer(workbook)))}_createRenderer(workbook){const unitId=workbook.getUnitId();this._renderManagerService.created$.subscribe((renderer=>{renderer.unitId===unitId&&(renderer.engine.getCanvas().setId(`univer-sheet-main-canvas_${unitId}`),renderer.engine.getCanvas().getContext().setId(`univer-sheet-main-canvas_${unitId}`))})),this._renderManagerService.createRender(unitId)}_disposeRenderer(workbook){const unitId=workbook.getUnitId();this._renderManagerService.removeRender(unitId)}_initContextListener(){this.disposeWithMe(this._contextService.subscribeContextValue$(engine_render_src.he3).pipe((0,distinctUntilChanged.F)()).subscribe((()=>{this._renderManagerService.getRenderAll().forEach((renderer=>{renderer.mainComponent instanceof engine_render_src.Zux&&renderer.mainComponent.makeForceDirty(!0)}))})))}}function auto_fill_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function auto_fill_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}SheetsRenderService=function sheets_render_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([sheets_render_service_ts_param(0,src.oaf),sheets_render_service_ts_param(1,src.HCr),sheets_render_service_ts_param(2,engine_render_src.cSx),sheets_render_service_ts_metadata("design:type",Function),sheets_render_service_ts_metadata("design:paramtypes",[void 0===src.oaf?Object:src.oaf,void 0===src.HCr?Object:src.HCr,void 0===engine_render_src.cSx?Object:engine_render_src.cSx])],SheetsRenderService);class AutoFillController extends src.jGt{constructor(_univerInstanceService,_commandService,_autoFillService,_editorBridgeService,_renderManagerService,_injector,_sheetsRenderService){super(),this._univerInstanceService=_univerInstanceService,this._commandService=_commandService,this._autoFillService=_autoFillService,this._editorBridgeService=_editorBridgeService,this._renderManagerService=_renderManagerService,this._injector=_injector,this._sheetsRenderService=_sheetsRenderService,this._beforeApplyData=[],this._currentLocation=null,this._copyData=[],this._defaultHook={id:"default",type:AutoFillHookType.Default,priority:0,onBeforeFillData:(location,direction)=>this._presetAndCacheData(location,direction),onFillData:(location,direction,applyType)=>this._fillData(location,direction,applyType)},this._init()}_init(){this._initDefaultHook(),this._initSelectionControlFillChanged(),this._initQuitListener(),this._initSkeletonChange()}_initSkeletonChange(){this.disposeWithMe(this._sheetsRenderService.registerSkeletonChangingMutations(AutoFillCommand.id))}_initDefaultHook(){this.disposeWithMe(this._autoFillService.addHook(this._defaultHook))}_initQuitListener(){const quitCommands=[SetCellEditVisibleOperation.id,AutoClearContentCommand.id,sheets_src.NXV.id,SetZoomRatioOperation.id,sheets_src._M5.id,sheets_src.o2G.id,sheets_src.G4z.id,sheets_src.MIN.id,sheets_src.bS1.id,sheets_src.RmT.id,sheets_src.yNb.id,sheets_src.YJl.id,sheets_src.Cay.id,sheets_src.BtL.id,sheets_src.N48.id];this.disposeWithMe(this._commandService.onCommandExecuted(((command,options)=>{const fromCollab=options?.fromCollab,fromSync=options?.fromSync,fromFormula=options?.fromFormula;!quitCommands.includes(command.id)||fromCollab||fromSync||fromFormula||command.params.trigger===AutoFillCommand.id||command.params.trigger===RefillCommand.id||this._quit(),command.id===sheets_src.fyw.id&&command.params.unitId===this._currentLocation?.unitId&&command.params.subUnitId===this._currentLocation?.subUnitId&&this._quit()}))),this.disposeWithMe(this._univerInstanceService.unitDisposed$.subscribe((unit=>{unit.getUnitId()===this._currentLocation?.unitId&&this._quit()})))}_quit(){this._currentLocation=null,this._beforeApplyData=[],this._copyData=[],this._autoFillService.setShowMenu(!1)}_initSelectionControlFillChanged(){const disposableCollection=new src.VdD,updateListener=()=>{disposableCollection.dispose();const currentRenderer=(0,engine_render_src.iDO)(src.Zy$.UNIVER_SHEET,this._univerInstanceService,this._renderManagerService);if(!currentRenderer)return;currentRenderer.with(ISheetSelectionRenderService).getSelectionControls().forEach((controlSelection=>{disposableCollection.add(controlSelection.selectionFilled$.subscribe((filled=>{if(null==filled||-1===filled.startColumn||-1===filled.startRow||-1===filled.endColumn||-1===filled.endRow)return;const source={startColumn:controlSelection.model.startColumn,endColumn:controlSelection.model.endColumn,startRow:controlSelection.model.startRow,endRow:controlSelection.model.endRow},selection={startColumn:filled.startColumn,endColumn:filled.endColumn,startRow:filled.startRow,endRow:filled.endRow};this._commandService.executeCommand(AutoFillCommand.id,{sourceRange:source,targetRange:selection})}))),disposableCollection.add(controlSelection.fillControl.onDblclick$.subscribeEvent((()=>{const source={startColumn:controlSelection.model.startColumn,endColumn:controlSelection.model.endColumn,startRow:controlSelection.model.startRow,endRow:controlSelection.model.endRow};this._handleDbClickFill(source)}))),disposableCollection.add(controlSelection.fillControl.onPointerDown$.subscribeEvent((()=>{this._editorBridgeService.isVisible().visible&&this._commandService.syncExecuteCommand(SetCellEditVisibleOperation.id,{visible:!1,eventType:engine_render_src.bKQ.PointerDown,unitId:currentRenderer.unitId})})))}))};updateListener(),this.disposeWithMe(this._commandService.onCommandExecuted((command=>{command.id===sheets_src.NSB.id&&updateListener()}))),this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET).subscribe((()=>updateListener())))}_handleDbClickFill(source){const selection=this._detectFillRange(source);selection.endRow<=source.endRow||this._commandService.executeCommand(AutoFillCommand.id,{sourceRange:source,targetRange:selection})}_detectFillRange(source){const{startRow,endRow,startColumn,endColumn}=source,worksheet=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET)?.getActiveSheet();if(!worksheet)return source;const matrix=worksheet.getCellMatrix(),maxRow=worksheet.getMaxRows()-1,maxColumn=worksheet.getMaxColumns()-1;let detectEndRow=endRow;if(startColumn>0&&null!=matrix.getValue(startRow,startColumn-1)?.v){let cur=startRow;for(;null!=matrix.getValue(cur,startColumn-1)?.v&&cur<maxRow;)cur+=1;detectEndRow=cur-1}else if(endColumn<maxColumn&&null!=matrix.getValue(endRow,endColumn+1)?.v){let cur=startRow;for(;null!=matrix.getValue(cur,endColumn+1)?.v&&cur<maxRow;)cur+=1;detectEndRow=cur-1}for(let i=endRow+1;i<=detectEndRow;i++)for(let j=startColumn;j<=endColumn;j++)if(null!=matrix.getValue(i,j)?.v){detectEndRow=i-1;break}return{startColumn,endColumn,startRow,endRow:detectEndRow}}_getApplyData(copyDataPiece,csLen,asLen,direction,applyType,hasStyle=!0,location){const applyData=[],num=Math.floor(asLen/csLen),rsd=asLen%csLen,rules=this._autoFillService.getRules();if(!hasStyle&&applyType===APPLY_TYPE.ONLY_FORMAT)return console.error("ERROR: only format can not be applied when hasStyle is false"),[];const applyDataInTypes={};rules.forEach((r=>{applyDataInTypes[r.type]=[]})),rules.forEach((r=>{const{type,applyFunctions:customApplyFunctions={}}=r,copyDataInType=copyDataPiece[type];copyDataInType&&copyDataInType.forEach((copySquad=>{const s=function getLenS(indexArr,rsd){let s=0;for(let j=0;j<indexArr.length&&indexArr[j]<rsd;j++)s++;return s}(copySquad.index,rsd),len=copySquad.index.length*num+s,arrData=this._applyFunctions(copySquad,len,direction,applyType,customApplyFunctions,copyDataPiece,location),arrIndex=function getDataIndex(csLen,asLen,indexArr){const obj=[],num=Math.floor(asLen/csLen),rsd=asLen%csLen;let sum=0;if(num>0){for(let i=0;i<num;i++)for(let j=0;j<indexArr.length;j++)obj[indexArr[j]+i*csLen]=sum,sum++;for(let a=0;a<indexArr.length&&indexArr[a]<rsd;a++)obj[indexArr[a]+csLen*num]=sum,sum++}else for(let a=0;a<indexArr.length&&indexArr[a]<rsd;a++)obj[indexArr[a]]=sum,sum++;return obj}(csLen,asLen,copySquad.index);applyDataInTypes[type].push({data:arrData,index:arrIndex})}))}));for(let x=0;x<asLen;x++)rules.forEach((r=>{const{type}=r,applyDataInType=applyDataInTypes[type];for(let y=0;y<applyDataInType.length;y++)x in applyDataInType[y].index&&applyData.push(applyDataInType[y].data[applyDataInType[y].index[x]])}));return applyData}_applyFunctions(copySquad,len,direction,applyType,customApplyFunctions,copyDataPiece,location){const{data}=copySquad,isReverse=direction===src.OP3.UP||direction===src.OP3.LEFT;if(applyType===APPLY_TYPE.COPY){const custom=customApplyFunctions?.[APPLY_TYPE.COPY];return custom?custom(copySquad,len,direction,copyDataPiece,location):(isReverse&&data.reverse(),fillCopy(data,len))}if(applyType===APPLY_TYPE.SERIES){const custom=customApplyFunctions?.[APPLY_TYPE.SERIES];return custom?custom(copySquad,len,direction,copyDataPiece):(isReverse&&data.reverse(),customApplyFunctions?.[APPLY_TYPE.COPY]?customApplyFunctions[APPLY_TYPE.COPY](copySquad,len,direction,copyDataPiece,location):fillCopy(data,len))}if(applyType===APPLY_TYPE.ONLY_FORMAT){const custom=customApplyFunctions?.[APPLY_TYPE.ONLY_FORMAT];return custom?custom(copySquad,len,direction,copyDataPiece):function fillCopyStyles(data,len){const applyData=[];for(let i=1;i<=len;i++){const index=(i-1)%data.length,d={s:data[index]?.s};applyData.push(d)}return applyData}(data,len)}}_getCopyData(source,direction){const worksheet=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET).getActiveSheet();if(!worksheet)throw new Error("No active sheet found");const currentCellDatas=worksheet.getCellMatrix(),rules=this._autoFillService.getRules(),copyData=[],isVertical=direction===src.OP3.DOWN||direction===src.OP3.UP;let aArray,bArray;return isVertical?(aArray=source.cols,bArray=source.rows):(aArray=source.rows,bArray=source.cols),aArray.forEach((a=>{const copyDataPiece=this._getEmptyCopyDataPiece(),prevData={type:void 0,cellData:void 0};bArray.forEach((b=>{let data;data=isVertical?currentCellDatas.getValue(b,a):currentCellDatas.getValue(a,b);const{type,isContinue}=rules.find((r=>r.match(data,this._injector)))||otherRule;if(isContinue(prevData,data)){const typeInfo=copyDataPiece[type],last=typeInfo[typeInfo.length-1];last.data.push(data),last.index.push(b-bArray[0])}else{const typeInfo=copyDataPiece[type];typeInfo?typeInfo.push({data:[data],index:[b-bArray[0]]}):copyDataPiece[type]=[{data:[data],index:[b-bArray[0]]}]}prevData.type=type,prevData.cellData=data})),copyData.push(copyDataPiece)})),copyData}_getEmptyCopyDataPiece(){const copyDataPiece={};return this._autoFillService.getRules().forEach((r=>{copyDataPiece[r.type]=[]})),copyDataPiece}_getMergeApplyData(source,target,direction,csLen){const worksheet=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET).getActiveSheet();if(!worksheet)throw new Error("No active sheet found");const applyMergeRanges=[];for(let i=source.startRow;i<=source.endRow;i++)for(let j=source.startColumn;j<=source.endColumn;j++){const{isMergedMainCell,startRow,startColumn,endRow,endColumn}=worksheet.getCellInfoInMergeData(i,j);if(isMergedMainCell)if(direction===src.OP3.DOWN){let windowStartRow=startRow+csLen,windowEndRow=endRow+csLen;for(;windowEndRow<=target.endRow;)applyMergeRanges.push({startRow:windowStartRow,startColumn,endRow:windowEndRow,endColumn}),windowStartRow+=csLen,windowEndRow+=csLen}else if(direction===src.OP3.UP){let windowStartRow=startRow-csLen,windowEndRow=endRow-csLen;for(;windowStartRow>=target.startRow;)applyMergeRanges.push({startRow:windowStartRow,startColumn,endRow:windowEndRow,endColumn}),windowStartRow-=csLen,windowEndRow-=csLen}else if(direction===src.OP3.RIGHT){let windowStartColumn=startColumn+csLen,windowEndColumn=endColumn+csLen;for(;windowEndColumn<=target.endColumn;)applyMergeRanges.push({startRow,startColumn:windowStartColumn,endRow,endColumn:windowEndColumn}),windowStartColumn+=csLen,windowEndColumn+=csLen}else if(direction===src.OP3.LEFT){let windowStartColumn=startColumn-csLen,windowEndColumn=endColumn-csLen;for(;windowStartColumn>=target.startColumn;)applyMergeRanges.push({startRow,startColumn:windowStartColumn,endRow,endColumn:windowEndColumn}),windowStartColumn-=csLen,windowEndColumn-=csLen}}return applyMergeRanges}_presetAndCacheData(location,direction){const{source,target}=location,worksheet=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET).getActiveSheet();if(!worksheet)throw new Error("No active sheet found");const currentCellDatas=worksheet.getCellMatrix(),applyData=[];return target.rows.forEach((i=>{const row=[];target.cols.forEach((j=>{row.push(src.S0q.deepClone(currentCellDatas.getValue(i,j)))})),applyData.push(row)})),this._beforeApplyData=applyData,this._copyData=this._getCopyData(source,direction),this._currentLocation=location,this._shouldDisableSeries(this._copyData)?(this._autoFillService.setDisableApplyType(APPLY_TYPE.SERIES,!0),APPLY_TYPE.COPY):(this._autoFillService.setDisableApplyType(APPLY_TYPE.SERIES,!1),this._getPreferredApplyType(this._copyData))}_fillData(location,direction,applyType){const undos=[],redos=[];let hasStyle=!0;applyType===APPLY_TYPE.NO_FORMAT&&(hasStyle=!1,applyType=APPLY_TYPE.SERIES);const{source,target,unitId,subUnitId}=location;if(!source||!target||null==direction)return{undos,redos};const sourceRange=discreteRangeToRange(source),targetRange=discreteRangeToRange(target),{cols:targetCols,rows:targetRows}=target,{cols:sourceCols,rows:sourceRows}=source,copyData=this._copyData;let csLen;csLen=direction===src.OP3.DOWN||direction===src.OP3.UP?sourceRows.length:sourceCols.length;const applyDatas=[];if(direction===src.OP3.DOWN||direction===src.OP3.UP){const asLen=targetRows.length,untransformedApplyDatas=[];targetCols.forEach(((_,i)=>{const copyD=copyData[i],applyData=this._getApplyData(copyD,csLen,asLen,direction,applyType,hasStyle,location);untransformedApplyDatas.push(applyData)}));for(let i=0;i<untransformedApplyDatas[0].length;i++){const row=[];for(let j=0;j<untransformedApplyDatas.length;j++)row.push({s:null,...untransformedApplyDatas[j][i]});applyDatas.push(row)}}else{const asLen=targetCols.length;targetRows.forEach(((_,i)=>{const copyD=copyData[i],applyData=this._getApplyData(copyD,csLen,asLen,direction,applyType,hasStyle,location),row=[];for(let j=0;j<applyData.length;j++)row.push({s:null,...applyData[j]});applyDatas.push(row)}))}let applyMergeRanges=[];const style=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET).getStyles();if(hasStyle?(applyMergeRanges=this._getMergeApplyData(sourceRange,targetRange,direction,csLen),applyDatas.forEach((row=>{row.forEach((cellData=>{cellData&&style&&style&&(cellData.s=style.getStyleByCell(cellData))}))}))):applyDatas.forEach(((row,rowIndex)=>{row.forEach(((cellData,colIndex)=>{cellData&&style&&(cellData.s=style.getStyleByCell(this._beforeApplyData[rowIndex][colIndex])||null)}))})),applyType===APPLY_TYPE.ONLY_FORMAT&&applyDatas.forEach(((row,rowIndex)=>{row.forEach(((cellData,colIndex)=>{if(cellData){const old=this._beforeApplyData[rowIndex][colIndex]||{};cellData.f=old.f,cellData.si=old.si,cellData.t=old.t,cellData.v=old.v}}))})),hasStyle){const deleteMergeRanges=[],mergeData=this._univerInstanceService.getUniverSheetInstance(unitId)?.getSheetBySheetId(subUnitId)?.getMergeData();mergeData&&mergeData.forEach((merge=>{src.M_G.intersects(merge,targetRange)&&deleteMergeRanges.push(merge)}));const removeMergeMutationParams={unitId,subUnitId,ranges:deleteMergeRanges},undoRemoveMergeMutationParams=this._injector.invoke(sheets_src.IX1,removeMergeMutationParams);deleteMergeRanges.length&&(redos.push({id:sheets_src._L3.id,params:removeMergeMutationParams}),undos.unshift({id:sheets_src.zo2.id,params:undoRemoveMergeMutationParams}))}const clearMutationParams={subUnitId,unitId,cellValue:generateNullCellValueRowCol([target])},undoClearMutationParams=this._injector.invoke(sheets_src.hro,clearMutationParams);redos.push({id:sheets_src.N48.id,params:clearMutationParams}),undos.unshift({id:sheets_src.N48.id,params:undoClearMutationParams});const cellValue=new src.hDc;targetRows.forEach(((row,rowIndex)=>{targetCols.forEach(((col,colIndex)=>{applyDatas[rowIndex][colIndex]&&cellValue.setValue(row,col,applyDatas[rowIndex][colIndex])}))}));const cellValueMatrix=cellValue.getMatrix(),setRangeValuesMutationParams={subUnitId,unitId,cellValue:cellValueMatrix},undoSetRangeValuesMutationParams=this._injector.invoke(sheets_src.hro,setRangeValuesMutationParams);if(this._autoFillService.getActiveHooks().forEach((hook=>{hook.onBeforeSubmit?.(location,direction,applyType,cellValueMatrix)})),undos.unshift({id:sheets_src.N48.id,params:undoSetRangeValuesMutationParams}),redos.push({id:sheets_src.N48.id,params:setRangeValuesMutationParams}),applyMergeRanges?.length){const addMergeMutationParams={unitId,subUnitId,ranges:(0,sheets_src.h9R)(applyMergeRanges)},undoAddMergeMutationParams=this._injector.invoke(sheets_src.PL,addMergeMutationParams);undos.unshift({id:sheets_src._L3.id,params:undoAddMergeMutationParams}),redos.push({id:sheets_src.zo2.id,params:addMergeMutationParams})}return{undos,redos}}_shouldDisableSeries(copyData){return copyData.every((copyDataPiece=>Object.keys(copyDataPiece).every((type=>0===copyDataPiece[type]?.length||[DATA_TYPE.OTHER,DATA_TYPE.FORMULA].includes(type)))))}_getPreferredApplyType(copyData){return copyData.every((copyDataPiece=>Object.keys(copyDataPiece).every((type=>0===copyDataPiece[type]?.length||1===copyDataPiece[type]?.length&&1===copyDataPiece[type][0].data.length&&DATA_TYPE.NUMBER===type))))?APPLY_TYPE.COPY:APPLY_TYPE.SERIES}}function cell_custom_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function cell_custom_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}AutoFillController=function auto_fill_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([auto_fill_controller_ts_param(0,src.HCr),auto_fill_controller_ts_param(1,src.wTY),auto_fill_controller_ts_param(2,IAutoFillService),auto_fill_controller_ts_param(3,editor_bridge_service_IEditorBridgeService),auto_fill_controller_ts_param(4,engine_render_src.cSx),auto_fill_controller_ts_param(5,(0,src.y_5)(src.zZn)),auto_fill_controller_ts_param(6,(0,src.y_5)(SheetsRenderService)),auto_fill_controller_ts_metadata("design:type",Function),auto_fill_controller_ts_metadata("design:paramtypes",[void 0===src.HCr?Object:src.HCr,void 0===src.wTY?Object:src.wTY,void 0===IAutoFillService?Object:IAutoFillService,void 0===editor_bridge_service_IEditorBridgeService?Object:editor_bridge_service_IEditorBridgeService,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===src.zZn?Object:src.zZn,void 0===SheetsRenderService?Object:SheetsRenderService])],AutoFillController);class CellCustomRenderController extends src.jGt{constructor(_context,_sheetSkeletonManagerService,_renderManagerService,_permissionService){super(),this._context=_context,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._renderManagerService=_renderManagerService,this._permissionService=_permissionService,this._initEventBinding()}_initEventBinding(){const disposableCollection=new src.VdD,workbook=this._context.unit,handleSkeletonChange=skeletonParam=>{if(disposableCollection.dispose(),!skeletonParam)return;const unitId=this._context.unitId,{skeleton}=skeletonParam,currentRender=this._renderManagerService.getRenderById(unitId);if(currentRender&&currentRender.mainComponent){const spreadsheet=currentRender.mainComponent,getActiveRender=evt=>{const{offsetX,offsetY}=evt,scene=currentRender.scene,worksheet=workbook.getActiveSheet();if(!worksheet)return;const activeViewport=scene.getActiveViewportByCoord(engine_render_src.I9Y.FromArray([offsetX,offsetY]));if(!activeViewport)return;const{scaleX,scaleY}=scene.getAncestorScale(),scrollXY={x:activeViewport.viewportScrollX,y:activeViewport.viewportScrollY},cellPos=skeleton.getCellIndexByOffset(offsetX,offsetY,scaleX,scaleY,scrollXY),mergeCell=skeleton.worksheet.getMergedCell(cellPos.row,cellPos.column),cellIndex={actualRow:mergeCell?mergeCell.startRow:cellPos.row,actualCol:mergeCell?mergeCell.startColumn:cellPos.column,mergeCell,row:cellPos.row,col:cellPos.column};if(!cellIndex||!skeleton)return;const cellData=worksheet.getCell(cellIndex.actualRow,cellIndex.actualCol);if(!cellData)return;const renders=cellData.customRender;if(!renders?.length)return;const row=cellIndex.actualRow,col=cellIndex.actualCol,sortedRenders=renders.sort(src.YRy),subUnitId=worksheet.getSheetId(),info={data:cellData,style:skeleton.getStyles().getStyleByCell(cellData),primaryWithCoord:skeleton.getCellWithCoordByIndex(cellIndex.actualRow,cellIndex.actualCol),unitId,subUnitId,row,col,workbook,worksheet},position={x:scrollXY.x+offsetX/scaleX,y:scrollXY.y+offsetY/scaleY},activeRender=sortedRenders.find((render=>render.isHit?.(position,info)));return activeRender?[activeRender,info]:void 0},disposable=spreadsheet.onPointerDown$.subscribeEvent((evt=>{const activeRenderInfo=getActiveRender(evt);if(activeRenderInfo){const[activeRender,cellContext]=activeRenderInfo,{row,col,worksheet,unitId,subUnitId}=cellContext,sheetEditable=this._permissionService.composePermission([new sheets_src.W30(unitId).id,new sheets_src.qGK(unitId,subUnitId).id])?.every((permission=>permission.value));if(!sheetEditable)return!1;const permission=worksheet.getCell(row,col)?.selectionProtection?.[0];if(!1===permission?.[sheets_src.pS2.Edit])return!1;activeRender.onPointerDown?.(cellContext,evt)}})),moveDisposable=(0,src.Ldp)(spreadsheet.onPointerMove$).pipe((0,throttleTime.c)(30)).subscribe((evt=>{const activeRenderInfo=getActiveRender(evt);if(activeRenderInfo){const[activeRender,cellContext]=activeRenderInfo;this._enterActiveRender?this._enterActiveRender.render!==activeRender&&(this._enterActiveRender.render.onPointerLeave?.(this._enterActiveRender.cellContext,evt),this._enterActiveRender={render:activeRender,cellContext},activeRender.onPointerEnter?.(cellContext,evt)):(this._enterActiveRender={render:activeRender,cellContext},activeRender.onPointerEnter?.(cellContext,evt))}else this._enterActiveRender&&(this._enterActiveRender.render.onPointerLeave?.(this._enterActiveRender.cellContext,evt),this._enterActiveRender=null)}));disposable&&disposableCollection.add(disposable),moveDisposable&&disposableCollection.add(moveDisposable)}};this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(handleSkeletonChange)),handleSkeletonChange(this._sheetSkeletonManagerService.getCurrentParam()),this.disposeWithMe(disposableCollection)}}CellCustomRenderController=function cell_custom_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([cell_custom_render_controller_ts_param(1,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),cell_custom_render_controller_ts_param(2,engine_render_src.cSx),cell_custom_render_controller_ts_param(3,src.QWp),cell_custom_render_controller_ts_metadata("design:type",Function),cell_custom_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService,"undefined"==typeof RenderManagerService?Object:RenderManagerService,void 0===src.QWp?Object:src.QWp])],CellCustomRenderController);var src_util=__webpack_require__("../../packages/engine-numfmt/src/util.ts");class SelectAllService extends src.jGt{constructor(...args){super(...args),this.rangesStack=[],this.selectedRangeWorksheet=""}}function shortcut_experience_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function shortcut_experience_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class ShortcutExperienceService{constructor(_univerInstanceService,_localeService){this._univerInstanceService=_univerInstanceService,this._localeService=_localeService,this._current=null,this._shortcutParam=[]}dispose(){this._shortcutParam=[]}getCurrentBySearch(searchParm){return this._getCurrentBySearch(searchParm)}getCurrent(){return this._getCurrentBySearch(this._current)}addOrUpdate(insertParam){const param=this._getCurrentBySearch({unitId:insertParam.unitId,sheetId:insertParam.sheetId,keycode:insertParam.keycode});if(null!=param){const index=this._shortcutParam.indexOf(param);this._shortcutParam.splice(index,1)}return this._shortcutParam.push(insertParam),param}remove(searchParm){if(null==searchParm)return;const param=this._getCurrentBySearch(searchParm);if(null==param)return;const index=this._shortcutParam.indexOf(param);return this._shortcutParam.splice(index,1)[0]}_getCurrentBySearch(searchParm){if(null==searchParm)return;return this._shortcutParam.find((param=>param.unitId===searchParm.unitId&&param.sheetId===searchParm.sheetId&&param.keycode===searchParm.keycode))}}ShortcutExperienceService=function shortcut_experience_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([shortcut_experience_service_ts_param(0,src.HCr),shortcut_experience_service_ts_param(1,(0,src.y_5)(src.iH9)),shortcut_experience_service_ts_metadata("design:type",Function),shortcut_experience_service_ts_metadata("design:paramtypes",[void 0===src.HCr?Object:src.HCr,void 0===src.iH9?Object:src.iH9])],ShortcutExperienceService);var MergeType=function(MergeType){return MergeType.MergeAll="mergeAll",MergeType.MergeVertical="mergeVertical",MergeType.MergeHorizontal="mergeHorizontal",MergeType}({});function findNextRange(startRange,direction,worksheet,boundary,isFindNext=!0,nextStep=1,isGoBack=!0){let next,destRange={...startRange};switch(null==boundary&&(boundary={startRow:0,endRow:worksheet.getRowCount()-1,startColumn:0,endColumn:worksheet.getColumnCount()-1}),direction){case src.OP3.UP:for(next=startRange.startRow-nextStep;next>-1&&!worksheet.getRowVisible(next);)next-=1;next>=boundary.startRow?(destRange.startRow=next,destRange.endRow=next):isGoBack&&(destRange.startRow=boundary.endRow,destRange.endRow=boundary.endRow,isFindNext&&(destRange=findNextRange(destRange,src.OP3.LEFT,worksheet,boundary,!1)));break;case src.OP3.DOWN:for(next=startRange.endRow+nextStep;next<worksheet.getRowCount()&&!worksheet.getRowVisible(next);)next+=1;next<=boundary.endRow?(destRange.startRow=next,destRange.endRow=next):isGoBack&&(destRange.startRow=boundary.startRow,destRange.endRow=boundary.startRow,isFindNext&&(destRange=findNextRange(destRange,src.OP3.RIGHT,worksheet,boundary,!1)));break;case src.OP3.LEFT:for(next=startRange.startColumn-nextStep;next>-1&&!worksheet.getColVisible(next);)next-=1;next>=boundary.startColumn?(destRange.startColumn=next,destRange.endColumn=next):isGoBack&&(destRange.startColumn=boundary.endColumn,destRange.endColumn=boundary.endColumn,isFindNext&&(destRange=findNextRange(destRange,src.OP3.UP,worksheet,boundary,!1)));break;case src.OP3.RIGHT:for(next=startRange.endColumn+nextStep;next<worksheet.getColumnCount()&&!worksheet.getColVisible(next);)next+=1;next<=boundary.endColumn?(destRange.startColumn=next,destRange.endColumn=next):isGoBack&&(destRange.startColumn=boundary.startColumn,destRange.endColumn=boundary.startColumn,isFindNext&&(destRange=findNextRange(destRange,src.OP3.DOWN,worksheet,boundary,!1)))}return destRange}function findNextGapRange(startRange,direction,worksheet){const destRange={...startRange},{startRow,startColumn,endRow,endColumn}=getEdgeOfRange(startRange,direction,worksheet);let currentPositionHasValue=rangeHasValue(worksheet,startRow,startColumn,endRow,endColumn).hasValue,firstMove=!0,shouldContinue=!0;for(;shouldContinue;){if(src.OP3.UP===direction){let next=destRange.startRow-1;for(;next>-1&&!worksheet.getRowVisible(next);)next-=1;if(-1===next){shouldContinue=!1;break}const{hasValue:nextRangeHasValue,matrix}=rangeHasValue(worksheet,next,destRange.startColumn,next,destRange.endColumn);if(currentPositionHasValue&&!nextRangeHasValue&&!firstMove){shouldContinue=!1;break}if(0!==matrix.getLength()){let min=next;matrix.forValue((row=>{min=Math.min(row,min)})),destRange.startRow=min}else destRange.startRow=next;if(destRange.endRow=destRange.startRow,!currentPositionHasValue&&nextRangeHasValue){shouldContinue=!1;break}currentPositionHasValue=nextRangeHasValue,firstMove=!1}if(src.OP3.DOWN===direction){let next=destRange.endRow+1;for(;next<worksheet.getRowCount()&&!worksheet.getRowVisible(next);)next+=1;if(next===worksheet.getRowCount()){shouldContinue=!1;break}const{hasValue:nextRangeHasValue,matrix}=rangeHasValue(worksheet,next,destRange.startColumn,next,destRange.endColumn);if(currentPositionHasValue&&!nextRangeHasValue&&!firstMove){shouldContinue=!1;break}if(0!==matrix.getLength()){let max=next;matrix.forValue(((row,_,value)=>{max=Math.max(row+(value.rowSpan||1)-1,max)})),destRange.endRow=max}else destRange.endRow=next;if(destRange.startRow=destRange.endRow,!currentPositionHasValue&&nextRangeHasValue){shouldContinue=!1;break}currentPositionHasValue=nextRangeHasValue,firstMove=!1}if(src.OP3.LEFT===direction){let next=destRange.startColumn-1;for(;next>-1&&!worksheet.getColVisible(next);)next-=1;if(-1===next){shouldContinue=!1;break}const{hasValue:nextRangeHasValue,matrix}=rangeHasValue(worksheet,destRange.startRow,next,destRange.endRow,next);if(currentPositionHasValue&&!nextRangeHasValue&&!firstMove){shouldContinue=!1;break}if(0!==matrix.getLength()){let min=next;matrix.forValue(((_,col)=>{min=Math.min(col,min)})),destRange.startColumn=min}else destRange.startColumn=next;if(destRange.endColumn=destRange.startColumn,!currentPositionHasValue&&nextRangeHasValue){shouldContinue=!1;break}currentPositionHasValue=nextRangeHasValue,firstMove=!1}if(src.OP3.RIGHT===direction){let next=destRange.endColumn+1;for(;next<worksheet.getColumnCount()&&!worksheet.getColVisible(next);)next+=1;if(next===worksheet.getColumnCount()){shouldContinue=!1;break}const{hasValue:nextRangeHasValue,matrix}=rangeHasValue(worksheet,destRange.startRow,next,destRange.endRow,next);if(currentPositionHasValue&&!nextRangeHasValue&&!firstMove){shouldContinue=!1;break}if(0!==matrix.getLength()){let max=next;matrix.forValue(((_,col,value)=>{max=Math.max(col+(value.colSpan||1)-1,max)})),destRange.endColumn=max}else destRange.endColumn=next;if(destRange.startColumn=destRange.endColumn,!currentPositionHasValue&&nextRangeHasValue){shouldContinue=!1;break}currentPositionHasValue=nextRangeHasValue,firstMove=!1}}return(0,sheets_src.rUp)(destRange,worksheet,!0)}function findNextRangeExpand(startRange,direction,worksheet){return findNextRange(startRange,direction,worksheet,void 0,!1,1,!1)}function expandToWholeSheet(worksheet){return{startRow:0,startColumn:0,endRow:worksheet.getRowCount()-1,endColumn:worksheet.getColumnCount()-1,rangeType:src.$uV.ALL}}function getEdgeOfRange(startRange,direction,worksheet){let destRange;switch(direction){case src.OP3.UP:destRange={startRow:startRange.startRow,startColumn:startRange.startColumn,endRow:startRange.startRow,endColumn:startRange.endColumn,rangeType:src.$uV.NORMAL};break;case src.OP3.DOWN:destRange={startRow:startRange.endRow,startColumn:startRange.startColumn,endRow:startRange.endRow,endColumn:startRange.endColumn,rangeType:src.$uV.NORMAL};break;case src.OP3.LEFT:destRange={startRow:startRange.startRow,startColumn:startRange.startColumn,endRow:startRange.endRow,endColumn:startRange.startColumn,rangeType:src.$uV.NORMAL};break;case src.OP3.RIGHT:destRange={startRow:startRange.startRow,startColumn:startRange.endColumn,endRow:startRange.endRow,endColumn:startRange.endColumn,rangeType:src.$uV.NORMAL};break;default:throw new Error("Invalid direction")}return(0,sheets_src.rUp)(destRange,worksheet,!1)}function rangeHasValue(worksheet,row,col,rowEnd,colEnd){let hasValue=!1;const matrix=worksheet.getMatrixWithMergedCells(row,col,rowEnd,colEnd).forValue(((_,__,value)=>{if(function cellHasValue(cell){return void 0!==cell.v&&null!==cell.v&&""!==cell.v||void 0!==cell.p}(value))return hasValue=!0,!1}));return{hasValue,matrix}}function getStartRange(range,primary,direction){const ret=src.M_G.clone(range);if(null==primary)return ret;switch(direction){case src.OP3.UP:case src.OP3.DOWN:ret.startColumn=ret.endColumn=primary.actualColumn;break;case src.OP3.LEFT:case src.OP3.RIGHT:ret.startRow=ret.endRow=primary.actualRow}return ret}function isAllRowsCovered(allRowRanges,ranges){let start=allRowRanges[0].startRow,end=allRowRanges[0].endRow;allRowRanges.forEach((range=>{const{startRow,endRow}=range;start=Math.min(start,startRow),end=Math.max(end,endRow)}));const covered=new Array(end-start+1).fill(!1);return ranges.forEach((range=>{const{startRow,endRow}=range;for(let i=Math.max(startRow,start);i<=Math.min(endRow,end);i++)covered[i-start]=!0})),allRowRanges.every((range=>{const{startRow,endRow}=range;for(let i=startRow;i<=endRow;i++)if(!covered[i-start])return!1;return!0}))}function isAllColumnsCovered(allColumnRanges,ranges){let start=allColumnRanges[0].startColumn,end=allColumnRanges[0].endColumn;allColumnRanges.forEach((range=>{const{startColumn,endColumn}=range;start=Math.min(start,startColumn),end=Math.max(end,endColumn)}));const covered=new Array(end-start+1).fill(!1);return ranges.forEach((range=>{const{startColumn,endColumn}=range;for(let i=Math.max(startColumn,start);i<=Math.min(endColumn,end);i++)covered[i-start]=!0})),allColumnRanges.every((range=>{const{startColumn,endColumn}=range;for(let i=startColumn;i<=endColumn;i++)if(!covered[i-start])return!1;return!0}))}function getMergeableSelectionsByType(type,selections){return selections?"mergeAll"===type?selections.filter((selection=>selection.startRow!==selection.endRow||selection.startColumn!==selection.endColumn)):"mergeVertical"===type?selections.filter((selection=>selection.startRow!==selection.endRow)):"mergeHorizontal"===type?selections.filter((selection=>selection.startColumn!==selection.endColumn)):selections:null}var JumpOver=function(JumpOver){return JumpOver[JumpOver.moveStopeOne=0]="moveStopeOne",JumpOver[JumpOver.moveGap=1]="moveGap",JumpOver[JumpOver.moveStepPage=2]="moveStepPage",JumpOver[JumpOver.moveStepEnd=3]="moveStepEnd",JumpOver}({});const MoveSelectionCommand={id:"sheet.command.move-selection",type:src.g4t.COMMAND,handler:(accessor,params)=>{if(!params)return!1;const target=(0,sheets_src.go2)(accessor.get(src.HCr));if(!target)return!1;const{workbook,worksheet}=target,selection=(0,sheets_src.jy0)(accessor,params.fromCurrentSelection).getCurrentLastSelection();if(!selection)return!1;const{direction,jumpOver,extra}=params,{range,primary}=selection,startRange=getStartRange(range,primary,direction),next=1===jumpOver?findNextGapRange(startRange,direction,worksheet):findNextRange(startRange,direction,worksheet),destRange=(0,sheets_src.Oqq)(next.startRow,next.startColumn,worksheet);if(src.M_G.equals(destRange,startRange))return!1;const unitId=workbook.getUnitId();accessor.get(ShortcutExperienceService).remove({unitId,sheetId:worksheet.getSheetId(),keycode:ui_src.DD.TAB});const selections=[{range:src.M_G.clone(destRange),primary:{startRow:destRange.startRow,startColumn:destRange.startColumn,endRow:destRange.endRow,endColumn:destRange.endColumn,actualRow:next.startRow,actualColumn:next.startColumn,isMerged:destRange.isMerged,isMergedMainCell:destRange.startRow===next.startRow&&destRange.startColumn===next.startColumn}}];return accessor.get(src.wTY).executeCommand(sheets_src.NSB.id,{unitId:workbook.getUnitId(),subUnitId:worksheet.getSheetId(),selections,type:sheets_src.kFf.MOVE_END,extra,reveal:!0})}},MoveSelectionEnterAndTabCommand={id:"sheet.command.move-selection-enter-tab",type:src.g4t.COMMAND,handler:(accessor,params)=>{if(!params)return!1;const target=(0,sheets_src.go2)(accessor.get(src.HCr));if(!target)return!1;const{workbook,worksheet}=target,selectionsService=(0,sheets_src.jy0)(accessor),{direction,keycode}=params,isReverse=direction===src.OP3.LEFT||direction===src.OP3.UP,selections=selectionsService.getCurrentSelections().concat(),currentSelectionIndex=selections.findIndex((s=>s.primary)),selection=selections[currentSelectionIndex];if(!selection)return!1;const delta=isReverse?-1:1,nextSelection=currentSelectionIndex+delta!==selections.length?selections[currentSelectionIndex+delta]:selections[0],nextSelectionIndex=selections.findIndex((s=>s===nextSelection)),unitId=workbook.getUnitId(),sheetId=worksheet.getSheetId();if(!selection)return!1;const{range}=selection,primary=selection.primary;let startRange=getStartRange(range,primary,direction);const shortcutExperienceService=accessor.get(ShortcutExperienceService),shortcutExperienceParam=shortcutExperienceService.getCurrentBySearch({unitId,sheetId,keycode:ui_src.DD.TAB});let resultRange;const{startRow,endRow,startColumn,endColumn}=range,isLastCell=isReverse?primary.startRow===startRow&&primary.startColumn===startColumn:primary.endRow===endRow&&primary.endColumn===endColumn;if(src.M_G.equals(range,primary)){if(keycode===ui_src.DD.TAB)null==shortcutExperienceParam&&shortcutExperienceService.addOrUpdate({unitId,sheetId,keycode:ui_src.DD.TAB,selection});else{const selectionRemain=shortcutExperienceParam?.selection;if(null!=selectionRemain){const{range,primary}=selectionRemain;startRange=getStartRange(range,primary,direction)}shortcutExperienceService.remove({unitId,sheetId,keycode:ui_src.DD.TAB})}const next=findNextRange(startRange,direction,worksheet),destRange=(0,sheets_src.Oqq)(next.startRow,next.startColumn,worksheet);if(src.M_G.equals(destRange,startRange))return!1;resultRange={range:src.M_G.clone(destRange),primary:{startRow:destRange.startRow,startColumn:destRange.startColumn,endRow:destRange.endRow,endColumn:destRange.endColumn,actualRow:next.startRow,actualColumn:next.startColumn,isMerged:destRange.isMerged,isMergedMainCell:destRange.startRow===next.startRow&&destRange.startColumn===next.startColumn}}}else{shortcutExperienceService.remove({unitId,sheetId,keycode:ui_src.DD.TAB});const newPrimary=src.S0q.deepClone(primary),next=isLastCell?nextSelection.range:findNextRange({startRow:newPrimary.startRow,startColumn:newPrimary.startColumn,endRow:newPrimary.endRow,endColumn:newPrimary.endColumn},direction,worksheet,{startRow,endRow,startColumn,endColumn}),useLeftTopAsDest=isLastCell&&isReverse,destRange=useLeftTopAsDest?(0,sheets_src.Oqq)(next.endRow,next.endColumn,worksheet):(0,sheets_src.Oqq)(next.startRow,next.startColumn,worksheet);resultRange={range:isLastCell?nextSelection.range:src.M_G.clone(range),primary:{startRow:destRange.startRow,startColumn:destRange.startColumn,endRow:destRange.endRow,endColumn:destRange.endColumn,actualRow:useLeftTopAsDest?destRange.startRow:next.startRow,actualColumn:useLeftTopAsDest?destRange.startColumn:next.startColumn,isMerged:destRange.isMerged,isMergedMainCell:destRange.startRow===next.startRow&&destRange.startColumn===next.startColumn},style:isLastCell?nextSelection.style:selection.style}}isLastCell?(selections[currentSelectionIndex].primary=null,selections[nextSelectionIndex]=resultRange,selectionsService.setSelections(unitId,sheetId,[],sheets_src.kFf.MOVE_END)):selections[currentSelectionIndex]=resultRange;const rs=accessor.get(src.wTY).executeCommand(sheets_src.NSB.id,{unitId,subUnitId:sheetId,type:sheets_src.kFf.MOVE_END,selections,reveal:!0,extra:params.extra}),renderManagerService=accessor.get(engine_render_src.cSx),selectionService=renderManagerService.getRenderById(unitId)?.with(ISheetSelectionRenderService);return selectionService?.refreshSelectionMoveEnd(),rs}},ExpandSelectionCommand={id:"sheet.command.expand-selection",type:src.g4t.COMMAND,handler:(accessor,params)=>{if(!params)return!1;const target=(0,sheets_src.go2)(accessor.get(src.HCr));if(!target)return!1;const{worksheet,unitId,subUnitId}=target,selection=(0,sheets_src.jy0)(accessor).getCurrentLastSelection();if(!selection)return!1;const{range:startRange,primary}=selection,{jumpOver,direction,extra}=params,isShrink=function checkIfShrink(selection,direction,worksheet){const{primary,range}=selection,startRange=src.M_G.clone(range);switch(direction){case src.OP3.UP:case src.OP3.DOWN:startRange.startRow=primary?.startRow??range.startRow,startRange.endRow=primary?.endRow??range.startRow;break;case src.OP3.LEFT:case src.OP3.RIGHT:startRange.startColumn=primary?.startColumn??range.startColumn,startRange.endColumn=primary?.endColumn??range.startColumn}const anchorRange=getEdgeOfRange(startRange,direction,worksheet);switch(direction){case src.OP3.DOWN:return range.startRow<anchorRange.startRow;case src.OP3.UP:return range.endRow>anchorRange.endRow;case src.OP3.LEFT:return anchorRange.endColumn<range.endColumn;case src.OP3.RIGHT:return anchorRange.startColumn>range.startColumn}}(selection,direction,worksheet),destRange=isShrink?1===jumpOver?function shrinkToNextGapRange(startRange,anchorRange,direction,worksheet){const nextGap=findNextGapRange(getEdgeOfRange(startRange,(0,src.qod)(direction),worksheet),direction,worksheet);return direction===src.OP3.UP&&nextGap.startRow<=startRange.startRow||direction===src.OP3.DOWN&&nextGap.endRow>=startRange.endRow?(0,sheets_src.rUp)({...anchorRange,startColumn:startRange.startColumn,endColumn:startRange.endColumn},worksheet,!0):direction===src.OP3.LEFT&&nextGap.startColumn<=startRange.startColumn||direction===src.OP3.RIGHT&&nextGap.endColumn>=startRange.endColumn?(0,sheets_src.rUp)({...anchorRange,startRow:startRange.startRow,endRow:startRange.endRow},worksheet,!0):src.M_G.union(src.M_G.clone(anchorRange),nextGap)}(startRange,{...src.M_G.clone(primary),rangeType:src.$uV.NORMAL},direction,worksheet):function shrinkToNextCell(startRange,direction,worksheet){const shrinkFromEdge=getEdgeOfRange(startRange,(0,src.qod)(direction),worksheet),otherEdge=getEdgeOfRange(startRange,direction,worksheet),next=findNextRangeExpand(shrinkFromEdge,direction,worksheet);return(0,sheets_src.rUp)(src.M_G.union(otherEdge,next),worksheet,!1)}(startRange,direction,worksheet):1===jumpOver?function expandToNextGapRange(startRange,direction,worksheet){const next=findNextGapRange(startRange,direction,worksheet);return(0,sheets_src.rUp)(src.M_G.union(next,startRange),worksheet,!0)}(startRange,direction,worksheet):function expandToNextCell(startRange,direction,worksheet){const next=findNextRangeExpand(startRange,direction,worksheet),destRange={startRow:Math.min(startRange.startRow,next.startRow),startColumn:Math.min(startRange.startColumn,next.startColumn),endRow:Math.max(startRange.endRow,next.endRow),endColumn:Math.max(startRange.endColumn,next.endColumn)};return(0,sheets_src.rUp)(src.M_G.union(startRange,destRange),worksheet)}(startRange,direction,worksheet);return destRange.rangeType=selection.range.rangeType,!src.M_G.equals(destRange,startRange)&&accessor.get(src.wTY).syncExecuteCommand(sheets_src.NSB.id,{unitId,subUnitId,type:sheets_src.kFf.MOVE_END,selections:[{range:destRange,primary}],extra,reveal:!0})}},SelectAllCommand={id:"sheet.command.select-all",type:src.g4t.COMMAND,handler:async(accessor,params={expandToGapFirst:!0,loop:!1})=>{const target=(0,sheets_src.go2)(accessor.get(src.HCr));if(!target)return!1;const selection=(0,sheets_src.jy0)(accessor).getCurrentLastSelection();if(!selection)return!1;const selectAllService=accessor.get(SelectAllService),{worksheet,unitId,subUnitId}=target,id=`${unitId}|${subUnitId}`;id!==selectAllService.selectedRangeWorksheet&&(selectAllService.rangesStack=[],selectAllService.selectedRangeWorksheet=id);const maxRow=worksheet.getMaxRows(),maxCol=worksheet.getMaxColumns(),{expandToGapFirst,loop}=params,{range,primary}=selection,isWholeSheetSelected=range.endColumn===maxCol-1&&range.endRow===maxRow-1&&0===range.startRow&&0===range.startColumn;let destRange;if(selectAllService.rangesStack.some((s=>src.M_G.equals(s,range)))||(selectAllService.rangesStack=[],selectAllService.rangesStack.push(range)),isWholeSheetSelected){if(!loop)return!1;if(selectAllService.rangesStack.findIndex((s=>src.M_G.equals(s,range)))!==selectAllService.rangesStack.length-1)return!1;destRange=selectAllService.rangesStack[0]}else expandToGapFirst?(destRange=(0,sheets_src.OqS)(range,{left:!0,right:!0,up:!0,down:!0},worksheet),src.M_G.equals(destRange,range)&&(destRange=expandToWholeSheet(worksheet))):destRange=expandToWholeSheet(worksheet);return selectAllService.rangesStack.some((s=>src.M_G.equals(s,destRange)))||selectAllService.rangesStack.push(destRange),accessor.get(src.wTY).executeCommand(sheets_src.NSB.id,{unitId,subUnitId,reveal:!0,selections:[{range:destRange,primary}]})}};function scroll_manager_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}class SheetScrollManagerService{constructor(_context,_sheetSkeletonManagerService){this._context=_context,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._scrollStateMap=new Map,this._rawScrollInfo$=new BehaviorSubject.t(null),this.rawScrollInfo$=this._rawScrollInfo$.asObservable(),this.validViewportScrollInfo$=new BehaviorSubject.t(null),this._searchParamForScroll=null}dispose(){this._rawScrollInfo$.complete()}calcViewportScrollFromRowColOffset(scrollInfo){if(!scrollInfo)return{viewportScrollX:0,viewportScrollY:0};let{sheetViewStartColumn,sheetViewStartRow,offsetX,offsetY}=scrollInfo;sheetViewStartRow=sheetViewStartRow||0,offsetY=offsetY||0;const skeleton=this._sheetSkeletonManagerService.getCurrentSkeleton(),rowAcc=skeleton?.rowHeightAccumulation[sheetViewStartRow-1]||0;return{viewportScrollX:(skeleton?.columnWidthAccumulation[sheetViewStartColumn-1]||0)+offsetX,viewportScrollY:rowAcc+offsetY}}setSearchParam(param){this._searchParamForScroll=param}getScrollStateByParam(param){return this._getCurrentScroll(param)}getCurrentScrollState(){return this._getCurrentScroll(this._searchParamForScroll)}setValidScrollState(param){this._setScrollState(param)}emitRawScrollParam(param){this._emitRawScroll(param)}setValidScrollStateToCurrSheet(scroll){if(null==this._searchParamForScroll)return;this._setScrollState({...this._searchParamForScroll,...scroll});const sheetId=this._searchParamForScroll.sheetId,sheetSkeleton=this._sheetSkeletonManagerService.getSkeleton(sheetId);sheetSkeleton&&sheetSkeleton.setScroll(scroll.viewportScrollX,scroll.viewportScrollY)}clear(){null!=this._searchParamForScroll&&this._clearByParamAndNotify(this._searchParamForScroll)}_setScrollState(scrollInfo){const{unitId,sheetId,sheetViewStartColumn,sheetViewStartRow,offsetX,offsetY}=scrollInfo;this._scrollStateMap.has(unitId)||this._scrollStateMap.set(unitId,new Map);const newScrollInfo={sheetViewStartRow,sheetViewStartColumn,offsetX,offsetY};this._scrollStateMap.get(unitId).set(sheetId,newScrollInfo)}_clearByParamAndNotify(param){this._setScrollState({...param,sheetViewStartRow:0,sheetViewStartColumn:0,offsetX:0,offsetY:0}),this._emitRawScroll({sheetViewStartRow:0,sheetViewStartColumn:0,offsetX:0,offsetY:0})}_getCurrentScroll(param){const emptyState={sheetViewStartRow:0,sheetViewStartColumn:0,offsetX:0,offsetY:0};if(null==param)return emptyState;const{unitId,sheetId}=param,currScrollState=this._scrollStateMap.get(unitId)?.get(sheetId);return currScrollState||emptyState}_emitRawScroll(param){this._rawScrollInfo$.next(param)}}SheetScrollManagerService=function scroll_manager_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([function scroll_manager_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}(1,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),scroll_manager_service_ts_metadata("design:type",Function),scroll_manager_service_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService])],SheetScrollManagerService);const SetScrollOperation={id:"sheet.operation.set-scroll",type:src.g4t.OPERATION,handler:(accessor,params)=>{if(!params)return!1;const{unitId,sheetId,offsetX,offsetY,sheetViewStartColumn,sheetViewStartRow}=params;return accessor.get(engine_render_src.cSx).getRenderById(unitId).with(SheetScrollManagerService).emitRawScrollParam({unitId,sheetId,offsetX,offsetY,sheetViewStartRow,sheetViewStartColumn}),!0}},SetScrollRelativeCommand={id:"sheet.command.set-scroll-relative",type:src.g4t.COMMAND,handler:async(accessor,params)=>{const commandService=accessor.get(src.wTY),univerInstanceService=accessor.get(src.HCr),renderManagerSrv=accessor.get(engine_render_src.cSx),target=(0,sheets_src.go2)(univerInstanceService);if(!target)return!1;const{unitId,subUnitId}=target,currentScroll=renderManagerSrv.getRenderById(unitId).with(SheetScrollManagerService).getCurrentScrollState(),{offsetX=0,offsetY=0}=params||{},{sheetViewStartRow=0,sheetViewStartColumn=0,offsetX:currentOffsetX=0,offsetY:currentOffsetY=0}=currentScroll||{};return commandService.executeCommand(SetScrollOperation.id,{unitId,sheetId:subUnitId,sheetViewStartRow,sheetViewStartColumn,offsetX:currentOffsetX+offsetX,offsetY:currentOffsetY+offsetY})}},ScrollCommand={id:"sheet.command.scroll-view",type:src.g4t.COMMAND,handler:(accessor,params)=>{if(!params)return!1;const univerInstanceService=accessor.get(src.HCr),renderManagerSrv=accessor.get(engine_render_src.cSx),target=(0,sheets_src.go2)(univerInstanceService);if(!target)return!1;const{workbook,worksheet,unitId}=target,currentScroll=renderManagerSrv.getRenderById(unitId).with(SheetScrollManagerService).getCurrentScrollState();if(!worksheet)return!1;const{sheetViewStartRow,sheetViewStartColumn,offsetX,offsetY}=params,{sheetViewStartColumn:currentColumn,sheetViewStartRow:currentRow,offsetX:currentOffsetX,offsetY:currentOffsetY}=currentScroll||{},{xSplit,ySplit}=target.worksheet.getConfig().freeze;return accessor.get(src.wTY).syncExecuteCommand(SetScrollOperation.id,{unitId:workbook.getUnitId(),sheetId:worksheet.getSheetId(),sheetViewStartRow:sheetViewStartRow??currentRow??0+ySplit,sheetViewStartColumn:sheetViewStartColumn??currentColumn??0+xSplit,offsetX:offsetX??currentOffsetX,offsetY:offsetY??currentOffsetY})}},ScrollToCellCommand={id:"sheet.command.scroll-to-cell",type:src.g4t.COMMAND,handler:(accessor,params)=>{const instanceService=accessor.get(src.HCr);return accessor.get(engine_render_src.cSx).getRenderById(instanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET).getUnitId()).with(SheetsScrollRenderController).scrollToRange(params.range,params.forceTop,params.forceLeft)}};src.g4t.COMMAND;function scroll_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function scroll_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}MoveSelectionCommand.id,MoveSelectionEnterAndTabCommand.id;class SheetsScrollRenderController extends src.jGt{constructor(_context,_injector,_sheetSkeletonManagerService,_contextService,_commandService,_renderManagerService,_scrollManagerService){super(),this._context=_context,this._injector=_injector,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._contextService=_contextService,this._commandService=_commandService,this._renderManagerService=_renderManagerService,this._scrollManagerService=_scrollManagerService,this._initCommandListener(),this._wheelEventListener(),this._scrollBarEventListener(),this._initSkeletonListener()}_wheelEventListener(){const{scene}=this._context;if(!scene)return;const viewMain=scene.getViewport(engine_render_src.p3k.VIEW_MAIN);viewMain&&this.disposeWithMe(scene.onMouseWheel$.subscribeEvent(((evt,state)=>{if(evt.ctrlKey||!this._contextService.getContextValue(src.xU))return;let offsetX=0,offsetY=0;offsetX=evt.deltaX,evt.shiftKey?offsetX=3*(evt.deltaY||evt.deltaX):offsetY=evt.deltaY,this._commandService.executeCommand(SetScrollRelativeCommand.id,{offsetX,offsetY}),this._context.scene.makeDirty(!0);const isLimitedStore=viewMain.limitedScroll(viewMain.scrollX+offsetX,viewMain.scrollY+offsetY);!isLimitedStore||isLimitedStore.isLimitedX||isLimitedStore.isLimitedY||(evt.preventDefault(),scene.getParent().classType===engine_render_src.FNJ.SCENE_VIEWER&&state.stopPropagation()),viewMain.isWheelPreventDefaultX&&viewMain.isWheelPreventDefaultY&&evt.preventDefault()})))}_scrollBarEventListener(){const{scene}=this._context;if(null==scene)return;const viewportMain=scene.getViewport(engine_render_src.p3k.VIEW_MAIN);viewportMain&&(this.disposeWithMe((0,src.saO)(this._scrollManagerService.rawScrollInfo$.subscribe((rawScrollInfo=>{const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(!skeleton)return;if(null==rawScrollInfo)return void viewportMain.scrollToViewportPos({viewportScrollX:0,viewportScrollY:0});const{sheetViewStartRow,sheetViewStartColumn,offsetX,offsetY}=rawScrollInfo,{startX,startY}=skeleton.getCellWithCoordByIndex(sheetViewStartRow,sheetViewStartColumn,!1),viewportScrollX=startX+offsetX,viewportScrollY=startY+offsetY;viewportMain.scrollToViewportPos({viewportScrollX,viewportScrollY})})))),this.disposeWithMe(viewportMain.onScrollAfter$.subscribeEvent((scrollAfterParam=>{const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(null==skeleton||!1===scrollAfterParam.isTrigger)return;const sheetObject=this._getSheetObject();if(null==skeleton||null==sheetObject)return;const{viewportScrollX,viewportScrollY,scrollX,scrollY}=scrollAfterParam,{row,column,rowOffset,columnOffset}=skeleton.getOffsetRelativeToRowCol(viewportScrollX,viewportScrollY),scrollInfo={sheetViewStartRow:row,sheetViewStartColumn:column,offsetX:columnOffset,offsetY:rowOffset,viewportScrollX,viewportScrollY,scrollX,scrollY};this._scrollManagerService.setValidScrollStateToCurrSheet(scrollInfo),this._scrollManagerService.validViewportScrollInfo$.next({...scrollInfo,viewportScrollX,viewportScrollY,scrollX,scrollY})}))),this.disposeWithMe(viewportMain.onScrollByBar$.subscribeEvent((param=>{const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(null==skeleton||!1===param.isTrigger)return;const sheetObject=this._getSheetObject();if(null==skeleton||null==sheetObject)return;const{viewportScrollX=0,viewportScrollY=0}=param,{row,column,rowOffset,columnOffset}=(this._getFreeze(),skeleton.getOffsetRelativeToRowCol(viewportScrollX,viewportScrollY));this._commandService.executeCommand(ScrollCommand.id,{sheetViewStartRow:row,sheetViewStartColumn:column,offsetX:columnOffset,offsetY:rowOffset})}))))}_initSkeletonListener(){this.disposeWithMe((0,src.saO)(this._sheetSkeletonManagerService.currentSkeletonBefore$.subscribe((param=>{if(null==param)return;const scrollParam={unitId:param.unitId,sheetId:param.sheetId};this._scrollManagerService.setSearchParam(scrollParam);if(!this._getSheetObject())return;const currScrollInfo=this._scrollManagerService.getScrollStateByParam(scrollParam),{viewportScrollX,viewportScrollY}=this._scrollManagerService.calcViewportScrollFromRowColOffset(currScrollInfo);currScrollInfo&&this._updateViewportScroll(viewportScrollX,viewportScrollY)}))))}_updateViewportScroll(viewportScrollX=0,viewportScrollY=0){const sheetObject=this._getSheetObject();if(!sheetObject)return;const scene=sheetObject.scene,viewportMain=scene.getViewport(engine_render_src.p3k.VIEW_MAIN),viewColRight=scene.getViewport(engine_render_src.p3k.VIEW_COLUMN_RIGHT),viewRowBottom=scene.getViewport(engine_render_src.p3k.VIEW_ROW_BOTTOM),viewportMainLeft=scene.getViewport(engine_render_src.p3k.VIEW_MAIN_LEFT),viewportMainTop=scene.getViewport(engine_render_src.p3k.VIEW_MAIN_TOP);viewportMain&&(viewportMain.viewportScrollX=viewportScrollX,viewportMain.viewportScrollY=viewportScrollY),viewRowBottom&&(viewRowBottom.viewportScrollY=viewportScrollY),viewColRight&&(viewColRight.viewportScrollX=viewportScrollX),viewportMainLeft&&(viewportMainLeft.viewportScrollY=viewportScrollY),viewportMainTop&&(viewportMainTop.viewportScrollX=viewportScrollX)}scrollToRange(range,forceTop,forceLeft){let{endRow,endColumn,startColumn,startRow}=range;const bounding=this._getViewportBounding();if(range.rangeType===src.$uV.ROW?(startColumn=0,endColumn=0):range.rangeType===src.$uV.COLUMN&&(startRow=0,endRow=0),!bounding||forceTop||forceLeft)return this._scrollToCell(startRow,startColumn,forceTop,forceLeft);{const row=bounding.startRow>endRow?startRow:endRow,col=bounding.startColumn>endColumn?startColumn:endColumn;return this._scrollToCell(row,col)}}scrollToCell(row,column){const worksheet=this._context.unit.getActiveSheet(),{ySplit:freezeYSplit,xSplit:freezeXSplit}=worksheet.getFreeze();return this._commandService.syncExecuteCommand(ScrollCommand.id,{sheetViewStartRow:row-freezeYSplit,sheetViewStartColumn:column-freezeXSplit,offsetX:0,offsetY:0})}_initCommandListener(){this.disposeWithMe(this._commandService.onCommandExecuted((command=>{switch(command.id){case sheets_src.NSB.id:{const p=command.params;p.unitId===this._context.unitId&&p.reveal&&this._scrollToSelection()}break;case sheets_src.Q8V.id:{const p=command.params;if(p.unitId===this._context.unitId){const rangeParam=p.range;this.scrollToRange(rangeParam)}}break;case ExpandSelectionCommand.id:{const expandParam=command.params;this._scrollToSelectionForExpand(expandParam)}}})))}_scrollToSelectionForExpand(param){setTimeout((()=>{const selection=this._getSelectionsService().getCurrentLastSelection();if(null==selection)return;const{startRow,startColumn,endRow,endColumn}=selection.range,bounds=this._getViewportBounding();if(null==bounds)return;const{startRow:viewportStartRow,startColumn:viewportStartColumn,endRow:viewportEndRow,endColumn:viewportEndColumn}=bounds;let row=0,column=0;row=startRow>viewportStartRow?endRow:endRow<viewportEndRow?startRow:viewportStartRow,column=startColumn>viewportStartColumn?endColumn:endColumn<viewportEndColumn?startColumn:viewportStartColumn,param.direction===src.OP3.DOWN?row=endRow:param.direction===src.OP3.UP?row=startRow:param.direction===src.OP3.RIGHT?column=endColumn:param.direction===src.OP3.LEFT&&(column=startColumn),this._scrollToCell(row,column)}),0)}_getFreeze(){const snapshot=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton.getWorksheetConfig();if(null!=snapshot)return snapshot.freeze}_updateSceneSize(param){if(null==param)return;const{unitId}=this._context,{skeleton}=param,scene=this._renderManagerService.getRenderById(unitId)?.scene;if(null==skeleton||null==scene)return;const{rowTotalHeight,columnTotalWidth,rowHeaderWidthAndMarginLeft,columnHeaderHeightAndMarginTop}=skeleton;this._context.unit.getActiveSheet()&&scene?.transformByState({width:rowHeaderWidthAndMarginLeft+columnTotalWidth,height:columnHeaderHeightAndMarginTop+rowTotalHeight})}_getSheetObject(){return getSheetObject(this._context.unit,this._context)}_scrollToSelectionByDirection(range){const bounds=this._getViewportBounding();if(null==bounds)return!1;const{startRow:viewportStartRow,startColumn:viewportStartColumn,endRow:viewportEndRow,endColumn:viewportEndColumn}=bounds;let row=0,column=0;const{startRow,startColumn,endRow,endColumn}=range;startRow>=viewportStartRow&&(row=endRow),endRow<=viewportEndRow&&(row=startRow),startColumn>=viewportStartColumn&&(column=endColumn),endColumn<=viewportEndColumn&&(column=startColumn),this._scrollToCell(row,column)}_scrollToSelection(targetIsActualRowAndColumn=!0){const selection=this._getSelectionsService().getCurrentLastSelection();if(!selection)return;const{startRow,startColumn,actualRow,actualColumn}=selection.primary??selection.range,selectionStartRow=targetIsActualRowAndColumn?actualRow??startRow:startRow,selectionStartColumn=targetIsActualRowAndColumn?actualColumn??startColumn:startColumn;this._scrollToCell(selectionStartRow,selectionStartColumn)}_getSelectionsService(){return(0,sheets_src.jy0)(this._injector)}_getViewportBounding(){const scene=this._getSheetObject()?.scene;if(null==scene)return;const viewport=scene.getViewport(engine_render_src.p3k.VIEW_MAIN);if(null==viewport)return;const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(null==skeleton)return;const vpInfo=viewport.calcViewportInfo();return skeleton.getRangeByViewBound(vpInfo.viewBound)}_scrollToCell(row,column,forceTop=!1,forceLeft=!1){const{rowHeightAccumulation,columnWidthAccumulation}=this._sheetSkeletonManagerService.getCurrentSkeleton()??{};if(null==rowHeightAccumulation||null==columnWidthAccumulation)return!1;const scene=this._getSheetObject()?.scene;if(null==scene)return!1;const viewport=scene.getViewport(engine_render_src.p3k.VIEW_MAIN);if(null==viewport)return!1;const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(null==skeleton)return!1;const worksheet=this._context.unit.getActiveSheet();if(!worksheet)return!1;row=src.S0q.clamp(row,0,rowHeightAccumulation.length-1),column=src.S0q.clamp(column,0,columnWidthAccumulation.length-1);const{startColumn:scrollableStartCol,startRow:scrollableStartRow,ySplit:freezedRowCount,xSplit:freezedColCount}=worksheet.getFreeze(),bounds=this._getViewportBounding();if(null==bounds)return!1;const{startRow:viewMainStartRow,startColumn:viewMainStartColumn,endRow:viewMainEndRow,endColumn:viewMainEndColumn}=bounds;let startSheetViewRow,startSheetViewColumn;if(row>=scrollableStartRow&&column>=scrollableStartCol-freezedRowCount&&(row<=viewMainStartRow&&(startSheetViewRow=row,forceTop=!0),row>=viewMainEndRow)){const minRowAccumulation=rowHeightAccumulation[row]-viewport.height;for(let r=viewMainStartRow;r<=row&&(startSheetViewRow=r+1,!(rowHeightAccumulation[r]>=minRowAccumulation));r++);}if(column>=scrollableStartCol&&row>=scrollableStartRow-freezedRowCount&&(column<=viewMainStartColumn&&(startSheetViewColumn=column,forceLeft=!0),column>=viewMainEndColumn)){const minColumnAccumulation=columnWidthAccumulation[column]-viewport.width;for(let c=viewMainStartColumn;c<=column&&(startSheetViewColumn=c+1,!(columnWidthAccumulation[c]>=minColumnAccumulation));c++);}if(void 0===startSheetViewRow&&void 0===startSheetViewColumn)return!1;let{offsetX,offsetY,sheetViewStartRow:preSheetViewStartRow,sheetViewStartColumn:preSheetViewStartColumn}=this._scrollManagerService.getCurrentScrollState()||{};if(startSheetViewRow=startSheetViewRow?Math.min(startSheetViewRow,row):preSheetViewStartRow+freezedRowCount,startSheetViewColumn=startSheetViewColumn?Math.min(startSheetViewColumn,column):preSheetViewStartColumn+freezedColCount,forceLeft){offsetX=0,startSheetViewColumn=column;startSheetViewColumn-=skeleton.getHiddenColumnsInRange({startColumn:startSheetViewColumn-freezedColCount,endColumn:startSheetViewColumn}).length}if(forceTop){offsetY=0,startSheetViewRow=row;startSheetViewRow-=skeleton.getHiddenRowsInRange({startRow:startSheetViewRow-freezedRowCount,endRow:startSheetViewRow}).length}return this._commandService.syncExecuteCommand(ScrollCommand.id,{sheetViewStartRow:Math.max(0,startSheetViewRow-freezedRowCount),sheetViewStartColumn:Math.max(0,startSheetViewColumn-freezedColCount),offsetX,offsetY})}}SheetsScrollRenderController=function scroll_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([scroll_render_controller_ts_param(1,(0,src.y_5)(src.zZn)),scroll_render_controller_ts_param(2,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),scroll_render_controller_ts_param(3,src.oaf),scroll_render_controller_ts_param(4,src.wTY),scroll_render_controller_ts_param(5,engine_render_src.cSx),scroll_render_controller_ts_param(6,(0,src.y_5)(SheetScrollManagerService)),scroll_render_controller_ts_metadata("design:type",Function),scroll_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===src.zZn?Object:src.zZn,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService,void 0===src.oaf?Object:src.oaf,void 0===src.wTY?Object:src.wTY,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===SheetScrollManagerService?Object:SheetScrollManagerService])],SheetsScrollRenderController);const ScrollToRangeOperation={id:"sheet.operation.scroll-to-range",type:src.g4t.OPERATION,handler:(accessor,params)=>{if(!params)return!1;const instanceService=accessor.get(src.HCr);return accessor.get(engine_render_src.cSx).getRenderById(instanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET).getUnitId()).with(SheetsScrollRenderController).scrollToRange(params.range,params.forceTop,params.forceLeft)}};class CellEditorManagerService{dispose(){this._state$.complete(),this._state=null,this._rect$.complete(),this._rect=null}setState(param){this._state=param,this._refresh(param)}getRect(){return this._rect}setRect(param){this._rect=param,this._rect$.next(param)}getState(){return this._state}setFocus(param=!1){this._focus=param,this._focus$.next(param)}_refresh(param){this._state$.next(param)}constructor(){this._state=null,this._rect=null,this._state$=new BehaviorSubject.t(null),this.state$=this._state$.asObservable(),this._rect$=new BehaviorSubject.t(null),this.rect$=this._rect$.asObservable(),this._focus=!1,this._focus$=new BehaviorSubject.t(this._focus),this.focus$=this._focus$.asObservable()}}const ICellEditorManagerService=(0,src.Qmd)("univer.sheet-cell-editor-manager.service");var autofill=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/autofill.js"),more_down_single=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/more-down-single.js");const AutoFillPopupMenu=()=>{const commandService=(0,ui_src.fJ)(src.wTY),univerInstanceService=(0,ui_src.fJ)(src.HCr),renderManagerService=(0,ui_src.fJ)(engine_render_src.cSx),autoFillService=(0,ui_src.fJ)(IAutoFillService),localeService=(0,ui_src.fJ)(src.iH9),[menu,setMenu]=(0,react.useState)([]),[visible,setVisible]=(0,react.useState)(!1),[anchor,setAnchor]=(0,react.useState)({row:-1,col:-1}),[selected,setSelected]=(0,react.useState)(APPLY_TYPE.SERIES),[isHovered,setHovered]=(0,react.useState)(!1),workbook=useActiveWorkbook(),{sheetSkeletonManagerService,selectionRenderService}=(0,react.useMemo)((()=>{if(workbook){const ru=renderManagerService.getRenderById(workbook.getUnitId());return{sheetSkeletonManagerService:ru?.with(sheet_skeleton_manager_service_SheetSkeletonManagerService),selectionRenderService:ru?.with(ISheetSelectionRenderService)}}return{sheetSkeletonManagerService:null,selectionRenderService:null}}),[workbook,renderManagerService]),forceUpdate=(()=>{const[,setState]=(0,react.useState)({});return(0,react.useCallback)((()=>setState((prevState=>!prevState))),[])})();if((0,react.useEffect)((()=>commandService.onCommandExecuted(((command,options)=>{command.id===SetScrollOperation.id&&forceUpdate()})).dispose),[forceUpdate,commandService]),(0,react.useEffect)((()=>{const disposable=sheetSkeletonManagerService&&(0,src.saO)(sheetSkeletonManagerService.currentSkeleton$.subscribe((skeleton=>{skeleton&&forceUpdate()})));return disposable?.dispose}),[sheetSkeletonManagerService,forceUpdate]),(0,react.useEffect)((()=>{const disposable=(0,src.saO)(autoFillService.menu$.subscribe((menu=>{setMenu(menu.map((i=>({...i,index:menu.indexOf(i)}))))})));return disposable.dispose}),[autoFillService]),(0,react.useEffect)((()=>(0,src.saO)(autoFillService.showMenu$.subscribe((show=>{const{source,target}=autoFillService.autoFillLocation||{source:null,target:null};if(show&&source&&target){const lastRow=Math.max(source.rows[source.rows.length-1],target.rows[target.rows.length-1]),lastCol=Math.max(source.cols[source.cols.length-1],target.cols[target.cols.length-1]);setAnchor({row:lastRow,col:lastCol})}else setAnchor({row:-1,col:-1})}))).dispose),[autoFillService]),(0,react.useEffect)((()=>(0,src.saO)(autoFillService.applyType$.subscribe((type=>{setSelected(type)}))).dispose),[autoFillService]),(0,react.useEffect)((()=>{function handleClose(){setVisible(!1)}return document.addEventListener("wheel",handleClose),()=>{document.removeEventListener("wheel",handleClose)}}),[visible]),anchor.col<0||anchor.row<0)return null;const sheetObject=getSheetObject(univerInstanceService,renderManagerService);if(!sheetObject||!selectionRenderService)return null;const{scene}=sheetObject,skeleton=sheetSkeletonManagerService?.getCurrentSkeleton(),viewport=selectionRenderService.getViewPort(),scaleX=scene?.scaleX,scaleY=scene?.scaleY,scrollXY=scene?.getViewportScrollXY(viewport);if(!(scaleX&&scene&&scaleX&&scaleY&&scrollXY))return null;const x=skeleton?.getNoMergeCellWithCoordByIndex(anchor.row,anchor.col).endX||0,y=skeleton?.getNoMergeCellWithCoordByIndex(anchor.row,anchor.col).endY||0,relativeX=(0,engine_render_src.kiU)(x,scaleX,scrollXY),relativeY=(0,engine_render_src.FgB)(y,scaleY,scrollXY);if(null==relativeX||null==relativeY)return null;const showMore=visible||isHovered,availableMenu=menu.filter((item=>!item.disable));return(0,jsx_runtime.jsx)("div",{className:"univer-absolute univer-inset-0 univer-z-10 univer-size-0",children:(0,jsx_runtime.jsx)("div",{style:{left:`${relativeX+2}px`,top:`${relativeY+2}px`,position:"absolute"},onMouseEnter:()=>{setHovered(!0)},onMouseLeave:()=>{setHovered(!1)},children:(0,jsx_runtime.jsx)(design_src.rI,{align:"start",items:availableMenu.map((item=>({type:"radio",value:selected,options:[{label:localeService.t(item.label),value:item.value}],onSelect:()=>(item=>{commandService.executeCommand(RefillCommand.id,{type:item.value}),setVisible(!1)})(item)}))),open:visible,onOpenChange:visible=>{setVisible(visible)},children:(0,jsx_runtime.jsxs)("div",{className:(0,design_src.$z)("\n                          univer-flex univer-items-center univer-gap-2 univer-rounded univer-border univer-border-solid\n                          univer-border-gray-200 univer-p-1\n                          hover:univer-bg-gray-100\n                        ",{"univer-bg-gray-100":visible,"univer-bg-white":!visible}),children:[(0,jsx_runtime.jsx)(autofill.A,{style:{color:"#35322B"},extend:{colorChannel1:"rgb(var(--green-700, #409f11))"}}),showMore&&(0,jsx_runtime.jsx)(more_down_single.A,{className:"univer-text-[10px] univer-text-gray-400"})]})})})})};var src_views_count_bar_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/count-bar/index.module.less"),views_count_bar_index_module_options={};views_count_bar_index_module_options.styleTagTransform=styleTagTransform_default(),views_count_bar_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),views_count_bar_index_module_options.insert=insertBySelector_default().bind(null,"head"),views_count_bar_index_module_options.domAPI=styleDomAPI_default(),views_count_bar_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(src_views_count_bar_index_module.A,views_count_bar_index_module_options);const sheets_ui_src_views_count_bar_index_module=src_views_count_bar_index_module.A&&src_views_count_bar_index_module.A.locals?src_views_count_bar_index_module.A.locals:void 0,ZoomSlider_ZOOM_MAP=[50,75,100,125,150,175,200,400];function ZoomSlider_ZoomSlider(){const commandService=(0,ui_src.fJ)(src.wTY),univerInstanceService=(0,ui_src.fJ)(src.HCr),workbook=useActiveWorkbook(),editorBridgeService=(0,ui_src.fJ)(editor_bridge_service_IEditorBridgeService),visible=(0,ui_src.J2)(editorBridgeService.visible$),getCurrentZoom=(0,react.useCallback)((()=>{if(!workbook)return 100;const worksheet=workbook.getActiveSheet(),currentZoom=worksheet&&100*worksheet.getZoomRatio()||100;return Math.round(currentZoom)}),[workbook]),[zoom,setZoom]=(0,react.useState)((()=>getCurrentZoom()));(0,react.useEffect)((()=>{setZoom(getCurrentZoom());return commandService.onCommandExecuted((commandInfo=>{if(commandInfo.id===SetZoomRatioOperation.id||commandInfo.id===sheets_src._M5.id){const currentZoom=getCurrentZoom();setZoom(currentZoom)}})).dispose}),[commandService,getCurrentZoom]);const disabled=visible?.visible&&(visible.unitId===workbook?.getUnitId()||visible.unitId===src.azi);return(0,jsx_runtime.jsx)(ui_src.Ap,{disabled,min:SHEET_ZOOM_RANGE[0],value:zoom,shortcuts:ZoomSlider_ZOOM_MAP,onChange:function handleChange(value){setZoom(value);const workbook=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook?.getActiveSheet();if(null==worksheet)return;const zoomRatio=value/100;commandService.executeCommand(SetZoomRatioCommand.id,{unitId:workbook.getUnitId(),subUnitId:worksheet.getSheetId(),zoomRatio})}})}function CountBar_CountBar(props){return(0,jsx_runtime.jsx)("section",{className:sheets_ui_src_views_count_bar_index_module.countBar,children:(0,jsx_runtime.jsx)(ZoomSlider_ZoomSlider,{})})}function useKeyEventConfig(isRefSelecting,unitId){const editorBridgeService=(0,ui_src.fJ)(editor_bridge_service_IEditorBridgeService),commandService=(0,ui_src.fJ)(src.wTY);return(0,react.useMemo)((()=>({keyCodes:[{keyCode:ui_src.DD.ENTER},{keyCode:ui_src.DD.ESC},{keyCode:ui_src.DD.TAB}],handler:keycode=>{keycode!==ui_src.DD.ENTER&&keycode!==ui_src.DD.ESC&&keycode!==ui_src.DD.TAB||(editorBridgeService.disableForceKeepVisible(),commandService.executeCommand(SetCellEditVisibleOperation.id,{visible:!1,eventType:engine_render_src.bKQ.Keyboard,keycode,unitId}))}})),[commandService,editorBridgeService,unitId])}ZoomSlider_ZoomSlider.__docgenInfo={description:"",methods:[],displayName:"ZoomSlider"},CountBar_CountBar.__docgenInfo={description:"",methods:[],displayName:"CountBar",props:{changeRatio:{required:!1,tsType:{name:"signature",type:"function",raw:"(ratio: string) => void",signature:{arguments:[{type:{name:"string"},name:"ratio"}],return:{name:"void"}}},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""}}};var editor_container_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/editor-container/index.module.less"),editor_container_index_module_options={};editor_container_index_module_options.styleTagTransform=styleTagTransform_default(),editor_container_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),editor_container_index_module_options.insert=insertBySelector_default().bind(null,"head"),editor_container_index_module_options.domAPI=styleDomAPI_default(),editor_container_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(editor_container_index_module.A,editor_container_index_module_options);const views_editor_container_index_module=editor_container_index_module.A&&editor_container_index_module.A.locals?editor_container_index_module.A.locals:void 0,HIDDEN_EDITOR_POSITION=-1e3,EDITOR_DEFAULT_POSITION={width:0,height:0,top:HIDDEN_EDITOR_POSITION,left:HIDDEN_EDITOR_POSITION},EditorContainer=()=>{const[state,setState]=(0,react.useState)({...EDITOR_DEFAULT_POSITION}),cellEditorManagerService=(0,ui_src.fJ)(ICellEditorManagerService),editorService=(0,ui_src.fJ)(editor_manager_service.I),contextService=(0,ui_src.fJ)(src.oaf),componentManager=(0,ui_src.fJ)(ui_src.BJ),editorBridgeService=(0,ui_src.fJ)(editor_bridge_service_IEditorBridgeService),visible=(0,ui_src.J2)(editorBridgeService.visible$),commandService=(0,ui_src.fJ)(src.wTY),isRefSelecting=(0,react.useRef)(0),disableAutoFocus=(0,ui_src.J2)((()=>contextService.subscribeContextValue$(ui_src.If)),!1,void 0,[contextService,ui_src.If]),FormulaEditor=componentManager.get("EMBEDDING_FORMULA_EDITOR_COMPONENT_KEY"),editState=editorBridgeService.getEditLocation();(0,react.useEffect)((()=>{const sub=cellEditorManagerService.state$.subscribe((param=>{if(null==param)return;const{startX=HIDDEN_EDITOR_POSITION,startY=HIDDEN_EDITOR_POSITION,endX=0,endY=0,show=!1}=param;if(show){setState({width:endX-startX,height:endY-startY,left:startX,top:startY});const editor=editorService.getEditor(src.Fmw);if(null==editor)return;const{left,top,width,height}=editor.getBoundingClientRect();cellEditorManagerService.setRect({left,top,width,height})}else setState({...EDITOR_DEFAULT_POSITION})}));return()=>{sub.unsubscribe()}}),[]),(0,react.useEffect)((()=>{disableAutoFocus||cellEditorManagerService.setFocus(!0)}),[disableAutoFocus,state]);const handleClickSideBar=(0,ui_src._q)((()=>{editorBridgeService.isVisible().visible&&commandService.executeCommand(SetCellEditVisibleOperation.id,{visible:!1,eventType:engine_render_src.bKQ.PointerUp,unitId:editState?.unitId})}));(0,ui_src.GK)(handleClickSideBar);const keyCodeConfig=useKeyEventConfig(0,editState?.unitId),onMoveInEditor=(0,ui_src._q)(((keycode,metaKey)=>{commandService.executeCommand(SetCellEditVisibleArrowOperation.id,{keycode,visible:!1,eventType:engine_render_src.bKQ.Keyboard,isShift:metaKey===ui_src.SK.SHIFT||metaKey===(ui_src.SK.CTRL_COMMAND|ui_src.SK.SHIFT),unitId:editState?.unitId})}));return(0,jsx_runtime.jsx)("div",{className:views_editor_container_index_module.editorContainer,style:{left:state.left,top:state.top,width:state.width,height:state.height},children:FormulaEditor&&(0,jsx_runtime.jsx)(FormulaEditor,{editorId:src.Fmw,className:views_editor_container_index_module.editorInput,initValue:"",onChange:()=>{},isFocus:visible?.visible,unitId:editState?.unitId,subUnitId:editState?.sheetId,keyboradEventConfig:keyCodeConfig,onMoveInEditor,isSupportAcrossSheet:!0,resetSelectionOnBlur:!1,isSingle:!1,autoScrollbar:!1,onFormulaSelectingChange:isSelecting=>{isRefSelecting.current=isSelecting,isSelecting?editorBridgeService.enableForceKeepVisible():editorBridgeService.disableForceKeepVisible()},disableSelectionOnClick:!0,disableContextMenu:!1})})};EditorContainer.__docgenInfo={description:"Cell editor container.\n@returns",methods:[],displayName:"EditorContainer"};var close_single=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/close-single.js"),check_mark_single=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/check-mark-single.js"),fx_single=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/fx-single.js"),dropdown_single=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/dropdown-single.js"),empty=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/observable/empty.js");class FormulaEditorManagerService{dispose(){this._position$.complete(),this._focus$.complete(),this._position=null,this._focus=!1}setPosition(param){this._position=param,this._refresh(param)}getPosition(){return this._position}setFocus(param=!1){this._focus=param,this._focus$.next(param)}handleFxBtnClick(params){this._fxBtnClick$.next(params)}handleFoldBtnClick(params){this._foldBtnStatus$.next(params)}_refresh(param){this._position$.next(param)}constructor(){this._position=null,this._position$=new BehaviorSubject.t(null),this.position$=this._position$.asObservable(),this._focus=!1,this._focus$=new BehaviorSubject.t(this._focus),this.focus$=this._focus$.asObservable(),this._fxBtnClick$=new Subject.B,this.fxBtnClick$=this._fxBtnClick$.asObservable(),this._foldBtnStatus$=new Subject.B,this.foldBtnStatus$=this._foldBtnStatus$.asObservable()}}const IFormulaEditorManagerService=(0,src.Qmd)("univer.sheet-formula-editor-manager.service"),SidebarDefinedNameOperation={id:"sidebar.operation.defined-name",type:src.g4t.COMMAND,handler:async(accessor,params)=>{const sidebarService=accessor.get(ui_src.Jj),localeService=(accessor.get(editor_manager_service.I),accessor.get(src.iH9)),univerInstanceService=accessor.get(src.HCr),target=(0,sheets_src.go2)(univerInstanceService);if(!target)return!1;const{unitId}=target;if("open"===params.value)sidebarService.open({id:"DefinedNameContainer",header:{title:localeService.t("definedName.featureTitle")},children:{label:"DefinedNameContainer"},onClose:()=>{},width:333});else sidebarService.close();return!0}};function DefinedNameOverlay(props){const commandService=(0,ui_src.fJ)(src.wTY),localeService=(0,ui_src.fJ)(src.iH9),definedNamesService=(0,ui_src.fJ)(engine_formula_src.ke),univerInstanceService=(0,ui_src.fJ)(src.HCr),sidebarService=(0,ui_src.fJ)(ui_src.Jj),unitId=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET).getUnitId(),getDefinedNameMap=()=>{const definedNameMap=definedNamesService.getDefinedNameMap(unitId);return definedNameMap?Array.from(Object.values(definedNameMap)):[]},[definedNames,setDefinedNames]=(0,react.useState)(getDefinedNameMap());(0,react.useEffect)((()=>{const definedNamesSubscription=definedNamesService.update$.subscribe((()=>{setDefinedNames(getDefinedNameMap())}));return()=>{definedNamesSubscription.unsubscribe()}}),[]),(0,react.useEffect)((()=>{const d=sidebarService.sidebarOptions$.subscribe((info=>{"DefinedNameContainer"===info.id&&(info.visible||setTimeout((()=>{sidebarService.sidebarOptions$.next({visible:!1})})))}));return()=>{d.unsubscribe()}}),[]);return(0,jsx_runtime.jsxs)("div",{className:"univer-w-[300px]",children:[(0,jsx_runtime.jsx)("ul",{className:"\n                  univer-m-0 univer-max-h-[360px] univer-list-none univer-overflow-y-auto univer-p-0\n                  univer-scrollbar-thin univer-scrollbar-track-transparent univer-scrollbar-thumb-gray-300\n                  univer-scrollbar-w-[4px]\n                ",children:definedNames.map(((definedName,index)=>(0,jsx_runtime.jsx)("li",{className:"\n                              univer-cursor-pointer univer-px-2 univer-transition-colors univer-duration-200\n                              dark:hover:univer-bg-gray-600\n                              hover:univer-bg-gray-100\n                            ",onClick:()=>{(async definedName=>{const{formulaOrRefString,id}=definedName,worksheet=definedNamesService.getWorksheetByRef(unitId,formulaOrRefString);if(!worksheet)return;worksheet.isSheetHidden()&&await commandService.executeCommand(sheets_src.dSt.id,{unitId,subUnitId:worksheet.getSheetId()}),definedNamesService.focusRange(unitId,id)})(definedName)},children:(0,jsx_runtime.jsxs)("div",{className:"\n                                  univer-flex univer-items-center univer-justify-between univer-gap-2 univer-border-0\n                                  univer-border-b univer-border-solid univer-border-gray-200 univer-py-1\n                                ",children:[(0,jsx_runtime.jsx)("div",{className:"\n                                      univer-w-[50%] univer-flex-shrink-0 univer-overflow-hidden univer-text-ellipsis\n                                      univer-whitespace-nowrap univer-text-sm univer-text-gray-600\n                                    ",title:definedName.name,children:definedName.name}),(0,jsx_runtime.jsx)("div",{className:"\n                                      univer-w-[50%] univer-flex-shrink-0 univer-overflow-hidden univer-text-ellipsis\n                                      univer-whitespace-nowrap univer-text-xs univer-text-gray-400\n                                    ",title:definedName.formulaOrRefString,children:definedName.formulaOrRefString})]})},index)))}),(0,jsx_runtime.jsxs)("div",{className:"\n                  univer-cursor-pointer univer-p-2 univer-transition-colors univer-duration-200\n                  dark:hover:univer-bg-gray-600\n                  hover:univer-bg-gray-100\n                ",onClick:()=>{commandService.executeCommand(SidebarDefinedNameOperation.id,{value:"open"})},children:[(0,jsx_runtime.jsx)("div",{className:"univer-mb-2 univer-text-sm univer-font-semibold univer-text-gray-600",children:localeService.t("definedName.managerTitle")}),(0,jsx_runtime.jsx)("div",{className:"univer-text-xs univer-text-gray-400",children:localeService.t("definedName.managerDescription")})]})]})}DefinedNameOverlay.__docgenInfo={description:"",methods:[],displayName:"DefinedNameOverlay"};var defined_name_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/defined-name/index.module.less"),defined_name_index_module_options={};defined_name_index_module_options.styleTagTransform=styleTagTransform_default(),defined_name_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),defined_name_index_module_options.insert=insertBySelector_default().bind(null,"head"),defined_name_index_module_options.domAPI=styleDomAPI_default(),defined_name_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(defined_name_index_module.A,defined_name_index_module_options);const views_defined_name_index_module=defined_name_index_module.A&&defined_name_index_module.A.locals?defined_name_index_module.A.locals:void 0;function DefinedName({disable}){const[rangeString,setRangeString]=(0,react.useState)(""),definedNamesService=(0,ui_src.fJ)(engine_formula_src.ke);return(0,react.useEffect)((()=>{const subscription=definedNamesService.currentRange$.subscribe((()=>{setRangeString(definedNamesService.getCurrentRangeForString())}));return()=>{subscription.unsubscribe()}}),[]),(0,jsx_runtime.jsxs)("div",{className:"\n              univer-relative univer-box-border univer-flex univer-h-full univer-w-24 univer-border-r-gray-200\n              univer-py-1.5 univer-transition-all\n            ",children:[(0,jsx_runtime.jsx)("input",{className:(0,design_src.$z)("\n                  univer-box-border univer-h-full univer-w-full univer-appearance-none univer-border-0 univer-border-r\n                  univer-border-r-gray-200 univer-px-1.5\n                  focus:univer-outline-none\n                ",{[views_defined_name_index_module.defineNameInputDisable]:disable}),type:"text",value:rangeString,onChange:function handleChangeSelection(){}}),(0,jsx_runtime.jsx)(design_src.ms,{overlay:(0,jsx_runtime.jsx)("div",{className:"univer-z-[1001]",children:(0,jsx_runtime.jsx)(DefinedNameOverlay,{})}),children:(0,jsx_runtime.jsx)("a",{className:(0,design_src.$z)("\n                      univer-absolute univer-right-0 univer-top-0 univer-flex univer-h-full univer-cursor-pointer\n                      univer-items-center univer-justify-center univer-px-1 univer-transition-colors univer-duration-200\n                      hover:univer-bg-gray-100\n                    ",{"univer-cursor-not-allowed univer-text-gray-300 hover:univer-bg-transparent":disable}),children:(0,jsx_runtime.jsx)(more_down_single.A,{})})})]})}DefinedName.__docgenInfo={description:"",methods:[],displayName:"DefinedName",props:{disable:{required:!0,tsType:{name:"boolean"},description:""}}};var formula_bar_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/formula-bar/index.module.less"),formula_bar_index_module_options={};formula_bar_index_module_options.styleTagTransform=styleTagTransform_default(),formula_bar_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),formula_bar_index_module_options.insert=insertBySelector_default().bind(null,"head"),formula_bar_index_module_options.domAPI=styleDomAPI_default(),formula_bar_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(formula_bar_index_module.A,formula_bar_index_module_options);const views_formula_bar_index_module=formula_bar_index_module.A&&formula_bar_index_module.A.locals?formula_bar_index_module.A.locals:void 0;function FormulaBar(props){const{className}=props,[iconStyle,setIconStyle]=(0,react.useState)(views_formula_bar_index_module.formulaGrey),[arrowDirection,setArrowDirection]=(0,react.useState)(0),formulaEditorManagerService=(0,ui_src.fJ)(IFormulaEditorManagerService),editorBridgeService=(0,ui_src.fJ)(editor_bridge_service_IEditorBridgeService),worksheetProtectionRuleModel=(0,ui_src.fJ)(sheets_src.$af),rangeProtectionRuleModel=(0,ui_src.fJ)(sheets_src.qI9),univerInstanceService=(0,ui_src.fJ)(src.HCr),selectionManager=(0,ui_src.fJ)(sheets_src.Fal),permissionService=(0,ui_src.fJ)(src.QWp),rangeProtectionCache=(0,ui_src.fJ)(sheets_src.vL8),commandService=(0,ui_src.fJ)(src.wTY),[disableInfo,setDisableInfo]=(0,react.useState)({editDisable:!1,viewDisable:!1}),[imageDisable,setImageDisable]=(0,react.useState)(!1),currentWorkbook=useActiveWorkbook(),componentManager=(0,ui_src.fJ)(ui_src.BJ),workbook=(0,ui_src.J2)((()=>univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET)),void 0,void 0,[]),isRefSelecting=(0,react.useRef)(0),editState=(0,ui_src.J2)(editorBridgeService.currentEditCellState$),keyCodeConfig=useKeyEventConfig(0,editState?.unitId??""),FormulaEditor=componentManager.get("EMBEDDING_FORMULA_EDITOR_COMPONENT_KEY"),formulaAuxUIParts=(0,ui_src.YP)(SheetsUIPart.FORMULA_AUX),contextService=(0,ui_src.fJ)(src.oaf);(0,ui_src.J2)((0,react.useMemo)((()=>contextService.subscribeContextValue$(src.kgb)),[contextService]));const isFocusFxBar=contextService.getContextValue(src.kgb),ref=(0,react.useRef)(null),editorService=(0,ui_src.fJ)(editor_manager_service.I);(0,react.useLayoutEffect)((()=>{const subscription=workbook.activeSheet$.pipe((0,switchMap.n)((worksheet=>worksheet?(0,observable_merge.h)(worksheetProtectionRuleModel.ruleChange$,rangeProtectionRuleModel.ruleChange$,selectionManager.selectionMoveEnd$,selectionManager.selectionSet$).pipe((0,switchMap.n)((()=>{const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId(),range=selectionManager.getCurrentLastSelection()?.range;if(!range)return empty.w;const primary=selectionManager.getCurrentLastSelection()?.primary;return primary?(0,observable_of.of)({unitId,subUnitId,primary}):(0,observable_of.of)(null)}))):empty.w))).subscribe((cellInfo=>{if(cellInfo){const{unitId,subUnitId,primary}=cellInfo;if(worksheetProtectionRuleModel.getRule(unitId,subUnitId)){const editDisable=!(permissionService.getPermissionPoint(new sheets_src.qGK(unitId,subUnitId).id)?.value??1),viewDisable=!(permissionService.getPermissionPoint(new sheets_src.R4Q(unitId,subUnitId).id)?.value??1);return void setDisableInfo({viewDisable,editDisable})}const{actualRow,actualColumn}=primary,cellInfoWithPermission=rangeProtectionCache.getCellInfo(unitId,subUnitId,actualRow,actualColumn);setDisableInfo({editDisable:!(cellInfoWithPermission?.[sheets_src.pS2.Edit]??1),viewDisable:!(cellInfoWithPermission?.[sheets_src.pS2.View]??1)})}else setDisableInfo({viewDisable:!1,editDisable:!1})}));return()=>{subscription.unsubscribe()}}),[workbook]),(0,react.useEffect)((()=>{const subscription=editorBridgeService.visible$.subscribe((visibleInfo=>{setIconStyle(visibleInfo.visible?views_formula_bar_index_module.formulaActive:views_formula_bar_index_module.formulaGrey)}));return()=>subscription.unsubscribe()}),[editorBridgeService.visible$]),(0,react.useEffect)((()=>{const subscription=editorBridgeService.currentEditCellState$.subscribe((state=>{state?.documentLayoutObject.documentModel?.getBody()?.customBlocks?.length?setImageDisable(!0):setImageDisable(!1)}));return()=>subscription.unsubscribe()}),[editorBridgeService.currentEditCellState$]),(0,react.useEffect)((()=>{const handleResize=()=>{if(!ref.current)return;const editorRect=ref.current.getBoundingClientRect();formulaEditorManagerService.setPosition(editorRect)};if(ref.current){handleResize();const a=new ResizeObserver(handleResize);return a.observe(ref.current),()=>a.disconnect()}}),[formulaEditorManagerService]);const{viewDisable,editDisable}=disableInfo,disabled=editDisable||imageDisable,shouldSkipFocus=(0,react.useRef)(!1),hideEditor=(editState?.documentLayoutObject.documentModel?.getDrawingsOrder()?.length??0)>0||viewDisable;return(0,jsx_runtime.jsxs)("div",{className:(0,design_src.$z)(views_formula_bar_index_module.formulaBox,className),style:{height:0===arrowDirection?"28px":"82px",pointerEvents:editDisable?"none":"auto"},children:[(0,jsx_runtime.jsx)("div",{className:views_formula_bar_index_module.nameRanges,children:(0,jsx_runtime.jsx)(DefinedName,{disable:editDisable})}),(0,jsx_runtime.jsxs)("div",{className:views_formula_bar_index_module.formulaBar,children:[(0,jsx_runtime.jsx)("div",{className:(0,design_src.$z)(views_formula_bar_index_module.formulaIcon,{[views_formula_bar_index_module.formulaIconDisable]:disabled}),children:(0,jsx_runtime.jsxs)("div",{className:views_formula_bar_index_module.formulaIconWrapper,children:[(0,jsx_runtime.jsx)("span",{className:(0,design_src.$z)(views_formula_bar_index_module.iconContainer,views_formula_bar_index_module.iconContainerError,iconStyle),onClick:function handleCloseBtnClick(){editorBridgeService.isVisible().visible&&commandService.executeCommand(SetCellEditVisibleOperation.id,{visible:!1,eventType:engine_render_src.bKQ.Keyboard,keycode:ui_src.DD.ESC,unitId:currentWorkbook?.getUnitId()??""})},children:(0,jsx_runtime.jsx)(close_single.A,{})}),(0,jsx_runtime.jsx)("span",{className:(0,design_src.$z)(views_formula_bar_index_module.iconContainer,views_formula_bar_index_module.iconContainerSuccess,iconStyle),onClick:function handleConfirmBtnClick(){editorBridgeService.isVisible().visible&&commandService.executeCommand(SetCellEditVisibleOperation.id,{visible:!1,eventType:engine_render_src.bKQ.PointerDown,unitId:currentWorkbook?.getUnitId()??""})},children:(0,jsx_runtime.jsx)(check_mark_single.A,{})}),(0,jsx_runtime.jsx)("span",{className:(0,design_src.$z)(views_formula_bar_index_module.iconContainer,views_formula_bar_index_module.iconContainerFx),onClick:function handlerFxBtnClick(){formulaEditorManagerService.handleFxBtnClick(!0)},children:(0,jsx_runtime.jsx)(fx_single.A,{})})]})}),(0,jsx_runtime.jsxs)("div",{className:views_formula_bar_index_module.formulaContainer,children:[(0,jsx_runtime.jsxs)("div",{className:views_formula_bar_index_module.formulaInput,onPointerDown:()=>{try{!1===editorBridgeService.isVisible().visible&&commandService.syncExecuteCommand(SetCellEditVisibleOperation.id,{visible:!0,eventType:engine_render_src.bKQ.PointerDown,unitId:currentWorkbook?.getUnitId()??""}),contextService.setContextValue(src.kgb,!0)}catch(e){throw shouldSkipFocus.current=!0,e}},onPointerUp:e=>{shouldSkipFocus.current&&setTimeout((()=>{editorService.blur(!0)}),30),shouldSkipFocus.current=!1},ref,style:{pointerEvents:hideEditor?"none":"auto"},children:[FormulaEditor&&(0,jsx_runtime.jsx)(FormulaEditor,{disableSelectionOnClick:!0,editorId:src.azi,initValue:"",onChange:()=>{},isFocus:isFocusFxBar,className:views_formula_bar_index_module.formulaContent,unitId:editState?.unitId,subUnitId:editState?.sheetId,isSupportAcrossSheet:!0,resetSelectionOnBlur:!1,isSingle:!1,keyboradEventConfig:keyCodeConfig,onFormulaSelectingChange:isSelecting=>{isRefSelecting.current=isSelecting,isSelecting?editorBridgeService.enableForceKeepVisible():editorBridgeService.disableForceKeepVisible()},autoScrollbar:!1,disableContextMenu:!1}),hideEditor?(0,jsx_runtime.jsx)("div",{className:views_formula_bar_index_module.formulaInputMask}):null]}),(0,jsx_runtime.jsx)("div",{className:(0,design_src.$z)(views_formula_bar_index_module.arrowContainer,{[views_formula_bar_index_module.arrowContainerDisable]:editDisable}),onClick:function handleArrowClick(){setArrowDirection(0===arrowDirection?1:0),setTimeout((()=>{formulaEditorManagerService.handleFoldBtnClick(1===arrowDirection)}),150)},children:0===arrowDirection?(0,jsx_runtime.jsx)(dropdown_single.A,{}):(0,jsx_runtime.jsx)(dropdown_single.A,{style:{transform:"rotateZ(180deg)"}})})]})]}),(0,jsx_runtime.jsx)(ui_src.h1,{components:formulaAuxUIParts},"formula-aux")]})}FormulaBar.__docgenInfo={description:"",methods:[],displayName:"FormulaBar",props:{className:{required:!1,tsType:{name:"string"},description:""}}};var increase_single=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/increase-single.js"),more_single=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/more-single.js");const ISheetBarService=(0,src.Qmd)("univer.sheetbar-service");class SheetBarService extends src.jGt{constructor(){super(),this._currentHandler=null,this._renameId$=new Subject.B,this.renameId$=this._renameId$.asObservable(),this._removeId$=new Subject.B,this.removeId$=this._removeId$.asObservable(),this._scroll$=new Subject.B,this.scroll$=this._scroll$.asObservable(),this._scrollX$=new Subject.B,this.scrollX$=this._scrollX$.asObservable(),this._addSheet$=new Subject.B,this.addSheet$=this._addSheet$.asObservable()}setRenameId(renameId){this._renameId$.next(renameId)}setRemoveId(removeId){this._removeId$.next(removeId)}setScroll(state){this._scroll$.next(state)}setScrollX(x){this._scrollX$.next(x)}setAddSheet(index){this._addSheet$.next(index)}triggerSheetBarMenu(){this._currentHandler?.handleSheetBarMenu()}registerSheetBarMenuHandler(handler){if(this._currentHandler)throw new Error("There is already a context menu handler!");return this._currentHandler=handler,(0,src.saO)((()=>{this._currentHandler=null}))}}var sheet_bar_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/sheet-bar/index.module.less"),sheet_bar_index_module_options={};sheet_bar_index_module_options.styleTagTransform=styleTagTransform_default(),sheet_bar_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),sheet_bar_index_module_options.insert=insertBySelector_default().bind(null,"head"),sheet_bar_index_module_options.domAPI=styleDomAPI_default(),sheet_bar_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(sheet_bar_index_module.A,sheet_bar_index_module_options);const views_sheet_bar_index_module=sheet_bar_index_module.A&&sheet_bar_index_module.A.locals?sheet_bar_index_module.A.locals:void 0;var sheet_bar_button_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/sheet-bar/sheet-bar-button/index.module.less"),sheet_bar_button_index_module_options={};sheet_bar_button_index_module_options.styleTagTransform=styleTagTransform_default(),sheet_bar_button_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),sheet_bar_button_index_module_options.insert=insertBySelector_default().bind(null,"head"),sheet_bar_button_index_module_options.domAPI=styleDomAPI_default(),sheet_bar_button_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(sheet_bar_button_index_module.A,sheet_bar_button_index_module_options);const sheet_bar_sheet_bar_button_index_module=sheet_bar_button_index_module.A&&sheet_bar_button_index_module.A.locals?sheet_bar_button_index_module.A.locals:void 0;function SheetBarButton(props){const{children,className,style,disabled=!1,onClick,...restProps}=props;return(0,jsx_runtime.jsx)("button",{type:"button",className:sheet_bar_sheet_bar_button_index_module.sheetBarBtn,style,disabled,onClick:e=>{disabled?e.preventDefault():onClick&&onClick(e)},...restProps,children})}SheetBarButton.__docgenInfo={description:"Button Component",methods:[],displayName:"SheetBarButton",props:{children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:"Semantic DOM class"},style:{required:!1,tsType:{name:"ReactCSSProperties",raw:"React.CSSProperties"},description:"Semantic DOM style"},disabled:{required:!1,tsType:{name:"boolean"},description:"Disabled state of button\n@default false"},onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.MouseEvent<HTMLButtonElement>) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLButtonElement>",elements:[{name:"HTMLButtonElement"}]},name:"event"}],return:{name:"void"}}},description:"Set the handler to handle `click` event"}}};var eyelash_single=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/eyelash-single.js"),convert_single=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/convert-single.js");function SheetBarMenu(){const[menu,setMenu]=(0,react.useState)([]),[visible,setVisible]=(0,react.useState)(!1),univerInstanceService=(0,ui_src.fJ)(src.HCr),commandService=(0,ui_src.fJ)(src.wTY),sheetBarService=(0,ui_src.fJ)(ISheetBarService),worksheetProtectionRuleModel=(0,ui_src.fJ)(sheets_src.$af),workbook=(0,ui_src.J2)((()=>univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET)),null,!1,[]),statusInit=(0,react.useCallback)((()=>{if(!workbook)return;const sheets=workbook.getSheets(),activeSheet=workbook.getActiveSheet(),worksheetMenuItems=sheets.map(((sheet,index)=>({label:sheet.getName(),index:`${index}`,sheetId:sheet.getSheetId(),hidden:sheet.isSheetHidden()===src.OdA.TRUE,selected:activeSheet===sheet})));setMenu(worksheetMenuItems)}),[workbook,worksheetProtectionRuleModel]),setupStatusUpdate=(0,react.useCallback)((()=>commandService.onCommandExecuted((commandInfo=>{switch(commandInfo.id){case sheets_src.seI.id:case sheets_src.fyw.id:case sheets_src.H7b.id:case sheets_src.eUO.id:case sheets_src.yif.id:case sheets_src._M5.id:statusInit()}}))),[commandService,statusInit]);function handleSheetBarMenu(){setVisible(!0)}(0,react.useEffect)((()=>{statusInit();const disposables=new src.VdD;return disposables.add(setupStatusUpdate()),disposables.add(sheetBarService.registerSheetBarMenuHandler({handleSheetBarMenu})),()=>disposables.dispose()}),[setupStatusUpdate,sheetBarService,statusInit,workbook]);const items=(0,react.useMemo)((()=>menu.map((item=>({type:"item",children:(0,jsx_runtime.jsxs)("div",{className:"univer-relative univer-box-border univer-pl-6",children:[(item.selected||item.hidden)&&(0,jsx_runtime.jsxs)("span",{className:"univer-absolute univer-left-1 univer-top-0.5",children:[item.selected&&(0,jsx_runtime.jsx)(check_mark_single.A,{className:"univer-size-4 univer-text-primary-600"}),item.hidden&&(0,jsx_runtime.jsx)(eyelash_single.A,{className:"univer-size-4 univer-text-gray-400"})]}),(0,jsx_runtime.jsx)("span",{className:(0,design_src.$z)({"univer-text-primary-600":item.selected}),children:item.label})]}),onSelect:()=>{(item=>{const{sheetId}=item;sheetId&&workbook&&(item.hidden?commandService.executeCommand(sheets_src.dSt.id,{unitId:workbook.getUnitId(),subUnitId:sheetId,value:sheetId}):item.selected||commandService.executeCommand(sheets_src.LlJ.id,{unitId:workbook.getUnitId(),subUnitId:sheetId}),setVisible(!1))})(item)}})))),[menu]);return(0,jsx_runtime.jsx)(design_src.rI,{align:"start",items,open:visible,onOpenChange:visible=>{setVisible(visible)},children:(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(SheetBarButton,{children:(0,jsx_runtime.jsx)(convert_single.A,{})})})})}SheetBarMenu.__docgenInfo={description:"",methods:[],displayName:"SheetBarMenu"};var lock_single=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/lock-single.js"),sheet_bar_tabs_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/sheet-bar/sheet-bar-tabs/index.module.less"),sheet_bar_tabs_index_module_options={};sheet_bar_tabs_index_module_options.styleTagTransform=styleTagTransform_default(),sheet_bar_tabs_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),sheet_bar_tabs_index_module_options.insert=insertBySelector_default().bind(null,"head"),sheet_bar_tabs_index_module_options.domAPI=styleDomAPI_default(),sheet_bar_tabs_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(sheet_bar_tabs_index_module.A,sheet_bar_tabs_index_module_options);const sheet_bar_sheet_bar_tabs_index_module=sheet_bar_tabs_index_module.A&&sheet_bar_tabs_index_module.A.locals?sheet_bar_tabs_index_module.A.locals:void 0;function SheetBarItem(props){const{sheetId,label,color,selected}=props,[currentSelected,setCurrentSelected]=(0,react.useState)(selected),themeService=(0,ui_src.fJ)(src.Fsb);(0,react.useEffect)((()=>{setCurrentSelected(selected)}),[selected]);return(0,jsx_runtime.jsx)("div",{"data-id":sheetId,className:currentSelected?`\n                  ${sheet_bar_sheet_bar_tabs_index_module.slideTabActive}\n                  ${sheet_bar_sheet_bar_tabs_index_module.slideTabItem}\n                `:sheet_bar_sheet_bar_tabs_index_module.slideTabItem,style:{backgroundColor:!currentSelected&&color?color:"",color:!currentSelected&&color?(color=>{const theme=themeService.getCurrentTheme(),darkTextColor=theme.textColor,lightTextColor=theme.colorWhite;return new src.mKL(color).isDark()?lightTextColor:darkTextColor})(color):"",boxShadow:currentSelected&&color?`0px 0px 8px rgba(0, 0, 0, 0.08), inset 0px -2px 0px 0px ${color}`:""},children:(0,jsx_runtime.jsx)("div",{className:sheet_bar_sheet_bar_tabs_index_module.slideTabDiv,children:label})},sheetId)}SheetBarItem.__docgenInfo={description:"",methods:[],displayName:"SheetBarItem",props:{label:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},children:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:""},index:{required:!1,tsType:{name:"number"},description:""},color:{required:!1,tsType:{name:"string"},description:""},sheetId:{required:!1,tsType:{name:"string"},description:""},style:{required:!1,tsType:{name:"ReactCSSProperties",raw:"React.CSSProperties"},description:""},hidden:{required:!1,tsType:{name:"BooleanNumber"},description:""},selected:{required:!1,tsType:{name:"boolean"},description:""}}};const Tween={easeOutStrong:(t,b,c,d)=>-c*((t=t/d-1)*t*t*t-1)+b,backOut:(t,b,c,d,s)=>(void 0===s&&(s=.7),c*((t=t/d-1)*t*((s+1)*t+s)+1)+b)},CONFIG={loop:!1,begin:0,end:0,duration:300,delay:0,type:"easeOutStrong",receive(v){},success(v){},cancel(v){},complete(v){}};class Animate{constructor(config){this._status=0,this._start=0,this._handle=0,this._delayHandle=null,this._config={...CONFIG,...config},this._config.loop&&(this._config.complete=()=>{},this._config.success=()=>{this.request()})}static success(...animates){let successNumber=0;return new Promise((resolve=>{for(let i=0;i<animates.length;i++){const animate=animates[i],config=animate._config,success=config.success;config.loop||(config.success=v=>{successNumber++,success&&success.call(animate,v),successNumber===animates.length&&resolve()})}}))}request(){0===this._config.delay?(this._status=0,this._start=Date.now(),this._fakeHandle()):(this._delayHandle&&clearTimeout(this._delayHandle),this._delayHandle=setTimeout((()=>{this._status=0,this._start=Date.now(),this._fakeHandle()}),this._config.delay))}cancel(){this._status=1,this._delayHandle&&clearTimeout(this._delayHandle),cancelAnimationFrame(this._handle)}_fakeHandle(){let times=Date.now()-this._start;times=times>=this._config.duration?this._config.duration:times;const fix=Tween[this._config.type](times,this._config.begin,this._config.end-this._config.begin,this._config.duration,.7).toFixed(2);return this._config.receive(fix),1===this._status?(this._config.cancel(fix),void this._config.complete(fix)):times===this._config.duration?(this._config.success(fix),void this._config.complete(fix)):void(this._handle=requestAnimationFrame((()=>{this._fakeHandle()})))}}class SlideTabItem{constructor(slideTabItem,slideTabBar){this._midline=0,this._slideTabItem=slideTabItem,this._animate=null,this._translateX=0,this._editMode=!1,this._slideTabBar=slideTabBar,this._placeholder=null,this._scrollbar=slideTabBar.getScrollbar(),this.update()}static midline(item){return item.getBoundingRect().x+item.getBoundingRect().width/2}static leftLine(item){return item.getBoundingRect().x}static rightLine(item){return item.getBoundingRect().x+item.getBoundingRect().width}static make(nodeList,slideTabBar){const result=[];return nodeList.forEach((item=>result.push(new SlideTabItem(item,slideTabBar)))),result}getSlideTabItem(){return this._slideTabItem}getEditor(){return this._slideTabItem.querySelector("span")}focus(){this.getEditor()?.focus()}selectAll(){const input=this.getEditor();input&&SlideTabBar.keepSelectAll(input)}isEditMode(){return this._editMode}classList(){return this._slideTabItem.classList}translateX(x){return this._translateX=x,this._slideTabItem.style.transform=`translateX(${x}px)`,this.getTranslateXDirection()}setEditor(callback){if(!this._slideTabBar.getConfig().onNameChangeCheck())return;let compositionFlag=!0;if(!1===this._editMode){const input=this._slideTabItem.querySelector("span"),blurAction=focusEvent=>{if(!this.nameCheck()){if(this._editMode=!1,input&&(input.removeAttribute("contentEditable"),input.removeEventListener("focusout",blurAction),input.removeEventListener("compositionstart",compositionstartAction),input.removeEventListener("compositionend",compositionendAction),input.removeEventListener("input",inputAction),input.removeEventListener("keydown",keydownAction),input.classList.remove(this._slideTabBar.getConfig().slideTabBarSpanEditClassName)),this._slideTabBar.removeListener(),this._slideTabBar.updateItems(),this._slideTabBar.getConfig().onChangeName){const text=input?.innerText||"",id=this.getId();this._slideTabBar.getConfig().onChangeName(id,text)}callback&&callback(focusEvent)}};let keydownAction=e=>{input&&(e.stopPropagation(),"Enter"===e.key&&input.blur())};const compositionstartAction=e=>{compositionFlag=!1},compositionendAction=e=>{compositionFlag=!0},inputAction=e=>{if(!input)return;setTimeout((()=>{if(compositionFlag){const text=input.innerText;text.length>31&&(input.innerText=text.substring(0,31),SlideTabBar.keepLastIndex(input))}}),0)};input&&(input.setAttribute("contentEditable","true"),input.addEventListener("focusout",blurAction),input.addEventListener("compositionstart",compositionstartAction),input.addEventListener("compositionend",compositionendAction),input.addEventListener("input",inputAction),input.addEventListener("keydown",keydownAction),input.classList.add(this._slideTabBar.getConfig().slideTabBarSpanEditClassName),this._editMode=!0,SlideTabBar.keepSelectAll(input))}}nameCheck(){const input=this._slideTabItem.querySelector("span");if(!input)return!1;const text=input.innerText;return this._slideTabBar.getConfig().onNameCheckAlert(text)}animate(){return{translateX:x=>{this._translateX!==x&&(this._animate&&(this._animate.cancel(),this._animate=null),this._animate=new Animate({begin:this._translateX,end:x,receive:val=>{this._slideTabItem.style.transform=`translateX(${val}px)`}}),this._translateX=x,this._animate.request())},cancel:()=>{this._animate&&(this._animate.cancel(),this._animate=null)}}}after(other){this._slideTabItem.after(other._slideTabItem||other)}update(){this._midline=SlideTabItem.midline(this)}disableFixed(){if(this._placeholder){const primeval=this._slideTabBar.primeval();this._slideTabItem.style.removeProperty("position"),this._slideTabItem.style.removeProperty("left"),this._slideTabItem.style.removeProperty("top"),this._slideTabItem.style.removeProperty("width"),this._slideTabItem.style.removeProperty("height"),this._slideTabItem.style.removeProperty("background"),this._slideTabItem.style.removeProperty("padding"),this._slideTabItem.style.removeProperty("box-sizing"),this._slideTabItem.style.removeProperty("font-size"),this._slideTabItem.style.removeProperty("font-family"),this._slideTabItem.style.removeProperty("font-weight"),this._slideTabItem.style.removeProperty("color"),this._slideTabItem.style.removeProperty("border-radius"),this._placeholder.after(this._slideTabItem),primeval.removeChild(this._placeholder),this._placeholder=null}}enableFixed(){const placeholder=document.createElement("div"),boundingRect=this.getBoundingRect(),computedStyles=getComputedStyle(this._slideTabItem),innerSpan=this._slideTabItem.querySelector("span");if(this._placeholder=placeholder,this._placeholder.style.width=`${boundingRect.width}px`,this._placeholder.style.height=`${boundingRect.height}px`,this._placeholder.style.flexShrink="0",this._placeholder.style.margin=computedStyles.margin,this._slideTabItem.style.background=computedStyles.background,innerSpan){const innerPadding=getComputedStyle(innerSpan).padding;this._slideTabItem.style.padding=innerPadding}this._slideTabItem.style.boxSizing=computedStyles.boxSizing,this._slideTabItem.style.fontSize=computedStyles.fontSize,this._slideTabItem.style.fontFamily=computedStyles.fontFamily,this._slideTabItem.style.fontWeight=computedStyles.fontWeight,this._slideTabItem.style.color=computedStyles.color,this._slideTabItem.style.borderRadius=computedStyles.borderRadius,this._slideTabItem.style.left=boundingRect.x-this.getScrollbar().getScrollX()+"px",this._slideTabItem.style.top=`${boundingRect.y}px`,this._slideTabItem.style.width=`${boundingRect.width}px`,this._slideTabItem.style.height=`${boundingRect.height}px`,this._slideTabItem.style.position="fixed",this._slideTabItem.after(placeholder),document.body.appendChild(this._slideTabItem)}addEventListener(type,action,options){this._slideTabItem.addEventListener(type,action,options)}removeEventListener(type,action,options){this._slideTabItem.removeEventListener(type,action,options)}getScrollbar(){return this._scrollbar}getMidLine(){return this._midline}getBoundingRect(){const boundingClientRect=this._slideTabItem.getBoundingClientRect();return boundingClientRect.x+=this._scrollbar.getScrollX(),boundingClientRect}getWidth(){return this.getBoundingRect().width}getTranslateXDirection(){const midline=SlideTabItem.midline(this);return midline>this._midline?1:midline<this._midline?-1:0}equals(other){return other&&other._slideTabItem===this._slideTabItem}getId(){return this._slideTabItem.dataset.id||""}}class SlideScrollbar{constructor(slideTabBar){const primeval=slideTabBar.primeval();this._scrollX=primeval.scrollLeft,this._slideTabBar=slideTabBar}scrollX(x){const primeval=this._slideTabBar.primeval();primeval.scrollLeft=x,this._scrollX=primeval.scrollLeft}scrollRight(){const primeval=this._slideTabBar.primeval();primeval.scrollLeft=primeval.scrollWidth,this._scrollX=primeval.scrollLeft}getScrollX(){return this._scrollX}}class SlideTabBar{static#_=this.LongPressDelay=500;static#_2=this.DoubleClickDelay=300;constructor(config){if(this._activeTabItemIndex=0,this._slideTabItems=[],this._downActionX=0,this._moveActionX=0,this._compareIndex=0,this._activeTabItem=null,this._scrollIncremental=0,this._compareDirection=0,this._autoScrollTime=null,this._longPressTimer=null,this._leftBoundingLine=0,this._rightBoundingLine=0,this._leftMoveX=0,this._rightMoveX=0,null==config.slideTabBarContainer)throw new Error("not found slide-tab-bar root element");const slideTabBar=config.slideTabBarContainer.querySelector(`.${config.slideTabBarClassName??"slide-tab-bar"}`);if(null==slideTabBar)throw new Error("not found slide-tab-bar");this._slideTabBar=slideTabBar,this._slideScrollbar=new SlideScrollbar(this),this._config=config,this._initConfig();let lastPageX=0,lastPageY=0,lastTime=0;this._downAction=downEvent=>{if(this._activeTabItem?.isEditMode())return;this._longPressTimer&&(clearTimeout(this._longPressTimer),this._longPressTimer=null);const slideItemId=downEvent.target?.closest(`.${config.slideTabBarItemClassName}`)?.getAttribute("data-id"),slideItemIndex=this._slideTabItems.findIndex((item=>item.getId()===slideItemId));if(null==slideItemId||-1===slideItemIndex)return;if(this._activeTabItemIndex!==slideItemIndex)return this._activeTabItem?.removeEventListener("pointermove",this._moveAction),this._activeTabItem?.removeEventListener("pointerup",this._upAction),this.removeListener(),void this._config.onChangeTab(downEvent,slideItemId);if(this._compareIndex=slideItemIndex,this._downActionX=downEvent.pageX,this._moveActionX=0,this._scrollIncremental=0,this._activeTabItem=this._slideTabItems[slideItemIndex],!this._activeTabItem)return void console.error("Not found active slide-tab-item in sheet bar");const activeSlideItemElement=this._activeTabItem.getSlideTabItem();activeSlideItemElement?.setPointerCapture(downEvent.pointerId),this._activeTabItem?.addEventListener("pointerup",this._upAction);const{x,width}=this._activeTabItem.getBoundingRect(),{x:containerX,width:containerWidth}=this.getBoundingRect(),scrollX=this._slideScrollbar.getScrollX();if(this._leftBoundingLine=this._downActionX-(x-scrollX),this._rightBoundingLine=x-scrollX+width-this._downActionX,this._leftMoveX=x-containerX-scrollX,this._rightMoveX=containerX+containerWidth-(x+width)+scrollX,2===downEvent.button||this._hasEditItem())return;const{pageX,pageY}=downEvent,current=Date.now(),diffTime=current-lastTime<=SlideTabBar.DoubleClickDelay,diffPageX=Math.abs(pageX-lastPageX)<10,diffPageY=Math.abs(pageY-lastPageY)<10;diffTime&&diffPageX&&diffPageY&&this._activeTabItem.setEditor(),lastPageX=pageX,lastPageY=pageY,lastTime=current,this._longPressTimer=setTimeout((()=>{activeSlideItemElement&&!this._activeTabItem?.isEditMode()&&(this._activeTabItem?.enableFixed(),this._startAutoScroll(),activeSlideItemElement.setPointerCapture(downEvent.pointerId),activeSlideItemElement.style.cursor="move",this._activeTabItem?.addEventListener("pointermove",this._moveAction))}),SlideTabBar.LongPressDelay)},this._upAction=upEvent=>{if(this._activeTabItem?.isEditMode())return;if(this._longPressTimer&&(clearTimeout(this._longPressTimer),this._longPressTimer=null),!this._activeTabItem)return;const isFromScroll=null!==this._autoScrollTime;this._closeAutoScroll(),this._activeTabItem.disableFixed(),this.updateItems();const activeSlideItemElement=this._activeTabItem?.getSlideTabItem();activeSlideItemElement&&(activeSlideItemElement.style.cursor="",activeSlideItemElement.releasePointerCapture(upEvent.pointerId),this._activeTabItem?.removeEventListener("pointermove",this._moveAction),this._activeTabItem?.removeEventListener("pointerup",this._upAction),this._config.onSlideEnd&&this._activeTabItemIndex!==this._compareIndex&&isFromScroll&&(this.removeListener(),this._config.onSlideEnd(upEvent,this._compareIndex||0)),this._scrollIncremental=0,this._downActionX=0,this._moveActionX=0,this._compareIndex=0)},this._moveAction=moveEvent=>{this._activeTabItem&&(this._moveActionX=moveEvent.pageX-this._downActionX,this._moveActionX<=-this._leftMoveX?this._moveActionX=-this._leftMoveX:this._moveActionX>=this._rightMoveX&&(this._moveActionX=this._rightMoveX),this._scrollIncremental=0,this._scrollLeft(moveEvent),this._scrollRight(moveEvent))},this._wheelAction=wheelEvent=>{this.setScroll(wheelEvent.deltaY)},this.addListener()}static checkedSkipSlide(event){let parent=event.target;for(;null!=parent&&parent!==document.body;){if(parent.getAttribute("data-slide-skip"))return!0;parent=parent.parentElement}return!1}static keepLastIndex(inputHtml){setTimeout((()=>{const range=window.getSelection();range&&(range.selectAllChildren(inputHtml),range.collapseToEnd())}))}static keepSelectAll(inputHtml){setTimeout((()=>{const selection=window.getSelection();if(!selection)return;const range=document.createRange();range.selectNodeContents(inputHtml),selection.removeAllRanges(),selection.addRange(range)}))}update(currentIndex){this._config.currentIndex=currentIndex,this._initConfig(),this.removeListener(),this.addListener(),this.scrollToItem(currentIndex)}primeval(){return this._slideTabBar}updateItems(){for(let i=0;i<this._slideTabItems.length;i++)this._slideTabItems[i].animate().cancel(),this._slideTabItems[i].translateX(0),this._slideTabItems[i].update()}getScrollbar(){return this._slideScrollbar}getConfig(){return this._config}getBoundingRect(){return this._slideTabBar.getBoundingClientRect()}getSlideTabItems(){return this._slideTabItems}getActiveItem(){return this._activeTabItem}isLeftEnd(){return 0===this._slideTabBar.scrollLeft}isRightEnd(){const parent=this._slideTabBar.parentElement;return!!parent&&this._slideTabBar.scrollWidth-parent.clientWidth===this._slideTabBar.scrollLeft}addListener(){this._slideTabBar.addEventListener("wheel",this._wheelAction),this._slideTabItems.forEach((item=>{item.addEventListener("pointerdown",this._downAction)}))}removeListener(){this._slideTabBar.removeEventListener("wheel",this._wheelAction),this._slideTabItems.forEach((item=>{item.removeEventListener("pointerdown",this._downAction)}))}setScroll(x){if(this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+x),x>0){const left=this.calculateLeftScrollX();this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+left)}else if(x<0){const right=this.calculateRightScrollX();this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+right)}this._config.onScroll({leftEnd:this.isLeftEnd(),rightEnd:this.isRightEnd()})}flipPage(x){if(x>0){const left=this.calculateLeftScrollX(!0);this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+left)}else if(x<0){const right=this.calculateRightScrollX(!0);this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+right)}this._config.onScroll({leftEnd:this.isLeftEnd(),rightEnd:this.isRightEnd()})}scrollToItem(index){if((index=index??this._config.currentIndex)<0||index>=this._slideTabItems.length)return void console.error("Index out of bounds");const right=this.calculateTabItemScrollX(index);this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+right),this._config.onScroll({leftEnd:this.isLeftEnd(),rightEnd:this.isRightEnd()})}calculateLeftScrollX(shouldFlipPage){let scrollX=0;return this._slideTabItems.some((item=>{const containerRect=this._slideTabBar.getBoundingClientRect(),containerPosition=containerRect.left+containerRect.width,itemReact=item.getSlideTabItem().getBoundingClientRect(),itemLeft=itemReact.left,itemWidth=itemReact.width;return itemLeft<containerPosition&&itemLeft+itemWidth+8>containerPosition&&(scrollX=shouldFlipPage?itemLeft-containerRect.left-4:itemLeft+itemWidth-containerPosition+4,!0)})),scrollX}calculateRightScrollX(shouldFlipPage){let scrollX=0;return this._slideTabItems.some((item=>{const containerRect=this._slideTabBar.getBoundingClientRect(),containerPosition=containerRect.left,itemReact=item.getSlideTabItem().getBoundingClientRect(),itemLeft=itemReact.left,itemWidth=itemReact.width;return itemLeft-8<containerPosition&&itemLeft+itemWidth>containerPosition&&(scrollX=shouldFlipPage?itemLeft+itemWidth-containerRect.left-containerRect.width+4:itemLeft-containerPosition-4,!0)})),scrollX}calculateTabItemScrollX(index){let scrollX=0;const containerRect=this._slideTabBar.getBoundingClientRect(),containerLeftPosition=containerRect.left,containerRightPosition=containerRect.left+containerRect.width,itemReact=this._slideTabItems[index].getSlideTabItem().getBoundingClientRect(),itemLeft=itemReact.left,itemWidth=itemReact.width;return itemLeft-8<containerLeftPosition&&(scrollX=itemLeft-containerLeftPosition-4),itemLeft+itemWidth+8>containerRightPosition&&(scrollX=itemLeft+itemWidth-containerRightPosition+4),scrollX}calculateActiveTabItemScrollX(){let scrollX=0;const containerRect=this._slideTabBar.getBoundingClientRect(),containerLeftPosition=containerRect.left,containerRightPosition=containerRect.left+containerRect.width,itemReact=this._activeTabItem?.getSlideTabItem().getBoundingClientRect();if(!itemReact)return 0;const itemLeft=itemReact.left,itemWidth=itemReact.width;return itemLeft-8<containerLeftPosition&&itemLeft+itemWidth>containerLeftPosition&&(scrollX=itemLeft-containerLeftPosition-4),itemLeft<containerRightPosition&&itemLeft+itemWidth+8>containerRightPosition&&(scrollX=itemLeft+itemWidth-containerRightPosition+4),scrollX}destroy(){this.removeListener(),this._downActionX=0,this._moveActionX=0,this._compareDirection=0,this._compareIndex=0,this._slideTabItems=[],this._activeTabItem=null}_hasEditItem(){for(let index=0;index<this._slideTabItems.length;index++){if(this._slideTabItems[index].isEditMode())return!0}return!1}_autoScrollFrame(){if(this._activeTabItem)switch(this._compareDirection=this._activeTabItem.translateX(this._moveActionX),this._compareDirection){case 1:this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareRight();break;case 0:this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareIndex=this._activeTabItemIndex;break;case-1:this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareLeft()}this._autoScrollTime=requestAnimationFrame((()=>{this._autoScrollFrame()}))}_startAutoScroll(){null==this._autoScrollTime&&this._autoScrollFrame()}_closeAutoScroll(){this._autoScrollTime&&cancelAnimationFrame(this._autoScrollTime),this._autoScrollTime=null}_scrollLeft(event){const boundingRect=this.getBoundingRect(),x=event.pageX-boundingRect.x;x<this._leftBoundingLine&&(this._scrollIncremental=-Math.min(.1*Math.abs(x-this._leftBoundingLine),50))}_scrollRight(event){const boundingRect=this.getBoundingRect(),x=event.pageX-boundingRect.x;x>boundingRect.width-this._rightBoundingLine&&(this._scrollIncremental=Math.min(.1*Math.abs(x-(boundingRect.width-this._rightBoundingLine)),50))}_sortedItems(){if(null!=this._activeTabItem&&null!=this._activeTabItemIndex&&null!=this._compareIndex&&(this._slideTabItems.splice(this._activeTabItemIndex,1),this._slideTabItems.splice(this._compareIndex,0,this._activeTabItem),this._config.slideTabBarItemAutoSort))for(let i=0;i<this._slideTabItems.length;i++){const item=this._slideTabItems[i],next=this._slideTabItems[i+1];next&&item.after(next)}}_compareLeft(){if(this._activeTabItem&&this._activeTabItemIndex){const splice=this._slideTabItems.findIndex((item=>item.equals(this._activeTabItem))),length=this._slideTabItems.length,collect=[];for(let i=0;i<splice&&!(i>=splice);i++)collect.push(this._slideTabItems[i]);for(let i=splice+1;i<length;i++)this._slideTabItems[i].animate().translateX(0);let notFound=!0;for(let i=collect.length-1;i>=0;i--){const item=collect[i];SlideTabItem.leftLine(this._activeTabItem)<item.getMidLine()?(item.animate().translateX(this._activeTabItem.getWidth()),this._compareIndex=i,notFound=!1):(item.animate().translateX(0),notFound&&(this._compareIndex=this._activeTabItemIndex))}}}_compareRight(){if(this._activeTabItem){const splice=this._slideTabItems.findIndex((item=>item.equals(this._activeTabItem))),length=this._slideTabItems.length,collect=[];for(let i=splice+1;i<length;i++)collect.push(this._slideTabItems[i]);for(let i=0;i<splice;i++)this._slideTabItems[i].animate().translateX(0);let notFound=!0;for(let i=0;i<collect.length;i++){const item=collect[i];SlideTabItem.rightLine(this._activeTabItem)>item.getMidLine()?(item.animate().translateX(-this._activeTabItem.getWidth()),this._compareIndex=splice+i+1,notFound=!1):(item.animate().translateX(0),notFound&&(this._compareIndex=this._activeTabItemIndex))}}}_initConfig(){const slideTabItems=this._slideTabBar.querySelectorAll(`.${this._config.slideTabBarItemClassName??"slide-tab-item"}`);this._downActionX=0,this._moveActionX=0,this._compareDirection=0,this._compareIndex=0,this._slideTabItems=SlideTabItem.make(slideTabItems,this),this._activeTabItemIndex=this._config.currentIndex,this._activeTabItem=this._slideTabItems[this._activeTabItemIndex]}}function SheetBarTabs(){const[sheetList,setSheetList]=(0,react.useState)([]),[activeKey,setActiveKey]=(0,react.useState)(""),[boxShadow,setBoxShadow]=(0,react.useState)(""),[visible,setVisible]=(0,react.useState)(!1),[offset,setOffset]=(0,react.useState)([0,0]),slideTabBarRef=(0,react.useRef)({slideTabBar:null}),slideTabBarContainerRef=(0,react.useRef)(null),commandService=(0,ui_src.fJ)(src.wTY),sheetBarService=(0,ui_src.fJ)(ISheetBarService),localeService=(0,ui_src.fJ)(src.iH9),confirmService=(0,ui_src.fJ)(ui_src.rQ),configService=(0,ui_src.fJ)(src.J0C),editorBridgeService=(0,ui_src.fJ)(editor_bridge_service_IEditorBridgeService,src.Q1r.OPTIONAL),worksheetProtectionRuleModel=(0,ui_src.fJ)(sheets_src.$af),rangeProtectionRuleModel=(0,ui_src.fJ)(sheets_src.qI9),resetOrder=(0,ui_src.J2)(worksheetProtectionRuleModel.resetOrder$),workbook=useActiveWorkbook(),permissionService=(0,ui_src.fJ)(src.QWp),updateSheetItems=(0,react.useCallback)((()=>{const currentSubUnitId=workbook.getActiveSheet()?.getSheetId()||"";setActiveKey(currentSubUnitId);const sheets=workbook.getSheets(),activeSheet=workbook.getActiveSheet(),sheetListItems=sheets.filter((sheet=>!sheet.isSheetHidden())).map(((sheet,index)=>{const worksheetRule=worksheetProtectionRuleModel.getRule(workbook.getUnitId(),sheet.getSheetId()),hasSelectionRule=rangeProtectionRuleModel.getSubunitRuleList(workbook.getUnitId(),sheet.getSheetId()).length>0,name=worksheetRule?.permissionId||hasSelectionRule?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(lock_single.A,{}),(0,jsx_runtime.jsx)("span",{children:sheet.getName()})]}):(0,jsx_runtime.jsx)("span",{children:sheet.getName()});return{sheetId:sheet.getSheetId(),label:name,index,selected:activeSheet===sheet,color:sheet.getTabColor()??void 0}}));setSheetList(sheetListItems),setActiveKey(currentSubUnitId)}),[rangeProtectionRuleModel,workbook,worksheetProtectionRuleModel]);(0,react.useEffect)((()=>{updateSheetItems();const{slideTabBar,disconnectResizeObserver}=setupSlideTabBarInit(),disposable=setupStatusUpdate(),subscribeList=[setupSubscribeScroll(),setupSubscribeScrollX(),setupSubscribeRenameId()];return()=>{disposable.dispose(),slideTabBar.destroy(),subscribeList.forEach((subscribe=>subscribe.unsubscribe())),disconnectResizeObserver&&disconnectResizeObserver()}}),[resetOrder,workbook]),(0,react.useEffect)((()=>{sheetList.length>0&&setupSlideTabBarUpdate()}),[sheetList]),(0,react.useEffect)((()=>{const subscription=(0,observable_merge.h)(worksheetProtectionRuleModel.ruleChange$,rangeProtectionRuleModel.ruleChange$).subscribe((()=>{updateSheetItems()}));return()=>{subscription.unsubscribe()}}),[worksheetProtectionRuleModel,updateSheetItems]);const setupSlideTabBarInit=()=>{const slideTabBar=new SlideTabBar({slideTabBarClassName:sheet_bar_sheet_bar_tabs_index_module.slideTabBar,slideTabBarItemActiveClassName:sheet_bar_sheet_bar_tabs_index_module.slideTabActive,slideTabBarItemClassName:sheet_bar_sheet_bar_tabs_index_module.slideTabItem,slideTabBarSpanEditClassName:sheet_bar_sheet_bar_tabs_index_module.slideTabDivEdit,slideTabBarItemAutoSort:!0,slideTabBarContainer:slideTabBarContainerRef.current,currentIndex:0,onChangeName:(subUnitId,worksheetName)=>{commandService.executeCommand(sheets_src.JP6.id,{subUnitId,name:worksheetName})},onSlideEnd:async(event,order)=>{await commandService.executeCommand(sheets_src.YPi.id,{order})},onChangeTab:(event,subUnitId)=>{commandService.executeCommand(sheets_src._M5.id,{subUnitId,unitId:workbook.getUnitId()}).then((()=>{2===event.button&&onVisibleChange(!0)}))},onScroll:state=>{sheetBarService.setScroll(state)},onNameCheckAlert:text=>nameEmptyCheck(text)||sheetNameSpecCharCheck(text)||nameRepeatCheck(text),onNameChangeCheck:()=>{const unitId=workbook.getUnitId(),worksheet=workbook?.getActiveSheet();if(!worksheet)throw new Error("No active sheet found");const subUnitId=worksheet.getSheetId(),worksheetRule=worksheetProtectionRuleModel.getRule(unitId,subUnitId),selectionRule=rangeProtectionRuleModel.getSubunitRuleList(unitId,subUnitId).length>0;return worksheetRule||selectionRule?permissionService.getPermissionPoint(new sheets_src.d0P(unitId).id)?.value??!1:permissionService.getPermissionPoint(new sheets_src.fzU(unitId).id)?.value??!1}});slideTabBarRef.current.slideTabBar=slideTabBar;return{slideTabBar,disconnectResizeObserver:resizeInit(slideTabBar)}},config=configService.getConfig(ui_src.cQ),showContextMenu=config?.contextMenu??!0,nameEmptyCheck=name=>{if(""===name.trim()){const id="sheetNameEmptyAlert";return confirmService.open({id,title:{title:localeService.t("sheetConfig.sheetNameErrorTitle")},children:{title:localeService.t("sheetConfig.sheetNameCannotIsEmptyError")},cancelText:localeService.t("button.cancel"),confirmText:localeService.t("button.confirm"),onClose(){focusTabEditor(),confirmService.close(id)},onConfirm(){focusTabEditor(),confirmService.close(id)}}),!0}return!1},sheetNameSpecCharCheck=name=>{if(!(0,src.zGg)(name)){const id="sheetNameSpecCharAlert";return confirmService.open({id,title:{title:localeService.t("sheetConfig.sheetNameErrorTitle")},children:{title:localeService.t("sheetConfig.sheetNameSpecCharError")},cancelText:localeService.t("button.cancel"),confirmText:localeService.t("button.confirm"),onClose(){focusTabEditor(),confirmService.close(id)},onConfirm(){focusTabEditor(),confirmService.close(id)}}),!0}return!1},nameRepeatCheck=name=>{const worksheet=workbook.getActiveSheet(),currenSheetName=worksheet?.getName();if(currenSheetName===name)return!1;const checked=workbook.checkSheetName(name);if(checked){const id="sheetNameRepeatAlert";confirmService.open({id,title:{title:localeService.t("sheetConfig.sheetNameErrorTitle")},children:{title:localeService.t("sheetConfig.sheetNameAlreadyExistsError")},cancelText:localeService.t("button.cancel"),confirmText:localeService.t("button.confirm"),onClose(){confirmService.close(id),focusTabEditor()},onConfirm(){confirmService.close(id),focusTabEditor()}})}return checked},focusTabEditor=()=>{setTimeout((()=>{const activeSlideTab=slideTabBarRef.current.slideTabBar?.getActiveItem();activeSlideTab&&(activeSlideTab.focus(),activeSlideTab.selectAll())}),0)},setupSlideTabBarUpdate=()=>{const currentIndex=sheetList.findIndex((item=>item.selected));slideTabBarRef.current.slideTabBar?.update(currentIndex)},setupStatusUpdate=()=>commandService.onCommandExecuted((commandInfo=>{switch(commandInfo.id){case sheets_src.CBb.id:case sheets_src.seI.id:case sheets_src.fyw.id:case sheets_src.H7b.id:case sheets_src.eUO.id:case sheets_src.yif.id:case sheets_src._M5.id:updateSheetItems()}})),setupSubscribeScroll=()=>sheetBarService.scroll$.subscribe((state=>{updateScrollButtonState(state)})),setupSubscribeScrollX=()=>sheetBarService.scrollX$.subscribe((x=>{slideTabBarRef.current.slideTabBar?.flipPage(x)})),setupSubscribeRenameId=()=>sheetBarService.renameId$.subscribe((()=>{slideTabBarRef.current.slideTabBar?.getActiveItem()?.setEditor()})),updateScrollButtonState=state=>{const{leftEnd,rightEnd}=state;let boxShadow="";leftEnd&&rightEnd?boxShadow="":leftEnd&&!rightEnd?boxShadow="inset -10px 0px 10px -10px rgba(0, 0, 0, 0.2)":!leftEnd&&rightEnd?boxShadow="inset 10px 0px 10px -10px rgba(0, 0, 0, 0.2)":leftEnd||rightEnd||(boxShadow="inset 10px 0px 10px -10px rgba(0, 0, 0, 0.2), inset -10px 0px 10px -10px rgba(0, 0, 0, 0.2)"),setBoxShadow(boxShadow)},resizeInit=slideTabBar=>{const slideTabBarContainer=slideTabBarContainerRef.current?.querySelector(`.${sheet_bar_sheet_bar_tabs_index_module.slideTabBar}`);if(!slideTabBarContainer)return;const observer=new ResizeObserver((()=>{(slideTabBar=>{const scrollX=slideTabBar.calculateActiveTabItemScrollX();if(scrollX){const scrollBar=slideTabBar.getScrollbar();scrollBar.scrollX(scrollBar.getScrollX()+scrollX)}sheetBarService.setScroll({leftEnd:slideTabBar.isLeftEnd(),rightEnd:slideTabBar.isRightEnd()})})(slideTabBar)}));return observer.observe(slideTabBarContainer),()=>observer.disconnect()},onVisibleChange=visible=>{if(showContextMenu&&!editorBridgeService?.isForceKeepVisible()){if(visible){const{left:containerLeft}=slideTabBarContainerRef.current?.getBoundingClientRect()??{},{left:activeTabLeft}=slideTabBarRef.current.slideTabBar?.getActiveItem()?.getSlideTabItem().getBoundingClientRect()??{};void 0!==containerLeft&&void 0!==activeTabLeft&&setOffset([activeTabLeft-containerLeft,0])}setVisible(visible)}};return(0,jsx_runtime.jsx)(design_src.jI,{className:sheet_bar_sheet_bar_tabs_index_module.slideTabItemDropdown,visible,align:{offset},trigger:["contextMenu"],overlay:(0,jsx_runtime.jsx)(ui_src.pe,{menuType:ui_src.ai.FOOTER_TABS,onOptionSelect:params=>{const{label:id,value,commandId}=params;commandService.executeCommand(commandId??id,{value,subUnitId:activeKey}),setVisible(!1)}}),onVisibleChange,children:(0,jsx_runtime.jsx)("div",{className:sheet_bar_sheet_bar_tabs_index_module.slideTabBarContainer,ref:slideTabBarContainerRef,onDragStart:e=>e.preventDefault(),onContextMenu:e=>e.preventDefault(),children:(0,jsx_runtime.jsx)("div",{className:sheet_bar_sheet_bar_tabs_index_module.slideTabBar,style:{boxShadow},children:sheetList.map((item=>(0,react.createElement)(SheetBarItem,{...item,key:item.sheetId,selected:activeKey===item.sheetId})))})})})}SheetBarTabs.__docgenInfo={description:"",methods:[],displayName:"SheetBarTabs"};const SheetBar=()=>{const[leftScrollState,setLeftScrollState]=(0,react.useState)(!0),[rightScrollState,setRightScrollState]=(0,react.useState)(!0),commandService=(0,ui_src.fJ)(src.wTY),sheetBarService=(0,ui_src.fJ)(ISheetBarService),permissionService=(0,ui_src.fJ)(src.QWp),unitId=useActiveWorkbook().getUnitId(),workbookEditablePermission=(0,ui_src.J2)(permissionService.getPermissionPoint$(new sheets_src.W30(unitId)?.id)),workbookCreateSheetPermission=(0,ui_src.J2)(permissionService.getPermissionPoint$(new sheets_src.ZZ1(unitId)?.id));(0,react.useEffect)((()=>{const subscription=sheetBarService.scroll$.subscribe((state=>{updateScrollButtonState(state)}));return()=>{subscription.unsubscribe()}}),[]);const updateScrollButtonState=state=>{const{leftEnd,rightEnd}=state;setLeftScrollState(leftEnd),setRightScrollState(rightEnd)};return(0,jsx_runtime.jsxs)("div",{className:(0,design_src.$z)(views_sheet_bar_index_module.sheetBar,"univer-relative univer-flex univer-h-full univer-flex-1"),children:[(0,jsx_runtime.jsxs)("div",{className:views_sheet_bar_index_module.sheetBarOptions,children:[(0,jsx_runtime.jsx)(SheetBarButton,{onClick:()=>{commandService.executeCommand(sheets_src.cz2.id),setTimeout((()=>{sheetBarService.setAddSheet(0)}),0)},disabled:!(workbookCreateSheetPermission?.value&&workbookEditablePermission?.value),children:(0,jsx_runtime.jsx)(increase_single.A,{})}),(0,jsx_runtime.jsx)(SheetBarMenu,{})]}),(0,jsx_runtime.jsx)(SheetBarTabs,{}),(!leftScrollState||!rightScrollState)&&(0,jsx_runtime.jsxs)("div",{className:`\n                      ${views_sheet_bar_index_module.sheetBarOptions}\n                      ${views_sheet_bar_index_module.sheetBarOptionsDivider}\n                    `,children:[(0,jsx_runtime.jsx)(SheetBarButton,{disabled:leftScrollState,onClick:()=>{sheetBarService.setScrollX(-100)},children:(0,jsx_runtime.jsx)(more_single.A,{style:{transform:"rotateZ(180deg)"}})}),(0,jsx_runtime.jsx)(SheetBarButton,{disabled:rightScrollState,onClick:()=>{sheetBarService.setScrollX(100)},children:(0,jsx_runtime.jsx)(more_single.A,{})})]})]})};SheetBar.__docgenInfo={description:"",methods:[],displayName:"SheetBar"};class StatusBarService{dispose(){this._state$.complete()}setState(param){const newState={values:[],pattern:null};param?.values.forEach((item=>{const func=this._functions.find((func=>func.func===item.func));func&&(void 0===func.filter||func.filter(param))&&newState.values.push(item)})),newState.pattern=param?.pattern??null,this._state$.next(newState)}getState(){return this._state$.getValue()}getFunctions(){return this._functions}addFunctions(functions){this._functions.push(...functions)}constructor(){this._functions=[{func:engine_formula_src._1.MAX,filter:status=>(status.values.find((item=>item.func===engine_formula_src._1.COUNTA))?.value??0)>1&&(status.values.find((item=>item.func===engine_formula_src._1.COUNT))?.value??0)>0},{func:engine_formula_src._1.MIN,filter:status=>(status.values.find((item=>item.func===engine_formula_src._1.COUNTA))?.value??0)>1&&(status.values.find((item=>item.func===engine_formula_src._1.COUNT))?.value??0)>0},{func:engine_formula_src.hK.SUM,filter:status=>(status.values.find((item=>item.func===engine_formula_src._1.COUNTA))?.value??0)>1&&(status.values.find((item=>item.func===engine_formula_src._1.COUNT))?.value??0)>0},{func:engine_formula_src._1.COUNTA,filter:status=>(status.values.find((item=>item.func===engine_formula_src._1.COUNTA))?.value??0)>1},{func:engine_formula_src._1.COUNT,filter:status=>(status.values.find((item=>item.func===engine_formula_src._1.COUNTA))?.value??0)>1&&(status.values.find((item=>item.func===engine_formula_src._1.COUNT))?.value??0)>0},{func:engine_formula_src._1.AVERAGE,filter:status=>(status.values.find((item=>item.func===engine_formula_src._1.COUNTA))?.value??0)>1&&(status.values.find((item=>item.func===engine_formula_src._1.COUNT))?.value??0)>0}],this._state$=new BehaviorSubject.t(null),this.state$=this._state$.asObservable()}}const IStatusBarService=(0,src.Qmd)("univer.sheet-status-bar.service");var status_bar_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/status-bar/index.module.less"),status_bar_index_module_options={};status_bar_index_module_options.styleTagTransform=styleTagTransform_default(),status_bar_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),status_bar_index_module_options.insert=insertBySelector_default().bind(null,"head"),status_bar_index_module_options.domAPI=styleDomAPI_default(),status_bar_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(status_bar_index_module.A,status_bar_index_module_options);const views_status_bar_index_module=status_bar_index_module.A&&status_bar_index_module.A.locals?status_bar_index_module.A.locals:void 0,allowPatternFunctions=[engine_formula_src.hK.SUM,engine_formula_src._1.AVERAGE,engine_formula_src._1.MIN,engine_formula_src._1.MAX],functionDisplayNames={[engine_formula_src.hK.SUM]:"statusbar.sum",[engine_formula_src._1.AVERAGE]:"statusbar.average",[engine_formula_src._1.MIN]:"statusbar.min",[engine_formula_src._1.MAX]:"statusbar.max",[engine_formula_src._1.COUNT]:"statusbar.count",[engine_formula_src._1.COUNTA]:"statusbar.countA",[engine_formula_src.OE.CONCATENATE]:"concatenate"},CopyableStatisticItem=item=>{const localeService=(0,ui_src.fJ)(src.iH9),messageService=(0,ui_src.fJ)(ui_src.mX),clipboardService=(0,ui_src.fJ)(ui_src.O),formateValue=function formatNumber(item){const{pattern,value:num}=item;if("number"!=typeof num)return 0;if(num>=1e8)return num.toExponential(2);if(pattern&&allowPatternFunctions.includes(item.name))return src.gIL.format(pattern,num,{throws:!1});return num.toLocaleString()}(item);return(0,jsx_runtime.jsx)(design_src.m_,{title:localeService.t("statusbar.clickToCopy"),placement:"top",children:(0,jsx_runtime.jsx)("div",{className:views_status_bar_index_module.statisticItem,onClick:async()=>{await clipboardService.writeText(item.value.toString()),messageService.show({type:design_src.Go.Success,content:localeService.t("statusbar.copied")})},children:(0,jsx_runtime.jsx)("span",{children:`${localeService.t(functionDisplayNames?.[item.name]||item.name)}: ${formateValue}`})},item.name)})};CopyableStatisticItem.__docgenInfo={description:"",methods:[],displayName:"CopyableStatisticItem",props:{name:{required:!0,tsType:{name:"union",raw:"| string\n| FUNCTION_NAMES_ARRAY\n| FUNCTION_NAMES_COMPATIBILITY\n| FUNCTION_NAMES_CUBE\n| FUNCTION_NAMES_DATABASE\n| FUNCTION_NAMES_DATE\n| FUNCTION_NAMES_ENGINEERING\n| FUNCTION_NAMES_FINANCIAL\n| FUNCTION_NAMES_INFORMATION\n| FUNCTION_NAMES_LOGICAL\n| FUNCTION_NAMES_LOOKUP\n| FUNCTION_NAMES_MATH\n| FUNCTION_NAMES_META\n| FUNCTION_NAMES_STATISTICAL\n| FUNCTION_NAMES_TEXT\n| FUNCTION_NAMES_UNIVER\n| FUNCTION_NAMES_WEB",elements:[{name:"string"},{name:"FUNCTION_NAMES_ARRAY"},{name:"FUNCTION_NAMES_COMPATIBILITY"},{name:"FUNCTION_NAMES_CUBE"},{name:"FUNCTION_NAMES_DATABASE"},{name:"FUNCTION_NAMES_DATE"},{name:"FUNCTION_NAMES_ENGINEERING"},{name:"FUNCTION_NAMES_FINANCIAL"},{name:"FUNCTION_NAMES_INFORMATION"},{name:"FUNCTION_NAMES_LOGICAL"},{name:"FUNCTION_NAMES_LOOKUP"},{name:"FUNCTION_NAMES_MATH"},{name:"FUNCTION_NAMES_META"},{name:"FUNCTION_NAMES_STATISTICAL"},{name:"FUNCTION_NAMES_TEXT"},{name:"FUNCTION_NAMES_UNIVER"},{name:"FUNCTION_NAMES_WEB"}]},description:""},value:{required:!0,tsType:{name:"number"},description:""},show:{required:!0,tsType:{name:"boolean"},description:""},disable:{required:!0,tsType:{name:"boolean"},description:""},pattern:{required:!0,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""}}};const StatusBar=()=>{const configService=(0,ui_src.fJ)(src.J0C),showStatistic=configService.getConfig("sheets-ui.config")?.statusBarStatistic??!0,[isSingle,setIsSingle]=(0,react.useState)(window.innerWidth<800),statusBarService=(0,ui_src.fJ)(IStatusBarService),items=statusBarService.getFunctions().map(((item,index)=>({name:item.func,value:0,show:!0,disable:!1,pattern:null}))),{showList,show}=((initialItems,statusBarService,isSingle,showStatistic)=>{const[statistics,setStatistics]=(0,react.useState)(initialItems),[show,setShow]=(0,react.useState)(!0),filteredStatistics=(0,react.useMemo)((()=>statistics.filter((item=>item.show&&!item.disable))),[statistics]),firstItem=(0,react.useMemo)((()=>filteredStatistics.find((item=>item.show&&!item.disable))),[filteredStatistics]),showList=(0,react.useMemo)((()=>isSingle&&firstItem?[firstItem]:filteredStatistics),[isSingle,firstItem,filteredStatistics]),updateStatistics=(0,react.useCallback)((state=>{const items=state?.values;items?.length?(setShow(!0),setStatistics((prevStats=>prevStats.map((stat=>({...stat,value:items.find((i=>i.func===stat.name))?.value??stat.value,disable:!items.some((i=>i.func===stat.name)),pattern:state?.pattern??null})))))):setShow(!1)}),[]);return(0,react.useEffect)((()=>{if(!showStatistic)return;const subscription=statusBarService.state$.subscribe(updateStatistics);return()=>subscription.unsubscribe()}),[showStatistic,statusBarService,updateStatistics]),{statistics,showList,show}})(items,statusBarService,isSingle,showStatistic),handleResize=(0,src.sg1)((()=>{const newSingleState=window.innerWidth<800;isSingle!==newSingleState&&setIsSingle(newSingleState)}),100);(0,react.useEffect)((()=>(window.addEventListener("resize",handleResize),()=>{window.removeEventListener("resize",handleResize)})),[isSingle]);const renderContent=((showList,rowCountThreshold,CopyableStatisticItem)=>{if(!showStatistic)return null;return react.useMemo((()=>{if(showList.length>rowCountThreshold){const doubleLineList=showList.reduce(((acc,_,index)=>(index%2==0&&acc.push(showList.slice(index,index+2)),acc)),[]);return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:doubleLineList.map(((item,index)=>(0,jsx_runtime.jsxs)("div",{className:views_status_bar_index_module.statisticListColumn,children:[item[0]&&(0,jsx_runtime.jsx)(CopyableStatisticItem,{...item[0]},item[0].name),item[1]&&(0,jsx_runtime.jsx)(CopyableStatisticItem,{...item[1]},item[1].name)]},`stat-col-${index}`)))})}return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:showList.map((item=>(0,jsx_runtime.jsx)(CopyableStatisticItem,{...item},item.name)))})}),[showList,rowCountThreshold,CopyableStatisticItem])})(showList,3,CopyableStatisticItem);return show&&(0,jsx_runtime.jsxs)("div",{className:(0,design_src.$z)(views_status_bar_index_module.statusBar,{[views_status_bar_index_module.singleMode]:isSingle}),children:[(0,jsx_runtime.jsx)("div",{className:"univer-flex",children:renderContent}),(0,jsx_runtime.jsx)("div",{className:views_status_bar_index_module.statusBarDiv})]})};StatusBar.__docgenInfo={description:"",methods:[],displayName:"StatusBar"};function RenderSheetFooter(){const menuManagerService=(0,ui_src.fJ)(ui_src.Zi);if(!useActiveWorkbook())return null;const footerMenus=menuManagerService.getMenuByPositionKey(ui_src.ai.FOOTER_MENU);return(0,jsx_runtime.jsxs)("section",{className:"\n              univer-box-border univer-flex univer-items-center univer-justify-between univer-bg-white univer-px-5\n              univer-text-gray-900\n              dark:univer-bg-gray-900 dark:univer-text-gray-200\n            ",style:{height:36},"data-range-selector":!0,children:[(0,jsx_runtime.jsx)(SheetBar,{}),(0,jsx_runtime.jsx)(StatusBar,{}),footerMenus.length&&(0,jsx_runtime.jsx)("div",{className:"univer-mr-2 univer-flex univer-gap-2",children:footerMenus.map((item=>item.children?.map((child=>child?.item&&(0,jsx_runtime.jsx)(ui_src.Tm,{...child.item},child.key)))))}),(0,jsx_runtime.jsx)(CountBar_CountBar,{})]})}function RenderSheetHeader(){return useHasWorkbook()?(0,jsx_runtime.jsx)(FormulaBar,{}):null}function RenderSheetContent(){return useHasWorkbook()?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(EditorContainer,{}),(0,jsx_runtime.jsx)(AutoFillPopupMenu,{})]}):null}function useHasWorkbook(){const univerInstanceService=(0,ui_src.fJ)(src.HCr),hasWorkbook=!!(0,ui_src.J2)((()=>univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET)),null,!1,[]);return(0,react.useMemo)((()=>univerInstanceService.getAllUnitsForType(src.Zy$.UNIVER_SHEET).length>0),[univerInstanceService,hasWorkbook])}function cell_editor_resize_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function cell_editor_resize_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}RenderSheetFooter.__docgenInfo={description:"",methods:[],displayName:"RenderSheetFooter"},RenderSheetHeader.__docgenInfo={description:"",methods:[],displayName:"RenderSheetHeader"},RenderSheetContent.__docgenInfo={description:"@deprecated We should not write into this component anymore.",methods:[],displayName:"RenderSheetContent"};class SheetCellEditorResizeService extends src.jGt{constructor(_context,_layoutService,_cellEditorManagerService,_editorBridgeService,_renderManagerService,_sheetSkeletonManagerService,_univerInstanceService){super(),this._context=_context,this._layoutService=_layoutService,this._cellEditorManagerService=_cellEditorManagerService,this._editorBridgeService=_editorBridgeService,this._renderManagerService=_renderManagerService,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._univerInstanceService=_univerInstanceService}fitTextSize(callback){const param=this._editorBridgeService.getEditCellState();if(!param)return;const{position,documentLayoutObject,canvasOffset,scaleX,scaleY}=param,{startX,startY,endX,endY}=position,documentDataModel=this._univerInstanceService.getUnit(src.Fmw,src.Zy$.UNIVER_DOC);if(null==documentDataModel)return;const documentSkeleton=this._getEditorSkeleton();if(!documentSkeleton)return;const info=this._predictingSize(position,canvasOffset,documentSkeleton,documentLayoutObject,scaleX,scaleY);if(!info)return;let{actualWidth,actualHeight}=info;const{verticalAlign,horizontalAlign,paddingData,fill}=documentLayoutObject;actualWidth=actualWidth+(paddingData.l??0)+(paddingData.r??0),actualHeight=actualHeight+(paddingData.t??0)+(paddingData.b??0);let editorWidth=endX-startX,editorHeight=endY-startY;editorWidth<actualWidth&&(editorWidth=Math.ceil(actualWidth)),editorHeight<actualHeight&&(editorHeight=Math.ceil(actualHeight));let offsetTop=0;offsetTop=verticalAlign===src.G4t.MIDDLE?(editorHeight-actualHeight)/2/scaleY:verticalAlign===src.G4t.TOP?paddingData.t||0:(editorHeight-actualHeight)/scaleY;let offsetLeft=0;offsetLeft=horizontalAlign===src.wqs.CENTER?(editorWidth-actualWidth)/2/scaleX:horizontalAlign===src.wqs.RIGHT?(editorWidth-actualWidth)/scaleX:paddingData.l||0,offsetTop=offsetTop<(paddingData.t||0)?paddingData.t||0:offsetTop,offsetLeft=offsetLeft<(paddingData.l||0)?paddingData.l||0:offsetLeft,documentDataModel.updateDocumentDataMargin({t:offsetTop,l:offsetLeft}),documentSkeleton.calculate(),this._editAreaProcessing(editorWidth,editorHeight,position,canvasOffset,fill,scaleX,scaleY,horizontalAlign,callback)}_predictingSize(actualRangeWithCoord,canvasOffset,documentSkeleton,documentLayoutObject,scaleX=1,scaleY=1){const{startX,endX}=actualRangeWithCoord,{textRotation,wrapStrategy,paddingData}=documentLayoutObject,documentDataModel=this._univerInstanceService.getUnit(src.Fmw,src.Zy$.UNIVER_DOC),{vertexAngle:angle}=(0,engine_render_src.XBM)(textRotation);if(wrapStrategy===src.sFy.WRAP&&0===angle){documentDataModel?.updateDocumentDataPageSize(endX-startX),documentDataModel?.updateDocumentDataMargin({l:paddingData.l,t:paddingData.t}),documentSkeleton.calculate();const{actualWidth,actualHeight}=documentSkeleton.getActualSize();return{actualWidth:actualWidth*scaleX,actualHeight:actualHeight*scaleY}}const maxSize=this._getEditorMaxSize(actualRangeWithCoord,canvasOffset,documentLayoutObject.horizontalAlign);if(!maxSize)return;documentDataModel?.updateDocumentDataPageSize(maxSize.width/scaleX),documentSkeleton.calculate();const size=documentSkeleton.getActualSize();let editorWidth=endX-startX;return editorWidth<size.actualWidth*scaleX+5*scaleX&&(editorWidth=size.actualWidth*scaleX+5*scaleX),documentDataModel?.updateDocumentDataPageSize(editorWidth/scaleX),documentDataModel?.updateDocumentRenderConfig({horizontalAlign:src.wqs.UNSPECIFIED,cellValueType:void 0}),{actualWidth:size.actualWidth*scaleX,actualHeight:size.actualHeight*scaleY}}_getEditorMaxSize(position,canvasOffset,horizontalAlign){if(null==this._getEditorObject())return;const canvasElement=this._context.engine.getCanvasElement(),canvasClientRect=canvasElement.getBoundingClientRect(),widthOfCanvas=function pxToNum(width){return Number.parseInt(width.replace("px",""))}(canvasElement.style.width),{width}=canvasClientRect,scaleAdjust=width/widthOfCanvas,{startX,startY,endX}=position,enginWidth=this._context.engine.width,clientHeight=document.body.clientHeight-startY-36-canvasOffset.top-4;let clientWidth=width-startX;if(horizontalAlign===src.wqs.CENTER){const rightGap=enginWidth-endX,leftGap=startX;clientWidth=endX-startX+2*Math.min(leftGap,rightGap)}else horizontalAlign===src.wqs.RIGHT&&(clientWidth=endX);return{height:clientHeight,width:clientWidth-2,scaleAdjust}}_editAreaProcessing(editorWidth,editorHeight,actualRangeWithCoord,canvasOffset,fill,scaleX=1,scaleY=1,horizontalAlign,callback){const editorObject=this._getEditorObject();if(null==editorObject)return;const canvasElement=this._context.engine.getCanvasElement();let{startX,startY}=actualRangeWithCoord;const{document:documentComponent,scene:editorScene,engine:docEngine}=editorObject,viewportMain=editorScene.getViewport(docs_view_key.hl.VIEW_MAIN),info=this._getEditorMaxSize(actualRangeWithCoord,canvasOffset,horizontalAlign),{height:clientHeight,width:clientWidth,scaleAdjust}=info;let physicHeight=editorHeight,scrollBar=viewportMain?.getScrollBar();physicHeight>clientHeight?(null==scrollBar?viewportMain&&new engine_render_src.$H1(viewportMain,{enableHorizontal:!1,barSize:8}):viewportMain?.resetCanvasSizeAndUpdateScroll(),viewportMain?.scrollToViewportPos({viewportScrollY:physicHeight-clientHeight}),physicHeight=clientHeight):(scrollBar=null,viewportMain?.getScrollBar()?.dispose()),(editorWidth+=scrollBar?.barSize||0)>clientWidth&&(editorWidth=clientWidth),this._addBackground(editorScene,editorWidth/scaleX,editorHeight/scaleY,fill);const{scaleX:precisionScaleX,scaleY:precisionScaleY}=editorScene.getPrecisionScale();editorScene.transformByState({width:editorWidth*scaleAdjust/scaleX,height:editorHeight*scaleAdjust/scaleY,scaleX:scaleX*scaleAdjust,scaleY:scaleY*scaleAdjust}),documentComponent.resize(editorWidth*scaleAdjust/scaleX,editorHeight*scaleAdjust/scaleY),setTimeout((()=>{docEngine.resizeBySize((0,engine_render_src.PQ5)(editorWidth,precisionScaleX),(0,engine_render_src.PQ5)(physicHeight,precisionScaleY)),callback?.()}),0);const contentBoundingRect=this._layoutService.getContentElement().getBoundingClientRect(),canvasBoundingRect=canvasElement.getBoundingClientRect();startX=startX*scaleAdjust+(canvasBoundingRect.left-contentBoundingRect.left),startY=startY*scaleAdjust+(canvasBoundingRect.top-contentBoundingRect.top);const cellWidth=actualRangeWithCoord.endX-actualRangeWithCoord.startX;horizontalAlign===src.wqs.RIGHT?startX+=(cellWidth-editorWidth)*scaleAdjust:horizontalAlign===src.wqs.CENTER&&(startX+=(cellWidth-editorWidth*scaleAdjust)/2),this._cellEditorManagerService.setState({startX,startY,endX:editorWidth*scaleAdjust+startX,endY:physicHeight*scaleAdjust+startY,show:!0})}_addBackground(scene,editorWidth,editorHeight,fill){const rect=scene.getObject("_backgroundRectHelperColor_");null==rect&&null==fill||(null==rect?scene.addObjects([new engine_render_src.rwV("_backgroundRectHelperColor_",{width:editorWidth,height:editorHeight,fill,evented:!1})],docs_view_key.lN):null==fill?rect.dispose():(rect.setProps({fill}),rect.transformByState({width:editorWidth,height:editorHeight})))}resizeCellEditor(callback){const state=this._cellEditorManagerService.getState();if(!state)return;if(!this._editorBridgeService.isVisible().visible)return;this._editorBridgeService.refreshEditCellPosition(!0);const editCellState=this._editorBridgeService.getEditCellState();if(!editCellState)return;const skeleton=this._sheetSkeletonManagerService.getSkeletonParam(editCellState.sheetId)?.skeleton;if(!skeleton)return;const{row,column,scaleX,scaleY,position,canvasOffset,documentLayoutObject}=editCellState,{horizontalAlign}=documentLayoutObject,maxSize=this._getEditorMaxSize(position,canvasOffset,horizontalAlign);if(!maxSize)return;const{height:clientHeight,width:clientWidth,scaleAdjust}=maxSize,cell=skeleton.getCellWithCoordByIndex(row,column),height=Math.min((cell.mergeInfo.endY-cell.mergeInfo.startY)*scaleY,clientHeight)*scaleAdjust,width=Math.min((cell.mergeInfo.endX-cell.mergeInfo.startX)*scaleX,clientWidth)*scaleAdjust,currentHeight=state.endY-state.startY,currentWidth=state.endX-state.startX;if(currentHeight!==height||currentWidth!==width){this._editorBridgeService.refreshEditCellPosition(!0);if(!this._getEditorSkeleton())return;this.fitTextSize(callback)}}_getEditorObject(){return getEditorObject(this._editorBridgeService.getCurrentEditorId(),this._renderManagerService)}_getEditorSkeleton(){return this._renderManagerService.getRenderById(src.Fmw)?.with(docs_src.EX).getSkeleton()}}function whenSheetFocused(contextService){return contextService.getContextValue(src.xU)}function whenSheetEditorFocused(contextService){return contextService.getContextValue(src.xU)&&contextService.getContextValue(src.l1D)&&!contextService.getContextValue(src.AF$)&&!contextService.getContextValue(src.fiP)}function whenSheetEditorFocusedAndFxNotFocused(contextService){return contextService.getContextValue(src.xU)&&contextService.getContextValue(src.l1D)&&!contextService.getContextValue(src.AF$)&&!contextService.getContextValue(src.kgb)&&!contextService.getContextValue(src.fiP)}function whenFormulaEditorFocused(contextService){return contextService.getContextValue(src.kgb)&&contextService.getContextValue(src.l1D)}function whenEditorDidNotInputFormulaActivated(contextService){return contextService.getContextValue(src.xU)&&contextService.getContextValue(src.l1D)&&contextService.getContextValue(src.AF$)&&!contextService.getContextValue(src.fXv)&&!contextService.getContextValue(src.RFS)}SheetCellEditorResizeService=function cell_editor_resize_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([cell_editor_resize_service_ts_param(1,ui_src.xQ),cell_editor_resize_service_ts_param(2,ICellEditorManagerService),cell_editor_resize_service_ts_param(3,editor_bridge_service_IEditorBridgeService),cell_editor_resize_service_ts_param(4,engine_render_src.cSx),cell_editor_resize_service_ts_param(5,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),cell_editor_resize_service_ts_param(6,src.HCr),cell_editor_resize_service_ts_metadata("design:type",Function),cell_editor_resize_service_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===ui_src.xQ?Object:ui_src.xQ,void 0===ICellEditorManagerService?Object:ICellEditorManagerService,void 0===editor_bridge_service_IEditorBridgeService?Object:editor_bridge_service_IEditorBridgeService,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService,void 0===src.HCr?Object:src.HCr])],SheetCellEditorResizeService);const ARROW_SELECTION_KEYCODE_LIST=[ui_src.DD.ARROW_DOWN,ui_src.DD.ARROW_UP,ui_src.DD.ARROW_LEFT,ui_src.DD.ARROW_RIGHT],MOVE_SELECTION_KEYCODE_LIST=[ui_src.DD.ENTER,ui_src.DD.TAB,...ARROW_SELECTION_KEYCODE_LIST];function generateArrowSelectionShortCutItem(){const shortcutList=[];for(const keycode of ARROW_SELECTION_KEYCODE_LIST)shortcutList.push({id:SetCellEditVisibleArrowOperation.id,binding:keycode,preconditions:contextService=>whenEditorDidNotInputFormulaActivated(contextService),staticParameters:{visible:!1,eventType:engine_render_src.bKQ.Keyboard,keycode,isShift:!1}}),shortcutList.push({id:SetCellEditVisibleArrowOperation.id,binding:keycode|ui_src.SK.SHIFT,preconditions:contextService=>whenEditorDidNotInputFormulaActivated(contextService),staticParameters:{visible:!1,eventType:engine_render_src.bKQ.Keyboard,keycode,isShift:!0}});return shortcutList}const StartEditWithF2Shortcut={id:SetCellEditVisibleWithF2Operation.id,binding:ui_src.DD.F2,description:"shortcut.sheet.start-editing",group:"4_sheet-edit",preconditions:whenSheetEditorFocused,staticParameters:{visible:!0,eventType:engine_render_src.bKQ.Keyboard,keycode:ui_src.DD.F2}},EditorCursorEnterShortcut={id:SetCellEditVisibleOperation.id,binding:ui_src.DD.ENTER,description:"shortcut.sheet.toggle-editing",group:"4_sheet-edit",preconditions:contextService=>whenEditorDidNotInputFormulaActivated(contextService),staticParameters:{visible:!1,eventType:engine_render_src.bKQ.Keyboard,keycode:ui_src.DD.ENTER}},EditorCursorTabShortcut={id:SetCellEditVisibleOperation.id,binding:ui_src.DD.TAB,preconditions:contextService=>whenEditorDidNotInputFormulaActivated(contextService),staticParameters:{visible:!1,eventType:engine_render_src.bKQ.Keyboard,keycode:ui_src.DD.TAB}},EditorCursorEscShortcut={id:SetCellEditVisibleOperation.id,binding:ui_src.DD.ESC,description:"shortcut.sheet.abort-editing",group:"4_sheet-edit",preconditions:contextService=>whenEditorDidNotInputFormulaActivated(contextService),staticParameters:{visible:!1,eventType:engine_render_src.bKQ.Keyboard,keycode:ui_src.DD.ESC}},EditorBreakLineShortcut={id:break_line_command.Z.id,description:"shortcut.sheet.break-line",group:"4_sheet-edit",preconditions:contextService=>function whenSheetEditorActivated(contextService){return contextService.getContextValue(src.xU)&&contextService.getContextValue(src.l1D)&&contextService.getContextValue(src.AF$)}(contextService),binding:ui_src.DD.ENTER|ui_src.SK.ALT},EditorDeleteLeftShortcut={id:doc_delete_command.iM.id,preconditions:contextService=>function whenEditorActivated(contextService){return contextService.getContextValue(src.l1D)&&contextService.getContextValue(src.AF$)}(contextService)||whenFormulaEditorFocused(contextService),binding:ui_src.DD.BACKSPACE},EditorDeleteLeftShortcutInActive={id:SetCellEditVisibleOperation.id,description:"shortcut.sheet.delete-and-start-editing",group:"4_sheet-edit",preconditions:contextService=>whenSheetEditorFocused(contextService)&&!whenFormulaEditorFocused(contextService),binding:ui_src.DD.BACKSPACE,staticParameters:{visible:!0,eventType:engine_render_src.bKQ.Keyboard,keycode:ui_src.DD.BACKSPACE}};const fullWidthToHalfWidthMap={"０":"0","１":"1","２":"2","３":"3","４":"4","５":"5","６":"6","７":"7","８":"8","９":"9",Ａ:"A",Ｂ:"B",Ｃ:"C",Ｄ:"D",Ｅ:"E",Ｆ:"F",Ｇ:"G",Ｈ:"H",Ｉ:"I",Ｊ:"J",Ｋ:"K",Ｌ:"L",Ｍ:"M",Ｎ:"N",Ｏ:"O",Ｐ:"P",Ｑ:"Q",Ｒ:"R",Ｓ:"S",Ｔ:"T",Ｕ:"U",Ｖ:"V",Ｗ:"W",Ｘ:"X",Ｙ:"Y",Ｚ:"Z",ａ:"a",ｂ:"b",ｃ:"c",ｄ:"d",ｅ:"e",ｆ:"f",ｇ:"g",ｈ:"h",ｉ:"i",ｊ:"j",ｋ:"k",ｌ:"l",ｍ:"m",ｎ:"n",ｏ:"o",ｐ:"p",ｑ:"q",ｒ:"r",ｓ:"s",ｔ:"t",ｕ:"u",ｖ:"v",ｗ:"w",ｘ:"x",ｙ:"y",ｚ:"z","％":"%","－":"-","．":".","：":":","／":"/","＋":"+","＠":"@","＆":"&","＊":"*","＃":"#","＝":"=","＞":">","＜":"<","＄":"$","＂":'"',"＇":"'","（":"(","）":")","　":" ","，":",","！":"!","？":"?","；":";","［":"[","］":"]","｛":"{","｝":"}"},booleanMap={true:"TRUE",false:"FALSE"};function normalizeString(str,lexerTreeBuilder,currentLocale,functionService){let normalStr=str;if(function isCJKLocale(locale){return[src.VnV.ZH_CN,src.VnV.ZH_TW].includes(locale)}(currentLocale)){if(str.startsWith("＇")||str.startsWith("'"))return`'${str.slice(1)}`;normalStr=function handleQuotedParts(str){const sheetNamePattern=/['"].*?['"]/g,quotedParts=[],parts=str.split(sheetNamePattern);str.replace(sheetNamePattern,(match=>(quotedParts.push(match),"")));let normalStr=parts.join("").split("").map(toHalfWidth).join("");return quotedParts.forEach(((part,idx)=>{normalStr=normalStr.slice(0,2*idx)+part+normalStr.slice(2*(idx+1))})),normalStr}(normalStr)}if(normalStr.startsWith("="))return function normalizeFormulaString(str,normalStr,lexerTreeBuilder,functionService){const nodes=lexerTreeBuilder.sequenceNodesBuilder(normalStr);if(!nodes)return str;let _normalStr=normalStr,totalOffset=0;return nodes.forEach(((node,index)=>{if("object"==typeof node){const token=node.token;if(booleanMap[token.toLowerCase()]){const startIndex=node.startIndex+totalOffset+1,endIndex=node.endIndex+totalOffset+2;_normalStr=replaceString(token.toLocaleUpperCase(),_normalStr,startIndex,endIndex)}else if(node.nodeType===engine_formula_src.kx.FUNCTION&&function hasFunctionName(name,functionService,nodes,index){const functionList=functionService.getDescriptions();if(nodes[index+1]!==engine_formula_src.RD.OPEN_BRACKET)return!1;return void 0!==functionList.get(function removeLeadingAtSymbols(str){const regex=/^@+/;return str.replace(regex,"")}(name).toLocaleUpperCase())}(token,functionService,nodes,index)||node.nodeType===engine_formula_src.kx.REFERENCE){const sheetNameIndex=token.indexOf("!");if(sheetNameIndex>-1){const refBody=token.substring(sheetNameIndex+1),startIndex=node.startIndex+totalOffset+(sheetNameIndex+1)+1,endIndex=node.endIndex+totalOffset+2;_normalStr=replaceString(refBody.toLocaleUpperCase(),_normalStr,startIndex,endIndex)}else{const startIndex=node.startIndex+totalOffset+1,endIndex=node.endIndex+totalOffset+2;_normalStr=replaceString(token.toLocaleUpperCase(),_normalStr,startIndex,endIndex)}}else if(token.startsWith('"')&&token.endsWith('"')||token.startsWith("'")&&token.endsWith("'")){const startIndex=node.startIndex+totalOffset+2,endIndex=node.endIndex+totalOffset+1;_normalStr=replaceString(str.slice(startIndex,endIndex),_normalStr,startIndex,endIndex)}else if(node.nodeType!==engine_formula_src.kx.ARRAY){const parsedValue=src.gIL.parseValue(token);if(null==parsedValue){const startIndex=node.startIndex+totalOffset+1,endIndex=node.endIndex+totalOffset+2;_normalStr=replaceString(str.slice(startIndex,endIndex),_normalStr,startIndex,endIndex)}else if("number"==typeof parsedValue.v&&(void 0===parsedValue.z||!src.gIL.isDate(parsedValue.z))){const v=`${parsedValue.v}`,startIndex=node.startIndex+totalOffset+1,endIndex=node.endIndex+totalOffset+2,{processedString,offset}=function processNumberStringWithSpaces(token,numStr){const leadingSpaces=token.match(/^\s*/)?.[0]||"",trailingSpaces=token.match(/\s*$/)?.[0]||"",processedString=leadingSpaces+numStr+trailingSpaces,offset=processedString.length-token.length;return{processedString,offset}}(token,v);_normalStr=replaceString(processedString,_normalStr,startIndex,endIndex),totalOffset+=offset}}}})),_normalStr}(str,normalStr,lexerTreeBuilder,functionService);const lowerCaseStr=normalStr.toLowerCase();if(booleanMap[lowerCaseStr])return booleanMap[lowerCaseStr];return null==src.gIL.parseValue(normalStr)?str:normalStr}function toHalfWidth(char){return fullWidthToHalfWidthMap[char]||char}function replaceString(replacedString,normalStr,startIndex,endIndex){return normalStr.substring(0,startIndex)+replacedString+normalStr.substring(endIndex)}function editing_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function editing_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class EditingRenderController extends src.jGt{constructor(_context,selectionManagerService,_undoRedoService,_contextService,_renderManagerService,_editorBridgeService,_cellEditorManagerService,_lexerTreeBuilder,_functionService,_textSelectionManagerService,_commandService,_localService,_editorService,_sheetCellEditorResizeService,_univerInstanceService,_sheetInterceptorService){super(),this._context=_context,this._undoRedoService=_undoRedoService,this._contextService=_contextService,this._renderManagerService=_renderManagerService,this._editorBridgeService=_editorBridgeService,this._cellEditorManagerService=_cellEditorManagerService,this._lexerTreeBuilder=_lexerTreeBuilder,this._functionService=_functionService,this._textSelectionManagerService=_textSelectionManagerService,this._commandService=_commandService,this._localService=_localService,this._editorService=_editorService,this._sheetCellEditorResizeService=_sheetCellEditorResizeService,this._univerInstanceService=_univerInstanceService,this._sheetInterceptorService=_sheetInterceptorService,this._cursorChange=0,this._isUnitEditing=!1,this._workbookSelections=selectionManagerService.getWorkbookSelections(this._context.unitId),this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET).subscribe((workbook=>{workbook?.getUnitId()===this._context.unitId?this._d=this._init():(this._disposeCurrent(),this._isUnitEditing&&(this._handleEditorInvisible({visible:!1,eventType:engine_render_src.bKQ.Keyboard,keycode:ui_src.DD.ESC,unitId:this._context.unitId}),this._isUnitEditing=!1))}))),this._initEditorVisibilityListener()}dispose(){super.dispose(),this._disposeCurrent()}_disposeCurrent(){this._d?.dispose(),this._d=null}_init(){const d=new src.VdD;return this._subscribeToCurrentCell(d),this._initialCursorSync(d),this._listenEditorFocus(d),this._commandExecutedListener(d),this._initSkeletonListener(d),d.add((()=>{clearTimeout(this._cursorTimeout)})),this._cursorTimeout=setTimeout((()=>{this._cursorStateListener(d)}),1e3),d}_initEditorVisibilityListener(){this.disposeWithMe(this._editorBridgeService.visible$.pipe((0,distinctUntilChanged.F)(((prev,curr)=>prev.visible===curr.visible))).subscribe((param=>{param.unitId!==src.azi&&param.unitId!==this._context.unitId||!param.visible?this._isUnitEditing&&(this._handleEditorInvisible(param),this._isUnitEditing=!1):(this._isUnitEditing=!0,this._handleEditorVisible(param))})))}_listenEditorFocus(d){const renderConfig=this._getEditorObject();renderConfig&&d.add(renderConfig.document.onPointerDown$.subscribeEvent((()=>{if(this._isUnitEditing&&this._editorBridgeService.isVisible()){const param=this._editorBridgeService.getEditCellState(),editorId=this._editorBridgeService.getCurrentEditorId();if(!param||!editorId)return;this._sheetCellEditorResizeService.fitTextSize()}})))}_initialCursorSync(d){d.add(this._cellEditorManagerService.focus$.pipe((0,filter.p)((f=>!!f))).subscribe((()=>{const currentDoc=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_DOC);if(!currentDoc)return;const docSelectionRenderManager=this._renderManagerService.getRenderById(currentDoc?.getUnitId())?.with(doc_selection_render_service.q);docSelectionRenderManager&&docSelectionRenderManager.sync()})))}_initSkeletonListener(d){const commandList=new Set(sheets_src.Izd);commandList.delete(sheets_src._M5.id),d.add(this._commandService.onCommandExecuted((commandInfo=>{if(commandList.has(commandInfo.id)){switch(commandInfo.id){case sheets_src.yNb.id:case sheets_src.YJl.id:case sheets_src.MIN.id:case sheets_src.G4z.id:case sheets_src.RmT.id:case sheets_src.bS1.id:{const editLocation=this._editorBridgeService.getEditLocation();if(!editLocation)break;const currentRange={startRow:editLocation.row,startColumn:editLocation.column,endRow:editLocation.row,endColumn:editLocation.column},newRange=(0,sheets_src.nlb)(currentRange,commandInfo);if(!newRange)break;const newRow=newRange.startRow,newColumn=newRange.startColumn;this._editorBridgeService.updateEditLocation(newRow,newColumn);break}}this._sheetCellEditorResizeService.resizeCellEditor((()=>{this._textSelectionManagerService.refreshSelection({unitId:src.Fmw,subUnitId:src.Fmw})}))}})))}_subscribeToCurrentCell(d){d.add(this._editorBridgeService.currentEditCellState$.subscribe((editCellState=>{if(null==editCellState||this._editorBridgeService.isForceKeepVisible())return;const state=this._editorBridgeService.getEditCellState();if(null==state)return;const{position,documentLayoutObject,scaleX,editorUnitId}=state;if(this._contextService.getContextValue(src.RFS))return;const cellDocument=this._getDocumentDataModel();if(null==cellDocument)return;const{startX,endX}=position,{textRotation,wrapStrategy,documentModel}=documentLayoutObject,{vertexAngle:angle}=(0,engine_render_src.XBM)(textRotation);wrapStrategy===src.sFy.WRAP&&0===angle&&cellDocument.updateDocumentDataPageSize((endX-startX)/scaleX),this._commandService.syncExecuteCommand(replace_content_command.e6.id,{unitId:editorUnitId,snapshot:documentModel.getSnapshot()}),this._contextService.setContextValue(src.ANQ,!0),this._textSelectionManagerService.replaceDocRanges([{startOffset:0,endOffset:0}],{unitId:src.Fmw,subUnitId:src.Fmw});const cellSelectionRenderManager=this._renderManagerService.getRenderById(src.Fmw)?.with(doc_selection_render_service.q),formulaSelectionRenderManager=this._renderManagerService.getRenderById(src.azi)?.with(doc_selection_render_service.q);(cellSelectionRenderManager?.canFocusing||formulaSelectionRenderManager?.canFocusing)&&(this._univerInstanceService.setCurrentUnitForType(src.Fmw),cellSelectionRenderManager?.activate(-1e3,-1e3,!0))})))}_commandExecutedListener(d){d.add(this._commandService.onCommandExecuted((command=>{if(command.id===docs_src.Bz.id){const params=command.params,{unitId:commandUnitId}=params;if(!this._isCurrentSheetFocused()||commandUnitId.includes("range_selector"))return;if(this._editorBridgeService.changeEditorDirty(!0),!this._editorBridgeService.isVisible().visible)return;commandUnitId===src.Fmw&&this._sheetCellEditorResizeService.fitTextSize()}})));const closeEditorOperation=[SetCellEditVisibleArrowOperation.id];d.add(this._commandService.onCommandExecuted((command=>{if(closeEditorOperation.includes(command.id)){const params=command.params,{keycode,isShift}=params;if(null!=keycode&&(2===this._cursorChange||this._contextService.getContextValue(src.kgb)))return void this._moveInEditor(keycode,isShift);this._commandService.syncExecuteCommand(SetCellEditVisibleOperation.id,params)}command.id===SetCellEditVisibleWithF2Operation.id&&(this._cursorChange=2)})))}_handleEditorVisible(param){const{eventType,keycode}=param;this._cursorChange=eventType===engine_render_src.bKQ.PointerDown||eventType===engine_render_src.bKQ.Dblclick?2:1;const editCellState=this._editorBridgeService.getEditLocation();if(null==editCellState)return;this._commandService.syncExecuteCommand(ScrollToRangeOperation.id,{range:{startRow:editCellState.row,startColumn:editCellState.column,endRow:editCellState.row,endColumn:editCellState.column}}),this._editorBridgeService.refreshEditCellPosition(!1);const{unitId,isInArrayFormulaRange=!1}=editCellState,editorObject=this._getEditorObject();if(null==editorObject)return;const{document,scene}=editorObject;this._contextService.setContextValue(src.AF$,!0);const documentDataModel=this._getDocumentDataModel(),skeleton=this._getEditorSkeleton(src.Fmw);if(skeleton&&documentDataModel){if(this._sheetCellEditorResizeService.fitTextSize((()=>{const viewMain=scene.getViewport(docs_view_key.hl.VIEW_MAIN);viewMain?.scrollToViewportPos({viewportScrollX:Number.POSITIVE_INFINITY,viewportScrollY:Number.POSITIVE_INFINITY})})),eventType===engine_render_src.bKQ.Keyboard&&keycode===ui_src.DD.F2){document.makeDirty(),this._textSelectionManagerService.replaceDocRanges([{startOffset:0,endOffset:0}]);const endOffset=(documentDataModel.getBody()?.dataStream.length??2)-2;this._textSelectionManagerService.replaceDocRanges([{startOffset:endOffset,endOffset}],{unitId:src.Fmw,subUnitId:src.Fmw})}else if(eventType===engine_render_src.bKQ.Keyboard||eventType===engine_render_src.bKQ.Dblclick&&isInArrayFormulaRange)this._emptyDocumentDataModel(documentDataModel.getSnapshot().documentStyle,!!isInArrayFormulaRange),document.makeDirty(),keycode!==ui_src.DD.BACKSPACE&&eventType!==engine_render_src.bKQ.Dblclick||(skeleton.calculate(),this._editorBridgeService.changeEditorDirty(!0)),this._textSelectionManagerService.replaceDocRanges([{startOffset:0,endOffset:0}],{unitId:src.Fmw,subUnitId:src.Fmw});else if(eventType===engine_render_src.bKQ.Dblclick){if(this._contextService.getContextValue(src.fXv))return;const cursor=documentDataModel.getBody().dataStream.length-2||0;this._textSelectionManagerService.replaceDocRanges([{startOffset:cursor,endOffset:cursor}])}this._renderManagerService.getRenderById(unitId)?.scene.resetCursor()}}async _handleEditorInvisible(param){const editCellState=this._editorBridgeService.getEditCellState(),documentDataModel=this._univerInstanceService.getUnit(src.Fmw),snapshot=src.S0q.deepClone(documentDataModel?.getSnapshot());let{keycode}=param;if(this._cursorChange=0,this._exitInput(param),null==editCellState)return;!1===this._editorBridgeService.getEditorDirty()&&(keycode=ui_src.DD.ESC);const worksheet=this._context.unit.getActiveSheet(),workbookId=this._context.unitId,worksheetId=worksheet.getSheetId(),{unitId,sheetId}=editCellState;if(workbookId===unitId&&sheetId!==worksheetId&&await this._commandService.executeCommand(sheets_src.LlJ.id,{subUnitId:sheetId,unitId}),keycode!==ui_src.DD.ESC){if(snapshot){if(!1===await this._submitCellData(snapshot))return}this._moveSelection(keycode)}else{this._editorBridgeService.isForceKeepVisible()&&this._editorBridgeService.disableForceKeepVisible();const selections=this._workbookSelections.getCurrentSelections();selections&&(this._contextService.setContextValue(sheets_src.C5D,!1),this._commandService.syncExecuteCommand(sheets_src.NSB.id,{unitId:this._context.unit.getUnitId(),subUnitId:sheetId,selections}))}}_getEditorObject(){return getEditorObject(this._editorBridgeService.getCurrentEditorId(),this._renderManagerService)}submitCellData(documentDataModel){return this._submitCellData(documentDataModel.getSnapshot())}async _submitCellData(snapshot){const editCellState=this._editorBridgeService.getEditCellState();if(null==editCellState)return!0;const{unitId,sheetId,row,column}=editCellState,workbook=this._context.unit;let worksheet=workbook.getActiveSheet();if(!workbook.getSheetBySheetId(sheetId))return!0;worksheet=workbook.getActiveSheet();const cellData=function getCellDataByInput(cellData,snapshot,lexerTreeBuilder,localeService,functionService,styles){if(null==snapshot?.body)return null;const{body}=snapshot;cellData.t=void 0;const data=body.dataStream;let newDataStream=data.substring(data.length-2,data.length)===src.Wd2?data.substring(0,data.length-2):data;const currentLocale=localeService.getCurrentLocale();if(newDataStream=normalizeString(newDataStream,lexerTreeBuilder,currentLocale,functionService),snapshot.drawingsOrder?.length)cellData.v="",cellData.f=null,cellData.si=null,cellData.p=snapshot,cellData.t=src.scd.STRING;else if(cellData.s&&(0,src_util.Z)(styles?.get(cellData.s)?.n?.pattern)){cellData.v=newDataStream,cellData.f=null,cellData.si=null,cellData.p=null,cellData.t=src.scd.STRING,isRichText(body)&&"\r\n"!==body.dataStream&&(cellData.p=snapshot);const style=getCellStyleBySnapshot(snapshot);style&&(cellData.s=style)}else if((0,src.qGs)(newDataStream)){if(cellData.f===newDataStream)return null;const bracketCount=lexerTreeBuilder.checkIfAddBracket(newDataStream);for(let i=0;i<bracketCount;i++)newDataStream+=engine_formula_src.RD.CLOSE_BRACKET;cellData.f=newDataStream,cellData.si=null,cellData.v=null,cellData.p=null}else if(function isForceString(str){return str.startsWith("'")}(newDataStream)){const v=function extractStringFromForceString(str){return str.slice(1)}(newDataStream);cellData.v=v,cellData.f=null,cellData.si=null,cellData.p=null,cellData.t=src.scd.FORCE_STRING}else if(isRichText(body))"\r\n"===body.dataStream?(cellData.v="",cellData.f=null,cellData.si=null,cellData.p=null):(cellData.p=snapshot,cellData.v=null,cellData.f=null,cellData.si=null);else{if(""===newDataStream&&null==cellData.v&&null==cellData.p)return null;cellData.v=newDataStream,cellData.f=null,cellData.si=null,cellData.p=null;const style=getCellStyleBySnapshot(snapshot);style&&(cellData.s=style)}return cellData}({...worksheet.getCellRaw(row,column)||{}},snapshot,this._lexerTreeBuilder,this._localService,this._functionService,workbook.getStyles());if(!cellData)return!0;if(this._sheetInterceptorService.onWriteCell(workbook,worksheet,row,column,cellData)===worksheet.getCellRaw(row,column))return!0;const redoUndoId=(0,src.MZQ)(6);if(this._commandService.syncExecuteCommand(sheets_src.NXV.id,{subUnitId:sheetId,unitId,range:{startRow:row,startColumn:column,endRow:row,endColumn:column},value:cellData,redoUndoId})){if(!1===await this._sheetInterceptorService.onValidateCell(workbook,worksheet,row,column))return this._undoRedoService.rollback(redoUndoId,unitId),!1}return!0}_exitInput(param){this._contextService.setContextValue(src.fXv,!1),this._contextService.setContextValue(src.AF$,!1),this._contextService.setContextValue(src.ANQ,!1),this._contextService.setContextValue(src.kgb,!1),this._cellEditorManagerService.setState({show:param.visible});const editorObject=this._getEditorObject();editorObject?.scene.getViewport(docs_view_key.hl.VIEW_MAIN)?.scrollToViewportPos({viewportScrollX:0,viewportScrollY:0});const editorUnitId=this._editorBridgeService.getCurrentEditorId();null!=editorUnitId&&this._editorService.isSheetEditor(editorUnitId)&&(this._undoRedoService.clearUndoRedo(editorUnitId),this._undoRedoService.clearUndoRedo(src.azi))}_moveSelection(keycode){if(null==keycode||!MOVE_SELECTION_KEYCODE_LIST.includes(keycode))return;let direction=src.OP3.LEFT;switch(keycode){case ui_src.DD.ENTER:direction=src.OP3.DOWN;break;case ui_src.DD.TAB:direction=src.OP3.RIGHT;break;case ui_src.DD.ARROW_DOWN:direction=src.OP3.DOWN;break;case ui_src.DD.ARROW_UP:direction=src.OP3.UP;break;case ui_src.DD.ARROW_LEFT:direction=src.OP3.LEFT;break;case ui_src.DD.ARROW_RIGHT:direction=src.OP3.RIGHT}keycode===ui_src.DD.ENTER||keycode===ui_src.DD.TAB?this._commandService.executeCommand(MoveSelectionEnterAndTabCommand.id,{keycode,direction}):this._commandService.executeCommand(MoveSelectionCommand.id,{direction})}_cursorStateListener(d){const editorObject=this._getEditorObject();if(!editorObject?.document)return;const{document:documentComponent}=editorObject;d.add((0,src.saO)(documentComponent.onPointerDown$.subscribeEvent((()=>{1===this._cursorChange&&(this._cursorChange=2)}))))}_moveInEditor(keycode,isShift){let direction=src.OP3.LEFT;keycode===ui_src.DD.ARROW_DOWN?direction=src.OP3.DOWN:keycode===ui_src.DD.ARROW_UP?direction=src.OP3.UP:keycode===ui_src.DD.ARROW_RIGHT&&(direction=src.OP3.RIGHT),isShift?this._commandService.executeCommand(MoveSelectionOperation.id,{direction}):this._commandService.executeCommand(MoveCursorOperation.id,{direction})}_getDocumentDataModel(){return this._univerInstanceService.getUnit(src.Fmw,src.Zy$.UNIVER_DOC)}_isCurrentSheetFocused(){return this._univerInstanceService.getFocusedUnit()?.getUnitId()===this._context.unitId}_getEditorSkeleton(editorId){return this._renderManagerService.getRenderById(editorId)?.with(docs_src.EX).getSkeleton()}_getEditorViewModel(editorId){return this._renderManagerService.getRenderById(editorId)?.with(docs_src.EX).getViewModel()}_emptyDocumentDataModel(documentStyle,removeStyle){const empty=(documentDataModel,resetDocumentStyle)=>{const snapshot=src.S0q.deepClone(documentDataModel.getSnapshot()),documentViewModel=this._getEditorViewModel(documentDataModel.getUnitId());null!=documentViewModel&&(!function emptyBody(body,removeStyle=!1){body.dataStream=src.Wd2,null!=body.textRuns&&(1!==body.textRuns.length||removeStyle?body.textRuns=void 0:(body.textRuns[0].st=0,body.textRuns[0].ed=1));null!=body.paragraphs&&(body.paragraphs=[{startIndex:0}]);null!=body.sectionBreaks&&(body.sectionBreaks=void 0);null!=body.tables&&(body.tables=void 0);null!=body.customRanges&&(body.customRanges=void 0);null!=body.customBlocks&&(body.customBlocks=void 0)}(snapshot.body,removeStyle),resetDocumentStyle&&(snapshot.documentStyle=documentStyle),snapshot.drawings={},snapshot.drawingsOrder=[],documentDataModel.reset(snapshot),documentViewModel.reset(documentDataModel))},documentDataModel=this._getDocumentDataModel();documentDataModel&&empty(documentDataModel,!0);const formulaDocument=this._univerInstanceService.getUnit(src.azi,src.Zy$.UNIVER_DOC);formulaDocument&&empty(formulaDocument)}}function isRichText(body){const{textRuns=[],paragraphs=[],customRanges,customBlocks=[]}=body,bodyNoLineBreak=body.dataStream.replace(/(\r\n)+$/,""),richTextStyle=["va"];return textRuns.filter((ts=>ts.st<bodyNoLineBreak.length)).some((textRun=>Boolean(textRun.ts&&Object.keys(textRun.ts).some((property=>richTextStyle.includes(property))))||Object.keys(textRun.ts??{}).length&&textRun.ed-textRun.st<bodyNoLineBreak.length))||paragraphs.some((paragraph=>paragraph.bullet))||paragraphs.length>=2||Boolean(customRanges?.length)||customBlocks.length>0}function getCellStyleBySnapshot(snapshot){const{body}=snapshot;if(!body)return null;const{textRuns=[]}=body;let style={};const bodyNoLineBreak=body.dataStream.replace("\r\n","");return textRuns.forEach((textRun=>{const{st,ed,ts}=textRun;ed-st>=bodyNoLineBreak.length&&(style={...style,...ts})})),Object.keys(style).length?style:null}EditingRenderController=function editing_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([editing_render_controller_ts_param(1,(0,src.y_5)(sheets_src.Fal)),editing_render_controller_ts_param(2,src.$Dz),editing_render_controller_ts_param(3,src.oaf),editing_render_controller_ts_param(4,engine_render_src.cSx),editing_render_controller_ts_param(5,editor_bridge_service_IEditorBridgeService),editing_render_controller_ts_param(6,ICellEditorManagerService),editing_render_controller_ts_param(7,(0,src.y_5)(engine_formula_src.GM)),editing_render_controller_ts_param(8,engine_formula_src.$C),editing_render_controller_ts_param(9,(0,src.y_5)(docs_src.pv)),editing_render_controller_ts_param(10,src.wTY),editing_render_controller_ts_param(11,(0,src.y_5)(src.iH9)),editing_render_controller_ts_param(12,editor_manager_service.I),editing_render_controller_ts_param(13,(0,src.y_5)(SheetCellEditorResizeService)),editing_render_controller_ts_param(14,src.HCr),editing_render_controller_ts_param(15,(0,src.y_5)(sheets_src.e5R)),editing_render_controller_ts_metadata("design:type",Function),editing_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===src.$Dz?Object:src.$Dz,void 0===src.oaf?Object:src.oaf,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===editor_bridge_service_IEditorBridgeService?Object:editor_bridge_service_IEditorBridgeService,void 0===ICellEditorManagerService?Object:ICellEditorManagerService,void 0===engine_formula_src.GM?Object:engine_formula_src.GM,void 0===engine_formula_src.$C?Object:engine_formula_src.$C,void 0===docs_src.pv?Object:docs_src.pv,void 0===src.wTY?Object:src.wTY,void 0===src.iH9?Object:src.iH9,void 0===editor_manager_service.I?Object:editor_manager_service.I,void 0===SheetCellEditorResizeService?Object:SheetCellEditorResizeService,void 0===src.HCr?Object:src.HCr,void 0===sheets_src.e5R?Object:sheets_src.e5R])],EditingRenderController);var internal_Observable=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/Observable.js"),operators_combineLatestWith=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/combineLatestWith.js");function mark_selection_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function mark_selection_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}const DEFAULT_Z_INDEX=SELECTION_SHAPE_DEPTH.MARK_SELECTION,IMarkSelectionService=(0,src.Qmd)("univer.mark-selection-service");class MarkSelectionService extends src.jGt{constructor(_currentService,_renderManagerService,_themeService){super(),this._currentService=_currentService,this._renderManagerService=_renderManagerService,this._themeService=_themeService,this._shapeMap=new Map}addShape(selection,exits=[],zIndex=DEFAULT_Z_INDEX){const workbook=this._currentService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),subUnitId=workbook.getActiveSheet()?.getSheetId();if(!subUnitId)return null;const id=src.S0q.generateRandomId(),markSelectionInfo={selection,subUnitId,unitId:workbook.getUnitId(),zIndex,control:null,exits};return this._shapeMap.set(id,markSelectionInfo),this.refreshShapes(),id}addShapeWithNoFresh(selection,exits=[],zIndex=DEFAULT_Z_INDEX){const workbook=this._currentService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),subUnitId=workbook.getActiveSheet()?.getSheetId();if(!subUnitId)return null;const id=src.S0q.generateRandomId();return this._shapeMap.set(id,{selection,subUnitId,unitId:workbook.getUnitId(),zIndex,control:null,exits}),id}refreshShapes(){const currentSheet=this._currentService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET);if(!currentSheet)return;const currentUnitId=currentSheet.getUnitId(),currentSubUnitId=currentSheet.getActiveSheet()?.getSheetId();this._shapeMap.forEach((shape=>{const{unitId,subUnitId,selection,control:oldControl,zIndex}=shape;if(oldControl?.dispose(),unitId!==currentUnitId||subUnitId!==currentSubUnitId)return;const renderUnit=this._renderManagerService.getRenderById(unitId);if(!renderUnit)return;const skeleton=renderUnit.with(sheet_skeleton_manager_service_SheetSkeletonManagerService).getCurrentSkeleton();if(!skeleton)return;const{scene}=renderUnit,{rowHeaderWidth,columnHeaderHeight}=skeleton,control=new SelectionControl(scene,zIndex,this._themeService,{enableAutoFill:!1,highlightHeader:!1,rowHeaderWidth,columnHeaderHeight}),selectionWithCoord=attachSelectionWithCoord(selection,skeleton);control.updateRangeBySelectionWithCoord(selectionWithCoord),shape.control=control}))}getShapeMap(){return this._shapeMap}removeShape(id){const shapeInfo=this._shapeMap.get(id);if(!shapeInfo)return;const{control}=shapeInfo;control?.dispose(),this._shapeMap.delete(id)}removeAllShapes(){for(const shape of this._shapeMap.values()){const{control}=shape;control?.dispose()}this._shapeMap.clear()}}function createCopyPasteSelectionStyle(themeService){return{strokeWidth:1.5,stroke:themeService.getCurrentTheme().primaryColor,fill:"rgba(178, 178, 178, 0.10)",widgets:{},strokeDash:8}}MarkSelectionService=function mark_selection_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([mark_selection_service_ts_param(0,src.HCr),mark_selection_service_ts_param(1,engine_render_src.cSx),mark_selection_service_ts_param(2,(0,src.y_5)(src.Fsb)),mark_selection_service_ts_metadata("design:type",Function),mark_selection_service_ts_metadata("design:paramtypes",[void 0===src.HCr?Object:src.HCr,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===src.Fsb?Object:src.Fsb])],MarkSelectionService);class CopyContentCache{set(id,clipboardData){this._cache.set(id,clipboardData)}get(id){return this._cache.get(id)}del(id){this._cache.delete(id)}clear(){this._cache.clear()}clearWithUnitId(unitId){this._cache.forEach(((value,key)=>{value.unitId===unitId&&this._cache.delete(key)}))}constructor(){this._cache=new src.GcK(10)}}new CopyContentCache;function extractNodeStyle(node,predefinedStyles){const styles=predefinedStyles??node.style,docStyles={},tagName=node.tagName.toLowerCase();switch(tagName){case"b":case"em":case"strong":docStyles.bl=src.OdA.TRUE;break;case"s":docStyles.st={s:src.OdA.TRUE};break;case"u":docStyles.ul={s:src.OdA.TRUE};break;case"i":docStyles.it=src.OdA.TRUE;break;case"sub":case"sup":docStyles.va="sup"===tagName?src.DRO.SUPERSCRIPT:src.DRO.SUBSCRIPT}return function parseStyleByProperty(styles,docStyles){if(styles instanceof CSSStyleDeclaration)for(let i=0;i<styles.length;i++){const cssRule=styles[i];handleStyle(cssRule,styles.getPropertyValue(cssRule),docStyles)}else for(const cssRule in styles){handleStyle(cssRule,styles[cssRule],docStyles)}}(styles,docStyles),docStyles}function handleStyle(cssRule,cssValue,docStyles){switch(cssRule){case"font-family":docStyles.ff=cssValue;break;case"font-size":{const fontSize=Number.parseInt(cssValue);Number.isNaN(fontSize)||(cssValue.endsWith("pt")?docStyles.fs=fontSize:cssValue.endsWith("px")&&(docStyles.fs=.75*fontSize));break}case"font-style":"italic"===cssValue&&(docStyles.it=src.OdA.TRUE);break;case"font-weight":{const MIDDLE_FONT_WEIGHT=400;(Number(cssValue)>MIDDLE_FONT_WEIGHT||"bold"===cssValue)&&(docStyles.bl=src.OdA.TRUE);break}case"text-decoration":/underline/.test(cssValue)?docStyles.ul={s:src.OdA.TRUE}:/overline/.test(cssValue)?docStyles.ol={s:src.OdA.TRUE}:/line-through/.test(cssValue)&&(docStyles.st={s:src.OdA.TRUE});break;case"color":try{const color=new src.mKL(cssValue);color.isValid&&(docStyles.cl={rgb:color.toRgbString()})}catch(_e){}break;case"background-color":{const color=new src.mKL(cssValue),bgColor=color.isValid?color.toRgbString():"";bgColor!==ui_src.Dw&&bgColor!==ui_src.IS&&(docStyles.bg={rgb:bgColor});break}}}function getParagraphStyle(el){const styles=el.style,paragraphStyle={};for(let i=0;i<styles.length;i++){const cssRule=styles[i],cssValue=styles.getPropertyValue(cssRule);switch(cssRule){case"margin-top":{const marginTopValue=Number.parseInt(cssValue);paragraphStyle.spaceAbove={v:/pt/.test(cssValue)?(0,engine_render_src.sb9)(marginTopValue):marginTopValue};break}case"margin-bottom":{const marginBottomValue=Number.parseInt(cssValue);paragraphStyle.spaceBelow={v:/pt/.test(cssValue)?(0,engine_render_src.sb9)(marginBottomValue):marginBottomValue};break}case"line-height":{const lineHeightValue=Number.parseFloat(cssValue);paragraphStyle.lineSpacing=lineHeightValue;break}}}return Object.getOwnPropertyNames(paragraphStyle).length?paragraphStyle:null}function generateParagraphs(dataStream,prevParagraph){const paragraphs=[];for(let i=0,len=dataStream.length;i<len;i++){dataStream[i]===src.gqw.PARAGRAPH&&paragraphs.push({startIndex:i})}if(prevParagraph)for(const paragraph of paragraphs)prevParagraph.bullet&&(paragraph.bullet=src.S0q.deepClone(prevParagraph.bullet)),prevParagraph.paragraphStyle&&(paragraph.paragraphStyle=src.S0q.deepClone(prevParagraph.paragraphStyle));return paragraphs}function convertToCellStyle(cell,dataStream,textRuns){const dataStreamLength=dataStream.length,canConvertToCellStyle=1===(textRuns?.length??0)&&0===textRuns[0].st&&textRuns[0].ed===dataStreamLength;return cell.p?canConvertToCellStyle&&cell.p.body?.textRuns?.length?(cell.p.body.textRuns=[],{...cell,s:textRuns[0].ts}):cell:canConvertToCellStyle?{...cell,s:textRuns[0].ts}:cell}const sheetStyleRules=["color","background","font-size","text-align","vertical-align","font-weight","font-style","font-family","text-decoration","white-space","word-wrap","border-left","border-right","border-top","border-bottom","--data-rotate"];function matchFilter(node,filter){const tagName=node.tagName.toLowerCase();return"string"==typeof filter?tagName===filter:Array.isArray(filter)?filter.some((name=>name===tagName)):filter(node)}class HtmlToUSMService{static#_=this._pluginList=[];static use(plugin){if(this._pluginList.includes(plugin))throw new Error(`Univer paste plugin ${plugin.name} already added`);this._pluginList.push(plugin)}constructor(props){this._styleMap=new Map,this._styleCache=new Map,this._styleRules=[],this._afterProcessRules=[],this._dom=null,this._getCurrentSkeleton=props.getCurrentSkeleton}convert(html){const pastePlugin=HtmlToUSMService._pluginList.find((plugin=>plugin.checkPasteType(html)));pastePlugin&&(this._styleRules=[...pastePlugin.stylesRules],this._afterProcessRules=[...pastePlugin.afterProcessRules]);const valueMatrix=new src.hDc;this._dom=function parseToDom(rawHtml){const template=document.createElement("body");return template.innerHTML=rawHtml,template}(html);const style=this._dom.querySelector("style");if(style){const shadowHost=document.createElement("div"),shadowRoot=shadowHost.attachShadow({mode:"open"});document.body.appendChild(shadowHost),shadowRoot.appendChild(style);for(const rule of style.sheet.cssRules){const cssRule=rule,selectorText=cssRule.selectorText,style=cssRule.style;this._styleMap.set(selectorText,style)}style.remove(),shadowHost.remove()}const newDocBody={dataStream:"",textRuns:[]},rowProperties=[],colProperties=[],tableStrings=html.match(/<table\b[^>]*>([\s\S]*?)<\/table>/gi);this.process(null,this._dom.childNodes,newDocBody,[]);const{paragraphs,dataStream,textRuns,payloads,customRanges}=newDocBody;if(paragraphs){const starts=paragraphs.map((p=>p.startIndex+1));starts.unshift(0);for(let i=0;i<starts.length;i++){let cellDataStream;if(i===starts.length-1){if(cellDataStream=`${dataStream.substring(starts[i])}\r\n`,"\r\n"===cellDataStream)continue}else cellDataStream=`${dataStream.substring(starts[i],starts[i+1]-1)}\r\n`;const cellTextRuns=[];textRuns?.forEach((t=>{t.st>=starts[i]&&t.ed<=starts[i+1]&&cellTextRuns.push({st:t.st-starts[i],ed:t.ed-starts[i],ts:t.ts})}));const cellCustomRanges=[];customRanges?.forEach((c=>{c.startIndex>=starts[i]&&c.endIndex<=starts[i+1]&&cellCustomRanges.push({...c,startIndex:c.startIndex-starts[i],endIndex:c.endIndex-starts[i]})}));const p=this._generateDocumentDataModelSnapshot({body:{dataStream:cellDataStream,textRuns:cellTextRuns,paragraphs:generateParagraphs(cellDataStream),customRanges:cellCustomRanges}}),isEmptyMatrix=0===Object.keys(valueMatrix.getMatrix()).length;valueMatrix.setValue(isEmptyMatrix?0:valueMatrix.getLength(),0,{v:cellDataStream,p}),rowProperties.push({})}}else if(dataStream){const singleDataStream=`${dataStream}\r\n`,singleDocBody={dataStream:singleDataStream,textRuns,paragraphs:generateParagraphs(singleDataStream),payloads,customRanges};if(customRanges?.length){const p=this._generateDocumentDataModelSnapshot({body:singleDocBody});valueMatrix.setValue(0,0,convertToCellStyle({v:dataStream,p},dataStream,textRuns))}else valueMatrix.setValue(0,0,convertToCellStyle({v:dataStream},dataStream,textRuns));rowProperties.push({})}return tableStrings&&tableStrings.forEach(((t,index)=>{const curRow=valueMatrix.getDataRange().endRow+1,{cellMatrix,rowProperties:tableRowProp,colProperties:tableColProp}=this._parseTable(t,index);cellMatrix&&cellMatrix.forValue(((row,col,value)=>{valueMatrix.setValue(curRow+row,col,value)})),tableColProp&&colProperties.push(...tableColProp),rowProperties.push(...tableRowProp)})),this.dispose(),{rowProperties,colProperties,cellMatrix:valueMatrix}}_getStyleBySelectorText(selectorText,cssText){const css=this._styleMap.get(selectorText)?.getPropertyValue(cssText);return css||""}_getStyle(node,styleStr){const recordStyle=turnToStyleObject(styleStr),style=node.style;let newStyleStr="";for(let l=0;l<sheetStyleRules.length;l++){const key=sheetStyleRules[l];if("background"===key){let value="";node.classList.forEach((className=>{value=this._getStyleBySelectorText(`.${className}`,"background-color")||this._getStyleBySelectorText(`.${className}`,key)}));const bgColor=style.getPropertyValue("background-color")||value||this._getStyleBySelectorText(`#${node.id}`,"background-color")||this._getStyleBySelectorText(`#${node.id}`,key)||this._getStyleBySelectorText(node.nodeName.toLowerCase(),key)||this._getStyleBySelectorText(node.nodeName,"background-color")||recordStyle["background-color"]||"";bgColor&&(newStyleStr+=`background:${bgColor};`);continue}if("text-decoration"===key){let value="";node.classList.forEach((className=>{value=this._getStyleBySelectorText(`.${className}`,"text-decoration-line")||this._getStyleBySelectorText(`.${className}`,key)}));const textDecoration=style.getPropertyValue("text-decoration-line")||style.getPropertyValue("text-decoration")||value||this._getStyleBySelectorText(`#${node.id}`,"text-decoration-line")||this._getStyleBySelectorText(`#${node.id}`,key)||this._getStyleBySelectorText(node.nodeName.toLowerCase(),key)||this._getStyleBySelectorText(node.nodeName,"text-decoration-line")||recordStyle["text-decoration-line"]||"";textDecoration&&(newStyleStr+=`text-decoration:${textDecoration};`);continue}let value="";node.classList.forEach((className=>{value=this._getStyleBySelectorText(`.${className}`,key)})),value=style.getPropertyValue(key)||this._getStyleBySelectorText(`#${node.id}`,key)||value||this._getStyleBySelectorText(node.nodeName.toLowerCase(),key)||recordStyle[key]||"",value&&(newStyleStr+=`${key}:${value};`)}return newStyleStr}_parseTable(html,tableElIndex){const valueMatrix=new src.hDc,colProperties=function parseColGroup(raw){const COLGROUP_TAG_REGEX=/<colgroup([\s\S]*?)>(.*?)<\/colgroup>/,colgroupMatch=raw.match(COLGROUP_TAG_REGEX),COL_TAG_REGEX=/<col([\s\S]*?)>/g;let colMatches;colMatches=colgroupMatch?.[2]?colgroupMatch[2].matchAll(COL_TAG_REGEX):raw.matchAll(COL_TAG_REGEX);if(!colMatches)return null;const colPropertiesWithSpan=Array.from(colMatches).map((colMatch=>parseProperties(colMatch[1]))),colProperties=[];return colPropertiesWithSpan.forEach((propertiesWithSpan=>{const span=Number(propertiesWithSpan.span);if(span)for(let i=0;i<span;i++){const propertiesWithoutSpan={...propertiesWithSpan};delete propertiesWithoutSpan.span,colProperties.push(propertiesWithoutSpan)}else colProperties.push(propertiesWithSpan)})),colProperties}(html)??[],{rowProperties=[]}=function parseTableRows(html){const ROWS_REGEX=/<tr([\s\S]*?)>([\s\S]*?)<\/tr>/gi,rowMatches=html.matchAll(ROWS_REGEX);if(!rowMatches)return{rowProperties:[],rowCount:0};const rowProperties=Array.from(rowMatches).map((rowMatch=>parseProperties(rowMatch[1]))).map((properties=>{if(!properties.height){const style=properties.style,match=style&&style.match(/height\s*:\s*(\d+(\.\d+)?)px/);properties.height=`${match?Number.parseInt(match[1],10):src.eqW}`}return properties}));return{rowProperties,rowCount:rowProperties.length}}(html),parsedCellMatrix=this._parseTableByHtml(this._dom,tableElIndex,this._getCurrentSkeleton()?.skeleton);return parsedCellMatrix&&parsedCellMatrix.forValue(((row,col,value)=>{let style=(0,ui_src.Os)(void 0,value.style);if(value?.richTextParma?.p?.body?.textRuns?.length){const textLen=value?.richTextParma?.v?.length;for(let i=0;i<value?.richTextParma?.p?.body?.textRuns?.length;i++){const textRunItem=value?.richTextParma?.p?.body?.textRuns[i];0===textRunItem.st&&textRunItem.ed===textLen&&(style={...textRunItem.ts,...style},value?.richTextParma?.p?.body?.textRuns.splice(i,1),i--)}0===value?.richTextParma?.p?.body?.textRuns?.length&&(value.content=value?.richTextParma?.v,delete value.richTextParma)}const cellValue=value?.richTextParma?.p?.body?.textRuns?{v:value.richTextParma.v,p:value.richTextParma.p,s:style,rowSpan:value.rowSpan,colSpan:value.colSpan}:{v:value.content,s:style,rowSpan:value.rowSpan,colSpan:value.colSpan};valueMatrix.setValue(row,col,cellValue)})),{rowProperties,colProperties,cellMatrix:valueMatrix}}_parseTableByHtml(htmlElement,tableElIndex,skeleton){const cellMatrix=new src.hDc,tableEle=htmlElement.querySelectorAll("table")[tableElIndex];if(!tableEle)return cellMatrix;const tableStyle=this._getStyle(tableEle,""),rows=tableEle?.querySelectorAll("tr");for(let rowIndex=0;rowIndex<rows.length;rowIndex++){const row=rows[rowIndex],rowStyle=this._getStyle(row,tableStyle),cells=row.querySelectorAll("td, th");let colSetValueIndex=0;for(let colIndex=0;colIndex<cells.length;){const cell=cells[colIndex];let cellStyle="";const rowSpan=Number(cell.getAttribute("rowSpan"))||1,colSpan=Number(cell.getAttribute("colSpan"))||1;if(cellStyle=this._getStyle(cell,rowStyle),rowIndex>0){const cellValueAbove=cellMatrix.getValue(rowIndex-1,colSetValueIndex);if(cellValueAbove?.style?.includes("border-bottom")&&cellStyle.includes("border-top")){const borderBottom=extractStyleProperty(cellValueAbove.style,"border-bottom");borderBottom&&"none"!==(0,ui_src._P)(borderBottom.substr(borderBottom.indexOf(":")+1))&&(cellStyle=cellStyle.replace(/border-top:[^;]+;/,""))}}if(colIndex>0){const cellValueLeft=cellMatrix.getValue(rowIndex,colSetValueIndex-1);if(cellValueLeft?.style?.includes("border-right")&&cellStyle.includes("border-left")){const borderRight=extractStyleProperty(cellValueLeft.style,"border-right");borderRight&&"none"!==(0,ui_src._P)(borderRight.substr(borderRight.indexOf(":")+1))&&(cellStyle=cellStyle.replace(/border-left:[^;]+;/,""))}}const{cellText,cellRichStyle}=this._getCellTextAndRichText(cell,cellStyle,skeleton),cellValue={rowSpan,colSpan,content:cellText,style:cellStyle,richTextParma:{p:cellRichStyle,v:cellText}};cellMatrix.getValue(rowIndex,colSetValueIndex)?colSetValueIndex+=1:(rowSpan>1||colSpan>1?setMergedCellStyle(cellMatrix,cellStyle,cellValue,{colSpan,rowSpan,rowIndex,colIndex,colSetValueIndex}):cellMatrix.setValue(rowIndex,colSetValueIndex,cellValue),colSetValueIndex+=colSpan,colIndex++)}}return cellMatrix}_parseCellHtml(parent,nodes,doc,styleCache=new Map,styleStr){for(const node of nodes)if(node.nodeType===Node.TEXT_NODE){const text=node.nodeValue?.replace(/[\r\n]/g,"");let style;parent&&styleCache.has(parent)&&(style=styleCache.get(parent)),doc.dataStream+=text,style&&Object.getOwnPropertyNames(style).length&&doc.textRuns.push({st:doc.dataStream.length-text.length,ed:doc.dataStream.length,ts:style})}else{if(node.nodeType===Node.COMMENT_NODE||"STYLE"===node.nodeName)continue;if("br"===node.nodeName.toLowerCase())doc.paragraphs||(doc.paragraphs=[]),doc.paragraphs.push({startIndex:doc.dataStream.length}),doc.dataStream+="\r";else if(node.nodeType===Node.ELEMENT_NODE){const currentNodeStyle=this._getStyle(node,styleStr),parentStyles=parent?styleCache.get(parent):{},nodeStyles=extractNodeStyle(node,turnToStyleObject(currentNodeStyle));styleCache.set(node,{...parentStyles,...nodeStyles});const{childNodes}=node;this._parseCellHtml(node,childNodes,doc,styleCache,currentNodeStyle)}}}_getCellTextAndRichText(cell,styleStr,skeleton){let cellRichStyle,cellText="";if(/<[^>]+>/.test(cell.innerHTML)&&skeleton){const newDocBody={dataStream:"",textRuns:[]};this._parseCellHtml(null,cell.childNodes,newDocBody,void 0,styleStr);const documentModel=skeleton.getBlankCellDocumentModel()?.documentModel,p=documentModel?.getSnapshot(),singleDataStream=`${newDocBody.dataStream}\r\n`,documentData={...p,body:{dataStream:singleDataStream,textRuns:newDocBody.textRuns,paragraphs:generateParagraphs(singleDataStream)}};documentModel?.reset(documentData),cellRichStyle=documentModel?.getSnapshot(),cellText=newDocBody.dataStream}else cellText=function decodeHTMLEntities(input){const entities={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&#39;":"'","&nbsp;":" "};return input.replace(/&lt;|&gt;|&amp;|&quot;|&#39;|&nbsp;|<br>/g,(match=>entities[match]))}(cell.innerHTML.replace(/[\r\n]/g,""));return{cellText,cellRichStyle}}_generateDocumentDataModelSnapshot(snapshot){const currentSkeleton=this._getCurrentSkeleton();if(null==currentSkeleton)return null;const{skeleton}=currentSkeleton,documentModel=skeleton.getBlankCellDocumentModel()?.documentModel,p=documentModel?.getSnapshot(),documentData={...p,...snapshot};return documentModel?.reset(documentData),documentModel?.getSnapshot()}process(parent,nodes,doc,tables){for(const node of nodes)if("table"===node.nodeName.toLowerCase())tables.push({index:doc?.paragraphs?.length||0});else if(node.nodeType===Node.TEXT_NODE){if(""===node.nodeValue?.trim())continue;const text=node.nodeValue?.replace(/[\r\n]/g,"");let style;parent&&this._styleCache.has(parent)&&(style=this._styleCache.get(parent));const newDoc={dataStream:"",textRuns:[]};doc.dataStream+=text,newDoc.dataStream+=text,style&&Object.getOwnPropertyNames(style).length&&(doc.textRuns.push({st:doc.dataStream.length-text.length,ed:doc.dataStream.length,ts:style}),newDoc.textRuns.push({st:doc.dataStream.length-text.length,ed:doc.dataStream.length,ts:style}))}else{if(src.HBg.includes(node.nodeName.toLowerCase()))continue;if("br"===node.nodeName.toLowerCase())doc.paragraphs||(doc.paragraphs=[]),doc.paragraphs.push({startIndex:doc.dataStream.length}),doc.dataStream+="\r";else if(node.nodeType===Node.ELEMENT_NODE){if("STYLE"===node.nodeName)continue;const element=node,linkStart=this._processBeforeLink(element,{body:doc}),parentStyles=parent?this._styleCache.get(parent):{},styleRule=this._styleRules.find((({filter})=>matchFilter(node,filter))),nodeStyles=styleRule?styleRule.getStyle(node):extractNodeStyle(node);this._styleCache.set(node,{...parentStyles,...nodeStyles});const{childNodes}=node;this.process(node,childNodes,doc,tables);const afterProcessRule=this._afterProcessRules.find((({filter})=>matchFilter(node,filter)));afterProcessRule&&afterProcessRule.handler(doc,node),this._processAfterLink(element,{body:doc},linkStart)}}}_processBeforeLink(node,doc){return doc.body.dataStream.length}_processAfterLink(node,doc,start){const body=doc.body,element=node;"A"===element.tagName.toUpperCase()&&(body.customRanges=body.customRanges??[],body.customRanges.push({startIndex:start,endIndex:body.dataStream.length-1,rangeId:element.dataset.rangeid??(0,src.MZQ)(),rangeType:src.Bvh.HYPERLINK,properties:{url:element.href}}))}dispose(){this._dom=null,this._styleCache.clear(),this._styleMap.clear()}}function turnToStyleObject(styleStr){const styleObj={};return styleStr.split(";").forEach((style=>{const[key,value]=style.split(":");styleObj[key]=value})),styleObj}function parseProperties(propertyStr){if(!propertyStr)return{};const property={},PROPERTY_REGEX=/([\w-]+)\s*=\s*(?:(['"])([^'"]*)\2|(\S+))/g;let match;for(;null!==(match=PROPERTY_REGEX.exec(propertyStr));){const[,attributeName,,attributeValue1,attributeValue2]=match,attributeValue=void 0!==attributeValue1?attributeValue1:attributeValue2;property[attributeName]=attributeValue}return property}function extractStyleProperty(styleString,propertyName){if(!styleString||!propertyName)return null;const regex=new RegExp(`(${propertyName}\\s*:\\s*[^;]+);`,"i"),match=styleString.match(regex);return match?match[1]:null}function setMergedCellStyle(cellMatrix,cellStyle,cellValue,indexParams){const{rowSpan,colSpan,rowIndex,colSetValueIndex}=indexParams;for(let i=rowIndex;i<rowIndex+rowSpan;i++)for(let j=colSetValueIndex;j<colSetValueIndex+colSpan;j++)i===rowIndex&&j===colSetValueIndex?cellMatrix.setValue(i,j,{...cellValue,style:cellStyle}):cellMatrix.setValue(i,j,{style:cellStyle})}const LarkPastePlugin={name:"univer-doc-paste-plugin-lark",checkPasteType:html=>/lark-record-clipboard/i.test(html),stylesRules:[{filter:["s"],getStyle(node){const inlineStyle=extractNodeStyle(node);return{st:{s:src.OdA.TRUE},...inlineStyle}}}],afterProcessRules:[{filter:el=>"DIV"===el.tagName&&/ace-line/i.test(el.className),handler(doc){null==doc.paragraphs&&(doc.paragraphs=[]),doc.paragraphs.push({startIndex:doc.dataStream.length}),doc.dataStream+="\r"}}]},UniverPastePlugin={name:"univer-doc-paste-plugin-univer",checkPasteType:html=>/UniverNormal/i.test(html),stylesRules:[],afterProcessRules:[{filter:el=>"P"===el.tagName&&/UniverNormal/i.test(el.className),handler(doc,el){null==doc.paragraphs&&(doc.paragraphs=[]);const paragraph={startIndex:doc.dataStream.length},paragraphStyle=getParagraphStyle(el);paragraphStyle&&(paragraph.paragraphStyle=paragraphStyle),doc.paragraphs.push(paragraph),doc.dataStream+="\r"}}]},WordPastePlugin={name:"univer-doc-paste-plugin-word",checkPasteType:html=>/word|mso/i.test(html),stylesRules:[{filter:["b"],getStyle(node){const inlineStyle=extractNodeStyle(node);return{bl:src.OdA.TRUE,...inlineStyle}}}],afterProcessRules:[{filter:el=>"P"===el.tagName&&/mso/i.test(el.className),handler(doc,el){null==doc.paragraphs&&(doc.paragraphs=[]);const paragraph={startIndex:doc.dataStream.length},paragraphStyle=getParagraphStyle(el);paragraphStyle&&(paragraph.paragraphStyle=paragraphStyle),doc.paragraphs.push(paragraph),doc.dataStream+="\r"}}]};var COPY_TYPE=function(COPY_TYPE){return COPY_TYPE.COPY="COPY",COPY_TYPE.CUT="CUT",COPY_TYPE}({});function getRowContent(row,cols,hooks,matrix,mergeSet){const str=zipClipboardPropertyItemToString(mergeProperties(hooks.map((hook=>hook.onCopyRow?.(row))).filter((v=>!!v)))),tds=cols.map((col=>{if(!mergeSet.has(`${row}-${col}`)){const v=matrix.getValue(row,col);if(v?.rowSpan&&v?.colSpan)for(let i=row;i<row+v.rowSpan;i++)for(let j=col;j<col+v.colSpan;j++)mergeSet.add(`${i}-${j}`);return function getTDContent(row,col,hooks,matrix){const v=matrix.getValue(row,col),properties=hooks.map((hook=>hook.onCopyCellStyle?.(row,col,v?.rowSpan,v?.colSpan))).filter((v=>!!v)),mergedProperties=mergeProperties(properties),str=zipClipboardPropertyItemToString(mergedProperties),content=hooks.reduce(((acc,hook)=>acc||hook.onCopyCellContent?.(row,col)||""),"");return`<td${str}>${content}</td>`}(row,col,hooks,matrix)}return null})).filter((v=>!!v)).join("");return`<tr${str}>${tds}</tr>`}function mergeProperties(properties){return properties.reduce(((acc,cur)=>(Object.keys(cur).forEach((key=>{acc[key]?acc[key]+=`;${cur[key]}`:acc[key]=cur[key]})),acc)),{})}function zipClipboardPropertyItemToString(item){return Object.keys(item).reduce(((acc,cur)=>`${acc} ${cur}="${item[cur]}"`),"")}class USMToHtmlService{convert(matrix,range,hooks){const{cols,rows}=range;if(!cols.length)return"";const colStyles=function getColStyle(cols,hooks){return`<colgroup>${cols.map((col=>`<col ${zipClipboardPropertyItemToString(mergeProperties(hooks.map((hook=>hook.onCopyColumn?.(col))).filter((v=>!!v))))} />`)).join("")}</colgroup>`}(cols,hooks),rowContents=[],mergeSet=new Set;rows.forEach((row=>{rowContents.push(getRowContent(row,cols,hooks,matrix,mergeSet))}));return`<google-sheets-html-origin><table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" cellpadding="0" dir="ltr" style="table-layout:fixed;font-size:10pt;font-family:Arial;width:0px;border-collapse:collapse;border:none">${colStyles}\n<tbody>${rowContents.join("")}</tbody></table>`}}function htmlIsFromExcel(html){if(!html)return!1;return[/<td[^>]*class=".*?xl.*?"[^>]*>/i,/xmlns:x="urn:schemas-microsoft-com:office:excel"/i,/ProgId="Excel.Sheet"/i,/xmlns:o="urn:schemas-microsoft-com:office:office"/i,/@mso-|mso-excel/i,/<x:ExcelWorkbook>/i].some((marker=>marker.test(html)))}function mergeCellValues(...cellValues){if(1===cellValues.length)return cellValues[0];const newMatrix=new src.hDc;return cellValues.forEach((cellValue=>{if(cellValue){new src.hDc(cellValue).forValue(((row,col,value)=>{newMatrix.setValue(row,col,{...newMatrix.getValue(row,col),...value})}))}})),newMatrix.getMatrix()}function mergeSetRangeValues(mutations){const newMutations=[];for(let i=0;i<mutations.length;){let cursor=1;if(mutations[i].id===sheets_src.N48.id){const current=mutations[i],toMerge=[current];for(;i+cursor<mutations.length&&(m1=current,m2=mutations[i+cursor],m1.id===m2.id&&m1.params.unitId===m2.params.unitId&&m1.params.subUnitId===m2.params.subUnitId);)toMerge.push(mutations[i+cursor]),cursor+=1;const merged=mergeCellValues(...toMerge.map((m=>m.params.cellValue||{})));newMutations.push({...current,params:{...current.params,cellValue:merged}})}else newMutations.push(mutations[i]);i+=cursor}var m1,m2;return newMutations}function rangeIntersectWithDiscreteRange(range,discrete){const{startRow,endRow,startColumn,endColumn}=range;for(let i=startRow;i<=endRow;i++)for(let j=startColumn;j<=endColumn;j++)if(discrete.rows.includes(i)&&discrete.cols.includes(j))return!0}function discreteRangeContainsRange(discrete,range){const{startRow,endRow,startColumn,endColumn}=range;for(let i=startRow;i<=endRow;i++)if(!discrete.rows.includes(i))return!1;for(let j=startColumn;j<=endColumn;j++)if(!discrete.cols.includes(j))return!1;return!0}function clipboard_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function clipboard_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}const PREDEFINED_HOOK_NAME={DEFAULT_COPY:"default-copy",DEFAULT_PASTE:"default-paste",SPECIAL_PASTE_VALUE:"special-paste-value",SPECIAL_PASTE_FORMAT:"special-paste-format",SPECIAL_PASTE_COL_WIDTH:"special-paste-col-width",SPECIAL_PASTE_BESIDES_BORDER:"special-paste-besides-border",SPECIAL_PASTE_FORMULA:"special-paste-formula"},IMAGE_MIME_TO_EXTENSION={[ui_src.Kk]:"png",[ui_src.kR]:"jpg",[ui_src.C4]:"webp",[ui_src.x$]:"bmp"};HtmlToUSMService.use(WordPastePlugin),HtmlToUSMService.use(LarkPastePlugin),HtmlToUSMService.use(UniverPastePlugin);const ISheetClipboardService=(0,src.Qmd)("sheet.clipboard-service");class SheetClipboardService extends src.jGt{constructor(_logService,_univerInstanceService,_selectionManagerService,_clipboardInterfaceService,_undoRedoService,_commandService,_markSelectionService,_notificationService,_platformService,_renderManagerService,_themeService,_localeService,_errorService,_injector){super(),this._logService=_logService,this._univerInstanceService=_univerInstanceService,this._selectionManagerService=_selectionManagerService,this._clipboardInterfaceService=_clipboardInterfaceService,this._undoRedoService=_undoRedoService,this._commandService=_commandService,this._markSelectionService=_markSelectionService,this._notificationService=_notificationService,this._platformService=_platformService,this._renderManagerService=_renderManagerService,this._themeService=_themeService,this._localeService=_localeService,this._errorService=_errorService,this._injector=_injector,this._clipboardHooks=[],this._clipboardHooks$=new BehaviorSubject.t([]),this.clipboardHooks$=this._clipboardHooks$.asObservable(),this._copyMarkId=null,this._pasteOptionsCache$=new BehaviorSubject.t(null),this.pasteOptionsCache$=this._pasteOptionsCache$.asObservable(),this._showMenu$=new BehaviorSubject.t(!1),this.showMenu$=this._showMenu$.asObservable(),this._htmlToUSM=new HtmlToUSMService({getCurrentSkeleton:()=>(0,engine_render_src.KMz)(src.Zy$.UNIVER_SHEET,sheet_skeleton_manager_service_SheetSkeletonManagerService,this._univerInstanceService,this._renderManagerService)?.getCurrentParam()}),this._usmToHtml=new USMToHtmlService,this._copyContentCache=new CopyContentCache,this.disposeWithMe(this._htmlToUSM),this._initUnitDisposed()}setShowMenu(show){this._showMenu$.next(show)}getPasteMenuVisible(){return this._showMenu$.getValue()}getPasteOptionsCache(){return this._pasteOptionsCache$.getValue()}copyContentCache(){return this._copyContentCache}generateCopyContent(workbookId,worksheetId,range,copyType=COPY_TYPE.COPY){const hooks=this._clipboardHooks;hooks.forEach((h=>h.onBeforeCopy?.(workbookId,worksheetId,range,copyType)));const copyContent=this._generateCopyContent(workbookId,worksheetId,range,this._clipboardHooks);return hooks.forEach((h=>h.onAfterCopy?.())),copyContent}async copy(copyType=COPY_TYPE.COPY){const selection=this._selectionManagerService.getCurrentLastSelection();if(!selection)return!1;const workbook=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook.getActiveSheet();if(!worksheet)return!1;const workbookId=workbook.getUnitId(),worksheetId=worksheet.getSheetId(),copyContent=this.generateCopyContent(workbookId,worksheetId,selection.range);if(!copyContent)return!1;const{html,plain,matrixFragment,copyId,discreteRange}=copyContent;this._copyContentCache.set(copyId,{unitId:workbook.getUnitId(),subUnitId:worksheet.getSheetId(),range:discreteRange,matrix:matrixFragment,copyType}),await this._clipboardInterfaceService.write(plain,html),this._markSelectionService.removeAllShapes();const style=createCopyPasteSelectionStyle(this._themeService);return this._copyMarkId=this._markSelectionService.addShape({...selection,style}),!0}async cut(){return this.copy(COPY_TYPE.CUT)}async paste(item,pasteType=PREDEFINED_HOOK_NAME.DEFAULT_PASTE){const types=item.types,text=-1!==types.indexOf(ui_src.OE)?await item.getType(ui_src.OE).then((blob=>blob&&blob.text())):"",html=-1!==types.indexOf(ui_src.lZ)?await item.getType(ui_src.lZ).then((blob=>blob&&blob.text())):"",imageIndex=types.findIndex((type=>ui_src._F.has(type))),shouldUseHTMLPaste=-1===imageIndex||!function htmlContainsImage(html){return!!html&&(html.match(/<img[^>]*src\s*=\s*["']data:image\/[^;]+;base64,[^"']*["'][^>]*>/i)||[]).length>0}(html);if(html&&shouldUseHTMLPaste)return this._platformService.isWindows&&htmlIsFromExcel(html)&&this._notificationService.show({type:"warning",title:this._localeService.t("clipboard.shortCutNotify.title"),content:this._localeService.t("clipboard.shortCutNotify.useShortCutInstead")}),this._pasteHTML(html,pasteType);if(-1!==imageIndex){const imageMimeType=types[imageIndex],imageBlob=await item.getType(imageMimeType);if(imageBlob){const file=new File([imageBlob],`clipboard-image.${IMAGE_MIME_TO_EXTENSION[imageMimeType]}`,{type:imageMimeType});return this._pasteFiles([file],pasteType)}}return text?this._pastePlainText(text,pasteType):(this._logService.error("[SheetClipboardService]","No valid data on clipboard"),!1)}async legacyPaste(html,text,files){const isFromExcel=htmlIsFromExcel(html??"");return files&&!isFromExcel?this._pasteFiles(files,PREDEFINED_HOOK_NAME.DEFAULT_PASTE):html?this._pasteHTML(html,PREDEFINED_HOOK_NAME.DEFAULT_PASTE):text?/[\n\t]/.test(text)?this._pasteHTML(function convertTextToTable(text){const rows=text.trim().split("\n");let html="<table>";return rows.forEach((row=>{const columns=row.split("\t");html+="<tr>",columns.forEach((column=>{html+=`<td>${column}</td>`})),html+="</tr>"})),html+="</table>",html}(text),PREDEFINED_HOOK_NAME.DEFAULT_PASTE):this._pastePlainText(text,PREDEFINED_HOOK_NAME.DEFAULT_PASTE):this._pasteUnrecognized()}rePasteWithPasteType(type){const pasteOptionsCache=this._pasteOptionsCache$.getValue();if(!pasteOptionsCache)return!1;const undoRedoService=this._injector.get(src.$Dz),element=undoRedoService.pitchTopUndoElement();if(element){(0,src.PkI)(element.undoMutations,this._commandService)&&undoRedoService.popUndoToRedo()}const{cellMatrix,rowProperties=[],colProperties=[],source,target}=pasteOptionsCache;return this._pasteUSM({cellMatrix,colProperties,rowProperties},target,PREDEFINED_HOOK_NAME[type],source),!0}updatePasteOptionsCache(cache){this._pasteOptionsCache$.next(cache)}addClipboardHook(hook){if(-1!==this._clipboardHooks.findIndex((h=>h.id===hook.id)))return this._logService.error("[SheetClipboardService]","hook already exists",hook.id),{dispose:()=>{}};const insertIndex=this._clipboardHooks.findIndex((existingHook=>{const existingHookPriority=existingHook.priority||0;return(hook.priority||0)<existingHookPriority}));return this._clipboardHooks.splice(-1!==insertIndex?insertIndex:this._clipboardHooks.length,0,hook),this._notifyClipboardHook(),(0,src.saO)((()=>{const index=this._clipboardHooks.indexOf(hook);index>-1&&(this._clipboardHooks.splice(index,1),this._notifyClipboardHook())}))}getClipboardHooks(){return this._clipboardHooks}_generateCopyContent(unitId,subUnitId,range,hooks){const workbook=this._univerInstanceService.getUniverSheetInstance(unitId),worksheet=workbook?.getSheetBySheetId(subUnitId);if(!workbook||!worksheet)return null;const filteredRows=hooks.reduce(((acc,cur)=>{const rows=cur.getFilteredOutRows?.(range);return rows?.forEach((r=>acc.add(r))),acc}),new Set),{startColumn,startRow,endColumn,endRow}=range,matrix=worksheet.getMatrixWithMergedCells(startRow,startColumn,endRow,endColumn,src.v2V.Both),matrixFragment=new src.hDc;let rowIndex=startRow;const plainMatrix=new src.hDc,discreteRange={rows:[],cols:[]};for(let r=startRow;r<=endRow;r++)if(!filteredRows.has(r)){discreteRange.rows.push(r);for(let c=startColumn;c<=endColumn;c++){const cellData=matrix.getValue(r,c);if(cellData){const newCellData=src.S0q.deepClone(cellData);plainMatrix.setValue(rowIndex-startRow,c-startColumn,{p:null,v:null,s:null,f:null,si:null,t:null,...newCellData}),delete newCellData.displayV,matrixFragment.setValue(rowIndex-startRow,c-startColumn,{p:null,v:null,s:null,f:null,si:null,t:null,...newCellData})}else plainMatrix.setValue(rowIndex-startRow,c-startColumn,{p:null,v:null,s:null,f:null,si:null,t:null}),matrixFragment.setValue(rowIndex-startRow,c-startColumn,{p:null,v:null,s:null,f:null,si:null,t:null}),matrix.setValue(r,c,{p:null,v:null,s:null,f:null,si:null,t:null})}rowIndex+=1}for(let c=startColumn;c<=endColumn;c++)discreteRange.cols.push(c);let html=this._usmToHtml.convert(matrix,discreteRange,hooks);const plain=function getMatrixPlainText(matrix){let plain="";const matrixLength=matrix.getLength();return matrix.forRow(((row,cols)=>{const arr=[];cols.forEach((col=>{const cell=matrix.getValue(row,col);if(cell){const cellText=function getCellTextForClipboard(cell){if((0,src.Gh7)(cell.displayV))return cell.displayV;return(0,src.zo$)(cell)}(cell);arr.push(cellText)}})),plain+=arr.join("\t"),row!==matrixLength-1&&(plain+="\n")})),plain}(plainMatrix),copyId=function genId(){return src.S0q.generateRandomId(6)}();return html=html.replace(/(<[a-z]+)/,((_p0,p1)=>`${p1} data-copy-id="${copyId}"`)),{copyId,plain,html,matrixFragment,discreteRange}}_notifyClipboardHook(){this._clipboardHooks$.next(this._clipboardHooks)}async _executePaste(generateMutations){const target=this._getPastingTarget();if(!target.subUnitId||!target.selection)return!1;const range=this._injector.invoke((accessor=>(0,sheets_src.tQu)(target.selection.range,accessor,target.unitId,target.subUnitId)));if(!range)return!1;const{unitId,subUnitId}=target,hooks=this._clipboardHooks,enabledHooks=[];if(hooks.some((h=>enabledHooks.push(h)&&!1===h.onBeforePaste?.({unitId,subUnitId,range}))))return enabledHooks.forEach((h=>h.onAfterPaste?.(!1))),!1;const redoMutationsInfo=[],undoMutationsInfo=[];enabledHooks.forEach((h=>{const contentReturn=generateMutations(h,{unitId,subUnitId,range});contentReturn&&(redoMutationsInfo.push(...contentReturn.redos),undoMutationsInfo.push(...contentReturn.undos))}));const result=redoMutationsInfo.every((m=>this._commandService.executeCommand(m.id,m.params)));return result&&this._undoRedoService.pushUndoRedo({unitID:this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET).getUnitId(),undoMutations:undoMutationsInfo,redoMutations:redoMutationsInfo}),result}async _pasteFiles(files,pasteType){return this._executePaste(((h,payload)=>h.onPasteFiles?.(payload,files,{pasteType})))}async _pastePlainText(text,pasteType){return this._executePaste(((h,payload)=>h.onPastePlainText?.(payload,text,{pasteType})))}_pasteUnrecognized(){return this._executePaste(((h,payload)=>h.onPasteUnrecognized?.(payload)))}async _pasteHTML(html,pasteType){const copyId=function extractId(html){const match=html.match(/data-copy-id="([^\s]+)"/);return match&&match[1]?match[1]:null}(html);return copyId&&this._copyContentCache.get(copyId)?this._pasteInternal(copyId,pasteType):this._pasteExternal(html,pasteType)}async _pasteExternal(html,pasteType){const{rowProperties,colProperties,cellMatrix}=this._htmlToUSM.convert(html);if(!cellMatrix)return!1;const pasteTarget=this._getPastedRange(cellMatrix);if(!pasteTarget)return!1;const worksheet=this._univerInstanceService.getUniverSheetInstance(pasteTarget.unitId)?.getSheetBySheetId(pasteTarget.subUnitId);if(!worksheet)return!1;const mergeData=worksheet?.getMergeData();if(mergeData.length){if(mergeData.some((m=>rangeIntersectWithDiscreteRange(m,pasteTarget.pastedRange)&&!discreteRangeContainsRange(pasteTarget.pastedRange,m))))return this._errorService.emit(this._localeService.t("clipboard.paste.overlappingMergedCells")),!1}return this._pasteUSM({rowProperties,colProperties,cellMatrix},pasteTarget,pasteType)}async _pasteInternal(copyId,pasteType){const cachedData=src.S0q.deepClone(this._copyContentCache.get(copyId)),{range,matrix:cellMatrix,unitId:copyUnitId,subUnitId:copySubUnitId}=cachedData||{};if(!(cellMatrix&&cachedData&&range&&copyUnitId&&copySubUnitId))return!1;if(!cellMatrix||!cachedData)return!1;const styles=this._univerInstanceService.getUniverSheetInstance(copyUnitId)?.getStyles();cellMatrix.forValue(((row,col,value)=>{if("string"==typeof value.s){const newValue=src.S0q.deepClone(value);newValue.s=styles?.getStyleByCell(value),cellMatrix.setValue(row,col,newValue)}if(value.colSpan||value.rowSpan)for(let rStart=0;rStart<value.rowSpan;rStart++)for(let cStart=0;cStart<value.colSpan;cStart++){if(0===rStart&&0===cStart)continue;const r=row+rStart,c=col+cStart;cellMatrix.setValue(r,c,{s:styles?.getStyleByCell(value)})}}));const pasteTarget=this._getPastedRange(cellMatrix);if(!pasteTarget)return!1;const pasteToWorksheet=this._univerInstanceService.getUniverSheetInstance(pasteTarget.unitId)?.getSheetBySheetId(pasteTarget.subUnitId);if(!pasteToWorksheet)return!1;const mergeData=pasteToWorksheet?.getMergeData();if(mergeData){if(mergeData.some((m=>rangeIntersectWithDiscreteRange(m,pasteTarget.pastedRange)&&!discreteRangeContainsRange(pasteTarget.pastedRange,m))))return this._errorService.emit(this._localeService.t("clipboard.paste.overlappingMergedCells")),!1}const pasteFromWorkbook=this._univerInstanceService.getUnit(copyUnitId);if(!pasteFromWorkbook)return!1;const pasteFromWorksheet=pasteFromWorkbook.getSheetBySheetId(copySubUnitId);if(!pasteFromWorksheet)return!1;const colManager=pasteFromWorksheet.getColumnManager(),rowManager=pasteFromWorksheet.getRowManager(),defaultColumnWidth=pasteFromWorksheet.getConfig().defaultColumnWidth,defaultRowHeight=pasteFromWorksheet.getConfig().defaultRowHeight,colProperties=[],rowProperties=[];if(range.cols.forEach((i=>{const column=colManager.getColumnOrCreate(i);colProperties.push({width:`${column.w||defaultColumnWidth}`})})),range.rows.forEach((j=>{const row=rowManager.getRowOrCreate(j),{ah=defaultRowHeight,h=defaultRowHeight}=row,height=Math.max(ah,h);rowProperties.push({height:`${height}`})})),cachedData.copyType===COPY_TYPE.CUT){const start=pasteTarget.pastedRange.rows[0],end=range.rows[range.rows.length-1]-range.rows[0]+start;pasteTarget.pastedRange.rows=Array.from(new Array(end+1).keys()).slice(start)}const pasteRes=this._pasteUSM({cellMatrix,colProperties,rowProperties},pasteTarget,pasteType,{range,unitId:cachedData.unitId,subUnitId:cachedData.subUnitId,copyType:cachedData.copyType,copyId});return cachedData.copyType===COPY_TYPE.CUT&&(this._copyContentCache.set(copyId,{...cachedData,matrix:null}),this._copyMarkId&&this._markSelectionService.removeShape(this._copyMarkId),this._copyMarkId=null),pasteRes}_pasteUSM(data,target,pasteType,source){const{rowProperties,colProperties,cellMatrix}=data,{unitId,subUnitId,pastedRange}=target,colCount=pastedRange.cols.length,hooks=this._clipboardHooks,enabledHooks=[];if(hooks.some((h=>enabledHooks.push(h)&&!1===h.onBeforePaste?.({unitId,subUnitId,range:pastedRange}))))return enabledHooks.forEach((h=>h.onAfterPaste?.(!1))),!1;if(!cellMatrix)return!1;const pasteFrom=source?{unitId:source.unitId,subUnitId:source.subUnitId,range:source.range}:null,payload={copyType:source?.copyType||COPY_TYPE.COPY,copyId:source?.copyId,pasteType};let redoMutationsInfo=[],undoMutationsInfo=[];const filteredHooks=enabledHooks.filter((h=>!h.specialPasteInfo&&h.id!==PREDEFINED_HOOK_NAME.DEFAULT_PASTE||pasteType===h.id));filteredHooks.forEach((h=>{if(rowProperties){const rowReturn=h.onPasteRows?.({range:pastedRange,unitId,subUnitId},rowProperties,{pasteType});rowReturn&&(redoMutationsInfo.push(...rowReturn.redos),undoMutationsInfo.push(...rowReturn.undos))}const colReturn=h.onPasteColumns?.({range:pastedRange,unitId,subUnitId},colProperties||new Array(colCount).map((()=>({}))),{pasteType});colReturn&&(redoMutationsInfo.push(...colReturn.redos),undoMutationsInfo.push(...colReturn.undos));const contentReturn=h.onPasteCells?.(pasteFrom,{range:pastedRange,unitId,subUnitId},cellMatrix,payload);contentReturn&&(redoMutationsInfo.push(...contentReturn.redos),undoMutationsInfo.push(...contentReturn.undos))}));const setSelectionOperation=this._getSetSelectionOperation(unitId,subUnitId,pastedRange,cellMatrix,pasteType);setSelectionOperation&&redoMutationsInfo.push(setSelectionOperation),redoMutationsInfo=mergeSetRangeValues(redoMutationsInfo),undoMutationsInfo=mergeSetRangeValues(undoMutationsInfo),undoMutationsInfo.push({id:sheets_src._M5.id,params:{unitId:target.unitId,subUnitId:target.subUnitId}}),this._logService.log("[SheetClipboardService]","pasting mutations",{undoMutationsInfo,redoMutationsInfo});const result=redoMutationsInfo.every((m=>this._commandService.syncExecuteCommand(m.id,m.params)));return result&&(this._undoRedoService.pushUndoRedo({unitID:unitId,undoMutations:undoMutationsInfo,redoMutations:redoMutationsInfo}),this.updatePasteOptionsCache({target:{pastedRange,unitId,subUnitId},cellMatrix,rowProperties,colProperties,pasteType,source}),this.setShowMenu(!0)),filteredHooks.forEach((h=>h.onAfterPaste?.(result))),result}_getSetSelectionOperation(unitId,subUnitId,range,cellMatrix,pasteType){const worksheet=this._univerInstanceService.getUniverSheetInstance(unitId)?.getSheetBySheetId(subUnitId);if(!worksheet)return null;const{rows,cols}=range,startRow=rows[0],startColumn=cols[0],endRow=rows[rows.length-1],endColumn=cols[cols.length-1],primaryCell={startRow,endRow:startRow,startColumn,endColumn:startColumn},primary=(0,sheets_src.fCg)(primaryCell,worksheet),mainCell=cellMatrix.getValue(0,0),rowSpan=mainCell?.rowSpan||1,colSpan=mainCell?.colSpan||1;if((pasteType===PREDEFINED_HOOK_NAME.DEFAULT_PASTE||pasteType===PREDEFINED_HOOK_NAME.SPECIAL_PASTE_BESIDES_BORDER||pasteType===PREDEFINED_HOOK_NAME.SPECIAL_PASTE_FORMAT)&&(rowSpan>1||colSpan>1)){const mergeRange={startRow,endRow:startRow+rowSpan-1,startColumn,endColumn:startColumn+colSpan-1};primary.startRow=mergeRange.startRow,primary.endRow=mergeRange.endRow,primary.startColumn=mergeRange.startColumn,primary.endColumn=mergeRange.endColumn,primary.isMerged=!0,primary.isMergedMainCell=!0}const setSelectionsParam={unitId,subUnitId,selections:[{range:{startRow,endRow,startColumn,endColumn},primary,style:null}]};return{id:sheets_src.NSB.id,params:setSelectionsParam}}_getPastingTarget(){const workbook=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook.getActiveSheet(),selection=this._selectionManagerService.getCurrentLastSelection();return{unitId:workbook.getUnitId(),subUnitId:worksheet?.getSheetId(),selection}}_transformPastedData(rowCount,colCount,cellMatrix){const target=this._getPastingTarget(),{selection,unitId,subUnitId}=target;if(!subUnitId||!selection)return null;const discreteRange=this._injector.invoke((accessor=>(0,sheets_src.tQu)(selection.range,accessor,unitId,subUnitId)));if(!discreteRange)return null;const{ranges:[vRange],mapFunc}=virtualizeDiscreteRanges([discreteRange]),{startRow,startColumn,endRow,endColumn}=vRange,destinationRows=endRow-startRow+1,destinationColumns=endColumn-startColumn+1,workbook=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook?.getActiveSheet();if(!worksheet)return null;const mergedCellsInRange=worksheet.getMergeData().filter((rect=>discreteRange.rows.includes(rect.startRow)&&discreteRange.cols.includes(rect.startColumn))),mergedRange=mergedCellsInRange[0];let mergedRangeStartRow=0,mergedRangeStartColumn=0,mergedRangeEndRow=0,mergedRangeEndColumn=0;if(mergedRange&&(mergedRangeStartRow=mergedRange.startRow,mergedRangeStartColumn=mergedRange.startColumn,mergedRangeEndRow=mergedRange.endRow,mergedRangeEndColumn=mergedRange.endColumn),destinationRows%rowCount==0&&destinationColumns%colCount==0)if(mergedCellsInRange.length>0&&(destinationRows!==rowCount||destinationColumns!==colCount))if(mergedRangeStartRow===discreteRange.rows[0]&&mergedRangeStartColumn===discreteRange.cols[0]&&mergedRangeEndRow===discreteRange.rows[destinationRows-1]&&mergedRangeEndColumn===discreteRange.cols[destinationColumns-1]){const isMultiple=function isMultipleCells(cellMatrix){let count=0;return cellMatrix.forValue(((row,col,cell)=>{if(cell&&count++,count>1)return!1})),count>1}(cellMatrix);if(isMultiple)for(let r=0;r<destinationRows;r++)for(let c=0;c<destinationColumns;c++){const cell=cellMatrix.getValue(r%rowCount,c%colCount);cell&&cellMatrix.setValue(r,c,cell)}else cellMatrix.forValue(((row,col,cell)=>{cell.s=null,delete cell.colSpan,delete cell.rowSpan}))}else for(let r=0;r<destinationRows;r++)for(let c=0;c<destinationColumns;c++){const cell=cellMatrix.getValue(r%rowCount,c%colCount);cell&&cellMatrix.setValue(r,c,cell)}else for(let r=0;r<destinationRows;r++)for(let c=0;c<destinationColumns;c++){const cell=cellMatrix.getValue(r%rowCount,c%colCount);cell&&cellMatrix.setValue(r,c,cell)}else if(mergedCellsInRange.length>0){const{row:topRow,col:leftCol}=mapFunc(startRow,startColumn);if(this._topLeftCellsMatch(rowCount,colCount,{topRow,leftCol})){const newDiscreteRange=this._expandOrShrinkRowsCols(unitId,subUnitId,discreteRange,colCount,rowCount);discreteRange.rows=newDiscreteRange.rows,discreteRange.cols=newDiscreteRange.cols}else{if(endRow>mergedRange.endRow||endColumn>mergedRange.endColumn)return null;cellMatrix.forValue(((row,col,cell)=>{cell.s=null,delete cell.colSpan,delete cell.rowSpan}))}}else{const newDiscreteRange=this._expandOrShrinkRowsCols(unitId,subUnitId,discreteRange,colCount,rowCount);discreteRange.rows=newDiscreteRange.rows,discreteRange.cols=newDiscreteRange.cols}return{pastedRange:discreteRange,unitId,subUnitId}}_getPastedRange(cellMatrix){const target=this._getPastingTarget(),{selection,unitId,subUnitId}=target;if(!subUnitId||!selection)return null;const discreteRange=this._injector.invoke((accessor=>(0,sheets_src.tQu)(selection.range,accessor,unitId,subUnitId)));if(!discreteRange)return null;const{startColumn,endColumn,startRow,endRow}=cellMatrix.getDataRange(),rowCount=endRow-startRow+1,colCount=endColumn-startColumn+1;if(rowCount<=0||colCount<=0)return null;const pasteSelectionRangeRowLen=discreteRange.rows.length,pasteSelectionRangeColLen=discreteRange.cols.length,worksheet=this._univerInstanceService.getUniverSheetInstance(unitId)?.getSheetBySheetId(subUnitId);if(!worksheet)return null;const mergeData=worksheet?.getMergeData();if(pasteSelectionRangeRowLen%rowCount==0&&pasteSelectionRangeColLen%colCount==0){const hasLapWithMerge=mergeData?.some((merge=>rangeIntersectWithDiscreteRange(merge,discreteRange)));if(!hasLapWithMerge){for(let r=0;r<pasteSelectionRangeRowLen;r++)for(let c=0;c<pasteSelectionRangeColLen;c++){const cell=cellMatrix.getValue(r%rowCount,c%colCount);cell&&cellMatrix.setValue(r,c,cell)}return{pastedRange:discreteRange,unitId,subUnitId}}}const newDiscreteRange=this._expandOrShrinkRowsCols(unitId,subUnitId,discreteRange,colCount,rowCount);return discreteRange.rows=newDiscreteRange.rows,discreteRange.cols=newDiscreteRange.cols,{pastedRange:discreteRange,unitId,subUnitId}}_expandOrShrinkRowsCols(unitId,subUnitId,range,colCount,rowCount){const{rows,cols}=range,workbook=this._univerInstanceService.getUniverSheetInstance(unitId),worksheet=workbook?.getSheetBySheetId(subUnitId);let newRows,newCols;if(rows.length>=rowCount)newRows=rows.slice(0,rowCount);else{newRows=rows.slice(0);let rowIndex=rows[rows.length-1]+1;for(;newRows.length<rowCount;)worksheet.getRowFiltered(rowIndex)||newRows.push(rowIndex),rowIndex++}if(cols.length>=colCount)newCols=cols.slice(0,colCount);else{newCols=cols.slice(0);let colIndex=cols[cols.length-1]+1;for(;newCols.length<colCount;)newCols.push(colIndex),colIndex++}return{rows:newRows,cols:newCols}}_topLeftCellsMatch(rowCount,colCount,range){const workbook=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook?.getActiveSheet();if(!worksheet)return!1;const{topRow,leftCol}=range,isRowAcross=function rowAcrossMergedCell(row,startColumn,endColumn,worksheet){return worksheet.getMergeData().some((mergedCell=>mergedCell.startRow<=row&&row<mergedCell.endRow&&startColumn<=mergedCell.startColumn&&mergedCell.startColumn<=endColumn))}(topRow+rowCount-1,leftCol,leftCol+colCount-1,worksheet),isColAcross=function columnAcrossMergedCell(col,startRow,endRow,worksheet){return worksheet.getMergeData().some((mergedCell=>mergedCell.startColumn<=col&&col<mergedCell.endColumn&&startRow<=mergedCell.startRow&&mergedCell.startRow<=endRow))}(leftCol+colCount-1,topRow,topRow+rowCount-1,worksheet);return!isRowAcross&&!isColAcross}removeMarkSelection(){this._copyMarkId&&(this._markSelectionService.removeShape(this._copyMarkId),this._copyMarkId=null)}_initUnitDisposed(){this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$(src.Zy$.UNIVER_SHEET).subscribe((workbook=>{if(workbook){this.copyContentCache().clearWithUnitId(workbook.getUnitId())}})))}disposePasteOptionsCache(){this.setShowMenu(!1),this.updatePasteOptionsCache(null)}}SheetClipboardService=function clipboard_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([clipboard_service_ts_param(0,src.rrK),clipboard_service_ts_param(1,src.HCr),clipboard_service_ts_param(2,(0,src.y_5)(sheets_src.Fal)),clipboard_service_ts_param(3,ui_src.O),clipboard_service_ts_param(4,src.$Dz),clipboard_service_ts_param(5,src.wTY),clipboard_service_ts_param(6,IMarkSelectionService),clipboard_service_ts_param(7,ui_src.Ot),clipboard_service_ts_param(8,ui_src.Gn),clipboard_service_ts_param(9,engine_render_src.cSx),clipboard_service_ts_param(10,(0,src.y_5)(src.Fsb)),clipboard_service_ts_param(11,(0,src.y_5)(src.iH9)),clipboard_service_ts_param(12,(0,src.y_5)(src.IvX)),clipboard_service_ts_param(13,(0,src.y_5)(src.zZn)),clipboard_service_ts_metadata("design:type",Function),clipboard_service_ts_metadata("design:paramtypes",[void 0===src.rrK?Object:src.rrK,void 0===src.HCr?Object:src.HCr,void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===ui_src.O?Object:ui_src.O,void 0===src.$Dz?Object:src.$Dz,void 0===src.wTY?Object:src.wTY,void 0===IMarkSelectionService?Object:IMarkSelectionService,void 0===ui_src.Ot?Object:ui_src.Ot,void 0===ui_src.Gn?Object:ui_src.Gn,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===src.Fsb?Object:src.Fsb,void 0===src.iH9?Object:src.iH9,void 0===src.IvX?Object:src.IvX,void 0===src.zZn?Object:src.zZn])],SheetClipboardService);const SheetCopyCommand={id:ui_src.HP.id,name:"sheet.command.copy",type:src.g4t.COMMAND,multi:!0,priority:998,preconditions:whenSheetFocused,handler:async accessor=>accessor.get(ISheetClipboardService).copy()},clipboard_command_SheetCutCommand={id:ui_src.AP.id,name:"sheet.command.cut",type:src.g4t.COMMAND,multi:!0,priority:998,preconditions:whenSheetFocused,handler:async accessor=>accessor.get(ISheetClipboardService).cut()},SheetPasteCommand={id:ui_src.Fw.id,type:src.g4t.COMMAND,multi:!0,name:"sheet.command.paste",priority:998,preconditions:whenSheetFocused,handler:async(accessor,params)=>{const clipboardInterfaceService=accessor.get(ui_src.O),clipboardItems=await clipboardInterfaceService.read(),sheetClipboardService=accessor.get(ISheetClipboardService);return 0!==clipboardItems.length&&sheetClipboardService.paste(clipboardItems[0],params?.value)}},SheetPasteShortKeyCommand={id:ui_src.W,type:src.g4t.COMMAND,handler:async(accessor,params)=>{const clipboardService=accessor.get(ISheetClipboardService),{htmlContent,textContent,files}=params;return clipboardService.legacyPaste(htmlContent,textContent,files),!0}},SheetPasteValueCommand={id:"sheet.command.paste-value",type:src.g4t.COMMAND,handler:async accessor=>accessor.get(src.wTY).executeCommand(SheetPasteCommand.id,{value:PREDEFINED_HOOK_NAME.SPECIAL_PASTE_VALUE})},SheetPasteFormatCommand={id:"sheet.command.paste-format",type:src.g4t.COMMAND,handler:async accessor=>accessor.get(src.wTY).executeCommand(SheetPasteCommand.id,{value:PREDEFINED_HOOK_NAME.SPECIAL_PASTE_FORMAT})},SheetPasteColWidthCommand={id:"sheet.command.paste-col-width",type:src.g4t.COMMAND,handler:async accessor=>accessor.get(src.wTY).executeCommand(SheetPasteCommand.id,{value:PREDEFINED_HOOK_NAME.SPECIAL_PASTE_COL_WIDTH})},SheetPasteBesidesBorderCommand={id:"sheet.command.paste-besides-border",type:src.g4t.COMMAND,handler:async accessor=>accessor.get(src.wTY).executeCommand(SheetPasteCommand.id,{value:PREDEFINED_HOOK_NAME.SPECIAL_PASTE_BESIDES_BORDER})},SheetOptionalPasteCommand={id:"sheet.command.optional-paste",type:src.g4t.COMMAND,handler:async(accessor,{type})=>accessor.get(ISheetClipboardService).rePasteWithPasteType(type)},HideRowConfirmCommand={id:"sheet.command.hide-row-confirm",type:src.g4t.COMMAND,handler:async accessor=>{const selectionManagerService=accessor.get(sheets_src.Fal),ranges=selectionManagerService.getCurrentSelections()?.map((s=>s.range));if(!ranges?.length)return!1;const commandService=accessor.get(src.wTY),univerInstanceService=accessor.get(src.HCr),target=(0,sheets_src.go2)(univerInstanceService);if(!target)return!1;const{worksheet}=target;if(isAllRowsCovered(worksheet.getVisibleRows(),ranges)){const confirmService=accessor.get(ui_src.rQ),localeService=accessor.get(src.iH9);return await confirmService.confirm({id:"sheet.confirm.hide-row",title:{title:localeService.t("info.problem")},children:{title:localeService.t("rightClick.hideAllRowsAlert")},cancelText:localeService.t("button.cancel"),confirmText:localeService.t("button.confirm")}),!1}return await commandService.executeCommand(sheets_src.ccO.id),!0}},HideColConfirmCommand={id:"sheet.command.hide-col-confirm",type:src.g4t.COMMAND,handler:async accessor=>{const selectionManagerService=accessor.get(sheets_src.Fal),ranges=selectionManagerService.getCurrentSelections()?.map((s=>s.range));if(!ranges?.length)return!1;const commandService=accessor.get(src.wTY),univerInstanceService=accessor.get(src.HCr),target=(0,sheets_src.go2)(univerInstanceService);if(!target)return!1;const{worksheet}=target;if(isAllColumnsCovered(worksheet.getVisibleCols(),ranges)){const confirmService=accessor.get(ui_src.rQ),localeService=accessor.get(src.iH9);return await confirmService.confirm({id:"sheet.confirm.hide-col",title:{title:localeService.t("info.problem")},children:{title:localeService.t("rightClick.hideAllColumnsAlert")},cancelText:localeService.t("button.cancel"),confirmText:localeService.t("button.confirm")}),!1}return await commandService.executeCommand(sheets_src.yCk.id),!0}},SetRangeBoldCommand={type:src.g4t.COMMAND,id:"sheet.command.set-range-bold",handler:async accessor=>{const commandService=accessor.get(src.wTY);return accessor.get(src.oaf).getContextValue(src.AF$)?commandService.executeCommand(inline_format_command.D6.id):commandService.executeCommand(sheets_src.ftS.id)}},SetRangeItalicCommand={type:src.g4t.COMMAND,id:"sheet.command.set-range-italic",handler:async accessor=>{const commandService=accessor.get(src.wTY);return accessor.get(src.oaf).getContextValue(src.AF$)?commandService.executeCommand(inline_format_command._H.id):commandService.executeCommand(sheets_src.kBM.id)}},SetRangeUnderlineCommand={type:src.g4t.COMMAND,id:"sheet.command.set-range-underline",handler:async accessor=>{const commandService=accessor.get(src.wTY);return accessor.get(src.oaf).getContextValue(src.AF$)?commandService.executeCommand(inline_format_command.uk.id):commandService.executeCommand(sheets_src.U0d.id)}},SetRangeStrickThroughCommand={type:src.g4t.COMMAND,id:"sheet.command.set-range-stroke",handler:async accessor=>{const commandService=accessor.get(src.wTY);return accessor.get(src.oaf).getContextValue(src.AF$)?commandService.executeCommand(inline_format_command.rF.id):commandService.executeCommand(sheets_src.HoN.id)}},SetRangeSubscriptCommand={type:src.g4t.COMMAND,id:"sheet.command.set-range-subscript",handler:async accessor=>{const commandService=accessor.get(src.wTY);return!!accessor.get(src.oaf).getContextValue(src.AF$)&&commandService.executeCommand(inline_format_command.xL.id)}},SetRangeSuperscriptCommand={type:src.g4t.COMMAND,id:"sheet.command.set-range-superscript",handler:async accessor=>{const commandService=accessor.get(src.wTY);return!!accessor.get(src.oaf).getContextValue(src.AF$)&&commandService.executeCommand(inline_format_command.yS.id)}},SetRangeFontSizeCommand={type:src.g4t.COMMAND,id:"sheet.command.set-range-fontsize",handler:async(accessor,params)=>{const commandService=accessor.get(src.wTY);return accessor.get(src.oaf).getContextValue(src.AF$)?commandService.executeCommand(inline_format_command.mZ.id,params):commandService.executeCommand(sheets_src.QPx.id,params)}},SetRangeFontFamilyCommand={type:src.g4t.COMMAND,id:"sheet.command.set-range-font-family",handler:async(accessor,params)=>{const commandService=accessor.get(src.wTY);return accessor.get(src.oaf).getContextValue(src.AF$)?commandService.executeCommand(inline_format_command.vp.id,params):commandService.executeCommand(sheets_src.B7g.id,params)}},SetRangeTextColorCommand={type:src.g4t.COMMAND,id:"sheet.command.set-range-text-color",handler:async(accessor,params)=>{const commandService=accessor.get(src.wTY);return accessor.get(src.oaf).getContextValue(src.AF$)?commandService.executeCommand(inline_format_command.Qo.id,params):commandService.executeCommand(sheets_src.YHk.id,params)}},ResetRangeTextColorCommand={type:src.g4t.COMMAND,id:"sheet.command.reset-range-text-color",handler:async accessor=>{const commandService=accessor.get(src.wTY),isCellEditorFocus=accessor.get(src.oaf).getContextValue(src.AF$),themeService=accessor.get(src.Fsb);return isCellEditorFocus?commandService.executeCommand(inline_format_command.Qo.id,{value:null}):commandService.executeCommand(sheets_src.YHk.id,{value:themeService.getCurrentTheme().textColor})}};function format_painter_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function format_painter_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}var FormatPainterStatus=function(FormatPainterStatus){return FormatPainterStatus[FormatPainterStatus.OFF=0]="OFF",FormatPainterStatus[FormatPainterStatus.ONCE=1]="ONCE",FormatPainterStatus[FormatPainterStatus.INFINITE=2]="INFINITE",FormatPainterStatus}({});const IFormatPainterService=(0,src.Qmd)("univer.format-painter-service");class FormatPainterService extends src.jGt{constructor(_selectionManagerService,_themeService,_markSelectionService,_logService,_commandService,_undoRedoService){super(),this._selectionManagerService=_selectionManagerService,this._themeService=_themeService,this._markSelectionService=_markSelectionService,this._logService=_logService,this._commandService=_commandService,this._undoRedoService=_undoRedoService,this._markId=null,this._defaultHook=null,this._extendHooks=[],this._status$=new BehaviorSubject.t(0),this.status$=this._status$.asObservable(),this._selectionFormat={styles:new src.hDc,merges:[]}}addHook(hook){hook.isDefaultHook&&(hook.priority??0)>(this._defaultHook?.priority??-1)?this._defaultHook=hook:(this._extendHooks.push(hook),this._extendHooks.sort(((a,b)=>(a.priority||0)-(b.priority||0))))}getHooks(){return this._defaultHook?[this._defaultHook,...this._extendHooks]:this._extendHooks}setStatus(status){this._updateRangeMark(status),this._status$.next(status);this.getHooks().forEach((hook=>{void 0!==hook.onStatusChange&&hook.onStatusChange(status)}))}getStatus(){return this._status$.getValue()}setSelectionFormat(format){this._selectionFormat=format}getSelectionFormat(){return this._selectionFormat}applyFormatPainter(unitId,subUnitId,range){const hooks=this.getHooks(),redoMutationsInfo=[],undoMutationsInfo=[];hooks.forEach((h=>{if(void 0!==h.onApply){const applyReturn=h.onApply(unitId,subUnitId,range,this._selectionFormat);applyReturn&&(redoMutationsInfo.push(...applyReturn.redos),undoMutationsInfo.push(...applyReturn.undos))}}));for(const beforeHook of hooks)if(void 0!==beforeHook.onBeforeApply){if(!beforeHook.onBeforeApply({unitId,subUnitId,range,redoMutationsInfo,format:this._selectionFormat,undoMutationsInfo}))return!1}this._logService.log("[FormatPainterService]","apply mutations",{undoMutationsInfo,redoMutationsInfo});const result=redoMutationsInfo.every((m=>this._commandService.executeCommand(m.id,m.params)));return result&&this._undoRedoService.pushUndoRedo({unitID:unitId,undoMutations:undoMutationsInfo,redoMutations:redoMutationsInfo}),result}_updateRangeMark(status){if(this._markSelectionService.removeAllShapes(),0!==status){const selection=this._selectionManagerService.getCurrentLastSelection();if(selection){const style=createCopyPasteSelectionStyle(this._themeService);this._markId=2===status?this._markSelectionService.addShape({...selection,style}):this._markSelectionService.addShape({...selection,style},[sheets_src.N48.id])}}}}FormatPainterService=function format_painter_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([format_painter_service_ts_param(0,(0,src.y_5)(sheets_src.Fal)),format_painter_service_ts_param(1,(0,src.y_5)(src.Fsb)),format_painter_service_ts_param(2,IMarkSelectionService),format_painter_service_ts_param(3,src.rrK),format_painter_service_ts_param(4,src.wTY),format_painter_service_ts_param(5,src.$Dz),format_painter_service_ts_metadata("design:type",Function),format_painter_service_ts_metadata("design:paramtypes",[void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===src.Fsb?Object:src.Fsb,void 0===IMarkSelectionService?Object:IMarkSelectionService,void 0===src.rrK?Object:src.rrK,void 0===src.wTY?Object:src.wTY,void 0===src.$Dz?Object:src.$Dz])],FormatPainterService);const SetFormatPainterOperation={id:"sheet.operation.set-format-painter",type:src.g4t.OPERATION,handler:(accessor,params)=>{if(!params)return!1;return accessor.get(IFormatPainterService).setStatus(params.status),!0}},SetInfiniteFormatPainterCommand={type:src.g4t.COMMAND,id:"sheet.command.set-infinite-format-painter",handler:async accessor=>{let newStatus;newStatus=accessor.get(IFormatPainterService).getStatus()!==FormatPainterStatus.OFF?FormatPainterStatus.OFF:FormatPainterStatus.INFINITE;return accessor.get(src.wTY).executeCommand(SetFormatPainterOperation.id,{status:newStatus})}},SetOnceFormatPainterCommand={type:src.g4t.COMMAND,id:"sheet.command.set-once-format-painter",handler:async accessor=>{let newStatus;newStatus=accessor.get(IFormatPainterService).getStatus()!==FormatPainterStatus.OFF?FormatPainterStatus.OFF:FormatPainterStatus.ONCE;return accessor.get(src.wTY).executeCommand(SetFormatPainterOperation.id,{status:newStatus})}},ApplyFormatPainterCommand={type:src.g4t.COMMAND,id:"sheet.command.apply-format-painter",handler:async(accessor,params)=>accessor.get(IFormatPainterService).applyFormatPainter(params.unitId,params.subUnitId,params.range)};const SetSelectionFrozenCommand={type:src.g4t.COMMAND,id:"sheet.command.set-selection-frozen",handler:async(accessor,params)=>{const{type}=params||{},univerInstanceService=accessor.get(src.HCr),undoRedoService=accessor.get(src.$Dz),target=(0,sheets_src.go2)(univerInstanceService);if(!target)return!1;const{unitId,subUnitId}=target,commandService=accessor.get(src.wTY),selections=accessor.get(sheets_src.Fal).getCurrentSelections();if(!selections)return!1;const currentSelection=selections[selections?.length-1],{range}=currentSelection,scrollManagerService=accessor.get(engine_render_src.cSx).getRenderById(unitId).with(SheetScrollManagerService),{sheetViewStartRow=0,sheetViewStartColumn=0}=scrollManagerService.getCurrentScrollState()||{};let startRow,startColumn,freezedRowCount,freezedColCount;const{startRow:selectRow,startColumn:selectColumn,rangeType}=range;if(rangeType===src.$uV.ROW||1===type)startRow=selectRow,freezedRowCount=selectRow-sheetViewStartRow,startColumn=-1,freezedColCount=0;else if(rangeType===src.$uV.COLUMN||2===type)startRow=-1,freezedRowCount=0,startColumn=selectColumn,freezedColCount=selectColumn-sheetViewStartColumn;else{if(rangeType!==src.$uV.NORMAL)return!1;startRow=selectRow,freezedRowCount=selectRow-sheetViewStartRow,startColumn=selectColumn,freezedColCount=selectColumn-sheetViewStartColumn}const redoMutationParams={unitId,subUnitId,startRow,startColumn,xSplit:startColumn>0?Math.max(1,freezedColCount):freezedColCount,ySplit:startRow>0?Math.max(1,freezedRowCount):freezedRowCount},undoMutationParams=(0,sheets_src.kJ6)(accessor,redoMutationParams);return!commandService.syncExecuteCommand(sheets_src.MOW.id,redoMutationParams)||(undoRedoService.pushUndoRedo({unitID:unitId,undoMutations:[{id:sheets_src.MOW.id,params:undoMutationParams}],redoMutations:[{id:sheets_src.MOW.id,params:redoMutationParams}]}),!0)}},SetRowFrozenCommand={type:src.g4t.COMMAND,id:"sheet.command.set-row-frozen",handler:async accessor=>(accessor.get(src.wTY).executeCommand(SetSelectionFrozenCommand.id,{type:1}),!0)},SetColumnFrozenCommand={type:src.g4t.COMMAND,id:"sheet.command.set-col-frozen",handler:async accessor=>(accessor.get(src.wTY).executeCommand(SetSelectionFrozenCommand.id,{type:2}),!0)};function auto_width_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function auto_width_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class AutoWidthController extends src.jGt{constructor(_renderManagerService,_univerInstanceService){super(),this._renderManagerService=_renderManagerService,this._univerInstanceService=_univerInstanceService}getUndoRedoParamsOfColWidth(params){const defaultValue={redos:[],undos:[]},{_univerInstanceService:univerInstanceService}=this,target=(0,sheets_src.go2)(univerInstanceService);if(!target)return defaultValue;const{unitId,subUnitId,worksheet}=target,sheetSkeletonService=this._renderManagerService.getRenderById(unitId).with(sheet_skeleton_manager_service_SheetSkeletonManagerService);if(!sheetSkeletonService.getCurrentParam())return defaultValue;const{skeleton}=sheetSkeletonService.getCurrentParam(),colsAutoWidthInfo=skeleton.calculateAutoWidthInRange(params.ranges),colWidthObject={};for(const{col,width}of colsAutoWidthInfo)colWidthObject[col]=width;const redoParams={subUnitId,unitId,ranges:params.ranges,colWidth:colWidthObject},undoParams=((params,worksheet)=>{const{unitId,subUnitId,ranges}=params,colWidthObj={},manager=worksheet.getColumnManager();for(let i=0;i<ranges.length;i++){const range=ranges[i];for(let j=range.startColumn;j<range.endColumn+1;j++){const col=manager.getColumnOrCreate(j);colWidthObj[j]=col.w}}return{unitId,subUnitId,ranges,colWidth:colWidthObj}})(redoParams,worksheet);return{undos:[{id:sheets_src.Cay.id,params:undoParams}],redos:[{id:sheets_src.Cay.id,params:redoParams}]}}}AutoWidthController=function auto_width_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([auto_width_controller_ts_param(0,engine_render_src.cSx),auto_width_controller_ts_param(1,(0,src.y_5)(src.HCr)),auto_width_controller_ts_metadata("design:type",Function),auto_width_controller_ts_metadata("design:paramtypes",["undefined"==typeof RenderManagerService?Object:RenderManagerService,void 0===src.HCr?Object:src.HCr])],AutoWidthController);const SetWorksheetColAutoWidthCommand={type:src.g4t.COMMAND,id:"sheet.command.set-col-auto-width",handler:(accessor,params)=>{const commandService=accessor.get(src.wTY),undoRedoService=accessor.get(src.$Dz),selectionManagerService=accessor.get(sheets_src.Fal),univerInstanceService=accessor.get(src.HCr),target=(0,sheets_src.go2)(univerInstanceService,params);if(!target)return!1;const{unitId,subUnitId}=target;let ranges=[];if(params?.ranges)ranges=[...params.ranges];else{const selections=selectionManagerService.getCurrentSelections();for(let i=0;i<selections.length;i++)ranges.push(selections[i].range)}if(!ranges?.length)return!1;const redoMutationParams={unitId,subUnitId,ranges},{redos,undos}=accessor.get(AutoWidthController).getUndoRedoParamsOfColWidth(redoMutationParams);return!!(0,src.PkI)([...redos],commandService).result&&(undoRedoService.pushUndoRedo({unitID:unitId,undoMutations:[...undos],redoMutations:[...redos]}),!0)}},COLOR_PICKER_COMPONENT="UI_PLUGIN_SHEETS_COLOR_PICKER_COMPONENT",MENU_ITEM_INPUT_COMPONENT="UI_PLUGIN_SHEETS_MENU_ITEM_INPUT_COMPONENT";var menu_item_input_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/components/menu-item-input/index.module.less"),menu_item_input_index_module_options={};menu_item_input_index_module_options.styleTagTransform=styleTagTransform_default(),menu_item_input_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),menu_item_input_index_module_options.insert=insertBySelector_default().bind(null,"head"),menu_item_input_index_module_options.domAPI=styleDomAPI_default(),menu_item_input_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(menu_item_input_index_module.A,menu_item_input_index_module_options);const components_menu_item_input_index_module=menu_item_input_index_module.A&&menu_item_input_index_module.A.locals?menu_item_input_index_module.A.locals:void 0,MenuItemInput=props=>{const{prefix,suffix,value,onChange,min=Number.MIN_SAFE_INTEGER,max=Number.MAX_SAFE_INTEGER}=props,localeService=(0,ui_src.fJ)(src.iH9),contextMenuService=(0,ui_src.fJ)(ui_src.ZL),[inputValue,setInputValue]=(0,react.useState)();return(0,react.useEffect)((()=>{contextMenuService.visible||setInputValue(value)}),[contextMenuService.visible]),(0,react.useEffect)((()=>{setInputValue(value)}),[value]),(0,jsx_runtime.jsxs)("div",{className:components_menu_item_input_index_module.sheetsUiContextMenuInput,children:[localeService.t(prefix),(0,jsx_runtime.jsx)("span",{className:components_menu_item_input_index_module.sheetsUiContextMenuInputContainer,onClick:e=>e.stopPropagation(),children:(0,jsx_runtime.jsx)(design_src.YI,{className:components_menu_item_input_index_module.sheetsUiContextMenuInputNumber,value:Number(inputValue),precision:0,onKeyDown:function handleKeyDown(e){"Backspace"===e.key&&e.stopPropagation()},onChange:value=>{setInputValue(value?.toString()),onChange(value?.toString()??"")},min,max})}),localeService.t(suffix)]})};MenuItemInput.__docgenInfo={description:"",methods:[],displayName:"MenuItemInput",props:{value:{required:!0,tsType:{name:"string"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(v: T) => void",signature:{arguments:[{type:{name:"string"},name:"v"}],return:{name:"void"}}},description:""},prefix:{required:!0,tsType:{name:"string"},description:""},suffix:{required:!0,tsType:{name:"string"},description:""},min:{required:!1,tsType:{name:"number"},description:""},max:{required:!1,tsType:{name:"number"},description:""}}};var combineLatest=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/observable/combineLatest.js"),finalize=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/finalize.js"),operators_startWith=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/startWith.js"),operators_debounceTime=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/debounceTime.js");function deriveStateFromActiveSheet$(univerInstanceService,defaultValue,callback){return function getActiveSheet$(univerInstanceService){return univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET).pipe((0,switchMap.n)((workbook=>workbook?workbook.activeSheet$.pipe((0,operators_map.T)((worksheet=>worksheet?{workbook,worksheet}:null))):(0,observable_of.of)(null))))}(univerInstanceService).pipe((0,switchMap.n)((active=>active?callback(active):(0,observable_of.of)(defaultValue))))}function getCurrentExclusiveRangeInterest$(accessor,disableGroupSet){const univerInstanceService=accessor.get(src.HCr),exclusiveRangeService=accessor.get(sheets_src.oJ9),selectionManagerService=accessor.get(sheets_src.Fal);return univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET).pipe((0,switchMap.n)((workbook=>workbook?(0,combineLatest.z)([selectionManagerService.selectionMoveEnd$,workbook.activeSheet$]).pipe((0,switchMap.n)((([selections,worksheet])=>{if(!worksheet)return(0,observable_of.of)(!1);if(0===selections.length)return(0,observable_of.of)(!1);const interestGroupIds=exclusiveRangeService.getInterestGroupId(selections);if(disableGroupSet){const disableGroup=interestGroupIds.filter((groupId=>disableGroupSet.has(groupId)));return(0,observable_of.of)(disableGroup.length>0)}return(0,observable_of.of)(interestGroupIds.length>0)}))):(0,observable_of.of)(!1))))}function getObservableWithExclusiveRange$(accessor,observable$,disableGroupSet){return(0,combineLatest.z)([observable$,getCurrentExclusiveRangeInterest$(accessor,disableGroupSet)]).pipe((0,operators_map.T)((([observable,exclusiveRangeDisable])=>observable||exclusiveRangeDisable)))}function menu_util_getCurrentRangeDisable$(accessor,permissionTypes={},supportCellEdit=!1){const workbook$=accessor.get(src.HCr).getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET),userManagerService=accessor.get(src.szM),editorBridgeService=accessor.has(editor_bridge_service_IEditorBridgeService)?accessor.get(editor_bridge_service_IEditorBridgeService):null,contextService=accessor.get(src.oaf),formulaEditorFocus$=new BehaviorSubject.t(!1),editorVisible$=editorBridgeService?.visible$??(0,observable_of.of)(null),subscription=contextService.subscribeContextValue$(src.kgb).subscribe((visible=>{formulaEditorFocus$.next(visible)})),observable=(0,combineLatest.z)([userManagerService.currentUser$,workbook$,editorVisible$,formulaEditorFocus$]).pipe((0,finalize.j)((()=>{subscription.unsubscribe(),formulaEditorFocus$.complete()})),(0,switchMap.n)((([_,workbook,visible,formulaEditorFocus])=>!workbook||visible?.visible&&visible.unitId===workbook.getUnitId()&&!supportCellEdit||formulaEditorFocus&&!supportCellEdit?(0,observable_of.of)(!0):workbook.activeSheet$.pipe((0,switchMap.n)((worksheet=>{if(!worksheet)return(0,observable_of.of)(!0);const selectionManagerService=accessor.get(sheets_src.Fal),rangeProtectionRuleModel=accessor.get(sheets_src.qI9),worksheetRuleModel=accessor.get(sheets_src.$af),focusedOnDrawing$=accessor.get(src.oaf).subscribeContextValue$(src.fiP).pipe((0,operators_startWith.Z)(!1));return(0,combineLatest.z)([selectionManagerService.selectionMoveEnd$,focusedOnDrawing$]).pipe((0,switchMap.n)((([selection,focusOnDrawings])=>{if(focusOnDrawings)return(0,observable_of.of)(!0);const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId(),permissionService=accessor.get(src.QWp),{workbookTypes=[sheets_src.W30],worksheetTypes,rangeTypes}=permissionTypes,permissionIds=[];workbookTypes?.forEach((F=>{permissionIds.push(new F(unitId).id)})),worksheetTypes?.forEach((F=>{permissionIds.push(new F(unitId,subUnitId).id)}));if(worksheetRuleModel.getRule(unitId,subUnitId))return permissionService.composePermission$(permissionIds).pipe((0,operators_map.T)((list=>list.some((item=>!1===item.value)))));const selectionRanges=selection?.map((selection=>selection.range)),rules=rangeProtectionRuleModel.getSubunitRuleList(unitId,subUnitId).filter((rule=>selectionRanges?.some((range=>rule.ranges.some((ruleRange=>src.M_G.intersects(range,ruleRange)))))));return rangeTypes?.forEach((F=>{rules.forEach((rule=>{permissionIds.push(new F(unitId,subUnitId,rule.permissionId).id)}))})),permissionService.composePermission$(permissionIds).pipe((0,operators_map.T)((list=>list.some((item=>!1===item.value)))))})))}))))));return observable}function menu_util_getBaseRangeMenuHidden$(accessor){const univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),rangeProtectionRuleModel=accessor.get(sheets_src.qI9),permissionService=accessor.get(src.QWp);return(0,observable_merge.h)(selectionManagerService.selectionMoveEnd$,permissionService.permissionPointUpdate$.pipe((0,operators_debounceTime.B)(100))).pipe((0,operators_map.T)((()=>{const range=selectionManagerService.getCurrentLastSelection()?.range;if(!range)return!0;const workbook=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook?.getActiveSheet();if(!workbook||!worksheet)return!0;const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId(),permissionIds=[new sheets_src.W30(unitId).id,new sheets_src.qGK(unitId,subUnitId).id];return rangeProtectionRuleModel.getSubunitRuleList(unitId,subUnitId).filter((rule=>rule.ranges.some((ruleRange=>src.M_G.intersects(range,ruleRange))))).forEach((rule=>{permissionIds.push(new sheets_src.o9h(unitId,subUnitId,rule.permissionId).id)})),permissionService.composePermission(permissionIds).some((item=>!1===item.value))})))}function menu_util_getInsertBeforeMenuHidden$(accessor,type){const univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),rangeProtectionRuleModel=accessor.get(sheets_src.qI9),permissionService=accessor.get(src.QWp);return(0,observable_merge.h)(selectionManagerService.selectionMoveEnd$,permissionService.permissionPointUpdate$.pipe((0,operators_debounceTime.B)(100))).pipe((0,operators_map.T)((()=>{const range=selectionManagerService.getCurrentLastSelection()?.range;if(!range)return!0;const workbook=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook?.getActiveSheet();if(!workbook||!worksheet)return!0;const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId(),permissionIds=[new sheets_src.W30(unitId).id,new sheets_src.qGK(unitId,subUnitId).id];return rangeProtectionRuleModel.getSubunitRuleList(unitId,subUnitId).filter((rule=>"row"===type?rule.ranges.some((ruleRange=>range.startRow>ruleRange.startRow&&range.startRow<=ruleRange.endRow)):rule.ranges.some((ruleRange=>range.startColumn>ruleRange.startColumn&&range.startColumn<=ruleRange.endColumn)))).forEach((rule=>{permissionIds.push(new sheets_src.o9h(unitId,subUnitId,rule.permissionId).id)})),permissionService.composePermission(permissionIds).some((item=>!1===item.value))})))}function getDeleteMenuHidden$(accessor,type){const univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),rangeProtectionRuleModel=accessor.get(sheets_src.qI9),permissionService=accessor.get(src.QWp);return(0,observable_merge.h)(selectionManagerService.selectionMoveEnd$,permissionService.permissionPointUpdate$.pipe((0,operators_debounceTime.B)(100))).pipe((0,operators_map.T)((()=>{const range=selectionManagerService.getCurrentLastSelection()?.range;if(!range)return!0;const workbook=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook?.getActiveSheet();if(!workbook||!worksheet)return!0;const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId(),permissionIds=[new sheets_src.W30(unitId).id,new sheets_src.qGK(unitId,subUnitId).id],rowColRangeExpand=src.S0q.deepClone(range);return"row"===type?(rowColRangeExpand.startColumn=0,rowColRangeExpand.endColumn=worksheet.getColumnCount()-1):(rowColRangeExpand.startRow=0,rowColRangeExpand.endRow=worksheet.getRowCount()-1),rangeProtectionRuleModel.getSubunitRuleList(unitId,subUnitId).filter((rule=>rule.ranges.some((ruleRange=>src.M_G.intersects(rowColRangeExpand,ruleRange))))).forEach((rule=>{permissionIds.push(new sheets_src.o9h(unitId,subUnitId,rule.permissionId).id)})),permissionService.composePermission(permissionIds).some((item=>!1===item.value))})))}function getCellMenuHidden$(accessor,type){const univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),rangeProtectionRuleModel=accessor.get(sheets_src.qI9),permissionService=accessor.get(src.QWp);return(0,observable_merge.h)(selectionManagerService.selectionMoveEnd$,permissionService.permissionPointUpdate$.pipe((0,operators_debounceTime.B)(100))).pipe((0,operators_map.T)((()=>{const range=selectionManagerService.getCurrentLastSelection()?.range;if(!range)return!0;const workbook=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook?.getActiveSheet();if(!workbook||!worksheet)return!0;const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId(),permissionIds=[new sheets_src.W30(unitId).id,new sheets_src.qGK(unitId,subUnitId).id],rowColRangeExpand=src.S0q.deepClone(range);return"row"===type?rowColRangeExpand.endRow=worksheet.getRowCount()-1:rowColRangeExpand.endColumn=worksheet.getColumnCount()-1,rangeProtectionRuleModel.getSubunitRuleList(unitId,subUnitId).filter((rule=>rule.ranges.some((ruleRange=>src.M_G.intersects(rowColRangeExpand,ruleRange))))).forEach((rule=>{permissionIds.push(new sheets_src.o9h(unitId,subUnitId,rule.permissionId).id)})),permissionService.composePermission(permissionIds).some((item=>!1===item.value))})))}function menu_util_getWorkbookPermissionDisable$(accessor,workbookPermissionTypes){const workbook$=accessor.get(src.HCr).getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET),worksheetRuleModel=accessor.get(sheets_src.$af),selectionRuleModel=accessor.get(sheets_src.qI9),permissionService=accessor.get(src.QWp),userManagerService=accessor.get(src.szM);return(0,combineLatest.z)([userManagerService.currentUser$,workbook$]).pipe((0,switchMap.n)((([_user,workbook])=>workbook?workbook.activeSheet$.pipe((0,switchMap.n)((activeSheet=>{if(!activeSheet)return(0,observable_of.of)(!0);const unitId=workbook.getUnitId(),workbookPermissionIds=[];workbookPermissionTypes.forEach((F=>workbookPermissionIds.push(new F(unitId).id)));return permissionService.composePermission$(workbookPermissionIds).pipe((0,operators_map.T)((list=>list.every((item=>!0===item.value))))).pipe((0,operators_map.T)((basePermission=>{if(!basePermission)return!0;const subUnitId=activeSheet.getSheetId(),worksheetRule=worksheetRuleModel.getRule(unitId,subUnitId),rangeRuleList=selectionRuleModel.getSubunitRuleList(unitId,subUnitId);return!(!worksheetRule&&!rangeRuleList.length)})))}))):(0,observable_of.of)(!0))))}const HORIZONTAL_ALIGN_CHILDREN=[{label:"align.left",icon:"LeftJustifyingSingle",value:src.wqs.LEFT},{label:"align.center",icon:"HorizontallySingle",value:src.wqs.CENTER},{label:"align.right",icon:"RightJustifyingSingle",value:src.wqs.RIGHT}];const VERTICAL_ALIGN_CHILDREN=[{label:"align.top",icon:"AlignTopSingle",value:src.G4t.TOP},{label:"align.middle",icon:"VerticalCenterSingle",value:src.G4t.MIDDLE},{label:"align.bottom",icon:"AlignBottomSingle",value:src.G4t.BOTTOM}];const TEXT_WRAP_CHILDREN=[{label:"textWrap.overflow",icon:"OverflowSingle",value:src.sFy.OVERFLOW},{label:"textWrap.wrap",icon:"AutowrapSingle",value:src.sFy.WRAP},{label:"textWrap.clip",icon:"TruncationSingle",value:src.sFy.CLIP}];const TEXT_ROTATE_CHILDREN=[{label:"textRotate.none",icon:"NoRotationSingle",value:0},{label:"textRotate.angleUp",icon:"LeftRotationFortyFiveDegreesSingle",value:-45},{label:"textRotate.angleDown",icon:"RightRotationFortyFiveDegreesSingle",value:45},{label:"textRotate.vertical",icon:"VerticalTextSingle",value:"v"},{label:"textRotate.rotationUp",icon:"LeftRotationNinetyDegreesSingle",value:-90},{label:"textRotate.rotationDown",icon:"RightRotationNinetyDegreesSingle",value:90}];function menuClipboardDisabledObservable(injector){return new internal_Observable.c((subscriber=>subscriber.next(!injector.get(ui_src.O).supportClipboard)))}function CopyMenuItemFactory(accessor){return{id:SheetCopyCommand.name,commandId:SheetCopyCommand.id,type:ui_src.xU.BUTTON,title:"rightClick.copy",icon:"Copy",disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.FB8],worksheetTypes:[sheets_src.$Rn],rangeTypes:[sheets_src.fGp]}),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}function PasteMenuItemFactory(accessor){return{id:SheetPasteCommand.name,commandId:SheetPasteCommand.id,type:ui_src.xU.BUTTON,title:"rightClick.paste",icon:"PasteSpecial",disabled$:menuClipboardDisabledObservable(accessor).pipe((0,operators_combineLatestWith.v)(menu_util_getCurrentRangeDisable$(accessor,{rangeTypes:[sheets_src.o9h],worksheetTypes:[sheets_src.qGK,sheets_src.nhd,sheets_src.r$W],workbookTypes:[sheets_src.W30]})),(0,operators_map.T)((([d1,d2])=>d1||d2))),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}const PASTE_SPECIAL_MENU_ID="sheet.menu.paste-special";function PasteSpacialMenuItemFactory(accessor){return{id:"sheet.menu.paste-special",type:ui_src.xU.SUBITEMS,icon:"PasteSpecial",title:"rightClick.pasteSpecial",hidden$:getObservableWithExclusiveRange$(accessor,(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET))}}function PasteValueMenuItemFactory(accessor){return{id:SheetPasteValueCommand.id,type:ui_src.xU.BUTTON,title:"rightClick.pasteValue",disabled$:menuClipboardDisabledObservable(accessor).pipe((0,operators_combineLatestWith.v)(menu_util_getCurrentRangeDisable$(accessor,{rangeTypes:[sheets_src.o9h],worksheetTypes:[sheets_src.r$W,sheets_src.qGK],workbookTypes:[sheets_src.W30]})),(0,operators_map.T)((([d1,d2])=>d1||d2))),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}function PasteFormatMenuItemFactory(accessor){return{id:SheetPasteFormatCommand.id,type:ui_src.xU.BUTTON,title:"rightClick.pasteFormat",disabled$:menuClipboardDisabledObservable(accessor).pipe((0,operators_combineLatestWith.v)(menu_util_getCurrentRangeDisable$(accessor,{rangeTypes:[sheets_src.o9h],worksheetTypes:[sheets_src.nhd,sheets_src.qGK],workbookTypes:[sheets_src.W30]})),(0,operators_map.T)((([d1,d2])=>d1||d2))),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}function PasteColWidthMenuItemFactory(accessor){return{id:SheetPasteColWidthCommand.id,type:ui_src.xU.BUTTON,title:"rightClick.pasteColWidth",disabled$:menuClipboardDisabledObservable(accessor).pipe((0,operators_combineLatestWith.v)(menu_util_getCurrentRangeDisable$(accessor,{rangeTypes:[sheets_src.o9h],worksheetTypes:[sheets_src.lLG,sheets_src.qGK],workbookTypes:[sheets_src.W30]})),(0,operators_map.T)((([d1,d2])=>d1||d2)))}}function PasteBesidesBorderMenuItemFactory(accessor){return{id:SheetPasteBesidesBorderCommand.id,type:ui_src.xU.BUTTON,title:"rightClick.pasteBesidesBorder",disabled$:menuClipboardDisabledObservable(accessor).pipe((0,operators_combineLatestWith.v)(menu_util_getCurrentRangeDisable$(accessor,{rangeTypes:[sheets_src.o9h],worksheetTypes:[sheets_src.qGK,sheets_src.nhd,sheets_src.r$W,sheets_src.Frs,sheets_src.lLG],workbookTypes:[sheets_src.W30]})),(0,operators_map.T)((([d1,d2])=>d1||d2))),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}const SHEET_FROZEN_MENU_ID="sheet.menu.sheet-frozen";const SHEET_FROZEN_HEADER_MENU_ID="sheet.header-menu.sheet-frozen";function SheetFrozenHeaderMenuItemFactory(accessor){return{id:"sheet.header-menu.sheet-frozen",type:ui_src.xU.SUBITEMS,title:"rightClick.freeze",icon:"FreezeToSelectedSingle",hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}function FrozenMenuItemFactory(accessor){return{id:SetSelectionFrozenCommand.id,type:ui_src.xU.BUTTON,title:"rightClick.freeze",icon:"FreezeToSelectedSingle",hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}function CancelFrozenMenuItemFactory(accessor){return{id:sheets_src.mtZ.id,type:ui_src.xU.BUTTON,title:"rightClick.cancelFreeze",icon:"CancelFreezeSingle",hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}function getFontStyleAtCursor(accessor){const univerInstanceService=accessor.get(src.HCr),textSelectionService=accessor.get(docs_src.pv),editorDataModel=univerInstanceService.getUniverDocInstance(src.Fmw),activeTextRange=textSelectionService.getActiveTextRange();if(null==editorDataModel||null==activeTextRange)return null;const textRuns=editorDataModel.getBody()?.textRuns;if(null==textRuns)return;const{startOffset}=activeTextRange;return textRuns.find((({st,ed})=>startOffset>=st&&startOffset<=ed))}var Subscription=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/Subscription.js");function freeze_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function freeze_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}const FREEZE_PERMISSION_CHECK=(0,src.nwg)("freezePermissionCheck");class HeaderFreezeRenderController extends src.jGt{constructor(_context,_sheetSkeletonManagerService,_commandService,_selectionManagerService,_scrollManagerService,_themeService,_sheetInterceptorService,_injector){super(),this._context=_context,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._commandService=_commandService,this._selectionManagerService=_selectionManagerService,this._scrollManagerService=_scrollManagerService,this._themeService=_themeService,this._sheetInterceptorService=_sheetInterceptorService,this._injector=_injector,this._changeToRow=-1,this._changeToColumn=-1,this._changeToOffsetX=0,this._changeToOffsetY=0,this._activeViewport=null,this._freezeNormalHeaderColor="",this._freezeNormalMainColor="",this._freezeActiveColor="",this._freezeHoverColor="",this._lastFreeze=void 0,this.interceptor=new src.vY4({FREEZE_PERMISSION_CHECK}),this._initialize()}dispose(){super.dispose()}_initialize(){this._skeletonListener(),this._commandExecutedListener(),this._themeChangeListener(),this._interceptorCommands(),this._bindViewportScroll(),this._zoomRefresh()}_createFreeze(freezeDirectionType=0,freezeConfig){const config=freezeConfig??this._getFreeze();if(null==config)return null;const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton,{startRow:freezeRow,startColumn:freezeColumn}=config,position=this._getPositionByIndex(freezeRow,freezeColumn);if(null==position||null==skeleton)return null;const sheetObject=this._getSheetObject(),engine=sheetObject.engine,canvasMaxWidth=engine?.width||0,canvasMaxHeight=engine?.height||0,scene=sheetObject.scene,{startX,startY}=position,{rowTotalHeight,columnTotalWidth,rowHeaderWidthAndMarginLeft,columnHeaderHeightAndMarginTop}=skeleton,contentWidth=canvasMaxWidth>columnTotalWidth+rowHeaderWidthAndMarginLeft?canvasMaxWidth:columnTotalWidth+columnHeaderHeightAndMarginTop,contentHeight=canvasMaxHeight>rowTotalHeight+columnHeaderHeightAndMarginTop?canvasMaxHeight:rowTotalHeight+columnHeaderHeightAndMarginTop;this._changeToRow=freezeRow,this._changeToColumn=freezeColumn,this._changeToOffsetX=startX,this._changeToOffsetY=startY;const scale=Math.max(scene.scaleX,scene.scaleY);let freezeSize=2/Math.max(1,scale);if(0===freezeDirectionType){-1!==freezeRow&&0!==freezeRow||(freezeSize*=2);const freezeOffset=freezeSize;this._rowFreezeHeaderRect=new engine_render_src.rwV("__SpreadsheetFreezeRowHeaderName__",{fill:this._freezeNormalHeaderColor,width:rowHeaderWidthAndMarginLeft,height:freezeSize,left:0,top:startY-freezeOffset,zIndex:3});let fill=this._freezeNormalHeaderColor;-1!==freezeRow&&0!==freezeRow||(fill=this._freezeNormalMainColor),this._rowFreezeMainRect=new engine_render_src.rwV("__SpreadsheetFreezeRowMainName__",{fill,width:2*contentWidth/scale,height:freezeSize,left:rowHeaderWidthAndMarginLeft,top:startY-freezeOffset,zIndex:3}),scene.addObjects([this._rowFreezeHeaderRect,this._rowFreezeMainRect],10)}else{-1!==freezeColumn&&0!==freezeColumn||(freezeSize*=2);const FREEZE_OFFSET=freezeSize;this._columnFreezeHeaderRect=new engine_render_src.rwV("__SpreadsheetFreezeColumnHeaderName__",{fill:this._freezeNormalHeaderColor,width:freezeSize,height:columnHeaderHeightAndMarginTop,left:startX-FREEZE_OFFSET,top:0,zIndex:3});let fill=this._freezeNormalHeaderColor;-1!==freezeColumn&&0!==freezeColumn||(fill=this._freezeNormalMainColor),this._columnFreezeMainRect=new engine_render_src.rwV("__SpreadsheetFreezeColumnMainName__",{fill,width:freezeSize,height:2*contentHeight/scale,left:startX-FREEZE_OFFSET,top:columnHeaderHeightAndMarginTop,zIndex:3}),scene.addObjects([this._columnFreezeHeaderRect,this._columnFreezeMainRect],10)}this._eventBinding(freezeDirectionType)}_eventBinding(freezeDirectionType=0){let freezeObjectHeaderRect=this._rowFreezeHeaderRect,freezeObjectMainRect=this._rowFreezeMainRect;1===freezeDirectionType&&(freezeObjectHeaderRect=this._columnFreezeHeaderRect,freezeObjectMainRect=this._columnFreezeMainRect);const sheetObject=this._getSheetObject();if(null==sheetObject)return;const{scene}=sheetObject;if(this._freezePointerEnterSubs=new Subscription.yU,this._freezePointerLeaveSubs=new Subscription.yU,this._freezeDownSubs=new Subscription.yU,freezeObjectMainRect){const _freezeObjectMainRectEnterSub=freezeObjectMainRect.onPointerEnter$.subscribeEvent((()=>{if(!this.interceptor.fetchThroughInterceptors(FREEZE_PERMISSION_CHECK)(!0,null))return!1;freezeObjectHeaderRect?.setProps({fill:this._freezeHoverColor,zIndex:4}),scene.setCursor(engine_render_src.MBo.GRAB)}));this._freezePointerEnterSubs.add(_freezeObjectMainRectEnterSub);const _freezeObjectMainPointerLeaveSub=freezeObjectMainRect.onPointerLeave$.subscribeEvent((()=>{freezeObjectHeaderRect?.setProps({fill:this._freezeNormalHeaderColor,zIndex:3}),scene.resetCursor()}));this._freezePointerLeaveSubs.add(_freezeObjectMainPointerLeaveSub)}if(freezeObjectHeaderRect){const _freezeObjHeaderPointerEnterSub=freezeObjectHeaderRect.onPointerEnter$.subscribeEvent((()=>{if(!this.interceptor.fetchThroughInterceptors(FREEZE_PERMISSION_CHECK)(!0,null))return!1;freezeObjectHeaderRect?.setProps({fill:this._freezeHoverColor,zIndex:4}),scene.setCursor(engine_render_src.MBo.GRAB)}));this._freezePointerEnterSubs.add(_freezeObjHeaderPointerEnterSub);const _freezeObjHeaderPointerLeaveSub=freezeObjectHeaderRect.onPointerLeave$.subscribeEvent((()=>{freezeObjectHeaderRect?.setProps({fill:this._freezeNormalHeaderColor,zIndex:3}),scene.resetCursor()}));this._freezePointerLeaveSubs.add(_freezeObjHeaderPointerLeaveSub)}const s1=freezeObjectHeaderRect?.onPointerDown$.subscribeEvent((evt=>{this._freezeDown(evt,freezeObjectHeaderRect,freezeObjectMainRect,freezeDirectionType)}));s1&&this._freezeDownSubs.add(s1);const s2=freezeObjectMainRect?.onPointerDown$.subscribeEvent((evt=>{this._freezeDown(evt,freezeObjectHeaderRect,freezeObjectMainRect,freezeDirectionType)}));s2&&this._freezeDownSubs.add(s2)}_getCurrentLastVisible(){const sheetObject=this._getSheetObject();if(null==sheetObject)return;const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(null==skeleton)return;const scene=sheetObject.scene,scale=Math.max(scene.scaleX,scene.scaleY),currentScroll=this._scrollManagerService.getCurrentScrollState(),skeletonViewHeight=(sheetObject.engine.height-skeleton.columnHeaderHeight)/scale,skeletonViewWidth=(sheetObject.engine.width-skeleton.rowHeaderWidth)/scale,startRow=currentScroll?.sheetViewStartRow??0,startHeight=0===startRow?-(currentScroll?.offsetY??0):skeleton.rowHeightAccumulation[startRow-1]-(currentScroll?.offsetY??0);let lastRow=0,hadFind=!1;for(let i=startRow,len=skeleton.rowHeightAccumulation.length;i<len;i++){if(skeleton.rowHeightAccumulation[i]-startHeight>skeletonViewHeight){lastRow=i,hadFind=!0;break}}hadFind||(lastRow=skeleton.rowHeightAccumulation.length-1);const startColumn=currentScroll?.sheetViewStartColumn??0,startWidth=0===startColumn?-(currentScroll?.offsetX??0):skeleton.columnWidthAccumulation[startColumn-1]-(currentScroll?.offsetX??0);let lastColumn=0,hadFindCol=!1;for(let i=startColumn,len=skeleton.columnWidthAccumulation.length;i<len;i++){if(skeleton.columnWidthAccumulation[i]-startWidth>skeletonViewWidth){lastColumn=i,hadFindCol=!0;break}}return hadFindCol||(lastColumn=skeleton.columnWidthAccumulation.length-1),{lastRow,lastColumn}}_getActiveViewport(evt){const viewports=this._getSheetObject()?.scene.getViewports();return viewports&&viewports.find((i=>i.isHit(new engine_render_src.I9Y(evt.offsetX,evt.offsetY))))||null}_freezeDown(evt,freezeObjectHeaderRect,freezeObjectMainRect,freezeDirectionType=0){const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(null==skeleton)return;const sheetObject=this._getSheetObject();if(null==sheetObject)return;if(!this.interceptor.fetchThroughInterceptors(FREEZE_PERMISSION_CHECK)(!0,null))return!1;const{scene}=sheetObject;scene.setCursor(engine_render_src.MBo.GRABBING),scene.disableObjectsEvent();const last=this._getCurrentLastVisible(),lastRowY=void 0===last?Number.POSITIVE_INFINITY:skeleton.rowHeightAccumulation[last.lastRow],lastColumnX=void 0===last?Number.POSITIVE_INFINITY:skeleton.columnWidthAccumulation[last.lastColumn-1]+skeleton.rowHeaderWidth;this._activeViewport=null;const oldFreeze=this._getFreeze();oldFreeze&&(this._changeToColumn=oldFreeze.startColumn,this._changeToRow=oldFreeze.startRow),this._scenePointerMoveSub=scene.onPointerMove$.subscribeEvent((moveEvt=>{const activeViewport=this._getActiveViewport(moveEvt),{startX,startY,row,column}=getCoordByOffset(moveEvt.offsetX,moveEvt.offsetY,scene,skeleton,activeViewport||void 0,!0);if(!this.interceptor.fetchThroughInterceptors(FREEZE_PERMISSION_CHECK)(!0,null))return!1;scene.setCursor(engine_render_src.MBo.GRABBING);const FREEZE_SIZE=2/Math.max(scene.scaleX,scene.scaleY);0===freezeDirectionType?(freezeObjectHeaderRect.transformByState({top:Math.min(startY,lastRowY)-FREEZE_SIZE/2})?.setProps({fill:this._freezeActiveColor}),freezeObjectMainRect.transformByState({top:Math.min(startY,lastRowY)-FREEZE_SIZE/2})?.setProps({fill:this._freezeNormalHeaderColor}),this._changeToRow=void 0===last?row:Math.min(row,last.lastRow),this._changeToOffsetY=Math.min(startY,lastRowY),this._activeViewport=activeViewport):(freezeObjectHeaderRect.transformByState({left:Math.min(startX,lastColumnX)-FREEZE_SIZE/2})?.setProps({fill:this._freezeActiveColor}),freezeObjectMainRect.transformByState({left:Math.min(startX,lastColumnX)-FREEZE_SIZE/2})?.setProps({fill:this._freezeNormalHeaderColor}),this._changeToColumn=void 0===last?column:Math.min(column,last.lastColumn),this._changeToOffsetX=startX,this._activeViewport=activeViewport)})),this._scenePointerUpSub=scene.onPointerUp$.subscribeEvent((()=>{scene.resetCursor(),scene.enableObjectsEvent(),this._clearObserverEvent();const{rowHeaderWidthAndMarginLeft,columnHeaderHeightAndMarginTop}=skeleton;0===freezeDirectionType&&(0===this._changeToRow||-1===this._changeToRow)||1===freezeDirectionType&&(0===this._changeToColumn||-1===this._changeToColumn)?(freezeObjectHeaderRect.setProps({fill:this._freezeNormalHeaderColor}),freezeObjectMainRect.setProps({fill:this._freezeNormalMainColor})):(freezeObjectHeaderRect?.setProps({fill:this._freezeNormalHeaderColor}),freezeObjectMainRect?.setProps({fill:this._freezeNormalHeaderColor}));const FREEZE_SIZE=2/Math.max(scene.scaleX,scene.scaleY);0===freezeDirectionType?0!==this._changeToRow&&-1!==this._changeToRow||(freezeObjectHeaderRect.transformByState({top:columnHeaderHeightAndMarginTop-FREEZE_SIZE}),freezeObjectMainRect.transformByState({top:columnHeaderHeightAndMarginTop-FREEZE_SIZE})):0!==this._changeToColumn&&-1!==this._changeToColumn||(freezeObjectHeaderRect.transformByState({left:rowHeaderWidthAndMarginLeft-FREEZE_SIZE}),freezeObjectMainRect.transformByState({left:rowHeaderWidthAndMarginLeft-FREEZE_SIZE}));const sheetViewScroll=this._scrollManagerService.getCurrentScrollState()||{sheetViewStartRow:0,sheetViewStartColumn:0},{sheetViewStartRow,sheetViewStartColumn}=sheetViewScroll;if(null==sheetViewStartColumn||null==sheetViewStartRow)return;const workbook=this._context.unit,worksheet=workbook.getActiveSheet();if(!worksheet)return;const oldFreeze=worksheet.getConfig()?.freeze;let xSplit=oldFreeze?.xSplit||0,ySplit=oldFreeze?.ySplit||0;const viewPortKey=this._activeViewport?.viewportKey;0===freezeDirectionType&&(ySplit=viewPortKey&&viewPortKey!==engine_render_src.p3k.VIEW_LEFT_TOP&&viewPortKey!==engine_render_src.p3k.VIEW_MAIN_LEFT_TOP&&viewPortKey!==engine_render_src.p3k.VIEW_MAIN_TOP&&viewPortKey!==engine_render_src.p3k.VIEW_ROW_TOP?this._changeToRow-sheetViewStartRow:this._changeToRow-(oldFreeze.startRow-oldFreeze.ySplit),ySplit=ySplit<0?0:ySplit),1===freezeDirectionType&&(xSplit=viewPortKey&&viewPortKey!==engine_render_src.p3k.VIEW_LEFT_TOP&&viewPortKey!==engine_render_src.p3k.VIEW_MAIN_LEFT_TOP&&viewPortKey!==engine_render_src.p3k.VIEW_MAIN_LEFT&&viewPortKey!==engine_render_src.p3k.VIEW_COLUMN_LEFT?this._changeToColumn-sheetViewStartColumn:this._changeToColumn-(oldFreeze.startColumn-oldFreeze.xSplit),xSplit=xSplit<0?0:xSplit),this._commandService.executeCommand(sheets_src.UK8.id,{startRow:0===ySplit?-1:this._changeToRow,startColumn:0===xSplit?-1:this._changeToColumn,ySplit,xSplit,unitId:workbook.getUnitId(),subUnitId:worksheet.getSheetId()})}))}_getViewports(){const sheetObject=this._getSheetObject();if(null==sheetObject)return;const{scene}=sheetObject,viewColumnLeft=scene.getViewport(engine_render_src.p3k.VIEW_COLUMN_LEFT),viewColumnRight=scene.getViewport(engine_render_src.p3k.VIEW_COLUMN_RIGHT),viewRowTop=scene.getViewport(engine_render_src.p3k.VIEW_ROW_TOP),viewRowBottom=scene.getViewport(engine_render_src.p3k.VIEW_ROW_BOTTOM),viewLeftTop=scene.getViewport(engine_render_src.p3k.VIEW_LEFT_TOP),viewMain=scene.getViewport(engine_render_src.p3k.VIEW_MAIN),viewMainLeftTop=scene.getViewport(engine_render_src.p3k.VIEW_MAIN_LEFT_TOP),viewMainLeft=scene.getViewport(engine_render_src.p3k.VIEW_MAIN_LEFT),viewMainTop=scene.getViewport(engine_render_src.p3k.VIEW_MAIN_TOP);return null!=viewColumnLeft&&null!=viewColumnRight&&null!=viewRowTop&&null!=viewRowBottom&&null!=viewLeftTop&&null!=viewMain&&null!=viewMainLeftTop&&null!=viewMainLeft&&null!=viewMainTop?{viewMain,viewMainLeftTop,viewMainLeft,viewMainTop,viewColumnLeft,viewColumnRight,viewRowTop,viewRowBottom,viewLeftTop}:void 0}_bindViewportScroll(){const viewports=this._getViewports();if(!viewports)return;const{viewRowBottom,viewColumnRight,viewMainLeft,viewMainTop}=viewports;this.disposeWithMe(this._scrollManagerService.validViewportScrollInfo$.subscribe((param=>{if(!param)return;const{scrollX,scrollY,viewportScrollX,viewportScrollY}=param;viewRowBottom.isActive&&viewRowBottom.updateScrollVal({scrollY,viewportScrollY}),viewColumnRight.isActive&&viewColumnRight.updateScrollVal({scrollX,viewportScrollX}),viewMainLeft.isActive&&viewMainLeft.updateScrollVal({scrollY,viewportScrollY}),viewMainTop.isActive&&viewMainTop.updateScrollVal({scrollX,viewportScrollX})})))}_updateViewport(row=-1,column=-1,ySplit=0,xSplit=0,resetScroll=3){const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(null==skeleton)return;const{rowHeaderWidthAndMarginLeft,columnHeaderHeightAndMarginTop}=skeleton,viewports=this._getViewports();if(!viewports)return;const{viewMain,viewMainLeftTop,viewMainLeft,viewMainTop,viewColumnLeft,viewColumnRight,viewRowTop,viewRowBottom,viewLeftTop}=viewports;viewColumnRight.resizeWhenFreezeChange({left:rowHeaderWidthAndMarginLeft,top:0,height:columnHeaderHeightAndMarginTop+1,right:0}),viewRowBottom.resizeWhenFreezeChange({left:0,top:columnHeaderHeightAndMarginTop,bottom:0,width:rowHeaderWidthAndMarginLeft+1}),viewLeftTop.resizeWhenFreezeChange({left:0,top:0,width:rowHeaderWidthAndMarginLeft+1,height:columnHeaderHeightAndMarginTop});let isTopView=!0,isLeftView=!0;viewMainLeftTop.enable(),-1!==row&&0!==row||(isTopView=!1),-1!==column&&0!==column||(isLeftView=!1);const startSheetView=skeleton.getNoMergeCellWithCoordByIndex(row-ySplit,column-xSplit,!1),endSheetView=skeleton.getNoMergeCellWithCoordByIndex(row,column,!1);if(viewMainLeftTop.disable(),viewMainTop.disable(),viewMainLeft.disable(),viewRowTop.disable(),viewColumnLeft.disable(),viewMainLeftTop.resetPadding(),viewMainTop.resetPadding(),viewMainLeft.resetPadding(),viewRowTop.resetPadding(),viewColumnLeft.resetPadding(),!1===isTopView&&!1===isLeftView)viewMain.resizeWhenFreezeChange({left:rowHeaderWidthAndMarginLeft,top:columnHeaderHeightAndMarginTop,bottom:0,right:0}),viewMain.resetPadding(),viewMainLeft.resizeWhenFreezeChange({left:rowHeaderWidthAndMarginLeft,top:columnHeaderHeightAndMarginTop,bottom:0,width:0}),viewMainTop.resizeWhenFreezeChange({left:rowHeaderWidthAndMarginLeft,top:columnHeaderHeightAndMarginTop,height:0,right:0}),viewMainLeftTop.resizeWhenFreezeChange({left:rowHeaderWidthAndMarginLeft,top:columnHeaderHeightAndMarginTop,width:0,height:0}),viewRowTop.resizeWhenFreezeChange({left:0,top:columnHeaderHeightAndMarginTop,width:rowHeaderWidthAndMarginLeft+1,height:0}),viewColumnLeft.resizeWhenFreezeChange({left:0,top:0,height:columnHeaderHeightAndMarginTop+1,width:0});else if(!0===isTopView&&!1===isLeftView){const topGap=endSheetView.startY-startSheetView.startY;viewMain.resizeWhenFreezeChange({left:rowHeaderWidthAndMarginLeft,top:columnHeaderHeightAndMarginTop+topGap,bottom:0,right:0}),viewMain.setPadding({startY:startSheetView.startY,endY:endSheetView.startY,startX:0,endX:0}),2&resetScroll&&this._commandService.executeCommand(ScrollCommand.id,{sheetViewStartRow:0,offsetY:0}),viewMainTop.resizeWhenFreezeChange({left:rowHeaderWidthAndMarginLeft,top:columnHeaderHeightAndMarginTop,height:topGap,right:0}),viewMainTop.updateScrollVal({viewportScrollY:startSheetView.startY,rawScrollX:viewMain.scrollX,viewportScrollX:viewMain.viewportScrollX}),viewRowTop.resizeWhenFreezeChange({left:0,top:columnHeaderHeightAndMarginTop,width:rowHeaderWidthAndMarginLeft+1,height:topGap}),viewRowTop.updateScrollVal({viewportScrollY:startSheetView.startY}),viewRowBottom.resizeWhenFreezeChange({left:0,top:columnHeaderHeightAndMarginTop+topGap,bottom:0,width:rowHeaderWidthAndMarginLeft+1}),viewMainTop.enable(),viewRowTop.enable()}else if(!1===isTopView&&!0===isLeftView){const leftGap=endSheetView.startX-startSheetView.startX;viewMain.resizeWhenFreezeChange({left:rowHeaderWidthAndMarginLeft+leftGap,top:columnHeaderHeightAndMarginTop,bottom:0,right:0}),viewMain.setPadding({startX:startSheetView.startX,endX:endSheetView.startX,startY:0,endY:0}),1&resetScroll&&this._commandService.executeCommand(ScrollCommand.id,{sheetViewStartColumn:0,offsetX:0}),viewMainLeft.resizeWhenFreezeChange({left:rowHeaderWidthAndMarginLeft,top:columnHeaderHeightAndMarginTop,width:leftGap,bottom:0,right:0}),viewMainLeft.updateScrollVal({viewportScrollX:startSheetView.startX,rawScrollY:viewMain.scrollY,viewportScrollY:viewMain.viewportScrollY}),viewColumnLeft.resizeWhenFreezeChange({left:rowHeaderWidthAndMarginLeft,top:0,width:leftGap,height:columnHeaderHeightAndMarginTop+1}),viewColumnLeft.updateScrollVal({viewportScrollX:startSheetView.startX}),viewColumnRight.resizeWhenFreezeChange({left:rowHeaderWidthAndMarginLeft+leftGap,top:0,height:columnHeaderHeightAndMarginTop+1,right:0}),viewMainLeft.enable(),viewColumnLeft.enable()}else{const leftGap=endSheetView.startX-startSheetView.startX,topGap=endSheetView.startY-startSheetView.startY;viewMain.resizeWhenFreezeChange({left:rowHeaderWidthAndMarginLeft+leftGap,top:columnHeaderHeightAndMarginTop+topGap,bottom:0,right:0}),viewMain.setPadding({startY:startSheetView.startY,endY:endSheetView.startY,startX:startSheetView.startX,endX:endSheetView.startX}),resetScroll&&this._commandService.executeCommand(ScrollCommand.id,{...1&resetScroll?{sheetViewStartColumn:0,offsetX:0}:null,...2&resetScroll?{sheetViewStartRow:0,offsetY:0}:null}),viewMainLeft.resizeWhenFreezeChange({left:rowHeaderWidthAndMarginLeft,top:columnHeaderHeightAndMarginTop+topGap,width:leftGap,bottom:0}),viewMainLeft.updateScrollVal({viewportScrollX:startSheetView.startX,rawScrollY:viewMain.scrollY,viewportScrollY:viewMain.viewportScrollY}),viewMainTop.resizeWhenFreezeChange({left:rowHeaderWidthAndMarginLeft+leftGap,top:columnHeaderHeightAndMarginTop,height:topGap,right:0}),viewMainTop.updateScrollVal({viewportScrollY:startSheetView.startY,rawScrollX:viewMain.scrollX,viewportScrollX:viewMain.viewportScrollX}),viewMainLeftTop.resizeWhenFreezeChange({left:rowHeaderWidthAndMarginLeft,top:columnHeaderHeightAndMarginTop,width:leftGap,height:topGap}),viewMainLeftTop.updateScrollVal({viewportScrollX:startSheetView.startX,viewportScrollY:startSheetView.startY}),viewRowTop.resizeWhenFreezeChange({left:0,top:columnHeaderHeightAndMarginTop,width:rowHeaderWidthAndMarginLeft+1,height:topGap}),viewRowTop.updateScrollVal({viewportScrollY:startSheetView.startY}),viewRowBottom.resizeWhenFreezeChange({left:0,top:columnHeaderHeightAndMarginTop+topGap,bottom:0,width:rowHeaderWidthAndMarginLeft+1}),viewColumnLeft.resizeWhenFreezeChange({left:rowHeaderWidthAndMarginLeft,top:0,width:leftGap,height:columnHeaderHeightAndMarginTop+1}),viewColumnLeft.updateScrollVal({viewportScrollX:startSheetView.startX}),viewColumnRight.resizeWhenFreezeChange({left:rowHeaderWidthAndMarginLeft+leftGap,top:0,height:columnHeaderHeightAndMarginTop+1,right:0}),viewMainLeftTop.enable(),viewMainTop.enable(),viewMainLeft.enable(),viewRowTop.enable(),viewColumnLeft.enable()}}_skeletonListener(){this.disposeWithMe((0,src.saO)(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((param=>{[sheets_src._M5.id,sheets_src.H7i.id,sheets_src.TKH.id].includes(param?.commandId||"")&&this._refreshCurrent()}))))}_refreshCurrent(){const worksheet=this._context.unit.getActiveSheet();if(!worksheet)return;const freeze=worksheet.getConfig().freeze,{startRow=-1,startColumn=-1,ySplit=0,xSplit=0}=freeze;this._refreshFreeze(startRow,startColumn,ySplit,xSplit,0)}_themeChangeListener(){this._themeChange(this._themeService.getCurrentTheme()),this.disposeWithMe(this._themeService.currentTheme$.subscribe((style=>{this._clearFreeze(),this._themeChange(style),this._refreshCurrent()})))}_themeChange(style){this._freezeNormalHeaderColor=style.grey400,this._freezeNormalMainColor=new src.mKL(style.grey400).setAlpha(.01).toRgbString(),this._freezeActiveColor=style.primaryColor,this._freezeHoverColor=style.grey500}_interceptorCommands(){this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations:command=>{const empty={redos:[],undos:[]},freeze=this._getFreeze();if(!freeze)return empty;const createFreezeMutationAndRefresh=newFreeze=>{const workbook=this._context.unit,unitId=workbook.getUnitId(),worksheet=workbook.getActiveSheet();if(!worksheet)return empty;const subUnitId=worksheet.getSheetId();this._refreshFreeze(newFreeze.startRow,newFreeze.startColumn,newFreeze.ySplit,newFreeze.xSplit,0);const redoMutationParams={...newFreeze,unitId,subUnitId,resetScroll:!1},undoMutationParams=(0,sheets_src.kJ6)(this._injector,redoMutationParams);return{undos:[{id:sheets_src.MOW.id,params:undoMutationParams}],redos:[{id:sheets_src.MOW.id,params:redoMutationParams}]}};if(command.id===sheets_src.$h8.id){const params=command.params,{range,direction}=params,insertCount=range.endRow-range.startRow+1;if(range.startRow+1<freeze.startRow||range.startRow+1===freeze.startRow&&direction===src.OP3.UP){return createFreezeMutationAndRefresh({...freeze,startRow:Math.max(1,freeze.startRow+insertCount),ySplit:Math.max(1,freeze.ySplit+insertCount)})}}if(command.id===sheets_src.Xuv.id){const params=command.params,{range,direction}=params,insertCount=range.endColumn-range.startColumn+1;if(range.startColumn+1<freeze.startColumn||range.startColumn+1===freeze.startColumn&&direction===src.OP3.LEFT){return createFreezeMutationAndRefresh({...freeze,startColumn:Math.max(1,freeze.startColumn+insertCount),xSplit:Math.max(1,freeze.xSplit+insertCount)})}}if(command.id===sheets_src.GU8.id){const selections=this._selectionManagerService.getCurrentSelections(),{fromRange:{startColumn:fromCol},toRange:{startColumn:toCol}}=command.params,filteredSelections=selections?.filter((selection=>selection.range.rangeType===src.$uV.COLUMN&&selection.range.startColumn<=fromCol&&fromCol<=selection.range.endColumn));if(!filteredSelections?.length)return empty;const sourceRange=filteredSelections[0].range,targetRange={...sourceRange,startColumn:toCol,endColumn:toCol+sourceRange.endColumn-sourceRange.startColumn};if(!freeze||freeze.startColumn<=0||sourceRange.startColumn>=freeze.startColumn&&targetRange.startColumn>=freeze.startColumn||sourceRange.startColumn===targetRange.startColumn||sourceRange.endColumn<freeze.startColumn&&targetRange.startColumn<freeze.startColumn)return empty;const totalColCount=sourceRange.endColumn-sourceRange.startColumn+1,moveFreezeColCount=Math.max(Math.min(freeze.startColumn,sourceRange.endColumn+1)-sourceRange.startColumn,0);let newStartColumn,newXSplit;targetRange.startColumn>=freeze.startColumn?(newStartColumn=Math.max(freeze.startColumn-moveFreezeColCount,1),newXSplit=Math.max(freeze.xSplit-moveFreezeColCount,1)):(newStartColumn=freeze.startColumn+totalColCount-moveFreezeColCount,newXSplit=freeze.xSplit+totalColCount-moveFreezeColCount);return createFreezeMutationAndRefresh({...freeze,startColumn:newStartColumn,xSplit:newXSplit})}if(command.id===sheets_src.wAI.id){const selections=this._selectionManagerService.getCurrentSelections(),{fromRange:{startRow:fromRow},toRange:{startRow:toRow}}=command.params,filteredSelections=selections?.filter((selection=>selection.range.rangeType===src.$uV.ROW&&selection.range.startRow<=fromRow&&fromRow<=selection.range.endRow));if(!filteredSelections?.length)return empty;const sourceRange=filteredSelections[0].range,targetRange={...sourceRange,startRow:toRow,endRow:toRow+sourceRange.endRow-sourceRange.startRow};if(!freeze||freeze.startRow<=0||sourceRange.startRow>=freeze.startRow&&targetRange.startRow>=freeze.startRow||sourceRange.startRow===targetRange.startRow||sourceRange.endRow<freeze.startRow&&targetRange.startRow<freeze.startRow)return empty;const totalColCount=sourceRange.endRow-sourceRange.startRow+1,moveFreezeColCount=Math.max(Math.min(freeze.startRow,sourceRange.endRow+1)-sourceRange.startRow,0);let newStartRow,newYSplit;targetRange.startRow>=freeze.startRow?(newStartRow=Math.max(freeze.startRow-moveFreezeColCount,1),newYSplit=Math.max(freeze.ySplit-moveFreezeColCount,1)):(newStartRow=freeze.startRow+totalColCount-moveFreezeColCount,newYSplit=freeze.ySplit+totalColCount-moveFreezeColCount);return createFreezeMutationAndRefresh({...freeze,startRow:newStartRow,ySplit:newYSplit})}if(command.id===sheets_src.G7y.id||command.id===sheets_src.UJ9.id){const params=command.params,range=params.range;if(range.rangeType===src.$uV.COLUMN&&range.startColumn<freeze.startColumn){const deleteFreezeColCount=Math.min(freeze.startColumn,range.endColumn+1)-range.startColumn;return createFreezeMutationAndRefresh({...freeze,startColumn:Math.max(1,freeze.startColumn-deleteFreezeColCount),xSplit:Math.max(1,freeze.xSplit-deleteFreezeColCount)})}if(params.range.rangeType===src.$uV.ROW&&range.startRow<freeze.startRow){const deleteFreezeRowCount=Math.min(freeze.startRow,range.endRow+1)-range.startRow;return createFreezeMutationAndRefresh({...freeze,startRow:Math.max(1,freeze.startRow-deleteFreezeRowCount),ySplit:Math.max(1,freeze.ySplit-deleteFreezeRowCount)})}}return empty}}))}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted((command=>{switch(command.id){case sheets_src.MOW.id:case SetZoomRatioOperation.id:{const lastFreeze=this._lastFreeze,workbook=this._context.unit,worksheet=workbook.getActiveSheet(),params=command.params,{unitId,subUnitId}=params;if(unitId!==workbook.getUnitId()||subUnitId!==worksheet?.getSheetId())return;const freeze=worksheet.getConfig().freeze;if(this._lastFreeze=freeze,null==freeze)return;let resetScroll=0;const{startRow=-1,startColumn=-1,ySplit=0,xSplit=0}=freeze;lastFreeze&&lastFreeze.startRow===startRow&&lastFreeze.ySplit===ySplit||(resetScroll|=2),lastFreeze&&lastFreeze.startColumn===startColumn&&lastFreeze.xSplit===xSplit||(resetScroll|=1),!1===params.resetScroll&&(resetScroll=0),this._refreshFreeze(startRow,startColumn,ySplit,xSplit,resetScroll)}break;case sheets_src.BtL.id:{const freeze=this._getFreeze(),isRefresh=freeze&&command.params.ranges.some((i=>i.startRow<freeze.startRow));command.params&&isRefresh&&this._refreshCurrent()}break;case sheets_src.Cay.id:{const freeze=this._getFreeze();command.params&&freeze&&command.params.ranges.some((i=>i.startColumn<freeze.startColumn))&&this._refreshCurrent()}break;case sheets_src.wXn.id:{const params=command.params,freeze=this._getFreeze();if(freeze&&freeze.startRow>-1&&params.rowsAutoHeightInfo.some((info=>info.row<freeze.startRow))){const subscription=this._sheetSkeletonManagerService.currentSkeleton$.subscribe((()=>{this._refreshCurrent(),setTimeout((()=>{subscription.unsubscribe()}))}))}}break;case sheets_src.q4N.id:case sheets_src.Sys.id:{const params=command.params,freeze=this._getFreeze(),ranges=params.ranges;freeze&&freeze.startColumn>-1&&ranges.some((range=>range.startColumn<freeze.startColumn))&&this._refreshCurrent()}break;case sheets_src.avX.id:case sheets_src.QAK.id:{const params=command.params,freeze=this._getFreeze(),ranges=params.ranges;freeze&&freeze.startRow>-1&&ranges.some((range=>range.startRow<freeze.startRow))&&this._refreshCurrent()}break;case SetRowHeaderWidthCommand.id:case SetColumnHeaderHeightCommand.id:this._refreshCurrent()}})))}_zoomRefresh(){const sheetObject=this._getSheetObject();if(null==sheetObject)return;const{scene}=sheetObject;this.disposeWithMe(scene.onTransformChange$.subscribeEvent((state=>{[engine_render_src.FAP.scale,engine_render_src.FAP.all].includes(state.type)&&this._refreshCurrent()})))}_clearObserverEvent(){null!=this._getSheetObject()&&(this._scenePointerMoveSub?.unsubscribe(),this._scenePointerUpSub?.unsubscribe(),this._scenePointerMoveSub=null,this._scenePointerUpSub=null)}_clearFreeze(){this._rowFreezeHeaderRect?.dispose(),this._rowFreezeMainRect?.dispose(),this._columnFreezeHeaderRect?.dispose(),this._columnFreezeMainRect?.dispose();null!=this._getSheetObject()&&([this._freezeDownSubs,this._freezePointerEnterSubs,this._freezePointerLeaveSubs].forEach((s=>{s?.unsubscribe()})),this._freezeDownSubs=null,this._freezePointerEnterSubs=null,this._freezePointerLeaveSubs=null,this._scenePointerMoveSub?.unsubscribe(),this._scenePointerUpSub?.unsubscribe(),this._scenePointerMoveSub=null,this._scenePointerUpSub=null)}_getPositionByIndex(row,column){if(null==this._getSheetObject())return;const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton,position=skeleton?.getNoMergeCellWithCoordByIndex(row,column);if(null==skeleton)return;if(!(null==position||isNaN(position.endX)&&isNaN(position.endY)))return position;const{rowHeaderWidthAndMarginLeft,columnHeaderHeightAndMarginTop}=skeleton;return{startX:rowHeaderWidthAndMarginLeft,endX:rowHeaderWidthAndMarginLeft,startY:columnHeaderHeightAndMarginTop,endY:columnHeaderHeightAndMarginTop}}_getFreeze(){const config=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton.getWorksheetConfig();if(null!=config)return config.freeze}_getSheetObject(){return getSheetObject(this._context.unit,this._context)}_refreshFreeze(startRow,startColumn,ySplit,xSplit,resetScroll){const newFreeze={startRow,startColumn,ySplit,xSplit};this._clearFreeze(),this._createFreeze(0,newFreeze),this._createFreeze(1,newFreeze),this._updateViewport(startRow,startColumn,ySplit,xSplit,resetScroll),this._getSheetObject()?.spreadsheet.makeForceDirty()}}function isThisRowSelected(selections,rowIndex){return!!matchedSelectionByRowColIndex(selections,rowIndex,src.$uV.ROW)}function isThisColSelected(selections,colIndex){return!!matchedSelectionByRowColIndex(selections,colIndex,src.$uV.COLUMN)}function matchedSelectionByRowColIndex(selections,indexOfRowCol,rowOrCol){return selections.find((sel=>{const range=sel.range,{startRow:startRowOfCurrSel,endRow:endRowOfCurrSel,startColumn:startColumnOfCurrSel,endColumn:endColumnOfCurrSel,rangeType:rangeTypeOfCurrSelection}=range;if(rangeTypeOfCurrSelection===src.$uV.ALL||rangeTypeOfCurrSelection===src.$uV.NORMAL)return!1;if(rangeTypeOfCurrSelection===rowOrCol){if(rowOrCol===src.$uV.COLUMN&&startColumnOfCurrSel<=indexOfRowCol&&indexOfRowCol<=endColumnOfCurrSel)return!0;if(rowOrCol===src.$uV.ROW&&startRowOfCurrSel<=indexOfRowCol&&indexOfRowCol<=endRowOfCurrSel)return!0}return!1}))}function header_move_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function header_move_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}HeaderFreezeRenderController=function freeze_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([freeze_render_controller_ts_param(1,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),freeze_render_controller_ts_param(2,src.wTY),freeze_render_controller_ts_param(3,(0,src.y_5)(sheets_src.Fal)),freeze_render_controller_ts_param(4,(0,src.y_5)(SheetScrollManagerService)),freeze_render_controller_ts_param(5,(0,src.y_5)(src.Fsb)),freeze_render_controller_ts_param(6,(0,src.y_5)(sheets_src.e5R)),freeze_render_controller_ts_param(7,(0,src.y_5)(src.zZn)),freeze_render_controller_ts_metadata("design:type",Function),freeze_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService,void 0===src.wTY?Object:src.wTY,void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===SheetScrollManagerService?Object:SheetScrollManagerService,void 0===src.Fsb?Object:src.Fsb,void 0===sheets_src.e5R?Object:sheets_src.e5R,void 0===src.zZn?Object:src.zZn])],HeaderFreezeRenderController);const HEADER_MOVE_PERMISSION_CHECK=(0,src.nwg)("headerMovePermissionCheck");class HeaderMoveRenderController extends src.jGt{constructor(_context,selectionManagerService,_sheetSkeletonManagerService,_commandService){super(),this._context=_context,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._commandService=_commandService,this._startOffsetX=Number.NEGATIVE_INFINITY,this._startOffsetY=Number.NEGATIVE_INFINITY,this._changeFromColumn=-1,this._changeFromRow=-1,this._changeToColumn=-1,this._changeToRow=-1,this.interceptor=new src.vY4({HEADER_MOVE_PERMISSION_CHECK}),this._workbookSelections=selectionManagerService.getWorkbookSelections(this._context.unitId),this._init()}dispose(){this._moveHelperBackgroundShape?.dispose(),this._moveHelperLineShape?.dispose(),this._headerPointerMoveSubs?.unsubscribe(),this._headerPointerLeaveSubs?.unsubscribe(),this._headerPointerDownSubs?.unsubscribe(),this._headerPointerMoveSubs=null,this._headerPointerLeaveSubs=null,this._headerPointerDownSubs=null,this._dragHeaderMoveSub?.unsubscribe(),this._scenePointerUpSub?.unsubscribe(),this._dragHeaderMoveSub=null,this._scenePointerUpSub=null,this._scrollTimer?.dispose()}_init(){this._initialRowOrColumn(src.$uV.ROW),this._initialRowOrColumn(src.$uV.COLUMN)}_initialRowOrColumn(initialType=src.$uV.ROW){const spreadsheetColumnHeader=this._context.components.get(SHEET_VIEW_KEY.COLUMN),spreadsheetRowHeader=this._context.components.get(SHEET_VIEW_KEY.ROW),scene=this._context.scene,eventBindingObject=initialType===src.$uV.ROW?spreadsheetRowHeader:spreadsheetColumnHeader;this._headerPointerMoveSubs=new Subscription.yU,this._headerPointerMoveSubs.add(eventBindingObject.onPointerMove$.subscribeEvent((evt=>{const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(null==skeleton)return;const selectionRange=this._workbookSelections.getCurrentLastSelection()?.range;if(!selectionRange)return;if(!this.interceptor.fetchThroughInterceptors(HEADER_MOVE_PERMISSION_CHECK)(!1,selectionRange))return;const currentSelections=this._workbookSelections.getCurrentSelections(),{row,column}=getCoordByOffset(evt.offsetX,evt.offsetY,scene,skeleton);matchedSelectionByRowColIndex(currentSelections,initialType===src.$uV.ROW?row:column,initialType)?scene.setCursor(engine_render_src.MBo.GRAB):scene.resetCursor()}))),this._headerPointerLeaveSubs=new Subscription.yU,this._headerPointerLeaveSubs.add(eventBindingObject?.onPointerLeave$.subscribeEvent((()=>{this._moveHelperBackgroundShape?.hide(),this._moveHelperLineShape?.hide(),scene.resetCursor()}))),this._headerPointerDownSubs=new Subscription.yU,this._headerPointerDownSubs.add(eventBindingObject?.onPointerDown$.subscribeEvent(((evt,state)=>{if(state.isStopPropagation)return;const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(null==skeleton)return;const selectionRange=this._workbookSelections.getCurrentLastSelection()?.range;if(!selectionRange)return;if(!this.interceptor.fetchThroughInterceptors(HEADER_MOVE_PERMISSION_CHECK)(!1,selectionRange))return;const{offsetX:evtOffsetX,offsetY:evtOffsetY}=evt,relativeCoords=scene.getCoordRelativeToViewport(engine_render_src.I9Y.FromArray([evtOffsetX,evtOffsetY])),{x:newEvtOffsetX,y:newEvtOffsetY}=relativeCoords;this._startOffsetX=newEvtOffsetX,this._startOffsetY=newEvtOffsetY;const{row,column}=getCoordByOffset(evt.offsetX,evt.offsetY,scene,skeleton);let scrollType;initialType===src.$uV.ROW?(this._changeFromRow=row,scrollType=engine_render_src.rDM.Y):(this._changeFromColumn=column,scrollType=engine_render_src.rDM.X);const matchSelectionData=matchedSelectionByRowColIndex(this._workbookSelections.getCurrentSelections(),initialType===src.$uV.ROW?row:column,initialType);if(!matchSelectionData)return;const startScrollXY=scene.getScrollXYInfoByViewport(engine_render_src.I9Y.FromArray([this._startOffsetX,this._startOffsetY]));this._newBackgroundAndLine(),scene.setCursor(engine_render_src.MBo.GRABBING),scene.disableObjectsEvent();let scrollTimer,scrollTimerInitd=!1;const initScrollTimer=()=>{if(scrollTimerInitd)return;scrollTimer=engine_render_src.Vui.create(scene,scrollType),this._scrollTimer=scrollTimer;const mainViewport=scene.getViewport(engine_render_src.p3k.VIEW_MAIN);scrollTimer.startScroll(newEvtOffsetX,newEvtOffsetY,mainViewport),scrollTimerInitd=!0};this._dragHeaderMoveSub=scene.onPointerMove$.subscribeEvent((moveEvt=>{initScrollTimer();const{offsetX:moveOffsetX,offsetY:moveOffsetY}=moveEvt,{x:newMoveOffsetX,y:newMoveOffsetY}=scene.getCoordRelativeToViewport(engine_render_src.I9Y.FromArray([moveOffsetX,moveOffsetY]));this._rowColumnMoving(newMoveOffsetX,newMoveOffsetY,matchSelectionData,startScrollXY,initialType),scrollTimer.scrolling(newMoveOffsetX,newMoveOffsetY,(()=>{this._rowColumnMoving(newMoveOffsetX,newMoveOffsetY,matchSelectionData,startScrollXY,initialType)}))})),this._scenePointerUpSub=scene.onPointerUp$.subscribeEvent((()=>{this._disposeBackgroundAndLine(),scene.resetCursor(),scene.enableObjectsEvent(),this._clearObserverEvent(),this._scrollTimer?.dispose();const selections=this._workbookSelections.getCurrentSelections();if(initialType===src.$uV.ROW){if(this._changeFromRow!==this._changeToRow&&-1!==this._changeToRow){const filteredSelections=selections?.filter((selection=>selection.range.rangeType===src.$uV.ROW&&selection.range.startRow<=this._changeFromRow&&this._changeFromRow<=selection.range.endRow))||[],range=filteredSelections[0]?.range;range&&this._commandService.executeCommand(sheets_src.wAI.id,{fromRange:range,toRange:{...range,startRow:this._changeToRow,endRow:this._changeToRow+range.endRow-range.startRow}})}this._changeToRow=this._changeFromRow=-1}else{if(this._changeFromColumn!==this._changeToColumn&&-1!==this._changeToColumn){const filteredSelections=selections?.filter((selection=>selection.range.rangeType===src.$uV.COLUMN&&selection.range.startColumn<=this._changeFromColumn&&this._changeFromColumn<=selection.range.endColumn))||[],range=filteredSelections[0]?.range;range&&this._commandService.executeCommand(sheets_src.GU8.id,{fromRange:range,toRange:{...range,startColumn:this._changeToColumn,endColumn:this._changeToColumn+range.endColumn-range.startColumn}})}this._changeToColumn=this._changeFromColumn=-1}}))})))}_rowColumnMoving(moveOffsetX,moveOffsetY,matchSelectionData,startScrollXY,initialType){const scene=this._context.scene,skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(null==skeleton)return;const{rowHeaderWidth,columnHeaderHeight,rowTotalHeight,columnTotalWidth}=skeleton,scrollXY=scene.getViewportScrollXY(scene.getViewport(engine_render_src.p3k.VIEW_MAIN)),{scaleX,scaleY}=scene.getAncestorScale(),moveActualSelection=skeleton.getCellIndexByOffset(moveOffsetX,moveOffsetY,scaleX,scaleY,scrollXY),{row,column}=moveActualSelection,startCell=skeleton.getNoMergeCellWithCoordByIndex(row,column),{startX:cellStartX,startY:cellStartY,endX:cellEndX,endY:cellEndY}=startCell,selectionWithCoord=this._sheetSkeletonManagerService.attachRangeWithCoord(matchSelectionData.range);if(null==selectionWithCoord)return;const scale=Math.max(scaleX,scaleX),{startX:selectedStartX,endX:selectedEndX,startY:selectedStartY,endY:selectedEndY,startRow:selectedStartRow,startColumn:selectedStartColumn,endRow:selectedEndRow,endColumn:selectedEndColumn}=selectionWithCoord;initialType===src.$uV.ROW?this._moveHelperBackgroundShape?.transformByState({height:selectedEndY-selectedStartY,width:columnTotalWidth+rowHeaderWidth,left:0,top:selectedStartY+(moveOffsetY-this._startOffsetY)/scale+scrollXY.y-startScrollXY.y}):this._moveHelperBackgroundShape?.transformByState({height:rowTotalHeight+columnHeaderHeight,width:selectedEndX-selectedStartX,left:selectedStartX+(moveOffsetX-this._startOffsetX)/scale+scrollXY.x-startScrollXY.x,top:0}),this._moveHelperBackgroundShape?.show();const HEADER_MOVE_CONTROLLER_LINE_SIZE_SCALE=4/scale;if(initialType===src.$uV.ROW){let top=0;if(row<=selectedStartRow)top=cellStartY-HEADER_MOVE_CONTROLLER_LINE_SIZE_SCALE/2,this._changeToRow=row;else{if(!(row>selectedEndRow))return;top=cellEndY-HEADER_MOVE_CONTROLLER_LINE_SIZE_SCALE/2,this._changeToRow=row+1}this._moveHelperLineShape?.transformByState({height:HEADER_MOVE_CONTROLLER_LINE_SIZE_SCALE,width:columnTotalWidth,left:rowHeaderWidth,top})}else{let left=0;if(column<=selectedStartColumn)left=cellStartX-HEADER_MOVE_CONTROLLER_LINE_SIZE_SCALE/2,this._changeToColumn=column;else{if(!(column>selectedEndColumn))return;left=cellEndX-HEADER_MOVE_CONTROLLER_LINE_SIZE_SCALE/2,this._changeToColumn=column+1}this._moveHelperLineShape?.transformByState({height:rowTotalHeight,width:HEADER_MOVE_CONTROLLER_LINE_SIZE_SCALE,left,top:columnHeaderHeight})}this._moveHelperLineShape?.show()}_clearObserverEvent(){this._dragHeaderMoveSub?.unsubscribe(),this._scenePointerUpSub?.unsubscribe(),this._dragHeaderMoveSub=null,this._scenePointerUpSub=null}_newBackgroundAndLine(){const scene=this._context.scene;this._moveHelperBackgroundShape=new engine_render_src.rwV("__SpreadsheetHeaderMoveControllerBackground__",{fill:"rgba(0, 0, 0, 0.1)",evented:!1,zIndex:100}),this._moveHelperLineShape=new engine_render_src.rwV("__SpreadsheetHeaderMoveControllerShapeLine__",{fill:"rgb(119, 119, 119)",evented:!1,zIndex:100}),scene.addObjects([this._moveHelperBackgroundShape,this._moveHelperLineShape],10)}_disposeBackgroundAndLine(){this._moveHelperBackgroundShape?.dispose(),this._moveHelperLineShape?.dispose()}}HeaderMoveRenderController=function header_move_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([header_move_render_controller_ts_param(1,(0,src.y_5)(sheets_src.Fal)),header_move_render_controller_ts_param(2,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),header_move_render_controller_ts_param(3,src.wTY),header_move_render_controller_ts_metadata("design:type",Function),header_move_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService,void 0===src.wTY?Object:src.wTY])],HeaderMoveRenderController);var HEADER_RESIZE_SHAPE_TYPE=function(HEADER_RESIZE_SHAPE_TYPE){return HEADER_RESIZE_SHAPE_TYPE[HEADER_RESIZE_SHAPE_TYPE.VERTICAL=0]="VERTICAL",HEADER_RESIZE_SHAPE_TYPE[HEADER_RESIZE_SHAPE_TYPE.HORIZONTAL=1]="HORIZONTAL",HEADER_RESIZE_SHAPE_TYPE}({});class HeaderMenuResizeShape extends engine_render_src.ypk{constructor(key,props){super(key,props),this._size=12,this._color="rgb(68, 71, 70)",this._mode=0,this.setShapeProps(props)}get size(){return this._size}get mode(){return this._mode}get color(){return this._color}_draw(ctx){const scene=this.getScene();if(!scene)return;const{scaleX,scaleY}=scene.getAncestorScale(),scale=Math.max(scaleX,scaleY),HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE=12/scale,HEADER_MENU_SHAPE_THUMB_SIZE_SCALE=4/scale;let{width,height}=this,left=0,top=0;0===this.mode?(width=HEADER_MENU_SHAPE_THUMB_SIZE_SCALE,left=HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE-HEADER_MENU_SHAPE_THUMB_SIZE_SCALE):(height=HEADER_MENU_SHAPE_THUMB_SIZE_SCALE,top=HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE-HEADER_MENU_SHAPE_THUMB_SIZE_SCALE),engine_render_src.rwV.drawWith(ctx,{width:this.width,height:this.height,left:0,top:0,fill:"rgba(120, 120, 120, 0.01)"}),engine_render_src.rwV.drawWith(ctx,{width,height,fill:"rgb(68, 71, 70)",radius:HEADER_MENU_SHAPE_THUMB_SIZE_SCALE}),ctx.save(),ctx.transform(1,0,0,1,left,top),engine_render_src.rwV.drawWith(ctx,{width,height,fill:"rgb(68, 71, 70)",radius:HEADER_MENU_SHAPE_THUMB_SIZE_SCALE}),ctx.restore()}setShapeProps(props){return props?.size&&(this._size=props.size),props?.mode&&(this._mode=props.mode),props?.color&&(this._color=props.color),0===this.mode?this.transformByState({width:12,height:this.size}):this.transformByState({width:this.size,height:12}),this}}function header_resize_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function header_resize_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}const HEADER_RESIZE_PERMISSION_CHECK=(0,src.nwg)("headerResizePermissionCheck");class HeaderResizeRenderController extends src.jGt{constructor(_context,_sheetSkeletonManagerService,_selectionManagerService,_commandService){super(),this._context=_context,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._selectionManagerService=_selectionManagerService,this._commandService=_commandService,this._currentRow=0,this._currentColumn=0,this._startOffsetX=Number.POSITIVE_INFINITY,this._startOffsetY=Number.POSITIVE_INFINITY,this.interceptor=new src.vY4({HEADER_RESIZE_PERMISSION_CHECK}),this._init()}dispose(){this._rowResizeRect?.dispose(),this._rowResizeRect=null,this._columnResizeRect?.dispose(),this._columnResizeRect=null,this._headerPointerSubs?.unsubscribe(),this._headerPointerSubs=null}_init(){const scene=this._context.scene;this._rowResizeRect=new HeaderMenuResizeShape("__SpreadsheetHeaderResizeControllerShapeRow__",{visible:!1,mode:HEADER_RESIZE_SHAPE_TYPE.HORIZONTAL,zIndex:100}),this._columnResizeRect=new HeaderMenuResizeShape("__SpreadsheetHeaderResizeControllerShapeColumn__",{visible:!1,mode:HEADER_RESIZE_SHAPE_TYPE.VERTICAL,zIndex:100}),scene.addObjects([this._rowResizeRect,this._columnResizeRect],10),this._initialHover(0),this._initialHover(1),this._initialHoverResize(0),this._initialHoverResize(1)}_initialHover(initialType=0){const spreadsheetColumnHeader=this._context.components.get(SHEET_VIEW_KEY.COLUMN),spreadsheetRowHeader=this._context.components.get(SHEET_VIEW_KEY.ROW),scene=this._context.scene,eventBindingObject=0===initialType?spreadsheetRowHeader:spreadsheetColumnHeader;this._headerPointerSubs=new Subscription.yU,this._headerPointerSubs.add(eventBindingObject?.onPointerMove$.subscribeEvent(((evt,_state)=>{const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(null==skeleton||null==this._rowResizeRect||null==this._columnResizeRect)return;const{rowHeaderWidth,columnHeaderHeight}=skeleton,{startX,startY,endX,endY,row,column}=getCoordByOffset(evt.offsetX,evt.offsetY,scene,skeleton),transformCoord=getTransformCoord(evt.offsetX,evt.offsetY,scene),{scaleX,scaleY}=scene.getAncestorScale(),HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE=12/Math.max(scaleX,scaleY);if(0===initialType){let top=startY-HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE/2;if(transformCoord.y<=startY+HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE/2&&transformCoord.y>=startY)this._currentRow=row-1;else{if(!(transformCoord.y>=endY-HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE/2&&transformCoord.y<=endY))return void this._rowResizeRect.hide();this._currentRow=row,top=endY-HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE/2}if(-1===this._currentRow)return;if(!this.interceptor.fetchThroughInterceptors(HEADER_RESIZE_PERMISSION_CHECK)(null,{row:this._currentRow}))return!1;const rowSize=Math.min(44,rowHeaderWidth/3);this._rowResizeRect.transformByState({left:rowHeaderWidth/2-rowSize/2,top}),this._rowResizeRect.setShapeProps({size:rowSize}),this._rowResizeRect.show()}else{let left=startX-HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE/2;if(transformCoord.x<=startX+HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE/2&&transformCoord.x>=startX)this._currentColumn=column-1;else{if(!(transformCoord.x>=endX-HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE/2&&transformCoord.x<=endX))return void this._columnResizeRect.hide();this._currentColumn=column,left=endX-HEADER_MENU_SHAPE_WIDTH_HEIGHT_SCALE/2}if(-1===this._currentColumn)return;if(!this.interceptor.fetchThroughInterceptors(HEADER_RESIZE_PERMISSION_CHECK)(null,{col:this._currentColumn}))return!1;const columnSize=.7*columnHeaderHeight;this._columnResizeRect.transformByState({left,top:columnHeaderHeight/2-columnSize/2}),this._columnResizeRect.setShapeProps({size:columnSize}),this._columnResizeRect.show()}}))),this._headerPointerSubs.add(eventBindingObject?.onPointerLeave$.subscribeEvent(((_evt,_state)=>{this._rowResizeRect?.hide(),this._columnResizeRect?.hide()})))}_initialHoverResize(initialType=0){const scene=this._context.scene,eventBindingObject=0===initialType?this._rowResizeRect:this._columnResizeRect;null!=eventBindingObject&&(this.disposeWithMe(eventBindingObject.onPointerEnter$.subscribeEvent((()=>{null!=eventBindingObject&&(eventBindingObject.show(),scene.setCursor(0===initialType?engine_render_src.MBo.ROW_RESIZE:engine_render_src.MBo.COLUMN_RESIZE))}))),this.disposeWithMe(eventBindingObject.onPointerLeave$.subscribeEvent((()=>{null!=eventBindingObject&&(eventBindingObject.hide(),scene.resetCursor())}))),this.disposeWithMe(eventBindingObject.onPointerDown$.subscribeEvent((evt=>{const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(null==skeleton)return;const scene=this._context.scene,engine=scene.getEngine(),canvasMaxHeight=engine?.height||0,canvasMaxWidth=engine?.width||0,viewPort=scene.getViewport(engine_render_src.p3k.VIEW_MAIN),scrollBarHorizontalHeight=(viewPort?.getScrollBar()?.horizonScrollTrack?.height||0)+10,scrollBarVerticalWidth=(viewPort?.getScrollBar()?.verticalScrollTrack?.width||0)+10,transformCoord=getTransformCoord(evt.offsetX,evt.offsetY,scene),{scaleX,scaleY}=scene.getAncestorScale();this._startOffsetX=transformCoord.x,this._startOffsetY=transformCoord.y;const currentOffsetX=skeleton.getOffsetByColumn(this._currentColumn),currentOffsetY=skeleton.getOffsetByRow(this._currentRow),cell=skeleton.getNoMergeCellWithCoordByIndex(this._currentRow,this._currentColumn);let isStartMove=!1,moveChangeX=0,moveChangeY=0;const{columnTotalWidth,rowHeaderWidth,rowTotalHeight,columnHeaderHeight}=skeleton,shapeWidth=canvasMaxWidth>columnTotalWidth+rowHeaderWidth?canvasMaxWidth:columnTotalWidth+rowHeaderWidth,shapeHeight=canvasMaxHeight>rowTotalHeight+columnHeaderHeight?canvasMaxHeight:rowTotalHeight+columnHeaderHeight,HEADER_MENU_SHAPE_THUMB_SIZE_SCALE=4/Math.max(scaleX,scaleY);this._resizeHelperShape=0===initialType?new engine_render_src.rwV("__SpreadsheetHeaderResizeControllerShapeHelper__",{width:shapeWidth,height:HEADER_MENU_SHAPE_THUMB_SIZE_SCALE,fill:"rgb(199, 199, 199)",left:0,top:currentOffsetY-HEADER_MENU_SHAPE_THUMB_SIZE_SCALE/2}):new engine_render_src.rwV("__SpreadsheetHeaderResizeControllerShapeHelper__",{width:HEADER_MENU_SHAPE_THUMB_SIZE_SCALE,height:shapeHeight,fill:"rgb(199, 199, 199)",left:currentOffsetX-HEADER_MENU_SHAPE_THUMB_SIZE_SCALE/2,top:0});const rowResizeRectX=this._columnResizeRect?.left||0,rowResizeRectY=this._rowResizeRect?.top||0;scene.addObject(this._resizeHelperShape,10),scene.disableObjectsEvent(),this._scenePointerMoveSub=scene.onPointerMove$.subscribeEvent((moveEvt=>{const relativeCoords=scene.getCoordRelativeToViewport(engine_render_src.I9Y.FromArray([this._startOffsetX,this._startOffsetY])),scrollXY=scene.getScrollXYInfoByViewport(relativeCoords,viewPort),transformCoord=getTransformCoord(moveEvt.offsetX,moveEvt.offsetY,scene),{x:moveOffsetX,y:moveOffsetY}=transformCoord,{scaleX,scaleY}=scene.getAncestorScale(),HEADER_MENU_SHAPE_THUMB_SIZE_SCALE=4/Math.max(scaleX,scaleY);moveChangeX=moveOffsetX-this._startOffsetX-HEADER_MENU_SHAPE_THUMB_SIZE_SCALE/2,moveChangeY=moveOffsetY-this._startOffsetY-HEADER_MENU_SHAPE_THUMB_SIZE_SCALE/2,Math.abs(0===initialType?moveChangeY:moveChangeX)>=2&&(isStartMove=!0),0===initialType?(moveChangeY>canvasMaxHeight-scrollBarHorizontalHeight+scrollXY.y-cell.startY&&(moveChangeY=canvasMaxHeight-scrollBarHorizontalHeight+scrollXY.y-cell.startY),moveChangeY<2-(cell.endY-cell.startY)&&(moveChangeY=2-(cell.endY-cell.startY)),isStartMove&&(this._resizeHelperShape?.transformByState({top:currentOffsetY+moveChangeY}),this._rowResizeRect?.transformByState({top:rowResizeRectY+moveChangeY+HEADER_MENU_SHAPE_THUMB_SIZE_SCALE/2}),this._rowResizeRect?.show(),scene.setCursor(engine_render_src.MBo.ROW_RESIZE))):(moveChangeX>canvasMaxWidth-scrollBarVerticalWidth+scrollXY.x-cell.startX&&(moveChangeX=canvasMaxWidth-scrollBarVerticalWidth+scrollXY.x-cell.startX),moveChangeX<2-(cell.endX-cell.startX)&&(moveChangeX=2-(cell.endX-cell.startX)),isStartMove&&(this._resizeHelperShape?.transformByState({left:currentOffsetX+moveChangeX}),this._columnResizeRect?.transformByState({left:rowResizeRectX+moveChangeX+HEADER_MENU_SHAPE_THUMB_SIZE_SCALE/2}),this._columnResizeRect?.show(),scene.setCursor(engine_render_src.MBo.COLUMN_RESIZE)))})),this._scenePointerUpSub=scene.onPointerUp$.subscribeEvent((upEvt=>{const scene=this._context.scene;this._clearObserverEvent(),this._resizeHelperShape?.dispose(),this._resizeHelperShape=null,scene.enableObjectsEvent(),isStartMove&&(scene.resetCursor(),this._rowResizeRect?.hide(),this._columnResizeRect?.hide(),0===initialType?this._commandService.executeCommand(sheets_src.j71.id,{deltaY:moveChangeY,anchorRow:this._currentRow}):this._commandService.executeCommand(sheets_src.WnP.id,{deltaX:moveChangeX,anchorCol:this._currentColumn}))}))}))),this.disposeWithMe(eventBindingObject.onDblclick$.subscribeEvent((()=>{this._context.scene.resetCursor();const sk=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(!sk)return;const endRow=sk.worksheet.getRowCount()-1||0,endColumn=sk.worksheet.getColumnCount()-1||0;switch(initialType){case 1:{const curSelections=this._selectionManagerService.getCurrentSelections(),ranges=[];for(let i=0;i<curSelections.length;i++){const selection=curSelections[i];selection.range.rangeType===src.$uV.COLUMN&&this._currentColumn<=selection.range.endColumn&&this._currentColumn>=selection.range.startColumn&&ranges.push({startColumn:selection.range.startColumn,endColumn:selection.range.endColumn,startRow:0,endRow})}0===ranges.length&&ranges.push({startColumn:this._currentColumn,endColumn:this._currentColumn,startRow:0,endRow}),this._commandService.executeCommand(SetWorksheetColAutoWidthCommand.id,{ranges}),this._columnResizeRect?.hide();break}case 0:this._commandService.executeCommand(sheets_src.iOM.id,{ranges:[{startRow:this._currentRow,endRow:this._currentRow,startColumn:0,endColumn}]}),this._rowResizeRect?.hide()}}))))}_clearObserverEvent(){this._scenePointerMoveSub?.unsubscribe(),this._scenePointerUpSub?.unsubscribe(),this._scenePointerMoveSub=null,this._scenePointerUpSub=null}}HeaderResizeRenderController=function header_resize_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([header_resize_render_controller_ts_param(1,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),header_resize_render_controller_ts_param(2,(0,src.y_5)(sheets_src.Fal)),header_resize_render_controller_ts_param(3,src.wTY),header_resize_render_controller_ts_metadata("design:type",Function),header_resize_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService,void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===src.wTY?Object:src.wTY])],HeaderResizeRenderController);const ITelemetryService=(0,src.Qmd)("telemetry.service");var withLatestFrom=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/withLatestFrom.js");function sheet_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function sheet_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class SheetRenderController extends src.hy_{constructor(_context,_sheetSkeletonManagerService,_sheetRenderService,_commandService,_telemetryService){super(),this._context=_context,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._sheetRenderService=_sheetRenderService,this._commandService=_commandService,this._telemetryService=_telemetryService,this._renderMetric$=new Subject.B,this.renderMetric$=this._renderMetric$.asObservable(),this._renderFrameTimeMetric=null,this._renderFrameTags={},this._afterRenderMetric$=new Subject.B,this._addNewRender(),this._initRenderMetricSubscriber()}_addNewRender(){const{scene,engine,unit:workbook}=this._context;this._addComponent(workbook),this._initRerenderScheduler(),this._initCommandListener();const worksheet=this._context.unit.getActiveSheet();if(!worksheet)throw new Error("No active sheet found");const sheetId=worksheet.getSheetId();this._sheetSkeletonManagerService.setCurrent({sheetId});const frameFn=()=>scene.render();this.disposeWithMe(this._context.activated$.subscribe((activated=>{activated?engine.runRenderLoop(frameFn):engine.stopRenderLoop(frameFn)})))}_initRenderMetricSubscriber(){const{engine}=this._context;engine.beginFrame$.subscribe((()=>{this._renderFrameTimeMetric=null,this._renderFrameTags={}})),engine.endFrame$.subscribe((()=>{this._renderFrameTimeMetric&&Object.keys(this._renderFrameTimeMetric).filter((key=>key.startsWith(engine_render_src.xlr))).length>0&&this._afterRenderMetric$.next({frameTimeMetric:this._renderFrameTimeMetric,tags:this._renderFrameTags})})),engine.renderFrameTimeMetric$.subscribe((([key,value])=>{this._renderFrameTimeMetric||(this._renderFrameTimeMetric={}),this._renderFrameTimeMetric[key]||(this._renderFrameTimeMetric[key]=[]),this._renderFrameTimeMetric[key].push(Math.round(100*value)/100)})),engine.renderFrameTags$.subscribe((([key,value])=>{this._renderFrameTags[key]=value}));const frameInfoList=[];this._afterRenderMetric$.pipe((0,withLatestFrom.E)(engine.endFrame$)).subscribe((([sceneRenderDetail,basicFrameTimeInfo])=>{frameInfoList.push({FPS:basicFrameTimeInfo.FPS,elapsedTime:basicFrameTimeInfo.elapsedTime,frameTime:Math.round(100*basicFrameTimeInfo.frameTime)/100,...sceneRenderDetail.frameTimeMetric,...sceneRenderDetail.tags}),frameInfoList.length>60&&(this._captureRenderMetric(frameInfoList),frameInfoList.length=0)}))}_captureRenderMetric(frameInfoList){const filteredFrameInfo=frameInfoList;if(0===filteredFrameInfo.length)return;const sumValueForNumListFields=data=>{let totalSum=0;const sums=Object.entries(data).filter((([_,value])=>Array.isArray(value))).map((([key])=>key)).reduce(((acc,key)=>{const keySum=data[key].reduce(((sum,num)=>sum+num),0);return acc[key]=keySum,acc}),{});return Object.keys(data).filter((key=>key.startsWith(engine_render_src.xlr))).forEach((key=>{totalSum+=sums[key]})),{...sums,extensionTotal:totalSum}},frameTimeListAfterSum=frameInfoList.map((info=>({...info,...sumValueForNumListFields(info)}))),summaryFrameStats=(list=frameTimeListAfterSum,Object.entries(list[0]).filter((([key,_])=>!["elapsedTime"].includes(key))).filter((([_,value])=>"number"==typeof value)).map((([key])=>key)).reduce(((acc,key)=>{const values=list.map((obj=>obj[key])),max=Math.max(...values),min=Math.min(...values),avg=values.reduce(((sum,val)=>sum+val),0)/values.length;return acc[key]={max:Math.round(100*max)/100,min:Math.round(100*min)/100,avg:Math.round(100*avg)/100},acc}),{}));var list;const elapsedTimeToStart=filteredFrameInfo[filteredFrameInfo.length-1].elapsedTime,telemetryData={sheetId:this._context.unit.getActiveSheet().getSheetId(),unitId:this._context.unit.getUnitId(),elapsedTimeToStart,...summaryFrameStats};this._renderMetric$.next(telemetryData),this._telemetryService?.capture("sheet_render_cost",telemetryData)}_addComponent(workbook){const{scene,components}=this._context,worksheet=workbook.getActiveSheet(),spreadsheet=new engine_render_src.Zux(SHEET_VIEW_KEY.MAIN);this._addViewport(worksheet);const spreadsheetRowHeader=new engine_render_src.a$A(SHEET_VIEW_KEY.ROW),spreadsheetColumnHeader=new engine_render_src.eZZ(SHEET_VIEW_KEY.COLUMN),SpreadsheetLeftTopPlaceholder=new engine_render_src.rwV(SHEET_VIEW_KEY.LEFT_TOP,{zIndex:2,left:-1,top:-1,fill:"rgb(248, 249, 250)",stroke:"rgb(217, 217, 217)",strokeWidth:1});this._context.mainComponent=spreadsheet,components.set(SHEET_VIEW_KEY.MAIN,spreadsheet),components.set(SHEET_VIEW_KEY.ROW,spreadsheetRowHeader),components.set(SHEET_VIEW_KEY.COLUMN,spreadsheetColumnHeader),components.set(SHEET_VIEW_KEY.LEFT_TOP,SpreadsheetLeftTopPlaceholder),scene.addObjects([spreadsheet],0),scene.addObjects([spreadsheetRowHeader,spreadsheetColumnHeader,SpreadsheetLeftTopPlaceholder],10),scene.enableLayerCache(0,10)}_initViewports(scene,rowHeader,columnHeader){const viewMain=new engine_render_src.LMM(engine_render_src.p3k.VIEW_MAIN,scene,{left:rowHeader.width,top:columnHeader.height,bottom:0,right:0,isWheelPreventDefaultX:!0,allowCache:!0,bufferEdgeX:100,bufferEdgeY:100}),viewMainLeftTop=new engine_render_src.LMM(engine_render_src.p3k.VIEW_MAIN_LEFT_TOP,scene,{isWheelPreventDefaultX:!0,active:!1,allowCache:!0,bufferEdgeX:0,bufferEdgeY:0}),viewMainLeft=new engine_render_src.LMM(engine_render_src.p3k.VIEW_MAIN_LEFT,scene,{isWheelPreventDefaultX:!0,active:!1,allowCache:!0,bufferEdgeX:0,bufferEdgeY:100}),viewMainTop=new engine_render_src.LMM(engine_render_src.p3k.VIEW_MAIN_TOP,scene,{isWheelPreventDefaultX:!0,active:!1,allowCache:!0,bufferEdgeX:100,bufferEdgeY:0}),viewRowTop=new engine_render_src.LMM(engine_render_src.p3k.VIEW_ROW_TOP,scene,{active:!1,isWheelPreventDefaultX:!0}),viewRowBottom=new engine_render_src.LMM(engine_render_src.p3k.VIEW_ROW_BOTTOM,scene,{left:0,top:columnHeader.height,bottom:0,width:rowHeader.width+1,isWheelPreventDefaultX:!0}),viewColumnLeft=new engine_render_src.LMM(engine_render_src.p3k.VIEW_COLUMN_LEFT,scene,{active:!1,isWheelPreventDefaultX:!0}),viewColumnRight=new engine_render_src.LMM(engine_render_src.p3k.VIEW_COLUMN_RIGHT,scene,{left:rowHeader.width,top:0,height:columnHeader.height+1,right:0,isWheelPreventDefaultX:!0});return{viewMain,viewLeftTop:new engine_render_src.LMM(engine_render_src.p3k.VIEW_LEFT_TOP,scene,{left:0,top:0,width:rowHeader.width,height:columnHeader.height,isWheelPreventDefaultX:!0}),viewMainLeftTop,viewMainLeft,viewMainTop,viewColumnLeft,viewRowTop,viewRowBottom,viewColumnRight}}_addViewport(worksheet){const scene=this._context.scene,{rowHeader,columnHeader}=worksheet.getConfig(),{viewMain}=this._initViewports(scene,rowHeader,columnHeader);new engine_render_src.$H1(viewMain);return scene.attachControl(),viewMain}_initRerenderScheduler(){this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((param=>{if(!param)return null;const{skeleton:spreadsheetSkeleton,sheetId}=param,workbook=this._context.unit,worksheet=workbook?.getSheetBySheetId(sheetId);if(null==workbook||null==worksheet)return;const{mainComponent,components}=this._context,spreadsheet=mainComponent,spreadsheetRowHeader=components.get(SHEET_VIEW_KEY.ROW),spreadsheetColumnHeader=components.get(SHEET_VIEW_KEY.COLUMN),spreadsheetLeftTopPlaceholder=components.get(SHEET_VIEW_KEY.LEFT_TOP),{rowHeaderWidth,columnHeaderHeight}=spreadsheetSkeleton;spreadsheet?.updateSkeleton(spreadsheetSkeleton),spreadsheetRowHeader?.updateSkeleton(spreadsheetSkeleton),spreadsheetColumnHeader?.updateSkeleton(spreadsheetSkeleton),spreadsheetLeftTopPlaceholder?.transformByState({width:rowHeaderWidth,height:columnHeaderHeight})})))}_initCommandListener(){this.disposeWithMe(this._commandService.onCommandExecuted((command=>{const{unit:workbook}=this._context,{id:commandId}=command;if(sheets_src.Izd.includes(commandId)||this._sheetRenderService.checkMutationShouldTriggerRerender(commandId)){const params=command.params,{unitId,subUnitId}=params,worksheet=workbook.getActiveSheet();if(!worksheet)return;const workbookId=this._context.unitId,worksheetId=worksheet.getSheetId();if(unitId!==workbookId||subUnitId!==worksheetId)return;this._sheetSkeletonManagerService.makeDirty({sheetId:worksheetId,commandId},!0),this._sheetSkeletonManagerService.setCurrent({sheetId:worksheetId,commandId})}else sheets_src._nP.includes(commandId)&&this._sheetSkeletonManagerService.reCalculate();command.type===src.g4t.MUTATION&&this._markUnitDirty(command)})))}_markUnitDirty(command){const{mainComponent:spreadsheet,scene}=this._context;if(command.id===engine_formula_src.Yp.id){if(null!=command.params.stageInfo)return}if(spreadsheet&&spreadsheet.makeDirty(),scene.makeDirty(),!command.params)return;const cmdParams=command.params,viewports=this._spreadsheetViewports(scene);if(command.id===sheets_src.N48.id&&cmdParams.cellValue){const dirtyRange=this._cellValueToRange(cmdParams.cellValue),dirtyBounds=this._rangeToBounds([dirtyRange]);this._markViewportDirty(viewports,dirtyBounds),spreadsheet.setDirtyArea(dirtyBounds)}if(command.id===sheets_src.o2G.id&&cmdParams.from&&cmdParams.to){const fromRange=cmdParams.fromRange||this._cellValueToRange(cmdParams.from.value),toRange=cmdParams.toRange||this._cellValueToRange(cmdParams.to.value),dirtyBounds=this._rangeToBounds([fromRange,toRange]);this._markViewportDirty(viewports,dirtyBounds),spreadsheet.setDirtyArea(dirtyBounds)}}_cellValueToRange(cellValue){const columns=[];let minCol=0,maxCol=0,minRow=0,maxRow=0;for(const[_row,columnObj]of Object.entries(cellValue)){for(const column in columnObj)columns.push(Number(column)),minCol>Number(column)&&(minCol=Number(column)),maxCol<Number(column)&&(maxCol=Number(column));minRow>Number(_row)&&(minRow=Number(_row)),maxRow<Number(_row)&&(maxRow=Number(_row))}return{startRow:minRow,endRow:maxRow,startColumn:minCol,endColumn:maxCol}}_rangeToBounds(ranges){const skeleton=this._sheetSkeletonManagerService.getCurrentParam().skeleton,{rowHeightAccumulation,columnWidthAccumulation,rowHeaderWidth,columnHeaderHeight}=skeleton,dirtyBounds=[];for(const r of ranges){const{startRow,endRow,startColumn,endColumn}=r,top=0===startRow?0:rowHeightAccumulation[startRow-1]+columnHeaderHeight,bottom=rowHeightAccumulation[endRow]+columnHeaderHeight,left=0===startColumn?0:columnWidthAccumulation[startColumn-1]+rowHeaderWidth,right=columnWidthAccumulation[endColumn]+rowHeaderWidth;dirtyBounds.push({top,left,bottom,right,width:right-left,height:bottom-top})}return dirtyBounds}_markViewportDirty(viewports,dirtyBounds){const activeViewports=viewports.filter((vp=>vp.isActive&&vp.cacheBound));for(const vp of activeViewports)for(const b of dirtyBounds)src.M_G.hasIntersectionBetweenTwoRect(vp.cacheBound,b)&&vp.markDirty(!0)}_spreadsheetViewports(scene){return scene.getViewports().filter((v=>["viewMain","viewMainLeftTop","viewMainTop","viewMainLeft"].includes(v.viewportKey)))}}SheetRenderController=function sheet_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([sheet_render_controller_ts_param(1,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),sheet_render_controller_ts_param(2,(0,src.y_5)(SheetsRenderService)),sheet_render_controller_ts_param(3,src.wTY),sheet_render_controller_ts_param(4,(0,src.Xx1)(ITelemetryService)),sheet_render_controller_ts_metadata("design:type",Function),sheet_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService,void 0===SheetsRenderService?Object:SheetsRenderService,void 0===src.wTY?Object:src.wTY,void 0===ITelemetryService?Object:ITelemetryService])],SheetRenderController);var hide_gridlines=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/hide-gridlines.js");function checkCellContentInRanges(worksheet,ranges){return ranges.some((range=>function checkCellContentInRange(worksheet,range){const{startRow,startColumn,endColumn,endRow}=range,cellMatrix=worksheet.getMatrixWithMergedCells(startRow,startColumn,endRow,endColumn);let someCellGoingToBeRemoved=!1;return cellMatrix.forValue(((row,col,cellData)=>{if(cellData&&(row!==startRow||col!==startColumn)&&worksheet.cellHasValue(cellData))return someCellGoingToBeRemoved=!0,!1})),someCellGoingToBeRemoved}(worksheet,range)))}function getClearContentMutationParamsForRanges(accessor,unitId,worksheet,ranges){const undos=[],redos=[],subUnitId=worksheet.getSheetId();return ranges.forEach((range=>{const redoMatrix=function getClearContentMutationParamForRange(worksheet,range){const{startRow,startColumn,endColumn,endRow}=range,cellMatrix=worksheet.getMatrixWithMergedCells(startRow,startColumn,endRow,endColumn,src.v2V.Intercepted),redoMatrix=new src.hDc;let leftTopCellValue=null;return cellMatrix.forValue(((row,col,cellData)=>{cellData&&row>=startRow&&col>=startColumn&&(!leftTopCellValue&&worksheet.cellHasValue(cellData)&&(""!==cellData.v||(cellData.p?.body?.dataStream?.length??0)>2)&&(leftTopCellValue=cellData),redoMatrix.setValue(row,col,null))})),redoMatrix.setValue(startRow,startColumn,leftTopCellValue),redoMatrix}(worksheet,range),redoMutationParams={unitId,subUnitId,cellValue:redoMatrix.getData()},undoMutationParams=(0,sheets_src.hro)(accessor,redoMutationParams);undos.push({id:sheets_src.N48.id,params:undoMutationParams}),redos.push({id:sheets_src.N48.id,params:redoMutationParams})})),{undos,redos}}function getViewportByCell(row,column,scene,worksheet){const freeze=worksheet.getFreeze();return!freeze||freeze.startRow<=0&&freeze.startColumn<=0||row>=freeze.startRow&&column>=freeze.startColumn?scene.getViewport(engine_render_src.p3k.VIEW_MAIN):row<freeze.startRow&&column<freeze.startColumn?scene.getViewport(engine_render_src.p3k.VIEW_MAIN_LEFT_TOP):row<freeze.startRow&&column>=freeze.startColumn?scene.getViewport(engine_render_src.p3k.VIEW_MAIN_TOP):row>=freeze.startRow&&column<freeze.startColumn?scene.getViewport(engine_render_src.p3k.VIEW_MAIN_LEFT):void 0}function utils_transformPosition2Offset(x,y,scene,skeleton,worksheet){const{scaleX,scaleY}=scene.getAncestorScale(),viewMain=scene.getViewport(engine_render_src.p3k.VIEW_MAIN);if(!viewMain)return{x,y};const freeze=worksheet.getFreeze(),{startColumn,startRow,xSplit,ySplit}=freeze,startSheetView=skeleton.getNoMergeCellWithCoordByIndex(startRow-ySplit,startColumn-xSplit,!1),endSheetView=skeleton.getNoMergeCellWithCoordByIndex(startRow,startColumn,!1),{rowHeaderWidth,columnHeaderHeight}=skeleton,freezeWidth=endSheetView.startX-startSheetView.startX,freezeHeight=endSheetView.startY-startSheetView.startY,{top,left,viewportScrollX,viewportScrollY}=viewMain;let offsetX,offsetY;return offsetX=x>left?(x-viewportScrollX)*scaleX:(freezeWidth+rowHeaderWidth-(left-x))*scaleX,offsetY=y>top?(y-viewportScrollY)*scaleY:(freezeHeight+columnHeaderHeight-(top-y))*scaleX,{x:offsetX,y:offsetY}}function getHoverCellPosition(currentRender,workbook,worksheet,skeletonParam,offsetX,offsetY){const{scene}=currentRender,unitId=workbook.getUnitId(),{skeleton,sheetId}=skeletonParam,cellIndex=function getCellIndexByOffsetWithMerge(offsetX,offsetY,scene,skeleton){const activeViewport=scene.getActiveViewportByCoord(engine_render_src.I9Y.FromArray([offsetX,offsetY]));if(!activeViewport)return;const{scaleX,scaleY}=scene.getAncestorScale(),scrollXY={x:activeViewport.viewportScrollX,y:activeViewport.viewportScrollY},cellIndex=skeleton.getCellIndexByOffset(offsetX,offsetY,scaleX,scaleY,scrollXY),mergeCell=skeleton.worksheet.getMergedCell(cellIndex.row,cellIndex.column);return{actualRow:mergeCell?mergeCell.startRow:cellIndex.row,actualCol:mergeCell?mergeCell.startColumn:cellIndex.column,mergeCell,row:cellIndex.row,col:cellIndex.column}}(offsetX,offsetY,scene,skeleton);if(!cellIndex)return null;let{actualCol,actualRow}=cellIndex;const originLocation={unitId,subUnitId:sheetId,workbook,worksheet,row:actualRow,col:actualCol};skeleton.overflowCache.forValue(((r,c,range)=>{range.startRow<=actualRow&&range.endRow>=actualRow&&range.startColumn<=actualCol&&range.endColumn>=actualCol&&(actualCol=c,actualRow=r)}));const actualCell=skeleton.getCellWithCoordByIndex(actualRow,actualCol),location=function getCellRealRange(workbook,worksheet,skeleton,row,col){let actualRow=row,actualCol=col;skeleton.overflowCache.forValue(((r,c,range)=>{range.startRow<=actualRow&&range.endRow>=actualRow&&range.startColumn<=actualCol&&range.endColumn>=actualCol&&(actualCol=c,actualRow=r)}));const actualCell=skeleton.getCellWithCoordByIndex(actualRow,actualCol);return{unitId:workbook.getUnitId(),subUnitId:worksheet.getSheetId(),workbook,worksheet,row:actualCell.actualRow,col:actualCell.actualColumn}}(workbook,worksheet,skeleton,actualRow,actualCol);let anchorCell;anchorCell=actualCell.mergeInfo?actualCell.mergeInfo:{startRow:location.row,endRow:location.row,startColumn:location.col,endColumn:location.col};const activeViewport=scene.getActiveViewportByCoord(engine_render_src.I9Y.FromArray([offsetX,offsetY]));if(!activeViewport)return;const{scaleX,scaleY}=scene.getAncestorScale(),scrollXY_x=activeViewport.viewportScrollX,scrollXY_y=activeViewport.viewportScrollY;return{position:{startX:(skeleton.getOffsetByColumn(anchorCell.startColumn-1)-scrollXY_x)*scaleX,endX:(skeleton.getOffsetByColumn(anchorCell.endColumn)-scrollXY_x)*scaleX,startY:(skeleton.getOffsetByRow(anchorCell.startRow-1)-scrollXY_y)*scaleY,endY:(skeleton.getOffsetByRow(anchorCell.endRow)-scrollXY_y)*scaleY},location:originLocation,overflowLocation:location}}const AddWorksheetMergeCommand={type:src.g4t.COMMAND,id:"sheet.command.add-worksheet-merge",handler:async(accessor,params)=>{const commandService=accessor.get(src.wTY),undoRedoService=accessor.get(src.$Dz),univerInstanceService=accessor.get(src.HCr),confirmService=accessor.get(ui_src.rQ),localeService=accessor.get(src.iH9),unitId=params.unitId,subUnitId=params.subUnitId,selections=params.selections,ranges=(0,sheets_src.h9R)(selections,params.value),worksheet=univerInstanceService.getUniverSheetInstance(unitId).getSheetBySheetId(subUnitId),redoMutations=[],undoMutations=[],willClearSomeCell=checkCellContentInRanges(worksheet,ranges);if(willClearSomeCell&&!params.defaultMerge){if(!await confirmService.confirm({id:"merge.confirm.add-worksheet-merge",title:{title:"merge.confirm.title"},cancelText:localeService.t("merge.confirm.cancel"),confirmText:localeService.t("merge.confirm.confirm")}))return!1}const removeMergeMutationParams={unitId,subUnitId,ranges:src.S0q.deepClone(ranges)},addMergeMutationParams={unitId,subUnitId,ranges:src.S0q.deepClone(ranges)},undoRemoveMergeMutationParams=(0,sheets_src.IX1)(accessor,removeMergeMutationParams),undoMutationParams=(0,sheets_src.PL)(accessor,addMergeMutationParams);if(undoRemoveMergeMutationParams.ranges.length>0&&redoMutations.push({id:sheets_src._L3.id,params:undoRemoveMergeMutationParams}),redoMutations.push({id:sheets_src.zo2.id,params:addMergeMutationParams}),undoMutations.push({id:sheets_src._L3.id,params:undoMutationParams}),undoRemoveMergeMutationParams.ranges.length>0&&undoMutations.push({id:sheets_src.zo2.id,params:undoRemoveMergeMutationParams}),willClearSomeCell){const data=getClearContentMutationParamsForRanges(accessor,unitId,worksheet,ranges);redoMutations.unshift(...data.redos),undoMutations.push(...data.undos)}const addMergeRedoSelectionsMutation=(0,sheets_src.ifA)(accessor,params,ranges);addMergeRedoSelectionsMutation&&redoMutations.push(addMergeRedoSelectionsMutation);const addMergeUndoSelectionsMutation=(0,sheets_src.sRA)(accessor,params);addMergeUndoSelectionsMutation&&undoMutations.push(addMergeUndoSelectionsMutation);const interceptor=accessor.get(sheets_src.e5R).onCommandExecute({id:AddWorksheetMergeCommand.id,params:{unitId,subUnitId,ranges}});redoMutations.push(...interceptor.redos),undoMutations.push(...interceptor.undos);return!!(0,src.PkI)(redoMutations,commandService).result&&(undoRedoService.pushUndoRedo({unitID:unitId,undoMutations,redoMutations}),!0)}},AddWorksheetMergeAllCommand={type:src.g4t.COMMAND,id:"sheet.command.add-worksheet-merge-all",handler:async accessor=>{const commandService=accessor.get(src.wTY),selectionManagerService=accessor.get(sheets_src.Fal),selections=selectionManagerService.getCurrentSelections()?.map((s=>s.range)),mergeableSelections=getMergeableSelectionsByType(MergeType.MergeAll,selections);if(!mergeableSelections?.length)return!1;const workbook=accessor.get(src.HCr).getCurrentUnitForType(src.Zy$.UNIVER_SHEET);if(!workbook)return!1;const workSheet=workbook.getActiveSheet();if(!workSheet)return!1;const unitId=workbook.getUnitId(),subUnitId=workSheet.getSheetId();return commandService.executeCommand(AddWorksheetMergeCommand.id,{selections:mergeableSelections,unitId,subUnitId})}},AddWorksheetMergeVerticalCommand={type:src.g4t.COMMAND,id:"sheet.command.add-worksheet-merge-vertical",handler:async accessor=>{const commandService=accessor.get(src.wTY),selectionManagerService=accessor.get(sheets_src.Fal),selections=selectionManagerService.getCurrentSelections()?.map((s=>s.range)),mergeableSelections=getMergeableSelectionsByType(MergeType.MergeVertical,selections);if(!mergeableSelections?.length)return!1;const workbook=accessor.get(src.HCr).getCurrentUnitForType(src.Zy$.UNIVER_SHEET);if(!workbook)return!1;const workSheet=workbook.getActiveSheet();if(!workSheet)return!1;const unitId=workbook.getUnitId(),subUnitId=workSheet.getSheetId();return commandService.executeCommand(AddWorksheetMergeCommand.id,{value:src.fgB.COLUMNS,selections:mergeableSelections,unitId,subUnitId})}},AddWorksheetMergeHorizontalCommand={type:src.g4t.COMMAND,id:"sheet.command.add-worksheet-merge-horizontal",handler:async accessor=>{const commandService=accessor.get(src.wTY),selectionManagerService=accessor.get(sheets_src.Fal),selections=selectionManagerService.getCurrentSelections()?.map((s=>s.range)),mergeableSelections=getMergeableSelectionsByType(MergeType.MergeHorizontal,selections);if(!mergeableSelections?.length)return!1;const workbook=accessor.get(src.HCr).getCurrentUnitForType(src.Zy$.UNIVER_SHEET);if(!workbook)return!1;const workSheet=workbook.getActiveSheet();if(!workSheet)return!1;const unitId=workbook.getUnitId(),subUnitId=workSheet.getSheetId();return commandService.executeCommand(AddWorksheetMergeCommand.id,{value:src.fgB.ROWS,selections:mergeableSelections,unitId,subUnitId})}},DeleteRangeMoveLeftConfirmCommand={type:src.g4t.COMMAND,id:"sheet.command.delete-range-move-left-confirm",handler:async accessor=>{const confirmService=accessor.get(ui_src.rQ),commandService=accessor.get(src.wTY),localeService=accessor.get(src.iH9),selectionManagerService=accessor.get(sheets_src.Fal),univerInstanceService=accessor.get(src.HCr),selection=selectionManagerService.getCurrentSelections();if(!selection)return!1;const target=(0,sheets_src.go2)(univerInstanceService);if(!target)return!1;const{worksheet}=target;let range=selection[0].range;if(!range)return!1;range={...range,endColumn:worksheet.getColumnCount()-1};const getRowLength=range=>range.endRow-range.startRow;if(!worksheet.getMergeData().find((mergeRange=>{const interSectedRange=src.M_G.getIntersects(mergeRange,range);return!!interSectedRange&&getRowLength(mergeRange)>getRowLength(interSectedRange)})))return commandService.executeCommand(sheets_src.Ehw.id);return!await confirmService.confirm({id:DeleteRangeMoveLeftConfirmCommand.id,title:{title:localeService.t("merge.confirm.waring")},children:{title:localeService.t("merge.confirm.dismantleMergeCellWaring")},cancelText:localeService.t("button.cancel"),confirmText:localeService.t("button.confirm")})||commandService.executeCommand(sheets_src.Ehw.id)}},DeleteRangeMoveUpConfirmCommand={type:src.g4t.COMMAND,id:"sheet.command.delete-range-move-up-confirm",handler:async accessor=>{const confirmService=accessor.get(ui_src.rQ),commandService=accessor.get(src.wTY),localeService=accessor.get(src.iH9),selectionManagerService=accessor.get(sheets_src.Fal),univerInstanceService=accessor.get(src.HCr),selection=selectionManagerService.getCurrentSelections();if(!selection)return!1;const target=(0,sheets_src.go2)(univerInstanceService);if(!target)return!1;const{worksheet}=target;let range=selection[0].range;if(!range)return!1;range={...range,endRow:worksheet.getRowCount()-1};for(let i=range.startRow;i<=range.endRow;i++)if(worksheet.getRowFiltered(i)){if(await confirmService.confirm({id:DeleteRangeMoveUpConfirmCommand.id,title:{title:localeService.t("filter.confirm.error")},children:{title:localeService.t("filter.confirm.notAllowedToInsertRange")},confirmText:localeService.t("button.confirm")}))return!1}const getColLength=range=>range.endColumn-range.startColumn;if(!worksheet.getMergeData().find((mergeRange=>{const interSectedRange=src.M_G.getIntersects(mergeRange,range);return!!interSectedRange&&getColLength(mergeRange)>getColLength(interSectedRange)})))return commandService.executeCommand(sheets_src.kHF.id);return!await confirmService.confirm({id:DeleteRangeMoveUpConfirmCommand.id,title:{title:localeService.t("merge.confirm.waring")},children:{title:localeService.t("merge.confirm.dismantleMergeCellWaring")},cancelText:localeService.t("button.cancel"),confirmText:localeService.t("button.confirm")})||commandService.executeCommand(sheets_src.kHF.id)}},InsertRangeMoveDownConfirmCommand={type:src.g4t.COMMAND,id:"sheet.command.insert-range-move-down-confirm",handler:async accessor=>{const confirmService=accessor.get(ui_src.rQ),commandService=accessor.get(src.wTY),localeService=accessor.get(src.iH9),selectionManagerService=accessor.get(sheets_src.Fal),univerInstanceService=accessor.get(src.HCr),selection=selectionManagerService.getCurrentSelections();if(!selection)return!1;const target=(0,sheets_src.go2)(univerInstanceService);if(!target)return!1;const{worksheet}=target;let range=selection[0].range;if(!range)return!1;range={...range,endRow:worksheet.getRowCount()-1};for(let i=range.startRow;i<=range.endRow;i++)if(worksheet.getRowFiltered(i)){if(await confirmService.confirm({id:InsertRangeMoveDownConfirmCommand.id,title:{title:localeService.t("filter.confirm.error")},children:{title:localeService.t("filter.confirm.notAllowedToInsertRange")},confirmText:localeService.t("button.confirm")}))return!1}const getColLength=range=>range.endColumn-range.startColumn;if(!worksheet.getMergeData().find((mergeRange=>{const interSectedRange=src.M_G.getIntersects(mergeRange,range);return!!interSectedRange&&getColLength(mergeRange)>getColLength(interSectedRange)})))return commandService.executeCommand(sheets_src.H7i.id);return!await confirmService.confirm({id:InsertRangeMoveDownConfirmCommand.id,title:{title:localeService.t("merge.confirm.waring")},children:{title:localeService.t("merge.confirm.dismantleMergeCellWaring")},cancelText:localeService.t("button.cancel"),confirmText:localeService.t("button.confirm")})||commandService.executeCommand(sheets_src.H7i.id)}},InsertRangeMoveRightConfirmCommand={type:src.g4t.COMMAND,id:"sheet.command.insert-range-move-right-confirm",handler:async accessor=>{const confirmService=accessor.get(ui_src.rQ),commandService=accessor.get(src.wTY),localeService=accessor.get(src.iH9),selectionManagerService=accessor.get(sheets_src.Fal),univerInstanceService=accessor.get(src.HCr),selection=selectionManagerService.getCurrentSelections();if(!selection)return!1;const target=(0,sheets_src.go2)(univerInstanceService);if(!target)return!1;const{worksheet}=target;let range=selection[0].range;if(!range)return!1;range={...range,endColumn:worksheet.getColumnCount()-1};const getRowLength=range=>range.endRow-range.startRow;if(!worksheet.getMergeData().find((mergeRange=>{const interSectedRange=src.M_G.getIntersects(mergeRange,range);return!!interSectedRange&&getRowLength(mergeRange)>getRowLength(interSectedRange)})))return commandService.executeCommand(sheets_src.TKH.id);return!await confirmService.confirm({id:InsertRangeMoveRightConfirmCommand.id,title:{title:localeService.t("merge.confirm.waring")},children:{title:localeService.t("merge.confirm.dismantleMergeCellWaring")},cancelText:localeService.t("button.cancel"),confirmText:localeService.t("button.confirm")})||commandService.executeCommand(sheets_src.TKH.id)}};var es=__webpack_require__("../../node_modules/.pnpm/@univerjs+protocol@0.1.44_@grpc+grpc-js@1.10.9_rxjs@7.8.1/node_modules/@univerjs/protocol/lib/es/index.js");const UNIVER_SHEET_PERMISSION_PANEL="UNIVER_SHEET_PERMISSION_PANEL",UNIVER_SHEET_PERMISSION_USER_DIALOG="UNIVER_SHEET_PERMISSION_USER_DIALOG",UNIVER_SHEET_PERMISSION_DIALOG="UNIVER_SHEET_PERMISSION_DIALOG",subUnitPermissionTypeMap={[es.pS.Copy]:"Copy",[es.pS.SetCellStyle]:"SetCellStyle",[es.pS.SetCellValue]:"SetCellValue",[es.pS.SetRowStyle]:"SetRowStyle",[es.pS.SetColumnStyle]:"SetColumnStyle",[es.pS.InsertRow]:"InsertRow",[es.pS.InsertColumn]:"InsertColumn",[es.pS.InsertHyperlink]:"InsertHyperlink",[es.pS.DeleteRow]:"DeleteRow",[es.pS.DeleteColumn]:"DeleteColumn",[es.pS.Sort]:"Sort",[es.pS.Filter]:"Filter",[es.pS.PivotTable]:"PivotTable",[es.pS.EditExtraObject]:"EditExtraObject"},defaultWorksheetUnitActionList=[es.pS.Copy,es.pS.SetCellStyle,es.pS.SetCellValue,es.pS.SetRowStyle,es.pS.SetColumnStyle,es.pS.InsertRow,es.pS.InsertColumn,es.pS.InsertHyperlink,es.pS.DeleteRow,es.pS.DeleteColumn,es.pS.Sort,es.pS.Filter,es.pS.PivotTable,es.pS.EditExtraObject,es.pS.View],permissionMenuIconKey="sheet-permission-menu-icon",permissionDeleteIconKey="sheet-permission-delete-icon",permissionEditIconKey="sheet-permission-edit-icon",permissionCheckIconKey="sheet-permission-check-icon",permissionLockIconKey="sheet-permission-lock-icon",DEFAULT_RANGE_RULE={unitId:"",subUnitId:"",permissionId:"",unitType:sheets_src._mD.SelectRange,id:"",ranges:[],viewState:sheets_src.kLo.OthersCanView,editState:sheets_src.v2u.OnlyMe};class SheetPermissionPanelModel{setVisible(v){this._visible=v}getVisible(){return this._visible}reset(){this.setVisible(!1)}constructor(){this._rule=DEFAULT_RANGE_RULE,this._visible=!1}}class SheetPermissionUserManagerService{get userList(){return this._userList}setCanEditUserList(userList){this._userList=userList,this._userList$.next(userList)}reset(){this._userList=[],this._oldCollaboratorList=[],this._selectUserList=[],this._selectUserList$.next([])}get oldCollaboratorList(){return this._oldCollaboratorList}setOldCollaboratorList(userList){this._oldCollaboratorList=userList}get selectUserList(){return this._selectUserList}setSelectUserList(userList){this._selectUserList=userList,this._selectUserList$.next(userList)}constructor(){this._userList=[],this._userList$=new BehaviorSubject.t(this._userList),this.userList$=this._userList$.asObservable(),this._oldCollaboratorList=[],this._selectUserList=[],this._selectUserList$=new BehaviorSubject.t(this._selectUserList),this.selectUserList$=this._selectUserList$.asObservable()}}const SheetPermissionOpenPanelOperation={type:src.g4t.OPERATION,id:"sheet-permission.operation.openPanel",async handler(accessor,_params={}){const sidebarService=accessor.get(ui_src.Jj),sheetPermissionPanelModel=accessor.get(SheetPermissionPanelModel),sheetPermissionUserManagerService=accessor.get(SheetPermissionUserManagerService),{showDetail=!0,fromSheetBar=!1,rule,oldRule}=_params,sidebarProps={header:{title:"permission.panel.title"},children:{label:UNIVER_SHEET_PERMISSION_PANEL,showDetail,fromSheetBar,rule,oldRule},width:330,onClose:()=>{sheetPermissionPanelModel.reset(),sheetPermissionUserManagerService.reset()}};return sheetPermissionPanelModel.setVisible(!0),sidebarService.open(sidebarProps),!0}},AddRangeProtectionFromToolbarCommand={type:src.g4t.COMMAND,id:"sheet.command.add-range-protection-from-toolbar",async handler(accessor){const commandService=accessor.get(src.wTY);return await commandService.executeCommand(SheetPermissionOpenPanelOperation.id,{showDetail:!0}),!0}},AddRangeProtectionFromContextMenuCommand={type:src.g4t.COMMAND,id:"sheet.command.add-range-protection-from-context-menu",async handler(accessor){const commandService=accessor.get(src.wTY);return await commandService.executeCommand(SheetPermissionOpenPanelOperation.id,{showDetail:!0}),!0}},ViewSheetPermissionFromContextMenuCommand={type:src.g4t.COMMAND,id:"sheet.command.view-sheet-permission-from-context-menu",async handler(accessor){const commandService=accessor.get(src.wTY);return await commandService.executeCommand(SheetPermissionOpenPanelOperation.id,{showDetail:!1}),!0}},AddRangeProtectionFromSheetBarCommand={type:src.g4t.COMMAND,id:"sheet.command.add-range-protection-from-sheet-bar",async handler(accessor){const commandService=accessor.get(src.wTY);return await commandService.executeCommand(SheetPermissionOpenPanelOperation.id,{fromSheetBar:!0,showDetail:!0}),!0}},ViewSheetPermissionFromSheetBarCommand={type:src.g4t.COMMAND,id:"sheet.command.view-sheet-permission-from-sheet-bar",async handler(accessor){const commandService=accessor.get(src.wTY);return await commandService.executeCommand(SheetPermissionOpenPanelOperation.id,{showDetail:!1}),!0}},DeleteRangeProtectionFromContextMenuCommand={type:src.g4t.COMMAND,id:"sheet.command.delete-range-protection-from-context-menu",async handler(accessor){const commandService=accessor.get(src.wTY),univerInstanceService=accessor.get(src.HCr),undoRedoService=accessor.get(src.$Dz),selectionManagerService=accessor.get(sheets_src.Fal),worksheetRuleModel=accessor.get(sheets_src.$af),workbook=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook.getActiveSheet(),unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId(),worksheetRule=worksheetRuleModel.getRule(unitId,subUnitId);if(worksheetRule?.permissionId)return commandService.executeCommand(sheets_src.ImT.id,{unitId,subUnitId,rule:worksheetRule});{const selectRange=selectionManagerService.getCurrentLastSelection()?.range;if(!selectRange)return!1;const rule=accessor.get(sheets_src.qI9).getSubunitRuleList(unitId,subUnitId).find((item=>item.ranges.some((range=>src.M_G.intersects(range,selectRange)))));if(rule){const redoMutationParam={unitId,subUnitId,ruleIds:[rule.id]};return await commandService.executeCommand(sheets_src.h5E.id,redoMutationParam)&&undoRedoService.pushUndoRedo({unitID:unitId,redoMutations:[{id:sheets_src.h5E.id,params:redoMutationParam}],undoMutations:[{id:sheets_src.BAP.id,params:{unitId,subUnitId,rules:[rule]}}]}),!0}return!1}}},SetRangeProtectionFromContextMenuCommand={type:src.g4t.COMMAND,id:"sheet.command.set-range-protection-from-context-menu",async handler(accessor){const commandService=accessor.get(src.wTY),univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),worksheetRuleModel=accessor.get(sheets_src.$af),workbook=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook.getActiveSheet(),unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId(),worksheetRule=worksheetRuleModel.getRule(unitId,subUnitId);if(worksheetRule?.permissionId){const oldRule={...worksheetRule,unitId,subUnitId,ranges:[]};return await commandService.executeCommand(SheetPermissionOpenPanelOperation.id,{showDetail:!0,rule:src.S0q.deepClone(oldRule),oldRule:src.S0q.deepClone(oldRule)}),!0}{const selectRange=selectionManagerService.getCurrentLastSelection()?.range;if(!selectRange)return!1;const rule=accessor.get(sheets_src.qI9).getSubunitRuleList(unitId,subUnitId).find((item=>item?.ranges?.some((range=>src.M_G.intersects(range,selectRange)))));if(rule){const oldRule={...rule,unitId,subUnitId};return await commandService.executeCommand(SheetPermissionOpenPanelOperation.id,{showDetail:!0,rule:src.S0q.deepClone(oldRule),oldRule:src.S0q.deepClone(oldRule)}),!0}return!1}}},RemoveRowConfirmCommand={id:"sheet.command.remove-row-confirm",type:src.g4t.COMMAND,handler:async(accessor,params)=>{const selectionManagerService=accessor.get(sheets_src.Fal);let range=params?.range;if(range||(range=selectionManagerService.getCurrentLastSelection()?.range),!range)return!1;const commandService=accessor.get(src.wTY),univerInstanceService=accessor.get(src.HCr),target=(0,sheets_src.go2)(univerInstanceService);if(!target)return!1;const{worksheet}=target;if(isAllRowsCovered(worksheet.getVisibleRows(),[range])){const confirmService=accessor.get(ui_src.rQ),localeService=accessor.get(src.iH9);return await confirmService.confirm({id:"sheet.confirm.remove-row",title:{title:localeService.t("info.problem")},children:{title:localeService.t("rightClick.deleteAllRowsAlert")},cancelText:localeService.t("button.cancel"),confirmText:localeService.t("button.confirm")}),!1}return await commandService.executeCommand(sheets_src.UJ9.id,{range}),!0}},RemoveColConfirmCommand={id:"sheet.command.remove-col-confirm",type:src.g4t.COMMAND,handler:async(accessor,params)=>{const selectionManagerService=accessor.get(sheets_src.Fal);let range=params?.range;if(range||(range=selectionManagerService.getCurrentLastSelection()?.range),!range)return!1;const commandService=accessor.get(src.wTY),univerInstanceService=accessor.get(src.HCr),target=(0,sheets_src.go2)(univerInstanceService);if(!target)return!1;const{worksheet}=target;if(isAllColumnsCovered(worksheet.getVisibleCols(),[range])){const confirmService=accessor.get(ui_src.rQ),localeService=accessor.get(src.iH9);return await confirmService.confirm({id:"sheet.confirm.remove-col",title:{title:localeService.t("info.problem")},children:{title:localeService.t("rightClick.deleteAllColumnsAlert")},cancelText:localeService.t("button.cancel"),confirmText:localeService.t("button.confirm")}),!1}return await commandService.executeCommand(sheets_src.G7y.id,{range}),!0}},RemoveSheetConfirmCommand={id:"sheet.command.remove-sheet-confirm",type:src.g4t.COMMAND,handler:async(accessor,params)=>{const{subUnitId}=params,confirmService=accessor.get(ui_src.rQ),commandService=accessor.get(src.wTY),localeService=accessor.get(src.iH9);return!!await confirmService.confirm({id:"sheet.confirm.remove-sheet",title:{title:localeService.t("sheetConfig.deleteSheet")},children:{title:localeService.t("sheetConfig.deleteSheetContent")},cancelText:localeService.t("button.cancel"),confirmText:localeService.t("button.confirm")})&&(await commandService.executeCommand(sheets_src.J0n.id,{subUnitId}),!0)}},ShowMenuListCommand={id:"ui-sheet.command.show-menu-list",type:src.g4t.OPERATION,handler:async accessor=>(accessor.get(ISheetBarService).triggerSheetBarMenu(),!0)},DeleteWorksheetProtectionFormSheetBarCommand={type:src.g4t.COMMAND,id:"sheet.command.delete-worksheet-protection-from-sheet-bar",async handler(accessor,params){if(!params)return!1;const commandService=accessor.get(src.wTY),undoRedoService=accessor.get(src.$Dz),worksheetProtectionRuleModel=accessor.get(sheets_src.$af),workbook=accessor.get(src.HCr).getCurrentUnitForType(es.Wh.UNIVER_SHEET),worksheet=workbook?.getActiveSheet(),unitId=workbook.getUnitId();if(!worksheet)return!1;const subUnitId=worksheet.getSheetId(),rule=worksheetProtectionRuleModel.getRule(unitId,subUnitId);if(await commandService.executeCommand(sheets_src.ImT.id,{unitId,subUnitId})){const redoMutations=[{id:sheets_src.ImT.id,params:{unitId,subUnitId}}],undoMutations=[{id:sheets_src.c7$.id,params:{unitId,rule}}];undoRedoService.pushUndoRedo({unitID:unitId,redoMutations,undoMutations})}return!0}},ChangeSheetProtectionFromSheetBarCommand={type:src.g4t.COMMAND,id:"sheet.command.change-sheet-protection-from-sheet-bar",async handler(accessor){const commandService=accessor.get(src.wTY);return await commandService.executeCommand("sheet-permission.operation.openDialog"),!0}},SetActivateCellEditOperation={id:"sheet.operation.set-activate-cell-edit",type:src.g4t.OPERATION,handler:(accessor,params)=>(accessor.get(editor_bridge_service_IEditorBridgeService).setEditCell(params),!0)},RenameSheetOperation={id:"sheet.operation.rename-sheet",type:src.g4t.OPERATION,handler:async(accessor,params)=>{const sheetBarService=accessor.get(ISheetBarService);return params&&sheetBarService.setRenameId(params.subUnitId),!0}},SheetPermissionOpenDialogOperation={type:src.g4t.OPERATION,id:"sheet-permission.operation.openDialog",async handler(accessor,_params){const dialogService=accessor.get(ui_src.Xw);return dialogService.close("DESKTOP_FIND_REPLACE_DIALOG"),dialogService.open({id:"UNIVER_SHEET_PERMISSION_DIALOG_ID",title:{title:"permission.dialog.allowedPermissionType"},children:{label:UNIVER_SHEET_PERMISSION_DIALOG},width:393,destroyOnClose:!0,onClose:()=>dialogService.close("UNIVER_SHEET_PERMISSION_DIALOG_ID")}),!0}};var paint_bucket=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/paint-bucket.js");const BorderDashDot=()=>(0,jsx_runtime.jsxs)("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,jsx_runtime.jsx)("path",{d:"M0.98999 1.08218H-0.0100098V0.0821838H0.98999V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M5.78992 1.08218H2.78992V0.0821838H5.78992V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M7.58984 1.08218H8.58984V0.0821838H7.58984V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M14.9152 1.08218H13.9152V0.0821838H14.9152V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M16.7151 1.08218H19.7151V0.0821838H16.7151V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M22.515 1.08218H21.515V0.0821838H22.515V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M27.8405 1.08218H28.8405V0.0821838H27.8405V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M33.6404 1.08218H30.6404V0.0821838H33.6404V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M35.4403 1.08218H36.4403V0.0821838H35.4403V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M42.7657 1.08218H41.7657V0.0821838H42.7657V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M44.5657 1.08218H47.5657V0.0821838H44.5657V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M50.3656 1.08218H49.3656V0.0821838H50.3656V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M55.691 1.08218H56.691V0.0821838H55.691V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M61.491 1.08218H58.491V0.0821838H61.491V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M63.2909 1.08218H64.2909V0.0821838H63.2909V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M70.6163 1.08218H69.6163V0.0821838H70.6163V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M72.4163 1.08218H75.4163V0.0821838H72.4163V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M78.2162 1.08218H77.2162V0.0821838H78.2162V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M83.5416 1.08218H84.5416V0.0821838H83.5416V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M89.3416 1.08218H86.3416V0.0821838H89.3416V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M91.1415 1.08218H92.1415V0.0821838H91.1415V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M98.4669 1.08218H97.4669V0.0821838H98.4669V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M100.267 1.08218H103.267V0.0821838H100.267V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M106.067 1.08218H105.067V0.0821838H106.067V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M111.392 1.08218H112.392V0.0821838H111.392V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M117.192 1.08218H114.192V0.0821838H117.192V1.08218Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M118.992 1.08218H119.992V0.0821838H118.992V1.08218Z",fill:"black"})]});BorderDashDot.__docgenInfo={description:"",methods:[],displayName:"BorderDashDot"};const BorderDashDotDot=()=>(0,jsx_runtime.jsxs)("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,jsx_runtime.jsx)("path",{d:"M-0.0100098 1.15771H0.98999V0.157715H-0.0100098V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M2.78992 1.15771H5.78992V0.157715H2.78992V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M8.58984 1.15771H7.58984V0.157715H8.58984V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M10.3899 1.15771H11.3899V0.157715H10.3899V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M19.0903 1.15771H18.0903V0.157715H19.0903V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M20.8903 1.15771H23.8903V0.157715H20.8903V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M26.6902 1.15771H25.6902V0.157715H26.6902V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M28.4902 1.15771H29.4902V0.157715H28.4902V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M37.1907 1.15771H36.1907V0.157715H37.1907V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M38.9906 1.15771H41.9906V0.157715H38.9906V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M44.7905 1.15771H43.7905V0.157715H44.7905V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M46.5906 1.15771H47.5906V0.157715H46.5906V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M55.291 1.15771H54.291V0.157715H55.291V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M57.0909 1.15771H60.0909V0.157715H57.0909V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M62.8909 1.15771H61.8909V0.157715H62.8909V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M64.6909 1.15771H65.6909V0.157715H64.6909V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M73.3914 1.15771H72.3914V0.157715H73.3914V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M75.1913 1.15771H78.1913V0.157715H75.1913V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M80.9912 1.15771H79.9912V0.157715H80.9912V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M82.7913 1.15771H83.7913V0.157715H82.7913V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M91.4917 1.15771H90.4917V0.157715H91.4917V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M93.2916 1.15771H96.2916V0.157715H93.2916V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M99.0916 1.15771H98.0916V0.157715H99.0916V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M100.892 1.15771H101.892V0.157715H100.892V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M109.592 1.15771H108.592V0.157715H109.592V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M111.392 1.15771H114.392V0.157715H111.392V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M117.192 1.15771H116.192V0.157715H117.192V1.15771Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M118.992 1.15771H119.992V0.157715H118.992V1.15771Z",fill:"black"})]});BorderDashDotDot.__docgenInfo={description:"",methods:[],displayName:"BorderDashDotDot"};const BorderDashed=()=>(0,jsx_runtime.jsxs)("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,jsx_runtime.jsx)("path",{d:"M-0.00842285 1.22449H2.99158V0.224487H-0.00842285V1.22449Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M6.14941 1.22449H9.14941V0.224487H6.14941V1.22449Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M15.3073 1.22449H12.3073V0.224487H15.3073V1.22449Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M18.4651 1.22449H21.4651V0.224487H18.4651V1.22449Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M27.6229 1.22449H24.6229V0.224487H27.6229V1.22449Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M30.7808 1.22449H33.7808V0.224487H30.7808V1.22449Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M39.9386 1.22449H36.9386V0.224487H39.9386V1.22449Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M43.0964 1.22449H46.0964V0.224487H43.0964V1.22449Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M52.2543 1.22449H49.2543V0.224487H52.2543V1.22449Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M55.4121 1.22449H58.4121V0.224487H55.4121V1.22449Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M64.5699 1.22449H61.5699V0.224487H64.5699V1.22449Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M67.7278 1.22449H70.7278V0.224487H67.7278V1.22449Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M76.8856 1.22449H73.8856V0.224487H76.8856V1.22449Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M80.0435 1.22449H83.0435V0.224487H80.0435V1.22449Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M89.2013 1.22449H86.2013V0.224487H89.2013V1.22449Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M92.3591 1.22449H95.3591V0.224487H92.3591V1.22449Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M101.517 1.22449H98.517V0.224487H101.517V1.22449Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M104.675 1.22449H107.675V0.224487H104.675V1.22449Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M113.833 1.22449H110.833V0.224487H113.833V1.22449Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M116.99 1.22449H119.99V0.224487H116.99V1.22449Z",fill:"black"})]});BorderDashed.__docgenInfo={description:"",methods:[],displayName:"BorderDashed"};const BorderHair=()=>(0,jsx_runtime.jsxs)("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,jsx_runtime.jsx)("path",{d:"M-0.00976562 1.65707H0.990234V0.657074H-0.00976562V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M2.32361 1.65707H3.32361V0.657074H2.32361V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M5.65698 1.65707H4.65698V0.657074H5.65698V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M6.99036 1.65707H7.99036V0.657074H6.99036V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M10.3237 1.65707H9.32373V0.657074H10.3237V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M11.6571 1.65707H12.6571V0.657074H11.6571V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M14.9905 1.65707H13.9905V0.657074H14.9905V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M16.3239 1.65707H17.3239V0.657074H16.3239V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M19.6572 1.65707H18.6572V0.657074H19.6572V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M20.9906 1.65707H21.9906V0.657074H20.9906V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M24.324 1.65707H23.324V0.657074H24.324V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M25.6573 1.65707H26.6573V0.657074H25.6573V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M28.9907 1.65707H27.9907V0.657074H28.9907V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M30.3241 1.65707H31.3241V0.657074H30.3241V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M33.6575 1.65707H32.6575V0.657074H33.6575V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M34.9908 1.65707H35.9908V0.657074H34.9908V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M38.3242 1.65707H37.3242V0.657074H38.3242V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M39.6576 1.65707H40.6576V0.657074H39.6576V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M42.991 1.65707H41.991V0.657074H42.991V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M44.3243 1.65707H45.3243V0.657074H44.3243V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M47.6577 1.65707H46.6577V0.657074H47.6577V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M48.9911 1.65707H49.9911V0.657074H48.9911V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M52.3245 1.65707H51.3245V0.657074H52.3245V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M53.6578 1.65707H54.6578V0.657074H53.6578V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M56.9912 1.65707H55.9912V0.657074H56.9912V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M58.3246 1.65707H59.3246V0.657074H58.3246V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M61.658 1.65707H60.658V0.657074H61.658V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M62.9913 1.65707H63.9913V0.657074H62.9913V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M66.3247 1.65707H65.3247V0.657074H66.3247V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M67.6581 1.65707H68.6581V0.657074H67.6581V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M70.9915 1.65707H69.9915V0.657074H70.9915V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M72.3248 1.65707H73.3248V0.657074H72.3248V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M75.6582 1.65707H74.6582V0.657074H75.6582V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M76.9916 1.65707H77.9916V0.657074H76.9916V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M80.325 1.65707H79.325V0.657074H80.325V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M81.6583 1.65707H82.6583V0.657074H81.6583V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M84.9917 1.65707H83.9917V0.657074H84.9917V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M86.3251 1.65707H87.3251V0.657074H86.3251V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M89.6584 1.65707H88.6584V0.657074H89.6584V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M90.9918 1.65707H91.9918V0.657074H90.9918V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M94.3252 1.65707H93.3252V0.657074H94.3252V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M95.6586 1.65707H96.6586V0.657074H95.6586V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M98.9919 1.65707H97.9919V0.657074H98.9919V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M100.325 1.65707H101.325V0.657074H100.325V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M103.659 1.65707H102.659V0.657074H103.659V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M104.992 1.65707H105.992V0.657074H104.992V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M108.325 1.65707H107.325V0.657074H108.325V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M109.659 1.65707H110.659V0.657074H109.659V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M112.992 1.65707H111.992V0.657074H112.992V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M114.325 1.65707H115.325V0.657074H114.325V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M117.659 1.65707H116.659V0.657074H117.659V1.65707Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M118.992 1.65707H119.992V0.657074H118.992V1.65707Z",fill:"black"})]});BorderHair.__docgenInfo={description:"",methods:[],displayName:"BorderHair"};const BorderMedium=()=>(0,jsx_runtime.jsx)("svg",{width:"120",height:"3",viewBox:"0 0 120 3",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,jsx_runtime.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M119.991 2.42035H-0.0090332V0.420349H119.991V2.42035Z",fill:"black"})});BorderMedium.__docgenInfo={description:"",methods:[],displayName:"BorderMedium"};const BorderMediumDashDot=()=>(0,jsx_runtime.jsxs)("svg",{width:"120",height:"3",viewBox:"0 0 120 3",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,jsx_runtime.jsx)("path",{d:"M-0.0100098 2.47614H1.98999V0.476135H-0.0100098V2.47614Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M3.99014 2.47614H9.99014V0.476135H3.99014V2.47614Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M13.9901 2.47614H11.9901V0.476135H13.9901V2.47614Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M21.1904 2.47614H23.1904V0.476135H21.1904V2.47614Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M31.1906 2.47614H25.1906V0.476135H31.1906V2.47614Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M33.1906 2.47614H35.1906V0.476135H33.1906V2.47614Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M44.3909 2.47614H42.3909V0.476135H44.3909V2.47614Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M46.391 2.47614H52.391V0.476135H46.391V2.47614Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M56.391 2.47614H54.391V0.476135H56.391V2.47614Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M63.5913 2.47614H65.5913V0.476135H63.5913V2.47614Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M73.5915 2.47614H67.5915V0.476135H73.5915V2.47614Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M75.5915 2.47614H77.5915V0.476135H75.5915V2.47614Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M86.7917 2.47614H84.7917V0.476135H86.7917V2.47614Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M88.7919 2.47614H94.7919V0.476135H88.7919V2.47614Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M98.7919 2.47614H96.7919V0.476135H98.7919V2.47614Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M105.992 2.47614H107.992V0.476135H105.992V2.47614Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M115.992 2.47614H109.992V0.476135H115.992V2.47614Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M117.992 2.47614H119.992V0.476135H117.992V2.47614Z",fill:"black"})]});BorderMediumDashDot.__docgenInfo={description:"",methods:[],displayName:"BorderMediumDashDot"};const BorderMediumDashDotDot=()=>(0,jsx_runtime.jsxs)("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,jsx_runtime.jsx)("path",{d:"M-0.0100098 2.00415H1.98999V0.00415039H-0.0100098V2.00415Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M3.99014 2.00415H9.99014V0.00415039H3.99014V2.00415Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M13.9901 2.00415H11.9901V0.00415039H13.9901V2.00415Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M15.9901 2.00415H17.9901V0.00415039H15.9901V2.00415Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M27.4905 2.00415H25.4905V0.00415039H27.4905V2.00415Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M29.4906 2.00415H35.4906V0.00415039H29.4906V2.00415Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M39.4906 2.00415H37.4906V0.00415039H39.4906V2.00415Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M41.4906 2.00415H43.4906V0.00415039H41.4906V2.00415Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M52.991 2.00415H50.991V0.00415039H52.991V2.00415Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M54.9911 2.00415H60.9911V0.00415039H54.9911V2.00415Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M64.9911 2.00415H62.9911V0.00415039H64.9911V2.00415Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M66.9911 2.00415H68.9911V0.00415039H66.9911V2.00415Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M78.4915 2.00415H76.4915V0.00415039H78.4915V2.00415Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M80.4916 2.00415H86.4916V0.00415039H80.4916V2.00415Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M90.4916 2.00415H88.4916V0.00415039H90.4916V2.00415Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M92.4916 2.00415H94.4916V0.00415039H92.4916V2.00415Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M103.992 2.00415H101.992V0.00415039H103.992V2.00415Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M105.992 2.00415H111.992V0.00415039H105.992V2.00415Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M115.992 2.00415H113.992V0.00415039H115.992V2.00415Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M117.992 2.00415H119.992V0.00415039H117.992V2.00415Z",fill:"black"})]});BorderMediumDashDotDot.__docgenInfo={description:"",methods:[],displayName:"BorderMediumDashDotDot"};const BorderMediumDashed=()=>(0,jsx_runtime.jsxs)("svg",{width:"118",height:"3",viewBox:"0 0 118 3",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,jsx_runtime.jsx)("path",{d:"M-0.00854492 2.94815H1.99146V0.948151H-0.00854492V2.94815Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M6.09668 2.94815H8.09668V0.948151H6.09668V2.94815Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M14.2019 2.94815H12.2019V0.948151H14.2019V2.94815Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M18.3071 2.94815H20.3071V0.948151H18.3071V2.94815Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M26.4124 2.94815H24.4124V0.948151H26.4124V2.94815Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M30.5176 2.94815H32.5176V0.948151H30.5176V2.94815Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M38.6228 2.94815H36.6228V0.948151H38.6228V2.94815Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M42.728 2.94815H44.728V0.948151H42.728V2.94815Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M50.8333 2.94815H48.8333V0.948151H50.8333V2.94815Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M54.9385 2.94815H56.9385V0.948151H54.9385V2.94815Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M63.0437 2.94815H61.0437V0.948151H63.0437V2.94815Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M67.1489 2.94815H69.1489V0.948151H67.1489V2.94815Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M75.2542 2.94815H73.2542V0.948151H75.2542V2.94815Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M79.3594 2.94815H81.3594V0.948151H79.3594V2.94815Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M87.4645 2.94815H85.4645V0.948151H87.4645V2.94815Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M91.5697 2.94815H93.5697V0.948151H91.5697V2.94815Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M99.6749 2.94815H97.6749V0.948151H99.6749V2.94815Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M103.78 2.94815H105.78V0.948151H103.78V2.94815Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M111.885 2.94815H109.885V0.948151H111.885V2.94815Z",fill:"black"}),(0,jsx_runtime.jsx)("path",{d:"M115.991 2.94815H117.991V0.948151H115.991V2.94815Z",fill:"black"})]});BorderMediumDashed.__docgenInfo={description:"",methods:[],displayName:"BorderMediumDashed"};const BorderThick=()=>(0,jsx_runtime.jsx)("svg",{width:"120",height:"4",viewBox:"0 0 120 4",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,jsx_runtime.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M119.991 3.86215H-0.0090332V0.862152H119.991V3.86215Z",fill:"black"})});BorderThick.__docgenInfo={description:"",methods:[],displayName:"BorderThick"};const BorderThin=()=>(0,jsx_runtime.jsx)("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,jsx_runtime.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M119.991 1.15668H-0.0090332V0.156677H119.991V1.15668Z",fill:"black"})});function BorderLine(props){const{type=src.jBF.THIN}=props;switch(type){case src.jBF.DASH_DOT:return(0,jsx_runtime.jsx)(BorderDashDot,{});case src.jBF.DASH_DOT_DOT:return(0,jsx_runtime.jsx)(BorderDashDotDot,{});case src.jBF.DASHED:return(0,jsx_runtime.jsx)(BorderDashed,{});case src.jBF.HAIR:return(0,jsx_runtime.jsx)(BorderHair,{});case src.jBF.MEDIUM:return(0,jsx_runtime.jsx)(BorderMedium,{});case src.jBF.MEDIUM_DASH_DOT:return(0,jsx_runtime.jsx)(BorderMediumDashDot,{});case src.jBF.MEDIUM_DASH_DOT_DOT:return(0,jsx_runtime.jsx)(BorderMediumDashDotDot,{});case src.jBF.MEDIUM_DASHED:return(0,jsx_runtime.jsx)(BorderMediumDashed,{});case src.jBF.THICK:return(0,jsx_runtime.jsx)(BorderThick,{});case src.jBF.THIN:default:return(0,jsx_runtime.jsx)(BorderThin,{})}}BorderThin.__docgenInfo={description:"",methods:[],displayName:"BorderThin"},BorderLine.__docgenInfo={description:"",methods:[],displayName:"BorderLine",props:{type:{required:!0,tsType:{name:"BorderStyleTypes"},description:""}}};const BORDER_LINE_CHILDREN=[{label:"borderLine.borderTop",icon:"UpBorder",value:"top"},{label:"borderLine.borderBottom",icon:"DownBorder",value:"bottom"},{label:"borderLine.borderLeft",icon:"LeftBorder",value:"left"},{label:"borderLine.borderRight",icon:"RightBorder",value:"right"},{label:"borderLine.borderNone",icon:"NoBorderSingle",value:"none"},{label:"borderLine.borderAll",icon:"AllBorderSingle",value:"all"},{label:"borderLine.borderOutside",icon:"OuterBorder",value:"outside"},{label:"borderLine.borderInside",icon:"InnerBorder",value:"inside"},{label:"borderLine.borderHorizontal",icon:"HorizontalBorder",value:"horizontal"},{label:"borderLine.borderVertical",icon:"VerticalBorder",value:"vertical"},{label:"borderLine.borderTlbr",icon:"BackSlashSingle",value:"tlbr"},{label:"borderLine.borderTlbcTlmr",icon:"LeftDoubleDiagonalSingle",value:"tlbc_tlmr"},{label:"borderLine.borderTlbrTlbcTlmr",icon:"LeftTridiagonalSingle",value:"tlbr_tlbc_tlmr"},{label:"borderLine.borderBlTr",icon:"SlashSingle",value:"bltr"},{label:"borderLine.borderMltrBctr",icon:"RightDoubleDiagonalSingle",value:"mltr_bctr"}],BORDER_SIZE_CHILDREN=[{label:src.jBF.THIN,value:src.jBF.THIN},{label:src.jBF.HAIR,value:src.jBF.HAIR},{label:src.jBF.DOTTED,value:src.jBF.DOTTED},{label:src.jBF.DASHED,value:src.jBF.DASHED},{label:src.jBF.DASH_DOT,value:src.jBF.DASH_DOT},{label:src.jBF.DASH_DOT_DOT,value:src.jBF.DASH_DOT_DOT},{label:src.jBF.MEDIUM,value:src.jBF.MEDIUM},{label:src.jBF.MEDIUM_DASHED,value:src.jBF.MEDIUM_DASHED},{label:src.jBF.MEDIUM_DASH_DOT,value:src.jBF.MEDIUM_DASH_DOT},{label:src.jBF.MEDIUM_DASH_DOT_DOT,value:src.jBF.MEDIUM_DASH_DOT_DOT},{label:src.jBF.THICK,value:src.jBF.THICK}];function BorderPanel(props){const componentManager=(0,ui_src.fJ)(ui_src.BJ),borderStyleManagerService=(0,ui_src.fJ)(sheets_src.wm$),{onChange,value}=props;function handleClick(v,type){onChange?.({...value,[type]:v})}function renderIcon(icon){const Icon=componentManager.get(icon);return Icon&&(0,jsx_runtime.jsx)(Icon,{extend:{colorChannel1:"#2c53f1"}})}return(0,jsx_runtime.jsxs)("section",{className:"univer-box-border univer-grid univer-gap-2 univer-p-1.5",children:[(0,jsx_runtime.jsx)("div",{className:"univer-box-border univer-grid univer-grid-cols-5 univer-gap-2",children:BORDER_LINE_CHILDREN.map((item=>(0,jsx_runtime.jsx)("a",{className:(0,design_src.$z)("\n                          univer-flex univer-size-6 univer-cursor-pointer univer-items-center univer-justify-center\n                          univer-justify-self-center univer-rounded\n                          hover:univer-bg-gray-100\n                        ",{"univer-bg-gray-200":borderStyleManagerService.getBorderInfo().type===item.value}),onClick:e=>{e.stopPropagation(),handleClick(item.value,"type")},children:renderIcon(item.icon)},item.value)))}),(0,jsx_runtime.jsx)(design_src.wv,{}),(0,jsx_runtime.jsxs)("div",{className:"univer-flex univer-items-center univer-gap-2",children:[(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(design_src.ms,{overlay:(0,jsx_runtime.jsx)("div",{className:"univer-rounded-lg univer-p-4",children:(0,jsx_runtime.jsx)(design_src.sk,{onChange:value=>handleClick(value,"color")})}),children:(0,jsx_runtime.jsxs)("button",{className:"\n                              univer-flex univer-cursor-pointer univer-items-center univer-gap-2 univer-rounded\n                              univer-border-none univer-bg-transparent univer-p-1\n                              hover:univer-bg-gray-100\n                            ",type:"button",children:[(0,jsx_runtime.jsx)(paint_bucket.A,{extend:{colorChannel1:value?.color??"rgb(var(--primary-color))"}}),(0,jsx_runtime.jsx)(more_down_single.A,{className:"univer-text-gray-400"})]})})}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(design_src.ms,{overlay:(0,jsx_runtime.jsx)("section",{className:"univer-rounded-lg univer-p-1.5",children:(0,jsx_runtime.jsx)("ul",{className:"univer-m-0 univer-grid univer-list-none univer-gap-1 univer-p-0",children:BORDER_SIZE_CHILDREN.map((item=>(0,jsx_runtime.jsx)("li",{className:"\n                                              univer-flex univer-cursor-pointer univer-items-center\n                                              univer-justify-center univer-rounded univer-px-1 univer-py-2\n                                              hover:univer-bg-gray-100\n                                            ",onClick:()=>handleClick(item.value,"style"),children:(0,jsx_runtime.jsx)(BorderLine,{type:item.value})},item.value)))})}),children:(0,jsx_runtime.jsxs)("button",{className:"\n                              univer-flex univer-cursor-pointer univer-items-center univer-gap-2 univer-rounded\n                              univer-border-none univer-bg-transparent univer-p-1\n                              hover:univer-bg-gray-100\n                            ",type:"button",children:[(0,jsx_runtime.jsx)(BorderLine,{type:src.jBF.THIN}),(0,jsx_runtime.jsx)(more_down_single.A,{className:"univer-text-gray-400"})]})})})]})]})}BorderPanel.__docgenInfo={description:"",methods:[],displayName:"BorderPanel",props:{value:{required:!0,tsType:{name:"IBorderInfo"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(v: T) => void",signature:{arguments:[{type:{name:"IBorderInfo"},name:"v"}],return:{name:"void"}}},description:""}}};var delete_single=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/delete-single.js"),error_single=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/error-single.js");const widthStyle={width:"100%"},DefinedNameInput=props=>{const{inputId,state=!1,type="range",confirm,cancel,name,formulaOrRefString,comment="",localSheetId=sheets_src.Gjg,hidden=!1,id}=props,workbook=(0,ui_src.fJ)(src.HCr).getCurrentUnitForType(src.Zy$.UNIVER_SHEET),localeService=(0,ui_src.fJ)(src.iH9),definedNamesService=(0,ui_src.fJ)(engine_formula_src.ke),functionService=(0,ui_src.fJ)(engine_formula_src.$C),lexerTreeBuilder=(0,ui_src.fJ)(engine_formula_src.GM),componentManager=(0,ui_src.fJ)(ui_src.BJ),RangeSelector=(0,react.useMemo)((()=>componentManager.get("RANGE_SELECTOR_COMPONENT_KEY")),[]),FormulaEditor=(0,react.useMemo)((()=>componentManager.get("EMBEDDING_FORMULA_EDITOR_COMPONENT_KEY")),[]);if(null==workbook)return;const unitId=(0,react.useMemo)((()=>workbook.getUnitId()),[]),subUnitId=(0,react.useMemo)((()=>workbook.getActiveSheet().getSheetId()),[]),[nameValue,setNameValue]=(0,react.useState)(name),[formulaOrRefStringValue,setFormulaOrRefStringValue]=(0,react.useState)(formulaOrRefString),[commentValue,setCommentValue]=(0,react.useState)(comment),[localSheetIdValue,setLocalSheetIdValue]=(0,react.useState)(localSheetId),[validString,setValidString]=(0,react.useState)(""),[typeValue,setTypeValue]=(0,react.useState)(type),[validFormulaOrRange,setValidFormulaOrRange]=(0,react.useState)(!0),options=[{label:localeService.t("definedName.scopeWorkbook"),value:sheets_src.Gjg}];(0,react.useEffect)((()=>{setValidFormulaOrRange(!0),setNameValue(name),setCommentValue(comment),setLocalSheetIdValue(localSheetId);let formulaOrRefStringCache=formulaOrRefString;var token;formulaOrRefString.substring(0,1)===engine_formula_src.gm.EQUALS?setTypeValue("formula"):(token=formulaOrRefString,(0,engine_formula_src.oB)(token)?setTypeValue("range"):(setTypeValue("formula"),formulaOrRefStringCache=engine_formula_src.gm.EQUALS+formulaOrRefString)),setFormulaOrRefStringValue(formulaOrRefStringCache),setValidString("")}),[state]),workbook.getSheetOrders().forEach((sheetId=>{const sheet=workbook.getSheetBySheetId(sheetId);options.push({label:sheet?.getName()||"",value:sheetId})}));const formulaEditorActionsRef=(0,react.useRef)({}),[isFocusFormulaEditor,isFocusFormulaEditorSet]=(0,react.useState)(!1);return(0,ui_src.GK)((e=>{const handleOutClick=formulaEditorActionsRef.current?.handleOutClick;handleOutClick&&handleOutClick(e,(()=>isFocusFormulaEditorSet(!1)))})),(0,jsx_runtime.jsxs)("div",{className:views_defined_name_index_module.definedNameInput,style:{display:state?"block":"none"},children:[(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(design_src.pd,{placeholder:localeService.t("definedName.inputNamePlaceholder"),value:nameValue,allowClear:!0,onChange:setNameValue,affixWrapperStyle:widthStyle})}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsxs)(design_src.z6,{value:typeValue,onChange:value=>{const type=value;"formula"===type?formulaOrRefString[0]===engine_formula_src.gm.EQUALS?setFormulaOrRefStringValue(formulaOrRefString):setFormulaOrRefStringValue(`${engine_formula_src.gm.EQUALS}`):formulaOrRefString[0]===engine_formula_src.gm.EQUALS?setFormulaOrRefStringValue(""):setFormulaOrRefStringValue(formulaOrRefString),setTypeValue(type)},children:[(0,jsx_runtime.jsx)(design_src.sx,{value:"range",children:localeService.t("definedName.ratioRange")}),(0,jsx_runtime.jsx)(design_src.sx,{value:"formula",children:localeService.t("definedName.ratioFormula")})]})}),"range"===typeValue?RangeSelector&&(0,jsx_runtime.jsx)(RangeSelector,{unitId,subUnitId,initialValue:formulaOrRefStringValue,onChange:(_,text)=>{setFormulaOrRefStringValue(text)},supportAcrossSheet:!0}):FormulaEditor&&(0,jsx_runtime.jsx)(FormulaEditor,{initValue:formulaOrRefStringValue,unitId,subUnitId,isFocus:isFocusFormulaEditor,isSupportAcrossSheet:!0,onChange:(v="")=>{setFormulaOrRefStringValue(v||""||"")},onVerify:res=>{setValidFormulaOrRange(res)},onFocus:()=>isFocusFormulaEditorSet(!0),actions:formulaEditorActionsRef.current}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(design_src.l6,{style:widthStyle,value:localSheetIdValue,options,onChange:setLocalSheetIdValue})}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(design_src.pd,{affixWrapperStyle:widthStyle,placeholder:localeService.t("definedName.inputCommentPlaceholder"),value:commentValue,onChange:setCommentValue})}),(0,jsx_runtime.jsxs)("div",{style:{display:0===validString.length?"none":"flex"},className:views_defined_name_index_module.definedNameInputValidation,children:[(0,jsx_runtime.jsx)("span",{children:validString}),(0,jsx_runtime.jsx)(error_single.A,{})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(design_src.$n,{onClick:()=>{cancel&&cancel()},children:localeService.t("definedName.cancel")}),(0,jsx_runtime.jsx)(design_src.$n,{style:{marginLeft:15},type:"primary",onClick:()=>{if(0===nameValue.length)return void setValidString(localeService.t("definedName.nameEmpty"));if(null!=definedNamesService.getValueByName(unitId,nameValue)&&(null==id||0===id.length))return void setValidString(localeService.t("definedName.nameDuplicate"));if(!src.S0q.isValidParameter(nameValue)||(0,engine_formula_src.wQ)(nameValue)||!src.S0q.isStartValidPosition(nameValue)&&!(0,engine_render_src.qCQ)(nameValue.substring(0,1)))return void setValidString(localeService.t("definedName.nameInvalid"));if(workbook.getSheetOrders().map((sheetId=>workbook.getSheetBySheetId(sheetId)?.getName()||"")).includes(nameValue))return void setValidString(localeService.t("definedName.nameSheetConflict"));if(0===formulaOrRefStringValue.length)return void setValidString(localeService.t("definedName.formulaOrRefStringEmpty"));if(!validFormulaOrRange)return void setValidString(localeService.t("definedName.formulaOrRefStringInvalid"));if(functionService.hasExecutor(nameValue.toUpperCase()))return void setValidString(localeService.t("definedName.nameConflict"));const currentSheetName=workbook.getActiveSheet().getName();confirm&&confirm({id:id||"",name:nameValue,formulaOrRefString:lexerTreeBuilder.convertRefersToAbsolute(formulaOrRefStringValue,src.F6v.ALL,src.F6v.ALL,currentSheetName),comment:commentValue,localSheetId:localSheetIdValue})},children:localeService.t("definedName.confirm")})]})]})},DefinedNameContainer=()=>{const commandService=(0,ui_src.fJ)(src.wTY),workbook=(0,ui_src.fJ)(src.HCr).getCurrentUnitForType(src.Zy$.UNIVER_SHEET),localeService=(0,ui_src.fJ)(src.iH9),definedNamesService=(0,ui_src.fJ)(engine_formula_src.ke),selectionManagerService=(0,ui_src.fJ)(sheets_src.Fal);if(null==workbook)return;const unitId=workbook.getUnitId(),getDefinedNameMap=()=>{const definedNameMap=definedNamesService.getDefinedNameMap(unitId);return definedNameMap?Array.from(Object.values(definedNameMap)):[]},[editState,setEditState]=(0,react.useState)(!1),[definedNames,setDefinedNames]=(0,react.useState)(getDefinedNameMap()),[editorKey,setEditorKey]=(0,react.useState)(null),[deleteConformKey,setDeleteConformKey]=(0,react.useState)();(0,react.useEffect)((()=>{const definedNamesSubscription=definedNamesService.update$.subscribe((()=>{setDefinedNames(getDefinedNameMap())}));return()=>{definedNamesSubscription.unsubscribe()}}),[]);const insertConfirm=param=>{const{name,formulaOrRefString,comment,localSheetId,hidden}=param;let id=param.id;if(null==id||0===id.length)id=src.S0q.generateRandomId(10),commandService.executeCommand(sheets_src.xDg.id,{id,unitId,name,formulaOrRefString,comment,localSheetId,hidden});else{const newDefinedName={id,unitId,name,formulaOrRefString,comment,localSheetId,hidden};commandService.executeCommand(sheets_src.iAm.id,newDefinedName)}setEditState(!1),setEditorKey(null)};function handleDeleteClose(){setDeleteConformKey(null)}const closeInput=()=>{setEditState(!1),setEditorKey(null)},getSheetNameBySheetId=sheetId=>{const sheet=workbook.getSheetBySheetId(sheetId);return null==sheet?"":sheet.getName()};return(0,jsx_runtime.jsx)("div",{className:views_defined_name_index_module.definedNameContainer,children:(0,jsx_runtime.jsxs)("div",{className:views_defined_name_index_module.definedNameContainerScroll,children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsxs)("div",{onClick:()=>{setEditState(!0),setEditorKey(null)},className:views_defined_name_index_module.definedNameContainerAddButton,style:{display:editState?"none":"flex"},children:[(0,jsx_runtime.jsx)(increase_single.A,{}),(0,jsx_runtime.jsx)("span",{className:views_defined_name_index_module.definedNameContainerAddButtonText,children:localeService.t("definedName.addButton")})]}),editState&&(0,jsx_runtime.jsx)(DefinedNameInput,{confirm:insertConfirm,cancel:closeInput,state:editState,inputId:"insertDefinedName",name:(()=>{const count=definedNames.length+1,name=localeService.t("definedName.defaultName")+count;if(null==definedNamesService.getValueByName(unitId,name))return name;let i=count+1;for(;;){const newName=localeService.t("definedName.defaultName")+i;if(null==definedNamesService.getValueByName(unitId,newName))return newName;i++}})(),formulaOrRefString:(()=>{const sheetName=workbook.getActiveSheet()?.getName();if(!sheetName)return"";const selections=selectionManagerService.getCurrentSelections();if(null==selections)return"";const formulaOrRefs=selections.map((selection=>(0,engine_formula_src.jz)(sheetName,selection.range)));return formulaOrRefs.join(",")})()})]},"insertDefinedName"),definedNames.map(((definedName,index)=>(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsxs)("div",{onClick:()=>{(async definedName=>{const{formulaOrRefString,id}=definedName,worksheet=definedNamesService.getWorksheetByRef(unitId,formulaOrRefString);if(!worksheet)return;worksheet.isSheetHidden()&&await commandService.executeCommand(sheets_src.dSt.id,{unitId,subUnitId:worksheet.getSheetId()}),definedNamesService.focusRange(unitId,id)})(definedName)},className:views_defined_name_index_module.definedNameContainerItem,style:{display:definedName.id===editorKey?"none":"flex"},children:[(0,jsx_runtime.jsxs)("div",{title:definedName.comment,children:[(0,jsx_runtime.jsxs)("div",{className:views_defined_name_index_module.definedNameContainerItemName,children:[definedName.name,(0,jsx_runtime.jsx)("span",{className:views_defined_name_index_module.definedNameContainerItemNameForSheet,children:definedName.localSheetId===sheets_src.Gjg||null==definedName.localSheetId?"":getSheetNameBySheetId(definedName.localSheetId)})]}),(0,jsx_runtime.jsx)("div",{className:views_defined_name_index_module.definedNameContainerItemFormulaOrRefString,children:definedName.formulaOrRefString})]}),(0,jsx_runtime.jsx)(design_src.m_,{title:localeService.t("definedName.updateButton"),placement:"top",children:(0,jsx_runtime.jsx)("div",{className:(0,design_src.$z)(views_defined_name_index_module.definedNameContainerItemUpdate,views_defined_name_index_module.definedNameContainerItemShow),onClick:()=>{var id;id=definedName.id,setEditState(!1),setEditorKey(id)},children:(0,jsx_runtime.jsx)(check_mark_single.A,{})})}),(0,jsx_runtime.jsx)(design_src.m_,{title:localeService.t("definedName.deleteButton"),placement:"top",children:(0,jsx_runtime.jsx)("div",{className:(0,design_src.$z)(views_defined_name_index_module.definedNameContainerItemDelete,views_defined_name_index_module.definedNameContainerItemShow),onClick:()=>{var id;id=definedName.id,setDeleteConformKey(id)},children:(0,jsx_runtime.jsx)(delete_single.A,{})})})]}),(0,jsx_runtime.jsx)(design_src.pT,{visible:deleteConformKey===definedName.id,onClose:handleDeleteClose,onConfirm:()=>{!function handleDeleteConfirm(id){const item=definedNamesService.getValueById(unitId,id);commandService.executeCommand(sheets_src.EIv.id,{...item,unitId}),setDeleteConformKey(null)}(definedName.id)},children:localeService.t("definedName.deleteConfirmText")}),definedName.id===editorKey&&(0,jsx_runtime.jsx)(DefinedNameInput,{confirm:insertConfirm,cancel:closeInput,state:definedName.id===editorKey,id:definedName.id,inputId:definedName.id+index,name:definedName.name,formulaOrRefString:definedName.formulaOrRefString,comment:definedName.comment,localSheetId:definedName.localSheetId})]},index)))]})})};DefinedNameContainer.__docgenInfo={description:"",methods:[],displayName:"DefinedNameContainer"};const CLEAR_SELECTION_MENU_ID="sheet.menu.clear-selection";function ClearSelectionMenuItemFactory(accessor){return{id:"sheet.menu.clear-selection",type:ui_src.xU.SUBITEMS,icon:"ClearFormat",title:"rightClick.clearSelection",hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}function ClearSelectionContentMenuItemFactory(accessor){return{id:sheets_src.kyo.id,type:ui_src.xU.BUTTON,title:"rightClick.clearContent",disabled$:getObservableWithExclusiveRange$(accessor,menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.r$W],rangeTypes:[sheets_src.o9h]})),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}function ClearSelectionFormatMenuItemFactory(accessor){return{id:sheets_src.igE.id,type:ui_src.xU.BUTTON,title:"rightClick.clearFormat",disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.nhd],rangeTypes:[sheets_src.o9h]}),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}function ClearSelectionAllMenuItemFactory(accessor){return{id:sheets_src.sd6.id,type:ui_src.xU.BUTTON,title:"rightClick.clearAll",disabled$:getObservableWithExclusiveRange$(accessor,menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.r$W,sheets_src.nhd],rangeTypes:[sheets_src.o9h]})),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}const DELETE_RANGE_MENU_ID="sheet.menu.delete";function RemoveColMenuItemFactory(accessor){return{id:RemoveColConfirmCommand.id,type:ui_src.xU.BUTTON,icon:"DeleteColumn",title:"rightClick.deleteSelectedColumn",hidden$:getObservableWithExclusiveRange$(accessor,getDeleteMenuHidden$(accessor,"col")),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.bjH]})}}function RemoveRowMenuItemFactory(accessor){return{id:RemoveRowConfirmCommand.id,type:ui_src.xU.BUTTON,icon:"DeleteRow",title:"rightClick.deleteSelectedRow",disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.FlU]}),hidden$:getDeleteMenuHidden$(accessor,"row")}}const CELL_INSERT_MENU_ID="sheet.menu.cell-insert";function getAddPermissionHidden$(accessor){const workbook$=accessor.get(src.HCr).getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET),userManagerService=accessor.get(src.szM);return(0,combineLatest.z)([workbook$,userManagerService.currentUser$]).pipe((0,switchMap.n)((([workbook,_])=>workbook?workbook.activeSheet$.pipe((0,switchMap.n)((worksheet=>{if(!worksheet)return(0,observable_of.of)(!0);const rangeProtectionRuleModel=accessor.get(sheets_src.qI9),worksheetRuleModel=accessor.get(sheets_src.$af),selectionManagerService=accessor.get(sheets_src.Fal);return(0,observable_merge.h)(selectionManagerService.selectionMoveEnd$,rangeProtectionRuleModel.ruleChange$,worksheetRuleModel.ruleChange$).pipe((0,operators_map.T)((()=>{const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId(),subUnitRuleList=rangeProtectionRuleModel.getSubunitRuleList(unitId,subUnitId),selections=selectionManagerService.getCurrentSelections(),selectionsRanges=selections?.map((selection=>selection.range)),ruleRanges=subUnitRuleList.map((rule=>rule.ranges)).flat();if(!selectionsRanges)return!1;const worksheetRule=worksheetRuleModel.getRule(unitId,subUnitId);return!!worksheetRule?.permissionId||selectionsRanges?.some((selectionRange=>ruleRanges.some((ruleRange=>src.M_G.intersects(selectionRange,ruleRange)))))})))}))):(0,observable_of.of)(!0))))}function getEditPermissionHidden$(accessor){const univerInstanceService=accessor.get(src.HCr),rangeRuleModel=accessor.get(sheets_src.qI9),workbook$=univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET),userManagerService=accessor.get(src.szM);return(0,combineLatest.z)([workbook$,userManagerService.currentUser$]).pipe((0,switchMap.n)((([workbook,_])=>workbook?workbook.activeSheet$.pipe((0,switchMap.n)((worksheet=>{if(!worksheet)return(0,observable_of.of)(!0);const rangeProtectionRuleModel=accessor.get(sheets_src.qI9),worksheetRuleModel=accessor.get(sheets_src.$af),permissionService=accessor.get(src.QWp),selectionManagerService=accessor.get(sheets_src.Fal);return(0,observable_merge.h)(selectionManagerService.selectionMoveEnd$,rangeProtectionRuleModel.ruleChange$,worksheetRuleModel.ruleChange$).pipe((0,operators_map.T)((()=>{const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId(),subUnitRuleList=rangeRuleModel.getSubunitRuleList(unitId,subUnitId),selectionRanges=selectionManagerService.getCurrentSelections()?.map((selection=>selection.range));subUnitRuleList.map((rule=>rule.ranges)).flat();if(!selectionRanges?.length)return!0;if(selectionRanges.length>1)return!0;const selectionRange=selectionRanges[0];if(selectionRange?.rangeType===src.$uV.ALL||selectionRange?.rangeType===src.$uV.COLUMN||selectionRange?.rangeType===src.$uV.ROW)return!0;const worksheetRule=worksheetRuleModel.getRule(unitId,subUnitId);if(worksheetRule?.permissionId)return!1===permissionService.getPermissionPoint(new sheets_src.rou(unitId,subUnitId).id)?.value;if(1!==subUnitRuleList.filter((rule=>rule.ranges.some((range=>src.M_G.intersects(range,selectionRange))))).length)return!0;const{startRow,endRow,startColumn,endColumn}=selectionRange,rangeProtectionCache=accessor.get(sheets_src.vL8);for(let i=startRow;i<=endRow;i++)for(let j=startColumn;j<=endColumn;j++){const cellInfo=rangeProtectionCache.getCellInfo(unitId,subUnitId,i,j);if(cellInfo)return!1===cellInfo[sheets_src.pS2.ManageCollaborator]}return!1})))}))):(0,observable_of.of)(!0))))}function getPermissionDisableBase$(accessor){const univerInstanceService=accessor.get(src.HCr),permissionService=accessor.get(src.QWp),workbook$=univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET),userManagerService=accessor.get(src.szM);return(0,combineLatest.z)([workbook$,userManagerService.currentUser$]).pipe((0,switchMap.n)((([workbook,_])=>workbook?workbook.activeSheet$.pipe((0,switchMap.n)((worksheet=>{if(!worksheet)return(0,observable_of.of)(!0);const unitId=workbook.getUnitId(),selectionManagerService=accessor.get(sheets_src.Fal),selectionProtectionRuleModel=accessor.get(sheets_src.qI9),worksheetProtectionRuleModel=accessor.get(sheets_src.$af),permission$=permissionService.composePermission$([new sheets_src.W30(unitId).id]).pipe((0,operators_map.T)((permissions=>permissions.every((permission=>permission.value)))))??(0,observable_of.of)(!1),ruleChange$=(0,observable_merge.h)(selectionProtectionRuleModel.ruleChange$,worksheetProtectionRuleModel.ruleChange$).pipe((0,operators_startWith.Z)(null));return(0,combineLatest.z)([permission$,ruleChange$,selectionManagerService.selectionMoveEnd$]).pipe((0,operators_map.T)((([permission,_,__])=>{if(!permission)return!0;const selections=selectionManagerService.getCurrentSelections(),selectionRanges=selections?.map((selection=>selection.range));return!!selectionRanges?.length&&selectionRanges.length>1})))}))):(0,observable_of.of)(!0))))}function getAddPermissionDisableBase$(accessor){const univerInstanceService=accessor.get(src.HCr),permissionService=accessor.get(src.QWp),workbook$=univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET),userManagerService=accessor.get(src.szM),editorBridgeService=accessor.has(editor_bridge_service_IEditorBridgeService)?accessor.get(editor_bridge_service_IEditorBridgeService):null,formulaEditorFocus$=accessor.get(src.oaf).subscribeContextValue$(src.kgb),editorVisible$=editorBridgeService?.visible$??(0,observable_of.of)(null);return(0,combineLatest.z)([workbook$,userManagerService.currentUser$,editorVisible$,formulaEditorFocus$]).pipe((0,switchMap.n)((([workbook,_,visible,formulaEditorFocus])=>!workbook||visible?.visible&&visible.unitId===workbook.getUnitId()||formulaEditorFocus?(0,observable_of.of)(!0):workbook.activeSheet$.pipe((0,switchMap.n)((worksheet=>{if(!worksheet)return(0,observable_of.of)(!0);const focusingDrawing$=accessor.get(src.oaf).subscribeContextValue$(src.fiP).pipe((0,operators_startWith.Z)(!1)),unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId(),selectionProtectionRuleModel=accessor.get(sheets_src.qI9),worksheetProtectionRuleModel=accessor.get(sheets_src.$af),selectionManagerService=accessor.get(sheets_src.Fal),permission$=permissionService.composePermission$([new sheets_src.l5B(unitId).id]).pipe((0,operators_map.T)((permissions=>permissions.every((permission=>permission.value)))))??(0,observable_of.of)(!1),ruleChange$=(0,observable_merge.h)(selectionProtectionRuleModel.ruleChange$,worksheetProtectionRuleModel.ruleChange$).pipe((0,operators_startWith.Z)(null));return(0,combineLatest.z)([permission$,ruleChange$,selectionManagerService.selectionMoveEnd$,focusingDrawing$]).pipe((0,operators_map.T)((([permission,_,__,focus])=>{if(!permission||focus)return!0;const selections=selectionManagerService.getCurrentSelections(),selectionRanges=selections?.map((selection=>selection.range));if(!selectionRanges?.length)return!0;const worksheetRule=worksheetProtectionRuleModel.getRule(unitId,subUnitId);if(worksheetRule?.permissionId)return!0;const subunitRuleList=selectionProtectionRuleModel.getSubunitRuleList(unitId,subUnitId),hasLap=selectionRanges?.some((selectionRange=>subunitRuleList.some((rule=>rule.ranges.some((ruleRange=>src.M_G.intersects(selectionRange,ruleRange)))))));return hasLap})))}))))))}function getAddPermissionFromSheetBarDisable$(accessor){const univerInstanceService=accessor.get(src.HCr),permissionService=accessor.get(src.QWp),workbook$=univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET),userManagerService=accessor.get(src.szM);return(0,combineLatest.z)([workbook$,userManagerService.currentUser$]).pipe((0,switchMap.n)((([workbook,_])=>workbook?workbook.activeSheet$.pipe((0,switchMap.n)((worksheet=>{if(!worksheet)return(0,observable_of.of)(!0);const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId(),selectionProtectionRuleModel=accessor.get(sheets_src.qI9),worksheetProtectionRuleModel=accessor.get(sheets_src.$af),permission$=permissionService.composePermission$([new sheets_src.l5B(unitId).id]).pipe((0,operators_map.T)((permissions=>permissions.every((permission=>permission.value)))))??(0,observable_of.of)(!1),ruleChange$=(0,observable_merge.h)(selectionProtectionRuleModel.ruleChange$,worksheetProtectionRuleModel.ruleChange$).pipe((0,operators_startWith.Z)(null));return(0,combineLatest.z)([permission$,ruleChange$]).pipe((0,operators_map.T)((([permission,_])=>{if(!permission)return!0;const worksheetRule=worksheetProtectionRuleModel.getRule(unitId,subUnitId);if(worksheetRule?.permissionId)return!0;const subUnitRuleList=selectionProtectionRuleModel.getSubunitRuleList(unitId,subUnitId)?.filter((item=>item?.permissionId));return subUnitRuleList.length>0})))}))):(0,observable_of.of)(!0))))}function getRemovePermissionFromSheetBarDisable$(accessor){const univerInstanceService=accessor.get(src.HCr),permissionService=accessor.get(src.QWp),workbook$=univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET),userManagerService=accessor.get(src.szM);return(0,combineLatest.z)([workbook$,userManagerService.currentUser$]).pipe((0,switchMap.n)((([workbook,_])=>workbook?workbook.activeSheet$.pipe((0,switchMap.n)((worksheet=>{if(!worksheet)return(0,observable_of.of)(!0);const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId(),worksheetProtectionRuleModel=accessor.get(sheets_src.$af);return worksheetProtectionRuleModel.ruleChange$.pipe((0,operators_startWith.Z)(null)).pipe((0,operators_map.T)((()=>!worksheetProtectionRuleModel.getRule(unitId,subUnitId)||!1===permissionService.getPermissionPoint(new sheets_src.i6_(unitId,subUnitId).id)?.value)))}))):(0,observable_of.of)(!0))))}function getSetPermissionFromSheetBarDisable$(accessor){const univerInstanceService=accessor.get(src.HCr),permissionService=accessor.get(src.QWp),workbook$=univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET),userManagerService=accessor.get(src.szM);return(0,combineLatest.z)([workbook$,userManagerService.currentUser$]).pipe((0,switchMap.n)((([workbook,_])=>workbook?workbook.activeSheet$.pipe((0,switchMap.n)((worksheet=>{if(!worksheet)return(0,observable_of.of)(!0);const unitId=workbook.getUnitId(),selectionProtectionRuleModel=accessor.get(sheets_src.qI9),worksheetProtectionRuleModel=accessor.get(sheets_src.$af),permission$=permissionService.composePermission$([new sheets_src.l5B(unitId).id,new sheets_src.d0P(unitId).id]).pipe((0,operators_map.T)((permissions=>permissions.every((permission=>permission.value)))))??(0,observable_of.of)(!1),worksheetRuleChange$=worksheetProtectionRuleModel.ruleChange$.pipe((0,operators_startWith.Z)(null)),selectionRuleChange$=selectionProtectionRuleModel.ruleChange$.pipe((0,operators_startWith.Z)(null));return(0,combineLatest.z)([permission$,worksheetRuleChange$,selectionRuleChange$]).pipe((0,operators_map.T)((([permission,_,__])=>{if(!permission)return!0;const subUnitId=worksheet.getSheetId(),worksheetRule=worksheetProtectionRuleModel.getRule(unitId,subUnitId),selectionRuleList=selectionProtectionRuleModel.getSubunitRuleList(unitId,subUnitId);return!worksheetRule&&!selectionRuleList.length})))}))):(0,observable_of.of)(!0))))}function getRemovePermissionDisable$(accessor){const univerInstanceService=accessor.get(src.HCr),permissionService=accessor.get(src.QWp),workbook$=univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET),userManagerService=accessor.get(src.szM);return(0,combineLatest.z)([workbook$,userManagerService.currentUser$]).pipe((0,switchMap.n)((([workbook,_])=>workbook?workbook.activeSheet$.pipe((0,switchMap.n)((worksheet=>{if(!worksheet)return(0,observable_of.of)(!0);const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId(),sheetSelectionsService=accessor.get(sheets_src.Fal),selectionProtectionRuleModel=accessor.get(sheets_src.qI9),worksheetProtectionRuleModel=accessor.get(sheets_src.$af),changes$=(0,observable_merge.h)(selectionProtectionRuleModel.ruleChange$,worksheetProtectionRuleModel.ruleChange$,sheetSelectionsService.selectionMoveEnd$).pipe((0,operators_startWith.Z)(null));return(0,combineLatest.z)([changes$]).pipe((0,operators_map.T)((([_])=>{const selections=accessor.get(sheets_src.Fal).getCurrentSelections(),selectionRanges=selections?.map((selection=>selection.range));if(!selectionRanges?.length||selectionRanges.length>1)return!0;const selectionRange=selectionRanges[0];if(selectionRange?.rangeType===src.$uV.ALL||selectionRange?.rangeType===src.$uV.COLUMN||selectionRange?.rangeType===src.$uV.ROW)return!0;const worksheetRule=worksheetProtectionRuleModel.getRule(unitId,subUnitId);if(worksheetRule?.permissionId)return!1===permissionService.getPermissionPoint(new sheets_src.i6_(unitId,subUnitId).id)?.value;if(1!==selectionProtectionRuleModel.getSubunitRuleList(unitId,subUnitId).filter((rule=>rule.ranges.some((range=>src.M_G.intersects(range,selectionRange))))).length)return!0;const{startRow,endRow,startColumn,endColumn}=selectionRange,rangeProtectionCache=accessor.get(sheets_src.vL8);for(let i=startRow;i<=endRow;i++)for(let j=startColumn;j<=endColumn;j++){const cellInfo=rangeProtectionCache.getCellInfo(unitId,subUnitId,i,j);if(cellInfo)return!1===cellInfo[sheets_src.pS2.Delete]}return!1})))}))):(0,observable_of.of)(!0))))}function getViewPermissionDisable$(accessor){const univerInstanceService=accessor.get(src.HCr),permissionService=accessor.get(src.QWp),workbook$=univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET),userManagerService=accessor.get(src.szM),editorBridgeService=accessor.has(editor_bridge_service_IEditorBridgeService)?accessor.get(editor_bridge_service_IEditorBridgeService):null,formulaEditorFocus$=accessor.get(src.oaf).subscribeContextValue$(src.kgb),editorVisible$=editorBridgeService?.visible$??(0,observable_of.of)(null);return(0,combineLatest.z)([workbook$,userManagerService.currentUser$,editorVisible$,formulaEditorFocus$]).pipe((0,switchMap.n)((([workbook,_,visible,formulaEditorFocus])=>!workbook||visible?.visible&&visible.unitId===workbook.getUnitId()||formulaEditorFocus?(0,observable_of.of)(!0):workbook.activeSheet$.pipe((0,switchMap.n)((worksheet=>{if(!worksheet)return(0,observable_of.of)(!0);const unitId=workbook.getUnitId();return(permissionService.getPermissionPoint$(new sheets_src.W30(unitId).id)?.pipe((0,operators_map.T)((e=>!!e.value)))??(0,observable_of.of)(!1)).pipe((0,operators_map.T)((permission=>!permission)))}))))))}const SHEET_PERMISSION_CONTEXT_MENU_ID="sheet.contextMenu.permission";function sheetPermissionContextMenuFactory(accessor){return{id:"sheet.contextMenu.permission",type:ui_src.xU.SUBITEMS,title:"rightClick.protectRange",icon:permissionLockIconKey,hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}function sheetPermissionAddProtectContextMenuFactory(accessor){return{id:AddRangeProtectionFromContextMenuCommand.id,type:ui_src.xU.BUTTON,title:"rightClick.turnOnProtectRange",hidden$:getAddPermissionHidden$(accessor),disabled$:getAddPermissionDisableBase$(accessor)}}function sheetPermissionEditProtectContextMenuFactory(accessor){return{id:SetRangeProtectionFromContextMenuCommand.id,type:ui_src.xU.BUTTON,title:"rightClick.editProtectRange",disabled$:getPermissionDisableBase$(accessor),hidden$:getEditPermissionHidden$(accessor)}}function sheetPermissionRemoveProtectContextMenuFactory(accessor){return{id:DeleteRangeProtectionFromContextMenuCommand.id,type:ui_src.xU.BUTTON,title:"rightClick.removeProtectRange",disabled$:getRemovePermissionDisable$(accessor),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}function sheetPermissionViewAllProtectRuleContextMenuFactory(accessor){return{id:ViewSheetPermissionFromContextMenuCommand.id,type:ui_src.xU.BUTTON,title:"rightClick.viewAllProtectArea",disabled$:getViewPermissionDisable$(accessor),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}function disableFunction(univerInstanceService,subscriber){const worksheets=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET).getWorksheets(),visibleSheets=Array.from(worksheets.values()).filter((sheet=>sheet.getConfig().hidden===src.OdA.FALSE));subscriber.next(1===visibleSheets.length)}const menuSchema={[ui_src.My.FORMAT]:{[SetOnceFormatPainterCommand.id]:{order:0,menuItemFactory:function FormatPainterMenuItemFactory(accessor){const formatPainterService=accessor.get(IFormatPainterService);return{id:SetOnceFormatPainterCommand.id,subId:SetInfiniteFormatPainterCommand.id,type:ui_src.xU.BUTTON,icon:"BrushSingle",title:"Format Painter",tooltip:"toolbar.formatPainter",activated$:new internal_Observable.c((subscriber=>{let active=!1;const status$=formatPainterService.status$.subscribe((s=>{active=s!==FormatPainterStatus.OFF,subscriber.next(active)}));return subscriber.next(active),()=>{status$.unsubscribe()}})),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.$Rn,sheets_src.qGK],rangeTypes:[sheets_src.o9h]},!0)}}},[SetRangeBoldCommand.id]:{order:1,menuItemFactory:function BoldMenuItemFactory(accessor){const commandService=accessor.get(src.wTY),univerInstanceService=accessor.get(src.HCr),contextService=accessor.get(src.oaf),selectionManagerService=accessor.get(sheets_src.Fal);return{id:SetRangeBoldCommand.id,type:ui_src.xU.BUTTON,icon:"BoldSingle",title:"Set bold",tooltip:"toolbar.bold",disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.nhd],rangeTypes:[sheets_src.o9h]},!0),activated$:deriveStateFromActiveSheet$(univerInstanceService,!1,(({worksheet})=>new internal_Observable.c((subscriber=>{const disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id===sheets_src.N48.id||id===sheets_src.NSB.id||id===sheets_src._M5.id){const primary=selectionManagerService.getCurrentLastSelection()?.primary;let isBold=src.ITE.NORMAL;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);isBold=range?.getFontWeight()}subscriber.next(isBold===src.ITE.BOLD)}if((id===docs_src.Uh.id||id===inline_format_command.EM.id)&&contextService.getContextValue(src.AF$)&&contextService.getContextValue(src.xU)){const textRun=getFontStyleAtCursor(accessor);if(null==textRun)return;const bl=textRun.ts?.bl;subscriber.next(bl===src.OdA.TRUE)}})),primary=selectionManagerService.getCurrentLastSelection()?.primary;if(!worksheet)return void subscriber.next(!1);let isBold=src.ITE.NORMAL;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);isBold=range?.getFontWeight()}return subscriber.next(isBold===src.ITE.BOLD),disposable.dispose})))),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[SetRangeItalicCommand.id]:{order:2,menuItemFactory:function ItalicMenuItemFactory(accessor){const commandService=accessor.get(src.wTY),univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),contextService=accessor.get(src.oaf);return{id:SetRangeItalicCommand.id,type:ui_src.xU.BUTTON,icon:"ItalicSingle",title:"Set italic",tooltip:"toolbar.italic",disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.nhd],rangeTypes:[sheets_src.o9h]},!0),activated$:deriveStateFromActiveSheet$(univerInstanceService,!1,(({worksheet})=>new internal_Observable.c((subscriber=>{const disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id===sheets_src.N48.id||id===sheets_src.NSB.id||id===sheets_src._M5.id){const primary=selectionManagerService.getCurrentLastSelection()?.primary;let isItalic=src.YfY.NORMAL;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);isItalic=range?.getFontStyle()}subscriber.next(isItalic===src.YfY.ITALIC)}if((id===docs_src.Uh.id||id===inline_format_command.EM.id)&&contextService.getContextValue(src.AF$)&&contextService.getContextValue(src.xU)){const textRun=getFontStyleAtCursor(accessor);if(null==textRun)return;const it=textRun.ts?.it;subscriber.next(it===src.OdA.TRUE)}})),primary=selectionManagerService.getCurrentLastSelection()?.primary;let isItalic=src.YfY.NORMAL;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);isItalic=range?.getFontStyle()}return subscriber.next(isItalic===src.YfY.ITALIC),disposable.dispose})))),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[SetRangeUnderlineCommand.id]:{order:3,menuItemFactory:function UnderlineMenuItemFactory(accessor){const commandService=accessor.get(src.wTY),univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),contextService=accessor.get(src.oaf);return{id:SetRangeUnderlineCommand.id,type:ui_src.xU.BUTTON,icon:"UnderlineSingle",title:"Set underline",tooltip:"toolbar.underline",activated$:deriveStateFromActiveSheet$(univerInstanceService,!1,(({worksheet})=>new internal_Observable.c((subscriber=>{const disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id===sheets_src.N48.id||id===sheets_src.NSB.id||id===sheets_src._M5.id){const primary=selectionManagerService.getCurrentLastSelection()?.primary;let isUnderline;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);isUnderline=range?.getUnderline()}subscriber.next(!(!isUnderline||!isUnderline.s))}if((id===docs_src.Uh.id||id===inline_format_command.EM.id)&&contextService.getContextValue(src.AF$)&&contextService.getContextValue(src.xU)){const textRun=getFontStyleAtCursor(accessor);if(null==textRun)return;const ul=textRun.ts?.ul;subscriber.next(ul?.s===src.OdA.TRUE)}})),primary=selectionManagerService.getCurrentLastSelection()?.primary;let isUnderline;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);isUnderline=range?.getUnderline()}return subscriber.next(!(!isUnderline||!isUnderline.s)),disposable.dispose})))),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.nhd],rangeTypes:[sheets_src.o9h]},!0),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[SetRangeStrickThroughCommand.id]:{order:4,menuItemFactory:function StrikeThroughMenuItemFactory(accessor){const commandService=accessor.get(src.wTY),univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),contextService=accessor.get(src.oaf);return{id:SetRangeStrickThroughCommand.id,type:ui_src.xU.BUTTON,icon:"StrikethroughSingle",title:"Set strike through",tooltip:"toolbar.strikethrough",disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.nhd],rangeTypes:[sheets_src.o9h]},!0),activated$:deriveStateFromActiveSheet$(univerInstanceService,!1,(({worksheet})=>new internal_Observable.c((subscriber=>{const disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id===sheets_src.N48.id||id===sheets_src.NSB.id||id===sheets_src._M5.id){const primary=selectionManagerService.getCurrentLastSelection()?.primary;let st;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);st=range?.getStrikeThrough()}subscriber.next(!(!st||!st.s))}if((id===docs_src.Uh.id||id===inline_format_command.EM.id)&&contextService.getContextValue(src.AF$)&&contextService.getContextValue(src.xU)){const textRun=getFontStyleAtCursor(accessor);if(null==textRun)return;const st=textRun.ts?.st;subscriber.next(st?.s===src.OdA.TRUE)}})),primary=selectionManagerService.getCurrentLastSelection()?.primary;let st;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);st=range?.getStrikeThrough()}return subscriber.next(!(!st||!st.s)),disposable.dispose})))),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[SetRangeFontFamilyCommand.id]:{order:5,menuItemFactory:function FontFamilySelectorMenuItemFactory(accessor){const commandService=accessor.get(src.wTY),univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),defaultValue=src.Hnp.ff;return{id:SetRangeFontFamilyCommand.id,tooltip:"toolbar.font",type:ui_src.xU.SELECTOR,label:"UI_PLUGIN_SHEETS_FONT_FAMILY_COMPONENT",selections:ui_src.Mc.map((item=>({label:{name:"UI_PLUGIN_SHEETS_FONT_FAMILY_ITEM_COMPONENT"},value:item.value}))),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.nhd],rangeTypes:[sheets_src.o9h]},!0),value$:deriveStateFromActiveSheet$(univerInstanceService,defaultValue,(({worksheet})=>new internal_Observable.c((subscriber=>{const disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id!==sheets_src.N48.id&&id!==sheets_src.NSB.id&&id!==sheets_src._M5.id)return;const primary=selectionManagerService.getCurrentLastSelection()?.primary;let ff;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);ff=range?.getFontFamily()}subscriber.next(ff??defaultValue)})),primary=selectionManagerService.getCurrentLastSelection()?.primary;let ff;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);ff=range?.getFontFamily()}return subscriber.next(ff??defaultValue),disposable.dispose})))),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[SetRangeFontSizeCommand.id]:{order:6,menuItemFactory:function FontSizeSelectorMenuItemFactory(accessor){const commandService=accessor.get(src.wTY),univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),contextService=accessor.get(src.oaf),defaultValue=src.Hnp.fs,disabled$=menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.nhd],rangeTypes:[sheets_src.o9h]},!0);return{id:SetRangeFontSizeCommand.id,type:ui_src.xU.SELECTOR,tooltip:"toolbar.fontSize",label:{name:"UI_PLUGIN_SHEETS_FONT_SIZE_COMPONENT",props:{min:1,max:400,disabled$}},selections:ui_src.X5,disabled$,value$:deriveStateFromActiveSheet$(univerInstanceService,defaultValue,(({worksheet})=>new internal_Observable.c((subscriber=>{const disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id===sheets_src.N48.id||id===sheets_src.NSB.id||id===sheets_src._M5.id){const primary=selectionManagerService.getCurrentLastSelection()?.primary;let fs;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);fs=range?.getFontSize()}subscriber.next(fs??defaultValue)}if((id===docs_src.Uh.id||id===inline_format_command.EM.id)&&contextService.getContextValue(src.AF$)&&contextService.getContextValue(src.xU)){const textRun=getFontStyleAtCursor(accessor);if(null==textRun)return;const fs=textRun.ts?.fs;subscriber.next(fs??defaultValue)}})),primary=selectionManagerService.getCurrentLastSelection()?.primary;let fs;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);fs=range?.getFontSize()}return subscriber.next(fs??defaultValue),disposable.dispose})))),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[SetRangeTextColorCommand.id]:{order:7,menuItemFactory:function TextColorSelectorMenuItemFactory(accessor){const commandService=accessor.get(src.wTY),themeService=accessor.get(src.Fsb);return{id:SetRangeTextColorCommand.id,icon:"FontColor",tooltip:"toolbar.textColor.main",type:ui_src.xU.BUTTON_SELECTOR,selections:[{label:{name:COLOR_PICKER_COMPONENT,hoverable:!1,selectable:!1}}],value$:new internal_Observable.c((subscriber=>{const defaultValue=themeService.getCurrentTheme().textColor,disposable=commandService.onCommandExecuted((c=>{if(c.id===SetRangeTextColorCommand.id){const color=c.params.value;subscriber.next(color??defaultValue)}}));return subscriber.next(defaultValue),disposable.dispose})),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.nhd],rangeTypes:[sheets_src.o9h]},!0)}},[sheets_src.nms.id]:{order:0,menuItemFactory:function ResetTextColorMenuItemFactory(accessor){return{id:ResetRangeTextColorCommand.id,type:ui_src.xU.BUTTON,title:"toolbar.resetColor",icon:"NoColor",disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.nhd],rangeTypes:[sheets_src.o9h]},!0),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}}},[sheets_src.H6w.id]:{order:9,menuItemFactory:function BackgroundColorSelectorMenuItemFactory(accessor){const commandService=accessor.get(src.wTY),themeService=accessor.get(src.Fsb);return{id:sheets_src.H6w.id,tooltip:"toolbar.fillColor.main",type:ui_src.xU.BUTTON_SELECTOR,icon:"PaintBucket",selections:[{label:{name:COLOR_PICKER_COMPONENT,hoverable:!1,selectable:!1}}],value$:new internal_Observable.c((subscriber=>{const defaultValue=themeService.getCurrentTheme().primaryColor,disposable=commandService.onCommandExecuted((c=>{if(c.id===sheets_src.H6w.id){const color=c.params.value;subscriber.next(color??defaultValue)}}));return subscriber.next(defaultValue),disposable.dispose})),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.nhd],rangeTypes:[sheets_src.o9h]})}},[sheets_src.mkI.id]:{order:0,menuItemFactory:function ResetBackgroundColorMenuItemFactory(accessor){return{id:sheets_src.mkI.id,type:ui_src.xU.BUTTON,title:"toolbar.resetColor",icon:"NoColor",disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.nhd],rangeTypes:[sheets_src.o9h]})}}}},[sheets_src.Sdr.id]:{order:10,menuItemFactory:function CellBorderSelectorMenuItemFactory(accessor){const borderStyleManagerService=accessor.get(sheets_src.wm$),disabled$=menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.nhd],rangeTypes:[sheets_src.o9h]});return{id:sheets_src.Sdr.id,icon:new internal_Observable.c((subscriber=>{const borderManager=accessor.get(sheets_src.wm$),disposable=accessor.get(src.wTY).onCommandExecuted((c=>{if(c.id!==sheets_src.Sdr.id)return;const{type}=borderManager.getBorderInfo(),item=BORDER_LINE_CHILDREN.find((item=>item.value===type)),icon=item?.icon??"AllBorderSingle";subscriber.next(icon)}));return subscriber.next("AllBorderSingle"),disposable.dispose})),tooltip:"toolbar.border.main",type:ui_src.xU.BUTTON_SELECTOR,slot:!0,selections:[{label:{name:"UI_PLUGIN_SHEETS_BORDER_PANEL_COMPONENT",hoverable:!1,selectable:!1},value$:borderStyleManagerService.borderInfo$}],value$:borderStyleManagerService.borderInfo$,hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET),disabled$}}}},[ui_src.My.LAYOUT]:{[sheets_src.zVg.id]:{order:0,menuItemFactory:function CellMergeMenuItemFactory(accessor){const editDisabled$=menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.r$W,sheets_src.nhd],rangeTypes:[sheets_src.o9h]}),selectionsHasCross$=function getSheetSelectionsDisabled$(accessor){const selectionManagerService=accessor.get(sheets_src.Fal),rangeProtectionRuleModel=accessor.get(sheets_src.qI9),univerInstanceService=accessor.get(src.HCr),mergeCellController=accessor.get(sheets_src.TSy),workbook$=univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET);return(0,combineLatest.z)([selectionManagerService.selectionMoveEnd$,workbook$.pipe((0,operators_map.T)((workbook=>workbook?.getUnitId()??""))),workbook$.pipe((0,switchMap.n)((workbook=>workbook?.activeSheet$??(0,observable_of.of)(null))))]).pipe((0,operators_map.T)((([selection,unitId,sheet])=>{if(!sheet)return!1;if(!selection||0===selection.length)return!1;const subUnitId=sheet.getSheetId(),selectionRanges=selection.map((sel=>sel.range));if(mergeCellController.interceptor.fetchThroughInterceptors(sheets_src.fik)(!1,selectionRanges))return!0;const subUnitRuleRange=rangeProtectionRuleModel.getSubunitRuleList(unitId,subUnitId).map((rule=>rule.ranges)).flat();if(selection.length<2){const range=selection[0].range;return subUnitRuleRange.some((ruleRange=>src.M_G.intersects(ruleRange,range)&&!src.M_G.contains(ruleRange,range)))}for(let i=0;i<selection.length;i++)for(let j=i+1;j<selection.length;j++)if(src.M_G.intersects(selection[i].range,selection[j].range))return!0;return!1})))}(accessor);return{id:AddWorksheetMergeCommand.id,icon:"MergeAllSingle",tooltip:"toolbar.mergeCell.main",type:ui_src.xU.SUBITEMS,hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET),disabled$:editDisabled$.pipe((0,operators_combineLatestWith.v)(selectionsHasCross$),(0,operators_map.T)((([disable,hasCross])=>disable||hasCross)))}},[sheets_src.amR.id]:{order:0,menuItemFactory:function CellMergeAllMenuItemFactory(accessor){return{id:AddWorksheetMergeAllCommand.id,type:ui_src.xU.BUTTON,title:"merge.all",icon:"MergeAllSingle",hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[sheets_src.F3Z.id]:{order:1,menuItemFactory:function CellMergeVerticalMenuItemFactory(accessor){return{id:AddWorksheetMergeVerticalCommand.id,type:ui_src.xU.BUTTON,title:"merge.vertical",icon:"VerticalIntegrationSingle",hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[sheets_src.PF.id]:{order:2,menuItemFactory:function CellMergeHorizontalMenuItemFactory(accessor){return{id:AddWorksheetMergeHorizontalCommand.id,type:ui_src.xU.BUTTON,title:"merge.horizontal",icon:"HorizontalMergeSingle",hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[sheets_src.Mkw.id]:{order:3,menuItemFactory:function CellMergeCancelMenuItemFactory(accessor){return{id:sheets_src.Mkw.id,type:ui_src.xU.BUTTON,title:"merge.cancel",icon:"CancelMergeSingle",hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}}},[sheets_src.y$j.id]:{order:1,menuItemFactory:function HorizontalAlignMenuItemFactory(accessor){const univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),defaultValue=src.wqs.LEFT;return{id:sheets_src.y$j.id,icon:HORIZONTAL_ALIGN_CHILDREN[0].icon,tooltip:"toolbar.horizontalAlignMode.main",type:ui_src.xU.SELECTOR,selections:HORIZONTAL_ALIGN_CHILDREN,value$:deriveStateFromActiveSheet$(univerInstanceService,defaultValue,(({worksheet})=>new internal_Observable.c((subscriber=>{const disposable=accessor.get(src.wTY).onCommandExecuted((c=>{const id=c.id;if(id!==sheets_src.y$j.id&&id!==sheets_src.NSB.id&&id!==sheets_src._M5.id)return;const primary=selectionManagerService.getCurrentLastSelection()?.primary;let ha;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);ha=range?.getHorizontalAlignment()}subscriber.next(ha??defaultValue)})),primary=selectionManagerService.getCurrentLastSelection()?.primary;let ha;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);ha=range?.getHorizontalAlignment()}return subscriber.next(ha??defaultValue),disposable.dispose})))),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.nhd],rangeTypes:[sheets_src.o9h]})}}},[sheets_src.slJ.id]:{order:1,menuItemFactory:function VerticalAlignMenuItemFactory(accessor){const univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),defaultValue=src.G4t.BOTTOM;return{id:sheets_src.slJ.id,icon:VERTICAL_ALIGN_CHILDREN[2].icon,tooltip:"toolbar.verticalAlignMode.main",type:ui_src.xU.SELECTOR,selections:VERTICAL_ALIGN_CHILDREN,value$:deriveStateFromActiveSheet$(univerInstanceService,defaultValue,(({worksheet})=>new internal_Observable.c((subscriber=>{const disposable=accessor.get(src.wTY).onCommandExecuted((c=>{const id=c.id;if(id!==sheets_src.slJ.id&&id!==sheets_src.NSB.id&&id!==sheets_src._M5.id)return;const primary=selectionManagerService.getCurrentLastSelection()?.primary;let va;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);va=range?.getVerticalAlignment()}subscriber.next(va??defaultValue)})),primary=selectionManagerService.getCurrentLastSelection()?.primary;let va;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);va=range?.getVerticalAlignment()}return subscriber.next(va??defaultValue),disposable.dispose})))),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.nhd],rangeTypes:[sheets_src.o9h]})}}},[sheets_src.TDI.id]:{order:2,menuItemFactory:function WrapTextMenuItemFactory(accessor){const selectionManagerService=accessor.get(sheets_src.Fal),univerInstanceService=accessor.get(src.HCr),defaultValue=src.sFy.OVERFLOW;return{id:sheets_src.TDI.id,tooltip:"toolbar.textWrapMode.main",icon:TEXT_WRAP_CHILDREN[0].icon,type:ui_src.xU.SELECTOR,selections:TEXT_WRAP_CHILDREN,value$:deriveStateFromActiveSheet$(univerInstanceService,defaultValue,(({worksheet})=>new internal_Observable.c((subscriber=>{const disposable=accessor.get(src.wTY).onCommandExecuted((c=>{const id=c.id;if(id!==sheets_src.TDI.id&&id!==sheets_src.NSB.id&&id!==sheets_src._M5.id)return;const primary=selectionManagerService.getCurrentLastSelection()?.primary;let ws;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);ws=range?.getWrapStrategy()}subscriber.next(ws??defaultValue)})),primary=selectionManagerService.getCurrentLastSelection()?.primary;let ws;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);ws=range?.getWrapStrategy()}return subscriber.next(ws??defaultValue),disposable.dispose})))),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.nhd],rangeTypes:[sheets_src.o9h]})}}},[sheets_src.hti.id]:{order:3,menuItemFactory:function TextRotateMenuItemFactory(accessor){const selectionManagerService=accessor.get(sheets_src.Fal),univerInstanceService=accessor.get(src.HCr);return{id:sheets_src.hti.id,tooltip:"toolbar.textRotateMode.main",icon:TEXT_ROTATE_CHILDREN[0].icon,type:ui_src.xU.SELECTOR,selections:TEXT_ROTATE_CHILDREN,value$:deriveStateFromActiveSheet$(univerInstanceService,0,(({worksheet})=>new internal_Observable.c((subscriber=>{const disposable=accessor.get(src.wTY).onCommandExecuted((c=>{const id=c.id;if(id!==sheets_src.hti.id&&id!==sheets_src.NSB.id&&id!==sheets_src._M5.id)return;const primary=selectionManagerService.getCurrentLastSelection()?.primary;let tr;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);tr=range?.getTextRotation()}tr?.v===src.OdA.TRUE?subscriber.next("v"):subscriber.next((tr&&tr.a)??0)})),primary=selectionManagerService.getCurrentLastSelection()?.primary;let tr;if(null!=primary){const range=worksheet.getRange(primary.startRow,primary.startColumn);tr=range?.getTextRotation()}return tr?.v===src.OdA.TRUE?subscriber.next("v"):subscriber.next((tr&&tr.a)??0),disposable.dispose})))),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.nhd],rangeTypes:[sheets_src.o9h]})}}}},[ui_src.My.OTHERS]:{[AddRangeProtectionFromToolbarCommand.id]:{order:0,menuItemFactory:function sheetPermissionToolbarMenuFactory(accessor){return{id:AddRangeProtectionFromToolbarCommand.id,type:ui_src.xU.BUTTON,icon:permissionMenuIconKey,tooltip:"permission.toolbarMenu",hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET),disabled$:getAddPermissionDisableBase$(accessor)}}}},[ui_src.ai.MAIN_AREA]:{[ui_src.Q2.FORMAT]:{[SheetCopyCommand.name]:{order:0,menuItemFactory:CopyMenuItemFactory},[SheetPasteCommand.name]:{order:2,menuItemFactory:PasteMenuItemFactory},[PASTE_SPECIAL_MENU_ID]:{order:3,menuItemFactory:PasteSpacialMenuItemFactory,[SheetPasteValueCommand.id]:{order:0,menuItemFactory:PasteValueMenuItemFactory},[SheetPasteFormatCommand.id]:{order:1,menuItemFactory:PasteFormatMenuItemFactory},[SheetPasteColWidthCommand.id]:{order:2,menuItemFactory:PasteColWidthMenuItemFactory},[SheetPasteBesidesBorderCommand.id]:{order:3,menuItemFactory:PasteBesidesBorderMenuItemFactory}},[CLEAR_SELECTION_MENU_ID]:{order:4,menuItemFactory:ClearSelectionMenuItemFactory,[sheets_src.kyo.id]:{order:0,menuItemFactory:ClearSelectionContentMenuItemFactory},[sheets_src.igE.id]:{order:1,menuItemFactory:ClearSelectionFormatMenuItemFactory},[sheets_src.sd6.id]:{order:2,menuItemFactory:ClearSelectionAllMenuItemFactory}}},[ui_src.Q2.LAYOUT]:{order:1,[CELL_INSERT_MENU_ID]:{order:0,menuItemFactory:function CellInsertMenuItemFactory(accessor){return{id:"sheet.menu.cell-insert",type:ui_src.xU.SUBITEMS,title:"rightClick.insert",icon:"Insert",hidden$:getObservableWithExclusiveRange$(accessor,menu_util_getBaseRangeMenuHidden$(accessor)),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.XMo,sheets_src.qGK],rangeTypes:[sheets_src.o9h]})}},[sheets_src.ET4.id]:{order:0,menuItemFactory:function InsertRowBeforeCellMenuItemFactory(accessor){const univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),commandService=accessor.get(src.wTY);return{id:sheets_src.ET4.id,type:ui_src.xU.BUTTON,icon:"InsertRowAbove",label:{name:MENU_ITEM_INPUT_COMPONENT,props:{prefix:"rightClick.insertRowsAbove",min:1,max:1e3,suffix:"rightClick.insertRowsAboveSuffix"}},value$:deriveStateFromActiveSheet$(univerInstanceService,1,(()=>new internal_Observable.c((subscriber=>{function update(){const range=selectionManagerService.getCurrentLastSelection()?.range;let countSelectedRange=1;range&&(countSelectedRange=range?.endRow-range?.startRow+1),subscriber.next(countSelectedRange)}const disposable=commandService.onCommandExecuted((c=>{if(c.id===sheets_src.NSB.id)return update()}));return update(),disposable.dispose})))),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.v9P,sheets_src.qGK],rangeTypes:[sheets_src.o9h]}),hidden$:menu_util_getInsertBeforeMenuHidden$(accessor,"row")}}},[sheets_src.OXv.id]:{order:1,menuItemFactory:function InsertColLeftCellMenuItemFactory(accessor){const univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),commandService=accessor.get(src.wTY);return{id:sheets_src.OXv.id,type:ui_src.xU.BUTTON,icon:"LeftInsertColumn",label:{name:MENU_ITEM_INPUT_COMPONENT,props:{prefix:"rightClick.insertColsLeft",min:1,max:1e3,suffix:"rightClick.insertColsLeftSuffix"}},value$:deriveStateFromActiveSheet$(univerInstanceService,1,(()=>new internal_Observable.c((subscriber=>{function update(){const range=selectionManagerService.getCurrentLastSelection()?.range;let countSelectedRange=1;range&&(countSelectedRange=range?.endColumn-range?.startColumn+1),subscriber.next(countSelectedRange)}const disposable=commandService.onCommandExecuted((c=>{if(c.id===sheets_src.NSB.id)return update()}));return update(),disposable.dispose})))),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.XMo,sheets_src.qGK],rangeTypes:[sheets_src.o9h]}),hidden$:menu_util_getInsertBeforeMenuHidden$(accessor,"col")}}},[InsertRangeMoveRightConfirmCommand.id]:{order:2,menuItemFactory:function InsertRangeMoveRightMenuItemFactory(accessor){return{id:InsertRangeMoveRightConfirmCommand.id,type:ui_src.xU.BUTTON,title:"rightClick.moveRight",icon:"InsertCellShiftRight",disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK],rangeTypes:[sheets_src.o9h]}),hidden$:getCellMenuHidden$(accessor,"col")}}},[InsertRangeMoveDownConfirmCommand.id]:{order:3,menuItemFactory:function InsertRangeMoveDownMenuItemFactory(accessor){return{id:InsertRangeMoveDownConfirmCommand.id,type:ui_src.xU.BUTTON,title:"rightClick.moveDown",icon:"InsertCellDown",disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK],rangeTypes:[sheets_src.o9h]}),hidden$:getCellMenuHidden$(accessor,"row")}}}},[DELETE_RANGE_MENU_ID]:{order:0,menuItemFactory:function DeleteRangeMenuItemFactory(accessor){return{id:"sheet.menu.delete",type:ui_src.xU.SUBITEMS,title:"rightClick.delete",icon:"Reduce",hidden$:getObservableWithExclusiveRange$(accessor,menu_util_getBaseRangeMenuHidden$(accessor)),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK]})}},[RemoveColConfirmCommand.id]:{order:0,menuItemFactory:RemoveColMenuItemFactory},[RemoveRowConfirmCommand.id]:{order:1,menuItemFactory:RemoveRowMenuItemFactory},[DeleteRangeMoveLeftConfirmCommand.id]:{order:2,menuItemFactory:function DeleteRangeMoveLeftMenuItemFactory(accessor){return{id:DeleteRangeMoveLeftConfirmCommand.id,type:ui_src.xU.BUTTON,title:"rightClick.moveLeft",icon:"DeleteCellShiftLeft",disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK],rangeTypes:[sheets_src.o9h]}),hidden$:getCellMenuHidden$(accessor,"col")}}},[DeleteRangeMoveUpConfirmCommand.id]:{order:3,menuItemFactory:function DeleteRangeMoveUpMenuItemFactory(accessor){return{id:DeleteRangeMoveUpConfirmCommand.id,type:ui_src.xU.BUTTON,title:"rightClick.moveUp",icon:"DeleteCellShiftUp",disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK],rangeTypes:[sheets_src.o9h]}),hidden$:getCellMenuHidden$(accessor,"row")}}}},[SHEET_FROZEN_MENU_ID]:{order:2,menuItemFactory:function SheetFrozenMenuItemFactory(accessor){return{id:"sheet.menu.sheet-frozen",type:ui_src.xU.SUBITEMS,title:"rightClick.freeze",icon:"FreezeToSelectedSingle",hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}},[SetSelectionFrozenCommand.id]:{order:0,menuItemFactory:FrozenMenuItemFactory},[SetRowFrozenCommand.id]:{order:1,menuItemFactory:function FrozenRowMenuItemFactory(accessor){return{id:SetRowFrozenCommand.id,type:ui_src.xU.BUTTON,title:"rightClick.freezeRow",icon:"FreezeRowSingle",hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[SetColumnFrozenCommand.id]:{order:2,menuItemFactory:function FrozenColMenuItemFactory(accessor){return{id:SetColumnFrozenCommand.id,type:ui_src.xU.BUTTON,title:"rightClick.freezeCol",icon:"FreezeColumnSingle",hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[sheets_src.mtZ.id]:{order:3,menuItemFactory:CancelFrozenMenuItemFactory}},[SHEET_PERMISSION_CONTEXT_MENU_ID]:{order:3,menuItemFactory:sheetPermissionContextMenuFactory,[AddRangeProtectionFromContextMenuCommand.id]:{order:0,menuItemFactory:sheetPermissionAddProtectContextMenuFactory},[SetRangeProtectionFromContextMenuCommand.id]:{order:1,menuItemFactory:sheetPermissionEditProtectContextMenuFactory},[DeleteRangeProtectionFromContextMenuCommand.id]:{order:2,menuItemFactory:sheetPermissionRemoveProtectContextMenuFactory},[ViewSheetPermissionFromContextMenuCommand.id]:{order:3,menuItemFactory:sheetPermissionViewAllProtectRuleContextMenuFactory}}},[ui_src.Q2.DATA]:{order:2},[ui_src.Q2.OTHERS]:{order:3}},[ui_src.ai.COL_HEADER]:{[ui_src.Q2.FORMAT]:{[SheetCopyCommand.name]:{order:0,menuItemFactory:CopyMenuItemFactory},[SheetPasteCommand.name]:{order:2,menuItemFactory:PasteMenuItemFactory},[PASTE_SPECIAL_MENU_ID]:{order:3,menuItemFactory:PasteSpacialMenuItemFactory,[SheetPasteValueCommand.id]:{order:0,menuItemFactory:PasteValueMenuItemFactory},[SheetPasteFormatCommand.id]:{order:1,menuItemFactory:PasteFormatMenuItemFactory},[SheetPasteColWidthCommand.id]:{order:2,menuItemFactory:PasteColWidthMenuItemFactory},[SheetPasteBesidesBorderCommand.id]:{order:3,menuItemFactory:PasteBesidesBorderMenuItemFactory}},[CLEAR_SELECTION_MENU_ID]:{order:4,menuItemFactory:ClearSelectionMenuItemFactory,[sheets_src.kyo.id]:{order:0,menuItemFactory:ClearSelectionContentMenuItemFactory},[sheets_src.igE.id]:{order:1,menuItemFactory:ClearSelectionFormatMenuItemFactory},[sheets_src.sd6.id]:{order:2,menuItemFactory:ClearSelectionAllMenuItemFactory}}},[ui_src.Q2.LAYOUT]:{order:1,[sheets_src.Csr.id]:{order:0,menuItemFactory:function InsertMultiColsLeftHeaderMenuItemFactory(accessor){const univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),commandService=accessor.get(src.wTY);return{id:sheets_src.Csr.id,type:ui_src.xU.BUTTON,icon:"LeftInsertColumn",label:{name:MENU_ITEM_INPUT_COMPONENT,props:{prefix:"rightClick.insertColsLeft",min:1,max:1e3,suffix:"rightClick.insertColsLeftSuffix"}},value$:deriveStateFromActiveSheet$(univerInstanceService,1,(()=>new internal_Observable.c((subscriber=>{function update(){const range=selectionManagerService.getCurrentLastSelection()?.range;let countSelectedRange=1;range&&(countSelectedRange=range?.endColumn-range?.startColumn+1),subscriber.next(countSelectedRange)}const disposable=commandService.onCommandExecuted((c=>{if(c.id===sheets_src.NSB.id)return update()}));return update(),disposable.dispose})))),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.v9P,sheets_src.qGK],rangeTypes:[sheets_src.o9h]}),hidden$:menu_util_getBaseRangeMenuHidden$(accessor)}}},[sheets_src.hOx.id]:{order:0,menuItemFactory:function InsertMultiColsRightHeaderMenuItemFactory(accessor){const univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),commandService=accessor.get(src.wTY);return{id:sheets_src.ih3.id,type:ui_src.xU.BUTTON,icon:"RightInsertColumn",label:{name:MENU_ITEM_INPUT_COMPONENT,props:{prefix:"rightClick.insertColsRight",min:1,max:1e3,suffix:"rightClick.insertColsRightSuffix"}},value$:deriveStateFromActiveSheet$(univerInstanceService,1,(()=>new internal_Observable.c((subscriber=>{function update(){const range=selectionManagerService.getCurrentLastSelection()?.range;let countSelectedRange=1;range&&(countSelectedRange=range?.endColumn-range?.startColumn+1),subscriber.next(countSelectedRange)}const disposable=commandService.onCommandExecuted((c=>{if(c.id===sheets_src.NSB.id)return update()}));return update(),disposable.dispose})))),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.v9P,sheets_src.qGK],rangeTypes:[sheets_src.o9h]}),hidden$:menu_util_getBaseRangeMenuHidden$(accessor)}}},[HideColConfirmCommand.id]:{order:1,menuItemFactory:function HideColMenuItemFactory(accessor){return{id:HideColConfirmCommand.id,type:ui_src.xU.BUTTON,icon:"Hide",title:"rightClick.hideSelectedColumn",disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.lLG],rangeTypes:[sheets_src.o9h]}),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[sheets_src.MeW.id]:{order:2,menuItemFactory:function ShowColMenuItemFactory(accessor){const univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),commandService=accessor.get(src.wTY),affectedCommands=[sheets_src.NSB,sheets_src.q4N,sheets_src.Sys].map((c=>c.id));return{id:sheets_src.MeW.id,type:ui_src.xU.BUTTON,title:"rightClick.showHideColumn",hidden$:deriveStateFromActiveSheet$(univerInstanceService,!0,(({worksheet})=>new internal_Observable.c((subscriber=>{function hasHiddenColsInSelections(){const colRanges=selectionManagerService.getCurrentSelections()?.map((s=>s.range)).filter((r=>r.rangeType===src.$uV.COLUMN));return!(!colRanges||0===colRanges.length)&&!!colRanges.some((range=>{for(let r=range.startColumn;r<=range.endColumn;r++)if(!worksheet.getColVisible(r))return!0;return!1}))}const disposable=commandService.onCommandExecuted((commandInfo=>{-1!==affectedCommands.findIndex((c=>c===commandInfo.id))&&subscriber.next(!hasHiddenColsInSelections())}));return subscriber.next(!hasHiddenColsInSelections()),()=>disposable.dispose()})))),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.lLG,sheets_src.qGK],rangeTypes:[sheets_src.o9h]})}}},[RemoveColConfirmCommand.id]:{order:2,menuItemFactory:RemoveColMenuItemFactory},[sheets_src.Mim.id]:{order:3,menuItemFactory:function SetColWidthMenuItemFactory(accessor){const commandService=accessor.get(src.wTY),univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal);return{id:sheets_src.Mim.id,type:ui_src.xU.BUTTON,icon:"AdjustWidth",label:{name:MENU_ITEM_INPUT_COMPONENT,props:{prefix:"rightClick.columnWidth",suffix:"px",min:2,max:1e3}},value$:deriveStateFromActiveSheet$(univerInstanceService,0,(({worksheet})=>new internal_Observable.c((subscriber=>{function update(){const primary=selectionManagerService.getCurrentLastSelection()?.primary;let colWidth=0;null!=primary&&(colWidth=worksheet.getColumnWidth(primary.startColumn)),subscriber.next(colWidth)}const disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id===sheets_src.N48.id||id===sheets_src.NSB.id||id===sheets_src.Cay.id)return update()}));return update(),disposable.dispose})))),hidden$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.lLG],rangeTypes:[sheets_src.o9h]})}}},[SetWorksheetColAutoWidthCommand.id]:{order:4,menuItemFactory:function ColAutoWidthMenuItemFactory(accessor){return{id:SetWorksheetColAutoWidthCommand.id,type:ui_src.xU.BUTTON,icon:"AutoWidth",title:"rightClick.fitContent",disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.Frs,sheets_src.qGK],rangeTypes:[sheets_src.o9h]}),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[SHEET_FROZEN_HEADER_MENU_ID]:{order:5,menuItemFactory:SheetFrozenHeaderMenuItemFactory,[SetSelectionFrozenCommand.id]:{order:0,menuItemFactory:FrozenMenuItemFactory},[sheets_src.mtZ.id]:{order:3,menuItemFactory:CancelFrozenMenuItemFactory}},[SHEET_PERMISSION_CONTEXT_MENU_ID]:{order:6,menuItemFactory:sheetPermissionContextMenuFactory,[AddRangeProtectionFromContextMenuCommand.id]:{order:0,menuItemFactory:sheetPermissionAddProtectContextMenuFactory},[SetRangeProtectionFromContextMenuCommand.id]:{order:1,menuItemFactory:sheetPermissionEditProtectContextMenuFactory},[DeleteRangeProtectionFromContextMenuCommand.id]:{order:2,menuItemFactory:sheetPermissionRemoveProtectContextMenuFactory},[ViewSheetPermissionFromContextMenuCommand.id]:{order:3,menuItemFactory:sheetPermissionViewAllProtectRuleContextMenuFactory}}},[ui_src.Q2.DATA]:{order:2},[ui_src.Q2.OTHERS]:{order:3}},[ui_src.ai.ROW_HEADER]:{[ui_src.Q2.FORMAT]:{[SheetCopyCommand.name]:{order:0,menuItemFactory:CopyMenuItemFactory},[SheetPasteCommand.name]:{order:2,menuItemFactory:PasteMenuItemFactory},[PASTE_SPECIAL_MENU_ID]:{order:3,menuItemFactory:PasteSpacialMenuItemFactory,[SheetPasteValueCommand.id]:{order:0,menuItemFactory:PasteValueMenuItemFactory},[SheetPasteFormatCommand.id]:{order:1,menuItemFactory:PasteFormatMenuItemFactory},[SheetPasteColWidthCommand.id]:{order:2,menuItemFactory:PasteColWidthMenuItemFactory},[SheetPasteBesidesBorderCommand.id]:{order:3,menuItemFactory:PasteBesidesBorderMenuItemFactory}},[CLEAR_SELECTION_MENU_ID]:{order:4,menuItemFactory:ClearSelectionMenuItemFactory,[sheets_src.kyo.id]:{order:0,menuItemFactory:ClearSelectionContentMenuItemFactory},[sheets_src.igE.id]:{order:1,menuItemFactory:ClearSelectionFormatMenuItemFactory},[sheets_src.sd6.id]:{order:2,menuItemFactory:ClearSelectionAllMenuItemFactory}}},[ui_src.Q2.LAYOUT]:{order:1,[sheets_src.ih3.id]:{order:0,menuItemFactory:function InsertMultiRowsAboveHeaderMenuItemFactory(accessor){const univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),commandService=accessor.get(src.wTY);return{id:sheets_src.ih3.id,type:ui_src.xU.BUTTON,icon:"InsertRowAbove",label:{name:MENU_ITEM_INPUT_COMPONENT,props:{prefix:"rightClick.insertRowsAbove",min:1,max:1e3,suffix:"rightClick.insertRowsAboveSuffix"}},value$:deriveStateFromActiveSheet$(univerInstanceService,1,(()=>new internal_Observable.c((subscriber=>{function update(){const range=selectionManagerService.getCurrentLastSelection()?.range;let countSelectedRange=1;range&&(countSelectedRange=range?.endRow-range?.startRow+1),subscriber.next(countSelectedRange)}const disposable=commandService.onCommandExecuted((c=>{if(c.id===sheets_src.NSB.id)return update()}));return update(),disposable.dispose})))),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.v9P,sheets_src.qGK],rangeTypes:[sheets_src.o9h]}),hidden$:menu_util_getBaseRangeMenuHidden$(accessor)}}},[sheets_src.L6E.id]:{order:1,menuItemFactory:function InsertMultiRowsAfterHeaderMenuItemFactory(accessor){const univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),commandService=accessor.get(src.wTY);return{id:sheets_src.L6E.id,type:ui_src.xU.BUTTON,icon:"InsertRowBelow",label:{name:MENU_ITEM_INPUT_COMPONENT,props:{prefix:"rightClick.insertRowsAfter",min:1,max:1e3,suffix:"rightClick.insertRowsAfterSuffix"}},value$:deriveStateFromActiveSheet$(univerInstanceService,1,(()=>new internal_Observable.c((subscriber=>{function update(){const range=selectionManagerService.getCurrentLastSelection()?.range;let countSelectedRange=1;range&&(countSelectedRange=range?.endRow-range?.startRow+1),subscriber.next(countSelectedRange)}const disposable=commandService.onCommandExecuted((c=>{if(c.id===sheets_src.NSB.id)return update()}));return update(),disposable.dispose})))),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.v9P,sheets_src.qGK],rangeTypes:[sheets_src.o9h]}),hidden$:menu_util_getBaseRangeMenuHidden$(accessor)}}},[RemoveRowConfirmCommand.id]:{order:1,menuItemFactory:RemoveRowMenuItemFactory},[HideRowConfirmCommand.id]:{order:2,menuItemFactory:function HideRowMenuItemFactory(accessor){return{id:HideRowConfirmCommand.id,type:ui_src.xU.BUTTON,icon:"Hide",title:"rightClick.hideSelectedRow",disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.Frs,sheets_src.qGK],rangeTypes:[sheets_src.o9h]}),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[sheets_src.QvT.id]:{order:2,menuItemFactory:function ShowRowMenuItemFactory(accessor){const univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal),commandService=accessor.get(src.wTY),affectedCommands=[sheets_src.NSB,sheets_src.avX,sheets_src.QAK].map((c=>c.id));return{id:sheets_src.QvT.id,type:ui_src.xU.BUTTON,title:"rightClick.showHideRow",hidden$:deriveStateFromActiveSheet$(univerInstanceService,!0,(({worksheet})=>new internal_Observable.c((subscriber=>{function hasHiddenRowsInSelections(){const rowRanges=selectionManagerService.getCurrentSelections()?.map((s=>s.range)).filter((r=>r.rangeType===src.$uV.ROW));return!!rowRanges?.some((range=>{for(let r=range.startRow;r<=range.endRow;r++)if(!worksheet.getRowRawVisible(r))return!0;return!1}))}const disposable=commandService.onCommandExecuted((command=>{-1!==affectedCommands.findIndex((c=>c===command.id))&&subscriber.next(!hasHiddenRowsInSelections())}));return subscriber.next(!hasHiddenRowsInSelections()),()=>disposable.dispose()})))),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.Frs],rangeTypes:[sheets_src.o9h]})}}},[sheets_src.fC2.id]:{order:3,menuItemFactory:function SetRowHeightMenuItemFactory(accessor){const commandService=accessor.get(src.wTY),univerInstanceService=accessor.get(src.HCr),selectionManagerService=accessor.get(sheets_src.Fal);return{id:sheets_src.fC2.id,type:ui_src.xU.BUTTON,icon:"AdjustHeight",label:{name:MENU_ITEM_INPUT_COMPONENT,props:{prefix:"rightClick.rowHeight",suffix:"px",min:2,max:1e3}},value$:deriveStateFromActiveSheet$(univerInstanceService,0,(({worksheet})=>new internal_Observable.c((subscriber=>{function update(){const primary=selectionManagerService.getCurrentLastSelection()?.primary,rowHeight=primary?worksheet.getRowHeight(primary.startRow):0;subscriber.next(rowHeight)}const disposable=commandService.onCommandExecuted((c=>{const id=c.id;if(id===sheets_src.N48.id||id===sheets_src.NSB.id||id===sheets_src.iqY.id)return update()}));return update(),disposable.dispose})))),hidden$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK,sheets_src.Frs],rangeTypes:[sheets_src.o9h]})}}},[sheets_src.iOM.id]:{order:4,menuItemFactory:function FitContentMenuItemFactory(accessor){return{id:sheets_src.iOM.id,type:ui_src.xU.BUTTON,icon:"AutoHeight",title:"rightClick.fitContent",disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.Frs,sheets_src.qGK],rangeTypes:[sheets_src.o9h]}),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[SHEET_FROZEN_HEADER_MENU_ID]:{order:5,menuItemFactory:SheetFrozenHeaderMenuItemFactory,[SetSelectionFrozenCommand.id]:{order:0,menuItemFactory:FrozenMenuItemFactory},[sheets_src.mtZ.id]:{order:3,menuItemFactory:CancelFrozenMenuItemFactory}},[SHEET_PERMISSION_CONTEXT_MENU_ID]:{order:6,menuItemFactory:sheetPermissionContextMenuFactory,[AddRangeProtectionFromContextMenuCommand.id]:{order:0,menuItemFactory:sheetPermissionAddProtectContextMenuFactory},[SetRangeProtectionFromContextMenuCommand.id]:{order:1,menuItemFactory:sheetPermissionEditProtectContextMenuFactory},[DeleteRangeProtectionFromContextMenuCommand.id]:{order:2,menuItemFactory:sheetPermissionRemoveProtectContextMenuFactory},[ViewSheetPermissionFromContextMenuCommand.id]:{order:3,menuItemFactory:sheetPermissionViewAllProtectRuleContextMenuFactory}}},[ui_src.Q2.DATA]:{order:2},[ui_src.Q2.OTHERS]:{order:3}},[ui_src.ai.FOOTER_TABS]:{[ui_src.Q2.OTHERS]:{order:0,[RemoveSheetConfirmCommand.id]:{order:0,menuItemFactory:function DeleteSheetMenuItemFactory(accessor){const univerInstanceService=accessor.get(src.HCr),commandService=accessor.get(src.wTY),defaultDisable$=new internal_Observable.c((subscriber=>{const disposable=commandService.onCommandExecuted((c=>{const id=c.id;id!==sheets_src.fyw.id&&id!==sheets_src.eUO.id&&id!==sheets_src.seI.id||disableFunction(univerInstanceService,subscriber)}));return disableFunction(univerInstanceService,subscriber),disposable.dispose})),permissionDisable$=menu_util_getWorkbookPermissionDisable$(accessor,[sheets_src.W30,sheets_src.mVR]);return{id:RemoveSheetConfirmCommand.id,type:ui_src.xU.BUTTON,title:"sheetConfig.delete",disabled$:(0,combineLatest.z)([defaultDisable$,permissionDisable$]).pipe((0,operators_map.T)((([defaultDisabled,permissionDisabled])=>defaultDisabled||permissionDisabled))),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[sheets_src.y2Q.id]:{order:1,menuItemFactory:function CopySheetMenuItemFactory(accessor){return{id:sheets_src.y2Q.id,type:ui_src.xU.BUTTON,title:"sheetConfig.copy",disabled$:menu_util_getWorkbookPermissionDisable$(accessor,[sheets_src.W30,sheets_src.ZZ1]),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[RenameSheetOperation.id]:{order:2,menuItemFactory:function RenameSheetMenuItemFactory(accessor){return{id:RenameSheetOperation.id,type:ui_src.xU.BUTTON,title:"sheetConfig.rename",disabled$:menu_util_getWorkbookPermissionDisable$(accessor,[sheets_src.W30,sheets_src.fzU]),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[sheets_src.uN4.id]:{order:3,menuItemFactory:function ChangeColorSheetMenuItemFactory(accessor){return{id:sheets_src.uN4.id,title:"sheetConfig.changeColor",type:ui_src.xU.SELECTOR,selections:[{label:{name:COLOR_PICKER_COMPONENT,hoverable:!1}}],hidden$:menu_util_getWorkbookPermissionDisable$(accessor,[sheets_src.W30])}}},[sheets_src.Kbx.id]:{order:4,menuItemFactory:function HideSheetMenuItemFactory(accessor){const univerInstanceService=accessor.get(src.HCr),commandService=accessor.get(src.wTY);return{id:sheets_src.Kbx.id,type:ui_src.xU.BUTTON,title:"sheetConfig.hide",disabled$:new internal_Observable.c((subscriber=>{const disposable=commandService.onCommandExecuted((c=>{const id=c.id;id!==sheets_src.fyw.id&&id!==sheets_src.eUO.id&&id!==sheets_src.seI.id||disableFunction(univerInstanceService,subscriber)}));return disableFunction(univerInstanceService,subscriber),disposable.dispose})).pipe((0,operators_combineLatestWith.v)(menu_util_getWorkbookPermissionDisable$(accessor,[sheets_src.W30,sheets_src.LGU])),(0,operators_map.T)((([defaultDisabled,permissionDisabled])=>defaultDisabled||permissionDisabled))),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[ShowMenuListCommand.id]:{order:6,menuItemFactory:function ShowMenuItemFactory(accessor){const univerInstanceService=accessor.get(src.HCr),commandService=accessor.get(src.wTY);return{id:ShowMenuListCommand.id,type:ui_src.xU.BUTTON,title:"sheetConfig.unhide",disabled$:new internal_Observable.c((subscriber=>{function disableFunction(){const worksheets=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET).getWorksheets(),visibleSheets=Array.from(worksheets.values());subscriber.next(1===visibleSheets.length)}const disposable=commandService.onCommandExecuted((c=>{const id=c.id;id!==sheets_src.fyw.id&&id!==sheets_src.eUO.id&&id!==sheets_src.seI.id||disableFunction()}));return disableFunction(),disposable.dispose})).pipe((0,operators_combineLatestWith.v)(menu_util_getWorkbookPermissionDisable$(accessor,[sheets_src.W30,sheets_src.LGU])),(0,operators_map.T)((([defaultDisabled,permissionDisabled])=>defaultDisabled||permissionDisabled))),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[AddRangeProtectionFromSheetBarCommand.id]:{order:7,menuItemFactory:function sheetPermissionProtectSheetInSheetBarMenuFactory(accessor){return{id:AddRangeProtectionFromSheetBarCommand.id,type:ui_src.xU.BUTTON,title:"sheetConfig.addProtectSheet",disabled$:getAddPermissionFromSheetBarDisable$(accessor),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[DeleteWorksheetProtectionFormSheetBarCommand.id]:{order:8,menuItemFactory:function sheetPermissionRemoveProtectionSheetBarMenuFactory(accessor){return{id:DeleteWorksheetProtectionFormSheetBarCommand.id,type:ui_src.xU.BUTTON,title:"sheetConfig.removeProtectSheet",disabled$:getRemovePermissionFromSheetBarDisable$(accessor),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[ChangeSheetProtectionFromSheetBarCommand.id]:{order:9,menuItemFactory:function sheetPermissionChangeSheetPermissionSheetBarMenuFactory(accessor){return{id:ChangeSheetProtectionFromSheetBarCommand.id,type:ui_src.xU.BUTTON,title:"sheetConfig.changeSheetPermission",disabled$:getSetPermissionFromSheetBarDisable$(accessor),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}},[ViewSheetPermissionFromSheetBarCommand.id]:{order:10,menuItemFactory:function sheetPermissionViewAllProtectRuleSheetBarMenuFactory(accessor){return{id:ViewSheetPermissionFromSheetBarCommand.id,type:ui_src.xU.BUTTON,title:"sheetConfig.viewAllProtectArea",disabled$:getViewPermissionDisable$(accessor),hidden$:(0,ui_src.fN)(accessor,src.Zy$.UNIVER_SHEET)}}}}},[ui_src.ai.FOOTER_MENU]:{[ui_src.Q2.OTHERS]:{[sheets_src.vf2.id]:{order:1,menuItemFactory:function ToggleGridlinesMenuFactory(accessor){const commandService=accessor.get(src.wTY),instanceService=accessor.get(src.HCr);return{id:sheets_src.vf2.id,type:ui_src.xU.BUTTON,tooltip:"toolbar.toggleGridlines",icon:"HideGridlines",activated$:new internal_Observable.c((observer=>{const getValue=()=>{const workbook=instanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET);return!!workbook&&workbook.getActiveSheet().getConfig().showGridlines===src.OdA.TRUE},disposable=new src.VdD;return disposable.add(commandService.onCommandExecuted((c=>{c.id!==sheets_src.HYc.id&&c.id!==sheets_src._M5.id||observer.next(getValue())}))),disposable.add(instanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET).subscribe((()=>{observer.next(getValue())}))),observer.next(getValue()),()=>disposable.dispose()})),disabled$:menu_util_getCurrentRangeDisable$(accessor,{workbookTypes:[sheets_src.W30],worksheetTypes:[sheets_src.qGK]})}}}}}},SetRowHiddenShortcutItem={id:sheets_src.ccO.id,preconditions:contextService=>whenSheetEditorFocused(contextService),binding:ui_src.DD.Digit9|ui_src.SK.CTRL_COMMAND},SetColHiddenShortcutItem={id:sheets_src.yCk.id,preconditions:contextService=>whenSheetEditorFocused(contextService),binding:ui_src.DD.Digit0|ui_src.SK.CTRL_COMMAND|ui_src.SK.SHIFT},MoveSelectionDownShortcutItem={id:MoveSelectionCommand.id,description:"shortcut.sheet.select-below-cell",group:"3_sheet-view",binding:ui_src.DD.ARROW_DOWN,priority:100,preconditions:whenSheetEditorFocused,staticParameters:{direction:src.OP3.DOWN}},MoveSelectionUpShortcutItem={id:MoveSelectionCommand.id,description:"shortcut.sheet.select-up-cell",group:"3_sheet-view",binding:ui_src.DD.ARROW_UP,priority:100,preconditions:whenSheetEditorFocused,staticParameters:{direction:src.OP3.UP}},MoveSelectionLeftShortcutItem={id:MoveSelectionCommand.id,description:"shortcut.sheet.select-left-cell",group:"3_sheet-view",binding:ui_src.DD.ARROW_LEFT,priority:100,preconditions:whenSheetEditorFocusedAndFxNotFocused,staticParameters:{direction:src.OP3.LEFT}},MoveSelectionRightShortcutItem={id:MoveSelectionCommand.id,description:"shortcut.sheet.select-right-cell",group:"3_sheet-view",binding:ui_src.DD.ARROW_RIGHT,priority:100,preconditions:whenSheetEditorFocusedAndFxNotFocused,staticParameters:{direction:src.OP3.RIGHT}},MoveSelectionTabShortcutItem={id:MoveSelectionEnterAndTabCommand.id,description:"shortcut.sheet.select-next-cell",group:"3_sheet-view",binding:ui_src.DD.TAB,priority:100,preconditions:whenSheetEditorFocused,staticParameters:{direction:src.OP3.RIGHT,keycode:ui_src.DD.TAB}},MoveSelectionTabLeftShortcutItem={id:MoveSelectionEnterAndTabCommand.id,description:"shortcut.sheet.select-previous-cell",group:"3_sheet-view",binding:ui_src.DD.TAB|ui_src.SK.SHIFT,priority:100,preconditions:whenSheetEditorFocused,staticParameters:{direction:src.OP3.LEFT,keycode:ui_src.DD.TAB}},MoveSelectionEnterShortcutItem={id:MoveSelectionEnterAndTabCommand.id,description:"shortcut.sheet.select-below-cell",group:"3_sheet-view",binding:ui_src.DD.ENTER,priority:100,preconditions:whenSheetEditorFocused,staticParameters:{direction:src.OP3.DOWN,keycode:ui_src.DD.ENTER}},MoveSelectionEnterUpShortcutItem={id:MoveSelectionEnterAndTabCommand.id,description:"shortcut.sheet.select-up-cell",group:"3_sheet-view",binding:ui_src.DD.ENTER|ui_src.SK.SHIFT,priority:100,preconditions:whenSheetEditorFocused,staticParameters:{direction:src.OP3.UP,keycode:ui_src.DD.ENTER}},MoveSelectionEndDownShortcutItem={id:MoveSelectionCommand.id,description:"shortcut.sheet.select-below-value-cell",group:"3_sheet-view",binding:ui_src.DD.ARROW_DOWN|ui_src.SK.CTRL_COMMAND,preconditions:whenSheetEditorFocused,staticParameters:{direction:src.OP3.DOWN,jumpOver:JumpOver.moveGap}},MoveSelectionEndUpShortcutItem={id:MoveSelectionCommand.id,description:"shortcut.sheet.select-up-value-cell",group:"3_sheet-view",binding:ui_src.DD.ARROW_UP|ui_src.SK.CTRL_COMMAND,preconditions:whenSheetEditorFocused,staticParameters:{direction:src.OP3.UP,jumpOver:JumpOver.moveGap}},MoveSelectionEndLeftShortcutItem={id:MoveSelectionCommand.id,description:"shortcut.sheet.select-left-value-cell",group:"3_sheet-view",binding:ui_src.DD.ARROW_LEFT|ui_src.SK.CTRL_COMMAND,preconditions:whenSheetEditorFocused,staticParameters:{direction:src.OP3.LEFT,jumpOver:JumpOver.moveGap}},MoveSelectionEndRightShortcutItem={id:MoveSelectionCommand.id,description:"shortcut.sheet.select-right-value-cell",group:"3_sheet-view",binding:ui_src.DD.ARROW_RIGHT|ui_src.SK.CTRL_COMMAND,preconditions:whenSheetEditorFocused,staticParameters:{direction:src.OP3.RIGHT,jumpOver:JumpOver.moveGap}},ExpandSelectionDownShortcutItem={id:ExpandSelectionCommand.id,description:"shortcut.sheet.expand-selection-down",group:"3_sheet-view",binding:ui_src.DD.ARROW_DOWN|ui_src.SK.SHIFT,preconditions:whenSheetEditorFocused,staticParameters:{direction:src.OP3.DOWN}},ExpandSelectionUpShortcutItem={id:ExpandSelectionCommand.id,description:"shortcut.sheet.expand-selection-up",group:"3_sheet-view",binding:ui_src.DD.ARROW_UP|ui_src.SK.SHIFT,preconditions:whenSheetEditorFocused,staticParameters:{direction:src.OP3.UP}},ExpandSelectionLeftShortcutItem={id:ExpandSelectionCommand.id,description:"shortcut.sheet.expand-selection-left",group:"3_sheet-view",binding:ui_src.DD.ARROW_LEFT|ui_src.SK.SHIFT,preconditions:whenSheetEditorFocused,staticParameters:{direction:src.OP3.LEFT}},ExpandSelectionRightShortcutItem={id:ExpandSelectionCommand.id,description:"shortcut.sheet.expand-selection-right",group:"3_sheet-view",binding:ui_src.DD.ARROW_RIGHT|ui_src.SK.SHIFT,preconditions:whenSheetEditorFocused,staticParameters:{direction:src.OP3.RIGHT}},ExpandSelectionEndDownShortcutItem={id:ExpandSelectionCommand.id,description:"shortcut.sheet.expand-selection-to-below-gap",group:"3_sheet-view",binding:ui_src.DD.ARROW_DOWN|ui_src.SK.SHIFT|ui_src.SK.CTRL_COMMAND,preconditions:whenSheetEditorFocused,staticParameters:{direction:src.OP3.DOWN,jumpOver:JumpOver.moveGap}},ExpandSelectionEndUpShortcutItem={id:ExpandSelectionCommand.id,description:"shortcut.sheet.expand-selection-to-up-gap",group:"3_sheet-view",binding:ui_src.DD.ARROW_UP|ui_src.SK.SHIFT|ui_src.SK.CTRL_COMMAND,preconditions:whenSheetEditorFocused,staticParameters:{direction:src.OP3.UP,jumpOver:JumpOver.moveGap}},ExpandSelectionEndLeftShortcutItem={id:ExpandSelectionCommand.id,description:"shortcut.sheet.expand-selection-to-left-gap",group:"3_sheet-view",binding:ui_src.DD.ARROW_LEFT|ui_src.SK.SHIFT|ui_src.SK.CTRL_COMMAND,preconditions:whenSheetEditorFocused,staticParameters:{direction:src.OP3.LEFT,jumpOver:JumpOver.moveGap}},ExpandSelectionEndRightShortcutItem={id:ExpandSelectionCommand.id,description:"shortcut.sheet.expand-selection-to-right-gap",group:"3_sheet-view",binding:ui_src.DD.ARROW_RIGHT|ui_src.SK.SHIFT|ui_src.SK.CTRL_COMMAND,preconditions:whenSheetEditorFocused,staticParameters:{direction:src.OP3.RIGHT,jumpOver:JumpOver.moveGap}},SelectAllShortcutItem={id:SelectAllCommand.id,description:"shortcut.sheet.select-all",group:"3_sheet-view",binding:ui_src.DD.A|ui_src.SK.CTRL_COMMAND,preconditions:whenSheetEditorFocused,staticParameters:{expandToGapFirst:!0,loop:!0}},SetBoldShortcutItem={id:SetRangeBoldCommand.id,description:"shortcut.sheet.set-bold",group:"4_sheet-edit",preconditions:contextService=>whenSheetEditorFocused(contextService),binding:ui_src.DD.B|ui_src.SK.CTRL_COMMAND},SetItalicShortcutItem={id:SetRangeItalicCommand.id,description:"shortcut.sheet.set-italic",group:"4_sheet-edit",preconditions:contextService=>whenSheetEditorFocused(contextService),binding:ui_src.DD.I|ui_src.SK.CTRL_COMMAND},SetUnderlineShortcutItem={id:SetRangeUnderlineCommand.id,description:"shortcut.sheet.set-underline",group:"4_sheet-edit",preconditions:contextService=>whenSheetEditorFocused(contextService),binding:ui_src.DD.U|ui_src.SK.CTRL_COMMAND},SetStrikeThroughShortcutItem={id:SetRangeStrickThroughCommand.id,description:"shortcut.sheet.set-strike-through",group:"4_sheet-edit",preconditions:contextService=>whenSheetEditorFocused(contextService),binding:ui_src.DD.X|ui_src.SK.SHIFT|ui_src.SK.CTRL_COMMAND},ClearSelectionValueShortcutItem={id:sheets_src.kyo.id,preconditions:contextService=>whenSheetEditorFocused(contextService),binding:ui_src.DD.DELETE,mac:ui_src.DD.BACKSPACE},ClearSelectionValueShortcutItemMac={id:sheets_src.kyo.id,preconditions:contextService=>whenSheetEditorFocused(contextService),mac:ui_src.DD.DELETE},ZoomInShortcutItem={id:ChangeZoomRatioCommand.id,description:"shortcut.sheet.zoom-in",binding:ui_src.DD.EQUAL|ui_src.SK.CTRL_COMMAND,group:"3_sheet-view",preconditions:whenSheetEditorFocused,priority:1,staticParameters:{delta:.2}},PreventDefaultZoomInShortcutItem={id:src.zHV.id,binding:ui_src.DD.EQUAL|ui_src.SK.CTRL_COMMAND},ZoomOutShortcutItem={id:ChangeZoomRatioCommand.id,description:"shortcut.sheet.zoom-out",binding:ui_src.DD.MINUS|ui_src.SK.CTRL_COMMAND,group:"3_sheet-view",preconditions:whenSheetEditorFocused,priority:1,staticParameters:{delta:-.2}},PreventDefaultZoomOutShortcutItem={id:src.zHV.id,binding:ui_src.DD.MINUS|ui_src.SK.CTRL_COMMAND},ResetZoomShortcutItem={id:ChangeZoomRatioCommand.id,description:"shortcut.sheet.reset-zoom",binding:ui_src.DD.Digit0|ui_src.SK.CTRL_COMMAND,preconditions:whenSheetEditorFocused,group:"3_sheet-view",priority:1,staticParameters:{reset:!0}},PreventDefaultResetZoomShortcutItem={id:src.zHV.id,binding:ui_src.DD.Digit0|ui_src.SK.CTRL_COMMAND};function sheet_ui_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function sheet_ui_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class SheetUIController extends src.jGt{constructor(_injector,_componentManager,_layoutService,_commandService,_shortcutService,_menuManagerService,_uiPartsService,_configService){super(),this._injector=_injector,this._componentManager=_componentManager,this._layoutService=_layoutService,this._commandService=_commandService,this._shortcutService=_shortcutService,this._menuManagerService=_menuManagerService,this._uiPartsService=_uiPartsService,this._configService=_configService,this._init()}_init(){this._initComponents(),this._initCommands(),this._initMenus(),this._initShortcuts(),this._initWorkbenchParts(),this._initFocusHandler()}_initComponents(){const componentManager=this._componentManager;this.disposeWithMe(componentManager.register(MENU_ITEM_INPUT_COMPONENT,MenuItemInput)),this.disposeWithMe(componentManager.register("UI_PLUGIN_SHEETS_BORDER_PANEL_COMPONENT",BorderPanel)),this.disposeWithMe(componentManager.register(COLOR_PICKER_COMPONENT,design_src.sk)),this.disposeWithMe(componentManager.register("UI_PLUGIN_SHEETS_FONT_FAMILY_COMPONENT",ui_src.ay)),this.disposeWithMe(componentManager.register("UI_PLUGIN_SHEETS_FONT_FAMILY_ITEM_COMPONENT",ui_src.vK)),this.disposeWithMe(componentManager.register("UI_PLUGIN_SHEETS_FONT_SIZE_COMPONENT",ui_src.Z4)),this.disposeWithMe(componentManager.register("DefinedNameContainer",DefinedNameContainer)),this.disposeWithMe(componentManager.register("HideGridlines",hide_gridlines.A))}_initCommands(){[AddWorksheetMergeAllCommand,AddWorksheetMergeCommand,AddWorksheetMergeHorizontalCommand,AddWorksheetMergeVerticalCommand,ChangeZoomRatioCommand,ExpandSelectionCommand,MoveSelectionCommand,MoveSelectionEnterAndTabCommand,RenameSheetOperation,RemoveSheetConfirmCommand,RemoveRowConfirmCommand,RemoveColConfirmCommand,HideRowConfirmCommand,HideColConfirmCommand,ScrollCommand,ScrollToCellCommand,SelectAllCommand,SetActivateCellEditOperation,sheets_src.ftS,SetCellEditVisibleArrowOperation,SetCellEditVisibleOperation,SetCellEditVisibleWithF2Operation,SetRangeBoldCommand,SetRangeItalicCommand,SetRangeUnderlineCommand,SetRangeStrickThroughCommand,SetRangeSubscriptCommand,SetRangeSuperscriptCommand,SetRangeFontSizeCommand,SetRangeFontFamilyCommand,SetRangeTextColorCommand,ResetRangeTextColorCommand,sheets_src.kBM,sheets_src.HoN,sheets_src.B7g,sheets_src.QPx,SetFormatPainterOperation,SetInfiniteFormatPainterCommand,SetOnceFormatPainterCommand,ApplyFormatPainterCommand,SetScrollOperation,SetScrollRelativeCommand,SetSelectionFrozenCommand,SetRowFrozenCommand,SetColumnFrozenCommand,ScrollToRangeOperation,sheets_src.U0d,SetZoomRatioCommand,SetZoomRatioOperation,ShowMenuListCommand,RefillCommand,InsertRangeMoveDownConfirmCommand,DeleteRangeMoveUpConfirmCommand,InsertRangeMoveRightConfirmCommand,DeleteRangeMoveLeftConfirmCommand,SidebarDefinedNameOperation,AutoFillCommand,AutoClearContentCommand,SheetPermissionOpenPanelOperation,SheetPermissionOpenDialogOperation,AddRangeProtectionFromToolbarCommand,AddRangeProtectionFromContextMenuCommand,ViewSheetPermissionFromContextMenuCommand,AddRangeProtectionFromSheetBarCommand,ViewSheetPermissionFromSheetBarCommand,ChangeSheetProtectionFromSheetBarCommand,DeleteRangeProtectionFromContextMenuCommand,SetRangeProtectionFromContextMenuCommand,DeleteWorksheetProtectionFormSheetBarCommand,SetWorksheetColAutoWidthCommand,SetRowHeaderWidthCommand,SetColumnHeaderHeightCommand].forEach((c=>{this.disposeWithMe(this._commandService.registerCommand(c))}))}_initMenus(){this._menuManagerService.mergeMenu(menuSchema)}_initShortcuts(){[MoveSelectionDownShortcutItem,MoveSelectionUpShortcutItem,MoveSelectionLeftShortcutItem,MoveSelectionRightShortcutItem,MoveSelectionTabShortcutItem,MoveSelectionTabLeftShortcutItem,MoveSelectionEnterShortcutItem,MoveSelectionEnterUpShortcutItem,MoveSelectionEndDownShortcutItem,MoveSelectionEndUpShortcutItem,MoveSelectionEndLeftShortcutItem,MoveSelectionEndRightShortcutItem,ExpandSelectionDownShortcutItem,ExpandSelectionUpShortcutItem,ExpandSelectionLeftShortcutItem,ExpandSelectionRightShortcutItem,ExpandSelectionEndDownShortcutItem,ExpandSelectionEndUpShortcutItem,ExpandSelectionEndLeftShortcutItem,ExpandSelectionEndRightShortcutItem,SelectAllShortcutItem,ZoomInShortcutItem,ZoomOutShortcutItem,ResetZoomShortcutItem,PreventDefaultResetZoomShortcutItem,PreventDefaultZoomInShortcutItem,PreventDefaultZoomOutShortcutItem,SetBoldShortcutItem,SetItalicShortcutItem,SetUnderlineShortcutItem,SetStrikeThroughShortcutItem,ClearSelectionValueShortcutItem,ClearSelectionValueShortcutItemMac,...generateArrowSelectionShortCutItem(),EditorCursorEnterShortcut,StartEditWithF2Shortcut,EditorCursorTabShortcut,EditorBreakLineShortcut,EditorDeleteLeftShortcut,EditorDeleteLeftShortcutInActive,EditorCursorEscShortcut,SetRowHiddenShortcutItem,SetColHiddenShortcutItem].forEach((item=>{this.disposeWithMe(this._shortcutService.registerShortcut(item))}))}_initWorkbenchParts(){const uiController=this._uiPartsService,injector=this._injector,config=this._configService.getConfig("sheets-ui.config");!1!==config?.formulaBar&&this.disposeWithMe(uiController.registerComponent(ui_src.ns.HEADER,(()=>(0,ui_src.pK)(RenderSheetHeader,injector)))),this.disposeWithMe(uiController.registerComponent(ui_src.ns.FOOTER,(()=>(0,ui_src.pK)(RenderSheetFooter,injector)))),this.disposeWithMe(uiController.registerComponent(ui_src.ns.CONTENT,(()=>(0,ui_src.pK)(RenderSheetContent,injector))))}_initFocusHandler(){this.disposeWithMe(this._layoutService.registerFocusHandler(src.Zy$.UNIVER_SHEET,(_unitId=>{const renderManagerService=this._injector.get(engine_render_src.cSx),instanceService=this._injector.get(src.HCr),currentEditorRender=(0,engine_render_src.iDO)(src.Zy$.UNIVER_DOC,instanceService,renderManagerService),docSelectionRenderService=currentEditorRender?.with(doc_selection_render_service.q);docSelectionRenderService?.focus()})))}}SheetUIController=function sheet_ui_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([sheet_ui_controller_ts_param(0,(0,src.y_5)(src.zZn)),sheet_ui_controller_ts_param(1,(0,src.y_5)(ui_src.BJ)),sheet_ui_controller_ts_param(2,ui_src.xQ),sheet_ui_controller_ts_param(3,src.wTY),sheet_ui_controller_ts_param(4,ui_src.nF),sheet_ui_controller_ts_param(5,ui_src.Zi),sheet_ui_controller_ts_param(6,ui_src.fe),sheet_ui_controller_ts_param(7,src.J0C),sheet_ui_controller_ts_metadata("design:type",Function),sheet_ui_controller_ts_metadata("design:paramtypes",[void 0===src.zZn?Object:src.zZn,void 0===ui_src.BJ?Object:ui_src.BJ,void 0===ui_src.xQ?Object:ui_src.xQ,void 0===src.wTY?Object:src.wTY,void 0===ui_src.nF?Object:ui_src.nF,void 0===ui_src.Zi?Object:ui_src.Zi,void 0===ui_src.fe?Object:ui_src.fe,void 0===src.J0C?Object:src.J0C])],SheetUIController);function active_worksheet_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function active_worksheet_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class ActiveWorksheetController extends src.jGt{constructor(_commandService,_univerInstanceService){super(),this._commandService=_commandService,this._univerInstanceService=_univerInstanceService,this._previousSheetIndex=-1,this.disposeWithMe(this._commandService.beforeCommandExecuted((command=>{if(command.id===sheets_src.fyw.id)return this._beforeAdjustActiveSheetOnRemoveSheet(command)}))),this.disposeWithMe(this._commandService.onCommandExecuted(((command,options)=>command.id===sheets_src.fyw.id?this._adjustActiveSheetOnRemoveSheet(command):command.id===sheets_src.seI.id&&command.params.hidden?this._adjustActiveSheetOnHideSheet(command):!options?.fromCollab&&(command.id===sheets_src.eUO.id?this._adjustActiveSheetOnInsertSheet(command):command.id!==sheets_src.seI.id||command.params.hidden?command.id===sheets_src.NSB.id?this._adjustActiveSheetOnSelection(command):void 0:this._adjustActiveSheetOnShowSheet(command)))))}_adjustActiveSheetOnHideSheet(mutation){const{unitId,subUnitId}=mutation.params,workbook=this._univerInstanceService.getUniverSheetInstance(unitId);if(!workbook)return;const activeSheet=workbook.getActiveSheet()?.getSheetId();if(activeSheet!==subUnitId)return;const activeIndex=workbook.getActiveSheetIndex(),nextId=findTheNextUnhiddenSheet(workbook,activeIndex);this._switchToNextSheet(unitId,nextId)}_beforeAdjustActiveSheetOnRemoveSheet(mutation){const{unitId,subUnitId}=mutation.params,workbook=this._univerInstanceService.getUniverSheetInstance(unitId);if(!workbook)return;const worksheet=workbook.getSheetBySheetId(subUnitId);worksheet&&(this._previousSheetIndex=workbook.getSheetIndex(worksheet))}_adjustActiveSheetOnRemoveSheet(mutation){if(-1===this._previousSheetIndex)return;const{unitId}=mutation.params,workbook=this._univerInstanceService.getUniverSheetInstance(unitId);if(!workbook)return;if(workbook.getActiveSheet().getSheetId()===mutation.params.subUnitId){const previousIndex=this._previousSheetIndex,nextId=findTheNextUnhiddenSheet(workbook,previousIndex>=1?previousIndex-1:0);this._switchToNextSheet(unitId,nextId)}}_adjustActiveSheetOnInsertSheet(mutation){const{unitId,sheet}=mutation.params;this._switchToNextSheet(unitId,sheet.id)}_adjustActiveSheetOnShowSheet(mutation){const{unitId,subUnitId}=mutation.params;this._switchToNextSheet(unitId,subUnitId)}_adjustActiveSheetOnSelection(operation){const{unitId,subUnitId}=operation.params;subUnitId!==this._univerInstanceService.getUnit(unitId)?.getActiveSheet().getSheetId()&&this._switchToNextSheet(unitId,subUnitId)}_switchToNextSheet(unitId,subUnitId){this._commandService.executeCommand(sheets_src._M5.id,{unitId,subUnitId})}}function findTheNextUnhiddenSheet(workbook,startIndex){const countOfSheets=workbook.getSheetSize();for(let i=startIndex;i>-1;i--){const sheet=workbook.getSheetByIndex(i);if(!sheet.getConfig().hidden)return sheet.getSheetId()}for(let i=startIndex;i<countOfSheets;i++){const sheet=workbook.getSheetByIndex(i);if(!sheet.getConfig().hidden)return sheet.getSheetId()}throw new Error("[ActiveWorksheetController]: could not find the next unhidden sheet! Collaboration error perhaps.")}ActiveWorksheetController=function active_worksheet_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([active_worksheet_controller_ts_param(0,src.wTY),active_worksheet_controller_ts_param(1,src.HCr),active_worksheet_controller_ts_metadata("design:type",Function),active_worksheet_controller_ts_metadata("design:paramtypes",[void 0===src.wTY?Object:src.wTY,void 0===src.HCr?Object:src.HCr])],ActiveWorksheetController);var warning_single=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/warning-single.js");function canvas_pop_manager_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function canvas_pop_manager_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class SheetCanvasPopManagerService extends src.jGt{constructor(_globalPopupManagerService,_renderManagerService,_univerInstanceService,_refRangeService,_commandService,_refSelectionsService,_selectionManagerService){super(),this._globalPopupManagerService=_globalPopupManagerService,this._renderManagerService=_renderManagerService,this._univerInstanceService=_univerInstanceService,this._refRangeService=_refRangeService,this._commandService=_commandService,this._refSelectionsService=_refSelectionsService,this._selectionManagerService=_selectionManagerService,this._popupMenuFeatureMap=new Map,this._isSelectionMoving=!1,this._initMoving()}_initMoving(){this.disposeWithMe(this._refSelectionsService.selectionMoving$.subscribe((()=>{this._isSelectionMoving=!0}))),this.disposeWithMe(this._refSelectionsService.selectionMoveEnd$.subscribe((()=>{this._isSelectionMoving=!1}))),this.disposeWithMe(this._selectionManagerService.selectionMoving$.subscribe((()=>{this._isSelectionMoving=!0}))),this.disposeWithMe(this._selectionManagerService.selectionMoveEnd$.subscribe((()=>{this._isSelectionMoving=!1})))}registerFeatureMenu(type,getPopupMenuCallBack){this._popupMenuFeatureMap.set(type,getPopupMenuCallBack)}getFeatureMenu(unitId,subUnitId,drawingId,drawingType){const callback=this._popupMenuFeatureMap.get(drawingType);if(callback)return callback(unitId,subUnitId,drawingId,drawingType)}dispose(){super.dispose(),this._popupMenuFeatureMap.clear()}_createHiddenRectObserver(params){const{row,column,worksheet,skeleton,currentRender}=params,calc=()=>{const freeze=worksheet.getFreeze(),{startRow:freezeStartRow,startColumn:freezeStartColumn,xSplit,ySplit}=freeze,startRow=freezeStartRow-ySplit,startColumn=freezeStartColumn-xSplit,{rowHeightAccumulation,columnWidthAccumulation,rowHeaderWidth,columnHeaderHeight}=skeleton,canvasFreezeWidth=rowHeaderWidth+(-1===startColumn?0:columnWidthAccumulation[startColumn+xSplit-1]-(columnWidthAccumulation[startColumn-1]??0)),canvasFreezeHeight=columnHeaderHeight+(-1===startRow?0:rowHeightAccumulation[startRow+ySplit-1]-(rowHeightAccumulation[startRow]??0)),canvasElement=currentRender.engine.getCanvasElement(),canvasClientRect=canvasElement.getBoundingClientRect(),widthOfCanvas=pxToNum(canvasElement.style.width),scaleAdjust=canvasClientRect.width/widthOfCanvas,canvasScale=currentRender.scene.getAncestorScale().scaleX,freezeWidth=canvasFreezeWidth*scaleAdjust*canvasScale,freezeHeight=canvasFreezeHeight*scaleAdjust*canvasScale,viewTopLeft={left:-1/0,top:-1/0,right:canvasClientRect.left+freezeWidth,bottom:canvasClientRect.top+freezeHeight},viewTopRight={left:canvasClientRect.left+freezeWidth,top:-1/0,right:1/0,bottom:canvasClientRect.top+freezeHeight},viewBottomLeft={left:-1/0,top:canvasClientRect.top+freezeHeight,right:canvasClientRect.left+freezeWidth,bottom:1/0},position=[];return row<freezeStartRow&&position.push(viewTopLeft),column<freezeStartColumn&&position.push(viewBottomLeft),row<freezeStartRow&&column<freezeStartColumn?[]:row<freezeStartRow||column<freezeStartColumn?[viewTopLeft]:[viewTopLeft,viewTopRight,viewBottomLeft]},rects=calc(),rects$=new BehaviorSubject.t(rects),disposable=new src.VdD;return disposable.add(this._commandService.onCommandExecuted((commandInfo=>{if(commandInfo.id===sheets_src.MOW.id){const newRects=calc();rects$.next(newRects)}}))),{rects$,disposable}}_createPositionObserver(bound,currentRender,skeleton,worksheet){const calc=()=>{const{scene}=currentRender,offsetBound=function utils_transformBound2OffsetBound(originBound,scene,skeleton,worksheet){const topLeft=utils_transformPosition2Offset(originBound.left,originBound.top,scene,skeleton,worksheet),bottomRight=utils_transformPosition2Offset(originBound.right,originBound.bottom,scene,skeleton,worksheet);return{left:topLeft.x,top:topLeft.y,right:bottomRight.x,bottom:bottomRight.y}}(bound,scene,skeleton,worksheet),canvasElement=currentRender.engine.getCanvasElement(),canvasClientRect=canvasElement.getBoundingClientRect(),widthOfCanvas=pxToNum(canvasElement.style.width),scaleAdjust=canvasClientRect.width/widthOfCanvas;return{left:offsetBound.left*scaleAdjust+canvasClientRect.left,right:offsetBound.right*scaleAdjust+canvasClientRect.left,top:offsetBound.top*scaleAdjust+canvasClientRect.top,bottom:offsetBound.bottom*scaleAdjust+canvasClientRect.top}},position=calc(),position$=new BehaviorSubject.t(position),disposable=new src.VdD;return disposable.add(this._commandService.onCommandExecuted((commandInfo=>{commandInfo.id!==SetScrollOperation.id&&commandInfo.id!==SetZoomRatioOperation.id||position$.next(calc())}))),{position,position$,disposable}}attachPopupToObject(targetObject,popup){const workbook=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook.getActiveSheet();if(!worksheet||this._isSelectionMoving&&!popup.showOnSelectionMoving)return{dispose:()=>{},canDispose:()=>!0};const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId(),skeleton=this._renderManagerService.getRenderById(unitId)?.with(sheet_skeleton_manager_service_SheetSkeletonManagerService).ensureSkeleton(subUnitId),currentRender=this._renderManagerService.getRenderById(unitId);if(!currentRender||!skeleton)return{dispose:()=>{},canDispose:()=>!0};const{left,top,width,height}=targetObject,bound={left,right:left+width,top,bottom:top+height},{position,position$,disposable}=this._createPositionObserver(bound,currentRender,skeleton,worksheet),id=this._globalPopupManagerService.addPopup({...popup,unitId,subUnitId,anchorRect:position,anchorRect$:position$,canvasElement:currentRender.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(id),position$.complete(),disposable.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==id}}attachPopupByPosition(bound,popup,location){const workbook=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook.getActiveSheet();if(!worksheet)return null;const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId();if(unitId!==location.unitId||location.subUnitId!==subUnitId)return null;if(this._isSelectionMoving&&!popup.showOnSelectionMoving)return;const skeleton=this._renderManagerService.getRenderById(unitId)?.with(sheet_skeleton_manager_service_SheetSkeletonManagerService).getOrCreateSkeleton({sheetId:subUnitId}),currentRender=this._renderManagerService.getRenderById(unitId);if(!currentRender||!skeleton)return null;const{position,position$,disposable}=this._createPositionObserver(bound,currentRender,skeleton,worksheet),{rects$,disposable:rectsObserverDisposable}=this._createHiddenRectObserver({row:location.row,column:location.col,worksheet,skeleton,currentRender}),id=this._globalPopupManagerService.addPopup({...popup,unitId,subUnitId,anchorRect:position,anchorRect$:position$,hiddenRects$:rects$,canvasElement:currentRender.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(id),position$.complete(),disposable.dispose(),rectsObserverDisposable.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==id}}attachPopupToAbsolutePosition(bound,popup,_unitId,_subUnitId){const workbook=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook.getActiveSheet();if(!worksheet)return null;const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId();if(_unitId&&unitId!==_unitId||_subUnitId&&_subUnitId!==subUnitId)return null;const skeleton=this._renderManagerService.getRenderById(unitId)?.with(sheet_skeleton_manager_service_SheetSkeletonManagerService).ensureSkeleton(subUnitId),currentRender=this._renderManagerService.getRenderById(unitId);if(!currentRender||!skeleton)return null;if(this._isSelectionMoving&&!popup.showOnSelectionMoving)return;const position$=new BehaviorSubject.t(bound),id=this._globalPopupManagerService.addPopup({...popup,unitId,subUnitId,anchorRect:bound,anchorRect$:position$.asObservable(),canvasElement:currentRender.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(id),position$.complete()},canDispose:()=>this._globalPopupManagerService.activePopupId!==id}}attachPopupToCell(row,col,popup,_unitId,_subUnitId,viewport){const workbook=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook.getActiveSheet();if(!worksheet)return null;const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId();if(_unitId&&unitId!==_unitId||_subUnitId&&subUnitId!==_subUnitId)return null;const currentRender=this._renderManagerService.getRenderById(unitId),skeleton=currentRender?.with(sheet_skeleton_manager_service_SheetSkeletonManagerService).ensureSkeleton(subUnitId),sheetSelectionRenderService=currentRender?.with(ISheetSelectionRenderService);if(!currentRender||!skeleton||!sheetSelectionRenderService)return null;if(this._isSelectionMoving&&!popup.showOnSelectionMoving)return;const activeViewport=viewport??getViewportByCell(row,col,currentRender.scene,worksheet);if(!activeViewport)return null;const{position,position$,disposable:positionObserverDisposable,updateRowCol}=this._createCellPositionObserver(row,col,currentRender,skeleton,activeViewport),{rects$,disposable:rectsObserverDisposable}=this._createHiddenRectObserver({row,column:col,worksheet,skeleton,currentRender}),id=this._globalPopupManagerService.addPopup({...popup,unitId,subUnitId,anchorRect:position,anchorRect$:position$,canvasElement:currentRender.engine.getCanvasElement(),hiddenRects$:rects$}),disposableCollection=new src.VdD;disposableCollection.add(positionObserverDisposable),disposableCollection.add((0,src.saO)((()=>{this._globalPopupManagerService.removePopup(id),position$.complete()}))),disposableCollection.add(rectsObserverDisposable);const watchedRange={startRow:row,endRow:row,startColumn:col,endColumn:col};return disposableCollection.add(this._refRangeService.watchRange(unitId,subUnitId,watchedRange,((_,after)=>{after?updateRowCol(after.startRow,after.startColumn):disposableCollection.dispose()}))),{dispose(){disposableCollection.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==id}}attachRangePopup(range,popup,_unitId,_subUnitId,viewport,showOnSelectionMoving=!1){const workbook=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook.getActiveSheet();if(!worksheet)return null;const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId();if(_unitId&&unitId!==_unitId||_subUnitId&&subUnitId!==_subUnitId)return null;const currentRender=this._renderManagerService.getRenderById(unitId),skeleton=currentRender?.with(sheet_skeleton_manager_service_SheetSkeletonManagerService).getOrCreateSkeleton({sheetId:subUnitId}),sheetSelectionRenderService=currentRender?.with(ISheetSelectionRenderService);if(!currentRender||!skeleton||!sheetSelectionRenderService)return null;if(sheetSelectionRenderService.selectionMoving&&!showOnSelectionMoving)return;const activeViewport=viewport??getViewportByCell(range.startRow,range.startColumn,currentRender.scene,worksheet);if(!activeViewport)return null;const{position,position$,disposable:positionObserverDisposable,updateRowCol,topLeftPos$,rightBottomPos$}=this._createRangePositionObserver(range,currentRender,skeleton,activeViewport),{rects$,disposable:rectsObserverDisposable}=this._createHiddenRectObserver({row:range.startRow,column:range.startColumn,worksheet,skeleton,currentRender}),id=this._globalPopupManagerService.addPopup({...popup,unitId,subUnitId,anchorRect:position,anchorRect$:position$,canvasElement:currentRender.engine.getCanvasElement(),hiddenRects$:rects$}),disposableCollection=new src.VdD;disposableCollection.add(positionObserverDisposable),disposableCollection.add((0,src.saO)((()=>{this._globalPopupManagerService.removePopup(id),topLeftPos$.complete(),rightBottomPos$.complete()}))),disposableCollection.add(rectsObserverDisposable);const watchedRange={...range};return disposableCollection.add(this._refRangeService.watchRange(unitId,subUnitId,watchedRange,((_,after)=>{after?updateRowCol(after.startRow,after.startColumn):disposableCollection.dispose()}))),{dispose(){disposableCollection.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==id}}_createCellPositionObserver(initialRow,initialCol,currentRender,skeleton,activeViewport){let row=initialRow,col=initialCol;const position=this._calcCellPositionByCell(row,col,currentRender,skeleton,activeViewport),position$=new BehaviorSubject.t(position),updatePosition=()=>position$.next(this._calcCellPositionByCell(row,col,currentRender,skeleton,activeViewport)),disposable=new src.VdD;disposable.add(currentRender.engine.clientRect$.subscribe((()=>updatePosition()))),disposable.add(this._commandService.onCommandExecuted((commandInfo=>{if(commandInfo.id===sheets_src.wXn.id){if(commandInfo.params.rowsAutoHeightInfo.findIndex((item=>item.row===row))>-1)return void updatePosition()}(sheets_src.Izd.indexOf(commandInfo.id)>-1||commandInfo.id===SetScrollOperation.id||commandInfo.id===SetZoomRatioOperation.id)&&updatePosition()})));return{position$,disposable,position,updateRowCol:(newRow,newCol)=>{row=newRow,col=newCol,updatePosition()}}}_calcCellPositionByCell(row,col,currentRender,skeleton,activeViewport){const{scene,engine}=currentRender,primaryWithCoord=skeleton.getCellWithCoordByIndex(row,col),cellInfo=primaryWithCoord.isMergedMainCell?primaryWithCoord.mergeInfo:primaryWithCoord,{scaleX,scaleY}=scene.getAncestorScale(),scrollXY_x=activeViewport.viewportScrollX,scrollXY_y=activeViewport.viewportScrollY,canvasElement=engine.getCanvasElement(),canvasClientRect=canvasElement.getBoundingClientRect(),widthOfCanvas=pxToNum(canvasElement.style.width),{top,left,width}=canvasClientRect,scaleAdjust=width/widthOfCanvas;return{left:(cellInfo.startX-scrollXY_x)*scaleAdjust*scaleX+left,right:(cellInfo.endX-scrollXY_x)*scaleAdjust*scaleX+left,top:(cellInfo.startY-scrollXY_y)*scaleAdjust*scaleY+top,bottom:(cellInfo.endY-scrollXY_y)*scaleAdjust*scaleY+top}}_createRangePositionObserver(range,currentRender,skeleton,activeViewport){let{startRow,startColumn}=range;const topLeftCoord=this._calcCellPositionByCell(startRow,startColumn,currentRender,skeleton,activeViewport),topLeftPos$=new BehaviorSubject.t(topLeftCoord),rightBottomCoord=this._calcCellPositionByCell(range.endRow,range.endColumn,currentRender,skeleton,activeViewport),rightBottomPos$=new BehaviorSubject.t(rightBottomCoord),updatePosition=()=>{const topLeftCoord=this._calcCellPositionByCell(startRow,startColumn,currentRender,skeleton,activeViewport),rightBottomCoord=this._calcCellPositionByCell(range.endRow,range.endColumn,currentRender,skeleton,activeViewport);topLeftPos$.next(topLeftCoord),rightBottomPos$.next(rightBottomCoord)},disposable=new src.VdD;disposable.add(currentRender.engine.clientRect$.subscribe((()=>updatePosition()))),disposable.add(this._commandService.onCommandExecuted((commandInfo=>{if(commandInfo.id===sheets_src.wXn.id){if(commandInfo.params.rowsAutoHeightInfo.findIndex((item=>item.row===startRow))>-1)return void updatePosition()}(sheets_src.Izd.indexOf(commandInfo.id)>-1||commandInfo.id===SetScrollOperation.id||commandInfo.id===SetZoomRatioOperation.id)&&updatePosition()})));const position$=topLeftPos$.pipe((0,operators_map.T)((topLeft=>{const rightBottomCoord=this._calcCellPositionByCell(range.endRow,range.endColumn,currentRender,skeleton,activeViewport);return{top:topLeft.top,left:topLeft.left,right:rightBottomCoord.right,bottom:rightBottomCoord.bottom}})));return{position$,position:{top:topLeftCoord.top,left:topLeftCoord.left,right:rightBottomCoord.right,bottom:rightBottomCoord.bottom},updateRowCol:(newRow,newCol)=>{startRow=newRow,startColumn=newCol,updatePosition()},topLeftPos$,rightBottomPos$,disposable}}}function pxToNum(width){return Number.parseInt(width.replace("px",""))}function cell_alert_manager_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function cell_alert_manager_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}SheetCanvasPopManagerService=function canvas_pop_manager_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([canvas_pop_manager_service_ts_param(0,(0,src.y_5)(ui_src.F6)),canvas_pop_manager_service_ts_param(1,engine_render_src.cSx),canvas_pop_manager_service_ts_param(2,src.HCr),canvas_pop_manager_service_ts_param(3,(0,src.y_5)(sheets_src.u7_)),canvas_pop_manager_service_ts_param(4,src.wTY),canvas_pop_manager_service_ts_param(5,sheets_src.BcG),canvas_pop_manager_service_ts_param(6,(0,src.y_5)(sheets_src.Fal)),canvas_pop_manager_service_ts_metadata("design:type",Function),canvas_pop_manager_service_ts_metadata("design:paramtypes",[void 0===ui_src.F6?Object:ui_src.F6,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===src.HCr?Object:src.HCr,void 0===sheets_src.u7_?Object:sheets_src.u7_,void 0===src.wTY?Object:src.wTY,void 0===ISheetSelectionRenderService?Object:ISheetSelectionRenderService,void 0===sheets_src.Fal?Object:sheets_src.Fal])],SheetCanvasPopManagerService);var CellAlertType=function(CellAlertType){return CellAlertType[CellAlertType.INFO=0]="INFO",CellAlertType[CellAlertType.WARNING=1]="WARNING",CellAlertType[CellAlertType.ERROR=2]="ERROR",CellAlertType}({});class CellAlertManagerService extends src.jGt{get currentAlert(){return this._currentAlert}constructor(_renderManagerService,_canvasPopManagerService){super(),this._renderManagerService=_renderManagerService,this._canvasPopManagerService=_canvasPopManagerService,this._currentAlert$=new Subject.B,this._currentAlert=new Map,this.currentAlert$=this._currentAlert$.asObservable(),this.disposeWithMe((()=>{this._currentAlert$.complete()}))}showAlert(alert){let lastPopup=this._currentAlert.get(alert.key);lastPopup&&lastPopup.dispose.dispose(),lastPopup?lastPopup.dispose.dispose():(lastPopup={alert,dispose:{dispose(){}}},this._currentAlert.set(alert.key,lastPopup));const{location}=alert,{row,col,unitId}=location;if(!this._renderManagerService.getRenderById(unitId))return;const disposable=this._canvasPopManagerService.attachPopupToCell(row,col,{componentKey:CELL_ALERT_KEY,direction:"horizontal",offset:[2,0],extraProps:{alert}});disposable&&(lastPopup.dispose=disposable),this._currentAlert$.next(Array.from(this._currentAlert.entries()))}removeAlert(key){const lastPopup=this._currentAlert.get(key);lastPopup&&(this._currentAlert.delete(key),lastPopup?.dispose.dispose(),this._currentAlert$.next(Array.from(this._currentAlert.entries())))}clearAlert(){this._currentAlert.forEach((alert=>{alert.dispose.dispose()})),this._currentAlert.clear(),this._currentAlert$.next(Array.from(this._currentAlert.entries()))}}CellAlertManagerService=function cell_alert_manager_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([cell_alert_manager_service_ts_param(0,engine_render_src.cSx),cell_alert_manager_service_ts_param(1,(0,src.y_5)(SheetCanvasPopManagerService)),cell_alert_manager_service_ts_metadata("design:type",Function),cell_alert_manager_service_ts_metadata("design:paramtypes",[void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===SheetCanvasPopManagerService?Object:SheetCanvasPopManagerService])],CellAlertManagerService);var cell_alert_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/cell-alert/index.module.less"),cell_alert_index_module_options={};cell_alert_index_module_options.styleTagTransform=styleTagTransform_default(),cell_alert_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),cell_alert_index_module_options.insert=insertBySelector_default().bind(null,"head"),cell_alert_index_module_options.domAPI=styleDomAPI_default(),cell_alert_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(cell_alert_index_module.A,cell_alert_index_module_options);const views_cell_alert_index_module=cell_alert_index_module.A&&cell_alert_index_module.A.locals?cell_alert_index_module.A.locals:void 0;function CellAlert({popup}){const alert=popup.extraProps?.alert;if(!alert)return null;const{type,title,message}=alert,iconMap={[CellAlertType.ERROR]:(0,jsx_runtime.jsx)(error_single.A,{className:(0,design_src.$z)(views_cell_alert_index_module.cellAlertIcon,views_cell_alert_index_module.cellAlertIconError)}),[CellAlertType.INFO]:(0,jsx_runtime.jsx)(warning_single.A,{className:(0,design_src.$z)(views_cell_alert_index_module.cellAlertIcon,views_cell_alert_index_module.cellAlertIconInfo)}),[CellAlertType.WARNING]:(0,jsx_runtime.jsx)(warning_single.A,{className:(0,design_src.$z)(views_cell_alert_index_module.cellAlertIcon,views_cell_alert_index_module.cellAlertIconWarning)})};return(0,jsx_runtime.jsxs)("div",{className:views_cell_alert_index_module.cellAlert,children:[(0,jsx_runtime.jsxs)("div",{className:views_cell_alert_index_module.cellAlertTitle,children:[type?iconMap[type]:null,title]}),(0,jsx_runtime.jsx)("div",{className:views_cell_alert_index_module.cellAlertContent,children:message})]})}const CELL_ALERT_KEY="univer.sheet.cell-alert";function cell_alert_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}class CellAlertRenderController extends src.jGt{constructor(_context,_componentManager){super(),this._context=_context,this._componentManager=_componentManager,this._initComponent()}_initComponent(){this._componentManager.register(CELL_ALERT_KEY,CellAlert)}}CellAlertRenderController=function cell_alert_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([function cell_alert_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}(1,(0,src.y_5)(ui_src.BJ)),cell_alert_controller_ts_metadata("design:type",Function),cell_alert_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===ui_src.BJ?Object:ui_src.BJ])],CellAlertRenderController);var paste_special=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/paste-special.js"),clipboard_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/clipboard/index.module.less"),clipboard_index_module_options={};clipboard_index_module_options.styleTagTransform=styleTagTransform_default(),clipboard_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),clipboard_index_module_options.insert=insertBySelector_default().bind(null,"head"),clipboard_index_module_options.domAPI=styleDomAPI_default(),clipboard_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(clipboard_index_module.A,clipboard_index_module_options);const views_clipboard_index_module=clipboard_index_module.A&&clipboard_index_module.A.locals?clipboard_index_module.A.locals:void 0,SheetPasteOptions=[{value:"DEFAULT_PASTE",label:"rightClick.paste"},{value:"SPECIAL_PASTE_VALUE",label:"rightClick.pasteValue"},{value:"SPECIAL_PASTE_FORMAT",label:"rightClick.pasteFormat"},{value:"SPECIAL_PASTE_COL_WIDTH",label:"rightClick.pasteColWidth"},{value:"SPECIAL_PASTE_BESIDES_BORDER",label:"rightClick.pasteBesidesBorder"},{value:"SPECIAL_PASTE_FORMULA",label:"formula.operation.pasteFormula"}],ClipboardPopupMenu=()=>{const clipboardService=(0,ui_src.fJ)(ISheetClipboardService),showMenu=(0,ui_src.J2)(clipboardService.showMenu$,!1),pasteOptionsCache=(0,ui_src.J2)(clipboardService.pasteOptionsCache$,null),localeService=(0,ui_src.fJ)(src.iH9),commandService=(0,ui_src.fJ)(src.wTY),[menuHovered,setMenuHovered]=(0,react.useState)(!1),[menuVisible,setMenuVisible]=(0,react.useState)(!1),range=pasteOptionsCache?.target.pastedRange,relativePosition=(range=>{const univerInstanceService=(0,ui_src.fJ)(src.HCr),renderManagerService=(0,ui_src.fJ)(engine_render_src.cSx),workbook=useActiveWorkbook();if(!range||!workbook)return null;const anchor={startRow:range.rows[0],startCol:range.cols[0],endRow:range.rows[range.rows.length-1],endCol:range.cols[range.cols.length-1]};if(anchor.endRow<0||anchor.endCol<0)return null;const ru=renderManagerService.getRenderById(workbook.getUnitId()),sheetSkeletonManagerService=ru?.with(sheet_skeleton_manager_service_SheetSkeletonManagerService),selectionRenderService=ru?.with(ISheetSelectionRenderService),sheetObject=getSheetObject(univerInstanceService,renderManagerService);if(!sheetObject||!selectionRenderService)return null;const{scene}=sheetObject,skeleton=sheetSkeletonManagerService?.getCurrentSkeleton(),viewport=selectionRenderService.getViewPort(),scaleX=scene?.scaleX,scaleY=scene?.scaleY,scrollXY=scene?.getViewportScrollXY(viewport),canvas=scene.getEngine()?.getCanvas();if(!(scaleX&&scene&&scaleX&&scaleY&&scrollXY))return null;const endPosition=skeleton?.getNoMergeCellPositionByIndex(anchor.endRow,anchor.endCol),endX=endPosition?.endX??0,endY=endPosition?.endY??0,positionEndX=(0,engine_render_src.kiU)(endX,scaleX,scrollXY)??-9999,positionEndY=(0,engine_render_src.FgB)(endY,scaleY,scrollXY)??-9999,canvasWidth=canvas?.getWidth(),canvasHeight=canvas?.getHeight();if(!canvasWidth||!canvasHeight)return null;let positionX=positionEndX,positionY=positionEndY;return positionEndX+50<=canvasWidth||(positionX=canvasWidth-100),positionEndY+50<=canvasHeight||(positionY=canvasHeight-100),{positionX,positionY}})(range);if(!relativePosition||!showMenu)return null;if(relativePosition.positionX<50||relativePosition.positionY<30)return null;const iconVisible=menuHovered||menuVisible;return(0,jsx_runtime.jsx)("div",{className:views_clipboard_index_module.sheetPasteOptionsWrapper,style:{left:relativePosition.positionX+2,top:relativePosition.positionY+2},onMouseEnter:()=>setMenuHovered(!0),onMouseLeave:()=>setMenuHovered(!1),children:(0,jsx_runtime.jsx)(design_src.ms,{overlay:(0,jsx_runtime.jsx)("div",{className:(0,design_src.$z)(views_clipboard_index_module.sheetPasteOptionsMenu,"\n                          univer-border univer-border-solid univer-border-gray-200 univer-opacity-100\n                        "),children:(0,jsx_runtime.jsx)("ul",{children:SheetPasteOptions.map((item=>{const itemType=PREDEFINED_HOOK_NAME[item.value],selected=pasteOptionsCache?.pasteType===itemType;return(0,jsx_runtime.jsxs)("li",{className:(0,design_src.$z)(views_clipboard_index_module.sheetPasteOptionsMenuItem,"hover:univer-bg-neutral-100"),onClick:()=>{return type=item.value,setMenuVisible(!1),void commandService.executeCommand(SheetOptionalPasteCommand.id,{type});var type},children:[(0,jsx_runtime.jsx)("span",{children:selected&&(0,jsx_runtime.jsx)(check_mark_single.A,{className:views_clipboard_index_module.sheetPasteOptionsMenuItemIcon,style:{color:"rgb(var(--green-700, #409f11))"}})}),(0,jsx_runtime.jsx)("div",{className:(0,design_src.$z)(views_clipboard_index_module.sheetPasteOptionsMenuItemTitle,"\n                                              univer-text-gray-700\n                                            "),children:localeService.t(item.label)})]},item.value)}))})}),open:menuVisible,onOpenChange:setMenuVisible,children:(0,jsx_runtime.jsxs)("div",{className:views_clipboard_index_module.sheetPasteOptionsIconWrapper,onClick:()=>{setMenuVisible(!menuVisible)},children:[(0,jsx_runtime.jsx)(paste_special.A,{style:{color:"#35322B"},extend:{colorChannel1:"rgb(var(--green-700))"}}),iconVisible&&(0,jsx_runtime.jsx)(more_down_single.A,{})]})})})};ClipboardPopupMenu.__docgenInfo={description:"",methods:[],displayName:"ClipboardPopupMenu"};const RemovePasteMenuCommands=[SetCellEditVisibleOperation.id,sheets_src.NXV.id,SetZoomRatioOperation.id,sheets_src.o2G.id,sheets_src.G4z.id,sheets_src.MIN.id,sheets_src.bS1.id,sheets_src.RmT.id,sheets_src.yNb.id,sheets_src.YJl.id,sheets_src.Cay.id,sheets_src.BtL.id,sheets_src.NSB.id,src.dab];function getDefaultOnPasteCellMutations(pasteFrom,pasteTo,data,payload,accessor){const redoMutationsInfo=[],undoMutationsInfo=[];if(payload.copyType===COPY_TYPE.CUT){const{undos,redos}=function getMoveRangeMutations(from,to,accessor){let redos=[],undos=[];const{range:fromDiscreteRange,subUnitId:fromSubUnitId,unitId}=from,{range:toDiscreteRange,subUnitId:toSubUnitId}=to,toRange=toDiscreteRange?discreteRangeToRange(toDiscreteRange):null,fromRange=fromDiscreteRange?discreteRangeToRange(fromDiscreteRange):null;if(fromRange&&toRange){const univerInstanceService=accessor.get(src.HCr),sheetInterceptorService=accessor.get(sheets_src.e5R),workbook=univerInstanceService.getUniverSheetInstance(unitId),fromWorksheet=workbook?.getSheetBySheetId(fromSubUnitId),toWorksheet=workbook?.getSheetBySheetId(toSubUnitId);if(fromWorksheet&&toWorksheet){const fromCellValue=new src.hDc,newFromCellValue=new src.hDc,fromCellMatrix=fromWorksheet.getCellMatrix(),toCellMatrix=toWorksheet.getCellMatrix();src.Q6t.foreach(fromRange,((row,col)=>{fromCellValue.setValue(row,col,src.S0q.deepClone(fromCellMatrix.getValue(row,col))),newFromCellValue.setValue(row,col,null)}));const toCellValue=new src.hDc;src.Q6t.foreach(toRange,((row,col)=>{toCellValue.setValue(row,col,src.S0q.deepClone(toCellMatrix.getValue(row,col)))}));const newToCellValue=new src.hDc;src.Q6t.foreach(fromRange,((row,col)=>{const cellRange=(0,src.PJ)(row,col),relativeRange=src.M_G.getRelativeRange(cellRange,fromRange),range=src.M_G.getPositionRange(relativeRange,toRange);newToCellValue.setValue(range.startRow,range.startColumn,fromCellMatrix.getValue(row,col))}));const doMoveRangeMutation={fromRange,toRange,from:{value:newFromCellValue.getMatrix(),subUnitId:fromSubUnitId},to:{value:newToCellValue.getMatrix(),subUnitId:toSubUnitId},unitId},undoMoveRangeMutation={fromRange:toRange,toRange:fromRange,from:{value:fromCellValue.getMatrix(),subUnitId:fromSubUnitId},to:{value:toCellValue.getMatrix(),subUnitId:toSubUnitId},unitId},interceptorCommands=sheetInterceptorService.onCommandExecute({id:sheets_src.Kft.id,params:{toRange,fromRange}}),fromMergeData=fromWorksheet.getMergeData(),toMergeData=toWorksheet.getMergeData(),fromMergeRanges=fromMergeData.filter((item=>src.M_G.intersects(item,fromRange))),toMergeRanges=toMergeData.filter((item=>src.M_G.intersects(item,toRange))),willMoveToMergeRanges=fromMergeRanges.map((mergeRange=>src.M_G.getRelativeRange(mergeRange,fromRange))).map((relativeRange=>src.M_G.getPositionRange(relativeRange,toRange))),addMergeCellRanges=(0,sheets_src.h9R)(willMoveToMergeRanges),mergeRedos=[{id:sheets_src._L3.id,params:{unitId,subUnitId:fromSubUnitId,ranges:fromMergeRanges}},{id:sheets_src._L3.id,params:{unitId,subUnitId:fromSubUnitId,ranges:toMergeRanges}},{id:sheets_src.zo2.id,params:{unitId,subUnitId:toSubUnitId,ranges:addMergeCellRanges}}],mergeUndos=[{id:sheets_src._L3.id,params:{unitId,subUnitId:toSubUnitId,ranges:addMergeCellRanges}},{id:sheets_src.zo2.id,params:{unitId,subUnitId:toSubUnitId,ranges:toMergeRanges}},{id:sheets_src.zo2.id,params:{unitId,subUnitId:fromSubUnitId,ranges:fromMergeRanges}}];redos=[{id:sheets_src.o2G.id,params:doMoveRangeMutation},...interceptorCommands.redos,...mergeRedos,{id:sheets_src.NSB.id,params:{unitId,subUnitId:toSubUnitId,selections:[{range:toRange}],type:sheets_src.kFf.MOVE_END}}],undos=[{id:sheets_src.o2G.id,params:undoMoveRangeMutation},...interceptorCommands.undos,...mergeUndos,{id:sheets_src.NSB.id,params:{unitId,subUnitId:fromSubUnitId,type:sheets_src.kFf.MOVE_END,selections:[{range:fromRange}]}}]}}return{undos,redos}}(pasteFrom,pasteTo,accessor);redoMutationsInfo.push(...redos),undoMutationsInfo.push(...undos)}else{const{undos:clearStyleUndos,redos:clearStyleRedos}=getClearCellStyleMutations(pasteTo,data,accessor);redoMutationsInfo.push(...clearStyleRedos),undoMutationsInfo.push(...clearStyleUndos);const{undos:clearValueUndos,redos:clearValueRedos}=function getClearCellValueMutations(pasteTo,matrix,accessor){const redoMutationsInfo=[],undoMutationsInfo=[],clearValueMatrix=new src.hDc,{unitId,subUnitId,range}=pasteTo,{mapFunc}=virtualizeDiscreteRanges([range]);if(matrix.forValue(((row,col,_value)=>{const{row:actualRow,col:actualCol}=mapFunc(row,col);clearValueMatrix.setValue(actualRow,actualCol,{v:null,p:null})})),clearValueMatrix.getLength()>0){const clearMutation={subUnitId,unitId,cellValue:src.S0q.deepClone(clearValueMatrix.getMatrix())};redoMutationsInfo.push({id:sheets_src.N48.id,params:clearMutation});const undoClearMutation=(0,sheets_src.hro)(accessor,clearMutation);undoMutationsInfo.push({id:sheets_src.N48.id,params:undoClearMutation})}return{undos:undoMutationsInfo,redos:redoMutationsInfo}}(pasteTo,data,accessor);redoMutationsInfo.push(...clearValueRedos),undoMutationsInfo.push(...clearValueUndos);const{undos:setValuesUndos,redos:setValuesRedos}=getSetCellValueMutations(pasteTo,pasteFrom,data,accessor);redoMutationsInfo.push(...setValuesRedos),undoMutationsInfo.push(...setValuesUndos);const{undos:setStyleUndos,redos:setStyleRedos}=getSetCellStyleMutations(pasteTo,data,accessor,!0);redoMutationsInfo.push(...setStyleRedos),undoMutationsInfo.push(...setStyleUndos);const{undos:clearMergeUndos,redos:clearMergeRedos}=getClearAndSetMergeMutations(pasteTo,data,accessor);redoMutationsInfo.push(...clearMergeRedos),undoMutationsInfo.push(...clearMergeUndos)}return{undos:undoMutationsInfo,redos:redoMutationsInfo}}function getSetCellValueMutations(pasteTo,pasteFrom,matrix,accessor){const{unitId,subUnitId,range}=pasteTo,redoMutationsInfo=[],undoMutationsInfo=[],{mapFunc}=virtualizeDiscreteRanges([range]),valueMatrix=new src.hDc;matrix.forValue(((row,col,value)=>{let originNumberValue;if(!value.p&&value.v&&!pasteFrom){const content=String(value.v),numfmtValue=src.gIL.parseValue(content);void 0!==numfmtValue?.v&&"number"==typeof numfmtValue.v&&(originNumberValue=numfmtValue.v)}const{row:realRow,col:realCol}=mapFunc(row,col);if(value.p?.body&&isRichText(value.p.body)){const newValue=src.S0q.deepClone({p:value.p,v:originNumberValue??value.v});valueMatrix.setValue(realRow,realCol,newValue)}else valueMatrix.setValue(realRow,realCol,src.S0q.deepClone({v:originNumberValue??value.v,t:value.t}))}));const setValuesMutation={unitId,subUnitId,cellValue:src.S0q.deepClone(valueMatrix.getMatrix())};redoMutationsInfo.push({id:sheets_src.N48.id,params:setValuesMutation});const undoSetValuesMutation=(0,sheets_src.hro)(accessor,setValuesMutation);return undoMutationsInfo.push({id:sheets_src.N48.id,params:undoSetValuesMutation}),{undos:undoMutationsInfo,redos:redoMutationsInfo}}function getSetCellStyleMutations(pasteTo,matrix,accessor,withRichFormat=!1){const redoMutationsInfo=[],undoMutationsInfo=[],{unitId,subUnitId,range}=pasteTo,valueMatrix=new src.hDc,{mapFunc}=virtualizeDiscreteRanges([range]);matrix.forValue(((row,col,value)=>{const newValue={s:Object.assign({},{...src.Hnp,pd:engine_render_src.nR0,bg:null,cl:null},value.s)},cellBd=newValue.s.bd;if(cellBd){Object.keys(cellBd).length>0||(newValue.s.bd={b:null,l:null,r:null,t:null})}const content=String(value.v),numfmtValue=src.gIL.parseValue(content);numfmtValue?.z&&(newValue.s||(newValue.s={}),"object"==typeof newValue.s&&(newValue.s?.n?newValue.s.n.pattern=numfmtValue.z:newValue.s.n={pattern:numfmtValue.z}));const{row:actualRow,col:actualCol}=mapFunc(row,col);valueMatrix.setValue(actualRow,actualCol,newValue)}));const setValuesMutation={unitId,subUnitId,cellValue:src.S0q.deepClone(valueMatrix.getMatrix())};redoMutationsInfo.push({id:sheets_src.N48.id,params:setValuesMutation});const undoSetValuesMutation=(0,sheets_src.hro)(accessor,setValuesMutation);return undoMutationsInfo.push({id:sheets_src.N48.id,params:undoSetValuesMutation}),{undos:undoMutationsInfo,redos:redoMutationsInfo}}function getClearCellStyleMutations(pasteTo,matrix,accessor){const redoMutationsInfo=[],undoMutationsInfo=[],clearStyleMatrix=new src.hDc,{unitId,subUnitId,range}=pasteTo,{mapFunc}=virtualizeDiscreteRanges([range]);if(matrix.forEach(((rowIndex,row)=>{Object.keys(row).forEach((colIndexStr=>{const colIndex=Number(colIndexStr),{row:actualRow,col:actualCol}=mapFunc(rowIndex,colIndex);clearStyleMatrix.setValue(actualRow,actualCol,{s:null})}))})),clearStyleMatrix.getLength()>0){const clearMutation={subUnitId,unitId,cellValue:src.S0q.deepClone(clearStyleMatrix.getMatrix())};redoMutationsInfo.push({id:sheets_src.N48.id,params:clearMutation});const undoClearMutation=(0,sheets_src.hro)(accessor,clearMutation);undoMutationsInfo.push({id:sheets_src.N48.id,params:undoClearMutation})}return{undos:undoMutationsInfo,redos:redoMutationsInfo}}function getClearAndSetMergeMutations(pasteTo,matrix,accessor){const redoMutationsInfo=[],undoMutationsInfo=[],{unitId,subUnitId,range}=pasteTo,{startColumn,startRow,endColumn,endRow}=discreteRangeToRange(range),mergeRangeData=[];matrix.forValue(((row,col,value)=>{if(value.rowSpan&&value.rowSpan>1){const colSpan=value.colSpan||1,mergeRange={startRow:startRow+row,endRow:startRow+row+value.rowSpan-1,startColumn:startColumn+col,endColumn:startColumn+col+colSpan-1};mergeRangeData.push(mergeRange)}else if(value.colSpan&&value.colSpan>1){const rowSpan=value.rowSpan||1,mergeRange={startRow:startRow+row,endRow:startRow+row+rowSpan-1,startColumn:startColumn+col,endColumn:startColumn+col+value.colSpan-1};mergeRangeData.push(mergeRange)}}));const workbook=accessor.get(src.HCr).getUniverSheetInstance(unitId),worksheet=workbook?.getSheetBySheetId(subUnitId);if(workbook&&worksheet){const removeMergeMutationParams={unitId,subUnitId,ranges:worksheet.getMergeData().filter((rect=>src.M_G.intersects({startRow,startColumn,endRow,endColumn},rect)))};redoMutationsInfo.push({id:sheets_src._L3.id,params:removeMergeMutationParams});const undoRemoveMergeMutationParams=(0,sheets_src.IX1)(accessor,removeMergeMutationParams);undoMutationsInfo.push({id:sheets_src.zo2.id,params:undoRemoveMergeMutationParams})}const addMergeMutationParams={unitId,subUnitId,ranges:mergeRangeData};mergeRangeData.length>0&&redoMutationsInfo.push({id:sheets_src.zo2.id,params:addMergeMutationParams});const undoAddMergeMutation=(0,sheets_src.PL)(accessor,addMergeMutationParams);return mergeRangeData.length>0&&undoMutationsInfo.push({id:sheets_src._L3.id,params:undoAddMergeMutation}),{undos:undoMutationsInfo,redos:redoMutationsInfo}}function clipboard_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function clipboard_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}const shouldRemoveShapeIds=[sheets_src.RmT.id,sheets_src.bS1.id,sheets_src.MIN.id,sheets_src.G4z.id,sheets_src.o2G.id,sheets_src.yNb.id,sheets_src.YJl.id];class SheetClipboardController extends src.hy_{constructor(_injector,_instanceService,_renderManagerService,_commandService,_contextService,_configService,_sheetClipboardService,_messageService,_localService,_uiPartsService){super(),this._injector=_injector,this._instanceService=_instanceService,this._renderManagerService=_renderManagerService,this._commandService=_commandService,this._contextService=_contextService,this._configService=_configService,this._sheetClipboardService=_sheetClipboardService,this._messageService=_messageService,this._localService=_localService,this._uiPartsService=_uiPartsService,this._refreshOptionalPaste$=new Subject.B,this.refreshOptionalPaste$=this._refreshOptionalPaste$.asObservable(),this._init(),this._initCommandListener(),this._initUIComponents(),this._pasteWithDoc()}refreshOptionalPaste(){this._refreshOptionalPaste$.next(Math.random())}_pasteWithDoc(){const sheetPasteShortKeyFn=docSelectionRenderService=>{docSelectionRenderService.onPaste$.pipe((0,takeUntil.Q)(this.dispose$)).subscribe((config=>{if(!whenSheetEditorFocused(this._contextService))return;config.event.preventDefault();const clipboardEvent=config.event,htmlContent=clipboardEvent.clipboardData?.getData("text/html"),textContent=clipboardEvent.clipboardData?.getData("text/plain"),files=this._resolveClipboardFiles(clipboardEvent.clipboardData);this._commandService.executeCommand(SheetPasteShortKeyCommand.id,{htmlContent,textContent,files})}))};let docSelectionRenderService=this._renderManagerService.getRenderById(src.Fmw)?.with(doc_selection_render_service.q);docSelectionRenderService&&sheetPasteShortKeyFn(docSelectionRenderService),this._renderManagerService.created$.subscribe((renderer=>{renderer.unitId===src.Fmw&&(docSelectionRenderService=this._renderManagerService.getRenderById(src.Fmw)?.with(doc_selection_render_service.q),docSelectionRenderService&&sheetPasteShortKeyFn(docSelectionRenderService))}))}_resolveClipboardFiles(clipboardData){if(!clipboardData)return;const files=Array.from(clipboardData.items).map((item=>"file"===item.kind?item.getAsFile():void 0)).filter(Boolean);return files.length>0?files:void 0}_init(){[SheetCopyCommand,clipboard_command_SheetCutCommand,SheetPasteCommand].forEach((command=>this.disposeWithMe(this._commandService.registerMultipleCommand(command)))),[SheetPasteValueCommand,SheetPasteFormatCommand,SheetPasteColWidthCommand,SheetPasteBesidesBorderCommand,SheetPasteShortKeyCommand,SheetOptionalPasteCommand].forEach((command=>this.disposeWithMe(this._commandService.registerCommand(command)))),this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._initCopyingHooks())),this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._initPastingHook()));const disposables=this._initSpecialPasteHooks().map((hook=>this._sheetClipboardService.addClipboardHook(hook)));this.disposeWithMe({dispose:()=>disposables.forEach((d=>d.dispose()))})}_initCopyingHooks(){const self=this;let currentSheet=null;return{id:PREDEFINED_HOOK_NAME.DEFAULT_COPY,isDefaultHook:!0,onBeforeCopy(unitId,subUnitId){currentSheet=self._getWorksheet(unitId,subUnitId)},onCopyCellContent(row,col){const cell=currentSheet.getCell(row,col);if(cell?.p?.body?.paragraphs||cell?.p?.body?.textRuns)return(0,src.S69)(cell.p.body);return cell?(0,src.zo$)(cell):""},onCopyCellStyle:(row,col,rowSpan,colSpan)=>{const properties={};(rowSpan||colSpan)&&(properties.rowspan=`${rowSpan||1}`,properties.colspan=`${colSpan||1}`);const range=currentSheet.getRange(row,col),mergedCellByRowCol=currentSheet.getMergedCell(row,col),textStyle=range.getTextStyle();let style="";if(textStyle&&(style=(0,src.gF)(textStyle)),mergedCellByRowCol){const endRow=mergedCellByRowCol.endRow,endColumn=mergedCellByRowCol.endColumn,lastTextStyle=currentSheet.getRange(endRow,endColumn).getTextStyle();if(lastTextStyle){const lastStyle=(0,src.gF)(lastTextStyle);style?style+=lastStyle?`;${lastStyle}`:"":style=lastStyle}}return style&&(properties.style=style),Object.keys(properties).length?properties:null},onCopyColumn:col=>({width:`${currentSheet.getColumnWidth(col)}`}),onCopyRow:row=>({style:`height: ${currentSheet.getRowHeight(row)}px;`}),onAfterCopy(){currentSheet=null},getFilteredOutRows(range){const{startRow,endRow}=range,worksheet=self._instanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET)?.getActiveSheet(),res=[];if(!worksheet)return res;for(let r=startRow;r<=endRow;r++)worksheet.getRowFiltered(r)&&res.push(r);return res}}}_initPastingHook(){const self=this;let unitId=null,subUnitId=null,currentSheet=null;return{id:PREDEFINED_HOOK_NAME.DEFAULT_PASTE,isDefaultHook:!0,onBeforePaste({unitId:unitId_,subUnitId:subUnitId_,range}){currentSheet=self._getWorksheet(unitId_,subUnitId_),unitId=unitId_,subUnitId=subUnitId_;const maxConfig=self._configService.getConfig(sheets_src.QM2),endRow=range.rows[range.rows.length-1],endColumn=range.cols[range.cols.length-1];return!(maxConfig&&endRow*endColumn>maxConfig)||(self._messageService.show({type:design_src.Go.Error,content:self._localService.t("clipboard.paste.exceedMaxCells")}),!1)},onPasteRows(pasteTo,rowProperties){const{range}=pasteTo,redoMutations=[],undoMutations=[],maxRow=currentSheet.getMaxRows(),rowCount=maxRow-1,addingRowsCount=range.rows[range.rows.length-1]-rowCount,existingRowsCount=rowProperties.length-addingRowsCount,rowManager=currentSheet.getRowManager();if(addingRowsCount>0){const rowInfo={};rowProperties.slice(existingRowsCount).forEach(((property,index)=>{const{height:PropertyHeight}=property||{};PropertyHeight&&(rowInfo[index]={h:Number.parseFloat(PropertyHeight),hd:src.OdA.FALSE})}));const addRowRange={startColumn:range.cols[0],endColumn:range.cols[range.cols.length-1],endRow:range.rows[range.rows.length-1],startRow:maxRow},addRowMutation={unitId,subUnitId,range:addRowRange,rowInfo};redoMutations.push({id:sheets_src.bS1.id,params:addRowMutation}),undoMutations.push({id:sheets_src.G4z.id,params:{unitId,subUnitId,range:addRowRange}})}const rowHeight={},originRowHeight={};if(rowProperties.slice(0,existingRowsCount).forEach(((property,index)=>{const{height:propertyHeight}=property;if(propertyHeight){const rowConfigBeforePaste=rowManager.getRow(range.rows[0]+index),willSetHeight=Number.parseFloat(propertyHeight);if(rowConfigBeforePaste){const{h=src.eqW,ah=0}=rowConfigBeforePaste,nowRowHeight=Math.max(h,ah);willSetHeight>nowRowHeight?(rowHeight[index+range.rows[0]]=willSetHeight,originRowHeight[index+range.rows[0]]=nowRowHeight):(rowHeight[index+range.rows[0]]=nowRowHeight,originRowHeight[index+range.rows[0]]=nowRowHeight)}else rowHeight[index+range.rows[0]]=willSetHeight,originRowHeight[index+range.rows[0]]=rowManager.getRow(range.rows[0]+index)?.h??src.eqW}})),Object.keys(rowHeight).length){const setRowPropertyMutation={unitId,subUnitId,ranges:[{startRow:range.rows[0],endRow:Math.min(range.rows[range.rows.length-1],maxRow),startColumn:range.cols[0],endColumn:range.cols[range.cols.length-1]}],rowHeight};redoMutations.push({id:sheets_src.BtL.id,params:setRowPropertyMutation}),undoMutations.push({id:sheets_src.BtL.id,params:{...setRowPropertyMutation,rowHeight:originRowHeight}})}return{redos:redoMutations,undos:undoMutations}},onPasteColumns(pasteTo,colProperties,pasteType){const{range}=pasteTo,redoMutations=[],undoMutations=[],maxColumn=currentSheet.getMaxColumns(),colCount=maxColumn-1,addingColsCount=range.cols[range.cols.length-1]-colCount,existingColsCount=colProperties.length-addingColsCount,defaultColumnWidth=self._configService.getConfig(src.zQH)??src.pry,pasteToCols=range.cols,startColumn=pasteToCols[0];if(addingColsCount>0){const addColRange={startRow:range.rows[0],endRow:range.rows[range.rows.length-1],endColumn:range.cols[range.cols.length-1],startColumn:maxColumn},addColMutation={unitId,subUnitId,range:addColRange,colInfo:colProperties.slice(existingColsCount).map(((property,index)=>({w:property.width?Math.max(+property.width,currentSheet.getColumnWidth(pasteToCols[index])):defaultColumnWidth,hd:src.OdA.FALSE})))};redoMutations.push({id:sheets_src.RmT.id,params:addColMutation}),undoMutations.push({id:sheets_src.MIN.id,params:{unitId,subUnitId,range:addColRange}})}const targetSetColPropertyParams={unitId,subUnitId,ranges:[{startRow:range.rows[0],endRow:range.rows[range.rows.length-1],startColumn:range.cols[0],endColumn:Math.min(range.cols[range.cols.length-1],maxColumn)}]};if(colProperties.length>0){const setColPropertyMutation={...targetSetColPropertyParams,colWidth:colProperties.slice(0,existingColsCount).reduce(((p,c,index)=>(p[index+startColumn]=c.width?Math.max(+c.width,currentSheet.getColumnWidth(pasteToCols[index])??defaultColumnWidth):defaultColumnWidth,p)),{})},undoSetColPropertyParams={...targetSetColPropertyParams,colWidth:colProperties.slice(0,existingColsCount).reduce(((p,c,index)=>(p[index+startColumn]=currentSheet.getColumnWidth(pasteToCols[index])??defaultColumnWidth,p)),{})};redoMutations.push({id:sheets_src.Cay.id,params:setColPropertyMutation}),undoMutations.push({id:sheets_src.Cay.id,params:undoSetColPropertyParams})}return{redos:redoMutations,undos:undoMutations}},onPastePlainText:(pasteTo,text,payload)=>self._onPastePlainText(pasteTo,text,payload),onPasteCells:(pasteFrom,pasteTo,data,payload)=>self._onPasteCells(pasteFrom,pasteTo,data,payload),onAfterPaste(success){currentSheet=null}}}_generateDocumentDataModelSnapshot(snapshot){const currentSkeleton=(0,engine_render_src.KMz)(src.Zy$.UNIVER_SHEET,sheet_skeleton_manager_service_SheetSkeletonManagerService,this._instanceService,this._renderManagerService)?.getCurrentParam();if(null==currentSkeleton)return null;const{skeleton}=currentSkeleton,documentModel=skeleton.getBlankCellDocumentModel()?.documentModel,p=documentModel?.getSnapshot(),documentData={...p,...snapshot};return documentModel?.reset(documentData),documentModel?.getSnapshot()}_onPastePlainText(pasteTo,text,payload){const{range,unitId,subUnitId}=pasteTo;let cellValue;if(/\r|\n/.test(text)||src.S0q.isLegalUrl(text)){const body=function generateBody(text){if(!text.includes("\r")&&src.S0q.isLegalUrl(text)){const id=(0,src.MZQ)(),urlText=`${text}`,range={startIndex:0,endIndex:urlText.length-1,rangeId:id,rangeType:src.Bvh.HYPERLINK,properties:{url:text}};return{dataStream:`${urlText}\r\n`,paragraphs:[{startIndex:urlText.length}],customRanges:[range]}}let dataStream=text.replace(/(\r\n|\n)/g,"\r");dataStream.endsWith("\r\n")||(dataStream+="\r\n");const paragraphs=[];for(let i=0;i<dataStream.length;i++)"\r"===dataStream[i]&&paragraphs.push({startIndex:i});return{dataStream,paragraphs,sectionBreaks:[{startIndex:dataStream.indexOf("\n")}]}}(text),p=this._generateDocumentDataModelSnapshot({body});cellValue={[range.rows[0]]:{[range.cols[0]]:{p}}}}else cellValue=(0,src.qGs)(text)?{[range.rows[0]]:{[range.cols[0]]:{f:text}}}:{[range.rows[0]]:{[range.cols[0]]:{v:text}}};const setRangeValuesParams={unitId,subUnitId,cellValue};return{redos:[{id:sheets_src.N48.id,params:setRangeValuesParams}],undos:[{id:sheets_src.N48.id,params:(0,sheets_src.hro)(this._injector,setRangeValuesParams)}]}}_onPasteCells(pasteFrom,pasteTo,data,payload){return this._injector.invoke((accessor=>getDefaultOnPasteCellMutations(pasteFrom,pasteTo,data,payload,accessor)))}_initSpecialPasteHooks(){const self=this;return[{id:PREDEFINED_HOOK_NAME.SPECIAL_PASTE_VALUE,specialPasteInfo:{label:"specialPaste.value"},onPasteCells:(pasteFrom,pasteTo,data)=>this._injector.invoke((accessor=>getSetCellValueMutations(pasteTo,pasteFrom,data,accessor)))},{id:PREDEFINED_HOOK_NAME.SPECIAL_PASTE_FORMAT,specialPasteInfo:{label:"specialPaste.format"},onPasteCells:(pasteFrom,pasteTo,matrix)=>{const redoMutationsInfo=[],undoMutationsInfo=[],{undos:styleUndos,redos:styleRedos}=this._injector.invoke((accessor=>getClearCellStyleMutations(pasteTo,matrix,accessor)));redoMutationsInfo.push(...styleRedos),undoMutationsInfo.push(...styleUndos);const{undos:mergeUndos,redos:mergeRedos}=this._injector.invoke((accessor=>getClearAndSetMergeMutations(pasteTo,matrix,accessor)));redoMutationsInfo.push(...mergeRedos),undoMutationsInfo.push(...mergeUndos);const{undos:setStyleUndos,redos:setStyleRedos}=this._injector.invoke((accessor=>getSetCellStyleMutations(pasteTo,matrix,accessor)));return redoMutationsInfo.push(...setStyleRedos),undoMutationsInfo.push(...setStyleUndos),{undos:undoMutationsInfo,redos:redoMutationsInfo}}},{id:PREDEFINED_HOOK_NAME.SPECIAL_PASTE_COL_WIDTH,specialPasteInfo:{label:"specialPaste.colWidth"},onPasteCells:()=>({undos:[],redos:[]}),onPasteColumns(pasteTo,colProperties,payload){const workbook=self._instanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),unitId=workbook.getUnitId(),subUnitId=workbook.getActiveSheet()?.getSheetId();if(!unitId||!subUnitId)throw new Error("Cannot find unitId or subUnitId");const redoMutations=[],undoMutations=[],currentSheet=self._getWorksheet(unitId,subUnitId),{range}=pasteTo,pasteToCols=range.cols,startColumn=pasteToCols[0],maxColumn=currentSheet.getMaxColumns(),addingColsCount=range.cols[range.cols.length-1]-maxColumn,existingColsCount=colProperties.length-addingColsCount,defaultColumnWidth=self._configService.getConfig(src.zQH)??src.pry,setColPropertyMutation={unitId,subUnitId,ranges:[{startRow:range.rows[0],endRow:Math.min(range.cols[range.cols.length-1],maxColumn),startColumn:range.cols[0],endColumn:range.cols[range.cols.length-1]}],colWidth:colProperties.slice(0,existingColsCount).reduce(((p,c,index)=>(p[index+startColumn]=c.width?Math.max(+c.width,currentSheet.getColumnWidth(pasteToCols[index])??defaultColumnWidth):defaultColumnWidth,p)),{})},undoSetColPropertyMutation={unitId,subUnitId,ranges:[{startRow:range.rows[0],endRow:Math.min(range.cols[range.cols.length-1],maxColumn),startColumn:range.cols[0],endColumn:range.cols[range.cols.length-1]}],colWidth:colProperties.slice(0,existingColsCount).reduce(((p,c,index)=>(p[index+startColumn]=currentSheet.getColumnWidth(pasteToCols[index])??defaultColumnWidth,p)),{})};return redoMutations.push({id:sheets_src.Cay.id,params:setColPropertyMutation}),undoMutations.push({id:sheets_src.Cay.id,params:undoSetColPropertyMutation}),{redos:redoMutations,undos:undoMutations}}},{id:PREDEFINED_HOOK_NAME.SPECIAL_PASTE_BESIDES_BORDER,specialPasteInfo:{label:"specialPaste.besidesBorder"},onPasteCells:(pasteFrom,pasteTo,matrix,payload)=>{self._instanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET);const redoMutationsInfo=[],undoMutationsInfo=[],{range,unitId,subUnitId}=pasteTo,valueMatrix=new src.hDc;matrix.forValue(((row,col,value)=>{const style=value.s;if("object"==typeof style){const newValue=src.S0q.deepClone(value);newValue.s&&(newValue.s={...style,bd:null}),valueMatrix.setValue(range.rows[row],range.cols[col],newValue)}}));const setValuesMutation={unitId,subUnitId,cellValue:valueMatrix.getData()};redoMutationsInfo.push({id:sheets_src.N48.id,params:setValuesMutation});const undoSetValuesMutation=this._injector.invoke(sheets_src.hro,setValuesMutation);undoMutationsInfo.push({id:sheets_src.N48.id,params:undoSetValuesMutation});const{undos,redos}=this._injector.invoke((accessor=>getClearAndSetMergeMutations(pasteTo,matrix,accessor)));return undoMutationsInfo.push(...undos),redoMutationsInfo.push(...redos),{redos:redoMutationsInfo,undos:undoMutationsInfo}}}]}_getWorksheet(unitId,subUnitId){const worksheet=this._instanceService.getUniverSheetInstance(unitId)?.getSheetBySheetId(subUnitId);if(!worksheet)throw new Error(`[SheetClipboardController]: cannot find a worksheet with unitId ${unitId} and subUnitId ${subUnitId}.`);return worksheet}_initCommandListener(){this.disposeWithMe(this._commandService.onCommandExecuted((command=>{(command.id===AddWorksheetMergeCommand.id||shouldRemoveShapeIds.includes(command.id))&&this._sheetClipboardService.removeMarkSelection()})));const sheetsUIConfig=this._configService.getConfig("sheets-ui.config");sheetsUIConfig?.clipboardConfig?.hidePasteOptions||(this.disposeWithMe(this._commandService.onCommandExecuted((command=>{RemovePasteMenuCommands.includes(command.id)&&this._sheetClipboardService.disposePasteOptionsCache()}))),this.disposeWithMe(this._commandService.onCommandExecuted((command=>{if(command.id===SetScrollOperation.id){if(!this._sheetClipboardService.getPasteMenuVisible())return;const scrollUnitId=command.params.unitId,pasteOptionsCache=this._sheetClipboardService.getPasteOptionsCache(),menuUnitId=pasteOptionsCache?.target.unitId;scrollUnitId===menuUnitId&&this._refreshOptionalPaste$.next(Math.random())}}))))}_initUIComponents(){const sheetsUIConfig=this._configService.getConfig("sheets-ui.config");sheetsUIConfig?.clipboardConfig?.hidePasteOptions||this.disposeWithMe(this._uiPartsService.registerComponent(ui_src.ns.CONTENT,(()=>(0,ui_src.pK)(ClipboardPopupMenu,this._injector))))}}function drag_manager_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function drag_manager_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}SheetClipboardController=function clipboard_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([clipboard_controller_ts_param(0,(0,src.y_5)(src.zZn)),clipboard_controller_ts_param(1,src.HCr),clipboard_controller_ts_param(2,engine_render_src.cSx),clipboard_controller_ts_param(3,src.wTY),clipboard_controller_ts_param(4,src.oaf),clipboard_controller_ts_param(5,src.J0C),clipboard_controller_ts_param(6,ISheetClipboardService),clipboard_controller_ts_param(7,ui_src.mX),clipboard_controller_ts_param(8,(0,src.y_5)(src.iH9)),clipboard_controller_ts_param(9,ui_src.fe),clipboard_controller_ts_metadata("design:type",Function),clipboard_controller_ts_metadata("design:paramtypes",[void 0===src.zZn?Object:src.zZn,void 0===src.HCr?Object:src.HCr,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===src.wTY?Object:src.wTY,void 0===src.oaf?Object:src.oaf,void 0===src.J0C?Object:src.J0C,void 0===ISheetClipboardService?Object:ISheetClipboardService,void 0===ui_src.mX?Object:ui_src.mX,void 0===src.iH9?Object:src.iH9,void 0===ui_src.fe?Object:ui_src.fe])],SheetClipboardController);class DragManagerService extends src.jGt{constructor(_univerInstanceService,_renderManagerService){super(),this._univerInstanceService=_univerInstanceService,this._renderManagerService=_renderManagerService,this._currentCell$=new Subject.B,this.currentCell$=this._currentCell$.asObservable().pipe((0,distinctUntilChanged.F)(((pre,aft)=>pre?.location?.unitId===aft?.location?.unitId&&pre?.location?.subUnitId===aft?.location?.subUnitId&&pre?.location?.row===aft?.location?.row&&pre?.location?.col===aft?.location?.col))),this._endCell$=new Subject.B,this.endCell$=this._endCell$.asObservable(),this._initCellDisposableListener()}dispose(){super.dispose(),this._currentCell$.complete(),this._endCell$.complete()}_initCellDisposableListener(){this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET).subscribe((workbook=>{workbook||(this._currentCell$.next(null),this._endCell$.next(null))})))}_calcActiveCell(offsetX,offsetY){const workbook=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET);if(!workbook)return null;const worksheet=workbook.getActiveSheet();if(!worksheet)return;const currentRender=this._renderManagerService.getRenderById(workbook.getUnitId());if(!currentRender)return;const skeletonParam=currentRender.with(sheet_skeleton_manager_service_SheetSkeletonManagerService).getCurrentParam(),scrollInfo=currentRender.with(SheetScrollManagerService).getCurrentScrollState();return skeletonParam&&scrollInfo&&currentRender?getHoverCellPosition(currentRender,workbook,worksheet,skeletonParam,offsetX,offsetY):void 0}onDragOver(evt){const{offsetX,offsetY,dataTransfer}=evt,activeCell=this._calcActiveCell(offsetX,offsetY);if(!activeCell)return void this._currentCell$.next(null);const{location,position}=activeCell;this._currentCell$.next({location,position,dataTransfer})}onDrop(evt){const{offsetX,offsetY,dataTransfer}=evt,activeCell=this._calcActiveCell(offsetX,offsetY);if(!activeCell)return void this._endCell$.next(null);const{location,position}=activeCell;this._endCell$.next({location,position,dataTransfer})}}function drag_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function drag_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}DragManagerService=function drag_manager_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([drag_manager_service_ts_param(0,src.HCr),drag_manager_service_ts_param(1,engine_render_src.cSx),drag_manager_service_ts_metadata("design:type",Function),drag_manager_service_ts_metadata("design:paramtypes",[void 0===src.HCr?Object:src.HCr,void 0===engine_render_src.cSx?Object:engine_render_src.cSx])],DragManagerService);class DragRenderController extends src.jGt{constructor(_context,_renderManagerService,_dragManagerService,_sheetSkeletonManagerService){super(),this._context=_context,this._renderManagerService=_renderManagerService,this._dragManagerService=_dragManagerService,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._initDragEvent()}_initDragEvent(){const disposeSet=new src.VdD,handleSkeletonChange=skeletonParam=>{if(disposeSet.dispose(),!skeletonParam)return;const{scene}=this._context,dragOverSub=scene.onDragOver$.subscribeEvent((evt=>{this._dragManagerService.onDragOver(evt)})),dropSub=scene.onDrop$.subscribeEvent((evt=>{this._dragManagerService.onDrop(evt)}));disposeSet.add({dispose(){dragOverSub.unsubscribe(),dropSub.unsubscribe()}})};handleSkeletonChange(this._sheetSkeletonManagerService.getCurrentParam()),this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((skeletonParam=>{handleSkeletonChange(skeletonParam)})))}}DragRenderController=function drag_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([drag_render_controller_ts_param(1,engine_render_src.cSx),drag_render_controller_ts_param(2,(0,src.y_5)(DragManagerService)),drag_render_controller_ts_param(3,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),drag_render_controller_ts_metadata("design:type",Function),drag_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===DragManagerService?Object:DragManagerService,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService])],DragRenderController);const doc_skeleton_util_calcDocRangePositions=(range,skeleton)=>{const startPosition=skeleton.findNodePositionByCharIndex(range.startOffset,!0,range.segmentId,-1),skeletonData=skeleton.getSkeletonData();let end=range.endOffset;if(range.segmentId){const root=Array.from(skeletonData?.skeFooters.get(range.segmentId)?.values()??[])[0]??Array.from(skeletonData?.skeHeaders.get(range.segmentId)?.values()??[])[0];root&&(end=Math.min(root.ed,end))}const endPosition=skeleton.findNodePositionByCharIndex(end,!0,range.segmentId,-1);if(!endPosition||!startPosition)return;const convertor=new convert_text_range.Wb({docsLeft:0,docsTop:0,pageMarginLeft:0,pageMarginTop:0},skeleton),{borderBoxPointGroup}=convertor.getRangePointData(startPosition,endPosition);return(0,text_range.rb)(borderBoxPointGroup).map((rect=>({top:rect.top,bottom:rect.bottom,left:rect.left,right:rect.right})))},calcBulletPosition=(skeleton,paragraph,paddingLeft=0,paddingTop=0)=>{const node=skeleton.findNodeByCharIndex(paragraph.startIndex),divide=node?.parent,line=divide?.parent,column=line?.parent,targetLine=column?.lines.find((l=>l.paragraphStart&&l.paragraphIndex===paragraph.startIndex)),bulletNode=targetLine?.divides?.[0]?.glyphGroup?.[0];if(!bulletNode)return;if(!bulletNode)return;const rect=((glyph,skeleton,pageIndex=-1)=>{const start=skeleton.findPositionByGlyph(glyph,pageIndex);if(!start)return;const startPosition={...start,isBack:!0},convertor=new convert_text_range.Wb({docsLeft:0,docsTop:0,pageMarginLeft:0,pageMarginTop:0},skeleton),{borderBoxPointGroup}=convertor.getRangePointData(startPosition,startPosition),rect=(0,text_range.rb)(borderBoxPointGroup)[0];return{top:rect.top,bottom:rect.bottom,left:rect.left,right:rect.right}})(bulletNode,skeleton);return rect?{rect:{top:rect.top+paddingTop,bottom:rect.bottom+paddingTop,left:rect.left+paddingLeft,right:rect.right+paddingLeft},segmentId:void 0,segmentPageIndex:-1,paragraph}:void 0},calculateDocSkeletonRects=(docSkeleton,paddingLeft=0,paddingTop=0)=>{const docModel=docSkeleton.getViewModel().getDataModel(),hyperLinks=docModel.getBody()?.customRanges?.filter((range=>range.rangeType===src.Bvh.HYPERLINK))??[],checkLists=docModel.getBody()?.paragraphs?.filter((p=>0===p.bullet?.listType.indexOf(src.yrS.CHECK_LIST)))??[],drawings=docSkeleton.getSkeletonData()?.pages[0].skeDrawings;return{links:hyperLinks.map((link=>((skeleton,range,paddingLeft=0,paddingTop=0)=>{const rects=doc_skeleton_util_calcDocRangePositions({startOffset:range.startIndex,endOffset:range.endIndex+1,collapsed:!1},skeleton);if(rects)return{rects:rects.map((rect=>({top:rect.top+paddingTop,bottom:rect.bottom+paddingTop,left:rect.left+paddingLeft,right:rect.right+paddingLeft}))),range}})(docSkeleton,link,paddingLeft,paddingTop))).filter(Boolean),checkLists:checkLists.map((list=>calcBulletPosition(docSkeleton,list,paddingLeft,paddingTop))).filter(Boolean),drawings:drawings?Array.from(drawings.keys()).map((key=>({drawingId:key,rect:{top:drawings.get(key).aTop,bottom:drawings.get(key).aTop+drawings.get(key).width,left:drawings.get(key).aLeft,right:drawings.get(key).aLeft+drawings.get(key).height}}))):[]}};function calcPadding(cell,font,isNum){const height=font.documentSkeleton?.getSkeletonData()?.pages[0].height??0,width=font.documentSkeleton?.getSkeletonData()?.pages[0].width??0,vt=font.verticalAlign,ht=font.horizontalAlign;let paddingTop=0;switch(vt){case src.G4t.UNSPECIFIED:case src.G4t.BOTTOM:paddingTop=cell.mergeInfo.endY-cell.mergeInfo.startY-height;break;case src.G4t.MIDDLE:paddingTop=(cell.mergeInfo.endY-cell.mergeInfo.startY-height)/2}let paddingLeft=0;switch(ht){case src.wqs.RIGHT:paddingLeft=cell.mergeInfo.endX-cell.mergeInfo.startX-width;break;case src.wqs.CENTER:paddingLeft=(cell.mergeInfo.endX-cell.mergeInfo.startX-width)/2;break;case src.wqs.UNSPECIFIED:isNum&&(paddingLeft=cell.mergeInfo.endX-cell.mergeInfo.startX-width)}return{paddingLeft,paddingTop}}function hover_manager_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function hover_manager_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}function getLocationBase(location){const{workbook,worksheet,...locBase}=location;return locBase}class HoverManagerService extends src.jGt{constructor(_univerInstanceService,_renderManagerService){super(),this._univerInstanceService=_univerInstanceService,this._renderManagerService=_renderManagerService,this._currentCell$=new BehaviorSubject.t(null),this._currentRichText$=new BehaviorSubject.t(null),this._currentClickedCell$=new Subject.B,this._currentDbClickedCell$=new Subject.B,this._currentCellWithEvent$=new Subject.B,this._currentPointerDownCell$=new Subject.B,this._currentPointerUpCell$=new Subject.B,this._currentHoveredRowHeader$=new BehaviorSubject.t(null),this._currentHoveredColHeader$=new BehaviorSubject.t(null),this._currentRowHeaderClick$=new Subject.B,this._currentColHeaderClick$=new Subject.B,this._currentRowHeaderDbClick$=new Subject.B,this._currentColHeaderDbClick$=new Subject.B,this._currentRowHeaderPointerDown$=new Subject.B,this._currentColHeaderPointerDown$=new Subject.B,this._currentRowHeaderPointerUp$=new Subject.B,this._currentColHeaderPointerUp$=new Subject.B,this.currentCell$=this._currentCell$.asObservable().pipe((0,distinctUntilChanged.F)(((pre,aft)=>pre?.location?.unitId===aft?.location?.unitId&&pre?.location?.subUnitId===aft?.location?.subUnitId&&pre?.location?.row===aft?.location?.row&&pre?.location?.col===aft?.location?.col))),this.currentRichText$=this._currentRichText$.pipe((0,distinctUntilChanged.F)(((pre,aft)=>pre?.location?.unitId===aft?.location?.unitId&&pre?.location?.subUnitId===aft?.location?.subUnitId&&pre?.location?.row===aft?.location?.row&&pre?.location?.col===aft?.location?.col&&pre?.customRange?.rangeId===aft?.customRange?.rangeId&&pre?.bullet?.startIndex===aft?.bullet?.startIndex&&pre?.customRange?.startIndex===aft?.customRange?.startIndex&&pre?.customRange?.endIndex===aft?.customRange?.endIndex&&pre?.drawing===aft?.drawing)),(0,operators_map.T)((cell=>cell&&{unitId:cell.location.unitId,subUnitId:cell.location.subUnitId,row:cell.location.row,col:cell.location.col,customRange:cell.customRange,bullet:cell.bullet,rect:cell.rect,drawing:cell.drawing}))),this.currentCellPosWithEvent$=this._currentCellWithEvent$.pipe((0,distinctUntilChanged.F)(((pre,aft)=>pre?.location?.unitId===aft?.location?.unitId&&pre?.location?.subUnitId===aft?.location?.subUnitId&&pre?.location?.row===aft?.location?.row&&pre?.location?.col===aft?.location?.col)),(0,operators_map.T)((cell=>cell&&{unitId:cell.location.unitId,subUnitId:cell.location.subUnitId,row:cell.location.row,col:cell.location.col,event:cell.event}))),this.currentPosition$=this._currentCell$.asObservable(),this.currentClickedCell$=this._currentClickedCell$.asObservable(),this.currentDbClickedCell$=this._currentDbClickedCell$.asObservable(),this.currentPointerDownCell$=this._currentPointerDownCell$.asObservable(),this.currentPointerUpCell$=this._currentPointerUpCell$.asObservable(),this.currentHoveredRowHeader$=this._currentHoveredRowHeader$.asObservable(),this.currentHoveredColHeader$=this._currentHoveredColHeader$.asObservable(),this.currentRowHeaderClick$=this._currentRowHeaderClick$.asObservable(),this.currentColHeaderClick$=this._currentColHeaderClick$.asObservable(),this.currentRowHeaderDbClick$=this._currentRowHeaderDbClick$.asObservable(),this.currentColHeaderDbClick$=this._currentColHeaderDbClick$.asObservable(),this.currentRowHeaderPointerDown$=this._currentRowHeaderPointerDown$.asObservable(),this.currentColHeaderPointerDown$=this._currentColHeaderPointerDown$.asObservable(),this.currentRowHeaderPointerUp$=this._currentRowHeaderPointerUp$.asObservable(),this.currentColHeaderPointerUp$=this._currentColHeaderPointerUp$.asObservable(),this._initCellDisposableListener()}dispose(){super.dispose(),this._currentCell$.complete(),this._currentClickedCell$.complete(),this._currentPointerDownCell$.complete(),this._currentPointerUpCell$.complete(),this._currentCellWithEvent$.complete()}_initCellDisposableListener(){this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET).subscribe((workbook=>{workbook||this._currentCell$.next(null)}))),this.disposeWithMe(this._univerInstanceService.unitDisposed$.subscribe((unit=>{this._currentCell$.getValue()?.location.unitId===unit.getUnitId()&&this._currentCell$.next(null),this._currentRichText$.getValue()?.location.unitId===unit.getUnitId()&&this._currentRichText$.next(null)})))}_getCalcDeps(unitId){const workbook=this._univerInstanceService.getUnit(unitId,src.Zy$.UNIVER_SHEET);if(!workbook)return null;const worksheet=workbook.getActiveSheet();if(!worksheet)return null;const currentRender=this._renderManagerService.getRenderById(workbook.getUnitId());if(!currentRender)return null;const skeletonParam=currentRender.with(sheet_skeleton_manager_service_SheetSkeletonManagerService).getSkeletonParam(worksheet.getSheetId());if(!skeletonParam)return null;const scrollManagerService=currentRender.with(SheetScrollManagerService),scrollInfo=scrollManagerService?.getCurrentScrollState();return scrollInfo&&currentRender?{currentRender,workbook,worksheet,skeletonParam}:void 0}_calcActiveCell(currentRender,workbook,worksheet,skeletonParam,offsetX,offsetY){const hoverPosition=getHoverCellPosition(currentRender,workbook,worksheet,skeletonParam,offsetX,offsetY),skeleton=skeletonParam.skeleton;if(!hoverPosition)return null;const{position,overflowLocation,location}=hoverPosition,font=skeleton.getFont(overflowLocation.row,overflowLocation.col);let customRange=null,bullet=null,drawing=null;const cell=skeleton.getCellWithCoordByIndex(overflowLocation.row,overflowLocation.col),cellData=worksheet.getCell(overflowLocation.row,overflowLocation.col),{topOffset=0,leftOffset=0}=cellData?.fontRenderExtension??{};if(font?.documentSkeleton){const{paddingLeft,paddingTop}=calcPadding(cell,font,null!=cellData?.v&&!Number.isNaN(+cellData.v)),rects=calculateDocSkeletonRects(font.documentSkeleton,paddingLeft,paddingTop),innerX=offsetX-position.startX-leftOffset,innerY=offsetY-position.startY-topOffset;customRange=rects.links.find((link=>link.rects.some((rect=>rect.left<=innerX&&innerX<=rect.right&&rect.top<=innerY&&innerY<=rect.bottom)))),bullet=rects.checkLists.find((list=>list.rect.left<=innerX&&innerX<=list.rect.right&&list.rect.top<=innerY&&innerY<=list.rect.bottom)),drawing=rects.drawings.find((drawing=>drawing.rect.left<=innerX&&innerX<=drawing.rect.right&&drawing.rect.top<=innerY&&innerY<=drawing.rect.bottom))}const rect=customRange?.rects.pop()??bullet?.rect??drawing?.rect;return{location,position,overflowLocation,customRange:customRange?.range,bullet:bullet?.paragraph,drawing:drawing?.drawingId,rect:rect&&{top:rect.top+cell.mergeInfo.startY+topOffset,bottom:rect.bottom+cell.mergeInfo.startY+topOffset,left:rect.left+cell.mergeInfo.startX+leftOffset,right:rect.right+cell.mergeInfo.startX+leftOffset}}}_calcActiveRowHeader(unitId,offsetX,offsetY){const deps=this._getCalcDeps(unitId);if(!deps)return;const{currentRender,worksheet,skeletonParam}=deps,{scaleY}=currentRender.scene.getAncestorScale(),activeViewport=currentRender.scene.getViewports().find((v=>v.isHit(new engine_render_src.I9Y(offsetX,offsetY))));if(!activeViewport||activeViewport.viewportKey!==engine_render_src.p3k.VIEW_ROW_TOP&&activeViewport.viewportKey!==engine_render_src.p3k.VIEW_ROW_BOTTOM)return;const scrollXY={x:activeViewport.viewportScrollX,y:activeViewport.viewportScrollY};return{unitId,index:skeletonParam.skeleton.getRowIndexByOffsetY(offsetY,scaleY,scrollXY),subUnitId:worksheet.getSheetId()}}_calcActiveColHeader(unitId,offsetX,offsetY){const deps=this._getCalcDeps(unitId);if(!deps)return;const{currentRender,worksheet,skeletonParam}=deps,{scaleX}=currentRender.scene.getAncestorScale(),activeViewport=currentRender.scene.getViewports().find((v=>v.isHit(new engine_render_src.I9Y(offsetX,offsetY))));if(!activeViewport||activeViewport.viewportKey!==engine_render_src.p3k.VIEW_COLUMN_LEFT&&activeViewport.viewportKey!==engine_render_src.p3k.VIEW_COLUMN_RIGHT)return;const scrollXY={x:activeViewport.viewportScrollX,y:activeViewport.viewportScrollY};return{unitId,index:skeletonParam.skeleton.getColumnIndexByOffsetX(offsetX,scaleX,scrollXY),subUnitId:worksheet.getSheetId()}}triggerPointerDown(unitId,event){const deps=this._getCalcDeps(unitId);if(!deps)return;const{currentRender,workbook,worksheet,skeletonParam}=deps,activeCell=this._calcActiveCell(currentRender,workbook,worksheet,skeletonParam,event.offsetX,event.offsetY);if(activeCell&&activeCell.location){const{unitId,subUnitId,row,col}=getLocationBase(activeCell.location);this._currentPointerDownCell$.next({unitId,subUnitId,row,col,event})}}triggerPointerUp(unitId,event){const deps=this._getCalcDeps(unitId);if(!deps)return;const{currentRender,workbook,worksheet,skeletonParam}=deps,activeCell=this._calcActiveCell(currentRender,workbook,worksheet,skeletonParam,event.offsetX,event.offsetY);if(activeCell){const location=getLocationBase(activeCell.location);this._currentPointerUpCell$.next({...location,event})}}triggerMouseMove(unitId,event){const deps=this._getCalcDeps(unitId);if(!deps)return;const{currentRender,workbook,worksheet,skeletonParam}=deps,activeCell=this._calcActiveCell(currentRender,workbook,worksheet,skeletonParam,event.offsetX,event.offsetY);this._currentCell$.next(activeCell&&{location:getLocationBase(activeCell.location),position:activeCell.position}),this._currentRichText$.next(activeCell&&{...activeCell,location:getLocationBase(activeCell.overflowLocation)}),this._currentCellWithEvent$.next(activeCell&&{...activeCell,location:getLocationBase(activeCell.location),event})}triggerClick(unitId,offsetX,offsetY){const deps=this._getCalcDeps(unitId);if(!deps)return;const{currentRender,workbook,worksheet,skeletonParam}=deps,activeCell=this._calcActiveCell(currentRender,workbook,worksheet,skeletonParam,offsetX,offsetY);activeCell&&this._currentClickedCell$.next({...activeCell,location:getLocationBase(activeCell.location)})}triggerDbClick(unitId,offsetX,offsetY){const deps=this._getCalcDeps(unitId);if(!deps)return;const{currentRender,workbook,worksheet,skeletonParam}=deps,activeCell=this._calcActiveCell(currentRender,workbook,worksheet,skeletonParam,offsetX,offsetY);activeCell&&this._currentDbClickedCell$.next({...activeCell,location:getLocationBase(activeCell.location)})}triggerScroll(){this._currentCell$.next(null)}triggerRowHeaderClick(unitId,offsetX,offsetY){const pos=this._calcActiveRowHeader(unitId,offsetX,offsetY);pos&&this._currentRowHeaderClick$.next(pos)}triggerColHeaderClick(unitId,offsetX,offsetY){const pos=this._calcActiveColHeader(unitId,offsetX,offsetY);pos&&this._currentColHeaderClick$.next(pos)}triggerRowHeaderDbClick(unitId,offsetX,offsetY){const pos=this._calcActiveRowHeader(unitId,offsetX,offsetY);pos&&this._currentRowHeaderDbClick$.next(pos)}triggerColHeaderDbClick(unitId,offsetX,offsetY){const pos=this._calcActiveColHeader(unitId,offsetX,offsetY);pos&&this._currentColHeaderDbClick$.next(pos)}triggerRowHeaderMouseMove(unitId,offsetX,offsetY){this._currentHoveredRowHeader$.next(this._calcActiveRowHeader(unitId,offsetX,offsetY))}triggerColHeaderMouseMove(unitId,offsetX,offsetY){this._currentHoveredColHeader$.next(this._calcActiveColHeader(unitId,offsetX,offsetY))}triggerRowHeaderPoniterDown(unitId,offsetX,offsetY){const pos=this._calcActiveRowHeader(unitId,offsetX,offsetY);pos&&this._currentRowHeaderPointerDown$.next(pos)}triggerColHeaderPoniterDown(unitId,offsetX,offsetY){const pos=this._calcActiveColHeader(unitId,offsetX,offsetY);pos&&this._currentColHeaderPointerDown$.next(pos)}triggerRowHeaderPoniterUp(unitId,offsetX,offsetY){const pos=this._calcActiveRowHeader(unitId,offsetX,offsetY);pos&&this._currentRowHeaderPointerUp$.next(pos)}triggerColHeaderPoniterUp(unitId,offsetX,offsetY){const pos=this._calcActiveColHeader(unitId,offsetX,offsetY);pos&&this._currentColHeaderPointerUp$.next(pos)}}function force_string_alert_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function force_string_alert_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}HoverManagerService=function hover_manager_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([hover_manager_service_ts_param(0,src.HCr),hover_manager_service_ts_param(1,engine_render_src.cSx),hover_manager_service_ts_metadata("design:type",Function),hover_manager_service_ts_metadata("design:paramtypes",[void 0===src.HCr?Object:src.HCr,void 0===engine_render_src.cSx?Object:engine_render_src.cSx])],HoverManagerService);const ALERT_KEY="SHEET_FORCE_STRING_ALERT";class ForceStringAlertRenderController extends src.jGt{constructor(_context,_hoverManagerService,_cellAlertManagerService,_localeService,_zenZoneService){super(),this._context=_context,this._hoverManagerService=_hoverManagerService,this._cellAlertManagerService=_cellAlertManagerService,this._localeService=_localeService,this._zenZoneService=_zenZoneService,this._init()}_init(){this._initCellAlertPopup(),this._initZenService()}_initCellAlertPopup(){this.disposeWithMe(this._hoverManagerService.currentCell$.subscribe((cellPos=>{if(cellPos){const worksheet=this._context.unit.getActiveSheet();if(!worksheet)return;const cellData=worksheet.getCell(cellPos.location.row,cellPos.location.col);if(cellData?.t===src.scd.FORCE_STRING&&cellData.v&&(0,src.DMQ)(cellData.v)){const currentAlert=this._cellAlertManagerService.currentAlert.get(ALERT_KEY),currentLoc=currentAlert?.alert?.location;if(currentLoc&&currentLoc.row===cellPos.location.row&&currentLoc.col===cellPos.location.col&&currentLoc.subUnitId===cellPos.location.subUnitId&&currentLoc.unitId===cellPos.location.unitId)return;return void this._cellAlertManagerService.showAlert({type:CellAlertType.ERROR,title:this._localeService.t("info.error"),message:this._localeService.t("info.forceStringInfo"),location:cellPos.location,width:200,height:74,key:ALERT_KEY})}}this._hideAlert()})))}_initZenService(){this.disposeWithMe(this._zenZoneService.visible$.subscribe((visible=>{visible&&this._hideAlert()})))}_hideAlert(){this._cellAlertManagerService.removeAlert(ALERT_KEY)}}function force_string_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function force_string_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}ForceStringAlertRenderController=function force_string_alert_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([force_string_alert_render_controller_ts_param(1,(0,src.y_5)(HoverManagerService)),force_string_alert_render_controller_ts_param(2,(0,src.y_5)(CellAlertManagerService)),force_string_alert_render_controller_ts_param(3,(0,src.y_5)(src.iH9)),force_string_alert_render_controller_ts_param(4,ui_src.Uw),force_string_alert_render_controller_ts_metadata("design:type",Function),force_string_alert_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===HoverManagerService?Object:HoverManagerService,void 0===CellAlertManagerService?Object:CellAlertManagerService,void 0===src.iH9?Object:src.iH9,void 0===ui_src.Uw?Object:ui_src.Uw])],ForceStringAlertRenderController);class ForceStringRenderController extends src.hy_{constructor(_context,_sheetSkeletonManagerService,_sheetInterceptorService){super(),this._context=_context,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._sheetInterceptorService=_sheetInterceptorService,this._initViewModelIntercept()}_initViewModelIntercept(){const FORCE_STRING_MARK={tl:{size:6,color:"#409f11"}};this.disposeWithMe(this._sheetInterceptorService.intercept(sheets_src.ZoP.CELL_CONTENT,{priority:10,effect:src._w8.Style,handler:(cell,pos,next)=>{const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(!skeleton)return next(cell);const cellRaw=pos.worksheet.getCellRaw(pos.row,pos.col);return cellRaw&&null!==cellRaw.v&&void 0!==cellRaw.v&&cell?.t===src.scd.FORCE_STRING&&(0,src.DMQ)(cellRaw.v)?next({...cell,markers:{...cell?.markers,...FORCE_STRING_MARK}}):next(cell)}}))}}function hover_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function hover_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}ForceStringRenderController=function force_string_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([force_string_render_controller_ts_param(1,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),force_string_render_controller_ts_param(2,(0,src.y_5)(sheets_src.e5R)),force_string_render_controller_ts_metadata("design:type",Function),force_string_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService,void 0===sheets_src.e5R?Object:sheets_src.e5R])],ForceStringRenderController);class HoverRenderController extends src.jGt{get active(){return this._active}constructor(_context,_hoverManagerService,_sheetSkeletonManagerService,_scrollManagerService){super(),this._context=_context,this._hoverManagerService=_hoverManagerService,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._scrollManagerService=_scrollManagerService,this._active=!1,this._initPointerEvent(),this._initScrollEvent()}_initPointerEvent(){const disposeSet=new src.VdD,handleSkeletonChange=skeletonParam=>{if(disposeSet.dispose(),!skeletonParam)return;const{mainComponent,unitId,components}=this._context;if(!mainComponent)return;disposeSet.add(mainComponent.onPointerEnter$.subscribeEvent((evt=>{this._active=!0}))),disposeSet.add((0,src.Ldp)(mainComponent.onPointerMove$).subscribe((evt=>{this._active=!0,this._hoverManagerService.triggerMouseMove(unitId,evt)}))),disposeSet.add(mainComponent.onPointerDown$.subscribeEvent((evt=>{this._hoverManagerService.triggerPointerDown(unitId,evt)}))),disposeSet.add(mainComponent.onPointerUp$.subscribeEvent((evt=>{this._hoverManagerService.triggerPointerUp(unitId,evt),this._hoverManagerService.triggerClick(unitId,evt.offsetX,evt.offsetY)}))),disposeSet.add(mainComponent.onDblclick$.subscribeEvent((evt=>{this._hoverManagerService.triggerDbClick(unitId,evt.offsetX,evt.offsetY)}))),disposeSet.add(mainComponent.onPointerLeave$.subscribeEvent((()=>{this._active=!1})));const rowHeader=components.get(SHEET_VIEW_KEY.ROW),colHeader=components.get(SHEET_VIEW_KEY.COLUMN);rowHeader&&(disposeSet.add(rowHeader.onPointerMove$.subscribeEvent((evt=>{this._hoverManagerService.triggerRowHeaderMouseMove(unitId,evt.offsetX,evt.offsetY)}))),disposeSet.add(rowHeader.onPointerDown$.subscribeEvent((evt=>{this._hoverManagerService.triggerRowHeaderPoniterDown(unitId,evt.offsetX,evt.offsetY)}))),disposeSet.add(rowHeader.onPointerUp$.subscribeEvent((evt=>{this._hoverManagerService.triggerRowHeaderPoniterUp(unitId,evt.offsetX,evt.offsetY),this._hoverManagerService.triggerRowHeaderClick(unitId,evt.offsetX,evt.offsetY)}))),disposeSet.add(rowHeader.onDblclick$.subscribeEvent((evt=>{this._hoverManagerService.triggerRowHeaderDbClick(unitId,evt.offsetX,evt.offsetY)})))),colHeader&&(disposeSet.add(colHeader.onPointerMove$.subscribeEvent((evt=>{this._hoverManagerService.triggerColHeaderMouseMove(unitId,evt.offsetX,evt.offsetY)}))),disposeSet.add(colHeader.onPointerDown$.subscribeEvent((evt=>{this._hoverManagerService.triggerColHeaderPoniterDown(unitId,evt.offsetX,evt.offsetY)}))),disposeSet.add(colHeader.onPointerUp$.subscribeEvent((evt=>{this._hoverManagerService.triggerColHeaderPoniterUp(unitId,evt.offsetX,evt.offsetY),this._hoverManagerService.triggerColHeaderClick(unitId,evt.offsetX,evt.offsetY)}))),disposeSet.add(colHeader.onDblclick$.subscribeEvent((evt=>{this._hoverManagerService.triggerColHeaderDbClick(unitId,evt.offsetX,evt.offsetY)}))))};handleSkeletonChange(this._sheetSkeletonManagerService.getCurrentParam()),this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((skeletonParam=>{handleSkeletonChange(skeletonParam)})))}_initScrollEvent(){this.disposeWithMe(this._scrollManagerService.validViewportScrollInfo$.subscribe((()=>this._hoverManagerService.triggerScroll())))}}function mark_selection_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function mark_selection_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}HoverRenderController=function hover_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([hover_render_controller_ts_param(1,(0,src.y_5)(HoverManagerService)),hover_render_controller_ts_param(2,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),hover_render_controller_ts_param(3,(0,src.y_5)(SheetScrollManagerService)),hover_render_controller_ts_metadata("design:type",Function),hover_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===HoverManagerService?Object:HoverManagerService,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService,void 0===SheetScrollManagerService?Object:SheetScrollManagerService])],HoverRenderController);class MarkSelectionRenderController extends src.jGt{constructor(_context,_markSelectionService,_commandService,_sheetSkeletonManagerService){super(),this._context=_context,this._markSelectionService=_markSelectionService,this._commandService=_commandService,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._initListeners()}_initListeners(){this._addRemoveListener(),this._addRefreshListener()}_addRemoveListener(){const removeCommands=[SetCellEditVisibleOperation.id];this.disposeWithMe(this._commandService.onCommandExecuted((command=>{if(removeCommands.includes(command.id))this._markSelectionService.removeAllShapes();else{this._markSelectionService.getShapeMap().forEach(((shape,id)=>{shape.exits.includes(command.id)&&this._markSelectionService.removeShape(id)}))}})))}_addRefreshListener(){this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((skeleton=>{skeleton&&this._markSelectionService.refreshShapes()})))}}MarkSelectionRenderController=function mark_selection_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([mark_selection_controller_ts_param(1,(0,src.y_5)(IMarkSelectionService)),mark_selection_controller_ts_param(2,src.wTY),mark_selection_controller_ts_param(3,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),mark_selection_controller_ts_metadata("design:type",Function),mark_selection_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===IMarkSelectionService?Object:IMarkSelectionService,void 0===src.wTY?Object:src.wTY,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService])],MarkSelectionRenderController);var mobile_sheet_bar_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/mobile/sheet-bar/index.module.less"),mobile_sheet_bar_index_module_options={};mobile_sheet_bar_index_module_options.styleTagTransform=styleTagTransform_default(),mobile_sheet_bar_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),mobile_sheet_bar_index_module_options.insert=insertBySelector_default().bind(null,"head"),mobile_sheet_bar_index_module_options.domAPI=styleDomAPI_default(),mobile_sheet_bar_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(mobile_sheet_bar_index_module.A,mobile_sheet_bar_index_module_options);const views_mobile_sheet_bar_index_module=mobile_sheet_bar_index_module.A&&mobile_sheet_bar_index_module.A.locals?mobile_sheet_bar_index_module.A.locals:void 0;function MobileSheetBar(){const workbook=useActiveWorkbook();return workbook?(0,jsx_runtime.jsx)(MobileSheetBarImpl,{workbook}):null}function MobileSheetBarImpl(props){const{workbook}=props,[sheetList,setSheetList]=(0,react.useState)([]),[activeKey,setActiveKey]=(0,react.useState)(""),tabMapRef=(0,react.useRef)(new Map),commandService=(0,ui_src.fJ)(src.wTY),updateSheetItems=(0,react.useCallback)((()=>{const currentSubUnitId=workbook.getActiveSheet().getSheetId(),sheets=workbook.getSheets(),activeSheet=workbook.getActiveSheet(),sheetListItems=sheets.filter((sheet=>!sheet.isSheetHidden())).map(((sheet,index)=>({sheetId:sheet.getSheetId(),label:sheet.getName(),index,selected:activeSheet===sheet,color:sheet.getTabColor()??void 0})));if(setSheetList(sheetListItems),setActiveKey(currentSubUnitId),tabMapRef.current.has(currentSubUnitId)){const element=tabMapRef.current.get(currentSubUnitId);element&&element.scrollIntoView({behavior:"smooth",block:"nearest"})}tabMapRef.current.clear()}),[workbook]);(0,react.useEffect)((()=>updateSheetItems()),[updateSheetItems]);const onTabClick=(0,react.useCallback)((sheetId=>{commandService.executeCommand(sheets_src._M5.id,{unitId:workbook.getUnitId(),subUnitId:sheetId})}),[commandService,workbook]);return(0,react.useEffect)((()=>{const disposable=commandService.onCommandExecuted((commandInfo=>{switch(commandInfo.id){case sheets_src.seI.id:case sheets_src.fyw.id:case sheets_src.H7b.id:case sheets_src.eUO.id:case sheets_src.yif.id:case sheets_src._M5.id:updateSheetItems()}}));return()=>disposable.dispose()}),[commandService,updateSheetItems]),(0,jsx_runtime.jsx)("div",{className:views_mobile_sheet_bar_index_module.mobileSheetBarContainer,children:(0,jsx_runtime.jsx)("div",{className:views_mobile_sheet_bar_index_module.mobileSheetBarSlider,children:sheetList.map((sheet=>(0,jsx_runtime.jsx)("div",{className:(0,design_src.$z)(views_mobile_sheet_bar_index_module.mobileSheetBarItem,{[views_mobile_sheet_bar_index_module.mobileSheetBarItemActivated]:sheet.sheetId===activeKey}),onClick:()=>onTabClick(sheet.sheetId),ref:element=>{tabMapRef.current.set(sheet.sheetId,element)},children:sheet.label},sheet.sheetId)))})})}MobileSheetBar.__docgenInfo={description:"",methods:[],displayName:"MobileSheetBar"};const menu_schema_menuSchema={[ui_src.ai.MAIN_AREA]:{[ui_src.Q2.FORMAT]:{[SheetCopyCommand.name]:{order:0,menuItemFactory:CopyMenuItemFactory}},[ui_src.Q2.DATA]:{order:2},[ui_src.Q2.OTHERS]:{order:3}},[ui_src.ai.COL_HEADER]:{[ui_src.Q2.FORMAT]:{[SheetCopyCommand.name]:{order:0,menuItemFactory:CopyMenuItemFactory}},[ui_src.Q2.LAYOUT]:{order:1},[ui_src.Q2.DATA]:{order:2},[ui_src.Q2.OTHERS]:{order:3}},[ui_src.ai.ROW_HEADER]:{[ui_src.Q2.FORMAT]:{[SheetCopyCommand.name]:{order:0,menuItemFactory:CopyMenuItemFactory}},[ui_src.Q2.LAYOUT]:{order:1},[ui_src.Q2.DATA]:{order:2},[ui_src.Q2.OTHERS]:{order:3}}};function mobile_sheet_ui_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function mobile_sheet_ui_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class SheetUIMobileController extends src.jGt{constructor(_injector,_componentManager,_layoutService,_commandService,_shortcutService,_menuManagerService,_uiPartsService){super(),this._injector=_injector,this._componentManager=_componentManager,this._layoutService=_layoutService,this._commandService=_commandService,this._shortcutService=_shortcutService,this._menuManagerService=_menuManagerService,this._uiPartsService=_uiPartsService,this._init()}_init(){this._initCustomComponents(),this._initCommands(),this._initMenus(),this._initShortcuts(),this._initWorkbenchParts(),this._initFocusHandler()}_initCustomComponents(){const componentManager=this._componentManager;this.disposeWithMe(componentManager.register(MENU_ITEM_INPUT_COMPONENT,MenuItemInput)),this.disposeWithMe(componentManager.register("UI_PLUGIN_SHEETS_BORDER_PANEL_COMPONENT",BorderPanel)),this.disposeWithMe(componentManager.register(COLOR_PICKER_COMPONENT,design_src.sk)),this.disposeWithMe(componentManager.register("UI_PLUGIN_SHEETS_FONT_FAMILY_COMPONENT",ui_src.ay)),this.disposeWithMe(componentManager.register("UI_PLUGIN_SHEETS_FONT_FAMILY_ITEM_COMPONENT",ui_src.vK)),this.disposeWithMe(componentManager.register("UI_PLUGIN_SHEETS_FONT_SIZE_COMPONENT",ui_src.Z4)),this.disposeWithMe(componentManager.register("DefinedNameContainer",DefinedNameContainer))}_initCommands(){[AddWorksheetMergeAllCommand,AddWorksheetMergeCommand,AddWorksheetMergeHorizontalCommand,AddWorksheetMergeVerticalCommand,ChangeZoomRatioCommand,ExpandSelectionCommand,MoveSelectionCommand,MoveSelectionEnterAndTabCommand,RenameSheetOperation,RemoveSheetConfirmCommand,RemoveRowConfirmCommand,RemoveColConfirmCommand,HideRowConfirmCommand,HideColConfirmCommand,ScrollCommand,ScrollToCellCommand,SelectAllCommand,SetActivateCellEditOperation,sheets_src.ftS,SetCellEditVisibleArrowOperation,SetCellEditVisibleOperation,SetCellEditVisibleWithF2Operation,SetRangeBoldCommand,SetRangeItalicCommand,SetRangeUnderlineCommand,SetRangeStrickThroughCommand,SetRangeSubscriptCommand,SetRangeSuperscriptCommand,SetRangeFontSizeCommand,SetRangeFontFamilyCommand,SetRangeTextColorCommand,sheets_src.kBM,sheets_src.HoN,sheets_src.B7g,sheets_src.QPx,SetFormatPainterOperation,SetInfiniteFormatPainterCommand,SetOnceFormatPainterCommand,ApplyFormatPainterCommand,SetScrollOperation,SetScrollRelativeCommand,SetSelectionFrozenCommand,SetRowFrozenCommand,SetColumnFrozenCommand,sheets_src.U0d,SetZoomRatioCommand,SetZoomRatioOperation,ShowMenuListCommand,RefillCommand,InsertRangeMoveDownConfirmCommand,DeleteRangeMoveUpConfirmCommand,InsertRangeMoveRightConfirmCommand,DeleteRangeMoveLeftConfirmCommand,SidebarDefinedNameOperation,AutoFillCommand,AutoClearContentCommand,SheetPermissionOpenPanelOperation,SheetPermissionOpenDialogOperation,AddRangeProtectionFromToolbarCommand,AddRangeProtectionFromContextMenuCommand,ViewSheetPermissionFromContextMenuCommand,AddRangeProtectionFromSheetBarCommand,ViewSheetPermissionFromSheetBarCommand,ChangeSheetProtectionFromSheetBarCommand,DeleteRangeProtectionFromContextMenuCommand,SetRangeProtectionFromContextMenuCommand,DeleteWorksheetProtectionFormSheetBarCommand].forEach((c=>{this.disposeWithMe(this._commandService.registerCommand(c))}))}_initMenus(){this._menuManagerService.mergeMenu(menu_schema_menuSchema)}_initShortcuts(){[MoveSelectionDownShortcutItem,MoveSelectionUpShortcutItem,MoveSelectionLeftShortcutItem,MoveSelectionRightShortcutItem,MoveSelectionTabShortcutItem,MoveSelectionTabLeftShortcutItem,MoveSelectionEnterShortcutItem,MoveSelectionEnterUpShortcutItem,MoveSelectionEndDownShortcutItem,MoveSelectionEndUpShortcutItem,MoveSelectionEndLeftShortcutItem,MoveSelectionEndRightShortcutItem,ExpandSelectionDownShortcutItem,ExpandSelectionUpShortcutItem,ExpandSelectionLeftShortcutItem,ExpandSelectionRightShortcutItem,ExpandSelectionEndDownShortcutItem,ExpandSelectionEndUpShortcutItem,ExpandSelectionEndLeftShortcutItem,ExpandSelectionEndRightShortcutItem,SelectAllShortcutItem,ZoomInShortcutItem,ZoomOutShortcutItem,ResetZoomShortcutItem,PreventDefaultResetZoomShortcutItem,PreventDefaultZoomInShortcutItem,PreventDefaultZoomOutShortcutItem,SetBoldShortcutItem,SetItalicShortcutItem,SetUnderlineShortcutItem,SetStrikeThroughShortcutItem,ClearSelectionValueShortcutItem,...generateArrowSelectionShortCutItem(),EditorCursorEnterShortcut,StartEditWithF2Shortcut,EditorCursorTabShortcut,EditorBreakLineShortcut,EditorDeleteLeftShortcut,EditorDeleteLeftShortcutInActive,EditorCursorEscShortcut,SetRowHiddenShortcutItem,SetColHiddenShortcutItem].forEach((item=>{this.disposeWithMe(this._shortcutService.registerShortcut(item))}))}_initWorkbenchParts(){this._uiPartsService.registerComponent(ui_src.ns.HEADER,(()=>(0,ui_src.pK)(MobileSheetBar,this._injector)))}_initFocusHandler(){this.disposeWithMe(this._layoutService.registerFocusHandler(src.Zy$.UNIVER_SHEET,(_unitId=>{})))}}SheetUIMobileController=function mobile_sheet_ui_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([mobile_sheet_ui_controller_ts_param(0,(0,src.y_5)(src.zZn)),mobile_sheet_ui_controller_ts_param(1,(0,src.y_5)(ui_src.BJ)),mobile_sheet_ui_controller_ts_param(2,ui_src.xQ),mobile_sheet_ui_controller_ts_param(3,src.wTY),mobile_sheet_ui_controller_ts_param(4,ui_src.nF),mobile_sheet_ui_controller_ts_param(5,ui_src.Zi),mobile_sheet_ui_controller_ts_param(6,ui_src.fe),mobile_sheet_ui_controller_ts_metadata("design:type",Function),mobile_sheet_ui_controller_ts_metadata("design:paramtypes",[void 0===src.zZn?Object:src.zZn,void 0===ui_src.BJ?Object:ui_src.BJ,void 0===ui_src.xQ?Object:ui_src.xQ,void 0===src.wTY?Object:src.wTY,void 0===ui_src.nF?Object:ui_src.nF,void 0===ui_src.Zi?Object:ui_src.Zi,void 0===ui_src.fe?Object:ui_src.fe])],SheetUIMobileController);const UNIVER_SHEET_PERMISSION_ALERT_DIALOG="UNIVER_SHEET_PERMISSION_ALERT_DIALOG";function sheet_permission_check_ui_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function sheet_permission_check_ui_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class SheetPermissionCheckUIController extends src.jGt{constructor(_commandService,_univerInstanceService,_permissionService,_dialogService,_rangeProtectionRuleModel,_autoFillService,_localeService,_contextService,_sheetPermissionCheckController){super(),this._commandService=_commandService,this._univerInstanceService=_univerInstanceService,this._permissionService=_permissionService,this._dialogService=_dialogService,this._rangeProtectionRuleModel=_rangeProtectionRuleModel,this._autoFillService=_autoFillService,this._localeService=_localeService,this._contextService=_contextService,this._sheetPermissionCheckController=_sheetPermissionCheckController,this.disposableCollection=new src.VdD,this._initialize(),this._initUIEvent()}_initUIEvent(){this.disposeWithMe(this._sheetPermissionCheckController.triggerPermissionUIEvent$.subscribe((errorMsg=>{this._haveNotPermissionHandle(errorMsg)})))}_haveNotPermissionHandle(errorMsg){const dialogProps={id:"UNIVER_SHEET_PERMISSION_ALERT_DIALOG_ID",title:{title:""},children:{label:UNIVER_SHEET_PERMISSION_ALERT_DIALOG,errorMsg},width:320,destroyOnClose:!0,onClose:()=>this._dialogService.close("UNIVER_SHEET_PERMISSION_ALERT_DIALOG_ID"),className:"sheet-permission-user-dialog"};this._permissionService.getShowComponents()&&this._dialogService.open(dialogProps)}_getPermissionCheck(id,params){let permission=!0,errorMsg="";switch(id){case core_editing_command.TX.id:case IMEInputCommand.id:if(!0===this._contextService.getContextValue(src.RFS))break;permission=this._sheetPermissionCheckController.permissionCheckWithoutRange({workbookTypes:[sheets_src.W30],rangeTypes:[sheets_src.o9h],worksheetTypes:[sheets_src.r$W,sheets_src.qGK]}),errorMsg=this._localeService.t("permission.dialog.editErr");break;case SetCellEditVisibleOperation.id:if(!1===params.visible)break;permission=this._sheetPermissionCheckController.permissionCheckWithoutRange({workbookTypes:[sheets_src.W30],rangeTypes:[sheets_src.o9h],worksheetTypes:[sheets_src.r$W,sheets_src.qGK]}),errorMsg=this._localeService.t("permission.dialog.editErr");break;case SheetPasteColWidthCommand.id:permission=this._sheetPermissionCheckController.permissionCheckWithoutRange({workbookTypes:[sheets_src.W30],rangeTypes:[sheets_src.o9h],worksheetTypes:[sheets_src.qGK,sheets_src.lLG]}),errorMsg=this._localeService.t("permission.dialog.pasteErr");break;case SheetPasteShortKeyCommand.id:permission=this._permissionCheckByPaste(params),errorMsg=this._localeService.t("permission.dialog.pasteErr");break;case ApplyFormatPainterCommand.id:permission=this._sheetPermissionCheckController.permissionCheckWithRanges({workbookTypes:[sheets_src.W30],rangeTypes:[sheets_src.o9h],worksheetTypes:[sheets_src.qGK,sheets_src.r$W,sheets_src.nhd]}),errorMsg=this._localeService.t("permission.dialog.commonErr");break;case sheets_src.H6w.id:case SetRangeBoldCommand.id:case SetRangeItalicCommand.id:case SetRangeUnderlineCommand.id:case SetRangeStrickThroughCommand.id:permission=this._sheetPermissionCheckController.permissionCheckWithRanges({workbookTypes:[sheets_src.W30],rangeTypes:[sheets_src.o9h],worksheetTypes:[sheets_src.nhd,sheets_src.qGK]}),errorMsg=this._localeService.t("permission.dialog.setStyleErr");break;case SheetCopyCommand.id:permission=this._sheetPermissionCheckController.permissionCheckWithRanges({workbookTypes:[sheets_src.FB8],rangeTypes:[sheets_src.fGp],worksheetTypes:[sheets_src.$Rn]}),errorMsg=this._localeService.t("permission.dialog.copyErr"),this._permissionService.getPermissionPoint(new sheets_src.FB8(this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET).getUnitId()).id)?.value||(errorMsg=this._localeService.t("permission.dialog.workbookCopyErr"));break;case clipboard_command_SheetCutCommand.id:permission=this._sheetPermissionCheckController.permissionCheckWithRanges({workbookTypes:[sheets_src.FB8,sheets_src.W30],rangeTypes:[sheets_src.fGp,sheets_src.o9h],worksheetTypes:[sheets_src.$Rn,sheets_src.qGK]}),errorMsg=this._localeService.t("permission.dialog.copyErr"),this._permissionService.getPermissionPoint(new sheets_src.FB8(this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET).getUnitId()).id)?.value||(errorMsg=this._localeService.t("permission.dialog.workbookCopyErr"));break;case AutoFillCommand.id:permission=this._permissionCheckByAutoFillCommand(params),errorMsg=this._localeService.t("permission.dialog.autoFillErr")}permission||this._sheetPermissionCheckController.blockExecuteWithoutPermission(errorMsg)}_initialize(){this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._commandService.beforeCommandExecuted((command=>{this._getPermissionCheck(command.id,command?.params)})))}_permissionCheckByPaste(params){return params.value===PREDEFINED_HOOK_NAME.SPECIAL_PASTE_VALUE||params.value===PREDEFINED_HOOK_NAME.SPECIAL_PASTE_FORMULA||params.value===PREDEFINED_HOOK_NAME.SPECIAL_PASTE_FORMAT?this._sheetPermissionCheckController.permissionCheckWithRanges({workbookTypes:[sheets_src.W30],rangeTypes:[sheets_src.o9h],worksheetTypes:[sheets_src.nhd,sheets_src.qGK]}):this._sheetPermissionCheckController.permissionCheckWithRanges({workbookTypes:[sheets_src.W30],rangeTypes:[sheets_src.o9h],worksheetTypes:[sheets_src.r$W,sheets_src.nhd,sheets_src.qGK]})}_permissionCheckByAutoFillCommand(params){if(!params)return!1;const{targetRange}=params,target=(0,sheets_src.go2)(this._univerInstanceService);if(!target)return!1;const{worksheet,unitId,subUnitId}=target;return!this._rangeProtectionRuleModel.getSubunitRuleList(unitId,subUnitId).reduce(((p,c)=>[...p,...c.ranges]),[]).filter((range=>src.M_G.intersects(range,targetRange))).some((range=>{for(let row=range.startRow;row<=range.endRow;row++)for(let col=range.startColumn;col<=range.endColumn;col++){const permission=worksheet.getCell(row,col)?.selectionProtection?.[0];if(!1===permission?.[es.pS.Edit])return!0}return!1}))}}function sheet_permission_interceptor_canvas_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function sheet_permission_interceptor_canvas_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}SheetPermissionCheckUIController=function sheet_permission_check_ui_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([sheet_permission_check_ui_controller_ts_param(0,src.wTY),sheet_permission_check_ui_controller_ts_param(1,src.HCr),sheet_permission_check_ui_controller_ts_param(2,src.QWp),sheet_permission_check_ui_controller_ts_param(3,ui_src.Xw),sheet_permission_check_ui_controller_ts_param(4,(0,src.y_5)(sheets_src.qI9)),sheet_permission_check_ui_controller_ts_param(5,IAutoFillService),sheet_permission_check_ui_controller_ts_param(6,(0,src.y_5)(src.iH9)),sheet_permission_check_ui_controller_ts_param(7,src.oaf),sheet_permission_check_ui_controller_ts_param(8,(0,src.y_5)(sheets_src.zP0)),sheet_permission_check_ui_controller_ts_metadata("design:type",Function),sheet_permission_check_ui_controller_ts_metadata("design:paramtypes",[void 0===src.wTY?Object:src.wTY,void 0===src.HCr?Object:src.HCr,void 0===src.QWp?Object:src.QWp,void 0===ui_src.Xw?Object:ui_src.Xw,void 0===sheets_src.qI9?Object:sheets_src.qI9,void 0===IAutoFillService?Object:IAutoFillService,void 0===src.iH9?Object:src.iH9,void 0===src.oaf?Object:src.oaf,void 0===sheets_src.zP0?Object:sheets_src.zP0])],SheetPermissionCheckUIController);class SheetPermissionInterceptorCanvasRenderController extends src.hy_{constructor(_context,_univerInstanceService,_permissionService,_selectionManagerService,_rangeProtectionRuleModel,_headerMoveRenderController,_selectionRenderService,_headerFreezeRenderController,_rangeProtectionCache,_headerResizeRenderController){super(),this._context=_context,this._univerInstanceService=_univerInstanceService,this._permissionService=_permissionService,this._selectionManagerService=_selectionManagerService,this._rangeProtectionRuleModel=_rangeProtectionRuleModel,this._headerMoveRenderController=_headerMoveRenderController,this._selectionRenderService=_selectionRenderService,this._headerFreezeRenderController=_headerFreezeRenderController,this._rangeProtectionCache=_rangeProtectionCache,this._headerResizeRenderController=_headerResizeRenderController,this.disposableCollection=new src.VdD,this._initHeaderMovePermissionInterceptor(),this._initHeaderResizePermissionInterceptor(),this._initRangeFillPermissionInterceptor(),this._initRangeMovePermissionInterceptor()}_initHeaderMovePermissionInterceptor(){const headerMoveInterceptor=this._headerMoveRenderController.interceptor.getInterceptPoints().HEADER_MOVE_PERMISSION_CHECK;this.disposeWithMe(this._headerMoveRenderController.interceptor.intercept(headerMoveInterceptor,{handler:(defaultValue,selectionRange)=>{const target=(0,sheets_src.go2)(this._univerInstanceService);if(!target)return!1;const{unitId,subUnitId}=target;if(!this._permissionService.composePermission([new sheets_src.W30(unitId).id,new sheets_src.qGK(unitId,subUnitId).id]).every((permission=>permission.value)))return!1;if(!selectionRange)return!0;if(selectionRange.rangeType!==src.$uV.ROW&&selectionRange.rangeType!==src.$uV.COLUMN)return defaultValue;if(selectionRange.rangeType===src.$uV.ROW)for(let i=selectionRange.startRow;i<=selectionRange.endRow;i++){if(!1===this._rangeProtectionCache.getRowPermissionInfo(unitId,subUnitId,i,[es.pS.Edit]))return!1}else for(let i=selectionRange.startColumn;i<=selectionRange.endColumn;i++){if(!1===this._rangeProtectionCache.getColPermissionInfo(unitId,subUnitId,i,[es.pS.Edit]))return!1}return!0}}))}_initHeaderResizePermissionInterceptor(){this._headerResizeRenderController&&this.disposeWithMe(this._headerResizeRenderController.interceptor.intercept(this._headerResizeRenderController.interceptor.getInterceptPoints().HEADER_RESIZE_PERMISSION_CHECK,{handler:(defaultValue,rangeParams)=>{const target=(0,sheets_src.go2)(this._univerInstanceService);if(!target)return!1;const{unitId,subUnitId}=target;if(rangeParams.row){if(!1===(this._permissionService.getPermissionPoint(new sheets_src.Frs(unitId,subUnitId).id)?.value??!1))return!1}else if(rangeParams.col){if(!1===(this._permissionService.getPermissionPoint(new sheets_src.lLG(unitId,subUnitId).id)?.value??!1))return!1}return!0}}))}_initRangeFillPermissionInterceptor(){this.disposeWithMe(this._selectionRenderService.interceptor.intercept(this._selectionRenderService.interceptor.getInterceptPoints().RANGE_FILL_PERMISSION_CHECK,{handler:(_,position)=>{const target=(0,sheets_src.go2)(this._univerInstanceService);if(!target)return!1;const{worksheet,unitId,subUnitId}=target;if(!this._permissionService.composePermission([new sheets_src.W30(unitId).id,new sheets_src.qGK(unitId,subUnitId).id,new sheets_src.r$W(unitId,subUnitId).id,new sheets_src.nhd(unitId,subUnitId).id]).every((permission=>permission.value)))return!1;const ranges=this._selectionManagerService.getCurrentSelections()?.map((selection=>selection.range)),selectionRange=ranges?.find((range=>{const transformCoord=getTransformCoord(position.x,position.y,position.scene,position.skeleton),cellPosition=position.skeleton.getCellWithCoordByIndex(range.endRow,range.endColumn),missX=Math.abs(cellPosition.endX-transformCoord.x),missY=Math.abs(cellPosition.endY-transformCoord.y);return missX<=5&&missY<=5}));if(!selectionRange)return!0;const{startRow,endRow,startColumn,endColumn}=selectionRange;for(let row=startRow;row<=endRow;row++)for(let col=startColumn;col<=endColumn;col++){const permission=worksheet.getCell(row,col)?.selectionProtection?.[0];if(!1===permission?.[es.pS.Edit]||!1===permission?.[es.pS.View])return!1}return!0}}))}_initRangeMovePermissionInterceptor(){this.disposeWithMe(this._selectionRenderService.interceptor.intercept(this._selectionRenderService.interceptor.getInterceptPoints().RANGE_MOVE_PERMISSION_CHECK,{handler:(_,_cellInfo)=>{const target=(0,sheets_src.go2)(this._univerInstanceService);if(!target)return!1;const{worksheet,unitId,subUnitId}=target;if(!this._permissionService.composePermission([new sheets_src.W30(unitId).id,new sheets_src.qGK(unitId,subUnitId).id]).every((permission=>permission.value)))return!1;const ranges=this._selectionManagerService.getCurrentSelections()?.map((selection=>selection.range)),ruleRanges=this._rangeProtectionRuleModel.getSubunitRuleList(unitId,subUnitId).reduce(((p,c)=>[...p,...c.ranges]),[]),permissionLapRanges=ranges?.filter((range=>ruleRanges.some((ruleRange=>src.M_G.intersects(ruleRange,range))))),haveNotPermission=permissionLapRanges?.some((range=>{const{startRow,startColumn,endRow,endColumn}=range;for(let row=startRow;row<=endRow;row++)for(let col=startColumn;col<=endColumn;col++){const permission=worksheet.getCell(row,col)?.selectionProtection?.[0];if(!1===permission?.[es.pS.Edit])return!0}return!1}));return!haveNotPermission}}))}_initFreezePermissionInterceptor(){this.disposeWithMe(this._headerFreezeRenderController.interceptor.intercept(this._headerFreezeRenderController.interceptor.getInterceptPoints().FREEZE_PERMISSION_CHECK,{handler:(_,__)=>{const workbook=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook?.getActiveSheet();if(!worksheet||!workbook)return!1;return this._permissionService.getPermissionPoint(new sheets_src.W30(workbook.getUnitId()).id)?.value??!1}}))}}function sheet_permission_interceptor_clipboard_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function sheet_permission_interceptor_clipboard_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}SheetPermissionInterceptorCanvasRenderController=function sheet_permission_interceptor_canvas_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([sheet_permission_interceptor_canvas_render_controller_ts_param(1,src.HCr),sheet_permission_interceptor_canvas_render_controller_ts_param(2,src.QWp),sheet_permission_interceptor_canvas_render_controller_ts_param(3,(0,src.y_5)(sheets_src.Fal)),sheet_permission_interceptor_canvas_render_controller_ts_param(4,(0,src.y_5)(sheets_src.qI9)),sheet_permission_interceptor_canvas_render_controller_ts_param(5,(0,src.y_5)(HeaderMoveRenderController)),sheet_permission_interceptor_canvas_render_controller_ts_param(6,ISheetSelectionRenderService),sheet_permission_interceptor_canvas_render_controller_ts_param(7,(0,src.y_5)(HeaderFreezeRenderController)),sheet_permission_interceptor_canvas_render_controller_ts_param(8,(0,src.y_5)(sheets_src.vL8)),sheet_permission_interceptor_canvas_render_controller_ts_param(9,(0,src.Xx1)(HeaderResizeRenderController)),sheet_permission_interceptor_canvas_render_controller_ts_metadata("design:type",Function),sheet_permission_interceptor_canvas_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===src.HCr?Object:src.HCr,void 0===src.QWp?Object:src.QWp,void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===sheets_src.qI9?Object:sheets_src.qI9,void 0===HeaderMoveRenderController?Object:HeaderMoveRenderController,void 0===ISheetSelectionRenderService?Object:ISheetSelectionRenderService,void 0===HeaderFreezeRenderController?Object:HeaderFreezeRenderController,void 0===sheets_src.vL8?Object:sheets_src.vL8,void 0===HeaderResizeRenderController?Object:HeaderResizeRenderController])],SheetPermissionInterceptorCanvasRenderController);class SheetPermissionInterceptorClipboardController extends src.jGt{constructor(_univerInstanceService,_selectionManagerService,_localService,_sheetClipboardService,_sheetPermissionCheckController){super(),this._univerInstanceService=_univerInstanceService,this._selectionManagerService=_selectionManagerService,this._localService=_localService,this._sheetClipboardService=_sheetClipboardService,this._sheetPermissionCheckController=_sheetPermissionCheckController,this.disposableCollection=new src.VdD,this._initClipboardHook()}_initClipboardHook(){this.disposeWithMe(this._sheetClipboardService.addClipboardHook({id:"SHEET_PERMISSION_PASTE_PLUGIN",onBeforePaste:pasteTo=>{const[ranges]=virtualizeDiscreteRanges([pasteTo.range]).ranges,startRange=this._selectionManagerService.getCurrentLastSelection()?.range;if(!startRange)return!1;const targetRange={startRow:startRange.startRow+ranges.startRow,endRow:startRange.startRow+ranges.endRow,startColumn:startRange.startColumn+ranges.startColumn,endColumn:startRange.startColumn+ranges.endColumn},worksheet=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET).getActiveSheet();if(!worksheet)return!1;const{startRow,endRow,startColumn,endColumn}=targetRange;let hasPermission=!0;for(let row=startRow;row<=endRow;row++)for(let col=startColumn;col<=endColumn;col++){const permission=worksheet.getCell(row,col)?.selectionProtection?.[0];if(!1===permission?.[es.pS.Edit]){hasPermission=!1;break}}return hasPermission||this._sheetPermissionCheckController.blockExecuteWithoutPermission(this._localService.t("permission.dialog.pasteErr")),hasPermission}}))}}function status_bar_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function status_bar_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}SheetPermissionInterceptorClipboardController=function sheet_permission_interceptor_clipboard_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([sheet_permission_interceptor_clipboard_controller_ts_param(0,src.HCr),sheet_permission_interceptor_clipboard_controller_ts_param(1,(0,src.y_5)(sheets_src.Fal)),sheet_permission_interceptor_clipboard_controller_ts_param(2,(0,src.y_5)(src.iH9)),sheet_permission_interceptor_clipboard_controller_ts_param(3,(0,src.y_5)(ISheetClipboardService)),sheet_permission_interceptor_clipboard_controller_ts_param(4,(0,src.y_5)(sheets_src.zP0)),sheet_permission_interceptor_clipboard_controller_ts_metadata("design:type",Function),sheet_permission_interceptor_clipboard_controller_ts_metadata("design:paramtypes",[void 0===src.HCr?Object:src.HCr,void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===src.iH9?Object:src.iH9,void 0===ISheetClipboardService?Object:ISheetClipboardService,void 0===sheets_src.zP0?Object:sheets_src.zP0])],SheetPermissionInterceptorClipboardController);const STATUS_BAR_PERMISSION_CORRECT=(0,src.nwg)("statusBarPermissionCorrect");class CalculateValueSet{add(value,styles,patternInfoRecord){if(!value?.v)return;const t=value?.t;let{v}=value;const updateNumberStats=v=>{this._sum+=v,this._countNumber++,this._min=Math.min(this._min,v),this._max=Math.max(this._max,v)};if("string"==typeof v&&t===src.scd.NUMBER){const numValue=Number(v);Number.isNaN(numValue)||(v=numValue)}if("number"==typeof v&&t!==src.scd.STRING)updateNumberStats(v);else if(t===src.scd.NUMBER&&value.s){((style,v,patternInfoRecord)=>{if(!style?.n?.pattern)return;const{pattern}=style.n;patternInfoRecord[pattern]||(patternInfoRecord[pattern]=src.gIL.getInfo(pattern)),patternInfoRecord[pattern].isDate&&updateNumberStats(v)})(styles.get(value.s),v,patternInfoRecord)}this._count++}getResults(){return{sum:this._sum,count:this._countNumber,countA:this._count,min:this._min,max:this._max}}constructor(){this._sum=0,this._count=0,this._countNumber=0,this._min=Number.POSITIVE_INFINITY,this._max=Number.NEGATIVE_INFINITY}}class StatusBarController extends src.jGt{constructor(_univerInstanceService,_selectionManagerService,_statusBarService,_commandService,_numfmtService){super(),this._univerInstanceService=_univerInstanceService,this._selectionManagerService=_selectionManagerService,this._statusBarService=_statusBarService,this._commandService=_commandService,this._numfmtService=_numfmtService,this.interceptor=new src.vY4({STATUS_BAR_PERMISSION_CORRECT}),this._init()}_init(){this._registerSelectionListener()}_registerSelectionListener(){const _statisticsHandler=(0,src.sg1)((selections=>{const primary=selections[selections.length-1]?.primary;this._calculateSelection(selections.map((selection=>selection.range)),primary)}),100),_statisticsMovingHandler=(0,src.sg1)((selections=>{const primary=selections[selections.length-1]?.primary;this._calculateSelection(selections.map((selection=>selection.range)),primary)}),500);this.disposeWithMe((0,src.saO)(this._selectionManagerService.selectionMoving$.subscribe((selections=>{selections&&_statisticsMovingHandler(selections)})))),this.disposeWithMe((0,src.saO)(this._selectionManagerService.selectionMoveEnd$.subscribe((selections=>{selections&&_statisticsHandler(selections)})))),this.disposeWithMe(this._commandService.onCommandExecuted((command=>{if(command.id===sheets_src.N48.id){const selections=this._selectionManagerService.getCurrentSelections();selections&&_statisticsHandler(selections)}})))}_clearResult(){this._statusBarService.setState(null)}getRangeStartEndInfo(range,sheet){return range.rangeType===src.$uV.ALL?{startRow:0,startColumn:0,endRow:sheet.getRowCount()-1,endColumn:sheet.getColumnCount()-1}:range.rangeType===src.$uV.COLUMN?{startRow:0,startColumn:range.startColumn,endRow:sheet.getRowCount()-1,endColumn:range.endColumn}:range.rangeType===src.$uV.ROW?{startRow:range.startRow,startColumn:0,endRow:range.endRow,endColumn:sheet.getColumnCount()-1}:{startRow:range.startRow,startColumn:range.startColumn,endRow:range.endRow,endColumn:range.endColumn}}_calculateSelection(selections,primary){const workbook=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET);if(!workbook)return this._clearResult();const unitId=workbook.getUnitId(),sheet=workbook.getActiveSheet(),sheetId=sheet?.getSheetId();if(!sheetId)return this._clearResult();const sheetData={};if(this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET).getSheets().forEach((sheet=>{const sheetConfig=sheet.getConfig();sheetData[sheet.getSheetId()]={cellData:new src.hDc(sheetConfig.cellData),rowCount:sheetConfig.rowCount,columnCount:sheetConfig.columnCount,rowData:sheetConfig.rowData,columnData:sheetConfig.columnData}})),selections?.length){const realSelections=[];selections.forEach((selection=>{const{startRow:start,endRow:end}=selection;let prev=null;for(let r=start;r<=end;r++)sheet.getRowVisible(r)?null===prev&&(prev=r):null!==prev&&(realSelections.push({...selection,startRow:prev,endRow:r-1}),prev=null);null!==prev&&realSelections.push({...selection,startRow:prev,endRow:end})}));const noDuplicate=(0,src.$xT)(realSelections),calculateValueSet=new CalculateValueSet,styles=workbook.getStyles(),patternInfoRecord={};for(const range of noDuplicate){const{startRow,startColumn,endColumn,endRow}=this.getRangeStartEndInfo(range,sheet);for(let r=startRow;r<=endRow;r++)for(let c=startColumn;c<=endColumn;c++){const value=sheet.getCellRaw(r,c);calculateValueSet.add(value,styles,patternInfoRecord)}}const calcResult=function calculateValues(valueSet){const{sum,count,countA,min,max}=valueSet.getResults();return[{func:engine_formula_src._1.MAX,value:max},{func:engine_formula_src._1.MIN,value:min},{func:engine_formula_src.hK.SUM,value:sum},{func:engine_formula_src._1.COUNTA,value:countA},{func:engine_formula_src._1.COUNT,value:count},{func:engine_formula_src._1.AVERAGE,value:sum/count}]}(calculateValueSet);if(calcResult.every((r=>void 0===r)))return;let pattern=null;if(primary){const{actualRow,actualColumn}=primary;pattern=this._numfmtService.getValue(unitId,sheetId,actualRow,actualColumn)?.pattern}const newState={values:calcResult.filter((r=>void 0!==r)),pattern};this._statusBarService.setState(newState)}else this._clearResult()}}function sheet_permission_interceptor_formula_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function sheet_permission_interceptor_formula_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}StatusBarController=function status_bar_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([status_bar_controller_ts_param(0,src.HCr),status_bar_controller_ts_param(1,(0,src.y_5)(sheets_src.Fal)),status_bar_controller_ts_param(2,IStatusBarService),status_bar_controller_ts_param(3,src.wTY),status_bar_controller_ts_param(4,(0,src.y_5)(sheets_src.C$8)),status_bar_controller_ts_metadata("design:type",Function),status_bar_controller_ts_metadata("design:paramtypes",[void 0===src.HCr?Object:src.HCr,void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===IStatusBarService?Object:IStatusBarService,void 0===src.wTY?Object:src.wTY,void 0===sheets_src.C$8?Object:sheets_src.C$8])],StatusBarController);class SheetPermissionInterceptorFormulaRenderController extends src.hy_{constructor(_context,_univerInstanceService,_permissionService,_statusBarController,_rangeProtectionCache){super(),this._context=_context,this._univerInstanceService=_univerInstanceService,this._permissionService=_permissionService,this._statusBarController=_statusBarController,this._rangeProtectionCache=_rangeProtectionCache,this.disposableCollection=new src.VdD,this._initStatusBarPermissionInterceptor()}_initStatusBarPermissionInterceptor(){this.disposeWithMe(this._statusBarController.interceptor.intercept(this._statusBarController.interceptor.getInterceptPoints().STATUS_BAR_PERMISSION_CORRECT,{priority:100,handler:(defaultValue,originValue)=>{const target=(0,sheets_src.go2)(this._univerInstanceService);if(!target)return defaultValue??[];const{worksheet,unitId,subUnitId}=target,sheetViewPermission=this._permissionService.getPermissionPoint(new sheets_src.R4Q(unitId,subUnitId).id)?.value;return!1===sheetViewPermission?originValue.forEach((item=>{const itemValue=item.getArrayValue();itemValue.forEach(((row,rowIndex)=>{row.forEach(((col,colIndex)=>{itemValue[rowIndex][colIndex]=engine_formula_src.y1.create()}))}))})):originValue.forEach((item=>{const itemValue=item.getArrayValue(),startRow=item.getCurrentRow(),startCol=item.getCurrentColumn();itemValue.forEach(((row,rowIndex)=>{row.forEach(((col,colIndex)=>{const cellValue=worksheet.getCellRaw(rowIndex+startRow,colIndex+startCol)?.v;if(void 0===cellValue)return;const permission=this._rangeProtectionCache.getCellInfo(unitId,subUnitId,rowIndex+startRow,colIndex+startCol);!1===permission?.[es.pS.View]&&(itemValue[rowIndex][colIndex]=engine_formula_src.y1.create())}))}))})),originValue}}))}}SheetPermissionInterceptorFormulaRenderController=function sheet_permission_interceptor_formula_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([sheet_permission_interceptor_formula_render_controller_ts_param(1,src.HCr),sheet_permission_interceptor_formula_render_controller_ts_param(2,src.QWp),sheet_permission_interceptor_formula_render_controller_ts_param(3,(0,src.y_5)(StatusBarController)),sheet_permission_interceptor_formula_render_controller_ts_param(4,(0,src.y_5)(sheets_src.vL8)),sheet_permission_interceptor_formula_render_controller_ts_metadata("design:type",Function),sheet_permission_interceptor_formula_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===src.HCr?Object:src.HCr,void 0===src.QWp?Object:src.QWp,void 0===StatusBarController?Object:StatusBarController,void 0===sheets_src.vL8?Object:sheets_src.vL8])],SheetPermissionInterceptorFormulaRenderController);var protect_single=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/protect-single.js"),write_single=__webpack_require__("../../node_modules/.pnpm/@univerjs+icons@0.2.22_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/@univerjs/icons/esm/components/write-single.js");const checkRangeValid=(injector,permissionRanges,permissionId,unitId,subUnitId)=>{const localeService=injector.get(src.iH9),worksheetRuleModel=injector.get(sheets_src.$af),rangeProtectionRuleModel=injector.get(sheets_src.qI9);let rangeErrorString="";if(0===permissionRanges.length)rangeErrorString=localeService.t("permission.panel.emptyRangeError");else if(permissionRanges.length>1){let hasLap=!1;for(let i=0;i<permissionRanges.length;i++){for(let j=i+1;j<permissionRanges.length;j++)if(src.M_G.intersects(permissionRanges[i],permissionRanges[j])){hasLap=!0;break}if(hasLap)break}hasLap&&(rangeErrorString=localeService.t("permission.panel.rangeOverlapError"))}if(!rangeErrorString){if(worksheetRuleModel.getRule(unitId,subUnitId)&&!permissionId)return rangeErrorString=localeService.t("permission.panel.rangeOverlapOverPermissionError"),rangeErrorString;const lapRule=rangeProtectionRuleModel.getSubunitRuleList(unitId,subUnitId).filter((rule=>rule.permissionId!==permissionId)).find((rule=>rule.ranges.some((ruleRange=>permissionRanges.some((r=>src.M_G.intersects(ruleRange,r))))))),lapRange=lapRule?.ranges.find((range=>permissionRanges.some((r=>src.M_G.intersects(range,r)))));lapRange&&(rangeErrorString=localeService.t("permission.panel.rangeOverlapOverPermissionError"))}return""===rangeErrorString?void 0:rangeErrorString};var panel_detail_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/permission/panel-detail/index.module.less"),panel_detail_index_module_options={};panel_detail_index_module_options.styleTagTransform=styleTagTransform_default(),panel_detail_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),panel_detail_index_module_options.insert=insertBySelector_default().bind(null,"head"),panel_detail_index_module_options.domAPI=styleDomAPI_default(),panel_detail_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(panel_detail_index_module.A,panel_detail_index_module_options);const permission_panel_detail_index_module=panel_detail_index_module.A&&panel_detail_index_module.A.locals?panel_detail_index_module.A.locals:void 0,PermissionDetailFooterPart=props=>{const{viewState,editState,permissionId,ranges,rangesErrMsg,desc,oldRule,id}=props,sheetPermissionPanelModel=(0,ui_src.fJ)(SheetPermissionPanelModel),sidebarService=(0,ui_src.fJ)(ui_src.Jj),authzIoService=(0,ui_src.fJ)(src.Jl7),localeService=(0,ui_src.fJ)(src.iH9),commandService=(0,ui_src.fJ)(src.wTY),sheetPermissionUserManagerService=(0,ui_src.fJ)(SheetPermissionUserManagerService),workbook=(0,ui_src.fJ)(src.HCr).getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook?.getActiveSheet();if(!workbook||!worksheet)return null;const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId();return(0,jsx_runtime.jsxs)("div",{className:permission_panel_detail_index_module.sheetPermissionPanelFooter,children:[(0,jsx_runtime.jsx)(design_src.$n,{type:"primary",onClick:async()=>{if(rangesErrMsg)return;const activeRule={unitId,subUnitId,permissionId,id,viewState,editState,unitType:sheets_src._mD.SelectRange,ranges,description:desc},isSelectWholeSheet=((ranges,sheet)=>{if(1!==ranges.length)return!1;const range=ranges[0],rowCount=sheet.getRowCount(),colCount=sheet.getColumnCount(),{startRow,endRow,startColumn,endColumn}=range;return 0===startRow&&0===startColumn&&endRow===rowCount-1&&endColumn===colCount-1})(ranges,worksheet);isSelectWholeSheet&&(activeRule.unitType=sheets_src._mD.Worksheet,activeRule.ranges=[]);let collaborators=sheetPermissionUserManagerService.selectUserList;activeRule.editState===sheets_src.v2u.OnlyMe&&(collaborators=[],sheetPermissionUserManagerService.setSelectUserList([]));const scopeObj={read:activeRule.viewState===sheets_src.kLo.OthersCanView?es.W$.AllCollaborator:es.W$.SomeCollaborator,edit:activeRule.editState===sheets_src.v2u.DesignedUserCanEdit?es.W$.SomeCollaborator:es.W$.OneSelf};if(activeRule.editState===sheets_src.v2u.DesignedUserCanEdit&&0===collaborators.length&&(collaborators=[],scopeObj.edit=es.W$.OneSelf),activeRule.permissionId){const isSameCollaborators=function getUserListEqual(userList1,userList2){if(userList1.length!==userList2.length)return!1;const sorted1=userList1.sort(((a,b)=>a.id.localeCompare(b.id))),sorted2=userList2.sort(((a,b)=>a.id.localeCompare(b.id)));return sorted1.every(((user,index)=>user.subject?.userID===sorted2[index].subject?.userID&&user.role===sorted2[index].role))}(collaborators.filter((user=>user.role===es.Fx.Editor)),sheetPermissionUserManagerService.oldCollaboratorList.filter((user=>user.role===es.Fx.Editor))),isSameReadStatus=oldRule?.viewState===activeRule.viewState,isSameEditStatus=oldRule?.editState===activeRule.editState,collaboratorsIsChange=!isSameCollaborators||!isSameReadStatus||!isSameEditStatus;if(activeRule.unitType===oldRule?.unitType&&activeRule.description===oldRule.description&&activeRule.ranges===oldRule.ranges&&collaboratorsIsChange)await authzIoService.update({objectType:activeRule.unitType,objectID:activeRule.permissionId,unitID:activeRule.unitId,share:void 0,name:"",strategies:[],scope:scopeObj,collaborators:{collaborators}});else{let newPermissionId=activeRule.permissionId;collaboratorsIsChange&&(newPermissionId=activeRule.unitType===sheets_src._mD.Worksheet?await authzIoService.create({worksheetObject:{collaborators,unitID:activeRule.unitId,name:"",strategies:[{role:es.Fx.Editor,action:es.pS.Edit},{role:es.Fx.Reader,action:es.pS.View}],scope:scopeObj},objectType:sheets_src._mD.Worksheet}):await authzIoService.create({selectRangeObject:{collaborators,unitID:activeRule.unitId,name:"",scope:scopeObj},objectType:sheets_src._mD.SelectRange})),commandService.executeCommand(sheets_src.$tU.id,{rule:{...activeRule,permissionId:newPermissionId},oldRule})}}else if(activeRule.unitType===sheets_src._mD.Worksheet){const permissionId=await authzIoService.create({worksheetObject:{collaborators,unitID:activeRule.unitId,name:"",strategies:[{role:es.Fx.Editor,action:es.pS.Edit},{role:es.Fx.Reader,action:es.pS.View}],scope:scopeObj},objectType:sheets_src._mD.Worksheet}),{ranges:_range=[],...sheetRule}=activeRule;sheetRule.permissionId=permissionId,commandService.executeCommand(sheets_src.c7$.id,{rule:sheetRule,unitId:activeRule.unitId})}else if(activeRule.unitType===sheets_src._mD.SelectRange){const permissionId=await authzIoService.create({selectRangeObject:{collaborators,unitID:activeRule.unitId,name:"",scope:scopeObj},objectType:sheets_src._mD.SelectRange});commandService.executeCommand(sheets_src.ZVQ.id,{rule:activeRule,permissionId})}const sidebarProps={header:{title:`${localeService.t("permission.panel.title")}`},children:{label:UNIVER_SHEET_PERMISSION_PANEL,showDetail:!1},width:330};sidebarService.open(sidebarProps)},children:localeService.t("permission.button.confirm")}),(0,jsx_runtime.jsx)(design_src.$n,{className:permission_panel_detail_index_module.sheetPermissionPanelFooterCancel,onClick:()=>{sheetPermissionPanelModel.reset(),sheetPermissionUserManagerService.reset(),sidebarService.close()},children:localeService.t("permission.button.cancel")})]})};PermissionDetailFooterPart.__docgenInfo={description:"",methods:[],displayName:"PermissionDetailFooterPart",props:{permissionId:{required:!0,tsType:{name:"string"},description:""},id:{required:!0,tsType:{name:"string"},description:""},ranges:{required:!0,tsType:{name:"Array",elements:[{name:"IRange"}],raw:"IRange[]"},description:""},rangesErrMsg:{required:!1,tsType:{name:"string"},description:""},desc:{required:!1,tsType:{name:"string"},description:""},editState:{required:!0,tsType:{name:"EditStateEnum"},description:""},viewState:{required:!0,tsType:{name:"ViewStateEnum"},description:""},oldRule:{required:!1,tsType:{name:"intersection",raw:"(IRangeProtectionRule | IWorksheetProtectionRule) & { ranges: IRange[]; id: string }",elements:[{name:"unknown"},{name:"signature",type:"object",raw:"{ ranges: IRange[]; id: string }",signature:{properties:[{key:"ranges",value:{name:"Array",elements:[{name:"IRange"}],raw:"IRange[]",required:!0}},{key:"id",value:{name:"string",required:!0}}]}}]},description:""}}};const PermissionDetailMainPart=props=>{const{ranges,onRangesChange,desc,onDescChange,rangesErrMsg,permissionId}=props,componentManager=(0,ui_src.fJ)(ui_src.BJ),RangeSelector=(0,react.useMemo)((()=>componentManager.get("RANGE_SELECTOR_COMPONENT_KEY")),[]),univerInstanceService=(0,ui_src.fJ)(src.HCr),localeService=(0,ui_src.fJ)(src.iH9),injector=(0,ui_src.fJ)(src.zZn),workbook=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook?.getActiveSheet();if(!workbook||!worksheet)return null;const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId();return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(design_src.Hb,{className:permission_panel_detail_index_module.sheetPermissionPanelTitle,label:localeService.t("permission.panel.protectedRange"),error:rangesErrMsg,children:RangeSelector&&(0,jsx_runtime.jsx)(RangeSelector,{unitId,subUnitId,initialValue:ranges?.map((i=>(0,engine_formula_src.oc)(i))).join(","),onChange:(_,text)=>(rangeText=>{const newRange=rangeText.split(",").map(engine_formula_src.YJ).map((item=>item.range));if(newRange.some((i=>!(0,src.yZr)(i)||i.endColumn<i.startColumn||i.endRow<i.startRow)))return;const workbook=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook?.getActiveSheet();if(!workbook||!worksheet)return;const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId(),transformedRange=newRange.map((range=>{const rowCount=worksheet.getRowCount(),colCount=worksheet.getColumnCount();return(0,sheets_src.cpS)(range,rowCount,colCount),range})),rangeErrorString=checkRangeValid(injector,transformedRange,permissionId,unitId,subUnitId);onRangesChange(transformedRange,rangeErrorString)})(text)})}),(0,jsx_runtime.jsx)(design_src.Hb,{className:permission_panel_detail_index_module.sheetPermissionPanelTitle,label:localeService.t("permission.panel.permissionDirection"),children:(0,jsx_runtime.jsx)(design_src.pd,{value:desc,onChange:v=>onDescChange(v),placeholder:localeService.t("permission.panel.permissionDirectionPlaceholder")})})]})};PermissionDetailMainPart.__docgenInfo={description:"",methods:[],displayName:"PermissionDetailMainPart",props:{permissionId:{required:!0,tsType:{name:"string"},description:""},ranges:{required:!0,tsType:{name:"Array",elements:[{name:"IRange"}],raw:"IRange[]"},description:""},onRangesChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(ranges: IRange[], err?: string) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"IRange"}],raw:"IRange[]"},name:"ranges"},{type:{name:"string"},name:"err"}],return:{name:"void"}}},description:""},rangesErrMsg:{required:!1,tsType:{name:"string"},description:""},desc:{required:!1,tsType:{name:"string"},description:""},onDescChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(desc: string) => void",signature:{arguments:[{type:{name:"string"},name:"desc"}],return:{name:"void"}}},description:""}}};const SheetPermissionPanelDetail=props=>{const{fromSheetBar,rule,oldRule}=props,injector=(0,ui_src.fJ)(src.zZn),activeRule=rule?((injector,rule)=>{const worksheet=injector.get(src.HCr).getCurrentUnitForType(src.Zy$.UNIVER_SHEET).getActiveSheet(),{unitType}=rule;return unitType===sheets_src._mD.Worksheet?{...rule,ranges:[{startRow:0,startColumn:0,endRow:worksheet.getRowCount()-1,endColumn:worksheet.getColumnCount()-1,rangeType:src.$uV.ALL}]}:rule})(injector,rule):((injector,fromSheetBar)=>{const univerInstanceService=injector.get(src.HCr),selectionManagerService=injector.get(sheets_src.Fal),workbook=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook.getActiveSheet();let unitType=sheets_src._mD.SelectRange,ranges=selectionManagerService.getCurrentSelections()?.map((s=>s.range))??[];return fromSheetBar&&(unitType=sheets_src._mD.Worksheet,ranges=[{startRow:0,startColumn:0,endRow:worksheet.getRowCount()-1,endColumn:worksheet.getColumnCount()-1,rangeType:src.$uV.ALL}]),{unitId:workbook.getUnitId(),subUnitId:worksheet.getSheetId(),permissionId:"",unitType,description:"",id:"",ranges,editState:sheets_src.v2u.OnlyMe,viewState:sheets_src.kLo.OthersCanView}})(injector,fromSheetBar),[ranges,setRanges]=(0,react.useState)(activeRule.ranges),[rangesErrMsg,setRangesErrMsg]=(0,react.useState)((()=>checkRangeValid(injector,activeRule.ranges,activeRule.permissionId,activeRule.unitId,activeRule.subUnitId))),[desc,setDesc]=(0,react.useState)(activeRule.description),[editState,setEditState]=(0,react.useState)(activeRule.editState??sheets_src.v2u.OnlyMe),[viewState,setViewState]=(0,react.useState)(activeRule.viewState??sheets_src.kLo.OthersCanView),PermissionDetailUserPart=(0,ui_src.YP)("UNIVER_SHEET_PERMISSION_USER_PART");return(0,react.useEffect)((()=>{const univerInstanceService=injector.get(src.HCr),sidebarService=injector.get(ui_src.Jj),workbook=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET);if(!workbook)return;const subUnitId=workbook.getActiveSheet().getSheetId(),activeSheetSubscribe=workbook.activeSheet$.subscribe((sheet=>{sheet?.getSheetId()!==subUnitId&&sidebarService.close()}));return()=>{activeSheetSubscribe.unsubscribe()}}),[]),(0,jsx_runtime.jsxs)("div",{className:permission_panel_detail_index_module.permissionPanelDetailWrapper,children:[(0,jsx_runtime.jsx)(PermissionDetailMainPart,{permissionId:activeRule.permissionId,ranges,onRangesChange:(v,err)=>{setRanges(v),setRangesErrMsg(err)},rangesErrMsg,desc,onDescChange:v=>setDesc(v)}),(0,jsx_runtime.jsx)(ui_src.h1,{components:PermissionDetailUserPart,sharedProps:{editState,onEditStateChange:v=>setEditState(v),viewState,onViewStateChange:v=>setViewState(v),permissionId:activeRule.permissionId}},"user-part"),(0,jsx_runtime.jsx)(PermissionDetailFooterPart,{permissionId:activeRule.permissionId,id:activeRule.id,ranges,rangesErrMsg,desc,viewState,editState,oldRule})]})};SheetPermissionPanelDetail.__docgenInfo={description:"",methods:[],displayName:"SheetPermissionPanelDetail",props:{fromSheetBar:{required:!0,tsType:{name:"boolean"},description:""},rule:{required:!1,tsType:{name:"intersection",raw:"(IRangeProtectionRule | IWorksheetProtectionRule) & { ranges: IRange[]; id: string }",elements:[{name:"unknown"},{name:"signature",type:"object",raw:"{ ranges: IRange[]; id: string }",signature:{properties:[{key:"ranges",value:{name:"Array",elements:[{name:"IRange"}],raw:"IRange[]",required:!0}},{key:"id",value:{name:"string",required:!0}}]}}]},description:""},oldRule:{required:!1,tsType:{name:"intersection",raw:"(IRangeProtectionRule | IWorksheetProtectionRule) & { ranges: IRange[]; id: string }",elements:[{name:"unknown"},{name:"signature",type:"object",raw:"{ ranges: IRange[]; id: string }",signature:{properties:[{key:"ranges",value:{name:"Array",elements:[{name:"IRange"}],raw:"IRange[]",required:!0}},{key:"id",value:{name:"string",required:!0}}]}}]},description:""}}};var panel_list_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/permission/panel-list/index.module.less"),panel_list_index_module_options={};panel_list_index_module_options.styleTagTransform=styleTagTransform_default(),panel_list_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),panel_list_index_module_options.insert=insertBySelector_default().bind(null,"head"),panel_list_index_module_options.domAPI=styleDomAPI_default(),panel_list_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(panel_list_index_module.A,panel_list_index_module_options);const permission_panel_list_index_module=panel_list_index_module.A&&panel_list_index_module.A.locals?panel_list_index_module.A.locals:void 0,SheetPermissionPanelList=()=>{const[isCurrentSheet,setIsCurrentSheet]=(0,react.useState)(!0),[forceUpdateFlag,setForceUpdateFlag]=(0,react.useState)(!1),localeService=(0,ui_src.fJ)(src.iH9),rangeProtectionRuleModel=(0,ui_src.fJ)(sheets_src.qI9),worksheetProtectionModel=(0,ui_src.fJ)(sheets_src.$af),univerInstanceService=(0,ui_src.fJ)(src.HCr),commandService=(0,ui_src.fJ)(src.wTY),sidebarService=(0,ui_src.fJ)(ui_src.Jj),authzIoService=(0,ui_src.fJ)(src.Jl7),permissionService=(0,ui_src.fJ)(src.QWp),currentUser=(0,ui_src.fJ)(src.szM).getCurrentUser(),[currentRuleRanges,currentRuleRangesSet]=(0,react.useState)([]),sheetPermissionUserManagerService=(0,ui_src.fJ)(SheetPermissionUserManagerService),_sheetRuleRefresh=(0,ui_src.J2)(worksheetProtectionModel.ruleRefresh$,""),_rangeRuleRefresh=(0,ui_src.J2)(rangeProtectionRuleModel.ruleRefresh$,""),workbook=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET);if(!workbook)return null;const unitId=workbook?.getUnitId(),getRuleList=(0,react.useCallback)((async isCurrentSheet=>{const worksheet=workbook.getActiveSheet(),unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId(),allRangePermissionId=[],allSheetPermissionId=[];workbook.getSheets().forEach((sheet=>{const sheetId=sheet.getSheetId();rangeProtectionRuleModel.getSubunitRuleList(unitId,sheetId).forEach((rule=>{rule.permissionId&&allRangePermissionId.push(rule.permissionId)}));const worksheetPermissionRule=worksheetProtectionModel.getRule(unitId,sheetId);worksheetPermissionRule?.permissionId&&allSheetPermissionId.push(worksheetPermissionRule.permissionId)}));const allPermissionId=[...allRangePermissionId,...allSheetPermissionId],allPermissionRule=await authzIoService.list({objectIDs:allPermissionId,unitID:unitId,actions:sheets_src.Wlz}),subUnitPermissionIds=rangeProtectionRuleModel.getSubunitRuleList(unitId,subUnitId).map((item=>item.permissionId)),sheetPermissionId=worksheetProtectionModel.getRule(unitId,subUnitId)?.permissionId;sheetPermissionId&&subUnitPermissionIds.push(sheetPermissionId);const subUnitRuleList=allPermissionRule.filter((item=>subUnitPermissionIds.includes(item.objectID)||item.objectID===worksheetProtectionModel.getRule(unitId,subUnitId)?.permissionId));return isCurrentSheet?subUnitRuleList:allPermissionRule}),[]),[ruleList,setRuleList]=(0,react.useState)([]);(0,react.useEffect)((()=>{const subscription=(0,observable_merge.h)(rangeProtectionRuleModel.ruleChange$,worksheetProtectionModel.ruleChange$).subscribe((async()=>{const ruleList=await getRuleList(isCurrentSheet);setRuleList(ruleList)}));return()=>{subscription.unsubscribe()}}),[isCurrentSheet]),(0,react.useEffect)((()=>{const subscribe=workbook.activeSheet$.pipe((0,distinctUntilChanged.F)(((prevSheet,currSheet)=>prevSheet?.getSheetId()===currSheet?.getSheetId()))).subscribe((async()=>{const ruleList=await getRuleList(isCurrentSheet);setRuleList(ruleList)}));return()=>{subscribe.unsubscribe()}}),[isCurrentSheet]),(0,react.useEffect)((()=>{(async()=>{if(_sheetRuleRefresh||_rangeRuleRefresh){const ruleList=await getRuleList(!0);setRuleList(ruleList)}})()}),[_sheetRuleRefresh,_rangeRuleRefresh]);(0,react.useEffect)((()=>{sheetPermissionUserManagerService.reset()}),[]),((ranges=[])=>{const markSelectionService=(0,ui_src.fJ)(IMarkSelectionService);(0,react.useEffect)((()=>{const ids=ranges.map((range=>markSelectionService.addShape({range,style:{fill:"rgba(73, 184, 17, 0.05)",strokeWidth:1,stroke:"#49B811",widgets:{}},primary:{startColumn:range.startColumn,endColumn:range.endColumn,startRow:range.startRow,endRow:range.endRow,actualRow:range.startRow,actualColumn:range.startColumn,isMerged:!1,isMergedMainCell:!1}})));return()=>{ids.forEach((id=>{id&&markSelectionService.removeShape(id)}))}}),[ranges])})(currentRuleRanges);const allRuleMap=new Map;workbook.getSheets().forEach((sheet=>{const sheetId=sheet.getSheetId();rangeProtectionRuleModel.getSubunitRuleList(unitId,sheetId).forEach((rule=>{allRuleMap.set(rule.permissionId,rule)}));const sheetRule=worksheetProtectionModel.getRule(unitId,sheetId);sheetRule&&allRuleMap.set(sheetRule?.permissionId,sheetRule)}));const handleChangeHeaderType=isCurrentSheet=>{setIsCurrentSheet(isCurrentSheet)},hasSetProtectPermission=permissionService.getPermissionPoint(new sheets_src.l5B(unitId).id)?.value;return(0,jsx_runtime.jsxs)("div",{className:permission_panel_list_index_module.sheetPermissionListPanelWrapper,children:[(0,jsx_runtime.jsxs)("div",{className:permission_panel_list_index_module.sheetPermissionListPanelHeader,children:[(0,jsx_runtime.jsxs)("div",{className:permission_panel_list_index_module.sheetPermissionListPanelHeaderType,onClick:()=>handleChangeHeaderType(!0),children:[(0,jsx_runtime.jsx)("div",{className:(0,design_src.$z)({[permission_panel_list_index_module.sheetPermissionListPanelHeaderSelect]:isCurrentSheet}),children:localeService.t("permission.panel.currentSheet")}),isCurrentSheet&&(0,jsx_runtime.jsx)("div",{className:permission_panel_list_index_module.sheetPermissionListPanelHeaderTypeBottom})]}),(0,jsx_runtime.jsxs)("div",{className:permission_panel_list_index_module.sheetPermissionListPanelHeaderType,onClick:()=>handleChangeHeaderType(!1),children:[(0,jsx_runtime.jsx)("div",{className:(0,design_src.$z)({[permission_panel_list_index_module.sheetPermissionListPanelHeaderSelect]:!isCurrentSheet}),children:localeService.t("permission.panel.allSheet")}),!isCurrentSheet&&(0,jsx_runtime.jsx)("div",{className:permission_panel_list_index_module.sheetPermissionListPanelHeaderTypeBottom})]})]}),ruleList?.length>0?(0,jsx_runtime.jsx)("div",{className:permission_panel_list_index_module.sheetPermissionListPanelContent,children:ruleList?.map((item=>{const rule=allRuleMap.get(item.objectID);if(!rule)return null;const editAction=item.actions.find((action=>action.action===es.pS.Edit)),editPermission=editAction?.allowed,viewAction=item.actions.find((action=>action.action===es.pS.View)),viewPermission=viewAction?.allowed,manageCollaboratorAction=item.actions.find((action=>action.action===es.pS.ManageCollaborator)),deleteAction=item.actions.find((action=>action.action===es.pS.Delete)),hasManagerPermission=manageCollaboratorAction?.allowed||currentUser.userID===item.creator?.userID,hasDeletePermission=deleteAction?.allowed||currentUser.userID===item.creator?.userID;let ruleName="";const targetSheet=workbook.getSheetBySheetId(rule.subUnitId),targetName=targetSheet?.getName();if(rule.unitType===es._m.SelectRange){const ranges=rule.ranges;ruleName=`${targetName}(${ranges?.length?ranges.map((range=>{const v=(0,engine_formula_src.oc)(range);return"NaN"===v?"":v})).filter((r=>!!r)).join(","):""})`}else rule.unitType===es._m.Worksheet&&(ruleName=targetName||"");return(0,jsx_runtime.jsxs)("div",{className:permission_panel_list_index_module.sheetPermissionListItem,onMouseMove:()=>{const{subUnitId,unitType}=rule,activeSheet=workbook.getActiveSheet();if(!activeSheet)return!1;if(subUnitId!==activeSheet.getSheetId())return!1;if(unitType===es._m.SelectRange){const ranges=rule.ranges||[];ranges!==currentRuleRanges&&currentRuleRangesSet(ranges)}else if(unitType===es._m.Worksheet){const ranges=[{startRow:0,endRow:activeSheet.getRowCount()-1,startColumn:0,endColumn:activeSheet.getColumnCount()-1}];ranges!==currentRuleRanges&&currentRuleRangesSet(ranges)}},onMouseLeave:()=>currentRuleRangesSet([]),children:[(0,jsx_runtime.jsxs)("div",{className:permission_panel_list_index_module.sheetPermissionListItemHeader,children:[(0,jsx_runtime.jsx)(design_src.m_,{title:ruleName,children:(0,jsx_runtime.jsx)("div",{className:permission_panel_list_index_module.sheetPermissionListItemHeaderName,children:ruleName})}),(hasManagerPermission||hasDeletePermission)&&(0,jsx_runtime.jsxs)("div",{className:permission_panel_list_index_module.sheetPermissionListItemHeaderOperator,children:[hasManagerPermission&&(0,jsx_runtime.jsx)(design_src.m_,{title:localeService.t("permission.panel.edit"),children:(0,jsx_runtime.jsx)("div",{className:permission_panel_list_index_module.sheetPermissionListItemHeaderIcon,onClick:()=>(rule=>{rule.subUnitId!==workbook.getActiveSheet().getSheetId()&&commandService.executeCommand(sheets_src._M5.id,{unitId:rule.unitId,subUnitId:rule.subUnitId});const sidebarProps={header:{title:"permission.panel.title"},children:{label:UNIVER_SHEET_PERMISSION_PANEL,showDetail:!0,rule:src.S0q.deepClone(rule),oldRule:src.S0q.deepClone(rule)},width:330};sidebarService.open(sidebarProps)})(rule),children:(0,jsx_runtime.jsx)(write_single.A,{})})}),hasDeletePermission&&(0,jsx_runtime.jsx)(design_src.m_,{title:localeService.t("permission.panel.delete"),children:(0,jsx_runtime.jsx)("div",{className:permission_panel_list_index_module.sheetPermissionListItemHeaderIcon,onClick:()=>(rule=>{const{unitId,subUnitId,unitType}=rule;let res;unitType===es._m.Worksheet?res=commandService.executeCommand(sheets_src.ImT.id,{unitId,subUnitId,rule}):unitType===es._m.SelectRange&&(res=commandService.executeCommand(sheets_src.bt0.id,{unitId,subUnitId,rule})),res&&(setForceUpdateFlag(!forceUpdateFlag),rule.ranges===currentRuleRanges&&currentRuleRangesSet([]))})(rule),children:(0,jsx_runtime.jsx)(delete_single.A,{})})})]})]}),(0,jsx_runtime.jsx)("div",{className:permission_panel_list_index_module.sheetPermissionListItemSplit}),(0,jsx_runtime.jsxs)("div",{className:permission_panel_list_index_module.sheetPermissionListItemContent,children:[(0,jsx_runtime.jsxs)("div",{className:permission_panel_list_index_module.sheetPermissionListItemContentEdit,children:[(0,jsx_runtime.jsx)(design_src.m_,{title:item.creator?.name??"",children:(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(design_src.eu,{src:item.creator?.avatar,style:{marginRight:6},size:24})})}),(0,jsx_runtime.jsx)("span",{className:permission_panel_list_index_module.sheetPermissionListItemContentTitle,children:localeService.t("permission.panel.created")}),(0,jsx_runtime.jsx)("span",{className:permission_panel_list_index_module.sheetPermissionListItemContentSub,children:editPermission?`${localeService.t("permission.panel.iCanEdit")}`:`${localeService.t("permission.panel.iCanNotEdit")}`})]}),(0,jsx_runtime.jsxs)("div",{className:permission_panel_list_index_module.sheetPermissionListItemContentView,children:[(0,jsx_runtime.jsx)("span",{className:permission_panel_list_index_module.sheetPermissionListItemContentTitle,children:localeService.t("permission.panel.viewPermission")}),(0,jsx_runtime.jsx)("span",{className:permission_panel_list_index_module.sheetPermissionListItemContentSub,children:viewPermission?`${localeService.t("permission.panel.iCanView")}`:`${localeService.t("permission.panel.iCanNotView")}`})]}),rule.description&&(0,jsx_runtime.jsx)(design_src.m_,{title:rule.description,children:(0,jsx_runtime.jsx)("div",{className:permission_panel_list_index_module.sheetPermissionListItemContentDesc,children:rule.description})})]})]},item.objectID)}))}):(0,jsx_runtime.jsxs)("div",{className:permission_panel_list_index_module.sheetPermissionListEmpty,children:[(0,jsx_runtime.jsx)("img",{width:240,height:120,src:"data:image/png;base64,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",alt:""}),(0,jsx_runtime.jsx)("p",{className:permission_panel_list_index_module.sheetPermissionListEmptyText,children:localeService.t("permission.dialog.listEmpty")})]}),hasSetProtectPermission&&(0,jsx_runtime.jsx)("div",{className:permission_panel_list_index_module.sheetPermissionPanelAddWrapper,children:(0,jsx_runtime.jsxs)(design_src.$n,{className:permission_panel_list_index_module.sheetPermissionPanelAddButton,type:"primary",onClick:()=>{const sidebarProps={header:{title:`${localeService.t("permission.panel.title")}`},children:{label:UNIVER_SHEET_PERMISSION_PANEL,showDetail:!0},width:330};sidebarService.open(sidebarProps)},children:[(0,jsx_runtime.jsx)("div",{children:"+ "}),localeService.t("permission.button.addNewPermission")]})})]})};SheetPermissionPanelList.__docgenInfo={description:"",methods:[],displayName:"SheetPermissionPanelList"};const SheetPermissionPanel=({showDetail,fromSheetBar,rule,oldRule})=>{const univerInstanceService=(0,ui_src.fJ)(src.HCr),sheetsSelectionsService=(0,ui_src.fJ)(sheets_src.Fal);if(!(0,ui_src.fJ)(SheetPermissionPanelModel).getVisible())return null;const target=(0,sheets_src.go2)(univerInstanceService);if(!target)return null;const{worksheet}=target,selectionRanges=sheetsSelectionsService.getCurrentSelections()?.map((selection=>selection.range)),key=selectionRanges.reduce(((acc,range)=>acc+(0,engine_formula_src.jz)(worksheet.getName(),range)),"");return showDetail?(0,jsx_runtime.jsx)(SheetPermissionPanelDetail,{fromSheetBar,rule,oldRule},fromSheetBar?"sheet-bar":"normal"):(0,jsx_runtime.jsx)(SheetPermissionPanelList,{},key)};SheetPermissionPanel.__docgenInfo={description:"",methods:[],displayName:"SheetPermissionPanel",props:{showDetail:{required:!0,tsType:{name:"boolean"},description:""},fromSheetBar:{required:!0,tsType:{name:"boolean"},description:""},rule:{required:!1,tsType:{name:"intersection",raw:"(IRangeProtectionRule | IWorksheetProtectionRule) & { ranges: IRange[]; id: string }",elements:[{name:"unknown"},{name:"signature",type:"object",raw:"{ ranges: IRange[]; id: string }",signature:{properties:[{key:"ranges",value:{name:"Array",elements:[{name:"IRange"}],raw:"IRange[]",required:!0}},{key:"id",value:{name:"string",required:!0}}]}}]},description:""},oldRule:{required:!1,tsType:{name:"intersection",raw:"(IRangeProtectionRule | IWorksheetProtectionRule) & { ranges: IRange[]; id: string }",elements:[{name:"unknown"},{name:"signature",type:"object",raw:"{ ranges: IRange[]; id: string }",signature:{properties:[{key:"ranges",value:{name:"Array",elements:[{name:"IRange"}],raw:"IRange[]",required:!0}},{key:"id",value:{name:"string",required:!0}}]}}]},description:""}}};var spin_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/permission/spin/index.module.less"),spin_index_module_options={};spin_index_module_options.styleTagTransform=styleTagTransform_default(),spin_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),spin_index_module_options.insert=insertBySelector_default().bind(null,"head"),spin_index_module_options.domAPI=styleDomAPI_default(),spin_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(spin_index_module.A,spin_index_module_options);const permission_spin_index_module=spin_index_module.A&&spin_index_module.A.locals?spin_index_module.A.locals:void 0,Spin=({loading,children})=>(0,jsx_runtime.jsxs)("div",{className:permission_spin_index_module.spinContainer,children:[loading&&(0,jsx_runtime.jsx)("div",{className:permission_spin_index_module.spinOverlay,children:(0,jsx_runtime.jsx)("div",{className:permission_spin_index_module.spinner})}),(0,jsx_runtime.jsx)("div",{className:loading?permission_spin_index_module.contentBlur:"",children})]}),spin=Spin;Spin.__docgenInfo={description:"",methods:[],displayName:"Spin",props:{loading:{required:!0,tsType:{name:"boolean"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};var permission_dialog_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/permission/permission-dialog/index.module.less"),permission_dialog_index_module_options={};permission_dialog_index_module_options.styleTagTransform=styleTagTransform_default(),permission_dialog_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),permission_dialog_index_module_options.insert=insertBySelector_default().bind(null,"head"),permission_dialog_index_module_options.domAPI=styleDomAPI_default(),permission_dialog_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(permission_dialog_index_module.A,permission_dialog_index_module_options);const permission_permission_dialog_index_module=permission_dialog_index_module.A&&permission_dialog_index_module.A.locals?permission_dialog_index_module.A.locals:void 0,SheetPermissionDialog=()=>{const localeService=(0,ui_src.fJ)(src.iH9),univerInstanceService=(0,ui_src.fJ)(src.HCr),authzIoService=(0,ui_src.fJ)(src.Jl7),worksheetProtectionPointRuleModel=(0,ui_src.fJ)(sheets_src.fON),dialogService=(0,ui_src.fJ)(ui_src.Xw),permissionService=(0,ui_src.fJ)(src.QWp),workbook=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook.getActiveSheet();if(!worksheet)throw new Error("No active sheet found");const[collaborators,setCollaborators]=(0,react.useState)([]),commandService=(0,ui_src.fJ)(src.wTY),[loading,setLoading]=(0,react.useState)((()=>!!worksheetProtectionPointRuleModel.getRule(workbook.getUnitId(),worksheet.getSheetId()))),[permissionMap,setPermissionMap]=(0,react.useState)((()=>Object.keys(subUnitPermissionTypeMap).reduce(((acc,action)=>(acc[action]={text:localeService.t(`permission.panel.${subUnitPermissionTypeMap[Number(action)]}`),allowed:!0},acc)),{})));(0,react.useEffect)((()=>{(async()=>{const unitId=workbook.getUnitId(),collaborators=await authzIoService.listCollaborators({objectID:unitId,unitID:unitId});setCollaborators(collaborators)})()}),[]),(0,react.useEffect)((()=>{(async()=>{const unitId=workbook.getUnitId(),worksheetPointRule=worksheetProtectionPointRuleModel.getRule(unitId,worksheet.getSheetId());if(!worksheetPointRule)return;setLoading(!0);const actions=(await authzIoService.list({unitID:workbook.getUnitId(),objectIDs:[worksheetPointRule.permissionId],actions:defaultWorksheetUnitActionList}))[0].strategies.reduce(((p,c)=>(subUnitPermissionTypeMap[c.action]&&(p[c.action]={text:localeService.t(`permission.panel.${subUnitPermissionTypeMap[c.action]}`),allowed:c.role!==es.Fx.Owner}),p)),{});setPermissionMap(actions),setTimeout((()=>{setLoading(!1)}),100)})()}),[]);return(0,jsx_runtime.jsx)(spin,{loading,children:(0,jsx_runtime.jsxs)("div",{className:permission_permission_dialog_index_module.sheetPermissionDialogWrapper,children:[(0,jsx_runtime.jsx)("div",{className:permission_permission_dialog_index_module.sheetPermissionDialogSplit}),Object.keys(permissionMap).map((action=>{const actionItem=permissionMap[action],{text,allowed}=actionItem;return(0,jsx_runtime.jsxs)("div",{className:permission_permission_dialog_index_module.sheetPermissionDialogItem,children:[(0,jsx_runtime.jsx)("div",{children:text}),(0,jsx_runtime.jsx)(design_src.dO,{defaultChecked:allowed,onChange:()=>{setPermissionMap({...permissionMap,[action]:{...actionItem,allowed:!allowed}})}})]},text)})),(0,jsx_runtime.jsx)("div",{className:permission_permission_dialog_index_module.sheetPermissionDialogSplit}),(0,jsx_runtime.jsxs)("div",{className:permission_permission_dialog_index_module.sheetPermissionUserDialogFooter,children:[(0,jsx_runtime.jsx)(design_src.$n,{className:permission_permission_dialog_index_module.sheetPermissionUserDialogButton,onClick:()=>{dialogService.close("UNIVER_SHEET_PERMISSION_DIALOG_ID")},children:localeService.t("permission.button.cancel")}),(0,jsx_runtime.jsx)(design_src.$n,{type:"primary",onClick:()=>{(async()=>{const workbook=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook?.getActiveSheet();if(!worksheet)throw new Error("No active sheet found");const unitId=workbook.getUnitId(),subUnitId=worksheet.getSheetId(),pointRule=worksheetProtectionPointRuleModel.getRule(unitId,subUnitId),actions=Object.keys(permissionMap).map((action=>({action:Number(action),role:permissionMap[action].allowed?es.Fx.Editor:es.Fx.Owner})));let permissionId=pointRule?.permissionId;permissionId?authzIoService.update({objectType:es._m.Worksheet,objectID:permissionId,unitID:unitId,strategies:actions,share:void 0,name:"",scope:{read:es.W$.AllCollaborator,edit:es.W$.AllCollaborator},collaborators:void 0}).then((()=>{(0,sheets_src.tSr)().forEach((F=>{const instance=new F(unitId,subUnitId),unitActionName=instance.subType,action=actions.find((item=>item.action===unitActionName));action&&permissionService.updatePermissionPoint(instance.id,action.role===es.Fx.Editor)}))})):(permissionId=await authzIoService.create({objectType:es._m.Worksheet,worksheetObject:{unitID:unitId,collaborators,name:"",strategies:actions,scope:{read:es.W$.AllCollaborator,edit:es.W$.AllCollaborator}}}),commandService.executeCommand(sheets_src.OZe.id,{rule:{permissionId,unitId,subUnitId}}))})(),dialogService.close("UNIVER_SHEET_PERMISSION_DIALOG_ID")},className:(0,design_src.$z)(permission_permission_dialog_index_module.sheetPermissionUserDialogFooterConfirm,permission_permission_dialog_index_module.sheetPermissionUserDialogButton),children:localeService.t("permission.button.confirm")})]})]})})};SheetPermissionDialog.__docgenInfo={description:"",methods:[],displayName:"SheetPermissionDialog"};const UserEmptyBase64="data:image/png;base64,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";var user_dialog_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/permission/user-dialog/index.module.less"),user_dialog_index_module_options={};user_dialog_index_module_options.styleTagTransform=styleTagTransform_default(),user_dialog_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),user_dialog_index_module_options.insert=insertBySelector_default().bind(null,"head"),user_dialog_index_module_options.domAPI=styleDomAPI_default(),user_dialog_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(user_dialog_index_module.A,user_dialog_index_module_options);const permission_user_dialog_index_module=user_dialog_index_module.A&&user_dialog_index_module.A.locals?user_dialog_index_module.A.locals:void 0,SheetPermissionUserDialog=()=>{const[inputValue,setInputValue]=(0,react.useState)(""),localeService=(0,ui_src.fJ)(src.iH9),dialogService=(0,ui_src.fJ)(ui_src.Xw),sheetPermissionUserManagerService=(0,ui_src.fJ)(SheetPermissionUserManagerService),userList=(0,ui_src.J2)(sheetPermissionUserManagerService.userList$,sheetPermissionUserManagerService.userList),searchUserList=userList?.filter((item=>item.subject?.name.toLocaleLowerCase().includes(inputValue.toLocaleLowerCase())&&item.role===es.Fx.Editor))??[],[selectUserInfo,setSelectUserInfo]=(0,react.useState)(sheetPermissionUserManagerService.selectUserList);return(0,jsx_runtime.jsxs)("div",{className:permission_user_dialog_index_module.sheetPermissionUserDialogWrapper,children:[(0,jsx_runtime.jsx)("div",{className:permission_user_dialog_index_module.sheetPermissionUserDialogSearch,children:(0,jsx_runtime.jsx)(design_src.pd,{placeholder:localeService.t("permission.dialog.search"),className:permission_user_dialog_index_module.sheetPermissionUserDialogSearchInput,value:inputValue,onChange:v=>setInputValue(v)})}),(0,jsx_runtime.jsx)("div",{className:permission_user_dialog_index_module.sheetPermissionUserList,children:searchUserList?.length>0?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:searchUserList?.map((item=>(0,jsx_runtime.jsxs)("div",{className:permission_user_dialog_index_module.sheetPermissionUserItem,onClick:()=>(item=>{const index=selectUserInfo?.findIndex((v=>v.subject?.userID===item.subject?.userID));if(-1===index){const select={...item};setSelectUserInfo([...selectUserInfo,select])}else{const newSelectUserInfo=selectUserInfo.filter((v=>v.subject?.userID!==item.subject?.userID));setSelectUserInfo(newSelectUserInfo)}})(item),children:[(0,jsx_runtime.jsx)(design_src.eu,{src:item.subject?.avatar,size:24}),(0,jsx_runtime.jsx)("div",{className:permission_user_dialog_index_module.sheetPermissionUserItemName,children:item.subject?.name}),-1!==selectUserInfo?.findIndex((v=>v.subject?.userID===item.subject?.userID))&&(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(check_mark_single.A,{})})]},item.subject?.userID)))}):(0,jsx_runtime.jsxs)("div",{className:permission_user_dialog_index_module.sheetPermissionUserListEmpty,children:[(0,jsx_runtime.jsx)("img",{width:240,height:120,src:UserEmptyBase64,alt:""}),(0,jsx_runtime.jsx)("p",{className:permission_user_dialog_index_module.sheetPermissionUserListEmptyText,children:localeService.t("permission.dialog.userEmpty")})]})}),(0,jsx_runtime.jsx)("div",{className:permission_user_dialog_index_module.sheetPermissionSplit}),(0,jsx_runtime.jsxs)("div",{className:permission_user_dialog_index_module.sheetPermissionUserDialogFooter,children:[(0,jsx_runtime.jsx)(design_src.$n,{className:permission_user_dialog_index_module.sheetPermissionUserDialogButton,onClick:()=>dialogService.close("UNIVER_SHEET_PERMISSION_USER_DIALOG_ID"),children:localeService.t("permission.button.cancel")}),(0,jsx_runtime.jsx)(design_src.$n,{type:"primary",onClick:()=>{sheetPermissionUserManagerService.setSelectUserList(selectUserInfo),dialogService.close("UNIVER_SHEET_PERMISSION_USER_DIALOG_ID")},className:(0,design_src.$z)(permission_user_dialog_index_module.sheetPermissionUserDialogFooterConfirm,permission_user_dialog_index_module.sheetPermissionUserDialogButton),children:localeService.t("permission.button.confirm")})]})]})};SheetPermissionUserDialog.__docgenInfo={description:"",methods:[],displayName:"SheetPermissionUserDialog"};var error_msg_dialog_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-ui/src/views/permission/error-msg-dialog/index.module.less"),error_msg_dialog_index_module_options={};error_msg_dialog_index_module_options.styleTagTransform=styleTagTransform_default(),error_msg_dialog_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),error_msg_dialog_index_module_options.insert=insertBySelector_default().bind(null,"head"),error_msg_dialog_index_module_options.domAPI=styleDomAPI_default(),error_msg_dialog_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(error_msg_dialog_index_module.A,error_msg_dialog_index_module_options);const permission_error_msg_dialog_index_module=error_msg_dialog_index_module.A&&error_msg_dialog_index_module.A.locals?error_msg_dialog_index_module.A.locals:void 0,AlertDialog=({errorMsg})=>{const localeService=(0,ui_src.fJ)(src.iH9),dialogService=(0,ui_src.fJ)(ui_src.Xw);return(0,jsx_runtime.jsxs)("div",{className:permission_error_msg_dialog_index_module.sheetPermissionAlertDialog,children:[(0,jsx_runtime.jsx)("h1",{className:permission_error_msg_dialog_index_module.sheetPermissionAlertDialogTitle,children:localeService.t("permission.dialog.alert")}),(0,jsx_runtime.jsx)("p",{children:errorMsg||localeService.t("permission.dialog.alertContent")}),(0,jsx_runtime.jsx)("div",{className:permission_error_msg_dialog_index_module.sheetPermissionAlertDialogButton,children:(0,jsx_runtime.jsx)(design_src.$n,{type:"primary",onClick:()=>{dialogService.close("UNIVER_SHEET_PERMISSION_ALERT_DIALOG_ID")},children:localeService.t("permission.button.confirm")})})]})};AlertDialog.__docgenInfo={description:"",methods:[],displayName:"AlertDialog",props:{errorMsg:{required:!0,tsType:{name:"string"},description:""}}};const base64="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNCIgaGVpZ2h0PSI0IiB2aWV3Qm94PSIwIDAgNCA0IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8bWFzayBpZD0ibWFzazBfNzU5XzExMDgiIHN0eWxlPSJtYXNrLXR5cGU6YWxwaGEiIG1hc2tVbml0cz0idXNlclNwYWNlT25Vc2UiIHg9IjAiIHk9IjAiIHdpZHRoPSI0IiBoZWlnaHQ9IjQiPgo8cmVjdCB3aWR0aD0iNCIgaGVpZ2h0PSI0IiBmaWxsPSIjRDZEOEQ5Ii8+CjwvbWFzaz4KPGcgbWFzaz0idXJsKCNtYXNrMF83NTlfMTEwOCkiPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTS0zLjY0MDAyIDMuNDQxNDFMMi4wNzM5NyAtMi4yNzI1OEwyLjc4MTA4IC0xLjU2NTQ4TC0yLjkzMjkxIDQuMTQ4NTJMLTMuNjQwMDIgMy40NDE0MVoiIGZpbGw9IiNENkQ4REIiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0tMS41MTg2OCA1LjU2Mjc1TDQuMTk1MzEgLTAuMTUxMjQ1TDQuOTAyNDIgMC41NTU4NjJMLTAuODExNTc1IDYuMjY5ODZMLTEuNTE4NjggNS41NjI3NVoiIGZpbGw9IiNENkQ4REIiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0wLjYwMjY1NiA3LjY4NDAzTDYuMzE2NjUgMS45NzAwM0w3LjAyMzc2IDIuNjc3MTRMMS4zMDk3NiA4LjM5MTEzTDAuNjAyNjU2IDcuNjg0MDNaIiBmaWxsPSIjRDZEOERCIi8+CjwvZz4KPC9zdmc+";class RangeProtectionRenderExtension extends engine_render_src.TRh{constructor(){super(),this._pattern=null,this._img=new Image,this.renderCache=new Set,this._img.src=base64}clearCache(){this.renderCache.clear()}draw(ctx,_parentScale,spreadsheetSkeleton){const{worksheet}=spreadsheetSkeleton;worksheet&&(ctx.save(),this._pattern||(this._pattern=ctx.createPattern(this._img,"repeat")),this.renderCache.clear(),src.Q6t.foreach(spreadsheetSkeleton.rowColumnSegment,((row,col)=>{if(!worksheet.getRowVisible(row)||!worksheet.getColVisible(col))return;const{selectionProtection=[]}=worksheet.getCell(row,col)||{};this._pattern&&(ctx.fillStyle=this._pattern,selectionProtection.forEach((config=>{if(config.ruleId&&this.shouldRender(config)){if(this.renderCache.has(config.ruleId))return;this.renderCache.add(config.ruleId),config.ranges.forEach((range=>{const start=spreadsheetSkeleton.getCellWithCoordByIndex(range.startRow,range.startColumn,!1),end=spreadsheetSkeleton.getCellWithCoordByIndex(range.endRow,range.endColumn,!1);ctx.fillRect(start.startX,start.startY,end.endX-start.startX,end.endY-start.startY)}))}})))})),ctx.restore())}}class RangeProtectionCanViewRenderExtension extends RangeProtectionRenderExtension{constructor(){super(),this.uKey="RANGE_PROTECTION_CAN_VIEW_RENDER_EXTENSION_KEY",this.Z_INDEX=25}shouldRender(config){return!1!==config?.[es.pS.View]}}class RangeProtectionCanNotViewRenderExtension extends RangeProtectionRenderExtension{constructor(){super(),this.uKey="RANGE_PROTECTION_CAN_NOT_VIEW_RENDER_EXTENSION_KEY",this.Z_INDEX=80}shouldRender(config){return!1===config?.[es.pS.View]}}class WorksheetProtectionRenderExtension extends engine_render_src.TRh{constructor(){super(),this.uKey="worksheet-protection",this.Z_INDEX=25,this._img=new Image,this._img.src=base64}draw(ctx,_parentScale,spreadsheetSkeleton){const{worksheet}=spreadsheetSkeleton;if(!worksheet)return!1;ctx.save(),this._pattern||(this._pattern=ctx.createPattern(this._img,"repeat"));const{startRow,startColumn,endRow,endColumn}=spreadsheetSkeleton.rowColumnSegment,start=spreadsheetSkeleton.getCellWithCoordByIndex(startRow,startColumn,!1),end=spreadsheetSkeleton.getCellWithCoordByIndex(endRow,endColumn,!1),{hasWorksheetRule=!1,selectionProtection=[]}=worksheet.getCell(startRow,startColumn)||{};if(this._pattern){if(selectionProtection.length>0){const cellProtectionConfig=selectionProtection[0],viewPermission=cellProtectionConfig?.[es.pS.View];viewPermission?this.setZIndex(25):this.setZIndex(80)}ctx.fillStyle=this._pattern,hasWorksheetRule&&ctx.fillRect(start.startX,start.startY,end.endX-start.startX,end.endY-start.startY),ctx.restore()}}setZIndex(zIndex){this.Z_INDEX=zIndex}}const PermissionDetailUserPart=props=>{const{editState,onEditStateChange,viewState,onViewStateChange,permissionId}=props,localeService=(0,ui_src.fJ)(src.iH9),dialogService=(0,ui_src.fJ)(ui_src.Xw),authzIoService=(0,ui_src.fJ)(src.Jl7),sheetPermissionUserManagerService=(0,ui_src.fJ)(SheetPermissionUserManagerService),userManagerService=(0,ui_src.fJ)(src.szM),univerInstanceService=(0,ui_src.fJ)(src.HCr),selectUserList=(0,ui_src.J2)(sheetPermissionUserManagerService.selectUserList$,sheetPermissionUserManagerService.selectUserList),workbook=univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook?.getActiveSheet();if(!workbook||!worksheet)return null;const unitId=workbook.getUnitId();return(0,react.useEffect)((()=>{permissionId?(async()=>{const selectUserList=(await authzIoService.listCollaborators({objectID:permissionId,unitID:unitId})).filter((user=>user.role===es.Fx.Editor));selectUserList.length>0&&onEditStateChange(sheets_src.v2u.DesignedUserCanEdit),sheetPermissionUserManagerService.setSelectUserList(selectUserList),sheetPermissionUserManagerService.setOldCollaboratorList(selectUserList)})():(sheetPermissionUserManagerService.setSelectUserList([]),sheetPermissionUserManagerService.setOldCollaboratorList([]))}),[]),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(design_src.Hb,{className:permission_panel_detail_index_module.sheetPermissionPanelTitle,label:localeService.t("permission.panel.editPermission"),children:(0,jsx_runtime.jsxs)(design_src.z6,{value:editState,onChange:v=>onEditStateChange(v),className:permission_panel_detail_index_module.radioGroupVertical,children:[(0,jsx_runtime.jsx)(design_src.sx,{value:sheets_src.v2u.OnlyMe,children:(0,jsx_runtime.jsx)("span",{className:permission_panel_detail_index_module.text,children:localeService.t("permission.panel.onlyICanEdit")})}),(0,jsx_runtime.jsx)(design_src.sx,{value:sheets_src.v2u.DesignedUserCanEdit,children:(0,jsx_runtime.jsx)("span",{className:permission_panel_detail_index_module.text,children:localeService.t("permission.panel.designedUserCanEdit")})})]})}),editState===sheets_src.v2u.DesignedUserCanEdit&&(0,jsx_runtime.jsxs)("div",{className:permission_panel_detail_index_module.sheetPermissionDesignPersonPanel,children:[(0,jsx_runtime.jsxs)("div",{className:permission_panel_detail_index_module.sheetPermissionDesignPersonPanelHeader,children:[(0,jsx_runtime.jsx)("span",{children:localeService.t("permission.panel.designedPerson")}),(0,jsx_runtime.jsx)("span",{className:permission_panel_detail_index_module.sheetPermissionDesignPersonPanelHeaderAdd,onClick:async()=>{const userList=await authzIoService.listCollaborators({objectID:unitId,unitID:unitId}),currentUser=userManagerService.getCurrentUser();sheetPermissionUserManagerService.setCanEditUserList(userList.filter((user=>user.subject?.userID!==currentUser.userID))),dialogService.open({id:"UNIVER_SHEET_PERMISSION_USER_DIALOG_ID",title:{title:""},children:{label:UNIVER_SHEET_PERMISSION_USER_DIALOG},width:280,destroyOnClose:!0,onClose:()=>dialogService.close("UNIVER_SHEET_PERMISSION_USER_DIALOG_ID"),className:"sheet-permission-user-dialog"})},children:localeService.t("permission.panel.addPerson")})]}),(0,jsx_runtime.jsx)("div",{className:permission_panel_detail_index_module.sheetPermissionDesignPersonPanelSplit}),(0,jsx_runtime.jsx)("div",{className:permission_panel_detail_index_module.sheetPermissionDesignPersonPanelContent,children:selectUserList?.length>0?selectUserList.map((item=>(0,jsx_runtime.jsxs)("div",{className:permission_panel_detail_index_module.sheetPermissionDesignPersonPanelContentItem,children:[(0,jsx_runtime.jsx)(design_src.eu,{size:24,src:item.subject?.avatar}),(0,jsx_runtime.jsx)("span",{className:permission_panel_detail_index_module.sheetPermissionDesignPersonPanelContentItemName,children:item.subject?.name}),(0,jsx_runtime.jsx)(design_src.l6,{className:permission_panel_detail_index_module.sheetPermissionDesignPersonPanelContentItemSelect,value:"edit",onChange:v=>{"delete"===v&&sheetPermissionUserManagerService.setSelectUserList(selectUserList.filter((i=>i.subject?.userID!==item.subject?.userID)))},options:[{label:`${localeService.t("permission.panel.canEdit")}`,value:"edit"},{label:`${localeService.t("permission.panel.delete")}`,value:"delete"}]})]},item.subject?.userID))):(0,jsx_runtime.jsxs)("div",{className:permission_panel_detail_index_module.sheetPermissionUserListEmpty,children:[(0,jsx_runtime.jsx)("img",{width:240,height:120,src:UserEmptyBase64,alt:""}),(0,jsx_runtime.jsx)("p",{className:permission_panel_detail_index_module.sheetPermissionUserListEmptyText,children:localeService.t("permission.dialog.userEmpty")})]})})]}),(0,jsx_runtime.jsx)(design_src.Hb,{className:permission_panel_detail_index_module.sheetPermissionPanelTitle,label:localeService.t("permission.panel.viewPermission"),children:(0,jsx_runtime.jsxs)(design_src.z6,{value:viewState,onChange:v=>onViewStateChange(v),className:permission_panel_detail_index_module.radioGroupVertical,children:[(0,jsx_runtime.jsx)(design_src.sx,{value:sheets_src.kLo.OthersCanView,children:(0,jsx_runtime.jsx)("span",{className:permission_panel_detail_index_module.text,children:localeService.t("permission.panel.othersCanView")})}),(0,jsx_runtime.jsx)(design_src.sx,{value:sheets_src.kLo.NoOneElseCanView,children:(0,jsx_runtime.jsx)("span",{className:permission_panel_detail_index_module.text,children:localeService.t("permission.panel.noOneElseCanView")})})]})})]})};function sheet_permission_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}function sheet_permission_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function sheet_permission_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}PermissionDetailUserPart.__docgenInfo={description:"",methods:[],displayName:"PermissionDetailUserPart",props:{editState:{required:!0,tsType:{name:"EditStateEnum"},description:""},onEditStateChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(v: EditStateEnum) => void",signature:{arguments:[{type:{name:"EditStateEnum"},name:"v"}],return:{name:"void"}}},description:""},viewState:{required:!0,tsType:{name:"ViewStateEnum"},description:""},onViewStateChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(v: ViewStateEnum) => void",signature:{arguments:[{type:{name:"ViewStateEnum"},name:"v"}],return:{name:"void"}}},description:""},permissionId:{required:!0,tsType:{name:"string"},description:""}}};class SheetPermissionRenderManagerController extends src.jGt{constructor(_injector,_componentManager,_uiPartsService){super(),this._injector=_injector,this._componentManager=_componentManager,this._uiPartsService=_uiPartsService,this._init()}_init(){this._initComponents(),this._initUiPartComponents()}_initComponents(){[[permissionMenuIconKey,protect_single.A],[permissionDeleteIconKey,delete_single.A],[permissionEditIconKey,write_single.A],[permissionCheckIconKey,check_mark_single.A],[permissionLockIconKey,lock_single.A],[UNIVER_SHEET_PERMISSION_PANEL,SheetPermissionPanel],[UNIVER_SHEET_PERMISSION_USER_DIALOG,SheetPermissionUserDialog],[UNIVER_SHEET_PERMISSION_DIALOG,SheetPermissionDialog],[UNIVER_SHEET_PERMISSION_ALERT_DIALOG,AlertDialog]].forEach((([key,component])=>{this.disposeWithMe(this._componentManager.register(key,component))}))}_initUiPartComponents(){const config=this._injector.get(src.J0C).getConfig("sheets-ui.config");config?.customComponents?.has("UNIVER_SHEET_PERMISSION_USER_PART")||this.disposeWithMe(this._uiPartsService.registerComponent("UNIVER_SHEET_PERMISSION_USER_PART",(()=>(0,ui_src.pK)(PermissionDetailUserPart,this._injector))))}}SheetPermissionRenderManagerController=sheet_permission_render_controller_ts_decorate([sheet_permission_render_controller_ts_param(0,(0,src.y_5)(src.zZn)),sheet_permission_render_controller_ts_param(1,(0,src.y_5)(ui_src.BJ)),sheet_permission_render_controller_ts_param(2,(0,src.y_5)(ui_src.fe)),sheet_permission_render_controller_ts_metadata("design:type",Function),sheet_permission_render_controller_ts_metadata("design:paramtypes",[void 0===src.zZn?Object:src.zZn,void 0===ui_src.BJ?Object:ui_src.BJ,void 0===ui_src.fe?Object:ui_src.fe])],SheetPermissionRenderManagerController);class SheetPermissionRenderController extends src.jGt{constructor(_context,_rangeProtectionRuleModel,_sheetSkeletonManagerService,_permissionService,_configService){super(),this._context=_context,this._rangeProtectionRuleModel=_rangeProtectionRuleModel,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._permissionService=_permissionService,this._configService=_configService,this._rangeProtectionCanViewRenderExtension=new RangeProtectionCanViewRenderExtension,this._rangeProtectionCanNotViewRenderExtension=new RangeProtectionCanNotViewRenderExtension;const config=this._configService.getConfig("sheets-ui.config");config?.customComponents?.has("UNIVER_SHEET_PERMISSION_BACKGROUND")||(this._initRender(),this._initSkeleton(),this.disposeWithMe(this._rangeProtectionRuleModel.ruleChange$.subscribe((info=>{(info.oldRule?.id&&this._rangeProtectionCanViewRenderExtension.renderCache.has(info.oldRule.id)||this._rangeProtectionCanViewRenderExtension.renderCache.has(info.rule.id))&&this._rangeProtectionCanViewRenderExtension.clearCache(),(info.oldRule?.id&&this._rangeProtectionCanNotViewRenderExtension.renderCache.has(info.oldRule.id)||this._rangeProtectionCanNotViewRenderExtension.renderCache.has(info.rule.id))&&this._rangeProtectionCanNotViewRenderExtension.clearCache()}))))}_initRender(){const spreadsheetRender=this._context.mainComponent;spreadsheetRender&&(spreadsheetRender.getExtensionByKey("RANGE_PROTECTION_CAN_VIEW_RENDER_EXTENSION_KEY")||spreadsheetRender.register(this._rangeProtectionCanViewRenderExtension),spreadsheetRender.getExtensionByKey("RANGE_PROTECTION_CAN_NOT_VIEW_RENDER_EXTENSION_KEY")||spreadsheetRender.register(this._rangeProtectionCanNotViewRenderExtension))}_initSkeleton(){this.disposeWithMe((0,observable_merge.h)(this._permissionService.permissionPointUpdate$.pipe((0,throttleTime.c)(300,void 0,{trailing:!0})),this._rangeProtectionRuleModel.rangeRuleInitStateChange$,this._rangeProtectionRuleModel.ruleChange$).pipe().subscribe((()=>{this._sheetSkeletonManagerService.reCalculate(),this._context.mainComponent?.makeDirty()})))}}SheetPermissionRenderController=sheet_permission_render_controller_ts_decorate([sheet_permission_render_controller_ts_param(1,(0,src.y_5)(sheets_src.qI9)),sheet_permission_render_controller_ts_param(2,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),sheet_permission_render_controller_ts_param(3,src.QWp),sheet_permission_render_controller_ts_param(4,src.J0C),sheet_permission_render_controller_ts_metadata("design:type",Function),sheet_permission_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===sheets_src.qI9?Object:sheets_src.qI9,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService,void 0===src.QWp?Object:src.QWp,void 0===src.J0C?Object:src.J0C])],SheetPermissionRenderController);class WorksheetProtectionRenderController extends src.jGt{constructor(_context,_renderManagerService,_univerInstanceService,_sheetSkeletonManagerService,_worksheetProtectionRuleModel,_configService){super(),this._context=_context,this._renderManagerService=_renderManagerService,this._univerInstanceService=_univerInstanceService,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._worksheetProtectionRuleModel=_worksheetProtectionRuleModel,this._configService=_configService,this._worksheetProtectionRenderExtension=new WorksheetProtectionRenderExtension;const config=this._configService.getConfig("sheets-ui.config");config?.customComponents?.has("UNIVER_SHEET_PERMISSION_BACKGROUND")||(this._initRender(),this._initSkeleton())}_initRender(){const renderId=this._context.unitId,render=renderId&&this._renderManagerService.getRenderById(renderId),spreadsheetRender=render&&render.mainComponent;spreadsheetRender&&(spreadsheetRender.getExtensionByKey("worksheet-protection")||spreadsheetRender.register(this._worksheetProtectionRenderExtension))}_initSkeleton(){this.disposeWithMe((0,observable_merge.h)(this._worksheetProtectionRuleModel.worksheetRuleInitStateChange$).pipe().subscribe((()=>{this._sheetSkeletonManagerService.reCalculate(),this._context.mainComponent?.makeDirty()})))}}function format_painter_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function format_painter_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}WorksheetProtectionRenderController=sheet_permission_render_controller_ts_decorate([sheet_permission_render_controller_ts_param(1,(0,src.y_5)(engine_render_src.cSx)),sheet_permission_render_controller_ts_param(2,(0,src.y_5)(src.HCr)),sheet_permission_render_controller_ts_param(3,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),sheet_permission_render_controller_ts_param(4,(0,src.y_5)(sheets_src.$af)),sheet_permission_render_controller_ts_param(5,(0,src.y_5)(src.J0C)),sheet_permission_render_controller_ts_metadata("design:type",Function),sheet_permission_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===src.HCr?Object:src.HCr,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService,void 0===sheets_src.$af?Object:sheets_src.$af,void 0===src.J0C?Object:src.J0C])],WorksheetProtectionRenderController);class FormatPainterRenderController extends src.jGt{constructor(_context,_formatPainterService,_selectionRenderService,_commandService){super(),this._context=_context,this._formatPainterService=_formatPainterService,this._selectionRenderService=_selectionRenderService,this._commandService=_commandService,this._initialize()}_initialize(){this._bindFormatPainterStatus(),this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._selectionRenderService.selectionMoveEnd$.subscribe((selections=>{if(this._formatPainterService.getStatus()!==FormatPainterStatus.OFF){const{rangeWithCoord}=selections[selections.length-1];this._commandService.executeCommand(ApplyFormatPainterCommand.id,{unitId:this._context.unitId,subUnitId:this._context.unit.getActiveSheet()?.getSheetId()||"",range:{startRow:rangeWithCoord.startRow,startColumn:rangeWithCoord.startColumn,endRow:rangeWithCoord.endRow,endColumn:rangeWithCoord.endColumn}}),this._formatPainterService.getStatus()===FormatPainterStatus.ONCE&&this._commandService.executeCommand(SetOnceFormatPainterCommand.id)}})))}_bindFormatPainterStatus(){this.disposeWithMe((0,src.saO)(this._formatPainterService.status$.subscribe((status=>{const scene=this._context.scene;scene&&(status!==FormatPainterStatus.OFF?scene.setDefaultCursor(engine_render_src.MBo.CELL):scene.setDefaultCursor(engine_render_src.MBo.DEFAULT))}))))}}function mobile_contextmenu_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function mobile_contextmenu_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}FormatPainterRenderController=function format_painter_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([format_painter_render_controller_ts_param(1,IFormatPainterService),format_painter_render_controller_ts_param(2,ISheetSelectionRenderService),format_painter_render_controller_ts_param(3,src.wTY),format_painter_render_controller_ts_metadata("design:type",Function),format_painter_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===IFormatPainterService?Object:IFormatPainterService,void 0===ISheetSelectionRenderService?Object:ISheetSelectionRenderService,void 0===src.wTY?Object:src.wTY])],FormatPainterRenderController);class SheetContextMenuMobileRenderController extends src.jGt{constructor(_context,_layoutService,_contextMenuService,_selectionManagerService,_selectionRenderService,_sheetSkeletonManagerService){super(),this._context=_context,this._layoutService=_layoutService,this._contextMenuService=_contextMenuService,this._selectionManagerService=_selectionManagerService,this._selectionRenderService=_selectionRenderService,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._init()}_init(){let listenToSelectionChangeEvent=!1;this.disposeWithMe(this._selectionManagerService.selectionMoveStart$.subscribe((()=>listenToSelectionChangeEvent=!0))),this.disposeWithMe(this._selectionManagerService.selectionMoveEnd$.subscribe((selectionWithStyleList=>{const skeleton=this._sheetSkeletonManagerService.getCurrentParam().skeleton;if(!skeleton||!selectionWithStyleList||!1===listenToSelectionChangeEvent)return;listenToSelectionChangeEvent=!1;const selectionRangeWithStyle=selectionWithStyleList[0];if(!selectionRangeWithStyle.primary)return;const selectionWithCoord=attachSelectionWithCoord(selectionRangeWithStyle,skeleton),rangeType=selectionRangeWithStyle.range.rangeType,{scene}=this._context,viewMain=scene.getViewport(engine_render_src.p3k.VIEW_MAIN),viewportScrollX=viewMain?.viewportScrollX||0,viewportScrollY=viewMain?.viewportScrollY||0;let clientX=0,clientY=0;const rowHeaderWidth=skeleton.rowHeaderWidth,canvasRect=this._layoutService.getContentElement().getBoundingClientRect();switch(rangeType){case src.$uV.NORMAL:clientX=selectionWithCoord.rangeWithCoord.startX+canvasRect.left-viewportScrollX,clientY=selectionWithCoord.rangeWithCoord.endY+canvasRect.top-viewportScrollY;break;case src.$uV.COLUMN:clientX=selectionWithCoord.rangeWithCoord.startX+canvasRect.left-viewportScrollX,clientY=Math.min(canvasRect.height/2,selectionWithCoord.rangeWithCoord.endY)+40;break;case src.$uV.ROW:clientX=(canvasRect.width-rowHeaderWidth)/2+20,clientY=selectionWithCoord.rangeWithCoord.endY+canvasRect.top-viewportScrollY;break;case src.$uV.ALL:clientX=selectionWithCoord.rangeWithCoord.startX+canvasRect.left,clientY=selectionWithCoord.rangeWithCoord.startY+canvasRect.top;break;default:clientX=selectionWithCoord.rangeWithCoord.startX+canvasRect.left-viewportScrollX,clientY=selectionWithCoord.rangeWithCoord.endY+canvasRect.top-viewportScrollY}clientX=src.S0q.clamp(clientX,rowHeaderWidth,canvasRect.width),clientY=src.S0q.clamp(clientY,canvasRect.top,canvasRect.height),this._contextMenuService.triggerContextMenu({clientX,clientY,preventDefault:()=>{},stopPropagation:()=>{}},ui_src.ai.MAIN_AREA)})))}}function mobile_scroll_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function mobile_scroll_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}SheetContextMenuMobileRenderController=function mobile_contextmenu_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([mobile_contextmenu_render_controller_ts_param(1,ui_src.xQ),mobile_contextmenu_render_controller_ts_param(2,ui_src.ZL),mobile_contextmenu_render_controller_ts_param(3,(0,src.y_5)(sheets_src.Fal)),mobile_contextmenu_render_controller_ts_param(4,ISheetSelectionRenderService),mobile_contextmenu_render_controller_ts_param(5,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),mobile_contextmenu_render_controller_ts_metadata("design:type",Function),mobile_contextmenu_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===ui_src.xQ?Object:ui_src.xQ,void 0===ui_src.ZL?Object:ui_src.ZL,void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===ISheetSelectionRenderService?Object:ISheetSelectionRenderService,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService])],SheetContextMenuMobileRenderController);const mobile_scroll_render_controller_SHEET_NAVIGATION_COMMANDS=[MoveSelectionCommand.id,MoveSelectionEnterAndTabCommand.id];class MobileSheetsScrollRenderController extends src.jGt{constructor(_context,_sheetSkeletonManagerService,_commandService,_renderManagerService,_selectionManagerService,_scrollManagerService,_univerInstanceService){super(),this._context=_context,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._commandService=_commandService,this._renderManagerService=_renderManagerService,this._selectionManagerService=_selectionManagerService,this._scrollManagerService=_scrollManagerService,this._univerInstanceService=_univerInstanceService,this._init()}scrollToRange(range){let{endRow,endColumn,startColumn,startRow}=range;const bounding=this._getViewportBounding();if(range.rangeType===src.$uV.ROW?(startColumn=0,endColumn=0):range.rangeType===src.$uV.COLUMN&&(startRow=0,endRow=0),bounding){const row=bounding.startRow>endRow?startRow:endRow,col=bounding.startColumn>endColumn?startColumn:endColumn;return this._scrollToCell(row,col)}return this._scrollToCell(startRow,startColumn)}_init(){this._initCommandListener(),this._initScrollEventListener(),this._initPointerScrollEvent(),this._initSkeletonListener()}_initCommandListener(){this.disposeWithMe(this._commandService.onCommandExecuted((command=>{if(mobile_scroll_render_controller_SHEET_NAVIGATION_COMMANDS.includes(command.id))this._scrollToSelection();else if(command.id===sheets_src.Q8V.id){const param=command.params.range;this.scrollToRange(param)}else if(command.id===ExpandSelectionCommand.id){const param=command.params;this._scrollToSelectionForExpand(param)}})))}_scrollToSelectionForExpand(param){setTimeout((()=>{const selection=this._selectionManagerService.getCurrentLastSelection();if(null==selection)return;const{startRow,startColumn,endRow,endColumn}=selection.range,bounds=this._getViewportBounding();if(null==bounds)return;const{startRow:viewportStartRow,startColumn:viewportStartColumn,endRow:viewportEndRow,endColumn:viewportEndColumn}=bounds;let row=0,column=0;row=startRow>viewportStartRow?endRow:endRow<viewportEndRow?startRow:viewportStartRow,column=startColumn>viewportStartColumn?endColumn:endColumn<viewportEndColumn?startColumn:viewportStartColumn,param.direction===src.OP3.DOWN?row=endRow:param.direction===src.OP3.UP?row=startRow:param.direction===src.OP3.RIGHT?column=endColumn:param.direction===src.OP3.LEFT&&(column=startColumn),this._scrollToCell(row,column)}),0)}_getFreeze(){const snapshot=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton.getWorksheetConfig();if(null!=snapshot)return snapshot.freeze}_initScrollEventListener(){const{scene}=this._context;if(null==scene)return;const viewportMain=scene.getViewport(engine_render_src.p3k.VIEW_MAIN);viewportMain&&(this.disposeWithMe((0,src.saO)(this._scrollManagerService.rawScrollInfo$.subscribe((rawScrollInfo=>{if(null==rawScrollInfo)return void viewportMain.scrollToViewportPos({viewportScrollX:0,viewportScrollY:0});const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(!skeleton)return;const{sheetViewStartRow,sheetViewStartColumn,offsetX,offsetY}=rawScrollInfo,{startX,startY}=skeleton.getCellWithCoordByIndex(sheetViewStartRow,sheetViewStartColumn,!1),viewportScrollX=startX+offsetX,viewportScrollY=startY+offsetY;viewportMain.scrollToViewportPos({viewportScrollX,viewportScrollY})})))),this.disposeWithMe(viewportMain.onScrollAfter$.subscribeEvent((scrollAfterParam=>{if(!scrollAfterParam)return;const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(null==skeleton)return;const sheetObject=this._getSheetObject();if(null==skeleton||null==sheetObject)return;const{viewportScrollX,viewportScrollY,scrollX,scrollY}=scrollAfterParam,{row,column,rowOffset,columnOffset}=skeleton.getOffsetRelativeToRowCol(viewportScrollX,viewportScrollY),scrollInfo={sheetViewStartRow:row,sheetViewStartColumn:column,offsetX:columnOffset,offsetY:rowOffset,viewportScrollX,viewportScrollY,scrollX,scrollY};this._scrollManagerService.setValidScrollStateToCurrSheet(scrollInfo),this._scrollManagerService.validViewportScrollInfo$.next({...scrollInfo,scrollX,scrollY,viewportScrollX,viewportScrollY})}))),this.disposeWithMe(viewportMain.onScrollByBar$.subscribeEvent((param=>{const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(null==skeleton||!1===param.isTrigger)return;const sheetObject=this._getSheetObject();if(null==skeleton||null==sheetObject)return;const{viewportScrollX=0,viewportScrollY=0}=param,freeze=this._getFreeze(),{row,column,rowOffset,columnOffset}=skeleton.getOffsetRelativeToRowCol(viewportScrollX,viewportScrollY);this._commandService.executeCommand(ScrollCommand.id,{sheetViewStartRow:row+(freeze?.ySplit||0),sheetViewStartColumn:column+(freeze?.xSplit||0),offsetX:columnOffset,offsetY:rowOffset})}))))}_initSkeletonListener(){this.disposeWithMe((0,src.saO)(this._sheetSkeletonManagerService.currentSkeletonBefore$.subscribe((param=>{if(null==param)return;const scrollParam={unitId:param.unitId,sheetId:param.sheetId};this._scrollManagerService.setSearchParam(scrollParam);const sheetObject=this._getSheetObject();if(!sheetObject)return;const viewportMain=sheetObject.scene.getViewport(engine_render_src.p3k.VIEW_MAIN),currScrollInfo=this._scrollManagerService.getScrollStateByParam(scrollParam),{viewportScrollX,viewportScrollY}=this._scrollManagerService.calcViewportScrollFromRowColOffset(currScrollInfo);viewportMain&&(currScrollInfo?(viewportMain.viewportScrollX=viewportScrollX,viewportMain.viewportScrollY=viewportScrollY):(viewportMain.viewportScrollX=0,viewportMain.viewportScrollY=0),this._updateSceneSize(param))}))))}_initPointerScrollEvent(){const sheetObject=this._getSheetObject();if(!sheetObject)return;const scrollManagerService=this._scrollManagerService,scene=sheetObject.scene,spreadsheet=sheetObject.spreadsheet,viewportMain=scene.getViewport(engine_render_src.p3k.VIEW_MAIN),lastPointerPos={x:0,y:0};let _pointerScrolling=!1;const velocity={x:0,y:0};let scrollInertiaAnimationID=null;const pointerScrollInertia=()=>{if(!viewportMain)return;velocity.x*=.95,velocity.y*=.95,lastPointerPos.x+=velocity.x,lastPointerPos.y+=velocity.y;const offsetX=velocity.x,offsetY=velocity.y;0===offsetY&&0===offsetX||this._commandService.executeCommand(SetScrollRelativeCommand.id,{offsetY,offsetX}),scrollInertiaAnimationID=Math.abs(velocity.x)>1||Math.abs(velocity.y)>1?requestAnimationFrame(pointerScrollInertia):null};spreadsheet.onPointerDown$.subscribeEvent(((evt,state)=>{cancelAnimationFrame(scrollInertiaAnimationID),scrollInertiaAnimationID=null,viewportMain&&(lastPointerPos.x=evt.offsetX,lastPointerPos.y=evt.offsetY,_pointerScrolling=!0,state.stopPropagation())})),spreadsheet.onPointerMove$.subscribeEvent(((evt,state)=>{if(!_pointerScrolling)return;if(!viewportMain)return;const e=evt,deltaX=-(e.offsetX-lastPointerPos.x),deltaY=-(e.offsetY-lastPointerPos.y);velocity.x=-(e.offsetX-lastPointerPos.x),velocity.y=-(e.offsetY-lastPointerPos.y);const offsetX=deltaX,offsetY=deltaY;0===deltaX&&0===deltaY||0===offsetY&&0===offsetX||this._commandService.executeCommand(SetScrollRelativeCommand.id,{offsetY,offsetX});scrollManagerService.getCurrentScrollState();lastPointerPos.x=e.offsetX,lastPointerPos.y=e.offsetY,state.stopPropagation()})),spreadsheet.onPointerUp$.subscribeEvent((_evt=>{_pointerScrolling=!1,scrollInertiaAnimationID=requestAnimationFrame(pointerScrollInertia)})),spreadsheet.onPointerLeave$.subscribeEvent((()=>{_pointerScrolling=!1})),spreadsheet.onPointerOut$.subscribeEvent((()=>{_pointerScrolling=!1})),scene.onPointerOut$.subscribeEvent((()=>{_pointerScrolling=!1})),scene.onPointerCancel$.subscribeEvent((()=>{_pointerScrolling=!1}))}_updateSceneSize(param){if(null==param)return;const{unitId}=this._context,{skeleton}=param,scene=this._renderManagerService.getRenderById(unitId)?.scene;if(null==skeleton||null==scene)return;const{rowTotalHeight,columnTotalWidth,rowHeaderWidthAndMarginLeft,columnHeaderHeightAndMarginTop}=skeleton,worksheet=this._context.unit.getActiveSheet();if(!worksheet)return;const zoomRatio=worksheet.getZoomRatio()||1;scene?.setScaleValueOnly(zoomRatio,zoomRatio),scene?.transformByState({width:rowHeaderWidthAndMarginLeft+columnTotalWidth,height:columnHeaderHeightAndMarginTop+rowTotalHeight})}_getSheetObject(){return getSheetObject(this._context.unit,this._context)}_scrollToSelectionByDirection(range){const bounds=this._getViewportBounding();if(null==bounds)return!1;const{startRow:viewportStartRow,startColumn:viewportStartColumn,endRow:viewportEndRow,endColumn:viewportEndColumn}=bounds;let row=0,column=0;const{startRow,startColumn,endRow,endColumn}=range;startRow>=viewportStartRow&&(row=endRow),endRow<=viewportEndRow&&(row=startRow),startColumn>=viewportStartColumn&&(column=endColumn),endColumn<=viewportEndColumn&&(column=startColumn),this._scrollToCell(row,column)}_scrollToSelection(targetIsActualRowAndColumn=!0){const selection=this._selectionManagerService.getCurrentLastSelection();if(null==selection)return;const{startRow,startColumn,actualRow,actualColumn}=selection.primary,selectionStartRow=targetIsActualRowAndColumn?actualRow:startRow,selectionStartColumn=targetIsActualRowAndColumn?actualColumn:startColumn;this._scrollToCell(selectionStartRow,selectionStartColumn)}_getViewportBounding(){const scene=this._getSheetObject()?.scene;if(null==scene)return;const viewport=scene.getViewport(engine_render_src.p3k.VIEW_MAIN);if(null==viewport)return;const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;return null!=skeleton?skeleton.getRangeByViewport(viewport.calcViewportInfo()):void 0}_scrollToCell(row,column){const{rowHeightAccumulation,columnWidthAccumulation}=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton??{};if(null==rowHeightAccumulation||null==columnWidthAccumulation)return!1;const scene=this._getSheetObject()?.scene;if(null==scene)return!1;const viewport=scene.getViewport(engine_render_src.p3k.VIEW_MAIN);if(null==viewport)return!1;const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(null==skeleton)return!1;const worksheet=this._context.unit.getActiveSheet();if(!worksheet)return!1;const{startColumn:freezeStartColumn,startRow:freezeStartRow,ySplit:freezeYSplit,xSplit:freezeXSplit}=worksheet.getFreeze(),bounds=this._getViewportBounding();if(null==bounds)return!1;const{startRow:viewportStartRow,startColumn:viewportStartColumn,endRow:viewportEndRow,endColumn:viewportEndColumn}=bounds;let startSheetViewRow,startSheetViewColumn;if(row>=freezeStartRow&&column>=freezeStartColumn-freezeXSplit&&(row<=viewportStartRow&&(startSheetViewRow=row),row>=viewportEndRow)){const minRowAccumulation=rowHeightAccumulation[row]-viewport.height;for(let r=viewportStartRow;r<=row;r++)if(rowHeightAccumulation[r]>=minRowAccumulation){startSheetViewRow=r+1;break}}if(column>=freezeStartColumn&&row>=freezeStartRow-freezeYSplit&&(column<=viewportStartColumn&&(startSheetViewColumn=column),column>=viewportEndColumn)){const minColumnAccumulation=columnWidthAccumulation[column]-viewport.width;for(let c=viewportStartColumn;c<=column;c++)if(columnWidthAccumulation[c]>=minColumnAccumulation){startSheetViewColumn=c+1;break}}if(void 0===startSheetViewRow&&void 0===startSheetViewColumn)return!1;const{offsetX,offsetY}=this._scrollManagerService.getCurrentScrollState()||{};return this._commandService.syncExecuteCommand(ScrollCommand.id,{sheetViewStartRow:startSheetViewRow,sheetViewStartColumn:startSheetViewColumn,offsetX:void 0===startSheetViewColumn?offsetX:0,offsetY:void 0===startSheetViewRow?offsetY:0})}}MobileSheetsScrollRenderController=function mobile_scroll_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([mobile_scroll_render_controller_ts_param(1,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),mobile_scroll_render_controller_ts_param(2,src.wTY),mobile_scroll_render_controller_ts_param(3,engine_render_src.cSx),mobile_scroll_render_controller_ts_param(4,(0,src.y_5)(sheets_src.Fal)),mobile_scroll_render_controller_ts_param(5,(0,src.y_5)(SheetScrollManagerService)),mobile_scroll_render_controller_ts_param(6,src.HCr),mobile_scroll_render_controller_ts_metadata("design:type",Function),mobile_scroll_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService,void 0===src.wTY?Object:src.wTY,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===SheetScrollManagerService?Object:SheetScrollManagerService,void 0===src.HCr?Object:src.HCr])],MobileSheetsScrollRenderController);const PRINTING_RANGE=(0,src.nwg)("PRINTING_RANGE"),PRINTING_COMPONENT_COLLECT=(0,src.nwg)("PRINTING_COMPONENT_COLLECT");class SheetPrintInterceptorService extends src.jGt{constructor(){super(),this.interceptor=new src.vY4({PRINTING_RANGE,PRINTING_COMPONENT_COLLECT}),this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_RANGE,{priority:-1,handler:_value=>_value})),this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_COMPONENT_COLLECT,{priority:-1,handler:_value=>_value}))}}class MobileSelectionControl extends SelectionControl{constructor(_scene,_zIndex,_themeService,options){super(_scene,_zIndex,_themeService,options),this._scene=_scene,this._zIndex=_zIndex,this._themeService=_themeService,this._rangeType=src.$uV.NORMAL,this._rangeType=options?.rangeType||src.$uV.NORMAL,this.initControlPoints()}initControlPoints(){const defaultStyle=this.currentStyle,expandCornerSize=defaultStyle.expandCornerSize||0,expandCornerInnerSize=(defaultStyle.expandCornerSize||0)/4,AutofillStrokeWidth=defaultStyle.autofillStrokeWidth||0,stroke=defaultStyle.stroke,AutofillStroke=defaultStyle.autofillStroke,zIndex=this.zIndex;this._fillControlTopLeft=new engine_render_src.rwV(SELECTION_MANAGER_KEY.fillTopLeft+zIndex,{zIndex:zIndex+2,width:expandCornerSize,height:expandCornerSize,radius:expandCornerSize/2,visualWidth:expandCornerInnerSize,visualHeight:expandCornerInnerSize,strokeWidth:AutofillStrokeWidth}),this._fillControlBottomRight=new engine_render_src.rwV(SELECTION_MANAGER_KEY.fillBottomRight+zIndex,{zIndex:zIndex+2,width:expandCornerSize,height:expandCornerSize,radius:expandCornerSize/2,visualHeight:expandCornerInnerSize,visualWidth:expandCornerInnerSize,strokeWidth:AutofillStrokeWidth});const fillProps={fill:stroke,stroke:AutofillStroke,strokeScaleEnabled:!1};this._fillControlTopLeft.setProps({...fillProps}),this._fillControlBottomRight.setProps({...fillProps});const objs=[this._fillControlTopLeft,this._fillControlBottomRight];switch(this._rangeType){case src.$uV.ROW:this.rowHeaderGroup.addObjects(...objs);break;case src.$uV.COLUMN:this.columnHeaderGroup.addObjects(...objs);break;case src.$uV.NORMAL:this.selectionShapeGroup.addObjects(...objs)}this.getScene().addObjects(objs,1)}get fillControlTopLeft(){return this._fillControlTopLeft}set fillControlTopLeft(value){this._fillControlTopLeft=value}get fillControlBottomRight(){return this._fillControlBottomRight}set fillControlBottomRight(value){this._fillControlBottomRight=value}get rangeType(){return this._rangeType}set rangeType(value){this._rangeType=value}dispose(){this._fillControlBottomRight?.dispose(),this._fillControlTopLeft?.dispose(),super.dispose()}_updateLayoutOfSelectionControl(style){super._updateLayoutOfSelectionControl(style);const defaultStyle=this.currentStyle;null==style&&(style=defaultStyle);const{widgets=defaultStyle.widgets}=style;if(this.currentStyle=style,!0!==this._enableAutoFill||super._hasWidgets(widgets))this.fillControlTopLeft?.hide(),this.fillControlBottomRight?.hide();else{const{viewportScrollX,viewportScrollY}=this.getViewportMainScrollInfo(),{endX,endY}=this.selectionModel;this.transformControlPoint(viewportScrollX,viewportScrollY,endX,endY),this.fillControlTopLeft.show(),this.fillControlBottomRight.show()}}getViewportMainScrollInfo(){const viewMain=this.getScene().getViewport(engine_render_src.p3k.VIEW_MAIN);return{viewportScrollX:viewMain?.viewportScrollX||0,viewportScrollY:viewMain?.viewportScrollY||0,width:viewMain?.width||0,height:viewMain?.height||0}}transformControlPoint(viewportScrollX=0,viewportScrollY=0,sheetContentWidth=0,sheetContentHeight=0){const style=this.currentStyle,rangeType=this.selectionModel.rangeType,expandCornerSize=style.expandCornerSize,{startX,startY,endX,endY}=this.selectionModel,viewportSizeInfo=this.getViewportMainScrollInfo(),viewportW=viewportSizeInfo.width,viewportH=viewportSizeInfo.height;switch(rangeType){case src.$uV.NORMAL:this.fillControlTopLeft.transformByState({left:-expandCornerSize/2,top:-expandCornerSize/2}),this.fillControlBottomRight.transformByState({left:endX-startX-expandCornerSize/2,top:endY-startY-expandCornerSize/2});break;case src.$uV.ROW:{const controlLeft=-expandCornerSize/2+Math.min(viewportW/2+viewportScrollX,sheetContentWidth);this.fillControlTopLeft.transformByState({left:controlLeft,top:-expandCornerSize/2}),this.fillControlBottomRight.transformByState({left:controlLeft,top:-expandCornerSize/2+endY-startY})}break;case src.$uV.COLUMN:{const controlTop=-expandCornerSize/2+Math.min(+viewportH/2+viewportScrollY,sheetContentHeight);this.fillControlTopLeft.transformByState({left:-expandCornerSize/2,top:controlTop}),this.fillControlBottomRight.transformByState({left:-expandCornerSize/2+endX-startX,top:controlTop})}break;default:console.error("unknown range type")}}}function mobile_selection_render_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function mobile_selection_render_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class MobileSheetsSelectionRenderService extends BaseSelectionRenderService{constructor(_context,injector,themeService,shortcutService,selectionManagerService,sheetSkeletonManagerService,_logService,_commandService,_contextService,_scrollManagerService){super(injector,themeService,shortcutService,sheetSkeletonManagerService,_contextService),this._context=_context,this._logService=_logService,this._commandService=_commandService,this._contextService=_contextService,this._scrollManagerService=_scrollManagerService,this._renderDisposable=null,this._expandingSelection=!1,this._selectionControls=[],this.expandingControlMode="bottom-right",this._workbookSelections=selectionManagerService.getWorkbookSelections(this._context.unitId),this._init()}_init(){const sheetObject=this._getSheetObject();this._initEventListeners(sheetObject),this._initSelectionChangeListener(),this._initSkeletonChangeListener(),this._initUserActionSyncListener(),this._updateControlPointWhenScrolling()}_initSkeletonChangeListener(){this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((param=>{if(null==param)return void this._logService.error("[SelectionRenderService]: should not receive null!");const unitId=this._context.unitId,{sheetId,skeleton}=param,{scene}=this._context,viewportMain=scene.getViewport(engine_render_src.p3k.VIEW_MAIN);this._changeRuntime(skeleton,scene,viewportMain);this._workbookSelections.getCurrentLastSelection()||this._commandService.syncExecuteCommand(sheets_src.NSB.id,{unitId,subUnitId:sheetId,selections:[getTopLeftSelectionOfCurrSheet(skeleton)]})})))}_initSelectionChangeListener(){}_initEventListeners(sheetObject){const{spreadsheetRowHeader,spreadsheetColumnHeader,spreadsheet,spreadsheetLeftTopPlaceholder}=sheetObject,{scene}=this._context;this._initSpreadsheetEvent(sheetObject),this.disposeWithMe(spreadsheetRowHeader?.onPointerUp$.subscribeEvent(((evt,_state)=>{if(this._normalSelectionDisabled())return;const skeleton=this._sheetSkeletonManagerService.getCurrentParam().skeleton,{row}=getCoordByOffset(evt.offsetX,evt.offsetY,scene,skeleton);isThisRowSelected(this._workbookSelections.getCurrentSelections(),row)||(this.createNewSelection(evt,(spreadsheet.zIndex||1)+1,src.$uV.ROW,this._getActiveViewport(evt)),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()))}))),this.disposeWithMe(spreadsheetColumnHeader?.onPointerUp$.subscribeEvent(((evt,_state)=>{if(this._normalSelectionDisabled())return;const skeleton=this._sheetSkeletonManagerService.getCurrentParam().skeleton,{column}=getCoordByOffset(evt.offsetX,evt.offsetY,scene,skeleton);isThisColSelected(this._workbookSelections.getCurrentSelections(),column)||(this.createNewSelection(evt,(spreadsheet.zIndex||1)+1,src.$uV.COLUMN,this._getActiveViewport(evt)),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()))}))),this.disposeWithMe(spreadsheetLeftTopPlaceholder?.onPointerUp$.subscribeEvent(((_evt,state)=>{if(this._normalSelectionDisabled())return;this._reset();const selectionWithStyle=selectionDataForSelectAll(this._sheetSkeletonManagerService.getCurrentParam().skeleton);this._addSelectionControlByModelData(selectionWithStyle),this.refreshSelectionMoveStart(),state.stopPropagation(),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle())})))}_initSpreadsheetEvent(sheetObject){const{spreadsheet}=sheetObject;let longPressTimer;const pointerDownPos={x:0,y:0},createNewSelection=(evt,showContextMenu)=>{this.createNewSelection(evt,spreadsheet.zIndex+1,src.$uV.NORMAL,this._getActiveViewport(evt)),showContextMenu&&this._selectionMoveEnd$.next(this.getSelectionDataWithStyle())};spreadsheet?.onPointerMove$.subscribeEvent(((evt,_state)=>{(Math.abs(evt.offsetX-pointerDownPos.x)>10||Math.abs(evt.offsetY-pointerDownPos.y)>10)&&clearTimeout(longPressTimer)}));const spreadsheetPointerDownSub=spreadsheet?.onPointerDown$.subscribeEvent(((evt,state)=>{pointerDownPos.x=evt.offsetX,pointerDownPos.y=evt.offsetY,longPressTimer=setTimeout((()=>{createNewSelection(evt,!0)}),500),state.stopPropagation()})),spreadsheetPointerUpSub=spreadsheet?.onPointerUp$.subscribeEvent(((evt,state)=>{if(this._normalSelectionDisabled())return;clearTimeout(longPressTimer);Math.abs(evt.offsetX-pointerDownPos.x)>10||Math.abs(evt.offsetY-pointerDownPos.y)>10||(createNewSelection(evt,!1),state.stopPropagation())}));this.disposeWithMe((0,src.saO)(spreadsheetPointerDownSub)),this.disposeWithMe((0,src.saO)(spreadsheetPointerUpSub))}_initUserActionSyncListener(){this.disposeWithMe(this.selectionMoveStart$.subscribe((params=>this._updateSelections(params,sheets_src.kFf.MOVE_START)))),this.disposeWithMe(this.selectionMoving$.subscribe((params=>this._updateSelections(params,sheets_src.kFf.MOVING)))),this.disposeWithMe(this._contextService.subscribeContextValue$(sheets_src.C5D).pipe((0,operators_startWith.Z)(!1),(0,distinctUntilChanged.F)()).subscribe((disabled=>{disabled?(this._renderDisposable?.dispose(),this._renderDisposable=null,this._reset()):this._renderDisposable=(0,src.saO)(this.selectionMoveEnd$.subscribe((params=>this._updateSelections(params,sheets_src.kFf.MOVE_END))))})))}_updateSelections(selectionDataWithStyleList,type){const workbook=this._context.unit,unitId=workbook.getUnitId(),sheetId=workbook.getActiveSheet().getSheetId();0!==selectionDataWithStyleList.length&&this._commandService.executeCommand(sheets_src.NSB.id,{unitId,subUnitId:sheetId,type,selections:selectionDataWithStyleList.map((selectionDataWithStyle=>(0,sheets_src.Y9H)(selectionDataWithStyle)))})}createNewSelection(evt,_zIndex=0,rangeType=src.$uV.NORMAL,viewport){this._rangeType=rangeType;const skeleton=this._skeleton,scene=this._scene;if(!scene||!skeleton)return;viewport&&(this._activeViewport=viewport);const{offsetX:evtOffsetX,offsetY:evtOffsetY}=evt,relativeCoords=scene.getCoordRelativeToViewport(engine_render_src.I9Y.FromArray([evtOffsetX,evtOffsetY])),{x:offsetX,y:offsetY}=relativeCoords;this._startViewportPosX=offsetX,this._startViewportPosY=offsetY;const scrollXY=scene.getScrollXYInfoByViewport(relativeCoords),{scaleX,scaleY}=scene.getAncestorScale(),selectCell=this._skeleton.getCellByOffset(offsetX,offsetY,scaleX,scaleY,scrollXY);if(!selectCell)return;switch(rangeType){case src.$uV.NORMAL:break;case src.$uV.ROW:selectCell.startColumn=0,selectCell.endColumn=this._skeleton.getColumnCount()-1;break;case src.$uV.COLUMN:selectCell.startRow=0,selectCell.endRow=this._skeleton.getRowCount()-1;break;case src.$uV.ALL:selectCell.startRow=0,selectCell.startColumn=0,selectCell.endRow=this._skeleton.getRowCount()-1,selectCell.endColumn=this._skeleton.getColumnCount()-1}const selectionWithStyle={range:selectCell,primary:selectCell,style:null};selectionWithStyle.range.rangeType=rangeType;const selectionCellWithCoord=attachSelectionWithCoord(selectionWithStyle,this._skeleton);this._startRangeWhenPointerDown={...selectionCellWithCoord.rangeWithCoord};let activeSelectionControl=this.getActiveSelectionControl();const cursorRangeWidthCoord={...selectionCellWithCoord.rangeWithCoord};for(const control of this.getSelectionControls())if(control.model.isEqual(cursorRangeWidthCoord)){activeSelectionControl=control;break}activeSelectionControl?.model.rangeType!==rangeType?(this._clearAllSelectionControls(),activeSelectionControl=this.newSelectionControl(scene,skeleton,selectionWithStyle)):activeSelectionControl.updateRangeBySelectionWithCoord(selectionCellWithCoord),this._selectionMoveStart$.next(this.getSelectionDataWithStyle()),this._clearUpdatingListeners(),this._expandingSelection=!1}newSelectionControl(scene,skeleton,selection){const selectionControls=this.getSelectionControls(),{rowHeaderWidth,columnHeaderHeight}=skeleton,rangeType=selection.range.rangeType,control=new MobileSelectionControl(scene,selectionControls.length,this._themeService,{highlightHeader:this._highlightHeader,rowHeaderWidth,columnHeaderHeight,rangeType}),selectionWithCoord=attachSelectionWithCoord(selection,skeleton);control.updateRangeBySelectionWithCoord(selectionWithCoord),this._selectionControls.push(control);const{expandingModeForTopLeft,expandingModeForBottomRight}=(()=>{switch(rangeType){case src.$uV.NORMAL:return{expandingModeForTopLeft:"top-left",expandingModeForBottomRight:"bottom-right"};case src.$uV.ROW:return{expandingModeForTopLeft:"top",expandingModeForBottomRight:"bottom"};case src.$uV.COLUMN:return{expandingModeForTopLeft:"left",expandingModeForBottomRight:"right"};case src.$uV.ALL:default:return{expandingModeForTopLeft:"top-left",expandingModeForBottomRight:"bottom-right"}}})();if(control.fillControlTopLeft.onPointerDown$.subscribeEvent((evt=>{this._expandingSelection=!0,this.expandingControlMode=expandingModeForTopLeft,this._selectionMoveStart$.next(this.getSelectionDataWithStyle()),this._fillControlPointerDownHandler(evt,rangeType,this._activeViewport)})),control.fillControlBottomRight.onPointerDown$.subscribeEvent((evt=>{this._expandingSelection=!0,this.expandingControlMode=expandingModeForBottomRight,this._selectionMoveStart$.next(this.getSelectionDataWithStyle()),this._fillControlPointerDownHandler(evt,rangeType,this._activeViewport)})),rangeType===src.$uV.ROW||rangeType===src.$uV.COLUMN){if(!scene.getViewport(engine_render_src.p3k.VIEW_MAIN))return control}return control}_getActiveViewport(evt){const sheetObject=this._getSheetObject();return sheetObject?.scene.getActiveViewportByCoord(engine_render_src.I9Y.FromArray([evt.offsetX,evt.offsetY]))}_getSheetObject(){return getSheetObject(this._context.unit,this._context)}_normalSelectionDisabled(){return this._contextService.getContextValue(sheets_src.C5D)}getSelectionControls(){return this._selectionControls}_fillControlPointerDownHandler(evt,rangeType=src.$uV.NORMAL,viewport,scrollTimerType=engine_render_src.rDM.ALL){const skeleton=this._skeleton,scene=this._scene;if(!scene||!skeleton)return;viewport&&(this._activeViewport=viewport);const viewportMain=scene.getViewport(engine_render_src.p3k.VIEW_MAIN),activeSelectionControl=this.getActiveSelectionControl();if(!activeSelectionControl)return;this._changeCurrCellWhenControlPointerDown(),this._selectionMoveStart$.next(this.getSelectionDataWithStyle()),this._clearUpdatingListeners(),this._addEndingListeners(),this._scrollTimer=engine_render_src.Vui.create(this._scene,scrollTimerType),this._scrollTimer.startScroll(viewportMain?.left??0,viewportMain?.top??0,viewportMain),scene.getTransformer()?.clearSelectedObjects();const relativeCoords=scene.getCoordRelativeToViewport(engine_render_src.I9Y.FromArray([evt.offsetX,evt.offsetY]));this._setupPointerMoveListener(viewportMain,activeSelectionControl,rangeType,scrollTimerType,relativeCoords.x,relativeCoords.y);const disposableShortcut=this._shortcutService.forceEscape();this._scenePointerUpSub=scene.onPointerUp$.subscribeEvent((_evt=>{this.endSelection(),this._expandingSelection=!1,this.expandingControlMode="bottom-right",this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()),disposableShortcut.dispose()}))}_changeCurrCellWhenControlPointerDown(){const activeSelectionControl=this.getActiveSelectionControl(),skeleton=this._skeleton;let currCellRange;const{startRow,startColumn,endRow,endColumn}=activeSelectionControl.model;switch(this.expandingControlMode){case"top-left":currCellRange=skeleton.getCellWithCoordByIndex(endRow,endColumn);break;case"bottom-right":default:currCellRange=skeleton.getCellWithCoordByIndex(startRow,startColumn);break;case"left":currCellRange=skeleton.getCellWithCoordByIndex(startRow,endColumn),currCellRange.isMerged=!1,currCellRange.isMergedMainCell=!1;break;case"right":case"bottom":currCellRange=skeleton.getCellWithCoordByIndex(startRow,startColumn),currCellRange.isMerged=!1,currCellRange.isMergedMainCell=!1;break;case"top":currCellRange=skeleton.getCellWithCoordByIndex(endRow,startColumn),currCellRange.isMerged=!1,currCellRange.isMergedMainCell=!1}return activeSelectionControl.updateCurrCell(currCellRange),currCellRange}_movingHandler(offsetX,offsetY,activeSelectionControl,rangeType){this._rangeType=rangeType;const skeleton=this._skeleton,scene=this._scene,currSelectionRange={startRow:activeSelectionControl.model.startRow,endRow:activeSelectionControl.model.endRow,startColumn:activeSelectionControl.model.startColumn,endColumn:activeSelectionControl.model.endColumn},viewportMain=scene.getViewport(engine_render_src.p3k.VIEW_MAIN),targetViewport=this._getViewportByCell(currSelectionRange.endRow,currSelectionRange.endColumn)??viewportMain,scrollXY=scene.getScrollXYInfoByViewport(engine_render_src.I9Y.FromArray([this._startViewportPosX,this._startViewportPosY]),targetViewport),{scaleX,scaleY}=scene.getAncestorScale();rangeType===src.$uV.ROW?offsetX=Number.POSITIVE_INFINITY:rangeType===src.$uV.COLUMN&&(offsetY=Number.POSITIVE_INFINITY);const cursorCellRangeInfo=this._getSelectionWithCoordByOffset(offsetX,offsetY,scaleX,scaleY,scrollXY);if(!cursorCellRangeInfo)return!1;const{rangeWithCoord:cursorCellRange}=cursorCellRangeInfo,currCellRange=activeSelectionControl.model.currentCell,startRowOfActiveCell=currCellRange?.mergeInfo.startRow??-1,endRowOfActiveCell=currCellRange?.mergeInfo.endRow??-1,startColumnOfActiveCell=currCellRange?.mergeInfo.startColumn??-1,endColOfActiveCell=currCellRange?.mergeInfo.endColumn??-1;let newSelectionRange={startRow:Math.min(cursorCellRange.startRow,startRowOfActiveCell),startColumn:Math.min(cursorCellRange.startColumn,startColumnOfActiveCell),endRow:Math.max(cursorCellRange.endRow,endRowOfActiveCell),endColumn:Math.max(cursorCellRange.endColumn,endColOfActiveCell)};if(rangeType===src.$uV.NORMAL?newSelectionRange=skeleton.expandRangeByMerge(newSelectionRange):(rangeType===src.$uV.COLUMN||rangeType===src.$uV.ROW)&&(newSelectionRange={startRow:Math.min(cursorCellRange.startRow,currCellRange?.actualRow??-1),startColumn:Math.min(cursorCellRange.startColumn,currCellRange?.actualColumn??-1),endRow:Math.max(cursorCellRange.endRow,currCellRange?.actualRow??-1),endColumn:Math.max(cursorCellRange.endColumn,currCellRange?.actualColumn??-1)}),!newSelectionRange)return!1;const newSelectionRangeWithCoord=attachSelectionWithCoord({range:newSelectionRange,style:null,primary:null},skeleton);(currSelectionRange.startRow!==newSelectionRange.startRow||currSelectionRange.startColumn!==newSelectionRange.startColumn||currSelectionRange.endRow!==newSelectionRange.endRow||currSelectionRange.endColumn!==newSelectionRange.endColumn)&&activeSelectionControl&&(activeSelectionControl.updateRangeBySelectionWithCoord(newSelectionRangeWithCoord),this._selectionMoving$.next(this.getSelectionDataWithStyle()))}_updateControlPointWhenScrolling(){const{scene}=this._context;if(!scene.getViewport(engine_render_src.p3k.VIEW_MAIN))return;const sub=this._scrollManagerService.validViewportScrollInfo$.subscribe((param=>{if(null==param)return;const{viewportScrollX,viewportScrollY}=param,activeControl=this.getActiveSelectionControl();if(null==activeControl)return;const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton,sheetContentHeight=skeleton?.rowTotalHeight,sheetContentWidth=skeleton?.columnTotalWidth,rangeType=activeControl.rangeType;rangeType===src.$uV.COLUMN?activeControl.transformControlPoint(0,viewportScrollY,sheetContentWidth,sheetContentHeight):rangeType===src.$uV.ROW&&activeControl.transformControlPoint(viewportScrollX,0,sheetContentWidth,sheetContentHeight)}));this.disposeWithMe((0,src.saO)(sub))}}function mobile_plugin_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function mobile_plugin_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}MobileSheetsSelectionRenderService=function mobile_selection_render_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([mobile_selection_render_service_ts_param(1,(0,src.y_5)(src.zZn)),mobile_selection_render_service_ts_param(2,(0,src.y_5)(src.Fsb)),mobile_selection_render_service_ts_param(3,ui_src.nF),mobile_selection_render_service_ts_param(4,(0,src.y_5)(sheets_src.Fal)),mobile_selection_render_service_ts_param(5,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),mobile_selection_render_service_ts_param(6,src.rrK),mobile_selection_render_service_ts_param(7,src.wTY),mobile_selection_render_service_ts_param(8,src.oaf),mobile_selection_render_service_ts_param(9,(0,src.y_5)(SheetScrollManagerService)),mobile_selection_render_service_ts_metadata("design:type",Function),mobile_selection_render_service_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===src.zZn?Object:src.zZn,void 0===src.Fsb?Object:src.Fsb,void 0===ui_src.nF?Object:ui_src.nF,void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService,void 0===src.rrK?Object:src.rrK,void 0===src.wTY?Object:src.wTY,void 0===src.oaf?Object:src.oaf,void 0===SheetScrollManagerService?Object:SheetScrollManagerService])],MobileSheetsSelectionRenderService);class UniverSheetsMobileUIPlugin extends src.k_1{static#_=this.pluginName="SHEET_UI_PLUGIN";static#_2=this.type=src.Zy$.UNIVER_SHEET;constructor(_config=controllers_config_schema_defaultPluginConfig,_injector,_renderManagerService,_univerInstanceService){super(),this._config=_config,this._injector=_injector,this._renderManagerService=_renderManagerService,this._univerInstanceService=_univerInstanceService}onStarting(){[[ShortcutExperienceService],[ISheetClipboardService,{useClass:SheetClipboardService}],[ISheetBarService,{useClass:SheetBarService}],[IFormatPainterService,{useClass:FormatPainterService}],[IAutoFillService,{useClass:AutoFillService}],[SheetPrintInterceptorService],[ISheetSelectionRenderService,{useClass:MobileSheetsSelectionRenderService}],[IStatusBarService,{useClass:StatusBarService}],[IMarkSelectionService,{useClass:MarkSelectionService}],[HoverManagerService],[DragManagerService],[SheetCanvasPopManagerService],[CellAlertManagerService],[SelectAllService],[ActiveWorksheetController],[AutoHeightController],[SheetClipboardController],[SheetsRenderService],[SheetUIMobileController],[StatusBarController],[sheets_src.BcG,{useClass:sheets_src.mOY}],[SheetPermissionPanelModel],[SheetPermissionUserManagerService],[WorksheetProtectionRenderController],[SheetPermissionInterceptorClipboardController],[SheetPermissionCheckUIController],[SheetPermissionRenderManagerController]].forEach((d=>this._injector.add(d)))}onReady(){this._markSheetAsFocused(),this._registerRenderBasics(),this._injector.get(SheetUIMobileController)}onRendered(){this._registerRenderModules()}_registerRenderBasics(){[[sheet_skeleton_manager_service_SheetSkeletonManagerService],[SheetRenderController],[ISheetSelectionRenderService,{useClass:MobileSheetsSelectionRenderService}],[SheetScrollManagerService]].forEach((renderDep=>{this.disposeWithMe(this._renderManagerService.registerRenderModule(src.Zy$.UNIVER_SHEET,renderDep))}))}_registerRenderModules(){[[HeaderMoveRenderController],[HeaderFreezeRenderController],[MobileSheetsScrollRenderController],[SheetsZoomRenderController],[FormatPainterRenderController],[CellAlertRenderController],[ForceStringAlertRenderController],[MarkSelectionRenderController],[HoverRenderController],[DragRenderController],[ForceStringRenderController],[CellCustomRenderController],[SheetContextMenuMobileRenderController],[SheetPermissionInterceptorCanvasRenderController],[SheetPermissionInterceptorFormulaRenderController],[SheetPermissionRenderController]].forEach((renderModule=>{this.disposeWithMe(this._renderManagerService.registerRenderModule(src.Zy$.UNIVER_SHEET,renderModule))}))}_markSheetAsFocused(){const univerInstanceService=this._univerInstanceService;this.disposeWithMe(univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET).pipe((0,filter.p)((v=>!!v))).subscribe((workbook=>{this._univerInstanceService.getFocusedUnit()!==workbook&&univerInstanceService.focusUnit(workbook.getUnitId())})))}}function checkbox_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function checkbox_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}UniverSheetsMobileUIPlugin=function mobile_plugin_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([(0,src.dCC)(sheets_src.nDU,ui_src.xW),mobile_plugin_ts_param(1,(0,src.y_5)(src.zZn)),mobile_plugin_ts_param(2,engine_render_src.cSx),mobile_plugin_ts_param(3,src.HCr),mobile_plugin_ts_metadata("design:type",Function),mobile_plugin_ts_metadata("design:paramtypes",["undefined"==typeof Partial?Object:Partial,void 0===src.zZn?Object:src.zZn,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===src.HCr?Object:src.HCr])],UniverSheetsMobileUIPlugin);class SheetCheckboxController extends src.jGt{constructor(_hoverManagerService,_instanceService,_commandService,_renderManagerService){super(),this._hoverManagerService=_hoverManagerService,this._instanceService=_instanceService,this._commandService=_commandService,this._renderManagerService=_renderManagerService,this._isPointer=!1,this._initPointerEvent(),this._initHover()}get _mainComponent(){return(0,engine_render_src.iDO)(src.Zy$.UNIVER_SHEET,this._instanceService,this._renderManagerService)?.mainComponent}_initHover(){this.disposeWithMe(this._hoverManagerService.currentRichText$.subscribe((richText=>{richText?.bullet?(this._isPointer||this._mainComponent?.setCursor(engine_render_src.MBo.POINTER),this._isPointer=!0):(this._isPointer&&this._mainComponent?.setCursor(engine_render_src.MBo.AUTO),this._isPointer=!1)})))}_initPointerEvent(){this.disposeWithMe(this._hoverManagerService.currentClickedCell$.subscribe((cell=>{const{location,bullet}=cell;bullet&&this._commandService.executeCommand(sheets_src.Pxm.id,{unitId:location.unitId,subUnitId:location.subUnitId,row:location.row,col:location.col,paragraphIndex:bullet.startIndex})})))}}function defined_name_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function defined_name_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}SheetCheckboxController=function checkbox_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([checkbox_controller_ts_param(0,(0,src.y_5)(HoverManagerService)),checkbox_controller_ts_param(1,src.HCr),checkbox_controller_ts_param(2,src.wTY),checkbox_controller_ts_param(3,engine_render_src.cSx),checkbox_controller_ts_metadata("design:type",Function),checkbox_controller_ts_metadata("design:paramtypes",[void 0===HoverManagerService?Object:HoverManagerService,void 0===src.HCr?Object:src.HCr,void 0===src.wTY?Object:src.wTY,void 0===engine_render_src.cSx?Object:engine_render_src.cSx])],SheetCheckboxController);class SheetsDefinedNameController extends src.jGt{constructor(_selectionManagerService,_themeService,_instanceSrv,_cmdSrv,_definedNamesService){super(),this._selectionManagerService=_selectionManagerService,this._themeService=_themeService,this._instanceSrv=_instanceSrv,this._cmdSrv=_cmdSrv,this._definedNamesService=_definedNamesService,this._init()}_init(){this.disposeWithMe((0,observable_merge.h)(this._selectionManagerService.selectionMoveStart$,this._selectionManagerService.selectionMoving$,this._selectionManagerService.selectionMoveEnd$,this._selectionManagerService.selectionSet$).pipe((0,filter.p)((params=>!!params))).subscribe((params=>{this._syncDefinedNameRange(params)}))),this.disposeWithMe(this._definedNamesService.focusRange$.subscribe((async item=>{if(null==item)return;const{unitId}=item;let{formulaOrRefString}=item;formulaOrRefString.substring(0,1)===engine_formula_src.gm.EQUALS&&(formulaOrRefString=formulaOrRefString.substring(1));if(!(0,engine_formula_src.oB)(formulaOrRefString))return;const workbook=this._instanceSrv.getUnit(unitId),selections=await this._getSelections(workbook,unitId,formulaOrRefString);this._selectionManagerService.setSelections(selections),this._cmdSrv.executeCommand(sheets_src.Q8V.id,{unitId,range:selections[0].range})})))}_syncDefinedNameRange(params){if(0===params.length)return;const lastSelection=params[params.length-1],workbook=this._instanceSrv.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook?.getActiveSheet();worksheet&&this._definedNamesService.setCurrentRange({range:lastSelection.range,unitId:workbook.getUnitId(),sheetId:worksheet.getSheetId()})}async _getSelections(workbook,unitId,formulaOrRefString){const valueArray=formulaOrRefString.split(",");let worksheet=workbook.getActiveSheet();if(!worksheet)return[];const selections=[];for(let i=0;i<valueArray.length;i++){const refString=valueArray[i].trim(),unitRange=(0,engine_formula_src.YJ)(refString.trim());if(0===i){const worksheetCache=workbook.getSheetBySheetName(unitRange.sheetName);worksheetCache&&worksheet.getSheetId()!==worksheetCache.getSheetId()&&(worksheet=worksheetCache,await this._cmdSrv.executeCommand(sheets_src.LlJ.id,{subUnitId:worksheet.getSheetId(),unitId}))}if(worksheet.getName()!==unitRange.sheetName)continue;let primary=null;if(i===valueArray.length-1){const range=unitRange.range,{startRow,startColumn,endRow,endColumn}=range;primary=(0,sheets_src.fCg)({startRow,startColumn,endRow,endColumn},worksheet)}selections.push({range:unitRange.range,style:genNormalSelectionStyle(this._themeService),primary})}return selections}}function formula_editor_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function formula_editor_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}SheetsDefinedNameController=function defined_name_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([defined_name_controller_ts_param(0,(0,src.y_5)(sheets_src.Fal)),defined_name_controller_ts_param(1,(0,src.y_5)(src.Fsb)),defined_name_controller_ts_param(2,src.HCr),defined_name_controller_ts_param(3,src.wTY),defined_name_controller_ts_param(4,engine_formula_src.ke),defined_name_controller_ts_metadata("design:type",Function),defined_name_controller_ts_metadata("design:paramtypes",[void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===src.Fsb?Object:src.Fsb,void 0===src.HCr?Object:src.HCr,void 0===src.wTY?Object:src.wTY,void 0===engine_formula_src.ke?Object:engine_formula_src.ke])],SheetsDefinedNameController);class FormulaEditorController extends src.hy_{constructor(_univerInstanceService,_renderManagerService,_editorBridgeService,_commandService,_contextService,_formulaEditorManagerService,_undoRedoService,_textSelectionManagerService,_editorService){super(),this._univerInstanceService=_univerInstanceService,this._renderManagerService=_renderManagerService,this._editorBridgeService=_editorBridgeService,this._commandService=_commandService,this._contextService=_contextService,this._formulaEditorManagerService=_formulaEditorManagerService,this._undoRedoService=_undoRedoService,this._textSelectionManagerService=_textSelectionManagerService,this._editorService=_editorService,this._loadedMap=new WeakSet,this._scheduledCallback=-1,this._initialize()}_initialize(){this._syncEditorSize(),this._listenFxBtnClick(),this._handleContentChange(),this._univerInstanceService.focused$.pipe((0,takeUntil.Q)(this.dispose$)).subscribe((unitId=>{this._create(unitId)})),this._create(src.azi),this.disposeWithMe(this._editorService.focus$.subscribe((()=>{const focusUnitId=this._editorService.getFocusEditor()?.getEditorId();focusUnitId!==src.azi?this._contextService.setContextValue(src.kgb,!1):this._contextService.setContextValue(src.kgb,!0)})))}_handleContentChange(){this.disposeWithMe(this._commandService.onCommandExecuted((commandInfo=>{if(commandInfo.id===docs_src.Bz.id){const params=commandInfo.params,{unitId}=params;unitId===src.azi&&this.autoScroll()}})))}_create(unitId){if(unitId!==src.azi)return;const formulaEditorDocObject=this._renderManagerService.getRenderById(unitId);if(null==formulaEditorDocObject)return;const{mainComponent:documentComponent}=formulaEditorDocObject;null!=documentComponent&&(this._loadedMap.has(documentComponent)||this._loadedMap.add(documentComponent))}_listenFxBtnClick(){this._formulaEditorManagerService.fxBtnClick$.pipe((0,takeUntil.Q)(this.dispose$)).subscribe((()=>{if(this._contextService.getContextValue(src.ANQ)&&!this._contextService.getContextValue(src.AF$)){this._univerInstanceService.setCurrentUnitForType(src.azi),this._contextService.setContextValue(src.kgb,!0);const currentSheet=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),formulaEditorDataModel=this._univerInstanceService.getUniverDocInstance(src.azi);!1===this._editorBridgeService.isVisible().visible&&this._commandService.syncExecuteCommand(SetCellEditVisibleOperation.id,{visible:!0,eventType:engine_render_src.bKQ.PointerDown,unitId:currentSheet?.getUnitId()??""});const content=formulaEditorDataModel?.getBody()?.dataStream;if(null==content)return;let newContent=content.startsWith("=")?content:`=${content}`;newContent=newContent.replace(/\r\n$/,"");const textRanges=[{startOffset:newContent.length,endOffset:newContent.length}],coverContentParams={unitId:src.azi,body:{dataStream:newContent},segmentId:""};this._commandService.executeCommand(replace_content_command.As.id,coverContentParams),this._textSelectionManagerService.replaceDocRanges(textRanges)}}))}_syncEditorSize(){const addFOrmulaBar$=this._univerInstanceService.unitAdded$.pipe((0,filter.p)((unit=>unit.getUnitId()===src.azi)));this.disposeWithMe((0,combineLatest.z)([this._formulaEditorManagerService.position$,addFOrmulaBar$]).subscribe((([position])=>{if(!position)return this._clearScheduledCallback();const editorObject=getEditorObject(src.azi,this._renderManagerService),formulaEditorDataModel=this._univerInstanceService.getUniverDocInstance(src.azi);if(null==editorObject||null==formulaEditorDataModel)return this._clearScheduledCallback();const{width,height}=position;if(0===width||0===height)return this._clearScheduledCallback();const{engine}=editorObject;formulaEditorDataModel.updateDocumentDataPageSize(width),this.autoScroll(),this._scheduledCallback=requestIdleCallback((()=>engine.resizeBySize(width,height)))})))}_clearScheduledCallback(){-1!==this._scheduledCallback&&cancelIdleCallback(this._scheduledCallback),this._scheduledCallback=-1}autoScroll(){const position=this._formulaEditorManagerService.getPosition(),skeleton=this._renderManagerService.getRenderById(src.azi)?.with(docs_src.EX).getSkeleton(),editorObject=this._renderManagerService.getRenderById(src.azi),formulaEditorDataModel=this._univerInstanceService.getUniverDocInstance(src.azi);if(null==skeleton||null==position||null==editorObject||null==formulaEditorDataModel)return;const{marginTop=0,marginBottom=0}=formulaEditorDataModel.getSnapshot().documentStyle,{scene,mainComponent}=editorObject;let{actualHeight}=skeleton.getActualSize();actualHeight+=marginTop+marginBottom;const{width,height}=position,viewportMain=scene.getViewport(docs_view_key.hl.VIEW_MAIN);let scrollBar=viewportMain?.getScrollBar();scene.transformByState({width,height:actualHeight}),mainComponent?.resize(width,actualHeight),actualHeight>height?null==scrollBar?viewportMain&&new engine_render_src.$H1(viewportMain,{enableHorizontal:!1,barSize:8}):viewportMain?.resetCanvasSizeAndUpdateScroll():(scrollBar=null,viewportMain?.scrollToViewportPos({viewportScrollX:0,viewportScrollY:0}),viewportMain?.getScrollBar()?.dispose())}}function data_sync_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function data_sync_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}FormulaEditorController=function formula_editor_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([formula_editor_controller_ts_param(0,src.HCr),formula_editor_controller_ts_param(1,engine_render_src.cSx),formula_editor_controller_ts_param(2,editor_bridge_service_IEditorBridgeService),formula_editor_controller_ts_param(3,src.wTY),formula_editor_controller_ts_param(4,src.oaf),formula_editor_controller_ts_param(5,IFormulaEditorManagerService),formula_editor_controller_ts_param(6,src.$Dz),formula_editor_controller_ts_param(7,(0,src.y_5)(docs_src.pv)),formula_editor_controller_ts_param(8,editor_manager_service.I),formula_editor_controller_ts_metadata("design:type",Function),formula_editor_controller_ts_metadata("design:paramtypes",[void 0===src.HCr?Object:src.HCr,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===editor_bridge_service_IEditorBridgeService?Object:editor_bridge_service_IEditorBridgeService,void 0===src.wTY?Object:src.wTY,void 0===src.oaf?Object:src.oaf,void 0===IFormulaEditorManagerService?Object:IFormulaEditorManagerService,void 0===src.$Dz?Object:src.$Dz,void 0===docs_src.pv?Object:docs_src.pv,void 0===editor_manager_service.I?Object:editor_manager_service.I])],FormulaEditorController);const formulaEditorStyle={pageSize:{width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},documentFlavor:src.CQy.UNSPECIFIED,marginTop:5,marginBottom:5,marginRight:0,marginLeft:0,paragraphLineGapDefault:0,renderConfig:{horizontalAlign:src.wqs.UNSPECIFIED,verticalAlign:src.G4t.TOP,centerAngle:0,vertexAngle:0,wrapStrategy:src.sFy.WRAP,isRenderStyle:src.OdA.FALSE}};class EditorDataSyncController extends src.jGt{constructor(_univerInstanceService,_renderManagerService,_editorBridgeService,_commandService,_rangeProtectionRuleModel,_worksheetProtectionRuleModel,_formulaEditorController,_formulaEditorManagerService){super(),this._univerInstanceService=_univerInstanceService,this._renderManagerService=_renderManagerService,this._editorBridgeService=_editorBridgeService,this._commandService=_commandService,this._rangeProtectionRuleModel=_rangeProtectionRuleModel,this._worksheetProtectionRuleModel=_worksheetProtectionRuleModel,this._formulaEditorController=_formulaEditorController,this._formulaEditorManagerService=_formulaEditorManagerService,this._initialize()}_initialize(){this._syncFormulaEditorContent(),this._commandExecutedListener()}_getEditorViewModel(unitId){return this._renderManagerService.getRenderById(unitId)?.with(docs_src.EX).getViewModel()}_syncFormulaEditorContent(){this.disposeWithMe(this._editorBridgeService.currentEditCellState$.subscribe((editCellState=>{null!=editCellState&&!this._editorBridgeService.isForceKeepVisible()&&this._rangeProtectionRuleModel.getRangeRuleInitState()&&this._worksheetProtectionRuleModel.getSheetRuleInitState()&&this._editorSyncHandler(editCellState)})))}_editorSyncHandler(param){let body=src.S0q.deepClone(param.documentLayoutObject.documentModel?.getBody());const drawings=src.S0q.deepClone(param.documentLayoutObject.documentModel?.drawings),drawingsOrder=src.S0q.deepClone(param.documentLayoutObject.documentModel?.getDrawingsOrder());(!body||!0===param.isInArrayFormulaRange&&this._editorBridgeService.isVisible().eventType===engine_render_src.bKQ.Dblclick)&&(body={dataStream:"\r\n",paragraphs:[{startIndex:0}],textRuns:[]}),this._syncContentAndRender(src.azi,body,drawings,drawingsOrder)}_commandExecutedListener(){const INCLUDE_LIST=[src.Fmw,src.azi];this.disposeWithMe(this._commandService.onCommandExecuted((command=>{if(command.id===docs_src.Bz.id){const params=command.params,{unitId,trigger,isSync}=params;if(isSync||trigger===replace_content_command.e6.id)return;if(INCLUDE_LIST.includes(unitId)){const editorDocDataModel=this._univerInstanceService.getUnit(unitId,src.Zy$.UNIVER_DOC),syncId=unitId===src.azi?src.Fmw:src.azi;this._checkAndSetRenderStyleConfig(editorDocDataModel),this._syncActionsAndRender(syncId,params)}}})));const needUpdateFormulaEditorContentCommandList=[sheets_src.N48.id,sheets_src.o2G.id];this.disposeWithMe(this._commandService.onCommandExecuted((command=>{if(needUpdateFormulaEditorContentCommandList.includes(command.id)){const editCellState=this._editorBridgeService.getLatestEditCellState();if(null==editCellState)return;let needUpdate=!1;const{row,column}=editCellState;if(command.id===sheets_src.N48.id&&command.params){const params=command.params;params.cellValue?.[row]?.[column]&&(needUpdate=!0)}else if(command.id===sheets_src.o2G.id&&command.params){const params=command.params;params.to.value?.[row]?.[column]&&(needUpdate=!0)}if(needUpdate){const body=src.S0q.deepClone(editCellState.documentLayoutObject.documentModel?.getBody()),drawings=src.S0q.deepClone(editCellState.documentLayoutObject.documentModel?.drawings),drawingsOrder=src.S0q.deepClone(editCellState.documentLayoutObject.documentModel?.getDrawingsOrder());if(null==body)return;this._syncContentAndRender(src.azi,body,drawings,drawingsOrder)}}})))}_syncActionsAndRender(unitId,parmas){const INCLUDE_LIST=[src.Fmw,src.azi],currentRender=this._renderManagerService.getRenderById(unitId);if(null==currentRender)return;const skeleton=currentRender.with(docs_src.EX).getSkeleton(),docDataModel=this._univerInstanceService.getUnit(unitId,src.Zy$.UNIVER_DOC),docViewModel=this._getEditorViewModel(unitId);null!=docDataModel&&null!=docViewModel&&(this._commandService.syncExecuteCommand(docs_src.Bz.id,{...parmas,textRanges:null,isSync:!0,unitId,syncer:parmas.unitId}),docViewModel.reset(docDataModel),skeleton.calculate(),INCLUDE_LIST.includes(unitId)&&currentRender.mainComponent?.makeDirty())}_syncContentAndRender(unitId,body,drawings,drawingsOrder){unitId===src.azi&&body.paragraphs&&(body.paragraphs=this._clearParagraph(body.paragraphs));const INCLUDE_LIST=[src.Fmw,src.azi],skeleton=this._renderManagerService.getRenderById(unitId)?.with(docs_src.EX).getSkeleton(),docDataModel=this._univerInstanceService.getUnit(unitId,src.Zy$.UNIVER_DOC),docViewModel=this._getEditorViewModel(unitId);if(null==docDataModel||null==docViewModel||null==skeleton)return;docDataModel.getSnapshot().body=body,docDataModel.getSnapshot().drawings=drawings??{},docDataModel.getSnapshot().drawingsOrder=drawingsOrder??[],this._checkAndSetRenderStyleConfig(docDataModel),docViewModel.reset(docDataModel);const currentRender=this._renderManagerService.getRenderById(unitId);null!=currentRender&&(skeleton.calculate(),INCLUDE_LIST.includes(unitId)&&currentRender.mainComponent?.makeDirty(),unitId===src.azi&&this._formulaEditorController.autoScroll())}_checkAndSetRenderStyleConfig(documentDataModel){const snapshot=documentDataModel.getSnapshot(),{body}=snapshot;if(snapshot.id!==src.azi)return;snapshot.documentStyle=formulaEditorStyle;let renderConfig=snapshot.documentStyle.renderConfig;null==renderConfig&&(renderConfig={},snapshot.documentStyle.renderConfig=renderConfig);const position=this._formulaEditorManagerService.getPosition();if(position){const width=position.width;snapshot.documentStyle.pageSize={width,height:1/0}}(body?.dataStream??"").startsWith("=")?renderConfig.isRenderStyle=src.OdA.TRUE:renderConfig.isRenderStyle=src.OdA.FALSE}_clearParagraph(paragraphs){const newParagraphs=src.S0q.deepClone(paragraphs);for(const paragraph of newParagraphs)paragraph.paragraphStyle&&(paragraph.paragraphStyle.horizontalAlign=src.wqs.UNSPECIFIED);return newParagraphs}}function format_painter_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function format_painter_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}EditorDataSyncController=function data_sync_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([data_sync_controller_ts_param(0,src.HCr),data_sync_controller_ts_param(1,engine_render_src.cSx),data_sync_controller_ts_param(2,editor_bridge_service_IEditorBridgeService),data_sync_controller_ts_param(3,src.wTY),data_sync_controller_ts_param(4,(0,src.y_5)(sheets_src.qI9)),data_sync_controller_ts_param(5,(0,src.y_5)(sheets_src.$af)),data_sync_controller_ts_param(6,(0,src.y_5)(FormulaEditorController)),data_sync_controller_ts_param(7,IFormulaEditorManagerService),data_sync_controller_ts_metadata("design:type",Function),data_sync_controller_ts_metadata("design:paramtypes",[void 0===src.HCr?Object:src.HCr,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===editor_bridge_service_IEditorBridgeService?Object:editor_bridge_service_IEditorBridgeService,void 0===src.wTY?Object:src.wTY,void 0===sheets_src.qI9?Object:sheets_src.qI9,void 0===sheets_src.$af?Object:sheets_src.$af,void 0===FormulaEditorController?Object:FormulaEditorController,void 0===IFormulaEditorManagerService?Object:IFormulaEditorManagerService])],EditorDataSyncController);class FormatPainterController extends src.jGt{constructor(_commandService,_formatPainterService,_univerInstanceService,_renderManagerService,_selectionManagerService,_sheetInterceptorService,_injector){super(),this._commandService=_commandService,this._formatPainterService=_formatPainterService,this._univerInstanceService=_univerInstanceService,this._renderManagerService=_renderManagerService,this._selectionManagerService=_selectionManagerService,this._sheetInterceptorService=_sheetInterceptorService,this._injector=_injector,this._initialize()}_initialize(){this._addDefaultHook()}_addDefaultHook(){const defaultHook={id:"default-format-painter",priority:0,isDefaultHook:!0,onStatusChange:status=>{if(status!==FormatPainterStatus.OFF){const format=this._collectSelectionRangeFormat();format&&this._formatPainterService.setSelectionFormat(format)}},onApply:(unitId,subUnitId,range,format)=>this._getUndoRedoMutationInfo(unitId,subUnitId,range,format)};this._formatPainterService.addHook(defaultHook)}_collectSelectionRangeFormat(){const selection=this._selectionManagerService.getCurrentLastSelection(),range=selection?.range;if(!range)return null;const{startRow,endRow,startColumn,endColumn}=range,workbook=this._univerInstanceService.getCurrentUnitForType(src.Zy$.UNIVER_SHEET),worksheet=workbook?.getActiveSheet();if(!worksheet)return null;const cellData=worksheet.getCellMatrix(),styles=workbook.getStyles(),stylesMatrix=new src.hDc,merges=[];for(let r=startRow;r<=endRow;r++)for(let c=startColumn;c<=endColumn;c++){const cell=cellData.getValue(r,c);stylesMatrix.setValue(r,c,styles.getStyleByCell(cell)||{});const{isMergedMainCell,...mergeInfo}=worksheet.getCellInfoInMergeData(r,c);isMergedMainCell&&merges.push({startRow:mergeInfo.startRow,startColumn:mergeInfo.startColumn,endRow:mergeInfo.endRow,endColumn:mergeInfo.endColumn})}return{styles:stylesMatrix,merges}}_getUndoRedoMutationInfo(unitId,subUnitId,originRange,format){const sheetInterceptorService=this._sheetInterceptorService,univerInstanceService=this._univerInstanceService,{merges,styles:stylesMatrix}=format;if(!stylesMatrix)return{undos:[],redos:[]};const{startRow,startColumn,endRow,endColumn}=stylesMatrix.getDataRange(),styleRowsNum=endRow-startRow+1,styleColsNum=endColumn-startColumn+1,range=originRange.startRow===originRange.endRow&&originRange.startColumn===originRange.endColumn?{startRow:originRange.startRow,startColumn:originRange.startColumn,endRow:originRange.startRow+styleRowsNum-1,endColumn:originRange.startColumn+styleColsNum-1}:originRange,styleValues=Array.from({length:range.endRow-range.startRow+1},(()=>Array.from({length:range.endColumn-range.startColumn+1},(()=>({}))))),mergeRanges=[];styleValues.forEach(((row,rowIndex)=>{row.forEach(((col,colIndex)=>{const mappedRowIndex=rowIndex%styleRowsNum+startRow,mappedColIndex=colIndex%styleColsNum+startColumn,style=stylesMatrix.getValue(mappedRowIndex,mappedColIndex);style&&(styleValues[rowIndex][colIndex].s=Object.keys(style).length>0?style:null)}))})),merges.forEach((merge=>{const relatedRange_startRow=merge.startRow-startRow,relatedRange_startColumn=merge.startColumn-startColumn,relatedRange_endRow=merge.endRow-startRow,relatedRange_endColumn=merge.endColumn-startColumn,rowRepeats=Math.max(1,Math.floor((range.endRow-range.startRow+1)/styleRowsNum)),colRepeats=Math.max(1,Math.floor((range.endColumn-range.startColumn+1)/styleColsNum));for(let i=0;i<rowRepeats;i++)for(let j=0;j<colRepeats;j++)mergeRanges.push({startRow:relatedRange_startRow+i*styleRowsNum+range.startRow,startColumn:relatedRange_startColumn+j*styleColsNum+range.startColumn,endRow:relatedRange_endRow+i*styleRowsNum+range.startRow,endColumn:relatedRange_endColumn+j*styleColsNum+range.startColumn})}));const currentSelections=[range],clearCellValue=new src.hDc,cellValue=new src.hDc;if(src.S0q.isArray(styleValues))for(let i=0;i<currentSelections.length;i++){const{startRow,startColumn,endRow,endColumn}=currentSelections[i];for(let r=0;r<=endRow-startRow;r++)for(let c=0;c<=endColumn-startColumn;c++)clearCellValue.setValue(r+startRow,c+startColumn,{s:null}),cellValue.setValue(r+startRow,c+startColumn,styleValues[r][c])}const clearStyleMutationParams={subUnitId,unitId,cellValue:clearCellValue.getMatrix()},setRangeValuesMutationParams={subUnitId,unitId,cellValue:cellValue.getMatrix()},undoSetRangeValuesMutationParams=this._injector.invoke(sheets_src.hro,clearStyleMutationParams),{undos:interceptorUndos,redos:interceptorRedos}=sheetInterceptorService.onCommandExecute({id:sheets_src.NXV.id,params:{...setRangeValuesMutationParams,range:currentSelections}}),ranges=(0,sheets_src.h9R)(mergeRanges),mergeRedos=[],mergeUndos=[],worksheet=univerInstanceService.getUnit(unitId).getSheetBySheetId(subUnitId),willRemoveSomeCell=checkCellContentInRanges(worksheet,ranges),removeMergeMutationParams={unitId,subUnitId,ranges},addMergeMutationParams={unitId,subUnitId,ranges};mergeRedos.push({id:sheets_src._L3.id,params:removeMergeMutationParams}),mergeRedos.push({id:sheets_src.zo2.id,params:addMergeMutationParams});const undoRemoveMergeMutationParams=this._injector.invoke(sheets_src.IX1,removeMergeMutationParams),undoMutationParams=this._injector.invoke(sheets_src.PL,addMergeMutationParams);if(mergeUndos.push({id:sheets_src._L3.id,params:undoMutationParams}),mergeUndos.push({id:sheets_src.zo2.id,params:undoRemoveMergeMutationParams}),willRemoveSomeCell){const data=this._injector.invoke((accessor=>getClearContentMutationParamsForRanges(accessor,unitId,worksheet,ranges)));mergeRedos.unshift(...data.redos),mergeUndos.push(...data.undos)}return{undos:[{id:sheets_src.N48.id,params:clearStyleMutationParams},{id:sheets_src.N48.id,params:undoSetRangeValuesMutationParams},...interceptorUndos,...mergeUndos],redos:[{id:sheets_src.N48.id,params:clearStyleMutationParams},{id:sheets_src.N48.id,params:setRangeValuesMutationParams},...interceptorRedos,...mergeRedos]}}}function move_range_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function move_range_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}FormatPainterController=function format_painter_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([format_painter_controller_ts_param(0,src.wTY),format_painter_controller_ts_param(1,IFormatPainterService),format_painter_controller_ts_param(2,src.HCr),format_painter_controller_ts_param(3,engine_render_src.cSx),format_painter_controller_ts_param(4,(0,src.y_5)(sheets_src.Fal)),format_painter_controller_ts_param(5,(0,src.y_5)(sheets_src.e5R)),format_painter_controller_ts_param(6,(0,src.y_5)(src.zZn)),format_painter_controller_ts_metadata("design:type",Function),format_painter_controller_ts_metadata("design:paramtypes",[void 0===src.wTY?Object:src.wTY,void 0===IFormatPainterService?Object:IFormatPainterService,void 0===src.HCr?Object:src.HCr,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===sheets_src.e5R?Object:sheets_src.e5R,void 0===src.zZn?Object:src.zZn])],FormatPainterController);class MoveRangeRenderController extends src.jGt{constructor(_context,_selectionRenderService,_selectionManagerService,_commandService){super(),this._context=_context,this._selectionRenderService=_selectionRenderService,this._selectionManagerService=_selectionManagerService,this._commandService=_commandService,this._initialize=()=>{const disposableCollection=new src.VdD;this.disposeWithMe(this._selectionManagerService.selectionMoveEnd$.subscribe((()=>{disposableCollection.dispose();this._selectionRenderService.getSelectionControls().forEach((controlSelection=>{disposableCollection.add((0,src.saO)(controlSelection.selectionMoveEnd$.subscribe((_toRange=>{if(!_toRange)return;const _fromRange=controlSelection.model.getRange(),fromRange={startRow:_fromRange.startRow,startColumn:_fromRange.startColumn,endRow:_fromRange.endRow,endColumn:_fromRange.endColumn,rangeType:_fromRange.rangeType},toRange={startRow:_toRange.startRow,startColumn:_toRange.startColumn,endRow:_toRange.endRow,endColumn:_toRange.endColumn,rangeType:_fromRange.rangeType};if(fromRange.startRow===toRange.startRow&&fromRange.startColumn===toRange.startColumn)return;if(toRange.startRow<0||toRange.startColumn<0)return;const params={fromRange,toRange};this._commandService.executeCommand(sheets_src.Kft.id,params)}))))}))})))},this._initialize()}}function sheet_permission_init_ui_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}MoveRangeRenderController=function move_range_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([move_range_controller_ts_param(1,(0,src.y_5)(ISheetSelectionRenderService)),move_range_controller_ts_param(2,(0,src.y_5)(sheets_src.Fal)),move_range_controller_ts_param(3,(0,src.y_5)(src.wTY)),move_range_controller_ts_metadata("design:type",Function),move_range_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===ISheetSelectionRenderService?Object:ISheetSelectionRenderService,void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===src.wTY?Object:src.wTY])],MoveRangeRenderController);class SheetPermissionInitUIController extends src.jGt{constructor(_sheetPermissionInitController){super(),this._sheetPermissionInitController=_sheetPermissionInitController,this._initPermission()}_initPermission(){this._sheetPermissionInitController.initPermission()}}function clipboard_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function clipboard_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}SheetPermissionInitUIController=function sheet_permission_init_ui_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([function sheet_permission_init_ui_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}(0,(0,src.y_5)(sheets_src.TNT)),sheet_permission_init_ui_controller_ts_metadata("design:type",Function),sheet_permission_init_ui_controller_ts_metadata("design:paramtypes",[void 0===sheets_src.TNT?Object:sheets_src.TNT])],SheetPermissionInitUIController);class ClipboardRenderController extends src.jGt{constructor(_context,_sheetSkeletonManagerService,_sheetClipboardService,_sheetClipboardController){super(),this._context=_context,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._sheetClipboardService=_sheetClipboardService,this._sheetClipboardController=_sheetClipboardController,this._initialize()}_initialize(){this.disposeWithMe((0,src.saO)(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((skeleton=>{if(!skeleton?.unitId)return;if(!this._sheetClipboardService.getPasteMenuVisible())return;const pasteOptionsCache=this._sheetClipboardService.getPasteOptionsCache(),menuUnitId=pasteOptionsCache?.target.unitId;skeleton.unitId===menuUnitId&&this._sheetClipboardController.refreshOptionalPaste()}))))}}function contextmenu_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function contextmenu_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}ClipboardRenderController=function clipboard_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([clipboard_render_controller_ts_param(1,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),clipboard_render_controller_ts_param(2,ISheetClipboardService),clipboard_render_controller_ts_param(3,(0,src.y_5)(SheetClipboardController)),clipboard_render_controller_ts_metadata("design:type",Function),clipboard_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService,void 0===ISheetClipboardService?Object:ISheetClipboardService,void 0===SheetClipboardController?Object:SheetClipboardController])],ClipboardRenderController);class SheetContextMenuRenderController extends src.jGt{constructor(_context,_contextMenuService,_selectionManagerService,_selectionRenderService){super(),this._context=_context,this._contextMenuService=_contextMenuService,this._selectionManagerService=_selectionManagerService,this._selectionRenderService=_selectionRenderService,this._init()}_init(){const spreadsheetPointerDownObserver=this._context?.mainComponent?.onPointerDown$,spreadsheetSubscription=spreadsheetPointerDownObserver.subscribeEvent((event=>{if(2===event.button){const selections=this._selectionManagerService.getCurrentSelections(),currentSelection=selections?.[0];if(!currentSelection)return;const rangeType=currentSelection.range.rangeType,range=attachSelectionWithCoord(currentSelection,this._selectionRenderService.getSkeleton()).rangeWithCoord,triggerMenu=position=>{this._contextMenuService.triggerContextMenu(event,position)};(()=>{if(!range)return!1;const x=event.offsetX,y=event.offsetY;switch(rangeType){case src.$uV.ROW:return range.startY<=y&&range.endY>=y;case src.$uV.COLUMN:return range.startX<=x&&range.endX>=x;default:return range.startX<=x&&range.endX>=x&&range.startY<=y&&range.endY>=y}})()?rangeType===src.$uV.COLUMN?triggerMenu(ui_src.ai.COL_HEADER):rangeType===src.$uV.ROW?triggerMenu(ui_src.ai.ROW_HEADER):triggerMenu(ui_src.ai.MAIN_AREA):triggerMenu(ui_src.ai.MAIN_AREA)}}));this.disposeWithMe(spreadsheetSubscription);const spreadsheetColumnHeader=this._context.components.get(SHEET_VIEW_KEY.COLUMN),rowHeaderSub=this._context.components.get(SHEET_VIEW_KEY.ROW).onPointerDown$.subscribeEvent((event=>{2===event.button&&this._contextMenuService.triggerContextMenu(event,ui_src.ai.ROW_HEADER)}));this.disposeWithMe(rowHeaderSub);const colHeaderObserver=spreadsheetColumnHeader.onPointerDown$.subscribeEvent((event=>{2===event.button&&this._contextMenuService.triggerContextMenu(event,ui_src.ai.COL_HEADER)}));this.disposeWithMe(colHeaderObserver)}}function editor_bridge_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function editor_bridge_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}SheetContextMenuRenderController=function contextmenu_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([contextmenu_render_controller_ts_param(1,ui_src.ZL),contextmenu_render_controller_ts_param(2,(0,src.y_5)(sheets_src.Fal)),contextmenu_render_controller_ts_param(3,ISheetSelectionRenderService),contextmenu_render_controller_ts_metadata("design:type",Function),contextmenu_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===ui_src.ZL?Object:ui_src.ZL,void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===ISheetSelectionRenderService?Object:ISheetSelectionRenderService])],SheetContextMenuRenderController);class EditorBridgeRenderController extends src.hy_{constructor(_context,_instanceSrv,_commandService,_editorBridgeService,_selectionManagerService,_rangeSelectorService,_contextService,_renderManagerService,_editorService,_sheetSkeletonManagerService){super(),this._context=_context,this._instanceSrv=_instanceSrv,this._commandService=_commandService,this._editorBridgeService=_editorBridgeService,this._selectionManagerService=_selectionManagerService,this._rangeSelectorService=_rangeSelectorService,this._contextService=_contextService,this._renderManagerService=_renderManagerService,this._editorService=_editorService,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this.disposeWithMe(this._instanceSrv.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET).subscribe((workbook=>{workbook&&workbook.getUnitId()===this._context.unitId?this._d=this._init():this._disposeCurrent()}))),this._initialRangeSelector()}_init(){const d=new src.VdD;return this._initSelectionChangeListener(d),this._initEventListener(d),this._commandExecutedListener(d),this._initialKeyboardListener(d),d}_disposeCurrent(){this._d?.dispose(),this._d=null}_initSelectionChangeListener(d){d.add((0,observable_merge.h)(this._selectionManagerService.selectionMoveEnd$,this._selectionManagerService.selectionSet$,this._selectionManagerService.selectionMoveStart$).subscribe((params=>this._updateEditorPosition(params))))}_updateEditorPosition(params){if(this._editorBridgeService.isVisible().visible)return;if(this._rangeSelectorService.selectorModalVisible)return;const primary=params?.[params.length-1]?.primary;if(primary){const sheetObject=this._getSheetObject(),{scene,engine}=sheetObject,unitId=this._context.unitId,sheetId=this._context.unit.getActiveSheet()?.getSheetId();if(!sheetId)return;const mergeInfo=this._sheetSkeletonManagerService.getSkeletonParam(sheetId)?.skeleton.getCellWithCoordByIndex(primary.actualRow,primary.actualColumn),newPrimary=mergeInfo?{actualRow:mergeInfo.actualRow,actualColumn:mergeInfo.actualColumn,isMerged:mergeInfo.isMerged,startRow:mergeInfo.mergeInfo.startRow,startColumn:mergeInfo.mergeInfo.startColumn,endRow:mergeInfo.mergeInfo.endRow,endColumn:mergeInfo.mergeInfo.endColumn,isMergedMainCell:mergeInfo.isMergedMainCell}:primary;this._commandService.executeCommand(SetActivateCellEditOperation.id,{scene,engine,primary:newPrimary,unitId,sheetId})}}_initEventListener(d){const sheetObject=this._getSheetObject(),{spreadsheet,spreadsheetColumnHeader,spreadsheetLeftTopPlaceholder,spreadsheetRowHeader}=sheetObject;d.add(spreadsheet.onDblclick$.subscribeEvent((evt=>{2!==evt.button&&this._commandService.executeCommand(SetCellEditVisibleOperation.id,{visible:!0,eventType:engine_render_src.bKQ.Dblclick,unitId:this._context.unitId})}))),d.add(spreadsheet.onPointerDown$.subscribeEvent({next:this._tryHideEditor.bind(this),priority:-1})),d.add(spreadsheetColumnHeader.onPointerDown$.subscribeEvent({next:this._tryHideEditor.bind(this),priority:-1})),d.add(spreadsheetLeftTopPlaceholder.onPointerDown$.subscribeEvent({next:this._tryHideEditor.bind(this),priority:-1})),d.add(spreadsheetRowHeader.onPointerDown$.subscribeEvent({next:this._tryHideEditor.bind(this),priority:-1}))}_initialKeyboardListener(d){let disposable=null;const addEvent=render=>{const docSelectionRenderService=render.with(doc_selection_render_service.q);docSelectionRenderService&&(disposable=(0,src.saO)(docSelectionRenderService.onInputBefore$.subscribe((config=>{if(!this._isCurrentSheetFocused())return;const isFocusFormulaEditor=this._contextService.getContextValue(src.kgb),isFocusSheets=this._contextService.getContextValue(src.xU),unitId=render.unitId;this._editorBridgeService.isVisible().visible||unitId&&isFocusSheets&&!isFocusFormulaEditor&&this._showEditorByKeyboard(config)}))),d.add(disposable))},render=this._renderManagerService.getRenderById(src.Fmw);render?addEvent(render):this.disposeWithMe(this._renderManagerService.created$.pipe((0,filter.p)((render=>render.unitId===src.Fmw))).subscribe((render=>{disposable?.dispose(),addEvent(render)})))}_commandExecutedListener(d){const refreshCommandSet=new Set([sheets_src.igE.id,SetZoomRatioCommand.id]);d.add(this._commandService.onCommandExecuted((command=>{if(refreshCommandSet.has(command.id)){if(this._editorBridgeService.isVisible().visible)return;this._editorBridgeService.refreshEditCellState()}if(command.id===sheets_src.N48.id){const params=command.params,{cellValue,unitId,subUnitId}=params;if(!cellValue)return;const editCell=this._editorBridgeService.getEditLocation();if(editCell){const{unitId:editingUnitId,sheetId:editingSheetId,row,column}=editCell;unitId===editingUnitId&&subUnitId===editingSheetId&&cellValue&&cellValue[row]&&Object.prototype.hasOwnProperty.call(cellValue[row],column)&&this._editorBridgeService.refreshEditCellState()}}}))),d.add(this._commandService.beforeCommandExecuted(((command,options)=>{options?.fromCollab||command.id===sheets_src._M5.id&&this._tryHideEditor()})))}_showEditorByKeyboard(config){const event=config?.event;null==config||!event.data&&"InsertParagraph"!==event.inputType||this._commandService.syncExecuteCommand(SetCellEditVisibleOperation.id,{visible:!0,eventType:engine_render_src.bKQ.Keyboard,keycode:event.which,unitId:this._context.unitId})}_tryHideEditor(){this._editorBridgeService.isForceKeepVisible()||this._hideEditor()}_hideEditor(){!0===this._editorBridgeService.isVisible().visible&&this._commandService.syncExecuteCommand(SetCellEditVisibleOperation.id,{visible:!1,eventType:engine_render_src.bKQ.PointerDown,unitId:this._context.unitId})}_initialRangeSelector(){this.disposeWithMe(this._selectionManagerService.selectionMoving$.subscribe(this._rangeSelector.bind(this))),this.disposeWithMe(this._selectionManagerService.selectionMoveStart$.subscribe(this._rangeSelector.bind(this))),this.disposeWithMe(this._rangeSelectorService.openSelector$.subscribe((()=>{const{unitId,sheetId,sheetName}=this._getCurrentUnitIdAndSheetId();if(!sheetId||!sheetName)return;const selectionWithStyle=this._selectionManagerService.getCurrentSelections(),ranges=selectionWithStyle?.map((value=>({range:value.range,unitId,sheetId,sheetName})));ranges&&this._rangeSelectorService.selectionChange(ranges)})))}_rangeSelector(selectionWithStyle){if(!selectionWithStyle)return;const{unitId,sheetId,sheetName}=this._getCurrentUnitIdAndSheetId();if(!sheetId||!sheetName)return;const ranges=selectionWithStyle.map((value=>({range:value.range,unitId,sheetId,sheetName})));this._rangeSelectorService.selectionChange(ranges)}_getCurrentUnitIdAndSheetId(){const workbook=this._context.unit,worksheet=workbook.getActiveSheet();return{unitId:workbook.getUnitId(),sheetId:worksheet?.getSheetId(),sheetName:worksheet?.getName()}}_getSheetObject(){return getSheetObject(this._context.unit,this._context)}_isCurrentSheetFocused(){return this._instanceSrv.getFocusedUnit()?.getUnitId()===this._context.unitId}}EditorBridgeRenderController=function editor_bridge_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([editor_bridge_render_controller_ts_param(1,src.HCr),editor_bridge_render_controller_ts_param(2,src.wTY),editor_bridge_render_controller_ts_param(3,editor_bridge_service_IEditorBridgeService),editor_bridge_render_controller_ts_param(4,(0,src.y_5)(sheets_src.Fal)),editor_bridge_render_controller_ts_param(5,IRangeSelectorService),editor_bridge_render_controller_ts_param(6,src.oaf),editor_bridge_render_controller_ts_param(7,engine_render_src.cSx),editor_bridge_render_controller_ts_param(8,editor_manager_service.I),editor_bridge_render_controller_ts_param(9,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),editor_bridge_render_controller_ts_metadata("design:type",Function),editor_bridge_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===src.HCr?Object:src.HCr,void 0===src.wTY?Object:src.wTY,void 0===editor_bridge_service_IEditorBridgeService?Object:editor_bridge_service_IEditorBridgeService,void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===IRangeSelectorService?Object:IRangeSelectorService,void 0===src.oaf?Object:src.oaf,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===editor_manager_service.I?Object:editor_manager_service.I,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService])],EditorBridgeRenderController);var HEADER_MENU_SHAPE_TYPE=function(HEADER_MENU_SHAPE_TYPE){return HEADER_MENU_SHAPE_TYPE[HEADER_MENU_SHAPE_TYPE.NORMAL=0]="NORMAL",HEADER_MENU_SHAPE_TYPE[HEADER_MENU_SHAPE_TYPE.HIGHLIGHT=1]="HIGHLIGHT",HEADER_MENU_SHAPE_TYPE}({});class HeaderMenuShape extends engine_render_src.ypk{constructor(key,props){super(key,props),this._size=12,this._iconRatio=.4,this._mode=0,this.setShapeProps(props)}setShapeProps(props){props?.size&&(this._size=props.size),props?.mode&&(this._mode=props.mode),this.transformByState({width:this._size,height:this._size})}_draw(ctx){1===this._mode&&engine_render_src.rwV.drawWith(ctx,{width:this._size,height:this._size,radius:this._size,fill:"rgba(0, 0, 0, 0.15)"});const iconSize=.5*this._size*this._iconRatio,sixtyDegree=Math.PI/180*60,left=iconSize*Math.sin(sixtyDegree),top=iconSize*Math.cos(sixtyDegree);engine_render_src.Rpp.drawWith(ctx,{pointsGroup:[[{x:-left+this._size/2,y:-top+this._size/2},{x:left+this._size/2,y:-top+this._size/2},{x:this._size/2,y:iconSize+this._size/2}]],fill:"rgb(0, 0, 0)"})}}function header_menu_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function header_menu_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class HeaderMenuRenderController extends src.jGt{constructor(_context,_sheetSkeletonManagerService,_contextMenuService,_commandService,_selectionManagerService){super(),this._context=_context,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._contextMenuService=_contextMenuService,this._commandService=_commandService,this._selectionManagerService=_selectionManagerService,this._currentColumn=Number.POSITIVE_INFINITY,this._initialize()}dispose(){this._hoverRect?.dispose(),this._hoverMenu?.dispose(),this._headerPointerSubs?.unsubscribe(),this._headerPointerSubs=null}_initialize(){const scene=this._context.scene;this._hoverRect=new engine_render_src.rwV("__SpreadsheetHeaderMenuSHAPEControllerShape__",{fill:"rgba(0, 0, 0, 0.1)",evented:!1}),this._hoverMenu=new HeaderMenuShape("__SpreadsheetHeaderMenuMAINControllerShape__",{zIndex:100,visible:!1}),scene.addObjects([this._hoverRect,this._hoverMenu],10),this._initialHover(0),this._initialHover(1),this._initialHoverMenu()}_initialHover(initialType=0){const spreadsheetColumnHeader=this._context.components.get(SHEET_VIEW_KEY.COLUMN),spreadsheetRowHeader=this._context.components.get(SHEET_VIEW_KEY.ROW),eventBindingObject=0===initialType?spreadsheetRowHeader:spreadsheetColumnHeader;this._headerPointerSubs=new Subscription.yU;const headerPointerMoveSub=eventBindingObject.onPointerMove$.subscribeEvent((evt=>{const skeleton=this._sheetSkeletonManagerService.getCurrentParam()?.skeleton;if(null==skeleton)return;const{rowHeaderWidth,columnHeaderHeight}=skeleton,{startX,startY,endX,endY,column}=getCoordByOffset(evt.offsetX,evt.offsetY,this._context.scene,skeleton);if(0===initialType)this._hoverRect?.transformByState({width:rowHeaderWidth,height:endY-startY,left:0,top:startY});else{if(this._currentColumn=column,this._hoverRect?.transformByState({width:endX-startX,height:columnHeaderHeight,left:startX,top:0}),null==this._hoverMenu)return;if(endX-startX<2*columnHeaderHeight)return void this._hoverMenu.hide();const menuSize=.8*columnHeaderHeight;this._hoverMenu.transformByState({left:endX-columnHeaderHeight,top:columnHeaderHeight/2-menuSize/2}),this._hoverMenu.setShapeProps({size:menuSize}),this._hoverMenu.show()}})),headerPointerEnterSub=eventBindingObject.onPointerEnter$.subscribeEvent((()=>{this._hoverRect?.show()})),headerPointerLeaveSub=eventBindingObject.onPointerLeave$.subscribeEvent((()=>{this._hoverRect?.hide(),this._hoverMenu?.hide()}));this._headerPointerSubs?.add(headerPointerMoveSub),this._headerPointerSubs?.add(headerPointerEnterSub),this._headerPointerSubs?.add(headerPointerLeaveSub)}_initialHoverMenu(){null!=this._hoverMenu&&(this._hoverMenu.onPointerEnter$.subscribeEvent((()=>{null!=this._hoverMenu&&(this._hoverMenu.setProps({mode:HEADER_MENU_SHAPE_TYPE.HIGHLIGHT,visible:!0}),this._context.scene.setCursor(engine_render_src.MBo.POINTER))})),this._hoverMenu.onPointerLeave$.subscribeEvent((()=>{null!=this._hoverMenu&&(this._hoverMenu.setProps({mode:HEADER_MENU_SHAPE_TYPE.NORMAL,visible:!1}),this._context.scene.resetCursor())})),this._hoverMenu.onPointerDown$.subscribeEvent((evt=>{const currentColumn=this._currentColumn,currentSelectionDatas=this._selectionManagerService.getCurrentSelections()?.map((s=>s.range));if(!!!currentSelectionDatas?.filter((range=>range.rangeType===src.$uV.COLUMN)).find((data=>{const{startColumn,endColumn}=data;return currentColumn>=startColumn&&currentColumn<=endColumn}))){const selection=this._getSelectionOnColumn(currentColumn);this._commandService.syncExecuteCommand(sheets_src.NSB.id,selection)}evt.stopPropagation(),evt.preventDefault(),this._contextMenuService.triggerContextMenu(evt,ui_src.ai.COL_HEADER)})))}_getSelectionOnColumn(column){const workbook=this._context.unit,worksheet=workbook.getActiveSheet();if(!worksheet)throw new Error("No active worksheet");return{unitId:workbook.getUnitId(),subUnitId:worksheet.getSheetId(),selections:[{range:{startRow:0,startColumn:column,endRow:worksheet.getRowCount()-1,endColumn:column,rangeType:src.$uV.COLUMN},primary:{startRow:0,startColumn:column,endRow:0,endColumn:column,actualRow:0,actualColumn:column,isMerged:!1,isMergedMainCell:!1},style:null}]}}}HeaderMenuRenderController=function header_menu_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([header_menu_render_controller_ts_param(1,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),header_menu_render_controller_ts_param(2,ui_src.ZL),header_menu_render_controller_ts_param(3,src.wTY),header_menu_render_controller_ts_param(4,(0,src.y_5)(sheets_src.Fal)),header_menu_render_controller_ts_metadata("design:type",Function),header_menu_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService,void 0===ui_src.ZL?Object:ui_src.ZL,void 0===src.wTY?Object:src.wTY,void 0===sheets_src.Fal?Object:sheets_src.Fal])],HeaderMenuRenderController);var HeaderUnhideShapeType=function(HeaderUnhideShapeType){return HeaderUnhideShapeType[HeaderUnhideShapeType.ROW=0]="ROW",HeaderUnhideShapeType[HeaderUnhideShapeType.COLUMN=1]="COLUMN",HeaderUnhideShapeType}({});class HeaderUnhideShape extends engine_render_src.ypk{constructor(key,props,onClick){super(key,props),this._size=12,this._iconRatio=.4,this._hovered=!0,this._hasPrevious=!0,this._hasNext=!0,props&&this.setShapeProps(props),this.onPointerEnter$.subscribeEvent((()=>this.setShapeProps({hovered:!0}))),this.onPointerLeave$.subscribeEvent((()=>this.setShapeProps({hovered:!1}))),this.onPointerDown$.subscribeEvent((()=>onClick?.()))}setShapeProps(props){void 0!==props.type&&(this._unhideType=props.type),void 0!==props.hovered&&(this._hovered=props.hovered),void 0!==props.hasPrevious&&(this._hasPrevious=props.hasPrevious),void 0!==props.hasNext&&(this._hasNext=props.hasNext),this.transformByState({width:this._size*(1===this._unhideType?2:1),height:this._size*(0===this._unhideType?2:1)})}_draw(ctx){0===this._unhideType?this._drawOnRow(ctx):this._drawOnCol(ctx)}_drawOnRow(ctx){this._hovered&&(this._hasNext&&this._hasPrevious?engine_render_src.rwV.drawWith(ctx,{width:this._size,height:2*this._size,stroke:"rgb(0, 0, 0)",fill:"rgb(255, 255, 255, 1)"}):engine_render_src.rwV.drawWith(ctx,{width:this._size,height:this._size,stroke:"rgb(0, 0, 0)",fill:"rgb(255, 255, 255, 1)"}));const iconSize=.5*this._size*this._iconRatio,sixtyDegree=Math.PI/3,top=iconSize*Math.cos(sixtyDegree),left=iconSize*Math.sin(sixtyDegree);if(this._hasPrevious&&engine_render_src.Rpp.drawWith(ctx,{pointsGroup:[[{x:this._size/2,y:this._size/2-left},{x:this._size/2-left,y:this._size/2+top},{x:this._size/2+left,y:this._size/2+top}]],fill:"rgb(0, 0, 0)"}),this._hasNext){const offset=this._hasPrevious?3:1;engine_render_src.Rpp.drawWith(ctx,{pointsGroup:[[{x:this._size/2,y:this._size*offset/2+left},{x:this._size/2-left,y:this._size*offset/2-top},{x:this._size/2+left,y:this._size*offset/2-top}]],fill:"rgb(0, 0, 0)"})}}_drawOnCol(ctx){this._hovered&&(this._hasNext&&this._hasPrevious?engine_render_src.rwV.drawWith(ctx,{width:2*this._size,height:this._size,stroke:"rgb(0, 0, 0)",fill:"rgb(255, 255, 255, 1)"}):engine_render_src.rwV.drawWith(ctx,{width:this._size,height:this._size,stroke:"rgb(0, 0, 0)",fill:"rgb(255, 255, 255, 1)"}));const iconSize=.5*this._size*this._iconRatio,sixtyDegree=Math.PI/3,top=iconSize*Math.cos(sixtyDegree),left=iconSize*Math.sin(sixtyDegree);if(this._hasPrevious&&engine_render_src.Rpp.drawWith(ctx,{pointsGroup:[[{x:-top+this._size/2,y:this._size/2},{x:this._size/2+left,y:this._size/2-left},{x:this._size/2+left,y:this._size/2+left}]],fill:"rgb(0, 0, 0)"}),this._hasNext){const offset=this._hasPrevious?3:1;engine_render_src.Rpp.drawWith(ctx,{pointsGroup:[[{x:top+this._size*offset/2,y:this._size/2},{x:-left+this._size*offset/2,y:this._size/2-left},{x:-left+this._size*offset/2,y:this._size/2+left}]],fill:"rgb(0, 0, 0)"})}}}function header_unhide_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function header_unhide_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}class HeaderUnhideRenderController extends src.hy_{get _workbook(){return this._context.unit}constructor(_context,_sheetSkeletonManagerService,_commandService){super(),this._context=_context,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._commandService=_commandService,this._shapes={cols:[],rows:[]},this._init()}dispose(){super.dispose(),this._clearShapes()}_init(){let activeSheetId="";this._context.unit.activeSheet$.pipe((0,takeUntil.Q)(this.dispose$)).subscribe((worksheet=>{this._clearShapes(),worksheet?(activeSheetId=worksheet.getSheetId(),this._update(this._workbook,worksheet)):activeSheetId=""})),this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((param=>{if(param){const{unitId,sheetId}=param;if(unitId===this._workbook.getUnitId()&&sheetId===activeSheetId){const worksheet=this._workbook.getSheetBySheetId(sheetId);worksheet&&this._update(this._workbook,worksheet)}}})))}_update(workbook,worksheet){const skeleton=this._sheetSkeletonManagerService.getSkeletonParam(worksheet.getSheetId())?.skeleton;if(!skeleton)return;const hiddenRowRanges=worksheet.getHiddenRows(),hiddenColRanges=worksheet.getHiddenCols(),sheetObject=this._getSheetObject(),{scene}=sheetObject,rowCount=worksheet.getRowCount(),rowShapes=hiddenRowRanges.map((range=>{const{startRow,endRow}=range,position=getCoordByCell(startRow,0,0,skeleton),hasPrevious=0!==startRow,hasNext=endRow!==rowCount-1;return new HeaderUnhideShape("__SpreadsheetHeaderUnhideSHAPEControllerShape__",{type:HeaderUnhideShapeType.ROW,hovered:!1,hasPrevious,hasNext,top:position.startY-(hasPrevious?12:0),left:position.startX-12},(()=>this._commandService.executeCommand(sheets_src.dMo.id,{unitId:workbook.getUnitId(),subUnitId:worksheet.getSheetId(),ranges:[range]})))})),colCount=worksheet.getColumnCount(),colShapes=hiddenColRanges.map((range=>{const{startColumn,endColumn}=range,position=getCoordByCell(0,startColumn,0,skeleton),hasPrevious=0!==startColumn,hasNext=endColumn!==colCount-1;return new HeaderUnhideShape("__SpreadsheetHeaderUnhideSHAPEControllerShape__",{type:HeaderUnhideShapeType.COLUMN,hovered:!1,hasPrevious,hasNext,top:8,left:position.startX-(hasPrevious?12:0)},(()=>this._commandService.executeCommand(sheets_src.d7m.id,{unitId:workbook.getUnitId(),subUnitId:worksheet.getSheetId(),ranges:[range]})))}));scene.addObjects(colShapes,12),scene.addObjects(rowShapes,12),this._clearShapes(),this._shapes={cols:colShapes,rows:rowShapes}}_clearShapes(){this._shapes.cols.forEach((shape=>shape.dispose())),this._shapes.rows.forEach((shape=>shape.dispose())),this._shapes={cols:[],rows:[]}}_getSheetObject(){return getSheetObject(this._workbook,this._context)}}function skeleton_render_controller_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function skeleton_render_controller_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}HeaderUnhideRenderController=function header_unhide_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([header_unhide_render_controller_ts_param(1,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),header_unhide_render_controller_ts_param(2,src.wTY),header_unhide_render_controller_ts_metadata("design:type",Function),header_unhide_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService,void 0===src.wTY?Object:src.wTY])],HeaderUnhideRenderController);class SheetSkeletonRenderController extends src.jGt{constructor(_context,_sheetSkeletonManagerService,_renderManagerService){super(),this._context=_context,this._sheetSkeletonManagerService=_sheetSkeletonManagerService,this._renderManagerService=_renderManagerService,this.disposeWithMe(this._context.unit.sheetDisposed$.subscribe((sheet=>{this._sheetSkeletonManagerService.disposeSkeleton(sheet.getSheetId())}))),this._sheetSkeletonManagerService.currentSkeleton$.subscribe((param=>{this._updateSceneSize(param)}))}_updateSceneSize(param){if(null==param)return;const{unitId}=this._context,{skeleton}=param,scene=this._renderManagerService.getRenderById(unitId)?.scene;if(null==skeleton||null==scene)return;const{rowTotalHeight,columnTotalWidth,rowHeaderWidthAndMarginLeft,columnHeaderHeightAndMarginTop}=skeleton;this._context.unit.getActiveSheet()&&scene?.transformByState({width:rowHeaderWidthAndMarginLeft+columnTotalWidth,height:columnHeaderHeightAndMarginTop+rowTotalHeight})}}function selection_render_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function selection_render_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}SheetSkeletonRenderController=function skeleton_render_controller_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([skeleton_render_controller_ts_param(1,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),skeleton_render_controller_ts_param(2,engine_render_src.cSx),skeleton_render_controller_ts_metadata("design:type",Function),skeleton_render_controller_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService,void 0===engine_render_src.cSx?Object:engine_render_src.cSx])],SheetSkeletonRenderController);class SheetSelectionRenderService extends BaseSelectionRenderService{constructor(_context,injector,themeService,shortcutService,selectionManagerService,sheetSkeletonManagerService,_logService,_commandService,_contextService){super(injector,themeService,shortcutService,sheetSkeletonManagerService,_contextService),this._context=_context,this._logService=_logService,this._commandService=_commandService,this._contextService=_contextService,this._renderDisposable=null,this._workbookSelections=selectionManagerService.getWorkbookSelections(this._context.unitId),this._init()}_init(){const sheetObject=this._getSheetObject();this._contextService.setContextValue(sheets_src.a_m,!0),this._initEventListeners(sheetObject),this._initSelectionModelChangeListener(),this._initThemeChangeListener(),this._initSkeletonChangeListener(),this._initUserActionSyncListener()}_initEventListeners(sheetObject){const{spreadsheetRowHeader,spreadsheetColumnHeader,spreadsheet,spreadsheetLeftTopPlaceholder}=sheetObject,{scene}=this._context;this.disposeWithMe(spreadsheet?.onPointerDown$.subscribeEvent(((evt,state)=>{this.isSelectionDisabled()||this.inRefSelectionMode()||(this._onPointerDown(evt,spreadsheet.zIndex+1,src.$uV.NORMAL,this._getActiveViewport(evt)),2!==evt.button&&state.stopPropagation())}))),this.disposeWithMe(spreadsheetRowHeader?.onPointerDown$.subscribeEvent(((evt,state)=>{if(this.isSelectionDisabled())return;if(this.inRefSelectionMode())return;const skeleton=this._sheetSkeletonManagerService.getCurrentParam().skeleton,{row}=getCoordByOffset(evt.offsetX,evt.offsetY,scene,skeleton);isThisRowSelected(this._workbookSelections.getCurrentSelections(),row)||(this._onPointerDown(evt,(spreadsheet.zIndex||1)+1,src.$uV.ROW,this._getActiveViewport(evt),engine_render_src.rDM.Y),2!==evt.button&&state.stopPropagation())}))),this.disposeWithMe(spreadsheetColumnHeader?.onPointerDown$.subscribeEvent(((evt,state)=>{if(this.isSelectionDisabled())return;if(this.inRefSelectionMode())return;const skeleton=this._sheetSkeletonManagerService.getCurrentParam().skeleton,{column}=getCoordByOffset(evt.offsetX,evt.offsetY,scene,skeleton);isThisColSelected(this._workbookSelections.getCurrentSelections(),column)||(this._onPointerDown(evt,(spreadsheet.zIndex||1)+1,src.$uV.COLUMN,this._getActiveViewport(evt),engine_render_src.rDM.X),2!==evt.button&&state.stopPropagation())}))),this.disposeWithMe(spreadsheetLeftTopPlaceholder?.onPointerDown$.subscribeEvent(((evt,state)=>{if(this.isSelectionDisabled())return;if(this.inRefSelectionMode())return;this._reset();const selectionWithStyle=selectionDataForSelectAll(this._sheetSkeletonManagerService.getCurrentParam().skeleton);this._addSelectionControlByModelData(selectionWithStyle),this.refreshSelectionMoveEnd(),2!==evt.button&&state.stopPropagation()})))}_initThemeChangeListener(){this.disposeWithMe(this._themeService.currentTheme$.subscribe((()=>{this._initSelectionThemeFromThemeService();const selections=this._workbookSelections.getCurrentSelections();selections&&this.resetSelectionsByModelData(selections)})))}_initSelectionModelChangeListener(){this.disposeWithMe((0,observable_merge.h)(this._workbookSelections.selectionMoveEnd$,this._workbookSelections.selectionSet$).subscribe((selectionWithStyleList=>{this.resetSelectionsByModelData(selectionWithStyleList)})))}disableSelection(){this._contextService.setContextValue(sheets_src.a_m,!1)}enableSelection(){this._contextService.setContextValue(sheets_src.a_m,!0)}transparentSelection(){this.setSelectionTheme({primaryColor:"transparent"});const selectionsWithStyle=this._workbookSelections.getCurrentSelections();for(let index=0;index<selectionsWithStyle.length;index++){selectionsWithStyle[index].style=genNormalSelectionStyle(this._selectionTheme)}this.resetSelectionsByModelData(selectionsWithStyle)}showSelection(){const currTheme=this._themeService.getCurrentTheme();this.setSelectionTheme(currTheme);const selectionsWithStyle=this._workbookSelections.getCurrentSelections();for(let index=0;index<selectionsWithStyle.length;index++){const selectionWithStyle=selectionsWithStyle[index];selectionWithStyle.style&&(selectionWithStyle.style=genNormalSelectionStyle(this._selectionTheme))}this.resetSelectionsByModelData(selectionsWithStyle)}_initUserActionSyncListener(){this.disposeWithMe(this.selectionMoveStart$.subscribe((params=>this._updateSelections(params,sheets_src.kFf.MOVE_START)))),this.disposeWithMe(this.selectionMoving$.subscribe((params=>this._updateSelections(params,sheets_src.kFf.MOVING)))),this.disposeWithMe(this._contextService.subscribeContextValue$(sheets_src.C5D).pipe((0,operators_startWith.Z)(!1),(0,distinctUntilChanged.F)()).subscribe((enabled=>{enabled&&this._reset()}))),this.disposeWithMe(this._contextService.subscribeContextValue$(sheets_src.a_m).pipe((0,operators_startWith.Z)(!0),(0,distinctUntilChanged.F)()).subscribe((enabled=>{enabled?this._renderDisposable=(0,src.saO)(this.selectionMoveEnd$.subscribe((params=>{this._updateSelections(params,sheets_src.kFf.MOVE_END)}))):(this._renderDisposable?.dispose(),this._renderDisposable=null,this._reset())})))}_updateSelections(selectionDataWithStyleList,type){const workbook=this._context.unit,unitId=workbook.getUnitId(),sheetId=workbook.getActiveSheet().getSheetId();if(0===selectionDataWithStyleList.length)return;const selectionWithStyles=selectionDataWithStyleList.map((selectionDataWithStyle=>(0,sheets_src.Y9H)(selectionDataWithStyle)));this._commandService.executeCommand(sheets_src.NSB.id,{unitId,subUnitId:sheetId,type,selections:selectionWithStyles})}_initSkeletonChangeListener(){this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((param=>{if(null==param)return void this._logService.error("[SelectionRenderService]: should not receive null!");const unitId=this._context.unitId,{sheetId,skeleton}=param,{scene}=this._context,viewportMain=scene.getViewport(engine_render_src.p3k.VIEW_MAIN),prevSheetId=this._skeleton?.worksheet?.getSheetId();if(this._changeRuntime(skeleton,scene,viewportMain),prevSheetId!==skeleton.worksheet.getSheetId()){const selections=this._workbookSelections.getCurrentSelections();this._commandService.syncExecuteCommand(sheets_src.NSB.id,{unitId,subUnitId:sheetId,selections:0!==selections.length?selections:[getTopLeftSelectionOfCurrSheet(skeleton)]})}const currentSelections=this._workbookSelections.getCurrentSelections();null!=currentSelections&&this.resetSelectionsByModelData(currentSelections)})))}_getActiveViewport(evt){const sheetObject=this._getSheetObject();return sheetObject?.scene.getActiveViewportByCoord(engine_render_src.I9Y.FromArray([evt.offsetX,evt.offsetY]))}_getSheetObject(){return getSheetObject(this._context.unit,this._context)}_onPointerDown(evt,_zIndex=0,rangeType=src.$uV.NORMAL,viewport,scrollTimerType=engine_render_src.rDM.ALL){this._rangeType=rangeType;const skeleton=this._skeleton,scene=this._scene;if(!scene||!skeleton)return;viewport&&(this._activeViewport=viewport);const{offsetX:evtOffsetX,offsetY:evtOffsetY}=evt,viewportMain=scene.getViewport(engine_render_src.p3k.VIEW_MAIN);if(!viewportMain)return;const relativeCoords=scene.getCoordRelativeToViewport(engine_render_src.I9Y.FromArray([evtOffsetX,evtOffsetY])),{x:offsetX,y:offsetY}=relativeCoords;this._startViewportPosX=offsetX,this._startViewportPosY=offsetY;const scrollXY=scene.getScrollXYInfoByViewport(relativeCoords),{scaleX,scaleY}=scene.getAncestorScale(),selectCell=this._skeleton.getCellByOffset(offsetX,offsetY,scaleX,scaleY,scrollXY);if(!selectCell)return;switch(rangeType){case src.$uV.NORMAL:break;case src.$uV.ROW:selectCell.startColumn=0,selectCell.endColumn=this._skeleton.getColumnCount()-1,selectCell.startRow=selectCell.actualRow,selectCell.endRow=selectCell.actualRow;break;case src.$uV.COLUMN:selectCell.startRow=0,selectCell.endRow=this._skeleton.getRowCount()-1,selectCell.startColumn=selectCell.actualColumn,selectCell.endColumn=selectCell.actualColumn;break;case src.$uV.ALL:selectCell.startRow=0,selectCell.startColumn=0,selectCell.endRow=this._skeleton.getRowCount()-1,selectCell.endColumn=this._skeleton.getColumnCount()-1}const selectionWithStyle={range:selectCell,primary:selectCell,style:null};selectionWithStyle.range.rangeType=rangeType;const selectionCellWithCoord=attachSelectionWithCoord(selectionWithStyle,this._skeleton);this._startRangeWhenPointerDown={...selectionCellWithCoord.rangeWithCoord};let activeSelectionControl=this.getActiveSelectionControl();const cursorRangeWidthCoord={...selectionCellWithCoord.rangeWithCoord,rangeType},curControls=this.getSelectionControls();for(const control of curControls)if(2===evt.button&&src.M_G.contains(control.model,cursorRangeWidthCoord))return void(activeSelectionControl=control);this._checkClearPreviousControls(evt);const currentCell=activeSelectionControl?.model.currentCell,expandByShiftKey=evt.shiftKey&&currentCell,remainLastEnable=this._remainLastEnabled&&!evt.ctrlKey&&!evt.shiftKey&&!this._skipLastEnabled&&!this._singleSelectionEnabled;expandByShiftKey&&currentCell?this._makeSelectionByTwoCells(currentCell,cursorRangeWidthCoord,skeleton,rangeType,activeSelectionControl):remainLastEnable&&activeSelectionControl?activeSelectionControl.updateRangeBySelectionWithCoord(selectionCellWithCoord):activeSelectionControl=this.newSelectionControl(scene,skeleton,selectionWithStyle);for(let i=0;i<this.getSelectionControls().length-1;i++)this.getSelectionControls()[i].clearHighlight();scene.disableObjectsEvent(),this._clearUpdatingListeners(),this._addEndingListeners(),scene.getTransformer()?.clearSelectedObjects(),this._setupPointerMoveListener(viewportMain,activeSelectionControl,rangeType,scrollTimerType,offsetX,offsetY),this._escapeShortcutDisposable=this._shortcutService.forceEscape(),this._selectionMoveStart$.next(this.getSelectionDataWithStyle()),this._scenePointerUpSub=scene.onPointerUp$.subscribeEvent((()=>{this._clearUpdatingListeners(),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()),this._escapeShortcutDisposable?.dispose(),this._escapeShortcutDisposable=null})),this._scene.getEngine()?.setCapture()}}function src_plugin_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function src_plugin_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}SheetSelectionRenderService=function selection_render_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([selection_render_service_ts_param(1,(0,src.y_5)(src.zZn)),selection_render_service_ts_param(2,(0,src.y_5)(src.Fsb)),selection_render_service_ts_param(3,ui_src.nF),selection_render_service_ts_param(4,(0,src.y_5)(sheets_src.Fal)),selection_render_service_ts_param(5,(0,src.y_5)(sheet_skeleton_manager_service_SheetSkeletonManagerService)),selection_render_service_ts_param(6,src.rrK),selection_render_service_ts_param(7,src.wTY),selection_render_service_ts_param(8,src.oaf),selection_render_service_ts_metadata("design:type",Function),selection_render_service_ts_metadata("design:paramtypes",["undefined"==typeof IRenderContext?Object:IRenderContext,void 0===src.zZn?Object:src.zZn,void 0===src.Fsb?Object:src.Fsb,void 0===ui_src.nF?Object:ui_src.nF,void 0===sheets_src.Fal?Object:sheets_src.Fal,void 0===sheet_skeleton_manager_service_SheetSkeletonManagerService?Object:sheet_skeleton_manager_service_SheetSkeletonManagerService,void 0===src.rrK?Object:src.rrK,void 0===src.wTY?Object:src.wTY,void 0===src.oaf?Object:src.oaf])],SheetSelectionRenderService);class UniverSheetsUIPlugin extends src.k_1{static#_=this.pluginName="SHEET_UI_PLUGIN";static#_2=this.type=src.Zy$.UNIVER_SHEET;constructor(_config=controllers_config_schema_defaultPluginConfig,_injector,_renderManagerService,_configService,_univerInstanceService){super(),this._config=_config,this._injector=_injector,this._renderManagerService=_renderManagerService,this._configService=_configService,this._univerInstanceService=_univerInstanceService;const{menu,...rest}=(0,src.h1I)({},controllers_config_schema_defaultPluginConfig,this._config);menu&&this._configService.setConfig("menu",menu,{merge:!0}),this._configService.setConfig("sheets-ui.config",rest)}onStarting(){(0,src.tMf)(this._injector,(0,src.afw)([[ShortcutExperienceService],[editor_bridge_service_IEditorBridgeService,{useClass:EditorBridgeService}],[ISheetClipboardService,{useClass:SheetClipboardService}],[ISheetBarService,{useClass:SheetBarService}],[IFormatPainterService,{useClass:FormatPainterService}],[ICellEditorManagerService,{useClass:CellEditorManagerService}],[IFormulaEditorManagerService,{useClass:FormulaEditorManagerService}],[sheets_src.BcG,{useClass:sheets_src.mOY}],[IAutoFillService,{useClass:AutoFillService}],[SheetPrintInterceptorService],[IStatusBarService,{useClass:StatusBarService}],[IMarkSelectionService,{useClass:MarkSelectionService}],[HoverManagerService],[DragManagerService],[SheetCanvasPopManagerService],[CellAlertManagerService],[SelectAllService],[ActiveWorksheetController],[AutoHeightController],[AutoWidthController],[FormulaEditorController],[SheetsRenderService],[SheetUIController],[StatusBarController],[AutoFillController],[FormatPainterController],[SheetsDefinedNameController],[EditorDataSyncController],[SheetCheckboxController],[SheetPermissionPanelModel],[SheetPermissionInitUIController],[SheetPermissionUserManagerService],[SheetPermissionInterceptorClipboardController],[SheetPermissionCheckUIController],[SheetPermissionRenderManagerController]],this._config.override))}onReady(){this._config.disableAutoFocus||this._initAutoFocus(),(0,src.tMf)(this._injector,[[SheetClipboardController]]),this._registerRenderBasics(),(0,src.HLP)(this._injector,[[SheetUIController],[SheetsRenderService],[ActiveWorksheetController],[SheetPermissionCheckUIController],[SheetPermissionInitUIController]])}onRendered(){this._registerRenderModules(),(0,src.HLP)(this._injector,[[SheetPermissionRenderManagerController],[SheetPermissionPanelModel],[SheetClipboardController],[FormulaEditorController],[SheetsDefinedNameController],[StatusBarController],[AutoHeightController],[AutoWidthController],[EditorDataSyncController],[SheetCheckboxController]])}onSteady(){(0,src.HLP)(this._injector,[[FormatPainterController],[AutoFillController],[SheetPermissionInterceptorClipboardController]])}_registerRenderBasics(){[[sheet_skeleton_manager_service_SheetSkeletonManagerService],[SheetSkeletonRenderController],[SheetRenderController],[ISheetSelectionRenderService,{useClass:SheetSelectionRenderService}]].forEach((m=>{this.disposeWithMe(this._renderManagerService.registerRenderModule(src.Zy$.UNIVER_SHEET,m))}))}_registerRenderModules(){const modules=[[HeaderMoveRenderController],[HeaderUnhideRenderController],[HeaderResizeRenderController],[SheetScrollManagerService],[SheetsScrollRenderController],[HeaderFreezeRenderController],[SheetsZoomRenderController],[SheetCellEditorResizeService],[FormatPainterRenderController],[ClipboardRenderController],[CellAlertRenderController],[ForceStringAlertRenderController],[MarkSelectionRenderController],[HoverRenderController],[DragRenderController],[ForceStringRenderController],[CellCustomRenderController],[SheetContextMenuRenderController],[MoveRangeRenderController],[EditorBridgeRenderController],[EditingRenderController],[SheetPermissionInterceptorCanvasRenderController],[SheetPermissionInterceptorFormulaRenderController],[SheetPermissionRenderController],[WorksheetProtectionRenderController]],config=this._configService.getConfig(ui_src.cQ);(config?.contextMenu??!0)&&modules.push([HeaderMenuRenderController]),modules.forEach((m=>{this.disposeWithMe(this._renderManagerService.registerRenderModule(src.Zy$.UNIVER_SHEET,m))}))}_initAutoFocus(){const univerInstanceService=this._univerInstanceService;this.disposeWithMe(univerInstanceService.getCurrentTypeOfUnit$(src.Zy$.UNIVER_SHEET).pipe((0,filter.p)((v=>!!v))).subscribe((workbook=>univerInstanceService.focusUnit(workbook.getUnitId()))))}}function WithValuesFilterModelFactory(){return{id:"test",sheetOrder:["sheet1"],name:"",appVersion:"3.0.0-alpha",locale:src.VnV.ZH_CN,styles:{GOAhZb:{n:{pattern:"yyyy-mm-dd"}},"A-iqEg":{n:{pattern:"yyyy/mm/dd"}},_yIXzW:{n:{pattern:"yyyy-m-d am/pm h:mm"}},qLSh7Z:{n:{pattern:'yyyy"年"MM"月"dd"日"'}}},sheets:{sheet1:{id:"sheet1",cellData:{0:{0:{v:"Column Header"}},1:{0:{v:"1"}},2:{0:{v:"2"}},3:{0:{v:"Michael Jackson King of Pop"}},4:{0:{v:"Michael"}},5:{0:{v:"Jackson"}},6:{0:{v:44876,t:2,s:"GOAhZb"}},7:{0:{v:44877,t:2,s:"GOAhZb"}},8:{0:{v:44878,t:2,s:"A-iqEg"}},9:{0:{v:44879,t:2,s:"_yIXzW"}},10:{0:{v:44880,t:2,s:"qLSh7Z"}}},name:"Sheet1",rowCount:1e3,columnCount:20,mergeData:[]}},resources:[{name:"SHEET_FILTER_PLUGIN",data:'{"sheet1":{"ref":{"startRow":0,"startColumn":0,"endRow":10,"endColumn":10},"filterColumns":[],"cachedFilteredOut":[]}}'}]}}UniverSheetsUIPlugin=function src_plugin_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([(0,src.dCC)(sheets_src.nDU),src_plugin_ts_param(1,(0,src.y_5)(src.zZn)),src_plugin_ts_param(2,engine_render_src.cSx),src_plugin_ts_param(3,src.J0C),src_plugin_ts_param(4,src.HCr),src_plugin_ts_metadata("design:type",Function),src_plugin_ts_metadata("design:paramtypes",["undefined"==typeof Partial?Object:Partial,void 0===src.zZn?Object:src.zZn,void 0===engine_render_src.cSx?Object:engine_render_src.cSx,void 0===src.J0C?Object:src.J0C,void 0===src.HCr?Object:src.HCr])],UniverSheetsUIPlugin);new Set(["44876"]),new Set(["44877"]),new Set(["44878"]),new Set(["44879"]),new Set(["44880"]),new Set(["44876"]),new Set(["44877"]),new Set(["44878"]),new Set(["44879"]),new Set(["44880"]);var FilterConditionItems,ReplaySubject=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/ReplaySubject.js"),shareReplay=__webpack_require__("../../node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/shareReplay.js"),OperatorOrder=function(OperatorOrder){return OperatorOrder[OperatorOrder.FIRST=0]="FIRST",OperatorOrder[OperatorOrder.SECOND=1]="SECOND",OperatorOrder}({}),ExtendCustomFilterOperator=function(ExtendCustomFilterOperator){return ExtendCustomFilterOperator.NONE="none",ExtendCustomFilterOperator.STARTS_WITH="startsWith",ExtendCustomFilterOperator.DOES_NOT_START_WITH="doesNotStartWith",ExtendCustomFilterOperator.ENDS_WITH="endsWith",ExtendCustomFilterOperator.DOES_NOT_END_WITH="doesNotEndWith",ExtendCustomFilterOperator.CONTAINS="contains",ExtendCustomFilterOperator.DOES_NOT_CONTAIN="doesNotContain",ExtendCustomFilterOperator.EQUALS="equals",ExtendCustomFilterOperator.NOT_EQUALS="notEquals",ExtendCustomFilterOperator.EMPTY="empty",ExtendCustomFilterOperator.NOT_EMPTY="notEmpty",ExtendCustomFilterOperator.BETWEEN="between",ExtendCustomFilterOperator.NOT_BETWEEN="notBetween",ExtendCustomFilterOperator.CUSTOM="custom",ExtendCustomFilterOperator}({});function getOnlyOperatorAndVal(mapParams){const{operator1,operator2,val1,val2}=mapParams;if(operator1&&operator2)throw new Error("Both operator1 and operator2 are set!");if(!operator1&&!operator2)throw new Error("Neither operator1 and operator2 and both not set!");return operator1?[operator1,val1]:[operator2,val2]}function statisticFilterByValueItems(items){const checkedItems=[],uncheckedItems=[];let checked=0,unchecked=0;return items.forEach((function traverse(node){node.leaf&&(node.checked?(checkedItems.push(node),checked+=node.count):(uncheckedItems.push(node),unchecked+=node.count)),node.children&&node.children.forEach(traverse)})),{checkedItems,uncheckedItems,checked,unchecked}}function generate_filter_values_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function generate_filter_values_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}!function(FilterConditionItems){function testMappingFilterColumn(filterColumn){if(!filterColumn)return[FilterConditionItems.NONE,{}];for(const condition of FilterConditionItems.ALL_CONDITIONS){const mapParams=condition.testMappingFilterColumn(filterColumn);if(mapParams)return[condition,mapParams]}return[FilterConditionItems.NONE,{}]}FilterConditionItems.NONE={label:"sheets-filter.conditions.none",operator:ExtendCustomFilterOperator.NONE,order:OperatorOrder.SECOND,numOfParameters:0,getDefaultFormParams:()=>{throw new Error("[FilterConditionItems.NONE]: should not have initial form params!")},testMappingParams:params=>params.operator1===ExtendCustomFilterOperator.NONE,mapToFilterColumn:()=>null,testMappingFilterColumn:filterColumn=>!filterColumn.customFilters&&!filterColumn.filters&&{}},FilterConditionItems.EMPTY={label:"sheets-filter.conditions.empty",operator:ExtendCustomFilterOperator.EMPTY,order:OperatorOrder.SECOND,numOfParameters:0,getDefaultFormParams:()=>{throw new Error("[FilterConditionItems.EMPTY]: should not have initial form params!")},testMappingParams:({operator1})=>operator1===ExtendCustomFilterOperator.EMPTY,mapToFilterColumn:()=>({customFilters:{customFilters:[{val:""}]}}),testMappingFilterColumn:filterColumn=>{if(1!==filterColumn.customFilters?.customFilters.length)return!1;const firstCustomFilter=filterColumn.customFilters.customFilters[0];return!(""!==firstCustomFilter.val||void 0!==firstCustomFilter.operator)&&{operator1:ExtendCustomFilterOperator.EMPTY}}},FilterConditionItems.NOT_EMPTY={label:"sheets-filter.conditions.not-empty",operator:ExtendCustomFilterOperator.NOT_EMPTY,order:OperatorOrder.SECOND,numOfParameters:0,getDefaultFormParams:()=>{throw new Error("[FilterConditionItems.NOT_EMPTY]: should not have initial form params!")},testMappingParams:({operator1})=>operator1===ExtendCustomFilterOperator.NOT_EMPTY,mapToFilterColumn:()=>({customFilters:{customFilters:[{val:"",operator:CustomFilterOperator.NOT_EQUALS}]}}),testMappingFilterColumn:filterColumn=>{if(1!==filterColumn.customFilters?.customFilters.length)return!1;const firstCustomFilter=filterColumn.customFilters.customFilters[0];return!(" "!==firstCustomFilter.val||firstCustomFilter.operator!==CustomFilterOperator.NOT_EQUALS)&&{operator1:ExtendCustomFilterOperator.NOT_EMPTY}}},FilterConditionItems.TEXT_CONTAINS={label:"sheets-filter.conditions.text-contains",operator:ExtendCustomFilterOperator.CONTAINS,order:OperatorOrder.FIRST,numOfParameters:1,getDefaultFormParams:()=>({operator1:ExtendCustomFilterOperator.CONTAINS,val1:""}),testMappingParams:params=>{const[op]=getOnlyOperatorAndVal(params);return op===ExtendCustomFilterOperator.CONTAINS},mapToFilterColumn:mapParams=>{const{val1}=mapParams;return""===val1?null:{customFilters:{customFilters:[{val:`*${val1}*`}]}}},testMappingFilterColumn:filterColumn=>{if(1!==filterColumn.customFilters?.customFilters.length)return!1;const firstCustomFilter=filterColumn.customFilters.customFilters[0],valAsString=firstCustomFilter.val.toString();return!(firstCustomFilter.operator||!valAsString.startsWith("*")||!valAsString.endsWith("*"))&&{operator1:ExtendCustomFilterOperator.CONTAINS,val1:valAsString.slice(1,-1)}}},FilterConditionItems.DOES_NOT_CONTAIN={label:"sheets-filter.conditions.does-not-contain",operator:ExtendCustomFilterOperator.DOES_NOT_CONTAIN,order:OperatorOrder.FIRST,numOfParameters:1,getDefaultFormParams:()=>({operator1:ExtendCustomFilterOperator.DOES_NOT_CONTAIN,val1:""}),mapToFilterColumn:mapParams=>({customFilters:{customFilters:[{val:`*${mapParams.val1}*`,operator:CustomFilterOperator.NOT_EQUALS}]}}),testMappingParams:params=>{const[op]=getOnlyOperatorAndVal(params);return op===ExtendCustomFilterOperator.DOES_NOT_CONTAIN},testMappingFilterColumn:filterColumn=>{if(1!==filterColumn.customFilters?.customFilters.length)return!1;const firstCustomFilter=filterColumn.customFilters.customFilters[0],valAsString=firstCustomFilter.val.toString();return!(firstCustomFilter.operator!==CustomFilterOperator.NOT_EQUALS||!valAsString.startsWith("*")||!valAsString.endsWith("*"))&&{operator1:ExtendCustomFilterOperator.DOES_NOT_CONTAIN,val1:valAsString.slice(1,-1)}}},FilterConditionItems.STARTS_WITH={label:"sheets-filter.conditions.starts-with",operator:ExtendCustomFilterOperator.STARTS_WITH,order:OperatorOrder.FIRST,numOfParameters:1,getDefaultFormParams:()=>({operator1:ExtendCustomFilterOperator.STARTS_WITH,val1:""}),mapToFilterColumn:mapParams=>({customFilters:{customFilters:[{val:`${mapParams.val1}*`}]}}),testMappingParams:params=>{const[op]=getOnlyOperatorAndVal(params);return op===ExtendCustomFilterOperator.STARTS_WITH},testMappingFilterColumn:filterColumn=>{if(1!==filterColumn.customFilters?.customFilters.length)return!1;const firstCustomFilter=filterColumn.customFilters.customFilters[0],valAsString=firstCustomFilter.val.toString();return!(firstCustomFilter.operator||!valAsString.endsWith("*")||valAsString.startsWith("*"))&&{operator1:ExtendCustomFilterOperator.STARTS_WITH,val1:valAsString.slice(0,-1)}}},FilterConditionItems.ENDS_WITH={label:"sheets-filter.conditions.ends-with",operator:ExtendCustomFilterOperator.ENDS_WITH,order:OperatorOrder.FIRST,numOfParameters:1,getDefaultFormParams:()=>({operator1:ExtendCustomFilterOperator.ENDS_WITH,val1:""}),mapToFilterColumn:mapParams=>({customFilters:{customFilters:[{val:`*${mapParams.val1}`}]}}),testMappingParams:params=>{const[op]=getOnlyOperatorAndVal(params);return op===ExtendCustomFilterOperator.ENDS_WITH},testMappingFilterColumn:filterColumn=>{if(1!==filterColumn.customFilters?.customFilters.length)return!1;const firstCustomFilter=filterColumn.customFilters.customFilters[0],valAsString=firstCustomFilter.val.toString();return!(firstCustomFilter.operator||!valAsString.startsWith("*")||valAsString.endsWith("*"))&&{operator1:ExtendCustomFilterOperator.ENDS_WITH,val1:valAsString.slice(1)}}},FilterConditionItems.EQUALS={label:"sheets-filter.conditions.equals",operator:ExtendCustomFilterOperator.EQUALS,order:OperatorOrder.FIRST,numOfParameters:1,getDefaultFormParams:()=>({operator1:ExtendCustomFilterOperator.EQUALS,val1:""}),testMappingParams:params=>{const[op]=getOnlyOperatorAndVal(params);return op===ExtendCustomFilterOperator.EQUALS},mapToFilterColumn:mapParams=>{const{val1}=mapParams;return""===val1?null:{customFilters:{customFilters:[{val:val1}]}}},testMappingFilterColumn:filterColumn=>1===filterColumn.filters?.filters?.length?{operator1:ExtendCustomFilterOperator.EQUALS,val1:""}:1===filterColumn.customFilters?.customFilters.length&&!filterColumn.customFilters.customFilters[0].operator&&{operator1:ExtendCustomFilterOperator.EQUALS,val1:filterColumn.customFilters.customFilters[0].val.toString()}},FilterConditionItems.GREATER_THAN={label:"sheets-filter.conditions.greater-than",operator:CustomFilterOperator.GREATER_THAN,numOfParameters:1,order:OperatorOrder.FIRST,getDefaultFormParams:()=>({operator1:CustomFilterOperator.GREATER_THAN,val1:""}),mapToFilterColumn:mapParams=>({customFilters:{customFilters:[{val:mapParams.val1,operator:CustomFilterOperator.GREATER_THAN}]}}),testMappingParams:params=>{const[op]=getOnlyOperatorAndVal(params);return op===CustomFilterOperator.GREATER_THAN},testMappingFilterColumn:filterColumn=>{if(1!==filterColumn.customFilters?.customFilters.length)return!1;const firstCustomFilter=filterColumn.customFilters.customFilters[0];return firstCustomFilter.operator===CustomFilterOperator.GREATER_THAN&&{operator1:CustomFilterOperator.GREATER_THAN,val1:firstCustomFilter.val.toString()}}},FilterConditionItems.GREATER_THAN_OR_EQUAL={label:"sheets-filter.conditions.greater-than-or-equal",operator:CustomFilterOperator.GREATER_THAN_OR_EQUAL,numOfParameters:1,order:OperatorOrder.FIRST,getDefaultFormParams:()=>({operator1:CustomFilterOperator.GREATER_THAN_OR_EQUAL,val1:""}),testMappingParams:params=>{const[op]=getOnlyOperatorAndVal(params);return op===CustomFilterOperator.GREATER_THAN_OR_EQUAL},mapToFilterColumn:mapParams=>({customFilters:{customFilters:[{val:mapParams.val1,operator:CustomFilterOperator.GREATER_THAN_OR_EQUAL}]}}),testMappingFilterColumn:filterColumn=>{if(1!==filterColumn.customFilters?.customFilters.length)return!1;const firstCustomFilter=filterColumn.customFilters.customFilters[0];return firstCustomFilter.operator===CustomFilterOperator.GREATER_THAN_OR_EQUAL&&{operator1:CustomFilterOperator.GREATER_THAN_OR_EQUAL,val1:firstCustomFilter.val.toString()}}},FilterConditionItems.LESS_THAN={label:"sheets-filter.conditions.less-than",operator:CustomFilterOperator.LESS_THAN,numOfParameters:1,order:OperatorOrder.FIRST,getDefaultFormParams:()=>({operator1:CustomFilterOperator.LESS_THAN,val1:""}),testMappingParams:params=>{const[op]=getOnlyOperatorAndVal(params);return op===CustomFilterOperator.LESS_THAN},mapToFilterColumn:mapParams=>({customFilters:{customFilters:[{val:mapParams.val1,operator:CustomFilterOperator.LESS_THAN}]}}),testMappingFilterColumn:filterColumn=>{if(1!==filterColumn.customFilters?.customFilters.length)return!1;const firstCustomFilter=filterColumn.customFilters.customFilters[0];return firstCustomFilter.operator===CustomFilterOperator.LESS_THAN&&{operator1:CustomFilterOperator.LESS_THAN,val1:firstCustomFilter.val.toString()}}},FilterConditionItems.LESS_THAN_OR_EQUAL={label:"sheets-filter.conditions.less-than-or-equal",operator:CustomFilterOperator.LESS_THAN_OR_EQUAL,numOfParameters:1,order:OperatorOrder.FIRST,getDefaultFormParams:()=>({operator1:CustomFilterOperator.LESS_THAN_OR_EQUAL,val1:""}),testMappingParams:params=>{const[op]=getOnlyOperatorAndVal(params);return op===CustomFilterOperator.LESS_THAN_OR_EQUAL},mapToFilterColumn:mapParams=>({customFilters:{customFilters:[{val:mapParams.val1,operator:CustomFilterOperator.LESS_THAN_OR_EQUAL}]}}),testMappingFilterColumn:filterColumn=>{if(1!==filterColumn.customFilters?.customFilters.length)return!1;const firstCustomFilter=filterColumn.customFilters.customFilters[0];return firstCustomFilter.operator===CustomFilterOperator.LESS_THAN_OR_EQUAL&&{operator1:CustomFilterOperator.LESS_THAN_OR_EQUAL,val1:firstCustomFilter.val.toString()}}},FilterConditionItems.EQUAL={label:"sheets-filter.conditions.equal",operator:CustomFilterOperator.EQUAL,numOfParameters:1,order:OperatorOrder.FIRST,getDefaultFormParams:()=>({operator1:CustomFilterOperator.EQUAL,val1:""}),testMappingParams:params=>{const[op]=getOnlyOperatorAndVal(params);return op===CustomFilterOperator.EQUAL},mapToFilterColumn:mapParams=>({customFilters:{customFilters:[{val:mapParams.val1,operator:CustomFilterOperator.EQUAL}]}}),testMappingFilterColumn:filterColumn=>{if(1!==filterColumn.customFilters?.customFilters.length)return!1;const firstCustomFilter=filterColumn.customFilters.customFilters[0];return firstCustomFilter.operator===CustomFilterOperator.EQUAL&&{operator1:CustomFilterOperator.EQUAL,val1:firstCustomFilter.val.toString()}}},FilterConditionItems.NOT_EQUAL={label:"sheets-filter.conditions.not-equal",operator:CustomFilterOperator.NOT_EQUALS,numOfParameters:1,order:OperatorOrder.FIRST,getDefaultFormParams:()=>({operator1:CustomFilterOperator.NOT_EQUALS,val1:""}),testMappingParams:params=>{const[op]=getOnlyOperatorAndVal(params);return op===CustomFilterOperator.NOT_EQUALS},mapToFilterColumn:mapParams=>({customFilters:{customFilters:[{val:mapParams.val1,operator:CustomFilterOperator.NOT_EQUALS}]}}),testMappingFilterColumn:filterColumn=>{if(1!==filterColumn.customFilters?.customFilters.length)return!1;const firstCustomFilter=filterColumn.customFilters.customFilters[0];return firstCustomFilter.operator===CustomFilterOperator.NOT_EQUALS&&{operator1:CustomFilterOperator.NOT_EQUALS,val1:firstCustomFilter.val.toString()}}},FilterConditionItems.BETWEEN={label:"sheets-filter.conditions.between",operator:ExtendCustomFilterOperator.BETWEEN,order:OperatorOrder.SECOND,numOfParameters:2,getDefaultFormParams:()=>({and:!0,operator1:CustomFilterOperator.GREATER_THAN_OR_EQUAL,val1:"",operator2:CustomFilterOperator.LESS_THAN_OR_EQUAL,val2:""}),testMappingParams:params=>{const{and,operator1,operator2}=params;if(!and)return!1;const operators=[operator1,operator2];return operators.includes(CustomFilterOperator.GREATER_THAN_OR_EQUAL)&&operators.includes(CustomFilterOperator.LESS_THAN_OR_EQUAL)},mapToFilterColumn:mapParams=>{const{val1,val2,operator1}=mapParams,operator1IsGreater=operator1===CustomFilterOperator.GREATER_THAN_OR_EQUAL;return{customFilters:{and:src.OdA.TRUE,customFilters:[{val:operator1IsGreater?val1:val2,operator:CustomFilterOperator.GREATER_THAN_OR_EQUAL},{val:operator1IsGreater?val2:val1,operator:CustomFilterOperator.LESS_THAN_OR_EQUAL}]}}},testMappingFilterColumn:filterColumn=>{if(2!==filterColumn.customFilters?.customFilters.length)return!1;const[firstCustomFilter,secondCustomFilter]=filterColumn.customFilters.customFilters;return firstCustomFilter.operator===CustomFilterOperator.GREATER_THAN_OR_EQUAL&&secondCustomFilter.operator===CustomFilterOperator.LESS_THAN_OR_EQUAL&&filterColumn.customFilters.and?{and:!0,operator1:CustomFilterOperator.GREATER_THAN_OR_EQUAL,val1:firstCustomFilter.val.toString(),operator2:CustomFilterOperator.LESS_THAN_OR_EQUAL,val2:secondCustomFilter.val.toString()}:!(secondCustomFilter.operator!==CustomFilterOperator.GREATER_THAN_OR_EQUAL||firstCustomFilter.operator!==CustomFilterOperator.LESS_THAN_OR_EQUAL||!filterColumn.customFilters.and)&&{and:!0,operator1:CustomFilterOperator.GREATER_THAN_OR_EQUAL,val1:secondCustomFilter.val.toString(),operator2:CustomFilterOperator.LESS_THAN_OR_EQUAL,val2:firstCustomFilter.val.toLocaleString()}}},FilterConditionItems.NOT_BETWEEN={label:"sheets-filter.conditions.not-between",operator:ExtendCustomFilterOperator.NOT_BETWEEN,order:OperatorOrder.SECOND,numOfParameters:2,getDefaultFormParams:()=>({operator1:CustomFilterOperator.LESS_THAN,val1:"",operator2:CustomFilterOperator.GREATER_THAN,val2:""}),testMappingParams:params=>{const{and,operator1,operator2}=params;if(and)return!1;const operators=[operator1,operator2];return operators.includes(CustomFilterOperator.GREATER_THAN)&&operators.includes(CustomFilterOperator.LESS_THAN)},mapToFilterColumn:mapParams=>{const{val1,val2,operator1}=mapParams,operator1IsGreater=operator1===CustomFilterOperator.GREATER_THAN;return{customFilters:{customFilters:[{val:operator1IsGreater?val1:val2,operator:CustomFilterOperator.GREATER_THAN},{val:operator1IsGreater?val2:val1,operator:CustomFilterOperator.LESS_THAN}]}}},testMappingFilterColumn:filterColumn=>{if(2!==filterColumn.customFilters?.customFilters.length)return!1;const[firstCustomFilter,secondCustomFilter]=filterColumn.customFilters.customFilters;return firstCustomFilter.operator!==CustomFilterOperator.LESS_THAN||secondCustomFilter.operator!==CustomFilterOperator.GREATER_THAN||filterColumn.customFilters.and?secondCustomFilter.operator===CustomFilterOperator.LESS_THAN&&firstCustomFilter.operator===CustomFilterOperator.GREATER_THAN&&!filterColumn.customFilters.and&&{operator1:CustomFilterOperator.GREATER_THAN,val1:secondCustomFilter.val.toString(),operator2:CustomFilterOperator.LESS_THAN,val2:firstCustomFilter.val.toLocaleString()}:{operator1:CustomFilterOperator.LESS_THAN,val1:firstCustomFilter.val.toString(),operator2:CustomFilterOperator.GREATER_THAN,val2:secondCustomFilter.val.toString()}}},FilterConditionItems.CUSTOM={label:"sheets-filter.conditions.custom",operator:ExtendCustomFilterOperator.CUSTOM,order:OperatorOrder.SECOND,numOfParameters:2,getDefaultFormParams:()=>({operator1:ExtendCustomFilterOperator.NONE,val1:"",operator2:ExtendCustomFilterOperator.NONE,val2:""}),testMappingParams:()=>!0,mapToFilterColumn:mapParams=>{const{and,val1,val2,operator1,operator2}=mapParams;function mapOperator(operator,val){for(const condition of FilterConditionItems.ALL_CONDITIONS)if(condition.operator===operator)return condition.mapToFilterColumn({val1:val,operator1:operator})}const operator1IsNone=!operator1||operator1===FilterConditionItems.NONE.operator,operator2IsNone=!operator2||operator2===FilterConditionItems.NONE.operator;if(operator1IsNone&&operator2IsNone)return FilterConditionItems.NONE.mapToFilterColumn({});if(operator1IsNone)return mapOperator(operator2,val2);if(operator2IsNone)return mapOperator(operator1,val1);const mappedCustomFilter1=mapOperator(operator1,val1),mappedCustomFilter2=mapOperator(operator2,val2),customFilters={customFilters:[mappedCustomFilter1.customFilters.customFilters[0],mappedCustomFilter2.customFilters.customFilters[0]]};return and&&(customFilters.and=src.OdA.TRUE),{customFilters}},testMappingFilterColumn:filterColumn=>{if(2!==filterColumn.customFilters?.customFilters.length)return!1;const params=filterColumn.customFilters.customFilters.map((customFilter=>testMappingFilterColumn({customFilters:{customFilters:[customFilter]}}))),result={operator1:params[0][0].operator,val1:params[0][1].val1,operator2:params[1][0].operator,val2:params[1][1].val1};return filterColumn.customFilters.and&&(result.and=!0),result}},FilterConditionItems.ALL_CONDITIONS=[FilterConditionItems.NONE,FilterConditionItems.EMPTY,FilterConditionItems.NOT_EMPTY,FilterConditionItems.TEXT_CONTAINS,FilterConditionItems.DOES_NOT_CONTAIN,FilterConditionItems.STARTS_WITH,FilterConditionItems.ENDS_WITH,FilterConditionItems.EQUALS,FilterConditionItems.GREATER_THAN,FilterConditionItems.GREATER_THAN_OR_EQUAL,FilterConditionItems.LESS_THAN,FilterConditionItems.LESS_THAN_OR_EQUAL,FilterConditionItems.EQUAL,FilterConditionItems.NOT_EQUAL,FilterConditionItems.BETWEEN,FilterConditionItems.NOT_BETWEEN,FilterConditionItems.CUSTOM],FilterConditionItems.getItemByOperator=function getItemByOperator(operator){const item=FilterConditionItems.ALL_CONDITIONS.find((condition=>condition.operator===operator));if(!item)throw new Error(`[SheetsFilter]: no condition item found for operator: ${operator}`);return item},FilterConditionItems.testMappingParams=function testMappingParams(mapParams,numOfParameters){for(const condition of FilterConditionItems.ALL_CONDITIONS.filter((condition=>condition.numOfParameters===numOfParameters)))if(0!==condition.numOfParameters&&condition.testMappingParams(mapParams))return condition;for(const condition of FilterConditionItems.ALL_CONDITIONS)if(condition.testMappingParams(mapParams))return condition;throw new Error("[SheetsFilter]: no condition item can be mapped from the filter map params!")},FilterConditionItems.getInitialFormParams=function getInitialFormParams(operator){const condition=FilterConditionItems.ALL_CONDITIONS.find((condition=>condition.operator===operator));return 0===condition?.numOfParameters?{operator1:condition.operator}:condition.getDefaultFormParams()},FilterConditionItems.mapToFilterColumn=function mapToFilterColumn(condition,mapParams){return condition.mapToFilterColumn(mapParams)},FilterConditionItems.testMappingFilterColumn=testMappingFilterColumn}(FilterConditionItems||(FilterConditionItems={}));const ISheetsGenerateFilterValuesService=(0,src.Qmd)("sheets-filter.generate-filter-values.service"),CAN_PARSE_DATE_FORMAT=["yyyy-mm-dd","yyyy-mm-dd;@","yyyy/mm/dd;@","yyyy/mm/dd hh:mm","yyyy-m-d am/pm h:mm","yyyy-MM-dd","yyyy/MM/dd","yyyy/mm/dd",'yyyy"年"MM"月"dd"日"',"MM-dd",'M"月"d"日"',"MM-dd A/P hh:mm"];class SheetsGenerateFilterValuesService extends src.jGt{constructor(_localeService,_univerInstanceService,_logService){super(),this._localeService=_localeService,this._univerInstanceService=_univerInstanceService,this._logService=_logService}async getFilterValues(params){const{unitId,subUnitId,filteredOutRowsByOtherColumns,filters,blankChecked,iterateRange,alreadyChecked}=params,workbook=this._univerInstanceService.getUnit(unitId),worksheet=this._univerInstanceService.getUnit(unitId)?.getSheetBySheetId(subUnitId);return workbook&&worksheet?(this._logService.debug("[SheetsGenerateFilterValuesService]","getFilterValues for",{unitId,subUnitId}),getFilterTreeByValueItems(filters,this._localeService,iterateRange,worksheet,new Set(filteredOutRowsByOtherColumns),new Set(alreadyChecked.map(String)),blankChecked,workbook.getStyles())):[]}}function getFilterTreeByValueItems(filters,localeService,iterateRange,worksheet,filteredOutRowsByOtherColumns,alreadyChecked,blankChecked,styles){const items=new Map,treeMap=new Map,canSplitPatternSet=new Set(CAN_PARSE_DATE_FORMAT);let emptyCount=0;for(const cell of worksheet.iterateByColumn(iterateRange,!1,!1)){const{row,rowSpan=1}=cell;let rowIndex=0;for(;rowIndex<rowSpan;){const targetRow=row+rowIndex;if(filteredOutRowsByOtherColumns.has(targetRow)){rowIndex++;continue}const value=cell?.value?(0,src.zo$)(cell.value):"";if(!value){emptyCount+=1,rowIndex+=rowSpan;continue}const fmtStr=cell.value?.v&&!cell.value.p?styles.get(cell.value?.s)?.n?.pattern:"",isDateValue=fmtStr&&src.gIL.isDate(fmtStr);if(fmtStr&&isDateValue&&canSplitPatternSet.has(fmtStr)){const originValue=worksheet.getCellRaw(cell.row,cell.col)?.v;if(!originValue){rowIndex++;continue}const valueParsedByDefaultPattern=src.gIL.format("yyyy-mm-dd",originValue),[year,month,day]=valueParsedByDefaultPattern.split("-").map(Number);let yearItem=items.get(`${year}`);yearItem||(yearItem={title:`${year}`,key:`${year}`,children:[],count:0,leaf:!1,checked:!1},items.set(`${year}`,yearItem),treeMap.set(`${year}`,[`${year}`]));let monthItem=yearItem.children?.find((item=>item.key===`${year}-${month}`));monthItem||(monthItem={title:localeService.t(`sheets-filter.date.${month}`),key:`${year}-${month}`,children:[],count:0,leaf:!1,checked:!1},yearItem.children?.push(monthItem),treeMap.set(`${year}-${month}`,[`${year}`,`${year}-${month}`]));const dayItem=monthItem?.children?.find((item=>item.key===`${year}-${month}-${day}`));dayItem?(dayItem.originValues.add(value),dayItem.count++,monthItem.count++,yearItem.count++):(monthItem.children?.push({title:`${day}`,key:`${year}-${month}-${day}`,count:1,originValues:new Set([value]),leaf:!0,checked:alreadyChecked.size?alreadyChecked.has(value):!blankChecked}),monthItem.count++,yearItem.count++,treeMap.set(`${year}-${month}-${day}`,[`${year}`,`${year}-${month}`,`${year}-${month}-${day}`]))}else{const key=value;let item=items.get(key);item?item.count++:(item={title:value,leaf:!0,checked:alreadyChecked.size?alreadyChecked.has(value):!blankChecked,key,count:1},items.set(key,item),treeMap.set(key,[key]))}rowIndex++}}const initialBlankChecked=!filters||blankChecked;if(emptyCount>0){const item={title:localeService.t("sheets-filter.panel.empty"),count:emptyCount,leaf:!0,checked:initialBlankChecked,key:"empty"};items.set("empty",item),treeMap.set("empty",["empty"])}return{filterTreeItems:(tree=Array.from(items.values()),Array.from(tree).sort(((a,b)=>a.children&&!b.children?-1:!a.children&&b.children?1:b.title.localeCompare(a.title))).map((yearItem=>(yearItem.children&&yearItem.children.sort(((a,b)=>{const monthA=Number.parseInt(a.key.split("-")[1],10),monthB=Number.parseInt(b.key.split("-")[1],10);return monthA-monthB})).forEach((monthItem=>{monthItem.children&&monthItem.children.sort(((a,b)=>{const dayA=Number.parseInt(a.key.split("-")[2],10),dayB=Number.parseInt(b.key.split("-")[2],10);return dayA-dayB}))})),yearItem)))),filterTreeMapCache:treeMap};var tree}function findObjectByKey(data,targetKey){for(const node of data){if(node.key===targetKey)return node;if(node.children){const result=findObjectByKey(node.children,targetKey);if(result)return result}}return null}function areAllLeafNodesChecked(node){return node.leaf?node.checked:!node.children||node.children.every((child=>areAllLeafNodesChecked(child)))}function updateLeafNodesCheckedStatus(node,status){node.leaf&&(node.checked=void 0!==status?status:!node.checked),node.children&&node.children.forEach((child=>updateLeafNodesCheckedStatus(child,status)))}function searchTree(items,searchKeywords){const result=[];return items.forEach((item=>{const originMatches=!!item.originValues&&searchKeywords.some((keyword=>Array.from(item.originValues).some((value=>value.toLowerCase().includes(keyword.toLowerCase()))))),titleMatches=!originMatches&&searchKeywords.some((keyword=>item.title.toLowerCase().includes(keyword.toLowerCase())));if(originMatches||titleMatches)result.push({...item});else if(item.children){const filteredChildren=searchTree(item.children,searchKeywords);if(filteredChildren.length>0){const aggregatedCount=filteredChildren.reduce(((sum,child)=>sum+child.count),0);result.push({...item,count:aggregatedCount,children:filteredChildren})}}})),result}function sheets_filter_panel_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}function sheets_filter_panel_service_ts_metadata(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)}function sheets_filter_panel_service_ts_param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}SheetsGenerateFilterValuesService=function generate_filter_values_service_ts_decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}([generate_filter_values_service_ts_param(0,(0,src.y_5)(src.iH9)),generate_filter_values_service_ts_param(1,src.HCr),generate_filter_values_service_ts_param(2,src.rrK),generate_filter_values_service_ts_metadata("design:type",Function),generate_filter_values_service_ts_metadata("design:paramtypes",[void 0===src.iH9?Object:src.iH9,void 0===src.HCr?Object:src.HCr,void 0===src.rrK?Object:src.rrK])],SheetsGenerateFilterValuesService);var FilterBy=function(FilterBy){return FilterBy[FilterBy.VALUES=0]="VALUES",FilterBy[FilterBy.CONDITIONS=1]="CONDITIONS",FilterBy}({});(0,src.Qmd)("sheets-filter-ui.sheets-filter-panel.service");class SheetsFilterPanelService extends src.jGt{get filterBy(){return this._filterBy$.getValue()}get filterByModel(){return this._filterByModel}set filterByModel(model){this._filterByModel=model,this._filterByModel$.next(model)}get filterModel(){return this._filterModel}get col(){return this._col$.getValue()}constructor(_injector,_refRangeService){super(),this._injector=_injector,this._refRangeService=_refRangeService,this._filterBy$=new BehaviorSubject.t(0),this.filterBy$=this._filterBy$.asObservable(),this._filterByModel$=new ReplaySubject.m(1),this.filterByModel$=this._filterByModel$.asObservable(),this._filterByModel=null,this._hasCriteria$=new BehaviorSubject.t(!1),this.hasCriteria$=this._hasCriteria$.asObservable(),this._filterModel=null,this._col$=new BehaviorSubject.t(-1),this.col$=this._col$.asObservable(),this._filterHeaderListener=null}dispose(){this._filterBy$.complete(),this._filterByModel$.complete(),this._hasCriteria$.complete()}setupCol(filterModel,col){this.terminate(),this._filterModel=filterModel,this._col$.next(col);const filterColumn=filterModel.getFilterColumn(col);if(filterColumn){const info=filterColumn.getColumnData();return info.customFilters?(this._hasCriteria$.next(!0),void this._setupByConditions(filterModel,col)):info.filters?(this._hasCriteria$.next(!0),void this._setupByValues(filterModel,col)):(this._hasCriteria$.next(!1),void this._setupByValues(filterModel,col))}this._hasCriteria$.next(!1),this._setupByValues(filterModel,col)}changeFilterBy(filterBy){return!(!this._filterModel||-1===this.col)&&(0===filterBy?this._setupByValues(this._filterModel,this.col):this._setupByConditions(this._filterModel,this.col),!0)}terminate(){return this._filterModel=null,this._col$.next(-1),this._disposeFilterHeaderChangeListener(),!0}_disposeFilterHeaderChangeListener(){this._filterHeaderListener?.dispose(),this._filterHeaderListener=null}_listenToFilterHeaderChange(filterModel,col){this._disposeFilterHeaderChangeListener();const unitId=filterModel.unitId,subUnitId=filterModel.subUnitId,filterRange=filterModel.getRange(),columnHeaderRange={startColumn:col,startRow:filterRange.startRow,endRow:filterRange.startRow,endColumn:col};this._filterHeaderListener=this._refRangeService.watchRange(unitId,subUnitId,columnHeaderRange,((before,after)=>{if(after){const offset=after.startColumn-before.startColumn;0!==offset&&this._filterByModel.deltaCol(offset)}else this.terminate()}))}async _setupByValues(filterModel,col){this._disposePreviousModel();const range=filterModel.getRange();if(range.startRow===range.endRow)return!1;const filterByModel=await ByValuesModel.fromFilterColumn(this._injector,filterModel,col);return this.filterByModel=filterByModel,this._filterBy$.next(0),this._listenToFilterHeaderChange(filterModel,col),!0}_setupByConditions(filterModel,col){this._disposePreviousModel();const range=filterModel.getRange();if(range.startRow===range.endRow)return!1;const model=ByConditionsModel.fromFilterColumn(this._injector,filterModel,col,filterModel.getFilterColumn(col));return this.filterByModel=model,this._filterBy$.next(1),this._listenToFilterHeaderChange(filterModel,col),!0}_disposePreviousModel(){this._filterByModel?.dispose(),this.filterByModel=null}}SheetsFilterPanelService=sheets_filter_panel_service_ts_decorate([sheets_filter_panel_service_ts_param(0,(0,src.y_5)(src.zZn)),sheets_filter_panel_service_ts_param(1,(0,src.y_5)(sheets_src.u7_)),sheets_filter_panel_service_ts_metadata("design:type",Function),sheets_filter_panel_service_ts_metadata("design:paramtypes",[void 0===src.zZn?Object:src.zZn,void 0===sheets_src.u7_?Object:sheets_src.u7_])],SheetsFilterPanelService);class ByConditionsModel extends src.jGt{static fromFilterColumn(injector,filterModel,col,filterColumn){const[conditionItem,conditionParams]=FilterConditionItems.testMappingFilterColumn(filterColumn?.getColumnData());return injector.createInstance(ByConditionsModel,filterModel,col,conditionItem,conditionParams)}get conditionItem(){return this._conditionItem$.getValue()}get filterConditionFormParams(){return this._filterConditionFormParams$.getValue()}constructor(_filterModel,col,conditionItem,conditionParams,_commandService){super(),this._filterModel=_filterModel,this.col=col,this._commandService=_commandService,this.canApply$=(0,observable_of.of)(!0),this._conditionItem$=new BehaviorSubject.t(conditionItem),this.conditionItem$=this._conditionItem$.asObservable(),this._filterConditionFormParams$=new BehaviorSubject.t(conditionParams),this.filterConditionFormParams$=this._filterConditionFormParams$.asObservable()}dispose(){super.dispose(),this._conditionItem$.complete(),this._filterConditionFormParams$.complete()}deltaCol(offset){this.col+=offset}clear(){return this._disposed?Promise.resolve(!1):this._commandService.executeCommand(SetSheetsFilterCriteriaCommand.id,{unitId:this._filterModel.unitId,subUnitId:this._filterModel.subUnitId,col:this.col,criteria:null})}async apply(){if(this._disposed)return!1;const filterColumn=FilterConditionItems.mapToFilterColumn(this.conditionItem,this.filterConditionFormParams);return this._commandService.executeCommand(SetSheetsFilterCriteriaCommand.id,{unitId:this._filterModel.unitId,subUnitId:this._filterModel.subUnitId,col:this.col,criteria:filterColumn})}onPrimaryConditionChange(operator){const conditionItem=FilterConditionItems.ALL_CONDITIONS.find((item=>item.operator===operator));if(!conditionItem)throw new Error(`[ByConditionsModel]: condition item not found for operator: ${operator}!`);this._conditionItem$.next(conditionItem),this._filterConditionFormParams$.next(FilterConditionItems.getInitialFormParams(operator))}onConditionFormChange(params){const newParams={...this.filterConditionFormParams,...params};if(!0!==newParams.and&&delete newParams.and,void 0!==params.and||void 0!==params.operator1||void 0!==params.operator2){const conditionItem=FilterConditionItems.testMappingParams(newParams,this.conditionItem.numOfParameters);this._conditionItem$.next(conditionItem)}this._filterConditionFormParams$.next(newParams)}}ByConditionsModel=sheets_filter_panel_service_ts_decorate([sheets_filter_panel_service_ts_param(4,src.wTY),sheets_filter_panel_service_ts_metadata("design:type",Function),sheets_filter_panel_service_ts_metadata("design:paramtypes",["undefined"==typeof FilterModel?Object:FilterModel,Number,"undefined"==typeof IFilterConditionItem?Object:IFilterConditionItem,"undefined"==typeof IFilterConditionFormParams?Object:IFilterConditionFormParams,void 0===src.wTY?Object:src.wTY])],ByConditionsModel);class ByValuesModel extends src.jGt{static async fromFilterColumn(injector,filterModel,col){const univerInstanceService=injector.get(src.HCr),localeService=injector.get(src.iH9),generateFilterValuesService=injector.get(ISheetsGenerateFilterValuesService,src.Q1r.OPTIONAL),{unitId,subUnitId}=filterModel,workbook=univerInstanceService.getUniverSheetInstance(unitId);if(!workbook)throw new Error(`[ByValuesModel]: Workbook not found for filter model with unitId: ${unitId}!`);const worksheet=workbook?.getSheetBySheetId(subUnitId);if(!worksheet)throw new Error(`[ByValuesModel]: Worksheet not found for filter model with unitId: ${unitId} and subUnitId: ${subUnitId}!`);const range=filterModel.getRange(),column=col,filters=filterModel.getFilterColumn(col)?.getColumnData().filters,alreadyChecked=new Set(filters?.filters),blankChecked=!(!filters||!filters.blank),filteredOutRowsByOtherColumns=filterModel.getFilteredOutRowsExceptCol(col),iterateRange={...range,startRow:range.startRow+1,startColumn:column,endColumn:column};let items,cache;if(generateFilterValuesService){const res=await generateFilterValuesService.getFilterValues({unitId,subUnitId,filteredOutRowsByOtherColumns:Array.from(filteredOutRowsByOtherColumns),filters:!!filters,blankChecked,iterateRange,alreadyChecked:Array.from(alreadyChecked)});items=res.filterTreeItems,cache=res.filterTreeMapCache}else{const res=getFilterTreeByValueItems(!!filters,localeService,iterateRange,worksheet,filteredOutRowsByOtherColumns,alreadyChecked,blankChecked,workbook.getStyles());items=res.filterTreeItems,cache=res.filterTreeMapCache}return injector.createInstance(ByValuesModel,filterModel,col,items,cache)}get rawFilterItems(){return this._rawFilterItems$.getValue()}get filterItems(){return this._filterItems}get treeMapCache(){return this._treeMapCache}constructor(_filterModel,col,items,cache,_commandService){super(),this._filterModel=_filterModel,this.col=col,this._commandService=_commandService,this._filterItems=[],this._treeMapCache=cache,this._searchString$=new BehaviorSubject.t(""),this.searchString$=this._searchString$.asObservable(),this._rawFilterItems$=new BehaviorSubject.t(items),this.rawFilterItems$=this._rawFilterItems$.asObservable(),this._manuallyUpdateFilterItems$=new Subject.B,this.filterItems$=(0,observable_merge.h)((0,combineLatest.z)([this._searchString$.pipe((0,throttleTime.c)(500,void 0,{leading:!0,trailing:!0}),(0,operators_startWith.Z)(void 0)),this._rawFilterItems$]).pipe((0,operators_map.T)((([searchString,items])=>{if(!searchString)return items;return searchTree(items,searchString.toLowerCase().split(/\s+/).filter((s=>!!s)))}))),this._manuallyUpdateFilterItems$).pipe((0,shareReplay.t)(1)),this.canApply$=this.filterItems$.pipe((0,operators_map.T)((items=>statisticFilterByValueItems(items).checked>0))),this.disposeWithMe(this.filterItems$.subscribe((items=>this._filterItems=items)))}dispose(){this._rawFilterItems$.complete(),this._searchString$.complete()}deltaCol(offset){this.col+=offset}setSearchString(str){this._searchString$.next(str)}onCheckAllToggled(checked){const items=src.S0q.deepClone(this._filterItems);items.forEach((item=>updateLeafNodesCheckedStatus(item,checked))),this._manuallyUpdateFilterItems(items)}onFilterCheckToggled(item){const items=src.S0q.deepClone(this._filterItems),changedItem=findObjectByKey(items,item.key);if(!changedItem)return;updateLeafNodesCheckedStatus(changedItem,!areAllLeafNodesChecked(changedItem)),this._manuallyUpdateFilterItems(items)}onFilterOnly(itemKeys){const items=src.S0q.deepClone(this._filterItems);items.forEach((item=>updateLeafNodesCheckedStatus(item,!1))),itemKeys.forEach((key=>{const changedItem=findObjectByKey(items,key);changedItem&&updateLeafNodesCheckedStatus(changedItem,!0)})),this._manuallyUpdateFilterItems(items)}_manuallyUpdateFilterItems(items){this._manuallyUpdateFilterItems$.next(items)}clear(){return this._disposed?Promise.resolve(!1):this._commandService.executeCommand(SetSheetsFilterCriteriaCommand.id,{unitId:this._filterModel.unitId,subUnitId:this._filterModel.subUnitId,col:this.col,criteria:null})}async apply(){if(this._disposed)return!1;const statistics=statisticFilterByValueItems(this._filterItems),{checked,checkedItems}=statistics,rawFilterItems=this.rawFilterItems;let rawFilterCount=0;for(const item of rawFilterItems)rawFilterCount+=item.count;const noChecked=0===checked,allChecked=statistics.checked===rawFilterCount,criteria={colId:this.col};if(noChecked)throw new Error("[ByValuesModel]: no checked items!");if(allChecked)return this._commandService.executeCommand(SetSheetsFilterCriteriaCommand.id,{unitId:this._filterModel.unitId,subUnitId:this._filterModel.subUnitId,col:this.col,criteria:null});{criteria.filters={};const nonEmptyItems=checkedItems.filter((item=>"empty"!==item.key));nonEmptyItems.length>0&&(criteria.filters={filters:nonEmptyItems.flatMap((item=>item.originValues?Array.from(item.originValues):[item.title]))});nonEmptyItems.length!==checkedItems.length&&(criteria.filters.blank=!0)}return this._commandService.executeCommand(SetSheetsFilterCriteriaCommand.id,{unitId:this._filterModel.unitId,subUnitId:this._filterModel.subUnitId,col:this.col,criteria})}}ByValuesModel=sheets_filter_panel_service_ts_decorate([sheets_filter_panel_service_ts_param(4,src.wTY),sheets_filter_panel_service_ts_metadata("design:type",Function),sheets_filter_panel_service_ts_metadata("design:paramtypes",["undefined"==typeof FilterModel?Object:FilterModel,Number,Array,"undefined"==typeof Map?Object:Map,void 0===src.wTY?Object:src.wTY])],ByValuesModel);const OpenFilterPanelOperation={id:"sheet.operation.open-filter-panel",type:src.g4t.OPERATION,handler:(accessor,params)=>{const contextService=accessor.get(src.oaf),sheetsFilterService=accessor.get(SheetsFilterService),sheetsFilterPanelService=accessor.get(SheetsFilterPanelService);accessor.get(src.wTY).syncExecuteCommand(SetCellEditVisibleOperation.id,{visible:!1});const{unitId,subUnitId,col}=params,filterModel=sheetsFilterService.getFilterModel(unitId,subUnitId);return!!filterModel&&(sheetsFilterPanelService.setupCol(filterModel,col),contextService.getContextValue("FILTER_PANEL_OPENED")||contextService.setContextValue("FILTER_PANEL_OPENED",!0),!0)}},CloseFilterPanelOperation={id:"sheet.operation.close-filter-panel",type:src.g4t.OPERATION,handler:accessor=>{const contextService=accessor.get(src.oaf),sheetsFilterPanelService=accessor.get(SheetsFilterPanelService),layoutService=accessor.get(ui_src.xQ,src.Q1r.OPTIONAL);return!!contextService.getContextValue("FILTER_PANEL_OPENED")&&(contextService.setContextValue("FILTER_PANEL_OPENED",!1),layoutService?.focus(),sheetsFilterPanelService.terminate())}},ChangeFilterByOperation={id:"sheet.operation.apply-filter",type:src.g4t.OPERATION,handler:(accessor,params)=>{const{filterBy}=params;return accessor.get(SheetsFilterPanelService).changeFilterBy(filterBy)}},en_US={"sheets-filter":{toolbar:{"smart-toggle-filter-tooltip":"Toggle Filter","clear-filter-criteria":"Clear Filter Conditions","re-calc-filter-conditions":"Re-calc Filter Conditions"},command:{"not-valid-filter-range":"The selected range only has one row and not valid for filter."},shortcut:{"smart-toggle-filter":"Toggle Filter"},panel:{"clear-filter":"Clear Filter",cancel:"Cancel",confirm:"Confirm","by-values":"By Values","by-conditions":"By Conditions","filter-only":"Filter Only","search-placeholder":"Use space to separate keywords","select-all":"Select All","input-values-placeholder":"Input Values",and:"AND",or:"OR",empty:"(empty)","?":"Use “?” to represent a single character.","*":"Use “*” to represent multiple characters."},conditions:{none:"None",empty:"Is Empty","not-empty":"Is Not Empty","text-contains":"Text Contains","does-not-contain":"Text Does Not Contain","starts-with":"Text Starts With","ends-with":"Text Ends With",equals:"Text Equals","greater-than":"Greater Than","greater-than-or-equal":"Greater Than Or Equal To","less-than":"Less Than","less-than-or-equal":"Less Than Or Equal To",equal:"Equal","not-equal":"Not Equal",between:"Between","not-between":"Not Between",custom:"Custom"},msg:{"filter-header-forbidden":"You can't move the header row of a filter."},date:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}}},ru_RU={"sheets-filter":{toolbar:{"smart-toggle-filter-tooltip":"Переключить фильтр","clear-filter-criteria":"Очистить условия фильтра","re-calc-filter-conditions":"Пересчитать условия фильтра"},command:{"not-valid-filter-range":"Выбранный диапазон содержит только одну строку и не подходит для фильтра."},shortcut:{"smart-toggle-filter":"Переключить фильтр"},panel:{"clear-filter":"Очистить фильтр",cancel:"Отмена",confirm:"Подтвердить","by-values":"По значениям","by-conditions":"По условиям","filter-only":"Только фильтр","search-placeholder":"Используйте пробел для разделения ключевых слов","select-all":"Выбрать все","input-values-placeholder":"Введите значения",and:"И",or:"ИЛИ",empty:"(пусто)","?":"Используйте “?” для обозначения одного символа.","*":"Используйте “*” для обозначения нескольких символов."},conditions:{none:"Нет",empty:"Пусто","not-empty":"Не пусто","text-contains":"Содержит текст","does-not-contain":"Не содержит текст","starts-with":"Начинается с","ends-with":"Заканчивается на",equals:"Равно","greater-than":"Больше чем","greater-than-or-equal":"Больше или равно","less-than":"Меньше чем","less-than-or-equal":"Меньше или равно",equal:"Равно","not-equal":"Не равно",between:"Между","not-between":"Не между",custom:"Пользовательский"},msg:{"filter-header-forbidden":"Вы не можете переместить строку заголовка фильтра."},date:{1:"Январь",2:"Февраль",3:"Март",4:"Апрель",5:"Май",6:"Июнь",7:"Июль",8:"Август",9:"Сентябрь",10:"Октябрь",11:"Ноябрь",12:"Декабрь"}}},zh_CN={"sheets-filter":{toolbar:{"smart-toggle-filter-tooltip":"筛选","clear-filter-criteria":"清除筛选条件","re-calc-filter-conditions":"重新计算"},command:{"not-valid-filter-range":"选中的区域只有一行，无法进行筛选"},shortcut:{"smart-toggle-filter":"切换筛选"},panel:{"clear-filter":"清除筛选",cancel:"取消",confirm:"确认","by-values":"按值","by-conditions":"按条件","filter-only":"仅筛选","search-placeholder":"使用空格分隔关键字","select-all":"全选","input-values-placeholder":"请输入",or:"或",and:"和",empty:"(空白)","?":"可用 ? 代表单个字符","*":"可用 * 代表任意多个字符"},conditions:{none:"无",empty:"为空","not-empty":"不为空","text-contains":"文本包含","does-not-contain":"文本不包含","starts-with":"文本开头","ends-with":"文本结尾",equals:"文本相符","greater-than":"大于","greater-than-or-equal":"大于等于","less-than":"小于","less-than-or-equal":"小于等于",equal:"等于","not-equal":"不等于",between:"介于","not-between":"不介于",custom:"自定义"},msg:{"filter-header-forbidden":"无法移动筛选行头"},date:{1:"1月",2:"2月",3:"3月",4:"4月",5:"5月",6:"6月",7:"7月",8:"8月",9:"9月",10:"10月",11:"11月",12:"12月"}}};var components_index_module=__webpack_require__("../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/.pnpm/less-loader@12.2.0_less@4.2.2_webpack@5.98.0_@swc+core@1.10.18_esbuild@0.25.0_/node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../packages/sheets-filter-ui/src/views/components/index.module.less"),components_index_module_options={};components_index_module_options.styleTagTransform=styleTagTransform_default(),components_index_module_options.setAttributes=setAttributesWithoutAttributes_default(),components_index_module_options.insert=insertBySelector_default().bind(null,"head"),components_index_module_options.domAPI=styleDomAPI_default(),components_index_module_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(components_index_module.A,components_index_module_options);const views_components_index_module=components_index_module.A&&components_index_module.A.locals?components_index_module.A.locals:void 0;function FilterByCondition(props){const{model}=props,localeService=(0,ui_src.fJ)(src.iH9),condition=(0,ui_src.J2)(model.conditionItem$,void 0),formParams=(0,ui_src.J2)(model.filterConditionFormParams$,void 0),radioValue=formParams?.and?"AND":"OR",onRadioChange=(0,react.useCallback)((key=>{model.onConditionFormChange({and:"AND"===key})}),[model]),primaryOptions=function usePrimaryOptions(localeService){const locale=localeService.getCurrentLocale();return(0,react.useMemo)((()=>[{options:[{label:localeService.t(FilterConditionItems.NONE.label),value:FilterConditionItems.NONE.operator}]},{options:[{label:localeService.t(FilterConditionItems.EMPTY.label),value:FilterConditionItems.EMPTY.operator},{label:localeService.t(FilterConditionItems.NOT_EMPTY.label),value:FilterConditionItems.NOT_EMPTY.operator}]},{options:[{label:localeService.t(FilterConditionItems.TEXT_CONTAINS.label),value:FilterConditionItems.TEXT_CONTAINS.operator},{label:localeService.t(FilterConditionItems.DOES_NOT_CONTAIN.label),value:FilterConditionItems.DOES_NOT_CONTAIN.operator},{label:localeService.t(FilterConditionItems.STARTS_WITH.label),value:FilterConditionItems.STARTS_WITH.operator},{label:localeService.t(FilterConditionItems.ENDS_WITH.label),value:FilterConditionItems.ENDS_WITH.operator},{label:localeService.t(FilterConditionItems.EQUALS.label),value:FilterConditionItems.EQUALS.operator}]},{options:[{label:localeService.t(FilterConditionItems.GREATER_THAN.label),value:FilterConditionItems.GREATER_THAN.operator},{label:localeService.t(FilterConditionItems.GREATER_THAN_OR_EQUAL.label),value:FilterConditionItems.GREATER_THAN_OR_EQUAL.operator},{label:localeService.t(FilterConditionItems.LESS_THAN.label),value:FilterConditionItems.LESS_THAN.operator},{label:localeService.t(FilterConditionItems.LESS_THAN_OR_EQUAL.label),value:FilterConditionItems.LESS_THAN_OR_EQUAL.operator},{label:localeService.t(FilterConditionItems.EQUAL.label),value:FilterConditionItems.EQUAL.operator},{label:localeService.t(FilterConditionItems.NOT_EQUAL.label),value:FilterConditionItems.NOT_EQUAL.operator},{label:localeService.t(FilterConditionItems.BETWEEN.label),value:FilterConditionItems.BETWEEN.operator},{label:localeService.t(FilterConditionItems.NOT_BETWEEN.label),value:FilterConditionItems.NOT_BETWEEN.operator}]},{options:[{label:localeService.t(FilterConditionItems.CUSTOM.label),value:FilterConditionItems.CUSTOM.operator}]}]),[locale,localeService])}(localeService),onPrimaryConditionChange=(0,react.useCallback)((value=>{model.onPrimaryConditionChange(value)}),[model]),secondaryOptions=function useSecondaryOptions(localeService){const locale=localeService.getCurrentLocale();return(0,react.useMemo)((()=>FilterConditionItems.ALL_CONDITIONS.filter((c=>2!==c.numOfParameters)).map((c=>({label:localeService.t(c.label),value:c.operator})))),[locale,localeService])}(localeService),onFormParamsChange=(0,react.useCallback)((diffParams=>{model.onConditionFormChange(diffParams)}),[model]),placeholder=localeService.t("sheets-filter.panel.input-values-placeholder");function renderSecondaryCondition(operator,val,name){const shouldRenderInput=1===FilterConditionItems.getItemByOperator(operator).numOfParameters;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["operator2"===name&&(0,jsx_runtime.jsxs)(design_src.z6,{value:radioValue,onChange:onRadioChange,children:[(0,jsx_runtime.jsx)(design_src.sx,{value:"AND",children:localeService.t("sheets-filter.panel.and")}),(0,jsx_runtime.jsx)(design_src.sx,{value:"OR",children:localeService.t("sheets-filter.panel.or")})]}),(0,jsx_runtime.jsx)(design_src.l6,{value:operator,options:secondaryOptions,onChange:operator=>onFormParamsChange({[name]:operator})}),shouldRenderInput&&(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(design_src.pd,{value:val,placeholder,onChange:value=>onFormParamsChange({["operator1"===name?"val1":"val2"]:value})})})]})}return(0,jsx_runtime.jsx)("div",{className:views_components_index_module.sheetsFilterPanelConditionsContainer,children:condition&&formParams&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(design_src.l6,{value:condition.operator,options:primaryOptions,onChange:onPrimaryConditionChange}),0!==FilterConditionItems.getItemByOperator(condition.operator).numOfParameters?(0,jsx_runtime.jsxs)("div",{className:views_components_index_module.sheetsFilterPanelConditionsContainerInner,children:[condition.numOfParameters>=1&&renderSecondaryCondition(formParams.operator1,formParams.val1??"","operator1"),condition.numOfParameters>=2&&renderSecondaryCondition(formParams.operator2,formParams.val2??"","operator2"),(0,jsx_runtime.jsxs)("div",{className:views_components_index_module.sheetsFilterPanelConditionsDesc,children:[localeService.t("sheets-filter.panel.?"),(0,jsx_runtime.jsx)("br",{}),localeService.t("sheets-filter.panel.*")]})]}):null]})})}function FilterByValue(props){const{model}=props,localeService=(0,ui_src.fJ)(src.iH9),searchText=(0,ui_src.J2)(model.searchString$,"",!0),items=(0,ui_src.J2)(model.filterItems$,void 0,!0),filterOnly=localeService.t("sheets-filter.panel.filter-only"),stat=statisticFilterByValueItems(items),allChecked=stat.checked>0&&0===stat.unchecked,indeterminate=stat.checked>0&&stat.unchecked>0,treeMap=model.treeMapCache,onCheckAllToggled=(0,react.useCallback)((()=>{model.onCheckAllToggled(!allChecked)}),[model,allChecked]),onSearchValueChange=(0,react.useCallback)((str=>{model.setSearchString(str)}),[model]);return(0,jsx_runtime.jsxs)("div",{className:views_components_index_module.sheetsFilterPanelValuesContainer,children:[(0,jsx_runtime.jsx)(design_src.pd,{autoFocus:!0,value:searchText,placeholder:localeService.t("sheets-filter.panel.search-placeholder"),onChange:onSearchValueChange}),(0,jsx_runtime.jsxs)("div",{className:views_components_index_module.sheetsFilterPanelValuesList,children:[(0,jsx_runtime.jsx)("div",{className:views_components_index_module.sheetsFilterPanelValuesItem,children:(0,jsx_runtime.jsxs)("div",{className:views_components_index_module.sheetsFilterPanelValuesItemInner,children:[(0,jsx_runtime.jsx)(design_src.Sc,{indeterminate,disabled:0===items.length,checked:allChecked,onChange:onCheckAllToggled}),(0,jsx_runtime.jsx)("span",{className:views_components_index_module.sheetsFilterPanelValuesItemText,children:`${localeService.t("sheets-filter.panel.select-all")}`}),(0,jsx_runtime.jsx)("span",{className:views_components_index_module.sheetsFilterPanelValuesItemCount,children:`(${stat.checked}/${stat.checked+stat.unchecked})`})]})}),(0,jsx_runtime.jsx)("div",{className:views_components_index_module.sheetsFilterPanelValuesVirtual,children:(0,jsx_runtime.jsx)(design_src.PH,{data:items,defaultExpandAll:!1,valueGroup:function extractCheckedKeys(items){let checkedKeys=[];return items.forEach((item=>{item.checked&&checkedKeys.push(item.key),item.children&&(checkedKeys=checkedKeys.concat(extractCheckedKeys(item.children)))})),checkedKeys}(items),height:180,onChange:node=>{model.onFilterCheckToggled(node)},defaultCache:treeMap,itemHeight:28,treeNodeClassName:views_components_index_module.sheetsFilterTreeNode,attachRender:item=>(0,jsx_runtime.jsxs)("div",{className:views_components_index_module.sheetsFilterTreeNodeAttach,children:[(0,jsx_runtime.jsx)("span",{className:views_components_index_module.sheetsFilterPanelValuesItemCount,children:`(${item.count})`}),(0,jsx_runtime.jsx)(design_src.$n,{className:views_components_index_module.sheetsFilterTreeNodeFilterOnly,size:"small",type:"link",onClick:()=>{const filterValues=[];item.children?item.children.forEach((child=>{child.children?child.children.forEach((subChild=>{filterValues.push(subChild.key)})):filterValues.push(child.key)})):filterValues.push(item.key),model.onFilterOnly(filterValues)},children:filterOnly})]})})})]})]})}function FilterPanel(){const sheetsFilterPanelService=(0,ui_src.fJ)(SheetsFilterPanelService),localeService=(0,ui_src.fJ)(src.iH9),commandService=(0,ui_src.fJ)(src.wTY),filterBy=(0,ui_src.J2)(sheetsFilterPanelService.filterBy$,void 0,!0),filterByModel=(0,ui_src.J2)(sheetsFilterPanelService.filterByModel$,void 0,!1),canApply=(0,ui_src.J2)((()=>filterByModel?.canApply$||(0,observable_of.of)(!1)),void 0,!1,[filterByModel]),items=function useFilterByOptions(localeService){const locale=localeService.getCurrentLocale();return(0,react.useMemo)((()=>[{label:localeService.t("sheets-filter.panel.by-values"),value:FilterBy.VALUES},{label:localeService.t("sheets-filter.panel.by-conditions"),value:FilterBy.CONDITIONS}]),[locale,localeService])}(localeService),clearFilterDisabled=!(0,ui_src.J2)(sheetsFilterPanelService.hasCriteria$),onFilterByTypeChange=(0,react.useCallback)((value=>{commandService.executeCommand(ChangeFilterByOperation.id,{filterBy:value})}),[commandService]),onClearCriteria=(0,react.useCallback)((async()=>{await(filterByModel?.clear()),commandService.executeCommand(CloseFilterPanelOperation.id)}),[filterByModel,commandService]),onCancel=(0,react.useCallback)((()=>{commandService.executeCommand(CloseFilterPanelOperation.id)}),[commandService]),onApply=(0,react.useCallback)((async()=>{await(filterByModel?.apply()),commandService.executeCommand(CloseFilterPanelOperation.id)}),[filterByModel,commandService]),filterService=(0,ui_src.fJ)(SheetsFilterService),range=filterService.activeFilterModel?.getRange(),colIndex=sheetsFilterPanelService.col,FilterPanelEmbedPointPart=(0,ui_src.YP)(SheetsUIPart.FILTER_PANEL_EMBED_POINT);return(0,jsx_runtime.jsxs)("div",{className:views_components_index_module.sheetsFilterPanel,children:[(0,jsx_runtime.jsx)(ui_src.h1,{components:FilterPanelEmbedPointPart,sharedProps:{range,colIndex,onClose:onCancel}}),(0,jsx_runtime.jsx)("div",{className:views_components_index_module.sheetsFilterPanelHeader,children:(0,jsx_runtime.jsx)(design_src.$q,{value:filterBy,items,onChange:value=>onFilterByTypeChange(value)})}),filterByModel?(0,jsx_runtime.jsx)("div",{className:views_components_index_module.sheetsFilterPanelContent,children:filterBy===FilterBy.VALUES?(0,jsx_runtime.jsx)(FilterByValue,{model:filterByModel}):(0,jsx_runtime.jsx)(FilterByCondition,{model:filterByModel})}):(0,jsx_runtime.jsx)("div",{style:{flex:1}}),(0,jsx_runtime.jsxs)("div",{className:views_components_index_module.sheetsFilterPanelFooter,children:[(0,jsx_runtime.jsx)(design_src.$n,{type:"link",onClick:onClearCriteria,disabled:clearFilterDisabled,children:localeService.t("sheets-filter.panel.clear-filter")}),(0,jsx_runtime.jsxs)("span",{className:views_components_index_module.sheetsFilterPanelFooterPrimaryButtons,children:[(0,jsx_runtime.jsx)(design_src.$n,{type:"default",onClick:onCancel,children:localeService.t("sheets-filter.panel.cancel")}),(0,jsx_runtime.jsx)(design_src.$n,{disabled:!canApply,type:"primary",onClick:onApply,children:localeService.t("sheets-filter.panel.confirm")})]})]})]})}FilterPanel.__docgenInfo={description:"This Filter Panel component is used to filter the data in the sheet.\n\n@returns React element",methods:[],displayName:"FilterPanel"};const SheetsFilterPanel_stories={title:"Components / FilterPanel",component:FilterPanel,tags:["autodocs"]},FakeCetCellEditVisibleOperation={id:SetCellEditVisibleOperation.id,type:src.g4t.OPERATION,handler:()=>!0};function createFilterStorybookBed(workbookData,locale=src.VnV.EN_US){const univer=new src.ICO,injector=univer.__getInjector();class TestPlugin extends src.k_1{static#_=this.type=src.Zy$.UNIVER_SHEET;static#_2=this.pluginName="test-plugin";constructor(_config,_injector){super(),this._injector=_injector}onStarting(){const injector=this._injector;injector.add([sheets_src.Fal]),injector.add([ui_src.nF,{useClass:ui_src.ev}]),injector.add([sheets_src.fON]),injector.add([sheets_src.e5R]),injector.add([SheetsFilterPanelService]),injector.add([sheets_src.u7_]);const commandService=injector.get(src.wTY);[FakeCetCellEditVisibleOperation,SmartToggleSheetsFilterCommand,SetSheetsFilterCriteriaCommand,ClearSheetsFilterCriteriaCommand,ReCalcSheetsFilterCommand,OpenFilterPanelOperation,CloseFilterPanelOperation,ChangeFilterByOperation].forEach((command=>commandService.registerCommand(command))),commandService.syncExecuteCommand(OpenFilterPanelOperation.id,{unitId:"test",subUnitId:"sheet1",col:0})}}univer.registerPlugin(UniverSheetsFilterPlugin),univer.registerPlugin(TestPlugin),injector.get(src.iH9).setLocale(locale),injector.get(src.iH9).load({enUS:en_US,zhCN:zh_CN,ruRU:ru_RU}),injector.get(src.rrK).setLogLevel(src.$bb.VERBOSE);const sheet=univer.createUnit(src.Zy$.UNIVER_SHEET,workbookData);return{univer,injector,sheet}}const FilterWithConditions={render(){const[bed]=(0,react.useState)((()=>createFilterStorybookBed(function WithCustomFilterModelFactory(){return{id:"test",appVersion:"3.0.0-alpha",sheets:{sheet1:{id:"sheet1",cellData:{0:{0:{v:"Header"}},1:{0:{v:1}},2:{0:{v:2}},3:{0:{v:3}},4:{0:{v:4}},5:{0:{v:5}},6:{0:{v:6}},7:{0:{v:7}},8:{0:{v:8}},9:{0:{v:9}}}}},resources:[{name:"SHEET_FILTER_PLUGIN",data:JSON.stringify({sheet1:{ref:{startColumn:0,startRow:0,endColumn:5,endRow:5},filterColumns:[{colId:0,customFilters:{customFilters:[{val:123,operator:CustomFilterOperator.GREATER_THAN}]}}]}})}],locale:src.VnV.ZH_CN,name:"",sheetOrder:["sheet1"],styles:{}}}()))),{injector}=bed;return(0,jsx_runtime.jsx)(ui_src.WZ.Provider,{value:{injector},children:(0,jsx_runtime.jsx)(FilterPanel,{})})}},FilterWithValues={render(){const[bed]=(0,react.useState)((()=>createFilterStorybookBed(WithValuesFilterModelFactory())));return(0,jsx_runtime.jsx)(ui_src.WZ.Provider,{value:{injector:bed.injector},children:(0,jsx_runtime.jsx)(FilterPanel,{})})}},FilterWithChinese={render(){const[bed]=(0,react.useState)((()=>createFilterStorybookBed(WithValuesFilterModelFactory(),src.VnV.ZH_CN)));return(0,jsx_runtime.jsx)(ui_src.WZ.Provider,{value:{injector:bed.injector},children:(0,jsx_runtime.jsx)(FilterPanel,{})})}},__namedExportsOrder=["FilterWithConditions","FilterWithValues","FilterWithChinese"];FilterWithConditions.parameters={...FilterWithConditions.parameters,docs:{...FilterWithConditions.parameters?.docs,source:{originalSource:"{\n  render() {\n    const [bed] = useState(() => createFilterStorybookBed(WithCustomFilterModelFactory()));\n    const {\n      injector\n    } = bed;\n    return <RediContext.Provider value={{\n      injector\n    }}>\n                <FilterPanel />\n            </RediContext.Provider>;\n  }\n}",...FilterWithConditions.parameters?.docs?.source}}},FilterWithValues.parameters={...FilterWithValues.parameters,docs:{...FilterWithValues.parameters?.docs,source:{originalSource:"{\n  render() {\n    const [bed] = useState(() => createFilterStorybookBed(WithValuesFilterModelFactory()));\n    return <RediContext.Provider value={{\n      injector: bed.injector\n    }}>\n                <FilterPanel />\n            </RediContext.Provider>;\n  }\n}",...FilterWithValues.parameters?.docs?.source}}},FilterWithChinese.parameters={...FilterWithChinese.parameters,docs:{...FilterWithChinese.parameters?.docs,source:{originalSource:"{\n  render() {\n    const [bed] = useState(() => createFilterStorybookBed(WithValuesFilterModelFactory(), LocaleType.ZH_CN));\n    return <RediContext.Provider value={{\n      injector: bed.injector\n    }}>\n                <FilterPanel />\n            </RediContext.Provider>;\n  }\n}",...FilterWithChinese.parameters?.docs?.source}}}}}]);